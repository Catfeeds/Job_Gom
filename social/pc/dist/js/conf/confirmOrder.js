webpackJsonp([5],[function(a,t,e){"use strict";var n=e(95);e(99);var i=e(107),d=e(109),o=e(110);n.init(),i.init(),o.init(),d.init();var s=e(56);s.setPageData("confirmOrder")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(a,t,e){(function(t,$){"use strict";var n=e(50),i=e(22),d=e(48),o=e(2),s=e(28),c=e(43),r=e(51),l=e(42),u=e(52),p=e(37);e(46),e(54);var f,v,h,m,g,k,b,x,C,y,I,w,N,T,D=function(){f=this._$("content"),v=f.find("[data-node=name]"),h=f.find("[data-node=nameTip]"),m=f.find("[data-node=idCard]"),g=f.find("[data-node=idCardTip]"),k=f.find("[data-node=addr]"),b=f.find("[data-node=addrTip]"),x=f.find("[data-node=phone]"),x.attr("maxlength",12),C=f.find("[data-node=phoneTip]"),I=f.find("[data-node=setDefault]"),w=f.find("[data-node=province]"),N=f.find("[data-node=city]"),T=f.find("[data-node=borough]"),y=f.find("[data-node=areaTip]")},L=function(){v.placeholder(),k.placeholder(),x.placeholder()},P=function(a,t,e){var n=c(a),i=!0;return(n>t||n<e)&&(i=!1),i},S=function(){var a=r(v.val());v.val(a);var t=!0;return P(a,20,2)?h.hide():(t=!1,h.show()),t},A=function(){if("1"!=t.isCross)return!0;var a=r(m.val());m.val(a);var e=!0;return/^\d{17}[\dxX]$/.test(a)?g.hide():(e=!1,g.show()),e},O=function(){var a=r(k.val());k.val(a);var t=!0;return P(a,60,5)?b.hide():(t=!1,b.show()),t},R=function(){var a=r(x.val()),t=/^0([0-9]{3,4}-)?[0-9]{10,12}$/,e=/^1[34578][0-9]{9}$/,n=t.test(a)||e.test(a);return n?C.hide():C.show(),n},F=function(){var a=u.getData(),t=!0;return a.provinceId&&a.boroughId&&a.cityId?y.hide():(t=!1,y.show()),t},j=function(){var a=!0;return S()||(a=!1),A()||(a=!1),O()||(a=!1),R()||(a=!1),F()||(a=!1),a},M=function(a,t){var e=r(a.val()),n=c(e);n>t&&a.val(l(e,t))},V=function(){var a=I.data("checked"),e=m.val()||"",n=18===e.length,i={userName:v.val(),idCard:e.toUpperCase(),address:k.val(),mobile:x.val(),isDefault:a?1:0,isCross:!!parseInt(t.isCross),hasIdCardVal:n},d=u.getData();return d.areaId&&(i.areaId=d.areaId,i.areaName=d.areaName),d.provinceId&&(i.provinceId=d.provinceId,i.provinceName=d.provinceName),d.cityId&&(i.cityId=d.cityId,i.cityName=d.cityName),d.boroughId&&(i.boroughId=d.boroughId,i.boroughName=d.boroughName),i},_=function(){var a=f.find("[data-node=province]"),t=f.find("[data-node=city]"),e=f.find("[data-node=borough]"),n=f.find("[data-node=area]");u.init([a,t,e,n],["选择省","选择市","选择区县","选择街道"],{},[{content:'<span class="menu-add" data-node="checked">选择省</span>',btn:'<span class="down-arrow"><em class="iconn-2"></em></span>'},{content:'<span class="menu-add" data-node="checked">选择市</span>',btn:'<span class="down-arrow"><em class="iconn-2"></em></span>'},{content:'<span class="menu-add" data-node="checked">选择区县</span>',btn:'<span class="down-arrow"><em class="iconn-2"></em></span>'},{content:'<span class="menu-add" data-node="checked">选择街道</span>',btn:'<span class="down-arrow"><em class="iconn-2"></em></span>'}])},U=function(){v.on("blur",function(){S()}),v.on("textchange",function(){var a=$(this),t=a.data("name");a.val()!=t&&""!==t&&m.val("").prop("readonly",!1),M(v,20)}),m.on("blur",function(){A()}),m.on("contextmenu",function(){return!1}),m.on("keydown",function(a){var t=a.keyCode;return t>=48&&t<=57||t>=96&&t<=105||88==t||8==t||46==t||t>=37&&t<=40}),m.on("textchange",function(){var a=$(this).val(),t="";/^\d{1,18}$|^\d{17}[xX]$/.test(a)||(t=$.trim(a.substr(0,a.length-1)),$(this).val(t))}),k.on("blur",function(){O()}),k.on("textchange",function(){M(k,60)}),x.on("blur",function(){R()}),I.on("click",function(){var a=$(this),t=a.find("span"),e="menu-radio-checked";return t.hasClass(e)?(a.data("checked",0),t.removeClass(e)):(a.data("checked",1),t.addClass(e)),!1}),w.on("click","a",function(){F()}),N.on("click","a",function(){F()}),T.on("click","a",function(){F()})},Y=function(){v.off(),m.off(),k.off(),x.off(),I.off(),u.destroy()},E={name:"",phone:"",addr:"",province:"",city:"",borough:"",area:"",setDefault:!0,isCross:!1},q=function(a,e){var c=a.name,r=s.get("addAddress"),l="addr.add",u=a.addressId;u&&(r=s.get("editAddress"),l="addr.edit");var f=n(a||E);e=e||{};var v=!1,h={title:"编辑收货地址",modal:!0,fixed:!0,content:f,className:"pop-box",okValue:"确定",okCls:"pc-btn pc-btnh35 circle-pop-btn",ok:function(){var a=this;if(j()){if(v)return!1;v=!0;var e=V();"0"===t.isCross&&c!=e.userName&&e.idCard&&(e.idCard=""),u&&(e.addressId=u),void 0===e.areaId&&(e.areaId="110114001",e.areaName="全部区域"),o.post(r,{data:e}).done(function(t){var n=$("[data-node=userCardTips]"),i=t.code,o=t.data||{};if(200===i){o.addressId&&(e.addressId=o.addressId),d(l).pub(e);var s=$("[data-node=curAddr]"),c=s.closest("tr");if(s.length){var r=c.find("[data-node=addrInfos]").data("addr").idCard,u=!!$.trim(r);n.length&&u&&(n.remove(),c.find("[data-action=editAddr]").closest("td").removeClass("hide-text"))}a.close(),a.remove()}else p(t.message)}).fail(function(){}).always(function(){v=!1})}return!1},onshow:function(){D.call(this),_.call(this),L(),U()},onclose:function(){Y(),v=!1}};$.extend(!0,h,e);var m=i(h);return m.show(),m};a.exports=q}).call(t,e(4),e(1))},function(a,t,e){var n=e(26);a.exports=n("src/js/module/popup/deliveryAddr/content",function(a,t){"use strict";var e=this,n=(e.$helpers,e.$escape),i=a.name,d=a.isCross,o=a.idCard,s=a.hasIdCardVal,c=a.provinceId,r=a.province,l=a.cityId,u=a.city,p=a.boroughId,f=a.borough,v=a.areaId,h=a.area,m=a.addr,g=a.phone,k=a.isDefault,b="";return b+='<div class="edit-add-box"> <dl class="receiver clearfix"> <dt>收货人:</dt> <dd> <input type="text" data-node="name" data-name="',b+=n(i),b+='" placeholder="请输入姓名" value="',b+=n(i),b+='"> </dd> </dl> <p class="warn-txt" data-node="nameTip">收货人姓名为2-20个字符</p> ',d&&(b+=' <dl class="receiver clearfix"> <dt>身份证号:</dt> <dd> <input type="text" data-node="idCard" data-idcard="',b+=n(o),b+='" ',s&&(b+='readonly="true"'),b+=' placeholder="请输入身份证号" value="',b+=n(o),b+='"> </dd> </dl> <p class="warn-txt" data-node="idCardTip">请填写与收货人姓名对应的身份证号码</p> '),b+=' <dl class="area clearfix"> <dt>所在地区:</dt> <dd data-node="areaList"> <div data-node="province" data-provinceId=',b+=n(c),b+=">",b+=n(r),b+='</div> <div data-node="city" data-cityId=',b+=n(l),b+=">",b+=n(u),b+='</div> <div data-node="borough" data-boroughId=',b+=n(p),b+=">",b+=n(f),b+='</div> <div data-node="area" data-areaId=',b+=n(v),b+=">",b+=n(h),b+='</div> </dd> </dl> <p class="warn-txt" data-node="areaTip">请补充地址</p> <dl class="detail-add clearfix"> <dt>详细地址:</dt> <dd> <input type="text" data-node="addr" placeholder="请如实填写详细地址" value="',b+=n(m),b+='"> </dd> </dl> <p class="warn-txt" data-node="addrTip">限制为5-60个字符</p> <dl class="phone clearfix"> <dt>电话/手机:</dt> <dd> <input type="text" data-node="phone" placeholder="请输入电话/手机号" value="',b+=n(g),b+='"> </dd> </dl> <p class="warn-txt" data-node="phoneTip">请输入手机号/电话号码</p> <div class="set-default-add"> <label data-node="setDefault" data-checked="',b+=k===!0?"true":"false",b+='"> <span class="menu-radio ',b+=k===!0?"menu-radio-checked":"''",b+='"></span>设置为默认地址 </label> </div> </div> ',new String(b)})},function(a,t){"use strict";var e=function(a){return a.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")};a.exports=e},function(a,t,e){(function($){"use strict";e(53);var t,n=e(2),i=e(28),d={},o=function(a,e,o,s){function c(a,t){if(window.localStorage){var e=JSON.parse(localStorage.getItem("address"+a)),d=null===e||!e.hasOwnProperty("time")||e.time<+new Date;d?n.get(i.get("getAddress")+a,{}).done(function(e){if(200===e.code){t.call(null,e.data);var n={data:e.data,time:+new Date+6048e5};localStorage.removeItem("address"+a),localStorage.setItem("address"+a,JSON.stringify(n))}}).fail(function(a,t){}):t.call(null,e.data)}else n.get(i.get("getAddress")+a,{}).done(function(a){200===a.code&&t.call(null,a.data)}).fail(function(a,t){})}function r(t,n){var i=t;n||(i++,a[t].find("div").children().eq(0).text(d[u[t][1]]));for(var o=i,s=a.length;o<s;o++)void 0!==d[u[o][0]]&&(delete d[u[o][0]],delete d[u[o][1]]),a[o].find("div").children().eq(0).text(l?e:e[o]),o!=i&&a[o].find("ul").html("")}var a=a,l=!1,u=[["provinceId","provinceName"],["cityId","cityName"],["boroughId","boroughName"],["areaId","areaName"]],p={},f=!(s instanceof Array);o=$.extend({},p,o),t=a,"string"==typeof e&&(l=!0);for(var v=0;v<t.length;v++){var h=l?e:e[v];h!==t[v].text()&&(d[u[v][0]]=t[v].attr("data-"+[u[v][0]]),d[u[v][1]]=t[v].text());var m=v-1>=0?t[v-1].attr("data-"+[u[v-1][0]]):0;!function(n){var i=o;i.please=l?e:e[n],i.onChanged=function(i){var o=i.value,s=!1;void 0===o?s=!0:(d[u[n][0]]=i.value,d[u[n][1]]=i.text,n+1<=t.length-1&&c(~~o,function(t){a[n+1].setList({data:t.nodes,please:l?e:e[n+1],textName:"name",valueName:"id"})})),r(n,s)},a[n].selects(f?s:s[n],i),""!==m&&c(m,function(a){t[n].setList({data:a.nodes,please:l?e:e[n],textName:"name",valueName:"id",checked:t[0].find("div").children().eq(0).text()})})}(v)}},s=function(){for(var a=0,e=t.length;a<e;a++)t[a].off()},c=function(){return d};a.exports={init:o,destroy:s,getData:c}}).call(t,e(1))},function(a,t,e){(function($){"use strict";$.fn.extend({selects:function(a,t){var e=this,n={content:'<span class="span1">'+$(e).text()+"</span>",btn:'<span class="span2"></span>'},i=$.trim($(e).text()),d={data:[],checked:i,please:"请选择",textName:"text",valueName:"value",selectdCls:"active",checkText:!0,checkedCls:"active",disable:"disable",onChanged:function(){}};a=$.extend({},n,a),t=$.extend({},d,t);var o=$("<div></div>").appendTo($(e).empty()).height($(e).height());$(a.content).text(""===i?t.please:i).appendTo(o).attr("data-node","checked"),$(a.btn).appendTo(o);for(var s,c,r=null,l='<ul data-node="selectList"><li><a href="javascript:;">'+t.please+"</a></li>",u=t.parent?$(t.parent):this,p=t.parent?this.selector:void 0,f=0,v=t.data.length;f<v;f++)r=void 0!==t.data[f][t.valueName]?t.data[f][t.valueName]:f,l+='<li class="'+(t.data[f].checked===r?t.checkedCls:"")+'"><a href="javascript:;" data-value="'+r+'" data-index="'+f+'">'+t.data[f][t.textName]+"</a></li>";return l+="</ul>",$(l).appendTo($(e)),u.on("click",p,function(a){a.stopPropagation(),$('ul[data-node="selectList"]').hide(),0===t.data.length&&"running"!==$(this).attr("data-refresh")||$(this).hasClass(t.disable)||($(this).addClass(t.selectdCls),0!==$(this).find("ul li").length&&$(this).find("ul").show())}),u.on("click",'ul[data-node="selectList"] a',function(a){return a.stopPropagation(),s=$(this).parents("ul").parent().find('[data-node="checked"]'),s.text()!==$(this).text()&&(c={text:$(this).text()!==t.please?$(this).text():"",value:$(this).attr("data-value"),index:$(this).attr("data-index")},t.checkText&&s.text($(this).text()),void 0!==t.checkedCls&&$(this).parent().addClass(t.checkedCls).siblings().removeClass(t.checkedCls),t.onChanged.call(this,c)),$(this).parents("ul").hide(),!1}),$(document).on("click",function(){e.find("ul").hide()}),this},setList:function(a){$(this).attr("data-refresh","running");var t,e=this,n={data:[],textName:"text",checked:"",valueName:"value",please:"请选择",checkedCls:"active"};a=$.extend({},n,a);var i='<li><a href="javascript:;">'+a.please+"</a></li>";if(0!==a.data.length)for(var d=0,o=a.data.length;d<o;d++)t=void 0!==a.data[d][a.valueName]?a.data[d][a.valueName]:d,i+='<li class="'+(a.checked===a.data[d][a.textName]?a.checkedCls:"")+'"><a href="javascript:;" data-value="'+t+'">'+a.data[d][a.textName]+"</a></li>";return $(e).find('[data-node="selectList"]').html(i),this}})}).call(t,e(1))},function(a,t,e){(function($){"use strict";var a=document.createElement("input"),t="oninput"in a&&(!("documentMode"in document)||document.documentMode>9),e=function(a){return"INPUT"===a.nodeName&&("text"===a.type||"password"===a.type)},n=null,i=null,d=null,o={get:function(){return d.get.call(this)},set:function(a){i=a,d.set.call(this,a)}},s=function(a){n=a,i=a.value,d=Object.getOwnPropertyDescriptor(a.constructor.prototype,"value"),Object.defineProperty(n,"value",o),n.attachEvent("onpropertychange",r)},c=function(){n&&(delete n.value,n.detachEvent("onpropertychange",r),n=null,i=null,d=null)},r=function(a){if("value"===a.propertyName){var t=a.srcElement.value;t!==i&&(i=t,$(n).trigger("textchange"))}};t?$(document).on("input",function(a){"TEXTAREA"!==a.target.nodeName&&$(a.target).trigger("textchange")}):$(document).on("focusin",function(a){e(a.target)&&(c(),s(a.target))}).on("focusout",function(){c()}).on("selectionchange keyup keydown",function(){n&&n.value!==i&&(i=n.value,$(n).trigger("textchange"))})}).call(t,e(1))},function(a,t,e){(function($){"use strict";var t=e(22),n=function(){},i=function(a,e){var i={fixed:!0,modal:!0,content:'<p class="del-pop-p">'+a+"</p>",className:"pop-box",okCls:"pc-btn pc-btnh35 circle-pop-btn",ok:n,cancel:n,btnWrapCls:"two-buttons"};$.extend(!0,i,e);var d=t(i);return d.show(),d};a.exports=i}).call(t,e(1))},,,,,,,,,,,,,,function(a,t){"use strict";var e=function(a,t){function e(a){return a<10?"0"+a:a+""}a=parseInt(a);var n=new Date(a),i=n.getFullYear(),d=n.getMonth()+1,o=n.getDate(),s=n.getHours(),c=n.getMinutes(),r=n.getSeconds(),l={Y:i,y:i.toString().substr(-2),M:e(d),m:d,D:e(o),d:o,H:e(s),h:s,I:e(c),i:c,S:e(r),s:r},u=/([YMDHISymdhis])/g;return t.replace(u,function(a,t){return l[t]})};a.exports=e},,,,,,,,,,,,,,,,,,function(a,t,e){(function($){"use strict";var t,e,n,i=function(){t.off().on("click",function(){t.hide(),e.hide()}),e.off().on("click",function(){t.hide(),e.hide()})},d=function(a,d){var o={duration:2e3,callback:function(){}};$.extend(o,d||{}),clearTimeout(n),t=$('[data-action="publicMask"]'),e=$('[data-action="publicTips"]'),t.length>0?(t.show(),e.show().text(a)):($("body").append('<div data-action="publicMask" class="ordi-toast"></div><div class="ordi-toast-txt" data-action="publicTips">'+a+"</div>"),t=$('[data-action="publicMask"]'),e=$('[data-action="publicTips"]'),i()),e.css("margin",-e[0].offsetHeight/2+"px 0 0 "+-e.width()/2+"px"),n=setTimeout(function(){t.hide(),e.hide(),o.callback()},o.duration)};a.exports={init:d,events:i}}).call(t,e(1))},,,,,,,,function(a,t,e){(function($,t){"use strict";var n=e(2),i=e(28),d=e(48),o=e(49),s=e(55),c=e(37),r=e(87).init,l=e(96),u=e(97),p=$("[data-node=addrList]"),f=p.parent(),v=$("[data-action=addAddr]"),h=$("[data-action=expand]"),m=t,g=function(){location.href=window.location.href},k=function(a){a>=20?v.addClass("disabled"):v.removeClass("disabled")},b=function(a){var t=v.data("count"),e=t+a;return v.data("count",e),1===e&&1===a?void g():0===e?void y():(k(e),void(e>5?"展开"===h.find("span").text()&&h.show().click():h.hide()))},x=function(){var a=$(this).closest("tr"),e=1===a.data("dft"),n=a.find("[data-node=name]").text(),i=a.find("[data-node=phone]").text(),d=a.find("[data-addr]"),s=d.data("addr"),c=a.data("id"),r=!!parseInt(t.isCross),l=s.idCard||"",u=18===l.length;return o({name:n,idCard:s.idCard,hasIdCardVal:u,addr:s.address,isDefault:e,isCross:r,phone:i,province:s.provinceName,provinceId:s.provinceId,city:s.cityName,cityId:s.cityId,borough:s.boroughName,boroughId:s.boroughId,area:s.areaName,areaId:s.areaId,addressId:c}),!1},C=function(){var a=$(this).closest("tr");return s("确定删除收货地址吗？",{content:'<p class="pay-pop-p del-pop-p"><em class="iconn-25"></em>您确定要删除收货地址吗</p>',title:"删除",okCls:"",ok:function(){n.post(i.get("delAddress"),{data:{addressId:a.data("id")}}).done(function(t){var e=t.code;if(200===e){if(a.find("[data-node=curAddr]").hasClass("name-active"))return $("[data-node=userCardTips]").remove(),void g();a.remove(),b(-1)}else c("删除失败")})}}),!1},y=function(){var a=!!parseInt(t.isCross);return v.data("count")<20&&o({isCross:a},{title:"新增收货地址"}),!1},I=function(){var a=$(this),t=a.data("firing");if(t)return!1;a.data("firing",1);var e=a.closest("tr");return n.post(i.get("setDefaultAddr"),{data:{addressId:e.data("id")}}).done(function(a){a&&200===a.code?T(e):c("设置失败")}).fail(function(){c("设置失败")}).always(function(){a.data("firing",0)}),!1},w=function(a){var t=a||p.find("[data-dft=1]");t.attr("data-dft",0),t.find("[data-node=dftAddr]").addClass("hide"),t.find("[data-action=setDft]").css("visibility","visible")},N=function(){p.find("[data-node=lightName]").removeClass("name-active")},T=function(a){w(),a.find("[data-node=dftAddr]").removeClass("hide"),a.find("[data-action=setDft]").css("visibility","hidden"),a.attr("data-dft",1),p.find("tr").eq(0).after(a)},D=function(){var a=$(this);if("展开"===a.text())f.height("auto"),a.find("span").text("收起"),a.find("em").removeClass("iconn-45").addClass("iconn-37");else{var t=p.find("tr"),e=t.length;e=e>5?5:e,f.height(t.height()*e+10+"px"),a.find("span").text("展开"),a.find("em").removeClass("iconn-37").addClass("iconn-45")}return!1},L=function(a,t){t=t||{},s(a,{okValue:t.okValue||"修改配送地址",btnWrapCls:"insert-cancel",ok:t.ok||function(){document.body.scrollIntoView()}})},P=function(){var a=$(this),e=a.data("id"),d=a.children().eq(1).data("addr").provinceId;return N(),a.find("[data-node=lightName]").addClass("name-active"),n.post(i.get("isAddrOk"),{data:{addressId:e,addressProvinceId:d,skuList:JSON.stringify(t.skuList),fid:t.fid}}).done(function(){}).fail(function(){}).always(function(){g()}),!1},S=function(){var a=$("[data-node=curAddr]").closest("tr"),t=a.find("[data-action=editAddr]"),e=a.find("[data-node=addrInfos]").data("addr"),n=null,i="";e&&""===e.idCard&&(t.addClass("active"),t.closest("td").addClass("hide-text"),n=t.offset(),i=u({left:n.left-200,top:n.top-80}),$("body").append($(i)))},A=function(){var a=!!+t.showStatus,e=m.deliverInfo||{},n=m.orderList||[];a&&r("因配送地址变化，订单价格有变动，请留意"),200!==e.code?881043===e.code?L(e.message+"，请返回修改",{okValue:"返回修改",ok:function(){window.history.back()}}):L(e.message):p.find("tr").length?n.length||L("您购买的商品中包含无货或已下架商品，请返回修改",{okValue:"返回修改",ok:function(){window.history.back()}}):L("请添加收货地址",{okValue:"新建收货地址",ok:function(){y()}}),1==t.isCross&&S(),k(v.data("count")),v.on("click",y),p.on("click","[data-action=editAddr]",x),p.on("click","[data-action=delAddr]",C),p.on("click","[data-action=setDft]",I),p.on("click","tr[data-id]",P),h.on("click",D),d("addr.edit").sub(function(a){var t=p.find("[data-id="+a.addressId+"]");if(t.find("[data-node=curAddr]").hasClass("name-active"))return void g();var e=a.areaName?a.areaName:"",n=a.provinceName+a.cityName+a.boroughName+e+a.address,i=a.userName;t.find("[data-node=lightName]").text(i),t.find("[data-node=name]").text(i);var d=t.find("[data-addr]");d.data("addr",a);var o=t.find("[data-node=area]");o.text(n),t.find("[data-node=phone]").text(a.mobile),a.isDefault?T(t):w(t)}),d("addr.add").sub(function(a){var t=$("[data-dft=1]"),e=!!t.length,n=a.isDefault,i=a.areaName?a.areaName:"",d=a.provinceName+a.cityName+a.boroughName+i+a.address,o=JSON.stringify(a);a.pcba=d,a.pcbaStr=o;var s="after",c=$(l(a));e?(n&&(w(),s="before"),t.closest("tr")[s](c)):p.find("tr").eq(0)[s](c),b(1)})};a.exports={init:A}}).call(t,e(1),e(4))},function(a,t,e){var n=e(26);a.exports=n("src/js/page/confirmOrder/address/item",function(a,t){"use strict";var e=this,n=(e.$helpers,e.$escape),i=a.addressId,d=a.isDefault,o=a.userName,s=a.pcbaStr,c=a.pcba,r=a.mobile,l="";return l+='<tr data-id="',l+=n(i),l+='" data-dft="',l+=n(d),l+='"> <td width="10%"> <div class="name-box name-no-bor">',l+=n(o),l+='</div> </td> <td width="65%" data-addr="',l+=n(s),l+='"> <span title="',l+=n(o),l+='" class="consignee-name hide" data-node="name">',l+=n(o),l+='</span> <span title="" class="ship-address" data-node="area">',l+=n(c),l+='</span> <span class="phone-numb" data-node="phone">',l+=n(r),l+='</span> </td> <td width="25%" class="text-aglin-r"> <span class="default-address-bj ',1!==d&&(l+="hide"),l+='" data-node="dftAddr">默认地址</span> <a href="javascript:;" data-action="delAddr">删除</a> <a href="javascript:;" data-action="editAddr">编辑</a> <a href="javascript:;" data-action="setDft" ',1===d&&(l+='style="visibility:hidden"'),l+=">设置为默认地址</a> </td> </tr>",new String(l)})},function(a,t,e){(function($){"use strict";var t=e(98),n=function(a,e){var n=$(t({hasLink:!!e}));n.css(a);var i=$("<div></div>");return i.append(n),i.html()};a.exports=n}).call(t,e(1))},function(a,t,e){var n=e(26);a.exports=n("src/js/module/popup/userCardTips/userCardTips",function(a,t){"use strict";var e=this,n=(e.$helpers,a.hasLink),i="";return i+=n?' <div class="order-edit-box" data-node="editUserCardTips"> <div class="order-edit-text clearfix"><em class="iconn-12"></em><span>订单中含有跨境商品，需点击<br/><a href="javascript:;" data-action="editUserCard">编辑</a>完善身份信息！</span></div> <div class="order-edit-san"></div> </div> ':' <div class="order-edit-box" data-node="userCardTips"> <div class="order-edit-text clearfix"><em class="iconn-12"></em><span>订单中含有跨境商品，需点击编辑完善身份信息！</span></div> <div class="order-edit-san"></div> </div> ',new String(i)})},function(a,t,e){(function(a,$){"use strict";function t(a){a.sort(function(a,t){return a.endTime/1<t.endTime/1?-1:a.endTime/1==t.endTime/1&&a.money/1<t.money/1?-1:1})}function n(a){$("[data-action=useTickets]").data("coupons",a)}var i=e(100),d=e(101),o=e(22),s=e(48),c=e(71),r=e(102),l=e(103);e(106)(),e(105)();var u=a.couponList;u.shopList||(u.shopList=[]),u.platRedPackList||(u.platRedPackList=[]),function(){var a=[],t=$("[data-node=shopInfo]"),e=[];$.each(t,function(t,e){a.push($(e).data("shopid"))}),$.each(a,function(a,t){$.each(u.shopList,function(a,n){n.shopId==t&&e.push(u.shopList[a])})}),u.shopList=e}(),t(u.platRedPackList),function(){for(var a=u.shopList,e=0;e<a.length;e++){var n=a[e].redPackList;t(n)}}();var p=!0;(u.shopList.length||u.platRedPackList&&u.platRedPackList.length)&&(p=!1);var f=parseFloat($("[data-node=shippingPrice]").data("shippingprice")),v=parseFloat($("[data-node=goodsTotalPrice]").data("goodstotalprice"));f=isNaN(f)?0:f,v=isNaN(v)?0:v;var h={},m={},g=[],k=[],b=[],x=0,C=0,y=0,I=0;u.platRedPackList&&u.platRedPackList.length&&(h=r(u.platRedPackList,"id"),x=h.money/1);var w=u.shopList;$.each(w,function(a,t){t.redPackList.length&&(m=r(t.redPackList,"id"),C+=m.money/1,b.push(m))}),x>C?(u.platRedPackList&&u.platRedPackList.length&&(u.platRedPackList[h._index_].isFirst=!0,g.push("p-"+h._index_)),u.platShow=!0,u.shopShow=!1,y=x,k.push(h)):($.each(w,function(a,t){t.redPackList.length&&(m=r(t.redPackList,"id"),m.shopId=t.shopId,t.redPackList[m._index_].isFirst=!0,g.push("s-"+a+"-"+m._index_),k.push(m))}),u.platShow=!1,u.shopShow=!0,y=C),n(k);var N=v-y;I=l.initUseCoin(N),l.bindEvents(),s(c.confirmOrder.changeUseTickets).sub(function(a){var t=$("[data-node=ticketsDiscountName]"),e=$("[data-node=ticketsDiscount]"),n=a.ticketsDiscount;return n>0?(t.text("已抵扣："),void e.html("￥"+i(n))):void(p?(t.text("无可用优惠券"),e.html("")):(t.text("最高可抵用："),e.html("￥"+i(y))))}),s(c.confirmOrder.setFinalPrice).sub(function(a){var t=a.ticketsDiscount||0,e=a.gomeCoinDiscount||0,n=f+v-t-e;$("[data-node=useTicketsPrice]").text("￥"+i(t)),$("[data-node=useGomeCoinPrice]").text("￥"+i(e)),$("[data-node=finalPrice]").text(i(n))}),s(c.confirmOrder.changeUseTickets).pub({ticketsDiscount:y,orderDiscountPrice:N,gomeCoinDiscount:I}),s(c.confirmOrder.setGomeCoin).pub({ticketsDiscount:y,orderDiscountPrice:N,gomeCoinDiscount:I}),s(c.confirmOrder.setFinalPrice).pub({ticketsDiscount:y,orderDiscountPrice:N,gomeCoinDiscount:I});var T=function(a,t){a=a||{},t=t||function(){};var e={modal:!0,fixed:!0,content:d(a),className:"pop-box",okValue:"确定",okCls:"pc-btn coupon-btn",ok:t};return o(e).show()},D=function(){var a=$("[data-action=ticketRadio].menu-radio-checked"),t=0,e=[],i=[];$.each(a,function(a,n){t+=$(n).data("discount")/1,e.push($(n).data("index")),i.push($(n).data("info"))}),N=v-t;var d=e.length?e[0].charAt(0):"p";switch(d){case"s":u.platShow=!1,u.shopShow=!0;break;default:u.platShow=!0,u.shopShow=!1}$.each(g,function(a,t){var e=t.split("-");"p"==e[0]?u.platRedPackList[e[1]].isFirst=!1:u.shopList[e[1]].redPackList[e[2]].isFirst=!1}),$.each(e,function(a,t){var e=t.split("-");if("p"==e[0]){var n=u.platRedPackList[e[1]];n.isFirst=!0}else{var i=u.shopList[e[1]].redPackList[e[2]];i.isFirst=!0,i.shopId=u.shopList[e[1]].shopId}}),s(c.confirmOrder.changeUseTickets).pub({ticketsDiscount:t,orderDiscountPrice:N,gomeCoinDiscount:I}),s(c.confirmOrder.setGomeCoin).pub({ticketsDiscount:t,orderDiscountPrice:N,gomeCoinDiscount:I}),n(i),g=e.splice(0)};$("[data-action=useTickets]").on("click",function(){T(u,D),$("[data-node=ticketsMenu]").on("click","a",function(a){var t=$(this).children("em").length,e=$(this).index();a.preventDefault(),$(this).addClass("active").siblings("a").removeClass("active"),t||$(this).append('<em class="up-arrow"></em>').siblings("a").children("em").remove(),$("[data-node=ticketsList] > div").eq(e).show().siblings().hide()})}),$("body").on("click",'[data-action="ticketRadio"]',function(){var a="menu-radio-checked",t="[data-action=ticketRadio]",e=$(this);e.hasClass(a)?e.removeClass(a):(e.addClass(a).parent().parent().siblings().find(t).removeClass(a),e.parents("[data-node=ticketsBox]").siblings("div").find(t).removeClass(a))})}).call(t,e(4),e(1))},function(a,t){"use strict";function e(a){var t=(a/100).toFixed(2);return t="0.00"==t?"0":t}a.exports=e},function(a,t,e){var n=e(26);a.exports=n("src/js/page/confirmOrder/coupon/useTickets",function(a,t){"use strict";var e=this,n=e.$helpers,i=a.platShow,d=a.shopShow,o=a.platRedPackList,s=e.$each,c=(a.pp,a.i,e.$escape),r=a.shopList,l=(a.sp,a.sprl,a.j,"");return l+='  <table class="ui-dialog-grid"> <tbody> <tr> <td class="ui-dialog-header"> <button i="close" title="取消" href="javascript:;" class="icon icon-close">&times;</button> <div data-node="ticketsMenu" class="ui-dialog-title coupon-title"> <a href="javascript:;" ',i&&(l+='class="active"'),l+=">平台优惠券",i&&(l+='<em class="up-arrow"></em>'),l+='</a> <a href="javascript:;" ',d&&(l+='class="active"'),l+=">店铺优惠券",d&&(l+='<em class="up-arrow"></em>'),l+='</a> </div> </td> </tr> <tr> <td data-node="ticketsList" class="ui-dialog-body">  <div data-node="ticketsBox" class="coupon-box" style="',d&&(l+="display: none;"),l+='"> ',o.length?(l+=" ",s(o,function(a,t){l+=' <div class="clearfix"> <label><span data-action="ticketRadio" data-index="p-',l+=c(t),l+='" data-discount="',l+=c(a.money),l+='" data-ticketid="',l+=c(a.id),l+='" data-info=\'{"id":',l+=c(a.id),l+=',"planId":',l+=c(a.planId),l+=',"couponPlat":0}\' class="menu-radio ',a.isFirst&&(l+="menu-radio-checked"),l+='"></span>满',l+=c(n.f2Y(a.baseMoney)),l+="减",l+=c(n.f2Y(a.money)),l+='</label><span class="time">',l+=c(n.dateFormat(a.startTime,"Y.M.D")),l+="-",l+=c(n.dateFormat(a.endTime,"Y.M.D")),l+="</span> </div> "}),l+=" "):l+=' <div class="clearfix"> 没有可用平台优惠券 </div> ',l+=' </div>  <div data-node="ticketsBox" class="coupon-box" style="',i&&(l+="display: none;"),l+='"> ',r.length?(l+=" ",s(r,function(a,t){l+=' <div> <div class="shop"><em class="iconn-64"></em>',l+=c(a.shopName),l+="</div> ",a.redPackList.length&&(l+=" ",s(a.redPackList,function(e,i){l+=' <div class="clearfix"> <label><span data-action="ticketRadio" data-index="s-',l+=c(t),l+="-",l+=c(i),l+='" data-discount="',l+=c(e.money),l+='" data-shopid="',l+=c(a.providerId),l+='" data-ticketid="',l+=c(e.id),l+='" data-info=\'{"id":',l+=c(e.id),l+=',"planId":',l+=c(e.planId),l+=',"couponPlat":0}\' class="menu-radio ',e.isFirst&&(l+="menu-radio-checked"),l+='"></span>满',l+=c(n.f2Y(e.baseMoney)),l+="减",l+=c(n.f2Y(e.money)),l+='</label><span class="time">',l+=c(n.dateFormat(e.startTime,"Y.M.D")),l+="-",l+=c(n.dateFormat(e.endTime,"Y.M.D")),l+="</span> </div> "}),l+=" "),l+=" </div> "}),l+=" "):l+=' <div class="clearfix"> 没有可用店铺优惠券 </div> ',l+=" </div> </td> </tr> </tbody> </table>",new String(l)})},function(a,t){"use strict";var e=function(a,t){function e(a,t){var e=parseFloat(a.money),n=parseFloat(t.money),i=a.endTime,d=t.endTime;return e===n?i>=d?t:a:e>n?a:t}var n=a.length,i=a[n-1];if(i._index_=n-1,n>1)for(var d=n-2;d>=0;d--){var o=a[d];i=e(i,o),i[t]===o[t]&&(i._index_=d)}return i};a.exports=e},function(a,t,e){(function(t,$){"use strict";var n=e(104),i=e(22),d=e(48),o=e(71),s=e(100);e(105)();var c=t.gomeCoin,r=parseFloat(c.totalRebate),l=parseFloat(c.useableRebate),u=l>=r?r:l,p={canUse:0,checked:!1,bindTips:function(a){function t(a){$("[data-node=useGomeCoin]").html(a)}var e=a-100,n="",i=this.checked?"已抵扣":"当前可用";e=e>=u?u:e,e<=0?(this.canUse=0,n="无可用国美币"):(this.canUse=e,n=i+'：<span class="looked-up">￥'+s(e)+"</span>"),t(n)},initUseCoin:function(a){return this.bindTips(a),0},showPop:function(a,t){a=a||{},t=t||function(){};var e={modal:!0,fixed:!0,content:n(a),className:"pop-box",okValue:"确定",okCls:"pc-btn coupon-btn",ok:t};return i(e).show()},bindEvents:function(){var a,t,e=this,n=0,i=0,s=function(a){$("[data-action=useGomeCoin]").data("gomeCoins",a)};d(o.confirmOrder.setGomeCoin).sub(function(n){a=n.ticketsDiscount,t=n.orderDiscountPrice,e.bindTips(t),i=e.canUse,c()});var c=function(){n=e.checked?i:0,s(n),d(o.confirmOrder.setFinalPrice).pub({ticketsDiscount:a,orderDiscountPrice:t,gomeCoinDiscount:n}),d(o.confirmOrder.gomeMoney).pub({gomeMoney:n})},r=function(){$("[data-action=gomeCoinRadio]").hasClass("menu-radio-checked")?(n=$("[data-action=gomeCoinRadio]").data("coin")/1,s(n),e.checked=!0):(n=0,e.checked=!1,s(0)),e.bindTips(t),d(o.confirmOrder.setFinalPrice).pub({ticketsDiscount:a,orderDiscountPrice:t,gomeCoinDiscount:n})};$("[data-action=useGomeCoin]").on("click",function(){if(e.canUse<=0)return!1;var a={checked:e.checked,coinVal:e.canUse};e.showPop(a,r)}),$("body").on("click","[data-action=gomeCoinRadio]",function(){$(this).toggleClass("menu-radio-checked")})}};a.exports=p}).call(t,e(4),e(1))},function(a,t,e){var n=e(26);a.exports=n("src/js/page/confirmOrder/gomeCoin/gomeCoin",function(a,t){"use strict";var e=this,n=e.$helpers,i=a.checked,d=e.$escape,o=a.coinVal,s="";return s+='<table class="ui-dialog-grid"> <tbody> <tr> <td class="ui-dialog-header"> <button i="close" title="取消" href="javascript:;" class="icon icon-close">×</button> <div class="ui-dialog-title">国美币</div> </td> </tr> <tr> <td class="ui-dialog-body"> <div class="gome-coin-box clearfix"> <span class="menu-radio ',i&&(s+="menu-radio-checked"),s+='" data-coin="',s+=d(o),s+='" data-action="gomeCoinRadio"></span> <p>使用国美币（当前可用：￥<span class="coinVal">',s+=d(n.f2Y(o)),s+="</span>）</p> </div> </td> </tr> </tbody> </table>",new String(s)})},function(a,t,e){"use strict";var n=e(26),i=e(100);a.exports=function(){n.helper("f2Y",i)}},function(a,t,e){"use strict";var n=e(26),i=e(69);a.exports=function(){n.helper("dateFormat",i)}},function(a,t,e){(function($,t){"use strict";var n=e(55),i=e(108);e(54);var d="hide",o="menu-radio-checked",s="[data-node=invoiceInfo]",c=$("[data-node=invoice]"),r=!!+t.show_eceipt,l=function(a){n("",{fixed:!0,modal:!0,title:"修改发票",content:a,className:"pop-box pop-pad-btm65",okCls:"pc-btn pc-btnh40 pc-btnw120",cancelCls:"queren-btn pc-btnh40 pc-btnw120",ok:u,okValue:"确认修改",btnWrapCls:"two-buttons"})},u=function(){var a=c.find("[data-node=invoiceType]"),t=c.find("[data-node=invoiceTitle]"),e=c.find("[data-node=invoiceDetail]"),n=t.parent(),i=e.parent(),o=$(s),r=o.data("type"),l=$.trim(o.val()),u=["不开发票","普通发票"],p="明细";return r?""===l?(o.addClass("input-error").parent().addClass("show-error"),!1):(c.data("t",r),c.data("n",l),a.text(u[1]),t.text(l),e.text(p),n.removeClass(d),void i.removeClass(d)):(c.data("t",r),c.data("n",""),a.text(u[0]),n.addClass(d),i.addClass(d),!0)},p=function(){var a=$("[data-node=noInvoice]"),t=$("[data-node=openInvoice]"),e=$("[data-node=openInvoiceBox]"),n=$("[data-action=clear]"),i=$(s);a.on("click",function(){return!r&&($(this).find("span").addClass(o),t.find("span").removeClass(o),e.addClass(d),void i.data("type",0))}),t.on("click",function(){var t;$(this).find("span").addClass(o),a.find("span").removeClass(o),e.removeClass(d),t=e.find("label > .menu-radio-checked").parent("label").data("type"),i.data("type",t)}),e.on("click","label",function(){$(this).find("span").addClass(o).end().parent().siblings().find("span").removeClass(o),i.data("type",$(this).data("type"))}),i.on("textchange",function(){var a=/[!@#$%^&*+~,.?:;"'！；：、，…。？￥]/g,t=$.trim(this.value),e=t.length;a.test(t)&&(t=t.replace(a,function(){return""}),this.value=t),e>50&&(t=t.substring(0,50),this.value=t),e>0?n.show():n.hide()}),n.on("click",function(){n.hide(),i.val("").focus()}),i.on("focus",function(){var a=$.trim($(this).val());
$(this).removeClass("input-error").parent().removeClass("show-error"),""!==a&&n.show()})},f=function(){var a=c.find("[data-action=updateInvoice]");a.on("click",function(){var a=c.data("t"),t=c.data("n");r&&""===$.trim(t)&&(t="个人");var e=i({type:a,title:t,hasEA:r});return l(e),p(),!1})};a.exports={init:f}}).call(t,e(1),e(4))},function(a,t,e){var n=e(26);a.exports=n("src/js/page/confirmOrder/invoice/invoice",function(a,t){"use strict";var e=this,n=(e.$helpers,a.type),i=e.$escape,d=a.title,o="";return o+='<div class="ui-body-box"> <div class="invoice-box"> <h3 class="radio-title">发票类型：</h3> <div class="invoice-flot-lft"> <label data-node="noInvoice" data-type="0" ',n>0&&(o+='class="gm-gray"'),o+='><span class="menu-radio ',0==n&&(o+="menu-radio-checked"),o+='"></span>不开票</label> </div> <div class="invoice-flot-lft"> <label data-node="openInvoice"><span class="menu-radio ',n>0&&(o+="menu-radio-checked"),o+='"></span>普通发票</label> </div> </div> <div data-node="openInvoiceBox" class="',0==n&&(o+="hide"),o+='"> <div class="invoice-box"> <h3 class="radio-title">发票抬头：</h3> <div class="invoice-flot-lft"> <label data-type="1"><span class="menu-radio ',n<2&&(o+="menu-radio-checked"),o+='"></span>个人</label> </div> <div class="invoice-flot-lft"> <label data-type="2"><span class="menu-radio ',2==n&&(o+="menu-radio-checked"),o+='"></span>单位</label> </div> </div> <div class="please-enter"><em data-action="clear" class="iconn-7"></em> <input data-node="invoiceInfo" data-type="',o+=i(n),o+='" type="text" value="',o+=i(d),o+='" placeholder="请输入发票抬头" class="input-error"> <p class="error"><em class="iconn-25"></em>请输入发票抬头信息</p> </div> <p class="invoice-content">发票内容：由供应商自行确定发票内容</p> </div> </div>',new String(o)})},function(a,t,e){(function($){"use strict";function t(){var a=30,t=$("[data-node=buyerMsg]");t.on("textchange",function(){var t=$(this),e=$.trim(t.val()),n=e.length;n>a&&t.val(e.substr(0,a))})}e(54),a.exports={init:t}}).call(t,e(1))},function(a,t,e){(function($,t){"use strict";var n=e(2),i=e(28),d=e(55),o=e(97),s=$("[data-action=submitOrder]"),c=t,r=function(){var a=$("[data-node=invoice]"),t=a.data("t"),e=a.data("n");return t>0?{hasInvoice:1,invoice:{type:1,titleType:t,title:e,content:"明细"}}:{hasInvoice:0,invoice:{}}},l=function(){function a(a){var t=[];return $.each(a,function(a,e){var n={id:e.id,planId:e.planId,couponPlat:0};t.push(n)}),t}var e=c.orderList,n=$("[data-action=useTickets]").data("coupons"),i=$("[data-action=useGomeCoin]").data("gomeCoins")||0,d=$("[data-node=buyerMsg]").val(),o=r();return n=a(n),{addressId:c.currentAddress.id,payType:4,delivery:{receivingTimeType:1,needConfirmation:!0,memo:d},hasInvoice:o.hasInvoice,invoice:o.invoice,coupons:n,gomeMoney:i,orders:e,accoss:t.isCross}},u=function(){var a=s.offset(),t=o({left:a.left-120,top:a.top-80},!0),e=$(t);$("body").append(e),setTimeout(function(){e.remove()},6e3),e.on("click","a",function(){e.remove(),$("body, html").scrollTop(0),$("[data-node=curAddr]").parents("tr").find("[data-action=editAddr]").click()})},p=!1,f=function(){if(!p){p=!0,s.addClass("btn-default");var a=l(),e=c.fid;return n.post(i.get("submitOrder")+"?fid="+e,{data:{proJson:JSON.stringify(a)}}).done(function(a){if(a&&a.success===!0)location.href=t.order_domain+"order/paydetail?fid="+e;else{var n=a.message,i=a.code,o=/\[881064\]/,c=/\[881043\]/,r=n.substring(0,n.indexOf("错误码[")-1);if("100030"==i)return u(),!1;if("881011"==i)return location.href=t.passport_domain+"/login/index",!1;if(o.test(n))return d(r,{autofocus:!1,okValue:"修改配送地址",ok:function(){$(document).scrollTop(0),p=!1,s.removeClass("btn-default")},okCls:"red",cancelValue:"取消"}),!1;if(c.test(n))return d(r,{autofocus:!1,okValue:"返回修改",ok:function(){window.history.back()},okCls:"red",cancelValue:"取消"}),!1;d(n,{okValue:"返回修改",ok:function(){window.history.back()},okCls:"red",cancelValue:"取消"})}}).fail(function(){}).always(function(){p=!1,s.removeClass("btn-default")}),!1}},v=function(){c.deliverInfo.success===!0&&c.orderList.length?s.on("click",f):s.addClass("btn-default")};a.exports={init:v}}).call(t,e(1),e(4))}]);
!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={exports:{},id:o,loaded:!1};return e[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){!function(){n(1);var e=function(){var e,t=function(){if(!e){var t='<div class="share-weixin"><div class="wx-mask"></div><div class="wx-main"><div class="wx-code"><span></span><img data-node="qrcode" alt="分享到微信" /></div><p>打开微信扫一扫，即可分享</p><a href="#" title="点击关闭" class="wx-close" data-action="close">×</a></div></div>';e=$(t),$("body").append(e)}return e},n=!1,o=function(o){var i=t();if(!n){var a=i.find("[data-node=qrcode]");a[0].src=o,e.on("click","[data-action=close]",function(){return e.hide(),!1}),n=!0}i.show()},i="https://www.gomeplus.com/ajax/qrcode/urlcode";$("[data-action=shareWX]").on("click",function(){var e=i+"?url="+window.location.href;o(e)})};e(),$("[data-node=shareBar]").on("mouseenter","a > em",function(){var e=$(this);return e.html(e.data("active")),!1}).on("mouseleave","a > em",function(){var e=$(this);return e.html(e.data("init")),!1}),$("[data-node=sharemore]").on("click","em",function(){$(this).hide().siblings("em").show(),$("[data-node=shareLink]").toggle()}),$("[data-node=videoText]").on("click","a",function(){$(this).parent("div").hide().siblings("div.text").show()}),$("[data-node=copyBtn]").each(function(e,t){e=new ZeroClipboard(t),e.on("ready",function(n){e.on("copy",function(e){var n=e.clipboardData,o=$(t).siblings("[data-node=copyVal]").val();n.setData("text/plain",o)})})})}()},function(e,t){function n(e){var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null}function o(){}window.alert=function(e,t){"function"!=typeof t&&(t=function(){}),e=String(e);var n=0,o=0,i=0,a=0,r="",s="<div style=\"min-width: 200px;padding: 40px 20px;margin:0;font:14px/1.7 'Microsoft YaHei';color: #333;border: 1px solid #DDD;border-bottom: none;text-align: center;\">"+e+'</div><button style="width: 100%;height: 40px;line-height: 40px;text-align: center;border:1px solid #DDD;border-top-color:#CCC;outline: none;background: #fefefe;cursor: pointer;">确定</button>',d="background:rgba(0,0,0,.1);position:fixed;left:0;top:0;right:0;bottom:0;z-index:99998;cursor:auto;",l=function(e,t,n){return"position: fixed;left: "+e+";top:"+t+";margin:"+n+";z-index: 99999;box-shadow: 0 0 10px 5px rgba(0,0,0,.3);background:#FFF;overflow: hidden;"},c=document.createElement("div"),u=document.createElement("div"),p=null;c.style.cssText=d,u.style.cssText=l(i,a,r),u.innerHTML=s,p=u.querySelector("button"),p.onclick=function(){document.body.removeChild(c),u=null,c=null,p.onclick=null,t()},document.body.onkeydown=function(e){var t=window.event||e;"13"==t.keyCode&&p.click()},c.appendChild(u),document.body.appendChild(c),n=u.clientWidth,o=u.clientHeight,i=a="50%",r="-"+o/2+"px 0 0 -"+n/2+"px",u.style.cssText=l(i,a,r)},$(function(){if("live"===videoType){var e=$(".video-text"),t=e.find("div.text-form"),i=t.find("input.form-btn"),a=t.find("input.form-text"),r=e.find("div.tab").find("a"),s=$(".text"),d=$(".text-list"),l=$(".video"),c=l.find("em.icon-open");r.on("click",function(e){r.removeClass("active");var t=$(e.target).text();$(e.target).addClass("active"),"弹幕"==t?(s.hide(),d.show()):(s.eq(0).show(),d.hide())}),c.on("click",function(t){var n=parseInt(l.css("width")),o=$("div.danma");900==n?(l.css("width",1200),o.css("width",1200),c.eq(1).hide(),c.eq(0).show(),e.hide()):(l.css("width",900),o.css("width",900),c.eq(0).hide(),c.eq(1).show(),e.show())});var u=new o;u.init({textarea:a,talkArea:d,btn:i,renderTimer:null,maxLength:500,duringTime:30,env:window.env,host_id:n("host_id"),room_id:room_id,autoplay:1,danmaku:1,camera:0,danmakuStatus:1})}});var i=[];o.prototype.init=function(e){var t=this;if(e.room_id){this.room_id=e.room_id,this.duringTime=e.duringTime||30,this.videoContainer=e.videoContainer||"videoContainer",this.elementID=e.elementID||"mxvPlayer",this.autoplay=e.autoplay,this.danmaku=e.danmaku,this.env=e.env||"dev",this.stream=e.stream||"",this.camera=e.camera,this.type=e.type||"live",this.danmakuStatus=e.danmakuStatus,this.renderTimer=null;var o=new MeixinPlayer;if(o.init(this.room_id,this.videoContainer,{elementID:this.elementID,autoplay:this.autoplay,danmaku:this.danmaku,env:this.env,stream:this.stream,camera:this.camera,type:this.type,danmakuStatus:this.danmakuStatus}),this.textarea=e.textarea,this.talkArea=e.talkArea,this.btn=e.btn,this.host_id=e.host_id,window.v=o,o.on("playerInited",this.initComplete),o.on("needUserInfo",this.needUserInfo),o.on("messageReceived",this.receiveMessage),o.on("sendMessageSendResult",this.sendMessageSendResult),o.on("userLoginedByOther",this.userLoginedByOther),this.renderList(),this.renderTimer=setInterval(function(){t.renderList()},t.duringTime),""==n("host_name")||null==n("host_name"));else{n("host_name")}this.sendDanmaEv()}},o.prototype.initComplete=function(){},o.prototype.openDanma=function(){$(".danma").show()},o.prototype.closeDanma=function(){$(".danma").hide()},o.prototype.needUserInfo=function(){$.ajax({type:"GET",url:$GLOBAL_CONFIG.loginStyle,data:{type:1},dataType:"jsonp",jsonp:"callback",sync:!1,success:function(e){var t={user_id:"",nickname:""};3==e.loginStatus&&(t.user_id=e.loginId,t.nickname=e.loginName),v.setUserInfo(t)},error:function(e){console.log("request error")}})},o.prototype.receiveMessage=function(e,t){t.isSensitive?console.log("当前数据有敏感词 被过滤掉"):(i.push(t),console.log("flash 成功发给 js"))},o.prototype.sendMessageSendResult=function(e){e?console.log("flash监控  ：   发送后端存储成功"):(console.error("flash接受弹幕消息error"),alert("接受信息失败"))},o.prototype.renderList=function(){var e=i,t=this;if(e.length)for(var n=0;n<e.length;n++){var o=e[n],a=new RegExp("<","g"),r=new RegExp("/>","g"),s=o.content.content.replace(a,"&lt;").replace(r,"/&gt;"),d='<li style="font-weight:bold;" data-message_id="'+o.message_id+'" data-room_id="'+o.content.room_id+'" data-sender_id="'+o.content.sender.user_id+'" data-receiver_id="'+o.content.receiver.user_id+'"><a style="color:'+o.content.sender.style.color+';" href="javascript:;">'+o.content.sender.nickname+'：</a><span style="color:'+o.content.style.color+';">'+s+"</span></li>";t.talkArea.find("li").length>=t.maxLength&&(console.log("超过"+t.maxLength+"条了"),t.talkArea.find("li:first").remove()),t.talkArea.find("ul").append(d),t.talkArea.scrollTop(t.talkArea[0].scrollHeight),e.splice(n,1),n--}},o.prototype.sendMsg=function(){var e=this,t=this.textarea.val();return/\S/.test(t)?void $.ajax({type:"GET",url:$GLOBAL_CONFIG.loginStyle,data:{type:1},dataType:"jsonp",jsonp:"callback",sync:!1,success:function(t){if(3==t.loginStatus){var n=e.sendDanmaku(t.loginId,t.loginName);v.sendDanmaku(n),e.textarea.val("")}else popGomeOnlineLogin(function(){})},error:function(e){console.log("request error")}}):void console.log("你填的是空格")},o.prototype.sendDanmaku=function(e,t){var o=this,i=this.textarea.val(),a=o.host_id==e?"#e90034":"#ffffff",r=o.host_id==e?"#e90034":"#49abd1",s={content:i,room_id:o.room_id,style:{fontSize:"22px",color:a},sender:{user_id:e,nickname:t,session_id:n("PHPSESSID")||"",style:{fontSize:"22px",color:r}},receiver:{user_id:"",nickname:"",style:{fontSize:"22px",color:"#ffffff"}}};return s},o.prototype.sendDanmaEv=function(){var e=this;this.textarea.on({keyup:function(t){13===t.which&&(console.log(1),t.preventDefault(),e.sendMsg())}}),e.btn.on({click:function(){e.sendMsg()}})},o.prototype.StopRecieve=function(e){clearInterval(this.renderTimer),e&&e()},o.prototype.userLoginedByOther=function(){var e="你的账号已在其他终端登录，是否重新登录！";alert(e,function(){$.ajax({type:"GET",url:$GLOBAL_CONFIG.loginStyle,data:{type:1},dataType:"jsonp",jsonp:"callback",sync:!1,success:function(e){var t={user_id:3==e.loginStatus?e.loginId:"",nickname:3==e.loginStatus?e.loginName:""};v.setUserInfo(t)},error:function(e){console.log("request error")}})})}}]);
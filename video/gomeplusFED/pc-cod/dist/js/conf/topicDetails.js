webpackJsonp([30],{0:function(a,e,t){(function($){var a=t(216),e=t(217),i=t(219),n=t(220),o=t(225),s=t(226),r=t(227),d=t(54);d.setPageData("topicDetail");var c=t(221);c.init(),r.init(),o.init(),s.init(),i.init(),e.init($("[data-node=follow]")),n.init(),a("[data-node=circle]",function(){var a=$("[data-node=circle]"),e=a.data("approvaltype");0==e?(a.css("backgroundColor","#fc8753").html("发布话题"),a.attr("href","/topic/publiser?gid="+a.data("groupid")),a.attr("event-id","G000P010")):1==e&&a.css("backgroundColor","#ccc"),a.off().show(),n.getLoginState()})}).call(e,t(1))},84:function(a,e,t){(function($){var e,t,i,n=function(){e.off().on("click",function(){e.hide(),t.hide()}),t.off().on("click",function(){e.hide(),t.hide()})},o=function(a,o){var s={duration:2e3,callback:function(){}};$.extend(s,o||{}),clearTimeout(i),e=$('[data-action="publicMask"]'),t=$('[data-action="publicTips"]'),e.length>0?(e.show(),t.show().text(a)):($("body").append('<div data-action="publicMask" class="ordi-toast"></div><div class="ordi-toast-txt" data-action="publicTips">'+a+"</div>"),e=$('[data-action="publicMask"]'),t=$('[data-action="publicTips"]'),n()),t.css("margin",-t[0].offsetHeight/2+"px 0 0 "+-t.width()/2+"px"),i=setTimeout(function(){e.hide(),t.hide(),s.callback()},s.duration)};a.exports={init:o,events:n}}).call(e,t(1))},121:function(a,e,t){(function($){var e=t(2),i=t(28),n=t(122),o=t(42),s={qq:"http://connect.qq.com/widget/shareqq/index.html",sina:"http://v.t.sina.com.cn/share/share.php",qzone:"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey"},r={url:"http://www.gomeplus.com",title:"国美+APP边玩边分享，购物不孤单",pic:"http://www.gomeplus.com/images/logo.png",summary:"国美+APP边玩边分享，购物不孤单"},d=function(a){window.open(a)},c=!1,l=function(){var a='<p data-node="shareBtnBox" class="share-down" style="z-index:21;"><span class="share-box"><span class="icon icon-up-arrow"></span><span class="icon-box"><em data-shareto="weixin" class="icon icon-weixin">&#xe937;</em><em data-shareto="qq" class="icon icon-qq">&#xe900;</em><em data-shareto="sina" class="icon icon-sina">&#xe935;</em><em data-shareto="qzone" class="icon icon-kongjian">&#xe902;</em></span></span></p>';$("body").append(a),c=!0},p=function(a){!c&&l(),$("[data-node=shareBtnBox]").css({left:a.x,top:a.y}).show()},u=!1,m=function(){var a='<div class="share-weixin"><div class="wx-mask"></div><div class="wx-main"><div class="wx-code"><span></span><img data-node="shareWeixinCode" alt="分享到微信" /></div><p>打开微信扫一扫，即可分享</p><a href="javascript:;" title="点击关闭" class="wx-close">×</a></div></div>';$("body").append(a),u=!0},h=function(a,e){var t=[],i={title:a.title,url:a.url,summary:a.summary,desc:a.desc,site:a.site};e?i.pics=a.pic:i.pic=a.pic;for(var n in i)t.push(n+"="+encodeURIComponent(i[n]||""));return t.join("&")},f={weixin:function(a){var e=n(a.url);!u&&m(),$("[data-node=shareWeixinCode]")[0].src=e,$(".share-weixin").show(),$(".wx-close").on("click",function(){$(".share-weixin").hide()})},qq:function(a){var e=s.qq+"?"+h(a,!0);d(e)},sina:function(a){var e=s.sina+"?"+h(a);d(e)},qzone:function(a){var e=s.qzone+"?"+h(a,!0);d(e)}},v=function(a){var t="0"!==a.isRebate;e.get(i.get("shareGetGoodsKid"),{validate:t,data:{skuId:a.skuId,itemId:a.itemId,parentKid:a.parentKid},async:!1}).done(function(e){if(e.success===!0){var t=e.data.kid,i=a.shareInfo,n=i.url,o=n.indexOf("?");o>0&&(n=n.substring(0,o)),i.url=n+"?onlineUserId="+i.onlineUserId+"&kId="+t,f[a.shareto](i)}else f[a.shareto](a.shareInfo)}).fail(function(e){t?o()&&f[a.shareto](a.shareInfo):f[a.shareto](a.shareInfo)})},g=function(a){var e={title:a.title||r.title,url:a.url||r.url,pic:a.pic||r.pic,summary:a.summary||"",desc:a.desc||""};!!f[a.type]&&f[a.type](e)},y=function(a,e,t){var i=null;$item="string"==typeof a?$(a):a,e=e||"[data-action=shareto]",$item.on("mouseenter",e,function(a){var e=$(this).data("surl"),t=$(this).data("stitle"),n=$(this).data("spic");i={url:e,title:t,pic:n};var o=$(this).width(),s=$(this).height(),r=$(this).offset().left/1+o/2-80+"px",d=$(this).offset().top/1+(s-1)+"px";return p({x:r,y:d}),!1}),$item.on("mouseleave",e,function(a){return $("[data-node=shareBtnBox]").hide(),!1}),$("body").on("click","[data-shareto]",function(a){a.preventDefault(),shareType=$(this).data("shareto"),i.type=shareType,t=t||function(){},t.call(null,i),g(i)}),$("body").on("mouseenter","[data-node=shareBtnBox]",function(){$(this).show()}),$("body").on("mouseleave","[data-node=shareBtnBox]",function(){$(this).hide()})};a.exports={share:g,shareto:f,shareItem:y,shareWithKid:v}}).call(e,t(1))},122:function(a,e,t){(function(e){var t=function(a){return e.wap_url+"q.php?t="+encodeURIComponent(a)};a.exports=t}).call(e,t(4))},178:function(a,e,t){(function($){var e,i,n=t(179),o=t(180),s=t(181),r=0,d={},c=function(a){for(var e=a.length,t=24,i=Math.ceil(e/t),n=[],o=0;o<i;o++){n[o]=[];var s=t*(o+1);s=s>e?e:s;for(var r=o*t;r<s;r++){var c=a[r];n[o].push(c),d[c.name]=c.url}}return{page:new Array(i),list:n}},l=function(a,e){u(0),$("[data-node=faceBox]").css({left:a+"px",top:e+"px"}).show()},p=function(){$("[data-node=faceBox]").hide()},u=function(a){a=a||r,$("[data-action=facePage] > li").eq(a).addClass("active").siblings("li").removeClass("active"),$("[data-node=faceList] > div").eq(a).removeClass("hide").siblings("div").addClass("hide")},m=function(a,t){$("body").on("click","[data-face]",function(n){n.preventDefault(),n.stopPropagation(),e=$(this).data("face"),i=$(this).attr("src"),a({reg:e,url:i}),t!==!1&&$("[data-node=faceBox]").hide()})},h=function(a){var e=c(n),t=s(e);$("body").append(t),a()},f=function(){$("body").on("click","[data-node=faceBox]",function(a){a.stopPropagation()}),$(document).on("click",function(){$("[data-node=faceBox]").hide()}),$("[data-node=faceBox]").on("mouseenter","[data-action=facePage] > li",function(){var a=$(this).index();u(a)})},v=function(a){var e=!0;for(var t in a){e=!1;break}return e},g=function(a){var e=/(\[([\s\S]+?)\])/g;return v(d)&&c(n),a.replace(e,function(a,e,t){var i=d[t];if(i)return'<img width="22" height="22" src="'+i+'" />';var n=o[t];return n?'<img width="22" height="22" src="'+n.url+'" />':a})},y=function(){h(f)};a.exports={init:y,insert:m,show:l,hide:p,parseEmoji:g}}).call(e,t(1))},179:function(a,e,t){(function(e){var t=e.imgpath+"/images/emoji/",i=".png",n=[{name:"微笑",url:"weixiao"},{name:"色",url:"se"},{name:"亲亲",url:"qinqin"},{name:"得意",url:"deyi"},{name:"流泪",url:"liulei"},{name:"害羞",url:"haixiu"},{name:"闭嘴",url:"bizui"},{name:"鼓掌",url:"guzhang"},{name:"大哭",url:"daku"},{name:"尴尬",url:"ganga"},{name:"生气",url:"shengqi"},{name:"调皮",url:"tiaopi"},{name:"呲牙",url:"ciya"},{name:"惊讶",url:"jingya"},{name:"委屈",url:"weiqu"},{name:"吐血",url:"tuxue"},{name:"冷汗",url:"lenghan"},{name:"抓狂",url:"zhuakuang"},{name:"难过",url:"nanguo"},{name:"偷笑",url:"touxiao"},{name:"白眼",url:"baiyan"},{name:"不屑",url:"buxie"},{name:"快哭了",url:"kuaikule"}],o=[{name:"困",url:"kun"},{name:"装酷",url:"zhuangku"},{name:"大笑",url:"daxiao"},{name:"偷瞄",url:"toumiao"},{name:"奋斗",url:"fendou"},{name:"咒骂",url:"zhouma"},{name:"疑问",url:"yiwen"},{name:"晕",url:"yun"},{name:"捶打",url:"chuida"},{name:"再见",url:"zaijian"},{name:"抠鼻",url:"koubi"},{name:"发呆",url:"fadai"},{name:"坏笑",url:"huaixiao"},{name:"哈欠",url:"haqian"},{name:"鄙视",url:"bishi"},{name:"睡觉",url:"shuijiao"},{name:"饿",url:"e"},{name:"阴险",url:"yinxian"},{name:"难受",url:"nanshou"},{name:"可怜",url:"kelian"},{name:"撇嘴",url:"piezui"},{name:"石化",url:"shihua"},{name:"泪眼",url:"leiyan"}],s=function(a){for(var e=0,n=a.length;e<n;e++){var o=a[e];o.url=t+o.url+i}return a};a.exports=s(n.concat(o))}).call(e,t(4))},180:function(a,e,t){(function(e){var t=e.imgpath+"/images/emoji/",i=".png",n={"亲":{name:"亲亲",url:t+"qinqin"+i},"愤怒":{name:"生气",url:t+"shengqi"+i},"惊恐":{name:"惊讶",url:t+"jingya"+i},"迷茫":{name:"委屈",url:t+"weiqu"+i},"伤心":{name:"难过",url:t+"nanguo"+i},"努力":{name:"奋斗",url:t+"fendou"+i},YY:{name:" 坏笑",url:t+"huaixiao"+i},"恶心":{name:"难受",url:t+"nanshou"+i}};a.exports=n}).call(e,t(4))},181:function(a,e,t){var i=t(26);a.exports=i("src/js/module/popup/face/face",function(a,e){"use strict";var t=this,i=(t.$helpers,t.$each),n=a.list,o=(a.v,a.i,a.face,a.$index,t.$escape),s=a.page,r="";return r+='<div data-node="faceBox" class="imoj-box" style="position: absolute;z-index: 111;display:none"> <em class="sanjiao"></em> <div data-node="faceList" class="imoj-list"> ',i(n,function(a,e){r+=' <div class="imoj-content clearfix ',e&&(r+="hide"),r+='"> ',i(a,function(a,e){r+=' <a href="javascript:;"> <img width="22" height="22" data-face="[',r+=o(a.name),r+=']" src="',r+=o(a.url),r+='" alt="',r+=o(a.name),r+='" title="',r+=o(a.name),r+='"> </a> '}),r+=" </div> "}),r+=' </div> <ul data-action="facePage" class="pagination"> ',i(s,function(a,e){r+=" <li ",0==e&&(r+='class="active"'),r+="></li> "}),r+=" </ul> </div>",new String(r)})},209:function(a,e){var t=function(a,e){return a?a.replace(e||/[&<">'](?:(amp|lt|ldquo|rdquo|quot|gt|#39|nbsp|#\d+);)?/g,function(a,e){return e?a:{"<":"&lt;","&":"&amp;",'"':"&quot;","“":"&ldquo;","”":"&rdquo;",">":"&gt;","'":"&#39;"}[a]}):""};a.exports=t},210:function(a,e,t){(function($,e){var i=t(2),n=t(28),o=t(36),s=t(43),r=t(68),d=t(42),c=d(),l=function(){},p=function(a,e,t){a.data("praise",e),a.data("count",t)},u={normal:{add:function(a,e,t){a.find("em").addClass("active"),t||(t="取消点赞"),a.find("span").text(t)},reduce:function(a,e,t){a.find("em").removeClass("active"),t||(t="点赞"),a.find("span").text(t)}}},m=function(a){return u[a]},h=function(a,t,d){var u=$(a),h=d.onPraise||l,f=d.onUnPraise||l,v=d.onPraised||l,g=d.mode||"normal";u.on("click",t,function(){function a(a){i.post(n.get("praise"),a).done(function(a,i,n){var d=m(g);if(s(r.comment.enableEditor).pub({pid:"enable"}),a&&200===a.code&&a.success)1===u?(p(t,0,++b),d.add(t,a,b),h.call(t,a,b)):0===u&&(p(t,1,--b),d.reduce(t,a,b),f.call(t,a,b));else if(a&&422===a.code);else if(a&&403===a.code)o("抱歉！该话题审核未通过",{ok:function(){window.location.href=e.group_domain+"index/error?code=topic"}});else{var y=a.message;if(409===a.code)return v.call(t,a,b),c&&o(y),!1;0===l&&404===a.code?o(y,{ok:function(){window.location.reload()}}):o(y)}}).fail(function(a,e,t){}).always(function(){t.data("firing",0)})}var t=$(this),d=t.data("firing");if(1!==d){t.data("firing",1);var l=t.data("type"),u=t.data("praise"),y=t.data("id"),b=t.data("count"),I={validate:!0,data:{id:y,type:l,isPraise:u},onLogin:a,refresh:!0};return a(I),!1}})};a.exports=h}).call(e,t(1),t(4))},216:function(a,e,t){(function($,e){var i=t(2),n=t(28),o=t(36),s="<p data-node='alertTitle' class='dialog_p'>申请已发送，请耐心等待</p><img data-node='QRcode' src=''><p class='dialog_p'>下载国美+APP随时关注</p>",r=function(a,t){var r=$(a);r.on("click",function(){var a=r.data("groupid"),d={event_id:r.attr("event-id"),group_id:a,circle_type:$GLOBAL_CONFIG.s_c};if($GLOBAL_CONFIG.topicid&&(d.topic_id=$GLOBAL_CONFIG.topicid),void 0!==window.BP&&BP.send(d),1==r.data("verif"))return void o("您已提交申请，请等待审核");var c=r.data("firing");if(1===c)return!1;r.data("firing",1);var l=r.data("userid"),p=(r.data("approvaltype"),function(){i.post(n.get("joinCircle"),{validate:!0,data:{groupid:a,imid:"b_"+l},onLogin:p}).done(function(a,i,n){if(a&&200===a.code&&a.success){if(0===a.data.status)o("恭喜您已经加入圈子！"),r.hide();else if(1===a.data.status){o("",{width:"500px",content:s,cancel:!1});$("[data-node=QRcode]").attr("src",e.imgpath+"/images/public/down-ma.png"),$(".dialog_p").css({"text-align":"center",margin:"10px 0px","font-size":"1.5em"}),$("[data-node=QRcode]").css({"margin-left":"173px"}),r.css("background","#CCC").html("审核中").off()}t()}else"圈子拒绝加入"==a.message||403===a.code?o("抱歉！该圈子不允许任何人加入！"):409===a.code?(o(a.message),r.hide(),t()):o(a.message)}).fail(function(a,e,t){}).always(function(){r.data("firing",0)})});return p(),!1})};a.exports=r}).call(e,t(1),t(4))},217:function(a,e,t){(function(e,$){var i=t(36),n=t(2),o=t(28),s=t(218),r=t(36),d=function(a,t){if(0===e.islogin)return r("您还未登录,请登录后重试"),!1;var c=a,l=function(a,t){var o=t||!1;n.get(a.url,{data:{userid:a.userid}}).done(function(t,n,l){if("200"==t.code){if(a.isAlert){var p=i("",{width:"600",content:s(),ok:!1,close:function(){p.remove()}});$("[data-node=QRcode]").attr("src",e.imgpath+"/images/public/down-ma.png"),$("[data-node=dialog_close]").on("click",function(){$(this).off(),p.remove()}),$(c).css("opacity","0.7")}else $(c).css("opacity","1");o&&d(o)}else r(t.message),o&&d(o)}),c.html(a.val)};(t||"1"==t||void 0==!t)&&c.html("已关注").css("opacity","0.7"),c.on("click",function(){if(0==e.islogin)return r("您还未登录,请登录后重试"),!1;var a={};a.userid=$(this).data("userid"),"已关注"==$(this).html()?(a.isAlert=!1,a.url=o.get("unfollow"),a.val="加关注",$(this).off(),l(a,c)):(a.isAlert=!0,a.url=o.get("follow"),a.val="已关注",$(this).off(),l(a,c))})};a.exports={init:d}}).call(e,t(4),t(1))},218:function(a,e,t){var i=t(26);a.exports=i("src/js/page/topicDetails/follow",'<div class="windows-bg" style="display:block"> <div class="windows-ma"><a data-node=\'dialog_close\' href="javascript:;" class="icon icon-close">&times;</a><img data-node=\'QRcode\' src=""> <p>扫描二维码，下载国美+APP查看消息</p> </div> </div>')},219:function(a,e,t){(function($){var e=t(210),i=$("[data-node=praiseClick]");i.children("em").hasClass("active")&&i.children("span").html("取消点赞");var n=function(){return e("[data-node=ulFloat]","[data-node=praiseClick]",{mode:"normal"}),!1};a.exports={init:n}}).call(e,t(1))},220:function(a,e,t){(function($,e){function i(a){var e=new Date(a);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}function n(a){return a.replace(/&lt(.*?)&gt;/g,"")}function o(a){var e=a.replace(/\n|\r\n/g,"</br>");return e}var s=t(84),r=t(221),d=t(36),c=t(222),l=t(2),p=t(28),u=t(178),m=t(209),h=t(223),f=t(224),v=t(3),g=t(42),y=t(43),b=t(68),I={userIsExpert:$GLOBAL_CONFIG.isExpert,$comment_Msg:$("[data-node=comment_Msg]"),$secondCom_Key:$("[data-node=secondCom_Key]"),$loadlist:$("[data-node=loadlist]"),a_Submit:$("[data-node=a_Submit]"),circleCom:$("[data-node=circleCom]"),is_Login:1==g()?1:0,LoginSrc:e.passport_domain,mall_domain:e.mall_domain};I.$loadlist.css("display","none"),$("[data-node=loading]").css("display","none"),$("[data-node=noload]").css("display","none");var x,w=function(){I.$comment_Msg.on("click",T),I.a_Submit.on("click",q),I.circleCom.on("click","[data-node=secondCom_Key]",P),I.circleCom.on("click","[data-node=hideComBox]",j),I.circleCom.on("click","[data-node=a_secondComBtn]",B),I.$comment_Msg.on("click","[data-node=smilies_Face]",M),I.circleCom.on("click","[data-node=smilies_Face]",M),I.circleCom.on("click","[data-node=showMoreList]",S)},C=function(){L(1,10,2),u.init(),_(),U()&&u.insert(function(a){R(x[0],a.reg)}),w(),$("[data-node=loading]").css("display","none"),$("[data-node=noload]").css("display","none"),$("[data-node=loadlist]").on("click",function(){var a=$(this).attr("data-addmorepages"),e=$(this).attr("data-listsize"),t=($(this).attr("data-tootlepa"),parseInt(a)+1),i="nodelist";return L(t,e,5,i),!1})},_=function(){var a=$("[data-action=goComment]");a.on("click",function(a){window.BP&&BP.send({event_id:"G000P008",group_id:$GLOBAL_CONFIG.groupid,topic_id:$GLOBAL_CONFIG.topicid,circle_type:$GLOBAL_CONFIG.s_c,channel_id:"in-pinglun"});var e=$("[data-node=commentBox]").offset().top;$("html,body").animate({scrollTop:e},200)})},k=function(){var a=function(){I.is_Login=1,U(),$("[data-node=circleCom]").empty(),L(1,10,2)};v({onLogin:a})},T=function(){if(!g())return k(),!1},U=function(){var a=null;return g()?(I.$comment_Msg.children("textarea").removeAttr("readonly").css("background","transparent"),I.a_Submit.removeClass("pc-bj-fc8753").html("发布"),$("[data-node=secondCom_Key]").css("display","block"),a="1"):(a="0",I.$comment_Msg.children("textarea").attr("readonly","readonly").css("background","#fff"),$("[data-node=secondCom_Key]").css("display","none")),a},q=function(){if(!g())return k(),!1;var a=I.$comment_Msg.attr("data-headface"),e=$(this).parents().eq(1),t=e.children("textarea").val();t=t.trim();var f=(e.attr("data-userid"),e.attr("data-tid"));if(t){var v=0,y={reply_type:0,topicid:f,content:t};l.post(p.get("commentFirstV2"),{data:y}).then(function(t){if(t.success){var l=t.data,p=l.content;p=m(p),p=n(p),p=o(p),e.children("textarea").val("");var f={dlShowBorder:"clearfix bd-bottom",userIsExpert:I.userIsExpert,isExpert:l.expertInfo.isExpert,userPic:l.user.facePicUrl,username:l.user.nickname,backTopicId:l.id,content:u.parseEmoji(p),topicType:v,topicId:l.topicId,currUserImg:a,times:c(i(l.createTime)),isFirstCom:!0};$("[data-node=hidDiv]").css("display","block");var g=h(f);I.circleCom.append($(g));var y=$("[data-ddlist="+f.backTopicId+"]");$("body").scroll(parseInt(y.offset().top)),r.init(),$("body,html").animate({scrollTop:parseInt($(".topic-lfet",".wrap-box.wrap-reletive ").height())}),s.init("评论成功")}else 881001===t.code?d("评论内容不能超过200个汉字"):404===t.code||410===t.code?d("抱歉，该话题已被删除",{ok:function(){window.location.href="/index/get_error?code=topic_404"}}):422===t.code?d("抱歉，服务器君正在打盹",{ok:function(){window.location.href="/index/get_error?code=500"}}):403===t.code?d("抱歉，该话题审核不通过！",{ok:function(){window.location.href="/index/get_error?code=topic"}}):d(t.message)})}else d("输入有错，重新输入")},P=function(){if(!g())return k(),!1;var a=$(this).attr("data-replyuserid"),e=$(this).attr("data-replycommentid"),t=$(this).attr("data-comid"),i=$(this).attr("data-replayUser"),n=$(this).attr("data-publish"),o=$("[data-parenttopicid="+t+"]").css("display"),s=$("[data-parentTopicId="+t+"]");s.removeAttr("data-replyuserid"),s.removeAttr("data-replayTo"),s.removeAttr("data-replycommentid"),s.removeAttr("data-isPublish"),s.attr("data-replyuserid",a),s.attr("data-replayTo",i),s.attr("data-isPublish",n),s.attr("data-replycommentid",e),s.children(".topic-publish-content").children("textarea").attr("placeholder",i),"none"==o&&(s.css("display","block"),$("[data-parentTopicIdBtn="+t+"]").css("display","block"))},j=function(){if(!g())return k(),!1;var a=$(this).attr("data-parentTopicIdBtn");$("[data-parentTopicId="+a+"]").css("display","none"),$("[data-parentTopicId="+a+"]").children("textarea").attr("placeholder","说点什么吧"),$("[data-parentTopicIdBtn="+a+"]").css("display","none"),$("[data-parentTopicId="+a+"]").removeAttr("data-isPublish").removeAttr("data-replayTo"),$(".textarea-bx","[data-parentTopicId="+a+"]").val("")},B=function(){if(!g())return k(),!1;var a=$(this).parents().eq(2).attr("data-ispublish"),e="",t="";"1"==a?a=!1:(a=!0,e=$(this).parents().eq(2).attr("data-replycommentid"),t="b_"+$(this).parents().eq(2).attr("data-replyuserid"));var i=($("[data-node=comment_Msg]").attr("data-nickname"),$(this).parents().eq(2).attr("data-replayto"),$(this).attr("data-gettopicid")),s=($("[data-htid="+i+"]").attr("data-groupid"),$("[data-htid="+i+"]").attr("data-topictype"),$("[data-htid="+i+"]").attr("data-tid")),r=$(this).parents().eq(1).children("textarea").val(),c=null;c=r.length>200;var h=("b_"+$("[data-node=comment_Msg]").attr("data-userid"),$(this).parents().eq(2).attr("data-replycommentid"),i),v={topic_reply_id:h,topicid:s,content:r,topic_subreply_id:e};r&&!c?l.post(p.get("secondtopicV2"),{data:v}).then(function(e){if(e.success){var t=e.data.content;t=m(t),t=u.parseEmoji(t),t=n(t),t=o(t);var s="",r="";a&&(s=e.data.topicSubReplyUser.nickname,r=e.data.topicSubReplyUser.id);var c={topicType:0,backTopicId:i,parentCommentId:i,topicId:e.data.topicId,replayToPub:a,content:t,replyUserName:e.data.user.nickname,replyUserId:e.data.user.id,beReplyUserName:s,beReplyUserId:r,replyCommentId:e.data.id},l=f(c);$("[data-ddlist="+i+"]").append(l),$("[data-parentTopicIdBtn="+i+"]").css("display","none"),$("[data-parentTopicId="+i+"]").css("display","none"),$("[data-parentTopicId="+i+"]").removeAttr("data-replayto"),$(".textarea-bx","[data-parentTopicId="+i+"]").val("")}else 500===e.code||"请求参数为空"===e.message?d(e.message):(403===e.code&&(e.message="抱歉，该回复审核不通过！"),d(e.message,{ok:function(){$("[data-node=circleCom]").empty(),L(1,10,2)}}))}):d("评论内容不能超过200个汉字")},L=function(a,e,t,n){var s=$("[data-node=comment_Msg]").attr("data-tid"),d=$("[data-node=comment_Msg]").attr("data-headface"),f="?page="+a+"&pagesize="+e+"&topicid="+s;$("[data-node=loadlist]").css("display","none"),$("[data-node=loading]").css("display","block"),l.get(p.get("commentListUrlV2")+f).then(function(s){if(s.success){var l=s.data.topicReplys;if(l.length>0){$("[data-node=loading]").css("display","block"),$("[data-node=loadlist]").css("display","block").attr("data-addMorePages",a).attr("data-ListSize",e);for(var p=0;p<l.length;p++){var f=l[p],v=f.subReplyQuantity,g=f.topicSubReplys,y=[],b=null,x=null;v>t?(showMall=!0,x="clearfix",b=t):(showMall=!1,b=parseInt(g.length),x="clearfix bd-bottom");for(var w=0;w<b;w++){var C=g[w];if(C){var _=null,k="",T="";C.topicSubReplyUser?(_=!0,k=C.topicSubReplyUser.nickname,T=C.topicSubReplyUser.id):_=!1;var U=C.content;U=m(U),U=u.parseEmoji(U),U=o(U);var q={parentCommentId:f.id,replayToPub:_,content:U,replyUserName:C.user.nickname,replyUserId:C.user.id,beReplyUserName:k,beReplyUserId:T,replyCommentId:C.id};y.push(q)}}var P=f.content;P=m(P),P=u.parseEmoji(P),P=o(P);var j=f.pics,B="";if(j.length>0){var L=j;L.length;$.each(L,function(a,e){B+="</br><img  style='max-height:500px;max-width:750px' src="+e+" onerror='imgError(this)' >"})}P+=B;var S="",R="",M="",E="",N="";f.item&&(S=f.item.mainImage,R=f.item.name,M=f.item.price,E=f.item.id,N=f.item.shopId,rebateSummary=f.item.rebateSummary);var z="",A="";f.shop&&(z=f.shop.icon,R=f.shop.name,f.shop.promotionMark&&(A=f.shop.promotionMark.hasCouponPlan),N=f.shop.id);var G={dlShowBorder:x,showMall:showMall,userIsExpert:I.userIsExpert,isExpert:f.expertInfo.isExpert,userPic:f.user.facePicUrl,username:f.user.nickname,backTopicId:f.id,content:u.parseEmoji(P),topicType:f.replyType,topicId:f.topicId,currUserImg:d,times:c(i(f.createTime)),isFirstCom:!1,secondReply:y,mall_domain:I.mall_domain,itemsPic:S,itemShopName:R,itemPrice:M,shopId:E,itemShopId:N,redPackage:A,shopPic:z},D=h(G);if(I.circleCom.append($(D)),$("[data-node=loading]").css("display","none"),$("[data-node=loadlist]").css("display","block"),"0"==I.is_Login&&$("[data-node=secondCom_Key]").css("display","none"),l.length<e&&$("[data-node=loadlist]").css("display","none"),r.init(),n){var O=parseInt($(window).height()),F=$(".topic-lfet").height()-O;$(window).scrollTop(F)}}}else $("[data-node=loading]").css("display","none"),1==e&&$("[data-node=hidDiv]").css("display","none")}else $("[data-node=loadlist]").css("display","none"),$("[data-node=noload]").css("display","block"),$("[data-node=loading]").css("display","none")})},S=function(){function a(a,t){l.get(p.get("getRelyListV2")+a).then(function(a){var i=a.data.topicSubReplys;if(i.length>2){$("[data-ddlist="+e+"]").children(".comments-s").remove();for(var n=0;n<i.length;n++){var s=i[n],r=s.content;r=m(r),r=u.parseEmoji(r),r=o(r);var d="",c="",l=!1;s.topicSubReplyUser&&(d=s.topicSubReplyUser.nickname,c=s.topicSubReplyUser.id,l=!0);var p={topicType:0,backTopicId:e,parentCommentId:e,topicId:s.topicId,replayToPub:l,content:r,replyUserName:s.user.nickname,replyUserId:s.user.id,beReplyUserName:d,beReplyUserId:c,replyCommentId:s.id},h=f(p);$("[data-ddlist="+e+"]").append(h),"0"==I.is_Login&&$("[data-node=secondCom_Key]").css("display","none"),t.html("收起")}}else t.addClass("hide"),$("[data-ddlist="+e+"]").parent().addClass("bd-bottom")})}var e=($(this).attr("data-groupId"),$(this).attr("data-imId"),$(this).attr("data-topicType"),$(this).attr("data-htid")),t=($(this).attr("data-tid"),$(this).attr("data-tootlePages")),i=$(this).attr("data-currentPage"),n=$(this).attr("data-pageSize"),s=(Math.ceil(parseInt(t)/parseInt(n)),parseInt(t)%parseInt(n),parseInt(i)+1,$(this)),r="?page=1&pagesize=70&topic_replyid="+e,d=s.html();if("查看回复..."===d)a(r,s);else{for(var c=$("[data-ddlist="+e+"]").children(".comments-s"),h=2;h<c.length;h++)c.eq(h).remove();s.html("查看回复...")}},R=function(a,e){if(a.selectionStart>=0){var t=a.value,i=a.selectionStart;a.selectionEnd;a.value=t.substring(0,i)+e+t.substring(a.selectionEnd),a.selectionStart=a.selectionEnd=i+e.length,a.focus()}else if("undefined"!=typeof document.selection&&"undefined"!=typeof document.selection.createRange){a.focus();var n=document.selection.createRange();n.text=e,n.select()}},M=function(){if(!g())return k(),!1;var a=$(this),e=a.offset(),t=e.left-2,i=e.top+38;return x=a.closest("div").prev(),$("[data-node=faceBox]").is(":hidden")?u.show(t,i):u.hide(),!1};y(b.comment.enableEditor).sub(function(a){"enable"==a.pid&&U()}),a.exports={init:C,getLoginState:U}}).call(e,t(1),t(4))},221:function(a,e,t){(function($){function e(a,e){return!(e>a)}var t=function(){var a=0;$(window).scroll(function(){var t=$(".topic-lfet"),i=$(".topic-right"),n=parseInt(t.height()),o=parseInt(i.height()),s=parseInt($(window).height()),r=o-s,d=$("body").width()-$(".wrap-box").width();d=parseInt(d)/2;var c=parseInt($("body").height()),l=parseInt($(this).scrollTop()),p=parseInt($("[data-node=header]").height())+parseInt($(".wrap-box").height()),u=parseInt($(".footer").height()),m=e(s,o);m?l-p>0&&l<c-u-310?i.css({position:"fixed",right:d+"px"}).addClass("top_ly").removeClass("bottom_ly"):l>c-u-310?i.css({position:"absolute",right:"0px"}).addClass("bottom_ly").removeClass("top_ly"):i.css({position:"absolute",right:"0px"}).addClass("top_ly").removeClass("bottom_ly"):n+100>o&&(a-l<0?l-p>=r&&(l<c-u-s?i.css({position:"fixed",right:d+"px"}).addClass("bottom_ly").removeClass("top_ly"):i.css({position:"absolute",right:"0px"}).addClass("bottom_ly").removeClass("top_ly")):l+s-p>o&l+50<c-u-s?i.css({position:"fixed",right:d+"px"}).addClass("bottom_ly").removeClass("top_ly"):l+s-p<=o&&i.css({position:"absolute",right:"0px"}).removeClass("bottom_ly").addClass("top_ly"),a=l)})};a.exports={init:t}}).call(e,t(1))},222:function(a,e){var t=function(a){var e="",t=new Date(a).getTime(),i=(new Date).getTime(),n=i-t,o=6e4,s=36e5;if(oneDay=864e5,n<o)e="1分钟前";else if(n>=o&n<s){var r=Math.floor(n/o);e=r+"分钟前"}else if(n>=s&n<oneDay){var r=Math.floor(n/s);e=r+"小时前"}else if(n>=oneDay&n<2*oneDay){var r=Math.floor(n/oneDay);e="昨天"}else if(n>=2*oneDay&n<7*oneDay){var r=Math.floor(n/oneDay);e=r+"天前"}else e=a;return e};a.exports=t},223:function(a,e,t){var i=t(26);a.exports=i("src/js/page/topicDetails/comment/commentList",function(a,e){"use strict";var t=this,i=(t.$helpers,a.topicType),n=t.$escape,o=a.dlShowBorder,s=a.isExpert,r=a.userPic,d=a.backTopicId,c=a.topicId,l=a.username,p=a.times,u=t.$string,m=a.content,h=a.isFirstCom,f=t.$each,v=a.secondReply,g=(a.value,a.i,a.imId),y=a.itemsPic,b=a.itemShopName,I=a.itemPrice,x=a.mall_domain,w=a.shopId,C=a.itemShopId,_=a.shopPic,k=a.redPackage,T=a.showMall,U=a.groupId,q=a.replyCommentNum,P=a.currentPage,j=a.pageSize,B=a.userIsExpert,L=a.currUserImg,S="";return S+=" ","0"==i&&(S+=' <dl class="',S+=n(o),S+=' "> <dt> ',s&&(S+=' <em class="icon-daren"></em>'),S+=' <img src="',S+=n(r),S+='" onerror="imgError(this, \'g\')"> </dt> <dd data-ddList="',S+=n(d),S+='"> <div class="circle-comments-title" data-topicType=',S+=n(i),S+=" data-htId=",S+=n(d),S+=" data-tid=",S+=n(c),S+='> <a href="javascript:void(0)" >',S+=n(l),S+="</a> <span>",S+=n(p),S+='</span> <a href="javascript:;" class="fr" data-node="secondCom_Key" data-comId="',S+=n(d),S+='" data-replayUser=',S+=n(l),S+=' data-publish="1">回复</a> <p class="clearfix">',S+=u(m),S+="</p> </div> ",h||(S+=" ",f(v,function(a,e){S+=' <div class="comments-s" data-topicType=',S+=n(i),S+=" data-htId=",S+=n(d),S+=" data-tid=",S+=n(c),S+='> <a href="javascript:void(0)" data-replyUserId=',S+=n(a.replyUserId),S+=">",S+=n(a.replyUserName),S+="</a> ",a.replayToPub&&(S+=" ：<span> 回复</span> "),S+=' <a href="javascript:void(0)" data-replyCommentId =',S+=n(a.replyCommentId),S+=">",S+=n(a.beReplyUserName),S+=":</a> <span data-replyCommentId=",S+=n(a.replyCommentId),S+=">",S+=u(a.content),S+='</span> <a href="javascript:;" class="fr" data-getTopicId=',S+=n(d),S+=' data-node="secondCom_Key" data-replayUser=',S+=n(a.replyUserName),S+=' data-publish="0" data-comId="',S+=n(a.parentCommentId),S+='" data-replyCommentId =',S+=n(a.replyCommentId),S+=" data-replyUserId=",S+=n(a.replyUserId),S+=" data-imId=",S+=n(g),S+=">回复</a> </div> "}),S+=" "),S+=" </dd> </dl> "),S+="  ","1"==i&&(S+=' <dl class="li-bor-top bd-bottom"> <dt class="small-user-head"><img src="',S+=n(r),S+='" onerror="imgError(this, \'g\')"></dt> <dd class="reply-content" data-ddList="',S+=n(d),S+='"> <div class="reply-bx" data-topicType=',S+=n(i),S+=" data-htId=",S+=n(d),S+=" data-tid=",S+=n(c),S+='> <div class="head-tex-bx"> <a href="javascript:;" class="head-small">',S+=n(l),S+="</a> <span>",S+=n(p),S+='</span> <a href="javascript:;" class="reply-btn" data-node="secondCom_Key" data-comId="',S+=n(d),S+='" data-replayUser=',S+=n(l),S+=' data-publish="1">回复</a> </div> <p class="p-content">',S+=u(m),S+='</p> </div> <div class="reply-details"> <div class="reply-picture"> <img src="',S+=n(y),S+='" onerror="imgError(this, \'g\')"> </div> <div class="reply-contxt"> <p> ',S+=n(b),S+='</p> <p class="price-numb">￥<span>',S+=n(I),S+='</span></p> </div> <a href="',S+=n(x),S+="product/",S+=n(w),S+="-",S+=n(C),S+='.html" target="_blank" class="see-details pc-btn pc-btnw105 pc-btnh40" data-shopId=',S+=n(w),S+=" data-itemShopId=",S+=n(C),S+=' data-node="checkDetailMsg">查看详情</a> </div> ',h||(S+=" ",f(v,function(a,e){S+=' <div class="comments-s" data-topicType=',S+=n(i),S+=" data-htId=",S+=n(d),S+=" data-tid=",S+=n(c),S+='> <a href="javascript:void(0)" data-replyUserId=',S+=n(a.replyUserId),S+=">",S+=n(a.replyUserName),S+="</a> ",a.replayToPub&&(S+=" <span>：回复</span> "),S+=' <a href="javascript:void(0)" data-replyCommentId =',S+=n(a.replyCommentId),S+=">",S+=n(a.beReplyUserName),S+="</a> <span data-replyCommentId=",S+=n(a.replyCommentId),S+=">：",S+=u(a.content),S+='</span> <a href="javascript:;" class="fr" data-getTopicId=',S+=n(d),S+=' data-node="secondCom_Key" data-replayUser=',S+=n(a.replyUserName),S+=' data-publish="0" data-comId="',S+=n(a.parentCommentId),S+='" data-replyCommentId =',S+=n(a.replyCommentId),S+=" data-replyUserId=",S+=n(a.replyUserId),S+=" data-imId=",S+=n(g),S+=">回复</a> </div> "}),S+=" "),S+=" </dd> </dl> "),S+="  ","2"==i&&(S+=' <dl class="li-bor-top bd-bottom"> <dt class="small-user-head"><img src="',S+=n(r),S+=' " onerror="imgError(this, \'g\')"></dt> <dd class="reply-content" data-ddList="',S+=n(d),S+='"> <div class="reply-bx" data-topicType=',S+=n(i),S+=" data-htId=",S+=n(d),S+=" data-tid=",S+=n(c),S+='> <div class="head-tex-bx"> <a href="javascript:;" class="head-small">',S+=n(l),S+="</a> <span>",S+=n(p),S+='</span> <a href="javascript:;" class="reply-btn" data-node="secondCom_Key" data-comId="',S+=n(d),S+='" data-replayUser=',S+=n(l),S+=' data-publish="1">回复</a> </div> <p class="p-content">',S+=u(m),S+='</p> </div> <div class="reply-details"> <div class="reply-picture"><img src="',S+=n(_),S+='" onerror="imgError(this, \'g\')"></div> <div class="reply-contxt"> <p> ',S+=n(b),S+=" ",k&&(S+=' <span class="topic-label">优惠券</span> '),S+=' </p> </div> <a href="',S+=n(x),S+="shop-",S+=n(C),S+='.html" class="see-details pc-btn pc-btnw105 pc-btnh40" data-shopId=',S+=n(w),S+=" data-itemShopId=",S+=n(C),S+=' data-node="checkDetailMsg">进入店铺</a> </div> ',h||(S+=" ",f(v,function(a,e){S+=' <div class="comments-s" data-topicType=',S+=n(i),S+=" data-htId=",S+=n(d),S+=" data-tid=",S+=n(c),S+='> <a href="javascript:void(0)" data-replyUserId=',S+=n(a.replyUserId),S+=">",S+=n(a.replyUserName),S+="</a> ",a.replayToPub&&(S+=" <span>：回复</span> "),S+=' <a href="javascript:void(0)" data-replyCommentId =',S+=n(a.replyCommentId),S+=">",S+=n(a.beReplyUserName),S+="</a> <span data-replyCommentId=",S+=n(a.replyCommentId),S+=">：",S+=u(a.content),S+='</span> <a href="javascript:;" class="fr" data-getTopicId=',S+=n(d),S+=' data-node="secondCom_Key" data-replayUser=',S+=n(a.replyUserName),S+=' data-publish="0" data-comId="',S+=n(a.parentCommentId),S+='" data-replyCommentId =',S+=n(a.replyCommentId),S+=" data-replyUserId=",S+=n(a.replyUserId),S+=" data-imId=",S+=n(g),S+=">回复</a> </div> "}),S+=" "),S+=" </dd> </dl> "),S+=" ",h||(S+=" ",T&&(S+=' <a href="javascript:;" class="comments-more" data-node="showMoreList" data-groupId=',
S+=n(U),S+=" data-imId=",S+=n(g),S+=" data-topicType=",S+=n(i),S+=" data-htId=",S+=n(d),S+=" data-tid=",S+=n(c),S+=" data-tootlePages=",S+=n(q),S+=" data-currentPage= ",S+=n(P),S+=" data-pageSize=",S+=n(j),S+=">查看回复...</a> "),S+=" "),S+=' <a class="pack-up" style="display: none" data-node="hideComBox" data-parentTopicIdBtn=',S+=n(d),S+='>收起</a> <div class="text-field-box margin-width" style="display: none" data-parentTopicId=',S+=n(d),S+='> <div class="topic-user-head"> ',B&&(S+=' <em class="icon-daren"></em>'),S+=' <img src="',S+=n(L),S+='" onerror="imgError(this, \'g\')"> </div> <div class="topic-publish-content"> <textarea placeholder="说点什么吧…" class="textarea-bx" data-node="textarea-bx"></textarea> <div class="publish-face-bx"> <p class="icon-face" data-node="smilies_Face"><em class="icon">&#Xe95c;</em> 表情</p> <a href="javascript:;" class="pc-btn pc-btnh30 pc-btnw105" data-node="a_secondComBtn" data-getTopicId=',S+=n(d),S+=">发布</a> </div> </div> </div> ",new String(S)})},224:function(a,e,t){var i=t(26);a.exports=i("src/js/page/topicDetails/comment/secondComList",function(a,e){"use strict";var t=this,i=(t.$helpers,t.$escape),n=a.topicType,o=a.backTopicId,s=a.topicId,r=a.replyUserId,d=a.replyUserName,c=a.replayToPub,l=a.replyCommentId,p=a.beReplyUserName,u=t.$string,m=a.content,h=a.parentCommentId,f=a.imId,v="";return v+='<div class="comments-s" data-topicType=',v+=i(n),v+=" data-htId=",v+=i(o),v+=" data-tid=",v+=i(s),v+='> <a href="javascript:void(0)" data-replyUserId="',v+=i(r),v+='">',v+=i(d),v+="</a> ",c&&(v+=' ：<span>回复</span> <a href="javascript:void(0)" data-replyCommentId ="',v+=i(l),v+='">',v+=i(p),v+="</a> "),v+=" <span data-replyCommentId=",v+=i(l),v+=">：",v+=u(m),v+='</span> <a href="javascript:;" class="fr" data-node="secondCom_Key" data-getTopicId=',v+=i(o),v+=" data-replayUser=",v+=i(d),v+=' data-publish="0" data-comId="',v+=i(h),v+='" data-replyCommentId="',v+=i(l),v+='" data-imId="',v+=i(f),v+='" data-replyUserId=',v+=i(r),v+=" >回复</a> </div> ",new String(v)})},225:function(a,e,t){(function($,e){var i=t(121).shareto,n=function(){var a=$("[data-node=wx]"),t=$("[data-node=wb]"),n=$("[data-node=qq]"),o=$("[data-node=qzone]"),s=e.imgpath+"/images/public/down-logo.png",r=function(a){var e=a.closest("ul"),t={url:e.data("surl"),title:e.data("stitle"),pic:e.data("spic")||s,desc:e.data("content")};return t},d=function(a){return function(){var e=r($(this));return i[a](e),u(a),!1}},c="click",l=$GLOBAL_CONFIG,p={wx:"out-weixin",sina:"out-xlwb",qq:"out-QQ",qzone:"out-Qqzone"},u=function(a){BP.send({event_id:"G000P008",group_id:l.groupid,topic_id:l.topicid,circle_type:l.s_c,channel_id:p[a]||""})};a.on(c,function(){return i.weixin({url:e.wap_url+"group/topic?topicId="+l.topicid}),u("wx"),!1}),t.on(c,d("sina")),n.on(c,d("qq")),o.on(c,d("qzone"))};a.exports={init:n}}).call(e,t(1),t(4))},226:function(a,e,t){(function(e,$){var i=t(2),n=t(28),o=t(36),s=t(43),r=t(68),d=function(){window.location.href=e.passport_domain+"login/index"},c=$("[data-node=collect]");c.children("em").hasClass("active")&&c.children("span").html("取消收藏");var l=function(){var a=$("[data-node=collect]");a.on("click",function(){function a(a){i.post(n.get("collectTopic"),a).done(function(a){s(r.comment.enableEditor).pub({pid:"enable"}),a&&200===a.code&&a.success?1===u?(c.data("status",1),c.find("em").addClass("active"),c.find("span").text("取消收藏")):2===u&&(c.data("status",0),c.find("em").removeClass("active"),c.find("span").text("收藏")):a&&422===a.code?d():o(a.message)}).fail(function(){}).always(function(){c.data("firing",0)})}var t=e;window.BP&&BP.send({event_id:"G000P008",group_id:t.groupid,topic_id:t.topicid,circle_type:t.s_c,channel_id:"in-shoucang"});var c=$(this),l=c.data("firing");if(l)return!1;c.data("firing",1);var p=c.data("status"),u=0===p?1:2,m={validate:!0,data:{groupId:$GLOBAL_CONFIG.groupid,topicId:$GLOBAL_CONFIG.topicid,type:u},onLogin:a,refresh:!0};return a(m),!1})};a.exports={init:l}}).call(e,t(4),t(1))},227:function(a,e,t){(function($){var e={init:function(){var a=$("ul.source-lef-list"),e=a.parent(),t=a.height(),i=0;$(window).scroll(function(){var n=e.height()+100,o=e.position().top+220,s=$(this).scrollTop();if(t<n&s>o){var r=$(".wrap-box.ovflow-hid").css("margin-left");r=parseInt(r.substring(0,r.length-2))+20;var d=n-t-100,c=!(s>o+d);c&&a.css({position:"fixed",top:"6px",left:r+"px"});var l=s-i;i=s,l>0&s>o+d&&a.css({position:"absolute",top:d+"px",left:"0px"}),l<0&s<o&&a.css({position:"absolute",top:"6px",left:"0px"})}else a.css({position:"absolute",top:"6px",left:"0px"});i=s})}};a.exports=e}).call(e,t(1))}});
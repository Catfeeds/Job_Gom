webpackJsonp([5],[function(e,t,a){var n=a(92),i=(a(96),a(105)),d=a(107),o=a(108);n.init(),i.init(),o.init(),d.init();var s=a(54);s.setPageData("confirmOrder")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){(function(t,$){var n=a(45),i=a(22),d=a(43),o=a(2),s=a(28),r=a(46),c=a(47),l=(a(48),a(49)),u=(a(41),a(50)),p=a(36);a(52);var f,v,h,m,g,k,b,x,C,y,I=function(){f=this._$("content"),v=f.find("[data-node=name]"),h=f.find("[data-node=nameTip]"),m=f.find("[data-node=idCard]"),g=f.find("[data-node=idCardTip]"),k=f.find("[data-node=addr]"),b=f.find("[data-node=addrTip]"),x=f.find("[data-node=phone]"),x.attr("maxlength",12),C=f.find("[data-node=phoneTip]"),$setDefault=f.find("[data-node=setDefault]"),$areaList=f.find("[data-node=areaList]"),$province=f.find("[data-node=province]"),$city=f.find("[data-node=city]"),$borough=f.find("[data-node=borough]"),y=f.find("[data-node=areaTip]")},w=function(){v.placeholder(),k.placeholder(),x.placeholder()},N=function(e,t,a){var n=r(e),i=!0;return(n>t||n<a)&&(i=!1),i},L=function(){var e=c(v.val());v.val(e);var t=!0;return N(e,20,2)?h.hide():(t=!1,h.show()),t},D=function(){if("1"!=t.isCross)return!0;var e=c(m.val());m.val(e);var a=!0;return/^\d{17}[\dxX]$/.test(e)?g.hide():(a=!1,g.show()),a},T=function(){var e=c(k.val());k.val(e);var t=!0;return N(e,60,5)?b.hide():(t=!1,b.show()),t},P=function(){var e=c(x.val()),t=/^0([0-9]{3,4}-)?[0-9]{10,12}$/,a=/^1[34578][0-9]{9}$/,n=t.test(e)||a.test(e);return n?C.hide():C.show(),n},A=function(){var e=u.getData(),t=!0;return e.provinceId&&e.boroughId&&e.cityId?y.hide():(t=!1,y.show()),t},O=function(){var e=!0;return L()||(e=!1),D()||(e=!1),T()||(e=!1),P()||(e=!1),A()||(e=!1),e},F=function(e,t){var a=c(e.val()),n=r(a);n>t&&e.val(l(a,t))},S=function(){var e=$setDefault.data("checked"),a=m.val()||"",n=18===a.length,i={userName:v.val(),idCard:a.toUpperCase(),address:k.val(),mobile:x.val(),isDefault:e?1:0,isCross:!!parseInt(t.isCross),hasIdCardVal:n},d=u.getData();return d.areaId&&(i.areaId=d.areaId,i.areaName=d.areaName),d.provinceId&&(i.provinceId=d.provinceId,i.provinceName=d.provinceName),d.cityId&&(i.cityId=d.cityId,i.cityName=d.cityName),d.boroughId&&(i.boroughId=d.boroughId,i.boroughName=d.boroughName),i},R=function(){var e=f.find("[data-node=province]"),t=f.find("[data-node=city]"),a=f.find("[data-node=borough]"),n=f.find("[data-node=area]");u.init([e,t,a,n],["选择省","选择市","选择区县","选择街道"],{},[{content:'<span class="menu-add" data-node="checked">选择省</span>',btn:'<span class="down-arrow"><em class="icon icon-down"></em></span>'},{content:'<span class="menu-add" data-node="checked">选择市</span>',btn:'<span class="down-arrow"><em class="icon icon-down"></em></span>'},{content:'<span class="menu-add" data-node="checked">选择区县</span>',btn:'<span class="down-arrow"><em class="icon icon-down"></em></span>'},{content:'<span class="menu-add" style="margin-right:0" data-node="checked">选择街道</span>',btn:'<span class="down-arrow"><em class="icon icon-down"></em></span>'}])},V=function(){v.on("blur",function(e){L()}),v.on("textchange",function(e){var t=$(this),a=t.data("name");t.val()!=a&&""!==a&&m.val("").prop("readonly",!1),F(v,20)}),m.on("blur",function(e){D()}),m.on("contextmenu",function(e){return!1}),m.on("keydown",function(e){var t=e.keyCode;return t>=48&&t<=57||t>=96&&t<=105||88==t||8==t||46==t||t>=37&&t<=40}),m.on("textchange",function(){var e=$(this).val(),t="";/^\d{1,18}$|^\d{17}[xX]$/.test(e)||(t=$.trim(e.substr(0,e.length-1)),$(this).val(t))}),k.on("blur",function(e){T()}),k.on("textchange",function(e){F(k,60)}),x.on("blur",function(){P()}),$setDefault.on("click",function(){var e=$(this),t=e.find("span"),a="menu-radio-checked";return t.hasClass(a)?(e.data("checked",0),t.removeClass(a)):(e.data("checked",1),t.addClass(a)),!1}),$province.on("click","a",function(){A()}),$city.on("click","a",function(){A()}),$borough.on("click","a",function(){A()})},_=function(){v.off(),m.off(),k.off(),x.off(),$setDefault.off(),u.destroy()},j={name:"",phone:"",addr:"",province:"",city:"",borough:"",area:"",setDefault:!0,isCross:!1},G=function(e,a){var r=e.name,c=s.get("addAddress"),l="addr.add",u=e.addressId;u&&(c=s.get("editAddress"),l="addr.edit");var f=n(e||j);a=a||{};var v=!1,h={title:"编辑收货地址",modal:!0,fixed:!0,content:f,className:"pop-box",okValue:"确定",okCls:"pc-btn pc-btnh35 circle-pop-btn",ok:function(){var e=this;if(O()){if(v)return!1;v=!0;var a=S();"0"===t.isCross&&r!=a.userName&&a.idCard&&(a.idCard=""),u&&(a.addressId=u),void 0===a.areaId&&(a.areaId="110114001",a.areaName="全部区域"),o.post(c,{data:a}).done(function(t){var n=$("[data-node=userCardTips]"),i=t.code,o=t.data||{};if(200===i){o.addressId&&(a.addressId=o.addressId),d(l).pub(a);var s=$("[data-node=curAddr]"),r=s.closest("tr");if(s.length){var c=r.find("[data-node=addrInfos]").data("addr").idCard,u=!!$.trim(c);n.length&&u&&(n.remove(),r.find("[data-action=editAddr]").closest("td").removeClass("hide-text"))}e.close(),e.remove()}else p(t.message)}).fail(function(){}).always(function(){v=!1})}return!1},onshow:function(){I.call(this),R.call(this),w(),V()},onclose:function(){_(),v=!1}};$.extend(!0,h,a);var m=i(h);return m.show(),m};e.exports=G}).call(t,a(4),a(1))},function(e,t,a){var n=a(26);e.exports=n("src/js/module/popup/deliveryAddr/content",function(e,t){"use strict";var a=this,n=(a.$helpers,a.$escape),i=e.name,d=e.isCross,o=e.idCard,s=e.hasIdCardVal,r=e.provinceId,c=e.province,l=e.cityId,u=e.city,p=e.boroughId,f=e.borough,v=e.areaId,h=e.area,m=e.addr,g=e.phone,k=e.isDefault,b="";return b+='<div class="edit-add-box"> <dl class="receiver clearfix"> <dt>收货人:</dt> <dd> <input type="text" data-node="name" data-name="',b+=n(i),b+='" placeholder="请输入姓名" value="',b+=n(i),b+='"> </dd> </dl> <p class="warn-txt" data-node="nameTip">收货人姓名为2-20个字符</p> ',d&&(b+=' <dl class="receiver clearfix"> <dt>身份证号:</dt> <dd> <input type="text" data-node="idCard" data-idcard="',b+=n(o),b+='" ',s&&(b+='readonly="true"'),b+=' placeholder="请输入身份证号" value="',b+=n(o),b+='"> </dd> </dl> <p class="warn-txt" data-node="idCardTip">请填写与收货人姓名对应的身份证号码</p> '),b+=' <dl class="area clearfix"> <dt>所在地区:</dt> <dd data-node="areaList"> <div data-node="province" data-provinceId=',b+=n(r),b+=">",b+=n(c),b+='</div> <div data-node="city" data-cityId=',b+=n(l),b+=">",b+=n(u),b+='</div> <div data-node="borough" data-boroughId=',b+=n(p),b+=">",b+=n(f),b+='</div> <div data-node="area" data-areaId=',b+=n(v),b+=">",b+=n(h),b+='</div> </dd> </dl> <p class="warn-txt" data-node="areaTip">请补充地址</p> <dl class="detail-add clearfix"> <dt>详细地址:</dt> <dd> <input type="text" data-node="addr" placeholder="请如实填写详细地址" value="',b+=n(m),b+='"> </dd> </dl> <p class="warn-txt" data-node="addrTip">限制为5-60个字符</p> <dl class="phone clearfix"> <dt>电话/手机:</dt> <dd> <input type="text" data-node="phone" placeholder="请输入电话/手机号" value="',b+=n(g),b+='"> </dd> </dl> <p class="warn-txt" data-node="phoneTip">请输入手机号/电话号码</p> <div class="set-default-add"> <label data-node="setDefault" data-checked="',b+=k===!0?"true":"false",b+='"> <span class="menu-radio ',b+=k===!0?"menu-radio-checked":"''",b+='"></span>设置为默认地址 </label> </div> </div> ',new String(b)})},function(e,t){var a=function(e){return null==e?0:("string"!=typeof e&&(e+=""),e.replace(/[^\x00-\xff]/g,"01").length)};e.exports=a},function(e,t){var a=function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")};e.exports=a},function(e,t){var a={checkVal:function(e,t){return t.test(e)},isMobileNum:function(e){return/^1[34578][0-9]{9}$/.test(e)},isEmail:function(e){return/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/.test(e)},isCertificate:function(e){return/^(\d{15}$|^\d{18}$|^\d{17}(\d|X|x))$/.test(e)},isCID:function(e){return/^(\d{16}|\d{19})$/.test(e)},isCWord:function(e,t,a){var t=!isNaN(t)&&t>0?t:1,a=!isNaN(a)&&a>0?a:"",n=new RegExp("^[\\u4e00-\\u9fa5]{"+t+","+a+"}$");n.test(e);return n.test(e)},isArray:function(e){return Array.isArray(e)||e instanceof Array},passwordReg:function(e){var t=/^((?=.*?\d)(?=.*?[A-Za-z])|(?=.*?\d)(?=.*?[<>《》！\*\(\^\)\$%~!@#\…&%￥—\+=、。，\"\,\:\;；,\.‘’“”：'"\·`【】])|(?=.*?[A-Za-z])(?=.*?[<>《》！\*\(\^\)\$%~!@#\…&%￥—\+=、。，；‘’“”：'"\·`,\.【】]))[\dA-Za-z<>《》！\*\(\^\)\$%~!@#\…&%￥—\+=、。，；‘’“”：'"\·`,\.【】]{6,21}$/;return t.test(e)},checkSpace:function(e){var t=/\s+/;return t.test(e)},checkRefCode:function(e){var t=/^[0-9a-zA-Z]{8}$/;return t.test(e)},checkNickName:function(e){var t=/^([\u4e00-\u9fa5]|[0-9a-zA-Z_-])+$/;return t.test(e)},isMsgCode:function(e){var t=/^\d{6}$/;return t.test(e)}};e.exports=a},function(e,t,a){function n(e){return e>=55296&&e<=56319}function i(e){return e>=56320&&e<=57343}function d(e,t){if("string"!=typeof e)throw new Error("Input must be string");for(var a,d,s=e.length,r=0,c=0;c<s;c+=1){if(a=e.charCodeAt(c),d=e[c],n(a)&&i(e.charCodeAt(c+1))&&(c+=1,d+=e[c]),r+=o(d),r===t)return e.slice(0,c+1);if(r>t)return e.slice(0,c-d.length+1)}return e}var o=a(46);e.exports=d},function(e,t,a){(function($){a(51);var t,n=a(2),i=a(28),d={},o=(a(43),function(e,a,o,s){function r(e,t){if(window.localStorage){var a=JSON.parse(localStorage.getItem("address"+e)),d=null===a||!a.hasOwnProperty("time")||a.time<+new Date;d?n.get(i.get("getAddress")+e,{}).done(function(a){if(200===a.code){t.call(null,a.data);var n={data:a.data,time:+new Date+6048e5};localStorage.removeItem("address"+e),localStorage.setItem("address"+e,JSON.stringify(n))}}).fail(function(e,t){}):t.call(null,a.data)}else n.get(i.get("getAddress")+e,{}).done(function(e){200===e.code&&t.call(null,e.data)}).fail(function(e,t){})}function c(t,n){var i=t;n||(i++,e[t].find("div").children().eq(0).text(d[u[t][1]]));for(var o=i,s=e.length;o<s;o++)void 0!==d[u[o][0]]&&(delete d[u[o][0]],delete d[u[o][1]]),e[o].find("div").children().eq(0).text(l?a:a[o]),o!=i&&e[o].find("ul").html("")}var e=e,l=!1,u=[["provinceId","provinceName"],["cityId","cityName"],["boroughId","boroughName"],["areaId","areaName"]],p={},f=!(s instanceof Array),o=$.extend({},p,o);t=e,"string"==typeof a&&(l=!0);for(var v=0;v<t.length;v++){var h=l?a:a[v];h!==t[v].text()&&(d[u[v][0]]=t[v].attr("data-"+[u[v][0]]),d[u[v][1]]=t[v].text());var m=v-1>=0?t[v-1].attr("data-"+[u[v-1][0]]):0;!function(n){var i=o;i.please=l?a:a[n],i.onChanged=function(i){var o=i.value,s=!1;void 0===o?s=!0:(d[u[n][0]]=i.value,d[u[n][1]]=i.text,n+1<=t.length-1&&r(~~o,function(t){e[n+1].setList({data:t.nodes,please:l?a:a[n+1],textName:"name",valueName:"id"})})),c(n,s)},e[n].selects(f?s:s[n],i),""!==m&&r(m,function(e){t[n].setList({data:e.nodes,please:l?a:a[n],textName:"name",valueName:"id",checked:t[0].find("div").children().eq(0).text()})})}(v)}}),s=function(){for(var e=0,a=t.length;e<a;e++)t[e].off()},r=function(){return d};e.exports={init:o,destroy:s,getData:r}}).call(t,a(1))},function(e,t,a){(function($){$.fn.extend({selects:function(e,t){var a=this,n={content:'<span class="span1">'+$(a).text()+"</span>",btn:'<span class="span2"></span>'},i=$.trim($(a).text()),d={data:[],checked:i,please:"请选择",textName:"text",valueName:"value",selectdCls:"active",checkText:!0,checkedCls:"active",disable:"disable",onChanged:function(){}},e=$.extend({},n,e),t=$.extend({},d,t),o=$("<div></div>").appendTo($(a).empty()).height($(a).height());$content=$(e.content).text(""===i?t.please:i).appendTo(o).attr("data-node","checked"),$btn=$(e.btn).appendTo(o),value=null;for(var s,r,c,l='<ul data-node="selectList"><li><a href="javascript:;">'+t.please+"</a></li>",u=t.parent?$(t.parent):this,p=t.parent?this.selector:void 0,f=0,v=t.data.length;f<v;f++)value=void 0!==t.data[f][t.valueName]?t.data[f][t.valueName]:f,l+='<li class="'+(t.data[f].checked===value?t.checkedCls:"")+'"><a href="javascript:;" data-value="'+value+'" data-index="'+f+'">'+t.data[f][t.textName]+"</a></li>";return l+="</ul>",c=$(l).appendTo($(a)),u.on("click",p,function(e){e.stopPropagation(),$('ul[data-node="selectList"]').hide(),0===t.data.length&&"running"!==$(this).attr("data-refresh")||$(this).hasClass(t.disable)||($(this).addClass(t.selectdCls),0!==$(this).find("ul li").length&&$(this).find("ul").show())}),u.on("click",'ul[data-node="selectList"] a',function(e){return e.stopPropagation(),s=$(this).parents("ul").parent().find('[data-node="checked"]'),s.text()!==$(this).text()&&(r={text:$(this).text()!==t.please?$(this).text():"",value:$(this).attr("data-value"),index:$(this).attr("data-index")},t.checkText&&s.text($(this).text()),void 0!==t.checkedCls&&$(this).parent().addClass(t.checkedCls).siblings().removeClass(t.checkedCls),t.onChanged.call(this,r)),$(this).parents("ul").hide(),!1}),$(document).on("click",function(){a.find("ul").hide()}),this},setList:function(e){$(this).attr("data-refresh","running");var t=this,a={data:[],textName:"text",checked:"",valueName:"value",please:"请选择",checkedCls:"active"},e=$.extend({},a,e),n='<li><a href="javascript:;">'+e.please+"</a></li>";if(0!==e.data.length)for(var i=0,d=e.data.length;i<d;i++)value=void 0!==e.data[i][e.valueName]?e.data[i][e.valueName]:i,n+='<li class="'+(e.checked===e.data[i][e.textName]?e.checkedCls:"")+'"><a href="javascript:;" data-value="'+value+'">'+e.data[i][e.textName]+"</a></li>";return $(t).find('[data-node="selectList"]').html(n),this}})}).call(t,a(1))},function(e,t,a){(function($){var e=document.createElement("input"),t="oninput"in e&&(!("documentMode"in document)||document.documentMode>9),a=function(e){return"INPUT"===e.nodeName&&("text"===e.type||"password"===e.type)},n=null,i=null,d=null,o={get:function(){return d.get.call(this)},set:function(e){i=e,d.set.call(this,e)}},s=function(e){n=e,i=e.value,d=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(n,"value",o),n.attachEvent("onpropertychange",c)},r=function(){n&&(delete n.value,n.detachEvent("onpropertychange",c),n=null,i=null,d=null)},c=function(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==i&&(i=t,$(n).trigger("textchange"))}};t?$(document).on("input",function(e){"TEXTAREA"!==e.target.nodeName&&$(e.target).trigger("textchange")}):$(document).on("focusin",function(e){a(e.target)&&(r(),s(e.target))}).on("focusout",function(){r()}).on("selectionchange keyup keydown",function(){n&&n.value!==i&&(i=n.value,$(n).trigger("textchange"))})}).call(t,a(1))},function(e,t,a){(function($){var t=a(22),n=function(){},i=function(e,a){var i={fixed:!0,modal:!0,content:'<p class="del-pop-p">'+e+"</p>",className:"pop-box",okCls:"pc-btn pc-btnh35 circle-pop-btn",ok:n,cancel:n,btnWrapCls:"two-buttons"};$.extend(!0,i,a);var d=t(i);return d.show(),d};e.exports=i}).call(t,a(1))},,,,,,,,,,,,,function(e,t){var a=function(e,t){function a(e){return e<10?"0"+e:e+""}e=parseInt(e);var n=new Date(e),i=n.getFullYear(),d=n.getMonth()+1,o=n.getDate(),s=n.getHours(),r=n.getMinutes(),c=n.getSeconds(),l={Y:i,y:i.toString().substr(-2),M:a(d),m:d,D:a(o),d:o,H:a(s),h:s,I:a(r),i:r,S:a(c),s:c},u=/([YMDHISymdhis])/g;return t.replace(u,function(e,t){return l[t]})};e.exports=a},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){(function($,t){var n=a(2),i=a(28),d=a(43),o=a(44),s=a(53),r=a(36),c=a(93),l=a(94),u=$("[data-node=addrList]"),p=u.parent(),f=$("[data-action=addAddr]"),v=$("[data-action=expand]"),h=$GLOBAL_CONFIG,m=function(){location.href=window.location.href},g=function(e){e>=20?f.addClass("disabled"):f.removeClass("disabled")},k=function(e){var t=f.data("count"),a=t+e;return f.data("count",a),1===a&&1===e?void m():0===a?void C():(g(a),void(a>5?"展开"===v.find("span").text()&&v.show().click():v.hide()))},b=function(e){var a=$(this).closest("tr"),n=1===a.data("dft"),i=a.find("[data-node=name]").text(),d=a.find("[data-node=phone]").text(),s=a.find("[data-addr]"),r=s.data("addr"),c=(a.find("[data-node=area]").text(),a.data("id")),l=!!parseInt(t.isCross),u=r.idCard||"",p=18===u.length;return o({name:i,idCard:r.idCard,hasIdCardVal:p,addr:r.address,isDefault:n,isCross:l,phone:d,province:r.provinceName,provinceId:r.provinceId,city:r.cityName,cityId:r.cityId,borough:r.boroughName,boroughId:r.boroughId,area:r.areaName,areaId:r.areaId,addressId:c}),!1},x=function(e){var t=$(this).closest("tr");return s("确定删除收货地址吗？",{content:'<p class="pay-pop-p del-pop-p"><em class="icon icon-warn">&#xe960;</em>您确定要删除收货地址吗</p>',title:"删除",okCls:"",ok:function(){n.post(i.get("delAddress"),{data:{addressId:t.data("id")}}).done(function(e){var a=e.code;if(200===a){if(t.find("[data-node=curAddr]").hasClass("name-active"))return $("[data-node=userCardTips]").remove(),void m();t.remove(),k(-1)}else r("删除失败")})}}),!1},C=function(e){var a=!!parseInt(t.isCross);return f.data("count")<20&&o({isCross:a},{title:"新增收货地址"}),!1},y=function(){var e=$(this),t=e.data("firing");if(t)return!1;e.data("firing",1);var a=e.closest("tr");return n.post(i.get("setDefaultAddr"),{data:{addressId:a.data("id")}}).done(function(e){e&&200===e.code?N(a):r("设置失败")}).fail(function(){r("设置失败")}).always(function(){e.data("firing",0)}),!1},I=function(e){var t=e||u.find("[data-dft=1]");t.attr("data-dft",0),t.find("[data-node=dftAddr]").addClass("hide"),t.find("[data-action=setDft]").css("visibility","visible")},w=function(){u.find("[data-node=lightName]").removeClass("name-active")},N=function(e){I(),e.find("[data-node=dftAddr]").removeClass("hide"),e.find("[data-action=setDft]").css("visibility","hidden"),e.attr("data-dft",1),u.find("tr").eq(0).after(e)},L=function(){var e=$(this);if("展开"===e.text())p.height("auto"),e.find("span").text("收起"),e.find("em").addClass("rotate90");else{var t=u.find("tr"),a=t.length;a=a>5?5:a,p.height(t.height()*a+10+"px"),e.find("span").text("展开"),e.find("em").removeClass("rotate90")}return!1},D=function(e,t){t=t||{},s(e,{okValue:t.okValue||"修改配送地址",btnWrapCls:"insert-cancel",ok:t.ok||function(){document.body.scrollIntoView()}})},T=function(){var e=$(this),t=e.data("id"),a=e.children().eq(1).data("addr").provinceId;return w(),e.find("[data-node=lightName]").addClass("name-active"),n.post(i.get("isAddrOk"),{data:{addressId:t,addressProvinceId:a,skuList:JSON.stringify($GLOBAL_CONFIG.skuList),fid:$GLOBAL_CONFIG.fid}}).done(function(e){}).fail(function(){}).always(function(){m()}),!1},P=function(){var e=$("[data-node=curAddr]").closest("tr"),t=e.find("[data-action=editAddr]"),a=e.find("[data-node=addrInfos]").data("addr"),n=null,i="";a&&""===a.idCard&&(t.addClass("active"),t.closest("td").addClass("hide-text"),n=t.offset(),i=l({left:n.left-200,top:n.top-80}),$("body").append($(i)))},A=function(){var e=h.deliverInfo||{},a=h.orderList||[];h.currentAddress||{};200!==e.code?881043===e.code?D(e.message+"，请返回修改",{okValue:"返回修改",ok:function(){window.history.back()}}):D(e.message):u.find("tr").length?a.length||D("您购买的商品中包含无货或已下架商品，请返回修改",{okValue:"返回修改",ok:function(){window.history.back()}}):D("请添加收货地址",{okValue:"新建收货地址",ok:function(){C()}}),1==t.isCross&&P(),g(f.data("count")),f.on("click",C),u.on("click","[data-action=editAddr]",b),u.on("click","[data-action=delAddr]",x),u.on("click","[data-action=setDft]",y),u.on("click","tr[data-id]",T),v.on("click",L),d("addr.edit").sub(function(e){var t=u.find("[data-id="+e.addressId+"]");if(t.find("[data-node=curAddr]").hasClass("name-active"))return void m();var a=e.areaName?e.areaName:"",n=e.provinceName+e.cityName+e.boroughName+a+e.address,i=e.userName;t.find("[data-node=lightName]").text(i),t.find("[data-node=name]").text(i);var d=t.find("[data-addr]");d.data("addr",e);var o=t.find("[data-node=area]");o.text(n),t.find("[data-node=phone]").text(e.mobile),e.isDefault?N(t):I(t)}),d("addr.add").sub(function(e){var t=$("[data-dft=1]"),a=!!t.length,n=e.isDefault,i=e.areaName?e.areaName:"",d=e.provinceName+e.cityName+e.boroughName+i+e.address,o=JSON.stringify(e);e.pcba=d,e.pcbaStr=o;var s="after",r=$(c(e));a?(n&&(I(),s="before"),t.closest("tr")[s](r)):u.find("tr").eq(0)[s](r),k(1)})};e.exports={init:A}}).call(t,a(1),a(4))},function(e,t,a){var n=a(26);e.exports=n("src/js/page/confirmOrder/address/item",function(e,t){"use strict";var a=this,n=(a.$helpers,a.$escape),i=e.addressId,d=e.isDefault,o=e.userName,s=e.pcbaStr,r=e.pcba,c=e.mobile,l="";return l+='<tr data-id="',l+=n(i),l+='" data-dft="',l+=n(d),l+='"> <td width="10%"> <div class="name-box name-no-bor">',l+=n(o),l+='</div> </td> <td width="65%" data-addr="',l+=n(s),l+='"> <span title="',l+=n(o),l+='" class="consignee-name hide" data-node="name">',l+=n(o),l+='</span> <span title="" class="ship-address" data-node="area">',l+=n(r),l+='</span> <span class="phone-numb" data-node="phone">',l+=n(c),l+='</span> </td> <td width="25%" class="text-aglin-r"> <span class="default-address-bj ',1!==d&&(l+="hide"),l+='" data-node="dftAddr">默认地址</span> <a href="javascript:;" data-action="delAddr">删除</a> <a href="javascript:;" data-action="editAddr">编辑</a> <a href="javascript:;" data-action="setDft" ',1===d&&(l+='style="visibility:hidden"'),l+=">设置为默认地址</a> </td> </tr>",new String(l)})},function(e,t,a){(function($){var t=a(95),n=function(e,a){var n=$(t({hasLink:!!a}));n.css(e);var i=$("<div></div>");return i.append(n),i.html()};e.exports=n}).call(t,a(1))},function(e,t,a){var n=a(26);e.exports=n("src/js/module/popup/userCardTips/userCardTips",function(e,t){"use strict";var a=this,n=(a.$helpers,e.hasLink),i="";return i+=n?' <div class="order-edit-box" data-node="editUserCardTips"> <div class="order-edit-text clearfix"><em class="icon">&#xe983;</em><span>订单中含有跨境商品，需点击<br/><a href="javascript:;" data-action="editUserCard">编辑</a>完善身份信息！</span></div> <div class="order-edit-san"></div> </div> ':' <div class="order-edit-box" data-node="userCardTips"> <div class="order-edit-text clearfix"><em class="icon">&#xe983;</em><span>订单中含有跨境商品，需点击编辑完善身份信息！</span></div> <div class="order-edit-san"></div> </div> ',new String(i)})},function(e,t,a){(function($){function e(e){e.sort(function(e,t){return e.endTime/1<t.endTime/1?-1:e.endTime/1==t.endTime/1&&e.money/1<t.money/1?-1:1})}function t(e){$("[data-action=useTickets]").data("coupons",e)}var n=a(97),i=a(98),d=a(22),o=a(43),s=a(68),r=(a(2),a(28),a(99)),c=a(100);a(104)(),a(102)();var l=$GLOBAL_CONFIG.couponList;l.shopList||(l.shopList=[]),l.platRedPackList||(l.platRedPackList=[]),function(){var e=[],t=$("[data-node=shopInfo]"),a=[];$.each(t,function(t,a){e.push($(a).data("shopid"))}),$.each(e,function(e,t){$.each(l.shopList,function(e,n){n.shopId==t&&a.push(l.shopList[e])})}),l.shopList=a}(),e(l.platRedPackList),function(){for(var t=l.shopList,a=0;a<t.length;a++){var n=t[a].redPackList;e(n)}}();var u=!0;(l.shopList.length||l.platRedPackList&&l.platRedPackList.length)&&(u=!1);var p=parseFloat($("[data-node=shippingPrice]").data("shippingprice")),f=parseFloat($("[data-node=goodsTotalPrice]").data("goodstotalprice"));p=isNaN(p)?0:p,f=isNaN(f)?0:f;var v={},h={},m=[],g=[],k=[],b=0,x=0,C=0,y=0;l.platRedPackList&&l.platRedPackList.length&&(v=r(l.platRedPackList,"id"),b=v.money/1);var I=l.shopList;$.each(I,function(e,t){t.redPackList.length&&(h=r(t.redPackList,"id"),x+=h.money/1,k.push(h))}),b>x?(l.platRedPackList&&l.platRedPackList.length&&(l.platRedPackList[v._index_].isFirst=!0,m.push("p-"+v._index_)),l.platShow=!0,l.shopShow=!1,C=b,g.push(v)):($.each(I,function(e,t){t.redPackList.length&&(h=r(t.redPackList,"id"),h.shopId=t.shopId,t.redPackList[h._index_].isFirst=!0,m.push("s-"+e+"-"+h._index_),g.push(h))}),l.platShow=!1,l.shopShow=!0,C=x),t(g);var w=f-C;y=c.initUseCoin(w),c.bindEvents(),o(s.confirmOrder.changeUseTickets).sub(function(e){var t=$("[data-node=ticketsDiscountName]"),a=$("[data-node=ticketsDiscount]"),i=e.ticketsDiscount;return i>0?(t.text("已抵扣："),void a.html("￥"+n(i))):void(u?(t.text("无可用优惠券"),a.html("")):(t.text("最高可抵用："),a.html("￥"+n(C))))}),o(s.confirmOrder.setFinalPrice).sub(function(e){var t=e.ticketsDiscount||0,a=e.gomeCoinDiscount||0,i=p+f-t-a;$("[data-node=useTicketsPrice]").text("￥"+n(t)),$("[data-node=useGomeCoinPrice]").text("￥"+n(a)),$("[data-node=finalPrice]").text(n(i))}),o(s.confirmOrder.changeUseTickets).pub({ticketsDiscount:C,orderDiscountPrice:w,gomeCoinDiscount:y}),o(s.confirmOrder.setGomeCoin).pub({ticketsDiscount:C,orderDiscountPrice:w,gomeCoinDiscount:y}),o(s.confirmOrder.setFinalPrice).pub({ticketsDiscount:C,orderDiscountPrice:w,gomeCoinDiscount:y});var N=function(e,t){e=e||{},t=t||function(){};var a={modal:!0,fixed:!0,content:i(e),className:"pop-box",okValue:"确定",okCls:"pc-btn coupon-btn",ok:t};return d(a).show()},L=function(){var e=$("[data-action=ticketRadio].menu-radio-checked"),a=0,n=[],i=[];$.each(e,function(e,t){a+=$(t).data("discount")/1,n.push($(t).data("index")),i.push($(t).data("info"))}),w=f-a;var d=n.length?n[0].charAt(0):"p";switch(d){case"s":l.platShow=!1,l.shopShow=!0;break;default:l.platShow=!0,l.shopShow=!1}$.each(m,function(e,t){var a=t.split("-");"p"==a[0]?l.platRedPackList[a[1]].isFirst=!1:l.shopList[a[1]].redPackList[a[2]].isFirst=!1}),$.each(n,function(e,t){var a=t.split("-");if("p"==a[0]){var n=l.platRedPackList[a[1]];n.isFirst=!0}else{var i=l.shopList[a[1]].redPackList[a[2]];i.isFirst=!0,i.shopId=l.shopList[a[1]].shopId}}),o(s.confirmOrder.changeUseTickets).pub({ticketsDiscount:a,orderDiscountPrice:w,gomeCoinDiscount:y}),o(s.confirmOrder.setGomeCoin).pub({ticketsDiscount:a,orderDiscountPrice:w,gomeCoinDiscount:y}),t(i),m=n.splice(0)};$("[data-action=useTickets]").on("click",function(){N(l,L),$("[data-node=ticketsMenu]").on("click","a",function(e){var t=$(this).children("em").length,a=$(this).index();e.preventDefault(),$(this).addClass("active").siblings("a").removeClass("active"),t||$(this).append('<em class="up-arrow"></em>').siblings("a").children("em").remove(),$("[data-node=ticketsList] > div").eq(a).show().siblings().hide()})}),$("body").on("click",'[data-action="ticketRadio"]',function(){var e="menu-radio-checked",t="[data-action=ticketRadio]",a=$(this);a.hasClass(e)?a.removeClass(e):(a.addClass(e).parent().parent().siblings().find(t).removeClass(e),a.parents("[data-node=ticketsBox]").siblings("div").find(t).removeClass(e))})}).call(t,a(1))},function(e,t){function a(e){var t=(e/100).toFixed(2);return t="0.00"==t?"0":t}e.exports=a},function(e,t,a){var n=a(26);e.exports=n("src/js/page/confirmOrder/coupon/useTickets",function(e,t){"use strict";var a=this,n=a.$helpers,i=e.platShow,d=e.shopShow,o=e.platRedPackList,s=a.$each,r=(e.pp,e.i,a.$escape),c=e.shopList,l=(e.sp,e.sprl,e.j,"");return l+='  <table class="ui-dialog-grid"> <tbody> <tr> <td class="ui-dialog-header"> <button i="close" title="取消" href="javascript:;" class="icon icon-close">&times;</button> <div data-node="ticketsMenu" class="ui-dialog-title coupon-title"> <a href="javascript:;" ',i&&(l+='class="active"'),l+=">平台优惠券",i&&(l+='<em class="up-arrow"></em>'),l+='</a> <a href="javascript:;" ',d&&(l+='class="active"'),l+=">店铺优惠券",d&&(l+='<em class="up-arrow"></em>'),l+='</a> </div> </td> </tr> <tr> <td data-node="ticketsList" class="ui-dialog-body">  <div data-node="ticketsBox" class="coupon-box" style="',d&&(l+="display: none;"),l+='"> ',o.length?(l+=" ",s(o,function(e,t){l+=' <div class="clearfix"> <label><span data-action="ticketRadio" data-index="p-',l+=r(t),l+='" data-discount="',l+=r(e.money),l+='" data-ticketid="',l+=r(e.id),l+='" data-info=\'{"id":',l+=r(e.id),l+=',"planId":',l+=r(e.planId),l+=',"couponPlat":0}\' class="menu-radio ',e.isFirst&&(l+="menu-radio-checked"),l+='"></span>满',l+=r(n.f2Y(e.baseMoney)),l+="减",l+=r(n.f2Y(e.money)),l+='</label><span class="time">',l+=r(n.dateFormat(e.startTime,"Y.M.D")),l+="-",l+=r(n.dateFormat(e.endTime,"Y.M.D")),l+="</span> </div> "}),l+=" "):l+=' <div class="clearfix"> 没有可用平台优惠券 </div> ',l+=' </div>  <div data-node="ticketsBox" class="coupon-box" style="',i&&(l+="display: none;"),l+='"> ',c.length?(l+=" ",s(c,function(e,t){l+=' <div> <div class="shop"><em class="icon icon-shop">&#xe9df;</em>',l+=r(e.shopName),l+="</div> ",e.redPackList.length&&(l+=" ",s(e.redPackList,function(a,i){l+=' <div class="clearfix"> <label><span data-action="ticketRadio" data-index="s-',l+=r(t),l+="-",l+=r(i),l+='" data-discount="',l+=r(a.money),l+='" data-shopid="',l+=r(e.providerId),l+='" data-ticketid="',l+=r(a.id),l+='" data-info=\'{"id":',l+=r(a.id),l+=',"planId":',l+=r(a.planId),l+=',"couponPlat":0}\' class="menu-radio ',a.isFirst&&(l+="menu-radio-checked"),l+='"></span>满',l+=r(n.f2Y(a.baseMoney)),l+="减",l+=r(n.f2Y(a.money)),l+='</label><span class="time">',l+=r(n.dateFormat(a.startTime,"Y.M.D")),l+="-",l+=r(n.dateFormat(a.endTime,"Y.M.D")),l+="</span> </div> "}),l+=" "),l+=" </div> "}),l+=" "):l+=' <div class="clearfix"> 没有可用店铺优惠券 </div> ',l+=" </div> </td> </tr> </tbody> </table>",new String(l)})},function(e,t){var a=function(e,t){function a(e,t){var a=parseFloat(e.money),n=parseFloat(t.money),i=e.endTime,d=t.endTime;return a===n?i>=d?t:e:a>n?e:t}var n=e.length,i=e[n-1];if(i._index_=n-1,n>1)for(var d=n-2;d>=0;d--){var o=e[d];i=a(i,o),i[t]===o[t]&&(i._index_=d)}return i};e.exports=a},function(e,t,a){(function($){var t=a(101),n=a(22),i=a(43),d=a(68),o=a(97);a(102)();var s=a(103),r=s(),c=(r.length,parseFloat($("[data-node=goodsTotalPrice]").data("goodstotalprice")),$GLOBAL_CONFIG.gomeCoin),l=parseFloat(c.totalRebate),u=parseFloat(c.useableRebate),p=u>=l?l:u;p=p;var f={canUse:0,checked:!1,bindTips:function(e){function t(e){$("[data-node=useGomeCoin]").html(e)}var a=e-100,n="",i=this.checked?"已抵扣":"当前可用";a=a>=p?p:a,a<=0?(this.canUse=0,n="无可用国美币"):(this.canUse=a,n=i+'：<span class="looked-up">￥'+o(a)+"</span>"),t(n)},initUseCoin:function(e){return this.bindTips(e),0},showPop:function(e,a){e=e||{},a=a||function(){};var i={modal:!0,fixed:!0,content:t(e),className:"pop-box",okValue:"确定",okCls:"pc-btn coupon-btn",ok:a};return n(i).show()},bindEvents:function(){var e,t,a=this,n=0,o=0,s=function(e){$("[data-action=useGomeCoin]").data("gomeCoins",e)};i(d.confirmOrder.setGomeCoin).sub(function(n){e=n.ticketsDiscount,t=n.orderDiscountPrice,a.bindTips(t),o=a.canUse,r()});var r=function(){n=a.checked?o:0,s(n),i(d.confirmOrder.setFinalPrice).pub({ticketsDiscount:e,orderDiscountPrice:t,gomeCoinDiscount:n}),i(d.confirmOrder.gomeMoney).pub({gomeMoney:n})},c=function(){$("[data-action=gomeCoinRadio]").hasClass("menu-radio-checked")?(n=$("[data-action=gomeCoinRadio]").data("coin")/1,s(n),a.checked=!0):(n=0,a.checked=!1,s(0)),a.bindTips(t),i(d.confirmOrder.setFinalPrice).pub({ticketsDiscount:e,orderDiscountPrice:t,gomeCoinDiscount:n})};$("[data-action=useGomeCoin]").on("click",function(){if(a.canUse<=0)return!1;var e={checked:a.checked,coinVal:a.canUse};a.showPop(e,c)}),$("body").on("click","[data-action=gomeCoinRadio]",function(){$(this).toggleClass("menu-radio-checked")})}};e.exports=f}).call(t,a(1))},function(e,t,a){var n=a(26);e.exports=n("src/js/page/confirmOrder/gomeCoin/gomeCoin",function(e,t){"use strict";var a=this,n=a.$helpers,i=e.checked,d=a.$escape,o=e.coinVal,s="";return s+='<table class="ui-dialog-grid"> <tbody> <tr> <td class="ui-dialog-header"> <button i="close" title="取消" href="javascript:;" class="icon icon-close">×</button> <div class="ui-dialog-title">国美币</div> </td> </tr> <tr> <td class="ui-dialog-body"> <div class="gome-coin-box clearfix"> <span class="menu-radio ',i&&(s+="menu-radio-checked"),s+='" data-coin="',s+=d(o),s+='" data-action="gomeCoinRadio"></span> <p>使用国美币（当前可用：￥<span class="coinVal">',s+=d(n.f2Y(o)),s+="</span>）</p> </div> </td> </tr> </tbody> </table>",new String(s)})},function(e,t,a){var n=a(26),i=a(97);e.exports=function(){n.helper("f2Y",i)}},function(e,t,a){(function($){var t=function(){var e=$GLOBAL_CONFIG.orderList,t=[];return $.each(e,function(e,a){var n={shopId:a.shopId},i=a.productList,d=0;$.each(i,function(e,t){d+=t.price*t.productNum}),n.totalPrice=d,t.push(n)}),t.sort(function(e,t){return e.totalPrice>t.totalPrice?1:-1}),t};e.exports=t}).call(t,a(1))},function(e,t,a){var n=a(26),i=a(66);e.exports=function(){n.helper("dateFormat",i)}},function(e,t,a){(function($){var t=(a(43),a(68),a(53)),n=a(106),i="hide",d="menu-radio-checked",o="[data-node=invoiceInfo]",s=$("[data-node=invoice]"),r=(s.find("[data-node=invoiceTitle]"),function(e){t("",{fixed:!0,modal:!0,title:"修改发票",content:e,className:"pop-box pop-pad-btm65",okCls:"pc-btn pc-btnh40 pc-btnw120",cancelCls:"queren-btn pc-btnh40 pc-btnw120",ok:c,okValue:"确认修改",btnWrapCls:"two-buttons"})}),c=function(){var e=$("[data-node=invoice]"),t=e.find("[data-node=invoiceType]"),a=e.find("[data-node=invoiceTitle]"),n=e.find("[data-node=invoiceDetail]"),d=a.parent(),s=n.parent(),r=$(o),c=r.data("type"),l=$.trim(r.val()),u=["不开发票","普通发票"],p="明细";
return c?""===l?(r.addClass("input-error").parent().addClass("show-error"),!1):(e.data("t",c),e.data("n",l),t.text(u[1]),a.text(l),n.text(p),d.removeClass(i),void s.removeClass(i)):(e.data("t",c),e.data("n",""),t.text(u[0]),d.addClass(i),s.addClass(i),!0)},l=function(){var e=$("[data-node=noInvoice]"),t=$("[data-node=openInvoice]"),a=$("[data-node=openInvoiceBox]"),n=$("[data-action=clear]"),s=$(o);e.on("click",function(){$(this).find("span").addClass(d),t.find("span").removeClass(d),a.addClass(i),s.data("type",0)}),t.on("click",function(){var t;$(this).find("span").addClass(d),e.find("span").removeClass(d),a.removeClass(i),t=a.find("label > .menu-radio-checked").parent("label").data("type"),s.data("type",t)}),a.on("click","label",function(){$(this).find("span").addClass(d).end().parent().siblings().find("span").removeClass(d),s.data("type",$(this).data("type"))}),s.on("textchange",function(){var e=/[!@#$%^&*+~,.?:;"'！；：、，…。？￥]/g,t=$.trim(this.value),a=t.length;e.test(t)&&(t=t.replace(e,function(e){return""}),this.value=t),a>50&&(t=t.substring(0,50),this.value=t),a>0?n.show():n.hide()}),n.on("click",function(){n.hide(),s.val("").focus()}),s.on("focus",function(){var e=$.trim($(this).val());$(this).removeClass("input-error").parent().removeClass("show-error"),""!==e&&n.show()})},u=function(){var e=$("[data-node=invoice]"),t=e.find("[data-action=updateInvoice]");t.on("click",function(){var t=e.data("t"),a=e.data("n"),i=n({type:t,title:a});return r(i),l(),!1})};e.exports={init:u}}).call(t,a(1))},function(e,t,a){var n=a(26);e.exports=n("src/js/page/confirmOrder/invoice/invoice",function(e,t){"use strict";var a=this,n=(a.$helpers,e.type),i=a.$escape,d=e.title,o="";return o+='<div class="ui-body-box"> <div class="invoice-box"> <h3 class="radio-title">发票类型：</h3> <div class="invoice-flot-lft"> <label data-node="noInvoice" data-type="0"><span class="menu-radio ',0==n&&(o+="menu-radio-checked"),o+='"></span>不开票</label> </div> <div class="invoice-flot-lft"> <label data-node="openInvoice"><span class="menu-radio ',n>0&&(o+="menu-radio-checked"),o+='"></span>普通发票</label> </div> </div> <div data-node="openInvoiceBox" class="',0==n&&(o+="hide"),o+='"> <div class="invoice-box"> <h3 class="radio-title">发票抬头：</h3> <div class="invoice-flot-lft"> <label data-type="1"><span class="menu-radio ',n<2&&(o+="menu-radio-checked"),o+='"></span>个人</label> </div> <div class="invoice-flot-lft"> <label data-type="2"><span class="menu-radio ',2==n&&(o+="menu-radio-checked"),o+='"></span>单位</label> </div> </div> <div class="please-enter"><em data-action="clear" class="icon close">&#xea5a;</em> <input data-node="invoiceInfo" data-type="',o+=i(n),o+='" type="text" value="',o+=i(d),o+='" placeholder="请输入发票抬头" class="input-error"> <p class="error"><em class="icon">&#xe961;</em>请输入发票抬头信息</p> </div> <p class="invoice-content">发票内容：由供应商自行确定发票内容</p> </div> </div>',new String(o)})},function(e,t,a){(function($){function t(){var e=30,t=$("[data-node=buyerMsg]");t.on("textchange",function(t){var a=$(this),n=$.trim(a.val()),i=n.length;i>e&&a.val(n.substr(0,e))})}a(52),e.exports={init:t}}).call(t,a(1))},function(e,t,a){(function($,t){var n=a(2),i=a(28),d=a(43),o=a(68),s=a(53),r=a(94),c=$("[data-action=submitOrder]"),l=$GLOBAL_CONFIG,u=function(){var e=$("[data-node=invoice]"),t=e.data("t"),a=e.data("n");return t>0?{hasInvoice:1,invoice:{type:1,titleType:t,title:a,content:"明细"}}:{hasInvoice:0,invoice:{}}},p=function(){function e(e){var t=[];return $.each(e,function(e,a){var n={id:a.id,planId:a.planId,couponPlat:0};t.push(n)}),t}var a=l.orderList,n=$("[data-action=useTickets]").data("coupons"),i=$("[data-action=useGomeCoin]").data("gomeCoins")||0,d=$("[data-node=buyerMsg]").val(),o=u();return n=e(n),{addressId:l.currentAddress.id,payType:4,delivery:{receivingTimeType:1,needConfirmation:!0,memo:d},hasInvoice:o.hasInvoice,invoice:o.invoice,coupons:n,gomeMoney:i,orders:a,accoss:t.isCross}},f=function(){var e=c.offset(),t=r({left:e.left-120,top:e.top-80},!0);$tips=$(t),$("body").append($tips),setTimeout(function(){$tips.remove()},6e3),$tips.on("click","a",function(){$tips.remove(),$("body, html").scrollTop(0),$("[data-node=curAddr]").parents("tr").find("[data-action=editAddr]").click()})},v=!1,h=function(){if(!v){v=!0,c.addClass("btn-default");var e=p(),a=l.fid;return n.post(i.get("submitOrder")+"?fid="+a,{data:{proJson:JSON.stringify(e)}}).done(function(e){if(e&&e.success===!0)location.href=t.order_domain+"order/paydetail?fid="+a;else{var n=e.message,i=e.code,d=/\[881064\]/,o=/\[881043\]/,r=n.substring(0,n.indexOf("错误码[")-1);if("100030"==i)return f(),!1;if("881011"==i)return location.href=t.passport_domain+"/login/index",!1;if(d.test(n))return s(r,{autofocus:!1,okValue:"修改配送地址",ok:function(){$(document).scrollTop(0),v=!1,c.removeClass("btn-default")},okCls:"red",cancelValue:"取消"}),!1;if(o.test(n))return s(r,{autofocus:!1,okValue:"返回修改",ok:function(){window.history.back()},okCls:"red",cancelValue:"取消"}),!1;s(n,{okValue:"返回修改",ok:function(){window.history.back()},okCls:"red",cancelValue:"取消"})}}).fail(function(){}).always(function(){v=!1,c.removeClass("btn-default")}),!1}},m=function(){d(o.confirmOrder.invoice).sub(function(e){"company"===e.type?invoiceTitle=2:invoiceTitle=1,invoiceContent=e.value,hasInvoice=1,invoiceData={type:1,titleType:invoiceTitle,title:invoiceContent,content:"明细"}}),l.deliverInfo.success===!0&&l.orderList.length?c.on("click",h):c.addClass("btn-default")};e.exports={init:m}}).call(t,a(1),a(4))}]);
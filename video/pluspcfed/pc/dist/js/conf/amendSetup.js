webpackJsonp([42],{"12":function(e,exports,t){(function(i){var r,n,a;!function(s,o){var l={},u=function(e,t){var i,r,n;if("string"==typeof e)return f(e);for(i=[],r=e.length,n=0;n<r;n++)i.push(f(e[n]));return t.apply(null,i)},c=function(e,t,i){2===arguments.length&&(i=t,t=null),u(t||[],function(){d(e,i,arguments)})},d=function(e,t,r){var n,a={"exports":t};"function"==typeof t&&(r.length||(r=[u,a.exports,a,i]),void 0!==(n=t.apply(null,r))&&(a.exports=n)),l[e]=a.exports},f=function(e){var t=l[e]||s[e];if(!t)throw new Error("`"+e+"` is undefined");return t},h=function(e){var t,i,r,n,a,s;s=function(e){return e&&e.charAt(0).toUpperCase()+e.substr(1)};for(t in l)if(i=e,l.hasOwnProperty(t)){for(r=t.split("/"),a=s(r.pop());n=s(r.shift());)i[n]=i[n]||{},i=i[n];i[a]=l[t]}return e},p=function(e){return s.__dollar=e,h(o(s,c,u,i))};"object"==typeof e&&"object"==typeof e.exports?e.exports=p():(n=[t(0)],r=p,void 0!==(a="function"==typeof r?r.apply(exports,n):r)&&(e.exports=a))}(window,function(e,t,require,i){return t("dollar-third",[],function(){var $=e.__dollar||e.jQuery||e.Zepto||i;if(!$)throw new Error("jQuery or Zepto not found!");return $}),t("dollar",["dollar-third"],function(e){return e}),t("promise-third",["dollar"],function($){return{"Deferred":$.Deferred,"when":$.when,"isPromise":function(e){return e&&"function"==typeof e.then}}}),t("promise",["promise-third"],function(e){return e}),t("base",["dollar","promise"],function($,t){function i(e,t){return function(){return e.apply(t,arguments)}}function r(e){var t;return Object.create?Object.create(e):(t=function(){},t.prototype=e,new t)}var n=function(){},a=Function.call;return{"version":"0.1.5","$":$,"Deferred":t.Deferred,"isPromise":t.isPromise,"when":t.when,"browser":function(e){var t={},i=e.match(/WebKit\/([\d.]+)/),r=e.match(/Chrome\/([\d.]+)/)||e.match(/CriOS\/([\d.]+)/),n=e.match(/MSIE\s([\d\.]+)/)||e.match(/(?:trident)(?:.*rv:([\w.]+))?/i),a=e.match(/Firefox\/([\d.]+)/),s=e.match(/Safari\/([\d.]+)/),o=e.match(/OPR\/([\d.]+)/);return i&&(t.webkit=parseFloat(i[1])),r&&(t.chrome=parseFloat(r[1])),n&&(t.ie=parseFloat(n[1])),a&&(t.firefox=parseFloat(a[1])),s&&(t.safari=parseFloat(s[1])),o&&(t.opera=parseFloat(o[1])),t}(navigator.userAgent),"os":function(e){var t={},i=e.match(/(?:Android);?[\s\/]+([\d.]+)?/),r=e.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);return i&&(t.android=parseFloat(i[1])),r&&(t.ios=parseFloat(r[1].replace(/_/g,"."))),t}(navigator.userAgent),"inherits":function(e,t,i){var n;return"function"==typeof t?(n=t,t=null):n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},$.extend(!0,n,e,i||{}),n.__super__=e.prototype,n.prototype=r(e.prototype),t&&$.extend(!0,n.prototype,t),n},"noop":n,"bindFn":i,"log":function(){return e.console?i(console.log,console):n}(),"nextTick":function(){return function(e){setTimeout(e,1)}}(),"slice":function(e){return function(){return a.apply(e,arguments)}}([].slice),"guid":function(){var e=0;return function(t){for(var i=(+new Date).toString(32),r=0;r<5;r++)i+=Math.floor(65535*Math.random()).toString(32);return(t||"wu_")+i+(e++).toString(32)}}(),"formatSize":function(e,t,i){var r;for(i=i||["B","K","M","G","TB"];(r=i.shift())&&e>1024;)e/=1024;return("B"===r?e:e.toFixed(t||2))+r}}}),t("mediator",["base"],function(e){function t(e,t,i,r){return $.grep(e,function(e){return e&&(!t||e.e===t)&&(!i||e.cb===i||e.cb._cb===i)&&(!r||e.ctx===r)})}function i(e,t,i){$.each((e||"").split(s),function(e,r){i(r,t)})}function r(e,t){for(var i,r=!1,n=-1,a=e.length;++n<a;)if(i=e[n],!1===i.cb.apply(i.ctx2,t)){r=!0;break}return!r}var n,$=e.$,a=[].slice,s=/\s+/;return n={"on":function(e,t,r){var n,a=this;return t?(n=this._events||(this._events=[]),i(e,t,function(e,t){var i={"e":e};i.cb=t,i.ctx=r,i.ctx2=r||a,i.id=n.length,n.push(i)}),this):this},"once":function(e,t,r){var n=this;return t?(i(e,t,function(e,t){var i=function(){return n.off(e,i),t.apply(r||n,arguments)};i._cb=t,n.on(e,i,r)}),n):n},"off":function(e,r,n){var a=this._events;return a?e||r||n?(i(e,r,function(e,i){$.each(t(a,e,i,n),function(){delete a[this.id]})}),this):(this._events=[],this):this},"trigger":function(e){var i,n,s;return this._events&&e?(i=a.call(arguments,1),n=t(this._events,e),s=t(this._events,"all"),r(n,i)&&r(s,arguments)):this}},$.extend({"installTo":function(e){return $.extend(e,n)}},n)}),t("uploader",["base","mediator"],function(e,t){function i(e){this.options=$.extend(!0,{},i.options,e),this._init(this.options)}var $=e.$;return i.options={},t.installTo(i.prototype),$.each({"upload":"start-upload","stop":"stop-upload","getFile":"get-file","getFiles":"get-files","addFile":"add-file","addFiles":"add-file","sort":"sort-files","removeFile":"remove-file","cancelFile":"cancel-file","skipFile":"skip-file","retry":"retry","isInProgress":"is-in-progress","makeThumb":"make-thumb","md5File":"md5-file","getDimension":"get-dimension","addButton":"add-btn","predictRuntimeType":"predict-runtime-type","refresh":"refresh","disable":"disable","enable":"enable","reset":"reset"},function(e,t){i.prototype[e]=function(){return this.request(t,arguments)}}),$.extend(i.prototype,{"state":"pending","_init":function(e){var t=this;t.request("init",e,function(){t.state="ready",t.trigger("ready")})},"option":function(e,t){var i=this.options;if(!(arguments.length>1))return e?i[e]:i;$.isPlainObject(t)&&$.isPlainObject(i[e])?$.extend(i[e],t):i[e]=t},"getStats":function(){var e=this.request("get-stats");return e?{"successNum":e.numOfSuccess,"progressNum":e.numOfProgress,"cancelNum":e.numOfCancel,"invalidNum":e.numOfInvalid,"uploadFailNum":e.numOfUploadFailed,"queueNum":e.numOfQueue,"interruptNum":e.numofInterrupt}:{}},"trigger":function(e){var i=[].slice.call(arguments,1),r=this.options,n="on"+e.substring(0,1).toUpperCase()+e.substring(1);return!(!1===t.trigger.apply(this,arguments)||$.isFunction(r[n])&&!1===r[n].apply(this,i)||$.isFunction(this[n])&&!1===this[n].apply(this,i)||!1===t.trigger.apply(t,[this,e].concat(i)))},"destroy":function(){this.request("destroy",arguments),this.off()},"request":e.noop}),e.create=i.create=function(e){return new i(e)},e.Uploader=i,i}),t("runtime/runtime",["base","mediator"],function(e,t){function i(t){this.options=$.extend({"container":document.body},t),this.uid=e.guid("rt_")}var $=e.$,r={},n=function(e){for(var t in e)if(e.hasOwnProperty(t))return t;return null};return $.extend(i.prototype,{"getContainer":function(){var e,t,i=this.options;return this._container?this._container:(e=$(i.container||document.body),t=$(document.createElement("div")),t.attr("id","rt_"+this.uid),t.css({"position":"absolute","top":"0px","left":"0px","width":"1px","height":"1px","overflow":"hidden"}),e.append(t),e.addClass("webuploader-container"),this._container=t,this._parent=e,t)},"init":e.noop,"exec":e.noop,"destroy":function(){this._container&&this._container.remove(),this._parent&&this._parent.removeClass("webuploader-container"),this.off()}}),i.orders="html5,flash",i.addRuntime=function(e,t){r[e]=t},i.hasRuntime=function(e){return!!(e?r[e]:n(r))},i.create=function(e,t){var a;if(t=t||i.orders,$.each(t.split(/\s*,\s*/g),function(){if(r[this])return a=this,!1}),!(a=a||n(r)))throw new Error("Runtime Error");return new r[a](e)},t.installTo(i.prototype),i}),t("runtime/client",["base","mediator","runtime/runtime"],function(e,t,i){function r(t,r){var a,s=e.Deferred();this.uid=e.guid("client_"),this.runtimeReady=function(e){return s.done(e)},this.connectRuntime=function(t,o){if(a)throw new Error("already connected!");return s.done(o),"string"==typeof t&&n.get(t)&&(a=n.get(t)),a=a||n.get(null,r),a?(e.$.extend(a.options,t),a.__promise.then(s.resolve),a.__client++):(a=i.create(t,t.runtimeOrder),a.__promise=s.promise(),a.once("ready",s.resolve),a.init(),n.add(a),a.__client=1),r&&(a.__standalone=r),a},this.getRuntime=function(){return a},this.disconnectRuntime=function(){a&&(a.__client--,a.__client<=0&&(n.remove(a),delete a.__promise,a.destroy()),a=null)},this.exec=function(){if(a){var i=e.slice(arguments);return t&&i.unshift(t),a.exec.apply(this,i)}},this.getRuid=function(){return a&&a.uid},this.destroy=function(e){return function(){e&&e.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()}}(this.destroy)}var n;return n=function(){var e={};return{"add":function(t){e[t.uid]=t},"get":function(t,i){var r;if(t)return e[t];for(r in e)if(!i||!e[r].__standalone)return e[r];return null},"remove":function(t){delete e[t.uid]}}}(),t.installTo(r.prototype),r}),t("lib/dnd",["base","mediator","runtime/client"],function(e,t,i){function r(e){e=this.options=$.extend({},r.options,e),e.container=$(e.container),e.container.length&&i.call(this,"DragAndDrop")}var $=e.$;return r.options={"accept":null,"disableGlobalDnd":!1},e.inherits(i,{"constructor":r,"init":function(){var e=this;e.connectRuntime(e.options,function(){e.exec("init"),e.trigger("ready")})}}),t.installTo(r.prototype),r}),t("widgets/widget",["base","uploader"],function(e,t){function i(e){if(!e)return!1;var t=e.length,i=$.type(e);return!(1!==e.nodeType||!t)||("array"===i||"function"!==i&&"string"!==i&&(0===t||"number"==typeof t&&t>0&&t-1 in e))}function r(e){this.owner=e,this.options=e.options}var $=e.$,n=t.prototype._init,a=t.prototype.destroy,s={},o=[];return $.extend(r.prototype,{"init":e.noop,"invoke":function(e,t){var i=this.responseMap;return i&&e in i&&i[e]in this&&$.isFunction(this[i[e]])?this[i[e]].apply(this,t):s},"request":function(){return this.owner.request.apply(this.owner,arguments)}}),$.extend(t.prototype,{"_init":function(){var e=this,t=e._widgets=[],i=e.options.disableWidgets||"";return $.each(o,function(r,n){(!i||!~i.indexOf(n._name))&&t.push(new n(e))}),n.apply(e,arguments)},"request":function(t,r,n){var a,o,l,u,c=0,d=this._widgets,f=d&&d.length,h=[],p=[];for(r=i(r)?r:[r];c<f;c++)a=d[c],(o=a.invoke(t,r))!==s&&(e.isPromise(o)?p.push(o):h.push(o));return n||p.length?(l=e.when.apply(e,p),u=l.pipe?"pipe":"then",l[u](function(){var t=e.Deferred(),i=arguments;return 1===i.length&&(i=i[0]),setTimeout(function(){t.resolve(i)},1),t.promise()})[n?u:"done"](n||e.noop)):h[0]},"destroy":function(){a.apply(this,arguments),this._widgets=null}}),t.register=r.register=function(t,i){var n,a={"init":"init","destroy":"destroy","name":"anonymous"};return 1===arguments.length?(i=t,$.each(i,function(e){if("_"===e[0]||"name"===e)return void("name"===e&&(a.name=i.name));a[e.replace(/[A-Z]/g,"-$&").toLowerCase()]=e})):a=$.extend(a,t),i.responseMap=a,n=e.inherits(r,i),n._name=a.name,o.push(n),n},t.unRegister=r.unRegister=function(e){if(e&&"anonymous"!==e)for(var t=o.length;t--;)o[t]._name===e&&o.splice(t,1)},r}),t("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(e,t,i){var $=e.$;return t.options.dnd="",t.register({"name":"dnd","init":function(t){if(t.dnd&&"html5"===this.request("predict-runtime-type")){var r,n=this,a=e.Deferred(),s=$.extend({},{"disableGlobalDnd":t.disableGlobalDnd,"container":t.dnd,"accept":t.accept});return this.dnd=r=new i(s),r.once("ready",a.resolve),r.on("drop",function(e){n.request("add-file",[e])}),r.on("accept",function(e){return n.owner.trigger("dndAccept",e)}),r.init(),a.promise()}},"destroy":function(){this.dnd&&this.dnd.destroy()}})}),t("lib/filepaste",["base","mediator","runtime/client"],function(e,t,i){function r(e){e=this.options=$.extend({},e),e.container=$(e.container||document.body),i.call(this,"FilePaste")}var $=e.$;return e.inherits(i,{"constructor":r,"init":function(){var e=this;e.connectRuntime(e.options,function(){e.exec("init"),e.trigger("ready")})}}),t.installTo(r.prototype),r}),t("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(e,t,i){var $=e.$;return t.register({"name":"paste","init":function(t){if(t.paste&&"html5"===this.request("predict-runtime-type")){var r,n=this,a=e.Deferred(),s=$.extend({},{"container":t.paste,"accept":t.accept});return this.paste=r=new i(s),r.once("ready",a.resolve),r.on("paste",function(e){n.owner.request("add-file",[e])}),r.init(),a.promise()}},"destroy":function(){this.paste&&this.paste.destroy()}})}),t("lib/blob",["base","runtime/client"],function(e,t){function i(e,i){var r=this;r.source=i,r.ruid=e,this.size=i.size||0,!i.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)?this.type="image/"+("jpg"===this.ext?"jpeg":this.ext):this.type=i.type||"application/octet-stream",t.call(r,"Blob"),this.uid=i.uid||this.uid,e&&r.connectRuntime(e)}return e.inherits(t,{"constructor":i,"slice":function(e,t){return this.exec("slice",e,t)},"getSource":function(){return this.source}}),i}),t("lib/file",["base","lib/blob"],function(e,t){function i(e,i){var a;this.name=i.name||"untitled"+r++,a=n.exec(i.name)?RegExp.$1.toLowerCase():"",!a&&i.type&&(a=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(i.type)?RegExp.$1.toLowerCase():"",this.name+="."+a),this.ext=a,this.lastModifiedDate=i.lastModifiedDate||(new Date).toLocaleString(),t.apply(this,arguments)}var r=1,n=/\.([^.]+)$/;return e.inherits(t,i)}),t("lib/filepicker",["base","runtime/client","lib/file"],function(t,i,r){function n(e){if(e=this.options=$.extend({},n.options,e),e.container=$(e.id),!e.container.length)throw new Error("按钮指定错误");e.innerHTML=e.innerHTML||e.label||e.container.html()||"",e.button=$(e.button||document.createElement("div")),e.button.html(e.innerHTML),e.container.html(e.button),i.call(this,"FilePicker",!0)}var $=t.$;return n.options={"button":null,"container":null,"label":null,"innerHTML":null,"multiple":!0,"accept":null,"name":"file"},t.inherits(i,{"constructor":n,"init":function(){var i=this,n=i.options,a=n.button;a.addClass("webuploader-pick"),i.on("all",function(e){var t;switch(e){case"mouseenter":a.addClass("webuploader-pick-hover");break;case"mouseleave":a.removeClass("webuploader-pick-hover");break;case"change":t=i.exec("getFiles"),i.trigger("select",$.map(t,function(e){return e=new r(i.getRuid(),e),e._refer=n.container,e}),n.container)}}),i.connectRuntime(n,function(){i.refresh(),i.exec("init",n),i.trigger("ready")}),this._resizeHandler=t.bindFn(this.refresh,this),$(e).on("resize",this._resizeHandler)},"refresh":function(){var e=this.getRuntime().getContainer(),t=this.options.button,i=t.outerWidth?t.outerWidth():t.width(),r=t.outerHeight?t.outerHeight():t.height(),n=t.offset();i&&r&&e.css({"bottom":"auto","right":"auto","width":i+"px","height":r+"px"}).offset(n)},"enable":function(){this.options.button.removeClass("webuploader-pick-disable"),this.refresh()},"disable":function(){var e=this.options.button;this.getRuntime().getContainer().css({"top":"-99999px"}),e.addClass("webuploader-pick-disable")},"destroy":function(){var t=this.options.button;$(e).off("resize",this._resizeHandler),t.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}}),n}),t("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(e,t,i){var $=e.$;return $.extend(t.options,{"pick":null,"accept":null}),t.register({"name":"picker","init":function(e){return this.pickers=[],e.pick&&this.addBtn(e.pick)},"refresh":function(){$.each(this.pickers,function(){this.refresh()})},"addBtn":function(t){var r=this,n=r.options,a=n.accept,s=[];if(t)return $.isPlainObject(t)||(t={"id":t}),$(t.id).each(function(){var o,l,u;u=e.Deferred(),o=$.extend({},t,{"accept":$.isPlainObject(a)?[a]:a,"swf":n.swf,"runtimeOrder":n.runtimeOrder,"id":this}),l=new i(o),l.once("ready",u.resolve),l.on("select",function(e){r.owner.request("add-file",[e])}),l.init(),r.pickers.push(l),s.push(u.promise())}),e.when.apply(e,s)},"disable":function(){$.each(this.pickers,function(){this.disable()})},"enable":function(){$.each(this.pickers,function(){this.enable()})},"destroy":function(){$.each(this.pickers,function(){this.destroy()}),this.pickers=null}})}),t("lib/image",["base","runtime/client","lib/blob"],function(e,t,i){function r(e){this.options=$.extend({},r.options,e),t.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}var $=e.$;return r.options={"quality":90,"crop":!1,"preserveHeaders":!1,"allowMagnify":!1},e.inherits(t,{"constructor":r,"info":function(e){return e?(this._info=e,this):this._info},"meta":function(e){return e?(this._meta=e,this):this._meta},"loadFromBlob":function(e){var t=this,i=e.getRuid();this.connectRuntime(i,function(){t.exec("init",t.options),t.exec("loadFromBlob",e)})},"resize":function(){var t=e.slice(arguments);return this.exec.apply(this,["resize"].concat(t))},"crop":function(){var t=e.slice(arguments);return this.exec.apply(this,["crop"].concat(t))},"getAsDataUrl":function(e){return this.exec("getAsDataUrl",e)},"getAsBlob":function(e){var t=this.exec("getAsBlob",e);return new i(this.getRuid(),t)}}),r}),t("widgets/image",["base","uploader","lib/image","widgets/widget"],function(e,t,i){var r,$=e.$;return r=function(e){var t=0,i=[],r=function(){for(var e;i.length&&t<5242880;)e=i.shift(),t+=e[0],e[1]()};return function(e,n,a){i.push([n,a]),e.once("destroy",function(){t-=n,setTimeout(r,1)}),setTimeout(r,1)}}(),$.extend(t.options,{"thumb":{"width":110,"height":110,"quality":70,"allowMagnify":!0,"crop":!0,"preserveHeaders":!1,"type":"image/jpeg"},"compress":{"width":1600,"height":1600,"quality":90,"allowMagnify":!1,"crop":!1,"preserveHeaders":!0}}),t.register({"name":"image","makeThumb":function(e,t,n,a){var s,o,l=!1;if(e=this.request("get-file",e),!e.type.match(/^image/))return void t(!0);s=$.extend({},this.options.thumb),l=!$.isPlainObject(this.options.thumb),$.isPlainObject(n)&&(s=$.extend(s,n),n=null),n=n||s.width,a=a||s.height,o=new i(s),o.once("load",function(){e._info=e._info||o.info(),e._meta=e._meta||o.meta(),n<=1&&n>0&&(n=e._info.width*n),a<=1&&a>0&&(a=e._info.height*a),l?o.resize(e._info.width,e._info.height):o.resize(n,a)}),o.once("complete",function(){t(!1,o.getAsDataUrl(s.type)),o.destroy()}),o.once("error",function(e){t(e||!0),o.destroy()}),r(o,e.source.size,function(){e._info&&o.info(e._info),e._meta&&o.meta(e._meta),o.loadFromBlob(e.source)})},"beforeSendFile":function(t){var r,n,a=this.options.compress||this.options.resize,s=a&&a.compressSize||0,o=a&&a.noCompressIfLarger||!1;if(t=this.request("get-file",t),a&&~"image/jpeg,image/jpg".indexOf(t.type)&&!(t.size<s)&&!t._compressed)return a=$.extend({},a),n=e.Deferred(),r=new i(a),n.always(function(){r.destroy(),r=null}),r.once("error",n.reject),r.once("load",function(){var e=a.width,i=a.height;t._info=t._info||r.info(),t._meta=t._meta||r.meta(),e<=1&&e>0&&(e=t._info.width*e),i<=1&&i>0&&(i=t._info.height*i),r.resize(e,i)}),r.once("complete",function(){var e,i;try{e=r.getAsBlob(a.type),i=t.size,(!o||e.size<i)&&(t.source=e,t.size=e.size,t.trigger("resize",e.size,i)),t._compressed=!0,n.resolve()}catch(e){n.resolve()}}),t._info&&r.info(t._info),t._meta&&r.meta(t._meta),r.loadFromBlob(t.source),n.promise()}})}),t("file",["base","mediator"],function(e,t){function i(){return n+a++}function r(e){this.name=e.name||"Untitled",this.size=e.size||0,this.type=e.type||"application/octet-stream",this.lastModifiedDate=e.lastModifiedDate||1*new Date,this.id=i(),this.ext=s.exec(this.name)?RegExp.$1:"",this.statusText="",o[this.id]=r.Status.INITED,this.source=e,this.loaded=0,this.on("error",function(e){this.setStatus(r.Status.ERROR,e)})}var $=e.$,n="WU_FILE_",a=0,s=/\.([^.]+)$/,o={};return $.extend(r.prototype,{"setStatus":function(e,t){var i=o[this.id];void 0!==t&&(this.statusText=t),e!==i&&(o[this.id]=e,this.trigger("statuschange",e,i))},"getStatus":function(){return o[this.id]},"getSource":function(){return this.source},"destroy":function(){this.off(),delete o[this.id]}}),t.installTo(r.prototype),r.Status={"INITED":"inited","QUEUED":"queued","PROGRESS":"progress","ERROR":"error","COMPLETE":"complete","CANCELLED":"cancelled","INTERRUPT":"interrupt","INVALID":"invalid"},r}),t("queue",["base","mediator","file"],function(e,t,i){function r(){this.stats={"numOfQueue":0,"numOfSuccess":0,"numOfCancel":0,"numOfProgress":0,"numOfUploadFailed":0,"numOfInvalid":0,"numofDeleted":0,"numofInterrupt":0},this._queue=[],this._map={}}var $=e.$,n=i.Status;return $.extend(r.prototype,{"append":function(e){return this._queue.push(e),this._fileAdded(e),this},"prepend":function(e){return this._queue.unshift(e),this._fileAdded(e),this},"getFile":function(e){return"string"!=typeof e?e:this._map[e]},"fetch":function(e){var t,i,r=this._queue.length;for(e=e||n.QUEUED,t=0;t<r;t++)if(i=this._queue[t],e===i.getStatus())return i;return null},"sort":function(e){"function"==typeof e&&this._queue.sort(e)},"getFiles":function(){for(var e,t=[].slice.call(arguments,0),i=[],r=0,n=this._queue.length;r<n;r++)e=this._queue[r],t.length&&!~$.inArray(e.getStatus(),t)||i.push(e);return i},"removeFile":function(e){this._map[e.id]&&(delete this._map[e.id],e.destroy(),this.stats.numofDeleted++)},"_fileAdded":function(e){var t=this;this._map[e.id]||(this._map[e.id]=e,e.on("statuschange",function(e,i){t._onFileStatusChange(e,i)}))},"_onFileStatusChange":function(e,t){var i=this.stats;switch(t){case n.PROGRESS:i.numOfProgress--;break;case n.QUEUED:i.numOfQueue--;break;case n.ERROR:i.numOfUploadFailed--;break;case n.INVALID:i.numOfInvalid--;break;case n.INTERRUPT:i.numofInterrupt--}switch(e){case n.QUEUED:i.numOfQueue++;break;case n.PROGRESS:i.numOfProgress++;break;case n.ERROR:i.numOfUploadFailed++;break;case n.COMPLETE:i.numOfSuccess++;break;case n.CANCELLED:i.numOfCancel++;break;case n.INVALID:i.numOfInvalid++;break;case n.INTERRUPT:i.numofInterrupt++}}}),t.installTo(r.prototype),r}),t("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(e,t,i,r,n,a){var $=e.$,s=/\.\w+$/,o=r.Status;return t.register({"name":"queue","init":function(t){var r,n,s,o,l,u,c,d=this;if($.isPlainObject(t.accept)&&(t.accept=[t.accept]),t.accept){for(l=[],s=0,n=t.accept.length;s<n;s++)(o=t.accept[s].extensions)&&l.push(o);l.length&&(u="\\."+l.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),d.accept=new RegExp(u,"i")}if(d.queue=new i,d.stats=d.queue.stats,"html5"===this.request("predict-runtime-type"))return r=e.Deferred(),this.placeholder=c=new a("Placeholder"),c.connectRuntime({"runtimeOrder":"html5"},function(){d._ruid=c.getRuid(),r.resolve()}),r.promise()},"_wrapFile":function(e){if(!(e instanceof r)){if(!(e instanceof n)){if(!this._ruid)throw new Error("Can't add external files.");e=new n(this._ruid,e)}e=new r(e)}return e},"acceptFile":function(e){return!(!(!e||!e.size||this.accept&&null!==s.exec(e.name))||!this.accept.test(e.name))},"_addFile":function(e){var t=this;if(e=t._wrapFile(e),t.owner.trigger("beforeFileQueued",e))return t.acceptFile(e)?(t.queue.append(e),t.owner.trigger("fileQueued",e),e):void t.owner.trigger("error","Q_TYPE_DENIED",e)},"getFile":function(e){return this.queue.getFile(e)},"addFile":function(e){var t=this;e.length||(e=[e]),e=$.map(e,function(e){return t._addFile(e)}),t.owner.trigger("filesQueued",e),t.options.auto&&setTimeout(function(){t.request("start-upload")},20)},"getStats":function(){return this.stats},"removeFile":function(e,t){var i=this;e=e.id?e:i.queue.getFile(e),this.request("cancel-file",e),t&&this.queue.removeFile(e)},"getFiles":function(){return this.queue.getFiles.apply(this.queue,arguments)},"fetchFile":function(){return this.queue.fetch.apply(this.queue,arguments)},"retry":function(e,t){var i,r,n,a=this;if(e)return e=e.id?e:a.queue.getFile(e),e.setStatus(o.QUEUED),void(t||a.request("start-upload"));for(i=a.queue.getFiles(o.ERROR),r=0,n=i.length;r<n;r++)e=i[r],e.setStatus(o.QUEUED);a.request("start-upload")},"sortFiles":function(){return this.queue.sort.apply(this.queue,arguments)},"reset":function(){this.owner.trigger("reset"),this.queue=new i,this.stats=this.queue.stats},"destroy":function(){this.reset(),this.placeholder&&this.placeholder.destroy()}})}),t("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(e,t){return e.support=function(){return t.hasRuntime.apply(t,arguments)},e.register({"name":"runtime","init":function(){if(!this.predictRuntimeType())throw Error("Runtime Error")},"predictRuntimeType":function(){var e,i,r=this.options.runtimeOrder||t.orders,n=this.type;if(!n)for(r=r.split(/\s*,\s*/g),e=0,i=r.length;e<i;e++)if(t.hasRuntime(r[e])){this.type=n=r[e];break}return n}})}),t("lib/transport",["base","runtime/client","mediator"],function(e,t,i){function r(e){var i=this;e=i.options=$.extend(!0,{},r.options,e||{}),t.call(this,"Transport"),this._blob=null,this._formData=e.formData||{},this._headers=e.headers||{},this.on("progress",this._timeout),this.on("load error",function(){i.trigger("progress",1),clearTimeout(i._timer)})}var $=e.$;return r.options={"server":"","method":"POST","withCredentials":!1,"fileVal":"file","timeout":12e4,"formData":{},"headers":{},"sendAsBinary":!1},$.extend(r.prototype,{"appendBlob":function(e,t,i){var r=this,n=r.options;r.getRuid()&&r.disconnectRuntime(),r.connectRuntime(t.ruid,function(){r.exec("init")}),r._blob=t,n.fileVal=e||n.fileVal,n.filename=i||n.filename},"append":function(e,t){"object"==typeof e?$.extend(this._formData,e):this._formData[e]=t},"setRequestHeader":function(e,t){"object"==typeof e?$.extend(this._headers,e):this._headers[e]=t},"send":function(e){this.exec("send",e),this._timeout()},"abort":function(){return clearTimeout(this._timer),this.exec("abort")},"destroy":function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},"getResponse":function(){return this.exec("getResponse")},"getResponseAsJson":function(){return this.exec("getResponseAsJson")},"getStatus":function(){return this.exec("getStatus")},"_timeout":function(){var e=this,t=e.options.timeout;t&&(clearTimeout(e._timer),e._timer=setTimeout(function(){e.abort(),e.trigger("error","timeout")},t))}}),i.installTo(r.prototype),r}),t("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(e,t,i,r){function n(e,t){var i,r,n=[],a=e.source,s=a.size,o=t?Math.ceil(s/t):1,l=0,u=0;for(r={"file":e,"has":function(){return!!n.length},"shift":function(){return n.shift()},"unshift":function(e){n.unshift(e)}};u<o;)i=Math.min(t,s-l),n.push({"file":e,"start":l,"end":t?l+i:s,"total":s,"chunks":o,"chunk":u++,"cuted":r}),l+=i;return e.blocks=n.concat(),e.remaning=n.length,r}var $=e.$,a=e.isPromise,s=i.Status;$.extend(t.options,{"prepareNextFile":!1,"chunked":!1,"chunkSize":5242880,"chunkRetry":2,"threads":3,"formData":{}}),t.register({"name":"upload","init":function(){var t=this.owner,i=this;this.runing=!1,this.progress=!1,t.on("startUpload",function(){i.progress=!0}).on("uploadFinished",function(){i.progress=!1}),this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this.__tick=e.bindFn(this._tick,this),t.on("uploadComplete",function(e){e.blocks&&$.each(e.blocks,function(e,t){t.transport&&(t.transport.abort(),t.transport.destroy()),delete t.transport}),delete e.blocks,delete e.remaning})},"reset":function(){this.request("stop-upload",!0),this.runing=!1,this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this._trigged=!1,this._promise=null},"startUpload":function(t){var i=this;if($.each(i.request("get-files",s.INVALID),function(){i.request("remove-file",this)}),t)if(t=t.id?t:i.request("get-file",t),t.getStatus()===s.INTERRUPT)$.each(i.pool,function(e,i){i.file===t&&i.transport&&i.transport.send()}),t.setStatus(s.QUEUED);else{if(t.getStatus()===s.PROGRESS)return;t.setStatus(s.QUEUED)}else $.each(i.request("get-files",[s.INITED]),function(){this.setStatus(s.QUEUED)});if(!i.runing){i.runing=!0;var r=[];$.each(i.pool,function(e,t){var n=t.file;n.getStatus()===s.INTERRUPT&&(r.push(n),i._trigged=!1,t.transport&&t.transport.send())});for(var t;t=r.shift();)t.setStatus(s.PROGRESS);t||$.each(i.request("get-files",s.INTERRUPT),function(){this.setStatus(s.PROGRESS)}),i._trigged=!1,e.nextTick(i.__tick),i.owner.trigger("startUpload")}},"stopUpload":function(t,i){var r=this;if(!0===t&&(i=t,t=null),!1!==r.runing){if(t){if(t=t.id?t:r.request("get-file",t),t.getStatus()!==s.PROGRESS&&t.getStatus()!==s.QUEUED)return;return t.setStatus(s.INTERRUPT),$.each(r.pool,function(e,i){i.file===t&&(i.transport&&i.transport.abort(),r._putback(i),r._popBlock(i))}),e.nextTick(r.__tick)}r.runing=!1,this._promise&&this._promise.file&&this._promise.file.setStatus(s.INTERRUPT),i&&$.each(r.pool,function(e,t){t.transport&&t.transport.abort(),t.file.setStatus(s.INTERRUPT)}),r.owner.trigger("stopUpload")}},"cancelFile":function(e){e=e.id?e:this.request("get-file",e),e.blocks&&$.each(e.blocks,function(e,t){var i=t.transport;i&&(i.abort(),i.destroy(),delete t.transport)}),e.setStatus(s.CANCELLED),this.owner.trigger("fileDequeued",e)},"isInProgress":function(){return!!this.progress},"_getStats":function(){return this.request("get-stats")},"skipFile":function(e,t){e=e.id?e:this.request("get-file",e),e.setStatus(t||s.COMPLETE),e.skipped=!0,e.blocks&&$.each(e.blocks,function(e,t){var i=t.transport;i&&(i.abort(),i.destroy(),delete t.transport)}),this.owner.trigger("uploadSkip",e)},"_tick":function(){var t,i,r=this,n=r.options;if(r._promise)return r._promise.always(r.__tick);r.pool.length<n.threads&&(i=r._nextBlock())?(r._trigged=!1,t=function(t){r._promise=null,t&&t.file&&r._startSend(t),e.nextTick(r.__tick)},r._promise=a(i)?i.always(t):t(i)):r.remaning||r._getStats().numOfQueue||r._getStats().numofInterrupt||(r.runing=!1,r._trigged||e.nextTick(function(){r.owner.trigger("uploadFinished")}),r._trigged=!0)},"_putback":function(e){var t;e.cuted.unshift(e),~(t=this.stack.indexOf(e.cuted))||this.stack.unshift(e.cuted)},"_getStack":function(){for(var e,t=0;e=this.stack[t++];){if(e.has()&&e.file.getStatus()===s.PROGRESS)return e;(!e.has()||e.file.getStatus()!==s.PROGRESS&&e.file.getStatus()!==s.INTERRUPT)&&this.stack.splice(--t,1)}return null},"_nextBlock":function(){var e,t,i,r,s=this,o=s.options;return(e=this._getStack())?(o.prepareNextFile&&!s.pending.length&&s._prepareNextFile(),e.shift()):s.runing?(!s.pending.length&&s._getStats().numOfQueue&&s._prepareNextFile(),t=s.pending.shift(),i=function(t){return t?(e=n(t,o.chunked?o.chunkSize:0),s.stack.push(e),e.shift()):null},a(t)?(r=t.file,t=t[t.pipe?"pipe":"then"](i),t.file=r,t):i(t)):void 0},"_prepareNextFile":function(){var e,t=this,i=t.request("fetch-file"),r=t.pending;i&&(e=t.request("before-send-file",i,function(){return i.getStatus()===s.PROGRESS||i.getStatus()===s.INTERRUPT?i:t._finishFile(i)}),t.owner.trigger("uploadStart",i),i.setStatus(s.PROGRESS),e.file=i,e.done(function(){var t=$.inArray(e,r);~t&&r.splice(t,1,i)}),e.fail(function(e){i.setStatus(s.ERROR,e),t.owner.trigger("uploadError",i,e),t.owner.trigger("uploadComplete",i)}),r.push(e))},"_popBlock":function(e){var t=$.inArray(e,this.pool);this.pool.splice(t,1),e.file.remaning--,this.remaning--},"_startSend":function(t){var i,r=this,n=t.file;if(n.getStatus()!==s.PROGRESS)return void(n.getStatus()===s.INTERRUPT&&r._putback(t));r.pool.push(t),r.remaning++,t.blob=1===t.chunks?n.source:n.source.slice(t.start,t.end),i=r.request("before-send",t,function(){n.getStatus()===s.PROGRESS?r._doSend(t):(r._popBlock(t),e.nextTick(r.__tick))}),i.fail(function(){1===n.remaning?r._finishFile(n).always(function(){t.percentage=1,r._popBlock(t),r.owner.trigger("uploadComplete",n),e.nextTick(r.__tick)}):(t.percentage=1,r.updateFileProgress(n),r._popBlock(t),e.nextTick(r.__tick))})},"_doSend":function(t){var i,n,a=this,o=a.owner,l=a.options,u=t.file,c=new r(l),d=$.extend({},l.formData),f=$.extend({},l.headers);t.transport=c,c.on("destroy",function(){delete t.transport,a._popBlock(t),e.nextTick(a.__tick)}),c.on("progress",function(e){t.percentage=e,a.updateFileProgress(u)}),i=function(e){var i;return n=c.getResponseAsJson()||{},n._raw=c.getResponse(),i=function(t){e=t},o.trigger("uploadAccept",t,n,i)||(e=e||"server"),e},c.on("error",function(e,r){t.retried=t.retried||0,t.chunks>1&&~"http,abort".indexOf(e)&&t.retried<l.chunkRetry?(t.retried++,c.send()):(r||"server"!==e||(e=i(e)),u.setStatus(s.ERROR,e),o.trigger("uploadError",u,e),o.trigger("uploadComplete",u))}),c.on("load",function(){var e;if(e=i())return void c.trigger("error",e,!0);1===u.remaning?a._finishFile(u,n):c.destroy()}),d=$.extend(d,{"id":u.id,"name":u.name,"type":u.type,"lastModifiedDate":u.lastModifiedDate,"size":u.size}),t.chunks>1&&$.extend(d,{"chunks":t.chunks,"chunk":t.chunk}),o.trigger("uploadBeforeSend",t,d,f),c.appendBlob(l.fileVal,t.blob,u.name),c.append(d),c.setRequestHeader(f),c.send()},"_finishFile":function(e,t,i){var r=this.owner;return r.request("after-send-file",arguments,function(){e.setStatus(s.COMPLETE),r.trigger("uploadSuccess",e,t,i)}).fail(function(t){e.getStatus()===s.PROGRESS&&e.setStatus(s.ERROR,t),r.trigger("uploadError",e,t)}).always(function(){r.trigger("uploadComplete",e)})},"updateFileProgress":function(e){var t=0,i=0;e.blocks&&($.each(e.blocks,function(e,t){i+=(t.percentage||0)*(t.end-t.start)}),t=i/e.size,this.owner.trigger("uploadProgress",e,t||0))}})}),t("widgets/validator",["base","uploader","file","widgets/widget"],function(e,t,i){var r,$=e.$,n={};return r={"addValidator":function(e,t){n[e]=t},"removeValidator":function(e){delete n[e]}},t.register({"name":"validator","init":function(){var t=this;e.nextTick(function(){$.each(n,function(){this.call(t.owner)})})}}),r.addValidator("fileNumLimit",function(){var e=this,t=e.options,i=0,r=parseInt(t.fileNumLimit,10),n=!0;r&&(e.on("beforeFileQueued",function(e){return i>=r&&n&&(n=!1,this.trigger("error","Q_EXCEED_NUM_LIMIT",r,e),setTimeout(function(){n=!0},1)),!(i>=r)}),e.on("fileQueued",function(){i++}),e.on("fileDequeued",function(){i--}),e.on("reset",function(){i=0}))}),r.addValidator("fileSizeLimit",function(){var e=this,t=e.options,i=0,r=parseInt(t.fileSizeLimit,10),n=!0;r&&(e.on("beforeFileQueued",function(e){var t=i+e.size>r;return t&&n&&(n=!1,this.trigger("error","Q_EXCEED_SIZE_LIMIT",r,e),setTimeout(function(){n=!0},1)),!t}),e.on("fileQueued",function(e){i+=e.size}),e.on("fileDequeued",function(e){i-=e.size}),e.on("reset",function(){i=0}))}),r.addValidator("fileSingleSizeLimit",function(){var e=this,t=e.options,r=t.fileSingleSizeLimit;r&&e.on("beforeFileQueued",function(e){if(e.size>r)return e.setStatus(i.Status.INVALID,"exceed_size"),this.trigger("error","F_EXCEED_SIZE",r,e),!1})}),r.addValidator("duplicate",function(){function e(e){for(var t,i=0,r=0,n=e.length;r<n;r++)t=e.charCodeAt(r),i=t+(i<<6)+(i<<16)-i;return i}var t=this,i=t.options,r={};i.duplicate||(t.on("beforeFileQueued",function(t){var i=t.__hash||(t.__hash=e(t.name+t.size+t.lastModifiedDate));if(r[i])return this.trigger("error","F_DUPLICATE",t),!1}),t.on("fileQueued",function(e){var t=e.__hash;t&&(r[t]=!0)}),t.on("fileDequeued",function(e){var t=e.__hash;t&&delete r[t]}),t.on("reset",function(){r={}}))}),r}),t("lib/md5",["runtime/client","mediator"],function(e,t){function i(){e.call(this,"Md5")}return t.installTo(i.prototype),i.prototype.loadFromBlob=function(e){var t=this;t.getRuid()&&t.disconnectRuntime(),t.connectRuntime(e.ruid,function(){t.exec("init"),t.exec("loadFromBlob",e)})},i.prototype.getResult=function(){return this.exec("getResult")},i}),t("widgets/md5",["base","uploader","lib/md5","lib/blob","widgets/widget"],function(e,t,i,r){return t.register({"name":"md5","md5File":function(t,n,a){var s=new i,o=e.Deferred(),l=t instanceof r?t:this.request("get-file",t).source;return s.on("progress load",function(e){e=e||{},o.notify(e.total?e.loaded/e.total:1)}),s.on("complete",function(){o.resolve(s.getResult())}),s.on("error",function(e){o.reject(e)}),arguments.length>1&&(n=n||0,a=a||0,n<0&&(n=l.size+n),a<0&&(a=l.size+a),a=Math.min(a,l.size),l=l.slice(n,a)),s.loadFromBlob(l),o.promise()}})}),t("runtime/compbase",[],function(){function e(e,t){this.owner=e,this.options=e.options,this.getRuntime=function(){return t},this.getRuid=function(){return t.uid},this.trigger=function(){return e.trigger.apply(e,arguments)}}return e}),t("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(t,i,r){function n(){var e={},r=this,n=this.destroy;i.apply(r,arguments),r.type=a,r.exec=function(i,n){var a,o=this,l=o.uid,u=t.slice(arguments,2);if(s[i]&&(a=e[l]=e[l]||new s[i](o,r),a[n]))return a[n].apply(a,u)},r.destroy=function(){return n&&n.apply(this,arguments)}}var a="html5",s={};return t.inherits(i,{"constructor":n,"init":function(){var e=this;setTimeout(function(){e.trigger("ready")},1)}}),n.register=function(e,i){return s[e]=t.inherits(r,i)},e.Blob&&e.FileReader&&e.DataView&&i.addRuntime(a,n),n}),t("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(e,t){return e.register("Blob",{"slice":function(e,i){var r=this.owner.source;return r=(r.slice||r.webkitSlice||r.mozSlice).call(r,e,i),new t(this.getRuid(),r)}})}),t("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(e,t,i){var $=e.$,r="webuploader-dnd-";return t.register("DragAndDrop",{"init":function(){var t=this.elem=this.options.container;this.dragEnterHandler=e.bindFn(this._dragEnterHandler,this),this.dragOverHandler=e.bindFn(this._dragOverHandler,this),this.dragLeaveHandler=e.bindFn(this._dragLeaveHandler,this),this.dropHandler=e.bindFn(this._dropHandler,this),this.dndOver=!1,t.on("dragenter",this.dragEnterHandler),t.on("dragover",this.dragOverHandler),t.on("dragleave",this.dragLeaveHandler),t.on("drop",this.dropHandler),this.options.disableGlobalDnd&&($(document).on("dragover",this.dragOverHandler),$(document).on("drop",this.dropHandler))},"_dragEnterHandler":function(e){var t,i=this,n=i._denied||!1;return e=e.originalEvent||e,i.dndOver||(i.dndOver=!0,t=e.dataTransfer.items,t&&t.length&&(i._denied=n=!i.trigger("accept",t)),i.elem.addClass(r+"over"),i.elem[n?"addClass":"removeClass"](r+"denied")),e.dataTransfer.dropEffect=n?"none":"copy",!1},"_dragOverHandler":function(e){var t=this.elem.parent().get(0);return!(t&&!$.contains(t,e.currentTarget))&&(clearTimeout(this._leaveTimer),this._dragEnterHandler.call(this,e),!1)},"_dragLeaveHandler":function(){var e,t=this;return e=function(){t.dndOver=!1,t.elem.removeClass(r+"over "+r+"denied")},clearTimeout(t._leaveTimer),t._leaveTimer=setTimeout(e,100),!1},"_dropHandler":function(e){var t,n,a=this,s=a.getRuid(),o=a.elem.parent().get(0);if(o&&!$.contains(o,e.currentTarget))return!1;e=e.originalEvent||e,t=e.dataTransfer;try{n=t.getData("text/html")}catch(e){}return n?void 0:(a._getTansferFiles(t,function(e){a.trigger("drop",$.map(e,function(e){return new i(s,e)}))}),a.dndOver=!1,a.elem.removeClass(r+"over"),!1)},"_getTansferFiles":function(t,i){var r,n,a,s,o,l,u,c=[],d=[];for(r=t.items,n=t.files,u=!(!r||!r[0].webkitGetAsEntry),o=0,l=n.length;o<l;o++)a=n[o],s=r&&r[o],u&&s.webkitGetAsEntry().isDirectory?d.push(this._traverseDirectoryTree(s.webkitGetAsEntry(),c)):c.push(a);e.when.apply(e,d).done(function(){c.length&&i(c)})},"_traverseDirectoryTree":function(t,i){var r=e.Deferred(),n=this;return t.isFile?t.file(function(e){i.push(e),r.resolve()}):t.isDirectory&&t.createReader().readEntries(function(t){var a,s=t.length,o=[],l=[];for(a=0;a<s;a++)o.push(n._traverseDirectoryTree(t[a],l));e.when.apply(e,o).then(function(){i.push.apply(i,l),r.resolve()},r.reject)}),r.promise()},"destroy":function(){var e=this.elem;e&&(e.off("dragenter",this.dragEnterHandler),e.off("dragover",this.dragOverHandler),e.off("dragleave",this.dragLeaveHandler),e.off("drop",this.dropHandler),this.options.disableGlobalDnd&&($(document).off("dragover",this.dragOverHandler),$(document).off("drop",this.dropHandler)))}})}),t("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(e,t,i){return t.register("FilePaste",{"init":function(){var t,i,r,n,a=this.options,s=this.elem=a.container,o=".*";if(a.accept){for(t=[],i=0,r=a.accept.length;i<r;i++)(n=a.accept[i].mimeTypes)&&t.push(n);t.length&&(o=t.join(","),o=o.replace(/,/g,"|").replace(/\*/g,".*"))}this.accept=o=new RegExp(o,"i"),this.hander=e.bindFn(this._pasteHander,this),s.on("paste",this.hander)},"_pasteHander":function(e){var t,r,n,a,s,o=[],l=this.getRuid();for(e=e.originalEvent||e,t=e.clipboardData.items,a=0,s=t.length;a<s;a++)r=t[a],"file"===r.kind&&(n=r.getAsFile())&&o.push(new i(l,n));o.length&&(e.preventDefault(),e.stopPropagation(),this.trigger("paste",o))},"destroy":function(){this.elem.off("paste",this.hander)}})}),t("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(e,t){var $=e.$;return t.register("FilePicker",{"init":function(){var e,t,i,r,n=this.getRuntime().getContainer(),a=this,s=a.owner,o=a.options,l=this.label=$(document.createElement("label")),u=this.input=$(document.createElement("input"));if(u.attr("type","file"),u.attr("name","file"),u.addClass("webuploader-element-invisible"),l.on("click",function(){u.trigger("click")}),l.css({"opacity":0,"width":"100%","height":"100%","display":"block","cursor":"pointer","background":"#ffffff"}),o.multiple&&u.attr("multiple","multiple"),o.accept&&o.accept.length>0){for(e=[],t=0,i=o.accept.length;t<i;t++)e.push(o.accept[t].mimeTypes);u.attr("accept",e.join(","))}n.append(u),n.append(l),r=function(e){s.trigger(e.type)},u.on("change",function(e){var t,i=arguments.callee;a.files=e.target.files,t=this.cloneNode(!0),t.value=null,this.parentNode.replaceChild(t,this),u.off(),u=$(t).on("change",i).on("mouseenter mouseleave",r),s.trigger("change")}),l.on("mouseenter mouseleave",r)},"getFiles":function(){return this.files},"destroy":function(){this.input.off(),this.label.off()}})}),t("runtime/html5/util",["base"],function(t){var i=e.createObjectURL&&e||e.URL&&URL.revokeObjectURL&&URL||e.webkitURL,r=t.noop,n=r;return i&&(r=function(){return i.createObjectURL.apply(i,arguments)},n=function(){return i.revokeObjectURL.apply(i,arguments)}),{"createObjectURL":r,"revokeObjectURL":n,"dataURL2Blob":function(e){var t,i,r,n,a,s;for(s=e.split(","),t=~s[0].indexOf("base64")?atob(s[1]):decodeURIComponent(s[1]),r=new ArrayBuffer(t.length),i=new Uint8Array(r),n=0;n<t.length;n++)i[n]=t.charCodeAt(n);return a=s[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(r,a)},"dataURL2ArrayBuffer":function(e){var t,i,r,n;for(n=e.split(","),t=~n[0].indexOf("base64")?atob(n[1]):decodeURIComponent(n[1]),i=new Uint8Array(t.length),r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i.buffer},"arrayBufferToBlob":function(t,i){var r,n=e.BlobBuilder||e.WebKitBlobBuilder;return n?(r=new n,r.append(t),r.getBlob(i)):new Blob([t],i?{"type":i}:{})},"canvasToDataUrl":function(e,t,i){return e.toDataURL(t,i/100)},"parseMeta":function(e,t){t(!1,{})},"updateImageHead":function(e){return e}}}),t("runtime/html5/imagemeta",["runtime/html5/util"],function(e){var t;return t={"parsers":{"65505":[]},"maxMetaDataSize":262144,"parse":function(e,t){var i=this,r=new FileReader;r.onload=function(){t(!1,i._parse(this.result)),r=r.onload=r.onerror=null},r.onerror=function(e){t(e.message),r=r.onload=r.onerror=null},e=e.slice(0,i.maxMetaDataSize),r.readAsArrayBuffer(e.getSource())},"_parse":function(e,i){if(!(e.byteLength<6)){var r,n,a,s,o=new DataView(e),l=2,u=o.byteLength-4,c=l,d={};if(65496===o.getUint16(0)){for(;l<u&&((r=o.getUint16(l))>=65504&&r<=65519||65534===r)&&(n=o.getUint16(l+2)+2,!(l+n>o.byteLength));){if(a=t.parsers[r],!i&&a)for(s=0;s<a.length;s+=1)a[s].call(t,o,l,n,d);l+=n,c=l}c>6&&(e.slice?d.imageHead=e.slice(2,c):d.imageHead=new Uint8Array(e).subarray(2,c))}return d}},"updateImageHead":function(e,t){var i,r,n,a=this._parse(e,!0);return n=2,a.imageHead&&(n=2+a.imageHead.byteLength),r=e.slice?e.slice(n):new Uint8Array(e).subarray(n),i=new Uint8Array(t.byteLength+2+r.byteLength),i[0]=255,i[1]=216,i.set(new Uint8Array(t),2),i.set(new Uint8Array(r),t.byteLength+2),i.buffer}},e.parseMeta=function(){return t.parse.apply(t,arguments)},e.updateImageHead=function(){return t.updateImageHead.apply(t,arguments)},t}),t("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(e,t){var i={};return i.ExifMap=function(){return this},i.ExifMap.prototype.map={"Orientation":274},i.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},i.exifTagTypes={"1":{"getValue":function(e,t){return e.getUint8(t)},"size":1},"2":{"getValue":function(e,t){return String.fromCharCode(e.getUint8(t))},"size":1,"ascii":!0},"3":{"getValue":function(e,t,i){return e.getUint16(t,i)},"size":2},"4":{"getValue":function(e,t,i){return e.getUint32(t,i)},"size":4},"5":{"getValue":function(e,t,i){return e.getUint32(t,i)/e.getUint32(t+4,i)},"size":8},"9":{"getValue":function(e,t,i){return e.getInt32(t,i)},"size":4},"10":{"getValue":function(e,t,i){return e.getInt32(t,i)/e.getInt32(t+4,i)},"size":8}},i.exifTagTypes[7]=i.exifTagTypes[1],i.getExifValue=function(t,r,n,a,s,o){var l,u,c,d,f,h,p=i.exifTagTypes[a];if(!p)return void e.log("Invalid Exif data: Invalid tag type.");if(l=p.size*s,(u=l>4?r+t.getUint32(n+8,o):n+8)+l>t.byteLength)return void e.log("Invalid Exif data: Invalid data offset.");if(1===s)return p.getValue(t,u,o);for(c=[],d=0;d<s;d+=1)c[d]=p.getValue(t,u+d*p.size,o);if(p.ascii){for(f="",d=0;d<c.length&&"\0"!==(h=c[d]);d+=1)f+=h;return f}return c},i.parseExifTag=function(e,t,r,n,a){var s=e.getUint16(r,n);a.exif[s]=i.getExifValue(e,t,r,e.getUint16(r+2,n),e.getUint32(r+4,n),n)},i.parseExifTags=function(t,i,r,n,a){var s,o,l;if(r+6>t.byteLength)return void e.log("Invalid Exif data: Invalid directory offset.");if(s=t.getUint16(r,n),(o=r+2+12*s)+4>t.byteLength)return void e.log("Invalid Exif data: Invalid directory size.");for(l=0;l<s;l+=1)this.parseExifTag(t,i,r+2+12*l,n,a);return t.getUint32(o,n)},i.parseExifData=function(t,r,n,a){var s,o,l=r+10;if(1165519206===t.getUint32(r+4)){if(l+8>t.byteLength)return void e.log("Invalid Exif data: Invalid segment size.");if(0!==t.getUint16(r+8))return void e.log("Invalid Exif data: Missing byte alignment offset.");switch(t.getUint16(l)){case 18761:s=!0;break;case 19789:s=!1;break;default:return void e.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==t.getUint16(l+2,s))return void e.log("Invalid Exif data: Missing TIFF marker.");o=t.getUint32(l+4,s),a.exif=new i.ExifMap,o=i.parseExifTags(t,l,l+o,s,a)}},t.parsers[65505].push(i.parseExifData),i}),t("runtime/html5/jpegencoder",[],function(require,exports,e){function t(e){function t(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var r=x((t[i]*e+50)/100);r<1?r=1:r>255&&(r=255),k[q[i]]=r}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var s=x((n[a]*e+50)/100);s<1?s=1:s>255&&(s=255),S[q[a]]=s}for(var o=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],l=0,u=0;u<8;u++)for(var c=0;c<8;c++)D[l]=1/(k[q[l]]*o[u]*o[c]*8),R[l]=1/(S[q[l]]*o[u]*o[c]*8),l++}function i(e,t){for(var i=0,r=0,n=new Array,a=1;a<=16;a++){for(var s=1;s<=e[a];s++)n[t[r]]=[],n[t[r]][0]=i,n[t[r]][1]=a,r++,i++;i*=2}return n}function r(){b=i(j,H),w=i(Q,V),_=i(z,G),y=i(J,W)}function n(){for(var e=1,t=2,i=1;i<=15;i++){for(var r=e;r<t;r++)E[32767+r]=i,I[32767+r]=[],I[32767+r][1]=i,I[32767+r][0]=r;for(var n=-(t-1);n<=-e;n++)E[32767+n]=i,I[32767+n]=[],I[32767+n][1]=i,I[32767+n][0]=t-1+n;e<<=1,t<<=1}}function a(){for(var e=0;e<256;e++)M[e]=19595*e,M[e+256>>0]=38470*e,M[e+512>>0]=7471*e+32768,M[e+768>>0]=-11059*e,M[e+1024>>0]=-21709*e,M[e+1280>>0]=32768*e+8421375,M[e+1536>>0]=-27439*e,M[e+1792>>0]=-5329*e}function s(e){for(var t=e[0],i=e[1]-1;i>=0;)t&1<<i&&(T|=1<<B),i--,--B<0&&(255==T?(o(255),o(0)):o(T),B=7,T=0)}function o(e){L.push(U[e])}function l(e){o(e>>8&255),o(255&e)}function u(e,t){var i,r,n,a,s,o,l,u,c,d=0;for(c=0;c<8;++c){i=e[d],r=e[d+1],n=e[d+2],a=e[d+3],s=e[d+4],o=e[d+5],l=e[d+6],u=e[d+7];var f=i+u,h=i-u,p=r+l,g=r-l,m=n+o,v=n-o,b=a+s,w=a-s,_=f+b,y=f-b,C=p+m,x=p-m;e[d]=_+C,e[d+4]=_-C;var k=.707106781*(x+y);e[d+2]=y+k,e[d+6]=y-k,_=w+v,C=v+g,x=g+h;var S=.382683433*(_-x),D=.5411961*_+S,R=1.306562965*x+S,I=.707106781*C,E=h+I,F=h-I;e[d+5]=F+D,e[d+3]=F-D,e[d+1]=E+R,e[d+7]=E-R,d+=8}for(d=0,c=0;c<8;++c){i=e[d],r=e[d+8],n=e[d+16],a=e[d+24],s=e[d+32],o=e[d+40],l=e[d+48],u=e[d+56];var L=i+u,T=i-u,B=r+l,N=r-l,P=n+o,O=n-o,U=a+s,M=a-s,q=L+U,j=L-U,H=B+P,z=B-P;e[d]=q+H,e[d+32]=q-H;var G=.707106781*(z+j);e[d+16]=j+G,e[d+48]=j-G,q=M+O,H=O+N,z=N+T;var Q=.382683433*(q-z),V=.5411961*q+Q,J=1.306562965*z+Q,W=.707106781*H,Y=T+W,X=T-W;e[d+40]=X+V,e[d+24]=X-V,e[d+8]=Y+J,e[d+56]=Y-J,d++}var Z;for(c=0;c<64;++c)Z=e[c]*t[c],A[c]=Z>0?Z+.5|0:Z-.5|0;return A}function c(){l(65504),l(16),o(74),o(70),o(73),o(70),o(0),o(1),o(1),o(0),l(1),l(1),o(0),o(0)}function d(e,t){l(65472),l(17),o(8),l(t),l(e),o(3),o(1),o(17),o(0),o(2),o(17),o(1),o(3),o(17),o(1)}function f(){l(65499),l(132),o(0);for(var e=0;e<64;e++)o(k[e]);o(1);for(var t=0;t<64;t++)o(S[t])}function h(){l(65476),l(418),o(0);for(var e=0;e<16;e++)o(j[e+1]);for(var t=0;t<=11;t++)o(H[t]);o(16);for(var i=0;i<16;i++)o(z[i+1]);for(var r=0;r<=161;r++)o(G[r]);o(1);for(var n=0;n<16;n++)o(Q[n+1]);for(var a=0;a<=11;a++)o(V[a]);o(17);for(var s=0;s<16;s++)o(J[s+1]);for(var u=0;u<=161;u++)o(W[u])}function p(){l(65498),l(12),o(3),o(1),o(0),o(2),o(17),o(3),o(17),o(0),o(63),o(0)}function g(e,t,i,r,n){for(var a,o=n[0],l=n[240],c=u(e,t),d=0;d<64;++d)F[q[d]]=c[d];var f=F[0]-i;i=F[0],0==f?s(r[0]):(a=32767+f,s(r[E[a]]),s(I[a]));for(var h=63;h>0&&0==F[h];h--);if(0==h)return s(o),i;for(var p,g=1;g<=h;){for(var m=g;0==F[g]&&g<=h;++g);var v=g-m;if(v>=16){p=v>>4;for(var b=1;b<=p;++b)s(l);v&=15}a=32767+F[g],s(n[(v<<4)+E[a]]),s(I[a]),g++}return 63!=h&&s(o),i}function m(){for(var e=String.fromCharCode,t=0;t<256;t++)U[t]=e(t)}function v(e){if(e<=0&&(e=1),e>100&&(e=100),C!=e){var i=0;i=e<50?Math.floor(5e3/e):Math.floor(200-2*e),t(i),C=e}}var b,w,_,y,C,x=(Math.round,Math.floor),k=new Array(64),S=new Array(64),D=new Array(64),R=new Array(64),I=new Array(65535),E=new Array(65535),A=new Array(64),F=new Array(64),L=[],T=0,B=7,N=new Array(64),P=new Array(64),O=new Array(64),U=new Array(256),M=new Array(2048),q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],j=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],z=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],G=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Q=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],W=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(e,t){t&&v(t),L=new Array,T=0,B=7,l(65496),c(),f(),d(e.width,e.height),h(),p();var i=0,r=0,n=0;T=0,B=7,this.encode.displayName="_encode_";for(var a,o,u,m,C,x,k,S,I,E=e.data,A=e.width,F=e.height,U=4*A,q=0;q<F;){for(a=0;a<U;){for(C=U*q+a,x=C,k=-1,S=0,I=0;I<64;I++)S=I>>3,k=4*(7&I),x=C+S*U+k,q+S>=F&&(x-=U*(q+1+S-F)),a+k>=U&&(x-=a+k-U+4),o=E[x++],u=E[x++],m=E[x++],N[I]=(M[o]+M[u+256>>0]+M[m+512>>0]>>16)-128,P[I]=(M[o+768>>0]+M[u+1024>>0]+M[m+1280>>0]>>16)-128,O[I]=(M[o+1280>>0]+M[u+1536>>0]+M[m+1792>>0]>>16)-128;i=g(N,D,i,b,_),r=g(P,R,r,w,y),n=g(O,R,n,w,y),a+=32}q+=8}if(B>=0){var j=[];j[1]=B+1,j[0]=(1<<B+1)-1,s(j)}l(65497);var H="data:image/jpeg;base64,"+btoa(L.join(""));return L=[],H},function(){e||(e=50),m(),r(),n(),a(),v(e)}()}return t.encode=function(e,i){return new t(i).encode(e)},t}),t("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(e,t,i){var r,n=e.canvasToDataUrl;e.canvasToDataUrl=function(e,a,s){var o,l,u,c,d;return i.os.android?("image/jpeg"===a&&void 0===r&&(c=n.apply(null,arguments),d=c.split(","),c=~d[0].indexOf("base64")?atob(d[1]):decodeURIComponent(d[1]),c=c.substring(0,2),r=255===c.charCodeAt(0)&&216===c.charCodeAt(1)),"image/jpeg"!==a||r?n.apply(null,arguments):(l=e.width,u=e.height,o=e.getContext("2d"),t.encode(o.getImageData(0,0,l,u),s))):n.apply(null,arguments)}}),t("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(e,t,i){return t.register("Image",{"modified":!1,"init":function(){var e=this,t=new Image;t.onload=function(){e._info={"type":e.type,"width":this.width,"height":this.height},e._metas||"image/jpeg"!==e.type?e.owner.trigger("load"):i.parseMeta(e._blob,function(t,i){e._metas=i,e.owner.trigger("load")})},t.onerror=function(){e.owner.trigger("error")},e._img=t},"loadFromBlob":function(e){var t=this,r=t._img;t._blob=e,t.type=e.type,r.src=i.createObjectURL(e.getSource()),t.owner.once("load",function(){i.revokeObjectURL(r.src)})},"resize":function(e,t){var i=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,i,e,t),this._blob=null,this.modified=!0,this.owner.trigger("complete","resize")},"crop":function(e,t,i,r,n){var a=this._canvas||(this._canvas=document.createElement("canvas")),s=this.options,o=this._img,l=o.naturalWidth,u=o.naturalHeight,c=this.getOrientation();n=n||1,a.width=i,a.height=r,s.preserveHeaders||this._rotate2Orientaion(a,c),this._renderImageToCanvas(a,o,-e,-t,l*n,u*n),this._blob=null,this.modified=!0,this.owner.trigger("complete","crop")},"getAsBlob":function(e){var t,r=this._blob,n=this.options;if(e=e||this.type,this.modified||this.type!==e){if(t=this._canvas,"image/jpeg"===e){if(r=i.canvasToDataUrl(t,e,n.quality),n.preserveHeaders&&this._metas&&this._metas.imageHead)return r=i.dataURL2ArrayBuffer(r),r=i.updateImageHead(r,this._metas.imageHead),r=i.arrayBufferToBlob(r,e)}else r=i.canvasToDataUrl(t,e);r=i.dataURL2Blob(r)}return r},"getAsDataUrl":function(e){var t=this.options;return e=e||this.type,"image/jpeg"===e?i.canvasToDataUrl(this._canvas,e,t.quality):this._canvas.toDataURL(e)},"getOrientation":function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},"info":function(e){return e?(this._info=e,this):this._info},"meta":function(e){return e?(this._meta=e,this):this._meta},"destroy":function(){var e=this._canvas;this._img.onload=null,e&&(e.getContext("2d").clearRect(0,0,e.width,e.height),e.width=e.height=0,this._canvas=null),this._img.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D",this._img=this._blob=null},"_resize":function(e,t,i,r){var n,a,s,o,l,u=this.options,c=e.width,d=e.height,f=this.getOrientation();~[5,6,7,8].indexOf(f)&&(i^=r,r^=i,i^=r),n=Math[u.crop?"max":"min"](i/c,r/d),u.allowMagnify||(n=Math.min(1,n)),a=c*n,s=d*n,u.crop?(t.width=i,t.height=r):(t.width=a,t.height=s),o=(t.width-a)/2,l=(t.height-s)/2,u.preserveHeaders||this._rotate2Orientaion(t,f),this._renderImageToCanvas(t,e,o,l,a,s)},"_rotate2Orientaion":function(e,t){var i=e.width,r=e.height,n=e.getContext("2d");switch(t){case 5:case 6:case 7:case 8:e.width=r,e.height=i}switch(t){case 2:n.translate(i,0),n.scale(-1,1);break;case 3:n.translate(i,r),n.rotate(Math.PI);break;case 4:n.translate(0,r),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-r);break;case 7:n.rotate(.5*Math.PI),n.translate(i,-r),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-i,0)}},"_renderImageToCanvas":function(){function t(e,t,i){var r,n,a,s=document.createElement("canvas"),o=s.getContext("2d"),l=0,u=i,c=i;for(s.width=1,s.height=i,o.drawImage(e,0,0),r=o.getImageData(0,0,1,i).data;c>l;)n=r[4*(c-1)+3],0===n?u=c:l=c,c=u+l>>1;return a=c/i,0===a?1:a}function i(e){var t,i,r=e.naturalWidth,n=e.naturalHeight;return r*n>1048576&&(t=document.createElement("canvas"),t.width=t.height=1,i=t.getContext("2d"),i.drawImage(e,1-r,0),0===i.getImageData(0,0,1,1).data[3])}return e.os.ios?e.os.ios>=7?function(e,i,r,n,a,s){var o=i.naturalWidth,l=i.naturalHeight,u=t(i,o,l);return e.getContext("2d").drawImage(i,0,0,o*u,l*u,r,n,a,s)}:function(e,r,n,a,s,o){var l,u,c,d,f,h,p,g=r.naturalWidth,m=r.naturalHeight,v=e.getContext("2d"),b=i(r),w="image/jpeg"===this.type,_=1024,y=0,C=0;for(b&&(g/=2,m/=2),v.save(),l=document.createElement("canvas"),l.width=l.height=_,u=l.getContext("2d"),c=w?t(r,g,m):1,d=Math.ceil(_*s/g),f=Math.ceil(_*o/m/c);y<m;){for(h=0,p=0;h<g;)u.clearRect(0,0,_,_),u.drawImage(r,-h,-y),v.drawImage(l,0,0,_,_,n+p,a+C,d,f),h+=_,p+=d;y+=_,C+=f}v.restore(),l=u=null}:function(t){var i=e.slice(arguments,1),r=t.getContext("2d");r.drawImage.apply(r,i)}}()})}),t("runtime/html5/transport",["base","runtime/html5/runtime"],function(e,t){var i=e.noop,$=e.$;return t.register("Transport",{"init":function(){this._status=0,this._response=null},"send":function(){var t,i,r,n=this.owner,a=this.options,s=this._initAjax(),o=n._blob,l=a.server;a.sendAsBinary?(l+=(/\?/.test(l)?"&":"?")+$.param(n._formData),i=o.getSource()):(t=new FormData,$.each(n._formData,function(e,i){t.append(e,i)}),t.append(a.fileVal,o.getSource(),a.filename||n._formData.name||"")),a.withCredentials&&"withCredentials"in s?(s.open(a.method,l,!0),s.withCredentials=!0):s.open(a.method,l),this._setRequestHeader(s,a.headers),i?(s.overrideMimeType&&s.overrideMimeType("application/octet-stream"),e.os.android?(r=new FileReader,r.onload=function(){s.send(this.result),r=r.onload=null},r.readAsArrayBuffer(i)):s.send(i)):s.send(t)},"getResponse":function(){return this._response},"getResponseAsJson":function(){return this._parseJson(this._response)},"getStatus":function(){return this._status},"abort":function(){var e=this._xhr;e&&(e.upload.onprogress=i,e.onreadystatechange=i,e.abort(),this._xhr=e=null)},"destroy":function(){this.abort()},"_initAjax":function(){var e=this,t=new XMLHttpRequest;return!this.options.withCredentials||"withCredentials"in t||"undefined"==typeof XDomainRequest||(t=new XDomainRequest),t.upload.onprogress=function(t){var i=0;return t.lengthComputable&&(i=t.loaded/t.total),e.trigger("progress",i)},t.onreadystatechange=function(){if(4===t.readyState)return t.upload.onprogress=i,t.onreadystatechange=i,e._xhr=null,e._status=t.status,t.status>=200&&t.status<300?(e._response=t.responseText,e.trigger("load")):t.status>=500&&t.status<600?(e._response=t.responseText,e.trigger("error","server")):e.trigger("error",e._status?"http":"abort")},e._xhr=t,t},"_setRequestHeader":function(e,t){$.each(t,function(t,i){e.setRequestHeader(t,i)})},"_parseJson":function(e){var t;try{t=JSON.parse(e)}catch(e){t={}}return t}})}),t("runtime/html5/md5",["runtime/html5/runtime"],function(e){var t=function(e,t){return e+t&4294967295},i=function(e,i,r,n,a,s){return i=t(t(i,e),t(n,s)),t(i<<a|i>>>32-a,r)},r=function(e,t,r,n,a,s,o){return i(t&r|~t&n,e,t,a,s,o)},n=function(e,t,r,n,a,s,o){return i(t&n|r&~n,e,t,a,s,o)},a=function(e,t,r,n,a,s,o){return i(t^r^n,e,t,a,s,o)},s=function(e,t,r,n,a,s,o){return i(r^(t|~n),e,t,a,s,o)},o=function(e,i){var o=e[0],l=e[1],u=e[2],c=e[3];o=r(o,l,u,c,i[0],7,-680876936),c=r(c,o,l,u,i[1],12,-389564586),u=r(u,c,o,l,i[2],17,606105819),l=r(l,u,c,o,i[3],22,-1044525330),o=r(o,l,u,c,i[4],7,-176418897),c=r(c,o,l,u,i[5],12,1200080426),u=r(u,c,o,l,i[6],17,-1473231341),l=r(l,u,c,o,i[7],22,-45705983),o=r(o,l,u,c,i[8],7,1770035416),c=r(c,o,l,u,i[9],12,-1958414417),u=r(u,c,o,l,i[10],17,-42063),l=r(l,u,c,o,i[11],22,-1990404162),o=r(o,l,u,c,i[12],7,1804603682),c=r(c,o,l,u,i[13],12,-40341101),u=r(u,c,o,l,i[14],17,-1502002290),l=r(l,u,c,o,i[15],22,1236535329),o=n(o,l,u,c,i[1],5,-165796510),c=n(c,o,l,u,i[6],9,-1069501632),u=n(u,c,o,l,i[11],14,643717713),l=n(l,u,c,o,i[0],20,-373897302),o=n(o,l,u,c,i[5],5,-701558691),c=n(c,o,l,u,i[10],9,38016083),u=n(u,c,o,l,i[15],14,-660478335),l=n(l,u,c,o,i[4],20,-405537848),o=n(o,l,u,c,i[9],5,568446438),c=n(c,o,l,u,i[14],9,-1019803690),u=n(u,c,o,l,i[3],14,-187363961),l=n(l,u,c,o,i[8],20,1163531501),o=n(o,l,u,c,i[13],5,-1444681467),c=n(c,o,l,u,i[2],9,-51403784),u=n(u,c,o,l,i[7],14,1735328473),l=n(l,u,c,o,i[12],20,-1926607734),o=a(o,l,u,c,i[5],4,-378558),c=a(c,o,l,u,i[8],11,-2022574463),u=a(u,c,o,l,i[11],16,1839030562),l=a(l,u,c,o,i[14],23,-35309556),o=a(o,l,u,c,i[1],4,-1530992060),c=a(c,o,l,u,i[4],11,1272893353),u=a(u,c,o,l,i[7],16,-155497632),l=a(l,u,c,o,i[10],23,-1094730640),o=a(o,l,u,c,i[13],4,681279174),c=a(c,o,l,u,i[0],11,-358537222),u=a(u,c,o,l,i[3],16,-722521979),l=a(l,u,c,o,i[6],23,76029189),o=a(o,l,u,c,i[9],4,-640364487),c=a(c,o,l,u,i[12],11,-421815835),u=a(u,c,o,l,i[15],16,530742520),l=a(l,u,c,o,i[2],23,-995338651),o=s(o,l,u,c,i[0],6,-198630844),c=s(c,o,l,u,i[7],10,1126891415),u=s(u,c,o,l,i[14],15,-1416354905),l=s(l,u,c,o,i[5],21,-57434055),o=s(o,l,u,c,i[12],6,1700485571),c=s(c,o,l,u,i[3],10,-1894986606),u=s(u,c,o,l,i[10],15,-1051523),l=s(l,u,c,o,i[1],21,-2054922799),o=s(o,l,u,c,i[8],6,1873313359),c=s(c,o,l,u,i[15],10,-30611744),u=s(u,c,o,l,i[6],15,-1560198380),l=s(l,u,c,o,i[13],21,1309151649),o=s(o,l,u,c,i[4],6,-145523070),c=s(c,o,l,u,i[11],10,-1120210379),u=s(u,c,o,l,i[2],15,718787259),l=s(l,u,c,o,i[9],21,-343485551),e[0]=t(o,e[0]),e[1]=t(l,e[1]),e[2]=t(u,e[2]),e[3]=t(c,e[3])},l=function(e){var t,i=[];for(t=0;t<64;t+=4)i[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return i},u=function(e){var t,i=[];for(t=0;t<64;t+=4)i[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return i},c=function(e){var t,i,r,n,a,s,u=e.length,c=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=u;t+=64)o(c,l(e.substring(t-64,t)));for(e=e.substring(t-64),i=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)r[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(o(c,r),t=0;t<16;t+=1)r[t]=0;return n=8*u,n=n.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(n[2],16),s=parseInt(n[1],16)||0,r[14]=a,r[15]=s,o(c,r),c},d=function(e){var t,i,r,n,a,s,l=e.length,c=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=l;t+=64)o(c,u(e.subarray(t-64,t)));for(e=t-64<l?e.subarray(t-64):new Uint8Array(0),i=e.length,r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)r[t>>2]|=e[t]<<(t%4<<3);if(r[t>>2]|=128<<(t%4<<3),t>55)for(o(c,r),t=0;t<16;t+=1)r[t]=0;return n=8*l,n=n.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(n[2],16),s=parseInt(n[1],16)||0,r[14]=a,r[15]=s,o(c,r),c},f=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],h=function(e){var t,i="";for(t=0;t<4;t+=1)i+=f[e>>8*t+4&15]+f[e>>8*t&15];return i},p=function(e){var t;for(t=0;t<e.length;t+=1)e[t]=h(e[t]);return e.join("")},g=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==function(e){return p(c(e))}("hello")&&(t=function(e,t){var i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}),g.prototype.append=function(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),this.appendBinary(e),this},g.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)o(this._state,l(this._buff.substring(t-64,t)));return this._buff=this._buff.substr(t-64),this},g.prototype.end=function(e){var t,i,r=this._buff,n=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<n;t+=1)a[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(a,n),i=e?this._state:p(this._state),this.reset(),i},g.prototype._finish=function(e,t){var i,r,n,a=t;if(e[a>>2]|=128<<(a%4<<3),a>55)for(o(this._state,e),a=0;a<16;a+=1)e[a]=0;i=8*this._length,i=i.toString(16).match(/(.*?)(.{0,8})$/),r=parseInt(i[2],16),n=parseInt(i[1],16)||0,e[14]=r,e[15]=n,o(this._state,e)},g.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},g.hash=function(e,t){/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e)));var i=c(e);return t?i:p(i)},g.hashBinary=function(e,t){var i=c(e);return t?i:p(i)},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(e){var t,i=this._concatArrayBuffer(this._buff,e),r=i.length;for(this._length+=e.byteLength,t=64;t<=r;t+=64)o(this._state,u(i.subarray(t-64,t)));return this._buff=t-64<r?i.subarray(t-64):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(e){var t,i,r=this._buff,n=r.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<n;t+=1)a[t>>2]|=r[t]<<(t%4<<3);return this._finish(a,n),i=e?this._state:p(this._state),this.reset(),i},g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._concatArrayBuffer=function(e,t){var i=e.length,r=new Uint8Array(i+t.byteLength);return r.set(e),r.set(new Uint8Array(t),i),r},g.ArrayBuffer.hash=function(e,t){var i=d(new Uint8Array(e));return t?i:p(i)},e.register("Md5",{"init":function(){},"loadFromBlob":function(e){var t,i,r=e.getSource(),n=Math.ceil(r.size/2097152),a=0,s=this.owner,o=new g.ArrayBuffer,l=this,u=r.mozSlice||r.webkitSlice||r.slice;i=new FileReader,(t=function(){var c,d;c=2097152*a,d=Math.min(c+2097152,r.size),i.onload=function(t){o.append(t.target.result),s.trigger("progress",{"total":e.size,"loaded":d})},i.onloadend=function(){i.onloadend=i.onload=null,++a<n?setTimeout(t,1):setTimeout(function(){s.trigger("load"),l.result=o.end(),t=e=r=o=null,s.trigger("complete")},50)},i.readAsArrayBuffer(u.call(r,c,d))})()},"getResult":function(){return this.result}})}),t("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(t,i,r){function n(){function r(e,t){var i,r,n=e.type||e;i=n.split("::"),r=i[0],n=i[1],"Ready"===n&&r===u.uid?u.trigger("ready"):o[r]&&o[r].trigger(n.toLowerCase(),e,t)}var n={},o={},l=this.destroy,u=this,c=t.guid("webuploader_");i.apply(u,arguments),u.type=a,u.exec=function(e,i){var r,a=this,l=a.uid,c=t.slice(arguments,2);return o[l]=a,s[e]&&(n[l]||(n[l]=new s[e](a,u)),r=n[l],r[i])?r[i].apply(r,c):u.flashExec.apply(a,arguments)},e[c]=function(){var e=arguments;setTimeout(function(){r.apply(null,e)},1)},this.jsreciver=c,this.destroy=function(){return l&&l.apply(this,arguments)},this.flashExec=function(e,i){var r=u.getFlash(),n=t.slice(arguments,2);return r.exec(this.uid,e,i,n)}}var $=t.$,a="flash",s={};return t.inherits(i,{"constructor":n,"init":function(){var e,i=this.getContainer(),r=this.options;i.css({"position":"absolute","top":"-8px","left":"-8px","width":"9px","height":"9px","overflow":"hidden"}),e='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+r.swf+'" ',t.browser.ie&&(e+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),e+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+r.swf+'" /><param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',i.html(e)},"getFlash":function(){return this._flash?this._flash:(this._flash=$("#"+this.uid).get(0),this._flash)}}),n.register=function(e,i){return i=s[e]=t.inherits(r,$.extend({"flashExec":function(){var e=this.owner;return this.getRuntime().flashExec.apply(e,arguments)}},i))},function(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(t){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1],10)}()>=11.4&&i.addRuntime(a,n),n}),t("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(e,t){var $=e.$;return t.register("FilePicker",{"init":function(e){var t,i,r=$.extend({},e);for(t=r.accept&&r.accept.length,i=0;i<t;i++)r.accept[i].title||(r.accept[i].title="Files");delete r.button,delete r.id,delete r.container,this.flashExec("FilePicker","init",r)},"destroy":function(){this.flashExec("FilePicker","destroy")}})}),t("runtime/flash/image",["runtime/flash/runtime"],function(e){return e.register("Image",{"loadFromBlob":function(e){var t=this.owner;t.info()&&this.flashExec("Image","info",t.info()),t.meta()&&this.flashExec("Image","meta",t.meta()),this.flashExec("Image","loadFromBlob",e.uid)}})}),t("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(t,i,r){var $=t.$;return i.register("Transport",{"init":function(){this._status=0,this._response=null,this._responseJson=null},"send":function(){var e,t=this.owner,i=this.options,r=this._initAjax(),n=t._blob,a=i.server;r.connectRuntime(n.ruid),i.sendAsBinary?(a+=(/\?/.test(a)?"&":"?")+$.param(t._formData),e=n.uid):($.each(t._formData,function(e,t){r.exec("append",e,t)}),r.exec("appendBlob",i.fileVal,n.uid,i.filename||t._formData.name||"")),this._setRequestHeader(r,i.headers),r.exec("send",{"method":i.method,"url":a,"forceURLStream":i.forceURLStream,"mimeType":"application/octet-stream"},e)},"getStatus":function(){return this._status},"getResponse":function(){return this._response||""},"getResponseAsJson":function(){return this._responseJson},"abort":function(){var e=this._xhr;e&&(e.exec("abort"),e.destroy(),this._xhr=e=null)},"destroy":function(){this.abort()},"_initAjax":function(){var t=this,i=new r("XMLHttpRequest");return i.on("uploadprogress progress",function(e){var i=e.loaded/e.total;return i=Math.min(1,Math.max(0,i)),t.trigger("progress",i)}),i.on("load",function(){var r,n=i.exec("getStatus"),a=!1,s="";return i.off(),t._xhr=null,n>=200&&n<300?a=!0:n>=500&&n<600?(a=!0,s="server"):s="http",a&&(t._response=i.exec("getResponse"),t._response=decodeURIComponent(t._response),r=e.JSON&&e.JSON.parse||function(e){try{return new Function("return "+e).call()}catch(e){return{}}},t._responseJson=t._response?r(t._response):{}),i.destroy(),i=null,s?t.trigger("error",s):t.trigger("load")}),i.on("error",function(){i.off(),t._xhr=null,t.trigger("error","http")}),t._xhr=i,i},"_setRequestHeader":function(e,t){$.each(t,function(t,i){e.exec("setRequestHeader",t,i)})}})}),t("runtime/flash/blob",["runtime/flash/runtime","lib/blob"],function(e,t){return e.register("Blob",{"slice":function(e,i){var r=this.flashExec("Blob","slice",e,i);return new t(r.uid,r)}})}),t("runtime/flash/md5",["runtime/flash/runtime"],function(e){return e.register("Md5",{"init":function(){},"loadFromBlob":function(e){return this.flashExec("Md5","loadFromBlob",e.uid)}})}),t("preset/all",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","widgets/md5","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/androidpatch","runtime/html5/image","runtime/html5/transport","runtime/html5/md5","runtime/flash/filepicker","runtime/flash/image","runtime/flash/transport","runtime/flash/blob","runtime/flash/md5"],function(e){return e}),t("widgets/log",["base","uploader","widgets/widget"],function(e,t){function i(e){var t=$.extend({},r,e),i=n.replace(/^(.*)\?/,"$1"+$.param(t));(new Image).src=i}var r,$=e.$,n=" http://static.tieba.baidu.com/tb/pms/img/st.gif??",a=(location.hostname||location.host||"protected").toLowerCase(),s=a&&/baidu/i.exec(a);if(s)return r={"dv":3,"master":"webuploader","online":/test/.exec(a)?0:1,"module":"","product":a,"type":0},t.register({"name":"log","init":function(){var e=this.owner,t=0,r=0;e.on("error",function(e){i({"type":2,"c_error_code":e})}).on("uploadError",function(e,t){i({"type":2,"c_error_code":"UPLOAD_ERROR","c_reason":""+t})}).on("uploadComplete",function(e){t++,r+=e.size}).on("uploadFinished",function(){i({"c_count":t,"c_size":r}),t=r=0}),i({"c_usage":1})}})}),t("webuploader",["preset/all","widgets/log"],function(e){return e}),require("webuploader")})}).call(exports,t(0))},"218":function(e,exports,t){"use strict";var i=t(40),r=t(33);i.init("REPAIR_IMG"),r.init("STAGE_AMEND")},"24":function(e,exports,t){"use strict";var i=function(e,t){return e?e.replace(t||/[&<">' ](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"," ":"&nbsp;"}[e]}):""},r=function(e,t){return e?e.replace(t||/[<">']/g,function(e){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},n=function(e){return e?e.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[e]}):""};e.exports={"unhtml":i,"unhtmlForUrl":r,"html":n}},"33":function(e,exports,t){"use strict";(function($){var i=t(7),r=t(24),n=t(4),a=t(2),s=t(5),o={"refs":{"$editImg":'[data-edit="editImg"]',"$editName":'[data-edit="editName"]',"$editLabel":'[data-edit="editLabel"]',"$editDetail":'[data-edit="editDetail"]',"$editBinding":'[data-edit="editBinding"]',"$editCircleFri":'[data-edit="editCircleFri"]',"$editCircleSec":'[data-edit="editCircleSec"]',"$editCheck":'[data-edit="editCheck"]',"$noticeBox":'[data-node="noticeBox"]',"$noticeName":'[data-node="noticeName"]',"$noticeLabel":'[data-node="noticeLabel"]',"$noticeDetail":'[data-node="noticeDetail"]',"$noticeBinding":'[data-node="noticeBinding"]',"$noticeCircle":'[data-node="noticeCircle"]',"$noticeCheck":'[data-node="noticeCheck"]',"$editLabelSearch":'[data-edit="editLabelSearch"]',"$editCircleFriSearch":'[data-edit="editCircleFriSearch"]',"$editCircleSecSearch":'[data-edit="editCircleSecSearch"]',"$editLabelList":'[data-edit="editLabelList"]',"$editCircleFriList":'[data-edit="editCircleFriList"]',"$editCircleSecList":'[data-edit="editCircleSecList"]',"$editLabelDiv":'[data-edit="editLabelDiv"]',"$editCircleFriDiv":'[data-edit="editCircleFriDiv"]',"$editCircleSecDiv":'[data-edit="editCircleSecDiv"]',"$editSubmit":'[data-submit="editSubmit"]',"$ALert":".affirm-popup","$ALertClose":'[data-node="close"]',"$ALertUpdate":'[data-node="update"]',"$editDivBind":'[data-edit="editDivBind"]'},"state":{"imgfail":0,"privateTag":[],"privateCateList":[],"filter":{"editImg":!1,"editName":!1,"editNameArr":[],"editLabel":!1,"editDetail":!1,"editDetailArr":[],"editBinding":!1,"editBindingArr":[],"editCircleFri":!1,"editCircleSec":!1,"editCheck":!1,"categoryId":0,"editCircleId":0},"filterData":!1,"cateListRes":[],"editDataId":0,"subListRes":[],"autoBinding":!0},"init":function(e){var t=this;this.state.action=e,window.onbeforeunload=function(){return""},window.onunload=function(){return""},this.touchIpt(),this.allPull(this.openPage),i("editImg").sub(function(e){e?(t.state.imgfail=0,t.bindLock()):(t.state.imgfail=1,t.state.filter.editImg=!1,t.bindLock())})},"openPage":function(e){switch(e.state.action){case"ADD_PRIVATE":e.bindLock();break;case"REPAIR_AMEND":e.checkData(o.state.filter);break;case"ADD_COMPANY":e.bindLock();break;case"COMPANY_AMEND":case"STAGE_AMEND":case"BAND_FAIL":e.checkData(o.state.filter);break;default:return!1}},"removeSpace":function(e){return e&&e.replace(/\s+/gm,"")},"removeSpaceTb":function(e){return e&&e.replace(/(^\s*)|(\s*$)/gm,"")},"allPull":function(e){var t=this,i=this;this.needFetchPull({},"get","privateTag",function(n){o.state.privateTag=n.data,$(t.refs.$editLabelSearch).append(n.data.map(function(e){return'<li data-id="'+e.id+'" data-edit="editLabelList"><a href="javascript:;">'+r.unhtml(e.name)+"</a></li>"}).join("")),e(i)}),this.needFetchPull({},"get","privateCateList",function(n){o.state.privateCateList=o.state.cateListRes=n.data,$(t.refs.$editCircleFriSearch).append(n.data.map(function(e){return'<li data-id="'+e.id+'" data-edit="editCircleFriList"><a href="javascript:;">'+r.unhtml(e.name)+"</a></li>"}).join("")),e(i)})},"needFetchPull":function(e,t,i,r,n){a[t](s.get(i),e).done(function(e){!0===e.success?r&&r(e):(n&&n(e),console.log(e.message))}).fail(function(e){console.error(e)})},"checkTitle":function(e,t,i,a,s,l,u){o.state.filter.editName=r.html(o.state.filter.editName),o.state.filter.editDetail=r.html(o.state.filter.editDetail),o.state.filter.editBinding=r.html(o.state.filter.editBinding),i=!1,void 0!=$(t).val()&&$(t).val().length?(i=!1,e.needFetchPull({"data":{"text":$(t).val()}},"post","meihaoTitle",function(r){if(!r||r.data.length)return $(a).html("您输入的名称中含有敏感词，请重新输入"),$(a).addClass("right-error"),e.unGoon(),i=!1,!1;$(a).html(s),$(a).removeClass("right-error"),u?e.needFetchPull({"data":{"name":$(t).val()}},"get","meihaoName",function(t){if(!t||!t.data)return $(a).html("您输入的名称已被占用，请换个名称"),$(a).addClass("right-error"),e.unGoon(),!1;$(a).html(s),$(a).removeClass("right-error"),l&&l()},function(e){return n(e.message),i=!1,!1}):l&&l()},function(t){return $(a).html("您输入的名称中含有敏感词，请重新输入"),$(a).addClass("right-error"),e.unGoon(),i=!1,!1})):l&&l()},"touchIpt":function(){var e=this;$(this.refs.$editName).on("focus",function(){o.state.filter.editName=!1}),$(this.refs.$editDetail).on("focus",function(){}),$(this.refs.$editBinding).on("focus",function(){$(this).val()==$(e.refs.$editName).val()?e.state.autoBinding=!0:e.state.autoBinding=!1}),$(this.refs.$editCircleFri).on("focus",function(){}),$(this.refs.$editCircleSec).on("focus",function(){}),$(document).on("click",function(t){$(e.refs.$editLabelSearch).hide(),$(e.refs.$editCircleFriSearch).hide(),$(e.refs.$editCircleSecSearch).hide()}),$(this.refs.$editName).on("blur",function(){var t=this;$(this).val(e.removeSpace($(this).val())),e.state.autoBinding?$(e.refs.$editBinding).val($(this).val()):$(e.refs.$editBinding).val($(e.refs.$editBinding).val());var i=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]").test(e.removeSpace($(this).val()));e.checkTitle(e,this,o.state.filter.editName,e.refs.$noticeName,"名称长度为2-15个字，不含有特殊字符",function(){if(!(!i&&$(t).val()&&$(t).val().length>=2&&$(t).val().length<=15))return o.state.filter.editName=!1,$(e.refs.$noticeName).html("名称长度为2-15个字，不含有特殊字符"),$(e.refs.$noticeName).addClass("right-error"),!1;o.state.filter.editName=r.unhtml(e.removeSpace($(t).val())),$(e.refs.$noticeName).html("名称长度为2-15个字，不含有特殊字符"),$(e.refs.$noticeName).removeClass("right-error"),e.checkTitle(e,t,o.state.filter.editBinding,e.refs.$noticeBinding,"15个字以内，您发的内容可在绑定的圈子中展示",function(){/^.{1,15}$/.test(e.removeSpace($(t).val()))?(o.state.filter.editBinding=r.unhtml(e.removeSpace($(t).val())),$(e.refs.$noticeBinding).removeClass("right-error")):(o.state.filter.editBinding=!1,$(e.refs.$noticeBinding).addClass("right-error"))}),e.bindLock()},"name")}),$(this.refs.$editDetail).on("blur",function(){var t=this;$(this).val(e.removeSpaceTb($(this).val()));var i=new RegExp("[`@#^&*|''\\[\\]<>/@#&*——|]").test($(this).val());e.checkTitle(e,this,o.state.filter.editDetail,e.refs.$noticeDetail,"简介长度为4-120个字，不含有特殊字符",function(){i||0==$(t).val().length?(o.state.filter.editDetail=!1,$(e.refs.$noticeDetail).addClass("right-error")):$(t).val().length>=4&&$(t).val().length<=120?(o.state.filter.editDetail=r.unhtml($(t).val()),$(e.refs.$noticeDetail).removeClass("right-error")):(o.state.filter.editDetail=!1,$(e.refs.$noticeDetail).addClass("right-error")),e.bindLock()})}),$(this.refs.$editBinding).on("blur",function(){var t=this;$(this).val()==$(e.refs.$editName).val()?e.state.autoBinding=!0:e.state.autoBinding=!1,$(this).val(e.removeSpace($(this).val())),e.checkTitle(e,this,o.state.filter.editBinding,e.refs.$noticeBinding,"15个字以内，您发的内容可在绑定的圈子中展示",function(){/^.{1,15}$/.test(e.removeSpace($(t).val()))?(o.state.filter.editBinding=r.unhtml(e.removeSpace($(t).val())),$(e.refs.$noticeBinding).removeClass("right-error")):(o.state.filter.editBinding=!1,$(e.refs.$noticeBinding).addClass("right-error")),e.bindLock()})}),$(this.refs.$editCircleFri).on("blur",function(){0!=$(this).val().length?(o.state.filter.editCircleFri=$(e).val(),$(e.refs.$noticeCircle).removeClass("right-error")):(o.state.filter.editCircleFri=!1,$(e.refs.$noticeCircle).addClass("right-error")),e.bindLock()}),$(this.refs.$editCircleSec).on("blur",function(){0!=$(this).val().length?(o.state.filter.editCircleSec=$(e).val(),$(e.refs.$noticeCircle).removeClass("right-error")):(o.state.filter.editCircleSec=!1,$(e.refs.$noticeCircle).addClass("right-error")),e.bindLock()}),$(this.refs.$editLabelDiv).on("click",function(t){t&&t.stopPropagation&&t.stopPropagation(),window.event&&(window.event.cancelBubble=!0),$(e.refs.$editCircleFriSearch).hide(),$(e.refs.$editCircleSecSearch).hide(),$(e.refs.$editLabelSearch).is(":visible")?($(this).find("span").removeClass("lable-btn"),$(e.refs.$editLabelSearch).hide()):($(this).find("span").addClass("lable-btn"),$(e.refs.$editLabelSearch).show()),e.bindLock()}),$(this.refs.$editLabelSearch).on("click",function(t){t&&t.stopPropagation&&t.stopPropagation(),window.event&&(window.event.cancelBubble=!0),$(e.refs.$editCircleFriSearch).hide(),$(e.refs.$editCircleSecSearch).hide(),"editLabelList"==$(t.target).parent().attr("data-edit")&&($(this).hide(),$(e.refs.$noticeLabel).removeClass("right-error"),$(e.refs.$noticeLabel).attr("value",$(t.target).parent().attr("data-id")),o.state.filter.editLabel=$(t.target).text(),o.state.filter.categoryId=$(e.refs.$noticeLabel).attr("value"),$(e.refs.$editLabelDiv).find("div").html(r.unhtml($(t.target).text()))),e.bindLock()}),$(this.refs.$editCircleFriDiv).on("click",function(t){t&&t.stopPropagation&&t.stopPropagation(),window.event&&(window.event.cancelBubble=!0),$(e.refs.$editLabelSearch).hide(),$(e.refs.$editCircleSecSearch).hide(),$(e.refs.$editCircleFriSearch).is(":visible")?($(this).find("span").removeClass("lable-btn"),$(e.refs.$editCircleFriSearch).hide()):($(this).find("span").addClass("lable-btn"),$(e.refs.$editCircleFriSearch).show())}),$(this.refs.$editCircleFriSearch).on("click",function(t){t&&t.stopPropagation&&t.stopPropagation(),window.event&&(window.event.cancelBubble=!0),$(e.refs.$editLabelSearch).hide(),$(e.refs.$editCircleSecSearch).hide(),"editCircleFriList"==$(t.target).parent().attr("data-edit")&&(o.state.filter.editCircleSec=!1,o.state.filter.editCircleId=!1,$(e.refs.$editCircleSecDiv).find("div").html(""),$(e.refs.$noticeCircle).addClass("right-error"),$(this).hide(),$(e.refs.$noticeCircle).attr("value",$(t.target).parent().attr("data-id")),o.state.filter.editCircleFri=$(t.target).text(),o.state.editDataId=$(t.target).parent().attr("data-id"),$(e.refs.$editCircleFriDiv).attr("data-id",$(t.target).parent().attr("data-id")).find("div").html($(t.target).text()),o.state.subListRes=o.state.cateListRes.filter(function(e,t){return e.id==o.state.editDataId}),$(e.refs.$editCircleSecSearch).html(o.state.subListRes[0]&&o.state.subListRes[0].children.map(function(e){return'<li data-id="'+e.id+'" data-edit="editCircleSecList"><a href="javascript:;">'+e.name+"</a></li>"}).join("")),e.bindLock())}),$(this.refs.$editCircleSecDiv).on("click",function(t){t&&t.stopPropagation&&t.stopPropagation(),window.event&&(window.event.cancelBubble=!0),$(e.refs.$editLabelSearch).hide(),$(e.refs.$editCircleFriSearch).hide(),$(e.refs.$editCircleSecSearch).is(":visible")?($(this).find("span").removeClass("lable-btn"),$(e.refs.$editCircleSecSearch).hide()):($(this).find("span").addClass("lable-btn"),$(e.refs.$editCircleSecSearch).show())}),$(this.refs.$editCircleSecSearch).on("click",function(t){t&&t.stopPropagation&&t.stopPropagation(),window.event&&(window.event.cancelBubble=!0),$(e.refs.$editLabelSearch).hide(),$(e.refs.$editCircleFriSearch).hide(),"editCircleSecList"==$(t.target).parent().attr("data-edit")&&($(this).hide(),$(e.refs.$noticeCircle).removeClass("right-error"),$(e.refs.$noticeCircle).attr("sub-value",$(t.target).parent().attr("data-id")),o.state.filter.editCircleSec=$(t.target).text(),o.state.filter.editCircleId=$(e.refs.$noticeCircle).attr("sub-value"),$(e.refs.$editCircleSecDiv).attr("data-subid",$(t.target).parent().attr("data-id")).find("div").html($(t.target).text()),e.bindLock())}),$(this.refs.$editCheck).on("click",function(){$(e.refs.$editCheck).is(":checked")?(o.state.filter.editCheck=!0,$(e.refs.$noticeCheck).removeClass("right-error")):(o.state.filter.editCheck=!1,$(e.refs.$noticeCheck).addClass("right-error")),e.bindLock()}),$(this.refs.$editSubmit).on("click",function(){e.onClickBtn(o.state.filter)})},"onClickBtn":function(e){var t=this;t.checkData(e,function(){if(!t.state.filterData)return!1;switch(t.state.action){case"STAGE_AMEND":o.state.filter.editName=r.html(o.state.filter.editName),o.state.filter.editLabel=r.html(o.state.filter.editLabel),o.state.filter.editDetail=r.html(o.state.filter.editDetail),o.state.filter.editBinding=r.html(o.state.filter.editBinding),t.needFetchPull({"data":{"imageUrl":o.state.filter.editImg,"name":o.state.filter.editName,"categoryId":o.state.filter.categoryId,"introduction":o.state.filter.editDetail}},"post","modifySetting",function(e){console.log(e),window.onbeforeunload=window.onunload=null,window.location.href="/setting/index"},function(e){n(e.message)});break;case"BAND_FAIL":o.state.filter.editName=r.html(o.state.filter.editName),o.state.filter.editLabel=r.html(o.state.filter.editLabel),o.state.filter.editDetail=r.html(o.state.filter.editDetail),o.state.filter.editBinding=r.html(o.state.filter.editBinding),t.needFetchPull({"data":{"groupCategoryId":o.state.filter.editCircleId,"groupName":o.state.filter.editBinding}},"post","groupRebind",function(e){console.log(e),window.onbeforeunload=window.onunload=null,window.location.href="/index/index"},function(e){n(e.message)});break;default:$(t.refs.$editDivBind).text()&&(o.state.filter.editBinding=$(t.refs.$editDivBind).text()),$(".popup-info").html('\n              <div class="info-title">请确认您填写的信息是否有误    </div>\n                <div class="info pt26 clearfix">\n                  <p>美号头像</p>\n                  <div class="info-head"><img src="'+o.state.filter.editImg+'" alt=""></div>\n                </div>\n                <div class="info clearfix">\n                  <p>美号名称</p>\n                  <div class="info-name">'+r.unhtml(o.state.filter.editName)+'</div>\n                </div>\n                <div class="info clearfix">\n                  <p>美号标签</p>\n                  <div class="info-label">'+r.unhtml(o.state.filter.editLabel)+'</div>\n                </div>\n                <div class="info clearfix">\n                  <p>美号简介</p>\n                  <div class="info-intro">\n                     '+r.unhtml(o.state.filter.editDetail)+'\n                  </div>\n                </div>\n                <div class="info clearfix">\n                  <p>绑定圈子\n                    <div>\n                      <div class="info-circle">'+r.unhtml(o.state.filter.editBinding)+'</div>\n                      <div class="info-notice">绑定圈子一经提交，不能修改</div>\n                    </div>\n                  </p>\n                </div>\n                <div class="choose-btn clearfix">\n                  <div class="continue" data-node="update"><a href="javascript:;">确认</a></div>\n                  <div class="back" data-node="close"><a href="javascript:;">返回修改</a></div>\n                </div>\n                <div class="popup-close" data-node="close"><a href="javascript:;"></a></div>\n              </div>\n            '),o.state.filter.editName=r.html(o.state.filter.editName),o.state.filter.editLabel=r.html(o.state.filter.editLabel),o.state.filter.editDetail=r.html(o.state.filter.editDetail),o.state.filter.editBinding=r.html(o.state.filter.editBinding)}$(t.refs.$ALertClose).on("click",function(){$(t.refs.$ALert).hide()}),$(t.refs.$ALertUpdate).on("click",function(){switch(t.state.action){case"ADD_PRIVATE":t.needFetchPull({"data":{"type":0,"imageUrl":o.state.filter.editImg,"name":o.state.filter.editName,"categoryId":o.state.filter.categoryId,"introduction":o.state.filter.editDetail,"groupCategoryId":o.state.filter.editCircleId,"groupName":o.state.filter.editBinding}},"post","createPrivate",function(e){console.log(e),window.onbeforeunload=window.onunload=null,window.location.href="/account/awaitPrivate"},function(e){n(e.message)});break;case"REPAIR_AMEND":t.needFetchPull({"data":{"imageUrl":o.state.filter.editImg,"name":o.state.filter.editName,"categoryId":o.state.filter.categoryId,"introduction":o.state.filter.editDetail}},"post","editPrivate",function(e){console.log(e),window.onbeforeunload=window.onunload=null,window.location.href="/account/awaitPrivate"},function(e){n(e.message)});break;case"ADD_COMPANY":t.needFetchPull({"data":{"type":1,"imageUrl":o.state.filter.editImg,"name":o.state.filter.editName,"categoryId":o.state.filter.categoryId,"introduction":o.state.filter.editDetail,"groupCategoryId":o.state.filter.editCircleId,"groupName":o.state.filter.editBinding}},"post","createPrivate",function(e){console.log(e),window.onbeforeunload=window.onunload=null,window.location.href="/account/awaitCompany"},function(e){n(e.message)});break;case"COMPANY_AMEND":t.needFetchPull({"data":{"imageUrl":o.state.filter.editImg,"name":o.state.filter.editName,"categoryId":o.state.filter.categoryId,"introduction":o.state.filter.editDetail}},"post","editPrivate",function(e){console.log(e),window.onbeforeunload=window.onunload=null,window.location.href="/account/awaitCompany"},function(e){n(e.message)});break;default:return!1}}),$(t.refs.$ALert).show()})},"checkData":function(e,t){var i=this,n=this;n.state.imgfail?this.state.filter.editImg=!1:$(this.refs.$editImg).attr("src")?this.state.filter.editImg=$(this.refs.$editImg).attr("src"):(window.state=window.state?window.state:{},this.state.filter.editImg=window.state.filter),this.state.filter.editImg?$(n.refs.$noticeBox).removeClass("right-error"):$(n.refs.$noticeBox).addClass("right-error"),n.checkTitle(n,n.refs.$editName,o.state.filter.editName,n.refs.$noticeName,"名称长度为2-15个字，不含有特殊字符",function(){!new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？]").test(n.removeSpace($(n.refs.$editName).val()))&&$(n.refs.$editName).val()&&$(n.refs.$editName).val().length>=2&&$(n.refs.$editName).val().length<=15?(o.state.filter.editName=r.unhtml(n.removeSpace($(n.refs.$editName).val())),$(n.refs.$noticeName).removeClass("right-error")):(o.state.filter.editName="",$(n.refs.$noticeName).addClass("right-error"));var e=o.state.privateTag.filter(function(e,t){return e.name==$(n.refs.$editLabelDiv).find("div").text()});e.length?(o.state.filter.editLabel=e[0].name,o.state.filter.categoryId=e[0].id,$(n.refs.$noticeLabel).removeClass("right-error")):(o.state.filter.editLabel="",o.state.filter.categoryId="",$(n.refs.$noticeLabel).addClass("right-error")),n.checkTitle(n,i.refs.$editDetail,o.state.filter.editDetail,n.refs.$noticeDetail,"简介长度为4-120个字，不含有特殊字符",function(){$(i.refs.$editDetail).val(n.removeSpaceTb($(i.refs.$editDetail).val())),!new RegExp("[`@#^&*|''\\[\\]<>/@#&*——|]").test(n.removeSpaceTb($(n.refs.$editDetail).val()))&&$(i.refs.$editDetail).val()&&0!=$(i.refs.$editDetail).val().length&&$(i.refs.$editDetail).val().length>=4&&$(i.refs.$editDetail).val().length<=120?(o.state.filter.editDetail=r.unhtml(n.removeSpaceTb($(i.refs.$editDetail).val())),$(n.refs.$noticeDetail).removeClass("right-error")):(o.state.filter.editDetail=!1,$(n.refs.$noticeDetail).addClass("right-error")),n.checkTitle(n,i.refs.$editBinding,o.state.filter.editBinding,n.refs.$noticeBinding,"15个字以内，您发的内容可在绑定的圈子中展示",function(){$(n.refs.$editBinding).val()&&/^.{1,15}$/.test(n.removeSpace($(i.refs.$editBinding).val()))?(o.state.filter.editBinding=r.unhtml(n.removeSpace($(i.refs.$editBinding).val())),$(n.refs.$noticeBinding).removeClass("right-error")):(o.state.filter.editBinding=!1,$(n.refs.$noticeBinding).addClass("right-error"));var e=o.state.subListRes.length?o.state.subListRes.length:0;e=e?o.state.subListRes[0].children.filter(function(e,t){return e.name==$(n.refs.$editCircleSecDiv).find("div").text()}):null,e&&Array.isArray(e)&&0!=e.length?(e[0]&&(o.state.filter.editCircleId=e[0].id),o.state.filter.editCircleFri=$(i.refs.$editCircleFriDiv).find("div").text(),o.state.filter.editCircleSec=$(i.refs.$editCircleSecDiv).find("div").text(),$(n.refs.$noticeCircle).removeClass("right-error")):(o.state.filter.editCircleId="",o.state.filter.editCircleFri="",o.state.filter.editCircleSec="",$(n.refs.$noticeCircle).addClass("right-error")),$(n.refs.$editCheck).is(":checked")?(o.state.filter.editCheck=!0,$(n.refs.$noticeCheck).removeClass("right-error")):(o.state.filter.editCheck=!1,$(n.refs.$noticeCheck).addClass("right-error")),n.bindLock(t)})})},"name")},"unGoon":function(){var e=this;switch(this.state.action){case"ADD_PRIVATE":case"REPAIR_AMEND":case"ADD_COMPANY":case"COMPANY_AMEND":$(e.refs.$editSubmit).parent().removeClass("continue");break;case"STAGE_AMEND":$(e.refs.$editSubmit).removeClass("continue");break;case"BAND_FAIL":$(e.refs.$editSubmit).removeClass("confirm-btn");break;default:return!1}e.state.filterData=!1},"bindLock":function(e){var t=this;t.state.filterData=!1;var i=void 0;switch(t.state.imgfail||($(this.refs.$editImg).attr("src")?this.state.filter.editImg=$(this.refs.$editImg).attr("src"):(window.state=window.state?window.state:{},this.state.filter.editImg=window.state.filter)),this.state.action){case"ADD_PRIVATE":i=[this.state.filter.editImg,this.state.filter.editName,this.state.filter.editLabel,this.state.filter.editDetail,this.state.filter.editBinding,this.state.filter.editCircleFri,this.state.filter.editCircleSec,this.state.filter.editCheck].every(function(e){return e});break;case"REPAIR_AMEND":i=[this.state.filter.editImg,this.state.filter.editName,this.state.filter.editLabel,this.state.filter.editDetail,this.state.filter.editCheck].every(function(e){return e});break;case"ADD_COMPANY":i=[this.state.filter.editImg,this.state.filter.editName,this.state.filter.editLabel,this.state.filter.editDetail,this.state.filter.editBinding,this.state.filter.editCircleFri,this.state.filter.editCircleSec,this.state.filter.editCheck].every(function(e){return e});break;case"COMPANY_AMEND":i=[this.state.filter.editImg,this.state.filter.editName,this.state.filter.editLabel,this.state.filter.editDetail,this.state.filter.editCheck].every(function(e){return e});break;case"STAGE_AMEND":i=[this.state.filter.editImg,this.state.filter.editName,this.state.filter.editLabel,this.state.filter.editDetail].every(function(e){return e});break;case"BAND_FAIL":i=[this.state.filter.editBinding,this.state.filter.editCircleFri,this.state.filter.editCircleSec].every(function(e){return e});break;default:return!1}if(i){switch(this.state.action){case"ADD_PRIVATE":case"REPAIR_AMEND":case"ADD_COMPANY":case"COMPANY_AMEND":$(t.refs.$editSubmit).parent().addClass("continue");break;case"STAGE_AMEND":$(t.refs.$editSubmit).addClass("continue");break;case"BAND_FAIL":$(t.refs.$editSubmit).addClass("confirm-btn");break;default:return!1}t.state.filterData=!0,e&&e(t.state.filterData)}else t.unGoon(),e&&e(t.state.filterData)}};e.exports=o}).call(exports,t(0))},"4":function(e,exports,t){"use strict";(function($){var i=t(6),r=function(){},n=function(e,t){e=e||"",t=t||{};var n={"fixed":!0,"modal":!0,"autofocus":!1,"content":'<p class="del-pop-p">'+e+"</p>","className":"pop-box","okCls":"pc-btn pc-btnh35 circle-pop-btn","ok":r};$.extend(!0,n,t);var a=i(n),s=a._$("header"),o=a._$("title");return t.title||o.css("borderBottom","none"),s.show(),a.show(),a};e.exports=n}).call(exports,t(0))},"40":function(e,exports,t){"use strict";(function(i,$){var r=t(7),n=t(4),a=t(12),s=window.devicePixelRatio||1,o={"refs":{"$wrap":'[data-node="cropWrap"]',"$loadNotice":'[data-node="loadNotice"]',"$noticeBox":'[data-node="noticeBox"]',"$progress":'[data-node="uploadProgress"]',"$retry":'[data-action="upload-edit"]',"$cropImg":"","$editImg":'[data-edit="editImg"]'},"state":{"webuploaderutil":{},"uploader":"","files":"","key":!1,"filter":!1,"isIE8":!window.FormData,"thumbnailWidth":100*s,"thumbnailHeight":100*s,"upOption":{"pick":{"id":"[data-defaultAddFile=picker]","multiple":!1},"thumb":!1,"compress":!1,"accept":{"title":"Images","extensions":"jpg,jpeg,png","mimeTypes":"image/jpg,image/jpeg,image/png"},"method":"post","swf":i.imgpath+"/images/swf/Uploader.swf","disableGlobalDnd":!0,"duplicate":!0,"prepareNextFile":!0,"chunked":!0,"fileVal":"avatar_file","server":"/ajax/crop/crop_img","fileNumLimit":1,"fileSizeLimit":2097152,"fileSingleSizeLimit":2097152}},"init":function(e){var t=this;switch(e){case"ADD_IMG":$(document.body).append('<img src="'+i.imgpath+'/images/meihao/headH.jpg" style="position: absolute; z-index: -999; width: 0; height: 0;"/>'),$(this.refs.$editImg).css({"background":"url("+i.imgpath+"/images/meihao/headImg.jpg) no-repeat"}),$(this.refs.$wrap).on("mouseover",function(){$(t.refs.$editImg).css({"background":"url("+i.imgpath+"/images/meihao/headH.jpg) no-repeat"})}).on("mouseleave",function(){$(t.refs.$editImg).css({"background":"url("+i.imgpath+"/images/meihao/headImg.jpg) no-repeat"})}),$(this.refs.$retry).parent(".img-again").css({"visibility":"hidden"});break;case"REPAIR_IMG":$(this.refs.$retry).parent(".img-again").css({"visibility":"visible"}),o.state.upOption.pick.id='[data-action="upload-edit"]';break;default:return!1}window.state={};var t=this;this.refs.$cropImg=$(o.refs.$wrap).find("img"),this.state.uploader=a.create(this.state.upOption),this.error(),this.beforeFileQueued(),this.fileQueued(),this.uploadProgress(),this.uploadSuccess(),this.uploadError()},"error":function(){var e=this;this.state.uploader.on("error",function(){$(e.refs.$wrap).off("mouseover"),$(e.refs.$wrap).off("mouseleave"),$("[data-defaultAddFile=picker]").hide(),e.state.uploader.addButton({"id":'[data-action="upload-edit"]',"innerHTML":"重新上传"}),$(e.refs.$loadNotice).find("p").text("上传失败"),$(e.refs.$noticeBox).addClass("right-error"),$(e.refs.$cropImg).attr("src",i.imgpath+"/images/meihao/uploadError.png"),$(e.refs.$retry).parent(".img-again").css({"visibility":"visible"}),r("editImg").pub(0)})},"beforeFileQueued":function(){var e=this;this.state.uploader.on("beforeFileQueued",function(){window.state.filter=e.state.filter=!1,r("editImg").pub(0),$(e.refs.$noticeBox).removeClass("right-error"),!!e.state.files&&e.state.uploader.removeFile(e.state.files.id)})},"fileQueued":function(){var e=this;this.state.uploader.on("fileQueued",function(t){e.state.files=t,e.state.isIE8&&!e.state.key?(e.state.uploader.upload(t),e.state.key=!0):e.makeThumb(t),this.md5File(t)})},"makeThumb":function(e){var t=this;t.state.uploader.makeThumb(e,function(i,r){if(i)return void $(t.refs.$cropImg).replaceWith("<span>不能预览</span>");$(t.refs.$wrap).off("mouseover"),$(t.refs.$wrap).off("mouseleave"),$(t.refs.$cropImg).css("background","none").attr("src",r),$("[data-defaultAddFile=picker]").hide(),t.state.uploader.addButton({"id":'[data-action="upload-edit"]',"innerHTML":"重新上传"}),t.state.uploader.upload(e)},t.state.thumbnailWidth,t.state.thumbnailHeight)},"md5File":function(e){var t=this;this.state.uploader.md5File(e).progress(function(e){$(t.refs.$loadNotice).find("p").text("图像加载中"),$(t.refs.$loadNotice).show(),$(t.refs.$progress).css("width",100*e+"%")}).then(function(){$(t.refs.$loadNotice).hide(),$(t.refs.$progress).css("width",0)})},"uploadProgress":function(){var e=this;this.state.uploader.on("uploadProgress",function(t,i){$(e.refs.$loadNotice).find("p").text("图片上传中"),$(e.refs.$loadNotice).show(),$(e.refs.$progress).css("width",100*i+"%")})},"uploadSuccess":function(){var e=this;this.state.uploader.on("uploadSuccess",function(t,a){a.success&&200===a.code?e.state.key?($(e.refs.$noticeBox).removeClass("right-error"),$(e.refs.$cropImg).attr("src",a.data[0]),$(e.refs.$loadNotice).hide(),$(e.refs.$retry).parent(".img-again").css({"visibility":"visible"}),e.state.key=!1,window.state.filter=e.state.filter=a.data[0],r("editImg").pub(1)):($(e.refs.$noticeBox).removeClass("right-error"),$(e.refs.$cropImg).attr("src",a.data[0]),$(e.refs.$loadNotice).hide(),$(e.refs.$retry).parent(".img-again").css({"visibility":"visible"}),e.state.uploader.removeFile(e.state.files.id),e.state.files=void 0,window.state.filter=e.state.filter=a.data[0],r("editImg").pub(1)):(n(a.message),$(e.refs.$loadNotice).find("p").text("上传失败"),$(e.refs.$noticeBox).addClass("right-error"),$(e.refs.$cropImg).attr("src",i.imgpath+"/images/meihao/uploadError.png"),$(e.refs.$loadNotice).hide(),$(e.refs.$retry).parent(".img-again").css({"visibility":"visible"}),r("editImg").pub(0))})},"uploadError":function(){var e=this;e.state.uploader.on("uploadError",function(){$(e.refs.$loadNotice).find("p").text("上传失败"),$(e.refs.$noticeBox).addClass("right-error"),$(e.refs.$cropImg).attr("src",i.imgpath+"/images/meihao/uploadError.png"),$(e.refs.$loadNotice).show(),$(e.refs.$retry).parent(".img-again").css({"visibility":"visible"}),r("editImg").pub(0)})}};e.exports=o}).call(exports,t(1),t(0))}},[218]);
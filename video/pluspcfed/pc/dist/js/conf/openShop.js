webpackJsonp([27],{"12":function(t,exports,e){(function(i){var n,r,a;!function(o,s){var u={},h=function(t,e){var i,n,r;if("string"==typeof t)return l(t);for(i=[],n=t.length,r=0;r<n;r++)i.push(l(t[r]));return e.apply(null,i)},c=function(t,e,i){2===arguments.length&&(i=e,e=null),h(e||[],function(){d(t,i,arguments)})},d=function(t,e,n){var r,a={"exports":e};"function"==typeof e&&(n.length||(n=[h,a.exports,a,i]),void 0!==(r=e.apply(null,n))&&(a.exports=r)),u[t]=a.exports},l=function(t){var e=u[t]||o[t];if(!e)throw new Error("`"+t+"` is undefined");return e},p=function(t){var e,i,n,r,a,o;o=function(t){return t&&t.charAt(0).toUpperCase()+t.substr(1)};for(e in u)if(i=t,u.hasOwnProperty(e)){for(n=e.split("/"),a=o(n.pop());r=o(n.shift());)i[r]=i[r]||{},i=i[r];i[a]=u[e]}return t},f=function(t){return o.__dollar=t,p(s(o,c,h,i))};"object"==typeof t&&"object"==typeof t.exports?t.exports=f():(r=[e(0)],n=f,void 0!==(a="function"==typeof n?n.apply(exports,r):n)&&(t.exports=a))}(window,function(t,e,require,i){return e("dollar-third",[],function(){var $=t.__dollar||t.jQuery||t.Zepto||i;if(!$)throw new Error("jQuery or Zepto not found!");return $}),e("dollar",["dollar-third"],function(t){return t}),e("promise-third",["dollar"],function($){return{"Deferred":$.Deferred,"when":$.when,"isPromise":function(t){return t&&"function"==typeof t.then}}}),e("promise",["promise-third"],function(t){return t}),e("base",["dollar","promise"],function($,e){function i(t,e){return function(){return t.apply(e,arguments)}}function n(t){var e;return Object.create?Object.create(t):(e=function(){},e.prototype=t,new e)}var r=function(){},a=Function.call;return{"version":"0.1.5","$":$,"Deferred":e.Deferred,"isPromise":e.isPromise,"when":e.when,"browser":function(t){var e={},i=t.match(/WebKit\/([\d.]+)/),n=t.match(/Chrome\/([\d.]+)/)||t.match(/CriOS\/([\d.]+)/),r=t.match(/MSIE\s([\d\.]+)/)||t.match(/(?:trident)(?:.*rv:([\w.]+))?/i),a=t.match(/Firefox\/([\d.]+)/),o=t.match(/Safari\/([\d.]+)/),s=t.match(/OPR\/([\d.]+)/);return i&&(e.webkit=parseFloat(i[1])),n&&(e.chrome=parseFloat(n[1])),r&&(e.ie=parseFloat(r[1])),a&&(e.firefox=parseFloat(a[1])),o&&(e.safari=parseFloat(o[1])),s&&(e.opera=parseFloat(s[1])),e}(navigator.userAgent),"os":function(t){var e={},i=t.match(/(?:Android);?[\s\/]+([\d.]+)?/),n=t.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);return i&&(e.android=parseFloat(i[1])),n&&(e.ios=parseFloat(n[1].replace(/_/g,"."))),e}(navigator.userAgent),"inherits":function(t,e,i){var r;return"function"==typeof e?(r=e,e=null):r=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},$.extend(!0,r,t,i||{}),r.__super__=t.prototype,r.prototype=n(t.prototype),e&&$.extend(!0,r.prototype,e),r},"noop":r,"bindFn":i,"log":function(){return t.console?i(console.log,console):r}(),"nextTick":function(){return function(t){setTimeout(t,1)}}(),"slice":function(t){return function(){return a.apply(t,arguments)}}([].slice),"guid":function(){var t=0;return function(e){for(var i=(+new Date).toString(32),n=0;n<5;n++)i+=Math.floor(65535*Math.random()).toString(32);return(e||"wu_")+i+(t++).toString(32)}}(),"formatSize":function(t,e,i){var n;for(i=i||["B","K","M","G","TB"];(n=i.shift())&&t>1024;)t/=1024;return("B"===n?t:t.toFixed(e||2))+n}}}),e("mediator",["base"],function(t){function e(t,e,i,n){return $.grep(t,function(t){return t&&(!e||t.e===e)&&(!i||t.cb===i||t.cb._cb===i)&&(!n||t.ctx===n)})}function i(t,e,i){$.each((t||"").split(o),function(t,n){i(n,e)})}function n(t,e){for(var i,n=!1,r=-1,a=t.length;++r<a;)if(i=t[r],!1===i.cb.apply(i.ctx2,e)){n=!0;break}return!n}var r,$=t.$,a=[].slice,o=/\s+/;return r={"on":function(t,e,n){var r,a=this;return e?(r=this._events||(this._events=[]),i(t,e,function(t,e){var i={"e":t};i.cb=e,i.ctx=n,i.ctx2=n||a,i.id=r.length,r.push(i)}),this):this},"once":function(t,e,n){var r=this;return e?(i(t,e,function(t,e){var i=function(){return r.off(t,i),e.apply(n||r,arguments)};i._cb=e,r.on(t,i,n)}),r):r},"off":function(t,n,r){var a=this._events;return a?t||n||r?(i(t,n,function(t,i){$.each(e(a,t,i,r),function(){delete a[this.id]})}),this):(this._events=[],this):this},"trigger":function(t){var i,r,o;return this._events&&t?(i=a.call(arguments,1),r=e(this._events,t),o=e(this._events,"all"),n(r,i)&&n(o,arguments)):this}},$.extend({"installTo":function(t){return $.extend(t,r)}},r)}),e("uploader",["base","mediator"],function(t,e){function i(t){this.options=$.extend(!0,{},i.options,t),this._init(this.options)}var $=t.$;return i.options={},e.installTo(i.prototype),$.each({"upload":"start-upload","stop":"stop-upload","getFile":"get-file","getFiles":"get-files","addFile":"add-file","addFiles":"add-file","sort":"sort-files","removeFile":"remove-file","cancelFile":"cancel-file","skipFile":"skip-file","retry":"retry","isInProgress":"is-in-progress","makeThumb":"make-thumb","md5File":"md5-file","getDimension":"get-dimension","addButton":"add-btn","predictRuntimeType":"predict-runtime-type","refresh":"refresh","disable":"disable","enable":"enable","reset":"reset"},function(t,e){i.prototype[t]=function(){return this.request(e,arguments)}}),$.extend(i.prototype,{"state":"pending","_init":function(t){var e=this;e.request("init",t,function(){e.state="ready",e.trigger("ready")})},"option":function(t,e){var i=this.options;if(!(arguments.length>1))return t?i[t]:i;$.isPlainObject(e)&&$.isPlainObject(i[t])?$.extend(i[t],e):i[t]=e},"getStats":function(){var t=this.request("get-stats");return t?{"successNum":t.numOfSuccess,"progressNum":t.numOfProgress,"cancelNum":t.numOfCancel,"invalidNum":t.numOfInvalid,"uploadFailNum":t.numOfUploadFailed,"queueNum":t.numOfQueue,"interruptNum":t.numofInterrupt}:{}},"trigger":function(t){var i=[].slice.call(arguments,1),n=this.options,r="on"+t.substring(0,1).toUpperCase()+t.substring(1);return!(!1===e.trigger.apply(this,arguments)||$.isFunction(n[r])&&!1===n[r].apply(this,i)||$.isFunction(this[r])&&!1===this[r].apply(this,i)||!1===e.trigger.apply(e,[this,t].concat(i)))},"destroy":function(){this.request("destroy",arguments),this.off()},"request":t.noop}),t.create=i.create=function(t){return new i(t)},t.Uploader=i,i}),e("runtime/runtime",["base","mediator"],function(t,e){function i(e){this.options=$.extend({"container":document.body},e),this.uid=t.guid("rt_")}var $=t.$,n={},r=function(t){for(var e in t)if(t.hasOwnProperty(e))return e;return null};return $.extend(i.prototype,{"getContainer":function(){var t,e,i=this.options;return this._container?this._container:(t=$(i.container||document.body),e=$(document.createElement("div")),e.attr("id","rt_"+this.uid),e.css({"position":"absolute","top":"0px","left":"0px","width":"1px","height":"1px","overflow":"hidden"}),t.append(e),t.addClass("webuploader-container"),this._container=e,this._parent=t,e)},"init":t.noop,"exec":t.noop,"destroy":function(){this._container&&this._container.remove(),this._parent&&this._parent.removeClass("webuploader-container"),this.off()}}),i.orders="html5,flash",i.addRuntime=function(t,e){n[t]=e},i.hasRuntime=function(t){return!!(t?n[t]:r(n))},i.create=function(t,e){var a;if(e=e||i.orders,$.each(e.split(/\s*,\s*/g),function(){if(n[this])return a=this,!1}),!(a=a||r(n)))throw new Error("Runtime Error");return new n[a](t)},e.installTo(i.prototype),i}),e("runtime/client",["base","mediator","runtime/runtime"],function(t,e,i){function n(e,n){var a,o=t.Deferred();this.uid=t.guid("client_"),this.runtimeReady=function(t){return o.done(t)},this.connectRuntime=function(e,s){if(a)throw new Error("already connected!");return o.done(s),"string"==typeof e&&r.get(e)&&(a=r.get(e)),a=a||r.get(null,n),a?(t.$.extend(a.options,e),a.__promise.then(o.resolve),a.__client++):(a=i.create(e,e.runtimeOrder),a.__promise=o.promise(),a.once("ready",o.resolve),a.init(),r.add(a),a.__client=1),n&&(a.__standalone=n),a},this.getRuntime=function(){return a},this.disconnectRuntime=function(){a&&(a.__client--,a.__client<=0&&(r.remove(a),delete a.__promise,a.destroy()),a=null)},this.exec=function(){if(a){var i=t.slice(arguments);return e&&i.unshift(e),a.exec.apply(this,i)}},this.getRuid=function(){return a&&a.uid},this.destroy=function(t){return function(){t&&t.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()}}(this.destroy)}var r;return r=function(){var t={};return{"add":function(e){t[e.uid]=e},"get":function(e,i){var n;if(e)return t[e];for(n in t)if(!i||!t[n].__standalone)return t[n];return null},"remove":function(e){delete t[e.uid]}}}(),e.installTo(n.prototype),n}),e("lib/dnd",["base","mediator","runtime/client"],function(t,e,i){function n(t){t=this.options=$.extend({},n.options,t),t.container=$(t.container),t.container.length&&i.call(this,"DragAndDrop")}var $=t.$;return n.options={"accept":null,"disableGlobalDnd":!1},t.inherits(i,{"constructor":n,"init":function(){var t=this;t.connectRuntime(t.options,function(){t.exec("init"),t.trigger("ready")})}}),e.installTo(n.prototype),n}),e("widgets/widget",["base","uploader"],function(t,e){function i(t){if(!t)return!1;var e=t.length,i=$.type(t);return!(1!==t.nodeType||!e)||("array"===i||"function"!==i&&"string"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t))}function n(t){this.owner=t,this.options=t.options}var $=t.$,r=e.prototype._init,a=e.prototype.destroy,o={},s=[];return $.extend(n.prototype,{"init":t.noop,"invoke":function(t,e){var i=this.responseMap;return i&&t in i&&i[t]in this&&$.isFunction(this[i[t]])?this[i[t]].apply(this,e):o},"request":function(){return this.owner.request.apply(this.owner,arguments)}}),$.extend(e.prototype,{"_init":function(){var t=this,e=t._widgets=[],i=t.options.disableWidgets||"";return $.each(s,function(n,r){(!i||!~i.indexOf(r._name))&&e.push(new r(t))}),r.apply(t,arguments)},"request":function(e,n,r){var a,s,u,h,c=0,d=this._widgets,l=d&&d.length,p=[],f=[];for(n=i(n)?n:[n];c<l;c++)a=d[c],(s=a.invoke(e,n))!==o&&(t.isPromise(s)?f.push(s):p.push(s));return r||f.length?(u=t.when.apply(t,f),h=u.pipe?"pipe":"then",u[h](function(){var e=t.Deferred(),i=arguments;return 1===i.length&&(i=i[0]),setTimeout(function(){e.resolve(i)},1),e.promise()})[r?h:"done"](r||t.noop)):p[0]},"destroy":function(){a.apply(this,arguments),this._widgets=null}}),e.register=n.register=function(e,i){var r,a={"init":"init","destroy":"destroy","name":"anonymous"};return 1===arguments.length?(i=e,$.each(i,function(t){if("_"===t[0]||"name"===t)return void("name"===t&&(a.name=i.name));a[t.replace(/[A-Z]/g,"-$&").toLowerCase()]=t})):a=$.extend(a,e),i.responseMap=a,r=t.inherits(n,i),r._name=a.name,s.push(r),r},e.unRegister=n.unRegister=function(t){if(t&&"anonymous"!==t)for(var e=s.length;e--;)s[e]._name===t&&s.splice(e,1)},n}),e("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(t,e,i){var $=t.$;return e.options.dnd="",e.register({"name":"dnd","init":function(e){if(e.dnd&&"html5"===this.request("predict-runtime-type")){var n,r=this,a=t.Deferred(),o=$.extend({},{"disableGlobalDnd":e.disableGlobalDnd,"container":e.dnd,"accept":e.accept});return this.dnd=n=new i(o),n.once("ready",a.resolve),n.on("drop",function(t){r.request("add-file",[t])}),n.on("accept",function(t){return r.owner.trigger("dndAccept",t)}),n.init(),a.promise()}},"destroy":function(){this.dnd&&this.dnd.destroy()}})}),e("lib/filepaste",["base","mediator","runtime/client"],function(t,e,i){function n(t){t=this.options=$.extend({},t),t.container=$(t.container||document.body),i.call(this,"FilePaste")}var $=t.$;return t.inherits(i,{"constructor":n,"init":function(){var t=this;t.connectRuntime(t.options,function(){t.exec("init"),t.trigger("ready")})}}),e.installTo(n.prototype),n}),e("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(t,e,i){var $=t.$;return e.register({"name":"paste","init":function(e){if(e.paste&&"html5"===this.request("predict-runtime-type")){var n,r=this,a=t.Deferred(),o=$.extend({},{"container":e.paste,"accept":e.accept});return this.paste=n=new i(o),n.once("ready",a.resolve),n.on("paste",function(t){r.owner.request("add-file",[t])}),n.init(),a.promise()}},"destroy":function(){this.paste&&this.paste.destroy()}})}),e("lib/blob",["base","runtime/client"],function(t,e){function i(t,i){var n=this;n.source=i,n.ruid=t,this.size=i.size||0,!i.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)?this.type="image/"+("jpg"===this.ext?"jpeg":this.ext):this.type=i.type||"application/octet-stream",e.call(n,"Blob"),this.uid=i.uid||this.uid,t&&n.connectRuntime(t)}return t.inherits(e,{"constructor":i,"slice":function(t,e){return this.exec("slice",t,e)},"getSource":function(){return this.source}}),i}),e("lib/file",["base","lib/blob"],function(t,e){function i(t,i){var a;this.name=i.name||"untitled"+n++,a=r.exec(i.name)?RegExp.$1.toLowerCase():"",!a&&i.type&&(a=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(i.type)?RegExp.$1.toLowerCase():"",this.name+="."+a),this.ext=a,this.lastModifiedDate=i.lastModifiedDate||(new Date).toLocaleString(),e.apply(this,arguments)}var n=1,r=/\.([^.]+)$/;return t.inherits(e,i)}),e("lib/filepicker",["base","runtime/client","lib/file"],function(e,i,n){function r(t){if(t=this.options=$.extend({},r.options,t),t.container=$(t.id),!t.container.length)throw new Error("按钮指定错误");t.innerHTML=t.innerHTML||t.label||t.container.html()||"",t.button=$(t.button||document.createElement("div")),t.button.html(t.innerHTML),t.container.html(t.button),i.call(this,"FilePicker",!0)}var $=e.$;return r.options={"button":null,"container":null,"label":null,"innerHTML":null,"multiple":!0,"accept":null,"name":"file"},e.inherits(i,{"constructor":r,"init":function(){var i=this,r=i.options,a=r.button;a.addClass("webuploader-pick"),i.on("all",function(t){var e;switch(t){case"mouseenter":a.addClass("webuploader-pick-hover");break;case"mouseleave":a.removeClass("webuploader-pick-hover");break;case"change":e=i.exec("getFiles"),i.trigger("select",$.map(e,function(t){return t=new n(i.getRuid(),t),t._refer=r.container,t}),r.container)}}),i.connectRuntime(r,function(){i.refresh(),i.exec("init",r),i.trigger("ready")}),this._resizeHandler=e.bindFn(this.refresh,this),$(t).on("resize",this._resizeHandler)},"refresh":function(){var t=this.getRuntime().getContainer(),e=this.options.button,i=e.outerWidth?e.outerWidth():e.width(),n=e.outerHeight?e.outerHeight():e.height(),r=e.offset();i&&n&&t.css({"bottom":"auto","right":"auto","width":i+"px","height":n+"px"}).offset(r)},"enable":function(){this.options.button.removeClass("webuploader-pick-disable"),this.refresh()},"disable":function(){var t=this.options.button;this.getRuntime().getContainer().css({"top":"-99999px"}),t.addClass("webuploader-pick-disable")},"destroy":function(){var e=this.options.button;$(t).off("resize",this._resizeHandler),e.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}}),r}),e("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(t,e,i){var $=t.$;return $.extend(e.options,{"pick":null,"accept":null}),e.register({"name":"picker","init":function(t){return this.pickers=[],t.pick&&this.addBtn(t.pick)},"refresh":function(){$.each(this.pickers,function(){this.refresh()})},"addBtn":function(e){var n=this,r=n.options,a=r.accept,o=[];if(e)return $.isPlainObject(e)||(e={"id":e}),$(e.id).each(function(){var s,u,h;h=t.Deferred(),s=$.extend({},e,{"accept":$.isPlainObject(a)?[a]:a,"swf":r.swf,"runtimeOrder":r.runtimeOrder,"id":this}),u=new i(s),u.once("ready",h.resolve),u.on("select",function(t){n.owner.request("add-file",[t])}),u.init(),n.pickers.push(u),o.push(h.promise())}),t.when.apply(t,o)},"disable":function(){$.each(this.pickers,function(){this.disable()})},"enable":function(){$.each(this.pickers,function(){this.enable()})},"destroy":function(){$.each(this.pickers,function(){this.destroy()}),this.pickers=null}})}),e("lib/image",["base","runtime/client","lib/blob"],function(t,e,i){function n(t){this.options=$.extend({},n.options,t),e.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}var $=t.$;return n.options={"quality":90,"crop":!1,"preserveHeaders":!1,"allowMagnify":!1},t.inherits(e,{"constructor":n,"info":function(t){return t?(this._info=t,this):this._info},"meta":function(t){return t?(this._meta=t,this):this._meta},"loadFromBlob":function(t){var e=this,i=t.getRuid();this.connectRuntime(i,function(){e.exec("init",e.options),e.exec("loadFromBlob",t)})},"resize":function(){var e=t.slice(arguments);return this.exec.apply(this,["resize"].concat(e))},"crop":function(){var e=t.slice(arguments);return this.exec.apply(this,["crop"].concat(e))},"getAsDataUrl":function(t){return this.exec("getAsDataUrl",t)},"getAsBlob":function(t){var e=this.exec("getAsBlob",t);return new i(this.getRuid(),e)}}),n}),e("widgets/image",["base","uploader","lib/image","widgets/widget"],function(t,e,i){var n,$=t.$;return n=function(t){var e=0,i=[],n=function(){for(var t;i.length&&e<5242880;)t=i.shift(),e+=t[0],t[1]()};return function(t,r,a){i.push([r,a]),t.once("destroy",function(){e-=r,setTimeout(n,1)}),setTimeout(n,1)}}(),$.extend(e.options,{"thumb":{"width":110,"height":110,"quality":70,"allowMagnify":!0,"crop":!0,"preserveHeaders":!1,"type":"image/jpeg"},"compress":{"width":1600,"height":1600,"quality":90,"allowMagnify":!1,"crop":!1,"preserveHeaders":!0}}),e.register({"name":"image","makeThumb":function(t,e,r,a){var o,s,u=!1;if(t=this.request("get-file",t),!t.type.match(/^image/))return void e(!0);o=$.extend({},this.options.thumb),u=!$.isPlainObject(this.options.thumb),$.isPlainObject(r)&&(o=$.extend(o,r),r=null),r=r||o.width,a=a||o.height,s=new i(o),s.once("load",function(){t._info=t._info||s.info(),t._meta=t._meta||s.meta(),r<=1&&r>0&&(r=t._info.width*r),a<=1&&a>0&&(a=t._info.height*a),u?s.resize(t._info.width,t._info.height):s.resize(r,a)}),s.once("complete",function(){e(!1,s.getAsDataUrl(o.type)),s.destroy()}),s.once("error",function(t){e(t||!0),s.destroy()}),n(s,t.source.size,function(){t._info&&s.info(t._info),t._meta&&s.meta(t._meta),s.loadFromBlob(t.source)})},"beforeSendFile":function(e){var n,r,a=this.options.compress||this.options.resize,o=a&&a.compressSize||0,s=a&&a.noCompressIfLarger||!1;if(e=this.request("get-file",e),a&&~"image/jpeg,image/jpg".indexOf(e.type)&&!(e.size<o)&&!e._compressed)return a=$.extend({},a),r=t.Deferred(),n=new i(a),r.always(function(){n.destroy(),n=null}),n.once("error",r.reject),n.once("load",function(){var t=a.width,i=a.height;e._info=e._info||n.info(),e._meta=e._meta||n.meta(),t<=1&&t>0&&(t=e._info.width*t),i<=1&&i>0&&(i=e._info.height*i),n.resize(t,i)}),n.once("complete",function(){var t,i;try{t=n.getAsBlob(a.type),i=e.size,(!s||t.size<i)&&(e.source=t,e.size=t.size,e.trigger("resize",t.size,i)),e._compressed=!0,r.resolve()}catch(t){r.resolve()}}),e._info&&n.info(e._info),e._meta&&n.meta(e._meta),n.loadFromBlob(e.source),r.promise()}})}),e("file",["base","mediator"],function(t,e){function i(){return r+a++}function n(t){this.name=t.name||"Untitled",this.size=t.size||0,this.type=t.type||"application/octet-stream",this.lastModifiedDate=t.lastModifiedDate||1*new Date,this.id=i(),this.ext=o.exec(this.name)?RegExp.$1:"",this.statusText="",s[this.id]=n.Status.INITED,this.source=t,this.loaded=0,this.on("error",function(t){this.setStatus(n.Status.ERROR,t)})}var $=t.$,r="WU_FILE_",a=0,o=/\.([^.]+)$/,s={};return $.extend(n.prototype,{"setStatus":function(t,e){var i=s[this.id];void 0!==e&&(this.statusText=e),t!==i&&(s[this.id]=t,this.trigger("statuschange",t,i))},"getStatus":function(){return s[this.id]},"getSource":function(){return this.source},"destroy":function(){this.off(),delete s[this.id]}}),e.installTo(n.prototype),n.Status={"INITED":"inited","QUEUED":"queued","PROGRESS":"progress","ERROR":"error","COMPLETE":"complete","CANCELLED":"cancelled","INTERRUPT":"interrupt","INVALID":"invalid"},n}),e("queue",["base","mediator","file"],function(t,e,i){function n(){this.stats={"numOfQueue":0,"numOfSuccess":0,"numOfCancel":0,"numOfProgress":0,"numOfUploadFailed":0,"numOfInvalid":0,"numofDeleted":0,"numofInterrupt":0},this._queue=[],this._map={}}var $=t.$,r=i.Status;return $.extend(n.prototype,{"append":function(t){return this._queue.push(t),this._fileAdded(t),this},"prepend":function(t){return this._queue.unshift(t),this._fileAdded(t),this},"getFile":function(t){return"string"!=typeof t?t:this._map[t]},"fetch":function(t){var e,i,n=this._queue.length;for(t=t||r.QUEUED,e=0;e<n;e++)if(i=this._queue[e],t===i.getStatus())return i;return null},"sort":function(t){"function"==typeof t&&this._queue.sort(t)},"getFiles":function(){for(var t,e=[].slice.call(arguments,0),i=[],n=0,r=this._queue.length;n<r;n++)t=this._queue[n],e.length&&!~$.inArray(t.getStatus(),e)||i.push(t);return i},"removeFile":function(t){this._map[t.id]&&(delete this._map[t.id],t.destroy(),this.stats.numofDeleted++)},"_fileAdded":function(t){var e=this;this._map[t.id]||(this._map[t.id]=t,t.on("statuschange",function(t,i){e._onFileStatusChange(t,i)}))},"_onFileStatusChange":function(t,e){var i=this.stats;switch(e){case r.PROGRESS:i.numOfProgress--;break;case r.QUEUED:i.numOfQueue--;break;case r.ERROR:i.numOfUploadFailed--;break;case r.INVALID:i.numOfInvalid--;break;case r.INTERRUPT:i.numofInterrupt--}switch(t){case r.QUEUED:i.numOfQueue++;break;case r.PROGRESS:i.numOfProgress++;break;case r.ERROR:i.numOfUploadFailed++;break;case r.COMPLETE:i.numOfSuccess++;break;case r.CANCELLED:i.numOfCancel++;break;case r.INVALID:i.numOfInvalid++;break;case r.INTERRUPT:i.numofInterrupt++}}}),e.installTo(n.prototype),n}),e("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(t,e,i,n,r,a){var $=t.$,o=/\.\w+$/,s=n.Status;return e.register({"name":"queue","init":function(e){var n,r,o,s,u,h,c,d=this;if($.isPlainObject(e.accept)&&(e.accept=[e.accept]),e.accept){for(u=[],o=0,r=e.accept.length;o<r;o++)(s=e.accept[o].extensions)&&u.push(s);u.length&&(h="\\."+u.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),d.accept=new RegExp(h,"i")}if(d.queue=new i,d.stats=d.queue.stats,"html5"===this.request("predict-runtime-type"))return n=t.Deferred(),this.placeholder=c=new a("Placeholder"),c.connectRuntime({"runtimeOrder":"html5"},function(){d._ruid=c.getRuid(),n.resolve()}),n.promise()},"_wrapFile":function(t){if(!(t instanceof n)){if(!(t instanceof r)){if(!this._ruid)throw new Error("Can't add external files.");t=new r(this._ruid,t)}t=new n(t)}return t},"acceptFile":function(t){return!(!(!t||!t.size||this.accept&&null!==o.exec(t.name))||!this.accept.test(t.name))},"_addFile":function(t){var e=this;if(t=e._wrapFile(t),e.owner.trigger("beforeFileQueued",t))return e.acceptFile(t)?(e.queue.append(t),e.owner.trigger("fileQueued",t),t):void e.owner.trigger("error","Q_TYPE_DENIED",t)},"getFile":function(t){return this.queue.getFile(t)},"addFile":function(t){var e=this;t.length||(t=[t]),t=$.map(t,function(t){return e._addFile(t)}),e.owner.trigger("filesQueued",t),e.options.auto&&setTimeout(function(){e.request("start-upload")},20)},"getStats":function(){return this.stats},"removeFile":function(t,e){var i=this;t=t.id?t:i.queue.getFile(t),this.request("cancel-file",t),e&&this.queue.removeFile(t)},"getFiles":function(){return this.queue.getFiles.apply(this.queue,arguments)},"fetchFile":function(){return this.queue.fetch.apply(this.queue,arguments)},"retry":function(t,e){var i,n,r,a=this;if(t)return t=t.id?t:a.queue.getFile(t),t.setStatus(s.QUEUED),void(e||a.request("start-upload"));for(i=a.queue.getFiles(s.ERROR),n=0,r=i.length;n<r;n++)t=i[n],t.setStatus(s.QUEUED);a.request("start-upload")},"sortFiles":function(){return this.queue.sort.apply(this.queue,arguments)},"reset":function(){this.owner.trigger("reset"),this.queue=new i,this.stats=this.queue.stats},"destroy":function(){this.reset(),this.placeholder&&this.placeholder.destroy()}})}),e("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(t,e){return t.support=function(){return e.hasRuntime.apply(e,arguments)},t.register({"name":"runtime","init":function(){if(!this.predictRuntimeType())throw Error("Runtime Error")},"predictRuntimeType":function(){var t,i,n=this.options.runtimeOrder||e.orders,r=this.type;if(!r)for(n=n.split(/\s*,\s*/g),t=0,i=n.length;t<i;t++)if(e.hasRuntime(n[t])){this.type=r=n[t];break}return r}})}),e("lib/transport",["base","runtime/client","mediator"],function(t,e,i){function n(t){var i=this;t=i.options=$.extend(!0,{},n.options,t||{}),e.call(this,"Transport"),this._blob=null,this._formData=t.formData||{},this._headers=t.headers||{},this.on("progress",this._timeout),this.on("load error",function(){i.trigger("progress",1),clearTimeout(i._timer)})}var $=t.$;return n.options={"server":"","method":"POST","withCredentials":!1,"fileVal":"file","timeout":12e4,"formData":{},"headers":{},"sendAsBinary":!1},$.extend(n.prototype,{"appendBlob":function(t,e,i){var n=this,r=n.options;n.getRuid()&&n.disconnectRuntime(),n.connectRuntime(e.ruid,function(){n.exec("init")}),n._blob=e,r.fileVal=t||r.fileVal,r.filename=i||r.filename},"append":function(t,e){"object"==typeof t?$.extend(this._formData,t):this._formData[t]=e},"setRequestHeader":function(t,e){"object"==typeof t?$.extend(this._headers,t):this._headers[t]=e},"send":function(t){this.exec("send",t),this._timeout()},"abort":function(){return clearTimeout(this._timer),this.exec("abort")},"destroy":function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},"getResponse":function(){return this.exec("getResponse")},"getResponseAsJson":function(){return this.exec("getResponseAsJson")},"getStatus":function(){return this.exec("getStatus")},"_timeout":function(){var t=this,e=t.options.timeout;e&&(clearTimeout(t._timer),t._timer=setTimeout(function(){t.abort(),t.trigger("error","timeout")},e))}}),i.installTo(n.prototype),n}),e("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(t,e,i,n){function r(t,e){var i,n,r=[],a=t.source,o=a.size,s=e?Math.ceil(o/e):1,u=0,h=0;for(n={"file":t,"has":function(){return!!r.length},"shift":function(){return r.shift()},"unshift":function(t){r.unshift(t)}};h<s;)i=Math.min(e,o-u),r.push({"file":t,"start":u,"end":e?u+i:o,"total":o,"chunks":s,"chunk":h++,"cuted":n}),u+=i;return t.blocks=r.concat(),t.remaning=r.length,n}var $=t.$,a=t.isPromise,o=i.Status;$.extend(e.options,{"prepareNextFile":!1,"chunked":!1,"chunkSize":5242880,"chunkRetry":2,"threads":3,"formData":{}}),e.register({"name":"upload","init":function(){var e=this.owner,i=this;this.runing=!1,this.progress=!1,e.on("startUpload",function(){i.progress=!0}).on("uploadFinished",function(){i.progress=!1}),this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this.__tick=t.bindFn(this._tick,this),e.on("uploadComplete",function(t){t.blocks&&$.each(t.blocks,function(t,e){e.transport&&(e.transport.abort(),e.transport.destroy()),delete e.transport}),delete t.blocks,delete t.remaning})},"reset":function(){this.request("stop-upload",!0),this.runing=!1,this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this._trigged=!1,this._promise=null},"startUpload":function(e){var i=this;if($.each(i.request("get-files",o.INVALID),function(){i.request("remove-file",this)}),e)if(e=e.id?e:i.request("get-file",e),e.getStatus()===o.INTERRUPT)$.each(i.pool,function(t,i){i.file===e&&i.transport&&i.transport.send()}),e.setStatus(o.QUEUED);else{if(e.getStatus()===o.PROGRESS)return;e.setStatus(o.QUEUED)}else $.each(i.request("get-files",[o.INITED]),function(){this.setStatus(o.QUEUED)});if(!i.runing){i.runing=!0;var n=[];$.each(i.pool,function(t,e){var r=e.file;r.getStatus()===o.INTERRUPT&&(n.push(r),i._trigged=!1,e.transport&&e.transport.send())});for(var e;e=n.shift();)e.setStatus(o.PROGRESS);e||$.each(i.request("get-files",o.INTERRUPT),function(){this.setStatus(o.PROGRESS)}),i._trigged=!1,t.nextTick(i.__tick),i.owner.trigger("startUpload")}},"stopUpload":function(e,i){var n=this;if(!0===e&&(i=e,e=null),!1!==n.runing){if(e){if(e=e.id?e:n.request("get-file",e),e.getStatus()!==o.PROGRESS&&e.getStatus()!==o.QUEUED)return;return e.setStatus(o.INTERRUPT),$.each(n.pool,function(t,i){i.file===e&&(i.transport&&i.transport.abort(),n._putback(i),n._popBlock(i))}),t.nextTick(n.__tick)}n.runing=!1,this._promise&&this._promise.file&&this._promise.file.setStatus(o.INTERRUPT),i&&$.each(n.pool,function(t,e){e.transport&&e.transport.abort(),e.file.setStatus(o.INTERRUPT)}),n.owner.trigger("stopUpload")}},"cancelFile":function(t){t=t.id?t:this.request("get-file",t),t.blocks&&$.each(t.blocks,function(t,e){var i=e.transport;i&&(i.abort(),i.destroy(),delete e.transport)}),t.setStatus(o.CANCELLED),this.owner.trigger("fileDequeued",t)},"isInProgress":function(){return!!this.progress},"_getStats":function(){return this.request("get-stats")},"skipFile":function(t,e){t=t.id?t:this.request("get-file",t),t.setStatus(e||o.COMPLETE),t.skipped=!0,t.blocks&&$.each(t.blocks,function(t,e){var i=e.transport;i&&(i.abort(),i.destroy(),delete e.transport)}),this.owner.trigger("uploadSkip",t)},"_tick":function(){var e,i,n=this,r=n.options;if(n._promise)return n._promise.always(n.__tick);n.pool.length<r.threads&&(i=n._nextBlock())?(n._trigged=!1,e=function(e){n._promise=null,e&&e.file&&n._startSend(e),t.nextTick(n.__tick)},n._promise=a(i)?i.always(e):e(i)):n.remaning||n._getStats().numOfQueue||n._getStats().numofInterrupt||(n.runing=!1,n._trigged||t.nextTick(function(){n.owner.trigger("uploadFinished")}),n._trigged=!0)},"_putback":function(t){var e;t.cuted.unshift(t),~(e=this.stack.indexOf(t.cuted))||this.stack.unshift(t.cuted)},"_getStack":function(){for(var t,e=0;t=this.stack[e++];){if(t.has()&&t.file.getStatus()===o.PROGRESS)return t;(!t.has()||t.file.getStatus()!==o.PROGRESS&&t.file.getStatus()!==o.INTERRUPT)&&this.stack.splice(--e,1)}return null},"_nextBlock":function(){var t,e,i,n,o=this,s=o.options;return(t=this._getStack())?(s.prepareNextFile&&!o.pending.length&&o._prepareNextFile(),t.shift()):o.runing?(!o.pending.length&&o._getStats().numOfQueue&&o._prepareNextFile(),e=o.pending.shift(),i=function(e){return e?(t=r(e,s.chunked?s.chunkSize:0),o.stack.push(t),t.shift()):null},a(e)?(n=e.file,e=e[e.pipe?"pipe":"then"](i),e.file=n,e):i(e)):void 0},"_prepareNextFile":function(){var t,e=this,i=e.request("fetch-file"),n=e.pending;i&&(t=e.request("before-send-file",i,function(){return i.getStatus()===o.PROGRESS||i.getStatus()===o.INTERRUPT?i:e._finishFile(i)}),e.owner.trigger("uploadStart",i),i.setStatus(o.PROGRESS),t.file=i,t.done(function(){var e=$.inArray(t,n);~e&&n.splice(e,1,i)}),t.fail(function(t){i.setStatus(o.ERROR,t),e.owner.trigger("uploadError",i,t),e.owner.trigger("uploadComplete",i)}),n.push(t))},"_popBlock":function(t){var e=$.inArray(t,this.pool);this.pool.splice(e,1),t.file.remaning--,this.remaning--},"_startSend":function(e){var i,n=this,r=e.file;if(r.getStatus()!==o.PROGRESS)return void(r.getStatus()===o.INTERRUPT&&n._putback(e));n.pool.push(e),n.remaning++,e.blob=1===e.chunks?r.source:r.source.slice(e.start,e.end),i=n.request("before-send",e,function(){r.getStatus()===o.PROGRESS?n._doSend(e):(n._popBlock(e),t.nextTick(n.__tick))}),i.fail(function(){1===r.remaning?n._finishFile(r).always(function(){e.percentage=1,n._popBlock(e),n.owner.trigger("uploadComplete",r),t.nextTick(n.__tick)}):(e.percentage=1,n.updateFileProgress(r),n._popBlock(e),t.nextTick(n.__tick))})},"_doSend":function(e){var i,r,a=this,s=a.owner,u=a.options,h=e.file,c=new n(u),d=$.extend({},u.formData),l=$.extend({},u.headers);e.transport=c,c.on("destroy",function(){delete e.transport,a._popBlock(e),t.nextTick(a.__tick)}),c.on("progress",function(t){e.percentage=t,a.updateFileProgress(h)}),i=function(t){var i;return r=c.getResponseAsJson()||{},r._raw=c.getResponse(),i=function(e){t=e},s.trigger("uploadAccept",e,r,i)||(t=t||"server"),t},c.on("error",function(t,n){e.retried=e.retried||0,e.chunks>1&&~"http,abort".indexOf(t)&&e.retried<u.chunkRetry?(e.retried++,c.send()):(n||"server"!==t||(t=i(t)),h.setStatus(o.ERROR,t),s.trigger("uploadError",h,t),s.trigger("uploadComplete",h))}),c.on("load",function(){var t;if(t=i())return void c.trigger("error",t,!0);1===h.remaning?a._finishFile(h,r):c.destroy()}),d=$.extend(d,{"id":h.id,"name":h.name,"type":h.type,"lastModifiedDate":h.lastModifiedDate,"size":h.size}),e.chunks>1&&$.extend(d,{"chunks":e.chunks,"chunk":e.chunk}),s.trigger("uploadBeforeSend",e,d,l),c.appendBlob(u.fileVal,e.blob,h.name),c.append(d),c.setRequestHeader(l),c.send()},"_finishFile":function(t,e,i){var n=this.owner;return n.request("after-send-file",arguments,function(){t.setStatus(o.COMPLETE),n.trigger("uploadSuccess",t,e,i)}).fail(function(e){t.getStatus()===o.PROGRESS&&t.setStatus(o.ERROR,e),n.trigger("uploadError",t,e)}).always(function(){n.trigger("uploadComplete",t)})},"updateFileProgress":function(t){var e=0,i=0;t.blocks&&($.each(t.blocks,function(t,e){i+=(e.percentage||0)*(e.end-e.start)}),e=i/t.size,this.owner.trigger("uploadProgress",t,e||0))}})}),e("widgets/validator",["base","uploader","file","widgets/widget"],function(t,e,i){var n,$=t.$,r={};return n={"addValidator":function(t,e){r[t]=e},"removeValidator":function(t){delete r[t]}},e.register({"name":"validator","init":function(){var e=this;t.nextTick(function(){$.each(r,function(){this.call(e.owner)})})}}),n.addValidator("fileNumLimit",function(){var t=this,e=t.options,i=0,n=parseInt(e.fileNumLimit,10),r=!0;n&&(t.on("beforeFileQueued",function(t){return i>=n&&r&&(r=!1,this.trigger("error","Q_EXCEED_NUM_LIMIT",n,t),setTimeout(function(){r=!0},1)),!(i>=n)}),t.on("fileQueued",function(){i++}),t.on("fileDequeued",function(){i--}),t.on("reset",function(){i=0}))}),n.addValidator("fileSizeLimit",function(){var t=this,e=t.options,i=0,n=parseInt(e.fileSizeLimit,10),r=!0;n&&(t.on("beforeFileQueued",function(t){var e=i+t.size>n;return e&&r&&(r=!1,this.trigger("error","Q_EXCEED_SIZE_LIMIT",n,t),setTimeout(function(){r=!0},1)),!e}),t.on("fileQueued",function(t){i+=t.size}),t.on("fileDequeued",function(t){i-=t.size}),t.on("reset",function(){i=0}))}),n.addValidator("fileSingleSizeLimit",function(){var t=this,e=t.options,n=e.fileSingleSizeLimit;n&&t.on("beforeFileQueued",function(t){if(t.size>n)return t.setStatus(i.Status.INVALID,"exceed_size"),this.trigger("error","F_EXCEED_SIZE",n,t),!1})}),n.addValidator("duplicate",function(){function t(t){for(var e,i=0,n=0,r=t.length;n<r;n++)e=t.charCodeAt(n),i=e+(i<<6)+(i<<16)-i;return i}var e=this,i=e.options,n={};i.duplicate||(e.on("beforeFileQueued",function(e){var i=e.__hash||(e.__hash=t(e.name+e.size+e.lastModifiedDate));if(n[i])return this.trigger("error","F_DUPLICATE",e),!1}),e.on("fileQueued",function(t){var e=t.__hash;e&&(n[e]=!0)}),e.on("fileDequeued",function(t){var e=t.__hash;e&&delete n[e]}),e.on("reset",function(){n={}}))}),n}),e("lib/md5",["runtime/client","mediator"],function(t,e){function i(){t.call(this,"Md5")}return e.installTo(i.prototype),i.prototype.loadFromBlob=function(t){var e=this;e.getRuid()&&e.disconnectRuntime(),e.connectRuntime(t.ruid,function(){e.exec("init"),e.exec("loadFromBlob",t)})},i.prototype.getResult=function(){return this.exec("getResult")},i}),e("widgets/md5",["base","uploader","lib/md5","lib/blob","widgets/widget"],function(t,e,i,n){return e.register({"name":"md5","md5File":function(e,r,a){var o=new i,s=t.Deferred(),u=e instanceof n?e:this.request("get-file",e).source;return o.on("progress load",function(t){t=t||{},s.notify(t.total?t.loaded/t.total:1)}),o.on("complete",function(){s.resolve(o.getResult())}),o.on("error",function(t){s.reject(t)}),arguments.length>1&&(r=r||0,a=a||0,r<0&&(r=u.size+r),a<0&&(a=u.size+a),a=Math.min(a,u.size),u=u.slice(r,a)),o.loadFromBlob(u),s.promise()}})}),e("runtime/compbase",[],function(){function t(t,e){this.owner=t,this.options=t.options,this.getRuntime=function(){return e},this.getRuid=function(){return e.uid},this.trigger=function(){return t.trigger.apply(t,arguments)}}return t}),e("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(e,i,n){function r(){var t={},n=this,r=this.destroy;i.apply(n,arguments),n.type=a,n.exec=function(i,r){var a,s=this,u=s.uid,h=e.slice(arguments,2);if(o[i]&&(a=t[u]=t[u]||new o[i](s,n),a[r]))return a[r].apply(a,h)},n.destroy=function(){return r&&r.apply(this,arguments)}}var a="html5",o={};return e.inherits(i,{"constructor":r,"init":function(){var t=this;setTimeout(function(){t.trigger("ready")},1)}}),r.register=function(t,i){return o[t]=e.inherits(n,i)},t.Blob&&t.FileReader&&t.DataView&&i.addRuntime(a,r),r}),e("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(t,e){return t.register("Blob",{"slice":function(t,i){var n=this.owner.source;return n=(n.slice||n.webkitSlice||n.mozSlice).call(n,t,i),new e(this.getRuid(),n)}})}),e("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(t,e,i){var $=t.$,n="webuploader-dnd-";return e.register("DragAndDrop",{"init":function(){var e=this.elem=this.options.container;this.dragEnterHandler=t.bindFn(this._dragEnterHandler,this),this.dragOverHandler=t.bindFn(this._dragOverHandler,this),this.dragLeaveHandler=t.bindFn(this._dragLeaveHandler,this),this.dropHandler=t.bindFn(this._dropHandler,this),this.dndOver=!1,e.on("dragenter",this.dragEnterHandler),e.on("dragover",this.dragOverHandler),e.on("dragleave",this.dragLeaveHandler),e.on("drop",this.dropHandler),this.options.disableGlobalDnd&&($(document).on("dragover",this.dragOverHandler),$(document).on("drop",this.dropHandler))},"_dragEnterHandler":function(t){var e,i=this,r=i._denied||!1;return t=t.originalEvent||t,i.dndOver||(i.dndOver=!0,e=t.dataTransfer.items,e&&e.length&&(i._denied=r=!i.trigger("accept",e)),i.elem.addClass(n+"over"),i.elem[r?"addClass":"removeClass"](n+"denied")),t.dataTransfer.dropEffect=r?"none":"copy",!1},"_dragOverHandler":function(t){var e=this.elem.parent().get(0);return!(e&&!$.contains(e,t.currentTarget))&&(clearTimeout(this._leaveTimer),this._dragEnterHandler.call(this,t),!1)},"_dragLeaveHandler":function(){var t,e=this;return t=function(){e.dndOver=!1,e.elem.removeClass(n+"over "+n+"denied")},clearTimeout(e._leaveTimer),e._leaveTimer=setTimeout(t,100),!1},"_dropHandler":function(t){var e,r,a=this,o=a.getRuid(),s=a.elem.parent().get(0);if(s&&!$.contains(s,t.currentTarget))return!1;t=t.originalEvent||t,e=t.dataTransfer;try{r=e.getData("text/html")}catch(t){}return r?void 0:(a._getTansferFiles(e,function(t){a.trigger("drop",$.map(t,function(t){return new i(o,t)}))}),a.dndOver=!1,a.elem.removeClass(n+"over"),!1)},"_getTansferFiles":function(e,i){var n,r,a,o,s,u,h,c=[],d=[];for(n=e.items,r=e.files,h=!(!n||!n[0].webkitGetAsEntry),s=0,u=r.length;s<u;s++)a=r[s],o=n&&n[s],h&&o.webkitGetAsEntry().isDirectory?d.push(this._traverseDirectoryTree(o.webkitGetAsEntry(),c)):c.push(a);t.when.apply(t,d).done(function(){c.length&&i(c)})},"_traverseDirectoryTree":function(e,i){var n=t.Deferred(),r=this;return e.isFile?e.file(function(t){i.push(t),n.resolve()}):e.isDirectory&&e.createReader().readEntries(function(e){var a,o=e.length,s=[],u=[];for(a=0;a<o;a++)s.push(r._traverseDirectoryTree(e[a],u));t.when.apply(t,s).then(function(){i.push.apply(i,u),n.resolve()},n.reject)}),n.promise()},"destroy":function(){var t=this.elem;t&&(t.off("dragenter",this.dragEnterHandler),t.off("dragover",this.dragOverHandler),t.off("dragleave",this.dragLeaveHandler),t.off("drop",this.dropHandler),this.options.disableGlobalDnd&&($(document).off("dragover",this.dragOverHandler),$(document).off("drop",this.dropHandler)))}})}),e("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(t,e,i){return e.register("FilePaste",{"init":function(){var e,i,n,r,a=this.options,o=this.elem=a.container,s=".*";if(a.accept){for(e=[],i=0,n=a.accept.length;i<n;i++)(r=a.accept[i].mimeTypes)&&e.push(r);e.length&&(s=e.join(","),s=s.replace(/,/g,"|").replace(/\*/g,".*"))}this.accept=s=new RegExp(s,"i"),this.hander=t.bindFn(this._pasteHander,this),o.on("paste",this.hander)},"_pasteHander":function(t){var e,n,r,a,o,s=[],u=this.getRuid();for(t=t.originalEvent||t,e=t.clipboardData.items,a=0,o=e.length;a<o;a++)n=e[a],"file"===n.kind&&(r=n.getAsFile())&&s.push(new i(u,r));s.length&&(t.preventDefault(),t.stopPropagation(),this.trigger("paste",s))},"destroy":function(){this.elem.off("paste",this.hander)}})}),e("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(t,e){var $=t.$;return e.register("FilePicker",{"init":function(){var t,e,i,n,r=this.getRuntime().getContainer(),a=this,o=a.owner,s=a.options,u=this.label=$(document.createElement("label")),h=this.input=$(document.createElement("input"));if(h.attr("type","file"),h.attr("name","file"),h.addClass("webuploader-element-invisible"),u.on("click",function(){h.trigger("click")}),u.css({"opacity":0,"width":"100%","height":"100%","display":"block","cursor":"pointer","background":"#ffffff"}),s.multiple&&h.attr("multiple","multiple"),s.accept&&s.accept.length>0){for(t=[],e=0,i=s.accept.length;e<i;e++)t.push(s.accept[e].mimeTypes);h.attr("accept",t.join(","))}r.append(h),r.append(u),n=function(t){o.trigger(t.type)},h.on("change",function(t){var e,i=arguments.callee;a.files=t.target.files,e=this.cloneNode(!0),e.value=null,this.parentNode.replaceChild(e,this),h.off(),h=$(e).on("change",i).on("mouseenter mouseleave",n),o.trigger("change")}),u.on("mouseenter mouseleave",n)},"getFiles":function(){return this.files},"destroy":function(){this.input.off(),this.label.off()}})}),e("runtime/html5/util",["base"],function(e){var i=t.createObjectURL&&t||t.URL&&URL.revokeObjectURL&&URL||t.webkitURL,n=e.noop,r=n;return i&&(n=function(){return i.createObjectURL.apply(i,arguments)},r=function(){return i.revokeObjectURL.apply(i,arguments)}),{"createObjectURL":n,"revokeObjectURL":r,"dataURL2Blob":function(t){var e,i,n,r,a,o;for(o=t.split(","),e=~o[0].indexOf("base64")?atob(o[1]):decodeURIComponent(o[1]),n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return a=o[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(n,a)},"dataURL2ArrayBuffer":function(t){var e,i,n,r;for(r=t.split(","),e=~r[0].indexOf("base64")?atob(r[1]):decodeURIComponent(r[1]),i=new Uint8Array(e.length),n=0;n<e.length;n++)i[n]=e.charCodeAt(n);return i.buffer},"arrayBufferToBlob":function(e,i){var n,r=t.BlobBuilder||t.WebKitBlobBuilder;return r?(n=new r,n.append(e),n.getBlob(i)):new Blob([e],i?{"type":i}:{})},"canvasToDataUrl":function(t,e,i){return t.toDataURL(e,i/100)},"parseMeta":function(t,e){e(!1,{})},"updateImageHead":function(t){return t}}}),e("runtime/html5/imagemeta",["runtime/html5/util"],function(t){var e;return e={"parsers":{"65505":[]},"maxMetaDataSize":262144,"parse":function(t,e){var i=this,n=new FileReader;n.onload=function(){e(!1,i._parse(this.result)),n=n.onload=n.onerror=null},n.onerror=function(t){e(t.message),n=n.onload=n.onerror=null},t=t.slice(0,i.maxMetaDataSize),n.readAsArrayBuffer(t.getSource())},"_parse":function(t,i){if(!(t.byteLength<6)){var n,r,a,o,s=new DataView(t),u=2,h=s.byteLength-4,c=u,d={};if(65496===s.getUint16(0)){for(;u<h&&((n=s.getUint16(u))>=65504&&n<=65519||65534===n)&&(r=s.getUint16(u+2)+2,!(u+r>s.byteLength));){if(a=e.parsers[n],!i&&a)for(o=0;o<a.length;o+=1)a[o].call(e,s,u,r,d);u+=r,c=u}c>6&&(t.slice?d.imageHead=t.slice(2,c):d.imageHead=new Uint8Array(t).subarray(2,c))}return d}},"updateImageHead":function(t,e){var i,n,r,a=this._parse(t,!0);return r=2,a.imageHead&&(r=2+a.imageHead.byteLength),n=t.slice?t.slice(r):new Uint8Array(t).subarray(r),i=new Uint8Array(e.byteLength+2+n.byteLength),i[0]=255,i[1]=216,i.set(new Uint8Array(e),2),i.set(new Uint8Array(n),e.byteLength+2),i.buffer}},t.parseMeta=function(){return e.parse.apply(e,arguments)},t.updateImageHead=function(){return e.updateImageHead.apply(e,arguments)},e}),e("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(t,e){var i={};return i.ExifMap=function(){return this},i.ExifMap.prototype.map={"Orientation":274},i.ExifMap.prototype.get=function(t){return this[t]||this[this.map[t]]},i.exifTagTypes={"1":{"getValue":function(t,e){return t.getUint8(e)},"size":1},"2":{"getValue":function(t,e){return String.fromCharCode(t.getUint8(e))},"size":1,"ascii":!0},"3":{"getValue":function(t,e,i){return t.getUint16(e,i)},"size":2},"4":{"getValue":function(t,e,i){return t.getUint32(e,i)},"size":4},"5":{"getValue":function(t,e,i){return t.getUint32(e,i)/t.getUint32(e+4,i)},"size":8},"9":{"getValue":function(t,e,i){return t.getInt32(e,i)},"size":4},"10":{"getValue":function(t,e,i){return t.getInt32(e,i)/t.getInt32(e+4,i)},"size":8}},i.exifTagTypes[7]=i.exifTagTypes[1],i.getExifValue=function(e,n,r,a,o,s){var u,h,c,d,l,p,f=i.exifTagTypes[a];if(!f)return void t.log("Invalid Exif data: Invalid tag type.");if(u=f.size*o,(h=u>4?n+e.getUint32(r+8,s):r+8)+u>e.byteLength)return void t.log("Invalid Exif data: Invalid data offset.");if(1===o)return f.getValue(e,h,s);for(c=[],d=0;d<o;d+=1)c[d]=f.getValue(e,h+d*f.size,s);if(f.ascii){for(l="",d=0;d<c.length&&"\0"!==(p=c[d]);d+=1)l+=p;return l}return c},i.parseExifTag=function(t,e,n,r,a){var o=t.getUint16(n,r);a.exif[o]=i.getExifValue(t,e,n,t.getUint16(n+2,r),t.getUint32(n+4,r),r)},i.parseExifTags=function(e,i,n,r,a){var o,s,u;if(n+6>e.byteLength)return void t.log("Invalid Exif data: Invalid directory offset.");if(o=e.getUint16(n,r),(s=n+2+12*o)+4>e.byteLength)return void t.log("Invalid Exif data: Invalid directory size.");for(u=0;u<o;u+=1)this.parseExifTag(e,i,n+2+12*u,r,a);return e.getUint32(s,r)},i.parseExifData=function(e,n,r,a){var o,s,u=n+10;if(1165519206===e.getUint32(n+4)){if(u+8>e.byteLength)return void t.log("Invalid Exif data: Invalid segment size.");if(0!==e.getUint16(n+8))return void t.log("Invalid Exif data: Missing byte alignment offset.");switch(e.getUint16(u)){case 18761:o=!0;break;case 19789:o=!1;break;default:return void t.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==e.getUint16(u+2,o))return void t.log("Invalid Exif data: Missing TIFF marker.");s=e.getUint32(u+4,o),a.exif=new i.ExifMap,s=i.parseExifTags(e,u,u+s,o,a)}},e.parsers[65505].push(i.parseExifData),i}),e("runtime/html5/jpegencoder",[],function(require,exports,t){function e(t){function e(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=C((e[i]*t+50)/100);n<1?n=1:n>255&&(n=255),R[j[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var o=C((r[a]*t+50)/100);o<1?o=1:o>255&&(o=255),k[j[a]]=o}for(var s=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],u=0,h=0;h<8;h++)for(var c=0;c<8;c++)T[u]=1/(R[j[u]]*s[h]*s[c]*8),E[u]=1/(k[j[u]]*s[h]*s[c]*8),u++}function i(t,e){for(var i=0,n=0,r=new Array,a=1;a<=16;a++){for(var o=1;o<=t[a];o++)r[e[n]]=[],r[e[n]][0]=i,r[e[n]][1]=a,n++,i++;i*=2}return r}function n(){b=i(M,q),w=i(Q,V),y=i(N,W),x=i(X,G)}function r(){for(var t=1,e=2,i=1;i<=15;i++){for(var n=t;n<e;n++)D[32767+n]=i,S[32767+n]=[],S[32767+n][1]=i,S[32767+n][0]=n;for(var r=-(e-1);r<=-t;r++)D[32767+r]=i,S[32767+r]=[],S[32767+r][1]=i,S[32767+r][0]=e-1+r;t<<=1,e<<=1}}function a(){for(var t=0;t<256;t++)P[t]=19595*t,P[t+256>>0]=38470*t,P[t+512>>0]=7471*t+32768,P[t+768>>0]=-11059*t,P[t+1024>>0]=-21709*t,P[t+1280>>0]=32768*t+8421375,P[t+1536>>0]=-27439*t,P[t+1792>>0]=-5329*t}function o(t){for(var e=t[0],i=t[1]-1;i>=0;)e&1<<i&&(I|=1<<O),i--,--O<0&&(255==I?(s(255),s(0)):s(I),O=7,I=0)}function s(t){A.push(H[t])}function u(t){s(t>>8&255),s(255&t)}function h(t,e){var i,n,r,a,o,s,u,h,c,d=0;for(c=0;c<8;++c){i=t[d],n=t[d+1],r=t[d+2],a=t[d+3],o=t[d+4],s=t[d+5],u=t[d+6],h=t[d+7];var l=i+h,p=i-h,f=n+u,g=n-u,m=r+s,v=r-s,b=a+o,w=a-o,y=l+b,x=l-b,_=f+m,C=f-m;t[d]=y+_,t[d+4]=y-_;var R=.707106781*(C+x);t[d+2]=x+R,t[d+6]=x-R,y=w+v,_=v+g,C=g+p;var k=.382683433*(y-C),T=.5411961*y+k,E=1.306562965*C+k,S=.707106781*_,D=p+S,F=p-S;t[d+5]=F+T,t[d+3]=F-T,t[d+1]=D+E,t[d+7]=D-E,d+=8}for(d=0,c=0;c<8;++c){i=t[d],n=t[d+8],r=t[d+16],a=t[d+24],o=t[d+32],s=t[d+40],u=t[d+48],h=t[d+56];var A=i+h,I=i-h,O=n+u,U=n-u,L=r+s,z=r-s,H=a+o,P=a-o,j=A+H,M=A-H,q=O+L,N=O-L;t[d]=j+q,t[d+32]=j-q;var W=.707106781*(N+M);t[d+16]=M+W,t[d+48]=M-W,j=P+z,q=z+U,N=U+I;var Q=.382683433*(j-N),V=.5411961*j+Q,X=1.306562965*N+Q,G=.707106781*q,Y=I+G,J=I-G;t[d+40]=J+V,t[d+24]=J-V,t[d+8]=Y+X,t[d+56]=Y-X,d++}var Z;for(c=0;c<64;++c)Z=t[c]*e[c],B[c]=Z>0?Z+.5|0:Z-.5|0;return B}function c(){u(65504),u(16),s(74),s(70),s(73),s(70),s(0),s(1),s(1),s(0),u(1),u(1),s(0),s(0)}function d(t,e){u(65472),u(17),s(8),u(e),u(t),s(3),s(1),s(17),s(0),s(2),s(17),s(1),s(3),s(17),s(1)}function l(){u(65499),u(132),s(0);for(var t=0;t<64;t++)s(R[t]);s(1);for(var e=0;e<64;e++)s(k[e])}function p(){u(65476),u(418),s(0);for(var t=0;t<16;t++)s(M[t+1]);for(var e=0;e<=11;e++)s(q[e]);s(16);for(var i=0;i<16;i++)s(N[i+1]);for(var n=0;n<=161;n++)s(W[n]);s(1);for(var r=0;r<16;r++)s(Q[r+1]);for(var a=0;a<=11;a++)s(V[a]);s(17);for(var o=0;o<16;o++)s(X[o+1]);for(var h=0;h<=161;h++)s(G[h])}function f(){u(65498),u(12),s(3),s(1),s(0),s(2),s(17),s(3),s(17),s(0),s(63),s(0)}function g(t,e,i,n,r){for(var a,s=r[0],u=r[240],c=h(t,e),d=0;d<64;++d)F[j[d]]=c[d];var l=F[0]-i;i=F[0],0==l?o(n[0]):(a=32767+l,o(n[D[a]]),o(S[a]));for(var p=63;p>0&&0==F[p];p--);if(0==p)return o(s),i;for(var f,g=1;g<=p;){for(var m=g;0==F[g]&&g<=p;++g);var v=g-m;if(v>=16){f=v>>4;for(var b=1;b<=f;++b)o(u);v&=15}a=32767+F[g],o(r[(v<<4)+D[a]]),o(S[a]),g++}return 63!=p&&o(s),i}function m(){for(var t=String.fromCharCode,e=0;e<256;e++)H[e]=t(e)}function v(t){if(t<=0&&(t=1),t>100&&(t=100),_!=t){var i=0;i=t<50?Math.floor(5e3/t):Math.floor(200-2*t),e(i),_=t}}var b,w,y,x,_,C=(Math.round,Math.floor),R=new Array(64),k=new Array(64),T=new Array(64),E=new Array(64),S=new Array(65535),D=new Array(65535),B=new Array(64),F=new Array(64),A=[],I=0,O=7,U=new Array(64),L=new Array(64),z=new Array(64),H=new Array(256),P=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],M=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],N=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],W=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],Q=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],G=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(t,e){e&&v(e),A=new Array,I=0,O=7,u(65496),c(),l(),d(t.width,t.height),p(),f();var i=0,n=0,r=0;I=0,O=7,this.encode.displayName="_encode_";for(var a,s,h,m,_,C,R,k,S,D=t.data,B=t.width,F=t.height,H=4*B,j=0;j<F;){for(a=0;a<H;){for(_=H*j+a,C=_,R=-1,k=0,S=0;S<64;S++)k=S>>3,R=4*(7&S),C=_+k*H+R,j+k>=F&&(C-=H*(j+1+k-F)),a+R>=H&&(C-=a+R-H+4),s=D[C++],h=D[C++],m=D[C++],U[S]=(P[s]+P[h+256>>0]+P[m+512>>0]>>16)-128,L[S]=(P[s+768>>0]+P[h+1024>>0]+P[m+1280>>0]>>16)-128,z[S]=(P[s+1280>>0]+P[h+1536>>0]+P[m+1792>>0]>>16)-128;i=g(U,T,i,b,y),n=g(L,E,n,w,x),r=g(z,E,r,w,x),a+=32}j+=8}if(O>=0){var M=[];M[1]=O+1,M[0]=(1<<O+1)-1,o(M)}u(65497);var q="data:image/jpeg;base64,"+btoa(A.join(""));return A=[],q},function(){t||(t=50),m(),n(),r(),a(),v(t)}()}return e.encode=function(t,i){return new e(i).encode(t)},e}),e("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(t,e,i){var n,r=t.canvasToDataUrl;t.canvasToDataUrl=function(t,a,o){var s,u,h,c,d;return i.os.android?("image/jpeg"===a&&void 0===n&&(c=r.apply(null,arguments),d=c.split(","),c=~d[0].indexOf("base64")?atob(d[1]):decodeURIComponent(d[1]),c=c.substring(0,2),n=255===c.charCodeAt(0)&&216===c.charCodeAt(1)),"image/jpeg"!==a||n?r.apply(null,arguments):(u=t.width,h=t.height,s=t.getContext("2d"),e.encode(s.getImageData(0,0,u,h),o))):r.apply(null,arguments)}}),e("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(t,e,i){return e.register("Image",{"modified":!1,"init":function(){var t=this,e=new Image;e.onload=function(){t._info={"type":t.type,"width":this.width,"height":this.height},t._metas||"image/jpeg"!==t.type?t.owner.trigger("load"):i.parseMeta(t._blob,function(e,i){t._metas=i,t.owner.trigger("load")})},e.onerror=function(){t.owner.trigger("error")},t._img=e},"loadFromBlob":function(t){var e=this,n=e._img;e._blob=t,e.type=t.type,n.src=i.createObjectURL(t.getSource()),e.owner.once("load",function(){i.revokeObjectURL(n.src)})},"resize":function(t,e){var i=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,i,t,e),this._blob=null,this.modified=!0,this.owner.trigger("complete","resize")},"crop":function(t,e,i,n,r){var a=this._canvas||(this._canvas=document.createElement("canvas")),o=this.options,s=this._img,u=s.naturalWidth,h=s.naturalHeight,c=this.getOrientation();r=r||1,a.width=i,a.height=n,o.preserveHeaders||this._rotate2Orientaion(a,c),this._renderImageToCanvas(a,s,-t,-e,u*r,h*r),this._blob=null,this.modified=!0,this.owner.trigger("complete","crop")},"getAsBlob":function(t){var e,n=this._blob,r=this.options;if(t=t||this.type,this.modified||this.type!==t){if(e=this._canvas,"image/jpeg"===t){if(n=i.canvasToDataUrl(e,t,r.quality),r.preserveHeaders&&this._metas&&this._metas.imageHead)return n=i.dataURL2ArrayBuffer(n),n=i.updateImageHead(n,this._metas.imageHead),n=i.arrayBufferToBlob(n,t)}else n=i.canvasToDataUrl(e,t);n=i.dataURL2Blob(n)}return n},"getAsDataUrl":function(t){var e=this.options;return t=t||this.type,"image/jpeg"===t?i.canvasToDataUrl(this._canvas,t,e.quality):this._canvas.toDataURL(t)},"getOrientation":function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},"info":function(t){return t?(this._info=t,this):this._info},"meta":function(t){return t?(this._meta=t,this):this._meta},"destroy":function(){var t=this._canvas;this._img.onload=null,t&&(t.getContext("2d").clearRect(0,0,t.width,t.height),t.width=t.height=0,this._canvas=null),this._img.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D",this._img=this._blob=null},"_resize":function(t,e,i,n){var r,a,o,s,u,h=this.options,c=t.width,d=t.height,l=this.getOrientation();~[5,6,7,8].indexOf(l)&&(i^=n,n^=i,i^=n),r=Math[h.crop?"max":"min"](i/c,n/d),h.allowMagnify||(r=Math.min(1,r)),a=c*r,o=d*r,h.crop?(e.width=i,e.height=n):(e.width=a,e.height=o),s=(e.width-a)/2,u=(e.height-o)/2,h.preserveHeaders||this._rotate2Orientaion(e,l),this._renderImageToCanvas(e,t,s,u,a,o)},"_rotate2Orientaion":function(t,e){var i=t.width,n=t.height,r=t.getContext("2d");switch(e){case 5:case 6:case 7:case 8:t.width=n,t.height=i}switch(e){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,n),r.rotate(Math.PI);break;case 4:r.translate(0,n),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-n);break;case 7:r.rotate(.5*Math.PI),r.translate(i,-n),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-i,0)}},"_renderImageToCanvas":function(){function e(t,e,i){var n,r,a,o=document.createElement("canvas"),s=o.getContext("2d"),u=0,h=i,c=i;for(o.width=1,o.height=i,s.drawImage(t,0,0),n=s.getImageData(0,0,1,i).data;c>u;)r=n[4*(c-1)+3],0===r?h=c:u=c,c=h+u>>1;return a=c/i,0===a?1:a}function i(t){var e,i,n=t.naturalWidth,r=t.naturalHeight;return n*r>1048576&&(e=document.createElement("canvas"),e.width=e.height=1,i=e.getContext("2d"),i.drawImage(t,1-n,0),0===i.getImageData(0,0,1,1).data[3])}return t.os.ios?t.os.ios>=7?function(t,i,n,r,a,o){var s=i.naturalWidth,u=i.naturalHeight,h=e(i,s,u);return t.getContext("2d").drawImage(i,0,0,s*h,u*h,n,r,a,o)}:function(t,n,r,a,o,s){var u,h,c,d,l,p,f,g=n.naturalWidth,m=n.naturalHeight,v=t.getContext("2d"),b=i(n),w="image/jpeg"===this.type,y=1024,x=0,_=0;for(b&&(g/=2,m/=2),v.save(),u=document.createElement("canvas"),u.width=u.height=y,h=u.getContext("2d"),c=w?e(n,g,m):1,d=Math.ceil(y*o/g),l=Math.ceil(y*s/m/c);x<m;){for(p=0,f=0;p<g;)h.clearRect(0,0,y,y),h.drawImage(n,-p,-x),v.drawImage(u,0,0,y,y,r+f,a+_,d,l),p+=y,f+=d;x+=y,_+=l}v.restore(),u=h=null}:function(e){var i=t.slice(arguments,1),n=e.getContext("2d");n.drawImage.apply(n,i)}}()})}),e("runtime/html5/transport",["base","runtime/html5/runtime"],function(t,e){var i=t.noop,$=t.$;return e.register("Transport",{"init":function(){this._status=0,this._response=null},"send":function(){var e,i,n,r=this.owner,a=this.options,o=this._initAjax(),s=r._blob,u=a.server;a.sendAsBinary?(u+=(/\?/.test(u)?"&":"?")+$.param(r._formData),i=s.getSource()):(e=new FormData,$.each(r._formData,function(t,i){e.append(t,i)}),e.append(a.fileVal,s.getSource(),a.filename||r._formData.name||"")),a.withCredentials&&"withCredentials"in o?(o.open(a.method,u,!0),o.withCredentials=!0):o.open(a.method,u),this._setRequestHeader(o,a.headers),i?(o.overrideMimeType&&o.overrideMimeType("application/octet-stream"),t.os.android?(n=new FileReader,n.onload=function(){o.send(this.result),n=n.onload=null},n.readAsArrayBuffer(i)):o.send(i)):o.send(e)},"getResponse":function(){return this._response},"getResponseAsJson":function(){return this._parseJson(this._response)},"getStatus":function(){return this._status},"abort":function(){var t=this._xhr;t&&(t.upload.onprogress=i,t.onreadystatechange=i,t.abort(),this._xhr=t=null)},"destroy":function(){this.abort()},"_initAjax":function(){var t=this,e=new XMLHttpRequest;return!this.options.withCredentials||"withCredentials"in e||"undefined"==typeof XDomainRequest||(e=new XDomainRequest),e.upload.onprogress=function(e){var i=0;return e.lengthComputable&&(i=e.loaded/e.total),t.trigger("progress",i)},e.onreadystatechange=function(){if(4===e.readyState)return e.upload.onprogress=i,e.onreadystatechange=i,t._xhr=null,t._status=e.status,e.status>=200&&e.status<300?(t._response=e.responseText,t.trigger("load")):e.status>=500&&e.status<600?(t._response=e.responseText,t.trigger("error","server")):t.trigger("error",t._status?"http":"abort")},t._xhr=e,e},"_setRequestHeader":function(t,e){$.each(e,function(e,i){t.setRequestHeader(e,i)})},"_parseJson":function(t){var e;try{e=JSON.parse(t)}catch(t){e={}}return e}})}),e("runtime/html5/md5",["runtime/html5/runtime"],function(t){var e=function(t,e){return t+e&4294967295},i=function(t,i,n,r,a,o){return i=e(e(i,t),e(r,o)),e(i<<a|i>>>32-a,n)},n=function(t,e,n,r,a,o,s){return i(e&n|~e&r,t,e,a,o,s)},r=function(t,e,n,r,a,o,s){return i(e&r|n&~r,t,e,a,o,s)},a=function(t,e,n,r,a,o,s){return i(e^n^r,t,e,a,o,s)},o=function(t,e,n,r,a,o,s){return i(n^(e|~r),t,e,a,o,s)},s=function(t,i){var s=t[0],u=t[1],h=t[2],c=t[3];s=n(s,u,h,c,i[0],7,-680876936),c=n(c,s,u,h,i[1],12,-389564586),h=n(h,c,s,u,i[2],17,606105819),u=n(u,h,c,s,i[3],22,-1044525330),s=n(s,u,h,c,i[4],7,-176418897),c=n(c,s,u,h,i[5],12,1200080426),h=n(h,c,s,u,i[6],17,-1473231341),u=n(u,h,c,s,i[7],22,-45705983),s=n(s,u,h,c,i[8],7,1770035416),c=n(c,s,u,h,i[9],12,-1958414417),h=n(h,c,s,u,i[10],17,-42063),u=n(u,h,c,s,i[11],22,-1990404162),s=n(s,u,h,c,i[12],7,1804603682),c=n(c,s,u,h,i[13],12,-40341101),h=n(h,c,s,u,i[14],17,-1502002290),u=n(u,h,c,s,i[15],22,1236535329),s=r(s,u,h,c,i[1],5,-165796510),c=r(c,s,u,h,i[6],9,-1069501632),h=r(h,c,s,u,i[11],14,643717713),u=r(u,h,c,s,i[0],20,-373897302),s=r(s,u,h,c,i[5],5,-701558691),c=r(c,s,u,h,i[10],9,38016083),h=r(h,c,s,u,i[15],14,-660478335),u=r(u,h,c,s,i[4],20,-405537848),s=r(s,u,h,c,i[9],5,568446438),c=r(c,s,u,h,i[14],9,-1019803690),h=r(h,c,s,u,i[3],14,-187363961),u=r(u,h,c,s,i[8],20,1163531501),s=r(s,u,h,c,i[13],5,-1444681467),c=r(c,s,u,h,i[2],9,-51403784),h=r(h,c,s,u,i[7],14,1735328473),u=r(u,h,c,s,i[12],20,-1926607734),s=a(s,u,h,c,i[5],4,-378558),c=a(c,s,u,h,i[8],11,-2022574463),h=a(h,c,s,u,i[11],16,1839030562),u=a(u,h,c,s,i[14],23,-35309556),s=a(s,u,h,c,i[1],4,-1530992060),c=a(c,s,u,h,i[4],11,1272893353),h=a(h,c,s,u,i[7],16,-155497632),u=a(u,h,c,s,i[10],23,-1094730640),s=a(s,u,h,c,i[13],4,681279174),c=a(c,s,u,h,i[0],11,-358537222),h=a(h,c,s,u,i[3],16,-722521979),u=a(u,h,c,s,i[6],23,76029189),s=a(s,u,h,c,i[9],4,-640364487),c=a(c,s,u,h,i[12],11,-421815835),h=a(h,c,s,u,i[15],16,530742520),u=a(u,h,c,s,i[2],23,-995338651),s=o(s,u,h,c,i[0],6,-198630844),c=o(c,s,u,h,i[7],10,1126891415),h=o(h,c,s,u,i[14],15,-1416354905),u=o(u,h,c,s,i[5],21,-57434055),s=o(s,u,h,c,i[12],6,1700485571),c=o(c,s,u,h,i[3],10,-1894986606),h=o(h,c,s,u,i[10],15,-1051523),u=o(u,h,c,s,i[1],21,-2054922799),s=o(s,u,h,c,i[8],6,1873313359),c=o(c,s,u,h,i[15],10,-30611744),h=o(h,c,s,u,i[6],15,-1560198380),u=o(u,h,c,s,i[13],21,1309151649),s=o(s,u,h,c,i[4],6,-145523070),c=o(c,s,u,h,i[11],10,-1120210379),h=o(h,c,s,u,i[2],15,718787259),u=o(u,h,c,s,i[9],21,-343485551),t[0]=e(s,t[0]),t[1]=e(u,t[1]),t[2]=e(h,t[2]),t[3]=e(c,t[3])},u=function(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return i},h=function(t){var e,i=[];for(e=0;e<64;e+=4)i[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return i},c=function(t){var e,i,n,r,a,o,h=t.length,c=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=h;e+=64)s(c,u(t.substring(e-64,e)));for(t=t.substring(e-64),i=t.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)n[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(s(c,n),e=0;e<16;e+=1)n[e]=0;return r=8*h,r=r.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),o=parseInt(r[1],16)||0,n[14]=a,n[15]=o,s(c,n),c},d=function(t){var e,i,n,r,a,o,u=t.length,c=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=u;e+=64)s(c,h(t.subarray(e-64,e)));for(t=e-64<u?t.subarray(e-64):new Uint8Array(0),i=t.length,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)n[e>>2]|=t[e]<<(e%4<<3);if(n[e>>2]|=128<<(e%4<<3),e>55)for(s(c,n),e=0;e<16;e+=1)n[e]=0;return r=8*u,r=r.toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(r[2],16),o=parseInt(r[1],16)||0,n[14]=a,n[15]=o,s(c,n),c},l=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],p=function(t){var e,i="";for(e=0;e<4;e+=1)i+=l[t>>8*e+4&15]+l[t>>8*e&15];return i},f=function(t){var e;for(e=0;e<t.length;e+=1)t[e]=p(t[e]);return t.join("")},g=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==function(t){return f(c(t))}("hello")&&(e=function(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}),g.prototype.append=function(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),this.appendBinary(t),this},g.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,i=this._buff.length;for(e=64;e<=i;e+=64)s(this._state,u(this._buff.substring(e-64,e)));return this._buff=this._buff.substr(e-64),this},g.prototype.end=function(t){var e,i,n=this._buff,r=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)a[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(a,r),i=t?this._state:f(this._state),this.reset(),i},g.prototype._finish=function(t,e){var i,n,r,a=e;if(t[a>>2]|=128<<(a%4<<3),a>55)for(s(this._state,t),a=0;a<16;a+=1)t[a]=0;i=8*this._length,i=i.toString(16).match(/(.*?)(.{0,8})$/),n=parseInt(i[2],16),r=parseInt(i[1],16)||0,t[14]=n,t[15]=r,s(this._state,t)},g.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},g.hash=function(t,e){/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t)));var i=c(t);return e?i:f(i)},g.hashBinary=function(t,e){var i=c(t);return e?i:f(i)},g.ArrayBuffer=function(){this.reset()},g.ArrayBuffer.prototype.append=function(t){var e,i=this._concatArrayBuffer(this._buff,t),n=i.length;for(this._length+=t.byteLength,e=64;e<=n;e+=64)s(this._state,h(i.subarray(e-64,e)));return this._buff=e-64<n?i.subarray(e-64):new Uint8Array(0),this},g.ArrayBuffer.prototype.end=function(t){var e,i,n=this._buff,r=n.length,a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r;e+=1)a[e>>2]|=n[e]<<(e%4<<3);return this._finish(a,r),i=t?this._state:f(this._state),this.reset(),i},g.ArrayBuffer.prototype._finish=g.prototype._finish,g.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},g.ArrayBuffer.prototype.destroy=g.prototype.destroy,g.ArrayBuffer.prototype._concatArrayBuffer=function(t,e){var i=t.length,n=new Uint8Array(i+e.byteLength);return n.set(t),n.set(new Uint8Array(e),i),n},g.ArrayBuffer.hash=function(t,e){var i=d(new Uint8Array(t));return e?i:f(i)},t.register("Md5",{"init":function(){},"loadFromBlob":function(t){var e,i,n=t.getSource(),r=Math.ceil(n.size/2097152),a=0,o=this.owner,s=new g.ArrayBuffer,u=this,h=n.mozSlice||n.webkitSlice||n.slice;i=new FileReader,(e=function(){var c,d;c=2097152*a,d=Math.min(c+2097152,n.size),i.onload=function(e){s.append(e.target.result),o.trigger("progress",{"total":t.size,"loaded":d})},i.onloadend=function(){i.onloadend=i.onload=null,++a<r?setTimeout(e,1):setTimeout(function(){o.trigger("load"),u.result=s.end(),e=t=n=s=null,o.trigger("complete")},50)},i.readAsArrayBuffer(h.call(n,c,d))})()},"getResult":function(){return this.result}})}),e("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(e,i,n){function r(){function n(t,e){var i,n,r=t.type||t;i=r.split("::"),n=i[0],r=i[1],"Ready"===r&&n===h.uid?h.trigger("ready"):s[n]&&s[n].trigger(r.toLowerCase(),t,e)}var r={},s={},u=this.destroy,h=this,c=e.guid("webuploader_");i.apply(h,arguments),h.type=a,h.exec=function(t,i){var n,a=this,u=a.uid,c=e.slice(arguments,2);return s[u]=a,o[t]&&(r[u]||(r[u]=new o[t](a,h)),n=r[u],n[i])?n[i].apply(n,c):h.flashExec.apply(a,arguments)},t[c]=function(){var t=arguments;setTimeout(function(){n.apply(null,t)},1)},this.jsreciver=c,this.destroy=function(){return u&&u.apply(this,arguments)},this.flashExec=function(t,i){var n=h.getFlash(),r=e.slice(arguments,2);return n.exec(this.uid,t,i,r)}}var $=e.$,a="flash",o={};return e.inherits(i,{"constructor":r,"init":function(){var t,i=this.getContainer(),n=this.options;i.css({"position":"absolute","top":"-8px","left":"-8px","width":"9px","height":"9px","overflow":"hidden"}),t='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+n.swf+'" ',e.browser.ie&&(t+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),t+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+n.swf+'" /><param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',i.html(t)},"getFlash":function(){return this._flash?this._flash:(this._flash=$("#"+this.uid).get(0),this._flash)}}),r.register=function(t,i){return i=o[t]=e.inherits(n,$.extend({"flashExec":function(){var t=this.owner;return this.getRuntime().flashExec.apply(t,arguments)}},i))},function(){var t;try{t=navigator.plugins["Shockwave Flash"],t=t.description}catch(e){try{t=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){t="0.0"}}return t=t.match(/\d+/g),parseFloat(t[0]+"."+t[1],10)}()>=11.4&&i.addRuntime(a,r),r}),e("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(t,e){var $=t.$;return e.register("FilePicker",{"init":function(t){var e,i,n=$.extend({},t);for(e=n.accept&&n.accept.length,i=0;i<e;i++)n.accept[i].title||(n.accept[i].title="Files");delete n.button,delete n.id,delete n.container,this.flashExec("FilePicker","init",n)},"destroy":function(){this.flashExec("FilePicker","destroy")}})}),e("runtime/flash/image",["runtime/flash/runtime"],function(t){return t.register("Image",{"loadFromBlob":function(t){var e=this.owner;e.info()&&this.flashExec("Image","info",e.info()),e.meta()&&this.flashExec("Image","meta",e.meta()),this.flashExec("Image","loadFromBlob",t.uid)}})}),e("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(e,i,n){var $=e.$;return i.register("Transport",{"init":function(){this._status=0,this._response=null,this._responseJson=null},"send":function(){var t,e=this.owner,i=this.options,n=this._initAjax(),r=e._blob,a=i.server;n.connectRuntime(r.ruid),i.sendAsBinary?(a+=(/\?/.test(a)?"&":"?")+$.param(e._formData),t=r.uid):($.each(e._formData,function(t,e){n.exec("append",t,e)}),n.exec("appendBlob",i.fileVal,r.uid,i.filename||e._formData.name||"")),this._setRequestHeader(n,i.headers),n.exec("send",{"method":i.method,"url":a,"forceURLStream":i.forceURLStream,"mimeType":"application/octet-stream"},t)},"getStatus":function(){return this._status},"getResponse":function(){return this._response||""},"getResponseAsJson":function(){return this._responseJson},"abort":function(){var t=this._xhr;t&&(t.exec("abort"),t.destroy(),this._xhr=t=null)},"destroy":function(){this.abort()},"_initAjax":function(){var e=this,i=new n("XMLHttpRequest");return i.on("uploadprogress progress",function(t){var i=t.loaded/t.total;return i=Math.min(1,Math.max(0,i)),e.trigger("progress",i)}),i.on("load",function(){var n,r=i.exec("getStatus"),a=!1,o="";return i.off(),e._xhr=null,r>=200&&r<300?a=!0:r>=500&&r<600?(a=!0,o="server"):o="http",a&&(e._response=i.exec("getResponse"),e._response=decodeURIComponent(e._response),n=t.JSON&&t.JSON.parse||function(t){try{return new Function("return "+t).call()}catch(t){return{}}},e._responseJson=e._response?n(e._response):{}),i.destroy(),i=null,o?e.trigger("error",o):e.trigger("load")}),i.on("error",function(){i.off(),e._xhr=null,e.trigger("error","http")}),e._xhr=i,i},"_setRequestHeader":function(t,e){$.each(e,function(e,i){t.exec("setRequestHeader",e,i)})}})}),e("runtime/flash/blob",["runtime/flash/runtime","lib/blob"],function(t,e){return t.register("Blob",{"slice":function(t,i){var n=this.flashExec("Blob","slice",t,i);return new e(n.uid,n)}})}),e("runtime/flash/md5",["runtime/flash/runtime"],function(t){return t.register("Md5",{"init":function(){},"loadFromBlob":function(t){return this.flashExec("Md5","loadFromBlob",t.uid)}})}),e("preset/all",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","widgets/md5","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/androidpatch","runtime/html5/image","runtime/html5/transport","runtime/html5/md5","runtime/flash/filepicker","runtime/flash/image","runtime/flash/transport","runtime/flash/blob","runtime/flash/md5"],function(t){return t}),e("widgets/log",["base","uploader","widgets/widget"],function(t,e){function i(t){var e=$.extend({},n,t),i=r.replace(/^(.*)\?/,"$1"+$.param(e));(new Image).src=i}var n,$=t.$,r=" http://static.tieba.baidu.com/tb/pms/img/st.gif??",a=(location.hostname||location.host||"protected").toLowerCase(),o=a&&/baidu/i.exec(a);if(o)return n={"dv":3,"master":"webuploader","online":/test/.exec(a)?0:1,"module":"","product":a,"type":0},e.register({"name":"log","init":function(){var t=this.owner,e=0,n=0;t.on("error",function(t){i({"type":2,"c_error_code":t})}).on("uploadError",function(t,e){i({"type":2,"c_error_code":"UPLOAD_ERROR","c_reason":""+e})}).on("uploadComplete",function(t){e++,n+=t.size}).on("uploadFinished",function(){i({"c_count":e,"c_size":n}),e=n=0}),i({"c_usage":1})}})}),e("webuploader",["preset/all","widgets/log"],function(t){return t}),require("webuploader")})}).call(exports,e(0))},"300":function(t,exports,e){"use strict";e(82).init(),e(301).init(),e(84).init(),e(302).init()},"301":function(t,exports,e){"use strict";(function($){function i(){r.on("click",function(){n.init({"imgSrc":a.attr("src")})})}var n=e(83),r=$("[data-node=uploadAvatar]"),a=$('[data-node="avatar"]');t.exports.init=i}).call(exports,e(0))},"302":function(t,exports,e){"use strict";(function($,i){function n(){c.on("click",g)}var r=e(2),a=e(5),o=e(4),s=$('[data-node="desIpt"]'),u=$('[data-node="nameIpt"]'),h=$('[data-node="avatar"]'),c=$('[data-node="create"]'),d=$('[data-node="nameErr"]'),l=$('[data-node="desErr"]'),p=function(t){u.addClass("red-border"),d.removeClass("none").text(t)},f=function(t){s.addClass("red-border"),l.removeClass("none").text(t)},g=function(){var t=s.val(),e=u.val(),n=h.attr("src");return e.length>15?void p("不限制输入类型，最大可输入15个汉字。"):t.length>100?void f("不限制输入类型，最大可输入100个汉字。"):void r.post(a.get("saveMshop"),{"data":{"name":e,"icon":n,"description":t}}).done(function(t){200==t.code?window.location.href=i.meidian_domain+"admin":o(t.message)})};t.exports.init=n}).call(exports,e(0),e(1))},"35":function(t,exports,e){"use strict";(function($,i){var n=e(12);e(36);var r,a,o=$('[data-node="noticeBox"]'),s=$('[data-node="cropWrap"]'),u=s.find("img"),h=$('[data-node="avatrSelector"]'),c=$('[data-action="avatarSave"]'),d=o.find('[data-node="uploadProgress"]'),l=$('[data-node="error"]'),p=o.find('[data-node="loadNotice"]'),f=o.find('[data-action="retry"]'),g={},m=u.attr("data-default"),v=!1,b="",w=!window.FormData,y=!1,x=function(){v=!0,u.cropper({"aspectRatio":1,"preview":h.selector,"background":!1,"guides":!1})},_=function(t,e,i){r=n.create(t),r.on("beforeFileQueued",function(){v=!1,u.cropper("destroy"),l.hide(),void 0!==a&&r.removeFile(a.id)}),r.on("fileQueued",function(e){a=e,w&&!y?(r.upload(a),y=!0):r.makeThumb(e,function(e,i){e?(r.removeFile(a.id),o.removeClass("load-ing").show()):(u.attr("src",i),x(),c.addClass("active"),u.attr("data-edit")&&($("[data-defaultAddFile=picker]").hide(),r.addButton({"id":'[data-action="upload-edit"]',"innerHTML":t.uptxtBtn})))}),r.md5File(e).progress(function(t){p.text("图片加载中"),o.addClass("load-ing").show(),d.css("width",100*t+"%")}).then(function(){o.hide(),d.css("width",0)})}),r.on("error",function(){u.attr("src",m),h.find("img").attr("src",m),l.show().find("span").text(t.errTip),c.removeClass("active")}),r.on("uploadSuccess",function(t,e){e.success&&200===e.code?y?(u.attr("src",e.data[0]),x(),o.hide(),y=!1,c.addClass("active")):(u.attr("src",e.data[0]),o.hide(),u.cropper("destroy"),h.find("img").attr("src",e.data[0]),r.removeFile(a),b=e.data[0],i.call(null,e.data[0]),c.removeClass("active"),a=void 0):($(".cropper-crop-box").hide(),o.removeClass("load-ing").show(),v=!0)}),r.on("uploadError",function(){$(".cropper-crop-box").hide(),o.removeClass("load-ing").show(),v=!0}),r.on("uploadProgress",function(t,e){$(".cropper-crop-box").hide(),p.text("图片上传中"),o.addClass("load-ing").show(),d.css("width",100*e+"%"),v=!1})},C=function(){c.on("click",function(){v&&$(this).hasClass("active")?(v=!1,g=u.cropper("getData"),g.type="crop",r.on("uploadBeforeSend",function(t,e){$.extend(e,g)}),r.upload(a)):$(".ui-dialog-close").trigger("click"),f.addClass("active")}),f.on("click",function(){v&&$(this).hasClass("active")&&(v=!1,g=u.cropper("getData"),g.type="crop",r.on("uploadBeforeSend",function(t,e){$.extend(e,g)}),r.retry(a))})},R=function(t,e,n){o=$('[data-node="noticeBox"]'),s=$('[data-node="cropWrap"]'),u=s.find("img"),h=$('[data-node="avatrSelector"]'),c=$('[data-action="avatarSave"]'),d=o.find('[data-node="uploadProgress"]'),l=$('[data-node="error"]'),p=o.find('[data-node="loadNotice"]'),f=o.find('[data-action="retry"]'),m=u.attr("data-default");var a=t||function(){},g={"pick":{"id":"[data-defaultAddFile=picker]","innerHTML":"<span>+</span>上传头像","multiple":!1},"thumb":!1,"compress":!1,"accept":{"title":"Images","extensions":"jpg,jpeg,png","mimeTypes":"image/jpg,image/jpeg,image/png,image/gif"},"method":"post","swf":i.imgpath+"/images/swf/Uploader.swf","disableGlobalDnd":!0,"duplicate":!0,"prepareNextFile":!0,"chunked":!0,"fileVal":"avatar_file","server":"/ajax/crop/crop_img","fileNumLimit":1,"fileSizeLimit":2097152,"fileSingleSizeLimit":2097152,"errTip":"请上传小于2M的图片，支持格式jpg、jpeg、png、gif！"},v={"aspectRatio":1,"preview":h.selector,"background":!1,"guides":!1},b=$.extend(!0,g,e);$.extend(!0,v,n);return _(b,0,a),C(),{"webUpLoader":r,"cropper":u}},k=function(t){t=t||function(){},t.call(null,{"webUpLoader":r,"cropper":u}),a=void 0,r.destroy(),u.cropper("destroy")},T=function(){return b};t.exports={"init":R,"getData":T,"destroy":k}}).call(exports,e(0),e(1))},"36":function(t,exports,e){"use strict";var i,n,r;"function"==typeof Symbol&&Symbol.iterator;!function(a){n=[e(0)],i=a,void 0!==(r="function"==typeof i?i.apply(exports,n):i)&&(t.exports=r)}(function(t){function e(t){return"number"==typeof t}function i(t){return void 0===t}function n(t,i){var n=[];return e(i)&&n.push(i),n.slice.apply(t,n)}function r(t,e){var i=n(arguments,2);return function(){return t.apply(e,i.concat(n(arguments)))}}function a(t){var e=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return e&&(e[1]!==f.protocol||e[2]!==f.hostname||e[3]!==f.port)}function o(t){var e="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+e}function s(t,e){return e.left<0&&t.width<e.left+e.width&&e.top<0&&t.height<e.top+e.height}function u(t){return t?"rotate("+t+"deg)":"none"}function h(t,e){var i,n,r=j(t.degree)%180,a=(r>90?180-r:r)*Math.PI/180,o=M(a),s=q(a),u=t.width,h=t.height,c=t.aspectRatio;return e?(i=u/(s+o/c),n=i/c):(i=u*s+h*o,n=u*o+h*s),{"width":i,"height":n}}function c(e,i){var n=t("<canvas>")[0],r=n.getContext("2d"),a=i.naturalWidth,o=i.naturalHeight,s=i.rotate,u=h({"width":a,"height":o,"degree":s});return s?(n.width=u.width,n.height=u.height,r.save(),r.translate(u.width/2,u.height/2),r.rotate(s*Math.PI/180),r.drawImage(e,-a/2,-o/2,a,o),r.restore()):(n.width=a,n.height=o,r.drawImage(e,0,0,a,o)),n}function d(e,i){this.$element=t(e),this.options=t.extend({},d.DEFAULTS,t.isPlainObject(i)&&i),this.ready=!1,this.built=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.canvas=null,this.cropBox=null,this.load()}var l=t(window),p=t(document),f=window.location,g=".cropper",m="preview"+g,v=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,b="cropper-modal",w="cropper-hide",y="cropper-hidden",x="cropper-crop",_="cropper-disabled",C="mousedown touchstart",R="mousemove touchmove",k="mouseup mouseleave touchend touchleave touchcancel",T="wheel mousewheel DOMMouseScroll",E="dblclick",S="resize"+g,D="build"+g,B="built"+g,F="dragstart"+g,A="dragmove"+g,I="dragend"+g,O="zoomin"+g,U="zoomout"+g,L=t.isFunction(t("<canvas>")[0].getContext),z=Math.sqrt,H=Math.min,P=Math.max,j=Math.abs,M=Math.sin,q=Math.cos,N=parseFloat,W={};W.load=function(e){var i,n,r,s,u=this.options,h=this.$element;if(!e)if(h.is("img")){if(!h.attr("src"))return;e=h.prop("src")}else h.is("canvas")&&L&&(e=h[0].toDataURL());e&&(r=t.Event(D),h.one(D,u.build).trigger(r),r.isDefaultPrevented()||(u.checkImageOrigin&&a(e)&&(i="anonymous",h.prop("crossOrigin")||(n=o(e))),this.$clone=s=t("<img>"),s.one("load",t.proxy(function(){var t=s.prop("naturalWidth")||s.width(),i=s.prop("naturalHeight")||s.height();this.image={"naturalWidth":t,"naturalHeight":i,"aspectRatio":t/i,"rotate":0},this.url=e,this.ready=!0,this.build()},this)).one("error",function(){s.remove()}).attr({"src":n||e,"crossOrigin":i}),s.addClass(w).insertAfter(h)))},W.build=function(){var e,i,n=this.$element,r=this.$clone,a=this.options;this.ready&&(this.built&&this.unbuild(),this.$cropper=e=t(d.TEMPLATE),n.addClass(y),r.removeClass(w),this.$container=n.parent().append(e),this.$canvas=e.find(".cropper-canvas").append(r),this.$dragBox=e.find(".cropper-drag-box"),this.$cropBox=i=e.find(".cropper-crop-box"),this.$viewBox=e.find(".cropper-view-box"),this.addListeners(),this.initPreview(),a.aspectRatio=N(a.aspectRatio)||NaN,a.autoCrop?(this.cropped=!0,a.modal&&this.$dragBox.addClass(b)):i.addClass(y),a.background&&e.addClass("cropper-bg"),a.highlight||i.find(".cropper-face").addClass("cropper-invisible"),a.guides||i.find(".cropper-dashed").addClass(y),a.movable||i.find(".cropper-face").data("drag","move"),a.resizable||i.find(".cropper-line, .cropper-point").addClass(y),this.setDragMode(a.dragCrop?"crop":"move"),this.built=!0,this.render(),n.one(B,a.built).trigger(B))},W.unbuild=function(){this.built&&(this.built=!1,this.container=null,this.canvas=null,this.cropBox=null,this.removeListeners(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},t.extend(W,{"render":function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},"initContainer":function(){var t=this.$element,e=this.$container,i=this.$cropper,n=this.options;i.addClass(y),t.removeClass(y),i.css(this.container={"width":P(e.width(),N(n.minContainerWidth)||200),"height":P(e.height(),N(n.minContainerHeight)||100)}),t.addClass(y),i.removeClass(y)},"initCanvas":function(){var e=this.container,i=e.width,n=e.height,r=this.image,a=r.aspectRatio,o={"aspectRatio":a,"width":i,"height":n};n*a>i?o.height=i/a:o.width=n*a,o.oldLeft=o.left=(i-o.width)/2,o.oldTop=o.top=(n-o.height)/2,this.canvas=o,this.limitCanvas(!0,!0),this.initialImage=t.extend({},r),this.initialCanvas=t.extend({},o)},"limitCanvas":function(e,i){var n,r,a=this.options,o=a.strict,s=this.container,u=s.width,h=s.height,c=this.canvas,d=c.aspectRatio,l=this.cropBox,p=this.cropped&&l;e&&(n=N(a.minCanvasWidth)||0,r=N(a.minCanvasHeight)||0,n?(o&&(n=P(p?l.width:u,n)),r=n/d):r?(o&&(r=P(p?l.height:h,r)),n=r*d):o&&(p?(n=l.width,r=l.height,r*d>n?n=r*d:r=n/d):(n=u,r=h,r*d>n?r=n/d:n=r*d)),t.extend(c,{"minWidth":n,"minHeight":r,"maxWidth":1/0,"maxHeight":1/0})),i&&(o?p?(c.minLeft=H(l.left,l.left+l.width-c.width),c.minTop=H(l.top,l.top+l.height-c.height),c.maxLeft=l.left,c.maxTop=l.top):(c.minLeft=H(0,u-c.width),c.minTop=H(0,h-c.height),c.maxLeft=P(0,u-c.width),c.maxTop=P(0,h-c.height)):(c.minLeft=-c.width,c.minTop=-c.height,c.maxLeft=u,c.maxTop=h))},"renderCanvas":function(t){var e,i,n=this.options,r=this.canvas,a=this.image;this.rotated&&(this.rotated=!1,i=h({"width":a.width,"height":a.height,"degree":a.rotate}),(e=i.width/i.height)!==r.aspectRatio&&(r.left-=(i.width-r.width)/2,r.top-=(i.height-r.height)/2,r.width=i.width,r.height=i.height,r.aspectRatio=e,this.limitCanvas(!0,!1))),(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=H(P(r.width,r.minWidth),r.maxWidth),r.height=H(P(r.height,r.minHeight),r.maxHeight),this.limitCanvas(!1,!0),r.oldLeft=r.left=H(P(r.left,r.minLeft),r.maxLeft),r.oldTop=r.top=H(P(r.top,r.minTop),r.maxTop),this.$canvas.css({"width":r.width,"height":r.height,"left":r.left,"top":r.top}),this.renderImage(),this.cropped&&n.strict&&!s(this.container,r)&&this.limitCropBox(!0,!0),t&&this.output()},"renderImage":function(){var e,i=this.canvas,n=this.image;n.rotate&&(e=h({"width":i.width,"height":i.height,"degree":n.rotate,"aspectRatio":n.aspectRatio},!0)),t.extend(n,e?{"width":e.width,"height":e.height,"left":(i.width-e.width)/2,"top":(i.height-e.height)/2}:{"width":i.width,"height":i.height,"left":0,"top":0}),this.$clone.css({"width":n.width,"height":n.height,"marginLeft":n.left,"marginTop":n.top,"transform":u(n.rotate)})},"initCropBox":function(){var e=this.options,i=this.canvas,n=e.aspectRatio,r=N(e.autoCropArea)||.8,a={"width":i.width,"height":i.height};n&&(i.height*n>i.width?a.height=a.width/n:a.width=a.height*n),this.cropBox=a,this.limitCropBox(!0,!0),a.width=H(P(a.width,a.minWidth),a.maxWidth),a.height=H(P(a.height,a.minHeight),a.maxHeight),a.width=P(a.minWidth,a.width*r),a.height=P(a.minHeight,a.height*r),a.oldLeft=a.left=i.left+(i.width-a.width)/2,a.oldTop=a.top=i.top+(i.height-a.height)/2,this.initialCropBox=t.extend({},a)},"limitCropBox":function(t,e){var i,n,r=this.options,a=r.strict,o=this.container,s=o.width,u=o.height,h=this.canvas,c=this.cropBox,d=r.aspectRatio;t&&(i=N(r.minCropBoxWidth)||0,n=N(r.minCropBoxHeight)||0,c.minWidth=H(s,i),c.minHeight=H(u,n),c.maxWidth=H(s,a?h.width:s),c.maxHeight=H(u,a?h.height:u),d&&(c.maxHeight*d>c.maxWidth?(c.minHeight=c.minWidth/d,c.maxHeight=c.maxWidth/d):(c.minWidth=c.minHeight*d,c.maxWidth=c.maxHeight*d)),c.minWidth=H(c.maxWidth,c.minWidth),c.minHeight=H(c.maxHeight,c.minHeight)),e&&(a?(c.minLeft=P(0,h.left),c.minTop=P(0,h.top),c.maxLeft=H(s,h.left+h.width)-c.width,c.maxTop=H(u,h.top+h.height)-c.height):(c.minLeft=0,c.minTop=0,c.maxLeft=s-c.width,c.maxTop=u-c.height))},"renderCropBox":function(){var t=this.options,e=this.container,i=e.width,n=e.height,r=this.$cropBox,a=this.cropBox;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=H(P(a.width,a.minWidth),a.maxWidth),a.height=H(P(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.oldLeft=a.left=H(P(a.left,a.minLeft),a.maxLeft),a.oldTop=a.top=H(P(a.top,a.minTop),a.maxTop),t.movable&&r.find(".cropper-face").data("drag",a.width===i&&a.height===n?"move":"all"),r.css({"width":a.width,"height":a.height,"left":a.left,"top":a.top}),this.cropped&&t.strict&&!s(e,this.canvas)&&this.limitCanvas(!0,!0),this.disabled||this.output()},"output":function(){var t=this.options;this.preview(),t.crop&&t.crop.call(this.$element,this.getData())}}),W.initPreview=function(){var e=this.url;this.$preview=t(this.options.preview),this.$viewBox.html('<img src="'+e+'">'),this.$preview.each(function(){var i=t(this);i.data(m,{"width":i.width(),"height":i.height(),"original":i.html()}).html('<img src="'+e+'" style="display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important">')})},W.resetPreview=function(){this.$preview.each(function(){var e=t(this);e.html(e.data(m).original).removeData(m)})},W.preview=function(){var e=this.image,i=this.canvas,n=this.cropBox,r=e.width,a=e.height,o=n.left-i.left-e.left,s=n.top-i.top-e.top,h=e.rotate;this.cropped&&!this.disabled&&(this.$viewBox.find("img").css({"width":r,"height":a,"marginLeft":-o,"marginTop":-s,"transform":u(h)}),this.$preview.each(function(){var e=t(this),i=e.data(m),c=i.width/n.width,d=i.width,l=n.height*c;l>i.height&&(c=i.height/n.height,d=n.width*c,l=i.height),e.width(d).height(l).find("img").css({"width":r*c,"height":a*c,"marginLeft":-o*c,"marginTop":-s*c,"transform":u(h)})}))},W.addListeners=function(){var e=this.options;this.$element.on(F,e.dragstart).on(A,e.dragmove).on(I,e.dragend).on(O,e.zoomin).on(U,e.zoomout),this.$cropper.on(C,t.proxy(this.dragstart,this)).on(E,t.proxy(this.dblclick,this)),e.zoomable&&e.mouseWheelZoom&&this.$cropper.on(T,t.proxy(this.wheel,this)),p.on(R,this._dragmove=r(this.dragmove,this)).on(k,this._dragend=r(this.dragend,this)),e.responsive&&l.on(S,this._resize=r(this.resize,this))},W.removeListeners=function(){var t=this.options;this.$element.off(F,t.dragstart).off(A,t.dragmove).off(I,t.dragend).off(O,t.zoomin).off(U,t.zoomout),this.$cropper.off(C,this.dragstart).off(E,this.dblclick),t.zoomable&&t.mouseWheelZoom&&this.$cropper.off(T,this.wheel),p.off(R,this._dragmove).off(k,this._dragend),t.responsive&&l.off(S,this._resize)},t.extend(W,{"resize":function(){var e,i,n,r=this.$container,a=this.container;this.disabled||(1!==(n=r.width()/a.width)||r.height()!==a.height)&&(e=this.getCanvasData(),i=this.getCropBoxData(),this.render(),this.setCanvasData(t.each(e,function(t,i){e[t]=i*n})),this.setCropBoxData(t.each(i,function(t,e){i[t]=e*n})))},"dblclick":function(){this.disabled||this.setDragMode(this.$dragBox.hasClass(x)?"move":"crop")},"wheel":function(t){var e=t.originalEvent,i=1;this.disabled||(t.preventDefault(),e.deltaY?i=e.deltaY>0?1:-1:e.wheelDelta?i=-e.wheelDelta/120:e.detail&&(i=e.detail>0?1:-1),this.zoom(.1*-i))},"dragstart":function(e){var i,n,r,a=this.options,o=e.originalEvent,s=o&&o.touches,u=e;if(!this.disabled){if(s){if((r=s.length)>1){if(!a.zoomable||!a.touchDragZoom||2!==r)return;u=s[1],this.startX2=u.pageX,this.startY2=u.pageY,i="zoom"}u=s[0]}if(i=i||t(u.target).data("drag"),v.test(i)){if(e.preventDefault(),n=t.Event(F,{"originalEvent":o,"dragType":i}),this.$element.trigger(n),n.isDefaultPrevented())return;this.dragType=i,this.cropping=!1,this.startX=u.pageX,this.startY=u.pageY,"crop"===i&&(this.cropping=!0,this.$dragBox.addClass(b))}}},"dragmove":function(e){var i,n,r=this.options,a=e.originalEvent,o=a&&a.touches,s=e,u=this.dragType;if(!this.disabled){if(o){if((n=o.length)>1){if(!r.zoomable||!r.touchDragZoom||2!==n)return;s=o[1],this.endX2=s.pageX,this.endY2=s.pageY}s=o[0]}if(u){if(e.preventDefault(),i=t.Event(A,{"originalEvent":a,"dragType":u}),this.$element.trigger(i),i.isDefaultPrevented())return;this.endX=s.pageX,this.endY=s.pageY,this.change()}}},"dragend":function(e){var i,n=this.dragType;if(!this.disabled&&n){if(e.preventDefault(),i=t.Event(I,{"originalEvent":e.originalEvent,"dragType":n}),this.$element.trigger(i),i.isDefaultPrevented())return;this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(b,this.cropped&&this.options.modal)),this.dragType=""}}}),t.extend(W,{"reset":function(){this.built&&!this.disabled&&(this.image=t.extend({},this.initialImage),this.canvas=t.extend({},this.initialCanvas),this.renderCanvas(),this.cropped&&(this.cropBox=t.extend({},this.initialCropBox),this.renderCropBox()))},"clear":function(){this.cropped&&!this.disabled&&(t.extend(this.cropBox,{"left":0,"top":0,"width":0,"height":0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass(b),this.$cropBox.addClass(y))},"destroy":function(){var t=this.$element;this.ready?(this.unbuild(),t.removeClass(y)):this.$clone.off("load").remove(),t.removeData("cropper")},"replace":function(t){!this.disabled&&t&&this.load(t)},"enable":function(){this.built&&(this.disabled=!1,this.$cropper.removeClass(_))},"disable":function(){this.built&&(this.disabled=!0,this.$cropper.addClass(_))},"move":function(t,i){var n=this.canvas;this.built&&!this.disabled&&e(t)&&e(i)&&(n.left+=t,n.top+=i,this.renderCanvas(!0))},"zoom":function(e){var i,n,r,a=this.canvas;if((e=N(e))&&this.built&&!this.disabled&&this.options.zoomable){if(i=t.Event(e>0?O:U),this.$element.trigger(i),i.isDefaultPrevented())return;e=-1>=e?1/(1-e):1>=e?1+e:e,n=a.width*e,r=a.height*e,a.left-=(n-a.width)/2,a.top-=(r-a.height)/2,a.width=n,a.height=r,this.renderCanvas(!0),this.setDragMode("move")}},"rotate":function(t){var e=this.image;(t=N(t))&&this.built&&!this.disabled&&this.options.rotatable&&(e.rotate=(e.rotate+t)%360,this.rotated=!0,this.renderCanvas(!0))},"getData":function(){var e,i,n=this.cropBox,r=this.canvas,a=this.image;return this.built&&this.cropped?(i={"x":n.left-r.left,"y":n.top-r.top,"width":n.width,"height":n.height},e=a.width/a.naturalWidth,t.each(i,function(t,n){n/=e,i[t]=n})):i={"x":0,"y":0,"width":0,"height":0},i.rotate=a.rotate,i},"getContainerData":function(){return this.built?this.container:{}},"getImageData":function(){return this.ready?this.image:{}},"getCanvasData":function(){var t,e=this.canvas;return this.built&&(t={"left":e.left,"top":e.top,"width":e.width,"height":e.height}),t||{}},"setCanvasData":function(i){var n=this.canvas,r=n.aspectRatio;this.built&&!this.disabled&&t.isPlainObject(i)&&(e(i.left)&&(n.left=i.left),e(i.top)&&(n.top=i.top),e(i.width)?(n.width=i.width,n.height=i.width/r):e(i.height)&&(n.height=i.height,n.width=i.height*r),this.renderCanvas(!0))},"getCropBoxData":function(){var t,e=this.cropBox;return this.built&&this.cropped&&(t={"left":e.left,"top":e.top,"width":e.width,"height":e.height}),t||{}},"setCropBoxData":function(i){var n=this.cropBox,r=this.options.aspectRatio;this.built&&this.cropped&&!this.disabled&&t.isPlainObject(i)&&(e(i.left)&&(n.left=i.left),e(i.top)&&(n.top=i.top),r?e(i.width)?(n.width=i.width,n.height=n.width/r):e(i.height)&&(n.height=i.height,n.width=n.height*r):(e(i.width)&&(n.width=i.width),e(i.height)&&(n.height=i.height)),this.renderCropBox())},"getCroppedCanvas":function(e){var i,n,r,a,o,s,u,h,d,l,p;if(this.built&&this.cropped&&L)return t.isPlainObject(e)||(e={}),p=this.getData(),i=p.width,n=p.height,h=i/n,t.isPlainObject(e)&&(o=e.width,s=e.height,o?(s=o/h,u=o/i):s&&(o=s*h,u=s/n)),r=o||i,a=s||n,d=t("<canvas>")[0],d.width=r,d.height=a,l=d.getContext("2d"),e.fillColor&&(l.fillStyle=e.fillColor,l.fillRect(0,0,r,a)),l.drawImage.apply(l,function(){var t,e,r,a,o,s,h=c(this.$clone[0],this.image),d=h.width,l=h.height,f=[h],g=p.x,m=p.y;return-i>=g||g>d?g=t=r=o=0:0>=g?(r=-g,g=0,t=o=H(d,i+g)):d>=g&&(r=0,t=o=H(i,d-g)),0>=t||-n>=m||m>l?m=e=a=s=0:0>=m?(a=-m,m=0,e=s=H(l,n+m)):l>=m&&(a=0,e=s=H(n,l-m)),f.push(g,m,t,e),u&&(r*=u,a*=u,o*=u,s*=u),o>0&&s>0&&f.push(r,a,o,s),f}.call(this)),d},"setAspectRatio":function(t){var e=this.options;this.disabled||i(t)||(e.aspectRatio=N(t)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},"setDragMode":function(t){var e=this.$dragBox,i=!1,n=!1;if(this.ready&&!this.disabled){switch(t){case"crop":this.options.dragCrop?(i=!0,e.data("drag",t)):n=!0;break;case"move":n=!0,e.data("drag",t);break;default:e.removeData("drag")}e.toggleClass(x,i).toggleClass("cropper-move",n)}}}),W.change=function(){var t,e=this.dragType,i=this.options,n=this.canvas,r=this.container,a=this.cropBox,o=a.width,s=a.height,u=a.left,h=a.top,c=u+o,d=h+s,l=0,p=0,f=r.width,g=r.height,m=!0,v=i.aspectRatio,b={"x":this.endX-this.startX,"y":this.endY-this.startY};switch(i.strict&&(l=a.minLeft,p=a.minTop,f=l+H(r.width,n.width),g=p+H(r.height,n.height)),v&&(b.X=b.y*v,b.Y=b.x/v),e){case"all":u+=b.x,h+=b.y;break;case"e":if(b.x>=0&&(c>=f||v&&(p>=h||d>=g))){m=!1;break}o+=b.x,v&&(s=o/v,h-=b.Y/2),0>o&&(e="w",o=0);break;case"n":if(b.y<=0&&(p>=h||v&&(l>=u||c>=f))){m=!1;break}s-=b.y,h+=b.y,v&&(o=s*v,u+=b.X/2),0>s&&(e="s",s=0);break;case"w":if(b.x<=0&&(l>=u||v&&(p>=h||d>=g))){m=!1;break}o-=b.x,u+=b.x,v&&(s=o/v,h+=b.Y/2),0>o&&(e="e",o=0);break;case"s":if(b.y>=0&&(d>=g||v&&(l>=u||c>=f))){m=!1;break}s+=b.y,v&&(o=s*v,u-=b.X/2),0>s&&(e="n",s=0);break;case"ne":if(v){if(b.y<=0&&(p>=h||c>=f)){m=!1;break}s-=b.y,h+=b.y,o=s*v}else b.x>=0?f>c?o+=b.x:b.y<=0&&p>=h&&(m=!1):o+=b.x,b.y<=0?h>0&&(s-=b.y,h+=b.y):(s-=b.y,h+=b.y);0>o&&0>s?(e="sw",s=0,o=0):0>o?(e="nw",o=0):0>s&&(e="se",s=0);break;case"nw":if(v){if(b.y<=0&&(p>=h||l>=u)){m=!1;break}s-=b.y,h+=b.y,o=s*v,u+=b.X}else b.x<=0?u>0?(o-=b.x,u+=b.x):b.y<=0&&p>=h&&(m=!1):(o-=b.x,u+=b.x),b.y<=0?h>0&&(s-=b.y,h+=b.y):(s-=b.y,h+=b.y);0>o&&0>s?(e="se",s=0,o=0):0>o?(e="ne",o=0):0>s&&(e="sw",s=0);break;case"sw":if(v){if(b.x<=0&&(l>=u||d>=g)){m=!1;break}o-=b.x,u+=b.x,s=o/v}else b.x<=0?u>0?(o-=b.x,u+=b.x):b.y>=0&&d>=g&&(m=!1):(o-=b.x,u+=b.x),b.y>=0?g>d&&(s+=b.y):s+=b.y;0>o&&0>s?(e="ne",s=0,o=0):0>o?(e="se",o=0):0>s&&(e="nw",s=0);break;case"se":if(v){if(b.x>=0&&(c>=f||d>=g)){m=!1;break}o+=b.x,s=o/v}else b.x>=0?f>c?o+=b.x:b.y>=0&&d>=g&&(m=!1):o+=b.x,b.y>=0?g>d&&(s+=b.y):s+=b.y;0>o&&0>s?(e="nw",s=0,o=0):0>o?(e="sw",o=0):0>s&&(e="ne",s=0);break;case"move":n.left+=b.x,n.top+=b.y,this.renderCanvas(!0),m=!1;break;case"zoom":this.zoom(function(t,e,i,n){var r=z(t*t+e*e);return(z(i*i+n*n)-r)/r}(j(this.startX-this.startX2),j(this.startY-this.startY2),j(this.endX-this.endX2),j(this.endY-this.endY2))),this.startX2=this.endX2,this.startY2=this.endY2,m=!1;break;case"crop":b.x&&b.y&&(t=this.$cropper.offset(),u=this.startX-t.left,h=this.startY-t.top,o=a.minWidth,s=a.minHeight,b.x>0?b.y>0?e="se":(e="ne",h-=s):b.y>0?(e="sw",u-=o):(e="nw",u-=o,h-=s),this.cropped||(this.cropped=!0,this.$cropBox.removeClass(y)))}m&&(a.width=o,a.height=s,a.left=u,a.top=h,this.dragType=e,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},t.extend(d.prototype,W),d.DEFAULTS={"aspectRatio":NaN,"autoCropArea":.8,"crop":null,"preview":"","strict":!0,"responsive":!0,"checkImageOrigin":!0,"modal":!0,"guides":!0,"highlight":!0,"background":!0,"autoCrop":!0,"dragCrop":!0,"movable":!0,"resizable":!0,"rotatable":!0,"zoomable":!0,"touchDragZoom":!0,"mouseWheelZoom":!0,"minCanvasWidth":0,"minCanvasHeight":0,"minCropBoxWidth":0,"minCropBoxHeight":0,"minContainerWidth":200,"minContainerHeight":100,"build":null,"built":null,"dragstart":null,"dragmove":null,"dragend":null,"zoomin":null,"zoomout":null},d.setDefaults=function(e){t.extend(d.DEFAULTS,e)},d.TEMPLATE=function(t,e){return e=e.split(","),t.replace(/\d+/g,function(t){return e[t]})}('<0 6="5-container"><0 6="5-canvas"></0><0 6="5-2-9" 3-2="move"></0><0 6="5-crop-9"><1 6="5-view-9"></1><1 6="5-8 8-h"></1><1 6="5-8 8-v"></1><1 6="5-face" 3-2="all"></1><1 6="5-7 7-e" 3-2="e"></1><1 6="5-7 7-n" 3-2="n"></1><1 6="5-7 7-w" 3-2="w"></1><1 6="5-7 7-s" 3-2="s"></1><1 6="5-4 4-e" 3-2="e"></1><1 6="5-4 4-n" 3-2="n"></1><1 6="5-4 4-w" 3-2="w"></1><1 6="5-4 4-s" 3-2="s"></1><1 6="5-4 4-ne" 3-2="ne"></1><1 6="5-4 4-nw" 3-2="nw"></1><1 6="5-4 4-sw" 3-2="sw"></1><1 6="5-4 4-se" 3-2="se"></1></0></0>',"div,span,drag,data,point,cropper,class,line,dashed,box"),d.other=t.fn.cropper,t.fn.cropper=function(e){var r,a=n(arguments,1);return this.each(function(){var i,n=t(this),o=n.data("cropper");o||n.data("cropper",o=new d(this,e)),"string"==typeof e&&t.isFunction(i=o[e])&&(r=i.apply(o,a))}),i(r)?this:r},t.fn.cropper.Constructor=d,t.fn.cropper.setDefaults=d.setDefaults,t.fn.cropper.noConflict=function(){return t.fn.cropper=d.other,this}})},"4":function(t,exports,e){"use strict";(function($){var i=e(6),n=function(){},r=function(t,e){t=t||"",e=e||{};var r={"fixed":!0,"modal":!0,"autofocus":!1,"content":'<p class="del-pop-p">'+t+"</p>","className":"pop-box","okCls":"pc-btn pc-btnh35 circle-pop-btn","ok":n};$.extend(!0,r,e);var a=i(r),o=a._$("header"),s=a._$("title");return e.title||s.css("borderBottom","none"),o.show(),a.show(),a};t.exports=r}).call(exports,e(0))},"82":function(t,exports,e){"use strict";(function($){function e(){i.on("keyup",function(){var t=$(this).val();t.length>15&&$(this).val(t.substr(0,15))}).on("keydown",function(){$(this).val().length>0?$(this).addClass("text-color"):$(this).removeClass("text-color")}).on("focus",function(){i.removeClass("red-border"),n.addClass("none")})}var i=$('[data-node="nameIpt"]'),n=$('[data-node="nameErr"]');t.exports.init=e}).call(exports,e(0))},"83":function(t,exports,e){"use strict";(function($){function i(t){function e(){r.getData()&&a.length&&(a.attr("src",r.getData()),o.text("重新上传"),$(".ui-dialog-close").trigger("click"))}var i={"fixed":!0,"modal":!0,"title":'<span class="title-main">上传美店LOGO</span><span class="type-txt">请上传JPG/PNG/JPEG格式的图片（选填）</span>',"autofocus":!1,"content":'<div class="circle-head" data-node="uploadBox">\n\t            <div class="error" data-node="error"><span>＊请上传小于4M的图片，支持格式jpg、jpeg、png！</span></div>\n\t            <div class="upload-head-bx">\n\t             \n\t              <div class="picture-bj-img ">\n\t                \x3c!-- 提示类 --\x3e\n\t                <div class="position-abso" data-node="noticeBox">\n\n\t                    <div class="picture-bx"></div>\n\t                    <div class="load-failed-bx">\n\t                      <span class="opacity-all"></span>\n\t                      <span class="top-left"></span>\n\t                      <span class="top-right"></span>\n\t                      <span class="bottom-left"></span>\n\t                      <span class="bottom-right"></span>\n\t                    </div>\n\t                    <div class="load-failed-txt failure"><span data-node="noticeInfo">图片上传失败！<span><em class="icon iconn-24"></em><a href="javascript:;" data-action="retry">重新上传</a></span></span></div>\n\t                    <div class="load-failed-txt image-load">\n\t                      <p data-node="loadNotice">图片加载中</p>\n\t                      <div class="progress-bar-bx"><span data-node="uploadProgress"></span></div>\n\t                      \x3c!--img.img250(src="../../images/public/circle-default-head.jpg")--\x3e\n\t                    </div>\n\t                </div>\n\t                \x3c!-- 默认 --\x3e\n\t                <div class="circle-default-head" data-node="cropWrap">\n\t                    <div data-defaultaddfile="picker" class="webuploader-container"><div class="webuploader-pick webuploader-pick-hover"><span>+</span>上传头像</div><div id="rt_rt_1btbkd9nd1csg1eur1edu1e1q11pl1" style="position: absolute; top: 0px; left: 0px; width: 250px; height: 250px; overflow: hidden; bottom: auto; right: auto;"><input type="file" name="file" class="webuploader-element-invisible" accept="image/jpg,image/jpeg,image/png,image/gif"><label style="opacity: 0; width: 100%; height: 100%; display: block; cursor: pointer; background: rgb(255, 255, 255);"></label></div></div>\n\t                    <img src="'+t.imgSrc+'" alt="" data-default="'+t.imgSrc+'" data-edit="btn">\n\t                </div>\t\n\t              </div>\n\t                <div class="pc-btn-box">\n\t                    <a class="pc-btn pc-bj-fc8753 btn-size" href="javascript:" data-action="upload-edit">点击上传</a>\n\t                   \n\t                </div>\n\t            </div>\n\t            <div class="head-preview-bx">\n\t              <p class="head-title">效果预览</p>\n\t              <p class="head-size">你上传的图片会自动生成3种尺寸，请注意小尺寸的头像是否清晰</p>\n\t              <div class="picture2-bx clearfix">\n\t                <div class="picture-bx2">\n\t                  <div class="default-img1" data-node="avatrSelector"><img src="https://js.meixincdn.com/m/pc/dist/images/public/default-img1.jpg"></div>\n\t                  <p class="p-size">160*160px</p>\n\t                </div>\n\t                <div class="picture-bx3">\n\t                  <div class="picture-bx4">\n\t                    <div class="default-img2" data-node="avatrSelector"><img src="https://js.meixincdn.com/m/pc/dist/images/public/default-img2.jpg"></div>\n\t                    <p class="p-size">60*60px</p>\n\t                  </div>\n\t                  <div class="picture-bx5">\n\t                    <div class="default-img3" data-node="avatrSelector"><img src="https://js.meixincdn.com/m/pc/dist/images/public/default-img3.jpg"></div>\n\t                    <p class="p-size">30*30px</p>\n\t                  </div>\n\t                </div>\n\t              </div>\n\t            </div>\n\t        </div>\n\t        <div class="sub-btn">\n            \t<a href="javascript:void(0);" data-action="avatarSave">提交审核</a>\n            </div>',"className":"pop-box"},s=n(i),u=s._$("header");s._$("title");u.show(),s.show();var h=r.init(e,{"errTip":"请上传小于2M的图片，支持格式jpg、jpeg、png！","accept":{"title":"Images","extensions":"jpg,jpeg,png","mimeTypes":"image/jpg,image/jpeg,image/png"},"fileSingleSizeLimit":2097152,"uptxtBtn":"重新上传"});return t.imgSrc&&!/(circle-default-head\.jpg)|(T1YvKTBsDv1RCvBVdK)|(T1o4KTBTWQ1RCvBVdK)/.test(t.imgSrc)?($("[data-node=uploadBox]").find("img").attr("src",t.imgSrc),$("[data-defaultAddFile=picker]").hide(),h.webUpLoader.addButton({"id":'[data-action="upload-edit"]',"innerHTML":"重新上传"})):($("[data-node=uploadBox]").find("img").attr("src",t.imgSrc),$("[data-defaultAddFile=picker]").hide(),h.webUpLoader.addButton({"id":'[data-action="upload-edit"]',"innerHTML":"点击上传"})),r.getData()}var n=e(6),r=e(35),a=$('[data-node="avatar"]'),o=$('[data-node="uploadAvatar"]');t.exports.init=i}).call(exports,e(0))},"84":function(t,exports,e){"use strict";(function($){function e(){i.on("keyup",function(){var t=$(this).val();t.length>100&&$(this).val(t.substr(0,100)),r.text((t.length>=100?100:t.length)+"/100")}).on("keydown",function(){$(this).val().length>0?$(this).addClass("text-color"):$(this).removeClass("text-color")}).on("focus",function(){i.removeClass("red-border"),n.addClass("none")})}var i=$('[data-node="desIpt"]'),n=$('[data-node="desErr"]'),r=$('[data-node="textNum"]');t.exports.init=e}).call(exports,e(0))}},[300]);
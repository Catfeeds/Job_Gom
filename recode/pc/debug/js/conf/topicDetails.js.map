{"version":3,"sources":["webpack:///./src/js/page/topicDetails/index.js","webpack:///./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js?5041***************","webpack:///./src/js/module/popup/alert.js?466a***************","webpack:///./src/js/module/hint.js?34fa**********","webpack:///./src/js/module/atgregion.js?5113","webpack:///./src/js/plugin/jquery.lazyload.js?7b8d*","webpack:///./src/js/module/popup/face/emoji.js?d6cd*****","webpack:///./src/js/module/popup/confirm.js","webpack:///./src/js/utils/encodeHtml.js?4c98**","webpack:///./src/js/module/popup/face/face.js?b70b**","webpack:///./src/js/module/popup/face/backward.js?6a63****","webpack:///./src/js/module/popup/face/face.tpl?dd34****","webpack:///./src/js/module/i18n.js","webpack:///./src/js/plugin/webuploader/webuploader.js?37bb****","webpack:///./src/js/module/popup/upload/dialog.js?5b30**","webpack:///./src/js/module/popup/upload/content.tpl?cddf**","webpack:///./src/js/module/share.js?fbb7***","webpack:///./src/js/utils/getQRCode.js?13de***","webpack:///./src/js/module/popup/upload/uploader.js?5c04*","webpack:///./src/js/module/upload.js?e6aa*","webpack:///./src/js/utils/imgReplace.js?de1e*","webpack:///./src/js/module/popup/uploadfileQR/index.js?bd83*","webpack:///./src/js/module/popup/uploadfileQR/upload.tpl?dece*","webpack:///./src/js/editor/config.js?f540*","webpack:///./src/js/module/addGoods.js?afd4*","webpack:///./src/js/module/popup/addGoods/dialog.js?fbcd*","webpack:///./src/js/module/popup/addGoods/content.tpl?33fc*","webpack:///./src/js/module/popup/addGoods/itemContent.tpl?2c0d*","webpack:///./src/js/module/popup/addGoods/defaultItemContent.tpl?2cc1*","webpack:///./src/js/module/joinCircle.js?325d","webpack:///./src/js/module/sensitiveContent.js?7deb","webpack:///./src/js/module/praise.js?0d4d*","webpack:///./src/js/page/topicDetails/comment/commentv2.js","webpack:///./src/js/utils/IdentifyIE8-.js","webpack:///./src/js/page/topicDetails/comment/getCommentList.js","webpack:///./src/js/page/topicDetails/comment/changeContent.js","webpack:///./src/js/utils/fromNow.js","webpack:///./src/js/page/topicDetails/comment/commentList.tpl","webpack:///./src/js/page/topicDetails/comment/addImageTpl.tpl","webpack:///./src/js/page/topicDetails/comment/a_submit.js","webpack:///./src/js/page/topicDetails/comment/loginState.js","webpack:///./src/js/page/topicDetails/comment/a_secondComBtn.js","webpack:///./src/js/page/topicDetails/comment/secondComList.tpl","webpack:///./src/js/page/topicDetails/comment/showMoreList.js","webpack:///./src/js/page/topicDetails/comment/Smiley.js","webpack:///./src/js/page/topicDetails/comment/otherFn.js","webpack:///./src/js/page/topicDetails/praise.js","webpack:///./src/js/page/topicDetails/share.js","webpack:///./src/js/module/shareBP.js","webpack:///./src/js/page/topicDetails/collect.js","webpack:///./src/js/page/topicDetails/topicAddMore/topicAddMore.js","webpack:///./src/js/page/topicDetails/topicAddMore/title.tpl","webpack:///./src/js/page/topicDetails/topicAddMore/comList.tpl","webpack:///./src/js/page/topicDetails/topicAddMore/commentBox.tpl","webpack:///./src/js/page/topicDetails/topicAddMore/topicRight.tpl","webpack:///./src/js/plugin/jquery.history.js","webpack:///./src/js/page/topicDetails/deletUserTopic.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/addIMG.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/rotateImg.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/chooseImg.tpl","webpack:///./src/js/page/topicDetails/comment/addImgGoods/addGoods.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/goodsIn.tpl"],"names":["$","attr","require","lazyload","effect","commentv2","circle","praise","share","collect","topicAddMore","deleUserTopic","addImg","addGoods","buriedPoint","setPageData","init","on","done","getLoginState","window","location","reload","Dialog","noop","create","content","options","defaults","fixed","modal","autofocus","className","okCls","ok","extend","d","header","_$","title","css","show","module","exports","$publicMask","$publicTips","timer","events","off","hide","msg","duration","callback","clearTimeout","length","text","append","offsetHeight","width","setTimeout","fetch","Pubsub","url","hostname","split","len","domain","getCookieArea","get","$_CONFIG","ss_service_gome","dataType","jsonpCallback","data","value","atgregion","success","cookie","expires","path","pub","imgPath","imgpath","ext","groupOne","name","groupTwo","groupThree","groupFour","groupFive","format","arr","i","emoji","concat","cancel","btnWrapCls","html","str","reg","replace","a","b","emojis","backward","faceTpl","faceReg","faceUrl","defaultIndex","emojiMap","makeData","total","offset","page","Math","ceil","list","end","j","push","Array","x","y","setShowIndex","left","top","index","eq","addClass","siblings","removeClass","insertFace","fn","isHide","e","preventDefault","stopPropagation","initHTML","faceHTML","initEvent","document","parseEmoji","r","isEmptyObject","s","$1","img","old","insert","inputTip","tel","ept","err","errBack","msgCode","tipGet","tipEpt","tipErr","tipErrEdit","tipWrong","checkCodeWrong","send","tipSend","tipDisabled","tipLimitEdit","btnAfterSend","btnDefault","pwd","commonTip","pwdV","nickName","eptName","existName","sucSub","errLine","wrongName","birthTip","tip","refCode","imgCode","login","errCode","errNum","errPwd","agreement","createCircle","typeEmpty","nameEmpty","upperLimit","unJoin","cannotJoin","review","joinSuccess","joinSuccessPublic","cannotJoinCircle","exit","dissolved","qrCodeTip","loseEffTip","loseEffBtn","failGetTip","failGetBtn","masterApply","nameLength","nameType","isIdCard","type","summary","upload","noUpload","uploadError","uploadFaild","uploadError_Master","Q_EXCEED_NUM_LIMIT","Q_EXCEED_SIZE_LIMIT","Q_TYPE_DENIED","F_EXCEED_SIZE","excess","tpl","okValue","cancalValue","getQRCode","checkLoginStatus","APIS","qq","wb","qz","defaultInfo","pic","open","hasShareBtnsHTML","initShareBtns","shareBtns","showShareToBtns","style","hasWeixinHTML","initWeixinHTML","weixinBox","formatParams","p","pics","site","encodeURIComponent","join","shareTo","weixin","link","src","shareWithKid","args","isRebate","validate","skuId","itemId","parentKid","async","kid","shareInfo","indexOf","substring","onlineUserId","shareto","fail","go","obj","info","desc","shareItem","parent","selector","beforeShare","$item","shareUrl","shareTitle","sharePic","pw","ph","height","px","py","shareType","call","group_domain","uploadPop","pubName","alert","imgReplace","maxLen","dialogUploader","$webUpLoader","maxlength","node","find","hasClass","destroy","$imgList","images","setPubliser","changeImage","callbacks","onFileQueued","file","numList","number","$uploadBox","picker","children","id","before","source","ruid","onUploadSuccess","response","code","WebUploader","hint","notice","files","defaultOptions","parents","delSelector","defaultApi","pick","innerHTML","accept","extensions","mimeTypes","method","swf","auto","disableGlobalDnd","duplicate","prepareNextFile","chunked","fileVal","server","fileNumLimit","fileSizeLimit","fileSingleSizeLimit","onBeforeFileQueued","onUploadError","onUploadProgress","percentage","onErrored","retry","_this","delImage","webuploader","removeFile","remove","undefined","reason","rules","https","imgRule","shotCut","imgType","grepStr1","grepStr2","orignalImgReplace","test","addShortCut","imgProto","changeSrc","container","$imgs","not","_src","_orignal","proto","codeTpl","$GLOBAL_CONFIG","qrTips","config","pageId","imgLimitNUm","Scans","o","qid","topicQrId","$parent","uploadMaxNum","maxNum","useNewCode","interval","$showBox","time","customInit","customCb","isLoad","imgArr","editor","$cover","$localBtn","$target","btn","prototype","constructor","body","tagName","target","start","getCode","checkShow","imgLength","getContent","datas","qidArr","qrcodeId","_data","getCodeCb","setInterval","monitor","message","post","groupkey","scanCb","m","clearInterval","sendNum","insertPic","_img","_proto","execCommand","loading","setDisabled","unLoading","setEnabled","is","fixPop","$btn","isload","dataArr","tempArr","diffLen","slice","whiteList","div","dl","dt","em","h1","h2","h3","h4","h5","h6","span","ul","ol","li","goodsLimitNUm","initialFrameWidth","initialFrameHeight","zIndex","autoClearinitialContent","UEDITOR_HOME_URL","serverUrl","themePath","csspath","whitList","toolbars","iframeCssUrl","pasteplain","allowDivTransToP","imageScaleEnabled","elementPathEnabled","wordCount","catchRemoteImageEnable","enableContextMenu","imagePopup","enableAutoSave","dialog","itemlist","defaultItemlist","indexof","pageNum","isDefault","keyWord","changedList","isGetMore","degree","addDialog","$searchTop","$searchInput","$searchBtn","$searchNormal","$searchLoading","$searchFail","$searchResult","$searchList","$changeNum","$listBox","$changeList","$title","$getMore","$searchListBox","selectedGoods","changedGoods","max","returnList","imgSrc","changeNum","changedItem","dialogClosed","onshow","getNode","defaultItem","searchItem","reGet","changeItem","getMoreItem","overflowY","getItems","pagesize","result","items","keycode","which","trim","val","moreItem","prev","txt","pagenum","word","pageCount","resultItem","collections","always","$this","pId","shopId","itemLink","empty","PId","price","del","splice","reset","closest","scrollTop","confirm","tips","loginPop","event","$els","$action","focus","groupId","memberType","bpData","event_id","group_id","circle_type","topic_id","BP","userid","newWeb","noRefreshFetch","flag","groupid","imid","status","cancelValue","cancelCls","error","exitCircle","onclose","href","sensitiveTitle","comment","channel","isLogin","popFlag","setData","$node","count","helper","normal","add","reduce","getCallback","mode","$container","onPraise","onUnPraise","onPraised","t","isPraise","objs","enableEditor","pid","face","identify","getCommentList","a_Submit","secondComBtn","showMoreList","loginState","Smiley","otherFn","$loadlist","$comment_Msg","clickTopicId","DIVOBJ","textareaTips","commentDomInit","commentCheck","secondCom_Key","hideComBox","a_secondComBtn","showEmoji","hideTextareaTips","showTextareaTips","textVal","insertAtCursor","curretTextAreaObj","lodingMore","goComment","sub","ua","navigator","userAgent","toLowerCase","version","isIE","safariVersion","match","changeContent","fromNow","commentList","addImageTpl","$is_Login","$mall_domain","$userIsExpert","$secondCom_Key","LoadListStr","LoadtingStr","currPage","pageSize","listSize","nodelist","$hidDiv","$thisObjId","$ComTopicId","$loading","currUserImg","paramList","then","topicReplys","topicMsg","subReplyQuantity","subTop","topicSubReplys","replySecArr","showNum","dlShowBorder","showMall","parseInt","UserId","checkUserId","user","showSecComm","subTopMsg","replayToPub","beReplyUserName","beReplyUserId","threeUserId","topicSubReplyUser","nickname","contentSed","SenUserId","replySecMsg","topicPic","imageStr","imgsrcPic","picsSrc","picture","pictures","itemsPic","itemShopName","itemPrice","itemShopId","itemShopNameItem","item","mainImage","salePrice","shopPic","redPackage","shop","icon","promotionMark","hasCouponPlan","showDateList","expertInfo","isExpert","facePicUrl","replyType","topicId","timeString","createTime","i_domain","date","Date","fullYear","getFullYear","month","getMonth","day","getDate","hh","getHours","mm","getMinutes","ss","getSeconds","addZero","num","newNum","encodeHtml","htmlNull","re","timeStr","showTime","getTime","maxDay","oneMin","oneHour","oneDay","floor","getd","sensitiveContent","popUnion","parentDiv","comment_Msg","topicid","lis","imgPics","imgObj","$addImgGoods","topicType","itemid","$goodIn","params","skuid","Msg","contentMsg","mall_domain","goodObj","basics","idNode","animate","$a_Submit","ISLOGIN","removeAttr","secondComList","beReplyId","tId","replyId","contentT","showCom","replyuserid","replycommentid","username","dataPublis","dataObj","hideId","commentid","objHtml","getRelyList","childrens","k","replyCommentList","replyaList","curretTextArea","selectText","textbox","startIndex","stopIndex","setSelectionRange","createTextRagen","range","createTextRange","collapse","moveStart","moveEnd","select","selectionStart","selectionEnd","selection","createRange","hideDiv","userSubmits","addmorepages","listsize","toPage","next","$body","s_c","channel_id","$topObj","offsetTop","$praiseClick","shareBP","gomeplusLogo","getShareInfo","$ul","opts","shareId","evtType","$conf","wap_circle_url","api","shareObj","ht","wx","share_time","user_id","userId","cookie_id","share_ssid","env","share_env","jianjie","console","log","share_id","getcookie","objname","cookieArr","temp","unescape","shareData","page_id","JSON","stringify","passport_domain","$collect","$CONF","iscollect","onLogin","refresh","titel","comList","commentBox","topicRight","clickTopicObj","lastScroll","downLoadTopic","OpenedTop","ListTopsValid","arrayIdBoolean","idVideo","videoObj","currentId","oldCurrentId","$no_next","jctjmodule","htxqmodule","htcyplmodule","htpllbmodule","htqzxxmodule","htrmhtmodule","htxyymodule","ggjzgdmodule","hotTopicUl","topicRT","$topicWrap","addDivHtml","newMsg1","newMsg","rightNextMsg","nextTopName","topicName","nextTopTime","lastReplyTime","elemTitle","elemCommentBox","elemComList","elemRight","topicHtml","$leftImg","last","getVideo","videoArr","newVideo","_video","video_id","base","v","MeixinPlayer","stopVideo","nextLoading","addVisitTopicId","openTopicId","getGoodsPrice","goodsId","ids","each","substr","changeGoodsPrice","curTopicId","getNextTopicId","$getNext","slideDown","userImage","pathImg","isLoginClass","isLoginStr","readyOnly","dataStr","allNum","replyQuantity","getModuleString","isEssence","isUpper","groupCircleName","group","extGroupUrl","group_url","extImagesLst","surl","share_text","extSpic","images_lst","extStitle","isLike","isLikeName","userQuantity","userCollection","userCollectionName","userCollectionStatu","dataParise","is_del","Number","topRightH","h","addMoreEvent","History","replaceState","id1","name1","scrollToTop","nextiD","topFixed","showTopicID","$showDiv","$showRight","$thisScroll","$showLeft","showDivHeight","showRightHeight","thisScrollHeight","windowHight","showLeftHeight","floatRight","TopShow","BottomShow","pp","autoTop","opx","leftS","ulFixt","containerId","$divConter","divTop","divHeight","ulHeight","toTopBtn","$Btn","btnScroll","winScrollTop","dropTop","modulestr","$textareaTips","Adapter","bind","noneHeight","$current","nextAll","prevAll","jQuery","Error","el","trigger","extra","extractEventData","key","originalEvent","onDomLoad","sessionStorage","history","setItem","removeItem","encode","parse","decode","initCore","initHtml4","initialized","hashChangeInterval","safariPollInterval","doubleCheckInterval","disableSuid","storeInterval","busyDelay","debug","initialTitle","html4Mode","delayInit","intervalList","clearAllIntervals","il","apply","arguments","consoleExists","textarea","getElementById","n","arg","shift","Exception","scrollHeight","clientHeight","getInternetExplorerMajorVersion","cached","createElement","all","getElementsByTagName","isInternetExplorer","Boolean","emulated","pushState","hashChange","enabled","bugs","setHash","vendor","safariPoll","ieDoubleCheck","hashEscape","hasOwnProperty","cloneObject","hash","newObj","getRootUrl","rootUrl","protocol","host","port","getBaseHref","baseElements","baseElement","baseHref","getBaseUrl","baseUrl","getBasePageUrl","getPageUrl","State","getState","stateUrl","getLocationHref","pageUrl","part","string","basePageUrl","getFullUrl","allowBaseHref","fullUrl","firstChar","getShortUrl","shortUrl","isTraditionalAnchor","doc","URL","decodeURIComponent","store","idToState","stateToId","urlToId","storedStates","savedStates","normalizeStore","friendly","getLastSavedState","createStateObject","cleanUrl","getIdByState","newState","extractId","getStateString","String","random","normalizeState","oldState","dataNotEmpty","normalized","hashedUrl","hasUrlDuplicate","getStateById","passedState","cleanedState","getStateId","getHashByState","url_or_hash","parts","tmp","exec","isTraditional","extractState","getIdByUrl","getLastStoredState","hasDuplicate","storeState","isLastSavedState","isLast","newId","oldId","saveState","getStateByIndex","getCurrentIndex","getHash","getHashByUrl","unescapeHash","normalizeHash","queue","busy","pushQueue","scope","escapeHash","setTitle","firstState","queues","timeout","fireNext","fireQueueItem","clearQueue","stateChanged","doubleChecker","doubleCheckComplete","doubleCheckClear","doubleCheck","tryAgain","safariStatePoll","urlState","back","forward","emptyFunction","onPopState","stateId","currentHash","currentState","expectedStateId","getItem","onUnload","currentStore","currentStoreString","DOMException","QUOTA_EXCEEDED_ERR","appCodeName","deletTopic","sendMsg","idd","rotateImg","addImgTpl","detectQr","codeArr","showImgBox","btnEvent","addMoreImgFn","imgPicsBig","imgBigHindFn","hideBigPicFn","imgBigPNFn","deletImgFn","showImgFn","picPopBoxEvent","codeBoxEvent","$div","imgLENG","arriMG","imgNum","toImG","curPage","tootalPage","click","divObj","parentObj","ulObj","divBig","thisBigPic","thisImage","aBtn","$imgSrc","setImage","arrImg","nextnum","imgsrt","pictureHTML","lengthImg","$insertDom","_newObj","imgs","addEvent","divEm","$img","oldImgSrc","roteNum","angle","goodsInTpl","showGoodsBox","setGoods","goodsData","strGood","prepend"],"mappings":"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A,KAAIC,MAAMH,IAAIR,MAAd;AACA,KAAIY,SAASJ,IAAIG,MAAM,CAAV,IAAe,GAAf,GAAqBH,IAAIG,MAAM,CAAV,CAAlC;AACA,KAAIE,gBAAgB,SAAhBA,aAAgB,GAAW;AAC3BP,WAAMQ,GAAN,CAAUC,SAASC,eAAT,GAA2B,yCAArC,EAAgF;AAC5EC,mBAAU,OADkE;AAE5EC,wBAAe;AAF6D,MAAhF,EAGGtD,IAHH,CAGQ,UAASuD,IAAT,EAAe;AACnB,aAAIC,QAAQD,KAAKE,SAAjB;AACA,aAAIF,KAAKG,OAAL,KAAiB,IAArB,EAA2B;AACvB5E,eAAE6E,MAAF,CAAS,WAAT,EAAsBH,KAAtB,EAA6B;AACzBI,0BAAS,CADgB;AAEzBC,uBAAM,GAFmB;AAGzBb,yBAAQA;AAHiB,cAA7B;AAKAL,oBAAO,WAAP,EAAoBmB,GAApB;AACH;AACJ,MAbD;AAcH,EAfD;AAgBAtC,QAAOC,OAAP,GAAiBwB,aAAjB,C;;;;;;;;;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA6B;AAC7B;;AAEA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA;AACA,yCAAwC,oCAAoC;;AAE5E;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA,cAAa;AACb;AACA,MAAK;;AAEL,EAAC,kB;;;;;;;;;;;;;ACzPD,KAAIc,UAAUZ,SAASa,OAAT,GAAmB,gBAAjC;;AAEA,KAAIC,MAAM,MAAV;;AAEA,KAAIC,WAAW,CAAC;AACZC,WAAM,IADM;AAEZvB,UAAK;AAFO,EAAD,EAGZ;AACCuB,WAAM,GADP;AAECvB,UAAK;AAFN,EAHY,EAMZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EANY,EASZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EATY,EAYZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAZY,EAeZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAfY,EAkBZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAlBY,EAqBZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EArBY,EAwBZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAxBY,EA2BZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA3BY,EA8BZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA9BY,EAiCZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAjCY,EAoCZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EApCY,EAuCZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAvCY,EA0CZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA1CY,EA6CZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA7CY,EAgDZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAhDY,EAmDZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAnDY,EAsDZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAtDY,EAyDZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAzDY,EA4DZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA5DY,EA+DZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA/DY,EAkEZ;AACCuB,WAAM,KADP;AAECvB,UAAK;AAFN,EAlEY,CAAf;;AAuEA,KAAIwB,WAAW,CAAC;AACZD,WAAM,GADM;AAEZvB,UAAK;AAFO,EAAD,EAGZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAHY,EAMZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EANY,EASZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EATY,EAYZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAZY,EAeZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAfY,EAkBZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAlBY,EAqBZ;AACCuB,WAAM,GADP;AAECvB,UAAK;AAFN,EArBY,EAwBZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAxBY,EA2BZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA3BY,EA8BZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA9BY,EAiCZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAjCY,EAoCZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EApCY,EAuCZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAvCY,EA0CZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA1CY,EA6CZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA7CY,EAgDZ;AACCuB,WAAM,GADP;AAECvB,UAAK;AAFN,EAhDY,EAmDZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAnDY,EAsDZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAtDY,EAyDZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAzDY,EA4DZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA5DY,EA+DZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA/DY,EAkEZ;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAlEY,CAAf;;AAuEA,KAAIyB,aAAa,CAAC;AACdF,WAAM,GADQ;AAEdvB,UAAK;AAFS,EAAD,EAGd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAHc,EAMd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EANc,EASd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EATc,EAYd;AACCuB,WAAM,GADP;AAECvB,UAAK;AAFN,EAZc,EAed;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAfc,EAkBd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAlBc,EAqBd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EArBc,EAwBd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAxBc,EA2Bd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA3Bc,EA8Bd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA9Bc,EAiCd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAjCc,EAoCd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EApCc,EAuCd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAvCc,EA0Cd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA1Cc,EA6Cd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA7Cc,EAgDd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAhDc,EAmDd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAnDc,EAsDd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAtDc,EAyDd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAzDc,EA4Dd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA5Dc,EA+Dd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA/Dc,EAkEd;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAlEc,CAAjB;;AAuEA,KAAI0B,YAAY,CAAC;AACbH,WAAM,IADO;AAEbvB,UAAK;AAFQ,EAAD,EAGb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAHa,EAMb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EANa,EASb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EATa,EAYb;AACCuB,WAAM,KADP;AAECvB,UAAK;AAFN,EAZa,EAeb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAfa,EAkBb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAlBa,EAqBb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EArBa,EAwBb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAxBa,EA2Bb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA3Ba,EA8Bb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA9Ba,EAiCb;AACCuB,WAAM,KADP;AAECvB,UAAK;AAFN,EAjCa,EAoCb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EApCa,EAuCb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAvCa,EA0Cb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA1Ca,EA6Cb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA7Ca,EAgDb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAhDa,EAmDb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAnDa,EAsDb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAtDa,EAyDb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAzDa,EA4Db;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA5Da,EA+Db;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EA/Da,EAkEb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAlEa,CAAhB;;AAuEA,KAAI2B,YAAY,CAAC;AACbJ,WAAM,GADO;AAEbvB,UAAK;AAFQ,EAAD,EAGb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAHa,EAMb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EANa,EASb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EATa,EAYb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAZa,EAeb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAfa,EAkBb;AACCuB,WAAM,KADP;AAECvB,UAAK;AAFN,EAlBa,EAqBb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EArBa,EAwBb;AACCuB,WAAM,IADP;AAECvB,UAAK;AAFN,EAxBa,CAAhB;;AA6BA,KAAI4B,SAAS,SAATA,MAAS,CAASC,GAAT,EAAc;AACvB,UAAK,IAAIC,IAAI,CAAR,EAAW3B,MAAM0B,IAAIrC,MAA1B,EAAkCsC,IAAI3B,GAAtC,EAA2C2B,GAA3C,EAAgD;AAC5C,aAAIC,QAAQF,IAAIC,CAAJ,CAAZ;AACAC,eAAM/B,GAAN,GAAYmB,UAAUY,MAAM/B,GAAhB,GAAsBqB,GAAlC;AACH;AACD,YAAOQ,GAAP;AACH,EAND;;AAQAjD,QAAOC,OAAP,GAAiB+C,OAAON,SAASU,MAAT,CAAgBR,QAAhB,EAA0BC,UAA1B,EAAsCC,SAAtC,EAAiDC,SAAjD,CAAP,CAAjB,C;;;;;;;;;;;;;;;;;;ACrUA,KAAIlE,SAAS,mBAAArB,CAAQ,EAAR,CAAb;AACA,KAAIsB,OAAO,SAAPA,IAAO,GAAW,CAAE,CAAxB;;AAEA,KAAIC,SAAS,SAATA,MAAS,CAASC,OAAT,EAAkBC,OAAlB,EAA2B;AACpC,SAAIC,WAAW;AACXC,gBAAO,IADI;AAEXC,gBAAO,IAFI;AAGXJ,kBAAS,0BAA0BA,OAA1B,GAAoC,MAHlC;AAIXM,oBAAW,SAJA;AAKXC,gBAAO,iCALI;AAMXC,aAAIV,IANO;AAOXuE,iBAAQvE,IAPG;AAQXwE,qBAAY;AARD,MAAf;AAUAhG,OAAEmC,MAAF,CAAS,IAAT,EAAeP,QAAf,EAAyBD,OAAzB;;AAEA,SAAIS,IAAIb,OAAOK,QAAP,CAAR;;AAEA;AACA;AACA;AACA;;AAEAQ,OAAEK,IAAF;AACA,YAAOL,CAAP;AACH,EAtBD;;AAwBAM,QAAOC,OAAP,GAAiBlB,MAAjB,C;;;;;;;;;;;;;;;;;AC3BA,KAAIwE,OAAO,SAAPA,IAAO,CAASC,GAAT,EAAcC,GAAd,EAAmB;AAC1B,YAAOD,MAAMA,IAAIE,OAAJ,CAAYD,OAAO,0DAAnB,EAA+E,UAASE,CAAT,EAAYC,CAAZ,EAAe;AACvG,aAAIA,CAAJ,EAAO;AACH,oBAAOD,CAAP;AACH,UAFD,MAEO;AACH,oBAAO;AACH,sBAAK,MADF;AAEH,sBAAK,OAFF;AAGH,sBAAK,QAHF;AAIH,sBAAK,SAJF;AAKH,sBAAK,SALF;AAMH,sBAAK,MANF;AAOH,sBAAK;AAPF,eAQLA,CARK,CAAP;AASH;AAEJ,MAfY,CAAN,GAeF,EAfL;AAgBH,EAjBD;;AAmBA3D,QAAOC,OAAP,GAAiBsD,IAAjB,C;;;;;;;;ACnBA,KAAIM,SAAS,mBAAArG,CAAQ,EAAR,CAAb;AACA,KAAIsG,WAAW,mBAAAtG,CAAQ,EAAR,CAAf;AACA,KAAIuG,UAAU,mBAAAvG,CAAQ,EAAR,CAAd;;AAEA,KAAIwG,OAAJ;AAAA,KACIC,OADJ;AAAA,KAEIC,eAAe,CAFnB;;AAIA;AACA,KAAIC,WAAW,EAAf;;AAEA;AACA,KAAIC,WAAW,SAAXA,QAAW,CAASrC,IAAT,EAAe;AAC1B,SAAIsC,QAAQtC,KAAKnB,MAAjB;AACA,SAAI0D,SAAS,EAAb;AACA,SAAIC,OAAOC,KAAKC,IAAL,CAAUJ,QAAQC,MAAlB,CAAX;AACA,SAAII,OAAO,EAAX;;AAEA,UAAK,IAAIxB,IAAI,CAAb,EAAgBA,IAAIqB,IAApB,EAA0BrB,GAA1B,EAA+B;AAC3BwB,cAAKxB,CAAL,IAAU,EAAV;AACA,aAAIyB,MAAML,UAAUpB,IAAI,CAAd,CAAV;AACAyB,eAAMA,MAAMN,KAAN,GAAcA,KAAd,GAAsBM,GAA5B;AACA,cAAK,IAAIC,IAAI1B,IAAIoB,MAAjB,EAAyBM,IAAID,GAA7B,EAAkCC,GAAlC,EAAuC;AACnC,iBAAIzB,QAAQpB,KAAK6C,CAAL,CAAZ;AACAF,kBAAKxB,CAAL,EAAQ2B,IAAR,CAAa1B,KAAb;AACAgB,sBAAShB,MAAMR,IAAf,IAAuBQ,MAAM/B,GAA7B;AACH;AACJ;AACD,YAAO;AACHmD,eAAM,IAAIO,KAAJ,CAAUP,IAAV,CADH;AAEHG,eAAMA;AAFH,MAAP;AAIH,EApBD;AAqBA;AACA,KAAI3E,OAAO,SAAPA,IAAO,CAASgF,CAAT,EAAYC,CAAZ,EAAe;AACtBC,kBAAa,CAAb;AACA3H,OAAE,qBAAF,EAAyBwC,GAAzB,CAA6B;AACzBoF,eAAMH,IAAI,IADe;AAEzBI,cAAKH,IAAI;AAFgB,MAA7B,EAGGjF,IAHH;AAIH,EAND;AAOA;AACA,KAAIQ,OAAO,SAAPA,IAAO,GAAW;AAClBjD,OAAE,qBAAF,EAAyBiD,IAAzB;AACH,EAFD;AAGA;AACA,KAAI0E,eAAe,SAAfA,YAAe,CAASG,KAAT,EAAgB;AAC/BA,aAAQA,SAASlB,YAAjB;;AAEA5G,OAAE,6BAAF,EAAiC+H,EAAjC,CAAoCD,KAApC,EAA2CE,QAA3C,CAAoD,QAApD,EAA8DC,QAA9D,CAAuE,IAAvE,EAA6EC,WAA7E,CAAyF,QAAzF;AACAlI,OAAE,4BAAF,EAAgC+H,EAAhC,CAAmCD,KAAnC,EAA0CI,WAA1C,CAAsD,MAAtD,EAA8DD,QAA9D,CAAuE,KAAvE,EAA8ED,QAA9E,CAAuF,MAAvF;AACH,EALD;;AAOA;;;;;;AAMA,KAAIG,aAAa,SAAbA,UAAa,CAASC,EAAT,EAAaC,MAAb,EAAqB;AAClCrI,OAAE,MAAF,EAAUiB,EAAV,CAAa,OAAb,EAAsB,aAAtB,EAAqC,UAASqH,CAAT,EAAY;AAC7CA,WAAEC,cAAF;AACAD,WAAEE,eAAF;AACA9B,mBAAU1G,EAAE,IAAF,EAAQyE,IAAR,CAAa,MAAb,CAAV;AACAkC,mBAAU3G,EAAE,IAAF,EAAQC,IAAR,CAAa,KAAb,CAAV;AACAmI,YAAG;AACCjC,kBAAKO,OADN;AAEC5C,kBAAK6C;AAFN,UAAH;AAIA0B,oBAAW,KAAX,IAAoBrI,EAAE,qBAAF,EAAyBiD,IAAzB,EAApB;AACH,MAVD;AAWH,EAZD;AAaA;AACA,KAAIwF,WAAW,SAAXA,QAAW,CAASL,EAAT,EAAa;AACxB,SAAI3D,OAAOqC,SAASP,MAAT,CAAX;AACA,SAAImC,WAAWjC,QAAQhC,IAAR,CAAf;AACAzE,OAAE,MAAF,EAAUwD,MAAV,CAAiBkF,QAAjB;AACAN;AACH,EALD;AAMA;AACA,KAAIO,YAAY,SAAZA,SAAY,GAAW;AACvB3I,OAAE,MAAF,EAAUiB,EAAV,CAAa,OAAb,EAAsB,qBAAtB,EAA6C,UAASqH,CAAT,EAAY;AACrDA,WAAEE,eAAF;AACH,MAFD;AAGAxI,OAAE4I,QAAF,EAAY3H,EAAZ,CAAe,OAAf,EAAwB,YAAW;AAC/BjB,WAAE,qBAAF,EAAyBiD,IAAzB;AACH,MAFD;AAGA;AACAjD,OAAE,qBAAF,EAAyBiB,EAAzB,CAA4B,YAA5B,EAA0C,6BAA1C,EAAyE,YAAW;AAChF,aAAI6G,QAAQ9H,EAAE,IAAF,EAAQ8H,KAAR,EAAZ;AACAH,sBAAaG,KAAb;AACH,MAHD;AAIH,EAZD;;AAcA;AACA,KAAIe,aAAa,SAAbA,UAAa,CAAS3C,GAAT,EAAc;AAC3B,SAAI4C,IAAI,mBAAR;AACA,SAAI9I,EAAE+I,aAAF,CAAgBlC,QAAhB,CAAJ,EAA+B;AAC3BC,kBAASP,MAAT;AACH;;AAED,YAAOL,IAAIE,OAAJ,CAAY0C,CAAZ,EAAe,UAASE,CAAT,EAAYC,EAAZ,EAAgB5D,IAAhB,EAAsB;AACxC,aAAI6D,MAAMrC,SAASxB,IAAT,CAAV;AACA,aAAI6D,GAAJ,EAAS;AACL,oBAAO,sCAAsCA,GAAtC,GAA4C,MAAnD;AACH,UAFD,MAEO;AACH;AACA,iBAAIC,MAAM3C,SAASnB,IAAT,CAAV;AACA,iBAAI8D,GAAJ,EAAS;AACL,wBAAO,sCAAsCA,IAAIrF,GAA1C,GAAgD,MAAvD;AACH;AACD,oBAAOkF,CAAP;AACH;AACJ,MAZM,CAAP;AAaH,EAnBD;;AAqBA,KAAIhI,OAAO,SAAPA,IAAO,GAAW;AAClByH,cAASE,SAAT;AACH,EAFD;;AAIAjG,QAAOC,OAAP,GAAiB;AACb3B,WAAMA,IADO;AAEboI,aAAQjB,UAFK;AAGb1F,WAAMA,IAHO;AAIbQ,WAAMA,IAJO;AAKb4F,iBAAYA;AALC,EAAjB,C;;;;;;;;;ACxHA,KAAI9D,OAAOV,SAASa,OAAT,GAAmB,gBAA9B;AACA,KAAIC,MAAM,MAAV;;AAEA,KAAIqB,WAAW;AACX,UAAK;AACDnB,eAAM,IADL;AAEDvB,cAAKiB,OAAO,QAAP,GAAkBI;AAFtB,MADM;AAKX,WAAM;AACFE,eAAM,IADJ;AAEFvB,cAAKiB,OAAO,SAAP,GAAmBI;AAFtB,MALK;AASX,WAAM;AACFE,eAAM,IADJ;AAEFvB,cAAKiB,OAAO,QAAP,GAAkBI;AAFrB,MATK;AAaX,WAAM;AACFE,eAAM,IADJ;AAEFvB,cAAKiB,OAAO,OAAP,GAAiBI;AAFpB,MAbK;AAiBX,WAAM;AACFE,eAAM,IADJ;AAEFvB,cAAKiB,OAAO,QAAP,GAAkBI;AAFrB,MAjBK;AAqBX,WAAM;AACFE,eAAM,IADJ;AAEFvB,cAAKiB,OAAO,QAAP,GAAkBI;AAFrB,MArBK;AAyBX,WAAM;AACFE,eAAM,KADJ;AAEFvB,cAAKiB,OAAO,UAAP,GAAoBI;AAFvB,MAzBK;AA6BX,WAAM;AACFE,eAAM,IADJ;AAEFvB,cAAKiB,OAAO,SAAP,GAAmBI;AAFtB;AA7BK,EAAf;;AAmCAzC,QAAOC,OAAP,GAAiB6D,QAAjB,C;;;;;;;ACtCA;AACA;AACA;AACA,cAAa,mLAAmL,2EAA2E,cAAc;AACzR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,EAAC,E;;;;;;;;;;;;;;ACnCD;;;AAGA,KAAI6C,WAAW;AACXC,UAAK;AACDC,cAAK,WADJ;AAEDC,cAAK,SAFJ;AAGDC,kBAAS;AAHR,MADM;AAMXC,cAAS;AACLC,iBAAQ,UADH;AAELC,iBAAQ,UAFH;AAGLC,iBAAQ,gBAHH;AAILC,qBAAY,OAJP;AAKLC,mBAAU,aALL;AAMLC,yBAAgB,eANX;AAOLC,eAAM,cAPD;AAQLC,kBAAS,sBARJ;AASLC,sBAAa,eATR;AAULC,uBAAc,eAVT;AAWLC,uBAAc,QAXT;AAYLC,qBAAY;AAZP,MANE;AAoBXC,UAAK;AACDC,oBAAW;AADV,MApBM;AAuBXC,WAAM;AACFlB,cAAK,SADH;AAEFC,cAAK;AAFH,MAvBK;AA2BXkB,eAAU;AACNC,kBAAS,QADH;AAENH,oBAAW,yBAFL;AAGNI,oBAAW,kBAHL;AAINC,iBAAQ,SAJF;AAKNC,kBAAS,OALH;AAMNC,oBAAW;AANL,MA3BC;AAmCXC,eAAU;AACNC,cAAK;AADC,MAnCC;AAsCXC,cAAS;AACL1B,cAAK;AADA,MAtCE;AAyCX2B,cAAS;AACL5B,cAAK,QADA;AAELC,cAAK;AAFA,MAzCE;AA6CX4B,YAAO;AACHC,kBAAS,QADN;AAEHC,iBAAQ,OAFL;AAGHC,iBAAQ,OAHL;AAIHC,oBAAW;AAJR,MA7CI;AAmDXC,mBAAc;AACVC,oBAAW,SADD;AAEVC,oBAAW,UAFD;AAGVC,qBAAY;AAHF,MAnDH;AAwDXtL,aAAQ;AACP8K,gBAAO,OADA;AAEJS,iBAAQ,gBAFJ;AAGJC,qBAAY,gBAHR;AAIJC,iBAAQ,gBAJJ;AAKJC,sBAAa,YALT;AAMJC,4BAAmB,oBANf;AAOJC,2BAAkB,iBAPd;AAQJC,eAAM,WARF;AASJC,oBAAW;AATP,MAxDG;AAmEXC,gBAAW;AACPC,qBAAY,QADL;AAEPC,qBAAY,MAFL;AAGPC,qBAAY,SAHL;AAIPC,qBAAY;AAJL,MAnEA;AAyEXC,kBAAa;AACTC,qBAAY,YADH;AAETC,mBAAU,WAFD;AAGTC,mBAAU,cAHD;AAITC,eAAM,SAJG;AAKTC,kBAAS;AALA,MAzEF;AAgFXC,aAAQ;AACJC,mBAAU,OADN;AAEJC,sBAAa,kCAFT;AAGJC,sBAAa,YAHT;AAIJC,6BAAoB,kCAJhB;AAKJC,6BAAoB,kCALhB;AAMJC,8BAAqB,WANjB;AAOJC,wBAAe,QAPX;AAQJC,wBAAe,uBARX;AASJC,iBAAQ;AATJ,MAhFG;AA2FX3C,cAAS;AACLG,cAAK;AADA;AA3FE,EAAf;AA+FAvI,QAAOC,OAAP,GAAiB0G,QAAjB,C;;;;;;;iGClGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;;AAEpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA,+CAA8C,SAAS;AACvD;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;AACA,UAAS;;AAET;;AAEA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;AAGD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iCAAgC;AAChC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;;AAEA;AACA,2BAA0B,aAAa;AACvC;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA,6BAA4B;;AAE5B,wDAAuD;AACvD,sDAAqD;AACrD;;AAEA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,MAAM;AAC9B,yBAAwB,kBAAkB;AAC1C,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,MAAM;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA,6CAA4C;AAC5C;AACA;AACA,iCAAgC;AAChC,iCAAgC;AAChC;AACA;AACA,4DAA2D;AAC3D;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA,iEAAgE;;AAEhE;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA,qBAAoB;AACpB;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAuD;AACvD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,4BAA2B,OAAO;AAClC;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B,wBAAuB,MAAM;AAC7B;AACA,sDAAqD;AACrD,uDAAsD;AACtD,0DAAyD;AACzD,8DAA6D;AAC7D,qEAAoE;AACpE,2FAA0F;AAC1F;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAmD;AACnD,iBAAgB;AAChB;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,oCAAmC;;AAEnC;AACA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,EAAE;AAC1B,yBAAwB,QAAQ;AAChC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,OAAO;AAC/B;AACA;AACA;AACA;;AAEA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA,8CAA6C;AAC7C;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA,kBAAiB,OAAO;AACxB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B;;AAE1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;;;AAGA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,8CAA6C;;AAE7C;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAuB;AACvB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA,2BAA0B,eAAe;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,wBAAuB,SAAS;AAChC;AACA;;AAEA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kCAAiC;;AAEjC;AACA,8BAA6B;AAC7B,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ,4CAA2C;AAC3C;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA,wBAAuB,sDAAsD;AAC7E;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8CAA6C,KAAK;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,uBAAsB,SAAS;AAC/B;AACA;AACA;;AAEA;AACA,uBAAsB,SAAS;AAC/B;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,kBAAiB;;AAEjB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,8CAA6C;AAC7C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAsB,SAAS;AAC/B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAAyC;AACzC;AACA;AACA,sBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;;AAET;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,8CAA6C;;AAE7C;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,2BAA0B,kBAAkB;AAC5C;AACA;AACA;AACA;AACA,wBAAuB,YAAY;AACnC,2BAA0B,OAAO;AACjC,+BAA8B,OAAO;AACrC,8BAA6B,QAAQ;AACrC;AACA;;AAEA;AACA,2BAA0B,MAAM;AAChC;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC,gCAA+B,OAAO;AACtC,+BAA8B,OAAO;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;;AAEA,0CAAyC;AACzC;AACA;AACA;AACA;AACA,sBAAqB;;AAErB;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;;AAEA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC;;AAEA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,UAAS;;AAET;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA,qBAAoB;AACpB;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAqB;AACrB;;;AAGA;;AAEA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAkC;AAClC;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;;AAGA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;AACb;;AAEA;;AAEA;AACA;AACA;AACA;AACA,wBAAuB,mBAAmB;AAC1C,wBAAuB,OAAO;AAC9B;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAa;;AAEb;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;;AAEA;;AAEA,6BAA4B,SAAS;AACrC;;AAEA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,SAAS;AAChC;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,UAAS;;AAET;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA0D,SAAS;AACnE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;;AAGb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;;AAGb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD;AAClD;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wBAAuB,SAAS;AAChC;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;;AAET,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,sDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,mDAAkD,+BAA+B;AACjF;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAwB;AACxB,wBAAuB;AACvB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA,UAAS;;AAET;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;;AAGA;AACA,2BAA0B,OAAO,aAAa;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,sBAAqB;;AAErB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB;;AAEzB;AACA,sBAAqB;AACrB;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;;AAGb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAqB;;AAErB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,sBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;;AAGb;AACA;AACA,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B,wBAAuB,OAAO;AAC9B;AACA;AACA;;;AAGA;AACA;AACA,wBAAuB,KAAK;AAC5B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC;AACtC,0CAAyC;AACzC;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,sBAAqB;;AAErB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;;AAEA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB;AACzB;AACA;AACA,0BAAyB;AACzB,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA,UAAS;AACT,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4BAA2B;AAC3B;;AAEA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA,uBAAsB,IAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;AACb,UAAS;;;AAGT;AACA,uBAAsB,IAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA,uBAAsB,IAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,cAAa;;AAEb,UAAS;;AAET;AACA,uBAAsB,QAAQ;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,SAAS;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,0BAAyB;AACzB;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;;AAEjB;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,iDAAgD,SAAS;AACzD;AACA;;AAEA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA,qCAAoC,SAAS;AAC7C;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA0D,SAAS;AACnE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;;AAEA,iDAAgD,SAAS;AACzD;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA0D,SAAS;AACnE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;;AAEA,cAAa;;;AAGb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA,6BAA4B,oBAAoB;AAChD;AACA;;AAEA,+DAA8D;;AAE9D;AACA,cAAa;;AAEb;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA,6BAA4B,oBAAoB;AAChD;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,qDAAoD,aAAa,KAAK;AACtE,cAAa;;AAEb;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,oCAAmC;AACnC,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,6CAA4C,oBAAoB;AAChE;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,yBAAwB,YAAY;AACpC;AACA;AACA;;AAEA;AACA;;AAEA;AACA,6BAA4B,mBAAmB;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,yBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,YAAY;AACtC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAsD;AACtD,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAmC,QAAQ;AAC3C;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,QAAQ;AAC3C;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,SAAS;AAC9C;AACA,0CAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAmC,SAAS;AAC5C,wCAAuC,iBAAiB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sCAAqC,WAAW;AAChD;AACA,+CAA8C,YAAY;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,sDAAqD,iBAAiB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAkC,SAAS;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8CAA6C;AAC7C;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iDAAgD;AAChD;AACA;AACA;;AAEA,uDAAsD;AACtD;;AAEA,gEAA+D;AAC/D,sDAAqD;AACrD;;AAEA;AACA,6CAA4C;AAC5C;AACA;;AAEA;AACA,gEAA+D;AAC/D,2DAA0D;AAC1D,2DAA0D;AAC1D,sDAAqD;;AAErD,6CAA4C;AAC5C;;AAEA,oDAAmD;AACnD;AACA;AACA;;AAEA,sCAAqC;AACrC;;AAEA;AACA;AACA,8BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uDAAsD;AACtD;AACA;AACA;;AAEA,2DAA0D;AAC1D;;AAEA,sEAAqE;AACrE,2DAA0D;AAC1D;;AAEA;AACA,mDAAkD;AAClD;AACA;;AAEA;AACA,sEAAqE;AACrE,iEAAgE;AAChE,iEAAgE;AAChE,0DAAyD;;AAEzD,mDAAkD;AAClD;;AAEA,yDAAwD;AACxD;AACA;AACA;;AAEA,mCAAkC;AAClC;;AAEA;AACA;AACA,8BAA6B,OAAO;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC,mCAAkC;AAClC,qCAAoC;AACpC,qCAAoC;AACpC,qCAAoC;AACpC,qCAAoC;AACpC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC;;AAEA;AACA;AACA,uCAAsC;AACtC,mCAAkC;AAClC,kCAAiC;AACjC;AACA;AACA,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC;;AAEA;AACA;AACA,uCAAsC;AACtC,oCAAmC;AACnC;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC,uCAAsC;;AAEtC,kCAAiC;AACjC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,OAAO;AACxC;AACA;;AAEA,qCAAoC;AACpC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,QAAQ;AACzC;AACA;;AAEA,kCAAiC;AACjC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,OAAO;AACxC;AACA;;AAEA,qCAAoC;AACpC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,QAAQ;AACzC;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC,mCAAkC;AAClC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA,2CAA0C;AAC1C;AACA;AACA,4CAA2C;AAC3C,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC,2BAA0B,+BAA+B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,4BAA4B;AAC1D;AACA;AACA;AACA,iDAAgD,iBAAiB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAgC,SAAS,MAAM;AAC/C;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,uCAAsC;AACtC;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAkC,UAAU;AAC5C,4CAA2C;AAC3C,mDAAkD;AAClD;;AAEA,iDAAgD;AAChD;AACA;;AAEA,oDAAmD;AACnD;AACA;;AAEA;AACA;AACA;;;AAGA;AACA,qFAAoF;AACpF;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uCAAsC;;AAEtC,wDAAuD;;AAEvD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAoC;;AAEpC;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;;AAEA;AACA,mCAAkC;AAClC;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,mCAAkC;AAClC;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;;AAElB,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,mBAAkB;;AAElB,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA,wBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA,4BAA2B,QAAQ;AACnC;AACA;AACA;;AAEA;AACA;AACA,mDAAkD,IAAI;AACtD;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAwB,QAAQ;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,YAAY;AACnC;AACA;;AAEA;AACA;AACA;AACA,4BAA2B,QAAQ;AACnC;AACA;AACA;;AAEA;AACA;AACA,mDAAkD,IAAI;AACtD;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,UAAS;;AAET;;AAEA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,wBAAuB,cAAc;AACrC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;;;AAIT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yBAAwB,aAAa;AACrC;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,YAAY;AACnC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA2B,QAAQ;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA,mDAAkD,IAAI;AACtD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B;AACA,qBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,yBAAwB,aAAa;AACrC;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,YAAY;AACnC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC,qBAAoB,YAAY;AAChC;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;;AAEA;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB;AACzB,6BAA4B;AAC5B;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC;;AAEA;AACA;AACA,8BAA6B,SAAS;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB;AACpB,iBAAgB;;AAEhB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB;AACA;AACA,sBAAqB;;AAErB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA4B;;AAE5B;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kCAAiC;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAq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ACA;AACH,MAJM,MAIA;AACH,aAAI2kB,OAAOR,QAAQnpB,KAAR,CAAc,GAAd,CAAX;AACAopB,oBAAWO,KAAK,CAAL,CAAX;AACH;AACD,YAAOP,QAAP;AACH,EA1CD;AA2CA1qB,QAAOC,OAAP,GAAiB2kB,OAAjB,C;;;;;;AC5CA;AACA;AACA;AACA,cAAa,45BAA45B;AACz6B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sWAAqW;AACrW;AACA;AACA;AACA,EAAC,E;;;;;;AC/ID;AACA;AACA;AACA,cAAa,uLAAuL;AACpM;AACA;AACA;AACA,kDAAiD;AACjD;AACA;AACA,EAAC;AACD,iHAAgH,8EAA8E;AAC9L;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA,8BAA6B;AAC7B;AACA;AACA,EAAC;AACD;AACA;AACA,EAAC,E;;;;;;;;AC7BD;;;AAGA,KAAIG,Y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Cx0B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA0D;AAC1D;AACA;AACA;AACA,mFAAkF;AAClF;AACA;AACA;AACA,EAAC,E;;;;;;ACzFD;AACA;AACA;AACA,cAAa,0KAA0K;AACvL;AACA;AACA;AACA;AACA;AACA,uFAAsF;AACtF;AACA;AACA;AACA,0KAAyK,yBAAyB;AAClM;AACA,iIAAgI,yBAAyB;AACzJ;AACA,EAAC,E;;;;;;ACjBD;AACA;AACA;AACA,cAAa,gRAAgR;AAC7R;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAmE;AACnE;AACA,gUAA+T;AAC/T;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,E;;;;;;AC3BD;AACA;AACA;AACA,cAAa,2PAA2P;AACxQ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,E;;;;;;;;;;ACrBD;;;;;;;AAOA;AACA,EAAC,UAAS75B,MAAT,EAAgB0U,SAAhB,EAA0B;AAC1B;;AAEA;;AACA,MACC6kB,UAAUv5B,OAAOu5B,OAAP,GAAiBv5B,OAAOu5B,OAAP,IAAgB,EAD5C;AAAA,MAEC2C,SAAS,oCAFV;;AAIA;AACA,MAAK,OAAO3C,QAAQqC,OAAf,KAA2B,WAAhC,EAA8C;AAC7C,SAAM,IAAIO,KAAJ,CAAU,+CAAV,CAAN;AACA;;AAED;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","file":"topicDetails.js","sourcesContent":["$(\"body\").attr(\"data-module\", \"1\");\nrequire('lazyload');\n$(\"img\").lazyload({\n    effect: \"fadeIn\"\n});\nvar commentv2 = require('./comment/commentv2');\nvar circle = require('module/joinCircle');\n//var follow = require('./follow');\nvar praise = require('./praise');\nvar share = require('./share');\nvar collect = require('./collect');\n\nvar topicAddMore = require('./topicAddMore/topicAddMore');\n// 发送统计数据用\nvar deleUserTopic = require('./deletUserTopic');\nvar addImg = require('./comment/addImgGoods/addIMG');\nvar addGoods = require('./comment/addImgGoods/addGoods');\nvar buriedPoint = require('utils/buriedPoint');\nburiedPoint.setPageData('topicDetail');\n\ncommentv2.init(); // 评论\nshare.init(); // 分享\ncollect.init(); // 收藏\npraise.init(); // 赞\n//follow.init($('[data-node=\"follow\"]')); // 加关注\ntopicAddMore.init(); //加载更多话题\n\ndeleUserTopic.init();\n\naddGoods.init(); //商品选择\naddImg.init(); //添加图片事件\n\n// 加入圈子\n$('body').on('click', '[data-node=\"circle\"]', {\n    done: function() {\n        commentv2.getLoginState();\n        window.location.reload();\n    }\n}, circle);\n$(\"img\").lazyload({\n    effect: \"fadeIn\"\n});\n\n/*$(\".source-rig-box img\").not('.publish-item img').attr('src', '').on('error', function() {\n    imgError(this, 'l');\n})\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/index.js","/*TMODJS:{}*/\r\n!function () {\r\n\tfunction a(a, b) {\r\n\t\treturn (/string|function/.test(typeof b) ? h : g)(a, b)\r\n\t}\r\n\r\n\tfunction b(a, c) {\r\n\t\treturn \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a\r\n\t}\r\n\r\n\tfunction c(a) {\r\n\t\treturn l[a]\r\n\t}\r\n\r\n\tfunction d(a) {\r\n\t\treturn b(a).replace(/&(?![\\w#]+;)|[<>\"']/g, c)\r\n\t}\r\n\r\n\tfunction e(a, b) {\r\n\t\tif (m(a))for (var c = 0, d = a.length; d > c; c++)b.call(a, a[c], c, a); else for (c in a)b.call(a, a[c], c)\r\n\t}\r\n\r\n\tfunction f(a, b) {\r\n\t\tvar c = /(\\/)[^\\/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^\\/]+$/, \"\"), e = d + b;\r\n\t\tfor (e = e.replace(/\\/\\.\\//g, \"/\"); e.match(c);)e = e.replace(c, \"/\");\r\n\t\treturn e\r\n\t}\r\n\r\n\tfunction g(b, c) {\r\n\t\tvar d = a.get(b) || i({filename: b, name: \"Render Error\", message: \"Template not found\"});\r\n\t\treturn c ? d(c) : d\r\n\t}\r\n\r\n\tfunction h(a, b) {\r\n\t\tif (\"string\" == typeof b) {\r\n\t\t\tvar c = b;\r\n\t\t\tb = function () {\r\n\t\t\t\treturn new k(c)\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar d = j[a] = function (c) {\r\n\t\t\ttry {\r\n\t\t\t\treturn new b(c, a) + \"\"\r\n\t\t\t} catch (d) {\r\n\t\t\t\treturn i(d)()\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn d.prototype = b.prototype = n, d.toString = function () {\r\n\t\t\treturn b + \"\"\r\n\t\t}, d\r\n\t}\r\n\r\n\tfunction i(a) {\r\n\t\tvar b = \"{Template Error}\", c = a.stack || \"\";\r\n\t\tif (c)c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); else for (var d in a)c += \"<\" + d + \">\\n\" + a[d] + \"\\n\\n\";\r\n\t\treturn function () {\r\n\t\t\treturn \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b\r\n\t\t}\r\n\t}\r\n\r\n\tvar j = a.cache = {}, k = this.String, l = {\r\n\t\t\"<\": \"&#60;\",\r\n\t\t\">\": \"&#62;\",\r\n\t\t'\"': \"&#34;\",\r\n\t\t\"'\": \"&#39;\",\r\n\t\t\"&\": \"&#38;\"\r\n\t}, m = Array.isArray || function (a) {\r\n\t\t\treturn \"[object Array]\" === {}.toString.call(a)\r\n\t\t}, n = a.utils = {\r\n\t\t$helpers: {}, $include: function (a, b, c) {\r\n\t\t\treturn a = f(c, a), g(a, b)\r\n\t\t}, $string: b, $escape: d, $each: e\r\n\t}, o = a.helpers = n.$helpers;\r\n\ta.get = function (a) {\r\n\t\treturn j[a.replace(/^\\.\\//, \"\")]\r\n\t}, a.helper = function (a, b) {\r\n\t\to[a] = b\r\n\t}, module.exports = a\r\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js\n// module id = 34\n// module chunks = 0 1 2 3 4 5 7 9 13 15 16 20 21 22 26 27 29 30 32 34 35 38 43 44 45","var Dialog = require('dialog');\nvar noop = function() {};\n\nvar create = function(content, options) {\n    content = content || '';\n    options = options || {};\n    var defaults = {\n        fixed: true,\n        modal: true,\n        autofocus: false,\n        content: '<p class=\"del-pop-p\">' + content + '</p>',\n        className: 'pop-box',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        ok: noop\n    };\n    $.extend(true, defaults, options);\n    var d = Dialog(defaults);\n\n    var header = d._$('header');\n    var title = d._$('title');\n    if(!options.title){\n        title.css('borderBottom', 'none');\n    }\n    header.show();\n    d.show();\n    return d;\n};\n\nmodule.exports = create;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/alert.js","/*\r\n * 弹层提示弹窗\r\n * zhaodonghong\r\n */\r\n\r\n\r\n\r\nvar $publicMask;\r\nvar $publicTips;\r\nvar timer;\r\n\r\n\r\nvar events = function() {\r\n\r\n    $publicMask.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n\r\n    $publicTips.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * msg string 提示信息\r\n * options object \r\n * options.duration settimout消失时间\r\n * options.callback 提示消失的回调\r\n*/\r\nvar init = function(msg, options) {\r\n    var defaults = {\r\n        duration: 2000,\r\n        callback: function() {}\r\n    };\r\n\r\n    $.extend(defaults, options || {});\r\n\r\n    clearTimeout(timer);\r\n    $publicMask = $('[data-action=\"publicMask\"]');\r\n    $publicTips = $('[data-action=\"publicTips\"]');\r\n\r\n    if ($publicMask.length > 0) {\r\n\r\n        $publicMask.show();\r\n        $publicTips.show().text(msg);\r\n\r\n    } else {\r\n\r\n        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\r\n        $publicMask = $('[data-action=\"publicMask\"]');\r\n        $publicTips = $('[data-action=\"publicTips\"]');\r\n        events();\r\n    }\r\n\r\n    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\r\n\r\n    timer = setTimeout(function() {\r\n\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n\r\n        defaults.callback();\r\n\r\n    }, defaults.duration);\r\n};\r\n\r\n\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    events: events\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/hint.js","var fetch = require('io/fetch');\nvar Pubsub = require('io/pubsub');\n\nvar url = location.hostname.split('.');\nvar len = url.length;\nvar domain = url[len - 2] + '.' + url[len - 1];\nvar getCookieArea = function() {\n    fetch.get($_CONFIG.ss_service_gome + 'item/v1/cookie/getregion/flag/public/ip', {\n        dataType: 'jsonp',\n        jsonpCallback: \"ip\"\n    }).done(function(data) {\n        var value = data.atgregion;\n        if (data.success === true) {\n            $.cookie('atgregion', value, {\n                expires: 1,\n                path: '/',\n                domain: domain\n            });\n            Pubsub('getAreaId').pub();\n        }\n    })\n};\nmodule.exports = getCookieArea;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/atgregion.js","/*\n * Lazy Load - jQuery plugin for lazy loading images\n *\n * Copyright (c) 2007-2012 Mika Tuupola\n *\n * Licensed under the MIT license:\n *   http://www.opensource.org/licenses/mit-license.php\n *\n * Project home:\n *   http://www.appelsiini.net/projects/lazyload\n *\n * Version:  1.7.2\n *\n */\n(function($, window) {\n\n    var $window = $(window);\n    var $container;\n\n    $.fn.lazyload = function(options) {\n        var elements = this;\n        var settings = {\n            threshold: 0,\n            failure_limit: 0,\n            event: \"scroll\",\n            effect: \"show\",\n            container: window,\n            data_attribute: \"original\",\n            skip_invisible: true,\n            appear: null,\n            load: null\n        };\n\n        function update() {\n            var counter = 0;\n\n            elements.each(function() {\n                var $this = $(this);\n                if (settings.skip_invisible && !$this.is(\":visible\")) {\n                    return;\n                }\n                if ($.abovethetop(this, settings) ||\n                    $.leftofbegin(this, settings)) {\n                    /* Nothing. */\n                } else if (!$.belowthefold(this, settings) &&\n                    !$.rightoffold(this, settings)) {\n                    $this.trigger(\"appear\");\n                } else {\n                    if (++counter > settings.failure_limit) {\n                        return false;\n                    }\n                }\n            });\n\n        }\n\n        if (options) {\n            /* Maintain BC for a couple of versions. */\n            if (undefined !== options.failurelimit) {\n                options.failure_limit = options.failurelimit;\n                delete options.failurelimit;\n            }\n            if (undefined !== options.effectspeed) {\n                options.effect_speed = options.effectspeed;\n                delete options.effectspeed;\n            }\n\n            $.extend(settings, options);\n        }\n\n        /* Cache container as jQuery as object. */\n        $container = (settings.container === undefined ||\n            settings.container === window) ? $window : $(settings.container);\n\n        /* Fire one scroll event per scroll. Not one scroll event per image. */\n        if (0 === settings.event.indexOf(\"scroll\")) {\n            $container.bind(settings.event, function() {\n                return update();\n            });\n        }\n\n        this.each(function() {\n            var self = this;\n            var $self = $(self);\n\n            self.loaded = false;\n\n            /* When appear is triggered load original image. */\n            $self.one(\"appear\", function() {\n                if (!this.loaded) {\n                    if (settings.appear) {\n                        var elements_left = elements.length;\n                        settings.appear.call(self, elements_left, settings);\n                    }\n                    $(\"<img />\")\n                        .bind(\"load\", function() {\n                            $self\n                            //.hide()\n                                .attr(\"src\", $self.data(settings.data_attribute))[settings.effect](settings.effect_speed);\n                            self.loaded = true;\n\n                            /* Remove image from array so it is not looped next time. */\n                            var temp = $.grep(elements, function(element) {\n                                return !element.loaded;\n                            });\n                            elements = $(temp);\n\n                            if (settings.load) {\n                                var elements_left = elements.length;\n                                settings.load.call(self, elements_left, settings);\n                            }\n                        })\n                        .attr(\"src\", $self.data(settings.data_attribute));\n                }\n            });\n\n            /* When wanted event is triggered load original image */\n            /* by triggering appear.                              */\n            if (0 !== settings.event.indexOf(\"scroll\")) {\n                $self.bind(settings.event, function() {\n                    if (!self.loaded) {\n                        $self.trigger(\"appear\");\n                    }\n                });\n            }\n        });\n\n        /* Check if something appears when window is resized. */\n        $window.bind(\"resize\", function() {\n            update();\n        });\n\n        /* Force initial check if images should appear. */\n        update();\n\n        return this;\n    };\n\n    /* Convenience methods in jQuery namespace.           */\n    /* Use as  $.belowthefold(element, {threshold : 100, container : window}) */\n\n    $.belowthefold = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.height() + $window.scrollTop();\n        } else {\n            fold = $container.offset().top + $container.height();\n        }\n\n        return fold <= $(element).offset().top - settings.threshold;\n    };\n\n    $.rightoffold = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.width() + $window.scrollLeft();\n        } else {\n            fold = $container.offset().left + $container.width();\n        }\n\n        return fold <= $(element).offset().left - settings.threshold;\n    };\n\n    $.abovethetop = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.scrollTop();\n        } else {\n            fold = $container.offset().top;\n        }\n\n        return fold >= $(element).offset().top + settings.threshold + $(element).height();\n    };\n\n    $.leftofbegin = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.scrollLeft();\n        } else {\n            fold = $container.offset().left;\n        }\n\n        return fold >= $(element).offset().left + settings.threshold + $(element).width();\n    };\n\n    $.inviewport = function(element, settings) {\n        return !$.rightofscreen(element, settings) && !$.leftofscreen(element, settings) &&\n            !$.belowthefold(element, settings) && !$.abovethetop(element, settings);\n    };\n\n    /* Custom selectors for your convenience.   */\n    /* Use as $(\"img:below-the-fold\").something() */\n\n    $.extend($.expr[':'], {\n        \"below-the-fold\": function(a) {\n            return $.belowthefold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"above-the-top\": function(a) {\n            return !$.belowthefold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"right-of-screen\": function(a) {\n            return $.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"left-of-screen\": function(a) {\n            return !$.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"in-viewport\": function(a) {\n            return !$.inviewport(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        /* Maintain BC for couple of versions. */\n        \"above-the-fold\": function(a) {\n            return !$.belowthefold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"right-of-fold\": function(a) {\n            return $.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"left-of-fold\": function(a) {\n            return !$.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        }\n    });\n\n})(jQuery, window);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/plugin/jquery.lazyload.js\n// module id = 49\n// module chunks = 1 9 29","var imgPath = $_CONFIG.imgpath + '/images/emoji/';\n\nvar ext = '.png';\n\nvar groupOne = [{\n    name: '微笑',\n    url: 'weixiao'\n}, {\n    name: '色',\n    url: 'se'\n}, {\n    name: '亲亲',\n    url: 'qinqin'\n}, {\n    name: '得意',\n    url: 'deyi'\n}, {\n    name: '流泪',\n    url: 'liulei'\n}, {\n    name: '害羞',\n    url: 'haixiu'\n}, {\n    name: '闭嘴',\n    url: 'bizui'\n}, {\n    name: '鼓掌',\n    url: 'guzhang'\n}, {\n    name: '大哭',\n    url: 'daku'\n}, {\n    name: '尴尬',\n    url: 'ganga'\n}, {\n    name: '生气',\n    url: 'shengqi'\n}, {\n    name: '调皮',\n    url: 'tiaopi'\n}, {\n    name: '呲牙',\n    url: 'ciya'\n}, {\n    name: '惊讶',\n    url: 'jingya'\n}, {\n    name: '委屈',\n    url: 'weiqu'\n}, {\n    name: '吐血',\n    url: 'tuxue'\n}, {\n    name: '冷汗',\n    url: 'lenghan'\n}, {\n    name: '抓狂',\n    url: 'zhuakuang'\n}, {\n    name: '难过',\n    url: 'nanguo'\n}, {\n    name: '偷笑',\n    url: 'touxiao'\n}, {\n    name: '白眼',\n    url: 'baiyan'\n}, {\n    name: '不屑',\n    url: 'buxie'\n}, {\n    name: '快哭了',\n    url: 'kuaikule'\n}];\n\nvar groupTwo = [{\n    name: '困',\n    url: 'kun'\n}, {\n    name: '装酷',\n    url: 'zhuangku'\n}, {\n    name: '大笑',\n    url: 'daxiao'\n}, {\n    name: '偷瞄',\n    url: 'toumiao'\n}, {\n    name: '奋斗',\n    url: 'fendou'\n}, {\n    name: '咒骂',\n    url: 'zhouma'\n}, {\n    name: '疑问',\n    url: 'yiwen'\n}, {\n    name: '晕',\n    url: 'yun'\n}, {\n    name: '捶打',\n    url: 'chuida'\n}, {\n    name: '再见',\n    url: 'zaijian'\n}, {\n    name: '抠鼻',\n    url: 'koubi'\n}, {\n    name: '发呆',\n    url: 'fadai'\n}, {\n    name: '坏笑',\n    url: 'huaixiao'\n}, {\n    name: '哈欠',\n    url: 'haqian'\n}, {\n    name: '鄙视',\n    url: 'bishi'\n}, {\n    name: '睡觉',\n    url: 'shuijiao'\n}, {\n    name: '饿',\n    url: 'e'\n}, {\n    name: '阴险',\n    url: 'yinxian'\n}, {\n    name: '难受',\n    url: 'nanshou'\n}, {\n    name: '可怜',\n    url: 'kelian'\n}, {\n    name: '撇嘴',\n    url: 'piezui'\n}, {\n    name: '石化',\n    url: 'shihua'\n}, {\n    name: '泪眼',\n    url: 'leiyan'\n}];\n\nvar groupThree = [{\n    name: '嘘',\n    url: 'xu'\n}, {\n    name: '哼哼',\n    url: 'hengheng'\n}, {\n    name: '爱慕',\n    url: 'aimu'\n}, {\n    name: '财迷',\n    url: 'caimi'\n}, {\n    name: '耶',\n    url: 'ye'\n}, {\n    name: '思考',\n    url: 'sikao'\n}, {\n    name: '骷髅',\n    url: 'kulou'\n}, {\n    name: '痛哭',\n    url: 'tongku'\n}, {\n    name: '恭喜',\n    url: 'gongxi'\n}, {\n    name: '捂脸',\n    url: 'wulian'\n}, {\n    name: '嘿哈',\n    url: 'heiha'\n}, {\n    name: '机智',\n    url: 'jizhi'\n}, {\n    name: '皱眉',\n    url: 'zhoumei'\n}, {\n    name: '安慰',\n    url: 'anwei'\n}, {\n    name: '飞吻',\n    url: 'feiwen'\n}, {\n    name: '奸笑',\n    url: 'jianxiao'\n}, {\n    name: '猪头',\n    url: 'zhutou'\n}, {\n    name: '玫瑰',\n    url: 'meigui'\n}, {\n    name: '凋谢',\n    url: 'diaoxie'\n}, {\n    name: '爱心',\n    url: 'aixin'\n}, {\n    name: '心碎',\n    url: 'xinsui'\n}, {\n    name: '蛋糕',\n    url: 'dangao'\n}, {\n    name: '喝水',\n    url: 'heshui'\n}];\n\nvar groupFour = [{\n    name: '西瓜',\n    url: 'xigua'\n}, {\n    name: '咖啡',\n    url: 'kafei'\n}, {\n    name: '啤酒',\n    url: 'pijiu'\n}, {\n    name: '包包',\n    url: 'baobao'\n}, {\n    name: '高跟鞋',\n    url: 'gaogenxie'\n}, {\n    name: '帽子',\n    url: 'maozi'\n}, {\n    name: '口红',\n    url: 'kouhong'\n}, {\n    name: '裙子',\n    url: 'qunzi'\n}, {\n    name: 'T恤',\n    url: 'txu'\n}, {\n    name: '裤子',\n    url: 'kuzi'\n}, {\n    name: '眼镜',\n    url: 'yanjing'\n}, {\n    name: '太阳镜',\n    url: 'taiyangjing'\n}, {\n    name: '蜡烛',\n    url: 'lazhu'\n}, {\n    name: '礼物',\n    url: 'liwu'\n}, {\n    name: '红包',\n    url: 'hongbao'\n}, {\n    name: '拥抱',\n    url: 'yongbao'\n}, {\n    name: '太阳',\n    url: 'taiyang'\n}, {\n    name: '月亮',\n    url: 'yueliang'\n}, {\n    name: '便便',\n    url: 'bianbian'\n}, {\n    name: '炸弹',\n    url: 'zhadan'\n}, {\n    name: '菜刀',\n    url: 'caidao'\n}, {\n    name: '握手',\n    url: 'woshou'\n}, {\n    name: '胜利',\n    url: 'shengli'\n}];\n\nvar groupFive = [{\n    name: '赞',\n    url: 'zan'\n}, {\n    name: 'OK',\n    url: 'ok'\n}, {\n    name: '勾引',\n    url: 'gouyin'\n}, {\n    name: 'NO',\n    url: 'no'\n}, {\n    name: '打脸',\n    url: 'dalian'\n}, {\n    name: '抱拳',\n    url: 'baoquan'\n}, {\n    name: '乒乓球',\n    url: 'pingpangqiu'\n}, {\n    name: '足球',\n    url: 'zuqiu'\n}, {\n    name: '篮球',\n    url: 'lanqiu'\n}];\n\nvar format = function(arr) {\n    for (var i = 0, len = arr.length; i < len; i++) {\n        var emoji = arr[i];\n        emoji.url = imgPath + emoji.url + ext;\n    }\n    return arr;\n};\n\nmodule.exports = format(groupOne.concat(groupTwo, groupThree, groupFour, groupFive));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/emoji.js","var Dialog = require('dialog');\nvar noop = function() {};\n\nvar create = function(content, options) {\n    var defaults = {\n        fixed: true,\n        modal: true,\n        content: '<p class=\"del-pop-p\">' + content + '</p>',\n        className: 'pop-box',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        ok: noop,\n        cancel: noop,\n        btnWrapCls: 'two-buttons'\n    };\n    $.extend(true, defaults, options);\n\n    var d = Dialog(defaults);\n\n    // var header = d._$('header');\n    // var title = d._$('title');\n    // title.css('borderBottom', 'none');\n    // header.show();\n\n    d.show();\n    return d;\n};\n\nmodule.exports = create;\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/confirm.js","var html = function(str, reg) {\n    return str ? str.replace(reg || /[&<\">'](?:(amp|lt|ldquo|rdquo|quot|gt|#39|nbsp|#\\d+);)?/g, function(a, b) {\n        if (b) {\n            return a;\n        } else {\n            return {\n                '<': '&lt;',\n                '&': '&amp;',\n                '\"': '&quot;',\n                '“': '&ldquo;',\n                '”': '&rdquo;',\n                '>': '&gt;',\n                \"'\": '&#39;'\n            }[a]\n        }\n\n    }) : '';\n};\n\nmodule.exports = html;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/encodeHtml.js","var emojis = require('./emoji');\r\nvar backward = require('./backward');\r\nvar faceTpl = require('./face.tpl');\r\n\r\nvar faceReg,\r\n    faceUrl,\r\n    defaultIndex = 0;\r\n\r\n// 将表情转换成map\r\nvar emojiMap = {};\r\n\r\n// 数据适配转换\r\nvar makeData = function(data) {\r\n    var total = data.length;\r\n    var offset = 24;\r\n    var page = Math.ceil(total / offset);\r\n    var list = [];\r\n\r\n    for (var i = 0; i < page; i++) {\r\n        list[i] = [];\r\n        var end = offset * (i + 1);\r\n        end = end > total ? total : end;\r\n        for (var j = i * offset; j < end; j++) {\r\n            var emoji = data[j];\r\n            list[i].push(emoji);\r\n            emojiMap[emoji.name] = emoji.url;\r\n        }\r\n    }\r\n    return {\r\n        page: new Array(page),\r\n        list: list\r\n    };\r\n};\r\n// 表情层显示\r\nvar show = function(x, y) {\r\n    setShowIndex(0);\r\n    $('[data-node=faceBox]').css({\r\n        left: x + 'px',\r\n        top: y + 'px'\r\n    }).show();\r\n};\r\n// 表情层隐藏\r\nvar hide = function() {\r\n    $('[data-node=faceBox]').hide();\r\n};\r\n// tab方式显示所选页\r\nvar setShowIndex = function(index) {\r\n    index = index || defaultIndex;\r\n\r\n    $('[data-action=facePage] > li').eq(index).addClass('active').siblings('li').removeClass('active');\r\n    $('[data-node=faceList] > div').eq(index).removeClass('hide').siblings('div').addClass('hide');\r\n};\r\n\r\n/**\r\n * 插入表情，回调数据\r\n * @param  {Function} fn     回调函数\r\n * @param  {Boolean}  isHide 点击表情后是否隐藏表情浮层，默认隐藏\r\n * @return {[type]}          null\r\n */\r\nvar insertFace = function(fn, isHide) {\r\n    $('body').on('click', '[data-face]', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        faceReg = $(this).data('face');\r\n        faceUrl = $(this).attr('src');\r\n        fn({\r\n            reg: faceReg,\r\n            url: faceUrl\r\n        });\r\n        isHide !== false && $('[data-node=faceBox]').hide();\r\n    });\r\n};\r\n// 初始化表情弹层\r\nvar initHTML = function(fn) {\r\n    var data = makeData(emojis);\r\n    var faceHTML = faceTpl(data);\r\n    $('body').append(faceHTML);\r\n    fn();\r\n};\r\n// 初始化事件\r\nvar initEvent = function() {\r\n    $('body').on('click', '[data-node=faceBox]', function(e) {\r\n        e.stopPropagation();\r\n    });\r\n    $(document).on('click', function() {\r\n        $('[data-node=faceBox]').hide();\r\n    });\r\n    // 分页切换显示\r\n    $('[data-node=faceBox]').on('mouseenter', '[data-action=facePage] > li', function() {\r\n        var index = $(this).index();\r\n        setShowIndex(index);\r\n    });\r\n};\r\n\r\n// 把表情占位符替换成img\r\nvar parseEmoji = function(str) {\r\n    var r = /(\\[([\\s\\S]+?)\\])/g;\r\n    if ($.isEmptyObject(emojiMap)) {\r\n        makeData(emojis);\r\n    }\r\n\r\n    return str.replace(r, function(s, $1, name) {\r\n        var img = emojiMap[name];\r\n        if (img) {\r\n            return '<img width=\"22\" height=\"22\" src=\"' + img + '\" />';\r\n        } else {\r\n            // 兼容旧版表情\r\n            var old = backward[name];\r\n            if (old) {\r\n                return '<img width=\"22\" height=\"22\" src=\"' + old.url + '\" />';\r\n            }\r\n            return s;\r\n        }\r\n    });\r\n};\r\n\r\nvar init = function() {\r\n    initHTML(initEvent);\r\n};\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    insert: insertFace,\r\n    show: show,\r\n    hide: hide,\r\n    parseEmoji: parseEmoji\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/face.js","var path = $_CONFIG.imgpath + '/images/emoji/';\nvar ext = '.png';\n\nvar backward = {\n    '亲': {\n        name: '亲亲',\n        url: path + 'qinqin' + ext\n    },\n    '愤怒': {\n        name: '生气',\n        url: path + 'shengqi' + ext\n    },\n    '惊恐': {\n        name: '惊讶',\n        url: path + 'jingya' + ext\n    },\n    '迷茫': {\n        name: '委屈',\n        url: path + 'weiqu' + ext\n    },\n    '伤心': {\n        name: '难过',\n        url: path + 'nanguo' + ext\n    },\n    '努力': {\n        name: '奋斗',\n        url: path + 'fendou' + ext\n    },\n    'YY': {\n        name: ' 坏笑',\n        url: path + 'huaixiao' + ext\n    },\n    '恶心': {\n        name: '难受',\n        url: path + 'nanshou' + ext\n    }\n};\n\nmodule.exports = backward;\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/backward.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/face/face',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,face=$data.face,$index=$data.$index,$escape=$utils.$escape,page=$data.page,$out='';$out+='<div data-node=\"faceBox\" class=\"imoj-box\" style=\"position: absolute;z-index: 9999;display:none\"> <em class=\"sanjiao\"></em> <div data-node=\"faceList\" class=\"imoj-list\"> ';\n$each(list,function(v,i){\n$out+=' <div class=\"imoj-content clearfix ';\nif(i){\n$out+='hide';\n}\n$out+='\"> ';\n$each(v,function(face,$index){\n$out+=' <a href=\"javascript:;\"> <img width=\"22\" height=\"22\" data-face=\"[';\n$out+=$escape(face.name);\n$out+=']\" src=\"';\n$out+=$escape(face.url);\n$out+='\" alt=\"';\n$out+=$escape(face.name);\n$out+='\" title=\"';\n$out+=$escape(face.name);\n$out+='\"> </a> ';\n});\n$out+=' </div> ';\n});\n$out+=' </div> <ul data-action=\"facePage\" class=\"pagination\"> ';\n$each(page,function(v,i){\n$out+=' <li ';\nif(i==0){\n$out+='class=\"active\"';\n}\n$out+='>';\n$out+=$escape(i+1);\n$out+='</li> ';\n});\n$out+=' </ul> </div>';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/face/face.tpl\n// module id = 76\n// module chunks = 2 5 15 20 21 29 30 32 44","/**\n * Created by dongyukuan on 2016/7/4.\n */\nvar inputTip = {\n    tel: {\n        ept: '请填写11位手机号',\n        err: '手机号格式错误',\n        errBack: '该手机号已被注册'\n    },\n    msgCode: {\n        tipGet: '请获取短信验证码',\n        tipEpt: '请输入短信验证码',\n        tipErr: '验证码是6位数字,请重新输入',\n        tipErrEdit: '验证码错误',\n        tipWrong: '验证码有误,请重新输入',\n        checkCodeWrong: '验证码输入错误,请重新输入',\n        send: '验证码已发送，请注意查收',\n        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n        tipDisabled: \"验证码再次获取需间隔60s\",\n        tipLimitEdit: '获取验证码超限，请稍后再试',\n        btnAfterSend: \"秒后重新获取\",\n        btnDefault: \"获取验证码\"\n    },\n    pwd: {\n        commonTip: '请输入6-20位英文字母,数字或符号'\n    },\n    pwdV: {\n        ept: '请再次输入密码',\n        err: '两次输入的密码不一致'\n    },\n    nickName: {\n        eptName: '请输入昵称！',\n        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n        existName: '此昵称太受欢迎了，已经有人抢了~',\n        sucSub: '资料修改成功！',\n        errLine: \"网络超时!\",\n        wrongName: '此昵称含有敏感词,请重新输入'\n    },\n    birthTip: {\n        tip: '生日不能重复设置'\n    },\n    refCode: {\n        err: '推荐码错误'\n    },\n    imgCode: {\n        ept: '请输入验证码',\n        err: '验证码输入错误，请重新输入'\n    },\n    login: {\n        errCode: '请输入验证码',\n        errNum: '请输入账号',\n        errPwd: '请输入密码',\n        agreement: '请同意协议并勾选'\n    },\n    createCircle: {\n        typeEmpty: '请选择圈子分类',\n        nameEmpty: '圈子名称不能为空',\n        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n    },\n    circle: {\n    \tlogin: '登录成功！',\n        unJoin: '需要先加入该圈子才能发布话题',\n        cannotJoin: '抱歉！该圈子不允许发布话题!',\n        review: '加入圈子审核中，请耐心等待!',\n        joinSuccess: '恭喜您已经加入圈子！',\n        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n        exit: '您已经退出该圈子！',\n        dissolved: '抱歉！该圈子已被解散'\n    },\n    qrCodeTip: {\n        loseEffTip: '二维码已失效',\n        loseEffBtn: '点击刷新',\n        failGetTip: '二维码生成失败',\n        failGetBtn: '重新生成'\n    },\n    masterApply: {\n        nameLength: '姓名要2-20个字符',\n        nameType: '姓名仅限汉字和字母',\n        isIdCard: '请填写18位有效身份证号',\n        type: '请选择达人类别',\n        summary: '请输入自我介绍，2-100个字符'\n    },\n    upload: {\n        noUpload: '请上传图片',\n        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        uploadFaild: '上传失败,请重新上传',\n        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n        Q_TYPE_DENIED: '文件类型错误',\n        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n        excess: '文件个数超出限制'\n    },\n    errLine: {\n        tip: '网络错误,请稍后再试！'\n    }\n};\nmodule.exports = inputTip;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/i18n.js","/*! WebUploader 0.1.5 */\n\n\n/**\n * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n *\n * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n */\n(function( root, factory ) {\n    var modules = {},\n\n        // 内部require, 简单不完全实现。\n        // https://github.com/amdjs/amdjs-api/wiki/require\n        _require = function( deps, callback ) {\n            var args, len, i;\n\n            // 如果deps不是数组，则直接返回指定module\n            if ( typeof deps === 'string' ) {\n                return getModule( deps );\n            } else {\n                args = [];\n                for( len = deps.length, i = 0; i < len; i++ ) {\n                    args.push( getModule( deps[ i ] ) );\n                }\n\n                return callback.apply( null, args );\n            }\n        },\n\n        // 内部define，暂时不支持不指定id.\n        _define = function( id, deps, factory ) {\n            if ( arguments.length === 2 ) {\n                factory = deps;\n                deps = null;\n            }\n\n            _require( deps || [], function() {\n                setModule( id, factory, arguments );\n            });\n        },\n\n        // 设置module, 兼容CommonJs写法。\n        setModule = function( id, factory, args ) {\n            var module = {\n                    exports: factory\n                },\n                returned;\n\n            if ( typeof factory === 'function' ) {\n                args.length || (args = [ _require, module.exports, module ,window.jQuery]);\n                returned = factory.apply( null, args );\n                returned !== undefined && (module.exports = returned);\n            }\n\n            modules[ id ] = module.exports;\n        },\n\n        // 根据id获取module\n        getModule = function( id ) {\n            var module = modules[ id ] || root[ id ];\n\n            if ( !module ) {\n                throw new Error( '`' + id + '` is undefined' );\n            }\n\n            return module;\n        },\n\n        // 将所有modules，将路径ids装换成对象。\n        exportsTo = function( obj ) {\n            var key, host, parts, part, last, ucFirst;\n\n            // make the first character upper case.\n            ucFirst = function( str ) {\n                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n            };\n\n            for ( key in modules ) {\n                host = obj;\n\n                if ( !modules.hasOwnProperty( key ) ) {\n                    continue;\n                }\n\n                parts = key.split('/');\n                last = ucFirst( parts.pop() );\n\n                while( (part = ucFirst( parts.shift() )) ) {\n                    host[ part ] = host[ part ] || {};\n                    host = host[ part ];\n                }\n\n                host[ last ] = modules[ key ];\n            }\n\n            return obj;\n        },\n\n        makeExport = function( dollar ) {\n            root.__dollar = dollar;\n\n            // exports every module.\n            return exportsTo( factory( root, _define, _require,window.jQuery ) );\n        },\n\n        origin;\n\n    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\n        // For CommonJS and CommonJS-like environments where a proper window is present,\n        module.exports = makeExport();\n    } else if ( typeof define === 'function' && define.amd ) {\n\n        // Allow using this built library as an AMD module\n        // in another project. That other project will only\n        // see this AMD call, not the internal modules in\n        // the closure below.\n        define([ 'jquery' ], makeExport );\n    } else {\n\n        // Browser globals case. Just assign the\n        // result to a property on the global.\n        origin = root.WebUploader;\n        root.WebUploader = makeExport();\n        root.WebUploader.noConflict = function() {\n            root.WebUploader = origin;\n        };\n    }\n})( window, function( window, define, require ,jQuery ) {\n\n\n    /**\n     * @fileOverview jQuery or Zepto\n     */\n    define('dollar-third',[],function() {\n        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n    \n        if ( !$ ) {\n            throw new Error('jQuery or Zepto not found!');\n        }\n    \n        return $;\n    });\n    /**\n     * @fileOverview Dom 操作相关\n     */\n    define('dollar',[\n        'dollar-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 使用jQuery的Promise\n     */\n    define('promise-third',[\n        'dollar'\n    ], function( $ ) {\n        return {\n            Deferred: $.Deferred,\n            when: $.when,\n    \n            isPromise: function( anything ) {\n                return anything && typeof anything.then === 'function';\n            }\n        };\n    });\n    /**\n     * @fileOverview Promise/A+\n     */\n    define('promise',[\n        'promise-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 基础类方法。\n     */\n    \n    /**\n     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n     *\n     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n     *\n     * * module `base`：WebUploader.Base\n     * * module `file`: WebUploader.File\n     * * module `lib/dnd`: WebUploader.Lib.Dnd\n     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n     *\n     *\n     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n     * @module WebUploader\n     * @title WebUploader API文档\n     */\n    define('base',[\n        'dollar',\n        'promise'\n    ], function( $, promise ) {\n    \n        var noop = function() {},\n            call = Function.call;\n    \n        // http://jsperf.com/uncurrythis\n        // 反科里化\n        function uncurryThis( fn ) {\n            return function() {\n                return call.apply( fn, arguments );\n            };\n        }\n    \n        function bindFn( fn, context ) {\n            return function() {\n                return fn.apply( context, arguments );\n            };\n        }\n    \n        function createObject( proto ) {\n            var f;\n    \n            if ( Object.create ) {\n                return Object.create( proto );\n            } else {\n                f = function() {};\n                f.prototype = proto;\n                return new f();\n            }\n        }\n    \n    \n        /**\n         * 基础类，提供一些简单常用的方法。\n         * @class Base\n         */\n        return {\n    \n            /**\n             * @property {String} version 当前版本号。\n             */\n            version: '0.1.5',\n    \n            /**\n             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n             */\n            $: $,\n    \n            Deferred: promise.Deferred,\n    \n            isPromise: promise.isPromise,\n    \n            when: promise.when,\n    \n            /**\n             * @description  简单的浏览器检查结果。\n             *\n             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n             *\n             * @property {Object} [browser]\n             */\n            browser: (function( ua ) {\n                var ret = {},\n                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n                        ua.match( /CriOS\\/([\\d.]+)/ ),\n    \n                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n    \n                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n    \n                return ret;\n            })( navigator.userAgent ),\n    \n            /**\n             * @description  操作系统检查结果。\n             *\n             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n             * @property {Object} [os]\n             */\n            os: (function( ua ) {\n                var ret = {},\n    \n                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n    \n                // osx && (ret.osx = true);\n                android && (ret.android = parseFloat( android[ 1 ] ));\n                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n    \n                return ret;\n            })( navigator.userAgent ),\n    \n            /**\n             * 实现类与类之间的继承。\n             * @method inherits\n             * @grammar Base.inherits( super ) => child\n             * @grammar Base.inherits( super, protos ) => child\n             * @grammar Base.inherits( super, protos, statics ) => child\n             * @param  {Class} super 父类\n             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n             * @param  {Object} [statics] 静态属性或方法。\n             * @return {Class} 返回子类。\n             * @example\n             * function Person() {\n             *     console.log( 'Super' );\n             * }\n             * Person.prototype.hello = function() {\n             *     console.log( 'hello' );\n             * };\n             *\n             * var Manager = Base.inherits( Person, {\n             *     world: function() {\n             *         console.log( 'World' );\n             *     }\n             * });\n             *\n             * // 因为没有指定构造器，父类的构造器将会执行。\n             * var instance = new Manager();    // => Super\n             *\n             * // 继承子父类的方法\n             * instance.hello();    // => hello\n             * instance.world();    // => World\n             *\n             * // 子类的__super__属性指向父类\n             * console.log( Manager.__super__ === Person );    // => true\n             */\n            inherits: function( Super, protos, staticProtos ) {\n                var child;\n    \n                if ( typeof protos === 'function' ) {\n                    child = protos;\n                    protos = null;\n                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n                    child = protos.constructor;\n                } else {\n                    child = function() {\n                        return Super.apply( this, arguments );\n                    };\n                }\n    \n                // 复制静态方法\n                $.extend( true, child, Super, staticProtos || {} );\n    \n                /* jshint camelcase: false */\n    \n                // 让子类的__super__属性指向父类。\n                child.__super__ = Super.prototype;\n    \n                // 构建原型，添加原型方法或属性。\n                // 暂时用Object.create实现。\n                child.prototype = createObject( Super.prototype );\n                protos && $.extend( true, child.prototype, protos );\n    \n                return child;\n            },\n    \n            /**\n             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n             * @method noop\n             */\n            noop: noop,\n    \n            /**\n             * 返回一个新的方法，此方法将已指定的`context`来执行。\n             * @grammar Base.bindFn( fn, context ) => Function\n             * @method bindFn\n             * @example\n             * var doSomething = function() {\n             *         console.log( this.name );\n             *     },\n             *     obj = {\n             *         name: 'Object Name'\n             *     },\n             *     aliasFn = Base.bind( doSomething, obj );\n             *\n             *  aliasFn();    // => Object Name\n             *\n             */\n            bindFn: bindFn,\n    \n            /**\n             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n             * @grammar Base.log( args... ) => undefined\n             * @method log\n             */\n            log: (function() {\n                if ( window.console ) {\n                    return bindFn( console.log, console );\n                }\n                return noop;\n            })(),\n    \n            nextTick: (function() {\n    \n                return function( cb ) {\n                    setTimeout( cb, 1 );\n                };\n    \n                // @bug 当浏览器不在当前窗口时就停了。\n                // var next = window.requestAnimationFrame ||\n                //     window.webkitRequestAnimationFrame ||\n                //     window.mozRequestAnimationFrame ||\n                //     function( cb ) {\n                //         window.setTimeout( cb, 1000 / 60 );\n                //     };\n    \n                // // fix: Uncaught TypeError: Illegal invocation\n                // return bindFn( next, window );\n            })(),\n    \n            /**\n             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n             * 将用来将非数组对象转化成数组对象。\n             * @grammar Base.slice( target, start[, end] ) => Array\n             * @method slice\n             * @example\n             * function doSomthing() {\n             *     var args = Base.slice( arguments, 1 );\n             *     console.log( args );\n             * }\n             *\n             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n             */\n            slice: uncurryThis( [].slice ),\n    \n            /**\n             * 生成唯一的ID\n             * @method guid\n             * @grammar Base.guid() => String\n             * @grammar Base.guid( prefx ) => String\n             */\n            guid: (function() {\n                var counter = 0;\n    \n                return function( prefix ) {\n                    var guid = (+new Date()).toString( 32 ),\n                        i = 0;\n    \n                    for ( ; i < 5; i++ ) {\n                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n                    }\n    \n                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n                };\n            })(),\n    \n            /**\n             * 格式化文件大小, 输出成带单位的字符串\n             * @method formatSize\n             * @grammar Base.formatSize( size ) => String\n             * @grammar Base.formatSize( size, pointLength ) => String\n             * @grammar Base.formatSize( size, pointLength, units ) => String\n             * @param {Number} size 文件大小\n             * @param {Number} [pointLength=2] 精确到的小数点数。\n             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n             * @example\n             * console.log( Base.formatSize( 100 ) );    // => 100B\n             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n             */\n            formatSize: function( size, pointLength, units ) {\n                var unit;\n    \n                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n    \n                while ( (unit = units.shift()) && size > 1024 ) {\n                    size = size / 1024;\n                }\n    \n                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n                        unit;\n            }\n        };\n    });\n    /**\n     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n     * @fileOverview Mediator\n     */\n    define('mediator',[\n        'base'\n    ], function( Base ) {\n        var $ = Base.$,\n            slice = [].slice,\n            separator = /\\s+/,\n            protos;\n    \n        // 根据条件过滤出事件handlers.\n        function findHandlers( arr, name, callback, context ) {\n            return $.grep( arr, function( handler ) {\n                return handler &&\n                        (!name || handler.e === name) &&\n                        (!callback || handler.cb === callback ||\n                        handler.cb._cb === callback) &&\n                        (!context || handler.ctx === context);\n            });\n        }\n    \n        function eachEvent( events, callback, iterator ) {\n            // 不支持对象，只支持多个event用空格隔开\n            $.each( (events || '').split( separator ), function( _, key ) {\n                iterator( key, callback );\n            });\n        }\n    \n        function triggerHanders( events, args ) {\n            var stoped = false,\n                i = -1,\n                len = events.length,\n                handler;\n    \n            while ( ++i < len ) {\n                handler = events[ i ];\n    \n                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n                    stoped = true;\n                    break;\n                }\n            }\n    \n            return !stoped;\n        }\n    \n        protos = {\n    \n            /**\n             * 绑定事件。\n             *\n             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n             * ```javascript\n             * var obj = {};\n             *\n             * // 使得obj有事件行为\n             * Mediator.installTo( obj );\n             *\n             * obj.on( 'testa', function( arg1, arg2 ) {\n             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n             * });\n             *\n             * obj.trigger( 'testa', 'arg1', 'arg2' );\n             * ```\n             *\n             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n             * 切会影响到`trigger`方法的返回值，为`false`。\n             *\n             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n             * ```javascript\n             * obj.on( 'all', function( type, arg1, arg2 ) {\n             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n             * });\n             * ```\n             *\n             * @method on\n             * @grammar on( name, callback[, context] ) => self\n             * @param  {String}   name     事件名，支持多个事件用空格隔开\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             * @class Mediator\n             */\n            on: function( name, callback, context ) {\n                var me = this,\n                    set;\n    \n                if ( !callback ) {\n                    return this;\n                }\n    \n                set = this._events || (this._events = []);\n    \n                eachEvent( name, callback, function( name, callback ) {\n                    var handler = { e: name };\n    \n                    handler.cb = callback;\n                    handler.ctx = context;\n                    handler.ctx2 = context || me;\n                    handler.id = set.length;\n    \n                    set.push( handler );\n                });\n    \n                return this;\n            },\n    \n            /**\n             * 绑定事件，且当handler执行完后，自动解除绑定。\n             * @method once\n             * @grammar once( name, callback[, context] ) => self\n             * @param  {String}   name     事件名\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            once: function( name, callback, context ) {\n                var me = this;\n    \n                if ( !callback ) {\n                    return me;\n                }\n    \n                eachEvent( name, callback, function( name, callback ) {\n                    var once = function() {\n                            me.off( name, once );\n                            return callback.apply( context || me, arguments );\n                        };\n    \n                    once._cb = callback;\n                    me.on( name, once, context );\n                });\n    \n                return me;\n            },\n    \n            /**\n             * 解除事件绑定\n             * @method off\n             * @grammar off( [name[, callback[, context] ] ] ) => self\n             * @param  {String}   [name]     事件名\n             * @param  {Function} [callback] 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            off: function( name, cb, ctx ) {\n                var events = this._events;\n    \n                if ( !events ) {\n                    return this;\n                }\n    \n                if ( !name && !cb && !ctx ) {\n                    this._events = [];\n                    return this;\n                }\n    \n                eachEvent( name, cb, function( name, cb ) {\n                    $.each( findHandlers( events, name, cb, ctx ), function() {\n                        delete events[ this.id ];\n                    });\n                });\n    \n                return this;\n            },\n    \n            /**\n             * 触发事件\n             * @method trigger\n             * @grammar trigger( name[, args...] ) => self\n             * @param  {String}   type     事件名\n             * @param  {*} [...] 任意参数\n             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n             */\n            trigger: function( type ) {\n                var args, events, allEvents;\n    \n                if ( !this._events || !type ) {\n                    return this;\n                }\n    \n                args = slice.call( arguments, 1 );\n                events = findHandlers( this._events, type );\n                allEvents = findHandlers( this._events, 'all' );\n    \n                return triggerHanders( events, args ) &&\n                        triggerHanders( allEvents, arguments );\n            }\n        };\n    \n        /**\n         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n         *\n         * @class Mediator\n         */\n        return $.extend({\n    \n            /**\n             * 可以通过这个接口，使任何对象具备事件功能。\n             * @method installTo\n             * @param  {Object} obj 需要具备事件行为的对象。\n             * @return {Object} 返回obj.\n             */\n            installTo: function( obj ) {\n                return $.extend( obj, protos );\n            }\n    \n        }, protos );\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('uploader',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n    \n        var $ = Base.$;\n    \n        /**\n         * 上传入口类。\n         * @class Uploader\n         * @constructor\n         * @grammar new Uploader( opts ) => Uploader\n         * @example\n         * var uploader = WebUploader.Uploader({\n         *     swf: 'path_of_swf/Uploader.swf',\n         *\n         *     // 开起分片上传。\n         *     chunked: true\n         * });\n         */\n        function Uploader( opts ) {\n            this.options = $.extend( true, {}, Uploader.options, opts );\n            this._init( this.options );\n        }\n    \n        // default Options\n        // widgets中有相应扩展\n        Uploader.options = {};\n        Mediator.installTo( Uploader.prototype );\n    \n        // 批量添加纯命令式方法。\n        $.each({\n            upload: 'start-upload',\n            stop: 'stop-upload',\n            getFile: 'get-file',\n            getFiles: 'get-files',\n            addFile: 'add-file',\n            addFiles: 'add-file',\n            sort: 'sort-files',\n            removeFile: 'remove-file',\n            cancelFile: 'cancel-file',\n            skipFile: 'skip-file',\n            retry: 'retry',\n            isInProgress: 'is-in-progress',\n            makeThumb: 'make-thumb',\n            md5File: 'md5-file',\n            getDimension: 'get-dimension',\n            addButton: 'add-btn',\n            predictRuntimeType: 'predict-runtime-type',\n            refresh: 'refresh',\n            disable: 'disable',\n            enable: 'enable',\n            reset: 'reset'\n        }, function( fn, command ) {\n            Uploader.prototype[ fn ] = function() {\n                return this.request( command, arguments );\n            };\n        });\n    \n        $.extend( Uploader.prototype, {\n            state: 'pending',\n    \n            _init: function( opts ) {\n                var me = this;\n    \n                me.request( 'init', opts, function() {\n                    me.state = 'ready';\n                    me.trigger('ready');\n                });\n            },\n    \n            /**\n             * 获取或者设置Uploader配置项。\n             * @method option\n             * @grammar option( key ) => *\n             * @grammar option( key, val ) => self\n             * @example\n             *\n             * // 初始状态图片上传前不会压缩\n             * var uploader = new WebUploader.Uploader({\n             *     compress: null;\n             * });\n             *\n             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n             * uploader.option( 'compress', {\n             *     width: 1600,\n             *     height: 1600\n             * });\n             */\n            option: function( key, val ) {\n                var opts = this.options;\n    \n                // setter\n                if ( arguments.length > 1 ) {\n    \n                    if ( $.isPlainObject( val ) &&\n                            $.isPlainObject( opts[ key ] ) ) {\n                        $.extend( opts[ key ], val );\n                    } else {\n                        opts[ key ] = val;\n                    }\n    \n                } else {    // getter\n                    return key ? opts[ key ] : opts;\n                }\n            },\n    \n            /**\n             * 获取文件统计信息。返回一个包含一下信息的对象。\n             * * `successNum` 上传成功的文件数\n             * * `progressNum` 上传中的文件数\n             * * `cancelNum` 被删除的文件数\n             * * `invalidNum` 无效的文件数\n             * * `uploadFailNum` 上传失败的文件数\n             * * `queueNum` 还在队列中的文件数\n             * * `interruptNum` 被暂停的文件数\n             * @method getStats\n             * @grammar getStats() => Object\n             */\n            getStats: function() {\n                // return this._mgr.getStats.apply( this._mgr, arguments );\n                var stats = this.request('get-stats');\n    \n                return stats ? {\n                    successNum: stats.numOfSuccess,\n                    progressNum: stats.numOfProgress,\n    \n                    // who care?\n                    // queueFailNum: 0,\n                    cancelNum: stats.numOfCancel,\n                    invalidNum: stats.numOfInvalid,\n                    uploadFailNum: stats.numOfUploadFailed,\n                    queueNum: stats.numOfQueue,\n                    interruptNum: stats.numofInterrupt\n                } : {};\n            },\n    \n            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n            trigger: function( type/*, args...*/ ) {\n                var args = [].slice.call( arguments, 1 ),\n                    opts = this.options,\n                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n                        type.substring( 1 );\n    \n                if (\n                        // 调用通过on方法注册的handler.\n                        Mediator.trigger.apply( this, arguments ) === false ||\n    \n                        // 调用opts.onEvent\n                        $.isFunction( opts[ name ] ) &&\n                        opts[ name ].apply( this, args ) === false ||\n    \n                        // 调用this.onEvent\n                        $.isFunction( this[ name ] ) &&\n                        this[ name ].apply( this, args ) === false ||\n    \n                        // 广播所有uploader的事件。\n                        Mediator.trigger.apply( Mediator,\n                        [ this, type ].concat( args ) ) === false ) {\n    \n                    return false;\n                }\n    \n                return true;\n            },\n    \n            /**\n             * 销毁 webuploader 实例\n             * @method destroy\n             * @grammar destroy() => undefined\n             */\n            destroy: function() {\n                this.request( 'destroy', arguments );\n                this.off();\n            },\n    \n            // widgets/widget.js将补充此方法的详细文档。\n            request: Base.noop\n        });\n    \n        /**\n         * 创建Uploader实例，等同于new Uploader( opts );\n         * @method create\n         * @class Base\n         * @static\n         * @grammar Base.create( opts ) => Uploader\n         */\n        Base.create = Uploader.create = function( opts ) {\n            return new Uploader( opts );\n        };\n    \n        // 暴露Uploader，可以通过它来扩展业务逻辑。\n        Base.Uploader = Uploader;\n    \n        return Uploader;\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/runtime',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n    \n        var $ = Base.$,\n            factories = {},\n    \n            // 获取对象的第一个key\n            getFirstKey = function( obj ) {\n                for ( var key in obj ) {\n                    if ( obj.hasOwnProperty( key ) ) {\n                        return key;\n                    }\n                }\n                return null;\n            };\n    \n        // 接口类。\n        function Runtime( options ) {\n            this.options = $.extend({\n                container: document.body\n            }, options );\n            this.uid = Base.guid('rt_');\n        }\n    \n        $.extend( Runtime.prototype, {\n    \n            getContainer: function() {\n                var opts = this.options,\n                    parent, container;\n    \n                if ( this._container ) {\n                    return this._container;\n                }\n    \n                parent = $( opts.container || document.body );\n                container = $( document.createElement('div') );\n    \n                container.attr( 'id', 'rt_' + this.uid );\n                container.css({\n                    position: 'absolute',\n                    top: '0px',\n                    left: '0px',\n                    width: '1px',\n                    height: '1px',\n                    overflow: 'hidden'\n                });\n    \n                parent.append( container );\n                parent.addClass('webuploader-container');\n                this._container = container;\n                this._parent = parent;\n                return container;\n            },\n    \n            init: Base.noop,\n            exec: Base.noop,\n    \n            destroy: function() {\n                this._container && this._container.remove();\n                this._parent && this._parent.removeClass('webuploader-container');\n                this.off();\n            }\n        });\n    \n        Runtime.orders = 'html5,flash';\n    \n    \n        /**\n         * 添加Runtime实现。\n         * @param {String} type    类型\n         * @param {Runtime} factory 具体Runtime实现。\n         */\n        Runtime.addRuntime = function( type, factory ) {\n            factories[ type ] = factory;\n        };\n    \n        Runtime.hasRuntime = function( type ) {\n            return !!(type ? factories[ type ] : getFirstKey( factories ));\n        };\n    \n        Runtime.create = function( opts, orders ) {\n            var type, runtime;\n    \n            orders = orders || Runtime.orders;\n            $.each( orders.split( /\\s*,\\s*/g ), function() {\n                if ( factories[ this ] ) {\n                    type = this;\n                    return false;\n                }\n            });\n    \n            type = type || getFirstKey( factories );\n            if ( !type ) {\n                throw new Error('Runtime Error');\n            }\n    \n            runtime = new factories[ type ]( opts );\n            return runtime;\n        };\n    \n        Mediator.installTo( Runtime.prototype );\n        return Runtime;\n    });\n    \n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/client',[\n        'base',\n        'mediator',\n        'runtime/runtime'\n    ], function( Base, Mediator, Runtime ) {\n    \n        var cache;\n    \n        cache = (function() {\n            var obj = {};\n    \n            return {\n                add: function( runtime ) {\n                    obj[ runtime.uid ] = runtime;\n                },\n    \n                get: function( ruid, standalone ) {\n                    var i;\n    \n                    if ( ruid ) {\n                        return obj[ ruid ];\n                    }\n    \n                    for ( i in obj ) {\n                        // 有些类型不能重用，比如filepicker.\n                        if ( standalone && obj[ i ].__standalone ) {\n                            continue;\n                        }\n    \n                        return obj[ i ];\n                    }\n    \n                    return null;\n                },\n    \n                remove: function( runtime ) {\n                    delete obj[ runtime.uid ];\n                }\n            };\n        })();\n    \n        function RuntimeClient( component, standalone ) {\n            var deferred = Base.Deferred(),\n                runtime;\n    \n            this.uid = Base.guid('client_');\n    \n            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n            this.runtimeReady = function( cb ) {\n                return deferred.done( cb );\n            };\n    \n            this.connectRuntime = function( opts, cb ) {\n    \n                // already connected.\n                if ( runtime ) {\n                    throw new Error('already connected!');\n                }\n    \n                deferred.done( cb );\n    \n                if ( typeof opts === 'string' && cache.get( opts ) ) {\n                    runtime = cache.get( opts );\n                }\n    \n                // 像filePicker只能独立存在，不能公用。\n                runtime = runtime || cache.get( null, standalone );\n    \n                // 需要创建\n                if ( !runtime ) {\n                    runtime = Runtime.create( opts, opts.runtimeOrder );\n                    runtime.__promise = deferred.promise();\n                    runtime.once( 'ready', deferred.resolve );\n                    runtime.init();\n                    cache.add( runtime );\n                    runtime.__client = 1;\n                } else {\n                    // 来自cache\n                    Base.$.extend( runtime.options, opts );\n                    runtime.__promise.then( deferred.resolve );\n                    runtime.__client++;\n                }\n    \n                standalone && (runtime.__standalone = standalone);\n                return runtime;\n            };\n    \n            this.getRuntime = function() {\n                return runtime;\n            };\n    \n            this.disconnectRuntime = function() {\n                if ( !runtime ) {\n                    return;\n                }\n    \n                runtime.__client--;\n    \n                if ( runtime.__client <= 0 ) {\n                    cache.remove( runtime );\n                    delete runtime.__promise;\n                    runtime.destroy();\n                }\n    \n                runtime = null;\n            };\n    \n            this.exec = function() {\n                if ( !runtime ) {\n                    return;\n                }\n    \n                var args = Base.slice( arguments );\n                component && args.unshift( component );\n    \n                return runtime.exec.apply( this, args );\n            };\n    \n            this.getRuid = function() {\n                return runtime && runtime.uid;\n            };\n    \n            this.destroy = (function( destroy ) {\n                return function() {\n                    destroy && destroy.apply( this, arguments );\n                    this.trigger('destroy');\n                    this.off();\n                    this.exec('destroy');\n                    this.disconnectRuntime();\n                };\n            })( this.destroy );\n        }\n    \n        Mediator.installTo( RuntimeClient.prototype );\n        return RuntimeClient;\n    });\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/dnd',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n    \n        var $ = Base.$;\n    \n        function DragAndDrop( opts ) {\n            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n    \n            opts.container = $( opts.container );\n    \n            if ( !opts.container.length ) {\n                return;\n            }\n    \n            RuntimeClent.call( this, 'DragAndDrop' );\n        }\n    \n        DragAndDrop.options = {\n            accept: null,\n            disableGlobalDnd: false\n        };\n    \n        Base.inherits( RuntimeClent, {\n            constructor: DragAndDrop,\n    \n            init: function() {\n                var me = this;\n    \n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n    \n        Mediator.installTo( DragAndDrop.prototype );\n    \n        return DragAndDrop;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/widget',[\n        'base',\n        'uploader'\n    ], function( Base, Uploader ) {\n    \n        var $ = Base.$,\n            _init = Uploader.prototype._init,\n            _destroy = Uploader.prototype.destroy,\n            IGNORE = {},\n            widgetClass = [];\n    \n        function isArrayLike( obj ) {\n            if ( !obj ) {\n                return false;\n            }\n    \n            var length = obj.length,\n                type = $.type( obj );\n    \n            if ( obj.nodeType === 1 && length ) {\n                return true;\n            }\n    \n            return type === 'array' || type !== 'function' && type !== 'string' &&\n                    (length === 0 || typeof length === 'number' && length > 0 &&\n                    (length - 1) in obj);\n        }\n    \n        function Widget( uploader ) {\n            this.owner = uploader;\n            this.options = uploader.options;\n        }\n    \n        $.extend( Widget.prototype, {\n    \n            init: Base.noop,\n    \n            // 类Backbone的事件监听声明，监听uploader实例上的事件\n            // widget直接无法监听事件，事件只能通过uploader来传递\n            invoke: function( apiName, args ) {\n    \n                /*\n                    {\n                        'make-thumb': 'makeThumb'\n                    }\n                 */\n                var map = this.responseMap;\n    \n                // 如果无API响应声明则忽略\n                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n    \n                    return IGNORE;\n                }\n    \n                return this[ map[ apiName ] ].apply( this, args );\n    \n            },\n    \n            /**\n             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n             * @method request\n             * @grammar request( command, args ) => * | Promise\n             * @grammar request( command, args, callback ) => Promise\n             * @for  Uploader\n             */\n            request: function() {\n                return this.owner.request.apply( this.owner, arguments );\n            }\n        });\n    \n        // 扩展Uploader.\n        $.extend( Uploader.prototype, {\n    \n            /**\n             * @property {String | Array} [disableWidgets=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n             */\n    \n            // 覆写_init用来初始化widgets\n            _init: function() {\n                var me = this,\n                    widgets = me._widgets = [],\n                    deactives = me.options.disableWidgets || '';\n    \n                $.each( widgetClass, function( _, klass ) {\n                    (!deactives || !~deactives.indexOf( klass._name )) &&\n                        widgets.push( new klass( me ) );\n                });\n    \n                return _init.apply( me, arguments );\n            },\n    \n            request: function( apiName, args, callback ) {\n                var i = 0,\n                    widgets = this._widgets,\n                    len = widgets && widgets.length,\n                    rlts = [],\n                    dfds = [],\n                    widget, rlt, promise, key;\n    \n                args = isArrayLike( args ) ? args : [ args ];\n    \n                for ( ; i < len; i++ ) {\n                    widget = widgets[ i ];\n                    rlt = widget.invoke( apiName, args );\n    \n                    if ( rlt !== IGNORE ) {\n    \n                        // Deferred对象\n                        if ( Base.isPromise( rlt ) ) {\n                            dfds.push( rlt );\n                        } else {\n                            rlts.push( rlt );\n                        }\n                    }\n                }\n    \n                // 如果有callback，则用异步方式。\n                if ( callback || dfds.length ) {\n                    promise = Base.when.apply( Base, dfds );\n                    key = promise.pipe ? 'pipe' : 'then';\n    \n                    // 很重要不能删除。删除了会死循环。\n                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n                    return promise[ key ](function() {\n                                var deferred = Base.Deferred(),\n                                    args = arguments;\n    \n                                if ( args.length === 1 ) {\n                                    args = args[ 0 ];\n                                }\n    \n                                setTimeout(function() {\n                                    deferred.resolve( args );\n                                }, 1 );\n    \n                                return deferred.promise();\n                            })[ callback ? key : 'done' ]( callback || Base.noop );\n                } else {\n                    return rlts[ 0 ];\n                }\n            },\n    \n            destroy: function() {\n                _destroy.apply( this, arguments );\n                this._widgets = null;\n            }\n        });\n    \n        /**\n         * 添加组件\n         * @grammar Uploader.register(proto);\n         * @grammar Uploader.register(map, proto);\n         * @param  {object} responseMap API 名称与函数实现的映射\n         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n         * @method Uploader.register\n         * @for Uploader\n         * @example\n         * Uploader.register({\n         *     'make-thumb': 'makeThumb'\n         * }, {\n         *     init: function( options ) {},\n         *     makeThumb: function() {}\n         * });\n         *\n         * Uploader.register({\n         *     'make-thumb': function() {\n         *         \n         *     }\n         * });\n         */\n        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n                klass;\n    \n            if ( arguments.length === 1 ) {\n                widgetProto = responseMap;\n    \n                // 自动生成 map 表。\n                $.each(widgetProto, function(key) {\n                    if ( key[0] === '_' || key === 'name' ) {\n                        key === 'name' && (map.name = widgetProto.name);\n                        return;\n                    }\n    \n                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n                });\n    \n            } else {\n                map = $.extend( map, responseMap );\n            }\n    \n            widgetProto.responseMap = map;\n            klass = Base.inherits( Widget, widgetProto );\n            klass._name = map.name;\n            widgetClass.push( klass );\n    \n            return klass;\n        };\n    \n        /**\n         * 删除插件，只有在注册时指定了名字的才能被删除。\n         * @grammar Uploader.unRegister(name);\n         * @param  {string} name 组件名字\n         * @method Uploader.unRegister\n         * @for Uploader\n         * @example\n         *\n         * Uploader.register({\n         *     name: 'custom',\n         *     \n         *     'make-thumb': function() {\n         *         \n         *     }\n         * });\n         *\n         * Uploader.unRegister('custom');\n         */\n        Uploader.unRegister = Widget.unRegister = function( name ) {\n            if ( !name || name === 'anonymous' ) {\n                return;\n            }\n            \n            // 删除指定的插件。\n            for ( var i = widgetClass.length; i--; ) {\n                if ( widgetClass[i]._name === name ) {\n                    widgetClass.splice(i, 1)\n                }\n            }\n        };\n    \n        return Widget;\n    });\n    /**\n     * @fileOverview DragAndDrop Widget。\n     */\n    define('widgets/filednd',[\n        'base',\n        'uploader',\n        'lib/dnd',\n        'widgets/widget'\n    ], function( Base, Uploader, Dnd ) {\n        var $ = Base.$;\n    \n        Uploader.options.dnd = '';\n    \n        /**\n         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n         * @namespace options\n         * @for Uploader\n         */\n        \n        /**\n         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n         * @namespace options\n         * @for Uploader\n         */\n    \n        /**\n         * @event dndAccept\n         * @param {DataTransferItemList} items DataTransferItem\n         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n         * @for  Uploader\n         */\n        return Uploader.register({\n            name: 'dnd',\n            \n            init: function( opts ) {\n    \n                if ( !opts.dnd ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n    \n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        disableGlobalDnd: opts.disableGlobalDnd,\n                        container: opts.dnd,\n                        accept: opts.accept\n                    }),\n                    dnd;\n    \n                this.dnd = dnd = new Dnd( options );\n    \n                dnd.once( 'ready', deferred.resolve );\n                dnd.on( 'drop', function( files ) {\n                    me.request( 'add-file', [ files ]);\n                });\n    \n                // 检测文件是否全部允许添加。\n                dnd.on( 'accept', function( items ) {\n                    return me.owner.trigger( 'dndAccept', items );\n                });\n    \n                dnd.init();\n    \n                return deferred.promise();\n            },\n    \n            destroy: function() {\n                this.dnd && this.dnd.destroy();\n            }\n        });\n    });\n    \n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepaste',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n    \n        var $ = Base.$;\n    \n        function FilePaste( opts ) {\n            opts = this.options = $.extend({}, opts );\n            opts.container = $( opts.container || document.body );\n            RuntimeClent.call( this, 'FilePaste' );\n        }\n    \n        Base.inherits( RuntimeClent, {\n            constructor: FilePaste,\n    \n            init: function() {\n                var me = this;\n    \n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n    \n        Mediator.installTo( FilePaste.prototype );\n    \n        return FilePaste;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/filepaste',[\n        'base',\n        'uploader',\n        'lib/filepaste',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePaste ) {\n        var $ = Base.$;\n    \n        /**\n         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n         * @namespace options\n         * @for Uploader\n         */\n        return Uploader.register({\n            name: 'paste',\n            \n            init: function( opts ) {\n    \n                if ( !opts.paste ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n    \n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        container: opts.paste,\n                        accept: opts.accept\n                    }),\n                    paste;\n    \n                this.paste = paste = new FilePaste( options );\n    \n                paste.once( 'ready', deferred.resolve );\n                paste.on( 'paste', function( files ) {\n                    me.owner.request( 'add-file', [ files ]);\n                });\n                paste.init();\n    \n                return deferred.promise();\n            },\n    \n            destroy: function() {\n                this.paste && this.paste.destroy();\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob\n     */\n    define('lib/blob',[\n        'base',\n        'runtime/client'\n    ], function( Base, RuntimeClient ) {\n    \n        function Blob( ruid, source ) {\n            var me = this;\n    \n            me.source = source;\n            me.ruid = ruid;\n            this.size = source.size || 0;\n    \n            // 如果没有指定 mimetype, 但是知道文件后缀。\n            if ( !source.type && this.ext &&\n                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n            } else {\n                this.type = source.type || 'application/octet-stream';\n            }\n    \n            RuntimeClient.call( me, 'Blob' );\n            this.uid = source.uid || this.uid;\n    \n            if ( ruid ) {\n                me.connectRuntime( ruid );\n            }\n        }\n    \n        Base.inherits( RuntimeClient, {\n            constructor: Blob,\n    \n            slice: function( start, end ) {\n                return this.exec( 'slice', start, end );\n            },\n    \n            getSource: function() {\n                return this.source;\n            }\n        });\n    \n        return Blob;\n    });\n    /**\n     * 为了统一化Flash的File和HTML5的File而存在。\n     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n     * @fileOverview File\n     */\n    define('lib/file',[\n        'base',\n        'lib/blob'\n    ], function( Base, Blob ) {\n    \n        var uid = 1,\n            rExt = /\\.([^.]+)$/;\n    \n        function File( ruid, file ) {\n            var ext;\n    \n            this.name = file.name || ('untitled' + uid++);\n            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n    \n            // todo 支持其他类型文件的转换。\n            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n            if ( !ext && file.type ) {\n                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n                        RegExp.$1.toLowerCase() : '';\n                this.name += '.' + ext;\n            }\n    \n            this.ext = ext;\n            this.lastModifiedDate = file.lastModifiedDate ||\n                    (new Date()).toLocaleString();\n    \n            Blob.apply( this, arguments );\n        }\n    \n        return Base.inherits( Blob, File );\n    });\n    \n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepicker',[\n        'base',\n        'runtime/client',\n        'lib/file'\n    ], function( Base, RuntimeClent, File ) {\n    \n        var $ = Base.$;\n    \n        function FilePicker( opts ) {\n            opts = this.options = $.extend({}, FilePicker.options, opts );\n    \n            opts.container = $( opts.id );\n    \n            if ( !opts.container.length ) {\n                throw new Error('按钮指定错误');\n            }\n    \n            opts.innerHTML = opts.innerHTML || opts.label ||\n                    opts.container.html() || '';\n    \n            opts.button = $( opts.button || document.createElement('div') );\n            opts.button.html( opts.innerHTML );\n            opts.container.html( opts.button );\n    \n            RuntimeClent.call( this, 'FilePicker', true );\n        }\n    \n        FilePicker.options = {\n            button: null,\n            container: null,\n            label: null,\n            innerHTML: null,\n            multiple: true,\n            accept: null,\n            name: 'file'\n        };\n    \n        Base.inherits( RuntimeClent, {\n            constructor: FilePicker,\n    \n            init: function() {\n                var me = this,\n                    opts = me.options,\n                    button = opts.button;\n    \n                button.addClass('webuploader-pick');\n    \n                me.on( 'all', function( type ) {\n                    var files;\n    \n                    switch ( type ) {\n                        case 'mouseenter':\n                            button.addClass('webuploader-pick-hover');\n                            break;\n    \n                        case 'mouseleave':\n                            button.removeClass('webuploader-pick-hover');\n                            break;\n    \n                        case 'change':\n                            files = me.exec('getFiles');\n                            me.trigger( 'select', $.map( files, function( file ) {\n                                file = new File( me.getRuid(), file );\n    \n                                // 记录来源。\n                                file._refer = opts.container;\n                                return file;\n                            }), opts.container );\n                            break;\n                    }\n                });\n    \n                me.connectRuntime( opts, function() {\n                    me.refresh();\n                    me.exec( 'init', opts );\n                    me.trigger('ready');\n                });\n    \n                this._resizeHandler = Base.bindFn( this.refresh, this );\n                $( window ).on( 'resize', this._resizeHandler );\n            },\n    \n            refresh: function() {\n                var shimContainer = this.getRuntime().getContainer(),\n                    button = this.options.button,\n                    width = button.outerWidth ?\n                            button.outerWidth() : button.width(),\n    \n                    height = button.outerHeight ?\n                            button.outerHeight() : button.height(),\n    \n                    pos = button.offset();\n    \n                width && height && shimContainer.css({\n                    bottom: 'auto',\n                    right: 'auto',\n                    width: width + 'px',\n                    height: height + 'px'\n                }).offset( pos );\n            },\n    \n            enable: function() {\n                var btn = this.options.button;\n    \n                btn.removeClass('webuploader-pick-disable');\n                this.refresh();\n            },\n    \n            disable: function() {\n                var btn = this.options.button;\n    \n                this.getRuntime().getContainer().css({\n                    top: '-99999px'\n                });\n    \n                btn.addClass('webuploader-pick-disable');\n            },\n    \n            destroy: function() {\n                var btn = this.options.button;\n                $( window ).off( 'resize', this._resizeHandler );\n                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n                    'webuploader-pick');\n            }\n        });\n    \n        return FilePicker;\n    });\n    \n    /**\n     * @fileOverview 文件选择相关\n     */\n    define('widgets/filepicker',[\n        'base',\n        'uploader',\n        'lib/filepicker',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePicker ) {\n        var $ = Base.$;\n    \n        $.extend( Uploader.options, {\n    \n            /**\n             * @property {Selector | Object} [pick=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n             *\n             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n             * * `label` {String} 请采用 `innerHTML` 代替\n             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n             */\n            pick: null,\n    \n            /**\n             * @property {Arroy} [accept=null]\n             * @namespace options\n             * @for Uploader\n             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n             *\n             * * `title` {String} 文字描述\n             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n             * * `mimeTypes` {String} 多个用逗号分割。\n             *\n             * 如：\n             *\n             * ```\n             * {\n             *     title: 'Images',\n             *     extensions: 'gif,jpg,jpeg,bmp,png',\n             *     mimeTypes: 'image/*'\n             * }\n             * ```\n             */\n            accept: null/*{\n                title: 'Images',\n                extensions: 'gif,jpg,jpeg,bmp,png',\n                mimeTypes: 'image/*'\n            }*/\n        });\n    \n        return Uploader.register({\n            name: 'picker',\n    \n            init: function( opts ) {\n                this.pickers = [];\n                return opts.pick && this.addBtn( opts.pick );\n            },\n    \n            refresh: function() {\n                $.each( this.pickers, function() {\n                    this.refresh();\n                });\n            },\n    \n            /**\n             * @method addButton\n             * @for Uploader\n             * @grammar addButton( pick ) => Promise\n             * @description\n             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n             * @example\n             * uploader.addButton({\n             *     id: '#btnContainer',\n             *     innerHTML: '选择文件'\n             * });\n             */\n            addBtn: function( pick ) {\n                var me = this,\n                    opts = me.options,\n                    accept = opts.accept,\n                    promises = [];\n    \n                if ( !pick ) {\n                    return;\n                }\n    \n                $.isPlainObject( pick ) || (pick = {\n                    id: pick\n                });\n    \n                $( pick.id ).each(function() {\n                    var options, picker, deferred;\n    \n                    deferred = Base.Deferred();\n    \n                    options = $.extend({}, pick, {\n                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n                        swf: opts.swf,\n                        runtimeOrder: opts.runtimeOrder,\n                        id: this\n                    });\n    \n                    picker = new FilePicker( options );\n    \n                    picker.once( 'ready', deferred.resolve );\n                    picker.on( 'select', function( files ) {\n                        me.owner.request( 'add-file', [ files ]);\n                    });\n                    picker.init();\n    \n                    me.pickers.push( picker );\n    \n                    promises.push( deferred.promise() );\n                });\n    \n                return Base.when.apply( Base, promises );\n            },\n    \n            disable: function() {\n                $.each( this.pickers, function() {\n                    this.disable();\n                });\n            },\n    \n            enable: function() {\n                $.each( this.pickers, function() {\n                    this.enable();\n                });\n            },\n    \n            destroy: function() {\n                $.each( this.pickers, function() {\n                    this.destroy();\n                });\n                this.pickers = null;\n            }\n        });\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('lib/image',[\n        'base',\n        'runtime/client',\n        'lib/blob'\n    ], function( Base, RuntimeClient, Blob ) {\n        var $ = Base.$;\n    \n        // 构造器。\n        function Image( opts ) {\n            this.options = $.extend({}, Image.options, opts );\n            RuntimeClient.call( this, 'Image' );\n    \n            this.on( 'load', function() {\n                this._info = this.exec('info');\n                this._meta = this.exec('meta');\n            });\n        }\n    \n        // 默认选项。\n        Image.options = {\n    \n            // 默认的图片处理质量\n            quality: 90,\n    \n            // 是否裁剪\n            crop: false,\n    \n            // 是否保留头部信息\n            preserveHeaders: false,\n    \n            // 是否允许放大。\n            allowMagnify: false\n        };\n    \n        // 继承RuntimeClient.\n        Base.inherits( RuntimeClient, {\n            constructor: Image,\n    \n            info: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n    \n                // getter\n                return this._info;\n            },\n    \n            meta: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n    \n                // getter\n                return this._meta;\n            },\n    \n            loadFromBlob: function( blob ) {\n                var me = this,\n                    ruid = blob.getRuid();\n    \n                this.connectRuntime( ruid, function() {\n                    me.exec( 'init', me.options );\n                    me.exec( 'loadFromBlob', blob );\n                });\n            },\n    \n            resize: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n            },\n    \n            crop: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n            },\n    \n            getAsDataUrl: function( type ) {\n                return this.exec( 'getAsDataUrl', type );\n            },\n    \n            getAsBlob: function( type ) {\n                var blob = this.exec( 'getAsBlob', type );\n    \n                return new Blob( this.getRuid(), blob );\n            }\n        });\n    \n        return Image;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/image',[\n        'base',\n        'uploader',\n        'lib/image',\n        'widgets/widget'\n    ], function( Base, Uploader, Image ) {\n    \n        var $ = Base.$,\n            throttle;\n    \n        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n        throttle = (function( max ) {\n            var occupied = 0,\n                waiting = [],\n                tick = function() {\n                    var item;\n    \n                    while ( waiting.length && occupied < max ) {\n                        item = waiting.shift();\n                        occupied += item[ 0 ];\n                        item[ 1 ]();\n                    }\n                };\n    \n            return function( emiter, size, cb ) {\n                waiting.push([ size, cb ]);\n                emiter.once( 'destroy', function() {\n                    occupied -= size;\n                    setTimeout( tick, 1 );\n                });\n                setTimeout( tick, 1 );\n            };\n        })( 5 * 1024 * 1024 );\n    \n        $.extend( Uploader.options, {\n    \n            /**\n             * @property {Object} [thumb]\n             * @namespace options\n             * @for Uploader\n             * @description 配置生成缩略图的选项。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 110,\n             *     height: 110,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 70,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: true,\n             *\n             *     // 是否允许裁剪。\n             *     crop: true,\n             *\n             *     // 为空的话则保留原有图片格式。\n             *     // 否则强制转换成指定的类型。\n             *     type: 'image/jpeg'\n             * }\n             * ```\n             */\n            thumb: {\n                width: 110,\n                height: 110,\n                quality: 70,\n                allowMagnify: true,\n                crop: true,\n                preserveHeaders: false,\n    \n                // 为空的话则保留原有图片格式。\n                // 否则强制转换成指定的类型。\n                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n                type: 'image/jpeg'\n            },\n    \n            /**\n             * @property {Object} [compress]\n             * @namespace options\n             * @for Uploader\n             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 1600,\n             *     height: 1600,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 90,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: false,\n             *\n             *     // 是否允许裁剪。\n             *     crop: false,\n             *\n             *     // 是否保留头部meta信息。\n             *     preserveHeaders: true,\n             *\n             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n             *     // 此属性可能会影响图片自动纠正功能\n             *     noCompressIfLarger: false,\n             *\n             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n             *     compressSize: 0\n             * }\n             * ```\n             */\n            compress: {\n                width: 1600,\n                height: 1600,\n                quality: 90,\n                allowMagnify: false,\n                crop: false,\n                preserveHeaders: true\n            }\n        });\n    \n        return Uploader.register({\n    \n            name: 'image',\n    \n    \n            /**\n             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n             *\n             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n             *\n             * `callback`中可以接收到两个参数。\n             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n             * * 第二个为ret, 缩略图的Data URL值。\n             *\n             * **注意**\n             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n             *\n             * @method makeThumb\n             * @grammar makeThumb( file, callback ) => undefined\n             * @grammar makeThumb( file, callback, width, height ) => undefined\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.makeThumb( file, function( error, ret ) {\n             *         if ( error ) {\n             *             $li.text('预览错误');\n             *         } else {\n             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n             *         }\n             *     });\n             *\n             * });\n             */\n            makeThumb: function( file, cb, width, height ) {\n                var opts, image;\n                var isArtwork = false;\n                file = this.request( 'get-file', file );\n    \n                // 只预览图片格式。\n                if ( !file.type.match( /^image/ ) ) {\n                    cb( true );\n                    return;\n                }\n    \n                opts = $.extend({}, this.options.thumb );\n                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n                // 如果传入的是object.\n                if ( $.isPlainObject( width ) ) {\n                    opts = $.extend( opts, width );\n                    width = null;\n                }\n    \n                width = width || opts.width;\n                height = height || opts.height;\n    \n                image = new Image( opts );\n    \n                image.once( 'load', function() {\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n    \n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n    \n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n                    if( isArtwork ){\n                        image.resize( file._info.width, file._info.height );\n                        \n                    }else{\n                        image.resize( width, height );\n                        \n                       \n                    }\n\n                });\n    \n                // 当 resize 完后\n                image.once( 'complete', function() {\n                    cb( false, image.getAsDataUrl( opts.type ) );\n                    image.destroy();\n                });\n    \n                image.once( 'error', function( reason ) {\n                    cb( reason || true );\n                    image.destroy();\n                });\n    \n                throttle( image, file.source.size, function() {\n                    file._info && image.info( file._info );\n                    file._meta && image.meta( file._meta );\n                    image.loadFromBlob( file.source );\n                });\n            },\n    \n            beforeSendFile: function( file ) {\n                var opts = this.options.compress || this.options.resize,\n                    compressSize = opts && opts.compressSize || 0,\n                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n                    image, deferred;\n    \n                file = this.request( 'get-file', file );\n    \n                // 只压缩 jpeg 图片格式。\n                // gif 可能会丢失针\n                // bmp png 基本上尺寸都不大，且压缩比比较小。\n                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n                        file.size < compressSize ||\n                        file._compressed ) {\n                    return;\n                }\n    \n                opts = $.extend({}, opts );\n                deferred = Base.Deferred();\n    \n                image = new Image( opts );\n    \n                deferred.always(function() {\n                    image.destroy();\n                    image = null;\n                });\n                image.once( 'error', deferred.reject );\n                image.once( 'load', function() {\n                    var width = opts.width,\n                        height = opts.height;\n    \n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n    \n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n    \n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n    \n                    image.resize( width, height );\n                });\n    \n                image.once( 'complete', function() {\n                    var blob, size;\n    \n                    // 移动端 UC / qq 浏览器的无图模式下\n                    // ctx.getImageData 处理大图的时候会报 Exception\n                    // INDEX_SIZE_ERR: DOM Exception 1\n                    try {\n                        blob = image.getAsBlob( opts.type );\n    \n                        size = file.size;\n    \n                        // 如果压缩后，比原来还大则不用压缩后的。\n                        if ( !noCompressIfLarger || blob.size < size ) {\n                            // file.source.destroy && file.source.destroy();\n                            file.source = blob;\n                            file.size = blob.size;\n    \n                            file.trigger( 'resize', blob.size, size );\n                        }\n    \n                        // 标记，避免重复压缩。\n                        file._compressed = true;\n                        deferred.resolve();\n                    } catch ( e ) {\n                        // 出错了直接继续，让其上传原始图片\n                        deferred.resolve();\n                    }\n                });\n    \n                file._info && image.info( file._info );\n                file._meta && image.meta( file._meta );\n    \n                image.loadFromBlob( file.source );\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview 文件属性封装\n     */\n    define('file',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n    \n        var $ = Base.$,\n            idPrefix = 'WU_FILE_',\n            idSuffix = 0,\n            rExt = /\\.([^.]+)$/,\n            statusMap = {};\n    \n        function gid() {\n            return idPrefix + idSuffix++;\n        }\n    \n        /**\n         * 文件类\n         * @class File\n         * @constructor 构造函数\n         * @grammar new File( source ) => File\n         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n         */\n        function WUFile( source ) {\n    \n            /**\n             * 文件名，包括扩展名（后缀）\n             * @property name\n             * @type {string}\n             */\n            this.name = source.name || 'Untitled';\n    \n            /**\n             * 文件体积（字节）\n             * @property size\n             * @type {uint}\n             * @default 0\n             */\n            this.size = source.size || 0;\n    \n            /**\n             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n             * @property type\n             * @type {string}\n             * @default 'application/octet-stream'\n             */\n            this.type = source.type || 'application/octet-stream';\n    \n            /**\n             * 文件最后修改日期\n             * @property lastModifiedDate\n             * @type {int}\n             * @default 当前时间戳\n             */\n            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n    \n            /**\n             * 文件ID，每个对象具有唯一ID，与文件名无关\n             * @property id\n             * @type {string}\n             */\n            this.id = gid();\n    \n            /**\n             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n             * @property ext\n             * @type {string}\n             */\n            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n    \n    \n            /**\n             * 状态文字说明。在不同的status语境下有不同的用途。\n             * @property statusText\n             * @type {string}\n             */\n            this.statusText = '';\n    \n            // 存储文件状态，防止通过属性直接修改\n            statusMap[ this.id ] = WUFile.Status.INITED;\n    \n            this.source = source;\n            this.loaded = 0;\n    \n            this.on( 'error', function( msg ) {\n                this.setStatus( WUFile.Status.ERROR, msg );\n            });\n        }\n    \n        $.extend( WUFile.prototype, {\n    \n            /**\n             * 设置状态，状态变化时会触发`change`事件。\n             * @method setStatus\n             * @grammar setStatus( status[, statusText] );\n             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n             */\n            setStatus: function( status, text ) {\n    \n                var prevStatus = statusMap[ this.id ];\n    \n                typeof text !== 'undefined' && (this.statusText = text);\n    \n                if ( status !== prevStatus ) {\n                    statusMap[ this.id ] = status;\n                    /**\n                     * 文件状态变化\n                     * @event statuschange\n                     */\n                    this.trigger( 'statuschange', status, prevStatus );\n                }\n    \n            },\n    \n            /**\n             * 获取文件状态\n             * @return {File.Status}\n             * @example\n                     文件状态具体包括以下几种类型：\n                     {\n                         // 初始化\n                        INITED:     0,\n                        // 已入队列\n                        QUEUED:     1,\n                        // 正在上传\n                        PROGRESS:     2,\n                        // 上传出错\n                        ERROR:         3,\n                        // 上传成功\n                        COMPLETE:     4,\n                        // 上传取消\n                        CANCELLED:     5\n                    }\n             */\n            getStatus: function() {\n                return statusMap[ this.id ];\n            },\n    \n            /**\n             * 获取文件原始信息。\n             * @return {*}\n             */\n            getSource: function() {\n                return this.source;\n            },\n    \n            destroy: function() {\n                this.off();\n                delete statusMap[ this.id ];\n            }\n        });\n    \n        Mediator.installTo( WUFile.prototype );\n    \n        /**\n         * 文件状态值，具体包括以下几种类型：\n         * * `inited` 初始状态\n         * * `queued` 已经进入队列, 等待上传\n         * * `progress` 上传中\n         * * `complete` 上传完成。\n         * * `error` 上传出错，可重试\n         * * `interrupt` 上传中断，可续传。\n         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n         * * `cancelled` 文件被移除。\n         * @property {Object} Status\n         * @namespace File\n         * @class File\n         * @static\n         */\n        WUFile.Status = {\n            INITED:     'inited',    // 初始状态\n            QUEUED:     'queued',    // 已经进入队列, 等待上传\n            PROGRESS:   'progress',    // 上传中\n            ERROR:      'error',    // 上传出错，可重试\n            COMPLETE:   'complete',    // 上传完成。\n            CANCELLED:  'cancelled',    // 上传取消。\n            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n        };\n    \n        return WUFile;\n    });\n    \n    /**\n     * @fileOverview 文件队列\n     */\n    define('queue',[\n        'base',\n        'mediator',\n        'file'\n    ], function( Base, Mediator, WUFile ) {\n    \n        var $ = Base.$,\n            STATUS = WUFile.Status;\n    \n        /**\n         * 文件队列, 用来存储各个状态中的文件。\n         * @class Queue\n         * @extends Mediator\n         */\n        function Queue() {\n    \n            /**\n             * 统计文件数。\n             * * `numOfQueue` 队列中的文件数。\n             * * `numOfSuccess` 上传成功的文件数\n             * * `numOfCancel` 被取消的文件数\n             * * `numOfProgress` 正在上传中的文件数\n             * * `numOfUploadFailed` 上传错误的文件数。\n             * * `numOfInvalid` 无效的文件数。\n             * * `numofDeleted` 被移除的文件数。\n             * @property {Object} stats\n             */\n            this.stats = {\n                numOfQueue: 0,\n                numOfSuccess: 0,\n                numOfCancel: 0,\n                numOfProgress: 0,\n                numOfUploadFailed: 0,\n                numOfInvalid: 0,\n                numofDeleted: 0,\n                numofInterrupt: 0\n            };\n    \n            // 上传队列，仅包括等待上传的文件\n            this._queue = [];\n    \n            // 存储所有文件\n            this._map = {};\n        }\n    \n        $.extend( Queue.prototype, {\n    \n            /**\n             * 将新文件加入对队列尾部\n             *\n             * @method append\n             * @param  {File} file   文件对象\n             */\n            append: function( file ) {\n                this._queue.push( file );\n                this._fileAdded( file );\n                return this;\n            },\n    \n            /**\n             * 将新文件加入对队列头部\n             *\n             * @method prepend\n             * @param  {File} file   文件对象\n             */\n            prepend: function( file ) {\n                this._queue.unshift( file );\n                this._fileAdded( file );\n                return this;\n            },\n    \n            /**\n             * 获取文件对象\n             *\n             * @method getFile\n             * @param  {String} fileId   文件ID\n             * @return {File}\n             */\n            getFile: function( fileId ) {\n                if ( typeof fileId !== 'string' ) {\n                    return fileId;\n                }\n                return this._map[ fileId ];\n            },\n    \n            /**\n             * 从队列中取出一个指定状态的文件。\n             * @grammar fetch( status ) => File\n             * @method fetch\n             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n             * @return {File} [File](#WebUploader:File)\n             */\n            fetch: function( status ) {\n                var len = this._queue.length,\n                    i, file;\n    \n                status = status || STATUS.QUEUED;\n    \n                for ( i = 0; i < len; i++ ) {\n                    file = this._queue[ i ];\n    \n                    if ( status === file.getStatus() ) {\n                        return file;\n                    }\n                }\n    \n                return null;\n            },\n    \n            /**\n             * 对队列进行排序，能够控制文件上传顺序。\n             * @grammar sort( fn ) => undefined\n             * @method sort\n             * @param {Function} fn 排序方法\n             */\n            sort: function( fn ) {\n                if ( typeof fn === 'function' ) {\n                    this._queue.sort( fn );\n                }\n            },\n    \n            /**\n             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n             * @method getFiles\n             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n             */\n            getFiles: function() {\n                var sts = [].slice.call( arguments, 0 ),\n                    ret = [],\n                    i = 0,\n                    len = this._queue.length,\n                    file;\n    \n                for ( ; i < len; i++ ) {\n                    file = this._queue[ i ];\n    \n                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n                        continue;\n                    }\n    \n                    ret.push( file );\n                }\n    \n                return ret;\n            },\n    \n            /**\n             * 在队列中删除文件。\n             * @grammar removeFile( file ) => Array\n             * @method removeFile\n             * @param {File} 文件对象。\n             */\n            removeFile: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n    \n                if ( existing ) {\n                    delete this._map[ file.id ];\n                    file.destroy();\n                    this.stats.numofDeleted++;\n                }\n            },\n    \n            _fileAdded: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n    \n                if ( !existing ) {\n                    this._map[ file.id ] = file;\n    \n                    file.on( 'statuschange', function( cur, pre ) {\n                        me._onFileStatusChange( cur, pre );\n                    });\n                }\n            },\n    \n            _onFileStatusChange: function( curStatus, preStatus ) {\n                var stats = this.stats;\n    \n                switch ( preStatus ) {\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress--;\n                        break;\n    \n                    case STATUS.QUEUED:\n                        stats.numOfQueue --;\n                        break;\n    \n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed--;\n                        break;\n    \n                    case STATUS.INVALID:\n                        stats.numOfInvalid--;\n                        break;\n    \n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt--;\n                        break;\n                }\n    \n                switch ( curStatus ) {\n                    case STATUS.QUEUED:\n                        stats.numOfQueue++;\n                        break;\n    \n                    case STATUS.PROGRESS:\n                        stats.numOfProgress++;\n                        break;\n    \n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed++;\n                        break;\n    \n                    case STATUS.COMPLETE:\n                        stats.numOfSuccess++;\n                        break;\n    \n                    case STATUS.CANCELLED:\n                        stats.numOfCancel++;\n                        break;\n    \n    \n                    case STATUS.INVALID:\n                        stats.numOfInvalid++;\n                        break;\n    \n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt++;\n                        break;\n                }\n            }\n    \n        });\n    \n        Mediator.installTo( Queue.prototype );\n    \n        return Queue;\n    });\n    /**\n     * @fileOverview 队列\n     */\n    define('widgets/queue',[\n        'base',\n        'uploader',\n        'queue',\n        'file',\n        'lib/file',\n        'runtime/client',\n        'widgets/widget'\n    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n    \n        var $ = Base.$,\n            rExt = /\\.\\w+$/,\n            Status = WUFile.Status;\n    \n        return Uploader.register({\n            name: 'queue',\n    \n            init: function( opts ) {\n                var me = this,\n                    deferred, len, i, item, arr, accept, runtime;\n    \n                if ( $.isPlainObject( opts.accept ) ) {\n                    opts.accept = [ opts.accept ];\n                }\n    \n                // accept中的中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n    \n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].extensions;\n                        item && arr.push( item );\n                    }\n    \n                    if ( arr.length ) {\n                        accept = '\\\\.' + arr.join(',')\n                                .replace( /,/g, '$|\\\\.' )\n                                .replace( /\\*/g, '.*' ) + '$';\n                    }\n    \n                    me.accept = new RegExp( accept, 'i' );\n                }\n    \n                me.queue = new Queue();\n                me.stats = me.queue.stats;\n    \n                // 如果当前不是html5运行时，那就算了。\n                // 不执行后续操作\n                if ( this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n    \n                // 创建一个 html5 运行时的 placeholder\n                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n                deferred = Base.Deferred();\n                this.placeholder = runtime = new RuntimeClient('Placeholder');\n                runtime.connectRuntime({\n                    runtimeOrder: 'html5'\n                }, function() {\n                    me._ruid = runtime.getRuid();\n                    deferred.resolve();\n                });\n                return deferred.promise();\n            },\n    \n    \n            // 为了支持外部直接添加一个原生File对象。\n            _wrapFile: function( file ) {\n                if ( !(file instanceof WUFile) ) {\n    \n                    if ( !(file instanceof File) ) {\n                        if ( !this._ruid ) {\n                            throw new Error('Can\\'t add external files.');\n                        }\n                        file = new File( this._ruid, file );\n                    }\n    \n                    file = new WUFile( file );\n                }\n    \n                return file;\n            },\n    \n            // 判断文件是否可以被加入队列\n            acceptFile: function( file ) {\n                 var invalid = !file || !file.size || this.accept &&\n    \n                        // 如果名字中有后缀，才做后缀白名单处理。\n                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n                return !invalid;\n            },\n    \n    \n            /**\n             * @event beforeFileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event fileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列以后触发。\n             * @for  Uploader\n             */\n    \n            _addFile: function( file ) {\n                var me = this;\n    \n                file = me._wrapFile( file );\n    \n                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n                    return;\n                }\n    \n                // 类型不匹配，则派送错误事件，并返回。\n                if ( !me.acceptFile( file ) ) {\n                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n                    return;\n                }\n    \n                me.queue.append( file );\n                me.owner.trigger( 'fileQueued', file );\n                return file;\n            },\n    \n            getFile: function( fileId ) {\n                return this.queue.getFile( fileId );\n            },\n    \n            /**\n             * @event filesQueued\n             * @param {File} files 数组，内容为原始File(lib/File）对象。\n             * @description 当一批文件添加进队列以后触发。\n             * @for  Uploader\n             */\n            \n            /**\n             * @property {Boolean} [auto=false]\n             * @namespace options\n             * @for Uploader\n             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n             * \n             */\n    \n            /**\n             * @method addFiles\n             * @grammar addFiles( file ) => undefined\n             * @grammar addFiles( [file1, file2 ...] ) => undefined\n             * @param {Array of File or File} [files] Files 对象 数组\n             * @description 添加文件到队列\n             * @for  Uploader\n             */\n            addFile: function( files ) {\n                var me = this;\n    \n                if ( !files.length ) {\n                    files = [ files ];\n                }\n    \n                files = $.map( files, function( file ) {\n                    return me._addFile( file );\n                });\n    \n                me.owner.trigger( 'filesQueued', files );\n    \n                if ( me.options.auto ) {\n                    setTimeout(function() {\n                        me.request('start-upload');\n                    }, 20 );\n                }\n            },\n    \n            getStats: function() {\n                return this.stats;\n            },\n    \n            /**\n             * @event fileDequeued\n             * @param {File} file File对象\n             * @description 当文件被移除队列后触发。\n             * @for  Uploader\n             */\n    \n             /**\n             * @method removeFile\n             * @grammar removeFile( file ) => undefined\n             * @grammar removeFile( id ) => undefined\n             * @grammar removeFile( file, true ) => undefined\n             * @grammar removeFile( id, true ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.removeFile( file );\n             * })\n             */\n            removeFile: function( file, remove ) {\n                var me = this;\n    \n                file = file.id ? file : me.queue.getFile( file );\n    \n                this.request( 'cancel-file', file );\n    \n                if ( remove ) {\n                    this.queue.removeFile( file );\n                }\n            },\n    \n            /**\n             * @method getFiles\n             * @grammar getFiles() => Array\n             * @grammar getFiles( status1, status2, status... ) => Array\n             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n             * @for  Uploader\n             * @example\n             * console.log( uploader.getFiles() );    // => all files\n             * console.log( uploader.getFiles('error') )    // => all error files.\n             */\n            getFiles: function() {\n                return this.queue.getFiles.apply( this.queue, arguments );\n            },\n    \n            fetchFile: function() {\n                return this.queue.fetch.apply( this.queue, arguments );\n            },\n    \n            /**\n             * @method retry\n             * @grammar retry() => undefined\n             * @grammar retry( file ) => undefined\n             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n             * @for  Uploader\n             * @example\n             * function retry() {\n             *     uploader.retry();\n             * }\n             */\n            retry: function( file, noForceStart ) {\n                var me = this,\n                    files, i, len;\n    \n                if ( file ) {\n                    file = file.id ? file : me.queue.getFile( file );\n                    file.setStatus( Status.QUEUED );\n                    noForceStart || me.request('start-upload');\n                    return;\n                }\n    \n                files = me.queue.getFiles( Status.ERROR );\n                i = 0;\n                len = files.length;\n    \n                for ( ; i < len; i++ ) {\n                    file = files[ i ];\n                    file.setStatus( Status.QUEUED );\n                }\n    \n                me.request('start-upload');\n            },\n    \n            /**\n             * @method sort\n             * @grammar sort( fn ) => undefined\n             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n             * @for  Uploader\n             */\n            sortFiles: function() {\n                return this.queue.sort.apply( this.queue, arguments );\n            },\n    \n            /**\n             * @event reset\n             * @description 当 uploader 被重置的时候触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * @method reset\n             * @grammar reset() => undefined\n             * @description 重置uploader。目前只重置了队列。\n             * @for  Uploader\n             * @example\n             * uploader.reset();\n             */\n            reset: function() {\n                this.owner.trigger('reset');\n                this.queue = new Queue();\n                this.stats = this.queue.stats;\n            },\n    \n            destroy: function() {\n                this.reset();\n                this.placeholder && this.placeholder.destroy();\n            }\n        });\n    \n    });\n    /**\n     * @fileOverview 添加获取Runtime相关信息的方法。\n     */\n    define('widgets/runtime',[\n        'uploader',\n        'runtime/runtime',\n        'widgets/widget'\n    ], function( Uploader, Runtime ) {\n    \n        Uploader.support = function() {\n            return Runtime.hasRuntime.apply( Runtime, arguments );\n        };\n    \n        /**\n         * @property {Object} [runtimeOrder=html5,flash]\n         * @namespace options\n         * @for Uploader\n         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n         *\n         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n         */\n    \n        return Uploader.register({\n            name: 'runtime',\n    \n            init: function() {\n                if ( !this.predictRuntimeType() ) {\n                    throw Error('Runtime Error');\n                }\n            },\n    \n            /**\n             * 预测Uploader将采用哪个`Runtime`\n             * @grammar predictRuntimeType() => String\n             * @method predictRuntimeType\n             * @for  Uploader\n             */\n            predictRuntimeType: function() {\n                var orders = this.options.runtimeOrder || Runtime.orders,\n                    type = this.type,\n                    i, len;\n    \n                if ( !type ) {\n                    orders = orders.split( /\\s*,\\s*/g );\n    \n                    for ( i = 0, len = orders.length; i < len; i++ ) {\n                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n                            this.type = type = orders[ i ];\n                            break;\n                        }\n                    }\n                }\n    \n                return type;\n            }\n        });\n    });\n    /**\n     * @fileOverview Transport\n     */\n    define('lib/transport',[\n        'base',\n        'runtime/client',\n        'mediator'\n    ], function( Base, RuntimeClient, Mediator ) {\n    \n        var $ = Base.$;\n    \n        function Transport( opts ) {\n            var me = this;\n    \n            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n            RuntimeClient.call( this, 'Transport' );\n    \n            this._blob = null;\n            this._formData = opts.formData || {};\n            this._headers = opts.headers || {};\n    \n            this.on( 'progress', this._timeout );\n            this.on( 'load error', function() {\n                me.trigger( 'progress', 1 );\n                clearTimeout( me._timer );\n            });\n        }\n    \n        Transport.options = {\n            server: '',\n            method: 'POST',\n    \n            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n            withCredentials: false,\n            fileVal: 'file',\n            timeout: 2 * 60 * 1000,    // 2分钟\n            formData: {},\n            headers: {},\n            sendAsBinary: false\n        };\n    \n        $.extend( Transport.prototype, {\n    \n            // 添加Blob, 只能添加一次，最后一次有效。\n            appendBlob: function( key, blob, filename ) {\n                var me = this,\n                    opts = me.options;\n    \n                if ( me.getRuid() ) {\n                    me.disconnectRuntime();\n                }\n    \n                // 连接到blob归属的同一个runtime.\n                me.connectRuntime( blob.ruid, function() {\n                    me.exec('init');\n                });\n    \n                me._blob = blob;\n                opts.fileVal = key || opts.fileVal;\n                opts.filename = filename || opts.filename;\n\n            },\n    \n            // 添加其他字段\n            append: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._formData, key );\n                } else {\n                    this._formData[ key ] = value;\n                }\n            },\n    \n            setRequestHeader: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._headers, key );\n                } else {\n                    this._headers[ key ] = value;\n                }\n            },\n    \n            send: function( method ) {\n                this.exec( 'send', method );\n                this._timeout();\n            },\n    \n            abort: function() {\n                clearTimeout( this._timer );\n                return this.exec('abort');\n            },\n    \n            destroy: function() {\n                this.trigger('destroy');\n                this.off();\n                this.exec('destroy');\n                this.disconnectRuntime();\n            },\n    \n            getResponse: function() {\n                return this.exec('getResponse');\n            },\n    \n            getResponseAsJson: function() {\n                return this.exec('getResponseAsJson');\n            },\n    \n            getStatus: function() {\n                return this.exec('getStatus');\n            },\n    \n            _timeout: function() {\n                var me = this,\n                    duration = me.options.timeout;\n    \n                if ( !duration ) {\n                    return;\n                }\n    \n                clearTimeout( me._timer );\n                me._timer = setTimeout(function() {\n                    me.abort();\n                    me.trigger( 'error', 'timeout' );\n                }, duration );\n            }\n    \n        });\n    \n        // 让Transport具备事件功能。\n        Mediator.installTo( Transport.prototype );\n    \n        return Transport;\n    });\n    /**\n     * @fileOverview 负责文件上传相关。\n     */\n    define('widgets/upload',[\n        'base',\n        'uploader',\n        'file',\n        'lib/transport',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile, Transport ) {\n    \n        var $ = Base.$,\n            isPromise = Base.isPromise,\n            Status = WUFile.Status;\n    \n        // 添加默认配置项\n        $.extend( Uploader.options, {\n    \n    \n            /**\n             * @property {Boolean} [prepareNextFile=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否允许在文件传输时提前把下一个文件准备好。\n             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n             */\n            prepareNextFile: false,\n    \n            /**\n             * @property {Boolean} [chunked=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否要分片处理大文件上传。\n             */\n            chunked: false,\n    \n            /**\n             * @property {Boolean} [chunkSize=5242880]\n             * @namespace options\n             * @for Uploader\n             * @description 如果要分片，分多大一片？ 默认大小为5M.\n             */\n            chunkSize: 5 * 1024 * 1024,\n    \n            /**\n             * @property {Boolean} [chunkRetry=2]\n             * @namespace options\n             * @for Uploader\n             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n             */\n            chunkRetry: 2,\n    \n            /**\n             * @property {Boolean} [threads=3]\n             * @namespace options\n             * @for Uploader\n             * @description 上传并发数。允许同时最大上传进程数。\n             */\n            threads: 3,\n    \n    \n            /**\n             * @property {Object} [formData={}]\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n             */\n            formData: {}\n    \n            /**\n             * @property {Object} [fileVal='file']\n             * @namespace options\n             * @for Uploader\n             * @description 设置文件上传域的name。\n             */\n    \n            /**\n             * @property {Object} [method='POST']\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传方式，`POST`或者`GET`。\n             */\n    \n            /**\n             * @property {Object} [sendAsBinary=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n             * 其他参数在$_GET数组中。\n             */\n        });\n    \n        // 负责将文件切片。\n        function CuteFile( file, chunkSize ) {\n            var pending = [],\n                blob = file.source,\n                total = blob.size,\n                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n                start = 0,\n                index = 0,\n                len, api;\n    \n            api = {\n                file: file,\n    \n                has: function() {\n                    return !!pending.length;\n                },\n    \n                shift: function() {\n                    return pending.shift();\n                },\n    \n                unshift: function( block ) {\n                    pending.unshift( block );\n                }\n            };\n    \n            while ( index < chunks ) {\n                len = Math.min( chunkSize, total - start );\n    \n                pending.push({\n                    file: file,\n                    start: start,\n                    end: chunkSize ? (start + len) : total,\n                    total: total,\n                    chunks: chunks,\n                    chunk: index++,\n                    cuted: api\n                });\n                start += len;\n            }\n    \n            file.blocks = pending.concat();\n            file.remaning = pending.length;\n    \n            return api;\n        }\n    \n        Uploader.register({\n            name: 'upload',\n    \n            init: function() {\n                var owner = this.owner,\n                    me = this;\n    \n                this.runing = false;\n                this.progress = false;\n    \n                owner\n                    .on( 'startUpload', function() {\n                        me.progress = true;\n                    })\n                    .on( 'uploadFinished', function() {\n                        me.progress = false;\n                    });\n    \n                // 记录当前正在传的数据，跟threads相关\n                this.pool = [];\n    \n                // 缓存分好片的文件。\n                this.stack = [];\n    \n                // 缓存即将上传的文件。\n                this.pending = [];\n    \n                // 跟踪还有多少分片在上传中但是没有完成上传。\n                this.remaning = 0;\n                this.__tick = Base.bindFn( this._tick, this );\n    \n                owner.on( 'uploadComplete', function( file ) {\n    \n                    // 把其他块取消了。\n                    file.blocks && $.each( file.blocks, function( _, v ) {\n                        v.transport && (v.transport.abort(), v.transport.destroy());\n                        delete v.transport;\n                    });\n    \n                    delete file.blocks;\n                    delete file.remaning;\n                });\n            },\n    \n            reset: function() {\n                this.request( 'stop-upload', true );\n                this.runing = false;\n                this.pool = [];\n                this.stack = [];\n                this.pending = [];\n                this.remaning = 0;\n                this._trigged = false;\n                this._promise = null;\n            },\n    \n            /**\n             * @event startUpload\n             * @description 当开始上传流程时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n             *\n             * 可以指定开始某一个文件。\n             * @grammar upload() => undefined\n             * @grammar upload( file | fileId) => undefined\n             * @method upload\n             * @for  Uploader\n             */\n            startUpload: function(file) {\n                var me = this;\n    \n                // 移出invalid的文件\n                $.each( me.request( 'get-files', Status.INVALID ), function() {\n                    me.request( 'remove-file', this );\n                });\n    \n                // 如果指定了开始某个文件，则只开始指定文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n    \n                    if (file.getStatus() === Status.INTERRUPT) {\n                        $.each( me.pool, function( _, v ) {\n    \n                            // 之前暂停过。\n                            if (v.file !== file) {\n                                return;\n                            }\n    \n                            v.transport && v.transport.send();\n                        });\n    \n                        file.setStatus( Status.QUEUED );\n                    } else if (file.getStatus() === Status.PROGRESS) {\n                        return;\n                    } else {\n                        file.setStatus( Status.QUEUED );\n                    }\n                } else {\n                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n                        this.setStatus( Status.QUEUED );\n                    });\n                }\n    \n                if ( me.runing ) {\n                    return;\n                }\n    \n                me.runing = true;\n    \n                var files = [];\n    \n                // 如果有暂停的，则续传\n                $.each( me.pool, function( _, v ) {\n                    var file = v.file;\n    \n                    if ( file.getStatus() === Status.INTERRUPT ) {\n                        files.push(file);\n                        me._trigged = false;\n                        v.transport && v.transport.send();\n                    }\n                });\n    \n                var file;\n                while ( (file = files.shift()) ) {\n                    file.setStatus( Status.PROGRESS );\n                }\n    \n                file || $.each( me.request( 'get-files',\n                        Status.INTERRUPT ), function() {\n                    this.setStatus( Status.PROGRESS );\n                });\n    \n                me._trigged = false;\n                Base.nextTick( me.__tick );\n                me.owner.trigger('startUpload');\n            },\n    \n            /**\n             * @event stopUpload\n             * @description 当开始上传流程暂停时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n             *\n             * 如果第一个参数是文件，则只暂停指定文件。\n             * @grammar stop() => undefined\n             * @grammar stop( true ) => undefined\n             * @grammar stop( file ) => undefined\n             * @method stop\n             * @for  Uploader\n             */\n            stopUpload: function( file, interrupt ) {\n                var me = this;\n    \n                if (file === true) {\n                    interrupt = file;\n                    file = null;\n                }\n    \n                if ( me.runing === false ) {\n                    return;\n                }\n    \n                // 如果只是暂停某个文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n    \n                    if ( file.getStatus() !== Status.PROGRESS &&\n                            file.getStatus() !== Status.QUEUED ) {\n                        return;\n                    }\n    \n                    file.setStatus( Status.INTERRUPT );\n                    $.each( me.pool, function( _, v ) {\n    \n                        // 只 abort 指定的文件。\n                        if (v.file !== file) {\n                            return;\n                        }\n    \n                        v.transport && v.transport.abort();\n                        me._putback(v);\n                        me._popBlock(v);\n                    });\n    \n                    return Base.nextTick( me.__tick );\n                }\n    \n                me.runing = false;\n    \n                if (this._promise && this._promise.file) {\n                    this._promise.file.setStatus( Status.INTERRUPT );\n                }\n    \n                interrupt && $.each( me.pool, function( _, v ) {\n                    v.transport && v.transport.abort();\n                    v.file.setStatus( Status.INTERRUPT );\n                });\n    \n                me.owner.trigger('stopUpload');\n            },\n    \n            /**\n             * @method cancelFile\n             * @grammar cancelFile( file ) => undefined\n             * @grammar cancelFile( id ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 标记文件状态为已取消, 同时将中断文件传输。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.cancelFile( file );\n             * })\n             */\n            cancelFile: function( file ) {\n                file = file.id ? file : this.request( 'get-file', file );\n    \n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n    \n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n    \n                file.setStatus( Status.CANCELLED );\n                this.owner.trigger( 'fileDequeued', file );\n            },\n    \n            /**\n             * 判断`Uplaode`r是否正在上传中。\n             * @grammar isInProgress() => Boolean\n             * @method isInProgress\n             * @for  Uploader\n             */\n            isInProgress: function() {\n                return !!this.progress;\n            },\n    \n            _getStats: function() {\n                return this.request('get-stats');\n            },\n    \n            /**\n             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n             * @grammar skipFile( file ) => undefined\n             * @method skipFile\n             * @for  Uploader\n             */\n            skipFile: function( file, status ) {\n                file = file.id ? file : this.request( 'get-file', file );\n    \n                file.setStatus( status || Status.COMPLETE );\n                file.skipped = true;\n    \n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n    \n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n    \n                this.owner.trigger( 'uploadSkip', file );\n            },\n    \n            /**\n             * @event uploadFinished\n             * @description 当所有文件上传结束时触发。\n             * @for  Uploader\n             */\n            _tick: function() {\n                var me = this,\n                    opts = me.options,\n                    fn, val;\n    \n                // 上一个promise还没有结束，则等待完成后再执行。\n                if ( me._promise ) {\n                    return me._promise.always( me.__tick );\n                }\n    \n                // 还有位置，且还有文件要处理的话。\n                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n                    me._trigged = false;\n    \n                    fn = function( val ) {\n                        me._promise = null;\n    \n                        // 有可能是reject过来的，所以要检测val的类型。\n                        val && val.file && me._startSend( val );\n                        Base.nextTick( me.__tick );\n                    };\n    \n                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n    \n                // 没有要上传的了，且没有正在传输的了。\n                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n                    !me._getStats().numofInterrupt ) {\n                    me.runing = false;\n    \n                    me._trigged || Base.nextTick(function() {\n                        me.owner.trigger('uploadFinished');\n                    });\n                    me._trigged = true;\n                }\n            },\n    \n            _putback: function(block) {\n                var idx;\n    \n                block.cuted.unshift(block);\n                idx = this.stack.indexOf(block.cuted);\n    \n                if (!~idx) {\n                    this.stack.unshift(block.cuted);\n                }\n            },\n    \n            _getStack: function() {\n                var i = 0,\n                    act;\n    \n                while ( (act = this.stack[ i++ ]) ) {\n                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n                        return act;\n                    } else if (!act.has() ||\n                            act.file.getStatus() !== Status.PROGRESS &&\n                            act.file.getStatus() !== Status.INTERRUPT ) {\n    \n                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n                        // interupt（暂停中） 的移除。\n                        this.stack.splice( --i, 1 );\n                    }\n                }\n    \n                return null;\n            },\n    \n            _nextBlock: function() {\n                var me = this,\n                    opts = me.options,\n                    act, next, done, preparing;\n    \n                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n                if ( (act = this._getStack()) ) {\n    \n                    // 是否提前准备下一个文件\n                    if ( opts.prepareNextFile && !me.pending.length ) {\n                        me._prepareNextFile();\n                    }\n    \n                    return act.shift();\n    \n                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n                } else if ( me.runing ) {\n    \n                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n                        me._prepareNextFile();\n                    }\n    \n                    next = me.pending.shift();\n                    done = function( file ) {\n                        if ( !file ) {\n                            return null;\n                        }\n    \n                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n                        me.stack.push(act);\n                        return act.shift();\n                    };\n    \n                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n                    if ( isPromise( next) ) {\n                        preparing = next.file;\n                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n                        next.file = preparing;\n                        return next;\n                    }\n    \n                    return done( next );\n                }\n            },\n    \n    \n            /**\n             * @event uploadStart\n             * @param {File} file File对象\n             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n             * @for  Uploader\n             */\n            _prepareNextFile: function() {\n                var me = this,\n                    file = me.request('fetch-file'),\n                    pending = me.pending,\n                    promise;\n    \n                if ( file ) {\n                    promise = me.request( 'before-send-file', file, function() {\n    \n                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n                        if ( file.getStatus() === Status.PROGRESS ||\n                            file.getStatus() === Status.INTERRUPT ) {\n                            return file;\n                        }\n    \n                        return me._finishFile( file );\n                    });\n    \n                    me.owner.trigger( 'uploadStart', file );\n                    file.setStatus( Status.PROGRESS );\n    \n                    promise.file = file;\n    \n                    // 如果还在pending中，则替换成文件本身。\n                    promise.done(function() {\n                        var idx = $.inArray( promise, pending );\n    \n                        ~idx && pending.splice( idx, 1, file );\n                    });\n    \n                    // befeore-send-file的钩子就有错误发生。\n                    promise.fail(function( reason ) {\n                        file.setStatus( Status.ERROR, reason );\n                        me.owner.trigger( 'uploadError', file, reason );\n                        me.owner.trigger( 'uploadComplete', file );\n                    });\n    \n                    pending.push( promise );\n                }\n            },\n    \n            // 让出位置了，可以让其他分片开始上传\n            _popBlock: function( block ) {\n                var idx = $.inArray( block, this.pool );\n    \n                this.pool.splice( idx, 1 );\n                block.file.remaning--;\n                this.remaning--;\n            },\n    \n            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n            _startSend: function( block ) {\n                var me = this,\n                    file = block.file,\n                    promise;\n    \n                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n                // 如：暂停，取消\n                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n                if ( file.getStatus() !== Status.PROGRESS ) {\n    \n                    // 如果是中断，则还需要放回去。\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        me._putback(block);\n                    }\n    \n                    return;\n                }\n    \n                me.pool.push( block );\n                me.remaning++;\n    \n                // 如果没有分片，则直接使用原始的。\n                // 不会丢失content-type信息。\n                block.blob = block.chunks === 1 ? file.source :\n                        file.source.slice( block.start, block.end );\n    \n                // hook, 每个分片发送之前可能要做些异步的事情。\n                promise = me.request( 'before-send', block, function() {\n    \n                    // 有可能文件已经上传出错了，所以不需要再传输了。\n                    if ( file.getStatus() === Status.PROGRESS ) {\n                        me._doSend( block );\n                    } else {\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n    \n                // 如果为fail了，则跳过此分片。\n                promise.fail(function() {\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file ).always(function() {\n                            block.percentage = 1;\n                            me._popBlock( block );\n                            me.owner.trigger( 'uploadComplete', file );\n                            Base.nextTick( me.__tick );\n                        });\n                    } else {\n                        block.percentage = 1;\n                        me.updateFileProgress( file );\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n            },\n    \n    \n            /**\n             * @event uploadBeforeSend\n             * @param {Object} object\n             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n             * @param {Object} headers 可以扩展此对象来控制上传头部。\n             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadAccept\n             * @param {Object} object\n             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadProgress\n             * @param {File} file File对象\n             * @param {Number} percentage 上传进度\n             * @description 上传过程中触发，携带上传进度。\n             * @for  Uploader\n             */\n    \n    \n            /**\n             * @event uploadError\n             * @param {File} file File对象\n             * @param {String} reason 出错的code\n             * @description 当文件上传出错时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadSuccess\n             * @param {File} file File对象\n             * @param {Object} response 服务端返回的数据\n             * @description 当文件上传成功时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadComplete\n             * @param {File} [file] File对象\n             * @description 不管成功或者失败，文件上传完成时触发。\n             * @for  Uploader\n             */\n    \n            // 做上传操作。\n            _doSend: function( block ) {\n                var me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    file = block.file,\n                    tr = new Transport( opts ),\n                    data = $.extend({}, opts.formData ),\n                    headers = $.extend({}, opts.headers ),\n                    requestAccept, ret;\n    \n                block.transport = tr;\n    \n                tr.on( 'destroy', function() {\n                    delete block.transport;\n                    me._popBlock( block );\n                    Base.nextTick( me.__tick );\n                });\n    \n                // 广播上传进度。以文件为单位。\n                tr.on( 'progress', function( percentage ) {\n                    block.percentage = percentage;\n                    me.updateFileProgress( file );\n                });\n    \n                // 用来询问，是否返回的结果是有错误的。\n                requestAccept = function( reject ) {\n                    var fn;\n    \n                    ret = tr.getResponseAsJson() || {};\n                    ret._raw = tr.getResponse();\n                    fn = function( value ) {\n                        reject = value;\n                    };\n    \n                    // 服务端响应了，不代表成功了，询问是否响应正确。\n                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n                        reject = reject || 'server';\n                    }\n    \n                    return reject;\n                };\n    \n                // 尝试重试，然后广播文件上传出错。\n                tr.on( 'error', function( type, flag ) {\n                    block.retried = block.retried || 0;\n    \n                    // 自动重试\n                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n                            block.retried < opts.chunkRetry ) {\n    \n                        block.retried++;\n                        tr.send();\n    \n                    } else {\n    \n                        // http status 500 ~ 600\n                        if ( !flag && type === 'server' ) {\n                            type = requestAccept( type );\n                        }\n    \n                        file.setStatus( Status.ERROR, type );\n                        owner.trigger( 'uploadError', file, type );\n                        owner.trigger( 'uploadComplete', file );\n                    }\n                });\n    \n                // 上传成功\n                tr.on( 'load', function() {\n                    var reason;\n    \n                    // 如果非预期，转向上传出错。\n                    if ( (reason = requestAccept()) ) {\n                        tr.trigger( 'error', reason, true );\n                        return;\n                    }\n    \n                    // 全部上传完成。\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file, ret );\n                    } else {\n                        tr.destroy();\n                    }\n                });\n    \n                // 配置默认的上传字段。\n                data = $.extend( data, {\n                    id: file.id,\n                    name: file.name,\n                    type: file.type,\n                    lastModifiedDate: file.lastModifiedDate,\n                    size: file.size\n                });\n    \n                block.chunks > 1 && $.extend( data, {\n                    chunks: block.chunks,\n                    chunk: block.chunk\n                });\n    \n                // 在发送之间可以添加字段什么的。。。\n                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n                owner.trigger( 'uploadBeforeSend', block, data, headers );\n    \n                // 开始发送。\n                tr.appendBlob( opts.fileVal, block.blob, file.name );\n                tr.append( data );\n                tr.setRequestHeader( headers );\n                tr.send();\n            },\n    \n            // 完成上传。\n            _finishFile: function( file, ret, hds ) {\n                var owner = this.owner;\n    \n                return owner\n                        .request( 'after-send-file', arguments, function() {\n                            file.setStatus( Status.COMPLETE );\n                            owner.trigger( 'uploadSuccess', file, ret, hds );\n                        })\n                        .fail(function( reason ) {\n    \n                            // 如果外部已经标记为invalid什么的，不再改状态。\n                            if ( file.getStatus() === Status.PROGRESS ) {\n                                file.setStatus( Status.ERROR, reason );\n                            }\n    \n                            owner.trigger( 'uploadError', file, reason );\n                        })\n                        .always(function() {\n                            owner.trigger( 'uploadComplete', file );\n                        });\n            },\n    \n            updateFileProgress: function(file) {\n                var totalPercent = 0,\n                    uploaded = 0;\n    \n                if (!file.blocks) {\n                    return;\n                }\n    \n                $.each( file.blocks, function( _, v ) {\n                    uploaded += (v.percentage || 0) * (v.end - v.start);\n                });\n    \n                totalPercent = uploaded / file.size;\n                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n            }\n    \n        });\n    });\n    /**\n     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n     */\n    \n    define('widgets/validator',[\n        'base',\n        'uploader',\n        'file',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile ) {\n    \n        var $ = Base.$,\n            validators = {},\n            api;\n    \n        /**\n         * @event error\n         * @param {String} type 错误类型。\n         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n         *\n         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n         * @for  Uploader\n         */\n    \n        // 暴露给外面的api\n        api = {\n    \n            // 添加验证器\n            addValidator: function( type, cb ) {\n                validators[ type ] = cb;\n            },\n    \n            // 移除验证器\n            removeValidator: function( type ) {\n                delete validators[ type ];\n            }\n        };\n    \n        // 在Uploader初始化的时候启动Validators的初始化\n        Uploader.register({\n            name: 'validator',\n    \n            init: function() {\n                var me = this;\n                Base.nextTick(function() {\n                    $.each( validators, function() {\n                        this.call( me.owner );\n                    });\n                });\n            }\n        });\n    \n        /**\n         * @property {int} [fileNumLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总数量, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileNumLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileNumLimit, 10 ),\n                flag = true;\n    \n            if ( !max ) {\n                return;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n    \n                if ( count >= max && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n    \n                return count >= max ? false : true;\n            });\n    \n            uploader.on( 'fileQueued', function() {\n                count++;\n            });\n    \n            uploader.on( 'fileDequeued', function() {\n                count--;\n            });\n    \n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n    \n    \n        /**\n         * @property {int} [fileSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileSizeLimit, 10 ),\n                flag = true;\n    \n            if ( !max ) {\n                return;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n                var invalid = count + file.size > max;\n    \n                if ( invalid && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n    \n                return invalid ? false : true;\n            });\n    \n            uploader.on( 'fileQueued', function( file ) {\n                count += file.size;\n            });\n    \n            uploader.on( 'fileDequeued', function( file ) {\n                count -= file.size;\n            });\n    \n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n    \n        /**\n         * @property {int} [fileSingleSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSingleSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                max = opts.fileSingleSizeLimit;\n    \n            if ( !max ) {\n                return;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n    \n                if ( file.size > max ) {\n                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n                    return false;\n                }\n    \n            });\n    \n        });\n    \n        /**\n         * @property {Boolean} [duplicate=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n         */\n        api.addValidator( 'duplicate', function() {\n            var uploader = this,\n                opts = uploader.options,\n                mapping = {};\n    \n            if ( opts.duplicate ) {\n                return;\n            }\n    \n            function hashString( str ) {\n                var hash = 0,\n                    i = 0,\n                    len = str.length,\n                    _char;\n    \n                for ( ; i < len; i++ ) {\n                    _char = str.charCodeAt( i );\n                    hash = _char + (hash << 6) + (hash << 16) - hash;\n                }\n    \n                return hash;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n                var hash = file.__hash || (file.__hash = hashString( file.name +\n                        file.size + file.lastModifiedDate ));\n    \n                // 已经重复了\n                if ( mapping[ hash ] ) {\n                    this.trigger( 'error', 'F_DUPLICATE', file );\n                    return false;\n                }\n            });\n    \n            uploader.on( 'fileQueued', function( file ) {\n                var hash = file.__hash;\n    \n                hash && (mapping[ hash ] = true);\n            });\n    \n            uploader.on( 'fileDequeued', function( file ) {\n                var hash = file.__hash;\n    \n                hash && (delete mapping[ hash ]);\n            });\n    \n            uploader.on( 'reset', function() {\n                mapping = {};\n            });\n        });\n    \n        return api;\n    });\n    \n    /**\n     * @fileOverview Md5\n     */\n    define('lib/md5',[\n        'runtime/client',\n        'mediator'\n    ], function( RuntimeClient, Mediator ) {\n    \n        function Md5() {\n            RuntimeClient.call( this, 'Md5' );\n        }\n    \n        // 让 Md5 具备事件功能。\n        Mediator.installTo( Md5.prototype );\n    \n        Md5.prototype.loadFromBlob = function( blob ) {\n            var me = this;\n    \n            if ( me.getRuid() ) {\n                me.disconnectRuntime();\n            }\n    \n            // 连接到blob归属的同一个runtime.\n            me.connectRuntime( blob.ruid, function() {\n                me.exec('init');\n                me.exec( 'loadFromBlob', blob );\n            });\n        };\n    \n        Md5.prototype.getResult = function() {\n            return this.exec('getResult');\n        };\n    \n        return Md5;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/md5',[\n        'base',\n        'uploader',\n        'lib/md5',\n        'lib/blob',\n        'widgets/widget'\n    ], function( Base, Uploader, Md5, Blob ) {\n    \n        return Uploader.register({\n            name: 'md5',\n    \n    \n            /**\n             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n             *\n             *\n             * @method md5File\n             * @grammar md5File( file[, start[, end]] ) => promise\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.md5File( file )\n             *\n             *         // 及时显示进度\n             *         .progress(function(percentage) {\n             *             console.log('Percentage:', percentage);\n             *         })\n             *\n             *         // 完成\n             *         .then(function(val) {\n             *             console.log('md5 result:', val);\n             *         });\n             *\n             * });\n             */\n            md5File: function( file, start, end ) {\n                var md5 = new Md5(),\n                    deferred = Base.Deferred(),\n                    blob = (file instanceof Blob) ? file :\n                        this.request( 'get-file', file ).source;\n    \n                md5.on( 'progress load', function( e ) {\n                    e = e || {};\n                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n                });\n    \n                md5.on( 'complete', function() {\n                    deferred.resolve( md5.getResult() );\n                });\n    \n                md5.on( 'error', function( reason ) {\n                    deferred.reject( reason );\n                });\n    \n                if ( arguments.length > 1 ) {\n                    start = start || 0;\n                    end = end || 0;\n                    start < 0 && (start = blob.size + start);\n                    end < 0 && (end = blob.size + end);\n                    end = Math.min( end, blob.size );\n                    blob = blob.slice( start, end );\n                }\n    \n                md5.loadFromBlob( blob );\n    \n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/compbase',[],function() {\n    \n        function CompBase( owner, runtime ) {\n    \n            this.owner = owner;\n            this.options = owner.options;\n    \n            this.getRuntime = function() {\n                return runtime;\n            };\n    \n            this.getRuid = function() {\n                return runtime.uid;\n            };\n    \n            this.trigger = function() {\n                return owner.trigger.apply( owner, arguments );\n            };\n        }\n    \n        return CompBase;\n    });\n    /**\n     * @fileOverview Html5Runtime\n     */\n    define('runtime/html5/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n    \n        var type = 'html5',\n            components = {};\n    \n        function Html5Runtime() {\n            var pool = {},\n                me = this,\n                destroy = this.destroy;\n    \n            Runtime.apply( me, arguments );\n            me.type = type;\n    \n    \n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n    \n                if ( components[ comp ] ) {\n                    instance = pool[ uid ] = pool[ uid ] ||\n                            new components[ comp ]( client, me );\n    \n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n            };\n    \n            me.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n        }\n    \n        Base.inherits( Runtime, {\n            constructor: Html5Runtime,\n    \n            // 不需要连接其他程序，直接执行callback\n            init: function() {\n                var me = this;\n                setTimeout(function() {\n                    me.trigger('ready');\n                }, 1 );\n            }\n    \n        });\n    \n        // 注册Components\n        Html5Runtime.register = function( name, component ) {\n            var klass = components[ name ] = Base.inherits( CompBase, component );\n            return klass;\n        };\n    \n        // 注册html5运行时。\n        // 只有在支持的前提下注册。\n        if ( window.Blob && window.FileReader && window.DataView ) {\n            Runtime.addRuntime( type, Html5Runtime );\n        }\n    \n        return Html5Runtime;\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/html5/blob',[\n        'runtime/html5/runtime',\n        'lib/blob'\n    ], function( Html5Runtime, Blob ) {\n    \n        return Html5Runtime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.owner.source,\n                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n    \n                blob = slice.call( blob, start, end );\n    \n                return new Blob( this.getRuid(), blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/dnd',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n    \n        var $ = Base.$,\n            prefix = 'webuploader-dnd-';\n    \n        return Html5Runtime.register( 'DragAndDrop', {\n            init: function() {\n                var elem = this.elem = this.options.container;\n    \n                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n                this.dropHandler = Base.bindFn( this._dropHandler, this );\n                this.dndOver = false;\n    \n                elem.on( 'dragenter', this.dragEnterHandler );\n                elem.on( 'dragover', this.dragOverHandler );\n                elem.on( 'dragleave', this.dragLeaveHandler );\n                elem.on( 'drop', this.dropHandler );\n    \n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).on( 'dragover', this.dragOverHandler );\n                    $( document ).on( 'drop', this.dropHandler );\n                }\n            },\n    \n            _dragEnterHandler: function( e ) {\n                var me = this,\n                    denied = me._denied || false,\n                    items;\n    \n                e = e.originalEvent || e;\n    \n                if ( !me.dndOver ) {\n                    me.dndOver = true;\n    \n                    // 注意只有 chrome 支持。\n                    items = e.dataTransfer.items;\n    \n                    if ( items && items.length ) {\n                        me._denied = denied = !me.trigger( 'accept', items );\n                    }\n    \n                    me.elem.addClass( prefix + 'over' );\n                    me.elem[ denied ? 'addClass' :\n                            'removeClass' ]( prefix + 'denied' );\n                }\n    \n                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n    \n                return false;\n            },\n    \n            _dragOverHandler: function( e ) {\n                // 只处理框内的。\n                var parentElem = this.elem.parent().get( 0 );\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n    \n                clearTimeout( this._leaveTimer );\n                this._dragEnterHandler.call( this, e );\n    \n                return false;\n            },\n    \n            _dragLeaveHandler: function() {\n                var me = this,\n                    handler;\n    \n                handler = function() {\n                    me.dndOver = false;\n                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n                };\n    \n                clearTimeout( me._leaveTimer );\n                me._leaveTimer = setTimeout( handler, 100 );\n                return false;\n            },\n    \n            _dropHandler: function( e ) {\n                var me = this,\n                    ruid = me.getRuid(),\n                    parentElem = me.elem.parent().get( 0 ),\n                    dataTransfer, data;\n    \n                // 只处理框内的。\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n    \n                e = e.originalEvent || e;\n                dataTransfer = e.dataTransfer;\n    \n                // 如果是页面内拖拽，还不能处理，不阻止事件。\n                // 此处 ie11 下会报参数错误，\n                try {\n                    data = dataTransfer.getData('text/html');\n                } catch( err ) {\n                }\n    \n                if ( data ) {\n                    return;\n                }\n    \n                me._getTansferFiles( dataTransfer, function( results ) {\n                    me.trigger( 'drop', $.map( results, function( file ) {\n                        return new File( ruid, file );\n                    }) );\n                });\n    \n                me.dndOver = false;\n                me.elem.removeClass( prefix + 'over' );\n                return false;\n            },\n    \n            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n            _getTansferFiles: function( dataTransfer, callback ) {\n                var results  = [],\n                    promises = [],\n                    items, files, file, item, i, len, canAccessFolder;\n    \n                items = dataTransfer.items;\n                files = dataTransfer.files;\n    \n                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n    \n                for ( i = 0, len = files.length; i < len; i++ ) {\n                    file = files[ i ];\n                    item = items && items[ i ];\n    \n                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n    \n                        promises.push( this._traverseDirectoryTree(\n                                item.webkitGetAsEntry(), results ) );\n                    } else {\n                        results.push( file );\n                    }\n                }\n    \n                Base.when.apply( Base, promises ).done(function() {\n    \n                    if ( !results.length ) {\n                        return;\n                    }\n    \n                    callback( results );\n                });\n            },\n    \n            _traverseDirectoryTree: function( entry, results ) {\n                var deferred = Base.Deferred(),\n                    me = this;\n    \n                if ( entry.isFile ) {\n                    entry.file(function( file ) {\n                        results.push( file );\n                        deferred.resolve();\n                    });\n                } else if ( entry.isDirectory ) {\n                    entry.createReader().readEntries(function( entries ) {\n                        var len = entries.length,\n                            promises = [],\n                            arr = [],    // 为了保证顺序。\n                            i;\n    \n                        for ( i = 0; i < len; i++ ) {\n                            promises.push( me._traverseDirectoryTree(\n                                    entries[ i ], arr ) );\n                        }\n    \n                        Base.when.apply( Base, promises ).then(function() {\n                            results.push.apply( results, arr );\n                            deferred.resolve();\n                        }, deferred.reject );\n                    });\n                }\n    \n                return deferred.promise();\n            },\n    \n            destroy: function() {\n                var elem = this.elem;\n    \n                // 还没 init 就调用 destroy\n                if (!elem) {\n                    return;\n                }\n                \n                elem.off( 'dragenter', this.dragEnterHandler );\n                elem.off( 'dragover', this.dragOverHandler );\n                elem.off( 'dragleave', this.dragLeaveHandler );\n                elem.off( 'drop', this.dropHandler );\n    \n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).off( 'dragover', this.dragOverHandler );\n                    $( document ).off( 'drop', this.dropHandler );\n                }\n            }\n        });\n    });\n    \n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/filepaste',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n    \n        return Html5Runtime.register( 'FilePaste', {\n            init: function() {\n                var opts = this.options,\n                    elem = this.elem = opts.container,\n                    accept = '.*',\n                    arr, i, len, item;\n    \n                // accetp的mimeTypes中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n    \n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].mimeTypes;\n                        item && arr.push( item );\n                    }\n    \n                    if ( arr.length ) {\n                        accept = arr.join(',');\n                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n                    }\n                }\n                this.accept = accept = new RegExp( accept, 'i' );\n                this.hander = Base.bindFn( this._pasteHander, this );\n                elem.on( 'paste', this.hander );\n            },\n    \n            _pasteHander: function( e ) {\n                var allowed = [],\n                    ruid = this.getRuid(),\n                    items, item, blob, i, len;\n    \n                e = e.originalEvent || e;\n                items = e.clipboardData.items;\n    \n                for ( i = 0, len = items.length; i < len; i++ ) {\n                    item = items[ i ];\n    \n                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n                        continue;\n                    }\n    \n                    allowed.push( new File( ruid, blob ) );\n                }\n    \n                if ( allowed.length ) {\n                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.trigger( 'paste', allowed );\n                }\n            },\n    \n            destroy: function() {\n                this.elem.off( 'paste', this.hander );\n            }\n        });\n    });\n    \n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/html5/filepicker',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n    \n        var $ = Base.$;\n    \n        return Html5Runtime.register( 'FilePicker', {\n            init: function() {\n                var container = this.getRuntime().getContainer(),\n                    me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    label = this.label = $( document.createElement('label') ),\n                    input =  this.input = $( document.createElement('input') ),\n                    arr, i, len, mouseHandler;\n    \n                input.attr( 'type', 'file' );\n                //console.log(opts.name)\n                input.attr( 'name', 'file' );\n                input.addClass('webuploader-element-invisible');\n    \n                label.on( 'click', function() {\n                    input.trigger('click');\n                });\n    \n                label.css({\n                    opacity: 0,\n                    width: '100%',\n                    height: '100%',\n                    display: 'block',\n                    cursor: 'pointer',\n                    background: '#ffffff'\n                });\n    \n                if ( opts.multiple ) {\n                    input.attr( 'multiple', 'multiple' );\n                }\n    \n                // @todo Firefox不支持单独指定后缀\n                if ( opts.accept && opts.accept.length > 0 ) {\n                    arr = [];\n    \n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        arr.push( opts.accept[ i ].mimeTypes );\n                    }\n    \n                    input.attr( 'accept', arr.join(',') );\n                }\n    \n                container.append( input );\n                container.append( label );\n    \n                mouseHandler = function( e ) {\n                    owner.trigger( e.type );\n                };\n    \n                input.on( 'change', function( e ) {\n                    var fn = arguments.callee,\n                        clone;\n    \n                    me.files = e.target.files;\n    \n                    // reset input\n                    clone = this.cloneNode( true );\n                    clone.value = null;\n                    this.parentNode.replaceChild( clone, this );\n    \n                    input.off();\n                    input = $( clone ).on( 'change', fn )\n                            .on( 'mouseenter mouseleave', mouseHandler );\n    \n                    owner.trigger('change');\n                });\n    \n                label.on( 'mouseenter mouseleave', mouseHandler );\n    \n            },\n    \n    \n            getFiles: function() {\n                return this.files;\n            },\n    \n            destroy: function() {\n                this.input.off();\n                this.label.off();\n            }\n        });\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/util',[\n        'base'\n    ], function( Base ) {\n    \n        var urlAPI = window.createObjectURL && window ||\n                window.URL && URL.revokeObjectURL && URL ||\n                window.webkitURL,\n            createObjectURL = Base.noop,\n            revokeObjectURL = createObjectURL;\n    \n        if ( urlAPI ) {\n    \n            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n            createObjectURL = function() {\n                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n            };\n    \n            revokeObjectURL = function() {\n                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n            };\n        }\n    \n        return {\n            createObjectURL: createObjectURL,\n            revokeObjectURL: revokeObjectURL,\n    \n            dataURL2Blob: function( dataURI ) {\n                var byteStr, intArray, ab, i, mimetype, parts;\n    \n                parts = dataURI.split(',');\n    \n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n    \n                ab = new ArrayBuffer( byteStr.length );\n                intArray = new Uint8Array( ab );\n    \n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n    \n                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n    \n                return this.arrayBufferToBlob( ab, mimetype );\n            },\n    \n            dataURL2ArrayBuffer: function( dataURI ) {\n                var byteStr, intArray, i, parts;\n    \n                parts = dataURI.split(',');\n    \n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n    \n                intArray = new Uint8Array( byteStr.length );\n    \n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n    \n                return intArray.buffer;\n            },\n    \n            arrayBufferToBlob: function( buffer, type ) {\n                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n                    bb;\n    \n                // android不支持直接new Blob, 只能借助blobbuilder.\n                if ( builder ) {\n                    bb = new builder();\n                    bb.append( buffer );\n                    return bb.getBlob( type );\n                }\n    \n                return new Blob([ buffer ], type ? { type: type } : {} );\n            },\n    \n            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n            // 你得到的结果是png.\n            canvasToDataUrl: function( canvas, type, quality ) {\n                return canvas.toDataURL( type, quality / 100 );\n            },\n    \n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            parseMeta: function( blob, callback ) {\n                callback( false, {});\n            },\n    \n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            updateImageHead: function( data ) {\n                return data;\n            }\n        };\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/imagemeta',[\n        'runtime/html5/util'\n    ], function( Util ) {\n    \n        var api;\n    \n        api = {\n            parsers: {\n                0xffe1: []\n            },\n    \n            maxMetaDataSize: 262144,\n    \n            parse: function( blob, cb ) {\n                var me = this,\n                    fr = new FileReader();\n    \n                fr.onload = function() {\n                    cb( false, me._parse( this.result ) );\n                    fr = fr.onload = fr.onerror = null;\n                };\n    \n                fr.onerror = function( e ) {\n                    cb( e.message );\n                    fr = fr.onload = fr.onerror = null;\n                };\n    \n                blob = blob.slice( 0, me.maxMetaDataSize );\n                fr.readAsArrayBuffer( blob.getSource() );\n            },\n    \n            _parse: function( buffer, noParse ) {\n                if ( buffer.byteLength < 6 ) {\n                    return;\n                }\n    \n                var dataview = new DataView( buffer ),\n                    offset = 2,\n                    maxOffset = dataview.byteLength - 4,\n                    headLength = offset,\n                    ret = {},\n                    markerBytes, markerLength, parsers, i;\n    \n                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n    \n                    while ( offset < maxOffset ) {\n                        markerBytes = dataview.getUint16( offset );\n    \n                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n                                markerBytes === 0xfffe ) {\n    \n                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n    \n                            if ( offset + markerLength > dataview.byteLength ) {\n                                break;\n                            }\n    \n                            parsers = api.parsers[ markerBytes ];\n    \n                            if ( !noParse && parsers ) {\n                                for ( i = 0; i < parsers.length; i += 1 ) {\n                                    parsers[ i ].call( api, dataview, offset,\n                                            markerLength, ret );\n                                }\n                            }\n    \n                            offset += markerLength;\n                            headLength = offset;\n                        } else {\n                            break;\n                        }\n                    }\n    \n                    if ( headLength > 6 ) {\n                        if ( buffer.slice ) {\n                            ret.imageHead = buffer.slice( 2, headLength );\n                        } else {\n                            // Workaround for IE10, which does not yet\n                            // support ArrayBuffer.slice:\n                            ret.imageHead = new Uint8Array( buffer )\n                                    .subarray( 2, headLength );\n                        }\n                    }\n                }\n    \n                return ret;\n            },\n    \n            updateImageHead: function( buffer, head ) {\n                var data = this._parse( buffer, true ),\n                    buf1, buf2, bodyoffset;\n    \n    \n                bodyoffset = 2;\n                if ( data.imageHead ) {\n                    bodyoffset = 2 + data.imageHead.byteLength;\n                }\n    \n                if ( buffer.slice ) {\n                    buf2 = buffer.slice( bodyoffset );\n                } else {\n                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n                }\n    \n                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n    \n                buf1[ 0 ] = 0xFF;\n                buf1[ 1 ] = 0xD8;\n                buf1.set( new Uint8Array( head ), 2 );\n                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n    \n                return buf1.buffer;\n            }\n        };\n    \n        Util.parseMeta = function() {\n            return api.parse.apply( api, arguments );\n        };\n    \n        Util.updateImageHead = function() {\n            return api.updateImageHead.apply( api, arguments );\n        };\n    \n        return api;\n    });\n    /**\n     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n     * 暂时项目中只用了orientation.\n     *\n     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n     * @fileOverview EXIF解析\n     */\n    \n    // Sample\n    // ====================================\n    // Make : Apple\n    // Model : iPhone 4S\n    // Orientation : 1\n    // XResolution : 72 [72/1]\n    // YResolution : 72 [72/1]\n    // ResolutionUnit : 2\n    // Software : QuickTime 7.7.1\n    // DateTime : 2013:09:01 22:53:55\n    // ExifIFDPointer : 190\n    // ExposureTime : 0.058823529411764705 [1/17]\n    // FNumber : 2.4 [12/5]\n    // ExposureProgram : Normal program\n    // ISOSpeedRatings : 800\n    // ExifVersion : 0220\n    // DateTimeOriginal : 2013:09:01 22:52:51\n    // DateTimeDigitized : 2013:09:01 22:52:51\n    // ComponentsConfiguration : YCbCr\n    // ShutterSpeedValue : 4.058893515764426\n    // ApertureValue : 2.5260688216892597 [4845/1918]\n    // BrightnessValue : -0.3126686601998395\n    // MeteringMode : Pattern\n    // Flash : Flash did not fire, compulsory flash mode\n    // FocalLength : 4.28 [107/25]\n    // SubjectArea : [4 values]\n    // FlashpixVersion : 0100\n    // ColorSpace : 1\n    // PixelXDimension : 2448\n    // PixelYDimension : 3264\n    // SensingMethod : One-chip color area sensor\n    // ExposureMode : 0\n    // WhiteBalance : Auto white balance\n    // FocalLengthIn35mmFilm : 35\n    // SceneCaptureType : Standard\n    define('runtime/html5/imagemeta/exif',[\n        'base',\n        'runtime/html5/imagemeta'\n    ], function( Base, ImageMeta ) {\n    \n        var EXIF = {};\n    \n        EXIF.ExifMap = function() {\n            return this;\n        };\n    \n        EXIF.ExifMap.prototype.map = {\n            'Orientation': 0x0112\n        };\n    \n        EXIF.ExifMap.prototype.get = function( id ) {\n            return this[ id ] || this[ this.map[ id ] ];\n        };\n    \n        EXIF.exifTagTypes = {\n            // byte, 8-bit unsigned int:\n            1: {\n                getValue: function( dataView, dataOffset ) {\n                    return dataView.getUint8( dataOffset );\n                },\n                size: 1\n            },\n    \n            // ascii, 8-bit byte:\n            2: {\n                getValue: function( dataView, dataOffset ) {\n                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n                },\n                size: 1,\n                ascii: true\n            },\n    \n            // short, 16 bit int:\n            3: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint16( dataOffset, littleEndian );\n                },\n                size: 2\n            },\n    \n            // long, 32 bit int:\n            4: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n    \n            // rational = two long values,\n            // first is numerator, second is denominator:\n            5: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian ) /\n                        dataView.getUint32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            },\n    \n            // slong, 32 bit signed int:\n            9: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n    \n            // srational, two slongs, first is numerator, second is denominator:\n            10: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian ) /\n                        dataView.getInt32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            }\n        };\n    \n        // undefined, 8-bit byte, value depending on field:\n        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n    \n        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n                littleEndian ) {\n    \n            var tagType = EXIF.exifTagTypes[ type ],\n                tagSize, dataOffset, values, i, str, c;\n    \n            if ( !tagType ) {\n                Base.log('Invalid Exif data: Invalid tag type.');\n                return;\n            }\n    \n            tagSize = tagType.size * length;\n    \n            // Determine if the value is contained in the dataOffset bytes,\n            // or if the value at the dataOffset is a pointer to the actual data:\n            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n                    littleEndian ) : (offset + 8);\n    \n            if ( dataOffset + tagSize > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid data offset.');\n                return;\n            }\n    \n            if ( length === 1 ) {\n                return tagType.getValue( dataView, dataOffset, littleEndian );\n            }\n    \n            values = [];\n    \n            for ( i = 0; i < length; i += 1 ) {\n                values[ i ] = tagType.getValue( dataView,\n                        dataOffset + i * tagType.size, littleEndian );\n            }\n    \n            if ( tagType.ascii ) {\n                str = '';\n    \n                // Concatenate the chars:\n                for ( i = 0; i < values.length; i += 1 ) {\n                    c = values[ i ];\n    \n                    // Ignore the terminating NULL byte(s):\n                    if ( c === '\\u0000' ) {\n                        break;\n                    }\n                    str += c;\n                }\n    \n                return str;\n            }\n            return values;\n        };\n    \n        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n                data ) {\n    \n            var tag = dataView.getUint16( offset, littleEndian );\n            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n                    littleEndian );\n        };\n    \n        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n                littleEndian, data ) {\n    \n            var tagsNumber, dirEndOffset, i;\n    \n            if ( dirOffset + 6 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory offset.');\n                return;\n            }\n    \n            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n    \n            if ( dirEndOffset + 4 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory size.');\n                return;\n            }\n    \n            for ( i = 0; i < tagsNumber; i += 1 ) {\n                this.parseExifTag( dataView, tiffOffset,\n                        dirOffset + 2 + 12 * i,    // tag offset\n                        littleEndian, data );\n            }\n    \n            // Return the offset to the next directory:\n            return dataView.getUint32( dirEndOffset, littleEndian );\n        };\n    \n        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n        //     var hexData,\n        //         i,\n        //         b;\n        //     if (!length || offset + length > dataView.byteLength) {\n        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n        //         return;\n        //     }\n        //     hexData = [];\n        //     for (i = 0; i < length; i += 1) {\n        //         b = dataView.getUint8(offset + i);\n        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n        //     }\n        //     return 'data:image/jpeg,%' + hexData.join('%');\n        // };\n    \n        EXIF.parseExifData = function( dataView, offset, length, data ) {\n    \n            var tiffOffset = offset + 10,\n                littleEndian, dirOffset;\n    \n            // Check for the ASCII code for \"Exif\" (0x45786966):\n            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n                // No Exif data, might be XMP data instead\n                return;\n            }\n            if ( tiffOffset + 8 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid segment size.');\n                return;\n            }\n    \n            // Check for the two null bytes:\n            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n                Base.log('Invalid Exif data: Missing byte alignment offset.');\n                return;\n            }\n    \n            // Check the byte alignment:\n            switch ( dataView.getUint16( tiffOffset ) ) {\n                case 0x4949:\n                    littleEndian = true;\n                    break;\n    \n                case 0x4D4D:\n                    littleEndian = false;\n                    break;\n    \n                default:\n                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n                    return;\n            }\n    \n            // Check for the TIFF tag marker (0x002A):\n            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n                Base.log('Invalid Exif data: Missing TIFF marker.');\n                return;\n            }\n    \n            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n            // Create the exif object to store the tags:\n            data.exif = new EXIF.ExifMap();\n            // Parse the tags of the main image directory and retrieve the\n            // offset to the next directory, usually the thumbnail directory:\n            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n                    tiffOffset + dirOffset, littleEndian, data );\n    \n            // 尝试读取缩略图\n            // if ( dirOffset ) {\n            //     thumbnailData = {exif: {}};\n            //     dirOffset = EXIF.parseExifTags(\n            //         dataView,\n            //         tiffOffset,\n            //         tiffOffset + dirOffset,\n            //         littleEndian,\n            //         thumbnailData\n            //     );\n    \n            //     // Check for JPEG Thumbnail offset:\n            //     if (thumbnailData.exif[0x0201]) {\n            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n            //             dataView,\n            //             tiffOffset + thumbnailData.exif[0x0201],\n            //             thumbnailData.exif[0x0202] // Thumbnail data length\n            //         );\n            //     }\n            // }\n        };\n    \n        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n        return EXIF;\n    });\n    /**\n     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n     * android里面toDataUrl('image/jpege')得到的结果却是png.\n     *\n     * 所以这里没辙，只能借助这个工具\n     * @fileOverview jpeg encoder\n     */\n    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n    \n        /*\n          Copyright (c) 2008, Adobe Systems Incorporated\n          All rights reserved.\n    \n          Redistribution and use in source and binary forms, with or without\n          modification, are permitted provided that the following conditions are\n          met:\n    \n          * Redistributions of source code must retain the above copyright notice,\n            this list of conditions and the following disclaimer.\n    \n          * Redistributions in binary form must reproduce the above copyright\n            notice, this list of conditions and the following disclaimer in the\n            documentation and/or other materials provided with the distribution.\n    \n          * Neither the name of Adobe Systems Incorporated nor the names of its\n            contributors may be used to endorse or promote products derived from\n            this software without specific prior written permission.\n    \n          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n        */\n        /*\n        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n    \n        Basic GUI blocking jpeg encoder\n        */\n    \n        function JPEGEncoder(quality) {\n          var self = this;\n            var fround = Math.round;\n            var ffloor = Math.floor;\n            var YTable = new Array(64);\n            var UVTable = new Array(64);\n            var fdtbl_Y = new Array(64);\n            var fdtbl_UV = new Array(64);\n            var YDC_HT;\n            var UVDC_HT;\n            var YAC_HT;\n            var UVAC_HT;\n    \n            var bitcode = new Array(65535);\n            var category = new Array(65535);\n            var outputfDCTQuant = new Array(64);\n            var DU = new Array(64);\n            var byteout = [];\n            var bytenew = 0;\n            var bytepos = 7;\n    \n            var YDU = new Array(64);\n            var UDU = new Array(64);\n            var VDU = new Array(64);\n            var clt = new Array(256);\n            var RGB_YUV_TABLE = new Array(2048);\n            var currentQuality;\n    \n            var ZigZag = [\n                     0, 1, 5, 6,14,15,27,28,\n                     2, 4, 7,13,16,26,29,42,\n                     3, 8,12,17,25,30,41,43,\n                     9,11,18,24,31,40,44,53,\n                    10,19,23,32,39,45,52,54,\n                    20,22,33,38,46,51,55,60,\n                    21,34,37,47,50,56,59,61,\n                    35,36,48,49,57,58,62,63\n                ];\n    \n            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n            var std_ac_luminance_values = [\n                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n    \n            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n            var std_ac_chrominance_values = [\n                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n    \n            function initQuantTables(sf){\n                    var YQT = [\n                        16, 11, 10, 16, 24, 40, 51, 61,\n                        12, 12, 14, 19, 26, 58, 60, 55,\n                        14, 13, 16, 24, 40, 57, 69, 56,\n                        14, 17, 22, 29, 51, 87, 80, 62,\n                        18, 22, 37, 56, 68,109,103, 77,\n                        24, 35, 55, 64, 81,104,113, 92,\n                        49, 64, 78, 87,103,121,120,101,\n                        72, 92, 95, 98,112,100,103, 99\n                    ];\n    \n                    for (var i = 0; i < 64; i++) {\n                        var t = ffloor((YQT[i]*sf+50)/100);\n                        if (t < 1) {\n                            t = 1;\n                        } else if (t > 255) {\n                            t = 255;\n                        }\n                        YTable[ZigZag[i]] = t;\n                    }\n                    var UVQT = [\n                        17, 18, 24, 47, 99, 99, 99, 99,\n                        18, 21, 26, 66, 99, 99, 99, 99,\n                        24, 26, 56, 99, 99, 99, 99, 99,\n                        47, 66, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99\n                    ];\n                    for (var j = 0; j < 64; j++) {\n                        var u = ffloor((UVQT[j]*sf+50)/100);\n                        if (u < 1) {\n                            u = 1;\n                        } else if (u > 255) {\n                            u = 255;\n                        }\n                        UVTable[ZigZag[j]] = u;\n                    }\n                    var aasf = [\n                        1.0, 1.387039845, 1.306562965, 1.175875602,\n                        1.0, 0.785694958, 0.541196100, 0.275899379\n                    ];\n                    var k = 0;\n                    for (var row = 0; row < 8; row++)\n                    {\n                        for (var col = 0; col < 8; col++)\n                        {\n                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            k++;\n                        }\n                    }\n                }\n    \n                function computeHuffmanTbl(nrcodes, std_table){\n                    var codevalue = 0;\n                    var pos_in_table = 0;\n                    var HT = new Array();\n                    for (var k = 1; k <= 16; k++) {\n                        for (var j = 1; j <= nrcodes[k]; j++) {\n                            HT[std_table[pos_in_table]] = [];\n                            HT[std_table[pos_in_table]][0] = codevalue;\n                            HT[std_table[pos_in_table]][1] = k;\n                            pos_in_table++;\n                            codevalue++;\n                        }\n                        codevalue*=2;\n                    }\n                    return HT;\n                }\n    \n                function initHuffmanTbl()\n                {\n                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n                }\n    \n                function initCategoryNumber()\n                {\n                    var nrlower = 1;\n                    var nrupper = 2;\n                    for (var cat = 1; cat <= 15; cat++) {\n                        //Positive numbers\n                        for (var nr = nrlower; nr<nrupper; nr++) {\n                            category[32767+nr] = cat;\n                            bitcode[32767+nr] = [];\n                            bitcode[32767+nr][1] = cat;\n                            bitcode[32767+nr][0] = nr;\n                        }\n                        //Negative numbers\n                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n                            category[32767+nrneg] = cat;\n                            bitcode[32767+nrneg] = [];\n                            bitcode[32767+nrneg][1] = cat;\n                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n                        }\n                        nrlower <<= 1;\n                        nrupper <<= 1;\n                    }\n                }\n    \n                function initRGBYUVTable() {\n                    for(var i = 0; i < 256;i++) {\n                        RGB_YUV_TABLE[i]            =  19595 * i;\n                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n                    }\n                }\n    \n                // IO functions\n                function writeBits(bs)\n                {\n                    var value = bs[0];\n                    var posval = bs[1]-1;\n                    while ( posval >= 0 ) {\n                        if (value & (1 << posval) ) {\n                            bytenew |= (1 << bytepos);\n                        }\n                        posval--;\n                        bytepos--;\n                        if (bytepos < 0) {\n                            if (bytenew == 0xFF) {\n                                writeByte(0xFF);\n                                writeByte(0);\n                            }\n                            else {\n                                writeByte(bytenew);\n                            }\n                            bytepos=7;\n                            bytenew=0;\n                        }\n                    }\n                }\n    \n                function writeByte(value)\n                {\n                    byteout.push(clt[value]); // write char directly instead of converting later\n                }\n    \n                function writeWord(value)\n                {\n                    writeByte((value>>8)&0xFF);\n                    writeByte((value   )&0xFF);\n                }\n    \n                // DCT & quantization core\n                function fDCTQuant(data, fdtbl)\n                {\n                    var d0, d1, d2, d3, d4, d5, d6, d7;\n                    /* Pass 1: process rows. */\n                    var dataOff=0;\n                    var i;\n                    var I8 = 8;\n                    var I64 = 64;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff+1];\n                        d2 = data[dataOff+2];\n                        d3 = data[dataOff+3];\n                        d4 = data[dataOff+4];\n                        d5 = data[dataOff+5];\n                        d6 = data[dataOff+6];\n                        d7 = data[dataOff+7];\n    \n                        var tmp0 = d0 + d7;\n                        var tmp7 = d0 - d7;\n                        var tmp1 = d1 + d6;\n                        var tmp6 = d1 - d6;\n                        var tmp2 = d2 + d5;\n                        var tmp5 = d2 - d5;\n                        var tmp3 = d3 + d4;\n                        var tmp4 = d3 - d4;\n    \n                        /* Even part */\n                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n                        var tmp13 = tmp0 - tmp3;\n                        var tmp11 = tmp1 + tmp2;\n                        var tmp12 = tmp1 - tmp2;\n    \n                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n                        data[dataOff+4] = tmp10 - tmp11;\n    \n                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n                        data[dataOff+6] = tmp13 - z1;\n    \n                        /* Odd part */\n                        tmp10 = tmp4 + tmp5; /* phase 2 */\n                        tmp11 = tmp5 + tmp6;\n                        tmp12 = tmp6 + tmp7;\n    \n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n                        var z3 = tmp11 * 0.707106781; /* c4 */\n    \n                        var z11 = tmp7 + z3;    /* phase 5 */\n                        var z13 = tmp7 - z3;\n    \n                        data[dataOff+5] = z13 + z2; /* phase 6 */\n                        data[dataOff+3] = z13 - z2;\n                        data[dataOff+1] = z11 + z4;\n                        data[dataOff+7] = z11 - z4;\n    \n                        dataOff += 8; /* advance pointer to next row */\n                    }\n    \n                    /* Pass 2: process columns. */\n                    dataOff = 0;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff + 8];\n                        d2 = data[dataOff + 16];\n                        d3 = data[dataOff + 24];\n                        d4 = data[dataOff + 32];\n                        d5 = data[dataOff + 40];\n                        d6 = data[dataOff + 48];\n                        d7 = data[dataOff + 56];\n    \n                        var tmp0p2 = d0 + d7;\n                        var tmp7p2 = d0 - d7;\n                        var tmp1p2 = d1 + d6;\n                        var tmp6p2 = d1 - d6;\n                        var tmp2p2 = d2 + d5;\n                        var tmp5p2 = d2 - d5;\n                        var tmp3p2 = d3 + d4;\n                        var tmp4p2 = d3 - d4;\n    \n                        /* Even part */\n                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n                        var tmp13p2 = tmp0p2 - tmp3p2;\n                        var tmp11p2 = tmp1p2 + tmp2p2;\n                        var tmp12p2 = tmp1p2 - tmp2p2;\n    \n                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n                        data[dataOff+32] = tmp10p2 - tmp11p2;\n    \n                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n                        data[dataOff+48] = tmp13p2 - z1p2;\n    \n                        /* Odd part */\n                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n                        tmp11p2 = tmp5p2 + tmp6p2;\n                        tmp12p2 = tmp6p2 + tmp7p2;\n    \n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n    \n                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n                        var z13p2 = tmp7p2 - z3p2;\n    \n                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n                        data[dataOff+24] = z13p2 - z2p2;\n                        data[dataOff+ 8] = z11p2 + z4p2;\n                        data[dataOff+56] = z11p2 - z4p2;\n    \n                        dataOff++; /* advance pointer to next column */\n                    }\n    \n                    // Quantize/descale the coefficients\n                    var fDCTQuant;\n                    for (i=0; i<I64; ++i)\n                    {\n                        // Apply the quantization and scaling factor & Round to nearest integer\n                        fDCTQuant = data[i]*fdtbl[i];\n                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n                        //outputfDCTQuant[i] = fround(fDCTQuant);\n    \n                    }\n                    return outputfDCTQuant;\n                }\n    \n                function writeAPP0()\n                {\n                    writeWord(0xFFE0); // marker\n                    writeWord(16); // length\n                    writeByte(0x4A); // J\n                    writeByte(0x46); // F\n                    writeByte(0x49); // I\n                    writeByte(0x46); // F\n                    writeByte(0); // = \"JFIF\",'\\0'\n                    writeByte(1); // versionhi\n                    writeByte(1); // versionlo\n                    writeByte(0); // xyunits\n                    writeWord(1); // xdensity\n                    writeWord(1); // ydensity\n                    writeByte(0); // thumbnwidth\n                    writeByte(0); // thumbnheight\n                }\n    \n                function writeSOF0(width, height)\n                {\n                    writeWord(0xFFC0); // marker\n                    writeWord(17);   // length, truecolor YUV JPG\n                    writeByte(8);    // precision\n                    writeWord(height);\n                    writeWord(width);\n                    writeByte(3);    // nrofcomponents\n                    writeByte(1);    // IdY\n                    writeByte(0x11); // HVY\n                    writeByte(0);    // QTY\n                    writeByte(2);    // IdU\n                    writeByte(0x11); // HVU\n                    writeByte(1);    // QTU\n                    writeByte(3);    // IdV\n                    writeByte(0x11); // HVV\n                    writeByte(1);    // QTV\n                }\n    \n                function writeDQT()\n                {\n                    writeWord(0xFFDB); // marker\n                    writeWord(132);    // length\n                    writeByte(0);\n                    for (var i=0; i<64; i++) {\n                        writeByte(YTable[i]);\n                    }\n                    writeByte(1);\n                    for (var j=0; j<64; j++) {\n                        writeByte(UVTable[j]);\n                    }\n                }\n    \n                function writeDHT()\n                {\n                    writeWord(0xFFC4); // marker\n                    writeWord(0x01A2); // length\n    \n                    writeByte(0); // HTYDCinfo\n                    for (var i=0; i<16; i++) {\n                        writeByte(std_dc_luminance_nrcodes[i+1]);\n                    }\n                    for (var j=0; j<=11; j++) {\n                        writeByte(std_dc_luminance_values[j]);\n                    }\n    \n                    writeByte(0x10); // HTYACinfo\n                    for (var k=0; k<16; k++) {\n                        writeByte(std_ac_luminance_nrcodes[k+1]);\n                    }\n                    for (var l=0; l<=161; l++) {\n                        writeByte(std_ac_luminance_values[l]);\n                    }\n    \n                    writeByte(1); // HTUDCinfo\n                    for (var m=0; m<16; m++) {\n                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n                    }\n                    for (var n=0; n<=11; n++) {\n                        writeByte(std_dc_chrominance_values[n]);\n                    }\n    \n                    writeByte(0x11); // HTUACinfo\n                    for (var o=0; o<16; o++) {\n                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n                    }\n                    for (var p=0; p<=161; p++) {\n                        writeByte(std_ac_chrominance_values[p]);\n                    }\n                }\n    \n                function writeSOS()\n                {\n                    writeWord(0xFFDA); // marker\n                    writeWord(12); // length\n                    writeByte(3); // nrofcomponents\n                    writeByte(1); // IdY\n                    writeByte(0); // HTY\n                    writeByte(2); // IdU\n                    writeByte(0x11); // HTU\n                    writeByte(3); // IdV\n                    writeByte(0x11); // HTV\n                    writeByte(0); // Ss\n                    writeByte(0x3f); // Se\n                    writeByte(0); // Bf\n                }\n    \n                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n                    var EOB = HTAC[0x00];\n                    var M16zeroes = HTAC[0xF0];\n                    var pos;\n                    var I16 = 16;\n                    var I63 = 63;\n                    var I64 = 64;\n                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n                    //ZigZag reorder\n                    for (var j=0;j<I64;++j) {\n                        DU[ZigZag[j]]=DU_DCT[j];\n                    }\n                    var Diff = DU[0] - DC; DC = DU[0];\n                    //Encode DC\n                    if (Diff==0) {\n                        writeBits(HTDC[0]); // Diff might be 0\n                    } else {\n                        pos = 32767+Diff;\n                        writeBits(HTDC[category[pos]]);\n                        writeBits(bitcode[pos]);\n                    }\n                    //Encode ACs\n                    var end0pos = 63; // was const... which is crazy\n                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n                    //end0pos = first element in reverse order !=0\n                    if ( end0pos == 0) {\n                        writeBits(EOB);\n                        return DC;\n                    }\n                    var i = 1;\n                    var lng;\n                    while ( i <= end0pos ) {\n                        var startpos = i;\n                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n                        var nrzeroes = i-startpos;\n                        if ( nrzeroes >= I16 ) {\n                            lng = nrzeroes>>4;\n                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n                                writeBits(M16zeroes);\n                            nrzeroes = nrzeroes&0xF;\n                        }\n                        pos = 32767+DU[i];\n                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n                        writeBits(bitcode[pos]);\n                        i++;\n                    }\n                    if ( end0pos != I63 ) {\n                        writeBits(EOB);\n                    }\n                    return DC;\n                }\n    \n                function initCharLookupTable(){\n                    var sfcc = String.fromCharCode;\n                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n                        clt[i] = sfcc(i);\n                    }\n                }\n    \n                this.encode = function(image,quality) // image data object\n                {\n                    // var time_start = new Date().getTime();\n    \n                    if(quality) setQuality(quality);\n    \n                    // Initialize bit writer\n                    byteout = new Array();\n                    bytenew=0;\n                    bytepos=7;\n    \n                    // Add JPEG headers\n                    writeWord(0xFFD8); // SOI\n                    writeAPP0();\n                    writeDQT();\n                    writeSOF0(image.width,image.height);\n                    writeDHT();\n                    writeSOS();\n    \n    \n                    // Encode 8x8 macroblocks\n                    var DCY=0;\n                    var DCU=0;\n                    var DCV=0;\n    \n                    bytenew=0;\n                    bytepos=7;\n    \n    \n                    this.encode.displayName = \"_encode_\";\n    \n                    var imageData = image.data;\n                    var width = image.width;\n                    var height = image.height;\n    \n                    var quadWidth = width*4;\n                    var tripleWidth = width*3;\n    \n                    var x, y = 0;\n                    var r, g, b;\n                    var start,p, col,row,pos;\n                    while(y < height){\n                        x = 0;\n                        while(x < quadWidth){\n                        start = quadWidth * y + x;\n                        p = start;\n                        col = -1;\n                        row = 0;\n    \n                        for(pos=0; pos < 64; pos++){\n                            row = pos >> 3;// /8\n                            col = ( pos & 7 ) * 4; // %8\n                            p = start + ( row * quadWidth ) + col;\n    \n                            if(y+row >= height){ // padding bottom\n                                p-= (quadWidth*(y+1+row-height));\n                            }\n    \n                            if(x+col >= quadWidth){ // padding right\n                                p-= ((x+col) - quadWidth +4)\n                            }\n    \n                            r = imageData[ p++ ];\n                            g = imageData[ p++ ];\n                            b = imageData[ p++ ];\n    \n    \n                            /* // calculate YUV values dynamically\n                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n                            */\n    \n                            // use lookup table (slightly faster)\n                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n    \n                        }\n    \n                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n                        x+=32;\n                        }\n                        y+=8;\n                    }\n    \n    \n                    ////////////////////////////////////////////////////////////////\n    \n                    // Do the bit alignment of the EOI marker\n                    if ( bytepos >= 0 ) {\n                        var fillbits = [];\n                        fillbits[1] = bytepos+1;\n                        fillbits[0] = (1<<(bytepos+1))-1;\n                        writeBits(fillbits);\n                    }\n    \n                    writeWord(0xFFD9); //EOI\n    \n                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n    \n                    byteout = [];\n    \n                    // benchmarking\n                    // var duration = new Date().getTime() - time_start;\n                    // console.log('Encoding time: '+ currentQuality + 'ms');\n                    //\n    \n                    return jpegDataUri\n            }\n    \n            function setQuality(quality){\n                if (quality <= 0) {\n                    quality = 1;\n                }\n                if (quality > 100) {\n                    quality = 100;\n                }\n    \n                if(currentQuality == quality) return // don't recalc if unchanged\n    \n                var sf = 0;\n                if (quality < 50) {\n                    sf = Math.floor(5000 / quality);\n                } else {\n                    sf = Math.floor(200 - quality*2);\n                }\n    \n                initQuantTables(sf);\n                currentQuality = quality;\n                // console.log('Quality set to: '+quality +'%');\n            }\n    \n            function init(){\n                // var time_start = new Date().getTime();\n                if(!quality) quality = 50;\n                // Create tables\n                initCharLookupTable()\n                initHuffmanTbl();\n                initCategoryNumber();\n                initRGBYUVTable();\n    \n                setQuality(quality);\n                // var duration = new Date().getTime() - time_start;\n                // console.log('Initialization '+ duration + 'ms');\n            }\n    \n            init();\n    \n        }\n    \n        JPEGEncoder.encode = function( data, quality ) {\n            var encoder = new JPEGEncoder( quality );\n    \n            return encoder.encode( data );\n        }\n    \n        return JPEGEncoder;\n    });\n    /**\n     * @fileOverview Fix android canvas.toDataUrl bug.\n     */\n    define('runtime/html5/androidpatch',[\n        'runtime/html5/util',\n        'runtime/html5/jpegencoder',\n        'base'\n    ], function( Util, encoder, Base ) {\n        var origin = Util.canvasToDataUrl,\n            supportJpeg;\n    \n        Util.canvasToDataUrl = function( canvas, type, quality ) {\n            var ctx, w, h, fragement, parts;\n    \n            // 非android手机直接跳过。\n            if ( !Base.os.android ) {\n                return origin.apply( null, arguments );\n            }\n    \n            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n            // JPEG 前两位分别是：255, 216\n            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n                fragement = origin.apply( null, arguments );\n    \n                parts = fragement.split(',');\n    \n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    fragement = atob( parts[ 1 ] );\n                } else {\n                    fragement = decodeURIComponent( parts[ 1 ] );\n                }\n    \n                fragement = fragement.substring( 0, 2 );\n    \n                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n                        fragement.charCodeAt( 1 ) === 216;\n            }\n    \n            // 只有在android环境下才修复\n            if ( type === 'image/jpeg' && !supportJpeg ) {\n                w = canvas.width;\n                h = canvas.height;\n                ctx = canvas.getContext('2d');\n    \n                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n            }\n    \n            return origin.apply( null, arguments );\n        };\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('runtime/html5/image',[\n        'base',\n        'runtime/html5/runtime',\n        'runtime/html5/util'\n    ], function( Base, Html5Runtime, Util ) {\n    \n        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n    \n        return Html5Runtime.register( 'Image', {\n    \n            // flag: 标记是否被修改过。\n            modified: false,\n    \n            init: function() {\n                var me = this,\n                    img = new Image();\n    \n                img.onload = function() {\n    \n                    me._info = {\n                        type: me.type,\n                        width: this.width,\n                        height: this.height\n                    };\n    \n                    // 读取meta信息。\n                    if ( !me._metas && 'image/jpeg' === me.type ) {\n                        Util.parseMeta( me._blob, function( error, ret ) {\n                            me._metas = ret;\n                            me.owner.trigger('load');\n                        });\n                    } else {\n                        me.owner.trigger('load');\n                    }\n                };\n    \n                img.onerror = function() {\n                    me.owner.trigger('error');\n                };\n    \n                me._img = img;\n            },\n    \n            loadFromBlob: function( blob ) {\n                var me = this,\n                    img = me._img;\n    \n                me._blob = blob;\n                me.type = blob.type;\n                img.src = Util.createObjectURL( blob.getSource() );\n                me.owner.once( 'load', function() {\n                    Util.revokeObjectURL( img.src );\n                });\n            },\n    \n            resize: function( width, height ) {\n                var canvas = this._canvas ||\n                        (this._canvas = document.createElement('canvas'));\n    \n                this._resize( this._img, canvas, width, height );\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'resize' );\n            },\n    \n            crop: function( x, y, w, h, s ) {\n                var cvs = this._canvas ||\n                        (this._canvas = document.createElement('canvas')),\n                    opts = this.options,\n                    img = this._img,\n                    iw = img.naturalWidth,\n                    ih = img.naturalHeight,\n                    orientation = this.getOrientation();\n    \n                s = s || 1;\n    \n                // todo 解决 orientation 的问题。\n                // values that require 90 degree rotation\n                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n    \n                //     switch ( orientation ) {\n                //         case 6:\n                //             tmp = x;\n                //             x = y;\n                //             y = iw * s - tmp - w;\n                //             console.log(ih * s, tmp, w)\n                //             break;\n                //     }\n    \n                //     (w ^= h, h ^= w, w ^= h);\n                // }\n    \n                cvs.width = w;\n                cvs.height = h;\n    \n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n    \n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'crop' );\n            },\n    \n            getAsBlob: function( type ) {\n                var blob = this._blob,\n                    opts = this.options,\n                    canvas;\n    \n                type = type || this.type;\n    \n                // blob需要重新生成。\n                if ( this.modified || this.type !== type ) {\n                    canvas = this._canvas;\n    \n                    if ( type === 'image/jpeg' ) {\n    \n                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n    \n                        if ( opts.preserveHeaders && this._metas &&\n                                this._metas.imageHead ) {\n    \n                            blob = Util.dataURL2ArrayBuffer( blob );\n                            blob = Util.updateImageHead( blob,\n                                    this._metas.imageHead );\n                            blob = Util.arrayBufferToBlob( blob, type );\n                            return blob;\n                        }\n                    } else {\n                        blob = Util.canvasToDataUrl( canvas, type );\n                    }\n    \n                    blob = Util.dataURL2Blob( blob );\n                }\n    \n                return blob;\n            },\n    \n            getAsDataUrl: function( type ) {\n                var opts = this.options;\n    \n                type = type || this.type;\n    \n                if ( type === 'image/jpeg' ) {\n                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n                } else {\n                    return this._canvas.toDataURL( type );\n                }\n            },\n    \n            getOrientation: function() {\n                return this._metas && this._metas.exif &&\n                        this._metas.exif.get('Orientation') || 1;\n            },\n    \n            info: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n    \n                // getter\n                return this._info;\n            },\n    \n            meta: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n    \n                // getter\n                return this._meta;\n            },\n    \n            destroy: function() {\n                var canvas = this._canvas;\n                this._img.onload = null;\n    \n                if ( canvas ) {\n                    canvas.getContext('2d')\n                            .clearRect( 0, 0, canvas.width, canvas.height );\n                    canvas.width = canvas.height = 0;\n                    this._canvas = null;\n                }\n    \n                // 释放内存。非常重要，否则释放不了image的内存。\n                this._img.src = BLANK;\n                this._img = this._blob = null;\n            },\n    \n            _resize: function( img, cvs, width, height ) {\n                var opts = this.options,\n                    naturalWidth = img.width,\n                    naturalHeight = img.height,\n                    orientation = this.getOrientation(),\n                    scale, w, h, x, y;\n    \n                // values that require 90 degree rotation\n                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n    \n                    // 交换width, height的值。\n                    width ^= height;\n                    height ^= width;\n                    width ^= height;\n                }\n    \n                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n                        height / naturalHeight );\n    \n                // 不允许放大。\n                opts.allowMagnify || (scale = Math.min( 1, scale ));\n    \n                w = naturalWidth * scale;\n                h = naturalHeight * scale;\n    \n                if ( opts.crop ) {\n                    cvs.width = width;\n                    cvs.height = height;\n                } else {\n                    cvs.width = w;\n                    cvs.height = h;\n                }\n    \n                x = (cvs.width - w) / 2;\n                y = (cvs.height - h) / 2;\n    \n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n    \n                this._renderImageToCanvas( cvs, img, x, y, w, h );\n            },\n    \n            _rotate2Orientaion: function( canvas, orientation ) {\n                var width = canvas.width,\n                    height = canvas.height,\n                    ctx = canvas.getContext('2d');\n    \n                switch ( orientation ) {\n                    case 5:\n                    case 6:\n                    case 7:\n                    case 8:\n                        canvas.width = height;\n                        canvas.height = width;\n                        break;\n                }\n    \n                switch ( orientation ) {\n                    case 2:    // horizontal flip\n                        ctx.translate( width, 0 );\n                        ctx.scale( -1, 1 );\n                        break;\n    \n                    case 3:    // 180 rotate left\n                        ctx.translate( width, height );\n                        ctx.rotate( Math.PI );\n                        break;\n    \n                    case 4:    // vertical flip\n                        ctx.translate( 0, height );\n                        ctx.scale( 1, -1 );\n                        break;\n    \n                    case 5:    // vertical flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.scale( 1, -1 );\n                        break;\n    \n                    case 6:    // 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( 0, -height );\n                        break;\n    \n                    case 7:    // horizontal flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( width, -height );\n                        ctx.scale( -1, 1 );\n                        break;\n    \n                    case 8:    // 90 rotate left\n                        ctx.rotate( -0.5 * Math.PI );\n                        ctx.translate( -width, 0 );\n                        break;\n                }\n            },\n    \n            // https://github.com/stomita/ios-imagefile-megapixel/\n            // blob/master/src/megapix-image.js\n            _renderImageToCanvas: (function() {\n    \n                // 如果不是ios, 不需要这么复杂！\n                if ( !Base.os.ios ) {\n                    return function( canvas ) {\n                        var args = Base.slice( arguments, 1 ),\n                            ctx = canvas.getContext('2d');\n    \n                        ctx.drawImage.apply( ctx, args );\n                    };\n                }\n    \n                /**\n                 * Detecting vertical squash in loaded image.\n                 * Fixes a bug which squash image vertically while drawing into\n                 * canvas for some images.\n                 */\n                function detectVerticalSquash( img, iw, ih ) {\n                    var canvas = document.createElement('canvas'),\n                        ctx = canvas.getContext('2d'),\n                        sy = 0,\n                        ey = ih,\n                        py = ih,\n                        data, alpha, ratio;\n    \n    \n                    canvas.width = 1;\n                    canvas.height = ih;\n                    ctx.drawImage( img, 0, 0 );\n                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n    \n                    // search image edge pixel position in case\n                    // it is squashed vertically.\n                    while ( py > sy ) {\n                        alpha = data[ (py - 1) * 4 + 3 ];\n    \n                        if ( alpha === 0 ) {\n                            ey = py;\n                        } else {\n                            sy = py;\n                        }\n    \n                        py = (ey + sy) >> 1;\n                    }\n    \n                    ratio = (py / ih);\n                    return (ratio === 0) ? 1 : ratio;\n                }\n    \n                // fix ie7 bug\n                // http://stackoverflow.com/questions/11929099/\n                // html5-canvas-drawimage-ratio-bug-ios\n                if ( Base.os.ios >= 7 ) {\n                    return function( canvas, img, x, y, w, h ) {\n                        var iw = img.naturalWidth,\n                            ih = img.naturalHeight,\n                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n    \n                        return canvas.getContext('2d').drawImage( img, 0, 0,\n                                iw * vertSquashRatio, ih * vertSquashRatio,\n                                x, y, w, h );\n                    };\n                }\n    \n                /**\n                 * Detect subsampling in loaded image.\n                 * In iOS, larger images than 2M pixels may be\n                 * subsampled in rendering.\n                 */\n                function detectSubsampling( img ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        canvas, ctx;\n    \n                    // subsampling may happen overmegapixel image\n                    if ( iw * ih > 1024 * 1024 ) {\n                        canvas = document.createElement('canvas');\n                        canvas.width = canvas.height = 1;\n                        ctx = canvas.getContext('2d');\n                        ctx.drawImage( img, -iw + 1, 0 );\n    \n                        // subsampled image becomes half smaller in rendering size.\n                        // check alpha channel value to confirm image is covering\n                        // edge pixel or not. if alpha value is 0\n                        // image is not covering, hence subsampled.\n                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n                    } else {\n                        return false;\n                    }\n                }\n    \n    \n                return function( canvas, img, x, y, width, height ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        ctx = canvas.getContext('2d'),\n                        subsampled = detectSubsampling( img ),\n                        doSquash = this.type === 'image/jpeg',\n                        d = 1024,\n                        sy = 0,\n                        dy = 0,\n                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n    \n                    if ( subsampled ) {\n                        iw /= 2;\n                        ih /= 2;\n                    }\n    \n                    ctx.save();\n                    tmpCanvas = document.createElement('canvas');\n                    tmpCanvas.width = tmpCanvas.height = d;\n    \n                    tmpCtx = tmpCanvas.getContext('2d');\n                    vertSquashRatio = doSquash ?\n                            detectVerticalSquash( img, iw, ih ) : 1;\n    \n                    dw = Math.ceil( d * width / iw );\n                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n    \n                    while ( sy < ih ) {\n                        sx = 0;\n                        dx = 0;\n                        while ( sx < iw ) {\n                            tmpCtx.clearRect( 0, 0, d, d );\n                            tmpCtx.drawImage( img, -sx, -sy );\n                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n                                    x + dx, y + dy, dw, dh );\n                            sx += d;\n                            dx += dw;\n                        }\n                        sy += d;\n                        dy += dh;\n                    }\n                    ctx.restore();\n                    tmpCanvas = tmpCtx = null;\n                };\n            })()\n        });\n    });\n    /**\n     * @fileOverview Transport\n     * @todo 支持chunked传输，优势：\n     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n     */\n    define('runtime/html5/transport',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n    \n        var noop = Base.noop,\n            $ = Base.$;\n    \n        return Html5Runtime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n            },\n    \n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    formData, binary, fr;\n    \n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n    \n                    binary = blob.getSource();\n                } else {\n                    formData = new FormData();\n                    $.each( owner._formData, function( k, v ) {\n                        formData.append( k, v );\n                    });\n    \n                    formData.append( opts.fileVal, blob.getSource(),\n                            opts.filename || owner._formData.name || '' );\n                }\n    \n                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n                    xhr.open( opts.method, server, true );\n                    xhr.withCredentials = true;\n                } else {\n                    xhr.open( opts.method, server );\n                }\n    \n                this._setRequestHeader( xhr, opts.headers );\n    \n                if ( binary ) {\n                    // 强制设置成 content-type 为文件流。\n                    xhr.overrideMimeType &&\n                            xhr.overrideMimeType('application/octet-stream');\n    \n                    // android直接发送blob会导致服务端接收到的是空文件。\n                    // bug详情。\n                    // https://code.google.com/p/android/issues/detail?id=39882\n                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n                    if ( Base.os.android ) {\n                        fr = new FileReader();\n    \n                        fr.onload = function() {\n                            xhr.send( this.result );\n                            fr = fr.onload = null;\n                        };\n    \n                        fr.readAsArrayBuffer( binary );\n                    } else {\n                        xhr.send( binary );\n                    }\n                } else {\n                    xhr.send( formData );\n                }\n            },\n    \n            getResponse: function() {\n                return this._response;\n            },\n    \n            getResponseAsJson: function() {\n                return this._parseJson( this._response );\n            },\n    \n            getStatus: function() {\n                return this._status;\n            },\n    \n            abort: function() {\n                var xhr = this._xhr;\n    \n                if ( xhr ) {\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    xhr.abort();\n    \n                    this._xhr = xhr = null;\n                }\n            },\n    \n            destroy: function() {\n                this.abort();\n            },\n    \n            _initAjax: function() {\n                var me = this,\n                    xhr = new XMLHttpRequest(),\n                    opts = this.options;\n    \n                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n                        typeof XDomainRequest !== 'undefined' ) {\n                    xhr = new XDomainRequest();\n                }\n    \n                xhr.upload.onprogress = function( e ) {\n                    var percentage = 0;\n    \n                    if ( e.lengthComputable ) {\n                        percentage = e.loaded / e.total;\n                    }\n    \n                    return me.trigger( 'progress', percentage );\n                };\n    \n                xhr.onreadystatechange = function() {\n    \n                    if ( xhr.readyState !== 4 ) {\n                        return;\n                    }\n    \n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    me._xhr = null;\n                    me._status = xhr.status;\n    \n                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger('load');\n                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger( 'error', 'server' );\n                    }\n    \n    \n                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n                };\n    \n                me._xhr = xhr;\n                return xhr;\n            },\n    \n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.setRequestHeader( key, val );\n                });\n            },\n    \n            _parseJson: function( str ) {\n                var json;\n    \n                try {\n                    json = JSON.parse( str );\n                } catch ( ex ) {\n                    json = {};\n                }\n    \n                return json;\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/html5/md5',[\n        'runtime/html5/runtime'\n    ], function( FlashRuntime ) {\n    \n        /*\n         * Fastest md5 implementation around (JKM md5)\n         * Credits: Joseph Myers\n         *\n         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n         * @see http://jsperf.com/md5-shootout/7\n         */\n    \n        /* this function is much faster,\n          so if possible we use it. Some IEs\n          are the only ones I know of that\n          need the idiotic second function,\n          generated by an if clause.  */\n        var add32 = function (a, b) {\n            return (a + b) & 0xFFFFFFFF;\n        },\n    \n        cmn = function (q, a, b, x, s, t) {\n            a = add32(add32(a, q), add32(x, t));\n            return add32((a << s) | (a >>> (32 - s)), b);\n        },\n    \n        ff = function (a, b, c, d, x, s, t) {\n            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n        },\n    \n        gg = function (a, b, c, d, x, s, t) {\n            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n        },\n    \n        hh = function (a, b, c, d, x, s, t) {\n            return cmn(b ^ c ^ d, a, b, x, s, t);\n        },\n    \n        ii = function (a, b, c, d, x, s, t) {\n            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n        },\n    \n        md5cycle = function (x, k) {\n            var a = x[0],\n                b = x[1],\n                c = x[2],\n                d = x[3];\n    \n            a = ff(a, b, c, d, k[0], 7, -680876936);\n            d = ff(d, a, b, c, k[1], 12, -389564586);\n            c = ff(c, d, a, b, k[2], 17, 606105819);\n            b = ff(b, c, d, a, k[3], 22, -1044525330);\n            a = ff(a, b, c, d, k[4], 7, -176418897);\n            d = ff(d, a, b, c, k[5], 12, 1200080426);\n            c = ff(c, d, a, b, k[6], 17, -1473231341);\n            b = ff(b, c, d, a, k[7], 22, -45705983);\n            a = ff(a, b, c, d, k[8], 7, 1770035416);\n            d = ff(d, a, b, c, k[9], 12, -1958414417);\n            c = ff(c, d, a, b, k[10], 17, -42063);\n            b = ff(b, c, d, a, k[11], 22, -1990404162);\n            a = ff(a, b, c, d, k[12], 7, 1804603682);\n            d = ff(d, a, b, c, k[13], 12, -40341101);\n            c = ff(c, d, a, b, k[14], 17, -1502002290);\n            b = ff(b, c, d, a, k[15], 22, 1236535329);\n    \n            a = gg(a, b, c, d, k[1], 5, -165796510);\n            d = gg(d, a, b, c, k[6], 9, -1069501632);\n            c = gg(c, d, a, b, k[11], 14, 643717713);\n            b = gg(b, c, d, a, k[0], 20, -373897302);\n            a = gg(a, b, c, d, k[5], 5, -701558691);\n            d = gg(d, a, b, c, k[10], 9, 38016083);\n            c = gg(c, d, a, b, k[15], 14, -660478335);\n            b = gg(b, c, d, a, k[4], 20, -405537848);\n            a = gg(a, b, c, d, k[9], 5, 568446438);\n            d = gg(d, a, b, c, k[14], 9, -1019803690);\n            c = gg(c, d, a, b, k[3], 14, -187363961);\n            b = gg(b, c, d, a, k[8], 20, 1163531501);\n            a = gg(a, b, c, d, k[13], 5, -1444681467);\n            d = gg(d, a, b, c, k[2], 9, -51403784);\n            c = gg(c, d, a, b, k[7], 14, 1735328473);\n            b = gg(b, c, d, a, k[12], 20, -1926607734);\n    \n            a = hh(a, b, c, d, k[5], 4, -378558);\n            d = hh(d, a, b, c, k[8], 11, -2022574463);\n            c = hh(c, d, a, b, k[11], 16, 1839030562);\n            b = hh(b, c, d, a, k[14], 23, -35309556);\n            a = hh(a, b, c, d, k[1], 4, -1530992060);\n            d = hh(d, a, b, c, k[4], 11, 1272893353);\n            c = hh(c, d, a, b, k[7], 16, -155497632);\n            b = hh(b, c, d, a, k[10], 23, -1094730640);\n            a = hh(a, b, c, d, k[13], 4, 681279174);\n            d = hh(d, a, b, c, k[0], 11, -358537222);\n            c = hh(c, d, a, b, k[3], 16, -722521979);\n            b = hh(b, c, d, a, k[6], 23, 76029189);\n            a = hh(a, b, c, d, k[9], 4, -640364487);\n            d = hh(d, a, b, c, k[12], 11, -421815835);\n            c = hh(c, d, a, b, k[15], 16, 530742520);\n            b = hh(b, c, d, a, k[2], 23, -995338651);\n    \n            a = ii(a, b, c, d, k[0], 6, -198630844);\n            d = ii(d, a, b, c, k[7], 10, 1126891415);\n            c = ii(c, d, a, b, k[14], 15, -1416354905);\n            b = ii(b, c, d, a, k[5], 21, -57434055);\n            a = ii(a, b, c, d, k[12], 6, 1700485571);\n            d = ii(d, a, b, c, k[3], 10, -1894986606);\n            c = ii(c, d, a, b, k[10], 15, -1051523);\n            b = ii(b, c, d, a, k[1], 21, -2054922799);\n            a = ii(a, b, c, d, k[8], 6, 1873313359);\n            d = ii(d, a, b, c, k[15], 10, -30611744);\n            c = ii(c, d, a, b, k[6], 15, -1560198380);\n            b = ii(b, c, d, a, k[13], 21, 1309151649);\n            a = ii(a, b, c, d, k[4], 6, -145523070);\n            d = ii(d, a, b, c, k[11], 10, -1120210379);\n            c = ii(c, d, a, b, k[2], 15, 718787259);\n            b = ii(b, c, d, a, k[9], 21, -343485551);\n    \n            x[0] = add32(a, x[0]);\n            x[1] = add32(b, x[1]);\n            x[2] = add32(c, x[2]);\n            x[3] = add32(d, x[3]);\n        },\n    \n        /* there needs to be support for Unicode here,\n           * unless we pretend that we can redefine the MD-5\n           * algorithm for multi-byte characters (perhaps\n           * by adding every four 16-bit characters and\n           * shortening the sum to 32 bits). Otherwise\n           * I suggest performing MD-5 as if every character\n           * was two bytes--e.g., 0040 0025 = @%--but then\n           * how will an ordinary MD-5 sum be matched?\n           * There is no way to standardize text to something\n           * like UTF-8 before transformation; speed cost is\n           * utterly prohibitive. The JavaScript standard\n           * itself needs to look at this: it should start\n           * providing access to strings as preformed UTF-8\n           * 8-bit unsigned value arrays.\n           */\n        md5blk = function (s) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n    \n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n            }\n            return md5blks;\n        },\n    \n        md5blk_array = function (a) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n    \n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n            }\n            return md5blks;\n        },\n    \n        md51 = function (s) {\n            var n = s.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n    \n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk(s.substring(i - 64, i)));\n            }\n            s = s.substring(i - 64);\n            length = s.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n            }\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n    \n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n    \n            tail[14] = lo;\n            tail[15] = hi;\n    \n            md5cycle(state, tail);\n            return state;\n        },\n    \n        md51_array = function (a) {\n            var n = a.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n    \n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n            }\n    \n            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n            // containing the last element of the parent array if the sub array specified starts\n            // beyond the length of the parent array - weird.\n            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n    \n            length = a.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n            }\n    \n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n    \n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n    \n            tail[14] = lo;\n            tail[15] = hi;\n    \n            md5cycle(state, tail);\n    \n            return state;\n        },\n    \n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n    \n        rhex = function (n) {\n            var s = '',\n                j;\n            for (j = 0; j < 4; j += 1) {\n                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n            }\n            return s;\n        },\n    \n        hex = function (x) {\n            var i;\n            for (i = 0; i < x.length; i += 1) {\n                x[i] = rhex(x[i]);\n            }\n            return x.join('');\n        },\n    \n        md5 = function (s) {\n            return hex(md51(s));\n        },\n    \n    \n    \n        ////////////////////////////////////////////////////////////////////////////\n    \n        /**\n         * SparkMD5 OOP implementation.\n         *\n         * Use this class to perform an incremental md5, otherwise use the\n         * static methods instead.\n         */\n        SparkMD5 = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n    \n    \n        // In some cases the fast add32 function cannot be used..\n        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n            add32 = function (x, y) {\n                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n                return (msw << 16) | (lsw & 0xFFFF);\n            };\n        }\n    \n    \n        /**\n         * Appends a string.\n         * A conversion will be applied if an utf8 string is detected.\n         *\n         * @param {String} str The string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.append = function (str) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n    \n            // then append as binary\n            this.appendBinary(str);\n    \n            return this;\n        };\n    \n        /**\n         * Appends a binary string.\n         *\n         * @param {String} contents The binary string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.appendBinary = function (contents) {\n            this._buff += contents;\n            this._length += contents.length;\n    \n            var length = this._buff.length,\n                i;\n    \n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n            }\n    \n            this._buff = this._buff.substr(i - 64);\n    \n            return this;\n        };\n    \n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                i,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                ret;\n    \n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n            }\n    \n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n    \n            this.reset();\n    \n            return ret;\n        };\n    \n        /**\n         * Finish the final calculation based on the tail.\n         *\n         * @param {Array}  tail   The tail (will be modified)\n         * @param {Number} length The length of the remaining buffer\n         */\n        SparkMD5.prototype._finish = function (tail, length) {\n            var i = length,\n                tmp,\n                lo,\n                hi;\n    \n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(this._state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n    \n            // Do the final computation based on the tail and length\n            // Beware that the final length may not fit in 32 bits so we take care of that\n            tmp = this._length * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n    \n            tail[14] = lo;\n            tail[15] = hi;\n            md5cycle(this._state, tail);\n        };\n    \n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.reset = function () {\n            this._buff = \"\";\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n    \n            return this;\n        };\n    \n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.prototype.destroy = function () {\n            delete this._state;\n            delete this._buff;\n            delete this._length;\n        };\n    \n    \n        /**\n         * Performs the md5 hash on a string.\n         * A conversion will be applied if utf8 string is detected.\n         *\n         * @param {String}  str The string\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hash = function (str, raw) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n    \n            var hash = md51(str);\n    \n            return raw ? hash : hex(hash);\n        };\n    \n        /**\n         * Performs the md5 hash on a binary string.\n         *\n         * @param {String}  content The binary string\n         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hashBinary = function (content, raw) {\n            var hash = md51(content);\n    \n            return raw ? hash : hex(hash);\n        };\n    \n        /**\n         * SparkMD5 OOP implementation for array buffers.\n         *\n         * Use this class to perform an incremental md5 ONLY for array buffers.\n         */\n        SparkMD5.ArrayBuffer = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n    \n        ////////////////////////////////////////////////////////////////////////////\n    \n        /**\n         * Appends an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array to be appended\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n            //       if you find yourself needing extra performance, please make a PR.\n            var buff = this._concatArrayBuffer(this._buff, arr),\n                length = buff.length,\n                i;\n    \n            this._length += arr.byteLength;\n    \n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n            }\n    \n            // Avoids IE10 weirdness (documented above)\n            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n    \n            return this;\n        };\n    \n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                i,\n                ret;\n    \n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n            }\n    \n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n    \n            this.reset();\n    \n            return ret;\n        };\n    \n        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n    \n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.reset = function () {\n            this._buff = new Uint8Array(0);\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n    \n            return this;\n        };\n    \n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n    \n        /**\n         * Concats two array buffers, returning a new one.\n         *\n         * @param  {ArrayBuffer} first  The first array buffer\n         * @param  {ArrayBuffer} second The second array buffer\n         *\n         * @return {ArrayBuffer} The new array buffer\n         */\n        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n            var firstLength = first.length,\n                result = new Uint8Array(firstLength + second.byteLength);\n    \n            result.set(first);\n            result.set(new Uint8Array(second), firstLength);\n    \n            return result;\n        };\n    \n        /**\n         * Performs the md5 hash on an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array buffer\n         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n            var hash = md51_array(new Uint8Array(arr));\n    \n            return raw ? hash : hex(hash);\n        };\n        \n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n    \n            loadFromBlob: function( file ) {\n                var blob = file.getSource(),\n                    chunkSize = 2 * 1024 * 1024,\n                    chunks = Math.ceil( blob.size / chunkSize ),\n                    chunk = 0,\n                    owner = this.owner,\n                    spark = new SparkMD5.ArrayBuffer(),\n                    me = this,\n                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n                    loadNext, fr;\n    \n                fr = new FileReader();\n    \n                loadNext = function() {\n                    var start, end;\n    \n                    start = chunk * chunkSize;\n                    end = Math.min( start + chunkSize, blob.size );\n    \n                    fr.onload = function( e ) {\n                        spark.append( e.target.result );\n                        owner.trigger( 'progress', {\n                            total: file.size,\n                            loaded: end\n                        });\n                    };\n    \n                    fr.onloadend = function() {\n                        fr.onloadend = fr.onload = null;\n    \n                        if ( ++chunk < chunks ) {\n                            setTimeout( loadNext, 1 );\n                        } else {\n                            setTimeout(function(){\n                                owner.trigger('load');\n                                me.result = spark.end();\n                                loadNext = file = blob = spark = null;\n                                owner.trigger('complete');\n                            }, 50 );\n                        }\n                    };\n    \n                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n                };\n    \n                loadNext();\n            },\n    \n            getResult: function() {\n                return this.result;\n            }\n        });\n    });\n    /**\n     * @fileOverview FlashRuntime\n     */\n    define('runtime/flash/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n    \n        var $ = Base.$,\n            type = 'flash',\n            components = {};\n    \n    \n        function getFlashVersion() {\n            var version;\n    \n            try {\n                version = navigator.plugins[ 'Shockwave Flash' ];\n                version = version.description;\n            } catch ( ex ) {\n                try {\n                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n                            .GetVariable('$version');\n                } catch ( ex2 ) {\n                    version = '0.0';\n                }\n            }\n            version = version.match( /\\d+/g );\n            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n        }\n    \n        function FlashRuntime() {\n            var pool = {},\n                clients = {},\n                destroy = this.destroy,\n                me = this,\n                jsreciver = Base.guid('webuploader_');\n    \n            Runtime.apply( me, arguments );\n            me.type = type;\n    \n    \n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/ ) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n    \n                clients[ uid ] = client;\n    \n                if ( components[ comp ] ) {\n                    if ( !pool[ uid ] ) {\n                        pool[ uid ] = new components[ comp ]( client, me );\n                    }\n    \n                    instance = pool[ uid ];\n    \n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n    \n                return me.flashExec.apply( client, arguments );\n            };\n    \n            function handler( evt, obj ) {\n                var type = evt.type || evt,\n                    parts, uid;\n    \n                parts = type.split('::');\n                uid = parts[ 0 ];\n                type = parts[ 1 ];\n    \n                // console.log.apply( console, arguments );\n    \n                if ( type === 'Ready' && uid === me.uid ) {\n                    me.trigger('ready');\n                } else if ( clients[ uid ] ) {\n                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n                }\n    \n                // Base.log( evt, obj );\n            }\n    \n            // flash的接受器。\n            window[ jsreciver ] = function() {\n                var args = arguments;\n    \n                // 为了能捕获得到。\n                setTimeout(function() {\n                    handler.apply( null, args );\n                }, 1 );\n            };\n    \n            this.jsreciver = jsreciver;\n    \n            this.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n    \n            this.flashExec = function( comp, fn ) {\n                var flash = me.getFlash(),\n                    args = Base.slice( arguments, 2 );\n    \n                return flash.exec( this.uid, comp, fn, args );\n            };\n    \n            // @todo\n        }\n    \n        Base.inherits( Runtime, {\n            constructor: FlashRuntime,\n    \n            init: function() {\n                var container = this.getContainer(),\n                    opts = this.options,\n                    html;\n    \n                // if not the minimal height, shims are not initialized\n                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n                container.css({\n                    position: 'absolute',\n                    top: '-8px',\n                    left: '-8px',\n                    width: '9px',\n                    height: '9px',\n                    overflow: 'hidden'\n                });\n    \n                // insert flash object\n                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n    \n                if ( Base.browser.ie ) {\n                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n                }\n    \n                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n                    '&jsreciver=' + this.jsreciver + '\" />' +\n                    '<param name=\"wmode\" value=\"transparent\" />' +\n                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n                '</object>';\n    \n                container.html( html );\n            },\n    \n            getFlash: function() {\n                if ( this._flash ) {\n                    return this._flash;\n                }\n    \n                this._flash = $( '#' + this.uid ).get( 0 );\n                return this._flash;\n            }\n    \n        });\n    \n        FlashRuntime.register = function( name, component ) {\n            component = components[ name ] = Base.inherits( CompBase, $.extend({\n    \n                // @todo fix this later\n                flashExec: function() {\n                    var owner = this.owner,\n                        runtime = this.getRuntime();\n    \n                    return runtime.flashExec.apply( owner, arguments );\n                }\n            }, component ) );\n    \n            return component;\n        };\n    \n        if ( getFlashVersion() >= 11.4 ) {\n            Runtime.addRuntime( type, FlashRuntime );\n        }\n    \n        return FlashRuntime;\n    });\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/flash/filepicker',[\n        'base',\n        'runtime/flash/runtime'\n    ], function( Base, FlashRuntime ) {\n        var $ = Base.$;\n    \n        return FlashRuntime.register( 'FilePicker', {\n            init: function( opts ) {\n                var copy = $.extend({}, opts ),\n                    len, i;\n    \n                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n                len = copy.accept && copy.accept.length;\n                for (  i = 0; i < len; i++ ) {\n                    if ( !copy.accept[ i ].title ) {\n                        copy.accept[ i ].title = 'Files';\n                    }\n                }\n    \n                delete copy.button;\n                delete copy.id;\n                delete copy.container;\n    \n                this.flashExec( 'FilePicker', 'init', copy );\n            },\n    \n            destroy: function() {\n                this.flashExec( 'FilePicker', 'destroy' );\n            }\n        });\n    });\n    /**\n     * @fileOverview 图片压缩\n     */\n    define('runtime/flash/image',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n    \n        return FlashRuntime.register( 'Image', {\n            // init: function( options ) {\n            //     var owner = this.owner;\n    \n            //     this.flashExec( 'Image', 'init', options );\n            //     owner.on( 'load', function() {\n            //         debugger;\n            //     });\n            // },\n    \n            loadFromBlob: function( blob ) {\n                var owner = this.owner;\n    \n                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n    \n                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/flash/transport',[\n        'base',\n        'runtime/flash/runtime',\n        'runtime/client'\n    ], function( Base, FlashRuntime, RuntimeClient ) {\n        var $ = Base.$;\n    \n        return FlashRuntime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n                this._responseJson = null;\n            },\n    \n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    binary;\n    \n                xhr.connectRuntime( blob.ruid );\n    \n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n    \n                    binary = blob.uid;\n                } else {\n                    $.each( owner._formData, function( k, v ) {\n                        xhr.exec( 'append', k, v );\n                    });\n    \n                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n                            opts.filename || owner._formData.name || '' );\n                }\n    \n                this._setRequestHeader( xhr, opts.headers );\n                xhr.exec( 'send', {\n                    method: opts.method,\n                    url: server,\n                    forceURLStream: opts.forceURLStream,\n                    mimeType: 'application/octet-stream'\n                }, binary );\n            },\n    \n            getStatus: function() {\n                return this._status;\n            },\n    \n            getResponse: function() {\n                return this._response || '';\n            },\n    \n            getResponseAsJson: function() {\n                return this._responseJson;\n            },\n    \n            abort: function() {\n                var xhr = this._xhr;\n    \n                if ( xhr ) {\n                    xhr.exec('abort');\n                    xhr.destroy();\n                    this._xhr = xhr = null;\n                }\n            },\n    \n            destroy: function() {\n                this.abort();\n            },\n    \n            _initAjax: function() {\n                var me = this,\n                    xhr = new RuntimeClient('XMLHttpRequest');\n    \n                xhr.on( 'uploadprogress progress', function( e ) {\n                    var percent = e.loaded / e.total;\n                    percent = Math.min( 1, Math.max( 0, percent ) );\n                    return me.trigger( 'progress', percent );\n                });\n    \n                xhr.on( 'load', function() {\n                    var status = xhr.exec('getStatus'),\n                        readBody = false,\n                        err = '',\n                        p;\n    \n                    xhr.off();\n                    me._xhr = null;\n    \n                    if ( status >= 200 && status < 300 ) {\n                        readBody = true;\n                    } else if ( status >= 500 && status < 600 ) {\n                        readBody = true;\n                        err = 'server';\n                    } else {\n                        err = 'http';\n                    }\n    \n                    if ( readBody ) {\n                        me._response = xhr.exec('getResponse');\n                        me._response = decodeURIComponent( me._response );\n    \n                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n                        // try {\n                        //     me._responseJson = xhr.exec('getResponseAsJson');\n                        // } catch ( error ) {\n                            \n                        p = window.JSON && window.JSON.parse || function( s ) {\n                            try {\n                                return new Function('return ' + s).call();\n                            } catch ( err ) {\n                                return {};\n                            }\n                        };\n                        me._responseJson  = me._response ? p(me._response) : {};\n                            \n                        // }\n                    }\n                    \n                    xhr.destroy();\n                    xhr = null;\n    \n                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n                });\n    \n                xhr.on( 'error', function() {\n                    xhr.off();\n                    me._xhr = null;\n                    me.trigger( 'error', 'http' );\n                });\n    \n                me._xhr = xhr;\n                return xhr;\n            },\n    \n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.exec( 'setRequestHeader', key, val );\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/flash/blob',[\n        'runtime/flash/runtime',\n        'lib/blob'\n    ], function( FlashRuntime, Blob ) {\n    \n        return FlashRuntime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.flashExec( 'Blob', 'slice', start, end );\n    \n                return new Blob( blob.uid, blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Md5 flash实现\n     */\n    define('runtime/flash/md5',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n        \n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n    \n            loadFromBlob: function( blob ) {\n                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview 完全版本。\n     */\n    define('preset/all',[\n        'base',\n    \n        // widgets\n        'widgets/filednd',\n        'widgets/filepaste',\n        'widgets/filepicker',\n        'widgets/image',\n        'widgets/queue',\n        'widgets/runtime',\n        'widgets/upload',\n        'widgets/validator',\n        'widgets/md5',\n    \n        // runtimes\n        // html5\n        'runtime/html5/blob',\n        'runtime/html5/dnd',\n        'runtime/html5/filepaste',\n        'runtime/html5/filepicker',\n        'runtime/html5/imagemeta/exif',\n        'runtime/html5/androidpatch',\n        'runtime/html5/image',\n        'runtime/html5/transport',\n        'runtime/html5/md5',\n    \n        // flash\n        'runtime/flash/filepicker',\n        'runtime/flash/image',\n        'runtime/flash/transport',\n        'runtime/flash/blob',\n        'runtime/flash/md5'\n    ], function( Base ) {\n        return Base;\n    });\n    /**\n     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n     *\n     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n     *\n     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n     *\n     * 如：\n     * WebUploader.create({\n     *     ...\n     *\n     *     disableWidgets: 'log',\n     *\n     *     ...\n     * })\n     */\n    define('widgets/log',[\n        'base',\n        'uploader',\n        'widgets/widget'\n    ], function( Base, Uploader ) {\n        var $ = Base.$,\n            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n            product = (location.hostname || location.host || 'protected').toLowerCase(),\n    \n            // 只针对 baidu 内部产品用户做统计功能。\n            enable = product && /baidu/i.exec(product),\n            base;\n    \n        if (!enable) {\n            return;\n        }\n    \n        base = {\n            dv: 3,\n            master: 'webuploader',\n            online: /test/.exec(product) ? 0 : 1,\n            module: '',\n            product: product,\n            type: 0\n        };\n    \n        function send(data) {\n            var obj = $.extend({}, base, data),\n                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n                image = new Image();\n    \n            image.src = url;\n        }\n    \n        return Uploader.register({\n            name: 'log',\n    \n            init: function() {\n                var owner = this.owner,\n                    count = 0,\n                    size = 0;\n    \n                owner\n                    .on('error', function(code) {\n                        send({\n                            type: 2,\n                            c_error_code: code\n                        });\n                    })\n                    .on('uploadError', function(file, reason) {\n                        send({\n                            type: 2,\n                            c_error_code: 'UPLOAD_ERROR',\n                            c_reason: '' + reason\n                        });\n                    })\n                    .on('uploadComplete', function(file) {\n                        count++;\n                        size += file.size;\n                    }).\n                    on('uploadFinished', function() {\n                        send({\n                            c_count: count,\n                            c_size: size\n                        });\n                        count = size = 0;\n                    });\n    \n                send({\n                    c_usage: 1\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('webuploader',[\n        'preset/all',\n        'widgets/log'\n    ], function( preset ) {\n        return preset;\n    });\n    return require('webuploader');\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/plugin/webuploader/webuploader.js\n// module id = 85\n// module chunks = 3 5 6 11 15 29 33","var tpl = require('./content.tpl');\nvar Dialog = require('dialog');\n\nvar create = function(data, options){\n    var content = tpl(data || {}); // 显示编辑弹窗之前,需要自己拼装数据\n    options = options || {};\n\n    var defaults = {\n        title: '选择图片',\n        modal: true,\n        fixed: true,\n        content: content,\n        className: 'pop-box',\n        okValue: '插入图片',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        cancalValue : '取消',\n        btnWrapCls: 'insert-cancel'\n        /*function () {\n            // var value = $('#property-returnValue-demo').val();\n            // this.close(value);\n            // this.remove();\n        }*/\n    };\n    $.extend(true, defaults, options);\n    return Dialog(defaults);\n};\n\nmodule.exports = {\n    create: create\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/upload/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,maxlength=$data.maxlength,total=$data.total,$out='';$out+='<div data-node=\"uploadBox\"> <div class=\"pics-list-wrap clearfix\"> <ul class=\"pics-list clearfix\" data-node=\"uploadList\"> <li data-defaultAddFile=\\'picker\\'></li> </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"addNum\">';\n$out+=$escape(maxlength);\n$out+='</span><span class=\"deep-gray\">/';\n$out+=$escape(total);\n$out+='</span>张图片</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/upload/content.tpl\n// module id = 97\n// module chunks = 4 5 15 29","/**\n * 分享到 微信，QQ，微博，空间\n * @author Zhengchun Fu\n */\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar getQRCode = require('utils/getQRCode');\nvar checkLoginStatus = require('module/checkLoginStatus');\n\nvar APIS = {\n    qq: \"http://connect.qq.com/widget/shareqq/index.html\",\n    wb: \"http://v.t.sina.com.cn/share/share.php\",\n    qz: \"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey\"\n};\n\nvar defaultInfo = {\n    url: 'https://group.gomeplus.com/',\n    title: '国美APP边玩边分享，购物不孤单',\n    pic: '../../images/public/logo.png', // logo图片地址\n    summary: '国美APP边玩边分享，购物不孤单'\n};\n\nvar open = function(url) {\n    window.open(url);\n};\n\n// 分享按钮渲染\nvar hasShareBtnsHTML = false;\nvar initShareBtns = function() {\n    var shareBtns = '<p data-node=\"shareBtnBox\" class=\"share-down\" style=\"z-index:21;\"><span class=\"share-box\"><span class=\"icon icon-up-arrow\"></span><span class=\"icon-box\"><em data-shareto=\"weixin\" class=\"iconn-30\"></em><em data-shareto=\"qq\" class=\"iconn-32\"></em><em data-shareto=\"sina\" class=\"iconn-31\"></em><em data-shareto=\"qzone\" class=\"iconn-33\"></em></span></span></p>';\n    $('body').append(shareBtns);\n    hasShareBtnsHTML = true;\n};\nvar showShareToBtns = function(style) {\n    !hasShareBtnsHTML && initShareBtns();\n    $('[data-node=shareBtnBox]').css({\n        left: style.x,\n        top: style.y\n    }).show();\n};\n\n// 微信弹层渲染\nvar hasWeixinHTML = false;\nvar initWeixinHTML = function() {\n\n    var weixinBox = '<div class=\"share-weixin\"><div class=\"wx-mask\"></div><div class=\"wx-main\"><div class=\"wx-code\"><span></span><img data-node=\"shareWeixinCode\" alt=\"分享到微信\" /></div><p>打开微信扫一扫，即可分享</p><a href=\"javascript:;\" title=\"点击关闭\" class=\"wx-close\">×</a></div></div>';\n    $('body').append(weixinBox);\n    hasWeixinHTML = true;\n};\n\n// pics: 图片参数是否为pics，默认是pic。\nvar formatParams = function(p, pics) {\n    var s = [];\n    var data = {\n        title: p.title,\n        url: p.url,\n        summary: p.summary,\n        //desc: p.desc,\n        site: p.site\n    };\n\n    for (var i in data) {\n        s.push(i + '=' + encodeURIComponent(data[i] || ''));\n    }\n    if (pics) {\n        s.push('pics=' + p.pic);\n    } else {\n        s.push('pic=' + p.pic);\n    }\n    return s.join('&');\n};\n\n// 单个调用方法\n// 分享的图片多个用||隔开。\nvar shareTo = {\n    weixin: function(options) {\n        var link = getQRCode(options.url);\n        !hasWeixinHTML && initWeixinHTML();\n\n        $('[data-node=shareWeixinCode]')[0].src = link;\n        $('.share-weixin').show();\n        $('.wx-close').on('click', function() {\n            $('.share-weixin').hide();\n        });\n    },\n    qq: function(options) {\n        var link = APIS.qq + '?' + formatParams(options, true);\n        open(link);\n    },\n    wb: function(options) {\n        var link = APIS.wb + '?' + formatParams(options);\n        open(link);\n    },\n    qz: function(options) {\n        var link = APIS.qz + '?' + formatParams(options, true);\n        open(link);\n    }\n};\n\n// share with kid\nvar shareWithKid = function(args) {\n    var isRebate = args.isRebate === '0' ? false : true;\n    fetch.get(url.get('shareGetGoodsKid'), {\n        validate: isRebate,\n        data: {\n            skuId: args.skuId,\n            itemId: args.itemId,\n            parentKid: args.parentKid\n        },\n        async: false // 防止新窗口被拦截\n    }).done(function(data) {\n        if (data.success === true) {\n            var kid = data.data.kid;\n            var shareInfo = args.shareInfo;\n            // 替换分享链接\n            // 规则：mall_domain+product/shopid-productId.html?onlineUserId=xxxx&kid=xxxx\n            var url = shareInfo.url;\n            var index = url.indexOf('?');\n            if (index > 0) {\n                url = url.substring(0, index);\n            }\n            shareInfo.url = url + '?onlineUserId=' + shareInfo.onlineUserId + '&kId=' + kid;\n            shareTo[args.shareto](shareInfo);\n        } else {\n            shareTo[args.shareto](args.shareInfo);\n        }\n    }).fail(function() {\n        if (isRebate) {\n            if (checkLoginStatus()) {\n                shareTo[args.shareto](args.shareInfo);\n            }\n        } else {\n            shareTo[args.shareto](args.shareInfo);\n        }\n    });\n};\n\n// 统一方法\nvar go = function(obj) {\n    // {type:x,title:x,url:x,pic:x}\n    var info = {\n        title: obj.title || defaultInfo.title,\n        url: obj.url || defaultInfo.url,\n        pic: obj.pic || defaultInfo.pic,\n        summary: obj.summary || '',\n        desc: obj.desc || ''\n    };\n\n    !!shareTo[obj.type] && shareTo[obj.type](info);\n\n};\n\n/**\n * 简化分享\n * @param  {str} [parent] [容器节点]\n * @param {str} [selector] [子节点选择器]\n */\nvar shareItem = function(parent, selector, beforeShare) {\n    var shareInfo = null;\n    var $item = null;\n    $item = typeof parent === 'string' ? $(parent) : parent;\n    selector = selector || '[data-action=shareto]';\n    // 显示分享按钮\n    $item.on('mouseenter', selector, function() {\n        var shareUrl = $(this).data('surl');\n        var shareTitle = $(this).data('stitle');\n        var sharePic = $(this).data('spic');\n\n        shareInfo = {\n            url: shareUrl,\n            title: shareTitle,\n            pic: sharePic\n        };\n\n        var pw = $(this).width();\n        var ph = $(this).height();\n        var px = ($(this).offset().left / 1 + pw / 2 - 80) + 'px';\n        var py = ($(this).offset().top / 1 + (ph - 1)) + 'px';\n\n        showShareToBtns({\n            x: px,\n            y: py\n        });\n        return false;\n    });\n    // 隐藏分享按钮\n    $item.on('mouseleave', selector, function() {\n        $('[data-node=shareBtnBox]').hide();\n        return false;\n    });\n\n    $('body').on('click', '[data-shareto]', function(e) {\n        e.preventDefault();\n        var shareType = $(this).data('shareto');\n        shareInfo.type = shareType;\n        beforeShare = beforeShare || function() {};\n        beforeShare.call(null, shareInfo);\n        go(shareInfo);\n    });\n\n    $('body').on('mouseenter', '[data-node=shareBtnBox]', function() {\n        $(this).show();\n    });\n    $('body').on('mouseleave', '[data-node=shareBtnBox]', function() {\n        $(this).hide();\n    });\n};\n\nmodule.exports = {\n    share: go,\n    shareto: shareTo,\n    shareItem: shareItem,\n    shareWithKid: shareWithKid\n};\n\n/**\n * 分享到 使用说明\n * 在[data-action=shareto]节点上输出要获取的数据\n * data-surl,data-stitle,data-spic\n * url要是绝对地址，带https?://的\n * pic是要分享的图片绝对地址，多张图片用||隔开。\n *\n * 页面中在分享按钮加 [data-action=shareto] 自定义属性；\n * 如果是分享当前页面的也要加shareInfo,值为当前页面对应的信息。格式都一样。\n *\n * 调用方法:\n * var share = require(..);\n * share.shareItem(要分享的区域父节点字符串e.g. 'data-node=shareList');\n *\n * shareto.weixin({shareInfo})\n * shareto.qq({shareInfo})\n * shareto.sina({shareInfo})\n * shareto.qzone({shareInfo})\n *\n *\n * share.share({shareInfo});这个shareInfo里要有type：[weixin,qq,sina,qzone]\n */\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/share.js","// 根据字符串生成二维码\nvar getQRCode = function(url) {\n    return $_CONFIG.group_domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(url);\n};\n\nmodule.exports = getQRCode;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/getQRCode.js","var uploadPop = require('module/popup/upload/dialog'),\n    Pubsub = require('io/pubsub'),\n    pubName = require('io/channel');\nvar upload = require('module/upload');\nvar alert = require('module/popup/alert');\nvar imgReplace = require('utils/imgReplace');\n\nvar init = function(maxLen, total) {\n    var dialogUploader,\n        $webUpLoader,\n        maxlength = maxLen;\n    if (maxlength > 0) {\n\n        dialogUploader = uploadPop.create({\n            maxlength: maxlength,\n            total: total\n        }, {\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                var $imgList = $('[data-node=\"uploadList\"] img'),\n                    images = [];\n                for (var i = 0, len = $imgList.length; i < len; i++) {\n                    images.push($imgList.eq(i).attr('src'));\n                }\n                //maxLen -= images.length;\n                Pubsub(pubName.setPubliser.changeImage).pub({\n                    images: images\n                });\n                $('[data-node=picPopBox]').hide();\n            },\n            cancel: function() {\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                $('[data-node=picPopBox]').hide();\n            }\n        });\n\n        $webUpLoader = upload.init({\n            maxlength: maxlength,\n            callbacks: {\n                onFileQueued: function(file, numList, number) {\n                    var $uploadBox = $('[data-node=\"uploadBox\"]');\n                    var picker = '[data-defaultaddfile=\"picker\"]';\n                    $('[data-node=picPopBox]').addClass('webuploader-element-invisible');\n                    dialogUploader.show();\n                    $uploadBox.find(picker).children().eq(0).html('<em class=\"icon-add\"></em>');\n                    var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n                    $uploadBox.find(picker).before(html);\n                    $uploadBox.find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n                    if (numList[file.source.ruid] === ~~number) {\n                        $uploadBox.find(picker).hide();\n                    }\n                    $uploadBox.find(picker).children().eq(1).css({\n                        'width': '78px',\n                        'height': '78px'\n                    })\n                },\n\n                onUploadSuccess: function(file, response) {\n                    if (response.code === 200 && response.success) {\n                        $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                        // 激活提交按钮\n                        $('[i-id=ok]').removeClass('btn-default');\n                    } else {\n                        $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                    }\n                }\n            }\n        });\n    } else {\n        alert('您最多能添加' + maxLen + '张图片哦！');\n    }\n    return $webUpLoader;\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/uploader.js","/***\n * upload.js\n * @author zhaodonghong\n * @params                      object      上传图片参数\n *     maxlength               number      可上传图片最大张数\n *     selector                object      jq选择器\n *         parents             string      每个图片上传外层jq选择器\n *         delSelector         string      删除按钮jq选择器\n *         selector            string      实例化上传插件的pick.id的值\n *     defaultApi              object      实例化webuploader参数\n *     callbacks               object      实例化webuploader方法回调集合\n *         onBeforeFileQueued  function    上传图片添加到上传队列之前\n *         onFileQueued        function    上传图片添加到上传队列后\n *         onUploadSuccess     function    上传成功\n *         onUploadError       function    上传失败\n *         onUploadProgress    function    上传中\n *         onErrored           function    报错\n *         retry               function    重新上传\n *         delImage            function    删除上传图片\n */\n\nvar WebUploader = require('../plugin/webuploader/webuploader');\nvar hint = require('module/hint');\nvar notice = require('module/i18n');\nvar imgReplace = require('utils/imgReplace');\nvar init = function(options) {\n\n    //var number = maxlength;\n    var numList = {};\n    var $webUpLoader;\n    var files = {};\n    var defaultOptions = {\n        //最大上传张数\n        maxlength: options.maxlength || 9,\n        //选择器\n        selector: {\n            parents: '[data-node=\"uploadBox\"]', //每个图片上传外层jq选择器\n            delSelector: '[data-action=\"delImage\"]', //删除按钮jq选择器\n            selector: '[data-defaultAddFile=picker]' //初始化时options.defaultApi.pick 的值，也就是 选择器的值\n        }\n    };\n    //初始化参数\n    defaultOptions.defaultApi = {\n        pick: {\n            id: '[data-defaultAddFile=picker]',\n            innerHTML: '本地上传图片'\n        },\n        accept: {\n            title: 'Images',\n            extensions: 'jpg,jpeg,png,gif',\n            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\n        },\n        method: 'post',\n        // swf文件路径\n        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\n        auto: true,\n        disableGlobalDnd: true,\n        duplicate: true,\n        prepareNextFile: true,\n        chunked: true,\n        fileVal: 'avatar_file',\n        server: '/ajax/crop/crop_img',\n        fileNumLimit: defaultOptions.maxlength * $(defaultOptions.selector).length,\n        fileSizeLimit: defaultOptions.maxlength * $(defaultOptions.selector).length * 4 * 1024 * 1024, // 50 M\n        fileSingleSizeLimit: 4 * 1024 * 1024\n    };\n    defaultOptions.callbacks = {\n        /***\n         * name: 图片加入队列之前\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * number: 最多可上传数\n         */\n        onBeforeFileQueued: function( /*file, numList, number*/ ) {\n            hint.init(notice.upload.excess);\n        },\n\n        /***\n         * name: 图片添加入队列后\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * maxlength: 最多可上传数\n         */\n        onFileQueued: function(file, numList, number) {\n            var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n            $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').before(html);\n\n            $('#rt_' + file.source.ruid).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\n            if (numList[file.source.ruid] === ~~number) {\n                $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').hide();\n            }\n\n        },\n\n        /***\n         * name: 上传成功（此成功指ajax有返回结果，故需要判断返回的状态码）\n         * file: 图片信息对象\n         * response: 上传图片ajax返回数据\n         */\n        onUploadSuccess: function(file, response) {\n            if (response.code === 200 && response.success) {\n                $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                //$('#' + file.id).html('<img src=\"' + imgReplace(response.data[0]) + '\" _src = \"' + response.data[0] + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            } else {\n                $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            }\n        },\n\n        /***\n         * name: 上传失败\n         * file: 图片信息对象\n         * reason: 出错的code\n         */\n        onUploadError: function(file /*, reason*/ ) {\n            $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n        },\n\n        /***\n         * name: 上传时，包含进度条\n         * file: 图片信息对象\n         * percentage: 上传进度\n         */\n        onUploadProgress: function(file, percentage) {\n            $('#' + file.id).find('[data-node=\"progress\"]').css('width', percentage * 100 + '%');\n        },\n\n        /***\n         * name: 报错\n         * type: 报错类型\n         */\n        onErrored: function( /*type*/ ) {\n            hint.init(notice.upload.uploadError);\n        },\n\n        //重新上传\n        retry: function() {\n            var _this = this;\n            $('[data-node=\"uploadList\"]').on('click', '[data-action=\"retry\"]', function() {\n                _this.retry(files[$(this).parents('li').attr('id')]);\n            });\n        },\n\n        /***\n         * name: 删除图片\n         * webuploader: webuploader实例化对象\n         * numList: 自定义json对象，用来存储每个实例化对象已上传的图片个数\n         * id: 每个webuploader实例化时，上传按钮所生成的唯一id\n         */\n        delImage: function(webuploader, numList, id, number) {\n            $webUpLoader.removeFile(files[$(this).parents('li').attr('id')]);\n            $(this).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[id]);\n            $(this).parents('ul').find('[data-defaultAddFile=\"picker\"]').show();\n            $(this).parents('li').eq(0).remove();\n            if (numList[id] === 0) {\n                $('[i-id=ok]').addClass('btn-default');\n            };\n        }\n    };\n    options.callbacks = $.extend({}, defaultOptions.callbacks, options.callbacks);\n    /*var */\n    options = $.extend({}, defaultOptions, options);\n    $webUpLoader = WebUploader.create(options.defaultApi);\n\n    $webUpLoader.onFileQueued = function(file) {\n        var ruid = $('[data-node=\"uploadBox\"]').find('[data-defaultaddfile=\"picker\"]').children().eq(1).attr('id');\n        file.source.ruid = ruid;\n        numList[file.source.ruid] = numList[file.source.ruid] !== undefined ? numList[file.source.ruid] : 0;\n        numList[file.source.ruid]++;\n        files[file.id] = file;\n        options.callbacks.onFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\n    };\n\n    //上传成功\n    $webUpLoader.on('uploadSuccess', function(file, response) {\n        options.callbacks.onUploadSuccess.call($webUpLoader, file, response);\n    });\n\n    //加入队列前\n    $webUpLoader.on('beforeFileQueued', function(file) {\n        if (numList[file.source.ruid] >= options.maxlength) {\n            options.callbacks.onBeforeFileQueued.call($webUpLoader, file, numList, options.maxlength);\n            return false;\n        }\n\n    });\n    //上传失败\n    $webUpLoader.on('uploadError', function(file, reason) {\n        options.callbacks.onUploadError.call($webUpLoader, file, reason);\n    });\n\n    //上传时\n    $webUpLoader.on('uploadProgress', function(file, percentage) {\n        options.callbacks.onUploadProgress.call($webUpLoader, file, percentage);\n    });\n\n    //报错\n    $webUpLoader.on('error', function(type) {\n        options.callbacks.onErrored.call($webUpLoader, type);\n    });\n    options.callbacks.retry.call($webUpLoader);\n\n    //删除图片\n    $(options.selector.parents).on('click', options.selector.delSelector, function() {\n        var id = $(this).parents(options.selector.parents).find(options.defaultApi.pick.id).children().eq(1).attr('id');\n        numList[id]--;\n        options.callbacks.delImage.call(this, $webUpLoader, numList, id, options.maxlength);\n    });\n\n    return $webUpLoader;\n}\n\nmodule.exports = {\n    init: init\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/upload.js"," var rules = /^https?:/i;\n var https = 'https';\n var imgRule = /^http/i;\n/* var grepStr = /-600!80\\./g;\n var grepOldStr = /\\.600q80\\.jpg/gi;*/\n var shotCut = \"-600!80\";\n var imgType = /\\.(jpg|jpeg|png)$/;\n\nvar grepStr1 = /(.+?)-[^\\.]+\\.(jp(e)?g|png|gif).*/;\nvar grepStr2 = /(.+?\\.(jp(e)?g|png|gif)).*/\n\n\n var imgReplace = function(src) {\n    return  src.replace(rules, '');\n }\n\nvar orignalImgReplace = function(src){\n    if(grepStr1.test(src)){\n        return src.replace(grepStr1,\"$1.$2\"); \n    }else{\n        return src.replace(grepStr2,\"$1\");\n    }\n      \n}\n\nvar addShortCut = function(src){\n    return src.replace(imgType,function($1){\n        return shotCut + $1;\n    })\n}\n var imgProto = function(src) {\n     if (src.indexOf(https) != -1) {\n         return 'https:';\n     } else {\n         return 'http:'\n     }\n }\n\n var changeSrc = function(container) {\n     var $imgs = container.find('img').not('[data-node=\"goodsPic\"]');\n     var len = $imgs.length;\n     for (var i = 0; i < len; i++) {\n         var _this = $($imgs[i])\n         var _src = _this.attr(\"_src\");\n         var _orignal = _this.attr(\"data-original\");\n         if (_orignal) {\n             _this.attr({\n                 'src': imgReplace(_orignal),\n                 '_src': imgReplace(_orignal),\n                 'proto': imgProto(_orignal)\n             })\n         } else if (!imgRule.test(_src)) {\n             var proto = _this.attr(\"proto\");\n             _this.attr(\"_src\", _src);\n         }\n\n     }\n }\n\n module.exports = {\n     imgReplace: imgReplace,\n     addShortCut:addShortCut,\n     imgProto: imgProto,\n     changeSrc: changeSrc,\n     orignalImgReplace:orignalImgReplace\n };\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/imgReplace.js","var codeTpl = require('./upload.tpl');\nvar imgPath = $GLOBAL_CONFIG['pcimgpath'];\n\n$('body').append(codeTpl({\n    imgPath: imgPath\n}));\n\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar qrTips = require('module/i18n');\nvar alert = require('module/popup/alert');\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\nvar domain = $_CONFIG['group_domain'];\n\nvar pageId = window.pageId;\nvar maxLen = config.imgLimitNUm;\nvar pageId = window.pageId;\nfunction Scans(o) {\n    this.qid = o.qid || 'single'; //是否创建实例的唯一标示\n    this.topicQrId = \"\";\n    this.$parent = o.$parent; //用于寻找插入图片的节点\n    this.uploadMaxNum = o.maxNum || 20; //上传图片限制\n    //this.currentMaxNum = 0; //当前能够上传图片\n    this.useNewCode = 0; //二维码是否过期的判断\n    this.interval = 0;\n    this.type = o.type || 'pubsliser'; //扫码来源  评论页？发布话题页？等\n    this.$showBox = o.$showBox; //二维码弹层\n    this.time = o.time || 2000; //轮询请求间隔\n    this.customInit = o.customInit || \"\";\n    this.customCb = o.customCb; //用户自定义回调函数\n    this.isLoad = 0;\n    // this.$insertDom = o.$insertDom; //插入图片的节点\n    this.imgArr = []; //存储二维码未过期时，获得的的图片总数\n    this.editor = o.editor || \"\"; //用于编辑器\n    this.$cover = o.$showBox.find('[data-node=\"cover\"]'); //是否上传中\n    this.$localBtn = o.$showBox.find('[data-node=\"upLocal\"]'); //是否上传中\n    this.$target = o.$target;\n    this.code = \"\";\n    this.btn = o.btn;\n\n}\n\nScans.prototype = {\n    constructor: Scans,\n    init: function() {\n        var _this = this;\n        if (_this.editor) {\n            //\n            /*_this.editor.document.body.addEventListener('DOMNodeRemoved', function(evt) {\n                var code = evt.keyCode || evt.which\n                if (code == 8) {\n                    var target = evt.target\n                    debugger;\n                    console.log(target.nodeName, target.previousSibling, target.previousSibling.nodeName)\n                    if (target.nodeName == \"#text\") {\n                        if (target.previousSibling && target.previousSibling.nodeName == \"IMG\") {\n            console.log(333)\n                        }\n                    }\n                }\n            })*/\n\n            /*$(_this.editor.document).on('DOMNodeRemoved DOMNodeInserted', 'img', function(e) {\n                if (_this.interval) {\n                    //console.log(666)\n                    setTimeout(function() {\n                        _this.sendNum();\n                    }, 100)\n\n                }\n            })*/\n\n            $(_this.editor.body).on('click', function(e) {\n                //$webUpLoader.destroy();\n                _this.hide();\n                e.preventDefault();\n            })\n        }\n\n        if (typeof _this.customInit == 'function') {\n            this.customInit(this);\n        }\n        $('body').on('click', /* _this.$showBox*/ '[data-node=\"picPopBox\"]', function(e) {\n            var tagName = e.target.tagName;\n            tagName = tagName == 'INPUT' || tagName == 'LABEL'\n            if (!tagName) {\n                e.stopPropagation();\n            } else {\n                _this.hide()\n            }\n\n        });\n\n        this.start();\n    },\n    start: function() {\n        if (!this.useNewCode) {\n            this.getCode()\n        } else {\n\n            if (this.checkShow()) {\n                this.hide()\n            } else {\n                this.show();\n            }\n        }\n    },\n    //获取图片数量\n    imgLength: function() {\n        if (this.editor) {\n            return $(this.$parent.getContent()).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n        } else {\n            return this.$parent.find(\"img\").length;\n        }\n    },\n    //获取二维码\n    getCode: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var datas = {\n            pageId: pageId,\n            maxNum: this.uploadMaxNum - len\n        }\n        var qid = _this.qid;\n        var qidArr = window.topicQrId; //检测window变量是否有此变量 格式为：\n        _this.show();\n        //topicQrId:{\n        //  qid1:s1111,\n        //  qid2:s2222\n        // }\n        if (qidArr[qid].qrcodeId) {\n            datas.qrcodeId = _this.topicQrId;\n        }\n        fetch\n            .get(url.get('getUploadQrCode'), {\n                data: datas\n            })\n            .done(function(data) {\n                if (data.success == true) {\n\n                    if (data.code == 200) {\n\n                        _this.useNewCode = 1;\n\n                        var _data = data.data;\n\n                        var str = domain + 'qrupload/index?pageId=' + _data.pageId + '&qrcodeId=' + _data.qrcodeId + '&type=' + _this.type;;\n                        str = domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(str);\n\n                        window.topicQrId[qid].qrcodeId = _this.topicQrId = _data.qrcodeId; //把data的值赋予 window [qid].qrcodeId\n\n                        _this.code = str; //把二维码的值放入\n                        _this.getCodeCb();\n\n                        _this.interval = setInterval(function() {\n                            _this.monitor();\n                        }, _this.time)\n\n                    }\n                } else {\n                    alert(data.message);\n                }\n            })\n            .fail(function(e, s) {})\n\n    },\n    //扫码轮询\n    monitor: function() {\n        var _this = this;\n        fetch\n            .post(url.get('topListenImg'), {\n                data: {\n                    code: pageId,\n                    groupkey: window.topicQrId[_this.qid].qrcodeId\n                }\n\n            })\n            .done(function(data) {\n\n                if (data.success == true) { //ok\n                    _this.scanCb(data);\n                } else {\n                    _this.hide();\n                }\n            }).fail(function(e, m) {\n                clearInterval(_this.interval);\n                _this.interval = 0;\n                _this.hide();\n                // alert(e);\n            })\n    },\n    sendNum: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var maxNum = this.uploadMaxNum - len;\n        fetch\n            .get(url.get('topicuploadMax'), {\n                data: {\n                    qrcodeId: _this.topicQrId,\n                    maxNum: maxNum\n                }\n            })\n    },\n    //插入图片\n    insertPic: function(data) {\n        for (var i = 0, len = data.length; i < len; i++) {\n            var _data = data[i];\n            var _img = imgReplace.imgReplace(_data);\n            var _proto = imgReplace.imgProto(_data);\n            var str = '<p><img src=\"' + _img + '\" _src=\"' + _img + '\" data-type=\"insertImg\" proto=\"' + _proto + '\"/></p>';\n            this.editor.execCommand('inserthtml', str);\n        }\n    },\n    //用户正在上传中\n    loading: function() {\n        this.isLoad = 1;\n        this.$showBox.show();\n        this.$cover.show();\n        this.$localBtn.addClass('upload-unable');\n        if (this.editor) {\n            this.editor.setDisabled();\n        }\n\n    },\n    //用户不在上传中\n    unLoading: function() {\n        this.isLoad = 0;\n        this.$cover.hide();\n        this.$cover.css(\"display\", \"none\");\n        this.$localBtn.removeClass('upload-unable');\n        if (this.editor) {\n            this.editor.setEnabled();\n        }\n\n    },\n    //检查弹层状态\n    checkShow: function() {\n        if (this.$showBox.is(\":visible\")) {\n            return true;\n        }\n        return false;\n    },\n    //调整弹窗位置\n    fixPop: function() {\n        var $btn = this.$target;\n        var offset = $btn.offset();\n        var x = offset.left;\n        var y = offset.top / 1 + 30;\n\n        return this.$showBox.css({\n            'top': y + 'px',\n            'left': x + 'px'\n        });\n\n    },\n    //显示弹层\n    show: function() {\n        this.$showBox.removeClass('webuploader-element-invisible');\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        this.fixPop().show();\n    },\n    //隐藏弹层\n    hide: function() {\n        if (this.isLoad != 1) {\n            this.$showBox.hide();\n        }\n    },\n    //获得二维码回调\n    getCodeCb: function() {\n        this.sendNum(); //发送二维码数量\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        //this.show();\n    },\n    //扫码回调\n    scanCb: function(data) {\n\n            switch (data.isload) {\n                case 1:\n                    this.unLoading()\n                    break;\n                case 2: //上传中\n                    this.loading()\n\n                    break;\n                case 3: //上传完成\n                    var dataArr = data.data;\n                    var tempArr = [];\n\n                    var diffLen = dataArr.length - this.imgArr.length;\n\n                    if (diffLen) {\n                        this.loading()\n                        this.imgArr = dataArr;\n                        tempArr = dataArr.slice(-diffLen)\n                        var _this = this;\n                        setTimeout(function() {\n                            _this.unLoading()\n                            _this.hide();\n                            if (typeof _this.customCb == 'function') {\n                                _this.customCb(tempArr, _this)\n                            } else {\n                                _this.insertPic(tempArr);\n                            }\n\n                        }, 500)\n                    }\n                    break;\n                case 10000:\n                    this.imgArr = [];\n                    this.isload = 0;\n                    this.useNewCode = 0; //useNewCode 为0 意味着二维码过期\n                    clearInterval(this.interval);\n                    this.interval = 0;\n                    this.hide();\n                    break;\n            }\n        }\n        //prototype end\n}\n\nmodule.exports = Scans;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/uploadfileQR/index.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/uploadfileQR/upload',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgPath=$data.imgPath,$out='';$out+='<div data-node=\"picPopBox\" class=\"picPopBox\" data-node=\"picPopBox\"> <em class=\"sanjiao\"></em> <div class=\"container clearfix\"> <div class=\"left\"> <div class=\"qr\"> <img src=\\'\\'/> <div class=\"cover\" data-node=\"cover\">上传中...</div> </div> <p>扫描二维码,上传手机图片</p> </div> <div class=\"right\" data-node=\"uploadList\"> <div class=\"pc-btn pc-btnh35\" data-defaultAddFile=\\'picker\\'></div> </div> </div> </div> <div data-node=\"picLoading\" class=\"picLoading hide\"> <img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/public/loading.gif\"/> <div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/uploadfileQR/upload.tpl\n// module id = 120\n// module chunks = 5 15 29","//白名单\nvar whiteList = {\n    a: ['target', 'href', 'title', 'class', 'data-node'],\n    div: ['class', 'style', 'data-node', 'unselectable', 'onselectstart', 'data-type', 'data-skuid'],\n    dl: ['class', 'style', 'data-node'],\n    dt: ['class', 'style'],\n    em: ['class', 'style', 'data-node'],\n    h1: ['data-node'],\n    h2: ['data-node'],\n    h3: ['data-node'],\n    h4: ['data-node'],\n    h5: ['data-node'],\n    h6: ['data-node'],\n    img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-index', 'data-type', 'data-node', 'data-original', 'onerror', 'proto'],\n    p: ['class', 'style', 'data-node'],\n    span: ['class', 'style', 'data-node'],\n    ul: ['class', 'style', 'data-node'],\n    ol: ['class', 'style', 'data-node'],\n    li: ['class', 'style', 'data-node']\n};\n\nvar defaults = {\n    //图片张数限制\n    imgLimitNUm: 20,\n    //商品个数限制\n    goodsLimitNUm: 9,\n    initialFrameWidth: 788,\n    initialFrameHeight: 400,\n    zIndex: 9,\n    autoClearinitialContent: true,\n    //服务器根目录\n    UEDITOR_HOME_URL: $_CONFIG['js_domain'],\n    //后台地址\n    //serverUrl:'php/1.php',\n    //serverUrl: $_CONFIG['group_domain'],\n    serverUrl: '',\n    //css 路径\n    themePath: $_CONFIG.csspath + '/css/module/',\n    //白名单\n    whitList: whiteList,\n    //工具栏\n    toolbars: [\n        ['bold', 'italic', 'underline', 'insertunorderedlist', 'insertorderedlist', 'justifyleft', 'justifycenter', 'justifyright']\n        //['insertunorderedlist', 'insertorderedlist']\n    ],\n    //iframe 内置样式\n    iframeCssUrl: $_CONFIG.csspath + '/css/module/iframestyle.css?v=' + $GLOBAL_CONFIG['versionData'],\n    //'//localhost:8017/src/js/editor/themes/iframestyle.css',\n    //纯文本粘贴\n    pasteplain: true,\n    //禁止div转换成p标签\n    allowDivTransToP: false,\n    //禁止缩放图片\n    imageScaleEnabled: false,\n    elementPathEnabled: false, // 关闭元素路径,调试时暂时开启\n    wordCount: false, // 字数统计\n    //禁止非同域上传图片\n    catchRemoteImageEnable: true,\n    //匹配快捷按键回调\n    // callbackKey: shortcutKey.callbackKey,\n    //右键菜单功能\n    enableContextMenu: false,\n    // 因为是用的自定义的弹窗,所以,关闭了编辑器自带的图片弹窗\n    imagePopup: false,\n    // 禁止自动保存\n    enableAutoSave: false,\n    // 自定义过滤规则\n    // filterTxtRules:filterTxtRules()\n};\nmodule.exports = defaults;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/config.js","var dialog = require('module/popup/addGoods/dialog');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar Pubsub = require('io/pubsub');\nvar tpl = require('module/popup/addGoods/content.tpl');\nvar itemlist = require('module/popup/addGoods/itemContent.tpl');\nvar defaultItemlist = require('module/popup/addGoods/defaultItemContent.tpl');\nvar pubName = require('io/channel');\nvar indexof = require('lodash/indexOf');\nvar alert = require('module/popup/alert');\n\nvar pageNum = 1;\nvar maxlength = 9;\nvar isDefault = true;\nvar keyWord = '';\nvar changedList = [];\nvar isGetMore = false;\nvar options = {};\nvar degree = 1;\n// var delChanged = [];\nvar addDialog;\n\nvar $searchTop = null,\n    $searchInput = null,\n    $searchBtn = null,\n    $searchNormal = null,\n    $searchLoading = null,\n    $searchFail = null,\n    $searchResult = null,\n    $searchList = null,\n    // $searchPage = null,\n    $changeNum = null,\n    $listBox = null,\n    $changeList = null,\n    $title = null,\n    $getMore = null,\n    $searchListBox = null;\n\nvar selectedGoods = {};\n\nvar init = function(changedGoods, max /* 最多可选 */ ) {\n    var returnList = [];\n    selectedGoods = {};\n    // var selectedGoodsBak = {};\n    for (var i in changedGoods) {\n        changedList.push(i);\n        returnList.push(changedGoods[i]);\n    }\n\n    maxlength = max || 9;\n    selectedGoods = $.extend(true, selectedGoods, changedGoods);\n    if (maxlength - returnList.length !== 0) {\n        options = {\n            title: ' ',\n            modal: true,\n            fixed: true,\n            width: 610,\n            content: tpl({\n                imgSrc: $_CONFIG.imgpath,\n                returnList: returnList,\n                maxlength: maxlength,\n                changeNum: maxlength - returnList.length\n            }),\n            className: 'pop-box',\n            okValue: '插入商品',\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            btnWrapCls: 'insert-cancel',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n                dialogClosed();\n            },\n            cancel: function() {\n                dialogClosed();\n            },\n            onshow: function() {\n\n                $('[i=\"title\"]').hide();\n                getNode(); //获取节点\n                defaultItem(pageNum); //默认输出内容\n                searchItem(); //搜索商品\n                reGet(); //重新获取\n                changeItem(); //选择添加的商品\n                getMoreItem(); //加载 更多\n                $('body').css({\n                    height: '100%',\n                    overflowY: 'hidden'\n                });\n            }\n        };\n\n    } else {\n        options = {};\n    }\n\n    addDialog = dialog.create(options);\n    setTimeout(function() {\n        addDialog.show();\n    }, 100)\n\n};\n//获取节点\nvar getNode = function() {\n    $searchTop = $('[data-node=\"addTopBox\"]');\n    $searchInput = $searchTop.find('[data-action=\"addSearchInput\"]');\n    $searchBtn = $searchTop.find('[data-action=\"addSearchBtn\"]');\n    $searchNormal = $('[data-node=\"searchNormal\"]');\n    $searchLoading = $('[data-node=\"searchLoading\"]');\n    $searchFail = $('[data-node=\"searchFail\"]');\n    $searchResult = $('[data-node=\"searchResultBox\"]');\n    $searchList = $searchResult.find('[data-node=\"searchResultList\"]');\n    $listBox = $searchResult.find('[data-node=\"changedBox\"]');\n    $changeList = $listBox.find('[data-node=\"searchChangeList\"]');\n    $changeNum = $searchResult.find('[data-node=\"searchChangeNum\"]');\n    $title = $('[data-node=\"title\"]'),\n        $getMore = $searchResult.find('[data-action=\"moreItem\"]');\n    $searchListBox = $searchList.parent();\n};\n\n//初始化进弹窗获取数据\nvar defaultItem = function(pageNum) {\n    getItems(url.get('getCollectItem'), {\n        data: {\n            page: pageNum,\n            pagesize: 10\n        },\n        done: function(result) {\n            var html = defaultItemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//搜索 商品\nvar searchItem = function() {\n    $searchInput.on('keyup', function(e) {\n        var keycode = e.which;\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).val());\n        //处理回车的情况\n        if (keycode === 13) {\n            if (keyWord !== '') {\n                if (keyWord.length < 2) {\n                    alert('请输入两个字符以上关键词');\n                } else {\n                    pageNum = 1;\n                    $title.hide();\n                    $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                    moreItem(pageNum, keyWord);\n                }\n            } else {\n                alert('请输入关键词');\n            }\n        }\n        //返回我收藏的商品列表\n        if (keyWord === '') {\n            $searchResult.children().eq(0).hide();\n            isDefault = true;\n            pageNum = 1;\n            $title.show();\n            defaultItem(pageNum); //默认输出内容\n\n        }\n    });\n    $searchBtn.on('click', function() {\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).prev().val());\n\n        if (keyWord !== '') {\n            if (keyWord.length < 2) {\n                alert('请输入两个字符以上关键词');\n            } else {\n                $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                pageNum = 1;\n                $title.hide();\n                moreItem(pageNum, keyWord);\n            }\n        } else {\n            alert('请输入关键词');\n        }\n\n    });\n};\n\n//获取更多商品\n\nvar moreItem = function(pageNum, txt) {\n    getItems(url.get('getMoreItem'), {\n        data: {\n            pagenum: pageNum,\n            pagesize: 10,\n            word: txt\n        },\n        done: function(result) {\n            var html = itemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (result.pageCount != \"1\") {\n                $getMore.hide();\n            }\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//ajax\nvar getItems = function(link, options) {\n    if (pageNum === 1) {\n        $searchList.hide();\n        $searchFail.hide();\n        $searchLoading.show();\n        $searchNormal.hide();\n    } else {\n        $getMore.show();\n    }\n    fetch.get(link, {\n        data: options.data\n    }).done(function(result) {\n\n        if (result.code === 200) {\n            var resultItem = result.data.collections === undefined ? result.data.items : result.data.collections;\n            if ((!resultItem || resultItem.length === 0) && isDefault) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('暂无收藏的商品，可以搜索查找！');\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else if (!resultItem || resultItem.length === 0) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('没有找到相关产品');\n                    $searchResult.children().eq(0).hide();\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else {\n                $searchResult.show().children().eq(0).show();\n                $searchList.show();\n                options.done.call(this, result);\n                $getMore.hide();\n                isGetMore = false;\n\n                if (resultItem.length < 10 && pageNum !== 1) {\n\n                    isGetMore = true;\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            }\n\n            // 重新定位弹窗位置\n            // addDialog.reset();\n\n        } else if (result.code === 881001) {\n            if (pageNum === 1) {\n                $searchNormal.show().text('没有找到相关产品');\n                $searchResult.children().eq(0).hide();\n            } else {\n                $getMore.show().find('span').text('没有可加载内容');\n            }\n        } else {\n            if (pageNum === 1) {\n                $searchFail.show();\n            } else {\n                $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n            }\n        }\n    }).fail(function() {\n        if (pageNum === 1) {\n            $searchFail.show();\n        } else {\n            $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n        }\n    }).always(function() {\n        $searchLoading.hide();\n    });\n};\n\n//重新获取\nvar reGet = function() {\n    $searchFail.on('click', function() {\n        if (pageNum === 1) {\n            $searchLoading.show();\n            $searchFail.hide();\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n    $getMore.on('click', '[node-action=\"reget\"]', function() {\n        $(this).parent().html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n        if (isDefault) {\n            defaultItem(pageNum);\n        } else {\n            moreItem(pageNum, keyWord);\n        }\n    });\n};\n\nvar changeItem = function() {\n    if ($changeList.children().length) {\n        $('[i-id=ok]').removeClass('btn-default');\n    }\n    $searchResult.on('click', '[data-action=\"item\"]', function() {\n        var $this = $(this);\n        var imgSrc = $this.find('img').attr('src'),\n            pId = $this.attr('data-pId'),\n            shopId = $this.attr('data-shopid'),\n            itemLink = $this.attr('data-link'),\n            skuId = $this.attr('data-skuId'),\n            html = '';\n        if (maxlength == 1) {\n            if ($changeList.children().length) {\n                $changeList.empty();\n                $searchList.children(\"dl\").removeClass(\"chosed-mer-true\");\n\n            }\n            $this.addClass(\"chosed-mer-true\");\n\n            if ($changeList.children().length === 0) {\n                $listBox.show();\n            }\n            selectedGoods = {};\n            selectedGoods[skuId] = {\n                shopId: shopId,\n                skuId: skuId,\n                PId: pId,\n                title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                img: imgSrc,\n                price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                // 融合后的新商品链接\n                link: itemLink,\n            };\n            html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\n            $changeList.append(html);\n            $changeNum.text(maxlength - $changeList.children().length);\n        } else {\n\n            if (!$(this).hasClass('chosed-mer-true')) {\n                if ($changeList.children().length >= maxlength) {\n                    alert('最多可选取' + maxlength + '个商品');\n                    return false;\n                }\n\n                changedList.push(skuId);\n                selectedGoods[skuId] = {\n                    shopId: shopId,\n                    skuId: skuId,\n                    PId: pId,\n                    title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                    img: imgSrc,\n                    price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                    // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                    // 融合后的新商品链接\n                    link: $(this).attr('data-link'),\n                };\n                $(this).addClass('chosed-mer-true');\n                html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n                if ($changeList.children().length === 0) {\n                    $listBox.show();\n                }\n                $changeList.append(html);\n                $changeNum.text(maxlength - $changeList.children().length);\n            } else {\n                var del = $changeList.find('[data-skuId=\"' + skuId + '\"]');\n                $(this).removeClass('chosed-mer-true');\n                del.remove();\n\n                var id = $(this).attr('data-skuId');\n                var index = changedList.indexOf(id);\n                if (index !== -1) {\n                    changedList.splice(index, 1)\n                }\n                delete selectedGoods[id];\n                if ($changeList.children().length === 0) {\n                    $listBox.hide();\n                }\n                $changeNum.text(maxlength - $changeList.children().length);\n            }\n\n        }\n\n        if ($changeList.children().length) {\n            $('[i-id=ok]').removeClass('btn-default');\n        } else {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n\n        addDialog.reset();\n\n    }).on('click', '[data-action=\"delChanged\"]', function() {\n        var id = $(this).closest('li').attr('data-skuId');\n        var index = changedList.indexOf(id);\n        if (index !== -1) {\n            changedList.splice(index, 1)\n        }\n        var _this = this;\n        $searchList.find('[data-skuId=\"' + $(_this).parent().attr('data-skuId') + '\"]').removeClass('chosed-mer-true');\n\n        $(_this).parents('li').remove();\n        delete selectedGoods[id];\n        if ($changeList.children().length === 0) {\n            $listBox.hide();\n        }\n        $changeNum.text(maxlength - $changeList.children().length);\n        if (!$changeList.children().length) {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n    });\n};\n\n//加载更多\nvar getMoreItem = function() {\n    $searchListBox.on('scroll', function() {\n        if (!isGetMore && $searchListBox.scrollTop() >= ($searchList.height() - $searchListBox.height())) {\n            isGetMore = true;\n            pageNum++;\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n};\n\n//弹窗关闭\nvar dialogClosed = function() {\n    degree++;\n    $('body').css({\n        height: 'auto',\n        overflowY: 'auto'\n    });\n\n    $searchListBox.off('scroll');\n    $searchResult.off('click');\n    $searchFail.off('click');\n    $searchInput.off('keyup');\n    $searchBtn.off('click');\n    pageNum = 1;\n    // delChanged = [];\n    isDefault = true;\n    keyWord = '';\n    isGetMore = false;\n    changedList = [];\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/addGoods.js","var Dialog = require('dialog');\r\n\r\n\r\n\r\nvar create = function(options) {\r\n    options = options || {};\r\n    var defaults = {\r\n        title: ' ',\r\n        modal: true,\r\n        fixed: true,\r\n        width: 350,\r\n        content: '<p class=\"del-pop-p\">您最多能添加9个商品哦！</p>',\r\n        className: 'pop-box',\r\n        okValue: '确定',\r\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\r\n        ok: function() {\r\n\r\n        },\r\n        onshow: function() {\r\n            $('[i=\"title\"]').hide();\r\n        }\r\n    };\r\n    $.extend(true, defaults, options);\r\n    return Dialog(defaults);\r\n};\r\n\r\n\r\nmodule.exports = {\r\n    create: create\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/addGoods/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgSrc=$data.imgSrc,returnList=$data.returnList,$each=$utils.$each,$value=$data.$value,$index=$data.$index,changeNum=$data.changeNum,maxlength=$data.maxlength,$out='';$out+=' <div class=\"search-box\" data-node=\"addTopBox\"> <input type=\"text\" placeholder=\"搜索商品\" data-action=\"addSearchInput\"> <em class=\"icon-search-sw\" data-action=\"addSearchBtn\"></em> </div> <div class=\"ui-dialog-title\" data-node=\"title\">我收藏的商品</div> <p class=\"no-saving-txt\" style=\"display:none;\" data-node=\"searchNormal\">暂无收藏的商品，可以搜索查找！</p> <div class=\"loading\" data-node=\"searchLoading\"><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\" alt=\"\"></div> <p class=\"failed-txt\" style=\"display:none;\" data-node=\"searchFail\">数据获取失败，点击重新加载！</p> <div style=\"display:';\n$out+=$escape((returnList.length === 0 ? 'none':''));\n$out+=';\" data-node=\"searchResultBox\"> <div class=\"merchant-list clearfix\" > <div class=\"clearfix\" data-node=\"searchResultList\"></div> <div class=\"more-comments pop-more-com\" data-action=\"moreItem\" style=\"display:none;\"> <span><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\">正在加载...</span> </div> </div> <div class=\"chosed-merchants\" data-node=\"changedBox\" style=\"display:';\n$out+=$escape((returnList.length>0?'':'none'));\n$out+='\"> <ul class=\"merchants-list clearfix\" data-node=\"searchChangeList\"> ';\n$each(returnList,function($value,$index){\n$out+=' <li data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" data-pid=\"';\n$out+=$escape($value.PId);\n$out+='\"> <img src=\"';\n$out+=$escape($value.img);\n$out+='\" alt=\"\" onerror=\"imgError(this)\"> <a href=\"javascript:;\" data-action=\"delChanged\"> <em class=\"icon-del-pic\"></em> </a> </li> ';\n});\n$out+=' </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"searchChangeNum\">';\n$out+=$escape(changeNum);\n$out+='</span>/<span class=\"deep-gray\">';\n$out+=$escape(maxlength);\n$out+='</span>个商品</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/content.tpl\n// module id = 128\n// module chunks = 5 15 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/itemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$string=$utils.$string,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"11111\" onerror=\"imgError(this)\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$string($value.name);\n$out+='</h4> <span><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.salePrice !== null?$value.salePrice:'暂无售价');\n$out+='</span></span> </dd> </dl> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/itemContent.tpl\n// module id = 129\n// module chunks = 5 15 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/defaultItemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-shopId=\"';\n$out+=$escape($value.shopId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"\" onerror=\"imgError(this,\\'m\\')\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$escape($value.name);\n$out+='</h4><span><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.skuPrice);\n$out+='</span></span> </dd> </dl> ';\n});\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/defaultItemContent.tpl\n// module id = 130\n// module chunks = 5 15 29","var fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar confirm = require('module/popup/confirm');\nvar tips = require(\"module/i18n\").circle;\nvar checkLoginStatus = require('module/checkLoginStatus');\nvar loginPop = require('module/popup/login');\n\n// var popTpl = \"<p data-node='alertTitle' class='dialog_p'>申请已发送，请耐心等待</p><img data-node='QRcode' src=''><p class='dialog_p'>下载国美APP随时关注</p>\";\n\nvar join = function (event){\n\tvar $els = event.data?event.data.selector||$(this):$(this);\n\tvar $action = $els.attr('data-action');\n\tvar done = event.data?event.data.done||function (){}:function (){};\n\tvar word = event.data?event.data.word||{ join : '加入圈子', focus : '退出圈子' }:{ join : '加入圈子', focus : '退出圈子' };\n\tvar groupId = $els.attr('data-groupid'),\n\t\tmemberType = $els.attr('data-membertype'),\n\t\tbpData = {\n\t\t\tevent_id: $els.attr('event-id'), // 埋点数据\n\t\t\tgroup_id: groupId,\n\t\t\tcircle_type: $_CONFIG['s_c'] // 2级分类\n\t\t};\n\tif ($_CONFIG['topicid']) {\n\t\tbpData.topic_id = $_CONFIG['topicid'];\n\t}\n\t// 发送统计数据\n\tif (window.BP !== undefined) {\n\t\tBP.send(bpData);\n\t}\n\n\tif ($els.attr('data-verif') == 1) {\n\t\talert('您已提交申请，请等待审核');\n\t\treturn;\n\t}\n\t/*var firing = $els.attr('data-firing');\n\tif (firing == 1) {\n\t\treturn false;\n\t}\n\t$els.attr('data-firing', 1);*/\n\tvar userid = $els.attr('data-userid');\n\t// var approvaltype = $els.attr('data-approvaltype');\n\n\n\tvar newWeb = '';\n\tvar noRefreshFetch = function(flag) {\n\t\tfetch.post(url.get('joinCircle'), {\n\t\t\t// validate: true,\n\t\t\tdata: {\n\t\t\t\tgroupid: groupId,\n\t\t\t\timid: 'b_' + userid\n\t\t\t}/*,\n\t\t\tonLogin: function (){\n\t\t\t\t$_CONFIG['islogin'] = '1';\n\t\t\t\tnoRefreshFetch();\n\t\t\t}*/\n\t\t}).done(function(data/*, textStatus, jqXHR*/) {\n\t\t\tif (data && data.code === 200 && data.success) {\n\t\t\t\tif (data.data.status === 0) {\n\t\t\t\t\tif($action && $action == 'joinGroup' && !flag) {\n\t\t\t\t\t\tconfirm(tips.joinSuccessPublic, {\n\t\t\t\t\t\t\t\tclassName: 'pop-box',\n\t\t\t\t\t\t\t\tokValue: '暂不发布',\n\t\t\t\t\t\t\t\tcancelValue: '立即发布话题',\n\t\t\t\t\t\t\t\tokCls: 'pc-btn pc-btnh35 circle-pop-btn circle-cancel-btn',\n\t\t\t\t\t\t\t\tcancelCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t\t\t\t\t\t\t\tcontent: '<button data-active=\"close-join\" class=\"ui-dialog-close icon icon-close\" title=\"取消\">×</button><div i=\"title\" class=\"ui-dialog-title\" style=\"border-bottom: none;\"></div><p class=\"del-pop-p\">' + tips.joinSuccessPublic + '</p>',\n\t\t\t\t\t\t\t\tok: function(){},\n\t\t\t\t\t\t\t\tcancel: function(){\n\t\t\t\t\t\t\t\t\t// var $postTopic = $('[data-node=postTopic]');\n\t\t\t\t\t\t\t\t\tvar url = 'topic/publiser?gid=' + $els.attr('data-groupid');\n\t\t\t\t\t\t\t\t\twindow.open($_CONFIG['group_domain']+url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if($action && $action == 'joinCircle') {\n\t\t\t\t\t\talert(tips.joinSuccess);\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(tips.joinSuccess);\n\t\t\t\t\t}\n\t\t\t\t\t$('[data-active=close-join]').on('click', function(){\n\t\t\t\t\t\t$('.pop-box-backdrop').hide();\n\t\t\t\t\t\t$('[role=alertdialog]').hide();\n\t\t\t\t\t})\n\t\t\t\t\t$els.html(word.focus);\n\t\t\t\t} else if (data.data.status === 1) {\n\t\t\t\t\t// alert('申请已发送，请耐心等待');\n\t\t\t\t\t// var Dialog = alert('', {\n\t\t\t\t\t//     width: \"500px\",\n\t\t\t\t\t//     content: popTpl,\n\t\t\t\t\t//     cancel: false\n\t\t\t\t\t// });\n\t\t\t\t\t$('[data-node=QRcode]').attr('src', $_CONFIG.imgpath + '/images/public/down-ma.png');\n\t\t\t\t\t$('.dialog_p').css({\n\t\t\t\t\t\t'text-align': 'center',\n\t\t\t\t\t\t'margin': '10px 0px',\n\t\t\t\t\t\t'font-size': '1.5em'\n\t\t\t\t\t});\n\t\t\t\t\t$('[data-node=QRcode]').css({\n\t\t\t\t\t\t'margin-left': '173px'\n\t\t\t\t\t});\n\t\t\t\t\t// $els.css('background', '#CCC').html('审核中').off();\n\t\t\t\t\t// $els.html(word.join);\n\t\t\t\t\talert('您已申请加入圈子，请等待圈主审核');\n                    done(\"joining\", $els);\n                    setTimeout(function() {\n                    \tflag && location.reload();\n\t\t\t\t\t}, 1500)\n\t\t\t\t}\n\t\t\t\tdone(\"join\", $els);\n\t\t\t} else {\n\t\t\t\tif (data.code === 403 || data.message == '圈子拒绝加入') {\n\t\t\t\t\talert(tips.cannotJoinCircle);\n\t\t\t\t} else if (data.code === 409) {\n\t\t\t\t\t$els.html(word.join);\n\t\t\t\t\tif(data.error) {\n\t                    if(data.error.code === '2' || data.message === '该圈子人数已达上限'){\n\t                        alert(data.message);\n\t\t\t\t\t\t\tdone(\"limit\", $els);\n\t                    }else if(data.error.code === '3' || data.message === '您已申请加入圈子，请等待圈主审核'){\n\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\tdone(\"joining\", $els);\n\t\t\t\t\t\t}else if(data.error.code === '1' || data.message === '您已加入该圈子！'){\n\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\tdone(\"joined\", $els);\n\t\t\t\t\t\t\t$els.html(word.focus);\n\t\t\t\t\t\t\t// location.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\talert(data.message);\n\t\t\t\t}\n\t\t\t}\n\t\t}).fail(function(/*jqXHR, textStatus, errorThrown*/) {\n            // console.log(arguments);\n\t\t}).always(function() {\n\t\t\t// $els.attr('data-firing', 0);\n\t\t});\n\t};\n\tvar exitCircle = function (){\n\t\tfetch.post(url.get('exitCircle'), {\n\t\t\tdata: {\n\t\t\t\tgroupid: groupId\n\t\t\t}\n\t\t}).done(function(data/*, textStatus, jqXHR*/) {\n\t\t\tif (data && data.code == 200 && data.success) {\n\t\t\t\talert(tips.exit);\n\t\t\t\t$els.attr('data-membertype', 1);\n\t\t\t\t$els.html(word.join);\n\t\t\t\tdone(\"exit\", $els);\n\t\t\t}else{\n\t\t\t\tif( data.code == 410 ){\n\t\t\t\t\talert(tips.dissolved,{\n\t\t\t\t\t\tok:function (){\n\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonclose:function (){\n\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else if (data.code == 404){\n\t\t\t\t\tlocation.reload();\n\t\t\t\t}\n\t\t\t}\n\t\t}).fail(function(/*jqXHR, textStatus, errorThrown*/) {\n\t\t\t// console.log(arguments);\n\t\t}).always(function() {\n\t\t\t$els.attr('data-firing', 0);\n\t\t});\n\t}\n\tif(!checkLoginStatus()){\n\t\tloginPop(function(){\n\t\t\t$_CONFIG['islogin'] = '1';\n\t\t\tnoRefreshFetch(1);\n\t\t\tsetTimeout(function() {\n            \twindow.location.href = window.location;\n\t\t\t}, 1500)\n\t\t})\n\t\treturn;\n\t}\n\tif( memberType == 0 ){\n\t\texitCircle();\n\t}else{\n\t\tnoRefreshFetch();\n\t}\n\treturn false;\n}\nmodule.exports = join;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/joinCircle.js","var fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar flag = false;\nvar sensitiveTitle = function(node,comment) {\n    fetch.post(url.get('sensitiveWord'), {\n        data: {\n            text: node\n        },\n        async: false\n    }).done(function(data) {\n        if (data.success === false) {\n            var msg = '标题';\n            flag = true;\n            if(comment){\n                msg='评论';\n            }\n            alert(msg + '中含有\"' + data.data + '\"敏感词');\n        } else {\n            flag = false;\n        }\n    }).fail(function() {\n        alert('数据加载失败');\n    });\n    return flag;\n}\n\nmodule.exports = sensitiveTitle;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/sensitiveContent.js","/**\n *\n * 赞/取消赞\n */\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar checkLoginStatus = require('module/checkLoginStatus');\nvar loginPop = require('module/popup/login');\n\nvar isLogin = checkLoginStatus(); //页面初始化是否登录判断\nvar popFlag = 0;\n\nvar noop = function() {};\nvar setData = function($node, praise, count) {\n    $node.data('praise', praise);\n    $node.data('count', count);\n};\n\nvar helper = {\n    normal: {\n        add: function($node, data, count) {\n            $node.addClass('active');\n            if (!count) {\n                count = \"取消点赞\";\n            }\n            $node.find('span').text(count);\n\n        },\n        reduce: function($node, data, count) {\n            $node.removeClass('active');\n            if (!count) {\n                count = \"点赞\";\n            }\n            $node.find('span').text(count);\n        }\n    }\n};\n\nvar getCallback = function(mode) {\n    return helper[mode];\n}\n\nvar praise = function(container, selector, options) {\n    var $container = $(container);\n    var onPraise = options.onPraise || noop;\n    var onUnPraise = options.onUnPraise || noop;\n    var onPraised = options.onPraised || noop;\n    var mode = options.mode || 'normal';\n\n    $container.on('click', selector, function() {\n        var $this = $(this);\n        /* var firing = $this.data('firing');\n         if (firing === 1) {\n             return;\n         }*/\n\n        // $this.data('firing', 1);\n        var t = $this.data('type');\n        var isPraise = $this.data('praise');\n        var id = $this.data('id');\n        var count = $this.data('count');\n\n        var objs = {\n            data: {\n                groupId: $_CONFIG['groupid'],\n                id: id,\n                type: t, // 0 店铺,  1 话题\n                isPraise: isPraise // 0 取消点赞, 1 点赞\n            }\n            /*,\n                        onLogin: noRefreshFetch,\n                        refresh: true*/\n        }\n\n        //无刷新登录\n        function noRefreshFetch() {\n            var o = objs;\n            fetch.post(url.get('praise'), o)\n                .done(function(data /*, textStatus, jqXHR*/ ) {\n                    var callbacks = getCallback(mode);\n                    //推送 评论区状态\n                    Pubsub(channel.comment.enableEditor).pub({\n                        pid: \"enable\"\n                    });\n\n                    if (data && data.code === 200 && data.success) {\n                        if (isPraise === 1) {\n                            setData($this, 0, ++count);\n                            callbacks.add($this, data, count);\n                            onPraise.call($this, data, count);\n                        } else if (isPraise === 0) {\n                            setData($this, 1, --count);\n                            callbacks.reduce($this, data, count);\n                            onUnPraise.call($this, data, count);\n                        }\n\n                    } else if (data && data.code === 422) {\n                        // window.location.href = $_CONFIG.passport_domain + 'login/index';\n                    } else if (data && data.code === 403) {\n                        alert('抱歉！该话题审核未通过', {\n                            ok: function() {\n                                window.location.href = $_CONFIG.group_domain + 'index/error?code=topic';\n                            }\n                        });\n                    } else if (data.code === 409) {\n                        //409点过赞  已经登录 把点赞状态回带，不刷新\n                        onPraised.call($this, data, count);\n                        if (!popFlag) {\n                            alert(data.message);\n                        }\n                    } else {\n                        var message = data.message;\n                        if (t === 0) {\n                            if (data.code === 404) {\n                                alert(message, {\n                                    ok: function() {\n                                        window.location.reload();\n                                    }\n                                });\n                            } else {\n                                alert(message);\n                            }\n                        } else {\n                            alert(message);\n                        }\n                    }\n                    if (popFlag) {\n                        window.location.reload();\n                    }\n                }).fail(function( /*jqXHR, textStatus, errorThrown*/ ) {\n                    // 点赞失败时,如何处理\n                }).always(function() {\n                    // $this.data('firing', 0);\n                });\n        }\n        if (!checkLoginStatus()) {\n            popFlag = 1;\n            loginPop(noRefreshFetch);\n        } else {\n            popFlag = 0;\n            noRefreshFetch()\n        }\n        return false;\n    });\n};\n\nmodule.exports = praise;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/praise.js","/*话题详情页 v2版本改造*/\n\nrequire('lazyload');\nvar face = require('module/popup/face/face');\n//var loginPop = require('module/popup/login'); //登录弹窗\n//var checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\n\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar identify = require('utils/IdentifyIE8-');\n\nvar getCommentList = require('./getCommentList'); //\nvar a_Submit = require('./a_submit'); //\nvar secondComBtn = require('./a_secondComBtn'); //\nvar showMoreList = require('./showMoreList'); //\nvar loginState = require('./loginState');\nvar Smiley = require('./Smiley');\nvar otherFn = require('./otherFn');\n\nvar $loadlist = $(\"[data-node='loadlist']\");\nvar $comment_Msg = $(\"[data-node='comment_Msg']\");\n//var $a_Submit = $(\"[data-node=a_Submit]\");\n//var $circleCom = $(\"[data-node=circleCom]\");\nvar clickTopicId = $_CONFIG['topicid'];\n\nvar DIVOBJ = $(\"[data-node='more-topic']\");\nvar textareaTips = '[data-node=\"textareaTips\"]';\nvar hide = 'hide';\n\n$loadlist.css(\"display\", \"none\");\n$(\"[data-node='loading']\").css(\"display\", \"none\");\n$(\"[data-node='noload']\").css(\"display\", \"none\");\n$(\"[data-node='imgUl']\").addClass(\"hide\");\n\nvar commentDomInit = function() {\n    $comment_Msg.on('click', loginState.commentCheck)\n\n    DIVOBJ.on(\"click\", \"[data-node='a_Submit']\", a_Submit);\n    //$a_Submit.on(\"click\", $); //一级话题回复 绑定事件\n    DIVOBJ.on(\"click\", \"[data-node='secondCom_Key']\", secondComBtn.secondCom_Key); //显示二级回复框\n    DIVOBJ.on(\"click\", \"[data-node='hideComBox']\", secondComBtn.hideComBox); //点击收起 按钮，隐藏二级输入框\n    DIVOBJ.on(\"click\", \"[data-node='a_secondComBtn']\", secondComBtn.a_secondComBtn); //二级话题回复\n    DIVOBJ.on('click', '[data-node=\"smilies_Face\"]', Smiley.showEmoji); //表情添加\n    DIVOBJ.on(\"click\", \"[data-node='showMoreList']\", showMoreList); // 二级列表\n    if (identify()) {\n        DIVOBJ.on('keydown', 'textarea', hideTextareaTips);\n        DIVOBJ.on('blur', 'textarea', showTextareaTips);\n    }\n\n}\n\n// placeholder显示隐藏\nvar hideTextareaTips = function() {\n    var $this = $(this);\n    $this.parent($comment_Msg).find(textareaTips).addClass(hide);\n}\nvar showTextareaTips = function() {\n    var $this = $(this);\n    var textVal = $.trim($this.val());\n    $this.val(textVal);\n    if (textVal.length) {\n        $this.parent($comment_Msg).find(textareaTips).addClass(hide);\n    } else {\n        $this.parent($comment_Msg).find(textareaTips).removeClass(hide);\n    }\n}\n\nvar init = function() {\n    //登陆状态以及事件绑定\n    if (loginState.getLoginState()) {\n        face.insert(function(data) {\n            Smiley.insertAtCursor(Smiley.curretTextAreaObj(), data.reg);\n        });\n\n    }\n    getCommentList(clickTopicId, 1, 10, 2); //评论列表\n    commentDomInit(); //事件绑定\n    otherFn.lodingMore(); //一级评论列表加载更多\n    otherFn.goComment(); // 点击评论图标页面滚动到评论区域\n    face.init(); // 初始化表情\n    $(\"img\").lazyload({\n        effect: \"fadeIn\"\n    });\n}\n\n// 订阅\nPubsub(channel.comment.enableEditor).sub(function(data) {\n    if (data.pid == \"enable\") {\n        loginState.getLoginState();\n    }\n});\n\nmodule.exports = {\n    init: init,\n    getLoginState: loginState.getLoginState\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/commentv2.js","//识别当前浏览器是否为IE8及以下版本\n//返回值为 boolean true:当前版本为IE8及以下浏览器\nvar identify = function() {\n    var ua = navigator.userAgent.toLowerCase();\n    var version = 8.0;\n    var isIE = ua.indexOf(\"msie\") > -1;\n    if (isIE) {\n        var safariVersion = ua.match(/msie ([\\d.]+)/)[1];\n        if (safariVersion <= version) {\n            return true;\n        } else {\n            return false;\n        }\n    } else {\n        return false;\n    }\n};\nmodule.exports = identify;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/IdentifyIE8-.js","/**评论一级列表**/\nvar changeContent = require('./changeContent'); //评论内容转换\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\nvar face = require('module/popup/face/face');\nvar fromNow = require('utils/fromNow');\nvar commentList = require('./commentList.tpl');\nvar addImageTpl = require('./addImageTpl.tpl');\n//var fixedTopic = require('../fixedTopic');\n\nvar $is_Login = checkLoginStatus() == true ? 1 : 0; // 判断登陆状态\n//var  $LoginSrc = $_CONFIG.passport_domain; //登录注册域名\nvar $mall_domain = $_CONFIG['product_item_gome']; // 商城\nvar $userIsExpert = $_CONFIG['isExpert']; // 当前用户是否为达人\n\nvar $secondCom_Key = $(\"[data-node='secondCom_Key']\");\n\nvar LoadListStr = \"[data-node='loadlist']\";\nvar LoadtingStr = \"[data-node='loading']\";\n//var NoLoadStr = \"[data-node=noload]\";\n\nvar getCommentList = function(id, currPage, pageSize, listSize, nodelist) {\n\n    var $hidDiv = $(\"[id-node='\" + id + \"']\").children(\".topic-lfet\").children(\"[data-node='hidDiv']\");\n\n    var $thisObjId = $(\"[data-circlecom='\" + id + \"']\"); //每个话题的评论容器\n    var $ComTopicId = $thisObjId.parent(\".bjfff\");\n    //var $ComTopicId = $(\"[data-ComTopicId=\"+id+\"]\");\n    var $loadlist = $($ComTopicId.children(LoadListStr));\n    var $loading = $($ComTopicId.children(LoadtingStr));\n    //var $noload = $($ComTopicId.children(NoLoadStr));\n\n    $loadlist.css(\"display\", \"none\");\n    $loading.css(\"display\", \"block\");\n\n    var currUserImg = $(\"[data-tid='\" + id + \"']\").attr(\"data-headface\");\n    var paramList = '?page=' + currPage + '&pagesize=' + pageSize + '&topicid=' + id;\n\n    fetch.get(url.get('commentListUrlV2') + paramList).then(function(data) {\n\n        if (data.success) {\n            //获取所有的一级评论\n            //console.log(data);\n            var topicReplys = data.data.topicReplys;\n            // var windowHeight = parseInt($(window).height());\n            var height = $(\"[data-comtopicid='\" + id + \"']\").offset().top;\n            if (topicReplys.length > 0) {\n\n                //显示 正在加载中\n                $loading.css(\"display\", \"block\");\n                $loadlist.css(\"display\", \"block\").attr(\"data-addMorePages\", currPage).attr(\"data-ListSize\", pageSize);\n\n                for (var i = 0; i < topicReplys.length; i++) {\n\n                    //获取每个评论下的二级评论\n                    var topicMsg = topicReplys[i];\n                    var subReplyQuantity = topicMsg.subReplyQuantity; //二级回复的总数\n                    var subTop = topicMsg.topicSubReplys; //二级回复\n                    var replySecArr = []; //二级评论数组\n\n                    //判断是否显示  查看更多按钮\n                    var showNum = null;\n                    var dlShowBorder = null;\n                    var showMall = null;\n                    if (subReplyQuantity > listSize) {\n                        showMall = true;\n                        dlShowBorder = \"clearfix\";\n                        showNum = listSize;\n                    } else {\n                        showMall = false;\n                        showNum = parseInt(subTop.length);\n                        dlShowBorder = \"clearfix bd-bottom\";\n                    }\n                    var UserId = checkUserId(topicMsg.user.id)\n                        //console.log(UserId);\n                    var showSecComm = showNum > 0 ? \"\" : \"hide\";\n                    for (var j = 0; j < showNum; j++) {\n                        var subTopMsg = subTop[j];\n                        if (subTopMsg) {\n                            // console.log(subTopMsg.creatorId +\" \" +subTopMsg.user.id);\n                            //判断是二级评论还是三级评论\n                            var replayToPub = null;\n                            var beReplyUserName = \"\";\n                            var beReplyUserId = \"\";\n                            var threeUserId = \"javascript:;\";\n                            if (subTopMsg.topicSubReplyUser) {\n                                // 三级回复\n\n                                replayToPub = true;\n                                beReplyUserName = subTopMsg.topicSubReplyUser.nickname;\n                                beReplyUserId = subTopMsg.topicSubReplyUser.id;\n                                threeUserId = checkUserId(beReplyUserId)\n                            } else {\n                                //二级回复\n                                replayToPub = false;\n                            }\n\n                            var contentSed = subTopMsg.content;\n                            contentSed = changeContent(contentSed);\n                            var SenUserId = \"\";\n                            if (subTopMsg.user) {\n                                SenUserId = checkUserId(subTopMsg.user.id);\n                            }\n                            //var SenUserId =  checkUserId(subTopMsg.user.id);\n\n                            //二级回复中参数\n                            var replySecMsg = {\n                                \"threeUserId\": threeUserId,\n                                \"SenUserId\": SenUserId,\n                                \"parentCommentId\": topicMsg.id, //话题id\n                                // \"topicId\": topicId, //\n                                \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n                                \"content\": contentSed, //回复内容\n                                \"replyUserName\": subTopMsg.user.nickname, //回复人昵称\n                                \"replyUserId\": subTopMsg.user.id, //回复人id\n                                \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n                                \"beReplyUserId\": beReplyUserId, //被回复人的id\n                                \"replyCommentId\": subTopMsg.id // 二级回复内容id\n                            }\n\n                            replySecArr.push(replySecMsg);\n\n                        }\n\n                    }\n\n                    var content = topicMsg.content; //获取一级评论内容\n                    content = changeContent(content);\n                    var topicPic = topicMsg.pics; //一级评论的图片\n                    //var str = \"\";\n                    var imageStr = \"\";\n                    if (topicPic.length > 0) {\n                        var imgsrcPic = {\n                            picsSrc: topicPic,\n                            picture: topicMsg.pictures,\n                            length: topicPic.length\n                        }\n                        imageStr = addImageTpl(imgsrcPic);\n\n                        //addImageTpl\n                        // var imgArr = topicPic;\n                        // var imgArrLen = imgArr.length;\n\n                        // $.each(imgArr, function(index, img) {\n                        //     str += '<li><a href=\"javascript:;\"><img src=\"'+img+'\"></a></li>';\n                        //     //str += \"</br><img     data-original=\" + img + \"  >\";\n                        // })\n                        // imageStr =  '<ul class=\"clearfix comments-imglist\">'+str+'</ul>';\n                    }\n                    //content = content + str;\n                    //商品参数添加\n\n                    var itemsPic = \"\"; //商品图标\n                    var itemShopName = \"\"; //\n                    var itemPrice = \"\";\n                    var shopId = \"\";\n                    var itemShopId = \"\";\n                    var itemShopNameItem = \"\";\n                    var skuId = \"\";\n                    //var rebateSummary = \"\";\n                    if (topicMsg.item) {\n\n                        itemsPic = topicMsg.item.mainImage;\n                        itemShopNameItem = topicMsg.item.name;\n                        itemPrice = topicMsg.item.salePrice !== null ? topicMsg.item.salePrice : '暂无售价';\n                        shopId = topicMsg.item.id;\n                        itemShopId = topicMsg.item.id;\n                        skuId = topicMsg.item.skuId;\n                        // rebateSummary = topicMsg.item.rebateSummary; //返利金额\n\n                        /*\n                        \"discount\": 0, // 直降金额\n                        \"id\": 1179,  //商品id\n                        \"mainImage\": \"http://img.gomein.net.cn/image/prodimg/production_image/img/1000083845/1000027654\",\n                        \"name\": \"尤尼克斯（YONEX）SHB-60C羽毛球鞋\",\n                        \"originalPrice\": 18400, //市场价格\n                        \"price\": 18400,\n                        \"salePrice\": 18400, 售价\n                        \"saleQuantity\": 16, 销量\n                        \"shopId\": 3,\n                        \"skuHighestPrice\": 45900,\n                        \"status\": -1,\n                        \"stock\": 50000\n                        */\n                    }\n\n                    //店铺参数\n                    var shopPic = \"\";\n                    var redPackage = \"\";\n                    if (topicMsg.shop) {\n                        shopPic = topicMsg.shop.icon;\n                        itemShopName = topicMsg.shop.name;\n                        if (topicMsg.shop.promotionMark) {\n                            redPackage = topicMsg.shop.promotionMark.hasCouponPlan; //是否有优惠券\n                        }\n                        //redPackage = topicMsg.shop.promotionMark.hasCouponPlan; //是否有优惠券\n                        itemShopId = topicMsg.shop.id;\n                    }\n                    //所有参数集合\n                    var showDateList = {\n                        \"showSecComm\": showSecComm,\n                        \"imageStr\": imageStr,\n                        \"itemShopNameItem\": itemShopNameItem,\n                        \"UserId\": UserId,\n                        \"dlShowBorder\": dlShowBorder,\n                        \"showMall\": showMall,\n                        \"userIsExpert\": $userIsExpert, //当前用户是否是达人\n                        \"isExpert\": topicMsg.expertInfo.isExpert, //是否是达人\n                        \"userPic\": topicMsg.user.facePicUrl, //用户头像\n                        \"username\": topicMsg.user.nickname, //用户昵称\n                        \"backTopicId\": topicMsg.id, //本条评论id\n                        \"content\": face.parseEmoji(content), //过滤之后的内容\n                        \"topicType\": topicMsg.replyType, // 评论类型\n                        \"topicId\": topicMsg.topicId, // 话题id\n                        \"currUserImg\": currUserImg, // 当前用户的头像，在二级评论框中显示\n                        \"times\": fromNow(timeString(topicMsg.createTime)), //评论时间\n                        \"isFirstCom\": false, // 是否是一级评论  --  判断是否显示二级评论\n                        \"secondReply\": replySecArr, // 二级评论数组\n                        //商品参数\n                        \"mall_domain\": $mall_domain,\n                        \"itemsPic\": itemsPic,\n                        \"itemShopName\": itemShopName,\n                        \"itemPrice\": itemPrice,\n                        \"shopId\": shopId,\n                        \"itemShopId\": itemShopId,\n                        \"skuId\":skuId ? \"-\" + skuId : \"\",\n                        // 店铺参数\n                        \"redPackage\": redPackage,\n                        \"shopPic\": shopPic\n                    }\n\n                    var item = commentList(showDateList);\n                    //$circleCom.append($(item));\n                    $thisObjId.append($(item));\n                    $loading.css(\"display\", \"none\");\n                    $loadlist.css(\"display\", \"block\");\n\n                    $(\"img\").lazyload({\n                        effect: \"fadeIn\"\n                    });\n\n                    //没有登录时不显示 “回复”\n                    if ($is_Login == \"0\") {\n                        $secondCom_Key.css(\"display\", \"none\");\n                    }\n                    if (topicReplys.length < pageSize) {\n                        $loadlist.css(\"display\", \"none\");\n                    }\n\n                }\n                //fixedTopic.init();\n                if (nodelist) {\n\n                    //console.log(id);\n                    // var height = $(\"[data-comtopicid=\"+id+\"]\").height() - windowHeight;\n                    //console.log(height);\n                    $(window).scrollTop(height);\n                }\n            } else {\n                $loading.css(\"display\", \"none\");\n                if (pageSize == 1) {\n                    $hidDiv.css(\"display\", \"none\");\n                }\n            }\n        } else {\n            $loadlist.css(\"display\", \"none\");\n            // $noload.css(\"display\", \"block\");\n            $loading.css(\"display\", \"none\");\n        }\n\n    });\n\n}\n\nfunction checkUserId(id) {\n\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n\n}\n\nfunction timeString(str) {\n    var date = new Date(str);\n    var fullYear = date.getFullYear();\n    var month = (date.getMonth() + 1);\n    var day = date.getDate();\n    var hh = date.getHours();\n    var mm = date.getMinutes();\n    var ss = date.getSeconds();\n\n    function addZero(num) {\n\n        var newNum = \"\";\n        if (parseInt(num) < 10) {\n            newNum = \"0\" + num;\n        } else {\n            newNum = num;\n        }\n        return newNum;\n    }\n\n    return fullYear + \"-\" + addZero(month) + \"-\" + addZero(day) + \" \" + addZero(hh) + \":\" + addZero(mm) + \":\" + addZero(ss);\n\n}\n\nmodule.exports = getCommentList;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/getCommentList.js","\n\n//话题评论内容转换\n\nvar encodeHtml = require('utils/encodeHtml');\nvar face = require('module/popup/face/face');\n\n\nfunction htmlNull(str) {\n    var re = str.replace(/\\n|\\r\\n/g, \"</br>\");\n    return re; //去掉所有的html标记\n}\n\nvar changeContent = function(content){\n\tcontent = encodeHtml(content);\n    content = face.parseEmoji(content);\n    content = htmlNull(content);\n    return content;\n}\n\nmodule.exports = changeContent;\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/changeContent.js","// 传入的时间格式  2016-04-27 15:12:58\nvar fromNow = function(timeStr,max) {\n    /**\n      1）1个小时以内发表的消息，显示发表的分钟数，如“20分钟前”；\n      2）在24小时以内，发表的信息，显示具体小时数，如“15小时前”；\n      3）大于24小时小于48小时，发表的消息，显示昨天；\n      4）大于48小时小于72小时，发表的消息，显示2天前；大于72小时小于96小时，发表的消息，显示3天前；依此类推，最多到7天前\n      5）超过7天前，显示具体年/月/日\n    **/\n\n    var showTime = \"\";\n    var time = new Date(timeStr).getTime();\n    var date = new Date().getTime();\n    var num = date - time;\n    var maxDay = max||7;\n    var oneMin = 60000,\n        oneHour = 3600000,\n        oneDay = 24 * 3600000;\n    var s;\n    if (num < oneMin) {\n        showTime = '1分钟前';\n        //console.log(showTime);\n    } else if (num >= oneMin & num < oneHour) {\n        s = Math.floor(num / oneMin);\n        showTime = s + \"分钟前\";\n        //console.log(showTime);\n    } else if (num >= oneHour & num < oneDay) {\n        s = Math.floor(num / oneHour);\n        showTime = s + \"小时前\";\n        //console.log(showTime);\n    } else if (num >= oneDay & num < 2 * oneDay) {\n        s = Math.floor(num / oneDay);\n        showTime = \"昨天\";\n        //console.log(showTime);\n    } else if (num >= 2 * oneDay & num < maxDay * oneDay) {\n        s = Math.floor(num / oneDay);\n        showTime = s + \"天前\";\n        //console.log(showTime);\n    } else {\n        var getd = timeStr.split(' ');\n        showTime = getd[0];\n    }\n    return showTime;\n}\nmodule.exports = fromNow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/fromNow.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/commentList',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dlShowBorder=$data.dlShowBorder,userSubmit=$data.userSubmit,UserId=$data.UserId,isExpert=$data.isExpert,userPic=$data.userPic,backTopicId=$data.backTopicId,topicType=$data.topicType,topicId=$data.topicId,username=$data.username,times=$data.times,$string=$utils.$string,content=$data.content,itemsPic=$data.itemsPic,itemShopNameItem=$data.itemShopNameItem,itemPrice=$data.itemPrice,mall_domain=$data.mall_domain,shopId=$data.shopId,skuId=$data.skuId,itemShopId=$data.itemShopId,imageStr=$data.imageStr,showSecComm=$data.showSecComm,isFirstCom=$data.isFirstCom,$each=$utils.$each,secondReply=$data.secondReply,value=$data.value,i=$data.i,imId=$data.imId,showMall=$data.showMall,groupId=$data.groupId,replyCommentNum=$data.replyCommentNum,currentPage=$data.currentPage,pageSize=$data.pageSize,userIsExpert=$data.userIsExpert,currUserImg=$data.currUserImg,$out='';$out+=' <dl class=\"';\n$out+=$escape(dlShowBorder);\n$out+=' \" ';\nif(userSubmit){\n$out+=' data-node=\"userSubmit\"';\n}\n$out+='> <dt> <a href=\"';\n$out+=$escape(UserId);\n$out+='\" target=\"_blank\"> ';\nif(isExpert){\n$out+=' <em class=\"icon-daren\"></em>';\n}\n$out+=' <img src=\"';\n$out+=$escape(userPic);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"> </a> </dt> <dd data-ddList=\"';\n$out+=$escape(backTopicId);\n$out+='\"> <div class=\"circle-comments-title\" data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+='> <a href=\"javascript:;\" class=\"fr\" data-node=\"secondCom_Key\" data-comId=\"';\n$out+=$escape(backTopicId);\n$out+='\" data-replayUser=';\n$out+=$escape(username);\n$out+=' data-publish=\"1\">回复</a> <a href=\"';\n$out+=$escape(UserId);\n$out+='\" target=\"_blank\">';\n$out+=$escape(username);\n$out+='</a> <span>';\n$out+=$escape(times);\n$out+='</span> </div> <div class=\"first-comment\"> <p class=\"clearfix\">';\n$out+=$string(content);\n$out+='</p> ';\nif(topicType==\"1\"){\n$out+=' <div class=\"reply-details merchant\"> <div class=\"reply-picture\"> <img src=\"';\n$out+=$escape(itemsPic);\n$out+='\" onerror=\"imgError(this)\"> </div> <div class=\"reply-contxt\"> <p>';\n$out+=$escape(itemShopNameItem);\n$out+='</p> <p class=\"price-numb\">￥<span>';\n$out+=$escape(itemPrice);\n$out+='</span></p> </div> <a href=\"';\n$out+=$escape(mall_domain);\n$out+=$escape(shopId);\n$out+=$escape(skuId);\n$out+='.html\" target=\"_blank\" class=\"see-details pc-btn pc-btnw105 pc-btnh40\" data-shopId=';\n$out+=$escape(shopId);\n$out+=' data-itemShopId=';\n$out+=$escape(itemShopId);\n$out+=' data-node=\"checkDetailMsg\">查看详情</a> </div> ';\n}\n$out+=' ';\n$out+=$string(imageStr);\n$out+=' </div> <div class=\"comments-box ';\n$out+=$escape(showSecComm);\n$out+='\"> ';\nif(!isFirstCom){\n$out+=' ';\n$each(secondReply,function(value,i){\n$out+=' <div class=\"comments-s\" data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+='> <a href=\"';\n$out+=$escape(value.SenUserId);\n$out+='\" target=\"_blank\" data-replyUserId=';\n$out+=$escape(value.replyUserId);\n$out+='>';\n$out+=$escape(value.replyUserName);\n$out+='</a> ';\nif(value.replayToPub){\n$out+=' ：<span>回复</span> ';\n}\n$out+=' <a href=\"';\n$out+=$escape(value.threeUserId);\n$out+='\" target=\"_blank\" data-replyCommentId =';\n$out+=$escape(value.replyCommentId);\n$out+='>';\n$out+=$escape(value.beReplyUserName);\n$out+=':</a> <span data-replyCommentId=';\n$out+=$escape(value.replyCommentId);\n$out+='>';\n$out+=$string(value.content);\n$out+='</span> <a href=\"javascript:;\" class=\"hf-btn fr\" data-getTopicId=';\n$out+=$escape(backTopicId);\n$out+=' data-node=\"secondCom_Key\" data-replayUser=';\n$out+=$escape(value.replyUserName);\n$out+=' data-publish=\"0\" data-comId=\"';\n$out+=$escape(value.parentCommentId);\n$out+='\" data-replyCommentId =';\n$out+=$escape(value.replyCommentId);\n$out+=' data-replyUserId=';\n$out+=$escape(value.replyUserId);\n$out+=' data-imId=';\n$out+=$escape(imId);\n$out+='>回复</a> </div> ';\n});\n$out+=' ';\n}\n$out+=' </div> </dd> </dl> ';\nif(!isFirstCom){\n$out+=' ';\nif(showMall){\n$out+=' <a href=\"javascript:;\" class=\"comments-more\" data-node=\"showMoreList\" data-groupId=';\n$out+=$escape(groupId);\n$out+=' data-imId=';\n$out+=$escape(imId);\n$out+=' data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+=' data-tootlePages=';\n$out+=$escape(replyCommentNum);\n$out+=' data-currentPage= ';\n$out+=$escape(currentPage);\n$out+=' data-pageSize=';\n$out+=$escape(pageSize);\n$out+='>查看回复...</a> ';\n}\n$out+=' ';\n}\n$out+=' <a class=\"pack-up\" style=\"display: none\" data-node=\"hideComBox\" data-parentTopicIdBtn=';\n$out+=$escape(backTopicId);\n$out+='>收起</a> <div class=\"text-field-box clearfix secondText margin-width\" style=\"display: none\" data-parentTopicId=';\n$out+=$escape(backTopicId);\n$out+='> <div class=\"topic-user-head\"> ';\nif(userIsExpert){\n$out+=' <em class=\"icon-daren\"></em>';\n}\n$out+=' <img src=\"';\n$out+=$escape(currUserImg);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"> </div> <div class=\"topic-publish-content\"> <textarea placeholder=\"说点什么吧…\" class=\"textarea-bx secondT\"></textarea> <label class=\"textarea-tips hide\" data-node=\"textareaTips\"></label> <div class=\"publish-face-bx\"> <p class=\"icon-face\" data-node=\"smilies_Face\"><em class=\"icon-emoji\"></em> 表情</p> <a href=\"javascript:;\" class=\"pc-btn pc-btnh30 pc-btnw105\" data-node=\"a_secondComBtn\" data-getTopicId=';\n$out+=$escape(backTopicId);\n$out+='>发布</a> </div> </div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/commentList.tpl\n// module id = 239\n// module chunks = 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/addImageTpl',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,picsSrc=$data.picsSrc,value=$data.value,i=$data.i,$escape=$utils.$escape,length=$data.length,picture=$data.picture,$out='';$out+=' <div class=\"comments-imglist\" > <ul class=\"clearfix comments-imglist\" > ';\n$each(picsSrc,function(value,i){\n$out+=' <li data-imgSort=';\n$out+=$escape(i);\n$out+=' data-node=\"imgPics\"><a href=\"javascript:;\"><img src=\"';\n$out+=$escape(value);\n$out+='\"></a></li> ';\n});\n$out+=' </ul> <div class=\"imglist-big hide\" data-node=\"imgBigPic\"> <div class=\"big-title\"> <a href=\"javascript:;\" data-node=\"imgBigHind\"><em class=\"icon-up\"></em>收起</a> <a href=\"javascript:;\" data-node=\"imgBigSrc\" target=\"_blank\"><em class=\"icon-view-img\"></em>查看原图</a> </div> <div class=\"big-img\" data-picLength=\"';\n$out+=$escape(length);\n$out+='\"> <div class=\"img-hidden\"> ';\n$each(picture,function(value,i){\n$out+=' <div class=\"img-box\" data-bigImg=';\n$out+=$escape(i);\n$out+=' data-node=\"hideBigPic\"><img class=\"srcError\" data-imgsrc = \"';\n$out+=$escape(value.url);\n$out+='\"></div> ';\n});\n$out+=' </div> <em class=\"icon-left\" data-node=\"imgBigPN\" data-page=\"pre\"></em> <em class=\"icon-right\" data-node=\"imgBigPN\" data-page=\"next\"></em> </div> <div class=\"img-slide\"> ';\n$each(picture,function(value,i){\n$out+=' <a href=\"javascript:;\" data-node=\"showImg\" data-active=\"';\n$out+=$escape(i);\n$out+='\" ></a> ';\n});\n$out+=' </div> </div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/addImageTpl.tpl\n// module id = 240\n// module chunks = 29","/*\n\t一级评论\n*/\nvar $is_Login = 1;\nvar alert = require('module/popup/alert');\nvar hint = require('module/hint.js');\n//var fixedTopic = require('../fixedTopic');\nvar commentList = require('./commentList.tpl');\nvar changeContent = require('./changeContent'); //评论内容转换\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar loginState = require('./loginState');\nvar face = require('module/popup/face/face');\nvar fromNow = require('utils/fromNow');\n//var addImg = require('./addImgGoods/addIMG');\nvar addImageTpl = require('./addImageTpl.tpl');\n\n// 敏感词过滤\nvar sensitiveContent = require('module/sensitiveContent');\n\nvar $comment_Msg = $(\"[data-node='comment_Msg']\");\nvar $userIsExpert = $_CONFIG['isExpert'];\n//var $circleCom = $(\"[data-node=circleCom]\");\n\nvar $mall_domain = $_CONFIG[\"product_item_gome\"]; // 商城\n\nvar a_Submit = function() {\n\n    // 判断是否登陆，没登录，显示登录框\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var currUserImg = $comment_Msg.attr(\"data-headface\"); //头像\n    var parentDiv = $(this).parents().eq(1);\n    var comment_Msg = parentDiv.children(\"textarea\").val();\n    comment_Msg = comment_Msg.trim(); //对输入空格进行过滤\n    if (comment_Msg) {\n        if (sensitiveContent(comment_Msg,true)) {\n            return false;\n        }\n    }\n\n    //var data_userid = parentDiv.attr(\"data-userid\");\n    var topicid = parentDiv.attr(\"data-tid\");\n\n    //var imgPics = parentDiv.find(\"[data-node=imgUl]\").attr(\"data-imgsrt\");\n    var lis = parentDiv.find(\"[data-node='imgUl']\").children(\"li\");\n    var imgPics = [];\n\n    for (var i = 0; i < lis.length; i++) {\n        //console.log(lis[i]);\n        var imgObj = $(lis[i]).find(\"img\").attr(\"src\");\n        if (imgObj) {\n            imgPics.push(imgObj);\n        }\n    }\n\n    var $addImgGoods = parentDiv.find(\"[data-node='addImgGoods']\");\n\n    //var shopid = $(\"[data-node=goodsDiv]\").attr(\"data-shopId\");\n\n    if (comment_Msg || imgPics.length || $addImgGoods.hasClass(\"hasGoods\")) {\n        //var imId = \"b_\" + data_userid;\n        //var businessid = 0;\n        var topicType = null;\n        var shopId = \"\";\n        var itemid = \"\";\n        var skuId = \"\";\n        if ($addImgGoods.hasClass(\"hasGoods\")) {\n            var $goodIn = $addImgGoods.find(\"[data-node='goodsIn']\");\n            shopId = $goodIn.attr(\"data-shopId\");\n            itemid = $goodIn.attr(\"data-itemId\");\n            skuId = $goodIn.attr(\"data-skuId\");\n            topicType = 1;\n        } else {\n            topicType = 0;\n        }\n        var params = {\n            \"reply_type\": topicType, //回复的类型\n            \"topicid\": topicid, //话题id\n            \"content\": comment_Msg, //话题回复内容\n            \"pics\": imgPics, //话题回复图片\n            \"shopid\": shopId, //如果topicType = 1 或者 =2 那么这个字段必填\n            \"itemid\": itemid //如果topicType = 1 那么这个字段必填   \n        }\n        if(skuId){\n            params.skuid = skuId;\n        }\n\n        //提交请求\n        fetch.post(url.get('commentFirstV2'), {\n            data: params\n        }).then(function(data) {\n            if (data.success) {\n                var Msg = data.data;\n                var contentMsg = Msg.content;\n                contentMsg = changeContent(contentMsg);\n                parentDiv.children(\"textarea\").val(\"\");\n\n                var imageStr = null;\n\n                if (Msg.pics.length > 0) {\n                    var imgsrcPic = {\n                        \"picsSrc\": Msg.pics,\n                        \"picture\": Msg.pictures,\n                        \"length\": Msg.pics.length\n                    }\n                    imageStr = addImageTpl(imgsrcPic);\n                    //console.log(Msg.pics);\n                }\n                var mall_domain = \"\",\n                    itemsPic = \"\",\n                    itemShopName = \"\",\n                    itemPrice = \"\",\n                    shopId = \"\",\n                    itemShopId = \"\";\n                    skuId = \"\";\n                if (Msg.item) {\n                    // var goodStr = $(\"[data-node=addImgGoods]\").attr(\"data-goodStr\");\n                    var goodObj = Msg.item;\n                    mall_domain = $mall_domain;\n                    itemsPic = goodObj.mainImage;\n                    itemShopName = goodObj.name;\n                    itemPrice = goodObj.salePrice !== null ? goodObj.salePrice : '暂无售价';\n                    shopId = goodObj.id;\n                    itemShopId = Msg.id;\n                    skuId = Msg.skuId ? \"-\" + Msg.skuId : \"\";\n                }\n\n                //time = timeString(Msg.createTime);\n                var UserId = checkUserId(data.data.user.id);\n\n                var basics = {\n                    \"showSecComm\": \"hide\",\n                    \"mall_domain\": mall_domain,\n                    \"itemsPic\": itemsPic,\n                    \"itemShopNameItem\": itemShopName,\n                    \"itemPrice\": itemPrice,\n                    \"shopId\": shopId,\n                    \"itemShopId\": itemShopId,\n                    \"skuId\":skuId,\n                    \"imageStr\": imageStr,\n                    \"UserId\": UserId,\n                    \"dlShowBorder\": \"clearfix bd-bottom\",\n                    \"userIsExpert\": $userIsExpert, //当前用户是否是达人\n                    \"isExpert\": Msg.expertInfo.isExpert, //是否是达人\n                    \"userPic\": Msg.user.facePicUrl, //用户头像\n                    \"username\": Msg.user.nickname, //用户昵称\n                    \"backTopicId\": Msg.id, //本条评论id\n                    \"content\": face.parseEmoji(contentMsg), //过滤之后的内容\n                    \"topicType\": topicType, // 评论类型\n                    \"topicId\": Msg.topicId, // 话题id\n                    \"currUserImg\": currUserImg, // 当前用户的头像，在二级评论框中显示\n                    \"times\": fromNow(timeString(Msg.createTime)), //评论时间\n                    \"isFirstCom\": true, // 是否是一级评论  --  判断是否显示二级评论\n                    \"userSubmit\":true   //是否用户自己发布的评论\n                }\n                //$(\"[data-node=noload]\").css(\"display\", \"none\");\n                $(\"[data-node='hidDiv']\").css(\"display\", \"block\");\n\n                var item = commentList(basics);\n                //$circleCom.append($(item));\n\n                $(\"[data-circlecom='\" + topicid + \"']\").append($(item));\n                //console.log($(\"[data-circlecom=\"+topicid+\"]\").attr(\"class\"));\n                //var newDL = $(\"[data-ddlist=\" + basics.backTopicId + \"]\");\n\n                // 商品选择列表清空\n                // 图片列表清空\n                $(\"[data-tid='\" + topicid + \"']\").children('[data-node=\"addImgGoods\"]').attr(\"data-imgnum\", 9)\n                    .attr(\"data-goodstr\", \"\")\n                    .removeClass(\"hasGoods\");\n                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='imgUl']\")\n                    .attr(\"data-imgsrt\", \"\").addClass(\"hide\").children(\".imgClass\").remove();\n                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='addGoods_btn']\").removeClass(\"disabled\");\n                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='addImg_btn']\").removeClass(\"disabled\");\n                $(\"[data-node='goodsIn']\").remove();\n\n                var idNode = $(\"[id-node='\" + topicid + \"']\");\n                $(\"body,html\").animate({ //？？？？？有问题\n                    scrollTop: parseInt(idNode.height() + idNode.offset().top - $(window).height() / 2)\n\n                });\n                hint.init(\"评论成功\");\n\n            } else {\n\n                if (data.code === 881001) {\n                    alert(\"评论内容不能超过200个汉字\");\n                } else if (data.code === 404 || data.code === 410) {\n                    alert(\"抱歉，该话题已被删除\", {\n                        ok: function() {\n                            window.location.href = \"/index/get_error?code=topic_404\";\n                        }\n                    });\n                } else if (data.code === 422) {\n                    alert(\"抱歉，服务器君正在打盹\", {\n                        ok: function() {\n                            window.location.href = \"/index/get_error?code=500\";\n                        }\n                    });\n                } else if (data.code === 403) {\n                    alert(\"抱歉，该话题审核不通过！\", {\n                        ok: function() {\n                            window.location.href = \"/index/get_error?code=topic\";\n                        }\n                    });\n                } else {\n                    alert(data.message);\n                }\n\n            }\n        });\n    } else {\n        alert(\"请输入评论内容！\");\n    }\n\n}\n\nfunction checkUserId(id) {\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\n\nfunction timeString(str) {\n    var date = new Date(str);\n    var fullYear = date.getFullYear();\n    var month = (date.getMonth() + 1);\n    var day = date.getDate();\n    var hh = date.getHours();\n    var mm = date.getMinutes();\n    var ss = date.getSeconds();\n\n    function addZero(num) {\n\n        var newNum = \"\";\n        if (parseInt(num) < 10) {\n            newNum = \"0\" + num;\n        } else {\n            newNum = num;\n        }\n        return newNum;\n    }\n\n    return fullYear + \"-\" + addZero(month) + \"-\" + addZero(day) + \" \" + addZero(hh) + \":\" + addZero(mm) + \":\" + addZero(ss);\n\n}\n\nmodule.exports = a_Submit;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/a_submit.js","// 判断登陆状态\nvar checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\nvar $comment_Msg = $(\"[data-node='comment_Msg']\");\nvar $a_Submit = $(\"[data-node='a_Submit']\");\n\n\n\n//var getCommentList = require('./getCommentList'); //\nvar loginPop = require('module/popup/login'); //登录弹窗\n//var checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\n\n//var $is_Login = checkLoginStatus() == true ? 1 : 0;\n\n\nvar getLoginState = function() {\n    var ISLOGIN = null;\n    if (!checkLoginStatus()) { //必须重新判断 别的无刷新事件修改了登录状态\n        //没有登录\n        ISLOGIN = \"0\";\n        $comment_Msg.children(\"textarea\").attr(\"readonly\", \"readonly\").css(\"background\", \"#fff\");\n        $(\"[data-node='secondCom_Key']\").css(\"display\", \"none\");\n    } else {\n        $comment_Msg.children(\"textarea\")\n            .removeAttr(\"readonly\").css(\"background\", \"transparent\");\n\n        $a_Submit.removeClass(\"pc-bj-fc8753\").html(\"发布\");\n\n        $(\"[data-node='secondCom_Key']\").css(\"display\", \"block\");\n        //添加事件\n        ISLOGIN = \"1\";\n    }\n    return ISLOGIN;\n}\n\n// var loginCallback = function() {\n//     $is_Login = 1;\n//     getLoginState();\n//     $(\".topic-publish-content\").children(\"textarea\").removeAttr(\"readonly\").css(\"background\", \"transparent\");\n//     $(\".publish-face-bx\").children(\"a\").removeClass(\"pc-bj-fc8753\").html(\"发布\");\n//     //$(\"[data-node=circleCom]\").empty();\n//     //getCommentList(1, 10, 2);\n// }\n\nvar popUnion = function() {\n    loginPop();\n}\n\nvar commentCheck = function() {\n    if (!checkLoginStatus()) {\n        popUnion();\n        return false;\n    }\n}\n\nmodule.exports = {\n    getLoginState : getLoginState,\n    popUnion : popUnion,\n    commentCheck :commentCheck\n};\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/loginState.js","var identify = require('utils/IdentifyIE8-');\n\n//二级话题回复\nvar getCommentList = require('./getCommentList');\nvar $is_Login = 1;\nvar alert = require('module/popup/alert');\n//var hint = require('module/hint.js');\n//var commentList = require('./commentList.tpl');\nvar changeContent = require('./changeContent'); //评论内容转换\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar loginState = require('./loginState');\n//var face = require('module/popup/face/face');\n//var fromNow = require('utils/fromNow');\nvar secondComList = require('./secondComList.tpl');\n\n// 敏感词过滤\nvar sensitiveContent = require('module/sensitiveContent');\n\n//var $comment_Msg = $(\"[data-node=comment_Msg]\");\n\nvar a_secondComBtn = function() {\n\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var replayToPub = $(this).parents().eq(2).attr(\"data-ispublish\"); //\n    var beReplyId = \"\";\n    //var replayImid = \"\";\n\n    if (replayToPub == \"1\") {\n        replayToPub = false;\n    } else {\n        replayToPub = true;\n        beReplyId = $(this).parents().eq(2).attr(\"data-replycommentid\");\n        // var replayImid = \"b_\" + $(this).parents().eq(2).attr(\"data-replyuserid\");\n    }\n    //var replyUserName = $comment_Msg.attr(\"data-nickname\");\n    //var beReplyUserName = $(this).parents().eq(2).attr(\"data-replayto\");\n    var tId = $(this).attr(\"data-gettopicid\");\n    //var groupId = $(\"[data-htid=\" + tId + \"]\").attr(\"data-groupid\");\n\n    //var topicType = $(\"[data-htid=\" + tId + \"]\").attr(\"data-topictype\");;\n    var topicId = $(\"[data-htid='\" + tId + \"']\").attr(\"data-tid\");\n    var content = $(this).parents().eq(1).children(\"textarea\").val();\n    content = content.trim();\n    // var contentLong = \"\";\n\n    // if (content.length > 200) {\n    //     contentLong = true;\n    // } else {\n    //     contentLong = false;\n    // }\n    //var imId = \"b_\" + $comment_Msg.attr(\"data-userid\");\n    // var id = $(this).parents().eq(2).attr(\"data-replycommentid\");\n    var replyId = tId;\n\n    var params = {\n        \"topic_reply_id\": replyId,\n        \"topicid\": topicId,\n        \"content\": content,\n        \"topic_subreply_id\": beReplyId\n    }\n    if (content) {\n        if (sensitiveContent(content,true)) {\n            return false;\n        }\n        fetch.post(url.get('secondtopicV2'), {\n            data: params\n        }).then(function(data) {\n            if (data.success) {\n\n                var contentT = data.data.content;\n                contentT = changeContent(contentT);\n                //判断是二级回复还是三级回复\n                var beReplyUserName = \"\";\n                var beReplyUserId = \"\";\n\n                var SenUserId = checkUserId(data.data.user.id);\n                var threeUserId = \"javascript:;\"\n\n                if (replayToPub) {\n                    beReplyUserName = data.data.topicSubReplyUser.nickname;\n                    beReplyUserId = data.data.topicSubReplyUser.id;\n                    threeUserId = checkUserId(beReplyUserId);\n                }\n                var showCom = {\n                    \"SenUserId\": SenUserId,\n                    \"threeUserId\": threeUserId,\n                    \"topicType\": 0,\n                    \"backTopicId\": tId,\n                    \"parentCommentId\": tId, //话题id\n                    \"topicId\": data.data.topicId,\n                    \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n                    \"content\": contentT, //回复内容\n                    \"replyUserName\": data.data.user.nickname, //回复人昵称\n                    \"replyUserId\": data.data.user.id, //回复人id\n                    \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n                    \"beReplyUserId\": beReplyUserId, //被回复人的id\n                    \"replyCommentId\": data.data.id // 二级回复内容id\n                }\n\n                var item = secondComList(showCom);\n                $(\"[data-ddlist='\" + tId + \"']\").find(\".comments-box\").removeClass(\"hide\").append(item);\n                $(\"[data-parentTopicIdBtn='\" + tId + \"']\").css(\"display\", \"none\");\n                $(\"[data-parentTopicId='\" + tId + \"']\").css(\"display\", \"none\");\n                $(\"[data-parentTopicId='\" + tId + \"']\").removeAttr(\"data-replayto\");\n                $(\".textarea-bx\", \"[data-parentTopicId='\" + tId + \"']\").val(\"\");\n\n            } else {\n                if (data.code === 500 || data.message === \"请求参数为空\") {\n                    alert(data.message);\n                } else {\n                    // console.log(data.code);\n                    if (data.code === 403) {\n                        data.message = \"抱歉，该回复审核不通过！\";\n                    }\n                    alert(data.message, {\n                        ok: function() {\n                            $(\"[data-node=circleCom]\").empty();\n                            getCommentList(topicId, 1, 10, 2);\n                        }\n                    });\n                }\n\n            }\n        });\n    } else {\n        alert(\"请输入评论内容！\");\n    }\n};\n\n//点击回复按钮，显示二级输入框\nvar secondCom_Key = function() {\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var replyuserid = $(this).attr(\"data-replyuserid\");\n    //var replyimId = $(this).attr(\"data-imId\");\n\n    var replycommentid = $(this).attr(\"data-replycommentid\");\n    var topicid = $(this).attr(\"data-comid\");\n    var username = $(this).attr(\"data-replayUser\");\n    var dataPublis = $(this).attr(\"data-publish\");\n    var isHide = $(\"[data-parenttopicid='\" + topicid + \"']\").css(\"display\");\n    var dataObj = $(\"[data-parentTopicId='\" + topicid + \"']\");\n\n    dataObj.removeAttr(\"data-replyuserid\");\n    //dataObj.removeAttr(\"data-imId\");\n    dataObj.removeAttr(\"data-replayTo\");\n    dataObj.removeAttr(\"data-replycommentid\");\n    dataObj.removeAttr(\"data-isPublish\");\n    //dataObj.attr(\"data-imId\",replyimId);\n    dataObj.attr(\"data-replyuserid\", replyuserid);\n    dataObj.attr(\"data-replayTo\", username);\n    dataObj.attr(\"data-isPublish\", dataPublis);\n    dataObj.attr(\"data-replycommentid\", replycommentid);\n    dataObj.children(\".topic-publish-content\").children(\"textarea\").attr(\"placeholder\", \"回复: \" + username);\n    if (identify()) {\n        dataObj.children(\".topic-publish-content\").children(\"label\").html(\"回复: \" + username);\n    }\n    if (isHide == \"none\") {\n        $(\".secondText\").css(\"display\", \"none\");\n        $(\".pack-up\").css(\"display\", \"none\");\n        dataObj.css(\"display\", \"block\");\n        $(\"[data-parentTopicIdBtn='\" + topicid + \"']\").css(\"display\", \"block\");\n\n        var a = $(window).scrollTop() + $(window).height();\n        var b = dataObj.offset().top;\n        if (a + 60 < b) {\n\n            $('html,body').animate({\n                'scrollTop': dataObj.offset().top - $(window).height() + 185\n            }, 200);\n        }\n\n        dataObj.children(\".topic-publish-content\").children(\"textarea\").focus();\n        if (identify()) {\n            dataObj.children(\".topic-publish-content\").children(\"label\").removeClass('hide');\n        }\n\n    }\n}\n\n//隐藏二级输入框\nvar hideComBox = function() {\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n    var hideId = $(this).attr(\"data-parentTopicIdBtn\");\n    $(\"[data-parentTopicId='\" + hideId + \"']\").css(\"display\", \"none\");\n    $(\"[data-parentTopicId='\" + hideId + \"']\").children(\"textarea\").attr(\"placeholder\", \"说点什么吧\");\n    $(\"[data-parentTopicIdBtn='\" + hideId + \"']\").css(\"display\", \"none\");\n    $(\"[data-parentTopicId='\" + hideId + \"']\").removeAttr(\"data-isPublish\").removeAttr(\"data-replayTo\");\n    $(\".textarea-bx\", \"[data-parentTopicId='\" + hideId + \"']\").val(\"\");\n}\n\nfunction checkUserId(id) {\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\nmodule.exports = {\n    a_secondComBtn: a_secondComBtn,\n    secondCom_Key: secondCom_Key,\n    hideComBox: hideComBox\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/a_secondComBtn.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/secondComList',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,topicType=$data.topicType,backTopicId=$data.backTopicId,topicId=$data.topicId,SenUserId=$data.SenUserId,replyUserId=$data.replyUserId,replyUserName=$data.replyUserName,replayToPub=$data.replayToPub,threeUserId=$data.threeUserId,replyCommentId=$data.replyCommentId,beReplyUserName=$data.beReplyUserName,$string=$utils.$string,content=$data.content,parentCommentId=$data.parentCommentId,imId=$data.imId,$out='';$out+='<div class=\"comments-s\" data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+='> <a href=\"';\n$out+=$escape(SenUserId);\n$out+='\" target=\"_blank\" data-replyUserId=\"';\n$out+=$escape(replyUserId);\n$out+='\">';\n$out+=$escape(replyUserName);\n$out+='</a> ';\nif(replayToPub){\n$out+=' ：<span>回复</span> <a href=\"';\n$out+=$escape(threeUserId);\n$out+='\" target=\"_blank\" data-replyCommentId =\"';\n$out+=$escape(replyCommentId);\n$out+='\">';\n$out+=$escape(beReplyUserName);\n$out+='</a> ';\n}\n$out+=' <span data-replyCommentId=';\n$out+=$escape(replyCommentId);\n$out+='>：';\n$out+=$string(content);\n$out+='</span> <a href=\"javascript:;\" class=\"fr\" data-node=\"secondCom_Key\" data-getTopicId=';\n$out+=$escape(backTopicId);\n$out+=' data-replayUser=';\n$out+=$escape(replyUserName);\n$out+=' data-publish=\"0\" data-comId=\"';\n$out+=$escape(parentCommentId);\n$out+='\" data-replyCommentId=\"';\n$out+=$escape(replyCommentId);\n$out+='\" data-imId=\"';\n$out+=$escape(imId);\n$out+='\" data-replyUserId=';\n$out+=$escape(replyUserId);\n$out+=' >回复</a> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/secondComList.tpl\n// module id = 244\n// module chunks = 29","//二级列表\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar changeContent = require('./changeContent'); //评论内容转换\nvar secondComList = require('./secondComList.tpl');\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\n\nvar $is_Login = checkLoginStatus() == true ? 1 : 0; // 判断登陆状态\n\nvar showMoreList = function() {\n\n    //var groupId = $(this).attr(\"data-groupId\");\n    //var imId = $(this).attr(\"data-imId\");\n    //var topicType = $(this).attr(\"data-topicType\");\n    var commentid = $(this).attr(\"data-htid\");\n    //var tid = $(this).attr(\"data-tid\");\n    //var tootalPages = $(this).attr(\"data-tootlePages\"); //\n    //var currentPage = $(this).attr(\"data-currentPage\"); //当前页数\n    //var pageSize = $(this).attr(\"data-pageSize\"); //当前展示列表数\n    //var a = Math.ceil(parseInt(tootalPages) / parseInt(pageSize)); //获取总页数\n    // var b = parseInt(tootalPages) % parseInt(pageSize); //获取最后一页的列表数目\n    //var toPage = parseInt(currentPage) + 1;\n    var obj = $(this);\n    var paramList = '?page=1&pagesize=70&topic_replyid=' + commentid;\n    var objHtml = obj.html();\n\n    if (objHtml === \"查看回复...\") {\n        getRelyList(paramList, obj);\n    } else {\n        //\n        var childrens = $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-s\");\n        //console.log(childrens);\n        for (var k = 2; k < childrens.length; k++) {\n            childrens.eq(k).remove();\n        }\n        obj.html(\"查看回复...\");\n    }\n\n    function getRelyList(paramList, obj) {\n        fetch.get(url.get('getRelyListV2') + paramList).then(function(data) {\n            //console.log(data);\n\n            var replyCommentList = data.data.topicSubReplys;\n            if (replyCommentList.length > 2) {\n\n                $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-box\").empty();\n                for (var i = 0; i < replyCommentList.length; i++) {\n\n                    var replyaList = replyCommentList[i];\n                    var content = replyaList.content;\n                    content = changeContent(content);\n                    var beReplyUserName = \"\";\n                    var beReplyUserId = \"\";\n                    var replayToPub = false;\n                    // console.log(replyaList);\n                    var SenUserId = checkUserId(replyaList.user.id);\n                    var threeUserId = \"javascript:;\";\n\n                    if (replyaList.topicSubReplyUser) {\n                        beReplyUserName = replyaList.topicSubReplyUser.nickname;\n                        beReplyUserId = replyaList.topicSubReplyUser.id;\n                        replayToPub = true;\n                        threeUserId = checkUserId(beReplyUserId);\n                    }\n                    var showCom = {\n                        \"SenUserId\": SenUserId,\n                        \"threeUserId\": threeUserId,\n                        \"topicType\": 0,\n                        \"backTopicId\": commentid,\n                        \"parentCommentId\": commentid, //话题id\n                        \"topicId\": replyaList.topicId,\n                        \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n                        \"content\": content, //回复内容\n                        \"replyUserName\": replyaList.user.nickname, //回复人昵称\n                        \"replyUserId\": replyaList.user.id, //回复人id\n                        \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n                        \"beReplyUserId\": beReplyUserId, //被回复人的id\n                        \"replyCommentId\": replyaList.id // 二级回复内容id\n                    }\n                    var item = secondComList(showCom);\n                    //console.log(showCom);\n                    $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-box\").append(item);\n                    // if ($is_Login == \"0\") {\n                    //     $(\"[data-node=secondCom_Key]\").css(\"display\", \"none\");\n                    // }\n                    obj.html(\"收起\");\n                    //obj.css(\"display\", \"none\");\n\n                }\n            } else {\n                obj.addClass(\"hide\");\n                $(\"[data-ddlist='\" + commentid + \"']\").parent().addClass(\"bd-bottom\");\n            }\n        });\n    }\n}\n\nfunction checkUserId(id) {\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\nmodule.exports = showMoreList;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/showMoreList.js","//表情添加\n\nvar checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\nvar face = require('module/popup/face/face');\nvar loginState = require('./loginState');\n\nvar textareaTips = '[data-node=\"textareaTips\"]';\nvar curretTextArea = [];\nvar $showBox;\nvar selectText = function(textbox, startIndex, stopIndex) {\n    if (textbox.setSelectionRange) {\n        textbox.setSelectionRange(startIndex, stopIndex);\n    } else if (textbox.createTextRagen) {\n        var range = textbox.createTextRange();\n        range.collapse(true);\n        range.moveStart('character', startIndex);\n        range.moveEnd('character', stopIndex - startIndex);\n        range.select();\n    }\n    textbox.focus();\n};\n\nvar insertAtCursor = function(textbox, text) {\n    if (textbox.selectionStart >= 0) {\n        var val = textbox.value;\n        var startIndex = textbox.selectionStart;\n        textbox.value = val.substring(0, startIndex) + text + val.substring(textbox.selectionEnd);\n        textbox.selectionStart = textbox.selectionEnd = startIndex + text.length;\n        textbox.focus();\n    } else if (typeof document.selection != 'undefined' && typeof document.selection.createRange != 'undefined') {\n        textbox.focus();\n        $(textbox).siblings(textareaTips).addClass('hide');\n        var range = document.selection.createRange();\n        range.text = text;\n        range.select();\n    }\n};\nvar showEmoji = function() {\n    if ($showBox) {\n        $showBox.hide();\n    } else {\n        $showBox = $('[data-node=\"picPopBox\"]');\n        $showBox.hide();\n    }\n\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var $this = $(this);\n\n    var offset = $this.offset();\n    var x = offset.left - 2;\n    var y = offset.top + 38;\n\n    curretTextArea = $this.closest('.topic-publish-content').children(\"textarea\");\n    curretTextArea.focus();\n    if ($('[data-node=\"faceBox\"]').is(':hidden')) {\n        face.show(x, y);\n    } else {\n        face.hide();\n    }\n\n    return false;\n};\n\nmodule.exports = {\n    showEmoji: showEmoji,\n    insertAtCursor: insertAtCursor,\n    selectText: selectText,\n    curretTextAreaObj: function() {\n        return curretTextArea.get(0);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/Smiley.js","\nvar getCommentList = require('./getCommentList'); //\n\n//var $loadlist = $(\"[data-node=loadlist]\");\n//var $comment_Msg = $(\"[data-node=comment_Msg]\");\n//var $a_Submit = $(\"[data-node=a_Submit]\");\n//var $circleCom = $(\"[data-node=circleCom]\");\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar DIVOBJ = $(\"[data-node='more-topic']\");\nvar loginPop = require('module/popup/login');\nvar  lodingMore = function(){\n\n    //加载更多\n\n    //$(\"[data-node=loading]\").css(\"display\", \"none\");\n    //$(\"[data-node=noload]\").css(\"display\", \"none\");\n\n    DIVOBJ.on(\"click\" ,\"[data-node='loadlist']\",function(){\n        var hideDiv = $(this).parent(\"[data-node='hidDiv']\")\n        var topicId = hideDiv.attr(\"data-comtopicid\");\n        var userSubmits = hideDiv.find(\"[data-node='userSubmit']\");\n        var addmorepages = $(this).attr(\"data-addmorepages\"); //当前页\n        var listsize = $(this).attr(\"data-listsize\"); //\n        //var tootalPa = $(this).attr(\"data-tootlepa\"); //总页数\n        var toPage = parseInt(addmorepages) + 1;\n        var nodelist = \"nodelist\";\n\n        for(var i=0,len = userSubmits.length; i<len; i++){\n            var $this = $(userSubmits[i]);\n            $this.next('a').remove();\n            $this.next('div').remove();\n            $this.remove();\n            \n        }\n\n        getCommentList(topicId,toPage, listsize, 5, nodelist);\n        return false;\n    });\n\n\n}\n\n// 点击评论图标页面滚动到评论区域\nvar goComment = function() {\n\n\n\n    var $body = $('body');\n    $body.on('click',\"[data-action='goComment']\", function() {\n        if (!checkLoginStatus()) {\n            loginPop();\n            return false;\n        }\n        var id = $($(this).parents()[2]).attr(\"data-conter-ul\");\n        //console.log(id);\n        if (window.BP) {\n            BP.send({\n                event_id: 'G000P008',\n                group_id: $_CONFIG.groupid,\n                topic_id: $_CONFIG.topicid,\n                circle_type: $_CONFIG.s_c,\n                channel_id: 'in-pinglun'\n            });\n        }\n\n        var $topObj = $(\"[data-left='\"+id+\"']\").children(\"[data-node='commentBox']\");\n        var offsetTop = $topObj.offset().top;\n        $(\"[data-tid='\"+id+\"']\").children(\"textarea\").focus();\n        $('html,body').animate({\n            'scrollTop': offsetTop\n        }, 200);\n\n\n    });\n}\n\n\n\n\nmodule.exports = {\n\tlodingMore : lodingMore,\n\tgoComment :goComment\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/otherFn.js","var praise = require('module/praise');\n\nvar $praiseClick = $(\"[data-node='praiseClick']\");\n\n if($praiseClick.children(\"em\").hasClass(\"active\")){\n    $praiseClick.children(\"span\").html(\"取消点赞\");\n}\n\nvar init = function(){\n    praise('body', '[data-node=\"praiseClick\"]', {\n        mode: 'normal'\n    });\n   /* praise('[data-node=hot_topics]', '[data-action=like]', {\n        mode: 'normal'\n    });\n    */\n\n    return false;\n};\n\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/praise.js","var share = require('module/share').shareto;\nvar shareBP = require('module/shareBP');\n\nvar init = function() {\n    var $body = $(\"body\");\n    //var $wx = $('[data-node=wx]');\n    // var $wb = $('[data-node=wb]');\n    //var $qq = $('[data-node=qq]');\n    //var $qzone = $('[data-node=qzone]');\n\n    var gomeplusLogo = $_CONFIG.imgpath + '/images/public/down-logo.png';\n\n    var getShareInfo = function($node) {\n        var $ul = $node.closest('ul');\n        var shareInfo = {\n            url: $ul.data('surl'),\n            title: $ul.data('stitle'),\n            pic: $ul.data('spic') || gomeplusLogo,\n            summary: $ul.data('content') || \"这里有志趣相投的小伙伴，机智诙谐的猛料，还有你\"\n                //desc: $ul.data('content')\n        };\n        return shareInfo;\n    };\n\n    var shareTo = function(type) {\n        return function() {\n            var info = getShareInfo($(this));\n            //console.log(info);\n            var topicId = $(this).closest('.topic-conter').attr(\"data-conter-ul\");\n            //console.log(topicId);\n            share[type](info);\n            // analytic(type, topicId); // 发送统计数据\n            var opts = {\n                page: 'ht',\n                shareTo: type,\n                shareId: topicId\n            }\n            shareBP(opts);\n            return false;\n        };\n    };\n\n    var evtType = 'click';\n    var $conf = $_CONFIG;\n\n    /*var channels = {\n        'wx': 'out-weixin',\n        'sina': 'out-xlwb',\n        'qq': 'out-QQ',\n        'qzone': 'out-Qqzone'\n    };\n    var analytic = function(channel, topicId) {\n        BP.send({\n            event_id: 'G000P008',\n            group_id: $conf.groupid,\n            topic_id: topicId,\n            circle_type: $conf.s_c,\n            channel_id: channels[channel] || ''\n        });\n    };*/\n    $body.on(evtType, \"[data-node='wx']\", function() {\n        // 当前话题页所对应的wap页的地址\n        // https://m-pre.gomeplus.com/group/topic?topicId=56dfeac86af14853711f4668\n        var topicid = $(this).closest('.topic-conter').attr(\"data-conter-ul\");\n        share.weixin({\n            url: $_CONFIG.wap_circle_url + '/topic-' + topicid + '.html'\n                //url: \"https://circle.m.gomeplus.com/topic-\" + topicid + \".html\"\n        });\n\n        // analytic('wx'); // 发送统计数据\n        var opts = {\n            page: 'ht',\n            shareTo: 'wx',\n            shareId: topicid\n        };\n        shareBP(opts); //发送统计数据\n        return false;\n    });\n    $body.on(evtType, \"[data-node='wb']\", shareTo('wb'));\n    $body.on(evtType, \"[data-node='qq']\", shareTo('qq'));\n    $body.on(evtType, \"[data-node='qzone']\", shareTo('qz'));\n};\n\nmodule.exports = {\n    init: init\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/share.js","/*\n@Author:dongyukuan\n@data:2017/3/2\n话题详情页和圈子主页的分享埋点\n使用方法：\n    1、var shareBP = require('module/shareBP');\n    2、shareBP(opts);\n       注：opts={\n            page:是圈子主页还是话题详情页\n            shareTo:分享到微信、微博等\n            share_id:topic_id或group_id\n       }\n*/\n\nvar fetch = require(\"io/fetch\");\nvar api = 'https://beacon.gomeplus.com/log_share';\nvar shareObj = {\n    ht: {\n        share: {\n            qq: '2010506904',\n            qz: '2020506904',\n            wx: '2030506904',\n            wb: '2050506904'\n        },\n        url: {\n            qq: location.href + '&cmpid=fx_pc_qq' + $_CONFIG.share_time,\n            qz: location.href + '&cmpid=fx_pc_qz' + $_CONFIG.share_time,\n            wx: location.href + '&cmpid=fx_pc_wx' + $_CONFIG.share_time,\n            wb: location.href + '&cmpid=fx_pc_wb' + $_CONFIG.share_time\n        }\n    },\n    qz: {\n        share: {\n            qq: '2010507903',\n            qz: '2020507903',\n            wx: '2030507903',\n            wb: '2050507903'\n        },\n        url: {\n            qq: location.href + '&cmpid=fx_pc_qq' + $_CONFIG.share_time,\n            qz: location.href + '&cmpid=fx_pc_qz' + $_CONFIG.share_time,\n            wx: location.href + '&cmpid=fx_pc_wx' + $_CONFIG.share_time,\n            wb: location.href + '&cmpid=fx_pc_wb' + $_CONFIG.share_time\n        }\n    },\n    user_id: $_CONFIG.userId,\n    cookie_id: $_CONFIG.share_ssid,\n    env: $_CONFIG.share_env\n};\n\nfunction jianjie(data) {\n    console.log(data)\n};\n\nfunction shareBP(opts) {\n    var page = opts.page; //需传入'topic'(话题详情页)；'circle'(圈子主页);\n    var shareTo = opts.shareTo; //分享到哪(qq,qzone,wx,sina);\n    var share_id = opts.shareId; //topic_id或group_id;\n    function getcookie(objname){//获取指定名称的cookie的值\n        var cookieArr = document.cookie.split(\"; \");\n        for(var i = 0;i < cookieArr.length;i ++){\n            var temp = cookieArr[i].split(\"=\");\n            if(temp[0] == objname) return unescape(temp[1]);\n        }\n    }\n    var shareData = {\n        'sp':'plus',\n        'pf':'pc',\n        'sc':shareTo,\n        'st':page,\n        'ss':0,\n        'pid':window.page_id,\n        'sid':share_id,       \n        'uid':shareObj.user_id,\n        'cid':getcookie('__gmz'),\n        'url': shareObj[page].url[shareTo],\n        'env': shareObj.env,\n        'di':''\n    };\n    shareData = JSON.stringify(shareData);\n    fetch.post(api, {\n        data: shareData\n    }).done(function(data) {})\n};\nmodule.exports = shareBP;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/shareBP.js","/**\n * 话题收藏/取消收藏\n */\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar loginPop = require('module/popup/login');\nvar checkLoginStatus = require('module/checkLoginStatus');\n\nvar popFlag = 0;\n\nvar login = function() {\n    window.location.href = $_CONFIG.passport_domain + 'login/index';\n};\nvar $collect = $(\"[data-node='collect']\");\nif ($collect.children(\"em\").parent().hasClass(\"active\")) {\n    $collect.children(\"span\").html(\"取消收藏\");\n    // $collect.attr(\"data-status\",\"1\");\n}\n\n\nvar init = function() {\n    var $body = $(\"body\");\n    $body.on('click', \"[data-node='collect']\", function() {\n        var $CONF = $_CONFIG;\n        if (window.BP) {\n            BP.send({\n                event_id: 'G000P008',\n                group_id: $CONF.groupid,\n                topic_id: $($(this).parents()[2]).attr(\"data-conter-ul\"),\n                circle_type: $CONF.s_c,\n                channel_id: 'in-shoucang'\n            });\n        }\n\n        var $this = $(this);\n        // var firing = $this.data('firing');\n        // if (firing) {\n        //     return false;\n        // }\n        // $this.data('firing', 1);\n        var iscollect = $this.data('status');\n        // 1 收藏, 2 取消收藏\n        var t = iscollect === 0 ? 1 : 2;\n\n        //console.log($($this.parents()[2]).attr(\"data-conter-ul\"));\n        var objs = {\n            //validate: true,\n            data: {\n                groupId: $_CONFIG['groupid'],\n                topicId: $($this.parents()[2]).attr(\"data-conter-ul\"),\n                type: t\n            },\n            onLogin: noRefreshFetch,\n            refresh: true // 目前登录和收藏需要刷新页面\n        }\n\n        //无刷新登录\n        function noRefreshFetch() {\n            var o = objs;\n            fetch.post(url.get('collectTopic'), o).done(function(data) {\n                //订阅评论区编辑状态\n                Pubsub(channel.comment.enableEditor).pub({\n                    pid: \"enable\"\n                });\n                if (data && data.code === 200 && data.success) {\n                    if (t === 1) {\n                        $this.data('status', 1);\n                        $this.find('em').parent().addClass('active');\n                        $this.find('span').text('取消收藏');\n                    } else if (t === 2) {\n                        $this.data('status', 0);\n                        $this.find('em').parent().removeClass('active');\n                        $this.find('span').text('收藏');\n                    }\n                } else if (data && data.code === 422) {\n                    login();\n                } else {\n                    alert(data.message);\n                }\n                if (popFlag) {\n                    window.location.reload();\n                }\n            }).fail(function() {\n\n            }).always(function() {\n                // $this.data('firing', 0);\n            });\n        }\n        if (!checkLoginStatus()) {\n            popFlag = 1;\n            loginPop(noRefreshFetch);\n        } else {\n            popFlag = 0;\n            noRefreshFetch()\n        }\n        return false;\n    });\n};\n\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/collect.js","var Pubsub = require('io/pubsub');\nvar identify = require('utils/IdentifyIE8-');\nvar titel = require('./title.tpl');\nvar comList = require('./comList.tpl');\nvar commentBox = require('./commentBox.tpl');\nvar topicRight = require('./topicRight.tpl');\nrequire('lazyload');\n\nrequire('history');\nrequire('module/atgregion')();\n\nvar getCommentList = require('../comment/getCommentList');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\n\nvar clickTopicId = $_CONFIG['topicid'];\nvar clickTopicObj = {\n    \"name\": $_CONFIG['topic_title'],\n    \"id\": clickTopicId\n};\n//console.log(clickTopicObj);\nvar len = 0;\nvar lastScroll = 0;\n\nvar downLoadTopic = [clickTopicObj]; //已加载的有效话题id\n\nvar OpenedTop = [clickTopicObj]; //记录页面已经滑过的话题id\nvar ListTopsValid = [];\n\nvar arrayIdBoolean = []; //改变ul地址的判断\nvar idVideo = [];\nvar videoObj = [];\nvar currentId = clickTopicObj.id;\nvar oldCurrentId  = clickTopicObj.id;\n//var vid = null;\n\nvar $no_next = $_CONFIG['no_next']; //1 false\n\nvar imgPath = $_CONFIG['imgpath'];\nvar isLogin = $_CONFIG['islogin'];\n\nvar jctjmodule = $_CONFIG['htfxan']; //分享按钮\nvar htxqmodule = $_CONFIG['htxq']; //话题详情\nvar htcyplmodule = $_CONFIG['htcypl']; //参与评论\nvar htpllbmodule = $_CONFIG['htpllb']; //评论列表\nvar htqzxxmodule = $_CONFIG['htqzxx']; //圈主信息\nvar htrmhtmodule = $_CONFIG['htrmht']; //热门话题\nvar htxyymodule = $_CONFIG['htxyy']; //下一篇\n//$GLOBAL_CONFIG['ggckgd'] = 'PGGMKCKmd0003';  //埋点查看更多标示\nvar ggjzgdmodule = $_CONFIG['ggjzgd']; //埋点加载更多标示\nvar hotTopicUl = $(\"[data-node='hot_topics']\").html();\nvar topicRT = $(\".topic-r-t\").html();\nvar $topicWrap =  $(\"[data-node='more-topic']\");\nvar number = 0;\nfunction addDivHtml(newMsg1) {\n    var newMsg = newMsg1;\n    var id = newMsg.id;\n    //右侧的参数\n    var rightNextMsg = {\n        topicRT: topicRT,\n        hotTopicUl: hotTopicUl,\n        id: id,\n        nextTopName: newMsg.topicName,\n        nextTopTime: newMsg.lastReplyTime,\n        htqzxxmodule: newMsg.htqzxxmodule,\n        htrmhtmodule: newMsg.htrmhtmodule,\n        htxyymodule: newMsg.htxyymodule\n    }\n\n    var elemTitle = titel(newMsg); //头部\n    var elemCommentBox = commentBox(newMsg);\n    var elemComList = comList(newMsg); //评论\n    var elemRight = topicRight(rightNextMsg);\n\n    var topicHtml = '<div class=\"more-topic\" >'\n                        + '<div class=\"wrap-box ovflow-hid wrap-reletive \" data-node=\"wrap-box\" id-node=' + id + '>'\n                            + '<div class=\"topic-lfet\" data-left=' + id + '>'\n                                + elemTitle\n                                + elemCommentBox\n                                + elemComList\n                            + '</div>'\n                            + elemRight\n                        + '</div>'\n                    '</div>';\n    $topicWrap.append(topicHtml);\n\n    var $leftImg = $topicWrap.children().last().find('.source-rig-box img');\n    $leftImg.lazyload({\n        effect: \"fadeIn\"\n    });\n}\n\nfunction getVideo() {\n\n    var videoArr = $_CONFIG['video_arr'];\n    //console.log();\n    var newVideo = [videoArr];\n    if (videoArr.length > idVideo.length) {\n\n        newVideo = videoArr.slice(idVideo.length);\n        for (var i = 0; i < newVideo.length; i++) {\n\n            var _video = newVideo[i];\n            var video_id = _video.base.id;\n\n            var v = new MeixinPlayer();\n            v.init(video_id, 'videoContainer_' + video_id + \"_\" + _video.config.topicId, _video.config);\n            idVideo.push(newVideo[i]);\n            videoObj.push(v);\n\n            v.on('playStart', function() {\n                for (var i = 0; i < videoObj.length; i++) {\n                    if (videoObj[i] === v) {\n                        //return false;\n                    } else {\n                        videoObj[i].stopVideo();\n                    }\n                }\n            }, v);\n        }\n    } else {\n        return false;\n    }\n}\nvar nextLoading = 0;\n\n//增加话题访问量\nvar addVisitTopicId = function(openTopicId) {\n    fetch.get(url.get('addVisitTopic'), {\n        data: {\n            topicid: openTopicId\n        }\n    })\n}\n\n//获取话题中商品价格\nvar getGoodsPrice = function(goodsId) {\n    var ids = '';\n    $.each(goodsId, function(i, v) {\n        ids += ',' + $(v).attr('data-id') + '|' + $(v).attr('data-skuid');\n    })\n    return ids.substr(1);\n}\n\n//渲染话题中的价格\nvar changeGoodsPrice = function(topicId) {\n    var curTopicId = $('[id-node=\"' + topicId + '\"]');\n    var len = curTopicId.find('strong[data-id]').length;\n    var ids = getGoodsPrice(curTopicId.find('strong[data-id]'));\n    if (len !== 0) {\n        fetch.get(url.get('getIndexData'), {\n            data: {\n                type: 'product',\n                ids: ids\n            }\n        }).done(function(data) {\n            if (data.success === true) {\n                $.each(data.data, function(i, v) {\n                    if (v.salePrice === null) {\n                        v.salePrice = '暂无售价'\n                    }\n                    $('[data-id=\"' + v.id + '\"]').text(v.salePrice);\n                    $('[data-id=\"' + v.id + '\"]').parent('[data-node=\"price\"]').removeClass('hide');\n                })\n            }\n\n        })\n    }\n}\n\nfunction getNextTopicId(openTopicId) {\n    arrayIdBoolean.push(openTopicId);\n\n    fetch.get(url.get('getNextTopic') + \"?topicid=\" + openTopicId).then(function(data) {\n        if (data.success == true && data.code == 200) {\n\n            var $getNext = $(\"[data-get-next-topic='\" + openTopicId + \"']\");\n            if (nextLoading) {\n                $getNext.children(\"a\").html(data.data.name)\n                    .attr(\"href\", \"/topic/\" + data.data.id + \".html\")\n                    .attr(\"target\", \"_blank\");\n                $getNext.find(\".f12\").html(data.data.lastReplyTime);\n                $getNext.slideDown(\"slow\");\n            } else {\n                nextLoading = 1;\n            }\n            //获取下个话题的信息，id\n            var userImage = $_CONFIG['headface'];\n            var pathImg = $_CONFIG.imgpath;\n            if (!userImage) {\n                userImage = pathImg + \"/images/public/head-default.png\";\n            }\n            var isExpert = $_CONFIG['isExpert'] ? true : false; //是否为达人\n\n            //console.log(isLogin);\n            var isLoginClass = \"\";\n            var isLoginStr = '';\n            var readyOnly = '';\n            if (isLogin == \"0\") {\n                isLoginStr = \"登录\";\n                isLoginClass = \"pc-bj-fc8753\";\n                readyOnly = \"readonly\";\n                //var headface\n            } else {\n                isLoginStr = \"发布\";\n                isLoginClass = \"\";\n                readyOnly = \"\";\n            }\n\n            var dataStr = data.data;\n            var id = dataStr.id;\n            var name = data.data.name;\n            $(\"body\").attr(\"data-currentTopicId\", openTopicId);\n            $(\"body\").attr(\"data-nextTopicId\", id);\n\n            downLoadTopic.push({\n                \"name\": name,\n                \"id\": id\n            });\n\n            // 点赞和收藏\n\n            //var likeIS = dataStr.ext.praise.isLike == false ? \"\" : \"active\";\n            var UserId = checkUserId(dataStr.user.id);\n            var allNum = parseInt(dataStr.replyQuantity + dataStr.subReplyQuantity);\n            var newMsg = {\n                    jctjmodule: getModuleString(jctjmodule),\n                    htxqmodule: getModuleString(htxqmodule),\n                    htcyplmodule: getModuleString(htcyplmodule),\n                    htpllbmodule: getModuleString(htpllbmodule),\n                    htqzxxmodule: getModuleString(htqzxxmodule),\n                    htrmhtmodule: getModuleString(htrmhtmodule),\n                    htxyymodule: getModuleString(htxyymodule),\n                    ggjzgdmodule: ggjzgdmodule,\n                    UserId: UserId,\n                    html: dataStr.html,\n                    isEssence: dataStr.isEssence, //精品,\n                    isUpper: dataStr.isUpper, //置顶,\n                    style: dataStr.style == \"0\" ? false : true, //专访\n                    topicName: dataStr.name, //话题名称\n                    id: id, //话题ID\n                    imgPath: imgPath,\n                    facePicUrl: dataStr.user.facePicUrl, // 话题 用户头像\n                    nickName: dataStr.user.nickname, //话题 用户名\n                    groupCircleName: dataStr.group.name, //来自圈子\n                    lastReplyTime: dataStr.lastReplyTime, //话题时间\n                    allNum: allNum, //评论数\n                    extGroupUrl: dataStr.ext.group_url, // 圈子路径\n\n                    extImagesLst: dataStr.ext.surl, //左侧ul上添加的数据\n                    share_text: dataStr.ext.share_text, // 左侧ul上的data-content 属性值\n                    extSpic: dataStr.ext.images_lst,\n                    extStitle: dataStr.name,\n\n                    isLike: dataStr.ext.praise.isLike == false ? \"\" : \"active\", //点赞\n                    isLikeName: dataStr.ext.praise.isLike == false ? \"点赞\" : \"取消点赞\", //点赞\n                    userQuantity: dataStr.ext.praise.userQuantity, // 点赞数\n                    userCollection: dataStr.userCollection.result == 0 ? \"\" : \"active\", //收藏\n                    userCollectionName: dataStr.userCollection.result == 0 ? \"收藏\" : \"取消收藏\", //收藏\n                    userCollectionStatu: dataStr.userCollection.result == 0 ? 0 : 1,\n                    dataParise: dataStr.ext.praise.isLike == false ? \"1\" : \"0\", //点赞\n\n                    is_del: dataStr.user.is_del,\n                    isExpert: isExpert, //是否是达人\n                    userImage: userImage, //用户头像\n                    groupId: data.data.groupId, //groupid\n\n                    isLoginStr: isLoginStr, //根据是否登陆判断显示 按钮内容\n                    isLoginClass: isLoginClass, //根据是否登陆显示  样式\n                    readyOnly: readyOnly //根据是否登陆判断是  只读还是可写\n\n                }\n                //填写数据\n            addDivHtml(newMsg); //添加数据到页面\n            showTextareaTips();\n            $(\"body\").attr(\"data-module\", Number($(\"body\").attr(\"data-module\")) + 1);\n            if (allNum != 0) {\n                getCommentList(id, 1, 10, 2);\n            }\n            ListTopsValid.push({\n                \"name\": name,\n                \"id\": id\n            });\n\n            var topRightH = $(\"[data-topicrt='\" + openTopicId + \"']\");\n            var h = topRightH.children(\".topic-r-t\").height() + topRightH.children(\".topic-position\").height();\n\n            $(\"[id-node='\" + openTopicId + \"']\").css(\"min-height\", h + \"px\");\n\n        } else if (data.success == false && data.code == 404) {\n            return false;\n        }\n\n    });\n\n}\n\n//鼠标下滑\nfunction addMoreEvent(s) {\n    //var TopicIdNext = $(\"body\").attr(\"data-nexttopicid\"); //\n    if (len == -1) {\n        // 已经滑过的对象数字\n        OpenedTop.push(clickTopicObj); //clickTopic\n        len = 0;\n    }\n    if (ListTopsValid.length - 1 == len) {\n        var id = ListTopsValid[ListTopsValid.length - 1].id;\n        var name = ListTopsValid[ListTopsValid.length - 1].name;\n\n        if (s > $(\"[id-node='\" + id + \"']\").offset().top) {\n            History.replaceState({}, name, id + \".html\");\n            OpenedTop.push({\n                name: name,\n                id: id\n            });\n            if ($no_next == 0 && arrayIdBoolean[arrayIdBoolean.length - 1] != id) {\n                getNextTopicId(id);\n                addVisitTopicId(id);\n                changeGoodsPrice(id);\n            }\n            getVideo();\n            len++;\n            currentId = id;\n        }\n    }\n\n    if (ListTopsValid.length - 1 > len) {\n        var id1 = ListTopsValid[len].id;\n        var name1 = ListTopsValid[len].name;\n\n        if (s > $(\"[id-node='\" + id1 + \"']\").offset().top) {\n            History.replaceState({}, name1, id1 + \".html\");\n            OpenedTop.push({\n                name: name1,\n                id: id1\n            });\n            len++;\n            currentId = id1;\n        }\n    }\n}\n//鼠标上滑\nfunction scrollToTop(t) {\n\n    var id = \"\";\n    var nextiD = \"\";\n    var name = \"\";\n    if (len < 1) {\n        nextiD = clickTopicObj.id;\n        name = clickTopicObj.name;\n        currentId = nextiD;\n    } else {\n        id = OpenedTop[len].id;\n        nextiD = OpenedTop[len - 1].id;\n        name = OpenedTop[len - 1].name;\n        currentId = id;\n    }\n    if (id) {\n        //var scrollTop = $(this).scrollTop();\n        if (t < $(\"[id-node='\" + id + \"']\").offset().top) {\n            History.replaceState({}, name, nextiD + \".html\");\n            OpenedTop.length = len;\n            len--;\n        }\n    }\n}\n\n//右侧 固定\nfunction topFixed(scrollTop) {\n\n    var showTopicID = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n\n    var $showDiv = $(\"[id-node='\" + showTopicID + \"']\"); //当前话题的div\n    var $showRight = $showDiv.children(\".topic-right \"); //右侧整体\n    var $thisScroll = $showRight.children(\"[data-node='topic_xi']\"); // 滚动部分\n    var $showLeft = $showDiv.children(\".topic-lfet\"); //左侧\n\n    var showDivHeight = $showDiv.height(); // 话题整体高度\n    var showRightHeight = $showRight.height(); //右侧高度\n    var thisScrollHeight = $thisScroll.height(); //热门话题的高度\n    var windowHight = $(window).height(); //窗口高度\n    var showLeftHeight = $showLeft.height(); //左侧高度\n\n    var floatRight = $(\"body\").width() - $(\".wrap-box\").width();\n    floatRight = parseInt(floatRight) / 2; //右边浮动的宽度\n\n    var s = scrollTop; //鼠标滚动的高度\n    var TopShow = parseInt($showDiv.offset().top); //整个话题div距离顶部的高度\n    var topicRT = TopShow + 320; //热门话题距离页面顶部的距离\n    var BottomShow = parseInt(TopShow) + showDivHeight; //热门话题距离页面底部的距离，应该减去热门话题的高度\n\n    // 左侧小于右侧，不操作\n    if (showLeftHeight <= showRightHeight) {\n        return false;\n    } else {\n        var pp = null;\n        var autoTop = null;\n        var opx = null;\n        //var toTopHeight = $(\".topic-r-t\").height();\n\n        var h = 0;\n        //var m = 0;\n        if (windowHight > thisScrollHeight) {\n            h = windowHight - thisScrollHeight;\n        } else {\n            //m = thisScrollHeight - windowHight;\n        }\n\n        if (thisScrollHeight <= windowHight) {\n            //吸顶\n            pp = topicRT;\n            autoTop = \"0px\";\n            opx = \"auto\";\n        } else {\n            //吸底\n            pp = topicRT - windowHight + thisScrollHeight;\n            autoTop = \"auto\";\n            opx = \"0px\";\n        }\n        //var h = windowHight - thisScrollHeight;\n        if (s > pp && s + windowHight <= BottomShow + h) {\n            $($thisScroll).css({\n                \"position\": \"fixed\",\n                \"right\": floatRight + \"px\",\n                \"top\": autoTop,\n                \"bottom\": opx\n            });\n        } else if (s + windowHight > BottomShow + h) {\n            $($thisScroll).css({\n                \"position\": \"absolute\",\n                \"right\": \"0px\",\n                \"top\": \"auto\",\n                \"bottom\": \"0px\"\n            });\n        } else if (s < pp) {\n            $($thisScroll).css({\n                \"position\": \"absolute\",\n                \"right\": \"0px\",\n                \"top\": \"320px\",\n                \"bottom\": \"auto\"\n            });\n        }\n\n    }\n\n}\nvar leftS = parseInt($(\".wrap-box.ovflow-hid\").css(\"margin-left\"), 10) + 20;\nfunction ulFixt(scrollTop) {\n    var containerId = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n    var $divConter = $(\"[data-conter-ul='\" + containerId + \"']\");\n    var $ul = $($divConter).children(\"ul\");\n    var divTop = $divConter.offset().top;\n    var divHeight = $divConter.height();\n    var ulHeight = $ul.height();\n    var s = divHeight + divTop - ulHeight;\n    if (scrollTop > divTop && scrollTop < s) {\n        $ul.css({\n            \"position\": \"fixed\",\n            \"top\": \"6px\",\n            \"left\": leftS + \"px\",\n            \"bottom\": \"auto\"\n        });\n    } else if (scrollTop > s) {\n        $ul.css({\n            \"position\": \"absolute\",\n            \"top\": \"auto\",\n            \"left\": \"0px\",\n            \"bottom\": \"0px\"\n        });\n    } else if (scrollTop < divTop) {\n        $ul.css({\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"bottom\": \"auto\",\n            \"left\": \"0px\"\n        });\n    }\n\n}\n\nfunction checkUserId(id) {\n    if (isLogin == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\n\n// 返回顶部a\nfunction toTopBtn() {\n    var $Btn = $(\"[data-node='top']\");\n    $Btn.off();\n    var btnScroll = -1;\n\n    $Btn.on(\"click\", function() {\n\n        var topicId = \"\";\n        var winScrollTop = parseInt($(window).scrollTop());\n        $(this).attr(\"data-winScrollTop\", winScrollTop);\n        if (btnScroll == winScrollTop) {\n            OpenedTop = [clickTopicObj];\n            topicId = OpenedTop[OpenedTop.length - 1]; //当前话题id\n            len = 0;\n            $(\"html, body\").scrollTop(10);\n            History.replaceState({}, topicId.name, topicId.id + \".html\");\n\n        } else {\n            topicId = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n            var dropTop = parseInt($(\"[id-node='\" + topicId + \"']\").offset().top);\n            $(window).scrollTop(dropTop);\n            btnScroll = dropTop;\n        }\n        $(this).attr(\"data-btnScroll\", btnScroll);\n        //console.log(\"winScrollTop: \"+winScrollTop +\" dropTop: \"+dropTop);\n    })\n}\n\nvar getModuleString = function(modulestr) {\n    // var num = Number($(\"body\").attr(\"data-module\")) +1;\n    // if(num <10 ){\n    //     return modulestr+\"000\"+num;\n    // }else if(num >=10 && num <1000 ){\n    //     return modulestr+\"00\"+num;\n    // }else if(num >=100 && num <100){\n    //     return modulestr+\"0\"+num;\n    // }else if( num >=1000 &&num <10000){\n    //     return modulestr+\"\"+num;\n    // }\n    return modulestr;\n}\n\n//IE显示placeholder内容\nvar showTextareaTips = function() {\n    var $textareaTips = $('[data-node=\"textareaTips\"]');\n    if (identify()) {\n        $textareaTips.removeClass('hide');\n    }\n}\n\nvar init = function() {\n    getVideo();\n    toTopBtn();\n    History.Adapter.bind(window, 'statechange', function() {\n        //var State = History.getState();\n        //History.log('statechange:', State.data, State.title, State.hash);\n    });\n    showTextareaTips();\n    //var topicRT = $(\".topic-r-t\").html(); // 右侧的html\n    //var hotTopicUl = $(\"[data-node=hot_topics]\").html(); //热门话题的html\n\n    //获取下一个话题\n    if ($no_next == 0) {\n        getNextTopicId(clickTopicId);\n    }\n    addVisitTopicId(clickTopicId);\n\n    Pubsub('getAreaId').sub(function() {\n        changeGoodsPrice(clickTopicId);\n    });\n\n    var scrollTop = 0;\n    var windowHight = $(window).height();\n    var s = 0;\n    var noneHeight = 0;\n    //鼠标滚动事件\n    $(window).on(\"scroll\", function() {\n\n        scrollTop = $(this).scrollTop();\n        windowHight = $(window).height();\n        s = parseInt(scrollTop + windowHight / 3);\n        topFixed(scrollTop);\n        ulFixt(scrollTop);\n        var $current = $(\"[id-node='\" + currentId + \"']\").parent();\n        // 视频暂停\n        if (scrollTop - lastScroll > 0) { //下滑\n            //判断并加载话题\n            addMoreEvent(s);\n\n\n        } else { //上滑\n            //改变ulr地址\n            scrollToTop(s);\n            $current.next().nextAll() !== 'none' && $current.next().nextAll().hide();\n\n            if($current.prev().css('display') === 'none') {\n                $current.prev().show();\n                noneHeight = scrollTop + $current.prev().height();\n                $(window).scrollTop(noneHeight);\n            }\n        }\n        if( oldCurrentId !== currentId ){\n            if (scrollTop - lastScroll > 0) {\n                noneHeight = scrollTop - $current.prev().prev().height();\n                $current.prev().prevAll().css('display') !== 'none' && $current.prev().prevAll().hide();\n                $current.next().css('display') === 'none' && $current.next().show();\n                $(window).scrollTop(noneHeight);\n            }\n            oldCurrentId = currentId;\n        }\n\n        lastScroll = scrollTop;\n    });\n}\n\n\nmodule.exports = {\n    init: init,\n    topFixed: topFixed\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/topicAddMore/topicAddMore.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/title',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htxqmodule=$data.htxqmodule,isUpper=$data.isUpper,isEssence=$data.isEssence,style=$data.style,$string=$utils.$string,topicName=$data.topicName,UserId=$data.UserId,facePicUrl=$data.facePicUrl,nickName=$data.nickName,extGroupUrl=$data.extGroupUrl,groupCircleName=$data.groupCircleName,lastReplyTime=$data.lastReplyTime,allNum=$data.allNum,userQuantity=$data.userQuantity,extImagesLst=$data.extImagesLst,extSpic=$data.extSpic,extStitle=$data.extStitle,share_text=$data.share_text,jctjmodule=$data.jctjmodule,dataParise=$data.dataParise,isLike=$data.isLike,isLikeName=$data.isLikeName,userCollectionStatu=$data.userCollectionStatu,userCollection=$data.userCollection,userCollectionName=$data.userCollectionName,html=$data.html,is_del=$data.is_del,$out='';$out+='<div class=\"bjfff\" data-node=\"tiles\" data-title =';\n$out+=$escape(id);\n$out+=' modelid=\"';\n$out+=$escape(htxqmodule);\n$out+='\"> <div class=\"topic-title0\"> <h1> ';\nif(isUpper){\n$out+='<em class=\"set-top\">置顶</em> ';\n}\n$out+=' ';\nif(isEssence){\n$out+='<em class=\"set-spark\">精品</em> ';\n}\n$out+=' ';\nif(style){\n$out+='<em class=\"set-access\">专访</em> ';\n}\n$out+=' ';\n$out+=$string(topicName);\n$out+=' </h1> <p class=\"topic-source\" data-node=\"likewrap\"> <a href=\"';\n$out+=$escape(UserId);\n$out+='\" target=\"_blank\"> <img onerror=\"imgError(this, \\'h\\')\" src=';\n$out+=$escape(facePicUrl);\n$out+=' alt=\"\">';\n$out+=$escape(nickName);\n$out+=' </a> <span>来自圈子：</span> <a href=';\n$out+=$escape(extGroupUrl);\n$out+=' target=\"_blank\">';\n$out+=$escape(groupCircleName);\n$out+='</a> <span>';\n$out+=$escape(lastReplyTime);\n$out+='</span> <span class=\"fr\"> <em class=\"icon-discuss\"></em> <span class=\"topic-count\">';\n$out+=$escape(allNum);\n$out+='</span> </span> <span class=\"fr\"> <em class=\"icon-like\"></em> <span class=\"topic-count\">';\n$out+=$escape(userQuantity);\n$out+='</span> </span>  </a> </p> </div> <div class=\"topic-conter\" data-conter-ul =';\n$out+=$escape(id);\n$out+=' > <ul class=\"source-lef-list\" data-node=\"ulFloat\" data-surl=\"';\n$out+=$escape(extImagesLst);\n$out+='\" data-spic=\"';\n$out+=$escape(extSpic);\n$out+='\" data-stitle=\"';\n$out+=$escape(extStitle);\n$out+='\" data-content=\"';\n$out+=$escape(share_text);\n$out+='\" > <!--modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='\"--> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0001\"><a href=\"javascript:void(0)\" data-node=\"wx\"><em class=\"icon-weixin\"></em><span>微信</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0002\"><a href=\"javascript:void(0)\" data-node=\"wb\"><em class=\"icon-weibo\"></em><span>微博</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0003\"><a href=\"javascript:void(0)\" data-node=\"qq\"><em class=\"icon-qq\"></em><span>QQ</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0004\"><a href=\"javascript:void(0)\" data-node=\"qzone\"><em class=\"icon-qzone\"></em><span>QQ空间</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0005\"> <a href=\"javascript:void(0)\" data-id=\"';\n$out+=$escape(id);\n$out+='\" data-node=\"praiseClick\" data-type=\"1\" data-praise=\"';\n$out+=$escape(dataParise);\n$out+='\" class=\"';\n$out+=$escape(isLike);\n$out+='\"> <em class=\"icon-like-big ';\n$out+=$escape(isLike);\n$out+=' \"></em><span>';\n$out+=$escape(isLikeName);\n$out+='</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0006\"> <a href=\"javascript:void(0)\" data-node=\"collect\" data-status=\"';\n$out+=$escape(userCollectionStatu);\n$out+='\" class=\"';\n$out+=$escape(userCollection);\n$out+='\"> <em class=\"icon-collect-big ';\n$out+=$escape(userCollection);\n$out+='\" ></em><span>';\n$out+=$escape(userCollectionName);\n$out+='</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0007\"><a data-action=\"goComment\" href=\"javascript:;\"><em class=\"icon-discuss-big\"></em><span>评论</span></a></li> </ul> <div class=\"source-right-box\"> ';\n$out+=$string(html);\n$out+=' </div> </div> ';\nif(is_del){\n$out+=' <div class=\"topic-del\" > <a data-node = \"userTopic-del\" href=\"javascript:;\" title=\"删除该话题\">删除</a> </div> ';\n}\n$out+=' </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/title.tpl\n// module id = 253\n// module chunks = 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/comList',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htpllbmodule=$data.htpllbmodule,ggjzgdmodule=$data.ggjzgdmodule,imgPath=$data.imgPath,$out='';$out+='<div class=\"bjfff\" data-node =\"hidDiv\" data-ComTopicId=';\n$out+=$escape(id);\n$out+=' > <div class=\"circle-comments\" data-node=\"circleCom\" data-circleCom = ';\n$out+=$escape(id);\n$out+=' modelid=\"';\n$out+=$escape(htpllbmodule);\n$out+='\"> </div> <div class=\"more-comments\" data-node=\"loadlist\" style=\"display: none;\" modelid=\"';\n$out+=$escape(ggjzgdmodule);\n$out+='\"> <a href=\"##\" class=\"clearfix\"> <span> <img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/circle/small-logo.png\" >点击加载更多 <em class=\"icon icon-right\"></em> </span> </a> </div> <div class=\"more-comments\" data-node=\"loading\" style=\"display: none;\" > <a href=\"javascript:;\" class=\"disabled clearfix\"><span><img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/public/loading.gif\">正在加载...</span></a> </div> <div class=\"more-comments\" data-node=\"noload\" style=\"display: none;\" > <a href=\"javascript:;\" class=\"disabled clearfix\"> <span>没有可加载内容</span> </a> </div> </div>';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/comList.tpl\n// module id = 254\n// module chunks = 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/commentBox',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,htcyplmodule=$data.htcyplmodule,isExpert=$data.isExpert,userImage=$data.userImage,id=$data.id,readyOnly=$data.readyOnly,isLoginClass=$data.isLoginClass,isLoginStr=$data.isLoginStr,allNum=$data.allNum,$out='';$out+='<div data-node=\"commentBox\" class=\"topic-review-box\" modelid=\"';\n$out+=$escape(htcyplmodule);\n$out+='\"> <h2 class=\"review-title\">参与评论</h2> <div class=\"bjfff margin-btom20\" data-node=\"comment_FirDiv\"> <div class=\"text-field-box clearfix\"> <div class=\"topic-user-head\"> ';\nif(isExpert){\n$out+=' <em class=\"icon-daren\"></em> ';\n}\n$out+=' <img src=\"';\n$out+=$escape(userImage);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"> </div> <div class=\"topic-publish-content\" data-node=\"comment_Msg\" data-nickname=\"\" data-tid=\"';\n$out+=$escape(id);\n$out+='\" data-userid=\"0\" data-headface=\"';\n$out+=$escape(userImage);\n$out+='\"> <textarea class=\"textarea-bx\" ';\n$out+=$escape(readyOnly);\n$out+=' placeholder=\"说点什么吧…\" style=\"background: rgb(255, 255, 255);\"></textarea> <label class=\"textarea-tips hide\" data-node=\"textareaTips\">说点什么吧…</label> <div data-node=\"addImgGoods\" data-imgNum =\"9\"> <ul data-node=\"imgUl\" class=\"clearfix hide\"></ul> </div> <div class=\"publish-face-bx\" data-publish=\"';\n$out+=$escape(id);\n$out+='\"> <p class=\"icon-face cursor-pointer\" data-node=\"smilies_Face\"><em class=\"icon-emoji\"></em>表情</p> <p class=\"icon-face cursor-pointer\" data-node=\"addImg_btn\"><em class=\"icon-picture\"></em>图片</p> <p class=\"icon-face cursor-pointer\" data-node=\"addGoods_btn\"><em class=\"icon-goods\"></em>商品</p> <a href=\"javascript:;\" class=\"pc-btn pc-btnh30 pc-btnw105 ';\n$out+=$escape(isLoginClass);\n$out+='\" data-node=\"a_Submit\">';\n$out+=$escape(isLoginStr);\n$out+='</a> </div> </div> </div> </div> </div> <div class=\"comment-title\" data-node=\"hidDiv\"> <div class=\"bd-bottom\"><span class=\"red\">';\n$out+=$escape(allNum);\n$out+='</span><span>条评论</span></div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/commentBox.tpl\n// module id = 255\n// module chunks = 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/topicRight',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htqzxxmodule=$data.htqzxxmodule,$string=$utils.$string,topicRT=$data.topicRT,htrmhtmodule=$data.htrmhtmodule,hotTopicUl=$data.hotTopicUl,htxyymodule=$data.htxyymodule,$out='';$out+='<div class=\"topic-right topic-absolute\" data-topicRT= ';\n$out+=$escape(id);\n$out+='> <div class=\"topic-r-t\" modelid=\"';\n$out+=$escape(htqzxxmodule);\n$out+='\"> <!--modelid=\"';\n$out+=$escape(htqzxxmodule);\n$out+='\"--> ';\n$out+=$string(topicRT);\n$out+=' </div> <div class=\"topic-position\" data-node=\"topic_xi\"> <div class=\"topic-r-b\" data-node=\"hot_topics\"> <!--modelid=\"';\n$out+=$escape(htrmhtmodule);\n$out+='\"--> ';\n$out+=$string(hotTopicUl);\n$out+=' </div> <div class=\"next-page\" data-node=\"next-page\" data-get-next-topic =';\n$out+=$escape(id);\n$out+=' style=\"display: none\" modelid=\"';\n$out+=$escape(htxyymodule);\n$out+='\"> <p><span class=\"f12\" data-node=\"times\"></span>下一篇</p> <a></a> </div> </div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/topicRight.tpl\n// module id = 256\n// module chunks = 29","/**\n * History.js jQuery Adapter\n * @author Benjamin Arthur Lupton <contact@balupton.com>\n * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>\n * @license New BSD License <http://creativecommons.org/licenses/BSD/>\n */\n\n// Closure\n(function(window,undefined){\n\t\"use strict\";\n\n\t// Localise Globals\n\tvar\n\t\tHistory = window.History = window.History||{},\n\t\tjQuery = window.jQuery;\n\n\t// Check Existence\n\tif ( typeof History.Adapter !== 'undefined' ) {\n\t\tthrow new Error('History.js Adapter has already been loaded...');\n\t}\n\n\t// Add the Adapter\n\tHistory.Adapter = {\n\t\t/**\n\t\t * History.Adapter.bind(el,event,callback)\n\t\t * @param {Element|string} el\n\t\t * @param {string} event - custom and standard events\n\t\t * @param {function} callback\n\t\t * @return {void}\n\t\t */\n\t\tbind: function(el,event,callback){\n\t\t\tjQuery(el).bind(event,callback);\n\t\t},\n\n\t\t/**\n\t\t * History.Adapter.trigger(el,event)\n\t\t * @param {Element|string} el\n\t\t * @param {string} event - custom and standard events\n\t\t * @param {Object=} extra - a object of extra event data (optional)\n\t\t * @return {void}\n\t\t */\n\t\ttrigger: function(el,event,extra){\n\t\t\tjQuery(el).trigger(event,extra);\n\t\t},\n\n\t\t/**\n\t\t * History.Adapter.extractEventData(key,event,extra)\n\t\t * @param {string} key - key for the event data to extract\n\t\t * @param {string} event - custom and standard events\n\t\t * @param {Object=} extra - a object of extra event data (optional)\n\t\t * @return {mixed}\n\t\t */\n\t\textractEventData: function(key,event,extra){\n\t\t\t// jQuery Native then jQuery Custom\n\t\t\tvar result = (event && event.originalEvent && event.originalEvent[key]) || (extra && extra[key]) || undefined;\n\n\t\t\t// Return\n\t\t\treturn result;\n\t\t},\n\n\t\t/**\n\t\t * History.Adapter.onDomLoad(callback)\n\t\t * @param {function} callback\n\t\t * @return {void}\n\t\t */\n\t\tonDomLoad: function(callback) {\n\t\t\tjQuery(callback);\n\t\t}\n\t};\n\n\t// Try and Initialise History\n\tif ( typeof History.init !== 'undefined' ) {\n\t\tHistory.init();\n\t}\n\n})(window);\n\n/**\n * History.js Core\n * @author Benjamin Arthur Lupton <contact@balupton.com>\n * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>\n * @license New BSD License <http://creativecommons.org/licenses/BSD/>\n */\n\n(function(window,undefined){\n\t\"use strict\";\n\n\t// ========================================================================\n\t// Initialise\n\n\t// Localise Globals\n\tvar\n\t\tconsole = window.console||undefined, // Prevent a JSLint complain\n\t\tdocument = window.document, // Make sure we are using the correct document\n\t\tnavigator = window.navigator, // Make sure we are using the correct navigator\n\t\tsessionStorage = false, // sessionStorage\n\t\tsetTimeout = window.setTimeout,\n\t\tclearTimeout = window.clearTimeout,\n\t\tsetInterval = window.setInterval,\n\t\tclearInterval = window.clearInterval,\n\t\tJSON = window.JSON,\n\t\talert = window.alert,\n\t\tHistory = window.History = window.History||{}, // Public History Object\n\t\thistory = window.history; // Old History Object\n\n\ttry {\n\t\tsessionStorage = window.sessionStorage; // This will throw an exception in some browsers when cookies/localStorage are explicitly disabled (i.e. Chrome)\n\t\tsessionStorage.setItem('TEST', '1');\n\t\tsessionStorage.removeItem('TEST');\n\t} catch(e) {\n\t\tsessionStorage = false;\n\t}\n\n\t// MooTools Compatibility\n\tJSON.stringify = JSON.stringify||JSON.encode;\n\tJSON.parse = JSON.parse||JSON.decode;\n\n\t// Check Existence\n\tif ( typeof History.init !== 'undefined' ) {\n\t\tthrow new Error('History.js Core has already been loaded...');\n\t}\n\n\t// Initialise History\n\tHistory.init = function(options){\n\t\t// Check Load Status of Adapter\n\t\tif ( typeof History.Adapter === 'undefined' ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check Load Status of Core\n\t\tif ( typeof History.initCore !== 'undefined' ) {\n\t\t\tHistory.initCore();\n\t\t}\n\n\t\t// Check Load Status of HTML4 Support\n\t\tif ( typeof History.initHtml4 !== 'undefined' ) {\n\t\t\tHistory.initHtml4();\n\t\t}\n\n\t\t// Return true\n\t\treturn true;\n\t};\n\n\n\t// ========================================================================\n\t// Initialise Core\n\n\t// Initialise Core\n\tHistory.initCore = function(options){\n\t\t// Initialise\n\t\tif ( typeof History.initCore.initialized !== 'undefined' ) {\n\t\t\t// Already Loaded\n\t\t\treturn false;\n\t\t}\n\t\telse {\n\t\t\tHistory.initCore.initialized = true;\n\t\t}\n\n\n\t\t// ====================================================================\n\t\t// Options\n\n\t\t/**\n\t\t * History.options\n\t\t * Configurable options\n\t\t */\n\t\tHistory.options = History.options||{};\n\n\t\t/**\n\t\t * History.options.hashChangeInterval\n\t\t * How long should the interval be before hashchange checks\n\t\t */\n\t\tHistory.options.hashChangeInterval = History.options.hashChangeInterval || 100;\n\n\t\t/**\n\t\t * History.options.safariPollInterval\n\t\t * How long should the interval be before safari poll checks\n\t\t */\n\t\tHistory.options.safariPollInterval = History.options.safariPollInterval || 500;\n\n\t\t/**\n\t\t * History.options.doubleCheckInterval\n\t\t * How long should the interval be before we perform a double check\n\t\t */\n\t\tHistory.options.doubleCheckInterval = History.options.doubleCheckInterval || 500;\n\n\t\t/**\n\t\t * History.options.disableSuid\n\t\t * Force History not to append suid\n\t\t */\n\t\tHistory.options.disableSuid = History.options.disableSuid || false;\n\n\t\t/**\n\t\t * History.options.storeInterval\n\t\t * How long should we wait between store calls\n\t\t */\n\t\tHistory.options.storeInterval = History.options.storeInterval || 1000;\n\n\t\t/**\n\t\t * History.options.busyDelay\n\t\t * How long should we wait between busy events\n\t\t */\n\t\tHistory.options.busyDelay = History.options.busyDelay || 250;\n\n\t\t/**\n\t\t * History.options.debug\n\t\t * If true will enable debug messages to be logged\n\t\t */\n\t\tHistory.options.debug = History.options.debug || false;\n\n\t\t/**\n\t\t * History.options.initialTitle\n\t\t * What is the title of the initial state\n\t\t */\n\t\tHistory.options.initialTitle = History.options.initialTitle || document.title;\n\n\t\t/**\n\t\t * History.options.html4Mode\n\t\t * If true, will force HTMl4 mode (hashtags)\n\t\t */\n\t\tHistory.options.html4Mode = History.options.html4Mode || false;\n\n\t\t/**\n\t\t * History.options.delayInit\n\t\t * Want to override default options and call init manually.\n\t\t */\n\t\tHistory.options.delayInit = History.options.delayInit || false;\n\n\n\t\t// ====================================================================\n\t\t// Interval record\n\n\t\t/**\n\t\t * History.intervalList\n\t\t * List of intervals set, to be cleared when document is unloaded.\n\t\t */\n\t\tHistory.intervalList = [];\n\n\t\t/**\n\t\t * History.clearAllIntervals\n\t\t * Clears all setInterval instances.\n\t\t */\n\t\tHistory.clearAllIntervals = function(){\n\t\t\tvar i, il = History.intervalList;\n\t\t\tif (typeof il !== \"undefined\" && il !== null) {\n\t\t\t\tfor (i = 0; i < il.length; i++) {\n\t\t\t\t\tclearInterval(il[i]);\n\t\t\t\t}\n\t\t\t\tHistory.intervalList = null;\n\t\t\t}\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Debug\n\n\t\t/**\n\t\t * History.debug(message,...)\n\t\t * Logs the passed arguments if debug enabled\n\t\t */\n\t\tHistory.debug = function(){\n\t\t\tif ( (History.options.debug||false) ) {\n\t\t\t\tHistory.log.apply(History,arguments);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * History.log(message,...)\n\t\t * Logs the passed arguments\n\t\t */\n\t\tHistory.log = function(){\n\t\t\t// Prepare\n\t\t\tvar\n\t\t\t\tconsoleExists = !(typeof console === 'undefined' || typeof console.log === 'undefined' || typeof console.log.apply === 'undefined'),\n\t\t\t\ttextarea = document.getElementById('log'),\n\t\t\t\tmessage,\n\t\t\t\ti,n,\n\t\t\t\targs,arg\n\t\t\t\t;\n\n\t\t\t// Write to Console\n\t\t\tif ( consoleExists ) {\n\t\t\t\targs = Array.prototype.slice.call(arguments);\n\t\t\t\tmessage = args.shift();\n\t\t\t\tif ( typeof console.debug !== 'undefined' ) {\n\t\t\t\t\tconsole.debug.apply(console,[message,args]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconsole.log.apply(console,[message,args]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmessage = (\"\\n\"+arguments[0]+\"\\n\");\n\t\t\t}\n\n\t\t\t// Write to log\n\t\t\tfor ( i=1,n=arguments.length; i<n; ++i ) {\n\t\t\t\targ = arguments[i];\n\t\t\t\tif ( typeof arg === 'object' && typeof JSON !== 'undefined' ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\targ = JSON.stringify(arg);\n\t\t\t\t\t}\n\t\t\t\t\tcatch ( Exception ) {\n\t\t\t\t\t\t// Recursive Object\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmessage += \"\\n\"+arg+\"\\n\";\n\t\t\t}\n\n\t\t\t// Textarea\n\t\t\tif ( textarea ) {\n\t\t\t\ttextarea.value += message+\"\\n-----\\n\";\n\t\t\t\ttextarea.scrollTop = textarea.scrollHeight - textarea.clientHeight;\n\t\t\t}\n\t\t\t// No Textarea, No Console\n\t\t\telse if ( !consoleExists ) {\n\t\t\t\talert(message);\n\t\t\t}\n\n\t\t\t// Return true\n\t\t\treturn true;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Emulated Status\n\n\t\t/**\n\t\t * History.getInternetExplorerMajorVersion()\n\t\t * Get's the major version of Internet Explorer\n\t\t * @return {integer}\n\t\t * @license Public Domain\n\t\t * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t\t * @author James Padolsey <https://gist.github.com/527683>\n\t\t */\n\t\tHistory.getInternetExplorerMajorVersion = function(){\n\t\t\tvar result = History.getInternetExplorerMajorVersion.cached =\n\t\t\t\t\t(typeof History.getInternetExplorerMajorVersion.cached !== 'undefined')\n\t\t\t\t?\tHistory.getInternetExplorerMajorVersion.cached\n\t\t\t\t:\t(function(){\n\t\t\t\t\t\tvar v = 3,\n\t\t\t\t\t\t\t\tdiv = document.createElement('div'),\n\t\t\t\t\t\t\t\tall = div.getElementsByTagName('i');\n\t\t\t\t\t\twhile ( (div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->') && all[0] ) {}\n\t\t\t\t\t\treturn (v > 4) ? v : false;\n\t\t\t\t\t})()\n\t\t\t\t;\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.isInternetExplorer()\n\t\t * Are we using Internet Explorer?\n\t\t * @return {boolean}\n\t\t * @license Public Domain\n\t\t * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t\t */\n\t\tHistory.isInternetExplorer = function(){\n\t\t\tvar result =\n\t\t\t\tHistory.isInternetExplorer.cached =\n\t\t\t\t(typeof History.isInternetExplorer.cached !== 'undefined')\n\t\t\t\t\t?\tHistory.isInternetExplorer.cached\n\t\t\t\t\t:\tBoolean(History.getInternetExplorerMajorVersion())\n\t\t\t\t;\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.emulated\n\t\t * Which features require emulating?\n\t\t */\n\n\t\tif (History.options.html4Mode) {\n\t\t\tconsole.log(1)\n\t\t\tHistory.emulated = {\n\t\t\t\tpushState : true,\n\t\t\t\thashChange: true\n\t\t\t};\n\t\t}\n\n\t\telse {\n\t\t\tHistory.emulated = {\n\t\t\t\tpushState: /trident\\/7.0/i.test(navigator.userAgent),\n\t\t\t\thashChange: History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * History.enabled\n\t\t * Is History enabled?\n\t\t */\n\t\tHistory.enabled = !History.emulated.pushState;\n\n\t\t/**\n\t\t * History.bugs\n\t\t * Which bugs are present\n\t\t */\n\t\tHistory.bugs = {\n\t\t\t/**\n\t\t\t * Safari 5 and Safari iOS 4 fail to return to the correct state once a hash is replaced by a `replaceState` call\n\t\t\t * https://bugs.webkit.org/show_bug.cgi?id=56249\n\t\t\t */\n\t\t\tsetHash: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\n\t\t\t/**\n\t\t\t * Safari 5 and Safari iOS 4 sometimes fail to apply the state change under busy conditions\n\t\t\t * https://bugs.webkit.org/show_bug.cgi?id=42940\n\t\t\t */\n\t\t\tsafariPoll: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\n\t\t\t/**\n\t\t\t * MSIE 6 and 7 sometimes do not apply a hash even it was told to (requiring a second call to the apply function)\n\t\t\t */\n\t\t\tieDoubleCheck: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8),\n\n\t\t\t/**\n\t\t\t * MSIE 6 requires the entire hash to be encoded for the hashes to trigger the onHashChange event\n\t\t\t */\n\t\t\thashEscape: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 7)\n\t\t};\n\n\t\t/**\n\t\t * History.isEmptyObject(obj)\n\t\t * Checks to see if the Object is Empty\n\t\t * @param {Object} obj\n\t\t * @return {boolean}\n\t\t */\n\t\tHistory.isEmptyObject = function(obj) {\n\t\t\tfor ( var name in obj ) {\n\t\t\t\tif ( obj.hasOwnProperty(name) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.cloneObject(obj)\n\t\t * Clones a object and eliminate all references to the original contexts\n\t\t * @param {Object} obj\n\t\t * @return {Object}\n\t\t */\n\t\tHistory.cloneObject = function(obj) {\n\t\t\tvar hash,newObj;\n\t\t\tif ( obj ) {\n\t\t\t\thash = JSON.stringify(obj);\n\t\t\t\tnewObj = JSON.parse(hash);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnewObj = {};\n\t\t\t}\n\t\t\treturn newObj;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// URL Helpers\n\n\t\t/**\n\t\t * History.getRootUrl()\n\t\t * Turns \"http://mysite.com/dir/page.html?asd\" into \"http://mysite.com\"\n\t\t * @return {String} rootUrl\n\t\t */\n\t\tHistory.getRootUrl = function(){\n\t\t\t// Create\n\t\t\tvar rootUrl = document.location.protocol+'//'+(document.location.hostname||document.location.host);\n\t\t\tif ( document.location.port||false ) {\n\t\t\t\trootUrl += ':'+document.location.port;\n\t\t\t}\n\t\t\trootUrl += '/';\n\n\t\t\t// Return\n\t\t\treturn rootUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getBaseHref()\n\t\t * Fetches the `href` attribute of the `<base href=\"...\">` element if it exists\n\t\t * @return {String} baseHref\n\t\t */\n\t\tHistory.getBaseHref = function(){\n\t\t\t// Create\n\t\t\tvar\n\t\t\t\tbaseElements = document.getElementsByTagName('base'),\n\t\t\t\tbaseElement = null,\n\t\t\t\tbaseHref = '';\n\n\t\t\t// Test for Base Element\n\t\t\tif ( baseElements.length === 1 ) {\n\t\t\t\t// Prepare for Base Element\n\t\t\t\tbaseElement = baseElements[0];\n\t\t\t\tbaseHref = baseElement.href.replace(/[^\\/]+$/,'');\n\t\t\t}\n\n\t\t\t// Adjust trailing slash\n\t\t\tbaseHref = baseHref.replace(/\\/+$/,'');\n\t\t\tif ( baseHref ) baseHref += '/';\n\n\t\t\t// Return\n\t\t\treturn baseHref;\n\t\t};\n\n\t\t/**\n\t\t * History.getBaseUrl()\n\t\t * Fetches the baseHref or basePageUrl or rootUrl (whichever one exists first)\n\t\t * @return {String} baseUrl\n\t\t */\n\t\tHistory.getBaseUrl = function(){\n\t\t\t// Create\n\t\t\tvar baseUrl = History.getBaseHref()||History.getBasePageUrl()||History.getRootUrl();\n\n\t\t\t// Return\n\t\t\treturn baseUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getPageUrl()\n\t\t * Fetches the URL of the current page\n\t\t * @return {String} pageUrl\n\t\t */\n\t\tHistory.getPageUrl = function(){\n\t\t\t// Fetch\n\t\t\tvar\n\t\t\t\tState = History.getState(false,false),\n\t\t\t\tstateUrl = (State||{}).url||History.getLocationHref(),\n\t\t\t\tpageUrl;\n\n\t\t\t// Create\n\t\t\tpageUrl = stateUrl.replace(/\\/+$/,'').replace(/[^\\/]+$/,function(part,index,string){\n\t\t\t\treturn (/\\./).test(part) ? part : part+'/';\n\t\t\t});\n\n\t\t\t// Return\n\t\t\treturn pageUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getBasePageUrl()\n\t\t * Fetches the Url of the directory of the current page\n\t\t * @return {String} basePageUrl\n\t\t */\n\t\tHistory.getBasePageUrl = function(){\n\t\t\t// Create\n\t\t\tvar basePageUrl = (History.getLocationHref()).replace(/[#\\?].*/,'').replace(/[^\\/]+$/,function(part,index,string){\n\t\t\t\treturn (/[^\\/]$/).test(part) ? '' : part;\n\t\t\t}).replace(/\\/+$/,'')+'/';\n\n\t\t\t// Return\n\t\t\treturn basePageUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getFullUrl(url)\n\t\t * Ensures that we have an absolute URL and not a relative URL\n\t\t * @param {string} url\n\t\t * @param {Boolean} allowBaseHref\n\t\t * @return {string} fullUrl\n\t\t */\n\t\tHistory.getFullUrl = function(url,allowBaseHref){\n\t\t\t// Prepare\n\t\t\tvar fullUrl = url, firstChar = url.substring(0,1);\n\t\t\tallowBaseHref = (typeof allowBaseHref === 'undefined') ? true : allowBaseHref;\n\n\t\t\t// Check\n\t\t\tif ( /[a-z]+\\:\\/\\//.test(url) ) {\n\t\t\t\t// Full URL\n\t\t\t}\n\t\t\telse if ( firstChar === '/' ) {\n\t\t\t\t// Root URL\n\t\t\t\tfullUrl = History.getRootUrl()+url.replace(/^\\/+/,'');\n\t\t\t}\n\t\t\telse if ( firstChar === '#' ) {\n\t\t\t\t// Anchor URL\n\t\t\t\tfullUrl = History.getPageUrl().replace(/#.*/,'')+url;\n\t\t\t}\n\t\t\telse if ( firstChar === '?' ) {\n\t\t\t\t// Query URL\n\t\t\t\tfullUrl = History.getPageUrl().replace(/[\\?#].*/,'')+url;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Relative URL\n\t\t\t\tif ( allowBaseHref ) {\n\t\t\t\t\tfullUrl = History.getBaseUrl()+url.replace(/^(\\.\\/)+/,'');\n\t\t\t\t} else {\n\t\t\t\t\tfullUrl = History.getBasePageUrl()+url.replace(/^(\\.\\/)+/,'');\n\t\t\t\t}\n\t\t\t\t// We have an if condition above as we do not want hashes\n\t\t\t\t// which are relative to the baseHref in our URLs\n\t\t\t\t// as if the baseHref changes, then all our bookmarks\n\t\t\t\t// would now point to different locations\n\t\t\t\t// whereas the basePageUrl will always stay the same\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn fullUrl.replace(/\\#$/,'');\n\t\t};\n\n\t\t/**\n\t\t * History.getShortUrl(url)\n\t\t * Ensures that we have a relative URL and not a absolute URL\n\t\t * @param {string} url\n\t\t * @return {string} url\n\t\t */\n\t\tHistory.getShortUrl = function(url){\n\t\t\t// Prepare\n\t\t\tvar shortUrl = url, baseUrl = History.getBaseUrl(), rootUrl = History.getRootUrl();\n\n\t\t\t// Trim baseUrl\n\t\t\tif ( History.emulated.pushState ) {\n\t\t\t\t// We are in a if statement as when pushState is not emulated\n\t\t\t\t// The actual url these short urls are relative to can change\n\t\t\t\t// So within the same session, we the url may end up somewhere different\n\t\t\t\tshortUrl = shortUrl.replace(baseUrl,'');\n\t\t\t}\n\n\t\t\t// Trim rootUrl\n\t\t\tshortUrl = shortUrl.replace(rootUrl,'/');\n\n\t\t\t// Ensure we can still detect it as a state\n\t\t\tif ( History.isTraditionalAnchor(shortUrl) ) {\n\t\t\t\tshortUrl = './'+shortUrl;\n\t\t\t}\n\n\t\t\t// Clean It\n\t\t\tshortUrl = shortUrl.replace(/^(\\.\\/)+/g,'./').replace(/\\#$/,'');\n\n\t\t\t// Return\n\t\t\treturn shortUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getLocationHref(document)\n\t\t * Returns a normalized version of document.location.href\n\t\t * accounting for browser inconsistencies, etc.\n\t\t *\n\t\t * This URL will be URI-encoded and will include the hash\n\t\t *\n\t\t * @param {object} document\n\t\t * @return {string} url\n\t\t */\n\t\tHistory.getLocationHref = function(doc) {\n\t\t\tdoc = doc || document;\n\n\t\t\t// most of the time, this will be true\n\t\t\tif (doc.URL === doc.location.href)\n\t\t\t\treturn doc.location.href;\n\n\t\t\t// some versions of webkit URI-decode document.location.href\n\t\t\t// but they leave document.URL in an encoded state\n\t\t\tif (doc.location.href === decodeURIComponent(doc.URL))\n\t\t\t\treturn doc.URL;\n\n\t\t\t// FF 3.6 only updates document.URL when a page is reloaded\n\t\t\t// document.location.href is updated correctly\n\t\t\tif (doc.location.hash && decodeURIComponent(doc.location.href.replace(/^[^#]+/, \"\")) === doc.location.hash)\n\t\t\t\treturn doc.location.href;\n\n\t\t\tif (doc.URL.indexOf('#') == -1 && doc.location.href.indexOf('#') != -1)\n\t\t\t\treturn doc.location.href;\n\n\t\t\treturn doc.URL || doc.location.href;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// State Storage\n\n\t\t/**\n\t\t * History.store\n\t\t * The store for all session specific data\n\t\t */\n\t\tHistory.store = {};\n\n\t\t/**\n\t\t * History.idToState\n\t\t * 1-1: State ID to State Object\n\t\t */\n\t\tHistory.idToState = History.idToState||{};\n\n\t\t/**\n\t\t * History.stateToId\n\t\t * 1-1: State String to State ID\n\t\t */\n\t\tHistory.stateToId = History.stateToId||{};\n\n\t\t/**\n\t\t * History.urlToId\n\t\t * 1-1: State URL to State ID\n\t\t */\n\t\tHistory.urlToId = History.urlToId||{};\n\n\t\t/**\n\t\t * History.storedStates\n\t\t * Store the states in an array\n\t\t */\n\t\tHistory.storedStates = History.storedStates||[];\n\n\t\t/**\n\t\t * History.savedStates\n\t\t * Saved the states in an array\n\t\t */\n\t\tHistory.savedStates = History.savedStates||[];\n\n\t\t/**\n\t\t * History.noramlizeStore()\n\t\t * Noramlize the store by adding necessary values\n\t\t */\n\t\tHistory.normalizeStore = function(){\n\t\t\tHistory.store.idToState = History.store.idToState||{};\n\t\t\tHistory.store.urlToId = History.store.urlToId||{};\n\t\t\tHistory.store.stateToId = History.store.stateToId||{};\n\t\t};\n\n\t\t/**\n\t\t * History.getState()\n\t\t * Get an object containing the data, title and url of the current state\n\t\t * @param {Boolean} friendly\n\t\t * @param {Boolean} create\n\t\t * @return {Object} State\n\t\t */\n\t\tHistory.getState = function(friendly,create){\n\t\t\t// Prepare\n\t\t\tif ( typeof friendly === 'undefined' ) { friendly = true; }\n\t\t\tif ( typeof create === 'undefined' ) { create = true; }\n\n\t\t\t// Fetch\n\t\t\tvar State = History.getLastSavedState();\n\n\t\t\t// Create\n\t\t\tif ( !State && create ) {\n\t\t\t\tState = History.createStateObject();\n\t\t\t}\n\n\t\t\t// Adjust\n\t\t\tif ( friendly ) {\n\t\t\t\tState = History.cloneObject(State);\n\t\t\t\tState.url = State.cleanUrl||State.url;\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getIdByState(State)\n\t\t * Gets a ID for a State\n\t\t * @param {State} newState\n\t\t * @return {String} id\n\t\t */\n\t\tHistory.getIdByState = function(newState){\n\n\t\t\t// Fetch ID\n\t\t\tvar id = History.extractId(newState.url),\n\t\t\t\tstr;\n\n\t\t\tif ( !id ) {\n\t\t\t\t// Find ID via State String\n\t\t\t\tstr = History.getStateString(newState);\n\t\t\t\tif ( typeof History.stateToId[str] !== 'undefined' ) {\n\t\t\t\t\tid = History.stateToId[str];\n\t\t\t\t}\n\t\t\t\telse if ( typeof History.store.stateToId[str] !== 'undefined' ) {\n\t\t\t\t\tid = History.store.stateToId[str];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Generate a new ID\n\t\t\t\t\twhile ( true ) {\n\t\t\t\t\t\tid = (new Date()).getTime() + String(Math.random()).replace(/\\D/g,'');\n\t\t\t\t\t\tif ( typeof History.idToState[id] === 'undefined' && typeof History.store.idToState[id] === 'undefined' ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Apply the new State to the ID\n\t\t\t\t\tHistory.stateToId[str] = id;\n\t\t\t\t\tHistory.idToState[id] = newState;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Return ID\n\t\t\treturn id;\n\t\t};\n\n\t\t/**\n\t\t * History.normalizeState(State)\n\t\t * Expands a State Object\n\t\t * @param {object} State\n\t\t * @return {object}\n\t\t */\n\t\tHistory.normalizeState = function(oldState){\n\t\t\t// Variables\n\t\t\tvar newState, dataNotEmpty;\n\n\t\t\t// Prepare\n\t\t\tif ( !oldState || (typeof oldState !== 'object') ) {\n\t\t\t\toldState = {};\n\t\t\t}\n\n\t\t\t// Check\n\t\t\tif ( typeof oldState.normalized !== 'undefined' ) {\n\t\t\t\treturn oldState;\n\t\t\t}\n\n\t\t\t// Adjust\n\t\t\tif ( !oldState.data || (typeof oldState.data !== 'object') ) {\n\t\t\t\toldState.data = {};\n\t\t\t}\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Create\n\t\t\tnewState = {};\n\t\t\tnewState.normalized = true;\n\t\t\tnewState.title = oldState.title||'';\n\t\t\tnewState.url = History.getFullUrl(oldState.url?oldState.url:(History.getLocationHref()));\n\t\t\tnewState.hash = History.getShortUrl(newState.url);\n\t\t\tnewState.data = History.cloneObject(oldState.data);\n\n\t\t\t// Fetch ID\n\t\t\tnewState.id = History.getIdByState(newState);\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Clean the URL\n\t\t\tnewState.cleanUrl = newState.url.replace(/\\??\\&_suid.*/,'');\n\t\t\tnewState.url = newState.cleanUrl;\n\n\t\t\t// Check to see if we have more than just a url\n\t\t\tdataNotEmpty = !History.isEmptyObject(newState.data);\n\n\t\t\t// Apply\n\t\t\tif ( (newState.title || dataNotEmpty) && History.options.disableSuid !== true ) {\n\t\t\t\t// Add ID to Hash\n\t\t\t\tnewState.hash = History.getShortUrl(newState.url).replace(/\\??\\&_suid.*/,'');\n\t\t\t\tif ( !/\\?/.test(newState.hash) ) {\n\t\t\t\t\tnewState.hash += '?';\n\t\t\t\t}\n\t\t\t\tnewState.hash += '&_suid='+newState.id;\n\t\t\t}\n\n\t\t\t// Create the Hashed URL\n\t\t\tnewState.hashedUrl = History.getFullUrl(newState.hash);\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Update the URL if we have a duplicate\n\t\t\tif ( (History.emulated.pushState || History.bugs.safariPoll) && History.hasUrlDuplicate(newState) ) {\n\t\t\t\tnewState.url = newState.hashedUrl;\n\t\t\t}\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Return\n\t\t\treturn newState;\n\t\t};\n\n\t\t/**\n\t\t * History.createStateObject(data,title,url)\n\t\t * Creates a object based on the data, title and url state params\n\t\t * @param {object} data\n\t\t * @param {string} title\n\t\t * @param {string} url\n\t\t * @return {object}\n\t\t */\n\t\tHistory.createStateObject = function(data,title,url){\n\t\t\t// Hashify\n\t\t\tvar State = {\n\t\t\t\t'data': data,\n\t\t\t\t'title': title,\n\t\t\t\t'url': url\n\t\t\t};\n\n\t\t\t// Expand the State\n\t\t\tState = History.normalizeState(State);\n\n\t\t\t// Return object\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getStateById(id)\n\t\t * Get a state by it's UID\n\t\t * @param {String} id\n\t\t */\n\t\tHistory.getStateById = function(id){\n\t\t\t// Prepare\n\t\t\tid = String(id);\n\n\t\t\t// Retrieve\n\t\t\tvar State = History.idToState[id] || History.store.idToState[id] || undefined;\n\n\t\t\t// Return State\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * Get a State's String\n\t\t * @param {State} passedState\n\t\t */\n\t\tHistory.getStateString = function(passedState){\n\t\t\t// Prepare\n\t\t\tvar State, cleanedState, str;\n\n\t\t\t// Fetch\n\t\t\tState = History.normalizeState(passedState);\n\n\t\t\t// Clean\n\t\t\tcleanedState = {\n\t\t\t\tdata: State.data,\n\t\t\t\ttitle: passedState.title,\n\t\t\t\turl: passedState.url\n\t\t\t};\n\n\t\t\t// Fetch\n\t\t\tstr = JSON.stringify(cleanedState);\n\n\t\t\t// Return\n\t\t\treturn str;\n\t\t};\n\n\t\t/**\n\t\t * Get a State's ID\n\t\t * @param {State} passedState\n\t\t * @return {String} id\n\t\t */\n\t\tHistory.getStateId = function(passedState){\n\t\t\t// Prepare\n\t\t\tvar State, id;\n\n\t\t\t// Fetch\n\t\t\tState = History.normalizeState(passedState);\n\n\t\t\t// Fetch\n\t\t\tid = State.id;\n\n\t\t\t// Return\n\t\t\treturn id;\n\t\t};\n\n\t\t/**\n\t\t * History.getHashByState(State)\n\t\t * Creates a Hash for the State Object\n\t\t * @param {State} passedState\n\t\t * @return {String} hash\n\t\t */\n\t\tHistory.getHashByState = function(passedState){\n\t\t\t// Prepare\n\t\t\tvar State, hash;\n\n\t\t\t// Fetch\n\t\t\tState = History.normalizeState(passedState);\n\n\t\t\t// Hash\n\t\t\thash = State.hash;\n\n\t\t\t// Return\n\t\t\treturn hash;\n\t\t};\n\n\t\t/**\n\t\t * History.extractId(url_or_hash)\n\t\t * Get a State ID by it's URL or Hash\n\t\t * @param {string} url_or_hash\n\t\t * @return {string} id\n\t\t */\n\t\tHistory.extractId = function ( url_or_hash ) {\n\t\t\t// Prepare\n\t\t\tvar id,parts,url, tmp;\n\n\t\t\t// Extract\n\n\t\t\t// If the URL has a #, use the id from before the #\n\t\t\tif (url_or_hash.indexOf('#') != -1)\n\t\t\t{\n\t\t\t\ttmp = url_or_hash.split(\"#\")[0];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp = url_or_hash;\n\t\t\t}\n\n\t\t\tparts = /(.*)\\&_suid=([0-9]+)$/.exec(tmp);\n\t\t\turl = parts ? (parts[1]||url_or_hash) : url_or_hash;\n\t\t\tid = parts ? String(parts[2]||'') : '';\n\n\t\t\t// Return\n\t\t\treturn id||false;\n\t\t};\n\n\t\t/**\n\t\t * History.isTraditionalAnchor\n\t\t * Checks to see if the url is a traditional anchor or not\n\t\t * @param {String} url_or_hash\n\t\t * @return {Boolean}\n\t\t */\n\t\tHistory.isTraditionalAnchor = function(url_or_hash){\n\t\t\t// Check\n\t\t\tvar isTraditional = !(/[\\/\\?\\.]/.test(url_or_hash));\n\n\t\t\t// Return\n\t\t\treturn isTraditional;\n\t\t};\n\n\t\t/**\n\t\t * History.extractState\n\t\t * Get a State by it's URL or Hash\n\t\t * @param {String} url_or_hash\n\t\t * @return {State|null}\n\t\t */\n\t\tHistory.extractState = function(url_or_hash,create){\n\t\t\t// Prepare\n\t\t\tvar State = null, id, url;\n\t\t\tcreate = create||false;\n\n\t\t\t// Fetch SUID\n\t\t\tid = History.extractId(url_or_hash);\n\t\t\tif ( id ) {\n\t\t\t\tState = History.getStateById(id);\n\t\t\t}\n\n\t\t\t// Fetch SUID returned no State\n\t\t\tif ( !State ) {\n\t\t\t\t// Fetch URL\n\t\t\t\turl = History.getFullUrl(url_or_hash);\n\n\t\t\t\t// Check URL\n\t\t\t\tid = History.getIdByUrl(url)||false;\n\t\t\t\tif ( id ) {\n\t\t\t\t\tState = History.getStateById(id);\n\t\t\t\t}\n\n\t\t\t\t// Create State\n\t\t\t\tif ( !State && create && !History.isTraditionalAnchor(url_or_hash) ) {\n\t\t\t\t\tState = History.createStateObject(null,null,url);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getIdByUrl()\n\t\t * Get a State ID by a State URL\n\t\t */\n\t\tHistory.getIdByUrl = function(url){\n\t\t\t// Fetch\n\t\t\tvar id = History.urlToId[url] || History.store.urlToId[url] || undefined;\n\n\t\t\t// Return\n\t\t\treturn id;\n\t\t};\n\n\t\t/**\n\t\t * History.getLastSavedState()\n\t\t * Get an object containing the data, title and url of the current state\n\t\t * @return {Object} State\n\t\t */\n\t\tHistory.getLastSavedState = function(){\n\t\t\treturn History.savedStates[History.savedStates.length-1]||undefined;\n\t\t};\n\n\t\t/**\n\t\t * History.getLastStoredState()\n\t\t * Get an object containing the data, title and url of the current state\n\t\t * @return {Object} State\n\t\t */\n\t\tHistory.getLastStoredState = function(){\n\t\t\treturn History.storedStates[History.storedStates.length-1]||undefined;\n\t\t};\n\n\t\t/**\n\t\t * History.hasUrlDuplicate\n\t\t * Checks if a Url will have a url conflict\n\t\t * @param {Object} newState\n\t\t * @return {Boolean} hasDuplicate\n\t\t */\n\t\tHistory.hasUrlDuplicate = function(newState) {\n\t\t\t// Prepare\n\t\t\tvar hasDuplicate = false,\n\t\t\t\toldState;\n\n\t\t\t// Fetch\n\t\t\toldState = History.extractState(newState.url);\n\n\t\t\t// Check\n\t\t\thasDuplicate = oldState && oldState.id !== newState.id;\n\n\t\t\t// Return\n\t\t\treturn hasDuplicate;\n\t\t};\n\n\t\t/**\n\t\t * History.storeState\n\t\t * Store a State\n\t\t * @param {Object} newState\n\t\t * @return {Object} newState\n\t\t */\n\t\tHistory.storeState = function(newState){\n\t\t\t// Store the State\n\t\t\tHistory.urlToId[newState.url] = newState.id;\n\n\t\t\t// Push the State\n\t\t\tHistory.storedStates.push(History.cloneObject(newState));\n\n\t\t\t// Return newState\n\t\t\treturn newState;\n\t\t};\n\n\t\t/**\n\t\t * History.isLastSavedState(newState)\n\t\t * Tests to see if the state is the last state\n\t\t * @param {Object} newState\n\t\t * @return {boolean} isLast\n\t\t */\n\t\tHistory.isLastSavedState = function(newState){\n\t\t\t// Prepare\n\t\t\tvar isLast = false,\n\t\t\t\tnewId, oldState, oldId;\n\n\t\t\t// Check\n\t\t\tif ( History.savedStates.length ) {\n\t\t\t\tnewId = newState.id;\n\t\t\t\toldState = History.getLastSavedState();\n\t\t\t\toldId = oldState.id;\n\n\t\t\t\t// Check\n\t\t\t\tisLast = (newId === oldId);\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn isLast;\n\t\t};\n\n\t\t/**\n\t\t * History.saveState\n\t\t * Push a State\n\t\t * @param {Object} newState\n\t\t * @return {boolean} changed\n\t\t */\n\t\tHistory.saveState = function(newState){\n\t\t\t// Check Hash\n\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Push the State\n\t\t\tHistory.savedStates.push(History.cloneObject(newState));\n\n\t\t\t// Return true\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.getStateByIndex()\n\t\t * Gets a state by the index\n\t\t * @param {integer} index\n\t\t * @return {Object}\n\t\t */\n\t\tHistory.getStateByIndex = function(index){\n\t\t\t// Prepare\n\t\t\tvar State = null;\n\n\t\t\t// Handle\n\t\t\tif ( typeof index === 'undefined' ) {\n\t\t\t\t// Get the last inserted\n\t\t\t\tState = History.savedStates[History.savedStates.length-1];\n\t\t\t}\n\t\t\telse if ( index < 0 ) {\n\t\t\t\t// Get from the end\n\t\t\t\tState = History.savedStates[History.savedStates.length+index];\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Get from the beginning\n\t\t\t\tState = History.savedStates[index];\n\t\t\t}\n\n\t\t\t// Return State\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getCurrentIndex()\n\t\t * Gets the current index\n\t\t * @return (integer)\n\t\t*/\n\t\tHistory.getCurrentIndex = function(){\n\t\t\t// Prepare\n\t\t\tvar index = null;\n\n\t\t\t// No states saved\n\t\t\tif(History.savedStates.length < 1) {\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tindex = History.savedStates.length-1;\n\t\t\t}\n\t\t\treturn index;\n\t\t};\n\n\t\t// ====================================================================\n\t\t// Hash Helpers\n\n\t\t/**\n\t\t * History.getHash()\n\t\t * @param {Location=} location\n\t\t * Gets the current document hash\n\t\t * Note: unlike location.hash, this is guaranteed to return the escaped hash in all browsers\n\t\t * @return {string}\n\t\t */\n\t\tHistory.getHash = function(doc){\n\t\t\tvar url = History.getLocationHref(doc),\n\t\t\t\thash;\n\t\t\thash = History.getHashByUrl(url);\n\t\t\treturn hash;\n\t\t};\n\n\t\t/**\n\t\t * History.unescapeHash()\n\t\t * normalize and Unescape a Hash\n\t\t * @param {String} hash\n\t\t * @return {string}\n\t\t */\n\t\tHistory.unescapeHash = function(hash){\n\t\t\t// Prepare\n\t\t\tvar result = History.normalizeHash(hash);\n\n\t\t\t// Unescape hash\n\t\t\tresult = decodeURIComponent(result);\n\n\t\t\t// Return result\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.normalizeHash()\n\t\t * normalize a hash across browsers\n\t\t * @return {string}\n\t\t */\n\t\tHistory.normalizeHash = function(hash){\n\t\t\t// Prepare\n\t\t\tvar result = hash.replace(/[^#]*#/,'').replace(/#.*/, '');\n\n\t\t\t// Return result\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.setHash(hash)\n\t\t * Sets the document hash\n\t\t * @param {string} hash\n\t\t * @return {History}\n\t\t */\n\t\tHistory.setHash = function(hash,queue){\n\t\t\t// Prepare\n\t\t\tvar State, pageUrl;\n\n\t\t\t// Handle Queueing\n\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t// Wait + Push to Queue\n\t\t\t\t//History.debug('History.setHash: we must wait', arguments);\n\t\t\t\tHistory.pushQueue({\n\t\t\t\t\tscope: History,\n\t\t\t\t\tcallback: History.setHash,\n\t\t\t\t\targs: arguments,\n\t\t\t\t\tqueue: queue\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Log\n\t\t\t//History.debug('History.setHash: called',hash);\n\n\t\t\t// Make Busy + Continue\n\t\t\tHistory.busy(true);\n\n\t\t\t// Check if hash is a state\n\t\t\tState = History.extractState(hash,true);\n\t\t\tif ( State && !History.emulated.pushState ) {\n\t\t\t\t// Hash is a state so skip the setHash\n\t\t\t\t//History.debug('History.setHash: Hash is a state so skipping the hash set with a direct pushState call',arguments);\n\n\t\t\t\t// PushState\n\t\t\t\tHistory.pushState(State.data,State.title,State.url,false);\n\t\t\t}\n\t\t\telse if ( History.getHash() !== hash ) {\n\t\t\t\t// Hash is a proper hash, so apply it\n\n\t\t\t\t// Handle browser bugs\n\t\t\t\tif ( History.bugs.setHash ) {\n\t\t\t\t\t// Fix Safari Bug https://bugs.webkit.org/show_bug.cgi?id=56249\n\n\t\t\t\t\t// Fetch the base page\n\t\t\t\t\tpageUrl = History.getPageUrl();\n\n\t\t\t\t\t// Safari hash apply\n\t\t\t\t\tHistory.pushState(null,null,pageUrl+'#'+hash,false);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Normal hash apply\n\t\t\t\t\tdocument.location.hash = hash;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.escape()\n\t\t * normalize and Escape a Hash\n\t\t * @return {string}\n\t\t */\n\t\tHistory.escapeHash = function(hash){\n\t\t\t// Prepare\n\t\t\tvar result = History.normalizeHash(hash);\n\n\t\t\t// Escape hash\n\t\t\tresult = window.encodeURIComponent(result);\n\n\t\t\t// IE6 Escape Bug\n\t\t\tif ( !History.bugs.hashEscape ) {\n\t\t\t\t// Restore common parts\n\t\t\t\tresult = result\n\t\t\t\t\t.replace(/\\%21/g,'!')\n\t\t\t\t\t.replace(/\\%26/g,'&')\n\t\t\t\t\t.replace(/\\%3D/g,'=')\n\t\t\t\t\t.replace(/\\%3F/g,'?');\n\t\t\t}\n\n\t\t\t// Return result\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.getHashByUrl(url)\n\t\t * Extracts the Hash from a URL\n\t\t * @param {string} url\n\t\t * @return {string} url\n\t\t */\n\t\tHistory.getHashByUrl = function(url){\n\t\t\t// Extract the hash\n\t\t\tvar hash = String(url)\n\t\t\t\t.replace(/([^#]*)#?([^#]*)#?(.*)/, '$2')\n\t\t\t\t;\n\n\t\t\t// Unescape hash\n\t\t\thash = History.unescapeHash(hash);\n\n\t\t\t// Return hash\n\t\t\treturn hash;\n\t\t};\n\n\t\t/**\n\t\t * History.setTitle(title)\n\t\t * Applies the title to the document\n\t\t * @param {State} newState\n\t\t * @return {Boolean}\n\t\t */\n\t\tHistory.setTitle = function(newState){\n\t\t\t// Prepare\n\t\t\tvar title = newState.title,\n\t\t\t\tfirstState;\n\n\t\t\t// Initial\n\t\t\tif ( !title ) {\n\t\t\t\tfirstState = History.getStateByIndex(0);\n\t\t\t\tif ( firstState && firstState.url === newState.url ) {\n\t\t\t\t\ttitle = firstState.title||History.options.initialTitle;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply\n\t\t\ttry {\n\t\t\t\tdocument.getElementsByTagName('title')[0].innerHTML = title.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ');\n\t\t\t}\n\t\t\tcatch ( Exception ) { }\n\t\t\tdocument.title = title;\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Queueing\n\n\t\t/**\n\t\t * History.queues\n\t\t * The list of queues to use\n\t\t * First In, First Out\n\t\t */\n\t\tHistory.queues = [];\n\n\t\t/**\n\t\t * History.busy(value)\n\t\t * @param {boolean} value [optional]\n\t\t * @return {boolean} busy\n\t\t */\n\t\tHistory.busy = function(value){\n\t\t\t// Apply\n\t\t\tif ( typeof value !== 'undefined' ) {\n\t\t\t\t//History.debug('History.busy: changing ['+(History.busy.flag||false)+'] to ['+(value||false)+']', History.queues.length);\n\t\t\t\tHistory.busy.flag = value;\n\t\t\t}\n\t\t\t// Default\n\t\t\telse if ( typeof History.busy.flag === 'undefined' ) {\n\t\t\t\tHistory.busy.flag = false;\n\t\t\t}\n\n\t\t\t// Queue\n\t\t\tif ( !History.busy.flag ) {\n\t\t\t\t// Execute the next item in the queue\n\t\t\t\tclearTimeout(History.busy.timeout);\n\t\t\t\tvar fireNext = function(){\n\t\t\t\t\tvar i, queue, item;\n\t\t\t\t\tif ( History.busy.flag ) return;\n\t\t\t\t\tfor ( i=History.queues.length-1; i >= 0; --i ) {\n\t\t\t\t\t\tqueue = History.queues[i];\n\t\t\t\t\t\tif ( queue.length === 0 ) continue;\n\t\t\t\t\t\titem = queue.shift();\n\t\t\t\t\t\tHistory.fireQueueItem(item);\n\t\t\t\t\t\tHistory.busy.timeout = setTimeout(fireNext,History.options.busyDelay);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tHistory.busy.timeout = setTimeout(fireNext,History.options.busyDelay);\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn History.busy.flag;\n\t\t};\n\n\t\t/**\n\t\t * History.busy.flag\n\t\t */\n\t\tHistory.busy.flag = false;\n\n\t\t/**\n\t\t * History.fireQueueItem(item)\n\t\t * Fire a Queue Item\n\t\t * @param {Object} item\n\t\t * @return {Mixed} result\n\t\t */\n\t\tHistory.fireQueueItem = function(item){\n\t\t\treturn item.callback.apply(item.scope||History,item.args||[]);\n\t\t};\n\n\t\t/**\n\t\t * History.pushQueue(callback,args)\n\t\t * Add an item to the queue\n\t\t * @param {Object} item [scope,callback,args,queue]\n\t\t */\n\t\tHistory.pushQueue = function(item){\n\t\t\t// Prepare the queue\n\t\t\tHistory.queues[item.queue||0] = History.queues[item.queue||0]||[];\n\n\t\t\t// Add to the queue\n\t\t\tHistory.queues[item.queue||0].push(item);\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.queue (item,queue), (func,queue), (func), (item)\n\t\t * Either firs the item now if not busy, or adds it to the queue\n\t\t */\n\t\tHistory.queue = function(item,queue){\n\t\t\t// Prepare\n\t\t\tif ( typeof item === 'function' ) {\n\t\t\t\titem = {\n\t\t\t\t\tcallback: item\n\t\t\t\t};\n\t\t\t}\n\t\t\tif ( typeof queue !== 'undefined' ) {\n\t\t\t\titem.queue = queue;\n\t\t\t}\n\n\t\t\t// Handle\n\t\t\tif ( History.busy() ) {\n\t\t\t\tHistory.pushQueue(item);\n\t\t\t} else {\n\t\t\t\tHistory.fireQueueItem(item);\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.clearQueue()\n\t\t * Clears the Queue\n\t\t */\n\t\tHistory.clearQueue = function(){\n\t\t\tHistory.busy.flag = false;\n\t\t\tHistory.queues = [];\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// IE Bug Fix\n\n\t\t/**\n\t\t * History.stateChanged\n\t\t * States whether or not the state has changed since the last double check was initialised\n\t\t */\n\t\tHistory.stateChanged = false;\n\n\t\t/**\n\t\t * History.doubleChecker\n\t\t * Contains the timeout used for the double checks\n\t\t */\n\t\tHistory.doubleChecker = false;\n\n\t\t/**\n\t\t * History.doubleCheckComplete()\n\t\t * Complete a double check\n\t\t * @return {History}\n\t\t */\n\t\tHistory.doubleCheckComplete = function(){\n\t\t\t// Update\n\t\t\tHistory.stateChanged = true;\n\n\t\t\t// Clear\n\t\t\tHistory.doubleCheckClear();\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.doubleCheckClear()\n\t\t * Clear a double check\n\t\t * @return {History}\n\t\t */\n\t\tHistory.doubleCheckClear = function(){\n\t\t\t// Clear\n\t\t\tif ( History.doubleChecker ) {\n\t\t\t\tclearTimeout(History.doubleChecker);\n\t\t\t\tHistory.doubleChecker = false;\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.doubleCheck()\n\t\t * Create a double check\n\t\t * @return {History}\n\t\t */\n\t\tHistory.doubleCheck = function(tryAgain){\n\t\t\t// Reset\n\t\t\tHistory.stateChanged = false;\n\t\t\tHistory.doubleCheckClear();\n\n\t\t\t// Fix IE6,IE7 bug where calling history.back or history.forward does not actually change the hash (whereas doing it manually does)\n\t\t\t// Fix Safari 5 bug where sometimes the state does not change: https://bugs.webkit.org/show_bug.cgi?id=42940\n\t\t\tif ( History.bugs.ieDoubleCheck ) {\n\t\t\t\t// Apply Check\n\t\t\t\tHistory.doubleChecker = setTimeout(\n\t\t\t\t\tfunction(){\n\t\t\t\t\t\tHistory.doubleCheckClear();\n\t\t\t\t\t\tif ( !History.stateChanged ) {\n\t\t\t\t\t\t\t//History.debug('History.doubleCheck: State has not yet changed, trying again', arguments);\n\t\t\t\t\t\t\t// Re-Attempt\n\t\t\t\t\t\t\ttryAgain();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tHistory.options.doubleCheckInterval\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Safari Bug Fix\n\n\t\t/**\n\t\t * History.safariStatePoll()\n\t\t * Poll the current state\n\t\t * @return {History}\n\t\t */\n\t\tHistory.safariStatePoll = function(){\n\t\t\t// Poll the URL\n\n\t\t\t// Get the Last State which has the new URL\n\t\t\tvar\n\t\t\t\turlState = History.extractState(History.getLocationHref()),\n\t\t\t\tnewState;\n\n\t\t\t// Check for a difference\n\t\t\tif ( !History.isLastSavedState(urlState) ) {\n\t\t\t\tnewState = urlState;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check if we have a state with that url\n\t\t\t// If not create it\n\t\t\tif ( !newState ) {\n\t\t\t\t//History.debug('History.safariStatePoll: new');\n\t\t\t\tnewState = History.createStateObject();\n\t\t\t}\n\n\t\t\t// Apply the New State\n\t\t\t//History.debug('History.safariStatePoll: trigger');\n\t\t\tHistory.Adapter.trigger(window,'popstate');\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// State Aliases\n\n\t\t/**\n\t\t * History.back(queue)\n\t\t * Send the browser history back one item\n\t\t * @param {Integer} queue [optional]\n\t\t */\n\t\tHistory.back = function(queue){\n\t\t\t//History.debug('History.back: called', arguments);\n\n\t\t\t// Handle Queueing\n\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t// Wait + Push to Queue\n\t\t\t\t//History.debug('History.back: we must wait', arguments);\n\t\t\t\tHistory.pushQueue({\n\t\t\t\t\tscope: History,\n\t\t\t\t\tcallback: History.back,\n\t\t\t\t\targs: arguments,\n\t\t\t\t\tqueue: queue\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Make Busy + Continue\n\t\t\tHistory.busy(true);\n\n\t\t\t// Fix certain browser bugs that prevent the state from changing\n\t\t\tHistory.doubleCheck(function(){\n\t\t\t\tHistory.back(false);\n\t\t\t});\n\n\t\t\t// Go back\n\t\t\thistory.go(-1);\n\n\t\t\t// End back closure\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.forward(queue)\n\t\t * Send the browser history forward one item\n\t\t * @param {Integer} queue [optional]\n\t\t */\n\t\tHistory.forward = function(queue){\n\t\t\t//History.debug('History.forward: called', arguments);\n\n\t\t\t// Handle Queueing\n\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t// Wait + Push to Queue\n\t\t\t\t//History.debug('History.forward: we must wait', arguments);\n\t\t\t\tHistory.pushQueue({\n\t\t\t\t\tscope: History,\n\t\t\t\t\tcallback: History.forward,\n\t\t\t\t\targs: arguments,\n\t\t\t\t\tqueue: queue\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Make Busy + Continue\n\t\t\tHistory.busy(true);\n\n\t\t\t// Fix certain browser bugs that prevent the state from changing\n\t\t\tHistory.doubleCheck(function(){\n\t\t\t\tHistory.forward(false);\n\t\t\t});\n\n\t\t\t// Go forward\n\t\t\thistory.go(1);\n\n\t\t\t// End forward closure\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.go(index,queue)\n\t\t * Send the browser history back or forward index times\n\t\t * @param {Integer} queue [optional]\n\t\t */\n\t\tHistory.go = function(index,queue){\n\t\t\t//History.debug('History.go: called', arguments);\n\n\t\t\t// Prepare\n\t\t\tvar i;\n\n\t\t\t// Handle\n\t\t\tif ( index > 0 ) {\n\t\t\t\t// Forward\n\t\t\t\tfor ( i=1; i<=index; ++i ) {\n\t\t\t\t\tHistory.forward(queue);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( index < 0 ) {\n\t\t\t\t// Backward\n\t\t\t\tfor ( i=-1; i>=index; --i ) {\n\t\t\t\t\tHistory.back(queue);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error('History.go: History.go requires a positive or negative integer passed.');\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// HTML5 State Support\n\n\t\t// Non-Native pushState Implementation\n\t\tif ( History.emulated.pushState ) {\n\t\t\t/*\n\t\t\t * Provide Skeleton for HTML4 Browsers\n\t\t\t */\n\n\t\t\t// Prepare\n\t\t\tvar emptyFunction = function(){};\n\t\t\tHistory.pushState = History.pushState||emptyFunction;\n\t\t\tHistory.replaceState = History.replaceState||emptyFunction;\n\t\t} // History.emulated.pushState\n\n\t\t// Native pushState Implementation\n\t\telse {\n\t\t\t/*\n\t\t\t * Use native HTML5 History API Implementation\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * History.onPopState(event,extra)\n\t\t\t * Refresh the Current State\n\t\t\t */\n\t\t\tHistory.onPopState = function(event,extra){\n\t\t\t\t// Prepare\n\t\t\t\tvar stateId = false, newState = false, currentHash, currentState;\n\n\t\t\t\t// Reset the double check\n\t\t\t\tHistory.doubleCheckComplete();\n\n\t\t\t\t// Check for a Hash, and handle apporiatly\n\t\t\t\tcurrentHash = History.getHash();\n\t\t\t\tif ( currentHash ) {\n\t\t\t\t\t// Expand Hash\n\t\t\t\t\tcurrentState = History.extractState(currentHash||History.getLocationHref(),true);\n\t\t\t\t\tif ( currentState ) {\n\t\t\t\t\t\t// We were able to parse it, it must be a State!\n\t\t\t\t\t\t// Let's forward to replaceState\n\t\t\t\t\t\t//History.debug('History.onPopState: state anchor', currentHash, currentState);\n\t\t\t\t\t\tHistory.replaceState(currentState.data, currentState.title, currentState.url, false);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Traditional Anchor\n\t\t\t\t\t\t//History.debug('History.onPopState: traditional anchor', currentHash);\n\t\t\t\t\t\tHistory.Adapter.trigger(window,'anchorchange');\n\t\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\t}\n\n\t\t\t\t\t// We don't care for hashes\n\t\t\t\t\tHistory.expectedStateId = false;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Ensure\n\t\t\t\tstateId = History.Adapter.extractEventData('state',event,extra) || false;\n\n\t\t\t\t// Fetch State\n\t\t\t\tif ( stateId ) {\n\t\t\t\t\t// Vanilla: Back/forward button was used\n\t\t\t\t\tnewState = History.getStateById(stateId);\n\t\t\t\t}\n\t\t\t\telse if ( History.expectedStateId ) {\n\t\t\t\t\t// Vanilla: A new state was pushed, and popstate was called manually\n\t\t\t\t\tnewState = History.getStateById(History.expectedStateId);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Initial State\n\t\t\t\t\tnewState = History.extractState(History.getLocationHref());\n\t\t\t\t}\n\n\t\t\t\t// The State did not exist in our store\n\t\t\t\tif ( !newState ) {\n\t\t\t\t\t// Regenerate the State\n\t\t\t\t\tnewState = History.createStateObject(null,null,History.getLocationHref());\n\t\t\t\t}\n\n\t\t\t\t// Clean\n\t\t\t\tHistory.expectedStateId = false;\n\n\t\t\t\t// Check if we are the same state\n\t\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\t\t// There has been no change (just the page's hash has finally propagated)\n\t\t\t\t\t//History.debug('History.onPopState: no change', newState, History.savedStates);\n\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Store the State\n\t\t\t\tHistory.storeState(newState);\n\t\t\t\tHistory.saveState(newState);\n\n\t\t\t\t// Force update of the title\n\t\t\t\tHistory.setTitle(newState);\n\n\t\t\t\t// Fire Our Event\n\t\t\t\tHistory.Adapter.trigger(window,'statechange');\n\t\t\t\tHistory.busy(false);\n\n\t\t\t\t// Return true\n\t\t\t\treturn true;\n\t\t\t};\n\t\t\tHistory.Adapter.bind(window,'popstate',History.onPopState);\n\n\t\t\t/**\n\t\t\t * History.pushState(data,title,url)\n\t\t\t * Add a new State to the history object, become it, and trigger onpopstate\n\t\t\t * We have to trigger for HTML4 compatibility\n\t\t\t * @param {object} data\n\t\t\t * @param {string} title\n\t\t\t * @param {string} url\n\t\t\t * @return {true}\n\t\t\t */\n\t\t\tHistory.pushState = function(data,title,url,queue){\n\t\t\t\t//History.debug('History.pushState: called', arguments);\n\n\t\t\t\t// Check the State\n\t\t\t\tif ( History.getHashByUrl(url) && History.emulated.pushState ) {\n\t\t\t\t\tthrow new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n\t\t\t\t}\n\n\t\t\t\t// Handle Queueing\n\t\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t//History.debug('History.pushState: we must wait', arguments);\n\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\tcallback: History.pushState,\n\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Make Busy + Continue\n\t\t\t\tHistory.busy(true);\n\n\t\t\t\t// Create the newState\n\t\t\t\tvar newState = History.createStateObject(data,title,url);\n\n\t\t\t\t// Check it\n\t\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\t\t// Won't be a change\n\t\t\t\t\tHistory.busy(false);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Store the newState\n\t\t\t\t\tHistory.storeState(newState);\n\t\t\t\t\tHistory.expectedStateId = newState.id;\n\n\t\t\t\t\t// Push the newState\n\t\t\t\t\thistory.pushState(newState.id,newState.title,newState.url);\n\n\t\t\t\t\t// Fire HTML5 Event\n\t\t\t\t\tHistory.Adapter.trigger(window,'popstate');\n\t\t\t\t}\n\n\t\t\t\t// End pushState closure\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * History.replaceState(data,title,url)\n\t\t\t * Replace the State and trigger onpopstate\n\t\t\t * We have to trigger for HTML4 compatibility\n\t\t\t * @param {object} data\n\t\t\t * @param {string} title\n\t\t\t * @param {string} url\n\t\t\t * @return {true}\n\t\t\t */\n\t\t\tHistory.replaceState = function(data,title,url,queue){\n\t\t\t\t//History.debug('History.replaceState: called', arguments);\n\n\t\t\t\t// Check the State\n\t\t\t\tif ( History.getHashByUrl(url) && History.emulated.pushState ) {\n\t\t\t\t\tthrow new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n\t\t\t\t}\n\n\t\t\t\t// Handle Queueing\n\t\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t//History.debug('History.replaceState: we must wait', arguments);\n\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\tcallback: History.replaceState,\n\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Make Busy + Continue\n\t\t\t\tHistory.busy(true);\n\n\t\t\t\t// Create the newState\n\t\t\t\tvar newState = History.createStateObject(data,title,url);\n\n\t\t\t\t// Check it\n\t\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\t\t// Won't be a change\n\t\t\t\t\tHistory.busy(false);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Store the newState\n\t\t\t\t\tHistory.storeState(newState);\n\t\t\t\t\tHistory.expectedStateId = newState.id;\n\n\t\t\t\t\t// Push the newState\n\t\t\t\t\thistory.replaceState(newState.id,newState.title,newState.url);\n\n\t\t\t\t\t// Fire HTML5 Event\n\t\t\t\t\tHistory.Adapter.trigger(window,'popstate');\n\t\t\t\t}\n\n\t\t\t\t// End replaceState closure\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t} // !History.emulated.pushState\n\n\n\t\t// ====================================================================\n\t\t// Initialise\n\n\t\t/**\n\t\t * Load the Store\n\t\t */\n\t\tif ( sessionStorage ) {\n\t\t\t// Fetch\n\t\t\ttry {\n\t\t\t\tHistory.store = JSON.parse(sessionStorage.getItem('History.store'))||{};\n\t\t\t}\n\t\t\tcatch ( err ) {\n\t\t\t\tHistory.store = {};\n\t\t\t}\n\n\t\t\t// Normalize\n\t\t\tHistory.normalizeStore();\n\t\t}\n\t\telse {\n\t\t\t// Default Load\n\t\t\tHistory.store = {};\n\t\t\tHistory.normalizeStore();\n\t\t}\n\n\t\t/**\n\t\t * Clear Intervals on exit to prevent memory leaks\n\t\t */\n\t\tHistory.Adapter.bind(window,\"unload\",History.clearAllIntervals);\n\n\t\t/**\n\t\t * Create the initial State\n\t\t */\n\t\tHistory.saveState(History.storeState(History.extractState(History.getLocationHref(),true)));\n\n\t\t/**\n\t\t * Bind for Saving Store\n\t\t */\n\t\tif ( sessionStorage ) {\n\t\t\t// When the page is closed\n\t\t\tHistory.onUnload = function(){\n\t\t\t\t// Prepare\n\t\t\t\tvar\tcurrentStore, item, currentStoreString;\n\n\t\t\t\t// Fetch\n\t\t\t\ttry {\n\t\t\t\t\tcurrentStore = JSON.parse(sessionStorage.getItem('History.store'))||{};\n\t\t\t\t}\n\t\t\t\tcatch ( err ) {\n\t\t\t\t\tcurrentStore = {};\n\t\t\t\t}\n\n\t\t\t\t// Ensure\n\t\t\t\tcurrentStore.idToState = currentStore.idToState || {};\n\t\t\t\tcurrentStore.urlToId = currentStore.urlToId || {};\n\t\t\t\tcurrentStore.stateToId = currentStore.stateToId || {};\n\n\t\t\t\t// Sync\n\t\t\t\tfor ( item in History.idToState ) {\n\t\t\t\t\tif ( !History.idToState.hasOwnProperty(item) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentStore.idToState[item] = History.idToState[item];\n\t\t\t\t}\n\t\t\t\tfor ( item in History.urlToId ) {\n\t\t\t\t\tif ( !History.urlToId.hasOwnProperty(item) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentStore.urlToId[item] = History.urlToId[item];\n\t\t\t\t}\n\t\t\t\tfor ( item in History.stateToId ) {\n\t\t\t\t\tif ( !History.stateToId.hasOwnProperty(item) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentStore.stateToId[item] = History.stateToId[item];\n\t\t\t\t}\n\n\t\t\t\t// Update\n\t\t\t\tHistory.store = currentStore;\n\t\t\t\tHistory.normalizeStore();\n\n\t\t\t\t// In Safari, going into Private Browsing mode causes the\n\t\t\t\t// Session Storage object to still exist but if you try and use\n\t\t\t\t// or set any property/function of it it throws the exception\n\t\t\t\t// \"QUOTA_EXCEEDED_ERR: DOM Exception 22: An attempt was made to\n\t\t\t\t// add something to storage that exceeded the quota.\" infinitely\n\t\t\t\t// every second.\n\t\t\t\tcurrentStoreString = JSON.stringify(currentStore);\n\t\t\t\ttry {\n\t\t\t\t\t// Store\n\t\t\t\t\tsessionStorage.setItem('History.store', currentStoreString);\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\tif (e.code === DOMException.QUOTA_EXCEEDED_ERR) {\n\t\t\t\t\t\tif (sessionStorage.length) {\n\t\t\t\t\t\t\t// Workaround for a bug seen on iPads. Sometimes the quota exceeded error comes up and simply\n\t\t\t\t\t\t\t// removing/resetting the storage can work.\n\t\t\t\t\t\t\tsessionStorage.removeItem('History.store');\n\t\t\t\t\t\t\tsessionStorage.setItem('History.store', currentStoreString);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Otherwise, we're probably private browsing in Safari, so we'll ignore the exception.\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// For Internet Explorer\n\t\t\tHistory.intervalList.push(setInterval(History.onUnload,History.options.storeInterval));\n\n\t\t\t// For Other Browsers\n\t\t\tHistory.Adapter.bind(window,'beforeunload',History.onUnload);\n\t\t\tHistory.Adapter.bind(window,'unload',History.onUnload);\n\n\t\t\t// Both are enabled for consistency\n\t\t}\n\n\t\t// Non-Native pushState Implementation\n\t\tif ( !History.emulated.pushState ) {\n\t\t\t// Be aware, the following is only for native pushState implementations\n\t\t\t// If you are wanting to include something for all browsers\n\t\t\t// Then include it above this if block\n\n\t\t\t/**\n\t\t\t * Setup Safari Fix\n\t\t\t */\n\t\t\tif ( History.bugs.safariPoll ) {\n\t\t\t\tHistory.intervalList.push(setInterval(History.safariStatePoll, History.options.safariPollInterval));\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Ensure Cross Browser Compatibility\n\t\t\t */\n\t\t\tif ( navigator.vendor === 'Apple Computer, Inc.' || (navigator.appCodeName||'') === 'Mozilla' ) {\n\t\t\t\t/**\n\t\t\t\t * Fix Safari HashChange Issue\n\t\t\t\t */\n\n\t\t\t\t// Setup Alias\n\t\t\t\tHistory.Adapter.bind(window,'hashchange',function(){\n\t\t\t\t\tHistory.Adapter.trigger(window,'popstate');\n\t\t\t\t});\n\n\t\t\t\t// Initialise Alias\n\t\t\t\tif ( History.getHash() ) {\n\t\t\t\t\tHistory.Adapter.onDomLoad(function(){\n\t\t\t\t\t\tHistory.Adapter.trigger(window,'hashchange');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t} // !History.emulated.pushState\n\n\n\t}; // History.initCore\n\n\t// Try to Initialise History\n\tif (!History.options || !History.options.delayInit) {\n\t\tHistory.init();\n\t}\n\n})(window);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/plugin/jquery.history.js","// 删除自己发布的话题\nvar alert = require('module/popup/alert');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar confirm = require('module/popup/confirm');\n// //提交请求\n//        fetch.post(url.get('commentFirstV2'), {\n//            data: params\n//        }).then(function(data) {\n\nvar init = function() {\n    $(\"body\").on(\"click\", '[data-node=\"userTopic-del\"]', deletTopic);\n\n}\n\nvar deletTopic = function() {\n    var $this = $(this);\n    var id = $($this.parents().eq(2)).attr('data-left');\n    confirm('', {\n        content: \"<p class='del-pop-p' data-node='gettopId' data-topicH=\" + id + \">确定要删除该话题吗？</p>\",\n        title: '提示',\n        okCls: 'two-button two-button-red',\n        cancelCls: 'two-button',\n        ok: sendMsg,\n        btnWrapCls: 'text-center'\n    });\n}\nvar sendMsg = function() {\n    var groupid = $_CONFIG['groupid'];\n    var idd = {\n        id: $(\"[data-node='gettopId']\").attr('data-topicH'),\n        groupId:groupid\n    };\n\n    fetch.post(url.get('topicDel'), {\n        data: idd\n    }).then(function(data) {\n        if (data.success) {\n            location.replace($GLOBAL_CONFIG['group_domain'] + 'circle/' + groupid + '.html');\n        } else {\n            alert(\"删除失败！\");\n        }\n    });\n}\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/deletUserTopic.js","//var alert = require('module/popup/alert');\nvar upload = require('module/popup/upload/uploader');\n//var addBox = $('[data-node=addImgGoods]');\nvar confirm = require('module/popup/confirm');\nvar loginState = require('./../loginState');\nvar rotateImg = require('./rotateImg');\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar addImgTpl = require('./chooseImg.tpl');\nvar topFixed = require('../../topicAddMore/topicAddMore').topFixed; //右侧固定\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\n\n//插入二维码上传\nvar detectQr = require('module/popup/uploadfileQR');\n//存储二维码\nvar codeArr = [];\n\nvar $showBox = $('[data-node=\"picPopBox\"]');\nvar topicId = '';\nvar showImgBox = function() {\n\n    $(\"body\").on(\"click\", '[data-node=\"addImg_btn\"]', btnEvent)\n        .on(\"click\", \"[data-node='addMoreImg']\", addMoreImgFn) //+ tu\n        .on(\"click\", \"[data-node='imgPics']\", imgPicsBig)\n        .on(\"click\", '[data-node=\"imgBigHind\"]', imgBigHindFn)\n        .on(\"click\", '[data-node=\"hideBigPic\"]', hideBigPicFn)\n        .on(\"click\", '[data-node=\"imgBigPN\"]', imgBigPNFn)\n        .on(\"click\", '[data-node=\"deletImg\"]', deletImgFn)\n        .on(\"click\", '[data-node=\"showImg\"]', showImgFn)\n        .on(\"click\", '[data-node=\"roteRo\"]', rotateImg.init)\n        .on(\"click\", '[data-node=\"addImg_btn\"]', picPopBoxEvent)\n        .on(\"click\", '[data-node=\"picPopBox\"]', picPopBoxEvent)\n        .on('click', codeBoxEvent);\n}\n\nvar deletImgFn = function() {\n    var $this = $($(this).parents().eq(2));\n    var imgSrc = $this.children(\"a\").children(\"img\").attr(\"src\");\n    var ul = $this.parent();\n    var $div = ul.parent();\n    var imgLENG = parseInt($div.attr(\"data-imgnum\"));\n    //var arrImg=[];\n    confirm('确认删除该图片？', {\n        title: '提示',\n        okCls: 'two-button two-button-red',\n        cancelCls: 'two-button',\n        btnWrapCls: 'text-center',\n        ok: function() {\n            $this.remove();\n            var arriMG = ul.attr(\"data-imgsrt\");\n            var a = arriMG.split(',');\n            var b = a;\n            b.splice(imgSrc, 1);\n            ul.attr(\"data-imgsrt\", b);\n            $div.attr(\"data-imgnum\", imgLENG + 1);\n            ul.children(\"[data-node='addMoreImg']\").removeClass(\"hide\");\n            $div.parent().find(\"[data-node='addImg_btn']\").removeClass(\"disabled\");\n            if (parseInt(imgLENG + 1) >= 9) {\n                ul.addClass(\"hide\");\n            }\n        }\n    })\n}\nvar addMoreImgFn = function() {\n    var imgNum = $($(this).parents().eq(1)).attr(\"data-imgNum\");\n    topicId = $($(this).parents().eq(2)).children(\".publish-face-bx\").attr(\"data-publish\");\n    if (imgNum == 0) {\n        return false\n    } else {\n        upload(imgNum, topicId); //\n    }\n}\nvar showImgFn = function() {\n    var $this = $(this);\n\n    if ($this.hasClass(\"active\")) {\n        return false;\n    } else {\n        var toPage = $(this).attr(\"data-active\");\n        var toImG = $($this.parents().eq(1)).children(\".big-img\").children(\".img-hidden\").children(\"[data-bigimg='\" + toPage + \"']\");\n\n        $(toImG).removeClass(\"hide\").siblings().addClass(\"hide\");\n        var imgObj = $(toImG).children(\"img\");\n        if ($(imgObj).hasClass(\"srcError\")) {\n            $(imgObj).removeClass(\"srcError\")\n            $(imgObj).attr(\"src\", $(imgObj).attr(\"data-imgsrc\"));\n        }\n        $this.addClass(\"active\").siblings().removeClass(\"active\");\n        var imgSrc = $($this.parents().eq(1)).children(\".big-title\").children(\"[data-node='imgBigSrc']\");\n        $(imgSrc).attr(\"href\", $(imgObj).attr(\"data-imgsrc\"));\n    }\n\n}\nvar imgBigPNFn = function() {\n    var $this = $(this);\n    var curPage = $($this.parents().eq(1)).children(\".img-slide\").children(\".active\").attr(\"data-active\");\n    curPage = parseInt(curPage);\n\n    var toPage = null;\n    var tootalPage = parseInt($this.parent().attr(\"data-piclength\")) - 1;\n\n    if ($this.attr(\"data-page\") == \"pre\") {\n        if (curPage == 0) {\n            toPage = tootalPage;\n        } else {\n            toPage = curPage - 1;\n        }\n    } else {\n        if (curPage == tootalPage) {\n            toPage = 0;\n        } else {\n            toPage = curPage + 1;\n        }\n    }\n    // 图片更改\n    $($this.parents().eq(1)).children(\".img-slide\").children(\"[data-active='\" + toPage + \"']\").click();\n\n}\nvar hideBigPicFn = function() {\n    var divObj = $(this).parents().eq(2);\n    var parentObj = $(this).parents().eq(3);\n    $(divObj).addClass(\"hide\");\n    $(parentObj).children(\"ul\").removeClass(\"hide\");\n    topFixed($(window).scrollTop());\n}\n\n//大图隐藏\nvar imgBigHindFn = function() {\n        var divObj = $(this).parents().eq(1);\n        var parentObj = $(this).parents().eq(2);\n        $(divObj).addClass(\"hide\");\n        $(parentObj).children(\"ul\").removeClass(\"hide\");\n        topFixed($(window).scrollTop());\n    }\n    // 评论列表中大图展示\nvar imgPicsBig = function() {\n    var parentObj = $(this).parents().eq(1);\n    var ulObj = $(this).parents().eq(0);\n    var divBig = $(parentObj).children(\"[data-node='imgBigPic']\");\n    $(ulObj).addClass(\"hide\");\n    divBig.removeClass(\"hide\");\n\n    //大图定位显示\n    var pageId = $(this).attr(\"data-imgsort\");\n    //获取当前大图节点\n    //div\n    var thisBigPic = divBig.children(\".big-img\").children(\".img-hidden\").children(\"[data-bigimg='\" + pageId + \"']\");\n    var thisImage = $(thisBigPic).children(\"img\"); //img\n\n    $(thisBigPic).removeClass(\"hide\").siblings().addClass(\"hide\");\n    if ($(thisImage).hasClass(\"srcError\")) {\n        $(thisImage).removeClass(\"srcError\")\n        $(thisImage).attr(\"src\", $(thisImage).attr(\"data-imgsrc\"));\n    }\n\n    var aBtn = divBig.children(\".img-slide\").children(\"[data-active='\" + pageId + \"']\");\n    $(aBtn).addClass(\"active\").siblings().removeClass(\"active\");\n    //查看原图 添加链接\n    var $imgSrc = divBig.children(\".big-title\").children(\"[data-node='imgBigSrc']\");\n    $($imgSrc).attr(\"href\", $(thisImage).attr(\"data-imgsrc\"));\n    topFixed($(window).scrollTop());\n}\n\n//添加图片按钮事件\nvar btnEvent = function() {\n\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var imgNum = $(this).parents().eq(1).children(\"[data-node='addImgGoods']\").attr(\"data-imgNum\");\n    topicId = $(this).parent().attr(\"data-publish\");\n    $('[data-node=\"picPopBox\"]').removeClass('webuploader-element-invisible');\n    $('div[tabindex]').remove();\n    if (imgNum == 0) {\n        return false\n    } else {\n        code(topicId, $(this));\n        upload(imgNum, 9);\n    }\n}\nPubsub(channel.setPubliser.changeImage).sub(function(data) {\n    setImage(data, topicId);\n});\nvar setImage = function(data, topicId) {\n    if (data.images.length > 0) {\n        var arrImg = [];\n        var $div = $(\"[data-tid=\" + topicId + \"]\").children(\"[data-node='addImgGoods']\");\n        var num = parseInt($div.attr(\"data-imgNum\"));\n        var nextnum = parseInt(num - data.images.length);\n        $div.attr(\"data-imgNum\", nextnum);\n        var $ul = $(\"[data-tid='\" + topicId + \"']\").find(\"[data-node='imgUl']\");\n        $ul.addClass(\"topic-imglist\");\n        var imgsrt = $ul.attr(\"data-imgsrt\");\n        var pictureHTML = addImgTpl(data);\n        $ul.removeClass(\"hide\").append(pictureHTML);\n        if (imgsrt) {\n            arrImg.push(imgsrt);\n        }\n        for (var i = 0; i < data.images.length; i++) {\n            arrImg.push(data.images[i]);\n        }\n        $ul.attr(\"data-imgsrt\", arrImg);\n        var lengthImg = parseInt($ul.parent().attr(\"data-imgNum\"));\n        if (lengthImg <= 0) {\n            $(\"[data-tid=\" + topicId + \"]\").find(\"[data-node='addImg_btn']\").addClass(\"disabled\");\n        }\n    } else {\n        return false;\n    }\n\n}\n\n//图片二维码弹窗显示隐藏\nvar picPopBoxEvent = function(e) {\n\n    $('[data-node=\"faceBox\"]').hide();\n    e.stopPropagation();\n}\n\n//body点击事件,二维码弹窗隐藏\nvar codeBoxEvent = function(e) {\n    $showBox.hide();\n}\n\nvar code = function(topicId, $this) {\n\n    if (!window.topicQrId) {\n\n        window.topicQrId = [];\n    }\n    topicId = 's' + topicId;\n    //var arr = window.topicQrId;\n    if (!window.topicQrId[topicId]) {\n\n        var obj = {\n            qid: topicId,\n            time: 2000,\n            $showBox: $showBox,\n            customCb: customCb,\n            $insertDom: \"\",\n            $target: $this,\n            type: 'detail',\n            maxNum: 9\n        }\n\n        $.extend(obj, {\n            $parent: $this.parents('[data-node=\"comment_Msg\"]').find('[data-node=\"imgUl\"]'),\n        })\n        window.topicQrId[topicId] = new detectQr(obj)\n\n        window.topicQrId[topicId].init();\n\n    } else {\n        var _newObj = window.topicQrId[topicId]\n        if (!_newObj.useNewCode) {\n            _newObj.getCode();\n        } else {\n            if (!_newObj.checkShow()) {\n\n                _newObj.show();\n                _newObj.sendNum();\n            } else {\n                _newObj.hide();\n            }\n        }\n    }\n}\n\nvar customCb = function(data, obj) {\n    var _this = obj;\n    topicId = obj.qid.slice(1);\n    var imgs = {}; //为了做兼容性 处理\n    imgs.images = data;\n    setImage(imgs, topicId);\n}\n\n//添加事件\nvar addEvent = function() {\n    showImgBox();\n}\n\nmodule.exports = {\n    init: addEvent\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/addImgGoods/addIMG.js","var fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\n\nvar init = function (){\n\tvar $this = $(this);\n\tvar divEm = $(this).parent();\n\tvar $img = $($this.parents().eq(1)).children('img');\n\tvar imgSrc = $img.attr('src');\n\tvar oldImgSrc = $img.attr('data-oldImg');\n\tvar roteNum =Number.parseInt(divEm.attr('data-roteNum'));\n\n\tif(oldImgSrc.indexOf(\".gif\") != -1){\n\t\talert(\"gif图不支持旋转\");\n\t\treturn false;\n\t}else{\n\t\tif($this.hasClass('roteLeft')){\n\t\t\troteNum =(roteNum + 90)%360;\n\t\t}else if($this.hasClass('roteRight')){\n\t\t\troteNum =(roteNum - 90 + 360)%360;\n\t\t}\n\n\t\tif(roteNum===0){\n\t\t\t$img.attr('src',oldImgSrc);\n\t\t\t$img.css({\n\t\t\t\t\"transform\":\"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-ms-transform\" : \"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-moz-transform\":\"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-webkit-transform\":\"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-o-transform\":\"rotate(\"+roteNum+\"deg)\"\n\t\t\t});\n\t\t\tdivEm.attr('data-roteNum',roteNum);\n\n\t\t}else{\n\t\t\tvar params = {\n\t\t\t\timgPath : oldImgSrc,\n\t\t        angle : roteNum\n\t\t\t}\n\t\t\tfetch.post(url.get('handleimg'), {\n\t\t        data: params\n\t\t    }).then(function(data) {\n\t\t    \t\n\t\t    \tif(data.success){\n\t\t    \t\t$img.attr('src',data.data);\n\t\t    \t\tdivEm.attr('data-roteNum',roteNum);\n\t\t    \t}else{\n\t\t    \t\talert(data.message);\n\t\t    \t}\n\t\t    });\n\t\t}\n\t}\n\n\t\n\t\n}\n\nmodule.exports = { init }\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/addImgGoods/rotateImg.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/addImgGoods/chooseImg',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,images=$data.images,value=$data.value,i=$data.i,$escape=$utils.$escape,$out='';$each(images,function(value,i){\n$out+=' <li class=\"imgClass\"> <a href=\"javascript:;\" > <img src=\"';\n$out+=$escape(value);\n$out+='\" width=100 height=100 data-node=\"imgSrc\" data-oldImg=\"';\n$out+=$escape(value);\n$out+='\">  <div data-roteNum=0 class=\"icon-del\" > <em class=\"iconImg roteLeft\" data-node=\"roteRo\" ></em> <em class=\"iconImg roteRight\" data-node=\"roteRo\" ></em> <em class=\"iconImg deletImg\" data-node=\"deletImg\"></em> </div> </a> </li> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/addImgGoods/chooseImg.tpl\n// module id = 261\n// module chunks = 29","//var addBox = $('[data-node=addImgGoods]');\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar dialog = require('module/addGoods');\nvar Pubsub = require('io/pubsub');\nvar pubName = require('io/channel');\nvar goodsInTpl = require('./goodsIn.tpl');\nvar loginState = require('./../loginState');\nvar curTopicId = \"\";\n\nvar showGoodsBox = function() {\n\n    Pubsub(pubName.setPubliser.changedItem).sub(setGoods);\n    $(\"body\").on(\"click\", \"[data-node=addGoods_btn]\", function() {\n\n        // 判断是否登陆，没登录，显示登录框\n        if (!checkLoginStatus()) {\n            loginState.popUnion();\n            return false;\n        }\n\n        var $comment_Msg = $(this).closest(\"[data-node=comment_Msg]\");\n        curTopicId = $comment_Msg.attr(\"data-tid\");\n        var $addImgGoods = $comment_Msg.find(\"[data-node='addImgGoods']\");\n        if ($addImgGoods.hasClass(\"hasGoods\") || $(this).hasClass(\"disabled\")) {\n            return false;\n        } else {\n            var changedGoods = {};\n            dialog(changedGoods, 1);\n\n        }\n\n    });\n    //删除商品\n    $(\"body\").on(\"click\", \"[data-node='deletGoods']\", function() {\n        var $comment_Msg = $(this).closest(\"[data-node='comment_Msg']\");\n        $comment_Msg.find(\"[data-node='addImgGoods']\").removeClass(\"hasGoods\").attr(\"data-goodStr\", \"\");\n        $(this).parent().remove();\n        $comment_Msg.find(\"[data-node='addGoods_btn']\").removeClass(\"disabled\");\n    });\n}\n\n//\nvar setGoods = function(data) {\n    //将商品添加到div\n    var goodsData = data;\n    var comment_Msg = $(\"[data-tid=\" + curTopicId + \"]\");\n    var $addImgGoods = comment_Msg.children(\"[data-node='addImgGoods']\");\n\n    for (var key in goodsData) {\n        var v = goodsData[key];\n        var strGood = {\n            \"pid\": v.PId,\n            \"skuId\": v.skuId,\n            \"img\": v.img,\n            \"link\": v.link,\n            \"price\": v.price,\n            \"shopId\": v.shopId,\n            \"title\": v.title,\n            \"skuId\":v.skuId\n        }\n    }\n\n    if (strGood != \"undefined\") {\n        $addImgGoods.attr(\"data-goodStr\", JSON.stringify(strGood));\n    }\n\n    var item = goodsInTpl(strGood);\n    $addImgGoods.prepend(item).addClass(\"hasGoods\");\n    comment_Msg.find(\"[data-node='addGoods_btn']\").addClass(\"disabled\");\n}\n\nmodule.exports = {\n    init: showGoodsBox\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/addImgGoods/addGoods.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/addImgGoods/goodsIn',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,shopId=$data.shopId,pid=$data.pid,skuId=$data.skuId,img=$data.img,title=$data.title,price=$data.price,link=$data.link,$out='';$out+=' <div data-node=\"goodsIn\" class=\"reply-details\" data-shopId =\"';\n$out+=$escape(shopId);\n$out+='\" data-itemId=\"';\n$out+=$escape(pid);\n$out+='\" data-skuId=';\n$out+=$escape(skuId);\n$out+='> <em class=\"icon-close-b\" data-node=\"deletGoods\"></em> <div class=\"reply-picture\"><img src=\"';\n$out+=$escape(img);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"></div> <div class=\"reply-contxt\"> <p>';\n$out+=$escape(title);\n$out+='</p> <p class=\"price-numb\">￥<span>';\n$out+=$escape(price);\n$out+='</span></p> </div><a href=\"';\n$out+=$escape(link);\n$out+='\" class=\"see-details pc-btn pc-btnw105 pc-btnh40\" target=\"_blank\">查看详情</a> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/addImgGoods/goodsIn.tpl\n// module id = 263\n// module chunks = 29"],"sourceRoot":""}
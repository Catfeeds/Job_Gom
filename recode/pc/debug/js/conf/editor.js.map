{"version":3,"sources":["webpack:///./src/js/page/editor/index.js","webpack:///./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js?5041*****","webpack:///./src/js/module/popup/alert.js?466a****","webpack:///./src/js/module/hint.js?34fa*","webpack:///./src/js/module/popup/face/emoji.js?d6cd*","webpack:///./src/js/module/popup/face/backward.js?6a63","webpack:///./src/js/module/popup/face/face.tpl?dd34","webpack:///./src/js/module/i18n.js?8f86*","webpack:///./src/js/plugin/webuploader/webuploader.js?37bb","webpack:///./src/js/module/popup/upload/dialog.js?5b30","webpack:///./src/js/module/popup/upload/content.tpl?cddf","webpack:///./src/js/editor/index.js","webpack:///./src/js/editor/ueditor/ueditor.config.js","webpack:///./src/js/editor/ueditor/ueditor.all.js","webpack:///./src/js/editor/ueditor/lang/zh-cn/zh-cn.js","webpack:///./src/js/editor/plugin/index.js","webpack:///./src/js/editor/plugin/fonts/index.js","webpack:///./src/js/editor/plugin/fonts/title.js","webpack:///./src/js/editor/utils/getContent.js","webpack:///./src/js/editor/plugin/emoji/index.js","webpack:///./src/js/editor/plugin/picture/index.js","webpack:///./src/js/module/popup/upload/uploader.js","webpack:///./src/js/module/upload.js","webpack:///./src/js/utils/imgReplace.js","webpack:///./src/js/editor/plugin/picture/pictures.tpl","webpack:///./src/js/module/popup/uploadfileQR/index.js","webpack:///./src/js/module/popup/uploadfileQR/upload.tpl","webpack:///./src/js/editor/config.js","webpack:///./src/js/editor/plugin/transformImg.js","webpack:///./src/js/editor/plugin/angle.js","webpack:///./src/js/editor/plugin/goods/index.js","webpack:///./src/js/module/empty.js","webpack:///./src/js/module/addGoods.js","webpack:///./src/js/module/popup/addGoods/dialog.js","webpack:///./src/js/module/popup/addGoods/content.tpl","webpack:///./src/js/module/popup/addGoods/itemContent.tpl","webpack:///./src/js/module/popup/addGoods/defaultItemContent.tpl","webpack:///./src/js/editor/plugin/goods/goods.tpl","webpack:///./src/js/editor/plugin/beforeInput.js","webpack:///./src/js/editor/plugin/grepPaste.js","webpack:///./src/js/editor/rewrite/grepRule.js","webpack:///./src/js/editor/plugin/pastedCheckImg.js","webpack:///./src/js/editor/plugin/grepDrop.js","webpack:///./src/js/editor/plugin/autoHeight.js","webpack:///./src/js/editor/plugin/autoUpload.js","webpack:///./src/js/editor/plugin/beforeUnload.js","webpack:///./src/js/editor/rewrite/index.js","webpack:///./src/js/editor/rewrite/toolbar/index.js","webpack:///./src/js/editor/rewrite/toolbar/baseFont.js","webpack:///./src/js/editor/rewrite/toolbar/align.js","webpack:///./src/js/editor/rewrite/toolbar/list.js","webpack:///./src/js/editor/rewrite/buttonRules.js","webpack:///./src/js/editor/rewrite/insertGoods.js","webpack:///./src/js/editor/rewrite/fixPopPosition.js","webpack:///./src/js/editor/ban/index.js","webpack:///./src/js/editor/ban/codemirror.js","webpack:///./src/js/utils/indexOf.js","webpack:///./src/js/module/popup/face/index.js","webpack:///./src/js/editor/plugin/goodsMask.js","webpack:///./src/js/editor/rewrite/filterTxtRules.js","webpack:///./src/js/editor/plugin/restore/index.js","webpack:///./src/js/editor/utils/restoreContent.js","webpack:///./src/js/utils/decodeHtml.js","webpack:///./src/js/editor/plugin/restore/lenovoLabel.tpl","webpack:///./src/js/editor/plugin/goods/restoreGoods.tpl","webpack:///./src/js/page/publishTopic/unsuccessful/index.js","webpack:///./src/js/page/editor/test.js"],"names":["ueditor","require","test","ue","init","Dialog","noop","create","content","options","defaults","fixed","modal","autofocus","className","okCls","ok","$","extend","d","header","_$","title","css","show","module","exports","$publicMask","$publicTips","timer","events","off","on","hide","msg","duration","callback","clearTimeout","length","text","append","offsetHeight","width","setTimeout","imgPath","$_CONFIG","imgpath","ext","groupOne","name","url","groupTwo","groupThree","groupFour","groupFive","format","arr","i","len","emoji","concat","path","backward","inputTip","tel","ept","err","errBack","msgCode","tipGet","tipEpt","tipErr","tipErrEdit","tipWrong","checkCodeWrong","send","tipSend","tipDisabled","tipLimitEdit","btnAfterSend","btnDefault","pwd","commonTip","pwdV","nickName","eptName","existName","sucSub","errLine","wrongName","birthTip","tip","refCode","imgCode","login","errCode","errNum","errPwd","agreement","createCircle","typeEmpty","nameEmpty","upperLimit","circle","unJoin","cannotJoin","review","joinSuccess","joinSuccessPublic","cannotJoinCircle","exit","dissolved","qrCodeTip","loseEffTip","loseEffBtn","failGetTip","failGetBtn","masterApply","nameLength","nameType","isIdCard","type","summary","upload","noUpload","uploadError","uploadFaild","uploadError_Master","Q_EXCEED_NUM_LIMIT","Q_EXCEED_SIZE_LIMIT","Q_TYPE_DENIED","F_EXCEED_SIZE","excess","tpl","data","okValue","cancalValue","btnWrapCls","alert","faceModule","opts","goodsMask","filterTxtRules","restoreData","id","editor","UE","getEditor","face","onSelected","str","reg","execCommand","addListener","defaultContent","getContent","$editorBody","body","placeholderCls","$container","container","addClass","delegate","e","stopPropagation","preventDefault","removeClass","hasDiv","find","isEqDefault","isContentEmpty","trim","$emojiBtn","firstChild","$pictorBtn","$picPopBox","window","flagY","offset","top","scrollTop","isShow","$dom","sensitiveWord","each","v","URL","UEDITOR_HOME_URL","getUEBasePath","UEDITOR_CONFIG","serverUrl","toolbars","xssFilterRules","inputXssFilter","outputXssFilter","whitList","a","abbr","address","area","article","aside","audio","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","details","div","dl","dt","em","font","footer","h1","h2","h3","h4","h5","h6","hr","img","ins","li","mark","nav","ol","p","pre","s","section","small","span","sub","sup","strong","table","tbody","td","tfoot","th","thead","tr","tt","u","ul","video","docUrl","confUrl","getBasePath","self","document","location","href","getConfigFilePath","configPath","getElementsByTagName","src","basePath","exec","replace","split","optimizationPath","protocol","tmp","res","shift","pop","push","join","I18N","value","searchError","lang_city","lang_address","city","lang_search","lang_dynamicmap","cityMsg","errorMsg","lang_tab_search","lang_tab_replace","lang_search1","lang_search2","lang_replace","lang_searchReg","lang_searchReg1","lang_case_sensitive1","lang_case_sensitive2","nextFindBtn","preFindBtn","nextReplaceBtn","preReplaceBtn","repalceBtn","repalceAllBtn","getEnd","getStart","countMsg","lang_showMsg","lang_download","lang_step1","lang_step2","tsfh","lmsz","szfh","rwfh","xlzm","ewzm","pyzm","yyyb","zyzf","captionName","titleName","cellsName","lang_delRow","lang_delCol","lang_tdBkColor","lang_resave","uploadBtn","alt","clipboard","style","lang_step","domUtils","dom","utils","changeTagName","tagName","key","registerUI","uiName","aliasName","args","btn","ui","Button","onclick","range","selection","getRange","indexOf","startDom","startContainer","tag","findParentByTagName","toLowerCase","setChecked","select","fragment","cloneContents","node","createElement","appendChild","innerHTML","registerCommand","focus","$btn","target","x","left","y","label","iconEle","cssRules","state","queryCommandState","setDisabled","Pubsub","channel","pictureTpl","detectQr","config","imgReplace","imgMaxLen","imgLimitNUm","maxLen","imgTimes","$content","$upLocal","$cover","newPop","obj","time","$showBox","customCb","$insertDom","insertedImgLen","not","topicQrId","$parent","$target","useNewCode","getCode","checkShow","sendNum","remove","setPubliser","changeImage","$lastNode","pictureHTML","times","images","temp","proto","imgProto","_src","$editor","last","lastOffsetTop","lastPosition","height","changeSrc","uploadPop","pubName","total","dialogUploader","$webUpLoader","maxlength","hasClass","destroy","$imgList","eq","attr","pub","cancel","callbacks","onFileQueued","file","numList","number","$uploadBox","picker","children","html","before","source","ruid","onUploadSuccess","response","success","WebUploader","hint","notice","files","defaultOptions","selector","parents","delSelector","defaultApi","pick","accept","extensions","mimeTypes","method","swf","auto","disableGlobalDnd","duplicate","prepareNextFile","chunked","fileVal","server","fileNumLimit","fileSizeLimit","fileSingleSizeLimit","onBeforeFileQueued","onUploadError","onUploadProgress","percentage","onErrored","retry","_this","delImage","webuploader","removeFile","undefined","call","reason","rules","https","imgRule","shotCut","imgType","grepStr1","grepStr2","orignalImgReplace","addShortCut","$1","$imgs","_orignal","codeTpl","$GLOBAL_CONFIG","fetch","qrTips","domain","pageId","Scans","o","qid","uploadMaxNum","maxNum","interval","customInit","isLoad","imgArr","$localBtn","prototype","constructor","start","imgLength","datas","qidArr","qrcodeId","get","done","_data","encodeURIComponent","getCodeCb","setInterval","monitor","message","fail","post","groupkey","scanCb","m","clearInterval","insertPic","_img","_proto","loading","unLoading","setEnabled","is","fixPop","isload","dataArr","tempArr","diffLen","slice","whiteList","goodsLimitNUm","initialFrameWidth","initialFrameHeight","zIndex","autoClearinitialContent","themePath","csspath","iframeCssUrl","pasteplain","allowDivTransToP","imageScaleEnabled","elementPathEnabled","wordCount","catchRemoteImageEnable","enableContextMenu","imagePopup","enableAutoSave","transform","plugin","register","elm","me","imageTransformPopup","baidu","Popup","theme","cutstomPosition","_filterType","el","_left","anchorEl","_right","_delete","render","evtName","evt","parentNode","formatHtml","getDom","link","showAnchor","firing","$picLoading","transformAngle","$obj","direction","def","Deferred","angle","parseInt","resolve","promise","detectImg","hasImg","angleStr","tempObj","extendObj","renderImg","status","cache","renderExist","beforeSend","dataSrc","always","then","empty","toast","dialog","goodsTpl","from","insertedGoods","$goodsDoms","goodsLen","goodsData","skuId","k","changedItem","DomArr","getStartElementPath","creatNewP","nextNode","nextElementSibling","nodeName","$goodsCards","$eParent","parent","$preDom","prev","preDomTxt","$goodsCard","goodsHTML","list","$body","$el","$li","$next","next","itemlist","defaultItemlist","indexof","pageNum","isDefault","keyWord","changedList","isGetMore","degree","addDialog","$searchTop","$searchInput","$searchBtn","$searchNormal","$searchLoading","$searchFail","$searchResult","$searchList","$changeNum","$listBox","$changeList","$title","$getMore","$searchListBox","selectedGoods","changedGoods","max","returnList","imgSrc","changeNum","dialogClosed","onshow","getNode","defaultItem","searchItem","reGet","changeItem","getMoreItem","overflowY","getItems","page","pagesize","result","items","keycode","which","val","moreItem","txt","pagenum","word","pageCount","resultItem","collections","$this","pId","shopId","itemLink","PId","price","index","splice","reset","closest","browser","gecko","version","setCursor","newNode","position","setStart","setEnd","deleteNode","doc","textNode","createTextNode","startOffset","insertBefore","insertAfter","keyCode","toUpperCase","endOffset","closedNode","getClosedNode","detectKey","backspaceKey","deleteKey","defaultKey","previousSibling","$prev","console","log","prentsNode","ctrlKey","grepHtml","pastedCheckImg","grepFormat","grepDiv","grepImg","grepLocal","grepFace","getHtml","num","overload","j","selectGetHtml","innerImgLen","outerImgLen","limitNum","maybe","tempHtml","checkNum","innerImg","match","outerImg","endContainer","useAlert","case_1","case_2","h","defaultImg","setImgPath","useDefault","setAttribute","test_src","thisSrc","ieVersion","ie","dropStr","tempRange","dropToP","grepRule","grepCursor","isIe","l","nodeValue","renderP","childNodes","textOffset","imgOffset","_node","oldTextNode","renderBody","removeAttr","imgPrent","bindEvents","_body","dataTransfer","getData","setData","deleteContents","i18n","maxSize","fetchData","_datas","imgReader","reader","FileReader","onload","Image","canvas","context","getContext","imageBase64","_w","_h","drawImage","toDataURL","readAsDataURL","getPasteImage","clipboardData","getDropImage","outputRule","root","getNodesByTagName","n","getAttr","removeChild","FormData","getAsFile","size","navigator","userAgent","onbeforeunload","noAlertMessage","plugins","basestyles","getObj","tagNames","filterNodeList","addshortcutkey","addInputRule","cmd","commands","cmdName","collapsed","tmpText","insertNode","removeInlineStyle","setStartBefore","tmpNode","collapse","applyInlineStyle","block","isBlockElm","defaultValue","right","justify","doJustify","bookmark","createBookmark","filterFn","nodeType","isBookmarkNode","isWhitespace","enlarge","bookmark2","current","getNextDomNode","tmpRange","cloneRange","getPosition","end","POSITION_FOLLOWING","setEndAfter","common","getCommonAncestor","isBody","setStyles","isString","frag","extractContents","moveToBookmark","align","queryCommandValue","startNode","getComputedStyle","cell","dtd","grepDom","notExchange","customStyle","setOpt","listDefaultPaddingLeft","listiconpath","maxListLevel","disablePInList","listToArray","listStyle","insertorderedlist","insertunorderedlist","liiconpath","hasOwnProperty","ready","customCss","cssRule","rng","nextSibling","isEmptyBlock","pn","setStartAtLast","setStartAtFirst","fillNode","getStyle","cls","htmlparser","setAttr","currentStyle","setStyle","toHtml","getOpt","addOutputRule","newChildrens","lastNode","uNode","tmpP","ci","lastChild","autoTransWordToList","checkListType","unorderlisttype","orderlisttype","appendLi","first","innerText","cacheNode","adjustListStyle","ignore","inDoc","nodeStyleType","parentStyleType","styleIndex","setListStyle","cssText","paddingLeft","getAttribute","removeAttributes","adjustList","ignoreEmpty","nextList","moveChild","isFillChar","preList","ownerDocument","clearEmptySibling","preventAndSave","returnValue","fireEvent","undoManger","save","findList","shiftKey","findParent","RegExp","fillChar","__hasEnterExecCommand","parentList","bk","breakParent","isEmptyNode","$list","nextLi","shrinkBoundary","isStartInblock","trimBoundary","isTagNode","checkLevel","level","levelNum","parentLi","closeList","findParents","currentIndex","getLi","command","createDocumentFragment","adjustmentBoundary","bko","getElementById","modifyStart","modifyEnd","startParent","endParent","nodeStyle","tmpFrag","tmpfrag","hasBlock","setStartAfter","tmpDiv","setEndBefore","POSITION_PRECEDING","tmpDivs","getHtmlTpl","showIcon","notNeedFilter","innerGoods","innerGoodsLen","ueGoods","outerGoodsLen","uiUtils","UIBase","ANCHOR_CLASSES","showAnchorRect","rect","hoz","adj","_doAutoRender","vpRect","getViewportRect","visibility","_show","popSize","fitSize","sideLeft","sideUp","canSideLeft","canSideUp","bottom","popEl","objs","popWidth","setViewportOffset","removeClasses","getFixedLayer","Array","elt","Number","arguments","Math","ceil","floor","emojis","faceTpl","emojiData","emojiMap","makeData","Face","foo","_bindHtml","faceHTML","_bindEvent","setShowIndex","activeCls","hideCls","siblings","faceReg","faceUrl","parseEmoji","r","isEmptyObject","old","faceInstance","goodsdMask","close","hideMask","$s","lenth","rewriteTxtRules","fn","txtRules","newRules","restoreContent","editPath","editKey","unsuccessful","_url","tid","strs","$topicTitleTips","$titleCharLen","$crtLists","$selectGroup","decode","labelTpl","itemTpl","isMeihao","originRule1","originRule2","orignText","restore","components","restoreTitle","restoreLabel","restoreGroup","arrs","restoreText","restoreImg","restoreItem","formatText","richText","isVideo","tempSrc","tempProto","item","json","itemDetailUrl","mainImage","salePrice","labels","gid","groupId","group","unhtml","relativePath","i_domain","relUrl","contents","click","str2","tempstr","nodes","tagNode","_thisNode","_thisValue","attributes","JSON","parse","kid","t","htmlNull","re"],"mappings":"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AAU,cAHD;AAITC,eAAM,SAJG;AAKTC,kBAAS;AALA,MAzEF;AAgFXC,aAAQ;AACJC,mBAAU,OADN;AAEJC,sBAAa,kCAFT;AAGJC,sBAAa,YAHT;AAIJC,6BAAoB,kCAJhB;AAKJC,6BAAoB,kCALhB;AAMJC,8BAAqB,WANjB;AAOJC,wBAAe,QAPX;AAQJC,wBAAe,uBARX;AASJC,iBAAQ;AATJ,MAhFG;AA2FX5C,cAAS;AACLG,cAAK;AADA;AA3FE,EAAf;AA+FAlE,QAAOC,OAAP,GAAiBqC,QAAjB,C;;;;;;;iGClGA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;;AAEpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA,+CAA8C,SAAS;AACvD;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;AACA,UAAS;;AAET;;AAEA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;;;AAGD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iCAAgC;AAChC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;;AAEA;AACA,2BAA0B,aAAa;AACvC;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA,6BAA4B;;AAE5B,wDAAuD;AACvD,sDAAqD;AACrD;;AAEA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,MAAM;AAC9B,yBAAwB,kBAAkB;AAC1C,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,MAAM;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA,6CAA4C;AAC5C;AACA;AACA,iCAAgC;AAChC,iCAAgC;AAChC;AACA;AACA,4DAA2D;AAC3D;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,kBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA,iEAAgE;;AAEhE;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;AACA,qBAAoB;AACpB;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAuD;AACvD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,4BAA2B,OAAO;AAClC;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B,wBAAuB,MAAM;AAC7B;AACA,sDAAqD;AACrD,uDAAsD;AACtD,0DAAyD;AACzD,8DAA6D;AAC7D,qEAAoE;AACpE,2FAA0F;AAC1F;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAmD;AACnD,iBAAgB;AAChB;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,oCAAmC;;AAEnC;AACA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,SAAS;AACjC,yBAAwB,OAAO;AAC/B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,EAAE;AAC1B,yBAAwB,QAAQ;AAChC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB,OAAO;AAC/B;AACA;AACA;AACA;;AAEA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA,8CAA6C;AAC7C;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA,kBAAiB,OAAO;AACxB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B;;AAE1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;;;AAGA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,8CAA6C;;AAE7C;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAuB;AACvB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;;AAEA;AACA,2BAA0B,eAAe;AACzC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,wBAAuB,SAAS;AAChC;AACA;;AAEA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kCAAiC;;AAEjC;AACA,8BAA6B;AAC7B,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ,4CAA2C;AAC3C;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA,wBAAuB,sDAAsD;AAC7E;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,OAAO;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8CAA6C,KAAK;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,uBAAsB,SAAS;AAC/B;AACA;AACA;;AAEA;AACA,uBAAsB,SAAS;AAC/B;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,kBAAiB;;AAEjB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,8CAA6C;AAC7C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;;AAET;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAsB,SAAS;AAC/B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAAyC;AACzC;AACA;AACA,sBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;;AAET;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,8CAA6C;;AAE7C;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,2BAA0B,kBAAkB;AAC5C;AACA;AACA;AACA;AACA,wBAAuB,YAAY;AACnC,2BAA0B,OAAO;AACjC,+BAA8B,OAAO;AACrC,8BAA6B,QAAQ;AACrC;AACA;;AAEA;AACA,2BAA0B,MAAM;AAChC;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC,gCAA+B,OAAO;AACtC,+BAA8B,OAAO;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;;AAEA,0CAAyC;AACzC;AACA;AACA;AACA;AACA,sBAAqB;;AAErB;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;;AAEA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC;;AAEA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,UAAS;;AAET;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA,qBAAoB;AACpB;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAqB;AACrB;;;AAGA;;AAEA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAkC;AAClC;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;;AAGA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa;AACb;;AAEA;;AAEA;AACA;AACA;AACA;AACA,wBAAuB,mBAAmB;AAC1C,wBAAuB,OAAO;AAC9B;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,cAAa;;AAEb;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,yBAAwB,OAAO;AAC/B,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B,yBAAwB,KAAK;AAC7B;AACA;AACA;AACA;;AAEA;;AAEA,6BAA4B,SAAS;AACrC;;AAEA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,SAAS;AAChC;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,UAAS;;AAET;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA0D,SAAS;AACnE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;;AAGb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;;AAGb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD;AAClD;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wBAAuB,SAAS;AAChC;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;;AAET,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,uBAAsB,OAAO;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,sDAAqD,SAAS;AAC9D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,mDAAkD,+BAA+B;AACjF;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAwB;AACxB,wBAAuB;AACvB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA,UAAS;;AAET;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,QAAQ;AAClC;AACA;AACA;AACA;AACA;;;AAGA;AACA,2BAA0B,OAAO,aAAa;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;;AAEA;AACA,2BAA0B,OAAO;AACjC;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,sBAAqB;;AAErB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB;;AAEzB;AACA,sBAAqB;AACrB;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;;AAGb;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,sBAAqB;;AAErB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,sBAAqB;;AAErB;AACA;AACA;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;;AAGb;AACA;AACA,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,OAAO;AAC9B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B,wBAAuB,OAAO;AAC9B;AACA;AACA;;;AAGA;AACA;AACA,wBAAuB,KAAK;AAC5B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B,wBAAuB,OAAO;AAC9B;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,KAAK;AAC5B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC;AACtC,0CAAyC;AACzC;;AAEA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,sBAAqB;;AAErB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;;AAEA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB;AACzB;AACA;AACA,0BAAyB;AACzB,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA,UAAS;AACT,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4BAA2B;AAC3B;;AAEA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA,UAAS;;AAET;AACA,uBAAsB,IAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;AACb,UAAS;;;AAGT;AACA,uBAAsB,IAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;;AAEA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA,uBAAsB,IAAI;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,cAAa;;AAEb,UAAS;;AAET;AACA,uBAAsB,QAAQ;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,SAAS;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;AACb,UAAS;;AAET;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;AACb;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,0BAAyB;AACzB;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;;AAEjB;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,iDAAgD,SAAS;AACzD;AACA;;AAEA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB;AACrB,kBAAiB;AACjB;AACA;AACA;AACA;AACA;;AAEA,qCAAoC,SAAS;AAC7C;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA0D,SAAS;AACnE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;;AAEA,iDAAgD,SAAS;AACzD;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2DAA0D,SAAS;AACnE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;;AAEA,cAAa;;;AAGb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA,6BAA4B,oBAAoB;AAChD;AACA;;AAEA,+DAA8D;;AAE9D;AACA,cAAa;;AAEb;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA,6BAA4B,oBAAoB;AAChD;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,qDAAoD,aAAa,KAAK;AACtE,cAAa;;AAEb;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,oCAAmC;AACnC,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,6CAA4C,oBAAoB;AAChE;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;;AAEA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,yBAAwB,YAAY;AACpC;AACA;AACA;;AAEA;AACA;;AAEA;AACA,6BAA4B,mBAAmB;AAC/C;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,yBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,YAAY;AACtC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAsD;AACtD,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oCAAmC,QAAQ;AAC3C;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,QAAQ;AAC3C;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,SAAS;AAC9C;AACA,0CAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAmC,SAAS;AAC5C,wCAAuC,iBAAiB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sCAAqC,WAAW;AAChD;AACA,+CAA8C,YAAY;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA,sDAAqD,iBAAiB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAkC,SAAS;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,8CAA6C;AAC7C;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iDAAgD;AAChD;AACA;AACA;;AAEA,uDAAsD;AACtD;;AAEA,gEAA+D;AAC/D,sDAAqD;AACrD;;AAEA;AACA,6CAA4C;AAC5C;AACA;;AAEA;AACA,gEAA+D;AAC/D,2DAA0D;AAC1D,2DAA0D;AAC1D,sDAAqD;;AAErD,6CAA4C;AAC5C;;AAEA,oDAAmD;AACnD;AACA;AACA;;AAEA,sCAAqC;AACrC;;AAEA;AACA;AACA,8BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uDAAsD;AACtD;AACA;AACA;;AAEA,2DAA0D;AAC1D;;AAEA,sEAAqE;AACrE,2DAA0D;AAC1D;;AAEA;AACA,mDAAkD;AAClD;AACA;;AAEA;AACA,sEAAqE;AACrE,iEAAgE;AAChE,iEAAgE;AAChE,0DAAyD;;AAEzD,mDAAkD;AAClD;;AAEA,yDAAwD;AACxD;AACA;AACA;;AAEA,mCAAkC;AAClC;;AAEA;AACA;AACA,8BAA6B,OAAO;AACpC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC,mCAAkC;AAClC,qCAAoC;AACpC,qCAAoC;AACpC,qCAAoC;AACpC,qCAAoC;AACpC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC;;AAEA;AACA;AACA,uCAAsC;AACtC,mCAAkC;AAClC,kCAAiC;AACjC;AACA;AACA,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC;;AAEA;AACA;AACA,uCAAsC;AACtC,oCAAmC;AACnC;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC,uCAAsC;;AAEtC,kCAAiC;AACjC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,OAAO;AACxC;AACA;;AAEA,qCAAoC;AACpC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,QAAQ;AACzC;AACA;;AAEA,kCAAiC;AACjC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,OAAO;AACxC;AACA;;AAEA,qCAAoC;AACpC,kCAAiC,MAAM;AACvC;AACA;AACA,kCAAiC,QAAQ;AACzC;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC,mCAAkC;AAClC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC,qCAAoC;AACpC,kCAAiC;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,MAAM;AACvC;AACA;AACA,2CAA0C;AAC1C;AACA;AACA,4CAA2C;AAC3C,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,sCAAqC;AACrC,2BAA0B,+BAA+B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,4BAA4B;AAC1D;AACA;AACA;AACA,iDAAgD,iBAAiB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,iCAAgC,SAAS,MAAM;AAC/C;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,uCAAsC;AACtC;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,mCAAkC,UAAU;AAC5C,4CAA2C;AAC3C,mDAAkD;AAClD;;AAEA,iDAAgD;AAChD;AACA;;AAEA,oDAAmD;AACnD;AACA;;AAEA;AACA;AACA;;;AAGA;AACA,qFAAoF;AACpF;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uCAAsC;;AAEtC,wDAAuD;;AAEvD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAoC;;AAEpC;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB,sBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA;;AAEA;AACA,mCAAkC;AAClC;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,mCAAkC;AAClC;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB;AACA;AACA;AACA,sBAAqB;;AAErB;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sBAAqB;AACrB;AACA;AACA,kBAAiB;AACjB;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;;AAElB,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,mBAAkB;;AAElB,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAwB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA,wBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA,4BAA2B,QAAQ;AACnC;AACA;AACA;;AAEA;AACA;AACA,mDAAkD,IAAI;AACtD;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yBAAwB,QAAQ;AAChC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,YAAY;AACnC;AACA;;AAEA;AACA;AACA;AACA,4BAA2B,QAAQ;AACnC;AACA;AACA;;AAEA;AACA;AACA,mDAAkD,IAAI;AACtD;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,UAAS;;AAET;;AAEA;AACA;AACA;AACA,wBAAuB,OAAO;AAC9B;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,wBAAuB,cAAc;AACrC;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA,UAAS;;;;AAIT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yBAAwB,aAAa;AACrC;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,YAAY;AACnC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,MAAM;AACzB,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA2B,QAAQ;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA,mDAAkD,IAAI;AACtD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,SAAS;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,OAAO;AAC1B,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B;AACA,qBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,yBAAwB,aAAa;AACrC;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,YAAY;AACnC;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB,YAAY;AAChC,qBAAoB,YAAY;AAChC;AACA,qBAAoB,YAAY;AAChC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,oBAAmB,YAAY;AAC/B,oBAAmB,QAAQ;AAC3B;AACA,qBAAoB,aAAa;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;;AAEA;AACA;;AAEA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;;AAEA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAAyB;AACzB,6BAA4B;AAC5B;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,kBAAiB;AACjB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,UAAS;;AAET;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAsC;AACtC;;AAEA;AACA;AACA,8BAA6B,SAAS;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAoB;AACpB,iBAAgB;;AAEhB;AACA;;AAEA;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,kBAAiB;AACjB;AACA;AACA,sBAAqB;;AAErB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA,cAAa;;AAEb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,sBAAqB;AACrB;AACA;AACA,sBAAqB;AACrB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,6BAA4B;;AAE5B;AACA;AACA;AACA,8BAA6B;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAiB;;AAEjB;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,kBAAiB;AACjB;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa;;AAEb;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kCAAiC;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA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CA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AA7UoB,WA+UpBC,gBAAgB;AACZ;;AAhVgB,WAkVpBC,gBAAgB;AACZ;;AAnVgB,WAqVpBC,iBAAiB;AACb;;AAtVgB,WAwVpBC,UAAU;AACNC,gBAAG,CAAC,QAAD,EAAW,OAAX,EAAoB,MAApB,EAA4B,OAA5B,EAAqC,OAArC,CADG;AAENC,mBAAM,CAAC,OAAD,EAAU,OAAV,EAAmB,OAAnB,CAFA;AAGNC,sBAAS,CAAC,OA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CA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,KAAI;AACJ;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA,kBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,kBAAiB,UAAU;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAgB,UAAU;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,oCAAmC,OAAO;AAC1C;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA,yBAAwB,wBAAwB,+BAA+B,EAAE;AACjF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA,oBAAmB,yBAAyB;AAC5C,qBAAoB;AACpB;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB,cAAa,UAAU;AACvB,eAAc,SAAS;AACvB;AACA;AACA;AACA,oBAAmB,yBAAyB;AAC5C,qBAAoB;AACpB;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,YAAY;AACzB,eAAc,SAAS;AACvB;AACA;AACA;AACA,qBAAoB;AACpB,qBAAoB,0BAA0B;AAC9C,qBAAoB;AACpB;AACA;AACA;AACA,iBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,cAAc;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,WAAW;AACxB,cAAa,SAAS;AACtB,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAqC,iBAAiB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,WAAW;AACxB,cAAa,MAAM;AACnB;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,WAAW;AACxB,cAAa,MAAM;AACnB,cAAa,UAAU;AACvB;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,IAAI;AACjB,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,IAAI;AACjB,cAAa,MAAM;AACnB,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,IAAI;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,OAAO;AAC3C;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,QAAQ;AACrB,eAAc,SAAS;AACvB;AACA;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,gBAAgB;AAChD;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA,oBAAmB,QAAQ,KAAK,IAAI;AACpC;AACA;AACA;AACA;AACA;AACA,8EAA6E;AAC7E;AACA;AACA,MAAK;AACL;AACA,iBAAgB;AAChB,kBAAiB;AACjB,mBAAkB;AAClB,iBAAgB;AAChB,kBAAiB;AACjB,OAAM;AACN;;AAEA,KAAI;AACJ,IAAG;AACH;AACA;AACA,eAAc,SAAS;AACvB,eAAc,SAAS;AACvB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA,gBAAe;AACf,iBAAgB;AAChB,kBAAiB;AACjB,gBAAe;AACf,iBAAgB;AAChB,MAAK;;AAEL,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA,qBAAoB,QAAQ,KAAK,IAAI,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yDAAwD;AACxD;AACA,WAAU;AACV,YAAW;AACX,aAAY;AACZ,WAAU;AACV,YAAW;AACX,aAAY;AACZ,MAAK;AACL,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,cAAc;AAC3B,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,cAAc;AAC3B,cAAa,SAAS;AACtB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAwB,mBAAmB;AAC3C;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,IAAI;AACjB;AACA;AACA,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA,6CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,oBAAoB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA,4DAA2D,IAAI;AAC/D;AACA;AACA;AACA,iCAAgC;AAChC;AACA;AACA;AACA,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,sCAAsC;AACrD;AACA,MAAK;AACL,eAAc;AACd;AACA;AACA,kFAAiF;AACjF;AACA;AACA;;AAEA;AACA,kCAAiC,+BAA+B,gBAAgB,MAAM;AACtF,sCAAqC,GAAG;AACxC,wBAAuB,MAAM;AAC7B,MAAK;AACL,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;;AAEA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,iBAAgB,kBAAkB;AAClC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA,6CAA4C,gBAAgB;AAC5D,8GAA6G;AAC7G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,uCAAsC,SAAS;AAC/C,2CAA0C,YAAY;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,qBAAoB,oBAAoB;AACxC;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA,IAAG;AACH;;AAEA;;AAEA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAgB,OAAO;AACvB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,SAAQ;AACR;AACA,SAAQ;AACR;AACA,SAAQ;AACR,yBAAwB;AACxB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;AACA;AACA;AACA,aAAY,IAAI;AAChB,cAAa,UAAU;AACvB;;AAEA;AACA;AACA;AACA,aAAY,IAAI;AAChB,cAAa,UAAU;AACvB;;AAEA;AACA;AACA;AACA,aAAY,IAAI;AAChB,cAAa,UAAU;AACvB;;AAEA;AACA;AACA;AACA,aAAY,IAAI;AAChB,cAAa,UAAU;AACvB;;AAEA;AACA;AACA;AACA,aAAY,IAAI;AAChB,cAAa,UAAU;AACvB;;AAEA;AACA;AACA;AACA,aAAY,IAAI;AAChB,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,uBAAsB,iBAAiB;AACvC;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,iBAAiB;AACvC;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA,eAAc,IAAI;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,OAAO;AACpB,eAAc,IAAI;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,iBAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB,aAAY,UAAU;AACtB,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA,mFAAkF;AAClF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,KAAI;;AAEJ;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,YAAW;AACX,YAAW;AACX;AACA,WAAU;AACV;AACA;AACA;AACA,KAAI;AACJ,WAAU;AACV,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,eAAc;AACd;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;AACH,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,SAAS;AACvB;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,cAAc;AAC3B,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,WAAW;AACxB;AACA;AACA;AACA,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,WAAW;AACxB,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,QAAQ;AACrB;AACA,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,QAAQ;AACrB,cAAa,UAAU;AACvB;AACA,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB,eAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB,eAAc,OAAO;AACrB;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB,eAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB;AACA,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,MAAM;AACnB,eAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,SAAS,MAAM,aAAa;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,SAAS;AACtB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,QAAQ;AACrB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,SAAS;AACtB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,QAAQ;AACrB,cAAa,WAAW;AACxB;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,wBAAwB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD,SAAS;AAC1D,+CAA8C,SAAS;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B;AAC3B,4BAA2B;AAC3B;AACA;AACA;AACA,uBAAsB,kBAAkB;AACxC;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB,eAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,gCAAgC;AACpE;AACA,qCAAoC;AACpC;AACA;AACA;AACA,uBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD;AACjD;AACA;AACA;AACA;AACA,gDAA+C;AAC/C;AACA;AACA;AACA,8BAA6B;AAC7B,0BAAyB,gBAAgB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,SAAS;AACtB,eAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,GAAG;AAC3C;AACA,uBAAsB,gBAAgB;AACtC;AACA,wBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAkE;AAClE;AACA;AACA;AACA;AACA,sDAAqD;AACrD;AACA;AACA,QAAO;AACP,kCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,UAAU;AACvB,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,oBAAoB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,SAAS;AACtB;AACA;AACA;AACA,uCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,QAAQ;AACrB;AACA;AACA;AACA,uCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,0FAAyF,GAAG;AAC5F,uBAAsB,qBAAqB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,cAAc;AAC3B,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAmD;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,SAAS,mBAAmB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,GAAG;AAC3C,4CAA2C,sBAAsB;AACjE;AACA;AACA,uCAAsC,GAAG;AACzC;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qDAAoD,GAAG;AACvD,4CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,SAAS;AACtB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,QAAQ;AACrB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD,GAAG;AACrD,gDAA+C,qBAAqB;AACpE;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB;AACA;AACA,wCAAuC,kBAAkB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA,uFAAsF,GAAG;AACzF,KAAI;AACJ;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB;AACA,eAAc,SAAS;AACvB;AACA;AACA,uCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,+DAA8D,iBAAiB;AAC/E;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,UAAU;AACvB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,WAAW;AACxB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,iBAAgB,KAAK;AACrB,iBAAgB,OAAO;AACvB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,UAAU;AACvB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,UAAU;AACvB,cAAa,SAAS,gBAAgB,qBAAqB;AAC3D;AACA;AACA;AACA;AACA,uCAAsC,YAAY,oBAAoB;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA,+BAA8B,aAAa;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,cAAc;AAC3B,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB;AACA,eAAc,UAAU;AACxB;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,SAAS;AACtB,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,WAAW;AACxB,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,SAAS;AACtB,eAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,WAAW;AACxB,cAAa,UAAU;AACvB,eAAc,sBAAsB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA,cAAa,eAAe;AAC5B;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,wCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,kCAAkC;AACpD;AACA;AACA,uBAAsB,sBAAsB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,oBAAoB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,WAAW;AACxB;;AAEA;AACA,iBAAgB,OAAO;AACvB;;AAEA;AACA,iBAAgB,OAAO;AACvB;AACA;;AAEA;AACA,iBAAgB,OAAO;AACvB;;AAEA;AACA,iBAAgB,OAAO;AACvB;AACA;;AAEA;AACA,iBAAgB,UAAU;AAC1B;AACA;AACA;;AAEA;AACA,iBAAgB,WAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,gBAAe,0BAA0B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,gBAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB,eAAc,MAAM;AACpB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,OAAO;AACrB,eAAc,MAAM;AACpB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB,eAAc,UAAU;AACxB,gBAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;;AAEA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,QAAO;AACP;AACA;AACA,SAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;;AAEA;AACA;AACA;AACA,eAAc,UAAU;AACxB;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,UAAU;AACxB;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C,gBAAgB;AAC5D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,WAAW;AAC1B,iBAAgB,eAAe;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;;AAEA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,SAAS;AACvB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,yBAAyB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,gBAAgB;AAC1C;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,QAAQ;AACtB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,eAAe;AAC9B;;AAEA;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,SAAS;AACvB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,yBAAwB,mBAAmB;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;;AAEA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAmC,4CAA4C;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA4C,OAAO;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,OAAM;AACN;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,eAAe;AAC7B,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,WAAW;AACzB,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,WAAW;AACzB,eAAc,WAAW;AACzB;AACA;AACA,gBAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,MAAM;AACnB,cAAa,MAAM;AACnB,gBAAe,MAAM;AACrB;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,UAAU;AACvB,eAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,YAAY;AACzB;AACA;AACA;AACA;AACA;AACA,gFAA+E,eAAe;AAC9F;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC;AACvC,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAsD;AACtD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,IAAI;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAsB,UAAU;AAChC;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,cAAa,UAAU,qBAAqB,YAAY,YAAY;AACpE;AACA;AACA,aAAY,WAAW,uBAAuB,gBAAgB;AAC9D;AACA,UAAS,cAAc;AACvB;AACA;AACA;AACA;AACA,8BAA6B,qEAAqE,yBAAyB,IAAI;AAC/H,qEAAoE,8CAA8C;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,gBAAgB,+GAA+G;AACtK,wCAAuC,kBAAkB;AACzD,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,QAAO;AACP;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;;AAEA,QAAO;AACP;AACA;AACA,SAAQ;AACR;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,SAAS;AACvB;AACA;AACA,qDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,eAAe;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,SAAS,wCAAwC,KAAK,IAAI,OAAO,IAAI,MAAM;AAC1F;AACA;AACA;AACA,yCAAwC;AACxC;AACA;;AAEA;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA,2DAA0D;AAC1D,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;;AAEN;AACA,uGAAsG;AACtG,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA,yCAAwC;AACxC;AACA;AACA;AACA;AACA,wDAAuD;AACvD,uDAAsD;AACtD;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,yEAAwE;AACxE,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA,yCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,UAAU;AACxB;AACA;AACA;AACA,kDAAiD;AACjD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0DAAyD;;AAEzD,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,UAAU;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,MAAK;;AAEL,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA,gBAAe,IAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,IAAI;AAClB,gBAAe,IAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA,gBAAe,IAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA,gBAAe,IAAI;AACnB,wDAAuD;AACvD;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,QAAQ;AACtB,gBAAe,UAAU;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,gBAAgB;AAC/B;AACA,yBAAwB,iBAAiB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;;AAEJ;AACA;AACA;;AAEA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA,kCAAiC;AACjC;AACA;;AAEA;AACA;AACA,eAAc,QAAQ;AACtB;AACA;AACA;AACA,kDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,kBAAkB;AACjC;AACA;AACA,4CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,UAAU;AACxB,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,oBAAoB;AAC5C;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,QAAO;AACP;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,2BAA2B;AAClD;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,QAAO;AACP;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,4BAA4B;AACnD;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA,qCAAoC;AACpC,oCAAmC;AACnC,qCAAoC;AACpC,2CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,MAAM,OAAO;AAClC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,qBAAoB,oBAAoB;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,8BAA6B;AAC7B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,uCAAsC,KAAK,4BAA4B;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;;AAEA,wDAAuD;AACvD;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA,kCAAiC,KAAK,4BAA4B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,SAAQ;AACR;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc,YAAY;AAC1B,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,+BAA8B;AAC9B;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,sBAAqB;AACrB,uBAAsB;AACtB;AACA;AACA,QAAO;AACP,gBAAe;;AAEf,wBAAuB,UAAU;;AAEjC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,2CAA0C;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qDAAoD,cAAc,GAAG,MAAM;AAC3E,MAAK;;AAEL;;AAEA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB,aAAa;AAC/B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA,yBAAwB,yBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ,wGAAuG,EAAE,YAAY;AACrH;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA0E;AAC1E;AACA;AACA;AACA,qBAAoB;AACpB,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,uBAAuB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAc,UAAU;AACxB,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,yBAAyB;AAClD;AACA;AACA;AACA;AACA;AACA,yBAAwB,4BAA4B;AACpD;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,yBAAyB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,WAAW;AAC1B;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,WAAW;AAC1B;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,WAAW;AAC1B;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA,wBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,WAAW;AAC1B;AACA;AACA,sCAAqC;AACrC;AACA;AACA;AACA;AACA,wBAAuB,2BAA2B;AAClD;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB,eAAc,WAAW;AACzB,gBAAe,WAAW;AAC1B;AACA;AACA,6CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB,gBAAe,WAAW;AAC1B;AACA;AACA,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB,eAAc,WAAW;AACzB,gBAAe,WAAW;AAC1B;AACA;AACA,mDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB,eAAc,WAAW;AACzB,gBAAe,WAAW;AAC1B;AACA;AACA,kDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB,eAAc,UAAU;AACxB,gBAAe,IAAI;AACnB;AACA;AACA,wCAAuC;AACvC;AACA;AACA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA,4BAA2B,qBAAqB;AAChD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,IAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,IAAI;AAClB,gBAAe,IAAI;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,yBAAyB;AACjD;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD,GAAG;AACpD;AACA;AACA;AACA;AACA,0BAAyB,uBAAuB;AAChD;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA8B,sBAAsB;AACpD;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,SAAS;AACvB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,sBAAsB,GAAG;AACxD;AACA;AACA,qDAAoD;AACpD;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA,eAAc,WAAW;AACzB;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,UAAU;AACtB,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,wDAAuD;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,MAAK;AACL;AACA;AACA;AACA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,6BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,gCAA+B,6BAA6B;AAC5D;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,uCAAsC;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,4BAA2B,uBAAuB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,+BAA8B,6BAA6B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,uBAAsB,uBAAuB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ,YAAW;AACX;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;;AAEA,OAAM;AACN;AACA;;AAEA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;AACA;AACA;;AAEA;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;;AAEN;;AAEA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAqF;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,4CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;;AAEJ,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;;AAEA,KAAI;;AAEJ,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAM;;AAEN;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA,uBAAsB,iBAAiB;;AAEvC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAU;AACV;AACA;AACA;;AAEA;;AAEA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB,gBAAgB;AAClC,kCAAiC;AACjC;AACA;AACA,+DAA8D;AAC9D,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,kBAAiB;AACjB,mBAAkB,sBAAsB;AACxC;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,OAAO;;AAEzC;AACA,gBAAe;AACf,0BAAyB;AACzB;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,8CAA6C;AAC7C;AACA;AACA,qDAAoD,wBAAwB;AAC5E,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,8CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C;AAC5C;AACA;AACA,gBAAe;AACf;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA,sEAAqE;AACrE;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA,IAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,kCAAkC;AAC/E;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4GAA2G;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL,qBAAoB,eAAe;AACnC;AACA;AACA;AACA;AACA,yGAAwG;AACxG;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,QAAO;AACP;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,+BAA8B;AAC9B,iCAAgC;AAChC;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,sEAAqE,GAAG;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA,MAAK;AACL;AACA;AACA,6EAA4E;AAC5E;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA;AACA,eAAc;AACd,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAS;AACT;AACA;AACA,SAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,2CAA0C;AAC1C;;AAEA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC;AAChC,+DAA8D;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX,WAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,0BAAyB,cAAc;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,eAAc,OAAO;AACrB,eAAc,OAAO;AACrB,eAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,OAAO;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA,4BAA2B;AAC3B,MAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;;AAEA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;;AAEA;AACA;;AAEA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,SAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,UAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,cAAc,kDAAkD,EAAE;AAC7F;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,OAAO;AACnB,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAA+E;AAC/E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC,mBAAmB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,KAAI;AACJ;;AAEA;AACA;AACA;AACA,OAAM;;AAEN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA6B,cAAc,kBAAkB,kBAAkB,oBAAoB;AACnG;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC,cAAc;AACvD,MAAK;AACL;AACA;AACA,+EAA8E;AAC9E,OAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,aAAY;AACZ;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;;AAEA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA,cAAa;AACb;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;;AAEA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,QAAO;AACP;AACA,6EAA4E;;AAE5E;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,mDAAkD;AAClD;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C;AAC5C,OAAM;AACN;AACA;AACA,QAAO;AACP;AACA;;AAEA;;AAEA,MAAK;;AAEL,wCAAuC;AACvC,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA,WAAU;AACV;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,iFAAgF;AAChF;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;;AAEA;AACA,YAAW;AACX,iGAAgG;;AAEhG;AACA,WAAU;AACV,yFAAwF;;AAExF;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,QAAO;AACP,wFAAuF;AACvF;AACA;AACA;AACA;;AAEA,OAAM;AACN;;AAEA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAoB,oIAAoI,aAAa,sBAAsB,aAAa,aAAa;AACrN;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;AACA,MAAK;;AAEL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA,2CAA0C,cAAc,sBAAsB,0BAA0B,uBAAuB,UAAU;AACzI,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,yHAAwH;AACxH;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,uCAAsC;AACtC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,0BAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+KAA8K;AAC9K,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA,GAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+DAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sCAAqC,OAAO;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA6D;AAC7D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,SAAQ;AACR;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC;AACjC;AACA,gDAA+C,UAAU,WAAW,gBAAgB,aAAa,mBAAmB;AACpH;AACA;;AAEA;;AAEA;AACA;AACA,8EAA6E,qBAAqB;AAClG;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;;AAEA;;AAEA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;;AAEL;AACA;;AAEA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;;AAEA;;AAEA;AACA,yBAAwB,eAAe;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yBAAwB,iBAAiB;AACzC;AACA;;AAEA;AACA,iBAAgB,eAAe;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAgB,sBAAsB;AACtC;AACA;AACA;AACA;AACA;AACA,yBAAwB,iBAAiB;AACzC;AACA;AACA;;AAEA,4CAA2C;AAC3C,0BAAyB,2BAA2B;;AAEpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;;AAEJ,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D,OAAO;AACtE;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qDAAoD,8DAA8D;AAClH,0CAAyC,iBAAiB,uBAAuB,0BAA0B,4BAA4B;AACvI,MAAK;AACL,qBAAoB,QAAQ;AAC5B,0DAAyD,4EAA4E;AACrI;AACA,0CAAyC,iBAAiB,uBAAuB,0BAA0B,4BAA4B;AACvI;AACA;AACA;AACA,uDAAsD,kBAAkB;AACxE,uDAAsD,kBAAkB;AACxE,uDAAsD,kBAAkB;AACxE;AACA;AACA,uDAAsD,kBAAkB;AACxE,uDAAsD,kBAAkB;AACxE,uDAAsD,kBAAkB;AACxE;AACA;AACA,uDAAsD,kBAAkB;AACxE,uDAAsD,kBAAkB;AACxE,uDAAsD,kBAAkB;AACxE;AACA;AACA;AACA,uDAAsD,kBAAkB;AACxE;AACA;AACA,uDAAsD,kBAAkB;AACxE,uDAAsD,kBAAkB;AACxE;AACA;AACA,qDAAoD,kBAAkB;AACtE;AACA;AACA,qDAAoD,kBAAkB;AACtE;AACA;AACA,wCAAuC,eAAe;AACtD,wCAAuC,yDAAyD;AAChG,wCAAuC,6DAA6D;AACpG;AACA,iCAAgC,SAAS,SAAS,wCAAwC,GAAG,YAAY;AACzG,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAM;AACN;AACA;AACA,MAAK;;AAEL;;AAEA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA,wBAAuB,qBAAqB;AAC5C;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kFAAiF;AACjF;AACA;AACA,MAAK;AACL;;AAEA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC;AACxC;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;;AAEN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,UAAS;AACT;;AAEA;;AAEA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;;AAER;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,wEAAuE,mBAAmB;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,+BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA2E,sBAAsB;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD;AACjD;AACA,WAAU;AACV;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;;AAEN;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA8E,mBAAmB;AACjG;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;AACA,yBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;AACA;AACA,yBAAwB,gBAAgB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iDAAgD,YAAY,WAAW,YAAY,SAAS,UAAU,SAAS,gBAAgB;AAC/H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,4CAA2C,OAAO,MAAM,WAAW,YAAY,6CAA6C,eAAe;AAC3I,wEAAuE,OAAO,MAAM,WAAW,YAAY;AAC3G;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB,gBAAe,MAAM;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qDAAoD,cAAc,aAAa;;AAE/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAAyD;;AAEzD;AACA;AACA,QAAO;;AAEP;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,SAAQ;AACR,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,iDAAgD,OAAO;;AAEvD;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;;AAET,SAAQ;AACR,QAAO;AACP;AACA;AACA;AACA,SAAQ;;AAER;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,SAAQ;AACR;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;;AAEN,MAAK;AACL;;AAEA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;;AAEA;;AAEA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAQ;AACR;AACA;;AAEA,QAAO;AACP;AACA;AACA;;AAEA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yGAAwG,EAAE,aAAa;AACvH;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,+CAA8C,aAAa,2CAA2C,wBAAwB,WAAW,gBAAgB;AACzJ;AACA;AACA,OAAM;;AAEN,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA,iCAAgC,aAAa,yBAAyB,2CAA2C;;AAEjH;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA,2DAA0D,aAAa,kBAAkB,yBAAyB,YAAY,gCAAgC,6BAA6B,yBAAyB;AACpN,qCAAoC,kBAAkB,UAAU,WAAW,gBAAgB,cAAc,cAAc,0BAA0B,2DAA2D,iBAAiB,MAAM,gBAAgB,OAAO,kBAAkB,2DAA2D,gBAAgB,MAAM,gBAAgB,SAAS,kBAAkB,2DAA2D,iBAAiB,MAAM,gBAAgB,UAAU,kBAAkB,2DAA2D,gBAAgB,QAAQ,gBAAgB,OAAO,kBAAkB,2DAA2D,gBAAgB,QAAQ,gBAAgB,UAAU,kBAAkB,2DAA2D,iBAAiB,SAAS,gBAAgB,OAAO,kBAAkB,2DAA2D,gBAAgB,SAAS,gBAAgB,SAAS,kBAAkB,2DAA2D,iBAAiB,SAAS,gBAAgB,UAAU,kBAAkB;AAC/nC,MAAK;AACL;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,IAAG;AACH,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA,OAAM;;AAEN,MAAK;AACL;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,yMAAwM,uBAAuB,kCAAkC;AACjQ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+GAA8G;AAC9G;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB,eAAc,MAAM;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,SAAS;AACpD;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,eAAc,8EAA8E;AAC5F;AACA;;AAEA;;AAEA,mBAAkB;AAClB;AACA;AACA,mBAAkB;;AAElB;;AAEA;;AAEA;;AAEA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA,MAAK;;AAEL;;AAEA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;AACA,eAAc;AACd;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,yBAAwB,eAAe;AACvC;AACA,yBAAwB,qBAAqB;AAC7C;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,eAAe;AACvC;AACA,yBAAwB,qBAAqB;AAC7C;AACA;AACA,uBAAsB,gBAAgB;AACtC;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,kBAAkB;AACtC;AACA,+BAA8B,sBAAsB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,kBAAkB;AACtC;AACA,+BAA8B,sBAAsB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,SAAS;AAC/C;AACA;AACA;AACA,gCAA+B,sBAAsB;AACrD,sDAAqD,yBAAyB;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,aAAa;AAClC,uBAAsB,aAAa;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,aAAa;AAC5B,iBAAgB,aAAa;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,4BAA4B;AAChD;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,oBAAoB;AACtD;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,wBAAwB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA,gCAA+B,kBAAkB;AACjD,iCAAgC,kBAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qFAAoF,SAAS;AAC7F;AACA;AACA,OAAM;AACN,qDAAoD,SAAS;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,wBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe;AACf,2BAA0B,oBAAoB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB,oBAAoB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAW,oBAAoB;AAC/B;AACA;AACA,+CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL,YAAW,oBAAoB;AAC/B;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,oBAAoB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAgE,YAAY;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,oBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAgE,YAAY;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,mBAAmB;AAC7C;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;;AAEA;;AAEA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,qBAAoB,aAAa;AACjC;AACA,sBAAqB,aAAa;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2BAA0B;AAC1B;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,wCAAuC;AACvC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,yBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,gDAA+C;;AAE/C;AACA;AACA,oEAAmE;;AAEnE;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,+CAA8C;;AAE9C;AACA;AACA,kEAAiE;;AAEjE;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,wEAAuE,SAAS;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,wEAAuE,SAAS;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,4CAA2C,gCAAgC;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA,wEAAuE,SAAS;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,wEAAuE,SAAS;AAChF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,uCAAsC,2BAA2B;AACjE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,0BAAyB,UAAU;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,0BAAyB,UAAU;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAAyB,mBAAmB;AAC5C;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL,KAAI;AACJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;AACL;AACA;;AAEA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;;AAEjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,oCAAoC;AACxD,gFAA+E,kCAAkC;AACjH;AACA,YAAW,mBAAmB,yBAAyB,eAAe;AACtE,YAAW,kBAAkB,wBAAwB;AACrD,cAAa,uBAAuB,gBAAgB,YAAY,mBAAmB;AACnF,SAAQ,0BAA0B,0BAA0B;AAC5D,2BAA0B,sBAAsB;AAChD,uCAAsC,2BAA2B,EAAE,kCAAkC,2BAA2B,EAAE;AAClI,WAAU,SAAS,WAAW;;AAE9B;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,QAAO;AACP;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,0BAAyB,0BAA0B;AACnD;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,aAAa;AACtC;AACA;AACA,SAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,yBAAyB;AACnD;AACA,4BAA2B,YAAY;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,kBAAkB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,mDAAkD,cAAc;AAChE;AACA;AACA;AACA,oBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,yBAAyB;AACnD;AACA,4BAA2B,cAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,0BAAyB,yBAAyB;AAClD;AACA,2BAA0B,cAAc;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,QAAO;AACP;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL,KAAI;AACJ;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAAyD;AACzD;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA,0DAAyD;AACzD;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,SAAS;AAC5B;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;;AAEJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,0BAAyB,aAAa;AACtC;AACA;AACA;AACA,OAAM;AACN;AACA,KAAI;;AAEJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,aAAa;AACrC;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;;AAEA,KAAI;AACJ;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,YAAY,wFAAwF,mBAAmB,YAAY,2BAA2B,uBAAuB;AAC/N;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA,KAAI;AACJ;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,QAAO;;AAEP;;AAEA;;AAEA,QAAO;;AAEP;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,SAAQ;;AAER;;AAEA;;AAEA;;AAEA,SAAQ;;AAER,QAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B;;AAE7B;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;;AAEA,2CAA0C,SAAS;;AAEnD;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA,8BAA6B,gBAAgB;AAC7C;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,OAAM;;AAEN,MAAK;;AAEL;AACA;AACA,OAAM;;AAEN;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,mBAAmB;AAC5C;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,QAAO;;AAEP;;AAEA,OAAM;;AAEN;AACA;AACA;AACA,SAAQ;AACR;;AAEA;AACA;;AAEA,MAAK;;AAEL,KAAI;;AAEJ;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,4BAA2B,oBAAoB;;AAE/C;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,KAAI;;AAEJ;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,MAAK;AACL;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,wCAAuC;AACvC;;AAEA;AACA;;AAEA;;AAEA;;AAEA,6CAA4C;;AAE5C;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,kBAAkB,UAAU,SAAS,sBAAsB,gBAAgB,UAAU;AACvH,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,gFAAgF;AACpH,yCAAwC,mBAAmB,cAAc,sBAAsB,UAAU,SAAS,YAAY,WAAW;AACzI;AACA;AACA,mCAAkC,0BAA0B;AAC5D;AACA,yCAAwC,gBAAgB,mBAAmB,cAAc,sBAAsB,WAAW,SAAS,WAAW,WAAW;AACzJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,KAAI;;AAEJ;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,SAAS;AAC7C;AACA;AACA;AACA;AACA,IAAG;AACH,sCAAqC,SAAS;AAC9C;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,KAAI;AACJ;AACA,KAAI;AACJ;AACA;AACA;AACA,IAAG;AACH;AACA,wCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,wEAAuE,mBAAmB,6BAA6B,kCAAkC;AACzJ,oGAAmG;AACnG;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,mBAAmB;AAC5C;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,kBAAkB;AACtC;AACA;AACA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,0CAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,wCAAuC,sBAAsB;AAC7D;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY;AACZ;AACA;AACA,YAAW;AACX;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;;AAEA,OAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,SAAQ;AACR;;AAEA;;AAEA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA;;AAEA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA,IAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,wBAAuB,iBAAiB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,6BAA4B,qEAAqE;;AAEjG;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,yBAAwB,cAAc;AACtC;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,iBAAiB,6BAA6B,kBAAkB,kBAAkB,kBAAkB;AAC/H,KAAI;AACJ;AACA;AACA,4BAA2B,iBAAiB,6BAA6B,kBAAkB,gBAAgB,kBAAkB;AAC7H,KAAI;AACJ;AACA;AACA,4BAA2B,kBAAkB,iBAAiB,iBAAiB;AAC/E,KAAI;AACJ;AACA;AACA,4BAA2B,kBAAkB,iBAAiB,wBAAwB,iBAAiB;AACvG,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA,OAAM;;AAEN;AACA;AACA;AACA;AACA;AACA,0BAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA;;AAEA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,OAAM;;AAEN;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,iBAAiB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uBAAsB,gBAAgB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;;AAEA,kBAAiB,gBAAgB;AACjC;AACA,mBAAkB,gBAAgB;AAClC,4DAA2D;AAC3D;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,sDAAqD,aAAa,QAAQ,SAAS;AACnF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV,UAAS;AACT;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;;AAEA;AACA,QAAO;AACP,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sKAAqK,uBAAuB;AAC5L;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,mBAAmB;AACpD;AACA;AACA;AACA;AACA,iEAAgE,0JAA0J,IAAI,4HAA4H;AAC1V;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,8KAA6K,uBAAuB;AACpM;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;;AAEL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAQ;AACR;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;AACA;AACA,uBAAsB,qBAAqB,eAAe,gIAAgI,yBAAyB,gBAAgB,aAAa,aAAa;AAC7P,yBAAwB,qBAAqB,eAAe,kIAAkI,yBAAyB,iBAAiB,aAAa,YAAY;AACjQ,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA,KAAI;;AAEJ;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA,OAAM;AACN;AACA;;AAEA;AACA;;AAEA,MAAK;;AAEL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,QAAO;;AAEP,OAAM;;AAEN;;AAEA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA,4DAA2D;AAC3D;;AAEA,OAAM;AACN;;AAEA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA,MAAK;;AAEL,KAAI;AACJ;AACA;;AAEA;AACA,iDAAgD;AAChD;;AAEA,MAAK;;AAEL;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,yBAAwB,qBAAqB;;AAE7C;AACA;AACA;;AAEA;;AAEA,wBAAuB,qBAAqB;;AAE5C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,0BAAyB,qBAAqB;;AAE9C;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAkB,yBAAyB;AAC3C;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA,sBAAqB,oBAAoB;AACzC;AACA;AACA;AACA;AACA;AACA,UAAS;AACT,SAAQ;AACR;AACA;AACA;AACA;AACA;;AAEA;AACA,uBAAsB,oBAAoB;AAC1C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAQ;AACR;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA6C,SAAS;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB,yBAAyB;AAC/C;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,uBAAsB,uBAAuB;AAC7C;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA,uBAAsB,yBAAyB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+BAA8B,kBAAkB,mBAAmB,gBAAgB,SAAS,SAAS,UAAU,kBAAkB,MAAM,OAAO,wBAAwB,eAAe,kBAAkB,WAAW,eAAe;;AAEjO;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2GAA0G,QAAQ,SAAS,SAAS,SAAS,UAAU,kBAAkB;;AAEzK;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA,KAAI;;AAEJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAqB,qBAAqB,eAAe,gIAAgI,yBAAyB,iBAAiB,aAAa,aAAa;AAC7P,wBAAuB,qBAAqB,eAAe,kIAAkI,yBAAyB,iBAAiB,aAAa,YAAY;AAChQ,SAAQ;AACR;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA;AACA,gDAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB;AACA;AACA,kDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB;AACA;AACA;AACA,gDAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,SAAS;AACxB;AACA;AACA,2CAA0C,gBAAgB;AAC1D,gDAA+C,SAAS;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB,gBAAe,WAAW;AAC1B;AACA;AACA;AACA,oBAAmB;AACnB,SAAQ;AACR,gDAA+C,SAAS;AACxD;AACA;;AAEA;AACA;AACA;AACA;AACA,gBAAe,SAAS;AACxB;AACA;AACA,kDAAiD,SAAS;AAC1D;AACA;AACA;AACA;AACA,+CAA8C;AAC9C;AACA,QAAO,gCAAgC;AACvC;AACA;AACA,SAAQ;AACR;AACA;AACA,QAAO,gCAAgC;AACvC;AACA,QAAO,kCAAkC;AACzC;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,kBAAiB,qBAAqB;AACtC;AACA;AACA;AACA,6CAA4C;AAC5C,6CAA4C,mBAAmB;AAC/D,mCAAkC,eAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,KAAI;AACJ;;AAEA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,sBAAqB,+BAA+B;AACpD;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,OAAM;AACN;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,0BAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wFAAuF,mDAAmD;AAC1I,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,mBAAkB,sBAAsB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,0EAAyE;AACzE;AACA,yCAAwC,WAAW,OAAO,MAAM,8BAA8B;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,SAAQ;AACR;AACA;;AAEA;;AAEA;;AAEA,SAAQ;;AAER;;AAEA;;AAEA,QAAO;;AAEP,OAAM;;AAEN;AACA;;AAEA;;AAEA;;AAEA,QAAO;;AAEP;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;;AAEH,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sGAAqG;AACrG;AACA,gEAA+D,4CAA4C,0CAA0C,gDAAgD;AACrM,+CAA8C,gBAAgB,kBAAkB,WAAW;AAC3F;AACA,mBAAkB,mBAAmB;AACrC;AACA,6EAA4E,gBAAgB,kBAAkB,WAAW;AACzH;AACA,iDAAgD,+DAA+D;AAC/G;AACA,mDAAkD,kBAAkB;AACpE,6CAA4C;AAC5C,uDAAsD;;AAEtD,iCAAgC;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAiD;AACjD,kDAAiD;AACjD,gDAA+C;AAC/C,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA,yEAAwE;AACxE,oDAAmD;AACnD;AACA,2DAA0D;AAC1D,2DAA0D;AAC1D,yDAAwD;AACxD,uDAAsD;;AAEtD;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA8E,iBAAiB;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,yEAAwE,2CAA2C;AACnH;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,0GAAyG;AACzG;AACA;AACA;AACA,oEAAmE;AACnE;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,gBAAe;AACf;AACA;AACA;AACA;AACA;AACA,sCAAqC,iBAAiB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA,qDAAoD,2BAA2B;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;AACA,uBAAsB,mBAAmB;AACzC;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,wBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAM;;AAEN;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8CAA6C,qCAAqC;AAClF,uBAAsB,wCAAwC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,QAAO;AACP;;AAEA,OAAM;AACN;;AAEA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB,WAAW;;AAE9B;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA,KAAI;AACJ;AACA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA,8EAA6E,mDAAmD;AAChI;AACA;AACA,KAAI;AACJ;AACA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,QAAO;AACP,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAA+E;AAC/E;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA,oBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uFAAsF,iBAAiB;AACvG;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB,6BAA4B;AAC5B;AACA;AACA,OAAM;AACN;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA;AACA,qBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,KAAI;AACJ;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA,OAAM;;AAEN,MAAK;;AAEL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA,qBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,oFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA,qBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B;AAC3B,wBAAuB;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAA+C;AAC/C;AACA;AACA,wCAAuC;AACvC;AACA,oCAAmC;AACnC;AACA;AACA,wCAAuC;AACvC;AACA;AACA,gCAA+B;AAC/B,4BAA2B;AAC3B;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAAyB;;AAEzB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC;;AAExC;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,SAAQ;AACR;AACA;;AAEA;AACA;AACA,SAAQ;AACR;AACA,SAAQ;AACR;AACA;AACA,QAAO;AACP;AACA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL,KAAI;AACJ;AACA;AACA,8CAA6C,SAAS;AACtD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,0EAAyE;AACzE,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL,0BAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,iBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA2C,2BAA2B,yBAAyB;AAC/F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uCAAsC;;AAEtC;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,QAAO;AACP;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,2BAA0B,wBAAwB;AAClD;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,qBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA,oGAAmG,8BAA8B;AACjI;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,0BAAyB,sBAAsB;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;;AAEH;AACA;AACA,IAAG;;AAEH,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,yCAAwC,WAAW,OAAO,MAAM,8BAA8B;AAC9F;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;;AAEA;AACA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA,OAAM;AACN;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,sBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,wBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,OAAM;AACN;AACA,KAAI;AACJ;;AAEA;AACA,sBAAqB,sCAAsC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,mEAAkE;AAClE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV,UAAS,KAAK;;AAEd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,SAAQ;;AAER;AACA;AACA,OAAM;AACN;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA,KAAI;AACJ;AACA,+DAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;;AAEN,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAAyB,oBAAoB;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA,mCAAkC,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,0BAAyB,oBAAoB;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,qEAAoE;AACpE;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,eAAe;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA,yBAAwB,sBAAsB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA,mCAAkC,eAAe;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA,sBAAqB,uBAAuB;AAC5C;AACA;AACA;AACA;AACA,qCAAoC,eAAe;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,sBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gFAA+E;AAC/E,KAAI;AACJ;;AAEA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B;AAC3B;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;;AAEA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC;AACpC;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,MAAK;AACL;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN,0CAAyC,OAAO,0BAA0B,OAAO;AACjF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;;AAEA,OAAM;AACN;AACA;AACA;AACA;;AAEA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8JAA6J,MAAM,8GAA8G,MAAM,8GAA8G,MAAM;AAC3Y,kDAAiD;AACjD;AACA;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gLAA+K,MAAM;AACrL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4HAA2H,MAAM;AACjI,2HAA0H,MAAM;AAChI,6HAA4H,MAAM;AAClI,+HAA8H,MAAM;AACpI,0EAAyE;;AAEzE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAAyC;AACzC;AACA;AACA;AACA,0EAAyE;AACzE,sFAAqF;AACrF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,OAAM;AACN;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA,oBAAmB,qBAAqB;AACxC;AACA;AACA;AACA,OAAM;AACN,qBAAoB,oBAAoB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;;AAEA;;AAEA;AACA,QAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAwE;AACxE,mGAAkG;AAClG,qEAAoE;AACpE;AACA,4BAA2B,gBAAgB,WAAW;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,oBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA,KAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,QAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAI;AACJ;AACA;AACA;AACA,8CAA6C,kBAAkB,OAAO,mDAAmD,6BAA6B,+BAA+B;AACrL;AACA;AACA;AACA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA,yBAAwB,cAAc;AACtC,+FAA8F,iBAAiB,QAAQ,eAAe,EAAE;AACxI;AACA,wFAAuF,qEAAqE;;AAE5J,MAAK;AACL;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,oDAAmD,OAAO,SAAS,MAAM,yBAAyB,YAAY,0BAA0B,yCAAyC,2CAA2C;;AAE5N;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,OAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,oBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,EAAE;AACxC,kCAAiC,EAAE;AACnC;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,0BAAyB,iBAAiB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAkC,mBAAmB;AACrD;AACA,SAAQ;AACR,mCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","file":"editor.js","sourcesContent":["/*   使用示例  初始化已经集成至init.js\nvar ue = UE.getEditor('editor',{\n\t\ttoolbars:[[]]\n\t});\n*/\nvar ueditor = require(\"editor/index\");\n//var editorOpt = require(\"editor/pcInit\");\n\nvar test = require(\"./test\");\n\nvar ue = ueditor();\n\ntest.init(ue);\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/editor/index.js","/*TMODJS:{}*/\r\n!function () {\r\n\tfunction a(a, b) {\r\n\t\treturn (/string|function/.test(typeof b) ? h : g)(a, b)\r\n\t}\r\n\r\n\tfunction b(a, c) {\r\n\t\treturn \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a\r\n\t}\r\n\r\n\tfunction c(a) {\r\n\t\treturn l[a]\r\n\t}\r\n\r\n\tfunction d(a) {\r\n\t\treturn b(a).replace(/&(?![\\w#]+;)|[<>\"']/g, c)\r\n\t}\r\n\r\n\tfunction e(a, b) {\r\n\t\tif (m(a))for (var c = 0, d = a.length; d > c; c++)b.call(a, a[c], c, a); else for (c in a)b.call(a, a[c], c)\r\n\t}\r\n\r\n\tfunction f(a, b) {\r\n\t\tvar c = /(\\/)[^\\/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^\\/]+$/, \"\"), e = d + b;\r\n\t\tfor (e = e.replace(/\\/\\.\\//g, \"/\"); e.match(c);)e = e.replace(c, \"/\");\r\n\t\treturn e\r\n\t}\r\n\r\n\tfunction g(b, c) {\r\n\t\tvar d = a.get(b) || i({filename: b, name: \"Render Error\", message: \"Template not found\"});\r\n\t\treturn c ? d(c) : d\r\n\t}\r\n\r\n\tfunction h(a, b) {\r\n\t\tif (\"string\" == typeof b) {\r\n\t\t\tvar c = b;\r\n\t\t\tb = function () {\r\n\t\t\t\treturn new k(c)\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar d = j[a] = function (c) {\r\n\t\t\ttry {\r\n\t\t\t\treturn new b(c, a) + \"\"\r\n\t\t\t} catch (d) {\r\n\t\t\t\treturn i(d)()\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn d.prototype = b.prototype = n, d.toString = function () {\r\n\t\t\treturn b + \"\"\r\n\t\t}, d\r\n\t}\r\n\r\n\tfunction i(a) {\r\n\t\tvar b = \"{Template Error}\", c = a.stack || \"\";\r\n\t\tif (c)c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); else for (var d in a)c += \"<\" + d + \">\\n\" + a[d] + \"\\n\\n\";\r\n\t\treturn function () {\r\n\t\t\treturn \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b\r\n\t\t}\r\n\t}\r\n\r\n\tvar j = a.cache = {}, k = this.String, l = {\r\n\t\t\"<\": \"&#60;\",\r\n\t\t\">\": \"&#62;\",\r\n\t\t'\"': \"&#34;\",\r\n\t\t\"'\": \"&#39;\",\r\n\t\t\"&\": \"&#38;\"\r\n\t}, m = Array.isArray || function (a) {\r\n\t\t\treturn \"[object Array]\" === {}.toString.call(a)\r\n\t\t}, n = a.utils = {\r\n\t\t$helpers: {}, $include: function (a, b, c) {\r\n\t\t\treturn a = f(c, a), g(a, b)\r\n\t\t}, $string: b, $escape: d, $each: e\r\n\t}, o = a.helpers = n.$helpers;\r\n\ta.get = function (a) {\r\n\t\treturn j[a.replace(/^\\.\\//, \"\")]\r\n\t}, a.helper = function (a, b) {\r\n\t\to[a] = b\r\n\t}, module.exports = a\r\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js\n// module id = 34\n// module chunks = 0 1 2 3 4 5 7 9 13 15 16 20 21 22 26 27 29 30 32 34 35 38 43 44 45","var Dialog = require('dialog');\nvar noop = function() {};\n\nvar create = function(content, options) {\n    content = content || '';\n    options = options || {};\n    var defaults = {\n        fixed: true,\n        modal: true,\n        autofocus: false,\n        content: '<p class=\"del-pop-p\">' + content + '</p>',\n        className: 'pop-box',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        ok: noop\n    };\n    $.extend(true, defaults, options);\n    var d = Dialog(defaults);\n\n    var header = d._$('header');\n    var title = d._$('title');\n    if(!options.title){\n        title.css('borderBottom', 'none');\n    }\n    header.show();\n    d.show();\n    return d;\n};\n\nmodule.exports = create;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/alert.js","/*\r\n * 弹层提示弹窗\r\n * zhaodonghong\r\n */\r\n\r\n\r\n\r\nvar $publicMask;\r\nvar $publicTips;\r\nvar timer;\r\n\r\n\r\nvar events = function() {\r\n\r\n    $publicMask.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n\r\n    $publicTips.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * msg string 提示信息\r\n * options object \r\n * options.duration settimout消失时间\r\n * options.callback 提示消失的回调\r\n*/\r\nvar init = function(msg, options) {\r\n    var defaults = {\r\n        duration: 2000,\r\n        callback: function() {}\r\n    };\r\n\r\n    $.extend(defaults, options || {});\r\n\r\n    clearTimeout(timer);\r\n    $publicMask = $('[data-action=\"publicMask\"]');\r\n    $publicTips = $('[data-action=\"publicTips\"]');\r\n\r\n    if ($publicMask.length > 0) {\r\n\r\n        $publicMask.show();\r\n        $publicTips.show().text(msg);\r\n\r\n    } else {\r\n\r\n        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\r\n        $publicMask = $('[data-action=\"publicMask\"]');\r\n        $publicTips = $('[data-action=\"publicTips\"]');\r\n        events();\r\n    }\r\n\r\n    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\r\n\r\n    timer = setTimeout(function() {\r\n\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n\r\n        defaults.callback();\r\n\r\n    }, defaults.duration);\r\n};\r\n\r\n\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    events: events\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/hint.js","var imgPath = $_CONFIG.imgpath + '/images/emoji/';\n\nvar ext = '.png';\n\nvar groupOne = [{\n    name: '微笑',\n    url: 'weixiao'\n}, {\n    name: '色',\n    url: 'se'\n}, {\n    name: '亲亲',\n    url: 'qinqin'\n}, {\n    name: '得意',\n    url: 'deyi'\n}, {\n    name: '流泪',\n    url: 'liulei'\n}, {\n    name: '害羞',\n    url: 'haixiu'\n}, {\n    name: '闭嘴',\n    url: 'bizui'\n}, {\n    name: '鼓掌',\n    url: 'guzhang'\n}, {\n    name: '大哭',\n    url: 'daku'\n}, {\n    name: '尴尬',\n    url: 'ganga'\n}, {\n    name: '生气',\n    url: 'shengqi'\n}, {\n    name: '调皮',\n    url: 'tiaopi'\n}, {\n    name: '呲牙',\n    url: 'ciya'\n}, {\n    name: '惊讶',\n    url: 'jingya'\n}, {\n    name: '委屈',\n    url: 'weiqu'\n}, {\n    name: '吐血',\n    url: 'tuxue'\n}, {\n    name: '冷汗',\n    url: 'lenghan'\n}, {\n    name: '抓狂',\n    url: 'zhuakuang'\n}, {\n    name: '难过',\n    url: 'nanguo'\n}, {\n    name: '偷笑',\n    url: 'touxiao'\n}, {\n    name: '白眼',\n    url: 'baiyan'\n}, {\n    name: '不屑',\n    url: 'buxie'\n}, {\n    name: '快哭了',\n    url: 'kuaikule'\n}];\n\nvar groupTwo = [{\n    name: '困',\n    url: 'kun'\n}, {\n    name: '装酷',\n    url: 'zhuangku'\n}, {\n    name: '大笑',\n    url: 'daxiao'\n}, {\n    name: '偷瞄',\n    url: 'toumiao'\n}, {\n    name: '奋斗',\n    url: 'fendou'\n}, {\n    name: '咒骂',\n    url: 'zhouma'\n}, {\n    name: '疑问',\n    url: 'yiwen'\n}, {\n    name: '晕',\n    url: 'yun'\n}, {\n    name: '捶打',\n    url: 'chuida'\n}, {\n    name: '再见',\n    url: 'zaijian'\n}, {\n    name: '抠鼻',\n    url: 'koubi'\n}, {\n    name: '发呆',\n    url: 'fadai'\n}, {\n    name: '坏笑',\n    url: 'huaixiao'\n}, {\n    name: '哈欠',\n    url: 'haqian'\n}, {\n    name: '鄙视',\n    url: 'bishi'\n}, {\n    name: '睡觉',\n    url: 'shuijiao'\n}, {\n    name: '饿',\n    url: 'e'\n}, {\n    name: '阴险',\n    url: 'yinxian'\n}, {\n    name: '难受',\n    url: 'nanshou'\n}, {\n    name: '可怜',\n    url: 'kelian'\n}, {\n    name: '撇嘴',\n    url: 'piezui'\n}, {\n    name: '石化',\n    url: 'shihua'\n}, {\n    name: '泪眼',\n    url: 'leiyan'\n}];\n\nvar groupThree = [{\n    name: '嘘',\n    url: 'xu'\n}, {\n    name: '哼哼',\n    url: 'hengheng'\n}, {\n    name: '爱慕',\n    url: 'aimu'\n}, {\n    name: '财迷',\n    url: 'caimi'\n}, {\n    name: '耶',\n    url: 'ye'\n}, {\n    name: '思考',\n    url: 'sikao'\n}, {\n    name: '骷髅',\n    url: 'kulou'\n}, {\n    name: '痛哭',\n    url: 'tongku'\n}, {\n    name: '恭喜',\n    url: 'gongxi'\n}, {\n    name: '捂脸',\n    url: 'wulian'\n}, {\n    name: '嘿哈',\n    url: 'heiha'\n}, {\n    name: '机智',\n    url: 'jizhi'\n}, {\n    name: '皱眉',\n    url: 'zhoumei'\n}, {\n    name: '安慰',\n    url: 'anwei'\n}, {\n    name: '飞吻',\n    url: 'feiwen'\n}, {\n    name: '奸笑',\n    url: 'jianxiao'\n}, {\n    name: '猪头',\n    url: 'zhutou'\n}, {\n    name: '玫瑰',\n    url: 'meigui'\n}, {\n    name: '凋谢',\n    url: 'diaoxie'\n}, {\n    name: '爱心',\n    url: 'aixin'\n}, {\n    name: '心碎',\n    url: 'xinsui'\n}, {\n    name: '蛋糕',\n    url: 'dangao'\n}, {\n    name: '喝水',\n    url: 'heshui'\n}];\n\nvar groupFour = [{\n    name: '西瓜',\n    url: 'xigua'\n}, {\n    name: '咖啡',\n    url: 'kafei'\n}, {\n    name: '啤酒',\n    url: 'pijiu'\n}, {\n    name: '包包',\n    url: 'baobao'\n}, {\n    name: '高跟鞋',\n    url: 'gaogenxie'\n}, {\n    name: '帽子',\n    url: 'maozi'\n}, {\n    name: '口红',\n    url: 'kouhong'\n}, {\n    name: '裙子',\n    url: 'qunzi'\n}, {\n    name: 'T恤',\n    url: 'txu'\n}, {\n    name: '裤子',\n    url: 'kuzi'\n}, {\n    name: '眼镜',\n    url: 'yanjing'\n}, {\n    name: '太阳镜',\n    url: 'taiyangjing'\n}, {\n    name: '蜡烛',\n    url: 'lazhu'\n}, {\n    name: '礼物',\n    url: 'liwu'\n}, {\n    name: '红包',\n    url: 'hongbao'\n}, {\n    name: '拥抱',\n    url: 'yongbao'\n}, {\n    name: '太阳',\n    url: 'taiyang'\n}, {\n    name: '月亮',\n    url: 'yueliang'\n}, {\n    name: '便便',\n    url: 'bianbian'\n}, {\n    name: '炸弹',\n    url: 'zhadan'\n}, {\n    name: '菜刀',\n    url: 'caidao'\n}, {\n    name: '握手',\n    url: 'woshou'\n}, {\n    name: '胜利',\n    url: 'shengli'\n}];\n\nvar groupFive = [{\n    name: '赞',\n    url: 'zan'\n}, {\n    name: 'OK',\n    url: 'ok'\n}, {\n    name: '勾引',\n    url: 'gouyin'\n}, {\n    name: 'NO',\n    url: 'no'\n}, {\n    name: '打脸',\n    url: 'dalian'\n}, {\n    name: '抱拳',\n    url: 'baoquan'\n}, {\n    name: '乒乓球',\n    url: 'pingpangqiu'\n}, {\n    name: '足球',\n    url: 'zuqiu'\n}, {\n    name: '篮球',\n    url: 'lanqiu'\n}];\n\nvar format = function(arr) {\n    for (var i = 0, len = arr.length; i < len; i++) {\n        var emoji = arr[i];\n        emoji.url = imgPath + emoji.url + ext;\n    }\n    return arr;\n};\n\nmodule.exports = format(groupOne.concat(groupTwo, groupThree, groupFour, groupFive));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/emoji.js","var path = $_CONFIG.imgpath + '/images/emoji/';\nvar ext = '.png';\n\nvar backward = {\n    '亲': {\n        name: '亲亲',\n        url: path + 'qinqin' + ext\n    },\n    '愤怒': {\n        name: '生气',\n        url: path + 'shengqi' + ext\n    },\n    '惊恐': {\n        name: '惊讶',\n        url: path + 'jingya' + ext\n    },\n    '迷茫': {\n        name: '委屈',\n        url: path + 'weiqu' + ext\n    },\n    '伤心': {\n        name: '难过',\n        url: path + 'nanguo' + ext\n    },\n    '努力': {\n        name: '奋斗',\n        url: path + 'fendou' + ext\n    },\n    'YY': {\n        name: ' 坏笑',\n        url: path + 'huaixiao' + ext\n    },\n    '恶心': {\n        name: '难受',\n        url: path + 'nanshou' + ext\n    }\n};\n\nmodule.exports = backward;\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/backward.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/face/face',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,face=$data.face,$index=$data.$index,$escape=$utils.$escape,page=$data.page,$out='';$out+='<div data-node=\"faceBox\" class=\"imoj-box\" style=\"position: absolute;z-index: 9999;display:none\"> <em class=\"sanjiao\"></em> <div data-node=\"faceList\" class=\"imoj-list\"> ';\n$each(list,function(v,i){\n$out+=' <div class=\"imoj-content clearfix ';\nif(i){\n$out+='hide';\n}\n$out+='\"> ';\n$each(v,function(face,$index){\n$out+=' <a href=\"javascript:;\"> <img width=\"22\" height=\"22\" data-face=\"[';\n$out+=$escape(face.name);\n$out+=']\" src=\"';\n$out+=$escape(face.url);\n$out+='\" alt=\"';\n$out+=$escape(face.name);\n$out+='\" title=\"';\n$out+=$escape(face.name);\n$out+='\"> </a> ';\n});\n$out+=' </div> ';\n});\n$out+=' </div> <ul data-action=\"facePage\" class=\"pagination\"> ';\n$each(page,function(v,i){\n$out+=' <li ';\nif(i==0){\n$out+='class=\"active\"';\n}\n$out+='>';\n$out+=$escape(i+1);\n$out+='</li> ';\n});\n$out+=' </ul> </div>';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/face/face.tpl\n// module id = 76\n// module chunks = 2 5 15 20 21 29 30 32 44","/**\n * Created by dongyukuan on 2016/7/4.\n */\nvar inputTip = {\n    tel: {\n        ept: '请填写11位手机号',\n        err: '手机号格式错误',\n        errBack: '该手机号已被注册'\n    },\n    msgCode: {\n        tipGet: '请获取短信验证码',\n        tipEpt: '请输入短信验证码',\n        tipErr: '验证码是6位数字,请重新输入',\n        tipErrEdit: '验证码错误',\n        tipWrong: '验证码有误,请重新输入',\n        checkCodeWrong: '验证码输入错误,请重新输入',\n        send: '验证码已发送，请注意查收',\n        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n        tipDisabled: \"验证码再次获取需间隔60s\",\n        tipLimitEdit: '获取验证码超限，请稍后再试',\n        btnAfterSend: \"秒后重新获取\",\n        btnDefault: \"获取验证码\"\n    },\n    pwd: {\n        commonTip: '请输入6-20位英文字母,数字或符号'\n    },\n    pwdV: {\n        ept: '请再次输入密码',\n        err: '两次输入的密码不一致'\n    },\n    nickName: {\n        eptName: '请输入昵称！',\n        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n        existName: '此昵称太受欢迎了，已经有人抢了~',\n        sucSub: '资料修改成功！',\n        errLine: \"网络超时!\",\n        wrongName: '此昵称含有敏感词,请重新输入'\n    },\n    birthTip: {\n        tip: '生日不能重复设置'\n    },\n    refCode: {\n        err: '推荐码错误'\n    },\n    imgCode: {\n        ept: '请输入验证码',\n        err: '验证码输入错误，请重新输入'\n    },\n    login: {\n        errCode: '请输入验证码',\n        errNum: '请输入账号',\n        errPwd: '请输入密码',\n        agreement: '请同意协议并勾选'\n    },\n    createCircle: {\n        typeEmpty: '请选择圈子分类',\n        nameEmpty: '圈子名称不能为空',\n        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n    },\n    circle: {\n    \tlogin: '登录成功！',\n        unJoin: '需要先加入该圈子才能发布话题',\n        cannotJoin: '抱歉！该圈子不允许发布话题!',\n        review: '加入圈子审核中，请耐心等待!',\n        joinSuccess: '恭喜您已经加入圈子！',\n        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n        exit: '您已经退出该圈子！',\n        dissolved: '抱歉！该圈子已被解散'\n    },\n    qrCodeTip: {\n        loseEffTip: '二维码已失效',\n        loseEffBtn: '点击刷新',\n        failGetTip: '二维码生成失败',\n        failGetBtn: '重新生成'\n    },\n    masterApply: {\n        nameLength: '姓名要2-20个字符',\n        nameType: '姓名仅限汉字和字母',\n        isIdCard: '请填写18位有效身份证号',\n        type: '请选择达人类别',\n        summary: '请输入自我介绍，2-100个字符'\n    },\n    upload: {\n        noUpload: '请上传图片',\n        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        uploadFaild: '上传失败,请重新上传',\n        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n        Q_TYPE_DENIED: '文件类型错误',\n        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n        excess: '文件个数超出限制'\n    },\n    errLine: {\n        tip: '网络错误,请稍后再试！'\n    }\n};\nmodule.exports = inputTip;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/i18n.js","/*! WebUploader 0.1.5 */\n\n\n/**\n * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n *\n * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n */\n(function( root, factory ) {\n    var modules = {},\n\n        // 内部require, 简单不完全实现。\n        // https://github.com/amdjs/amdjs-api/wiki/require\n        _require = function( deps, callback ) {\n            var args, len, i;\n\n            // 如果deps不是数组，则直接返回指定module\n            if ( typeof deps === 'string' ) {\n                return getModule( deps );\n            } else {\n                args = [];\n                for( len = deps.length, i = 0; i < len; i++ ) {\n                    args.push( getModule( deps[ i ] ) );\n                }\n\n                return callback.apply( null, args );\n            }\n        },\n\n        // 内部define，暂时不支持不指定id.\n        _define = function( id, deps, factory ) {\n            if ( arguments.length === 2 ) {\n                factory = deps;\n                deps = null;\n            }\n\n            _require( deps || [], function() {\n                setModule( id, factory, arguments );\n            });\n        },\n\n        // 设置module, 兼容CommonJs写法。\n        setModule = function( id, factory, args ) {\n            var module = {\n                    exports: factory\n                },\n                returned;\n\n            if ( typeof factory === 'function' ) {\n                args.length || (args = [ _require, module.exports, module ,window.jQuery]);\n                returned = factory.apply( null, args );\n                returned !== undefined && (module.exports = returned);\n            }\n\n            modules[ id ] = module.exports;\n        },\n\n        // 根据id获取module\n        getModule = function( id ) {\n            var module = modules[ id ] || root[ id ];\n\n            if ( !module ) {\n                throw new Error( '`' + id + '` is undefined' );\n            }\n\n            return module;\n        },\n\n        // 将所有modules，将路径ids装换成对象。\n        exportsTo = function( obj ) {\n            var key, host, parts, part, last, ucFirst;\n\n            // make the first character upper case.\n            ucFirst = function( str ) {\n                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n            };\n\n            for ( key in modules ) {\n                host = obj;\n\n                if ( !modules.hasOwnProperty( key ) ) {\n                    continue;\n                }\n\n                parts = key.split('/');\n                last = ucFirst( parts.pop() );\n\n                while( (part = ucFirst( parts.shift() )) ) {\n                    host[ part ] = host[ part ] || {};\n                    host = host[ part ];\n                }\n\n                host[ last ] = modules[ key ];\n            }\n\n            return obj;\n        },\n\n        makeExport = function( dollar ) {\n            root.__dollar = dollar;\n\n            // exports every module.\n            return exportsTo( factory( root, _define, _require,window.jQuery ) );\n        },\n\n        origin;\n\n    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\n        // For CommonJS and CommonJS-like environments where a proper window is present,\n        module.exports = makeExport();\n    } else if ( typeof define === 'function' && define.amd ) {\n\n        // Allow using this built library as an AMD module\n        // in another project. That other project will only\n        // see this AMD call, not the internal modules in\n        // the closure below.\n        define([ 'jquery' ], makeExport );\n    } else {\n\n        // Browser globals case. Just assign the\n        // result to a property on the global.\n        origin = root.WebUploader;\n        root.WebUploader = makeExport();\n        root.WebUploader.noConflict = function() {\n            root.WebUploader = origin;\n        };\n    }\n})( window, function( window, define, require ,jQuery ) {\n\n\n    /**\n     * @fileOverview jQuery or Zepto\n     */\n    define('dollar-third',[],function() {\n        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n    \n        if ( !$ ) {\n            throw new Error('jQuery or Zepto not found!');\n        }\n    \n        return $;\n    });\n    /**\n     * @fileOverview Dom 操作相关\n     */\n    define('dollar',[\n        'dollar-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 使用jQuery的Promise\n     */\n    define('promise-third',[\n        'dollar'\n    ], function( $ ) {\n        return {\n            Deferred: $.Deferred,\n            when: $.when,\n    \n            isPromise: function( anything ) {\n                return anything && typeof anything.then === 'function';\n            }\n        };\n    });\n    /**\n     * @fileOverview Promise/A+\n     */\n    define('promise',[\n        'promise-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 基础类方法。\n     */\n    \n    /**\n     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n     *\n     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n     *\n     * * module `base`：WebUploader.Base\n     * * module `file`: WebUploader.File\n     * * module `lib/dnd`: WebUploader.Lib.Dnd\n     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n     *\n     *\n     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n     * @module WebUploader\n     * @title WebUploader API文档\n     */\n    define('base',[\n        'dollar',\n        'promise'\n    ], function( $, promise ) {\n    \n        var noop = function() {},\n            call = Function.call;\n    \n        // http://jsperf.com/uncurrythis\n        // 反科里化\n        function uncurryThis( fn ) {\n            return function() {\n                return call.apply( fn, arguments );\n            };\n        }\n    \n        function bindFn( fn, context ) {\n            return function() {\n                return fn.apply( context, arguments );\n            };\n        }\n    \n        function createObject( proto ) {\n            var f;\n    \n            if ( Object.create ) {\n                return Object.create( proto );\n            } else {\n                f = function() {};\n                f.prototype = proto;\n                return new f();\n            }\n        }\n    \n    \n        /**\n         * 基础类，提供一些简单常用的方法。\n         * @class Base\n         */\n        return {\n    \n            /**\n             * @property {String} version 当前版本号。\n             */\n            version: '0.1.5',\n    \n            /**\n             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n             */\n            $: $,\n    \n            Deferred: promise.Deferred,\n    \n            isPromise: promise.isPromise,\n    \n            when: promise.when,\n    \n            /**\n             * @description  简单的浏览器检查结果。\n             *\n             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n             *\n             * @property {Object} [browser]\n             */\n            browser: (function( ua ) {\n                var ret = {},\n                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n                        ua.match( /CriOS\\/([\\d.]+)/ ),\n    \n                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n    \n                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n    \n                return ret;\n            })( navigator.userAgent ),\n    \n            /**\n             * @description  操作系统检查结果。\n             *\n             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n             * @property {Object} [os]\n             */\n            os: (function( ua ) {\n                var ret = {},\n    \n                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n    \n                // osx && (ret.osx = true);\n                android && (ret.android = parseFloat( android[ 1 ] ));\n                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n    \n                return ret;\n            })( navigator.userAgent ),\n    \n            /**\n             * 实现类与类之间的继承。\n             * @method inherits\n             * @grammar Base.inherits( super ) => child\n             * @grammar Base.inherits( super, protos ) => child\n             * @grammar Base.inherits( super, protos, statics ) => child\n             * @param  {Class} super 父类\n             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n             * @param  {Object} [statics] 静态属性或方法。\n             * @return {Class} 返回子类。\n             * @example\n             * function Person() {\n             *     console.log( 'Super' );\n             * }\n             * Person.prototype.hello = function() {\n             *     console.log( 'hello' );\n             * };\n             *\n             * var Manager = Base.inherits( Person, {\n             *     world: function() {\n             *         console.log( 'World' );\n             *     }\n             * });\n             *\n             * // 因为没有指定构造器，父类的构造器将会执行。\n             * var instance = new Manager();    // => Super\n             *\n             * // 继承子父类的方法\n             * instance.hello();    // => hello\n             * instance.world();    // => World\n             *\n             * // 子类的__super__属性指向父类\n             * console.log( Manager.__super__ === Person );    // => true\n             */\n            inherits: function( Super, protos, staticProtos ) {\n                var child;\n    \n                if ( typeof protos === 'function' ) {\n                    child = protos;\n                    protos = null;\n                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n                    child = protos.constructor;\n                } else {\n                    child = function() {\n                        return Super.apply( this, arguments );\n                    };\n                }\n    \n                // 复制静态方法\n                $.extend( true, child, Super, staticProtos || {} );\n    \n                /* jshint camelcase: false */\n    \n                // 让子类的__super__属性指向父类。\n                child.__super__ = Super.prototype;\n    \n                // 构建原型，添加原型方法或属性。\n                // 暂时用Object.create实现。\n                child.prototype = createObject( Super.prototype );\n                protos && $.extend( true, child.prototype, protos );\n    \n                return child;\n            },\n    \n            /**\n             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n             * @method noop\n             */\n            noop: noop,\n    \n            /**\n             * 返回一个新的方法，此方法将已指定的`context`来执行。\n             * @grammar Base.bindFn( fn, context ) => Function\n             * @method bindFn\n             * @example\n             * var doSomething = function() {\n             *         console.log( this.name );\n             *     },\n             *     obj = {\n             *         name: 'Object Name'\n             *     },\n             *     aliasFn = Base.bind( doSomething, obj );\n             *\n             *  aliasFn();    // => Object Name\n             *\n             */\n            bindFn: bindFn,\n    \n            /**\n             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n             * @grammar Base.log( args... ) => undefined\n             * @method log\n             */\n            log: (function() {\n                if ( window.console ) {\n                    return bindFn( console.log, console );\n                }\n                return noop;\n            })(),\n    \n            nextTick: (function() {\n    \n                return function( cb ) {\n                    setTimeout( cb, 1 );\n                };\n    \n                // @bug 当浏览器不在当前窗口时就停了。\n                // var next = window.requestAnimationFrame ||\n                //     window.webkitRequestAnimationFrame ||\n                //     window.mozRequestAnimationFrame ||\n                //     function( cb ) {\n                //         window.setTimeout( cb, 1000 / 60 );\n                //     };\n    \n                // // fix: Uncaught TypeError: Illegal invocation\n                // return bindFn( next, window );\n            })(),\n    \n            /**\n             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n             * 将用来将非数组对象转化成数组对象。\n             * @grammar Base.slice( target, start[, end] ) => Array\n             * @method slice\n             * @example\n             * function doSomthing() {\n             *     var args = Base.slice( arguments, 1 );\n             *     console.log( args );\n             * }\n             *\n             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n             */\n            slice: uncurryThis( [].slice ),\n    \n            /**\n             * 生成唯一的ID\n             * @method guid\n             * @grammar Base.guid() => String\n             * @grammar Base.guid( prefx ) => String\n             */\n            guid: (function() {\n                var counter = 0;\n    \n                return function( prefix ) {\n                    var guid = (+new Date()).toString( 32 ),\n                        i = 0;\n    \n                    for ( ; i < 5; i++ ) {\n                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n                    }\n    \n                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n                };\n            })(),\n    \n            /**\n             * 格式化文件大小, 输出成带单位的字符串\n             * @method formatSize\n             * @grammar Base.formatSize( size ) => String\n             * @grammar Base.formatSize( size, pointLength ) => String\n             * @grammar Base.formatSize( size, pointLength, units ) => String\n             * @param {Number} size 文件大小\n             * @param {Number} [pointLength=2] 精确到的小数点数。\n             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n             * @example\n             * console.log( Base.formatSize( 100 ) );    // => 100B\n             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n             */\n            formatSize: function( size, pointLength, units ) {\n                var unit;\n    \n                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n    \n                while ( (unit = units.shift()) && size > 1024 ) {\n                    size = size / 1024;\n                }\n    \n                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n                        unit;\n            }\n        };\n    });\n    /**\n     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n     * @fileOverview Mediator\n     */\n    define('mediator',[\n        'base'\n    ], function( Base ) {\n        var $ = Base.$,\n            slice = [].slice,\n            separator = /\\s+/,\n            protos;\n    \n        // 根据条件过滤出事件handlers.\n        function findHandlers( arr, name, callback, context ) {\n            return $.grep( arr, function( handler ) {\n                return handler &&\n                        (!name || handler.e === name) &&\n                        (!callback || handler.cb === callback ||\n                        handler.cb._cb === callback) &&\n                        (!context || handler.ctx === context);\n            });\n        }\n    \n        function eachEvent( events, callback, iterator ) {\n            // 不支持对象，只支持多个event用空格隔开\n            $.each( (events || '').split( separator ), function( _, key ) {\n                iterator( key, callback );\n            });\n        }\n    \n        function triggerHanders( events, args ) {\n            var stoped = false,\n                i = -1,\n                len = events.length,\n                handler;\n    \n            while ( ++i < len ) {\n                handler = events[ i ];\n    \n                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n                    stoped = true;\n                    break;\n                }\n            }\n    \n            return !stoped;\n        }\n    \n        protos = {\n    \n            /**\n             * 绑定事件。\n             *\n             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n             * ```javascript\n             * var obj = {};\n             *\n             * // 使得obj有事件行为\n             * Mediator.installTo( obj );\n             *\n             * obj.on( 'testa', function( arg1, arg2 ) {\n             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n             * });\n             *\n             * obj.trigger( 'testa', 'arg1', 'arg2' );\n             * ```\n             *\n             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n             * 切会影响到`trigger`方法的返回值，为`false`。\n             *\n             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n             * ```javascript\n             * obj.on( 'all', function( type, arg1, arg2 ) {\n             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n             * });\n             * ```\n             *\n             * @method on\n             * @grammar on( name, callback[, context] ) => self\n             * @param  {String}   name     事件名，支持多个事件用空格隔开\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             * @class Mediator\n             */\n            on: function( name, callback, context ) {\n                var me = this,\n                    set;\n    \n                if ( !callback ) {\n                    return this;\n                }\n    \n                set = this._events || (this._events = []);\n    \n                eachEvent( name, callback, function( name, callback ) {\n                    var handler = { e: name };\n    \n                    handler.cb = callback;\n                    handler.ctx = context;\n                    handler.ctx2 = context || me;\n                    handler.id = set.length;\n    \n                    set.push( handler );\n                });\n    \n                return this;\n            },\n    \n            /**\n             * 绑定事件，且当handler执行完后，自动解除绑定。\n             * @method once\n             * @grammar once( name, callback[, context] ) => self\n             * @param  {String}   name     事件名\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            once: function( name, callback, context ) {\n                var me = this;\n    \n                if ( !callback ) {\n                    return me;\n                }\n    \n                eachEvent( name, callback, function( name, callback ) {\n                    var once = function() {\n                            me.off( name, once );\n                            return callback.apply( context || me, arguments );\n                        };\n    \n                    once._cb = callback;\n                    me.on( name, once, context );\n                });\n    \n                return me;\n            },\n    \n            /**\n             * 解除事件绑定\n             * @method off\n             * @grammar off( [name[, callback[, context] ] ] ) => self\n             * @param  {String}   [name]     事件名\n             * @param  {Function} [callback] 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            off: function( name, cb, ctx ) {\n                var events = this._events;\n    \n                if ( !events ) {\n                    return this;\n                }\n    \n                if ( !name && !cb && !ctx ) {\n                    this._events = [];\n                    return this;\n                }\n    \n                eachEvent( name, cb, function( name, cb ) {\n                    $.each( findHandlers( events, name, cb, ctx ), function() {\n                        delete events[ this.id ];\n                    });\n                });\n    \n                return this;\n            },\n    \n            /**\n             * 触发事件\n             * @method trigger\n             * @grammar trigger( name[, args...] ) => self\n             * @param  {String}   type     事件名\n             * @param  {*} [...] 任意参数\n             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n             */\n            trigger: function( type ) {\n                var args, events, allEvents;\n    \n                if ( !this._events || !type ) {\n                    return this;\n                }\n    \n                args = slice.call( arguments, 1 );\n                events = findHandlers( this._events, type );\n                allEvents = findHandlers( this._events, 'all' );\n    \n                return triggerHanders( events, args ) &&\n                        triggerHanders( allEvents, arguments );\n            }\n        };\n    \n        /**\n         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n         *\n         * @class Mediator\n         */\n        return $.extend({\n    \n            /**\n             * 可以通过这个接口，使任何对象具备事件功能。\n             * @method installTo\n             * @param  {Object} obj 需要具备事件行为的对象。\n             * @return {Object} 返回obj.\n             */\n            installTo: function( obj ) {\n                return $.extend( obj, protos );\n            }\n    \n        }, protos );\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('uploader',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n    \n        var $ = Base.$;\n    \n        /**\n         * 上传入口类。\n         * @class Uploader\n         * @constructor\n         * @grammar new Uploader( opts ) => Uploader\n         * @example\n         * var uploader = WebUploader.Uploader({\n         *     swf: 'path_of_swf/Uploader.swf',\n         *\n         *     // 开起分片上传。\n         *     chunked: true\n         * });\n         */\n        function Uploader( opts ) {\n            this.options = $.extend( true, {}, Uploader.options, opts );\n            this._init( this.options );\n        }\n    \n        // default Options\n        // widgets中有相应扩展\n        Uploader.options = {};\n        Mediator.installTo( Uploader.prototype );\n    \n        // 批量添加纯命令式方法。\n        $.each({\n            upload: 'start-upload',\n            stop: 'stop-upload',\n            getFile: 'get-file',\n            getFiles: 'get-files',\n            addFile: 'add-file',\n            addFiles: 'add-file',\n            sort: 'sort-files',\n            removeFile: 'remove-file',\n            cancelFile: 'cancel-file',\n            skipFile: 'skip-file',\n            retry: 'retry',\n            isInProgress: 'is-in-progress',\n            makeThumb: 'make-thumb',\n            md5File: 'md5-file',\n            getDimension: 'get-dimension',\n            addButton: 'add-btn',\n            predictRuntimeType: 'predict-runtime-type',\n            refresh: 'refresh',\n            disable: 'disable',\n            enable: 'enable',\n            reset: 'reset'\n        }, function( fn, command ) {\n            Uploader.prototype[ fn ] = function() {\n                return this.request( command, arguments );\n            };\n        });\n    \n        $.extend( Uploader.prototype, {\n            state: 'pending',\n    \n            _init: function( opts ) {\n                var me = this;\n    \n                me.request( 'init', opts, function() {\n                    me.state = 'ready';\n                    me.trigger('ready');\n                });\n            },\n    \n            /**\n             * 获取或者设置Uploader配置项。\n             * @method option\n             * @grammar option( key ) => *\n             * @grammar option( key, val ) => self\n             * @example\n             *\n             * // 初始状态图片上传前不会压缩\n             * var uploader = new WebUploader.Uploader({\n             *     compress: null;\n             * });\n             *\n             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n             * uploader.option( 'compress', {\n             *     width: 1600,\n             *     height: 1600\n             * });\n             */\n            option: function( key, val ) {\n                var opts = this.options;\n    \n                // setter\n                if ( arguments.length > 1 ) {\n    \n                    if ( $.isPlainObject( val ) &&\n                            $.isPlainObject( opts[ key ] ) ) {\n                        $.extend( opts[ key ], val );\n                    } else {\n                        opts[ key ] = val;\n                    }\n    \n                } else {    // getter\n                    return key ? opts[ key ] : opts;\n                }\n            },\n    \n            /**\n             * 获取文件统计信息。返回一个包含一下信息的对象。\n             * * `successNum` 上传成功的文件数\n             * * `progressNum` 上传中的文件数\n             * * `cancelNum` 被删除的文件数\n             * * `invalidNum` 无效的文件数\n             * * `uploadFailNum` 上传失败的文件数\n             * * `queueNum` 还在队列中的文件数\n             * * `interruptNum` 被暂停的文件数\n             * @method getStats\n             * @grammar getStats() => Object\n             */\n            getStats: function() {\n                // return this._mgr.getStats.apply( this._mgr, arguments );\n                var stats = this.request('get-stats');\n    \n                return stats ? {\n                    successNum: stats.numOfSuccess,\n                    progressNum: stats.numOfProgress,\n    \n                    // who care?\n                    // queueFailNum: 0,\n                    cancelNum: stats.numOfCancel,\n                    invalidNum: stats.numOfInvalid,\n                    uploadFailNum: stats.numOfUploadFailed,\n                    queueNum: stats.numOfQueue,\n                    interruptNum: stats.numofInterrupt\n                } : {};\n            },\n    \n            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n            trigger: function( type/*, args...*/ ) {\n                var args = [].slice.call( arguments, 1 ),\n                    opts = this.options,\n                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n                        type.substring( 1 );\n    \n                if (\n                        // 调用通过on方法注册的handler.\n                        Mediator.trigger.apply( this, arguments ) === false ||\n    \n                        // 调用opts.onEvent\n                        $.isFunction( opts[ name ] ) &&\n                        opts[ name ].apply( this, args ) === false ||\n    \n                        // 调用this.onEvent\n                        $.isFunction( this[ name ] ) &&\n                        this[ name ].apply( this, args ) === false ||\n    \n                        // 广播所有uploader的事件。\n                        Mediator.trigger.apply( Mediator,\n                        [ this, type ].concat( args ) ) === false ) {\n    \n                    return false;\n                }\n    \n                return true;\n            },\n    \n            /**\n             * 销毁 webuploader 实例\n             * @method destroy\n             * @grammar destroy() => undefined\n             */\n            destroy: function() {\n                this.request( 'destroy', arguments );\n                this.off();\n            },\n    \n            // widgets/widget.js将补充此方法的详细文档。\n            request: Base.noop\n        });\n    \n        /**\n         * 创建Uploader实例，等同于new Uploader( opts );\n         * @method create\n         * @class Base\n         * @static\n         * @grammar Base.create( opts ) => Uploader\n         */\n        Base.create = Uploader.create = function( opts ) {\n            return new Uploader( opts );\n        };\n    \n        // 暴露Uploader，可以通过它来扩展业务逻辑。\n        Base.Uploader = Uploader;\n    \n        return Uploader;\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/runtime',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n    \n        var $ = Base.$,\n            factories = {},\n    \n            // 获取对象的第一个key\n            getFirstKey = function( obj ) {\n                for ( var key in obj ) {\n                    if ( obj.hasOwnProperty( key ) ) {\n                        return key;\n                    }\n                }\n                return null;\n            };\n    \n        // 接口类。\n        function Runtime( options ) {\n            this.options = $.extend({\n                container: document.body\n            }, options );\n            this.uid = Base.guid('rt_');\n        }\n    \n        $.extend( Runtime.prototype, {\n    \n            getContainer: function() {\n                var opts = this.options,\n                    parent, container;\n    \n                if ( this._container ) {\n                    return this._container;\n                }\n    \n                parent = $( opts.container || document.body );\n                container = $( document.createElement('div') );\n    \n                container.attr( 'id', 'rt_' + this.uid );\n                container.css({\n                    position: 'absolute',\n                    top: '0px',\n                    left: '0px',\n                    width: '1px',\n                    height: '1px',\n                    overflow: 'hidden'\n                });\n    \n                parent.append( container );\n                parent.addClass('webuploader-container');\n                this._container = container;\n                this._parent = parent;\n                return container;\n            },\n    \n            init: Base.noop,\n            exec: Base.noop,\n    \n            destroy: function() {\n                this._container && this._container.remove();\n                this._parent && this._parent.removeClass('webuploader-container');\n                this.off();\n            }\n        });\n    \n        Runtime.orders = 'html5,flash';\n    \n    \n        /**\n         * 添加Runtime实现。\n         * @param {String} type    类型\n         * @param {Runtime} factory 具体Runtime实现。\n         */\n        Runtime.addRuntime = function( type, factory ) {\n            factories[ type ] = factory;\n        };\n    \n        Runtime.hasRuntime = function( type ) {\n            return !!(type ? factories[ type ] : getFirstKey( factories ));\n        };\n    \n        Runtime.create = function( opts, orders ) {\n            var type, runtime;\n    \n            orders = orders || Runtime.orders;\n            $.each( orders.split( /\\s*,\\s*/g ), function() {\n                if ( factories[ this ] ) {\n                    type = this;\n                    return false;\n                }\n            });\n    \n            type = type || getFirstKey( factories );\n            if ( !type ) {\n                throw new Error('Runtime Error');\n            }\n    \n            runtime = new factories[ type ]( opts );\n            return runtime;\n        };\n    \n        Mediator.installTo( Runtime.prototype );\n        return Runtime;\n    });\n    \n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/client',[\n        'base',\n        'mediator',\n        'runtime/runtime'\n    ], function( Base, Mediator, Runtime ) {\n    \n        var cache;\n    \n        cache = (function() {\n            var obj = {};\n    \n            return {\n                add: function( runtime ) {\n                    obj[ runtime.uid ] = runtime;\n                },\n    \n                get: function( ruid, standalone ) {\n                    var i;\n    \n                    if ( ruid ) {\n                        return obj[ ruid ];\n                    }\n    \n                    for ( i in obj ) {\n                        // 有些类型不能重用，比如filepicker.\n                        if ( standalone && obj[ i ].__standalone ) {\n                            continue;\n                        }\n    \n                        return obj[ i ];\n                    }\n    \n                    return null;\n                },\n    \n                remove: function( runtime ) {\n                    delete obj[ runtime.uid ];\n                }\n            };\n        })();\n    \n        function RuntimeClient( component, standalone ) {\n            var deferred = Base.Deferred(),\n                runtime;\n    \n            this.uid = Base.guid('client_');\n    \n            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n            this.runtimeReady = function( cb ) {\n                return deferred.done( cb );\n            };\n    \n            this.connectRuntime = function( opts, cb ) {\n    \n                // already connected.\n                if ( runtime ) {\n                    throw new Error('already connected!');\n                }\n    \n                deferred.done( cb );\n    \n                if ( typeof opts === 'string' && cache.get( opts ) ) {\n                    runtime = cache.get( opts );\n                }\n    \n                // 像filePicker只能独立存在，不能公用。\n                runtime = runtime || cache.get( null, standalone );\n    \n                // 需要创建\n                if ( !runtime ) {\n                    runtime = Runtime.create( opts, opts.runtimeOrder );\n                    runtime.__promise = deferred.promise();\n                    runtime.once( 'ready', deferred.resolve );\n                    runtime.init();\n                    cache.add( runtime );\n                    runtime.__client = 1;\n                } else {\n                    // 来自cache\n                    Base.$.extend( runtime.options, opts );\n                    runtime.__promise.then( deferred.resolve );\n                    runtime.__client++;\n                }\n    \n                standalone && (runtime.__standalone = standalone);\n                return runtime;\n            };\n    \n            this.getRuntime = function() {\n                return runtime;\n            };\n    \n            this.disconnectRuntime = function() {\n                if ( !runtime ) {\n                    return;\n                }\n    \n                runtime.__client--;\n    \n                if ( runtime.__client <= 0 ) {\n                    cache.remove( runtime );\n                    delete runtime.__promise;\n                    runtime.destroy();\n                }\n    \n                runtime = null;\n            };\n    \n            this.exec = function() {\n                if ( !runtime ) {\n                    return;\n                }\n    \n                var args = Base.slice( arguments );\n                component && args.unshift( component );\n    \n                return runtime.exec.apply( this, args );\n            };\n    \n            this.getRuid = function() {\n                return runtime && runtime.uid;\n            };\n    \n            this.destroy = (function( destroy ) {\n                return function() {\n                    destroy && destroy.apply( this, arguments );\n                    this.trigger('destroy');\n                    this.off();\n                    this.exec('destroy');\n                    this.disconnectRuntime();\n                };\n            })( this.destroy );\n        }\n    \n        Mediator.installTo( RuntimeClient.prototype );\n        return RuntimeClient;\n    });\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/dnd',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n    \n        var $ = Base.$;\n    \n        function DragAndDrop( opts ) {\n            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n    \n            opts.container = $( opts.container );\n    \n            if ( !opts.container.length ) {\n                return;\n            }\n    \n            RuntimeClent.call( this, 'DragAndDrop' );\n        }\n    \n        DragAndDrop.options = {\n            accept: null,\n            disableGlobalDnd: false\n        };\n    \n        Base.inherits( RuntimeClent, {\n            constructor: DragAndDrop,\n    \n            init: function() {\n                var me = this;\n    \n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n    \n        Mediator.installTo( DragAndDrop.prototype );\n    \n        return DragAndDrop;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/widget',[\n        'base',\n        'uploader'\n    ], function( Base, Uploader ) {\n    \n        var $ = Base.$,\n            _init = Uploader.prototype._init,\n            _destroy = Uploader.prototype.destroy,\n            IGNORE = {},\n            widgetClass = [];\n    \n        function isArrayLike( obj ) {\n            if ( !obj ) {\n                return false;\n            }\n    \n            var length = obj.length,\n                type = $.type( obj );\n    \n            if ( obj.nodeType === 1 && length ) {\n                return true;\n            }\n    \n            return type === 'array' || type !== 'function' && type !== 'string' &&\n                    (length === 0 || typeof length === 'number' && length > 0 &&\n                    (length - 1) in obj);\n        }\n    \n        function Widget( uploader ) {\n            this.owner = uploader;\n            this.options = uploader.options;\n        }\n    \n        $.extend( Widget.prototype, {\n    \n            init: Base.noop,\n    \n            // 类Backbone的事件监听声明，监听uploader实例上的事件\n            // widget直接无法监听事件，事件只能通过uploader来传递\n            invoke: function( apiName, args ) {\n    \n                /*\n                    {\n                        'make-thumb': 'makeThumb'\n                    }\n                 */\n                var map = this.responseMap;\n    \n                // 如果无API响应声明则忽略\n                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n    \n                    return IGNORE;\n                }\n    \n                return this[ map[ apiName ] ].apply( this, args );\n    \n            },\n    \n            /**\n             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n             * @method request\n             * @grammar request( command, args ) => * | Promise\n             * @grammar request( command, args, callback ) => Promise\n             * @for  Uploader\n             */\n            request: function() {\n                return this.owner.request.apply( this.owner, arguments );\n            }\n        });\n    \n        // 扩展Uploader.\n        $.extend( Uploader.prototype, {\n    \n            /**\n             * @property {String | Array} [disableWidgets=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n             */\n    \n            // 覆写_init用来初始化widgets\n            _init: function() {\n                var me = this,\n                    widgets = me._widgets = [],\n                    deactives = me.options.disableWidgets || '';\n    \n                $.each( widgetClass, function( _, klass ) {\n                    (!deactives || !~deactives.indexOf( klass._name )) &&\n                        widgets.push( new klass( me ) );\n                });\n    \n                return _init.apply( me, arguments );\n            },\n    \n            request: function( apiName, args, callback ) {\n                var i = 0,\n                    widgets = this._widgets,\n                    len = widgets && widgets.length,\n                    rlts = [],\n                    dfds = [],\n                    widget, rlt, promise, key;\n    \n                args = isArrayLike( args ) ? args : [ args ];\n    \n                for ( ; i < len; i++ ) {\n                    widget = widgets[ i ];\n                    rlt = widget.invoke( apiName, args );\n    \n                    if ( rlt !== IGNORE ) {\n    \n                        // Deferred对象\n                        if ( Base.isPromise( rlt ) ) {\n                            dfds.push( rlt );\n                        } else {\n                            rlts.push( rlt );\n                        }\n                    }\n                }\n    \n                // 如果有callback，则用异步方式。\n                if ( callback || dfds.length ) {\n                    promise = Base.when.apply( Base, dfds );\n                    key = promise.pipe ? 'pipe' : 'then';\n    \n                    // 很重要不能删除。删除了会死循环。\n                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n                    return promise[ key ](function() {\n                                var deferred = Base.Deferred(),\n                                    args = arguments;\n    \n                                if ( args.length === 1 ) {\n                                    args = args[ 0 ];\n                                }\n    \n                                setTimeout(function() {\n                                    deferred.resolve( args );\n                                }, 1 );\n    \n                                return deferred.promise();\n                            })[ callback ? key : 'done' ]( callback || Base.noop );\n                } else {\n                    return rlts[ 0 ];\n                }\n            },\n    \n            destroy: function() {\n                _destroy.apply( this, arguments );\n                this._widgets = null;\n            }\n        });\n    \n        /**\n         * 添加组件\n         * @grammar Uploader.register(proto);\n         * @grammar Uploader.register(map, proto);\n         * @param  {object} responseMap API 名称与函数实现的映射\n         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n         * @method Uploader.register\n         * @for Uploader\n         * @example\n         * Uploader.register({\n         *     'make-thumb': 'makeThumb'\n         * }, {\n         *     init: function( options ) {},\n         *     makeThumb: function() {}\n         * });\n         *\n         * Uploader.register({\n         *     'make-thumb': function() {\n         *         \n         *     }\n         * });\n         */\n        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n                klass;\n    \n            if ( arguments.length === 1 ) {\n                widgetProto = responseMap;\n    \n                // 自动生成 map 表。\n                $.each(widgetProto, function(key) {\n                    if ( key[0] === '_' || key === 'name' ) {\n                        key === 'name' && (map.name = widgetProto.name);\n                        return;\n                    }\n    \n                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n                });\n    \n            } else {\n                map = $.extend( map, responseMap );\n            }\n    \n            widgetProto.responseMap = map;\n            klass = Base.inherits( Widget, widgetProto );\n            klass._name = map.name;\n            widgetClass.push( klass );\n    \n            return klass;\n        };\n    \n        /**\n         * 删除插件，只有在注册时指定了名字的才能被删除。\n         * @grammar Uploader.unRegister(name);\n         * @param  {string} name 组件名字\n         * @method Uploader.unRegister\n         * @for Uploader\n         * @example\n         *\n         * Uploader.register({\n         *     name: 'custom',\n         *     \n         *     'make-thumb': function() {\n         *         \n         *     }\n         * });\n         *\n         * Uploader.unRegister('custom');\n         */\n        Uploader.unRegister = Widget.unRegister = function( name ) {\n            if ( !name || name === 'anonymous' ) {\n                return;\n            }\n            \n            // 删除指定的插件。\n            for ( var i = widgetClass.length; i--; ) {\n                if ( widgetClass[i]._name === name ) {\n                    widgetClass.splice(i, 1)\n                }\n            }\n        };\n    \n        return Widget;\n    });\n    /**\n     * @fileOverview DragAndDrop Widget。\n     */\n    define('widgets/filednd',[\n        'base',\n        'uploader',\n        'lib/dnd',\n        'widgets/widget'\n    ], function( Base, Uploader, Dnd ) {\n        var $ = Base.$;\n    \n        Uploader.options.dnd = '';\n    \n        /**\n         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n         * @namespace options\n         * @for Uploader\n         */\n        \n        /**\n         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n         * @namespace options\n         * @for Uploader\n         */\n    \n        /**\n         * @event dndAccept\n         * @param {DataTransferItemList} items DataTransferItem\n         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n         * @for  Uploader\n         */\n        return Uploader.register({\n            name: 'dnd',\n            \n            init: function( opts ) {\n    \n                if ( !opts.dnd ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n    \n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        disableGlobalDnd: opts.disableGlobalDnd,\n                        container: opts.dnd,\n                        accept: opts.accept\n                    }),\n                    dnd;\n    \n                this.dnd = dnd = new Dnd( options );\n    \n                dnd.once( 'ready', deferred.resolve );\n                dnd.on( 'drop', function( files ) {\n                    me.request( 'add-file', [ files ]);\n                });\n    \n                // 检测文件是否全部允许添加。\n                dnd.on( 'accept', function( items ) {\n                    return me.owner.trigger( 'dndAccept', items );\n                });\n    \n                dnd.init();\n    \n                return deferred.promise();\n            },\n    \n            destroy: function() {\n                this.dnd && this.dnd.destroy();\n            }\n        });\n    });\n    \n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepaste',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n    \n        var $ = Base.$;\n    \n        function FilePaste( opts ) {\n            opts = this.options = $.extend({}, opts );\n            opts.container = $( opts.container || document.body );\n            RuntimeClent.call( this, 'FilePaste' );\n        }\n    \n        Base.inherits( RuntimeClent, {\n            constructor: FilePaste,\n    \n            init: function() {\n                var me = this;\n    \n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n    \n        Mediator.installTo( FilePaste.prototype );\n    \n        return FilePaste;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/filepaste',[\n        'base',\n        'uploader',\n        'lib/filepaste',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePaste ) {\n        var $ = Base.$;\n    \n        /**\n         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n         * @namespace options\n         * @for Uploader\n         */\n        return Uploader.register({\n            name: 'paste',\n            \n            init: function( opts ) {\n    \n                if ( !opts.paste ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n    \n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        container: opts.paste,\n                        accept: opts.accept\n                    }),\n                    paste;\n    \n                this.paste = paste = new FilePaste( options );\n    \n                paste.once( 'ready', deferred.resolve );\n                paste.on( 'paste', function( files ) {\n                    me.owner.request( 'add-file', [ files ]);\n                });\n                paste.init();\n    \n                return deferred.promise();\n            },\n    \n            destroy: function() {\n                this.paste && this.paste.destroy();\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob\n     */\n    define('lib/blob',[\n        'base',\n        'runtime/client'\n    ], function( Base, RuntimeClient ) {\n    \n        function Blob( ruid, source ) {\n            var me = this;\n    \n            me.source = source;\n            me.ruid = ruid;\n            this.size = source.size || 0;\n    \n            // 如果没有指定 mimetype, 但是知道文件后缀。\n            if ( !source.type && this.ext &&\n                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n            } else {\n                this.type = source.type || 'application/octet-stream';\n            }\n    \n            RuntimeClient.call( me, 'Blob' );\n            this.uid = source.uid || this.uid;\n    \n            if ( ruid ) {\n                me.connectRuntime( ruid );\n            }\n        }\n    \n        Base.inherits( RuntimeClient, {\n            constructor: Blob,\n    \n            slice: function( start, end ) {\n                return this.exec( 'slice', start, end );\n            },\n    \n            getSource: function() {\n                return this.source;\n            }\n        });\n    \n        return Blob;\n    });\n    /**\n     * 为了统一化Flash的File和HTML5的File而存在。\n     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n     * @fileOverview File\n     */\n    define('lib/file',[\n        'base',\n        'lib/blob'\n    ], function( Base, Blob ) {\n    \n        var uid = 1,\n            rExt = /\\.([^.]+)$/;\n    \n        function File( ruid, file ) {\n            var ext;\n    \n            this.name = file.name || ('untitled' + uid++);\n            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n    \n            // todo 支持其他类型文件的转换。\n            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n            if ( !ext && file.type ) {\n                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n                        RegExp.$1.toLowerCase() : '';\n                this.name += '.' + ext;\n            }\n    \n            this.ext = ext;\n            this.lastModifiedDate = file.lastModifiedDate ||\n                    (new Date()).toLocaleString();\n    \n            Blob.apply( this, arguments );\n        }\n    \n        return Base.inherits( Blob, File );\n    });\n    \n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepicker',[\n        'base',\n        'runtime/client',\n        'lib/file'\n    ], function( Base, RuntimeClent, File ) {\n    \n        var $ = Base.$;\n    \n        function FilePicker( opts ) {\n            opts = this.options = $.extend({}, FilePicker.options, opts );\n    \n            opts.container = $( opts.id );\n    \n            if ( !opts.container.length ) {\n                throw new Error('按钮指定错误');\n            }\n    \n            opts.innerHTML = opts.innerHTML || opts.label ||\n                    opts.container.html() || '';\n    \n            opts.button = $( opts.button || document.createElement('div') );\n            opts.button.html( opts.innerHTML );\n            opts.container.html( opts.button );\n    \n            RuntimeClent.call( this, 'FilePicker', true );\n        }\n    \n        FilePicker.options = {\n            button: null,\n            container: null,\n            label: null,\n            innerHTML: null,\n            multiple: true,\n            accept: null,\n            name: 'file'\n        };\n    \n        Base.inherits( RuntimeClent, {\n            constructor: FilePicker,\n    \n            init: function() {\n                var me = this,\n                    opts = me.options,\n                    button = opts.button;\n    \n                button.addClass('webuploader-pick');\n    \n                me.on( 'all', function( type ) {\n                    var files;\n    \n                    switch ( type ) {\n                        case 'mouseenter':\n                            button.addClass('webuploader-pick-hover');\n                            break;\n    \n                        case 'mouseleave':\n                            button.removeClass('webuploader-pick-hover');\n                            break;\n    \n                        case 'change':\n                            files = me.exec('getFiles');\n                            me.trigger( 'select', $.map( files, function( file ) {\n                                file = new File( me.getRuid(), file );\n    \n                                // 记录来源。\n                                file._refer = opts.container;\n                                return file;\n                            }), opts.container );\n                            break;\n                    }\n                });\n    \n                me.connectRuntime( opts, function() {\n                    me.refresh();\n                    me.exec( 'init', opts );\n                    me.trigger('ready');\n                });\n    \n                this._resizeHandler = Base.bindFn( this.refresh, this );\n                $( window ).on( 'resize', this._resizeHandler );\n            },\n    \n            refresh: function() {\n                var shimContainer = this.getRuntime().getContainer(),\n                    button = this.options.button,\n                    width = button.outerWidth ?\n                            button.outerWidth() : button.width(),\n    \n                    height = button.outerHeight ?\n                            button.outerHeight() : button.height(),\n    \n                    pos = button.offset();\n    \n                width && height && shimContainer.css({\n                    bottom: 'auto',\n                    right: 'auto',\n                    width: width + 'px',\n                    height: height + 'px'\n                }).offset( pos );\n            },\n    \n            enable: function() {\n                var btn = this.options.button;\n    \n                btn.removeClass('webuploader-pick-disable');\n                this.refresh();\n            },\n    \n            disable: function() {\n                var btn = this.options.button;\n    \n                this.getRuntime().getContainer().css({\n                    top: '-99999px'\n                });\n    \n                btn.addClass('webuploader-pick-disable');\n            },\n    \n            destroy: function() {\n                var btn = this.options.button;\n                $( window ).off( 'resize', this._resizeHandler );\n                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n                    'webuploader-pick');\n            }\n        });\n    \n        return FilePicker;\n    });\n    \n    /**\n     * @fileOverview 文件选择相关\n     */\n    define('widgets/filepicker',[\n        'base',\n        'uploader',\n        'lib/filepicker',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePicker ) {\n        var $ = Base.$;\n    \n        $.extend( Uploader.options, {\n    \n            /**\n             * @property {Selector | Object} [pick=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n             *\n             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n             * * `label` {String} 请采用 `innerHTML` 代替\n             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n             */\n            pick: null,\n    \n            /**\n             * @property {Arroy} [accept=null]\n             * @namespace options\n             * @for Uploader\n             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n             *\n             * * `title` {String} 文字描述\n             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n             * * `mimeTypes` {String} 多个用逗号分割。\n             *\n             * 如：\n             *\n             * ```\n             * {\n             *     title: 'Images',\n             *     extensions: 'gif,jpg,jpeg,bmp,png',\n             *     mimeTypes: 'image/*'\n             * }\n             * ```\n             */\n            accept: null/*{\n                title: 'Images',\n                extensions: 'gif,jpg,jpeg,bmp,png',\n                mimeTypes: 'image/*'\n            }*/\n        });\n    \n        return Uploader.register({\n            name: 'picker',\n    \n            init: function( opts ) {\n                this.pickers = [];\n                return opts.pick && this.addBtn( opts.pick );\n            },\n    \n            refresh: function() {\n                $.each( this.pickers, function() {\n                    this.refresh();\n                });\n            },\n    \n            /**\n             * @method addButton\n             * @for Uploader\n             * @grammar addButton( pick ) => Promise\n             * @description\n             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n             * @example\n             * uploader.addButton({\n             *     id: '#btnContainer',\n             *     innerHTML: '选择文件'\n             * });\n             */\n            addBtn: function( pick ) {\n                var me = this,\n                    opts = me.options,\n                    accept = opts.accept,\n                    promises = [];\n    \n                if ( !pick ) {\n                    return;\n                }\n    \n                $.isPlainObject( pick ) || (pick = {\n                    id: pick\n                });\n    \n                $( pick.id ).each(function() {\n                    var options, picker, deferred;\n    \n                    deferred = Base.Deferred();\n    \n                    options = $.extend({}, pick, {\n                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n                        swf: opts.swf,\n                        runtimeOrder: opts.runtimeOrder,\n                        id: this\n                    });\n    \n                    picker = new FilePicker( options );\n    \n                    picker.once( 'ready', deferred.resolve );\n                    picker.on( 'select', function( files ) {\n                        me.owner.request( 'add-file', [ files ]);\n                    });\n                    picker.init();\n    \n                    me.pickers.push( picker );\n    \n                    promises.push( deferred.promise() );\n                });\n    \n                return Base.when.apply( Base, promises );\n            },\n    \n            disable: function() {\n                $.each( this.pickers, function() {\n                    this.disable();\n                });\n            },\n    \n            enable: function() {\n                $.each( this.pickers, function() {\n                    this.enable();\n                });\n            },\n    \n            destroy: function() {\n                $.each( this.pickers, function() {\n                    this.destroy();\n                });\n                this.pickers = null;\n            }\n        });\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('lib/image',[\n        'base',\n        'runtime/client',\n        'lib/blob'\n    ], function( Base, RuntimeClient, Blob ) {\n        var $ = Base.$;\n    \n        // 构造器。\n        function Image( opts ) {\n            this.options = $.extend({}, Image.options, opts );\n            RuntimeClient.call( this, 'Image' );\n    \n            this.on( 'load', function() {\n                this._info = this.exec('info');\n                this._meta = this.exec('meta');\n            });\n        }\n    \n        // 默认选项。\n        Image.options = {\n    \n            // 默认的图片处理质量\n            quality: 90,\n    \n            // 是否裁剪\n            crop: false,\n    \n            // 是否保留头部信息\n            preserveHeaders: false,\n    \n            // 是否允许放大。\n            allowMagnify: false\n        };\n    \n        // 继承RuntimeClient.\n        Base.inherits( RuntimeClient, {\n            constructor: Image,\n    \n            info: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n    \n                // getter\n                return this._info;\n            },\n    \n            meta: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n    \n                // getter\n                return this._meta;\n            },\n    \n            loadFromBlob: function( blob ) {\n                var me = this,\n                    ruid = blob.getRuid();\n    \n                this.connectRuntime( ruid, function() {\n                    me.exec( 'init', me.options );\n                    me.exec( 'loadFromBlob', blob );\n                });\n            },\n    \n            resize: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n            },\n    \n            crop: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n            },\n    \n            getAsDataUrl: function( type ) {\n                return this.exec( 'getAsDataUrl', type );\n            },\n    \n            getAsBlob: function( type ) {\n                var blob = this.exec( 'getAsBlob', type );\n    \n                return new Blob( this.getRuid(), blob );\n            }\n        });\n    \n        return Image;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/image',[\n        'base',\n        'uploader',\n        'lib/image',\n        'widgets/widget'\n    ], function( Base, Uploader, Image ) {\n    \n        var $ = Base.$,\n            throttle;\n    \n        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n        throttle = (function( max ) {\n            var occupied = 0,\n                waiting = [],\n                tick = function() {\n                    var item;\n    \n                    while ( waiting.length && occupied < max ) {\n                        item = waiting.shift();\n                        occupied += item[ 0 ];\n                        item[ 1 ]();\n                    }\n                };\n    \n            return function( emiter, size, cb ) {\n                waiting.push([ size, cb ]);\n                emiter.once( 'destroy', function() {\n                    occupied -= size;\n                    setTimeout( tick, 1 );\n                });\n                setTimeout( tick, 1 );\n            };\n        })( 5 * 1024 * 1024 );\n    \n        $.extend( Uploader.options, {\n    \n            /**\n             * @property {Object} [thumb]\n             * @namespace options\n             * @for Uploader\n             * @description 配置生成缩略图的选项。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 110,\n             *     height: 110,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 70,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: true,\n             *\n             *     // 是否允许裁剪。\n             *     crop: true,\n             *\n             *     // 为空的话则保留原有图片格式。\n             *     // 否则强制转换成指定的类型。\n             *     type: 'image/jpeg'\n             * }\n             * ```\n             */\n            thumb: {\n                width: 110,\n                height: 110,\n                quality: 70,\n                allowMagnify: true,\n                crop: true,\n                preserveHeaders: false,\n    \n                // 为空的话则保留原有图片格式。\n                // 否则强制转换成指定的类型。\n                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n                type: 'image/jpeg'\n            },\n    \n            /**\n             * @property {Object} [compress]\n             * @namespace options\n             * @for Uploader\n             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 1600,\n             *     height: 1600,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 90,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: false,\n             *\n             *     // 是否允许裁剪。\n             *     crop: false,\n             *\n             *     // 是否保留头部meta信息。\n             *     preserveHeaders: true,\n             *\n             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n             *     // 此属性可能会影响图片自动纠正功能\n             *     noCompressIfLarger: false,\n             *\n             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n             *     compressSize: 0\n             * }\n             * ```\n             */\n            compress: {\n                width: 1600,\n                height: 1600,\n                quality: 90,\n                allowMagnify: false,\n                crop: false,\n                preserveHeaders: true\n            }\n        });\n    \n        return Uploader.register({\n    \n            name: 'image',\n    \n    \n            /**\n             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n             *\n             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n             *\n             * `callback`中可以接收到两个参数。\n             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n             * * 第二个为ret, 缩略图的Data URL值。\n             *\n             * **注意**\n             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n             *\n             * @method makeThumb\n             * @grammar makeThumb( file, callback ) => undefined\n             * @grammar makeThumb( file, callback, width, height ) => undefined\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.makeThumb( file, function( error, ret ) {\n             *         if ( error ) {\n             *             $li.text('预览错误');\n             *         } else {\n             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n             *         }\n             *     });\n             *\n             * });\n             */\n            makeThumb: function( file, cb, width, height ) {\n                var opts, image;\n                var isArtwork = false;\n                file = this.request( 'get-file', file );\n    \n                // 只预览图片格式。\n                if ( !file.type.match( /^image/ ) ) {\n                    cb( true );\n                    return;\n                }\n    \n                opts = $.extend({}, this.options.thumb );\n                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n                // 如果传入的是object.\n                if ( $.isPlainObject( width ) ) {\n                    opts = $.extend( opts, width );\n                    width = null;\n                }\n    \n                width = width || opts.width;\n                height = height || opts.height;\n    \n                image = new Image( opts );\n    \n                image.once( 'load', function() {\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n    \n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n    \n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n                    if( isArtwork ){\n                        image.resize( file._info.width, file._info.height );\n                        \n                    }else{\n                        image.resize( width, height );\n                        \n                       \n                    }\n\n                });\n    \n                // 当 resize 完后\n                image.once( 'complete', function() {\n                    cb( false, image.getAsDataUrl( opts.type ) );\n                    image.destroy();\n                });\n    \n                image.once( 'error', function( reason ) {\n                    cb( reason || true );\n                    image.destroy();\n                });\n    \n                throttle( image, file.source.size, function() {\n                    file._info && image.info( file._info );\n                    file._meta && image.meta( file._meta );\n                    image.loadFromBlob( file.source );\n                });\n            },\n    \n            beforeSendFile: function( file ) {\n                var opts = this.options.compress || this.options.resize,\n                    compressSize = opts && opts.compressSize || 0,\n                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n                    image, deferred;\n    \n                file = this.request( 'get-file', file );\n    \n                // 只压缩 jpeg 图片格式。\n                // gif 可能会丢失针\n                // bmp png 基本上尺寸都不大，且压缩比比较小。\n                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n                        file.size < compressSize ||\n                        file._compressed ) {\n                    return;\n                }\n    \n                opts = $.extend({}, opts );\n                deferred = Base.Deferred();\n    \n                image = new Image( opts );\n    \n                deferred.always(function() {\n                    image.destroy();\n                    image = null;\n                });\n                image.once( 'error', deferred.reject );\n                image.once( 'load', function() {\n                    var width = opts.width,\n                        height = opts.height;\n    \n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n    \n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n    \n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n    \n                    image.resize( width, height );\n                });\n    \n                image.once( 'complete', function() {\n                    var blob, size;\n    \n                    // 移动端 UC / qq 浏览器的无图模式下\n                    // ctx.getImageData 处理大图的时候会报 Exception\n                    // INDEX_SIZE_ERR: DOM Exception 1\n                    try {\n                        blob = image.getAsBlob( opts.type );\n    \n                        size = file.size;\n    \n                        // 如果压缩后，比原来还大则不用压缩后的。\n                        if ( !noCompressIfLarger || blob.size < size ) {\n                            // file.source.destroy && file.source.destroy();\n                            file.source = blob;\n                            file.size = blob.size;\n    \n                            file.trigger( 'resize', blob.size, size );\n                        }\n    \n                        // 标记，避免重复压缩。\n                        file._compressed = true;\n                        deferred.resolve();\n                    } catch ( e ) {\n                        // 出错了直接继续，让其上传原始图片\n                        deferred.resolve();\n                    }\n                });\n    \n                file._info && image.info( file._info );\n                file._meta && image.meta( file._meta );\n    \n                image.loadFromBlob( file.source );\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview 文件属性封装\n     */\n    define('file',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n    \n        var $ = Base.$,\n            idPrefix = 'WU_FILE_',\n            idSuffix = 0,\n            rExt = /\\.([^.]+)$/,\n            statusMap = {};\n    \n        function gid() {\n            return idPrefix + idSuffix++;\n        }\n    \n        /**\n         * 文件类\n         * @class File\n         * @constructor 构造函数\n         * @grammar new File( source ) => File\n         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n         */\n        function WUFile( source ) {\n    \n            /**\n             * 文件名，包括扩展名（后缀）\n             * @property name\n             * @type {string}\n             */\n            this.name = source.name || 'Untitled';\n    \n            /**\n             * 文件体积（字节）\n             * @property size\n             * @type {uint}\n             * @default 0\n             */\n            this.size = source.size || 0;\n    \n            /**\n             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n             * @property type\n             * @type {string}\n             * @default 'application/octet-stream'\n             */\n            this.type = source.type || 'application/octet-stream';\n    \n            /**\n             * 文件最后修改日期\n             * @property lastModifiedDate\n             * @type {int}\n             * @default 当前时间戳\n             */\n            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n    \n            /**\n             * 文件ID，每个对象具有唯一ID，与文件名无关\n             * @property id\n             * @type {string}\n             */\n            this.id = gid();\n    \n            /**\n             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n             * @property ext\n             * @type {string}\n             */\n            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n    \n    \n            /**\n             * 状态文字说明。在不同的status语境下有不同的用途。\n             * @property statusText\n             * @type {string}\n             */\n            this.statusText = '';\n    \n            // 存储文件状态，防止通过属性直接修改\n            statusMap[ this.id ] = WUFile.Status.INITED;\n    \n            this.source = source;\n            this.loaded = 0;\n    \n            this.on( 'error', function( msg ) {\n                this.setStatus( WUFile.Status.ERROR, msg );\n            });\n        }\n    \n        $.extend( WUFile.prototype, {\n    \n            /**\n             * 设置状态，状态变化时会触发`change`事件。\n             * @method setStatus\n             * @grammar setStatus( status[, statusText] );\n             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n             */\n            setStatus: function( status, text ) {\n    \n                var prevStatus = statusMap[ this.id ];\n    \n                typeof text !== 'undefined' && (this.statusText = text);\n    \n                if ( status !== prevStatus ) {\n                    statusMap[ this.id ] = status;\n                    /**\n                     * 文件状态变化\n                     * @event statuschange\n                     */\n                    this.trigger( 'statuschange', status, prevStatus );\n                }\n    \n            },\n    \n            /**\n             * 获取文件状态\n             * @return {File.Status}\n             * @example\n                     文件状态具体包括以下几种类型：\n                     {\n                         // 初始化\n                        INITED:     0,\n                        // 已入队列\n                        QUEUED:     1,\n                        // 正在上传\n                        PROGRESS:     2,\n                        // 上传出错\n                        ERROR:         3,\n                        // 上传成功\n                        COMPLETE:     4,\n                        // 上传取消\n                        CANCELLED:     5\n                    }\n             */\n            getStatus: function() {\n                return statusMap[ this.id ];\n            },\n    \n            /**\n             * 获取文件原始信息。\n             * @return {*}\n             */\n            getSource: function() {\n                return this.source;\n            },\n    \n            destroy: function() {\n                this.off();\n                delete statusMap[ this.id ];\n            }\n        });\n    \n        Mediator.installTo( WUFile.prototype );\n    \n        /**\n         * 文件状态值，具体包括以下几种类型：\n         * * `inited` 初始状态\n         * * `queued` 已经进入队列, 等待上传\n         * * `progress` 上传中\n         * * `complete` 上传完成。\n         * * `error` 上传出错，可重试\n         * * `interrupt` 上传中断，可续传。\n         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n         * * `cancelled` 文件被移除。\n         * @property {Object} Status\n         * @namespace File\n         * @class File\n         * @static\n         */\n        WUFile.Status = {\n            INITED:     'inited',    // 初始状态\n            QUEUED:     'queued',    // 已经进入队列, 等待上传\n            PROGRESS:   'progress',    // 上传中\n            ERROR:      'error',    // 上传出错，可重试\n            COMPLETE:   'complete',    // 上传完成。\n            CANCELLED:  'cancelled',    // 上传取消。\n            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n        };\n    \n        return WUFile;\n    });\n    \n    /**\n     * @fileOverview 文件队列\n     */\n    define('queue',[\n        'base',\n        'mediator',\n        'file'\n    ], function( Base, Mediator, WUFile ) {\n    \n        var $ = Base.$,\n            STATUS = WUFile.Status;\n    \n        /**\n         * 文件队列, 用来存储各个状态中的文件。\n         * @class Queue\n         * @extends Mediator\n         */\n        function Queue() {\n    \n            /**\n             * 统计文件数。\n             * * `numOfQueue` 队列中的文件数。\n             * * `numOfSuccess` 上传成功的文件数\n             * * `numOfCancel` 被取消的文件数\n             * * `numOfProgress` 正在上传中的文件数\n             * * `numOfUploadFailed` 上传错误的文件数。\n             * * `numOfInvalid` 无效的文件数。\n             * * `numofDeleted` 被移除的文件数。\n             * @property {Object} stats\n             */\n            this.stats = {\n                numOfQueue: 0,\n                numOfSuccess: 0,\n                numOfCancel: 0,\n                numOfProgress: 0,\n                numOfUploadFailed: 0,\n                numOfInvalid: 0,\n                numofDeleted: 0,\n                numofInterrupt: 0\n            };\n    \n            // 上传队列，仅包括等待上传的文件\n            this._queue = [];\n    \n            // 存储所有文件\n            this._map = {};\n        }\n    \n        $.extend( Queue.prototype, {\n    \n            /**\n             * 将新文件加入对队列尾部\n             *\n             * @method append\n             * @param  {File} file   文件对象\n             */\n            append: function( file ) {\n                this._queue.push( file );\n                this._fileAdded( file );\n                return this;\n            },\n    \n            /**\n             * 将新文件加入对队列头部\n             *\n             * @method prepend\n             * @param  {File} file   文件对象\n             */\n            prepend: function( file ) {\n                this._queue.unshift( file );\n                this._fileAdded( file );\n                return this;\n            },\n    \n            /**\n             * 获取文件对象\n             *\n             * @method getFile\n             * @param  {String} fileId   文件ID\n             * @return {File}\n             */\n            getFile: function( fileId ) {\n                if ( typeof fileId !== 'string' ) {\n                    return fileId;\n                }\n                return this._map[ fileId ];\n            },\n    \n            /**\n             * 从队列中取出一个指定状态的文件。\n             * @grammar fetch( status ) => File\n             * @method fetch\n             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n             * @return {File} [File](#WebUploader:File)\n             */\n            fetch: function( status ) {\n                var len = this._queue.length,\n                    i, file;\n    \n                status = status || STATUS.QUEUED;\n    \n                for ( i = 0; i < len; i++ ) {\n                    file = this._queue[ i ];\n    \n                    if ( status === file.getStatus() ) {\n                        return file;\n                    }\n                }\n    \n                return null;\n            },\n    \n            /**\n             * 对队列进行排序，能够控制文件上传顺序。\n             * @grammar sort( fn ) => undefined\n             * @method sort\n             * @param {Function} fn 排序方法\n             */\n            sort: function( fn ) {\n                if ( typeof fn === 'function' ) {\n                    this._queue.sort( fn );\n                }\n            },\n    \n            /**\n             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n             * @method getFiles\n             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n             */\n            getFiles: function() {\n                var sts = [].slice.call( arguments, 0 ),\n                    ret = [],\n                    i = 0,\n                    len = this._queue.length,\n                    file;\n    \n                for ( ; i < len; i++ ) {\n                    file = this._queue[ i ];\n    \n                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n                        continue;\n                    }\n    \n                    ret.push( file );\n                }\n    \n                return ret;\n            },\n    \n            /**\n             * 在队列中删除文件。\n             * @grammar removeFile( file ) => Array\n             * @method removeFile\n             * @param {File} 文件对象。\n             */\n            removeFile: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n    \n                if ( existing ) {\n                    delete this._map[ file.id ];\n                    file.destroy();\n                    this.stats.numofDeleted++;\n                }\n            },\n    \n            _fileAdded: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n    \n                if ( !existing ) {\n                    this._map[ file.id ] = file;\n    \n                    file.on( 'statuschange', function( cur, pre ) {\n                        me._onFileStatusChange( cur, pre );\n                    });\n                }\n            },\n    \n            _onFileStatusChange: function( curStatus, preStatus ) {\n                var stats = this.stats;\n    \n                switch ( preStatus ) {\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress--;\n                        break;\n    \n                    case STATUS.QUEUED:\n                        stats.numOfQueue --;\n                        break;\n    \n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed--;\n                        break;\n    \n                    case STATUS.INVALID:\n                        stats.numOfInvalid--;\n                        break;\n    \n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt--;\n                        break;\n                }\n    \n                switch ( curStatus ) {\n                    case STATUS.QUEUED:\n                        stats.numOfQueue++;\n                        break;\n    \n                    case STATUS.PROGRESS:\n                        stats.numOfProgress++;\n                        break;\n    \n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed++;\n                        break;\n    \n                    case STATUS.COMPLETE:\n                        stats.numOfSuccess++;\n                        break;\n    \n                    case STATUS.CANCELLED:\n                        stats.numOfCancel++;\n                        break;\n    \n    \n                    case STATUS.INVALID:\n                        stats.numOfInvalid++;\n                        break;\n    \n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt++;\n                        break;\n                }\n            }\n    \n        });\n    \n        Mediator.installTo( Queue.prototype );\n    \n        return Queue;\n    });\n    /**\n     * @fileOverview 队列\n     */\n    define('widgets/queue',[\n        'base',\n        'uploader',\n        'queue',\n        'file',\n        'lib/file',\n        'runtime/client',\n        'widgets/widget'\n    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n    \n        var $ = Base.$,\n            rExt = /\\.\\w+$/,\n            Status = WUFile.Status;\n    \n        return Uploader.register({\n            name: 'queue',\n    \n            init: function( opts ) {\n                var me = this,\n                    deferred, len, i, item, arr, accept, runtime;\n    \n                if ( $.isPlainObject( opts.accept ) ) {\n                    opts.accept = [ opts.accept ];\n                }\n    \n                // accept中的中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n    \n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].extensions;\n                        item && arr.push( item );\n                    }\n    \n                    if ( arr.length ) {\n                        accept = '\\\\.' + arr.join(',')\n                                .replace( /,/g, '$|\\\\.' )\n                                .replace( /\\*/g, '.*' ) + '$';\n                    }\n    \n                    me.accept = new RegExp( accept, 'i' );\n                }\n    \n                me.queue = new Queue();\n                me.stats = me.queue.stats;\n    \n                // 如果当前不是html5运行时，那就算了。\n                // 不执行后续操作\n                if ( this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n    \n                // 创建一个 html5 运行时的 placeholder\n                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n                deferred = Base.Deferred();\n                this.placeholder = runtime = new RuntimeClient('Placeholder');\n                runtime.connectRuntime({\n                    runtimeOrder: 'html5'\n                }, function() {\n                    me._ruid = runtime.getRuid();\n                    deferred.resolve();\n                });\n                return deferred.promise();\n            },\n    \n    \n            // 为了支持外部直接添加一个原生File对象。\n            _wrapFile: function( file ) {\n                if ( !(file instanceof WUFile) ) {\n    \n                    if ( !(file instanceof File) ) {\n                        if ( !this._ruid ) {\n                            throw new Error('Can\\'t add external files.');\n                        }\n                        file = new File( this._ruid, file );\n                    }\n    \n                    file = new WUFile( file );\n                }\n    \n                return file;\n            },\n    \n            // 判断文件是否可以被加入队列\n            acceptFile: function( file ) {\n                 var invalid = !file || !file.size || this.accept &&\n    \n                        // 如果名字中有后缀，才做后缀白名单处理。\n                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n                return !invalid;\n            },\n    \n    \n            /**\n             * @event beforeFileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event fileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列以后触发。\n             * @for  Uploader\n             */\n    \n            _addFile: function( file ) {\n                var me = this;\n    \n                file = me._wrapFile( file );\n    \n                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n                    return;\n                }\n    \n                // 类型不匹配，则派送错误事件，并返回。\n                if ( !me.acceptFile( file ) ) {\n                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n                    return;\n                }\n    \n                me.queue.append( file );\n                me.owner.trigger( 'fileQueued', file );\n                return file;\n            },\n    \n            getFile: function( fileId ) {\n                return this.queue.getFile( fileId );\n            },\n    \n            /**\n             * @event filesQueued\n             * @param {File} files 数组，内容为原始File(lib/File）对象。\n             * @description 当一批文件添加进队列以后触发。\n             * @for  Uploader\n             */\n            \n            /**\n             * @property {Boolean} [auto=false]\n             * @namespace options\n             * @for Uploader\n             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n             * \n             */\n    \n            /**\n             * @method addFiles\n             * @grammar addFiles( file ) => undefined\n             * @grammar addFiles( [file1, file2 ...] ) => undefined\n             * @param {Array of File or File} [files] Files 对象 数组\n             * @description 添加文件到队列\n             * @for  Uploader\n             */\n            addFile: function( files ) {\n                var me = this;\n    \n                if ( !files.length ) {\n                    files = [ files ];\n                }\n    \n                files = $.map( files, function( file ) {\n                    return me._addFile( file );\n                });\n    \n                me.owner.trigger( 'filesQueued', files );\n    \n                if ( me.options.auto ) {\n                    setTimeout(function() {\n                        me.request('start-upload');\n                    }, 20 );\n                }\n            },\n    \n            getStats: function() {\n                return this.stats;\n            },\n    \n            /**\n             * @event fileDequeued\n             * @param {File} file File对象\n             * @description 当文件被移除队列后触发。\n             * @for  Uploader\n             */\n    \n             /**\n             * @method removeFile\n             * @grammar removeFile( file ) => undefined\n             * @grammar removeFile( id ) => undefined\n             * @grammar removeFile( file, true ) => undefined\n             * @grammar removeFile( id, true ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.removeFile( file );\n             * })\n             */\n            removeFile: function( file, remove ) {\n                var me = this;\n    \n                file = file.id ? file : me.queue.getFile( file );\n    \n                this.request( 'cancel-file', file );\n    \n                if ( remove ) {\n                    this.queue.removeFile( file );\n                }\n            },\n    \n            /**\n             * @method getFiles\n             * @grammar getFiles() => Array\n             * @grammar getFiles( status1, status2, status... ) => Array\n             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n             * @for  Uploader\n             * @example\n             * console.log( uploader.getFiles() );    // => all files\n             * console.log( uploader.getFiles('error') )    // => all error files.\n             */\n            getFiles: function() {\n                return this.queue.getFiles.apply( this.queue, arguments );\n            },\n    \n            fetchFile: function() {\n                return this.queue.fetch.apply( this.queue, arguments );\n            },\n    \n            /**\n             * @method retry\n             * @grammar retry() => undefined\n             * @grammar retry( file ) => undefined\n             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n             * @for  Uploader\n             * @example\n             * function retry() {\n             *     uploader.retry();\n             * }\n             */\n            retry: function( file, noForceStart ) {\n                var me = this,\n                    files, i, len;\n    \n                if ( file ) {\n                    file = file.id ? file : me.queue.getFile( file );\n                    file.setStatus( Status.QUEUED );\n                    noForceStart || me.request('start-upload');\n                    return;\n                }\n    \n                files = me.queue.getFiles( Status.ERROR );\n                i = 0;\n                len = files.length;\n    \n                for ( ; i < len; i++ ) {\n                    file = files[ i ];\n                    file.setStatus( Status.QUEUED );\n                }\n    \n                me.request('start-upload');\n            },\n    \n            /**\n             * @method sort\n             * @grammar sort( fn ) => undefined\n             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n             * @for  Uploader\n             */\n            sortFiles: function() {\n                return this.queue.sort.apply( this.queue, arguments );\n            },\n    \n            /**\n             * @event reset\n             * @description 当 uploader 被重置的时候触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * @method reset\n             * @grammar reset() => undefined\n             * @description 重置uploader。目前只重置了队列。\n             * @for  Uploader\n             * @example\n             * uploader.reset();\n             */\n            reset: function() {\n                this.owner.trigger('reset');\n                this.queue = new Queue();\n                this.stats = this.queue.stats;\n            },\n    \n            destroy: function() {\n                this.reset();\n                this.placeholder && this.placeholder.destroy();\n            }\n        });\n    \n    });\n    /**\n     * @fileOverview 添加获取Runtime相关信息的方法。\n     */\n    define('widgets/runtime',[\n        'uploader',\n        'runtime/runtime',\n        'widgets/widget'\n    ], function( Uploader, Runtime ) {\n    \n        Uploader.support = function() {\n            return Runtime.hasRuntime.apply( Runtime, arguments );\n        };\n    \n        /**\n         * @property {Object} [runtimeOrder=html5,flash]\n         * @namespace options\n         * @for Uploader\n         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n         *\n         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n         */\n    \n        return Uploader.register({\n            name: 'runtime',\n    \n            init: function() {\n                if ( !this.predictRuntimeType() ) {\n                    throw Error('Runtime Error');\n                }\n            },\n    \n            /**\n             * 预测Uploader将采用哪个`Runtime`\n             * @grammar predictRuntimeType() => String\n             * @method predictRuntimeType\n             * @for  Uploader\n             */\n            predictRuntimeType: function() {\n                var orders = this.options.runtimeOrder || Runtime.orders,\n                    type = this.type,\n                    i, len;\n    \n                if ( !type ) {\n                    orders = orders.split( /\\s*,\\s*/g );\n    \n                    for ( i = 0, len = orders.length; i < len; i++ ) {\n                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n                            this.type = type = orders[ i ];\n                            break;\n                        }\n                    }\n                }\n    \n                return type;\n            }\n        });\n    });\n    /**\n     * @fileOverview Transport\n     */\n    define('lib/transport',[\n        'base',\n        'runtime/client',\n        'mediator'\n    ], function( Base, RuntimeClient, Mediator ) {\n    \n        var $ = Base.$;\n    \n        function Transport( opts ) {\n            var me = this;\n    \n            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n            RuntimeClient.call( this, 'Transport' );\n    \n            this._blob = null;\n            this._formData = opts.formData || {};\n            this._headers = opts.headers || {};\n    \n            this.on( 'progress', this._timeout );\n            this.on( 'load error', function() {\n                me.trigger( 'progress', 1 );\n                clearTimeout( me._timer );\n            });\n        }\n    \n        Transport.options = {\n            server: '',\n            method: 'POST',\n    \n            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n            withCredentials: false,\n            fileVal: 'file',\n            timeout: 2 * 60 * 1000,    // 2分钟\n            formData: {},\n            headers: {},\n            sendAsBinary: false\n        };\n    \n        $.extend( Transport.prototype, {\n    \n            // 添加Blob, 只能添加一次，最后一次有效。\n            appendBlob: function( key, blob, filename ) {\n                var me = this,\n                    opts = me.options;\n    \n                if ( me.getRuid() ) {\n                    me.disconnectRuntime();\n                }\n    \n                // 连接到blob归属的同一个runtime.\n                me.connectRuntime( blob.ruid, function() {\n                    me.exec('init');\n                });\n    \n                me._blob = blob;\n                opts.fileVal = key || opts.fileVal;\n                opts.filename = filename || opts.filename;\n\n            },\n    \n            // 添加其他字段\n            append: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._formData, key );\n                } else {\n                    this._formData[ key ] = value;\n                }\n            },\n    \n            setRequestHeader: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._headers, key );\n                } else {\n                    this._headers[ key ] = value;\n                }\n            },\n    \n            send: function( method ) {\n                this.exec( 'send', method );\n                this._timeout();\n            },\n    \n            abort: function() {\n                clearTimeout( this._timer );\n                return this.exec('abort');\n            },\n    \n            destroy: function() {\n                this.trigger('destroy');\n                this.off();\n                this.exec('destroy');\n                this.disconnectRuntime();\n            },\n    \n            getResponse: function() {\n                return this.exec('getResponse');\n            },\n    \n            getResponseAsJson: function() {\n                return this.exec('getResponseAsJson');\n            },\n    \n            getStatus: function() {\n                return this.exec('getStatus');\n            },\n    \n            _timeout: function() {\n                var me = this,\n                    duration = me.options.timeout;\n    \n                if ( !duration ) {\n                    return;\n                }\n    \n                clearTimeout( me._timer );\n                me._timer = setTimeout(function() {\n                    me.abort();\n                    me.trigger( 'error', 'timeout' );\n                }, duration );\n            }\n    \n        });\n    \n        // 让Transport具备事件功能。\n        Mediator.installTo( Transport.prototype );\n    \n        return Transport;\n    });\n    /**\n     * @fileOverview 负责文件上传相关。\n     */\n    define('widgets/upload',[\n        'base',\n        'uploader',\n        'file',\n        'lib/transport',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile, Transport ) {\n    \n        var $ = Base.$,\n            isPromise = Base.isPromise,\n            Status = WUFile.Status;\n    \n        // 添加默认配置项\n        $.extend( Uploader.options, {\n    \n    \n            /**\n             * @property {Boolean} [prepareNextFile=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否允许在文件传输时提前把下一个文件准备好。\n             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n             */\n            prepareNextFile: false,\n    \n            /**\n             * @property {Boolean} [chunked=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否要分片处理大文件上传。\n             */\n            chunked: false,\n    \n            /**\n             * @property {Boolean} [chunkSize=5242880]\n             * @namespace options\n             * @for Uploader\n             * @description 如果要分片，分多大一片？ 默认大小为5M.\n             */\n            chunkSize: 5 * 1024 * 1024,\n    \n            /**\n             * @property {Boolean} [chunkRetry=2]\n             * @namespace options\n             * @for Uploader\n             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n             */\n            chunkRetry: 2,\n    \n            /**\n             * @property {Boolean} [threads=3]\n             * @namespace options\n             * @for Uploader\n             * @description 上传并发数。允许同时最大上传进程数。\n             */\n            threads: 3,\n    \n    \n            /**\n             * @property {Object} [formData={}]\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n             */\n            formData: {}\n    \n            /**\n             * @property {Object} [fileVal='file']\n             * @namespace options\n             * @for Uploader\n             * @description 设置文件上传域的name。\n             */\n    \n            /**\n             * @property {Object} [method='POST']\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传方式，`POST`或者`GET`。\n             */\n    \n            /**\n             * @property {Object} [sendAsBinary=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n             * 其他参数在$_GET数组中。\n             */\n        });\n    \n        // 负责将文件切片。\n        function CuteFile( file, chunkSize ) {\n            var pending = [],\n                blob = file.source,\n                total = blob.size,\n                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n                start = 0,\n                index = 0,\n                len, api;\n    \n            api = {\n                file: file,\n    \n                has: function() {\n                    return !!pending.length;\n                },\n    \n                shift: function() {\n                    return pending.shift();\n                },\n    \n                unshift: function( block ) {\n                    pending.unshift( block );\n                }\n            };\n    \n            while ( index < chunks ) {\n                len = Math.min( chunkSize, total - start );\n    \n                pending.push({\n                    file: file,\n                    start: start,\n                    end: chunkSize ? (start + len) : total,\n                    total: total,\n                    chunks: chunks,\n                    chunk: index++,\n                    cuted: api\n                });\n                start += len;\n            }\n    \n            file.blocks = pending.concat();\n            file.remaning = pending.length;\n    \n            return api;\n        }\n    \n        Uploader.register({\n            name: 'upload',\n    \n            init: function() {\n                var owner = this.owner,\n                    me = this;\n    \n                this.runing = false;\n                this.progress = false;\n    \n                owner\n                    .on( 'startUpload', function() {\n                        me.progress = true;\n                    })\n                    .on( 'uploadFinished', function() {\n                        me.progress = false;\n                    });\n    \n                // 记录当前正在传的数据，跟threads相关\n                this.pool = [];\n    \n                // 缓存分好片的文件。\n                this.stack = [];\n    \n                // 缓存即将上传的文件。\n                this.pending = [];\n    \n                // 跟踪还有多少分片在上传中但是没有完成上传。\n                this.remaning = 0;\n                this.__tick = Base.bindFn( this._tick, this );\n    \n                owner.on( 'uploadComplete', function( file ) {\n    \n                    // 把其他块取消了。\n                    file.blocks && $.each( file.blocks, function( _, v ) {\n                        v.transport && (v.transport.abort(), v.transport.destroy());\n                        delete v.transport;\n                    });\n    \n                    delete file.blocks;\n                    delete file.remaning;\n                });\n            },\n    \n            reset: function() {\n                this.request( 'stop-upload', true );\n                this.runing = false;\n                this.pool = [];\n                this.stack = [];\n                this.pending = [];\n                this.remaning = 0;\n                this._trigged = false;\n                this._promise = null;\n            },\n    \n            /**\n             * @event startUpload\n             * @description 当开始上传流程时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n             *\n             * 可以指定开始某一个文件。\n             * @grammar upload() => undefined\n             * @grammar upload( file | fileId) => undefined\n             * @method upload\n             * @for  Uploader\n             */\n            startUpload: function(file) {\n                var me = this;\n    \n                // 移出invalid的文件\n                $.each( me.request( 'get-files', Status.INVALID ), function() {\n                    me.request( 'remove-file', this );\n                });\n    \n                // 如果指定了开始某个文件，则只开始指定文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n    \n                    if (file.getStatus() === Status.INTERRUPT) {\n                        $.each( me.pool, function( _, v ) {\n    \n                            // 之前暂停过。\n                            if (v.file !== file) {\n                                return;\n                            }\n    \n                            v.transport && v.transport.send();\n                        });\n    \n                        file.setStatus( Status.QUEUED );\n                    } else if (file.getStatus() === Status.PROGRESS) {\n                        return;\n                    } else {\n                        file.setStatus( Status.QUEUED );\n                    }\n                } else {\n                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n                        this.setStatus( Status.QUEUED );\n                    });\n                }\n    \n                if ( me.runing ) {\n                    return;\n                }\n    \n                me.runing = true;\n    \n                var files = [];\n    \n                // 如果有暂停的，则续传\n                $.each( me.pool, function( _, v ) {\n                    var file = v.file;\n    \n                    if ( file.getStatus() === Status.INTERRUPT ) {\n                        files.push(file);\n                        me._trigged = false;\n                        v.transport && v.transport.send();\n                    }\n                });\n    \n                var file;\n                while ( (file = files.shift()) ) {\n                    file.setStatus( Status.PROGRESS );\n                }\n    \n                file || $.each( me.request( 'get-files',\n                        Status.INTERRUPT ), function() {\n                    this.setStatus( Status.PROGRESS );\n                });\n    \n                me._trigged = false;\n                Base.nextTick( me.__tick );\n                me.owner.trigger('startUpload');\n            },\n    \n            /**\n             * @event stopUpload\n             * @description 当开始上传流程暂停时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n             *\n             * 如果第一个参数是文件，则只暂停指定文件。\n             * @grammar stop() => undefined\n             * @grammar stop( true ) => undefined\n             * @grammar stop( file ) => undefined\n             * @method stop\n             * @for  Uploader\n             */\n            stopUpload: function( file, interrupt ) {\n                var me = this;\n    \n                if (file === true) {\n                    interrupt = file;\n                    file = null;\n                }\n    \n                if ( me.runing === false ) {\n                    return;\n                }\n    \n                // 如果只是暂停某个文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n    \n                    if ( file.getStatus() !== Status.PROGRESS &&\n                            file.getStatus() !== Status.QUEUED ) {\n                        return;\n                    }\n    \n                    file.setStatus( Status.INTERRUPT );\n                    $.each( me.pool, function( _, v ) {\n    \n                        // 只 abort 指定的文件。\n                        if (v.file !== file) {\n                            return;\n                        }\n    \n                        v.transport && v.transport.abort();\n                        me._putback(v);\n                        me._popBlock(v);\n                    });\n    \n                    return Base.nextTick( me.__tick );\n                }\n    \n                me.runing = false;\n    \n                if (this._promise && this._promise.file) {\n                    this._promise.file.setStatus( Status.INTERRUPT );\n                }\n    \n                interrupt && $.each( me.pool, function( _, v ) {\n                    v.transport && v.transport.abort();\n                    v.file.setStatus( Status.INTERRUPT );\n                });\n    \n                me.owner.trigger('stopUpload');\n            },\n    \n            /**\n             * @method cancelFile\n             * @grammar cancelFile( file ) => undefined\n             * @grammar cancelFile( id ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 标记文件状态为已取消, 同时将中断文件传输。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.cancelFile( file );\n             * })\n             */\n            cancelFile: function( file ) {\n                file = file.id ? file : this.request( 'get-file', file );\n    \n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n    \n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n    \n                file.setStatus( Status.CANCELLED );\n                this.owner.trigger( 'fileDequeued', file );\n            },\n    \n            /**\n             * 判断`Uplaode`r是否正在上传中。\n             * @grammar isInProgress() => Boolean\n             * @method isInProgress\n             * @for  Uploader\n             */\n            isInProgress: function() {\n                return !!this.progress;\n            },\n    \n            _getStats: function() {\n                return this.request('get-stats');\n            },\n    \n            /**\n             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n             * @grammar skipFile( file ) => undefined\n             * @method skipFile\n             * @for  Uploader\n             */\n            skipFile: function( file, status ) {\n                file = file.id ? file : this.request( 'get-file', file );\n    \n                file.setStatus( status || Status.COMPLETE );\n                file.skipped = true;\n    \n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n    \n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n    \n                this.owner.trigger( 'uploadSkip', file );\n            },\n    \n            /**\n             * @event uploadFinished\n             * @description 当所有文件上传结束时触发。\n             * @for  Uploader\n             */\n            _tick: function() {\n                var me = this,\n                    opts = me.options,\n                    fn, val;\n    \n                // 上一个promise还没有结束，则等待完成后再执行。\n                if ( me._promise ) {\n                    return me._promise.always( me.__tick );\n                }\n    \n                // 还有位置，且还有文件要处理的话。\n                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n                    me._trigged = false;\n    \n                    fn = function( val ) {\n                        me._promise = null;\n    \n                        // 有可能是reject过来的，所以要检测val的类型。\n                        val && val.file && me._startSend( val );\n                        Base.nextTick( me.__tick );\n                    };\n    \n                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n    \n                // 没有要上传的了，且没有正在传输的了。\n                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n                    !me._getStats().numofInterrupt ) {\n                    me.runing = false;\n    \n                    me._trigged || Base.nextTick(function() {\n                        me.owner.trigger('uploadFinished');\n                    });\n                    me._trigged = true;\n                }\n            },\n    \n            _putback: function(block) {\n                var idx;\n    \n                block.cuted.unshift(block);\n                idx = this.stack.indexOf(block.cuted);\n    \n                if (!~idx) {\n                    this.stack.unshift(block.cuted);\n                }\n            },\n    \n            _getStack: function() {\n                var i = 0,\n                    act;\n    \n                while ( (act = this.stack[ i++ ]) ) {\n                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n                        return act;\n                    } else if (!act.has() ||\n                            act.file.getStatus() !== Status.PROGRESS &&\n                            act.file.getStatus() !== Status.INTERRUPT ) {\n    \n                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n                        // interupt（暂停中） 的移除。\n                        this.stack.splice( --i, 1 );\n                    }\n                }\n    \n                return null;\n            },\n    \n            _nextBlock: function() {\n                var me = this,\n                    opts = me.options,\n                    act, next, done, preparing;\n    \n                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n                if ( (act = this._getStack()) ) {\n    \n                    // 是否提前准备下一个文件\n                    if ( opts.prepareNextFile && !me.pending.length ) {\n                        me._prepareNextFile();\n                    }\n    \n                    return act.shift();\n    \n                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n                } else if ( me.runing ) {\n    \n                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n                        me._prepareNextFile();\n                    }\n    \n                    next = me.pending.shift();\n                    done = function( file ) {\n                        if ( !file ) {\n                            return null;\n                        }\n    \n                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n                        me.stack.push(act);\n                        return act.shift();\n                    };\n    \n                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n                    if ( isPromise( next) ) {\n                        preparing = next.file;\n                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n                        next.file = preparing;\n                        return next;\n                    }\n    \n                    return done( next );\n                }\n            },\n    \n    \n            /**\n             * @event uploadStart\n             * @param {File} file File对象\n             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n             * @for  Uploader\n             */\n            _prepareNextFile: function() {\n                var me = this,\n                    file = me.request('fetch-file'),\n                    pending = me.pending,\n                    promise;\n    \n                if ( file ) {\n                    promise = me.request( 'before-send-file', file, function() {\n    \n                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n                        if ( file.getStatus() === Status.PROGRESS ||\n                            file.getStatus() === Status.INTERRUPT ) {\n                            return file;\n                        }\n    \n                        return me._finishFile( file );\n                    });\n    \n                    me.owner.trigger( 'uploadStart', file );\n                    file.setStatus( Status.PROGRESS );\n    \n                    promise.file = file;\n    \n                    // 如果还在pending中，则替换成文件本身。\n                    promise.done(function() {\n                        var idx = $.inArray( promise, pending );\n    \n                        ~idx && pending.splice( idx, 1, file );\n                    });\n    \n                    // befeore-send-file的钩子就有错误发生。\n                    promise.fail(function( reason ) {\n                        file.setStatus( Status.ERROR, reason );\n                        me.owner.trigger( 'uploadError', file, reason );\n                        me.owner.trigger( 'uploadComplete', file );\n                    });\n    \n                    pending.push( promise );\n                }\n            },\n    \n            // 让出位置了，可以让其他分片开始上传\n            _popBlock: function( block ) {\n                var idx = $.inArray( block, this.pool );\n    \n                this.pool.splice( idx, 1 );\n                block.file.remaning--;\n                this.remaning--;\n            },\n    \n            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n            _startSend: function( block ) {\n                var me = this,\n                    file = block.file,\n                    promise;\n    \n                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n                // 如：暂停，取消\n                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n                if ( file.getStatus() !== Status.PROGRESS ) {\n    \n                    // 如果是中断，则还需要放回去。\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        me._putback(block);\n                    }\n    \n                    return;\n                }\n    \n                me.pool.push( block );\n                me.remaning++;\n    \n                // 如果没有分片，则直接使用原始的。\n                // 不会丢失content-type信息。\n                block.blob = block.chunks === 1 ? file.source :\n                        file.source.slice( block.start, block.end );\n    \n                // hook, 每个分片发送之前可能要做些异步的事情。\n                promise = me.request( 'before-send', block, function() {\n    \n                    // 有可能文件已经上传出错了，所以不需要再传输了。\n                    if ( file.getStatus() === Status.PROGRESS ) {\n                        me._doSend( block );\n                    } else {\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n    \n                // 如果为fail了，则跳过此分片。\n                promise.fail(function() {\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file ).always(function() {\n                            block.percentage = 1;\n                            me._popBlock( block );\n                            me.owner.trigger( 'uploadComplete', file );\n                            Base.nextTick( me.__tick );\n                        });\n                    } else {\n                        block.percentage = 1;\n                        me.updateFileProgress( file );\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n            },\n    \n    \n            /**\n             * @event uploadBeforeSend\n             * @param {Object} object\n             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n             * @param {Object} headers 可以扩展此对象来控制上传头部。\n             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadAccept\n             * @param {Object} object\n             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadProgress\n             * @param {File} file File对象\n             * @param {Number} percentage 上传进度\n             * @description 上传过程中触发，携带上传进度。\n             * @for  Uploader\n             */\n    \n    \n            /**\n             * @event uploadError\n             * @param {File} file File对象\n             * @param {String} reason 出错的code\n             * @description 当文件上传出错时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadSuccess\n             * @param {File} file File对象\n             * @param {Object} response 服务端返回的数据\n             * @description 当文件上传成功时触发。\n             * @for  Uploader\n             */\n    \n            /**\n             * @event uploadComplete\n             * @param {File} [file] File对象\n             * @description 不管成功或者失败，文件上传完成时触发。\n             * @for  Uploader\n             */\n    \n            // 做上传操作。\n            _doSend: function( block ) {\n                var me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    file = block.file,\n                    tr = new Transport( opts ),\n                    data = $.extend({}, opts.formData ),\n                    headers = $.extend({}, opts.headers ),\n                    requestAccept, ret;\n    \n                block.transport = tr;\n    \n                tr.on( 'destroy', function() {\n                    delete block.transport;\n                    me._popBlock( block );\n                    Base.nextTick( me.__tick );\n                });\n    \n                // 广播上传进度。以文件为单位。\n                tr.on( 'progress', function( percentage ) {\n                    block.percentage = percentage;\n                    me.updateFileProgress( file );\n                });\n    \n                // 用来询问，是否返回的结果是有错误的。\n                requestAccept = function( reject ) {\n                    var fn;\n    \n                    ret = tr.getResponseAsJson() || {};\n                    ret._raw = tr.getResponse();\n                    fn = function( value ) {\n                        reject = value;\n                    };\n    \n                    // 服务端响应了，不代表成功了，询问是否响应正确。\n                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n                        reject = reject || 'server';\n                    }\n    \n                    return reject;\n                };\n    \n                // 尝试重试，然后广播文件上传出错。\n                tr.on( 'error', function( type, flag ) {\n                    block.retried = block.retried || 0;\n    \n                    // 自动重试\n                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n                            block.retried < opts.chunkRetry ) {\n    \n                        block.retried++;\n                        tr.send();\n    \n                    } else {\n    \n                        // http status 500 ~ 600\n                        if ( !flag && type === 'server' ) {\n                            type = requestAccept( type );\n                        }\n    \n                        file.setStatus( Status.ERROR, type );\n                        owner.trigger( 'uploadError', file, type );\n                        owner.trigger( 'uploadComplete', file );\n                    }\n                });\n    \n                // 上传成功\n                tr.on( 'load', function() {\n                    var reason;\n    \n                    // 如果非预期，转向上传出错。\n                    if ( (reason = requestAccept()) ) {\n                        tr.trigger( 'error', reason, true );\n                        return;\n                    }\n    \n                    // 全部上传完成。\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file, ret );\n                    } else {\n                        tr.destroy();\n                    }\n                });\n    \n                // 配置默认的上传字段。\n                data = $.extend( data, {\n                    id: file.id,\n                    name: file.name,\n                    type: file.type,\n                    lastModifiedDate: file.lastModifiedDate,\n                    size: file.size\n                });\n    \n                block.chunks > 1 && $.extend( data, {\n                    chunks: block.chunks,\n                    chunk: block.chunk\n                });\n    \n                // 在发送之间可以添加字段什么的。。。\n                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n                owner.trigger( 'uploadBeforeSend', block, data, headers );\n    \n                // 开始发送。\n                tr.appendBlob( opts.fileVal, block.blob, file.name );\n                tr.append( data );\n                tr.setRequestHeader( headers );\n                tr.send();\n            },\n    \n            // 完成上传。\n            _finishFile: function( file, ret, hds ) {\n                var owner = this.owner;\n    \n                return owner\n                        .request( 'after-send-file', arguments, function() {\n                            file.setStatus( Status.COMPLETE );\n                            owner.trigger( 'uploadSuccess', file, ret, hds );\n                        })\n                        .fail(function( reason ) {\n    \n                            // 如果外部已经标记为invalid什么的，不再改状态。\n                            if ( file.getStatus() === Status.PROGRESS ) {\n                                file.setStatus( Status.ERROR, reason );\n                            }\n    \n                            owner.trigger( 'uploadError', file, reason );\n                        })\n                        .always(function() {\n                            owner.trigger( 'uploadComplete', file );\n                        });\n            },\n    \n            updateFileProgress: function(file) {\n                var totalPercent = 0,\n                    uploaded = 0;\n    \n                if (!file.blocks) {\n                    return;\n                }\n    \n                $.each( file.blocks, function( _, v ) {\n                    uploaded += (v.percentage || 0) * (v.end - v.start);\n                });\n    \n                totalPercent = uploaded / file.size;\n                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n            }\n    \n        });\n    });\n    /**\n     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n     */\n    \n    define('widgets/validator',[\n        'base',\n        'uploader',\n        'file',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile ) {\n    \n        var $ = Base.$,\n            validators = {},\n            api;\n    \n        /**\n         * @event error\n         * @param {String} type 错误类型。\n         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n         *\n         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n         * @for  Uploader\n         */\n    \n        // 暴露给外面的api\n        api = {\n    \n            // 添加验证器\n            addValidator: function( type, cb ) {\n                validators[ type ] = cb;\n            },\n    \n            // 移除验证器\n            removeValidator: function( type ) {\n                delete validators[ type ];\n            }\n        };\n    \n        // 在Uploader初始化的时候启动Validators的初始化\n        Uploader.register({\n            name: 'validator',\n    \n            init: function() {\n                var me = this;\n                Base.nextTick(function() {\n                    $.each( validators, function() {\n                        this.call( me.owner );\n                    });\n                });\n            }\n        });\n    \n        /**\n         * @property {int} [fileNumLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总数量, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileNumLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileNumLimit, 10 ),\n                flag = true;\n    \n            if ( !max ) {\n                return;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n    \n                if ( count >= max && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n    \n                return count >= max ? false : true;\n            });\n    \n            uploader.on( 'fileQueued', function() {\n                count++;\n            });\n    \n            uploader.on( 'fileDequeued', function() {\n                count--;\n            });\n    \n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n    \n    \n        /**\n         * @property {int} [fileSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileSizeLimit, 10 ),\n                flag = true;\n    \n            if ( !max ) {\n                return;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n                var invalid = count + file.size > max;\n    \n                if ( invalid && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n    \n                return invalid ? false : true;\n            });\n    \n            uploader.on( 'fileQueued', function( file ) {\n                count += file.size;\n            });\n    \n            uploader.on( 'fileDequeued', function( file ) {\n                count -= file.size;\n            });\n    \n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n    \n        /**\n         * @property {int} [fileSingleSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSingleSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                max = opts.fileSingleSizeLimit;\n    \n            if ( !max ) {\n                return;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n    \n                if ( file.size > max ) {\n                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n                    return false;\n                }\n    \n            });\n    \n        });\n    \n        /**\n         * @property {Boolean} [duplicate=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n         */\n        api.addValidator( 'duplicate', function() {\n            var uploader = this,\n                opts = uploader.options,\n                mapping = {};\n    \n            if ( opts.duplicate ) {\n                return;\n            }\n    \n            function hashString( str ) {\n                var hash = 0,\n                    i = 0,\n                    len = str.length,\n                    _char;\n    \n                for ( ; i < len; i++ ) {\n                    _char = str.charCodeAt( i );\n                    hash = _char + (hash << 6) + (hash << 16) - hash;\n                }\n    \n                return hash;\n            }\n    \n            uploader.on( 'beforeFileQueued', function( file ) {\n                var hash = file.__hash || (file.__hash = hashString( file.name +\n                        file.size + file.lastModifiedDate ));\n    \n                // 已经重复了\n                if ( mapping[ hash ] ) {\n                    this.trigger( 'error', 'F_DUPLICATE', file );\n                    return false;\n                }\n            });\n    \n            uploader.on( 'fileQueued', function( file ) {\n                var hash = file.__hash;\n    \n                hash && (mapping[ hash ] = true);\n            });\n    \n            uploader.on( 'fileDequeued', function( file ) {\n                var hash = file.__hash;\n    \n                hash && (delete mapping[ hash ]);\n            });\n    \n            uploader.on( 'reset', function() {\n                mapping = {};\n            });\n        });\n    \n        return api;\n    });\n    \n    /**\n     * @fileOverview Md5\n     */\n    define('lib/md5',[\n        'runtime/client',\n        'mediator'\n    ], function( RuntimeClient, Mediator ) {\n    \n        function Md5() {\n            RuntimeClient.call( this, 'Md5' );\n        }\n    \n        // 让 Md5 具备事件功能。\n        Mediator.installTo( Md5.prototype );\n    \n        Md5.prototype.loadFromBlob = function( blob ) {\n            var me = this;\n    \n            if ( me.getRuid() ) {\n                me.disconnectRuntime();\n            }\n    \n            // 连接到blob归属的同一个runtime.\n            me.connectRuntime( blob.ruid, function() {\n                me.exec('init');\n                me.exec( 'loadFromBlob', blob );\n            });\n        };\n    \n        Md5.prototype.getResult = function() {\n            return this.exec('getResult');\n        };\n    \n        return Md5;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/md5',[\n        'base',\n        'uploader',\n        'lib/md5',\n        'lib/blob',\n        'widgets/widget'\n    ], function( Base, Uploader, Md5, Blob ) {\n    \n        return Uploader.register({\n            name: 'md5',\n    \n    \n            /**\n             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n             *\n             *\n             * @method md5File\n             * @grammar md5File( file[, start[, end]] ) => promise\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.md5File( file )\n             *\n             *         // 及时显示进度\n             *         .progress(function(percentage) {\n             *             console.log('Percentage:', percentage);\n             *         })\n             *\n             *         // 完成\n             *         .then(function(val) {\n             *             console.log('md5 result:', val);\n             *         });\n             *\n             * });\n             */\n            md5File: function( file, start, end ) {\n                var md5 = new Md5(),\n                    deferred = Base.Deferred(),\n                    blob = (file instanceof Blob) ? file :\n                        this.request( 'get-file', file ).source;\n    \n                md5.on( 'progress load', function( e ) {\n                    e = e || {};\n                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n                });\n    \n                md5.on( 'complete', function() {\n                    deferred.resolve( md5.getResult() );\n                });\n    \n                md5.on( 'error', function( reason ) {\n                    deferred.reject( reason );\n                });\n    \n                if ( arguments.length > 1 ) {\n                    start = start || 0;\n                    end = end || 0;\n                    start < 0 && (start = blob.size + start);\n                    end < 0 && (end = blob.size + end);\n                    end = Math.min( end, blob.size );\n                    blob = blob.slice( start, end );\n                }\n    \n                md5.loadFromBlob( blob );\n    \n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/compbase',[],function() {\n    \n        function CompBase( owner, runtime ) {\n    \n            this.owner = owner;\n            this.options = owner.options;\n    \n            this.getRuntime = function() {\n                return runtime;\n            };\n    \n            this.getRuid = function() {\n                return runtime.uid;\n            };\n    \n            this.trigger = function() {\n                return owner.trigger.apply( owner, arguments );\n            };\n        }\n    \n        return CompBase;\n    });\n    /**\n     * @fileOverview Html5Runtime\n     */\n    define('runtime/html5/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n    \n        var type = 'html5',\n            components = {};\n    \n        function Html5Runtime() {\n            var pool = {},\n                me = this,\n                destroy = this.destroy;\n    \n            Runtime.apply( me, arguments );\n            me.type = type;\n    \n    \n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n    \n                if ( components[ comp ] ) {\n                    instance = pool[ uid ] = pool[ uid ] ||\n                            new components[ comp ]( client, me );\n    \n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n            };\n    \n            me.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n        }\n    \n        Base.inherits( Runtime, {\n            constructor: Html5Runtime,\n    \n            // 不需要连接其他程序，直接执行callback\n            init: function() {\n                var me = this;\n                setTimeout(function() {\n                    me.trigger('ready');\n                }, 1 );\n            }\n    \n        });\n    \n        // 注册Components\n        Html5Runtime.register = function( name, component ) {\n            var klass = components[ name ] = Base.inherits( CompBase, component );\n            return klass;\n        };\n    \n        // 注册html5运行时。\n        // 只有在支持的前提下注册。\n        if ( window.Blob && window.FileReader && window.DataView ) {\n            Runtime.addRuntime( type, Html5Runtime );\n        }\n    \n        return Html5Runtime;\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/html5/blob',[\n        'runtime/html5/runtime',\n        'lib/blob'\n    ], function( Html5Runtime, Blob ) {\n    \n        return Html5Runtime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.owner.source,\n                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n    \n                blob = slice.call( blob, start, end );\n    \n                return new Blob( this.getRuid(), blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/dnd',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n    \n        var $ = Base.$,\n            prefix = 'webuploader-dnd-';\n    \n        return Html5Runtime.register( 'DragAndDrop', {\n            init: function() {\n                var elem = this.elem = this.options.container;\n    \n                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n                this.dropHandler = Base.bindFn( this._dropHandler, this );\n                this.dndOver = false;\n    \n                elem.on( 'dragenter', this.dragEnterHandler );\n                elem.on( 'dragover', this.dragOverHandler );\n                elem.on( 'dragleave', this.dragLeaveHandler );\n                elem.on( 'drop', this.dropHandler );\n    \n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).on( 'dragover', this.dragOverHandler );\n                    $( document ).on( 'drop', this.dropHandler );\n                }\n            },\n    \n            _dragEnterHandler: function( e ) {\n                var me = this,\n                    denied = me._denied || false,\n                    items;\n    \n                e = e.originalEvent || e;\n    \n                if ( !me.dndOver ) {\n                    me.dndOver = true;\n    \n                    // 注意只有 chrome 支持。\n                    items = e.dataTransfer.items;\n    \n                    if ( items && items.length ) {\n                        me._denied = denied = !me.trigger( 'accept', items );\n                    }\n    \n                    me.elem.addClass( prefix + 'over' );\n                    me.elem[ denied ? 'addClass' :\n                            'removeClass' ]( prefix + 'denied' );\n                }\n    \n                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n    \n                return false;\n            },\n    \n            _dragOverHandler: function( e ) {\n                // 只处理框内的。\n                var parentElem = this.elem.parent().get( 0 );\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n    \n                clearTimeout( this._leaveTimer );\n                this._dragEnterHandler.call( this, e );\n    \n                return false;\n            },\n    \n            _dragLeaveHandler: function() {\n                var me = this,\n                    handler;\n    \n                handler = function() {\n                    me.dndOver = false;\n                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n                };\n    \n                clearTimeout( me._leaveTimer );\n                me._leaveTimer = setTimeout( handler, 100 );\n                return false;\n            },\n    \n            _dropHandler: function( e ) {\n                var me = this,\n                    ruid = me.getRuid(),\n                    parentElem = me.elem.parent().get( 0 ),\n                    dataTransfer, data;\n    \n                // 只处理框内的。\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n    \n                e = e.originalEvent || e;\n                dataTransfer = e.dataTransfer;\n    \n                // 如果是页面内拖拽，还不能处理，不阻止事件。\n                // 此处 ie11 下会报参数错误，\n                try {\n                    data = dataTransfer.getData('text/html');\n                } catch( err ) {\n                }\n    \n                if ( data ) {\n                    return;\n                }\n    \n                me._getTansferFiles( dataTransfer, function( results ) {\n                    me.trigger( 'drop', $.map( results, function( file ) {\n                        return new File( ruid, file );\n                    }) );\n                });\n    \n                me.dndOver = false;\n                me.elem.removeClass( prefix + 'over' );\n                return false;\n            },\n    \n            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n            _getTansferFiles: function( dataTransfer, callback ) {\n                var results  = [],\n                    promises = [],\n                    items, files, file, item, i, len, canAccessFolder;\n    \n                items = dataTransfer.items;\n                files = dataTransfer.files;\n    \n                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n    \n                for ( i = 0, len = files.length; i < len; i++ ) {\n                    file = files[ i ];\n                    item = items && items[ i ];\n    \n                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n    \n                        promises.push( this._traverseDirectoryTree(\n                                item.webkitGetAsEntry(), results ) );\n                    } else {\n                        results.push( file );\n                    }\n                }\n    \n                Base.when.apply( Base, promises ).done(function() {\n    \n                    if ( !results.length ) {\n                        return;\n                    }\n    \n                    callback( results );\n                });\n            },\n    \n            _traverseDirectoryTree: function( entry, results ) {\n                var deferred = Base.Deferred(),\n                    me = this;\n    \n                if ( entry.isFile ) {\n                    entry.file(function( file ) {\n                        results.push( file );\n                        deferred.resolve();\n                    });\n                } else if ( entry.isDirectory ) {\n                    entry.createReader().readEntries(function( entries ) {\n                        var len = entries.length,\n                            promises = [],\n                            arr = [],    // 为了保证顺序。\n                            i;\n    \n                        for ( i = 0; i < len; i++ ) {\n                            promises.push( me._traverseDirectoryTree(\n                                    entries[ i ], arr ) );\n                        }\n    \n                        Base.when.apply( Base, promises ).then(function() {\n                            results.push.apply( results, arr );\n                            deferred.resolve();\n                        }, deferred.reject );\n                    });\n                }\n    \n                return deferred.promise();\n            },\n    \n            destroy: function() {\n                var elem = this.elem;\n    \n                // 还没 init 就调用 destroy\n                if (!elem) {\n                    return;\n                }\n                \n                elem.off( 'dragenter', this.dragEnterHandler );\n                elem.off( 'dragover', this.dragOverHandler );\n                elem.off( 'dragleave', this.dragLeaveHandler );\n                elem.off( 'drop', this.dropHandler );\n    \n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).off( 'dragover', this.dragOverHandler );\n                    $( document ).off( 'drop', this.dropHandler );\n                }\n            }\n        });\n    });\n    \n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/filepaste',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n    \n        return Html5Runtime.register( 'FilePaste', {\n            init: function() {\n                var opts = this.options,\n                    elem = this.elem = opts.container,\n                    accept = '.*',\n                    arr, i, len, item;\n    \n                // accetp的mimeTypes中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n    \n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].mimeTypes;\n                        item && arr.push( item );\n                    }\n    \n                    if ( arr.length ) {\n                        accept = arr.join(',');\n                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n                    }\n                }\n                this.accept = accept = new RegExp( accept, 'i' );\n                this.hander = Base.bindFn( this._pasteHander, this );\n                elem.on( 'paste', this.hander );\n            },\n    \n            _pasteHander: function( e ) {\n                var allowed = [],\n                    ruid = this.getRuid(),\n                    items, item, blob, i, len;\n    \n                e = e.originalEvent || e;\n                items = e.clipboardData.items;\n    \n                for ( i = 0, len = items.length; i < len; i++ ) {\n                    item = items[ i ];\n    \n                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n                        continue;\n                    }\n    \n                    allowed.push( new File( ruid, blob ) );\n                }\n    \n                if ( allowed.length ) {\n                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.trigger( 'paste', allowed );\n                }\n            },\n    \n            destroy: function() {\n                this.elem.off( 'paste', this.hander );\n            }\n        });\n    });\n    \n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/html5/filepicker',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n    \n        var $ = Base.$;\n    \n        return Html5Runtime.register( 'FilePicker', {\n            init: function() {\n                var container = this.getRuntime().getContainer(),\n                    me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    label = this.label = $( document.createElement('label') ),\n                    input =  this.input = $( document.createElement('input') ),\n                    arr, i, len, mouseHandler;\n    \n                input.attr( 'type', 'file' );\n                //console.log(opts.name)\n                input.attr( 'name', 'file' );\n                input.addClass('webuploader-element-invisible');\n    \n                label.on( 'click', function() {\n                    input.trigger('click');\n                });\n    \n                label.css({\n                    opacity: 0,\n                    width: '100%',\n                    height: '100%',\n                    display: 'block',\n                    cursor: 'pointer',\n                    background: '#ffffff'\n                });\n    \n                if ( opts.multiple ) {\n                    input.attr( 'multiple', 'multiple' );\n                }\n    \n                // @todo Firefox不支持单独指定后缀\n                if ( opts.accept && opts.accept.length > 0 ) {\n                    arr = [];\n    \n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        arr.push( opts.accept[ i ].mimeTypes );\n                    }\n    \n                    input.attr( 'accept', arr.join(',') );\n                }\n    \n                container.append( input );\n                container.append( label );\n    \n                mouseHandler = function( e ) {\n                    owner.trigger( e.type );\n                };\n    \n                input.on( 'change', function( e ) {\n                    var fn = arguments.callee,\n                        clone;\n    \n                    me.files = e.target.files;\n    \n                    // reset input\n                    clone = this.cloneNode( true );\n                    clone.value = null;\n                    this.parentNode.replaceChild( clone, this );\n    \n                    input.off();\n                    input = $( clone ).on( 'change', fn )\n                            .on( 'mouseenter mouseleave', mouseHandler );\n    \n                    owner.trigger('change');\n                });\n    \n                label.on( 'mouseenter mouseleave', mouseHandler );\n    \n            },\n    \n    \n            getFiles: function() {\n                return this.files;\n            },\n    \n            destroy: function() {\n                this.input.off();\n                this.label.off();\n            }\n        });\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/util',[\n        'base'\n    ], function( Base ) {\n    \n        var urlAPI = window.createObjectURL && window ||\n                window.URL && URL.revokeObjectURL && URL ||\n                window.webkitURL,\n            createObjectURL = Base.noop,\n            revokeObjectURL = createObjectURL;\n    \n        if ( urlAPI ) {\n    \n            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n            createObjectURL = function() {\n                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n            };\n    \n            revokeObjectURL = function() {\n                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n            };\n        }\n    \n        return {\n            createObjectURL: createObjectURL,\n            revokeObjectURL: revokeObjectURL,\n    \n            dataURL2Blob: function( dataURI ) {\n                var byteStr, intArray, ab, i, mimetype, parts;\n    \n                parts = dataURI.split(',');\n    \n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n    \n                ab = new ArrayBuffer( byteStr.length );\n                intArray = new Uint8Array( ab );\n    \n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n    \n                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n    \n                return this.arrayBufferToBlob( ab, mimetype );\n            },\n    \n            dataURL2ArrayBuffer: function( dataURI ) {\n                var byteStr, intArray, i, parts;\n    \n                parts = dataURI.split(',');\n    \n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n    \n                intArray = new Uint8Array( byteStr.length );\n    \n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n    \n                return intArray.buffer;\n            },\n    \n            arrayBufferToBlob: function( buffer, type ) {\n                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n                    bb;\n    \n                // android不支持直接new Blob, 只能借助blobbuilder.\n                if ( builder ) {\n                    bb = new builder();\n                    bb.append( buffer );\n                    return bb.getBlob( type );\n                }\n    \n                return new Blob([ buffer ], type ? { type: type } : {} );\n            },\n    \n            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n            // 你得到的结果是png.\n            canvasToDataUrl: function( canvas, type, quality ) {\n                return canvas.toDataURL( type, quality / 100 );\n            },\n    \n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            parseMeta: function( blob, callback ) {\n                callback( false, {});\n            },\n    \n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            updateImageHead: function( data ) {\n                return data;\n            }\n        };\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/imagemeta',[\n        'runtime/html5/util'\n    ], function( Util ) {\n    \n        var api;\n    \n        api = {\n            parsers: {\n                0xffe1: []\n            },\n    \n            maxMetaDataSize: 262144,\n    \n            parse: function( blob, cb ) {\n                var me = this,\n                    fr = new FileReader();\n    \n                fr.onload = function() {\n                    cb( false, me._parse( this.result ) );\n                    fr = fr.onload = fr.onerror = null;\n                };\n    \n                fr.onerror = function( e ) {\n                    cb( e.message );\n                    fr = fr.onload = fr.onerror = null;\n                };\n    \n                blob = blob.slice( 0, me.maxMetaDataSize );\n                fr.readAsArrayBuffer( blob.getSource() );\n            },\n    \n            _parse: function( buffer, noParse ) {\n                if ( buffer.byteLength < 6 ) {\n                    return;\n                }\n    \n                var dataview = new DataView( buffer ),\n                    offset = 2,\n                    maxOffset = dataview.byteLength - 4,\n                    headLength = offset,\n                    ret = {},\n                    markerBytes, markerLength, parsers, i;\n    \n                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n    \n                    while ( offset < maxOffset ) {\n                        markerBytes = dataview.getUint16( offset );\n    \n                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n                                markerBytes === 0xfffe ) {\n    \n                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n    \n                            if ( offset + markerLength > dataview.byteLength ) {\n                                break;\n                            }\n    \n                            parsers = api.parsers[ markerBytes ];\n    \n                            if ( !noParse && parsers ) {\n                                for ( i = 0; i < parsers.length; i += 1 ) {\n                                    parsers[ i ].call( api, dataview, offset,\n                                            markerLength, ret );\n                                }\n                            }\n    \n                            offset += markerLength;\n                            headLength = offset;\n                        } else {\n                            break;\n                        }\n                    }\n    \n                    if ( headLength > 6 ) {\n                        if ( buffer.slice ) {\n                            ret.imageHead = buffer.slice( 2, headLength );\n                        } else {\n                            // Workaround for IE10, which does not yet\n                            // support ArrayBuffer.slice:\n                            ret.imageHead = new Uint8Array( buffer )\n                                    .subarray( 2, headLength );\n                        }\n                    }\n                }\n    \n                return ret;\n            },\n    \n            updateImageHead: function( buffer, head ) {\n                var data = this._parse( buffer, true ),\n                    buf1, buf2, bodyoffset;\n    \n    \n                bodyoffset = 2;\n                if ( data.imageHead ) {\n                    bodyoffset = 2 + data.imageHead.byteLength;\n                }\n    \n                if ( buffer.slice ) {\n                    buf2 = buffer.slice( bodyoffset );\n                } else {\n                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n                }\n    \n                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n    \n                buf1[ 0 ] = 0xFF;\n                buf1[ 1 ] = 0xD8;\n                buf1.set( new Uint8Array( head ), 2 );\n                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n    \n                return buf1.buffer;\n            }\n        };\n    \n        Util.parseMeta = function() {\n            return api.parse.apply( api, arguments );\n        };\n    \n        Util.updateImageHead = function() {\n            return api.updateImageHead.apply( api, arguments );\n        };\n    \n        return api;\n    });\n    /**\n     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n     * 暂时项目中只用了orientation.\n     *\n     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n     * @fileOverview EXIF解析\n     */\n    \n    // Sample\n    // ====================================\n    // Make : Apple\n    // Model : iPhone 4S\n    // Orientation : 1\n    // XResolution : 72 [72/1]\n    // YResolution : 72 [72/1]\n    // ResolutionUnit : 2\n    // Software : QuickTime 7.7.1\n    // DateTime : 2013:09:01 22:53:55\n    // ExifIFDPointer : 190\n    // ExposureTime : 0.058823529411764705 [1/17]\n    // FNumber : 2.4 [12/5]\n    // ExposureProgram : Normal program\n    // ISOSpeedRatings : 800\n    // ExifVersion : 0220\n    // DateTimeOriginal : 2013:09:01 22:52:51\n    // DateTimeDigitized : 2013:09:01 22:52:51\n    // ComponentsConfiguration : YCbCr\n    // ShutterSpeedValue : 4.058893515764426\n    // ApertureValue : 2.5260688216892597 [4845/1918]\n    // BrightnessValue : -0.3126686601998395\n    // MeteringMode : Pattern\n    // Flash : Flash did not fire, compulsory flash mode\n    // FocalLength : 4.28 [107/25]\n    // SubjectArea : [4 values]\n    // FlashpixVersion : 0100\n    // ColorSpace : 1\n    // PixelXDimension : 2448\n    // PixelYDimension : 3264\n    // SensingMethod : One-chip color area sensor\n    // ExposureMode : 0\n    // WhiteBalance : Auto white balance\n    // FocalLengthIn35mmFilm : 35\n    // SceneCaptureType : Standard\n    define('runtime/html5/imagemeta/exif',[\n        'base',\n        'runtime/html5/imagemeta'\n    ], function( Base, ImageMeta ) {\n    \n        var EXIF = {};\n    \n        EXIF.ExifMap = function() {\n            return this;\n        };\n    \n        EXIF.ExifMap.prototype.map = {\n            'Orientation': 0x0112\n        };\n    \n        EXIF.ExifMap.prototype.get = function( id ) {\n            return this[ id ] || this[ this.map[ id ] ];\n        };\n    \n        EXIF.exifTagTypes = {\n            // byte, 8-bit unsigned int:\n            1: {\n                getValue: function( dataView, dataOffset ) {\n                    return dataView.getUint8( dataOffset );\n                },\n                size: 1\n            },\n    \n            // ascii, 8-bit byte:\n            2: {\n                getValue: function( dataView, dataOffset ) {\n                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n                },\n                size: 1,\n                ascii: true\n            },\n    \n            // short, 16 bit int:\n            3: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint16( dataOffset, littleEndian );\n                },\n                size: 2\n            },\n    \n            // long, 32 bit int:\n            4: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n    \n            // rational = two long values,\n            // first is numerator, second is denominator:\n            5: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian ) /\n                        dataView.getUint32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            },\n    \n            // slong, 32 bit signed int:\n            9: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n    \n            // srational, two slongs, first is numerator, second is denominator:\n            10: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian ) /\n                        dataView.getInt32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            }\n        };\n    \n        // undefined, 8-bit byte, value depending on field:\n        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n    \n        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n                littleEndian ) {\n    \n            var tagType = EXIF.exifTagTypes[ type ],\n                tagSize, dataOffset, values, i, str, c;\n    \n            if ( !tagType ) {\n                Base.log('Invalid Exif data: Invalid tag type.');\n                return;\n            }\n    \n            tagSize = tagType.size * length;\n    \n            // Determine if the value is contained in the dataOffset bytes,\n            // or if the value at the dataOffset is a pointer to the actual data:\n            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n                    littleEndian ) : (offset + 8);\n    \n            if ( dataOffset + tagSize > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid data offset.');\n                return;\n            }\n    \n            if ( length === 1 ) {\n                return tagType.getValue( dataView, dataOffset, littleEndian );\n            }\n    \n            values = [];\n    \n            for ( i = 0; i < length; i += 1 ) {\n                values[ i ] = tagType.getValue( dataView,\n                        dataOffset + i * tagType.size, littleEndian );\n            }\n    \n            if ( tagType.ascii ) {\n                str = '';\n    \n                // Concatenate the chars:\n                for ( i = 0; i < values.length; i += 1 ) {\n                    c = values[ i ];\n    \n                    // Ignore the terminating NULL byte(s):\n                    if ( c === '\\u0000' ) {\n                        break;\n                    }\n                    str += c;\n                }\n    \n                return str;\n            }\n            return values;\n        };\n    \n        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n                data ) {\n    \n            var tag = dataView.getUint16( offset, littleEndian );\n            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n                    littleEndian );\n        };\n    \n        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n                littleEndian, data ) {\n    \n            var tagsNumber, dirEndOffset, i;\n    \n            if ( dirOffset + 6 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory offset.');\n                return;\n            }\n    \n            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n    \n            if ( dirEndOffset + 4 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory size.');\n                return;\n            }\n    \n            for ( i = 0; i < tagsNumber; i += 1 ) {\n                this.parseExifTag( dataView, tiffOffset,\n                        dirOffset + 2 + 12 * i,    // tag offset\n                        littleEndian, data );\n            }\n    \n            // Return the offset to the next directory:\n            return dataView.getUint32( dirEndOffset, littleEndian );\n        };\n    \n        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n        //     var hexData,\n        //         i,\n        //         b;\n        //     if (!length || offset + length > dataView.byteLength) {\n        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n        //         return;\n        //     }\n        //     hexData = [];\n        //     for (i = 0; i < length; i += 1) {\n        //         b = dataView.getUint8(offset + i);\n        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n        //     }\n        //     return 'data:image/jpeg,%' + hexData.join('%');\n        // };\n    \n        EXIF.parseExifData = function( dataView, offset, length, data ) {\n    \n            var tiffOffset = offset + 10,\n                littleEndian, dirOffset;\n    \n            // Check for the ASCII code for \"Exif\" (0x45786966):\n            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n                // No Exif data, might be XMP data instead\n                return;\n            }\n            if ( tiffOffset + 8 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid segment size.');\n                return;\n            }\n    \n            // Check for the two null bytes:\n            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n                Base.log('Invalid Exif data: Missing byte alignment offset.');\n                return;\n            }\n    \n            // Check the byte alignment:\n            switch ( dataView.getUint16( tiffOffset ) ) {\n                case 0x4949:\n                    littleEndian = true;\n                    break;\n    \n                case 0x4D4D:\n                    littleEndian = false;\n                    break;\n    \n                default:\n                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n                    return;\n            }\n    \n            // Check for the TIFF tag marker (0x002A):\n            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n                Base.log('Invalid Exif data: Missing TIFF marker.');\n                return;\n            }\n    \n            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n            // Create the exif object to store the tags:\n            data.exif = new EXIF.ExifMap();\n            // Parse the tags of the main image directory and retrieve the\n            // offset to the next directory, usually the thumbnail directory:\n            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n                    tiffOffset + dirOffset, littleEndian, data );\n    \n            // 尝试读取缩略图\n            // if ( dirOffset ) {\n            //     thumbnailData = {exif: {}};\n            //     dirOffset = EXIF.parseExifTags(\n            //         dataView,\n            //         tiffOffset,\n            //         tiffOffset + dirOffset,\n            //         littleEndian,\n            //         thumbnailData\n            //     );\n    \n            //     // Check for JPEG Thumbnail offset:\n            //     if (thumbnailData.exif[0x0201]) {\n            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n            //             dataView,\n            //             tiffOffset + thumbnailData.exif[0x0201],\n            //             thumbnailData.exif[0x0202] // Thumbnail data length\n            //         );\n            //     }\n            // }\n        };\n    \n        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n        return EXIF;\n    });\n    /**\n     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n     * android里面toDataUrl('image/jpege')得到的结果却是png.\n     *\n     * 所以这里没辙，只能借助这个工具\n     * @fileOverview jpeg encoder\n     */\n    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n    \n        /*\n          Copyright (c) 2008, Adobe Systems Incorporated\n          All rights reserved.\n    \n          Redistribution and use in source and binary forms, with or without\n          modification, are permitted provided that the following conditions are\n          met:\n    \n          * Redistributions of source code must retain the above copyright notice,\n            this list of conditions and the following disclaimer.\n    \n          * Redistributions in binary form must reproduce the above copyright\n            notice, this list of conditions and the following disclaimer in the\n            documentation and/or other materials provided with the distribution.\n    \n          * Neither the name of Adobe Systems Incorporated nor the names of its\n            contributors may be used to endorse or promote products derived from\n            this software without specific prior written permission.\n    \n          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n        */\n        /*\n        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n    \n        Basic GUI blocking jpeg encoder\n        */\n    \n        function JPEGEncoder(quality) {\n          var self = this;\n            var fround = Math.round;\n            var ffloor = Math.floor;\n            var YTable = new Array(64);\n            var UVTable = new Array(64);\n            var fdtbl_Y = new Array(64);\n            var fdtbl_UV = new Array(64);\n            var YDC_HT;\n            var UVDC_HT;\n            var YAC_HT;\n            var UVAC_HT;\n    \n            var bitcode = new Array(65535);\n            var category = new Array(65535);\n            var outputfDCTQuant = new Array(64);\n            var DU = new Array(64);\n            var byteout = [];\n            var bytenew = 0;\n            var bytepos = 7;\n    \n            var YDU = new Array(64);\n            var UDU = new Array(64);\n            var VDU = new Array(64);\n            var clt = new Array(256);\n            var RGB_YUV_TABLE = new Array(2048);\n            var currentQuality;\n    \n            var ZigZag = [\n                     0, 1, 5, 6,14,15,27,28,\n                     2, 4, 7,13,16,26,29,42,\n                     3, 8,12,17,25,30,41,43,\n                     9,11,18,24,31,40,44,53,\n                    10,19,23,32,39,45,52,54,\n                    20,22,33,38,46,51,55,60,\n                    21,34,37,47,50,56,59,61,\n                    35,36,48,49,57,58,62,63\n                ];\n    \n            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n            var std_ac_luminance_values = [\n                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n    \n            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n            var std_ac_chrominance_values = [\n                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n    \n            function initQuantTables(sf){\n                    var YQT = [\n                        16, 11, 10, 16, 24, 40, 51, 61,\n                        12, 12, 14, 19, 26, 58, 60, 55,\n                        14, 13, 16, 24, 40, 57, 69, 56,\n                        14, 17, 22, 29, 51, 87, 80, 62,\n                        18, 22, 37, 56, 68,109,103, 77,\n                        24, 35, 55, 64, 81,104,113, 92,\n                        49, 64, 78, 87,103,121,120,101,\n                        72, 92, 95, 98,112,100,103, 99\n                    ];\n    \n                    for (var i = 0; i < 64; i++) {\n                        var t = ffloor((YQT[i]*sf+50)/100);\n                        if (t < 1) {\n                            t = 1;\n                        } else if (t > 255) {\n                            t = 255;\n                        }\n                        YTable[ZigZag[i]] = t;\n                    }\n                    var UVQT = [\n                        17, 18, 24, 47, 99, 99, 99, 99,\n                        18, 21, 26, 66, 99, 99, 99, 99,\n                        24, 26, 56, 99, 99, 99, 99, 99,\n                        47, 66, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99\n                    ];\n                    for (var j = 0; j < 64; j++) {\n                        var u = ffloor((UVQT[j]*sf+50)/100);\n                        if (u < 1) {\n                            u = 1;\n                        } else if (u > 255) {\n                            u = 255;\n                        }\n                        UVTable[ZigZag[j]] = u;\n                    }\n                    var aasf = [\n                        1.0, 1.387039845, 1.306562965, 1.175875602,\n                        1.0, 0.785694958, 0.541196100, 0.275899379\n                    ];\n                    var k = 0;\n                    for (var row = 0; row < 8; row++)\n                    {\n                        for (var col = 0; col < 8; col++)\n                        {\n                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            k++;\n                        }\n                    }\n                }\n    \n                function computeHuffmanTbl(nrcodes, std_table){\n                    var codevalue = 0;\n                    var pos_in_table = 0;\n                    var HT = new Array();\n                    for (var k = 1; k <= 16; k++) {\n                        for (var j = 1; j <= nrcodes[k]; j++) {\n                            HT[std_table[pos_in_table]] = [];\n                            HT[std_table[pos_in_table]][0] = codevalue;\n                            HT[std_table[pos_in_table]][1] = k;\n                            pos_in_table++;\n                            codevalue++;\n                        }\n                        codevalue*=2;\n                    }\n                    return HT;\n                }\n    \n                function initHuffmanTbl()\n                {\n                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n                }\n    \n                function initCategoryNumber()\n                {\n                    var nrlower = 1;\n                    var nrupper = 2;\n                    for (var cat = 1; cat <= 15; cat++) {\n                        //Positive numbers\n                        for (var nr = nrlower; nr<nrupper; nr++) {\n                            category[32767+nr] = cat;\n                            bitcode[32767+nr] = [];\n                            bitcode[32767+nr][1] = cat;\n                            bitcode[32767+nr][0] = nr;\n                        }\n                        //Negative numbers\n                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n                            category[32767+nrneg] = cat;\n                            bitcode[32767+nrneg] = [];\n                            bitcode[32767+nrneg][1] = cat;\n                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n                        }\n                        nrlower <<= 1;\n                        nrupper <<= 1;\n                    }\n                }\n    \n                function initRGBYUVTable() {\n                    for(var i = 0; i < 256;i++) {\n                        RGB_YUV_TABLE[i]            =  19595 * i;\n                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n                    }\n                }\n    \n                // IO functions\n                function writeBits(bs)\n                {\n                    var value = bs[0];\n                    var posval = bs[1]-1;\n                    while ( posval >= 0 ) {\n                        if (value & (1 << posval) ) {\n                            bytenew |= (1 << bytepos);\n                        }\n                        posval--;\n                        bytepos--;\n                        if (bytepos < 0) {\n                            if (bytenew == 0xFF) {\n                                writeByte(0xFF);\n                                writeByte(0);\n                            }\n                            else {\n                                writeByte(bytenew);\n                            }\n                            bytepos=7;\n                            bytenew=0;\n                        }\n                    }\n                }\n    \n                function writeByte(value)\n                {\n                    byteout.push(clt[value]); // write char directly instead of converting later\n                }\n    \n                function writeWord(value)\n                {\n                    writeByte((value>>8)&0xFF);\n                    writeByte((value   )&0xFF);\n                }\n    \n                // DCT & quantization core\n                function fDCTQuant(data, fdtbl)\n                {\n                    var d0, d1, d2, d3, d4, d5, d6, d7;\n                    /* Pass 1: process rows. */\n                    var dataOff=0;\n                    var i;\n                    var I8 = 8;\n                    var I64 = 64;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff+1];\n                        d2 = data[dataOff+2];\n                        d3 = data[dataOff+3];\n                        d4 = data[dataOff+4];\n                        d5 = data[dataOff+5];\n                        d6 = data[dataOff+6];\n                        d7 = data[dataOff+7];\n    \n                        var tmp0 = d0 + d7;\n                        var tmp7 = d0 - d7;\n                        var tmp1 = d1 + d6;\n                        var tmp6 = d1 - d6;\n                        var tmp2 = d2 + d5;\n                        var tmp5 = d2 - d5;\n                        var tmp3 = d3 + d4;\n                        var tmp4 = d3 - d4;\n    \n                        /* Even part */\n                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n                        var tmp13 = tmp0 - tmp3;\n                        var tmp11 = tmp1 + tmp2;\n                        var tmp12 = tmp1 - tmp2;\n    \n                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n                        data[dataOff+4] = tmp10 - tmp11;\n    \n                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n                        data[dataOff+6] = tmp13 - z1;\n    \n                        /* Odd part */\n                        tmp10 = tmp4 + tmp5; /* phase 2 */\n                        tmp11 = tmp5 + tmp6;\n                        tmp12 = tmp6 + tmp7;\n    \n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n                        var z3 = tmp11 * 0.707106781; /* c4 */\n    \n                        var z11 = tmp7 + z3;    /* phase 5 */\n                        var z13 = tmp7 - z3;\n    \n                        data[dataOff+5] = z13 + z2; /* phase 6 */\n                        data[dataOff+3] = z13 - z2;\n                        data[dataOff+1] = z11 + z4;\n                        data[dataOff+7] = z11 - z4;\n    \n                        dataOff += 8; /* advance pointer to next row */\n                    }\n    \n                    /* Pass 2: process columns. */\n                    dataOff = 0;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff + 8];\n                        d2 = data[dataOff + 16];\n                        d3 = data[dataOff + 24];\n                        d4 = data[dataOff + 32];\n                        d5 = data[dataOff + 40];\n                        d6 = data[dataOff + 48];\n                        d7 = data[dataOff + 56];\n    \n                        var tmp0p2 = d0 + d7;\n                        var tmp7p2 = d0 - d7;\n                        var tmp1p2 = d1 + d6;\n                        var tmp6p2 = d1 - d6;\n                        var tmp2p2 = d2 + d5;\n                        var tmp5p2 = d2 - d5;\n                        var tmp3p2 = d3 + d4;\n                        var tmp4p2 = d3 - d4;\n    \n                        /* Even part */\n                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n                        var tmp13p2 = tmp0p2 - tmp3p2;\n                        var tmp11p2 = tmp1p2 + tmp2p2;\n                        var tmp12p2 = tmp1p2 - tmp2p2;\n    \n                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n                        data[dataOff+32] = tmp10p2 - tmp11p2;\n    \n                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n                        data[dataOff+48] = tmp13p2 - z1p2;\n    \n                        /* Odd part */\n                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n                        tmp11p2 = tmp5p2 + tmp6p2;\n                        tmp12p2 = tmp6p2 + tmp7p2;\n    \n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n    \n                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n                        var z13p2 = tmp7p2 - z3p2;\n    \n                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n                        data[dataOff+24] = z13p2 - z2p2;\n                        data[dataOff+ 8] = z11p2 + z4p2;\n                        data[dataOff+56] = z11p2 - z4p2;\n    \n                        dataOff++; /* advance pointer to next column */\n                    }\n    \n                    // Quantize/descale the coefficients\n                    var fDCTQuant;\n                    for (i=0; i<I64; ++i)\n                    {\n                        // Apply the quantization and scaling factor & Round to nearest integer\n                        fDCTQuant = data[i]*fdtbl[i];\n                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n                        //outputfDCTQuant[i] = fround(fDCTQuant);\n    \n                    }\n                    return outputfDCTQuant;\n                }\n    \n                function writeAPP0()\n                {\n                    writeWord(0xFFE0); // marker\n                    writeWord(16); // length\n                    writeByte(0x4A); // J\n                    writeByte(0x46); // F\n                    writeByte(0x49); // I\n                    writeByte(0x46); // F\n                    writeByte(0); // = \"JFIF\",'\\0'\n                    writeByte(1); // versionhi\n                    writeByte(1); // versionlo\n                    writeByte(0); // xyunits\n                    writeWord(1); // xdensity\n                    writeWord(1); // ydensity\n                    writeByte(0); // thumbnwidth\n                    writeByte(0); // thumbnheight\n                }\n    \n                function writeSOF0(width, height)\n                {\n                    writeWord(0xFFC0); // marker\n                    writeWord(17);   // length, truecolor YUV JPG\n                    writeByte(8);    // precision\n                    writeWord(height);\n                    writeWord(width);\n                    writeByte(3);    // nrofcomponents\n                    writeByte(1);    // IdY\n                    writeByte(0x11); // HVY\n                    writeByte(0);    // QTY\n                    writeByte(2);    // IdU\n                    writeByte(0x11); // HVU\n                    writeByte(1);    // QTU\n                    writeByte(3);    // IdV\n                    writeByte(0x11); // HVV\n                    writeByte(1);    // QTV\n                }\n    \n                function writeDQT()\n                {\n                    writeWord(0xFFDB); // marker\n                    writeWord(132);    // length\n                    writeByte(0);\n                    for (var i=0; i<64; i++) {\n                        writeByte(YTable[i]);\n                    }\n                    writeByte(1);\n                    for (var j=0; j<64; j++) {\n                        writeByte(UVTable[j]);\n                    }\n                }\n    \n                function writeDHT()\n                {\n                    writeWord(0xFFC4); // marker\n                    writeWord(0x01A2); // length\n    \n                    writeByte(0); // HTYDCinfo\n                    for (var i=0; i<16; i++) {\n                        writeByte(std_dc_luminance_nrcodes[i+1]);\n                    }\n                    for (var j=0; j<=11; j++) {\n                        writeByte(std_dc_luminance_values[j]);\n                    }\n    \n                    writeByte(0x10); // HTYACinfo\n                    for (var k=0; k<16; k++) {\n                        writeByte(std_ac_luminance_nrcodes[k+1]);\n                    }\n                    for (var l=0; l<=161; l++) {\n                        writeByte(std_ac_luminance_values[l]);\n                    }\n    \n                    writeByte(1); // HTUDCinfo\n                    for (var m=0; m<16; m++) {\n                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n                    }\n                    for (var n=0; n<=11; n++) {\n                        writeByte(std_dc_chrominance_values[n]);\n                    }\n    \n                    writeByte(0x11); // HTUACinfo\n                    for (var o=0; o<16; o++) {\n                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n                    }\n                    for (var p=0; p<=161; p++) {\n                        writeByte(std_ac_chrominance_values[p]);\n                    }\n                }\n    \n                function writeSOS()\n                {\n                    writeWord(0xFFDA); // marker\n                    writeWord(12); // length\n                    writeByte(3); // nrofcomponents\n                    writeByte(1); // IdY\n                    writeByte(0); // HTY\n                    writeByte(2); // IdU\n                    writeByte(0x11); // HTU\n                    writeByte(3); // IdV\n                    writeByte(0x11); // HTV\n                    writeByte(0); // Ss\n                    writeByte(0x3f); // Se\n                    writeByte(0); // Bf\n                }\n    \n                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n                    var EOB = HTAC[0x00];\n                    var M16zeroes = HTAC[0xF0];\n                    var pos;\n                    var I16 = 16;\n                    var I63 = 63;\n                    var I64 = 64;\n                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n                    //ZigZag reorder\n                    for (var j=0;j<I64;++j) {\n                        DU[ZigZag[j]]=DU_DCT[j];\n                    }\n                    var Diff = DU[0] - DC; DC = DU[0];\n                    //Encode DC\n                    if (Diff==0) {\n                        writeBits(HTDC[0]); // Diff might be 0\n                    } else {\n                        pos = 32767+Diff;\n                        writeBits(HTDC[category[pos]]);\n                        writeBits(bitcode[pos]);\n                    }\n                    //Encode ACs\n                    var end0pos = 63; // was const... which is crazy\n                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n                    //end0pos = first element in reverse order !=0\n                    if ( end0pos == 0) {\n                        writeBits(EOB);\n                        return DC;\n                    }\n                    var i = 1;\n                    var lng;\n                    while ( i <= end0pos ) {\n                        var startpos = i;\n                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n                        var nrzeroes = i-startpos;\n                        if ( nrzeroes >= I16 ) {\n                            lng = nrzeroes>>4;\n                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n                                writeBits(M16zeroes);\n                            nrzeroes = nrzeroes&0xF;\n                        }\n                        pos = 32767+DU[i];\n                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n                        writeBits(bitcode[pos]);\n                        i++;\n                    }\n                    if ( end0pos != I63 ) {\n                        writeBits(EOB);\n                    }\n                    return DC;\n                }\n    \n                function initCharLookupTable(){\n                    var sfcc = String.fromCharCode;\n                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n                        clt[i] = sfcc(i);\n                    }\n                }\n    \n                this.encode = function(image,quality) // image data object\n                {\n                    // var time_start = new Date().getTime();\n    \n                    if(quality) setQuality(quality);\n    \n                    // Initialize bit writer\n                    byteout = new Array();\n                    bytenew=0;\n                    bytepos=7;\n    \n                    // Add JPEG headers\n                    writeWord(0xFFD8); // SOI\n                    writeAPP0();\n                    writeDQT();\n                    writeSOF0(image.width,image.height);\n                    writeDHT();\n                    writeSOS();\n    \n    \n                    // Encode 8x8 macroblocks\n                    var DCY=0;\n                    var DCU=0;\n                    var DCV=0;\n    \n                    bytenew=0;\n                    bytepos=7;\n    \n    \n                    this.encode.displayName = \"_encode_\";\n    \n                    var imageData = image.data;\n                    var width = image.width;\n                    var height = image.height;\n    \n                    var quadWidth = width*4;\n                    var tripleWidth = width*3;\n    \n                    var x, y = 0;\n                    var r, g, b;\n                    var start,p, col,row,pos;\n                    while(y < height){\n                        x = 0;\n                        while(x < quadWidth){\n                        start = quadWidth * y + x;\n                        p = start;\n                        col = -1;\n                        row = 0;\n    \n                        for(pos=0; pos < 64; pos++){\n                            row = pos >> 3;// /8\n                            col = ( pos & 7 ) * 4; // %8\n                            p = start + ( row * quadWidth ) + col;\n    \n                            if(y+row >= height){ // padding bottom\n                                p-= (quadWidth*(y+1+row-height));\n                            }\n    \n                            if(x+col >= quadWidth){ // padding right\n                                p-= ((x+col) - quadWidth +4)\n                            }\n    \n                            r = imageData[ p++ ];\n                            g = imageData[ p++ ];\n                            b = imageData[ p++ ];\n    \n    \n                            /* // calculate YUV values dynamically\n                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n                            */\n    \n                            // use lookup table (slightly faster)\n                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n    \n                        }\n    \n                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n                        x+=32;\n                        }\n                        y+=8;\n                    }\n    \n    \n                    ////////////////////////////////////////////////////////////////\n    \n                    // Do the bit alignment of the EOI marker\n                    if ( bytepos >= 0 ) {\n                        var fillbits = [];\n                        fillbits[1] = bytepos+1;\n                        fillbits[0] = (1<<(bytepos+1))-1;\n                        writeBits(fillbits);\n                    }\n    \n                    writeWord(0xFFD9); //EOI\n    \n                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n    \n                    byteout = [];\n    \n                    // benchmarking\n                    // var duration = new Date().getTime() - time_start;\n                    // console.log('Encoding time: '+ currentQuality + 'ms');\n                    //\n    \n                    return jpegDataUri\n            }\n    \n            function setQuality(quality){\n                if (quality <= 0) {\n                    quality = 1;\n                }\n                if (quality > 100) {\n                    quality = 100;\n                }\n    \n                if(currentQuality == quality) return // don't recalc if unchanged\n    \n                var sf = 0;\n                if (quality < 50) {\n                    sf = Math.floor(5000 / quality);\n                } else {\n                    sf = Math.floor(200 - quality*2);\n                }\n    \n                initQuantTables(sf);\n                currentQuality = quality;\n                // console.log('Quality set to: '+quality +'%');\n            }\n    \n            function init(){\n                // var time_start = new Date().getTime();\n                if(!quality) quality = 50;\n                // Create tables\n                initCharLookupTable()\n                initHuffmanTbl();\n                initCategoryNumber();\n                initRGBYUVTable();\n    \n                setQuality(quality);\n                // var duration = new Date().getTime() - time_start;\n                // console.log('Initialization '+ duration + 'ms');\n            }\n    \n            init();\n    \n        }\n    \n        JPEGEncoder.encode = function( data, quality ) {\n            var encoder = new JPEGEncoder( quality );\n    \n            return encoder.encode( data );\n        }\n    \n        return JPEGEncoder;\n    });\n    /**\n     * @fileOverview Fix android canvas.toDataUrl bug.\n     */\n    define('runtime/html5/androidpatch',[\n        'runtime/html5/util',\n        'runtime/html5/jpegencoder',\n        'base'\n    ], function( Util, encoder, Base ) {\n        var origin = Util.canvasToDataUrl,\n            supportJpeg;\n    \n        Util.canvasToDataUrl = function( canvas, type, quality ) {\n            var ctx, w, h, fragement, parts;\n    \n            // 非android手机直接跳过。\n            if ( !Base.os.android ) {\n                return origin.apply( null, arguments );\n            }\n    \n            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n            // JPEG 前两位分别是：255, 216\n            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n                fragement = origin.apply( null, arguments );\n    \n                parts = fragement.split(',');\n    \n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    fragement = atob( parts[ 1 ] );\n                } else {\n                    fragement = decodeURIComponent( parts[ 1 ] );\n                }\n    \n                fragement = fragement.substring( 0, 2 );\n    \n                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n                        fragement.charCodeAt( 1 ) === 216;\n            }\n    \n            // 只有在android环境下才修复\n            if ( type === 'image/jpeg' && !supportJpeg ) {\n                w = canvas.width;\n                h = canvas.height;\n                ctx = canvas.getContext('2d');\n    \n                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n            }\n    \n            return origin.apply( null, arguments );\n        };\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('runtime/html5/image',[\n        'base',\n        'runtime/html5/runtime',\n        'runtime/html5/util'\n    ], function( Base, Html5Runtime, Util ) {\n    \n        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n    \n        return Html5Runtime.register( 'Image', {\n    \n            // flag: 标记是否被修改过。\n            modified: false,\n    \n            init: function() {\n                var me = this,\n                    img = new Image();\n    \n                img.onload = function() {\n    \n                    me._info = {\n                        type: me.type,\n                        width: this.width,\n                        height: this.height\n                    };\n    \n                    // 读取meta信息。\n                    if ( !me._metas && 'image/jpeg' === me.type ) {\n                        Util.parseMeta( me._blob, function( error, ret ) {\n                            me._metas = ret;\n                            me.owner.trigger('load');\n                        });\n                    } else {\n                        me.owner.trigger('load');\n                    }\n                };\n    \n                img.onerror = function() {\n                    me.owner.trigger('error');\n                };\n    \n                me._img = img;\n            },\n    \n            loadFromBlob: function( blob ) {\n                var me = this,\n                    img = me._img;\n    \n                me._blob = blob;\n                me.type = blob.type;\n                img.src = Util.createObjectURL( blob.getSource() );\n                me.owner.once( 'load', function() {\n                    Util.revokeObjectURL( img.src );\n                });\n            },\n    \n            resize: function( width, height ) {\n                var canvas = this._canvas ||\n                        (this._canvas = document.createElement('canvas'));\n    \n                this._resize( this._img, canvas, width, height );\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'resize' );\n            },\n    \n            crop: function( x, y, w, h, s ) {\n                var cvs = this._canvas ||\n                        (this._canvas = document.createElement('canvas')),\n                    opts = this.options,\n                    img = this._img,\n                    iw = img.naturalWidth,\n                    ih = img.naturalHeight,\n                    orientation = this.getOrientation();\n    \n                s = s || 1;\n    \n                // todo 解决 orientation 的问题。\n                // values that require 90 degree rotation\n                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n    \n                //     switch ( orientation ) {\n                //         case 6:\n                //             tmp = x;\n                //             x = y;\n                //             y = iw * s - tmp - w;\n                //             console.log(ih * s, tmp, w)\n                //             break;\n                //     }\n    \n                //     (w ^= h, h ^= w, w ^= h);\n                // }\n    \n                cvs.width = w;\n                cvs.height = h;\n    \n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n    \n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'crop' );\n            },\n    \n            getAsBlob: function( type ) {\n                var blob = this._blob,\n                    opts = this.options,\n                    canvas;\n    \n                type = type || this.type;\n    \n                // blob需要重新生成。\n                if ( this.modified || this.type !== type ) {\n                    canvas = this._canvas;\n    \n                    if ( type === 'image/jpeg' ) {\n    \n                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n    \n                        if ( opts.preserveHeaders && this._metas &&\n                                this._metas.imageHead ) {\n    \n                            blob = Util.dataURL2ArrayBuffer( blob );\n                            blob = Util.updateImageHead( blob,\n                                    this._metas.imageHead );\n                            blob = Util.arrayBufferToBlob( blob, type );\n                            return blob;\n                        }\n                    } else {\n                        blob = Util.canvasToDataUrl( canvas, type );\n                    }\n    \n                    blob = Util.dataURL2Blob( blob );\n                }\n    \n                return blob;\n            },\n    \n            getAsDataUrl: function( type ) {\n                var opts = this.options;\n    \n                type = type || this.type;\n    \n                if ( type === 'image/jpeg' ) {\n                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n                } else {\n                    return this._canvas.toDataURL( type );\n                }\n            },\n    \n            getOrientation: function() {\n                return this._metas && this._metas.exif &&\n                        this._metas.exif.get('Orientation') || 1;\n            },\n    \n            info: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n    \n                // getter\n                return this._info;\n            },\n    \n            meta: function( val ) {\n    \n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n    \n                // getter\n                return this._meta;\n            },\n    \n            destroy: function() {\n                var canvas = this._canvas;\n                this._img.onload = null;\n    \n                if ( canvas ) {\n                    canvas.getContext('2d')\n                            .clearRect( 0, 0, canvas.width, canvas.height );\n                    canvas.width = canvas.height = 0;\n                    this._canvas = null;\n                }\n    \n                // 释放内存。非常重要，否则释放不了image的内存。\n                this._img.src = BLANK;\n                this._img = this._blob = null;\n            },\n    \n            _resize: function( img, cvs, width, height ) {\n                var opts = this.options,\n                    naturalWidth = img.width,\n                    naturalHeight = img.height,\n                    orientation = this.getOrientation(),\n                    scale, w, h, x, y;\n    \n                // values that require 90 degree rotation\n                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n    \n                    // 交换width, height的值。\n                    width ^= height;\n                    height ^= width;\n                    width ^= height;\n                }\n    \n                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n                        height / naturalHeight );\n    \n                // 不允许放大。\n                opts.allowMagnify || (scale = Math.min( 1, scale ));\n    \n                w = naturalWidth * scale;\n                h = naturalHeight * scale;\n    \n                if ( opts.crop ) {\n                    cvs.width = width;\n                    cvs.height = height;\n                } else {\n                    cvs.width = w;\n                    cvs.height = h;\n                }\n    \n                x = (cvs.width - w) / 2;\n                y = (cvs.height - h) / 2;\n    \n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n    \n                this._renderImageToCanvas( cvs, img, x, y, w, h );\n            },\n    \n            _rotate2Orientaion: function( canvas, orientation ) {\n                var width = canvas.width,\n                    height = canvas.height,\n                    ctx = canvas.getContext('2d');\n    \n                switch ( orientation ) {\n                    case 5:\n                    case 6:\n                    case 7:\n                    case 8:\n                        canvas.width = height;\n                        canvas.height = width;\n                        break;\n                }\n    \n                switch ( orientation ) {\n                    case 2:    // horizontal flip\n                        ctx.translate( width, 0 );\n                        ctx.scale( -1, 1 );\n                        break;\n    \n                    case 3:    // 180 rotate left\n                        ctx.translate( width, height );\n                        ctx.rotate( Math.PI );\n                        break;\n    \n                    case 4:    // vertical flip\n                        ctx.translate( 0, height );\n                        ctx.scale( 1, -1 );\n                        break;\n    \n                    case 5:    // vertical flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.scale( 1, -1 );\n                        break;\n    \n                    case 6:    // 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( 0, -height );\n                        break;\n    \n                    case 7:    // horizontal flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( width, -height );\n                        ctx.scale( -1, 1 );\n                        break;\n    \n                    case 8:    // 90 rotate left\n                        ctx.rotate( -0.5 * Math.PI );\n                        ctx.translate( -width, 0 );\n                        break;\n                }\n            },\n    \n            // https://github.com/stomita/ios-imagefile-megapixel/\n            // blob/master/src/megapix-image.js\n            _renderImageToCanvas: (function() {\n    \n                // 如果不是ios, 不需要这么复杂！\n                if ( !Base.os.ios ) {\n                    return function( canvas ) {\n                        var args = Base.slice( arguments, 1 ),\n                            ctx = canvas.getContext('2d');\n    \n                        ctx.drawImage.apply( ctx, args );\n                    };\n                }\n    \n                /**\n                 * Detecting vertical squash in loaded image.\n                 * Fixes a bug which squash image vertically while drawing into\n                 * canvas for some images.\n                 */\n                function detectVerticalSquash( img, iw, ih ) {\n                    var canvas = document.createElement('canvas'),\n                        ctx = canvas.getContext('2d'),\n                        sy = 0,\n                        ey = ih,\n                        py = ih,\n                        data, alpha, ratio;\n    \n    \n                    canvas.width = 1;\n                    canvas.height = ih;\n                    ctx.drawImage( img, 0, 0 );\n                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n    \n                    // search image edge pixel position in case\n                    // it is squashed vertically.\n                    while ( py > sy ) {\n                        alpha = data[ (py - 1) * 4 + 3 ];\n    \n                        if ( alpha === 0 ) {\n                            ey = py;\n                        } else {\n                            sy = py;\n                        }\n    \n                        py = (ey + sy) >> 1;\n                    }\n    \n                    ratio = (py / ih);\n                    return (ratio === 0) ? 1 : ratio;\n                }\n    \n                // fix ie7 bug\n                // http://stackoverflow.com/questions/11929099/\n                // html5-canvas-drawimage-ratio-bug-ios\n                if ( Base.os.ios >= 7 ) {\n                    return function( canvas, img, x, y, w, h ) {\n                        var iw = img.naturalWidth,\n                            ih = img.naturalHeight,\n                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n    \n                        return canvas.getContext('2d').drawImage( img, 0, 0,\n                                iw * vertSquashRatio, ih * vertSquashRatio,\n                                x, y, w, h );\n                    };\n                }\n    \n                /**\n                 * Detect subsampling in loaded image.\n                 * In iOS, larger images than 2M pixels may be\n                 * subsampled in rendering.\n                 */\n                function detectSubsampling( img ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        canvas, ctx;\n    \n                    // subsampling may happen overmegapixel image\n                    if ( iw * ih > 1024 * 1024 ) {\n                        canvas = document.createElement('canvas');\n                        canvas.width = canvas.height = 1;\n                        ctx = canvas.getContext('2d');\n                        ctx.drawImage( img, -iw + 1, 0 );\n    \n                        // subsampled image becomes half smaller in rendering size.\n                        // check alpha channel value to confirm image is covering\n                        // edge pixel or not. if alpha value is 0\n                        // image is not covering, hence subsampled.\n                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n                    } else {\n                        return false;\n                    }\n                }\n    \n    \n                return function( canvas, img, x, y, width, height ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        ctx = canvas.getContext('2d'),\n                        subsampled = detectSubsampling( img ),\n                        doSquash = this.type === 'image/jpeg',\n                        d = 1024,\n                        sy = 0,\n                        dy = 0,\n                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n    \n                    if ( subsampled ) {\n                        iw /= 2;\n                        ih /= 2;\n                    }\n    \n                    ctx.save();\n                    tmpCanvas = document.createElement('canvas');\n                    tmpCanvas.width = tmpCanvas.height = d;\n    \n                    tmpCtx = tmpCanvas.getContext('2d');\n                    vertSquashRatio = doSquash ?\n                            detectVerticalSquash( img, iw, ih ) : 1;\n    \n                    dw = Math.ceil( d * width / iw );\n                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n    \n                    while ( sy < ih ) {\n                        sx = 0;\n                        dx = 0;\n                        while ( sx < iw ) {\n                            tmpCtx.clearRect( 0, 0, d, d );\n                            tmpCtx.drawImage( img, -sx, -sy );\n                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n                                    x + dx, y + dy, dw, dh );\n                            sx += d;\n                            dx += dw;\n                        }\n                        sy += d;\n                        dy += dh;\n                    }\n                    ctx.restore();\n                    tmpCanvas = tmpCtx = null;\n                };\n            })()\n        });\n    });\n    /**\n     * @fileOverview Transport\n     * @todo 支持chunked传输，优势：\n     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n     */\n    define('runtime/html5/transport',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n    \n        var noop = Base.noop,\n            $ = Base.$;\n    \n        return Html5Runtime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n            },\n    \n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    formData, binary, fr;\n    \n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n    \n                    binary = blob.getSource();\n                } else {\n                    formData = new FormData();\n                    $.each( owner._formData, function( k, v ) {\n                        formData.append( k, v );\n                    });\n    \n                    formData.append( opts.fileVal, blob.getSource(),\n                            opts.filename || owner._formData.name || '' );\n                }\n    \n                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n                    xhr.open( opts.method, server, true );\n                    xhr.withCredentials = true;\n                } else {\n                    xhr.open( opts.method, server );\n                }\n    \n                this._setRequestHeader( xhr, opts.headers );\n    \n                if ( binary ) {\n                    // 强制设置成 content-type 为文件流。\n                    xhr.overrideMimeType &&\n                            xhr.overrideMimeType('application/octet-stream');\n    \n                    // android直接发送blob会导致服务端接收到的是空文件。\n                    // bug详情。\n                    // https://code.google.com/p/android/issues/detail?id=39882\n                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n                    if ( Base.os.android ) {\n                        fr = new FileReader();\n    \n                        fr.onload = function() {\n                            xhr.send( this.result );\n                            fr = fr.onload = null;\n                        };\n    \n                        fr.readAsArrayBuffer( binary );\n                    } else {\n                        xhr.send( binary );\n                    }\n                } else {\n                    xhr.send( formData );\n                }\n            },\n    \n            getResponse: function() {\n                return this._response;\n            },\n    \n            getResponseAsJson: function() {\n                return this._parseJson( this._response );\n            },\n    \n            getStatus: function() {\n                return this._status;\n            },\n    \n            abort: function() {\n                var xhr = this._xhr;\n    \n                if ( xhr ) {\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    xhr.abort();\n    \n                    this._xhr = xhr = null;\n                }\n            },\n    \n            destroy: function() {\n                this.abort();\n            },\n    \n            _initAjax: function() {\n                var me = this,\n                    xhr = new XMLHttpRequest(),\n                    opts = this.options;\n    \n                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n                        typeof XDomainRequest !== 'undefined' ) {\n                    xhr = new XDomainRequest();\n                }\n    \n                xhr.upload.onprogress = function( e ) {\n                    var percentage = 0;\n    \n                    if ( e.lengthComputable ) {\n                        percentage = e.loaded / e.total;\n                    }\n    \n                    return me.trigger( 'progress', percentage );\n                };\n    \n                xhr.onreadystatechange = function() {\n    \n                    if ( xhr.readyState !== 4 ) {\n                        return;\n                    }\n    \n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    me._xhr = null;\n                    me._status = xhr.status;\n    \n                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger('load');\n                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger( 'error', 'server' );\n                    }\n    \n    \n                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n                };\n    \n                me._xhr = xhr;\n                return xhr;\n            },\n    \n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.setRequestHeader( key, val );\n                });\n            },\n    \n            _parseJson: function( str ) {\n                var json;\n    \n                try {\n                    json = JSON.parse( str );\n                } catch ( ex ) {\n                    json = {};\n                }\n    \n                return json;\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/html5/md5',[\n        'runtime/html5/runtime'\n    ], function( FlashRuntime ) {\n    \n        /*\n         * Fastest md5 implementation around (JKM md5)\n         * Credits: Joseph Myers\n         *\n         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n         * @see http://jsperf.com/md5-shootout/7\n         */\n    \n        /* this function is much faster,\n          so if possible we use it. Some IEs\n          are the only ones I know of that\n          need the idiotic second function,\n          generated by an if clause.  */\n        var add32 = function (a, b) {\n            return (a + b) & 0xFFFFFFFF;\n        },\n    \n        cmn = function (q, a, b, x, s, t) {\n            a = add32(add32(a, q), add32(x, t));\n            return add32((a << s) | (a >>> (32 - s)), b);\n        },\n    \n        ff = function (a, b, c, d, x, s, t) {\n            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n        },\n    \n        gg = function (a, b, c, d, x, s, t) {\n            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n        },\n    \n        hh = function (a, b, c, d, x, s, t) {\n            return cmn(b ^ c ^ d, a, b, x, s, t);\n        },\n    \n        ii = function (a, b, c, d, x, s, t) {\n            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n        },\n    \n        md5cycle = function (x, k) {\n            var a = x[0],\n                b = x[1],\n                c = x[2],\n                d = x[3];\n    \n            a = ff(a, b, c, d, k[0], 7, -680876936);\n            d = ff(d, a, b, c, k[1], 12, -389564586);\n            c = ff(c, d, a, b, k[2], 17, 606105819);\n            b = ff(b, c, d, a, k[3], 22, -1044525330);\n            a = ff(a, b, c, d, k[4], 7, -176418897);\n            d = ff(d, a, b, c, k[5], 12, 1200080426);\n            c = ff(c, d, a, b, k[6], 17, -1473231341);\n            b = ff(b, c, d, a, k[7], 22, -45705983);\n            a = ff(a, b, c, d, k[8], 7, 1770035416);\n            d = ff(d, a, b, c, k[9], 12, -1958414417);\n            c = ff(c, d, a, b, k[10], 17, -42063);\n            b = ff(b, c, d, a, k[11], 22, -1990404162);\n            a = ff(a, b, c, d, k[12], 7, 1804603682);\n            d = ff(d, a, b, c, k[13], 12, -40341101);\n            c = ff(c, d, a, b, k[14], 17, -1502002290);\n            b = ff(b, c, d, a, k[15], 22, 1236535329);\n    \n            a = gg(a, b, c, d, k[1], 5, -165796510);\n            d = gg(d, a, b, c, k[6], 9, -1069501632);\n            c = gg(c, d, a, b, k[11], 14, 643717713);\n            b = gg(b, c, d, a, k[0], 20, -373897302);\n            a = gg(a, b, c, d, k[5], 5, -701558691);\n            d = gg(d, a, b, c, k[10], 9, 38016083);\n            c = gg(c, d, a, b, k[15], 14, -660478335);\n            b = gg(b, c, d, a, k[4], 20, -405537848);\n            a = gg(a, b, c, d, k[9], 5, 568446438);\n            d = gg(d, a, b, c, k[14], 9, -1019803690);\n            c = gg(c, d, a, b, k[3], 14, -187363961);\n            b = gg(b, c, d, a, k[8], 20, 1163531501);\n            a = gg(a, b, c, d, k[13], 5, -1444681467);\n            d = gg(d, a, b, c, k[2], 9, -51403784);\n            c = gg(c, d, a, b, k[7], 14, 1735328473);\n            b = gg(b, c, d, a, k[12], 20, -1926607734);\n    \n            a = hh(a, b, c, d, k[5], 4, -378558);\n            d = hh(d, a, b, c, k[8], 11, -2022574463);\n            c = hh(c, d, a, b, k[11], 16, 1839030562);\n            b = hh(b, c, d, a, k[14], 23, -35309556);\n            a = hh(a, b, c, d, k[1], 4, -1530992060);\n            d = hh(d, a, b, c, k[4], 11, 1272893353);\n            c = hh(c, d, a, b, k[7], 16, -155497632);\n            b = hh(b, c, d, a, k[10], 23, -1094730640);\n            a = hh(a, b, c, d, k[13], 4, 681279174);\n            d = hh(d, a, b, c, k[0], 11, -358537222);\n            c = hh(c, d, a, b, k[3], 16, -722521979);\n            b = hh(b, c, d, a, k[6], 23, 76029189);\n            a = hh(a, b, c, d, k[9], 4, -640364487);\n            d = hh(d, a, b, c, k[12], 11, -421815835);\n            c = hh(c, d, a, b, k[15], 16, 530742520);\n            b = hh(b, c, d, a, k[2], 23, -995338651);\n    \n            a = ii(a, b, c, d, k[0], 6, -198630844);\n            d = ii(d, a, b, c, k[7], 10, 1126891415);\n            c = ii(c, d, a, b, k[14], 15, -1416354905);\n            b = ii(b, c, d, a, k[5], 21, -57434055);\n            a = ii(a, b, c, d, k[12], 6, 1700485571);\n            d = ii(d, a, b, c, k[3], 10, -1894986606);\n            c = ii(c, d, a, b, k[10], 15, -1051523);\n            b = ii(b, c, d, a, k[1], 21, -2054922799);\n            a = ii(a, b, c, d, k[8], 6, 1873313359);\n            d = ii(d, a, b, c, k[15], 10, -30611744);\n            c = ii(c, d, a, b, k[6], 15, -1560198380);\n            b = ii(b, c, d, a, k[13], 21, 1309151649);\n            a = ii(a, b, c, d, k[4], 6, -145523070);\n            d = ii(d, a, b, c, k[11], 10, -1120210379);\n            c = ii(c, d, a, b, k[2], 15, 718787259);\n            b = ii(b, c, d, a, k[9], 21, -343485551);\n    \n            x[0] = add32(a, x[0]);\n            x[1] = add32(b, x[1]);\n            x[2] = add32(c, x[2]);\n            x[3] = add32(d, x[3]);\n        },\n    \n        /* there needs to be support for Unicode here,\n           * unless we pretend that we can redefine the MD-5\n           * algorithm for multi-byte characters (perhaps\n           * by adding every four 16-bit characters and\n           * shortening the sum to 32 bits). Otherwise\n           * I suggest performing MD-5 as if every character\n           * was two bytes--e.g., 0040 0025 = @%--but then\n           * how will an ordinary MD-5 sum be matched?\n           * There is no way to standardize text to something\n           * like UTF-8 before transformation; speed cost is\n           * utterly prohibitive. The JavaScript standard\n           * itself needs to look at this: it should start\n           * providing access to strings as preformed UTF-8\n           * 8-bit unsigned value arrays.\n           */\n        md5blk = function (s) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n    \n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n            }\n            return md5blks;\n        },\n    \n        md5blk_array = function (a) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n    \n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n            }\n            return md5blks;\n        },\n    \n        md51 = function (s) {\n            var n = s.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n    \n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk(s.substring(i - 64, i)));\n            }\n            s = s.substring(i - 64);\n            length = s.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n            }\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n    \n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n    \n            tail[14] = lo;\n            tail[15] = hi;\n    \n            md5cycle(state, tail);\n            return state;\n        },\n    \n        md51_array = function (a) {\n            var n = a.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n    \n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n            }\n    \n            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n            // containing the last element of the parent array if the sub array specified starts\n            // beyond the length of the parent array - weird.\n            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n    \n            length = a.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n            }\n    \n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n    \n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n    \n            tail[14] = lo;\n            tail[15] = hi;\n    \n            md5cycle(state, tail);\n    \n            return state;\n        },\n    \n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n    \n        rhex = function (n) {\n            var s = '',\n                j;\n            for (j = 0; j < 4; j += 1) {\n                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n            }\n            return s;\n        },\n    \n        hex = function (x) {\n            var i;\n            for (i = 0; i < x.length; i += 1) {\n                x[i] = rhex(x[i]);\n            }\n            return x.join('');\n        },\n    \n        md5 = function (s) {\n            return hex(md51(s));\n        },\n    \n    \n    \n        ////////////////////////////////////////////////////////////////////////////\n    \n        /**\n         * SparkMD5 OOP implementation.\n         *\n         * Use this class to perform an incremental md5, otherwise use the\n         * static methods instead.\n         */\n        SparkMD5 = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n    \n    \n        // In some cases the fast add32 function cannot be used..\n        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n            add32 = function (x, y) {\n                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n                return (msw << 16) | (lsw & 0xFFFF);\n            };\n        }\n    \n    \n        /**\n         * Appends a string.\n         * A conversion will be applied if an utf8 string is detected.\n         *\n         * @param {String} str The string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.append = function (str) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n    \n            // then append as binary\n            this.appendBinary(str);\n    \n            return this;\n        };\n    \n        /**\n         * Appends a binary string.\n         *\n         * @param {String} contents The binary string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.appendBinary = function (contents) {\n            this._buff += contents;\n            this._length += contents.length;\n    \n            var length = this._buff.length,\n                i;\n    \n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n            }\n    \n            this._buff = this._buff.substr(i - 64);\n    \n            return this;\n        };\n    \n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                i,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                ret;\n    \n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n            }\n    \n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n    \n            this.reset();\n    \n            return ret;\n        };\n    \n        /**\n         * Finish the final calculation based on the tail.\n         *\n         * @param {Array}  tail   The tail (will be modified)\n         * @param {Number} length The length of the remaining buffer\n         */\n        SparkMD5.prototype._finish = function (tail, length) {\n            var i = length,\n                tmp,\n                lo,\n                hi;\n    \n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(this._state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n    \n            // Do the final computation based on the tail and length\n            // Beware that the final length may not fit in 32 bits so we take care of that\n            tmp = this._length * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n    \n            tail[14] = lo;\n            tail[15] = hi;\n            md5cycle(this._state, tail);\n        };\n    \n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.reset = function () {\n            this._buff = \"\";\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n    \n            return this;\n        };\n    \n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.prototype.destroy = function () {\n            delete this._state;\n            delete this._buff;\n            delete this._length;\n        };\n    \n    \n        /**\n         * Performs the md5 hash on a string.\n         * A conversion will be applied if utf8 string is detected.\n         *\n         * @param {String}  str The string\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hash = function (str, raw) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n    \n            var hash = md51(str);\n    \n            return raw ? hash : hex(hash);\n        };\n    \n        /**\n         * Performs the md5 hash on a binary string.\n         *\n         * @param {String}  content The binary string\n         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hashBinary = function (content, raw) {\n            var hash = md51(content);\n    \n            return raw ? hash : hex(hash);\n        };\n    \n        /**\n         * SparkMD5 OOP implementation for array buffers.\n         *\n         * Use this class to perform an incremental md5 ONLY for array buffers.\n         */\n        SparkMD5.ArrayBuffer = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n    \n        ////////////////////////////////////////////////////////////////////////////\n    \n        /**\n         * Appends an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array to be appended\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n            //       if you find yourself needing extra performance, please make a PR.\n            var buff = this._concatArrayBuffer(this._buff, arr),\n                length = buff.length,\n                i;\n    \n            this._length += arr.byteLength;\n    \n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n            }\n    \n            // Avoids IE10 weirdness (documented above)\n            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n    \n            return this;\n        };\n    \n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                i,\n                ret;\n    \n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n            }\n    \n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n    \n            this.reset();\n    \n            return ret;\n        };\n    \n        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n    \n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.reset = function () {\n            this._buff = new Uint8Array(0);\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n    \n            return this;\n        };\n    \n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n    \n        /**\n         * Concats two array buffers, returning a new one.\n         *\n         * @param  {ArrayBuffer} first  The first array buffer\n         * @param  {ArrayBuffer} second The second array buffer\n         *\n         * @return {ArrayBuffer} The new array buffer\n         */\n        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n            var firstLength = first.length,\n                result = new Uint8Array(firstLength + second.byteLength);\n    \n            result.set(first);\n            result.set(new Uint8Array(second), firstLength);\n    \n            return result;\n        };\n    \n        /**\n         * Performs the md5 hash on an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array buffer\n         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n            var hash = md51_array(new Uint8Array(arr));\n    \n            return raw ? hash : hex(hash);\n        };\n        \n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n    \n            loadFromBlob: function( file ) {\n                var blob = file.getSource(),\n                    chunkSize = 2 * 1024 * 1024,\n                    chunks = Math.ceil( blob.size / chunkSize ),\n                    chunk = 0,\n                    owner = this.owner,\n                    spark = new SparkMD5.ArrayBuffer(),\n                    me = this,\n                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n                    loadNext, fr;\n    \n                fr = new FileReader();\n    \n                loadNext = function() {\n                    var start, end;\n    \n                    start = chunk * chunkSize;\n                    end = Math.min( start + chunkSize, blob.size );\n    \n                    fr.onload = function( e ) {\n                        spark.append( e.target.result );\n                        owner.trigger( 'progress', {\n                            total: file.size,\n                            loaded: end\n                        });\n                    };\n    \n                    fr.onloadend = function() {\n                        fr.onloadend = fr.onload = null;\n    \n                        if ( ++chunk < chunks ) {\n                            setTimeout( loadNext, 1 );\n                        } else {\n                            setTimeout(function(){\n                                owner.trigger('load');\n                                me.result = spark.end();\n                                loadNext = file = blob = spark = null;\n                                owner.trigger('complete');\n                            }, 50 );\n                        }\n                    };\n    \n                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n                };\n    \n                loadNext();\n            },\n    \n            getResult: function() {\n                return this.result;\n            }\n        });\n    });\n    /**\n     * @fileOverview FlashRuntime\n     */\n    define('runtime/flash/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n    \n        var $ = Base.$,\n            type = 'flash',\n            components = {};\n    \n    \n        function getFlashVersion() {\n            var version;\n    \n            try {\n                version = navigator.plugins[ 'Shockwave Flash' ];\n                version = version.description;\n            } catch ( ex ) {\n                try {\n                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n                            .GetVariable('$version');\n                } catch ( ex2 ) {\n                    version = '0.0';\n                }\n            }\n            version = version.match( /\\d+/g );\n            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n        }\n    \n        function FlashRuntime() {\n            var pool = {},\n                clients = {},\n                destroy = this.destroy,\n                me = this,\n                jsreciver = Base.guid('webuploader_');\n    \n            Runtime.apply( me, arguments );\n            me.type = type;\n    \n    \n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/ ) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n    \n                clients[ uid ] = client;\n    \n                if ( components[ comp ] ) {\n                    if ( !pool[ uid ] ) {\n                        pool[ uid ] = new components[ comp ]( client, me );\n                    }\n    \n                    instance = pool[ uid ];\n    \n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n    \n                return me.flashExec.apply( client, arguments );\n            };\n    \n            function handler( evt, obj ) {\n                var type = evt.type || evt,\n                    parts, uid;\n    \n                parts = type.split('::');\n                uid = parts[ 0 ];\n                type = parts[ 1 ];\n    \n                // console.log.apply( console, arguments );\n    \n                if ( type === 'Ready' && uid === me.uid ) {\n                    me.trigger('ready');\n                } else if ( clients[ uid ] ) {\n                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n                }\n    \n                // Base.log( evt, obj );\n            }\n    \n            // flash的接受器。\n            window[ jsreciver ] = function() {\n                var args = arguments;\n    \n                // 为了能捕获得到。\n                setTimeout(function() {\n                    handler.apply( null, args );\n                }, 1 );\n            };\n    \n            this.jsreciver = jsreciver;\n    \n            this.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n    \n            this.flashExec = function( comp, fn ) {\n                var flash = me.getFlash(),\n                    args = Base.slice( arguments, 2 );\n    \n                return flash.exec( this.uid, comp, fn, args );\n            };\n    \n            // @todo\n        }\n    \n        Base.inherits( Runtime, {\n            constructor: FlashRuntime,\n    \n            init: function() {\n                var container = this.getContainer(),\n                    opts = this.options,\n                    html;\n    \n                // if not the minimal height, shims are not initialized\n                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n                container.css({\n                    position: 'absolute',\n                    top: '-8px',\n                    left: '-8px',\n                    width: '9px',\n                    height: '9px',\n                    overflow: 'hidden'\n                });\n    \n                // insert flash object\n                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n    \n                if ( Base.browser.ie ) {\n                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n                }\n    \n                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n                    '&jsreciver=' + this.jsreciver + '\" />' +\n                    '<param name=\"wmode\" value=\"transparent\" />' +\n                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n                '</object>';\n    \n                container.html( html );\n            },\n    \n            getFlash: function() {\n                if ( this._flash ) {\n                    return this._flash;\n                }\n    \n                this._flash = $( '#' + this.uid ).get( 0 );\n                return this._flash;\n            }\n    \n        });\n    \n        FlashRuntime.register = function( name, component ) {\n            component = components[ name ] = Base.inherits( CompBase, $.extend({\n    \n                // @todo fix this later\n                flashExec: function() {\n                    var owner = this.owner,\n                        runtime = this.getRuntime();\n    \n                    return runtime.flashExec.apply( owner, arguments );\n                }\n            }, component ) );\n    \n            return component;\n        };\n    \n        if ( getFlashVersion() >= 11.4 ) {\n            Runtime.addRuntime( type, FlashRuntime );\n        }\n    \n        return FlashRuntime;\n    });\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/flash/filepicker',[\n        'base',\n        'runtime/flash/runtime'\n    ], function( Base, FlashRuntime ) {\n        var $ = Base.$;\n    \n        return FlashRuntime.register( 'FilePicker', {\n            init: function( opts ) {\n                var copy = $.extend({}, opts ),\n                    len, i;\n    \n                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n                len = copy.accept && copy.accept.length;\n                for (  i = 0; i < len; i++ ) {\n                    if ( !copy.accept[ i ].title ) {\n                        copy.accept[ i ].title = 'Files';\n                    }\n                }\n    \n                delete copy.button;\n                delete copy.id;\n                delete copy.container;\n    \n                this.flashExec( 'FilePicker', 'init', copy );\n            },\n    \n            destroy: function() {\n                this.flashExec( 'FilePicker', 'destroy' );\n            }\n        });\n    });\n    /**\n     * @fileOverview 图片压缩\n     */\n    define('runtime/flash/image',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n    \n        return FlashRuntime.register( 'Image', {\n            // init: function( options ) {\n            //     var owner = this.owner;\n    \n            //     this.flashExec( 'Image', 'init', options );\n            //     owner.on( 'load', function() {\n            //         debugger;\n            //     });\n            // },\n    \n            loadFromBlob: function( blob ) {\n                var owner = this.owner;\n    \n                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n    \n                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/flash/transport',[\n        'base',\n        'runtime/flash/runtime',\n        'runtime/client'\n    ], function( Base, FlashRuntime, RuntimeClient ) {\n        var $ = Base.$;\n    \n        return FlashRuntime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n                this._responseJson = null;\n            },\n    \n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    binary;\n    \n                xhr.connectRuntime( blob.ruid );\n    \n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n    \n                    binary = blob.uid;\n                } else {\n                    $.each( owner._formData, function( k, v ) {\n                        xhr.exec( 'append', k, v );\n                    });\n    \n                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n                            opts.filename || owner._formData.name || '' );\n                }\n    \n                this._setRequestHeader( xhr, opts.headers );\n                xhr.exec( 'send', {\n                    method: opts.method,\n                    url: server,\n                    forceURLStream: opts.forceURLStream,\n                    mimeType: 'application/octet-stream'\n                }, binary );\n            },\n    \n            getStatus: function() {\n                return this._status;\n            },\n    \n            getResponse: function() {\n                return this._response || '';\n            },\n    \n            getResponseAsJson: function() {\n                return this._responseJson;\n            },\n    \n            abort: function() {\n                var xhr = this._xhr;\n    \n                if ( xhr ) {\n                    xhr.exec('abort');\n                    xhr.destroy();\n                    this._xhr = xhr = null;\n                }\n            },\n    \n            destroy: function() {\n                this.abort();\n            },\n    \n            _initAjax: function() {\n                var me = this,\n                    xhr = new RuntimeClient('XMLHttpRequest');\n    \n                xhr.on( 'uploadprogress progress', function( e ) {\n                    var percent = e.loaded / e.total;\n                    percent = Math.min( 1, Math.max( 0, percent ) );\n                    return me.trigger( 'progress', percent );\n                });\n    \n                xhr.on( 'load', function() {\n                    var status = xhr.exec('getStatus'),\n                        readBody = false,\n                        err = '',\n                        p;\n    \n                    xhr.off();\n                    me._xhr = null;\n    \n                    if ( status >= 200 && status < 300 ) {\n                        readBody = true;\n                    } else if ( status >= 500 && status < 600 ) {\n                        readBody = true;\n                        err = 'server';\n                    } else {\n                        err = 'http';\n                    }\n    \n                    if ( readBody ) {\n                        me._response = xhr.exec('getResponse');\n                        me._response = decodeURIComponent( me._response );\n    \n                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n                        // try {\n                        //     me._responseJson = xhr.exec('getResponseAsJson');\n                        // } catch ( error ) {\n                            \n                        p = window.JSON && window.JSON.parse || function( s ) {\n                            try {\n                                return new Function('return ' + s).call();\n                            } catch ( err ) {\n                                return {};\n                            }\n                        };\n                        me._responseJson  = me._response ? p(me._response) : {};\n                            \n                        // }\n                    }\n                    \n                    xhr.destroy();\n                    xhr = null;\n    \n                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n                });\n    \n                xhr.on( 'error', function() {\n                    xhr.off();\n                    me._xhr = null;\n                    me.trigger( 'error', 'http' );\n                });\n    \n                me._xhr = xhr;\n                return xhr;\n            },\n    \n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.exec( 'setRequestHeader', key, val );\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/flash/blob',[\n        'runtime/flash/runtime',\n        'lib/blob'\n    ], function( FlashRuntime, Blob ) {\n    \n        return FlashRuntime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.flashExec( 'Blob', 'slice', start, end );\n    \n                return new Blob( blob.uid, blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Md5 flash实现\n     */\n    define('runtime/flash/md5',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n        \n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n    \n            loadFromBlob: function( blob ) {\n                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview 完全版本。\n     */\n    define('preset/all',[\n        'base',\n    \n        // widgets\n        'widgets/filednd',\n        'widgets/filepaste',\n        'widgets/filepicker',\n        'widgets/image',\n        'widgets/queue',\n        'widgets/runtime',\n        'widgets/upload',\n        'widgets/validator',\n        'widgets/md5',\n    \n        // runtimes\n        // html5\n        'runtime/html5/blob',\n        'runtime/html5/dnd',\n        'runtime/html5/filepaste',\n        'runtime/html5/filepicker',\n        'runtime/html5/imagemeta/exif',\n        'runtime/html5/androidpatch',\n        'runtime/html5/image',\n        'runtime/html5/transport',\n        'runtime/html5/md5',\n    \n        // flash\n        'runtime/flash/filepicker',\n        'runtime/flash/image',\n        'runtime/flash/transport',\n        'runtime/flash/blob',\n        'runtime/flash/md5'\n    ], function( Base ) {\n        return Base;\n    });\n    /**\n     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n     *\n     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n     *\n     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n     *\n     * 如：\n     * WebUploader.create({\n     *     ...\n     *\n     *     disableWidgets: 'log',\n     *\n     *     ...\n     * })\n     */\n    define('widgets/log',[\n        'base',\n        'uploader',\n        'widgets/widget'\n    ], function( Base, Uploader ) {\n        var $ = Base.$,\n            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n            product = (location.hostname || location.host || 'protected').toLowerCase(),\n    \n            // 只针对 baidu 内部产品用户做统计功能。\n            enable = product && /baidu/i.exec(product),\n            base;\n    \n        if (!enable) {\n            return;\n        }\n    \n        base = {\n            dv: 3,\n            master: 'webuploader',\n            online: /test/.exec(product) ? 0 : 1,\n            module: '',\n            product: product,\n            type: 0\n        };\n    \n        function send(data) {\n            var obj = $.extend({}, base, data),\n                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n                image = new Image();\n    \n            image.src = url;\n        }\n    \n        return Uploader.register({\n            name: 'log',\n    \n            init: function() {\n                var owner = this.owner,\n                    count = 0,\n                    size = 0;\n    \n                owner\n                    .on('error', function(code) {\n                        send({\n                            type: 2,\n                            c_error_code: code\n                        });\n                    })\n                    .on('uploadError', function(file, reason) {\n                        send({\n                            type: 2,\n                            c_error_code: 'UPLOAD_ERROR',\n                            c_reason: '' + reason\n                        });\n                    })\n                    .on('uploadComplete', function(file) {\n                        count++;\n                        size += file.size;\n                    }).\n                    on('uploadFinished', function() {\n                        send({\n                            c_count: count,\n                            c_size: size\n                        });\n                        count = size = 0;\n                    });\n    \n                send({\n                    c_usage: 1\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('webuploader',[\n        'preset/all',\n        'widgets/log'\n    ], function( preset ) {\n        return preset;\n    });\n    return require('webuploader');\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/plugin/webuploader/webuploader.js\n// module id = 85\n// module chunks = 3 5 6 11 15 29 33","var tpl = require('./content.tpl');\nvar Dialog = require('dialog');\n\nvar create = function(data, options){\n    var content = tpl(data || {}); // 显示编辑弹窗之前,需要自己拼装数据\n    options = options || {};\n\n    var defaults = {\n        title: '选择图片',\n        modal: true,\n        fixed: true,\n        content: content,\n        className: 'pop-box',\n        okValue: '插入图片',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        cancalValue : '取消',\n        btnWrapCls: 'insert-cancel'\n        /*function () {\n            // var value = $('#property-returnValue-demo').val();\n            // this.close(value);\n            // this.remove();\n        }*/\n    };\n    $.extend(true, defaults, options);\n    return Dialog(defaults);\n};\n\nmodule.exports = {\n    create: create\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/upload/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,maxlength=$data.maxlength,total=$data.total,$out='';$out+='<div data-node=\"uploadBox\"> <div class=\"pics-list-wrap clearfix\"> <ul class=\"pics-list clearfix\" data-node=\"uploadList\"> <li data-defaultAddFile=\\'picker\\'></li> </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"addNum\">';\n$out+=$escape(maxlength);\n$out+='</span><span class=\"deep-gray\">/';\n$out+=$escape(total);\n$out+='</span>张图片</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/upload/content.tpl\n// module id = 97\n// module chunks = 4 5 15 29","require('./ueditor/ueditor.config');\nrequire('./ueditor/ueditor.all');\nrequire('./ueditor/lang/zh-cn/zh-cn.js');\n\nrequire('./plugin');\nrequire('./rewrite');\nrequire('./ban');\nrequire('utils/indexOf');\nvar alert = require('module/popup/alert');\n//var detectQr = require('./plugin/detectQr');\n\nvar faceModule = require('module/popup/face/index');\nvar opts = require('./config');\n\n//商品选中增加遮罩\nvar goodsMask = require(\"./plugin/goodsMask\");\n//新增的文本过滤规则\nvar filterTxtRules = require(\"./rewrite/filterTxtRules\");\n//草稿箱\nvar restoreData = require('./plugin/restore');\nvar init = function(id) {\n    id = id || 'editor';\n    var editor = UE.getEditor(id, opts);\n\n    // 实例化表情，传入插入表情的回调方法。\n    var face = faceModule.init({\n        onSelected: function(data) {\n            var str = data.reg;\n            //var str = '<img src= \"' + data.url + '\" data-node=\"emoji\" width=\"22\" height=\"22\"/>'\n            editor.execCommand('inserthtml', str);\n        }\n    });\n    editor.face = face;\n\n    editor.addListener('ready', function() {\n\n        var defaultContent = editor.getContent();\n        var $editorBody = $(editor.body);\n        var placeholderCls = 'placeholder';\n        var $container = $(editor.container);\n        $editorBody.addClass(placeholderCls);\n        $editorBody.delegate('a', 'click', function(e) {\n            e.stopPropagation();\n            e.preventDefault();\n        })\n        editor.addListener('focus', function() {\n            $editorBody.removeClass(placeholderCls);\n            $container.addClass('edui-nobg');\n        });\n        editor.addListener('blur', function() {\n            var hasDiv = !!$editorBody.find('div').length;\n            var isEqDefault = editor.getContent() == defaultContent;\n            var isContentEmpty = $.trim(editor.getContent()) == '';\n\n            if ((isEqDefault && hasDiv) || isContentEmpty) {\n                $editorBody.addClass(placeholderCls);\n                $container.removeClass('edui-nobg');\n            } else {\n                $editorBody.removeClass(placeholderCls);\n                $container.addClass('edui-nobg');\n            }\n        });\n        //加载草稿箱\n        restoreData(editor);\n        //文字过滤规则\n        filterTxtRules(editor);\n        //点击商品显示遮罩\n        goodsMask(editor);\n\n        var $emojiBtn = $(editor.container.firstChild).find('.edui-for-insertemoji');\n        var $pictorBtn = $(editor.container.firstChild).find('.edui-for-insertpicture');\n        var $picPopBox = $('[data-node=picPopBox]');\n        // 让表情包随着editorBar的fixed一起fixed\n        $(window).on('scroll', function() {\n            var flagY = $emojiBtn.offset().top;\n            var scrollTop = $(window).scrollTop();\n            var top;\n\n            if (scrollTop > flagY) {\n                top = 0;\n            } else {\n                top = flagY;\n            }\n            top = top / 1 + 30;\n\n            $picPopBox.css({\n                'top': top + 'px'\n            });\n\n            if (!face.isShow) {\n                return;\n            }\n            face.$dom.css({\n                top: top + 'px'\n            });\n\n        });\n\n        // 阻止表情按钮事件冒泡\n        $emojiBtn.on('click', function(e) {\n            $picPopBox.hide();\n            e.stopPropagation();\n            e.preventDefault();\n        });\n\n        $pictorBtn.on('click', function(e) {\n            face.hide();\n            e.stopPropagation();\n            e.preventDefault();\n        });\n\n        $(\"body\").on('click', function() {\n            $picPopBox.hide();\n            face.hide();\n        })\n\n        $(editor.body).on('focus', function() {\n            if (editor.sensitiveWord) {\n                $.each($(editor.body).find('span[class=bg-warning]'), function(i, v) {\n                    $(v).on('mouseup', function() {\n                        $(v).removeClass('bg-warning');\n                    })\n                })\n                editor.sensitiveWord = false;\n            }\n            face.hide();\n        });\n        $(editor.body).on('click', function() {\n            face.hide();\n        });\n\n    });\n\n    return editor;\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/index.js","/**\n * ueditor完整配置项\n * 可以在这里配置整个编辑器的特性\n */\n/**************************提示********************************\n * 所有被注释的配置项均为UEditor默认值。\n * 修改默认配置请首先确保已经完全明确该参数的真实用途。\n * 主要有两种修改方案，一种是取消此处注释，然后修改成对应参数；另一种是在实例化编辑器时传入对应参数。\n * 当升级编辑器时，可直接使用旧版配置文件替换新版配置文件,不用担心旧版配置文件中因缺少新功能所需的参数而导致脚本报错。\n **************************提示********************************/\n\n(function() {\n\n    /**\n     * 编辑器资源文件根路径。它所表示的含义是：以编辑器实例化页面为当前路径，指向编辑器资源文件（即dialog等文件夹）的路径。\n     * 鉴于很多同学在使用编辑器的时候出现的种种路径问题，此处强烈建议大家使用\"相对于网站根目录的相对路径\"进行配置。\n     * \"相对于网站根目录的相对路径\"也就是以斜杠开头的形如\"/myProject/ueditor/\"这样的路径。\n     * 如果站点中有多个不在同一层级的页面需要实例化编辑器，且引用了同一UEditor的时候，此处的URL可能不适用于每个页面的编辑器。\n     * 因此，UEditor提供了针对不同页面的编辑器可单独配置的根路径，具体来说，在需要实例化编辑器的页面最顶部写上如下代码即可。当然，需要令此处的URL等于对应的配置。\n     * window.UEDITOR_HOME_URL = \"/xxxx/xxxx/\";\n     */\n\n    //window.UEDITOR_HOME_URL = \"http://js.dev.meixincdn.com:8017/src/js/module/editor/\"\n    var URL = window.UEDITOR_HOME_URL || getUEBasePath();\n\n    /**\n     * 配置项主体。注意，此处所有涉及到路径的配置别遗漏URL变量。\n     */\n    window.UEDITOR_CONFIG = {\n\n        //为编辑器实例添加一个路径，这个不能被注释\n        UEDITOR_HOME_URL: URL\n            // 服务器统一请求接口路径\n            // , serverUrl: URL + \"php/controller.php\"\n            ,\n        serverUrl: \"http://127.0.0.1/utf8-php/php/controller.php\"\n            //工具栏上的所有的功能按钮和下拉框，可以在new编辑器的实例时选择自己需要的重新定义\n            ,\n        /*toolbars: [[\n            'fullscreen', 'source', '|', 'undo', 'redo', '|',\n            'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', '|',\n            'rowspacingtop', 'rowspacingbottom', 'lineheight', '|',\n            'customstyle', 'paragraph', 'fontfamily', 'fontsize', '|',\n            'directionalityltr', 'directionalityrtl', 'indent', '|',\n            'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|', 'touppercase', 'tolowercase', '|',\n            'link', 'unlink', 'anchor', '|', 'imagenone', 'imageleft', 'imageright', 'imagecenter', '|',\n            'simpleupload', 'insertimage', 'emotion', 'scrawl', 'insertvideo', 'music', 'attachment', 'map', 'gmap', 'insertframe', 'insertcode', 'webapp', 'pagebreak', 'template', 'background', '|',\n            'horizontal', 'date', 'time', 'spechars', 'snapscreen', 'wordimage', '|',\n            'inserttable', 'deletetable', 'insertparagraphbeforetable', 'insertrow', 'deleterow', 'insertcol', 'deletecol', 'mergecells', 'mergeright', 'mergedown', 'splittocells', 'splittorows', 'splittocols', 'charts', '|',\n            'print', 'preview', 'searchreplace', 'drafts', 'help'\n        ]]*/\n        toolbars: [\n                []\n            ]\n            //当鼠标放在工具栏上时显示的tooltip提示,留空支持自动多语言配置，否则以配置值为准\n            //,labelMap:{\n            //    'anchor':'', 'undo':''\n            //}\n\n        //语言配置项,默认是zh-cn。有需要的话也可以使用如下这样的方式来自动多语言切换，当然，前提条件是lang文件夹下存在对应的语言文件：\n        //lang值也可以通过自动获取 (navigator.language||navigator.browserLanguage ||navigator.userLanguage).toLowerCase()\n        //,lang:\"zh-cn\"\n        //,langPath:URL +\"lang/\"\n\n        //主题配置项,默认是default。有需要的话也可以使用如下这样的方式来自动多主题切换，当然，前提条件是themes文件夹下存在对应的主题文件：\n        //现有如下皮肤:default\n        //,theme:'default'\n        //,themePath:URL +\"themes/\"\n\n        //,zIndex : 900     //编辑器层级的基数,默认是900\n\n        //针对getAllHtml方法，会在对应的head标签中增加该编码设置。\n        //,charset:\"utf-8\"\n\n        //若实例化编辑器的页面手动修改的domain，此处需要设置为true\n        //,customDomain:false\n\n        //常用配置项目\n        //,isShow : true    //默认显示编辑器\n\n        //,textarea:'editorValue' // 提交表单时，服务器获取编辑器提交内容的所用的参数，多实例时可以给容器name属性，会将name给定的值最为每个实例的键值，不用每次实例化的时候都设置这个值\n\n        //,initialContent:'欢迎使用ueditor!'    //初始化编辑器的内容,也可以通过textarea/script给值，看官网例子\n\n        //,autoClearinitialContent:true //是否自动清除编辑器初始内容，注意：如果focus属性设置为true,这个也为真，那么编辑器一上来就会触发导致初始化的内容看不到了\n\n        //,focus:false //初始化时，是否让编辑器获得焦点true或false\n\n        //如果自定义，最好给p标签如下的行高，要不输入中文时，会有跳动感\n        //,initialStyle:'p{line-height:1em}'//编辑器层级的基数,可以用来改变字体等\n\n        //,iframeCssUrl: URL + '/themes/iframe.css' //给编辑区域的iframe引入一个css文件\n\n        //indentValue\n        //首行缩进距离,默认是2em\n        //,indentValue:'2em'\n\n        //,initialFrameWidth:1000  //初始化编辑器宽度,默认1000\n        //,initialFrameHeight:320  //初始化编辑器高度,默认320\n\n        //,readonly : false //编辑器初始化结束后,编辑区域是否是只读的，默认是false\n\n        //,autoClearEmptyNode : true //getContent时，是否删除空的inlineElement节点（包括嵌套的情况）\n\n        //启用自动保存\n        //,enableAutoSave: true\n        //自动保存间隔时间， 单位ms\n        //,saveInterval: 500\n\n        //,fullscreen : false //是否开启初始化时即全屏，默认关闭\n\n        //,imagePopup:true      //图片操作的浮层开关，默认打开\n\n        //,autoSyncData:true //自动同步编辑器要提交的数据\n        //,emotionLocalization:false //是否开启表情本地化，默认关闭。若要开启请确保emotion文件夹下包含官网提供的images表情文件夹\n\n        //粘贴只保留标签，去除标签所有属性\n        //,retainOnlyLabelPasted: false\n\n        //,pasteplain:false  //是否默认为纯文本粘贴。false为不使用纯文本粘贴，true为使用纯文本粘贴\n        //纯文本粘贴模式下的过滤规则\n        //'filterTxtRules' : function(){\n        //    function transP(node){\n        //        node.tagName = 'p';\n        //        node.setStyle();\n        //    }\n        //    return {\n        //        //直接删除及其字节点内容\n        //        '-' : 'script style object iframe embed input select',\n        //        'p': {$:{}},\n        //        'br':{$:{}},\n        //        'div':{'$':{}},\n        //        'li':{'$':{}},\n        //        'caption':transP,\n        //        'th':transP,\n        //        'tr':transP,\n        //        'h1':transP,'h2':transP,'h3':transP,'h4':transP,'h5':transP,'h6':transP,\n        //        'td':function(node){\n        //            //没有内容的td直接删掉\n        //            var txt = !!node.innerText();\n        //            if(txt){\n        //                node.parentNode.insertAfter(UE.uNode.createText(' &nbsp; &nbsp;'),node);\n        //            }\n        //            node.parentNode.removeChild(node,node.innerText())\n        //        }\n        //    }\n        //}()\n\n        //,allHtmlEnabled:false //提交到后台的数据是否包含整个html字符串\n\n        //insertorderedlist\n        //有序列表的下拉配置,值留空时支持多语言自动识别，若配置值，则以此值为准\n        //,'insertorderedlist':{\n        //      //自定的样式\n        //        'num':'1,2,3...',\n        //        'num1':'1),2),3)...',\n        //        'num2':'(1),(2),(3)...',\n        //        'cn':'一,二,三....',\n        //        'cn1':'一),二),三)....',\n        //        'cn2':'(一),(二),(三)....',\n        //     //系统自带\n        //     'decimal' : '' ,         //'1,2,3...'\n        //     'lower-alpha' : '' ,    // 'a,b,c...'\n        //     'lower-roman' : '' ,    //'i,ii,iii...'\n        //     'upper-alpha' : '' , lang   //'A,B,C'\n        //     'upper-roman' : ''      //'I,II,III...'\n        //}\n\n        //insertunorderedlist\n        //无序列表的下拉配置，值留空时支持多语言自动识别，若配置值，则以此值为准\n        //,insertunorderedlist : { //自定的样式\n        //    'dash' :'— 破折号', //-破折号\n        //    'dot':' 。 小圆圈', //系统自带\n        //    'circle' : '',  // '○ 小圆圈'\n        //    'disc' : '',    // '● 小圆点'\n        //    'square' : ''   //'■ 小方块'\n        //}\n        //,listDefaultPaddingLeft : '30'//默认的左边缩进的基数倍\n        //,listiconpath : 'http://bs.baidu.com/listicon/'//自定义标号的路径\n        //,maxListLevel : 3 //限制可以tab的级数, 设置-1为不限制\n\n        //,autoTransWordToList:false  //禁止word中粘贴进来的列表自动变成列表标签\n\n        //fontfamily\n        //字体设置 label留空支持多语言自动切换，若配置，则以配置值为准\n        //,'fontfamily':[\n        //    { label:'',name:'songti',val:'宋体,SimSun'},\n        //    { label:'',name:'kaiti',val:'楷体,楷体_GB2312, SimKai'},\n        //    { label:'',name:'yahei',val:'微软雅黑,Microsoft YaHei'},\n        //    { label:'',name:'heiti',val:'黑体, SimHei'},\n        //    { label:'',name:'lishu',val:'隶书, SimLi'},\n        //    { label:'',name:'andaleMono',val:'andale mono'},\n        //    { label:'',name:'arial',val:'arial, helvetica,sans-serif'},\n        //    { label:'',name:'arialBlack',val:'arial black,avant garde'},\n        //    { label:'',name:'comicSansMs',val:'comic sans ms'},\n        //    { label:'',name:'impact',val:'impact,chicago'},\n        //    { label:'',name:'timesNewRoman',val:'times new roman'}\n        //]\n\n        //fontsize\n        //字号\n        //,'fontsize':[10, 11, 12, 14, 16, 18, 20, 24, 36]\n\n        //paragraph\n        //段落格式 值留空时支持多语言自动识别，若配置，则以配置值为准\n        //,'paragraph':{'p':'', 'h1':'', 'h2':'', 'h3':'', 'h4':'', 'h5':'', 'h6':''}\n\n        //rowspacingtop\n        //段间距 值和显示的名字相同\n        //,'rowspacingtop':['5', '10', '15', '20', '25']\n\n        //rowspacingBottom\n        //段间距 值和显示的名字相同\n        //,'rowspacingbottom':['5', '10', '15', '20', '25']\n\n        //lineheight\n        //行内间距 值和显示的名字相同\n        //,'lineheight':['1', '1.5','1.75','2', '3', '4', '5']\n\n        //customstyle\n        //自定义样式，不支持国际化，此处配置值即可最后显示值\n        //block的元素是依据设置段落的逻辑设置的，inline的元素依据BIU的逻辑设置\n        //尽量使用一些常用的标签\n        //参数说明\n        //tag 使用的标签名字\n        //label 显示的名字也是用来标识不同类型的标识符，注意这个值每个要不同，\n        //style 添加的样式\n        //每一个对象就是一个自定义的样式\n        //,'customstyle':[\n        //    {tag:'h1', name:'tc', label:'', style:'border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;'},\n        //    {tag:'h1', name:'tl',label:'', style:'border-bottom:#ccc 2px solid;padding:0 4px 0 0;margin:0 0 10px 0;'},\n        //    {tag:'span',name:'im', label:'', style:'font-style:italic;font-weight:bold'},\n        //    {tag:'span',name:'hi', label:'', style:'font-style:italic;font-weight:bold;color:rgb(51, 153, 204)'}\n        //]\n\n        //打开右键菜单功能\n        //,enableContextMenu: true\n        //右键菜单的内容，可以参考plugins/contextmenu.js里边的默认菜单的例子，label留空支持国际化，否则以此配置为准\n        //,contextMenu:[\n        //    {\n        //        label:'',       //显示的名称\n        //        cmdName:'selectall',//执行的command命令，当点击这个右键菜单时\n        //        //exec可选，有了exec就会在点击时执行这个function，优先级高于cmdName\n        //        exec:function () {\n        //            //this是当前编辑器的实例\n        //            //this.ui._dialogs['inserttableDialog'].open();\n        //        }\n        //    }\n        //]\n\n        //快捷菜单\n        //,shortcutMenu:[\"fontfamily\", \"fontsize\", \"bold\", \"italic\", \"underline\", \"forecolor\", \"backcolor\", \"insertorderedlist\", \"insertunorderedlist\"]\n\n        //elementPathEnabled\n        //是否启用元素路径，默认是显示\n        //,elementPathEnabled : true\n\n        //wordCount\n        //,wordCount:true          //是否开启字数统计\n        //,maximumWords:10000       //允许的最大字符数\n        //字数统计提示，{#count}代表当前字数，{#leave}代表还可以输入多少字符数,留空支持多语言自动切换，否则按此配置显示\n        //,wordCountMsg:''   //当前已输入 {#count} 个字符，您还可以输入{#leave} 个字符\n        //超出字数限制提示  留空支持多语言自动切换，否则按此配置显示\n        //,wordOverFlowMsg:''    //<span style=\"color:red;\">你输入的字符个数已经超出最大允许值，服务器可能会拒绝保存！</span>\n\n        //tab\n        //点击tab键时移动的距离,tabSize倍数，tabNode什么字符做为单位\n        //,tabSize:4\n        //,tabNode:'&nbsp;'\n\n        //removeFormat\n        //清除格式时可以删除的标签和属性\n        //removeForamtTags标签\n        //,removeFormatTags:'b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var'\n        //removeFormatAttributes属性\n        //,removeFormatAttributes:'class,style,lang,width,height,align,hspace,valign'\n\n        //undo\n        //可以最多回退的次数,默认20\n        //,maxUndoCount:20\n        //当输入的字符数超过该值时，保存一次现场\n        //,maxInputCount:1\n\n        //autoHeightEnabled\n        // 是否自动长高,默认true\n        //,autoHeightEnabled:true\n\n        //scaleEnabled\n        //是否可以拉伸长高,默认true(当开启时，自动长高失效)\n        //,scaleEnabled:false\n        //,minFrameWidth:800    //编辑器拖动时最小宽度,默认800\n        //,minFrameHeight:220  //编辑器拖动时最小高度,默认220\n\n        //autoFloatEnabled\n        //是否保持toolbar的位置不动,默认true\n        //,autoFloatEnabled:true\n        //浮动时工具栏距离浏览器顶部的高度，用于某些具有固定头部的页面\n        //,topOffset:30\n        //编辑器底部距离工具栏高度(如果参数大于等于编辑器高度，则设置无效)\n        //,toolbarTopOffset:400\n\n        //设置远程图片是否抓取到本地保存\n        //,catchRemoteImageEnable: true //设置是否抓取远程图片\n\n        //pageBreakTag\n        //分页标识符,默认是_ueditor_page_break_tag_\n        //,pageBreakTag:'_ueditor_page_break_tag_'\n\n        //autotypeset\n        //自动排版参数\n        //,autotypeset: {\n        //    mergeEmptyline: true,           //合并空行\n        //    removeClass: true,              //去掉冗余的class\n        //    removeEmptyline: false,         //去掉空行\n        //    textAlign:\"left\",               //段落的排版方式，可以是 left,right,center,justify 去掉这个属性表示不执行排版\n        //    imageBlockLine: 'center',       //图片的浮动方式，独占一行剧中,左右浮动，默认: center,left,right,none 去掉这个属性表示不执行排版\n        //    pasteFilter: false,             //根据规则过滤没事粘贴进来的内容\n        //    clearFontSize: false,           //去掉所有的内嵌字号，使用编辑器默认的字号\n        //    clearFontFamily: false,         //去掉所有的内嵌字体，使用编辑器默认的字体\n        //    removeEmptyNode: false,         // 去掉空节点\n        //    //可以去掉的标签\n        //    removeTagNames: {标签名字:1},\n        //    indent: false,                  // 行首缩进\n        //    indentValue : '2em',            //行首缩进的大小\n        //    bdc2sb: false,\n        //    tobdc: false\n        //}\n\n        //tableDragable\n        //表格是否可以拖拽\n        //,tableDragable: true\n\n        //sourceEditor\n        //源码的查看方式,codemirror 是代码高亮，textarea是文本框,默认是codemirror\n        //注意默认codemirror只能在ie8+和非ie中使用\n        //,sourceEditor:\"codemirror\"\n        //如果sourceEditor是codemirror，还用配置一下两个参数\n        //codeMirrorJsUrl js加载的路径，默认是 URL + \"third-party/codemirror/codemirror.js\"\n        //,codeMirrorJsUrl:URL + \"third-party/codemirror/codemirror.js\"\n        //codeMirrorCssUrl css加载的路径，默认是 URL + \"third-party/codemirror/codemirror.css\"\n        //,codeMirrorCssUrl:URL + \"third-party/codemirror/codemirror.css\"\n        //编辑器初始化完成后是否进入源码模式，默认为否。\n        //,sourceEditorFirst:false\n\n        //iframeUrlMap\n        //dialog内容的路径 ～会被替换成URL,垓属性一旦打开，将覆盖所有的dialog的默认路径\n        //,iframeUrlMap:{\n        //    'anchor':'~/dialogs/anchor/anchor.html',\n        //}\n\n        //allowLinkProtocol 允许的链接地址，有这些前缀的链接地址不会自动添加http\n        //, allowLinkProtocols: ['http:', 'https:', '#', '/', 'ftp:', 'mailto:', 'tel:', 'git:', 'svn:']\n\n        //webAppKey 百度应用的APIkey，每个站长必须首先去百度官网注册一个key后方能正常使用app功能，注册介绍，http://app.baidu.com/static/cms/getapikey.html\n        //, webAppKey: \"\"\n\n        //默认过滤规则相关配置项目\n        //,disabledTableInTable:true  //禁止表格嵌套\n        //,allowDivTransToP:true      //允许进入编辑器的div标签自动变成p标签\n        //,rgb2Hex:true               //默认产出的数据中的color自动从rgb格式变成16进制格式\n\n        // xss 过滤是否开启,inserthtml等操作\n        ,\n        xssFilterRules: true\n            //input xss过滤\n            ,\n        inputXssFilter: true\n            //output xss过滤\n            ,\n        outputXssFilter: true\n            // xss过滤白名单 名单来源: https://raw.githubusercontent.com/leizongmin/js-xss/master/lib/default.js\n            ,\n        whitList: {\n            a: ['target', 'style', 'href', 'title', 'class'],\n            abbr: ['title', 'class', 'style'],\n            address: ['class', 'style'],\n            area: ['shape', 'coords', 'href', 'alt'],\n            article: [],\n            aside: [],\n            audio: ['autoplay', 'controls', 'loop', 'preload', 'src', 'class', 'style'],\n            b: ['class', 'style'],\n            bdi: ['dir'],\n            bdo: ['dir'],\n            big: [],\n            blockquote: ['cite', 'class', 'style'],\n            br: [],\n            caption: ['class', 'style'],\n            center: [],\n            cite: [],\n            code: ['class', 'style'],\n            col: ['align', 'valign', 'span', 'width', 'class', 'style'],\n            colgroup: ['align', 'valign', 'span', 'width', 'class', 'style'],\n            dd: ['class', 'style'],\n            del: ['datetime'],\n            details: ['open'],\n            div: ['class', 'style', 'data-node', 'data-type', 'contenteditable', 'data-pid', 'data-info', 'data-goodsinfo', 'data-skuid'],\n            dl: ['class', 'style'],\n            dt: ['class', 'style'],\n            em: ['class', 'style'],\n            font: ['color', 'size', 'face'],\n            footer: [],\n            h1: ['data-node'],\n            h2: ['data-node'],\n            h3: ['class', 'data-node'],\n            h4: ['data-node'],\n            h5: ['data-node'],\n            h6: ['data-node'],\n            header: [],\n            hr: [],\n            i: ['class', 'style'],\n            img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-type', 'data-face', 'data-t', 'data-original', 'onerror', 'proto'],\n            ins: ['datetime'],\n            li: ['class', 'style'],\n            mark: [],\n            nav: [],\n            ol: ['class', 'style'],\n            p: ['class', 'style'],\n            pre: ['class', 'style'],\n            s: [],\n            section: [],\n            small: [],\n            span: ['class', 'style'],\n            sub: ['class', 'style'],\n            sup: ['class', 'style'],\n            strong: ['class', 'style'],\n            table: ['width', 'border', 'align', 'valign', 'class', 'style'],\n            tbody: ['align', 'valign', 'class', 'style'],\n            td: ['width', 'rowspan', 'colspan', 'align', 'valign', 'class', 'style'],\n            tfoot: ['align', 'valign', 'class', 'style'],\n            th: ['width', 'rowspan', 'colspan', 'align', 'valign', 'class', 'style'],\n            thead: ['align', 'valign', 'class', 'style'],\n            tr: ['rowspan', 'align', 'valign', 'class', 'style'],\n            tt: [],\n            u: [],\n            ul: ['class', 'style'],\n            video: ['autoplay', 'controls', 'loop', 'preload', 'src', 'height', 'width', 'class', 'style']\n        }\n    };\n\n    function getUEBasePath(docUrl, confUrl) {\n\n        return getBasePath(docUrl || self.document.URL || self.location.href, confUrl || getConfigFilePath());\n\n    }\n\n    function getConfigFilePath() {\n\n        var configPath = document.getElementsByTagName('script');\n\n        return configPath[configPath.length - 1].src;\n\n    }\n\n    function getBasePath(docUrl, confUrl) {\n\n        var basePath = confUrl;\n\n        if (/^(\\/|\\\\\\\\)/.test(confUrl)) {\n\n            basePath = /^.+?\\w(\\/|\\\\\\\\)/.exec(docUrl)[0] + confUrl.replace(/^(\\/|\\\\\\\\)/, '');\n\n        } else if (!/^[a-z]+:/i.test(confUrl)) {\n\n            docUrl = docUrl.split(\"#\")[0].split(\"?\")[0].replace(/[^\\\\\\/]+$/, '');\n\n            basePath = docUrl + \"\" + confUrl;\n\n        }\n\n        return optimizationPath(basePath);\n\n    }\n\n    function optimizationPath(path) {\n\n        var protocol = /^[a-z]+:\\/\\//.exec(path)[0],\n            tmp = null,\n            res = [];\n\n        path = path.replace(protocol, \"\").split(\"?\")[0].split(\"#\")[0];\n\n        path = path.replace(/\\\\/g, '/').split(/\\//);\n\n        path[path.length - 1] = \"\";\n\n        while (path.length) {\n\n            if ((tmp = path.shift()) === \"..\") {\n                res.pop();\n            } else if (tmp !== \".\") {\n                res.push(tmp);\n            }\n\n        }\n\n        return protocol + res.join(\"/\");\n\n    }\n\n    window.UE = {\n        getUEBasePath: getUEBasePath\n    };\n\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ueditor/ueditor.config.js","/*!\n * UEditor\n * version: ueditor\n * build: Wed Aug 10 2016 11:06:02 GMT+0800 (CST)\n */\n\n(function() {\n\t// editor.js\n\tUEDITOR_CONFIG = window.UEDITOR_CONFIG || {};\n\n\tvar baidu = window.baidu || {};\n\n\twindow.baidu = baidu;\n\n\twindow.UE = baidu.editor = window.UE || {};\n\n\tUE.plugins = {};\n\n\tUE.commands = {};\n\n\tUE.instants = {};\n\n\tUE.I18N = {};\n\n\tUE._customizeUI = {};\n\n\tUE.version = \"1.4.3\";\n\n\tvar dom = UE.dom = {};\n\n\t// core/browser.js\n\t/**\n\t * 浏览器判断模块\n\t * @file\n\t * @module UE.browser\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 提供浏览器检测的模块\n\t * @unfile\n\t * @module UE.browser\n\t */\n\tvar browser = UE.browser = function() {\n\t\tvar agent = navigator.userAgent.toLowerCase(),\n\t\t\topera = window.opera,\n\t\t\tbrowser = {\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} ie 检测当前浏览器是否为IE\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.ie ) {\n\t\t\t\t *     console.log( '当前浏览器是IE' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tie: /(msie\\s|trident.*rv:)([\\w.]+)/.test(agent),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} opera 检测当前浏览器是否为Opera\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.opera ) {\n\t\t\t\t *     console.log( '当前浏览器是Opera' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\topera: (!!opera && opera.version),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} webkit 检测当前浏览器是否是webkit内核的浏览器\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.webkit ) {\n\t\t\t\t *     console.log( '当前浏览器是webkit内核浏览器' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\twebkit: (agent.indexOf(' applewebkit/') > -1),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} mac 检测当前浏览器是否是运行在mac平台下\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.mac ) {\n\t\t\t\t *     console.log( '当前浏览器运行在mac平台下' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tmac: (agent.indexOf('macintosh') > -1),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} quirks 检测当前浏览器是否处于“怪异模式”下\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.quirks ) {\n\t\t\t\t *     console.log( '当前浏览器运行处于“怪异模式”' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tquirks: (document.compatMode == 'BackCompat')\n\t\t\t};\n\n\t\t/**\n\t\t * @property {boolean} gecko 检测当前浏览器内核是否是gecko内核\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.gecko ) {\n\t\t *     console.log( '当前浏览器内核是gecko内核' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tbrowser.gecko = (navigator.product == 'Gecko' && !browser.webkit && !browser.opera && !browser.ie);\n\n\t\tvar version = 0;\n\n\t\t// Internet Explorer 6.0+\n\t\tif (browser.ie) {\n\n\t\t\tvar v1 = agent.match(/(?:msie\\s([\\w.]+))/);\n\t\t\tvar v2 = agent.match(/(?:trident.*rv:([\\w.]+))/);\n\t\t\tif (v1 && v2 && v1[1] && v2[1]) {\n\t\t\t\tversion = Math.max(v1[1] * 1, v2[1] * 1);\n\t\t\t} else if (v1 && v1[1]) {\n\t\t\t\tversion = v1[1] * 1;\n\t\t\t} else if (v2 && v2[1]) {\n\t\t\t\tversion = v2[1] * 1;\n\t\t\t} else {\n\t\t\t\tversion = 0;\n\t\t\t}\n\n\t\t\tbrowser.ie11Compat = document.documentMode == 11;\n\t\t\t/**\n\t\t\t * @property { boolean } ie9Compat 检测浏览器模式是否为 IE9 兼容模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie9Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE9兼容模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie9Compat = document.documentMode == 9;\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie8 检测浏览器是否是IE8浏览器\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie8 ) {\n\t\t\t *     console.log( '当前浏览器是IE8浏览器' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie8 = !!document.documentMode;\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie8Compat 检测浏览器模式是否为 IE8 兼容模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie8Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE8兼容模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie8Compat = document.documentMode == 8;\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie7Compat 检测浏览器模式是否为 IE7 兼容模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie7Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE7兼容模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie7Compat = ((version == 7 && !document.documentMode) || document.documentMode == 7);\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie6Compat 检测浏览器模式是否为 IE6 模式 或者怪异模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie6Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE6模式或者怪异模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie6Compat = (version < 7 || browser.quirks);\n\n\t\t\tbrowser.ie9above = version > 8;\n\n\t\t\tbrowser.ie9below = version < 9;\n\n\t\t\tbrowser.ie11above = version > 10;\n\n\t\t\tbrowser.ie11below = version < 11;\n\n\t\t}\n\n\t\t// Gecko.\n\t\tif (browser.gecko) {\n\t\t\tvar geckoRelease = agent.match(/rv:([\\d\\.]+)/);\n\t\t\tif (geckoRelease) {\n\t\t\t\tgeckoRelease = geckoRelease[1].split('.');\n\t\t\t\tversion = geckoRelease[0] * 10000 + (geckoRelease[1] || 0) * 100 + (geckoRelease[2] || 0) * 1;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @property { Number } chrome 检测当前浏览器是否为Chrome, 如果是，则返回Chrome的大版本号\n\t\t * @warning 如果浏览器不是chrome， 则该值为undefined\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.chrome ) {\n\t\t *     console.log( '当前浏览器是Chrome' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tif (/chrome\\/(\\d+\\.\\d)/i.test(agent)) {\n\t\t\tbrowser.chrome = +RegExp['\\x241'];\n\t\t}\n\n\t\t/**\n\t\t * @property { Number } safari 检测当前浏览器是否为Safari, 如果是，则返回Safari的大版本号\n\t\t * @warning 如果浏览器不是safari， 则该值为undefined\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.safari ) {\n\t\t *     console.log( '当前浏览器是Safari' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tif (/(\\d+\\.\\d)?(?:\\.\\d)?\\s+safari\\/?(\\d+\\.\\d+)?/i.test(agent) && !/chrome/i.test(agent)) {\n\t\t\tbrowser.safari = +(RegExp['\\x241'] || RegExp['\\x242']);\n\t\t}\n\n\t\t// Opera 9.50+\n\t\tif (browser.opera)\n\t\t\tversion = parseFloat(opera.version());\n\n\t\t// WebKit 522+ (Safari 3+)\n\t\tif (browser.webkit)\n\t\t\tversion = parseFloat(agent.match(/ applewebkit\\/(\\d+)/)[1]);\n\n\t\t/**\n\t\t * @property { Number } version 检测当前浏览器版本号\n\t\t * @remind\n\t\t * <ul>\n\t\t *     <li>IE系列返回值为5,6,7,8,9,10等</li>\n\t\t *     <li>gecko系列会返回10900，158900等</li>\n\t\t *     <li>webkit系列会返回其build号 (如 522等)</li>\n\t\t * </ul>\n\t\t * @example\n\t\t * ```javascript\n\t\t * console.log( '当前浏览器版本号是： ' + UE.browser.version );\n\t\t * ```\n\t\t */\n\t\tbrowser.version = version;\n\n\t\t/**\n\t\t * @property { boolean } isCompatible 检测当前浏览器是否能够与UEditor良好兼容\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.isCompatible ) {\n\t\t *     console.log( '浏览器与UEditor能够良好兼容' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tbrowser.isCompatible = !browser.mobile && (\n\t\t\t(browser.ie && version >= 6) ||\n\t\t\t(browser.gecko && version >= 10801) ||\n\t\t\t(browser.opera && version >= 9.5) ||\n\t\t\t(browser.air && version >= 1) ||\n\t\t\t(browser.webkit && version >= 522) ||\n\t\t\tfalse);\n\t\treturn browser;\n\t}();\n\t//快捷方式\n\tvar ie = browser.ie,\n\t\twebkit = browser.webkit,\n\t\tgecko = browser.gecko,\n\t\topera = browser.opera;\n\n\t// core/utils.js\n\t/**\n\t * 工具函数包\n\t * @file\n\t * @module UE.utils\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor封装使用的静态工具函数\n\t * @module UE.utils\n\t * @unfile\n\t */\n\n\tvar utils = UE.utils = {\n\n\t\t/**\n\t\t * 用给定的迭代器遍历对象\n\t\t * @method each\n\t\t * @param { Object } obj 需要遍历的对象\n\t\t * @param { Function } iterator 迭代器， 该方法接受两个参数， 第一个参数是当前所处理的value， 第二个参数是当前遍历对象的key\n\t\t * @example\n\t\t * ```javascript\n\t\t * var demoObj = {\n\t\t *     key1: 1,\n\t\t *     key2: 2\n\t\t * };\n\t\t *\n\t\t * //output: key1: 1, key2: 2\n\t\t * UE.utils.each( demoObj, funciton ( value, key ) {\n\t\t *\n\t\t *     console.log( key + \":\" + value );\n\t\t *\n\t\t * } );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 用给定的迭代器遍历数组或类数组对象\n\t\t * @method each\n\t\t * @param { Array } array 需要遍历的数组或者类数组\n\t\t * @param { Function } iterator 迭代器， 该方法接受两个参数， 第一个参数是当前所处理的value， 第二个参数是当前遍历对象的key\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divs = document.getElmentByTagNames( \"div\" );\n\t\t *\n\t\t * //output: 0: DIV, 1: DIV ...\n\t\t * UE.utils.each( divs, funciton ( value, key ) {\n\t\t *\n\t\t *     console.log( key + \":\" + value.tagName );\n\t\t *\n\t\t * } );\n\t\t * ```\n\t\t */\n\t\teach: function(obj, iterator, context) {\n\t\t\tif (obj == null) return;\n\t\t\tif (obj.length === +obj.length) {\n\t\t\t\tfor (var i = 0, l = obj.length; i < l; i++) {\n\t\t\t\t\tif (iterator.call(context, obj[i], i, obj) === false)\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (var key in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (iterator.call(context, obj[key], key, obj) === false)\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 以给定对象作为原型创建一个新对象\n\t\t * @method makeInstance\n\t\t * @param { Object } protoObject 该对象将作为新创建对象的原型\n\t\t * @return { Object } 新的对象， 该对象的原型是给定的protoObject对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var protoObject = { sayHello: function () { console.log('Hello UEditor!'); } };\n\t\t *\n\t\t * var newObject = UE.utils.makeInstance( protoObject );\n\t\t * //output: Hello UEditor!\n\t\t * newObject.sayHello();\n\t\t * ```\n\t\t */\n\t\tmakeInstance: function(obj) {\n\t\t\tvar noop = new Function();\n\t\t\tnoop.prototype = obj;\n\t\t\tobj = new noop;\n\t\t\tnoop.prototype = null;\n\t\t\treturn obj;\n\t\t},\n\n\t\t/**\n\t\t * 将source对象中的属性扩展到target对象上\n\t\t * @method extend\n\t\t * @remind 该方法将强制把source对象上的属性复制到target对象上\n\t\t * @see UE.utils.extend(Object,Object,Boolean)\n\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t * @param { Object } source 源对象， 该对象的属性会被附加到target对象上\n\t\t * @return { Object } 返回target对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var target = { name: 'target', sex: 1 },\n\t\t *      source = { name: 'source', age: 17 };\n\t\t *\n\t\t * UE.utils.extend( target, source );\n\t\t *\n\t\t * //output: { name: 'source', sex: 1, age: 17 }\n\t\t * console.log( target );\n\t\t *\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 将source对象中的属性扩展到target对象上， 根据指定的isKeepTarget值决定是否保留目标对象中与\n\t\t * 源对象属性名相同的属性值。\n\t\t * @method extend\n\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t * @param { Object } source 源对象， 该对象的属性会被附加到target对象上\n\t\t * @param { Boolean } isKeepTarget 是否保留目标对象中与源对象中属性名相同的属性\n\t\t * @return { Object } 返回target对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var target = { name: 'target', sex: 1 },\n\t\t *      source = { name: 'source', age: 17 };\n\t\t *\n\t\t * UE.utils.extend( target, source, true );\n\t\t *\n\t\t * //output: { name: 'target', sex: 1, age: 17 }\n\t\t * console.log( target );\n\t\t *\n\t\t * ```\n\t\t */\n\t\textend: function(t, s, b) {\n\t\t\tif (s) {\n\t\t\t\tfor (var k in s) {\n\t\t\t\t\tif (!b || !t.hasOwnProperty(k)) {\n\t\t\t\t\t\tt[k] = s[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn t;\n\t\t},\n\n\t\t/**\n\t\t * 将给定的多个对象的属性复制到目标对象target上\n\t\t * @method extend2\n\t\t * @remind 该方法将强制把源对象上的属性复制到target对象上\n\t\t * @remind 该方法支持两个及以上的参数， 从第二个参数开始， 其属性都会被复制到第一个参数上。 如果遇到同名的属性，\n\t\t *          将会覆盖掉之前的值。\n\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t * @param { Object... } source 源对象， 支持多个对象， 该对象的属性会被附加到target对象上\n\t\t * @return { Object } 返回target对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var target = {},\n\t\t *     source1 = { name: 'source', age: 17 },\n\t\t *     source2 = { title: 'dev' };\n\t\t *\n\t\t * UE.utils.extend2( target, source1, source2 );\n\t\t *\n\t\t * //output: { name: 'source', age: 17, title: 'dev' }\n\t\t * console.log( target );\n\t\t *\n\t\t * ```\n\t\t */\n\t\textend2: function(t) {\n\t\t\tvar a = arguments;\n\t\t\tfor (var i = 1; i < a.length; i++) {\n\t\t\t\tvar x = a[i];\n\t\t\t\tfor (var k in x) {\n\t\t\t\t\tif (!t.hasOwnProperty(k)) {\n\t\t\t\t\t\tt[k] = x[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn t;\n\t\t},\n\n\t\t/**\n\t\t * 模拟继承机制， 使得subClass继承自superClass\n\t\t * @method inherits\n\t\t * @param { Object } subClass 子类对象\n\t\t * @param { Object } superClass 超类对象\n\t\t * @warning 该方法只能让subClass继承超类的原型， subClass对象自身的属性和方法不会被继承\n\t\t * @return { Object } 继承superClass后的子类对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * function SuperClass(){\n\t\t *     this.name = \"小李\";\n\t\t * }\n\t\t *\n\t\t * SuperClass.prototype = {\n\t\t *     hello:function(str){\n\t\t *         console.log(this.name + str);\n\t\t *     }\n\t\t * }\n\t\t *\n\t\t * function SubClass(){\n\t\t *     this.name = \"小张\";\n\t\t * }\n\t\t *\n\t\t * UE.utils.inherits(SubClass,SuperClass);\n\t\t *\n\t\t * var sub = new SubClass();\n\t\t * //output: '小张早上好!\n\t\t * sub.hello(\"早上好!\");\n\t\t * ```\n\t\t */\n\t\tinherits: function(subClass, superClass) {\n\t\t\tvar oldP = subClass.prototype,\n\t\t\t\tnewP = utils.makeInstance(superClass.prototype);\n\t\t\tutils.extend(newP, oldP, true);\n\t\t\tsubClass.prototype = newP;\n\t\t\treturn (newP.constructor = subClass);\n\t\t},\n\n\t\t/**\n\t\t * 用指定的context对象作为函数fn的上下文\n\t\t * @method bind\n\t\t * @param { Function } fn 需要绑定上下文的函数对象\n\t\t * @param { Object } content 函数fn新的上下文对象\n\t\t * @return { Function } 一个新的函数， 该函数作为原始函数fn的代理， 将完成fn的上下文调换工作。\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var name = 'window',\n\t\t *     newTest = null;\n\t\t *\n\t\t * function test () {\n\t\t *     console.log( this.name );\n\t\t * }\n\t\t *\n\t\t * newTest = UE.utils.bind( test, { name: 'object' } );\n\t\t *\n\t\t * //output: object\n\t\t * newTest();\n\t\t *\n\t\t * //output: window\n\t\t * test();\n\t\t *\n\t\t * ```\n\t\t */\n\t\tbind: function(fn, context) {\n\t\t\treturn function() {\n\t\t\t\treturn fn.apply(context, arguments);\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * 创建延迟指定时间后执行的函数fn\n\t\t * @method defer\n\t\t * @param { Function } fn 需要延迟执行的函数对象\n\t\t * @param { int } delay 延迟的时间， 单位是毫秒\n\t\t * @warning 该方法的时间控制是不精确的，仅仅只能保证函数的执行是在给定的时间之后，\n\t\t *           而不能保证刚好到达延迟时间时执行。\n\t\t * @return { Function } 目标函数fn的代理函数， 只有执行该函数才能起到延时效果\n\t\t * @example\n\t\t * ```javascript\n\t\t * var start = 0;\n\t\t *\n\t\t * function test(){\n\t\t *     console.log( new Date() - start );\n\t\t * }\n\t\t *\n\t\t * var testDefer = UE.utils.defer( test, 1000 );\n\t\t * //\n\t\t * start = new Date();\n\t\t * //output: (大约在1000毫秒之后输出) 1000\n\t\t * testDefer();\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 创建延迟指定时间后执行的函数fn, 如果在延迟时间内再次执行该方法， 将会根据指定的exclusion的值，\n\t\t * 决定是否取消前一次函数的执行， 如果exclusion的值为true， 则取消执行，反之，将继续执行前一个方法。\n\t\t * @method defer\n\t\t * @param { Function } fn 需要延迟执行的函数对象\n\t\t * @param { int } delay 延迟的时间， 单位是毫秒\n\t\t * @param { Boolean } exclusion 如果在延迟时间内再次执行该函数，该值将决定是否取消执行前一次函数的执行，\n\t\t *                     值为true表示取消执行， 反之则将在执行前一次函数之后才执行本次函数调用。\n\t\t * @warning 该方法的时间控制是不精确的，仅仅只能保证函数的执行是在给定的时间之后，\n\t\t *           而不能保证刚好到达延迟时间时执行。\n\t\t * @return { Function } 目标函数fn的代理函数， 只有执行该函数才能起到延时效果\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * function test(){\n\t\t *     console.log(1);\n\t\t * }\n\t\t *\n\t\t * var testDefer = UE.utils.defer( test, 1000, true );\n\t\t *\n\t\t * //output: (两次调用仅有一次输出) 1\n\t\t * testDefer();\n\t\t * testDefer();\n\t\t * ```\n\t\t */\n\t\tdefer: function(fn, delay, exclusion) {\n\t\t\tvar timerID;\n\t\t\treturn function() {\n\t\t\t\tif (exclusion) {\n\t\t\t\t\tclearTimeout(timerID);\n\t\t\t\t}\n\t\t\t\ttimerID = setTimeout(fn, delay);\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * 获取元素item在数组array中首次出现的位置, 如果未找到item， 则返回-1\n\t\t * @method indexOf\n\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t * @param { Array } array 需要查找的数组对象\n\t\t * @param { * } item 需要在目标数组中查找的值\n\t\t * @return { int } 返回item在目标数组array中首次出现的位置， 如果在数组中未找到item， 则返回-1\n\t\t * @example\n\t\t * ```javascript\n\t\t * var item = 1,\n\t\t *     arr = [ 3, 4, 6, 8, 1, 1, 2 ];\n\t\t *\n\t\t * //output: 4\n\t\t * console.log( UE.utils.indexOf( arr, item ) );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 获取元素item数组array中首次出现的位置, 如果未找到item， 则返回-1。通过start的值可以指定搜索的起始位置。\n\t\t * @method indexOf\n\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t * @param { Array } array 需要查找的数组对象\n\t\t * @param { * } item 需要在目标数组中查找的值\n\t\t * @param { int } start 搜索的起始位置\n\t\t * @return { int } 返回item在目标数组array中的start位置之后首次出现的位置， 如果在数组中未找到item， 则返回-1\n\t\t * @example\n\t\t * ```javascript\n\t\t * var item = 1,\n\t\t *     arr = [ 3, 4, 6, 8, 1, 2, 8, 3, 2, 1, 1, 4 ];\n\t\t *\n\t\t * //output: 9\n\t\t * console.log( UE.utils.indexOf( arr, item, 5 ) );\n\t\t * ```\n\t\t */\n\t\tindexOf: function(array, item, start) {\n\t\t\tvar index = -1;\n\t\t\tstart = this.isNumber(start) ? start : 0;\n\t\t\tthis.each(array, function(v, i) {\n\t\t\t\tif (i >= start && v === item) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn index;\n\t\t},\n\n\t\t/**\n\t\t * 移除数组array中所有的元素item\n\t\t * @method removeItem\n\t\t * @param { Array } array 要移除元素的目标数组\n\t\t * @param { * } item 将要被移除的元素\n\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t * @example\n\t\t * ```javascript\n\t\t * var arr = [ 4, 5, 7, 1, 3, 4, 6 ];\n\t\t *\n\t\t * UE.utils.removeItem( arr, 4 );\n\t\t * //output: [ 5, 7, 1, 3, 6 ]\n\t\t * console.log( arr );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tremoveItem: function(array, item) {\n\t\t\tfor (var i = 0, l = array.length; i < l; i++) {\n\t\t\t\tif (array[i] === item) {\n\t\t\t\t\tarray.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 删除字符串str的首尾空格\n\t\t * @method trim\n\t\t * @param { String } str 需要删除首尾空格的字符串\n\t\t * @return { String } 删除了首尾的空格后的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var str = \" UEdtior \";\n\t\t *\n\t\t * //output: 9\n\t\t * console.log( str.length );\n\t\t *\n\t\t * //output: 7\n\t\t * console.log( UE.utils.trim( \" UEdtior \" ).length );\n\t\t *\n\t\t * //output: 9\n\t\t * console.log( str.length );\n\t\t *\n\t\t *  ```\n\t\t */\n\t\ttrim: function(str) {\n\t\t\treturn str.replace(/(^[ \\t\\n\\r]+)|([ \\t\\n\\r]+$)/g, '');\n\t\t},\n\n\t\t/**\n\t\t * 将字符串str以','分隔成数组后，将该数组转换成哈希对象， 其生成的hash对象的key为数组中的元素， value为1\n\t\t * @method listToMap\n\t\t * @warning 该方法在生成的hash对象中，会为每一个key同时生成一个另一个全大写的key。\n\t\t * @param { String } str 该字符串将被以','分割为数组， 然后进行转化\n\t\t * @return { Object } 转化之后的hash对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: Object {UEdtior: 1, UEDTIOR: 1, Hello: 1, HELLO: 1}\n\t\t * console.log( UE.utils.listToMap( 'UEdtior,Hello' ) );\n\t\t *\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 将字符串数组转换成哈希对象， 其生成的hash对象的key为数组中的元素， value为1\n\t\t * @method listToMap\n\t\t * @warning 该方法在生成的hash对象中，会为每一个key同时生成一个另一个全大写的key。\n\t\t * @param { Array } arr 字符串数组\n\t\t * @return { Object } 转化之后的hash对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: Object {UEdtior: 1, UEDTIOR: 1, Hello: 1, HELLO: 1}\n\t\t * console.log( UE.utils.listToMap( [ 'UEdtior', 'Hello' ] ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tlistToMap: function(list) {\n\t\t\tif (!list) return {};\n\t\t\tlist = utils.isArray(list) ? list : list.split(',');\n\t\t\tfor (var i = 0, ci, obj = {}; ci = list[i++];) {\n\t\t\t\tobj[ci.toUpperCase()] = obj[ci] = 1;\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\n\t\t/**\n\t\t * 将str中的html符号转义,将转义“'，&，<，\"，>”五个字符\n\t\t * @method unhtml\n\t\t * @param { String } str 需要转义的字符串\n\t\t * @return { String } 转义后的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * var html = '<body>&</body>';\n\t\t *\n\t\t * //output: &lt;body&gt;&amp;&lt;/body&gt;\n\t\t * console.log( UE.utils.unhtml( html ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tunhtml: function(str, reg) {\n\t\t\treturn str ? str.replace(reg || /[&<\">'](?:(amp|lt|quot|gt|#39|nbsp|#\\d+);)?/g, function(a, b) {\n\t\t\t\tif (b) {\n\t\t\t\t\treturn a;\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'<': '&lt;',\n\t\t\t\t\t\t'&': '&amp;',\n\t\t\t\t\t\t'\"': '&quot;',\n\t\t\t\t\t\t'>': '&gt;',\n\t\t\t\t\t\t\"'\": '&#39;'\n\t\t\t\t\t}[a]\n\t\t\t\t}\n\n\t\t\t}) : '';\n\t\t},\n\t\t/**\n\t\t * 将url中的html字符转义， 仅转义  ', \", <, > 四个字符\n\t\t * @param  { String } str 需要转义的字符串\n\t\t * @param  { RegExp } reg 自定义的正则\n\t\t * @return { String }     转义后的字符串\n\t\t */\n\t\tunhtmlForUrl: function(str, reg) {\n\t\t\treturn str ? str.replace(reg || /[<\">']/g, function(a) {\n\t\t\t\treturn {\n\t\t\t\t\t'<': '&lt;',\n\t\t\t\t\t'&': '&amp;',\n\t\t\t\t\t'\"': '&quot;',\n\t\t\t\t\t'>': '&gt;',\n\t\t\t\t\t\"'\": '&#39;'\n\t\t\t\t}[a]\n\n\t\t\t}) : '';\n\t\t},\n\n\t\t/**\n\t\t * 将str中的转义字符还原成html字符\n\t\t * @see UE.utils.unhtml(String);\n\t\t * @method html\n\t\t * @param { String } str 需要逆转义的字符串\n\t\t * @return { String } 逆转义后的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var str = '&lt;body&gt;&amp;&lt;/body&gt;';\n\t\t *\n\t\t * //output: <body>&</body>\n\t\t * console.log( UE.utils.html( str ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\thtml: function(str) {\n\t\t\treturn str ? str.replace(/&((g|l|quo)t|amp|#39|nbsp);/g, function(m) {\n\t\t\t\treturn {\n\t\t\t\t\t'&lt;': '<',\n\t\t\t\t\t'&amp;': '&',\n\t\t\t\t\t'&quot;': '\"',\n\t\t\t\t\t'&gt;': '>',\n\t\t\t\t\t'&#39;': \"'\",\n\t\t\t\t\t'&nbsp;': ' '\n\t\t\t\t}[m]\n\t\t\t}) : '';\n\t\t},\n\n\t\t/**\n\t\t * 将css样式转换为驼峰的形式\n\t\t * @method cssStyleToDomStyle\n\t\t * @param { String } cssName 需要转换的css样式名\n\t\t * @return { String } 转换成驼峰形式后的css样式名\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var str = 'border-top';\n\t\t *\n\t\t * //output: borderTop\n\t\t * console.log( UE.utils.cssStyleToDomStyle( str ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tcssStyleToDomStyle: function() {\n\t\t\tvar test = document.createElement('div').style,\n\t\t\t\tcache = {\n\t\t\t\t\t'float': test.cssFloat != undefined ? 'cssFloat' : test.styleFloat != undefined ? 'styleFloat' : 'float'\n\t\t\t\t};\n\n\t\t\treturn function(cssName) {\n\t\t\t\treturn cache[cssName] || (cache[cssName] = cssName.toLowerCase().replace(/-./g, function(match) {\n\t\t\t\t\treturn match.charAt(1).toUpperCase();\n\t\t\t\t}));\n\t\t\t};\n\t\t}(),\n\n\t\t/**\n\t\t * 动态加载文件到doc中\n\t\t * @method loadFile\n\t\t * @param { DomDocument } document 需要加载资源文件的文档对象\n\t\t * @param { Object } options 加载资源文件的属性集合， 取值请参考代码示例\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * UE.utils.loadFile( document, {\n\t\t *     src:\"test.js\",\n\t\t *     tag:\"script\",\n\t\t *     type:\"text/javascript\",\n\t\t *     defer:\"defer\"\n\t\t * } );\n\t\t *\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 动态加载文件到doc中，加载成功后执行的回调函数fn\n\t\t * @method loadFile\n\t\t * @param { DomDocument } document 需要加载资源文件的文档对象\n\t\t * @param { Object } options 加载资源文件的属性集合， 该集合支持的值是script标签和style标签支持的所有属性。\n\t\t * @param { Function } fn 资源文件加载成功之后执行的回调\n\t\t * @warning 对于在同一个文档中多次加载同一URL的文件， 该方法会在第一次加载之后缓存该请求，\n\t\t *           在此之后的所有同一URL的请求， 将会直接触发回调。\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * UE.utils.loadFile( document, {\n\t\t *     src:\"test.js\",\n\t\t *     tag:\"script\",\n\t\t *     type:\"text/javascript\",\n\t\t *     defer:\"defer\"\n\t\t * }, function () {\n\t\t *     console.log('加载成功');\n\t\t * } );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tloadFile: function() {\n\t\t\tvar tmpList = [];\n\n\t\t\tfunction getItem(doc, obj) {\n\t\t\t\ttry {\n\t\t\t\t\tfor (var i = 0, ci; ci = tmpList[i++];) {\n\t\t\t\t\t\tif (ci.doc === doc && ci.url == (obj.src || obj.href)) {\n\t\t\t\t\t\t\treturn ci;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn function(doc, obj, fn) {\n\t\t\t\tvar item = getItem(doc, obj);\n\t\t\t\tif (item) {\n\t\t\t\t\tif (item.ready) {\n\t\t\t\t\t\tfn && fn();\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.funs.push(fn)\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttmpList.push({\n\t\t\t\t\tdoc: doc,\n\t\t\t\t\turl: obj.src || obj.href,\n\t\t\t\t\tfuns: [fn]\n\t\t\t\t});\n\t\t\t\tif (!doc.body) {\n\t\t\t\t\tvar html = [];\n\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\tif (p == 'tag') continue;\n\t\t\t\t\t\thtml.push(p + '=\"' + obj[p] + '\"')\n\t\t\t\t\t}\n\t\t\t\t\tdoc.write('<' + obj.tag + ' ' + html.join(' ') + ' ></' + obj.tag + '>');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (obj.id && doc.getElementById(obj.id)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar element = doc.createElement(obj.tag);\n\t\t\t\tdelete obj.tag;\n\t\t\t\tfor (var p in obj) {\n\t\t\t\t\telement.setAttribute(p, obj[p]);\n\t\t\t\t}\n\t\t\t\telement.onload = element.onreadystatechange = function() {\n\t\t\t\t\tif (!this.readyState || /loaded|complete/.test(this.readyState)) {\n\t\t\t\t\t\titem = getItem(doc, obj);\n\t\t\t\t\t\tif (item.funs.length > 0) {\n\t\t\t\t\t\t\titem.ready = 1;\n\t\t\t\t\t\t\tfor (var fi; fi = item.funs.pop();) {\n\t\t\t\t\t\t\t\tfi();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telement.onload = element.onreadystatechange = null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\telement.onerror = function() {\n\t\t\t\t\tthrow Error('The load ' + (obj.href || obj.src) + ' fails,check the url settings of file ueditor.config.js ')\n\t\t\t\t};\n\t\t\t\tdoc.getElementsByTagName(\"head\")[0].appendChild(element);\n\t\t\t}\n\t\t}(),\n\n\t\t/**\n\t\t * 判断obj对象是否为空\n\t\t * @method isEmptyObject\n\t\t * @param { * } obj 需要判断的对象\n\t\t * @remind 如果判断的对象是NULL， 将直接返回true， 如果是数组且为空， 返回true， 如果是字符串， 且字符串为空，\n\t\t *          返回true， 如果是普通对象， 且该对象没有任何实例属性， 返回true\n\t\t * @return { Boolean } 对象是否为空\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.utils.isEmptyObject( {} ) );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.utils.isEmptyObject( [] ) );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.utils.isEmptyObject( \"\" ) );\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.utils.isEmptyObject( { key: 1 } ) );\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.utils.isEmptyObject( [1] ) );\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.utils.isEmptyObject( \"1\" ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tisEmptyObject: function(obj) {\n\t\t\tif (obj == null) return true;\n\t\t\tif (this.isArray(obj) || this.isString(obj)) return obj.length === 0;\n\t\t\tfor (var key in obj)\n\t\t\t\tif (obj.hasOwnProperty(key)) return false;\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * 把rgb格式的颜色值转换成16进制格式\n\t\t * @method fixColor\n\t\t * @param { String } rgb格式的颜色值\n\t\t * @param { String }\n\t\t * @example\n\t\t * rgb(255,255,255)  => \"#ffffff\"\n\t\t */\n\t\tfixColor: function(name, value) {\n\t\t\tif (/color/i.test(name) && /rgba?/.test(value)) {\n\t\t\t\tvar array = value.split(\",\");\n\t\t\t\tif (array.length > 3)\n\t\t\t\t\treturn \"\";\n\t\t\t\tvalue = \"#\";\n\t\t\t\tfor (var i = 0, color; color = array[i++];) {\n\t\t\t\t\tcolor = parseInt(color.replace(/[^\\d]/gi, ''), 10).toString(16);\n\t\t\t\t\tvalue += color.length == 1 ? \"0\" + color : color;\n\t\t\t\t}\n\t\t\t\tvalue = value.toUpperCase();\n\t\t\t}\n\t\t\treturn value;\n\t\t},\n\t\t/**\n\t\t * 只针对border,padding,margin做了处理，因为性能问题\n\t\t * @public\n\t\t * @function\n\t\t * @param {String}    val style字符串\n\t\t */\n\t\toptCss: function(val) {\n\t\t\tvar padding, margin, border;\n\t\t\tval = val.replace(/(padding|margin|border)\\-([^:]+):([^;]+);?/gi, function(str, key, name, val) {\n\t\t\t\tif (val.split(' ').length == 1) {\n\t\t\t\t\tswitch (key) {\n\t\t\t\t\t\tcase 'padding':\n\t\t\t\t\t\t\t!padding && (padding = {});\n\t\t\t\t\t\t\tpadding[name] = val;\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\tcase 'margin':\n\t\t\t\t\t\t\t!margin && (margin = {});\n\t\t\t\t\t\t\tmargin[name] = val;\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\tcase 'border':\n\t\t\t\t\t\t\treturn val == 'initial' ? '' : str;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn str;\n\t\t\t});\n\n\t\t\tfunction opt(obj, name) {\n\t\t\t\tif (!obj) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tvar t = obj.top,\n\t\t\t\t\tb = obj.bottom,\n\t\t\t\t\tl = obj.left,\n\t\t\t\t\tr = obj.right,\n\t\t\t\t\tval = '';\n\t\t\t\tif (!t || !l || !b || !r) {\n\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\tval += ';' + name + '-' + p + ':' + obj[p] + ';';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tval += ';' + name + ':' +\n\t\t\t\t\t\t(t == b && b == l && l == r ? t :\n\t\t\t\t\t\t\tt == b && l == r ? (t + ' ' + l) :\n\t\t\t\t\t\t\tl == r ? (t + ' ' + l + ' ' + b) : (t + ' ' + r + ' ' + b + ' ' + l)) + ';'\n\t\t\t\t}\n\t\t\t\treturn val;\n\t\t\t}\n\n\t\t\tval += opt(padding, 'padding') + opt(margin, 'margin');\n\t\t\treturn val.replace(/^[ \\n\\r\\t;]*|[ \\n\\r\\t]*$/, '').replace(/;([ \\n\\r\\t]+)|\\1;/g, ';')\n\t\t\t\t.replace(/(&((l|g)t|quot|#39))?;{2,}/g, function(a, b) {\n\t\t\t\t\treturn b ? b + \";;\" : ';'\n\t\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * 克隆对象\n\t\t * @method clone\n\t\t * @param { Object } source 源对象\n\t\t * @return { Object } source的一个副本\n\t\t */\n\n\t\t/**\n\t\t * 深度克隆对象，将source的属性克隆到target对象， 会覆盖target重名的属性。\n\t\t * @method clone\n\t\t * @param { Object } source 源对象\n\t\t * @param { Object } target 目标对象\n\t\t * @return { Object } 附加了source对象所有属性的target对象\n\t\t */\n\t\tclone: function(source, target) {\n\t\t\tvar tmp;\n\t\t\ttarget = target || {};\n\t\t\tfor (var i in source) {\n\t\t\t\tif (source.hasOwnProperty(i)) {\n\t\t\t\t\ttmp = source[i];\n\t\t\t\t\tif (typeof tmp == 'object') {\n\t\t\t\t\t\ttarget[i] = utils.isArray(tmp) ? [] : {};\n\t\t\t\t\t\tutils.clone(source[i], target[i])\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget[i] = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn target;\n\t\t},\n\n\t\t/**\n\t\t * 把cm／pt为单位的值转换为px为单位的值\n\t\t * @method transUnitToPx\n\t\t * @param { String } 待转换的带单位的字符串\n\t\t * @return { String } 转换为px为计量单位的值的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: 500px\n\t\t * console.log( UE.utils.transUnitToPx( '20cm' ) );\n\t\t *\n\t\t * //output: 27px\n\t\t * console.log( UE.utils.transUnitToPx( '20pt' ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\ttransUnitToPx: function(val) {\n\t\t\tif (!/(pt|cm)/.test(val)) {\n\t\t\t\treturn val\n\t\t\t}\n\t\t\tvar unit;\n\t\t\tval.replace(/([\\d.]+)(\\w+)/, function(str, v, u) {\n\t\t\t\tval = v;\n\t\t\t\tunit = u;\n\t\t\t});\n\t\t\tswitch (unit) {\n\t\t\t\tcase 'cm':\n\t\t\t\t\tval = parseFloat(val) * 25;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pt':\n\t\t\t\t\tval = Math.round(parseFloat(val) * 96 / 72);\n\t\t\t}\n\t\t\treturn val + (val ? 'px' : '');\n\t\t},\n\n\t\t/**\n\t\t * 在dom树ready之后执行给定的回调函数\n\t\t * @method domReady\n\t\t * @remind 如果在执行该方法的时候， dom树已经ready， 那么回调函数将立刻执行\n\t\t * @param { Function } fn dom树ready之后的回调函数\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * UE.utils.domReady( function () {\n\t\t *\n\t\t *     console.log('123');\n\t\t *\n\t\t * } );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tdomReady: function() {\n\n\t\t\tvar fnArr = [];\n\n\t\t\tfunction doReady(doc) {\n\t\t\t\t//确保onready只执行一次\n\t\t\t\tdoc.isReady = true;\n\t\t\t\tfor (var ci; ci = fnArr.pop(); ci()) {}\n\t\t\t}\n\n\t\t\treturn function(onready, win) {\n\t\t\t\twin = win || window;\n\t\t\t\tvar doc = win.document;\n\t\t\t\tonready && fnArr.push(onready);\n\t\t\t\tif (doc.readyState === \"complete\") {\n\t\t\t\t\tdoReady(doc);\n\t\t\t\t} else {\n\t\t\t\t\tdoc.isReady && doReady(doc);\n\t\t\t\t\tif (browser.ie && browser.version != 11) {\n\t\t\t\t\t\t(function() {\n\t\t\t\t\t\t\tif (doc.isReady) return;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tdoc.documentElement.doScroll(\"left\");\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\tsetTimeout(arguments.callee, 0);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdoReady(doc);\n\t\t\t\t\t\t})();\n\t\t\t\t\t\twin.attachEvent('onload', function() {\n\t\t\t\t\t\t\tdoReady(doc)\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdoc.addEventListener(\"DOMContentLoaded\", function() {\n\t\t\t\t\t\t\tdoc.removeEventListener(\"DOMContentLoaded\", arguments.callee, false);\n\t\t\t\t\t\t\tdoReady(doc);\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t\twin.addEventListener('load', function() {\n\t\t\t\t\t\t\tdoReady(doc)\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}(),\n\n\t\t/**\n\t\t * 动态添加css样式\n\t\t * @method cssRule\n\t\t * @param { String } 节点名称\n\t\t * @grammar UE.utils.cssRule('添加的样式的节点名称',['样式'，'放到哪个document上'])\n\t\t * @grammar UE.utils.cssRule('body','body{background:#ccc}') => null  //给body添加背景颜色\n\t\t * @grammar UE.utils.cssRule('body') =>样式的字符串  //取得key值为body的样式的内容,如果没有找到key值先关的样式将返回空，例如刚才那个背景颜色，将返回 body{background:#ccc}\n\t\t * @grammar UE.utils.cssRule('body',document) => 返回指定key的样式，并且指定是哪个document\n\t\t * @grammar UE.utils.cssRule('body','') =>null //清空给定的key值的背景颜色\n\t\t */\n\t\tcssRule: browser.ie && browser.version != 11 ? function(key, style, doc) {\n\t\t\tvar indexList, index;\n\t\t\tif (style === undefined || style && style.nodeType && style.nodeType == 9) {\n\t\t\t\t//获取样式\n\t\t\t\tdoc = style && style.nodeType && style.nodeType == 9 ? style : (doc || document);\n\t\t\t\tindexList = doc.indexList || (doc.indexList = {});\n\t\t\t\tindex = indexList[key];\n\t\t\t\tif (index !== undefined) {\n\t\t\t\t\treturn doc.styleSheets[index].cssText\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tdoc = doc || document;\n\t\t\tindexList = doc.indexList || (doc.indexList = {});\n\t\t\tindex = indexList[key];\n\t\t\t//清除样式\n\t\t\tif (style === '') {\n\t\t\t\tif (index !== undefined) {\n\t\t\t\t\tdoc.styleSheets[index].cssText = '';\n\t\t\t\t\tdelete indexList[key];\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//添加样式\n\t\t\tif (index !== undefined) {\n\t\t\t\tsheetStyle = doc.styleSheets[index];\n\t\t\t} else {\n\t\t\t\tsheetStyle = doc.createStyleSheet('', index = doc.styleSheets.length);\n\t\t\t\tindexList[key] = index;\n\t\t\t}\n\t\t\tsheetStyle.cssText = style;\n\t\t} : function(key, style, doc) {\n\t\t\tvar head, node;\n\t\t\tif (style === undefined || style && style.nodeType && style.nodeType == 9) {\n\t\t\t\t//获取样式\n\t\t\t\tdoc = style && style.nodeType && style.nodeType == 9 ? style : (doc || document);\n\t\t\t\tnode = doc.getElementById(key);\n\t\t\t\treturn node ? node.innerHTML : undefined;\n\t\t\t}\n\t\t\tdoc = doc || document;\n\t\t\tnode = doc.getElementById(key);\n\n\t\t\t//清除样式\n\t\t\tif (style === '') {\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//添加样式\n\t\t\tif (node) {\n\t\t\t\tnode.innerHTML = style;\n\t\t\t} else {\n\t\t\t\tnode = doc.createElement('style');\n\t\t\t\tnode.id = key;\n\t\t\t\tnode.innerHTML = style;\n\t\t\t\tdoc.getElementsByTagName('head')[0].appendChild(node);\n\t\t\t}\n\t\t},\n\t\tsort: function(array, compareFn) {\n\t\t\tcompareFn = compareFn || function(item1, item2) {\n\t\t\t\treturn item1.localeCompare(item2);\n\t\t\t};\n\t\t\tfor (var i = 0, len = array.length; i < len; i++) {\n\t\t\t\tfor (var j = i, length = array.length; j < length; j++) {\n\t\t\t\t\tif (compareFn(array[i], array[j]) > 0) {\n\t\t\t\t\t\tvar t = array[i];\n\t\t\t\t\t\tarray[i] = array[j];\n\t\t\t\t\t\tarray[j] = t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn array;\n\t\t},\n\t\tserializeParam: function(json) {\n\t\t\tvar strArr = [];\n\t\t\tfor (var i in json) {\n\t\t\t\t//忽略默认的几个参数\n\t\t\t\tif (i == \"method\" || i == \"timeout\" || i == \"async\") continue;\n\t\t\t\t//传递过来的对象和函数不在提交之列\n\t\t\t\tif (!((typeof json[i]).toLowerCase() == \"function\" || (typeof json[i]).toLowerCase() == \"object\")) {\n\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"=\" + encodeURIComponent(json[i]));\n\t\t\t\t} else if (utils.isArray(json[i])) {\n\t\t\t\t\t//支持传数组内容\n\t\t\t\t\tfor (var j = 0; j < json[i].length; j++) {\n\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"[]=\" + encodeURIComponent(json[i][j]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn strArr.join(\"&\");\n\t\t},\n\t\tformatUrl: function(url) {\n\t\t\tvar u = url.replace(/&&/g, '&');\n\t\t\tu = u.replace(/\\?&/g, '?');\n\t\t\tu = u.replace(/&$/g, '');\n\t\t\tu = u.replace(/&#/g, '#');\n\t\t\tu = u.replace(/&+/g, '&');\n\t\t\treturn u;\n\t\t},\n\t\tisCrossDomainUrl: function(url) {\n\t\t\tvar a = document.createElement('a');\n\t\t\ta.href = url;\n\t\t\tif (browser.ie) {\n\t\t\t\ta.href = a.href;\n\t\t\t}\n\t\t\treturn !(a.protocol == location.protocol && a.hostname == location.hostname &&\n\t\t\t\t(a.port == location.port || (a.port == '80' && location.port == '') || (a.port == '' && location.port == '80')));\n\t\t},\n\t\tclearEmptyAttrs: function(obj) {\n\t\t\tfor (var p in obj) {\n\t\t\t\tif (obj[p] === '') {\n\t\t\t\t\tdelete obj[p]\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\t\tstr2json: function(s) {\n\n\t\t\tif (!utils.isString(s)) return null;\n\t\t\tif (window.JSON) {\n\t\t\t\treturn JSON.parse(s);\n\t\t\t} else {\n\t\t\t\treturn (new Function(\"return \" + utils.trim(s || '')))();\n\t\t\t}\n\n\t\t},\n\t\tjson2str: (function() {\n\n\t\t\tif (window.JSON) {\n\n\t\t\t\treturn JSON.stringify;\n\n\t\t\t} else {\n\n\t\t\t\tvar escapeMap = {\n\t\t\t\t\t\"\\b\": '\\\\b',\n\t\t\t\t\t\"\\t\": '\\\\t',\n\t\t\t\t\t\"\\n\": '\\\\n',\n\t\t\t\t\t\"\\f\": '\\\\f',\n\t\t\t\t\t\"\\r\": '\\\\r',\n\t\t\t\t\t'\"': '\\\\\"',\n\t\t\t\t\t\"\\\\\": '\\\\\\\\'\n\t\t\t\t};\n\n\t\t\t\tfunction encodeString(source) {\n\t\t\t\t\tif (/[\"\\\\\\x00-\\x1f]/.test(source)) {\n\t\t\t\t\t\tsource = source.replace(\n\t\t\t\t\t\t\t/[\"\\\\\\x00-\\x1f]/g,\n\t\t\t\t\t\t\tfunction(match) {\n\t\t\t\t\t\t\t\tvar c = escapeMap[match];\n\t\t\t\t\t\t\t\tif (c) {\n\t\t\t\t\t\t\t\t\treturn c;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tc = match.charCodeAt();\n\t\t\t\t\t\t\t\treturn \"\\\\u00\" + Math.floor(c / 16).toString(16) + (c % 16).toString(16);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn '\"' + source + '\"';\n\t\t\t\t}\n\n\t\t\t\tfunction encodeArray(source) {\n\t\t\t\t\tvar result = [\"[\"],\n\t\t\t\t\t\tl = source.length,\n\t\t\t\t\t\tpreComma, i, item;\n\n\t\t\t\t\tfor (i = 0; i < l; i++) {\n\t\t\t\t\t\titem = source[i];\n\n\t\t\t\t\t\tswitch (typeof item) {\n\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\t\tcase \"unknown\":\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tif (preComma) {\n\t\t\t\t\t\t\t\t\tresult.push(',');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresult.push(utils.json2str(item));\n\t\t\t\t\t\t\t\tpreComma = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresult.push(\"]\");\n\t\t\t\t\treturn result.join(\"\");\n\t\t\t\t}\n\n\t\t\t\tfunction pad(source) {\n\t\t\t\t\treturn source < 10 ? '0' + source : source;\n\t\t\t\t}\n\n\t\t\t\tfunction encodeDate(source) {\n\t\t\t\t\treturn '\"' + source.getFullYear() + \"-\" + pad(source.getMonth() + 1) + \"-\" + pad(source.getDate()) + \"T\" + pad(source.getHours()) + \":\" + pad(source.getMinutes()) + \":\" + pad(source.getSeconds()) + '\"';\n\t\t\t\t}\n\n\t\t\t\treturn function(value) {\n\t\t\t\t\tswitch (typeof value) {\n\t\t\t\t\t\tcase 'undefined':\n\t\t\t\t\t\t\treturn 'undefined';\n\n\t\t\t\t\t\tcase 'number':\n\t\t\t\t\t\t\treturn isFinite(value) ? String(value) : \"null\";\n\n\t\t\t\t\t\tcase 'string':\n\t\t\t\t\t\t\treturn encodeString(value);\n\n\t\t\t\t\t\tcase 'boolean':\n\t\t\t\t\t\t\treturn String(value);\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\t\t\treturn 'null';\n\t\t\t\t\t\t\t} else if (utils.isArray(value)) {\n\t\t\t\t\t\t\t\treturn encodeArray(value);\n\t\t\t\t\t\t\t} else if (utils.isDate(value)) {\n\t\t\t\t\t\t\t\treturn encodeDate(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar result = ['{'],\n\t\t\t\t\t\t\t\t\tencode = utils.json2str,\n\t\t\t\t\t\t\t\t\tpreComma,\n\t\t\t\t\t\t\t\t\titem;\n\n\t\t\t\t\t\t\t\tfor (var key in value) {\n\t\t\t\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(value, key)) {\n\t\t\t\t\t\t\t\t\t\titem = value[key];\n\t\t\t\t\t\t\t\t\t\tswitch (typeof item) {\n\t\t\t\t\t\t\t\t\t\t\tcase 'undefined':\n\t\t\t\t\t\t\t\t\t\t\tcase 'unknown':\n\t\t\t\t\t\t\t\t\t\t\tcase 'function':\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\tif (preComma) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tresult.push(',');\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tpreComma = 1;\n\t\t\t\t\t\t\t\t\t\t\t\tresult.push(encode(key) + ':' + encode(item));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresult.push('}');\n\t\t\t\t\t\t\t\treturn result.join('');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t})()\n\n\t};\n\t/**\n\t * 判断给定的对象是否是字符串\n\t * @method isString\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是字符串\n\t */\n\n\t/**\n\t * 判断给定的对象是否是数组\n\t * @method isArray\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是数组\n\t */\n\n\t/**\n\t * 判断给定的对象是否是一个Function\n\t * @method isFunction\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是Function\n\t */\n\n\t/**\n\t * 判断给定的对象是否是Number\n\t * @method isNumber\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是Number\n\t */\n\n\t/**\n\t * 判断给定的对象是否是一个正则表达式\n\t * @method isRegExp\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是正则表达式\n\t */\n\n\t/**\n\t * 判断给定的对象是否是一个普通对象\n\t * @method isObject\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是普通对象\n\t */\n\tutils.each(['String', 'Function', 'Array', 'Number', 'RegExp', 'Object', 'Date'], function(v) {\n\t\tUE.utils['is' + v] = function(obj) {\n\t\t\treturn Object.prototype.toString.apply(obj) == '[object ' + v + ']';\n\t\t}\n\t});\n\n\t// core/EventBase.js\n\t/**\n\t * UE采用的事件基类\n\t * @file\n\t * @module UE\n\t * @class EventBase\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t/**\n\t * UE采用的事件基类，继承此类的对应类将获取addListener,removeListener,fireEvent方法。\n\t * 在UE中，Editor以及所有ui实例都继承了该类，故可以在对应的ui对象以及editor对象上使用上述方法。\n\t * @unfile\n\t * @module UE\n\t * @class EventBase\n\t */\n\n\t/**\n\t * 通过此构造器，子类可以继承EventBase获取事件监听的方法\n\t * @constructor\n\t * @example\n\t * ```javascript\n\t * UE.EventBase.call(editor);\n\t * ```\n\t */\n\tvar EventBase = UE.EventBase = function() {};\n\n\tEventBase.prototype = {\n\n\t\t/**\n\t\t * 注册事件监听器\n\t\t * @method addListener\n\t\t * @param { String } types 监听的事件名称，同时监听多个事件使用空格分隔\n\t\t * @param { Function } fn 监听的事件被触发时，会执行该回调函数\n\t\t * @waining 事件被触发时，监听的函数假如返回的值恒等于true，回调函数的队列中后面的函数将不执行\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.addListener('selectionchange',function(){\n\t\t *      console.log(\"选区已经变化！\");\n\t\t * })\n\t\t * editor.addListener('beforegetcontent aftergetcontent',function(type){\n\t\t *         if(type == 'beforegetcontent'){\n\t\t *             //do something\n\t\t *         }else{\n\t\t *             //do something\n\t\t *         }\n\t\t *         console.log(this.getContent) // this是注册的事件的编辑器实例\n\t\t * })\n\t\t * ```\n\t\t * @see UE.EventBase:fireEvent(String)\n\t\t */\n\t\taddListener: function(types, listener) {\n\t\t\ttypes = utils.trim(types).split(/\\s+/);\n\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\tgetListener(this, ti, true).push(listener);\n\t\t\t}\n\t\t},\n\n\t\ton: function(types, listener) {\n\t\t\treturn this.addListener(types, listener);\n\t\t},\n\t\toff: function(types, listener) {\n\t\t\treturn this.removeListener(types, listener)\n\t\t},\n\t\ttrigger: function() {\n\t\t\treturn this.fireEvent.apply(this, arguments);\n\t\t},\n\t\t/**\n\t\t * 移除事件监听器\n\t\t * @method removeListener\n\t\t * @param { String } types 移除的事件名称，同时移除多个事件使用空格分隔\n\t\t * @param { Function } fn 移除监听事件的函数引用\n\t\t * @example\n\t\t * ```javascript\n\t\t * //changeCallback为方法体\n\t\t * editor.removeListener(\"selectionchange\",changeCallback);\n\t\t * ```\n\t\t */\n\t\tremoveListener: function(types, listener) {\n\t\t\ttypes = utils.trim(types).split(/\\s+/);\n\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\tutils.removeItem(getListener(this, ti) || [], listener);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 触发事件\n\t\t * @method fireEvent\n\t\t * @param { String } types 触发的事件名称，同时触发多个事件使用空格分隔\n\t\t * @remind 该方法会触发addListener\n\t\t * @return { * } 返回触发事件的队列中，最后执行的回调函数的返回值\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.fireEvent(\"selectionchange\");\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 触发事件\n\t\t * @method fireEvent\n\t\t * @param { String } types 触发的事件名称，同时触发多个事件使用空格分隔\n\t\t * @param { *... } options 可选参数，可以传入一个或多个参数，会传给事件触发的回调函数\n\t\t * @return { * } 返回触发事件的队列中，最后执行的回调函数的返回值\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * editor.addListener( \"selectionchange\", function ( type, arg1, arg2 ) {\n\t\t *\n\t\t *     console.log( arg1 + \" \" + arg2 );\n\t\t *\n\t\t * } );\n\t\t *\n\t\t * //触发selectionchange事件， 会执行上面的事件监听器\n\t\t * //output: Hello World\n\t\t * editor.fireEvent(\"selectionchange\", \"Hello\", \"World\");\n\t\t * ```\n\t\t */\n\t\tfireEvent: function() {\n\t\t\tvar types = arguments[0];\n\t\t\ttypes = utils.trim(types).split(' ');\n\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\tvar listeners = getListener(this, ti),\n\t\t\t\t\tr, t, k;\n\t\t\t\tif (listeners) {\n\t\t\t\t\tk = listeners.length;\n\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\tif (!listeners[k]) continue;\n\t\t\t\t\t\tt = listeners[k].apply(this, arguments);\n\t\t\t\t\t\tif (t === true) {\n\t\t\t\t\t\t\treturn t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (t !== undefined) {\n\t\t\t\t\t\t\tr = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t = this['on' + ti.toLowerCase()]) {\n\t\t\t\t\tr = t.apply(this, arguments);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\t};\n\t/**\n\t * 获得对象所拥有监听类型的所有监听器\n\t * @unfile\n\t * @module UE\n\t * @since 1.2.6.1\n\t * @method getListener\n\t * @public\n\t * @param { Object } obj  查询监听器的对象\n\t * @param { String } type 事件类型\n\t * @param { Boolean } force  为true且当前所有type类型的侦听器不存在时，创建一个空监听器数组\n\t * @return { Array } 监听器数组\n\t */\n\tfunction getListener(obj, type, force) {\n\t\tvar allListeners;\n\t\ttype = type.toLowerCase();\n\t\treturn ((allListeners = (obj.__allListeners || force && (obj.__allListeners = {}))) && (allListeners[type] || force && (allListeners[type] = [])));\n\t}\n\n\t// core/dtd.js\n\t///import editor.js\n\t///import core/dom/dom.js\n\t///import core/utils.js\n\t/**\n\t * dtd html语义化的体现类\n\t * @constructor\n\t * @namespace dtd\n\t */\n\tvar dtd = dom.dtd = (function() {\n\t\tfunction _(s) {\n\t\t\tfor (var k in s) {\n\t\t\t\ts[k.toUpperCase()] = s[k];\n\t\t\t}\n\t\t\treturn s;\n\t\t}\n\t\tvar X = utils.extend2;\n\t\tvar A = _({\n\t\t\t\tisindex: 1,\n\t\t\t\tfieldset: 1\n\t\t\t}),\n\t\t\tB = _({\n\t\t\t\tinput: 1,\n\t\t\t\tbutton: 1,\n\t\t\t\tselect: 1,\n\t\t\t\ttextarea: 1,\n\t\t\t\tlabel: 1\n\t\t\t}),\n\t\t\tC = X(_({\n\t\t\t\ta: 1\n\t\t\t}), B),\n\t\t\tD = X({\n\t\t\t\tiframe: 1\n\t\t\t}, C),\n\t\t\tE = _({\n\t\t\t\thr: 1,\n\t\t\t\tul: 1,\n\t\t\t\tmenu: 1,\n\t\t\t\tdiv: 1,\n\t\t\t\tblockquote: 1,\n\t\t\t\tnoscript: 1,\n\t\t\t\ttable: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\taddress: 1,\n\t\t\t\tdir: 1,\n\t\t\t\tpre: 1,\n\t\t\t\th5: 1,\n\t\t\t\tdl: 1,\n\t\t\t\th4: 1,\n\t\t\t\tnoframes: 1,\n\t\t\t\th6: 1,\n\t\t\t\tol: 1,\n\t\t\t\th1: 1,\n\t\t\t\th3: 1,\n\t\t\t\th2: 1\n\t\t\t}),\n\t\t\tF = _({\n\t\t\t\tins: 1,\n\t\t\t\tdel: 1,\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1\n\t\t\t}),\n\t\t\tG = X(_({\n\t\t\t\tb: 1,\n\t\t\t\tacronym: 1,\n\t\t\t\tbdo: 1,\n\t\t\t\t'var': 1,\n\t\t\t\t'#': 1,\n\t\t\t\tabbr: 1,\n\t\t\t\tcode: 1,\n\t\t\t\tbr: 1,\n\t\t\t\ti: 1,\n\t\t\t\tcite: 1,\n\t\t\t\tkbd: 1,\n\t\t\t\tu: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\ts: 1,\n\t\t\t\ttt: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\tq: 1,\n\t\t\t\tsamp: 1,\n\t\t\t\tem: 1,\n\t\t\t\tdfn: 1,\n\t\t\t\tspan: 1\n\t\t\t}), F),\n\t\t\tH = X(_({\n\t\t\t\tsub: 1,\n\t\t\t\timg: 1,\n\t\t\t\tembed: 1,\n\t\t\t\tobject: 1,\n\t\t\t\tsup: 1,\n\t\t\t\tbasefont: 1,\n\t\t\t\tmap: 1,\n\t\t\t\tapplet: 1,\n\t\t\t\tfont: 1,\n\t\t\t\tbig: 1,\n\t\t\t\tsmall: 1\n\t\t\t}), G),\n\t\t\tI = X(_({\n\t\t\t\tp: 1\n\t\t\t}), H),\n\t\t\tJ = X(_({\n\t\t\t\tiframe: 1\n\t\t\t}), H, B),\n\t\t\tK = _({\n\t\t\t\timg: 1,\n\t\t\t\tembed: 1,\n\t\t\t\tnoscript: 1,\n\t\t\t\tbr: 1,\n\t\t\t\tkbd: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\tbutton: 1,\n\t\t\t\tbasefont: 1,\n\t\t\t\th5: 1,\n\t\t\t\th4: 1,\n\t\t\t\tsamp: 1,\n\t\t\t\th6: 1,\n\t\t\t\tol: 1,\n\t\t\t\th1: 1,\n\t\t\t\th3: 1,\n\t\t\t\th2: 1,\n\t\t\t\tform: 1,\n\t\t\t\tfont: 1,\n\t\t\t\t'#': 1,\n\t\t\t\tselect: 1,\n\t\t\t\tmenu: 1,\n\t\t\t\tins: 1,\n\t\t\t\tabbr: 1,\n\t\t\t\tlabel: 1,\n\t\t\t\tcode: 1,\n\t\t\t\ttable: 1,\n\t\t\t\tscript: 1,\n\t\t\t\tcite: 1,\n\t\t\t\tinput: 1,\n\t\t\t\tiframe: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\ttextarea: 1,\n\t\t\t\tnoframes: 1,\n\t\t\t\tbig: 1,\n\t\t\t\tsmall: 1,\n\t\t\t\tspan: 1,\n\t\t\t\thr: 1,\n\t\t\t\tsub: 1,\n\t\t\t\tbdo: 1,\n\t\t\t\t'var': 1,\n\t\t\t\tdiv: 1,\n\t\t\t\tobject: 1,\n\t\t\t\tsup: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\tdir: 1,\n\t\t\t\tmap: 1,\n\t\t\t\tdl: 1,\n\t\t\t\tapplet: 1,\n\t\t\t\tdel: 1,\n\t\t\t\tisindex: 1,\n\t\t\t\tfieldset: 1,\n\t\t\t\tul: 1,\n\t\t\t\tb: 1,\n\t\t\t\tacronym: 1,\n\t\t\t\ta: 1,\n\t\t\t\tblockquote: 1,\n\t\t\t\ti: 1,\n\t\t\t\tu: 1,\n\t\t\t\ts: 1,\n\t\t\t\ttt: 1,\n\t\t\t\taddress: 1,\n\t\t\t\tq: 1,\n\t\t\t\tpre: 1,\n\t\t\t\tp: 1,\n\t\t\t\tem: 1,\n\t\t\t\tdfn: 1\n\t\t\t}),\n\n\t\t\tL = X(_({\n\t\t\t\ta: 0\n\t\t\t}), J), //a不能被切开，所以把他\n\t\t\tM = _({\n\t\t\t\ttr: 1\n\t\t\t}),\n\t\t\tN = _({\n\t\t\t\t'#': 1\n\t\t\t}),\n\t\t\tO = X(_({\n\t\t\t\tparam: 1\n\t\t\t}), K),\n\t\t\tP = X(_({\n\t\t\t\tform: 1\n\t\t\t}), A, D, E, I),\n\t\t\tQ = _({\n\t\t\t\tli: 1,\n\t\t\t\tol: 1,\n\t\t\t\tul: 1\n\t\t\t}),\n\t\t\tR = _({\n\t\t\t\tstyle: 1,\n\t\t\t\tscript: 1\n\t\t\t}),\n\t\t\tS = _({\n\t\t\t\tbase: 1,\n\t\t\t\tlink: 1,\n\t\t\t\tmeta: 1,\n\t\t\t\ttitle: 1\n\t\t\t}),\n\t\t\tT = X(S, R),\n\t\t\tU = _({\n\t\t\t\thead: 1,\n\t\t\t\tbody: 1\n\t\t\t}),\n\t\t\tV = _({\n\t\t\t\thtml: 1\n\t\t\t});\n\n\t\tvar block = _({\n\t\t\t\taddress: 1,\n\t\t\t\tblockquote: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\tdir: 1,\n\t\t\t\tdiv: 1,\n\t\t\t\tdl: 1,\n\t\t\t\tfieldset: 1,\n\t\t\t\tform: 1,\n\t\t\t\th1: 1,\n\t\t\t\th2: 1,\n\t\t\t\th3: 1,\n\t\t\t\th4: 1,\n\t\t\t\th5: 1,\n\t\t\t\th6: 1,\n\t\t\t\thr: 1,\n\t\t\t\tisindex: 1,\n\t\t\t\tmenu: 1,\n\t\t\t\tnoframes: 1,\n\t\t\t\tol: 1,\n\t\t\t\tp: 1,\n\t\t\t\tpre: 1,\n\t\t\t\ttable: 1,\n\t\t\t\tul: 1\n\t\t\t}),\n\n\t\t\tempty = _({\n\t\t\t\tarea: 1,\n\t\t\t\tbase: 1,\n\t\t\t\tbasefont: 1,\n\t\t\t\tbr: 1,\n\t\t\t\tcol: 1,\n\t\t\t\tcommand: 1,\n\t\t\t\tdialog: 1,\n\t\t\t\tembed: 1,\n\t\t\t\thr: 1,\n\t\t\t\timg: 1,\n\t\t\t\tinput: 1,\n\t\t\t\tisindex: 1,\n\t\t\t\tkeygen: 1,\n\t\t\t\tlink: 1,\n\t\t\t\tmeta: 1,\n\t\t\t\tparam: 1,\n\t\t\t\tsource: 1,\n\t\t\t\ttrack: 1,\n\t\t\t\twbr: 1\n\t\t\t});\n\n\t\treturn _({\n\n\t\t\t// $ 表示自定的属性\n\n\t\t\t// body外的元素列表.\n\t\t\t$nonBodyContent: X(V, U, S),\n\n\t\t\t//块结构元素列表\n\t\t\t$block: block,\n\n\t\t\t//内联元素列表\n\t\t\t$inline: L,\n\n\t\t\t$inlineWithA: X(_({\n\t\t\t\ta: 1\n\t\t\t}), L),\n\n\t\t\t$body: X(_({\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1\n\t\t\t}), block),\n\n\t\t\t$cdata: _({\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1\n\t\t\t}),\n\n\t\t\t//自闭和元素\n\t\t\t$empty: empty,\n\n\t\t\t//不是自闭合，但不能让range选中里边\n\t\t\t$nonChild: _({\n\t\t\t\tiframe: 1,\n\t\t\t\ttextarea: 1\n\t\t\t}),\n\t\t\t//列表元素列表\n\t\t\t$listItem: _({\n\t\t\t\tdd: 1,\n\t\t\t\tdt: 1,\n\t\t\t\tli: 1\n\t\t\t}),\n\n\t\t\t//列表根元素列表\n\t\t\t$list: _({\n\t\t\t\tul: 1,\n\t\t\t\tol: 1,\n\t\t\t\tdl: 1\n\t\t\t}),\n\n\t\t\t//不能认为是空的元素\n\t\t\t$isNotEmpty: _({\n\t\t\t\ttable: 1,\n\t\t\t\tul: 1,\n\t\t\t\tol: 1,\n\t\t\t\tdl: 1,\n\t\t\t\tiframe: 1,\n\t\t\t\tarea: 1,\n\t\t\t\tbase: 1,\n\t\t\t\tcol: 1,\n\t\t\t\thr: 1,\n\t\t\t\timg: 1,\n\t\t\t\tembed: 1,\n\t\t\t\tinput: 1,\n\t\t\t\tlink: 1,\n\t\t\t\tmeta: 1,\n\t\t\t\tparam: 1,\n\t\t\t\th1: 1,\n\t\t\t\th2: 1,\n\t\t\t\th3: 1,\n\t\t\t\th4: 1,\n\t\t\t\th5: 1,\n\t\t\t\th6: 1\n\t\t\t}),\n\n\t\t\t//如果没有子节点就可以删除的元素列表，像span,a\n\t\t\t$removeEmpty: _({\n\t\t\t\ta: 1,\n\t\t\t\tabbr: 1,\n\t\t\t\tacronym: 1,\n\t\t\t\taddress: 1,\n\t\t\t\tb: 1,\n\t\t\t\tbdo: 1,\n\t\t\t\tbig: 1,\n\t\t\t\tcite: 1,\n\t\t\t\tcode: 1,\n\t\t\t\tdel: 1,\n\t\t\t\tdfn: 1,\n\t\t\t\tem: 1,\n\t\t\t\tfont: 1,\n\t\t\t\ti: 1,\n\t\t\t\tins: 1,\n\t\t\t\tlabel: 1,\n\t\t\t\tkbd: 1,\n\t\t\t\tq: 1,\n\t\t\t\ts: 1,\n\t\t\t\tsamp: 1,\n\t\t\t\tsmall: 1,\n\t\t\t\tspan: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\tsub: 1,\n\t\t\t\tsup: 1,\n\t\t\t\ttt: 1,\n\t\t\t\tu: 1,\n\t\t\t\t'var': 1\n\t\t\t}),\n\n\t\t\t$removeEmptyBlock: _({\n\t\t\t\t'p': 1,\n\t\t\t\t'div': 1\n\t\t\t}),\n\n\t\t\t//在table元素里的元素列表\n\t\t\t$tableContent: _({\n\t\t\t\tcaption: 1,\n\t\t\t\tcol: 1,\n\t\t\t\tcolgroup: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\ttd: 1,\n\t\t\t\ttfoot: 1,\n\t\t\t\tth: 1,\n\t\t\t\tthead: 1,\n\t\t\t\ttr: 1,\n\t\t\t\ttable: 1\n\t\t\t}),\n\t\t\t//不转换的标签\n\t\t\t$notTransContent: _({\n\t\t\t\tpre: 1,\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1,\n\t\t\t\ttextarea: 1\n\t\t\t}),\n\t\t\thtml: U,\n\t\t\thead: T,\n\t\t\tstyle: N,\n\t\t\tscript: N,\n\t\t\tbody: P,\n\t\t\tbase: {},\n\t\t\tlink: {},\n\t\t\tmeta: {},\n\t\t\ttitle: N,\n\t\t\tcol: {},\n\t\t\ttr: _({\n\t\t\t\ttd: 1,\n\t\t\t\tth: 1\n\t\t\t}),\n\t\t\timg: {},\n\t\t\tembed: {},\n\t\t\tcolgroup: _({\n\t\t\t\tthead: 1,\n\t\t\t\tcol: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\ttr: 1,\n\t\t\t\ttfoot: 1\n\t\t\t}),\n\t\t\tnoscript: P,\n\t\t\ttd: P,\n\t\t\tbr: {},\n\t\t\tth: P,\n\t\t\tcenter: P,\n\t\t\tkbd: L,\n\t\t\tbutton: X(I, E),\n\t\t\tbasefont: {},\n\t\t\th5: L,\n\t\t\th4: L,\n\t\t\tsamp: L,\n\t\t\th6: L,\n\t\t\tol: Q,\n\t\t\th1: L,\n\t\t\th3: L,\n\t\t\toption: N,\n\t\t\th2: L,\n\t\t\tform: X(A, D, E, I),\n\t\t\tselect: _({\n\t\t\t\toptgroup: 1,\n\t\t\t\toption: 1\n\t\t\t}),\n\t\t\tfont: L,\n\t\t\tins: L,\n\t\t\tmenu: Q,\n\t\t\tabbr: L,\n\t\t\tlabel: L,\n\t\t\ttable: _({\n\t\t\t\tthead: 1,\n\t\t\t\tcol: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\ttr: 1,\n\t\t\t\tcolgroup: 1,\n\t\t\t\tcaption: 1,\n\t\t\t\ttfoot: 1\n\t\t\t}),\n\t\t\tcode: L,\n\t\t\ttfoot: M,\n\t\t\tcite: L,\n\t\t\tli: P,\n\t\t\tinput: {},\n\t\t\tiframe: P,\n\t\t\tstrong: L,\n\t\t\ttextarea: N,\n\t\t\tnoframes: P,\n\t\t\tbig: L,\n\t\t\tsmall: L,\n\t\t\t//trace:\n\t\t\tspan: _({\n\t\t\t\t'#': 1,\n\t\t\t\tbr: 1,\n\t\t\t\tb: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\tu: 1,\n\t\t\t\ti: 1,\n\t\t\t\tem: 1,\n\t\t\t\tsub: 1,\n\t\t\t\tsup: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\tspan: 1\n\t\t\t}),\n\t\t\thr: L,\n\t\t\tdt: L,\n\t\t\tsub: L,\n\t\t\toptgroup: _({\n\t\t\t\toption: 1\n\t\t\t}),\n\t\t\tparam: {},\n\t\t\tbdo: L,\n\t\t\t'var': L,\n\t\t\tdiv: P,\n\t\t\tobject: O,\n\t\t\tsup: L,\n\t\t\tdd: P,\n\t\t\tstrike: L,\n\t\t\tarea: {},\n\t\t\tdir: Q,\n\t\t\tmap: X(_({\n\t\t\t\tarea: 1,\n\t\t\t\tform: 1,\n\t\t\t\tp: 1\n\t\t\t}), A, F, E),\n\t\t\tapplet: O,\n\t\t\tdl: _({\n\t\t\t\tdt: 1,\n\t\t\t\tdd: 1\n\t\t\t}),\n\t\t\tdel: L,\n\t\t\tisindex: {},\n\t\t\tfieldset: X(_({\n\t\t\t\tlegend: 1\n\t\t\t}), K),\n\t\t\tthead: M,\n\t\t\tul: Q,\n\t\t\tacronym: L,\n\t\t\tb: L,\n\t\t\ta: X(_({\n\t\t\t\ta: 1\n\t\t\t}), J),\n\t\t\tblockquote: X(_({\n\t\t\t\ttd: 1,\n\t\t\t\ttr: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\tli: 1\n\t\t\t}), P),\n\t\t\tcaption: L,\n\t\t\ti: L,\n\t\t\tu: L,\n\t\t\ttbody: M,\n\t\t\ts: L,\n\t\t\taddress: X(D, I),\n\t\t\ttt: L,\n\t\t\tlegend: L,\n\t\t\tq: L,\n\t\t\tpre: X(G, C),\n\t\t\tp: X(_({\n\t\t\t\t'a': 1\n\t\t\t}), L),\n\t\t\tem: L,\n\t\t\tdfn: L\n\t\t});\n\t})();\n\n\t// core/domUtils.js\n\t/**\n\t * Dom操作工具包\n\t * @file\n\t * @module UE.dom.domUtils\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * Dom操作工具包\n\t * @unfile\n\t * @module UE.dom.domUtils\n\t */\n\tfunction getDomNode(node, start, ltr, startFromChild, fn, guard) {\n\t\tvar tmpNode = startFromChild && node[start],\n\t\t\tparent;\n\t\t!tmpNode && (tmpNode = node[ltr]);\n\t\twhile (!tmpNode && (parent = (parent || node).parentNode)) {\n\t\t\tif (parent.tagName == 'BODY' || guard && !guard(parent)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\ttmpNode = parent[ltr];\n\t\t}\n\t\tif (tmpNode && fn && !fn(tmpNode)) {\n\t\t\treturn getDomNode(tmpNode, start, ltr, false, fn);\n\t\t}\n\t\treturn tmpNode;\n\t}\n\tvar attrFix = ie && browser.version < 9 ? {\n\t\t\ttabindex: \"tabIndex\",\n\t\t\treadonly: \"readOnly\",\n\t\t\t\"for\": \"htmlFor\",\n\t\t\t\"class\": \"className\",\n\t\t\tmaxlength: \"maxLength\",\n\t\t\tcellspacing: \"cellSpacing\",\n\t\t\tcellpadding: \"cellPadding\",\n\t\t\trowspan: \"rowSpan\",\n\t\t\tcolspan: \"colSpan\",\n\t\t\tusemap: \"useMap\",\n\t\t\tframeborder: \"frameBorder\"\n\t\t} : {\n\t\t\ttabindex: \"tabIndex\",\n\t\t\treadonly: \"readOnly\"\n\t\t},\n\t\tstyleBlock = utils.listToMap([\n\t\t\t'-webkit-box', '-moz-box', 'block',\n\t\t\t'list-item', 'table', 'table-row-group',\n\t\t\t'table-header-group', 'table-footer-group',\n\t\t\t'table-row', 'table-column-group', 'table-column',\n\t\t\t'table-cell', 'table-caption'\n\t\t]);\n\tvar domUtils = dom.domUtils = {\n\t\t//节点常量\n\t\tNODE_ELEMENT: 1,\n\t\tNODE_DOCUMENT: 9,\n\t\tNODE_TEXT: 3,\n\t\tNODE_COMMENT: 8,\n\t\tNODE_DOCUMENT_FRAGMENT: 11,\n\n\t\t//位置关系\n\t\tPOSITION_IDENTICAL: 0,\n\t\tPOSITION_DISCONNECTED: 1,\n\t\tPOSITION_FOLLOWING: 2,\n\t\tPOSITION_PRECEDING: 4,\n\t\tPOSITION_IS_CONTAINED: 8,\n\t\tPOSITION_CONTAINS: 16,\n\t\t//ie6使用其他的会有一段空白出现\n\t\tfillChar: ie && browser.version == '6' ? '\\ufeff' : '\\u200B',\n\t\t//-------------------------Node部分--------------------------------\n\t\tkeys: {\n\t\t\t/*Backspace*/\n\t\t\t8: 1,\n\t\t\t/*Delete*/ 46: 1,\n\t\t\t/*Shift*/\n\t\t\t16: 1,\n\t\t\t/*Ctrl*/ 17: 1,\n\t\t\t/*Alt*/ 18: 1,\n\t\t\t37: 1,\n\t\t\t38: 1,\n\t\t\t39: 1,\n\t\t\t40: 1,\n\t\t\t13: 1 /*enter*/\n\t\t},\n\t\t/**\n\t\t * 获取节点A相对于节点B的位置关系\n\t\t * @method getPosition\n\t\t * @param { Node } nodeA 需要查询位置关系的节点A\n\t\t * @param { Node } nodeB 需要查询位置关系的节点B\n\t\t * @return { Number } 节点A与节点B的关系\n\t\t * @example\n\t\t * ```javascript\n\t\t * //output: 20\n\t\t * var position = UE.dom.domUtils.getPosition( document.documentElement, document.body );\n\t\t *\n\t\t * switch ( position ) {\n\t\t *\n\t\t *      //0\n\t\t *      case UE.dom.domUtils.POSITION_IDENTICAL:\n\t\t *          console.log('元素相同');\n\t\t *          break;\n\t\t *      //1\n\t\t *      case UE.dom.domUtils.POSITION_DISCONNECTED:\n\t\t *          console.log('两个节点在不同的文档中');\n\t\t *          break;\n\t\t *      //2\n\t\t *      case UE.dom.domUtils.POSITION_FOLLOWING:\n\t\t *          console.log('节点A在节点B之后');\n\t\t *          break;\n\t\t *      //4\n\t\t *      case UE.dom.domUtils.POSITION_PRECEDING;\n\t\t *          console.log('节点A在节点B之前');\n\t\t *          break;\n\t\t *      //8\n\t\t *      case UE.dom.domUtils.POSITION_IS_CONTAINED:\n\t\t *          console.log('节点A被节点B包含');\n\t\t *          break;\n\t\t *      case 10:\n\t\t *          console.log('节点A被节点B包含且节点A在节点B之后');\n\t\t *          break;\n\t\t *      //16\n\t\t *      case UE.dom.domUtils.POSITION_CONTAINS:\n\t\t *          console.log('节点A包含节点B');\n\t\t *          break;\n\t\t *      case 20:\n\t\t *          console.log('节点A包含节点B且节点A在节点B之前');\n\t\t *          break;\n\t\t *\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tgetPosition: function(nodeA, nodeB) {\n\t\t\t// 如果两个节点是同一个节点\n\t\t\tif (nodeA === nodeB) {\n\t\t\t\t// domUtils.POSITION_IDENTICAL\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tvar node,\n\t\t\t\tparentsA = [nodeA],\n\t\t\t\tparentsB = [nodeB];\n\t\t\tnode = nodeA;\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\t// 如果nodeB是nodeA的祖先节点\n\t\t\t\tif (node === nodeB) {\n\t\t\t\t\t// domUtils.POSITION_IS_CONTAINED + domUtils.POSITION_FOLLOWING\n\t\t\t\t\treturn 10;\n\t\t\t\t}\n\t\t\t\tparentsA.push(node);\n\t\t\t}\n\t\t\tnode = nodeB;\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\t// 如果nodeA是nodeB的祖先节点\n\t\t\t\tif (node === nodeA) {\n\t\t\t\t\t// domUtils.POSITION_CONTAINS + domUtils.POSITION_PRECEDING\n\t\t\t\t\treturn 20;\n\t\t\t\t}\n\t\t\t\tparentsB.push(node);\n\t\t\t}\n\t\t\tparentsA.reverse();\n\t\t\tparentsB.reverse();\n\t\t\tif (parentsA[0] !== parentsB[0]) {\n\t\t\t\t// domUtils.POSITION_DISCONNECTED\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tvar i = -1;\n\t\t\twhile (i++, parentsA[i] === parentsB[i]) {}\n\t\t\tnodeA = parentsA[i];\n\t\t\tnodeB = parentsB[i];\n\t\t\twhile (nodeA = nodeA.nextSibling) {\n\t\t\t\tif (nodeA === nodeB) {\n\t\t\t\t\t// domUtils.POSITION_PRECEDING\n\t\t\t\t\treturn 4\n\t\t\t\t}\n\t\t\t}\n\t\t\t// domUtils.POSITION_FOLLOWING\n\t\t\treturn 2;\n\t\t},\n\n\t\t/**\n\t\t * 检测节点node在父节点中的索引位置\n\t\t * @method getNodeIndex\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Number } 该节点在父节点中的位置\n\t\t * @see UE.dom.domUtils.getNodeIndex(Node,Boolean)\n\t\t */\n\n\t\t/**\n\t\t * 检测节点node在父节点中的索引位置， 根据给定的mergeTextNode参数决定是否要合并多个连续的文本节点为一个节点\n\t\t * @method getNodeIndex\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @param { Boolean } mergeTextNode 是否合并多个连续的文本节点为一个节点\n\t\t * @return { Number } 该节点在父节点中的位置\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t *      var node = document.createElement(\"div\");\n\t\t *\n\t\t *      node.appendChild( document.createTextNode( \"hello\" ) );\n\t\t *      node.appendChild( document.createTextNode( \"world\" ) );\n\t\t *      node.appendChild( node = document.createElement( \"div\" ) );\n\t\t *\n\t\t *      //output: 2\n\t\t *      console.log( UE.dom.domUtils.getNodeIndex( node ) );\n\t\t *\n\t\t *      //output: 1\n\t\t *      console.log( UE.dom.domUtils.getNodeIndex( node, true ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tgetNodeIndex: function(node, ignoreTextNode) {\n\t\t\tvar preNode = node,\n\t\t\t\ti = 0;\n\t\t\twhile (preNode = preNode.previousSibling) {\n\t\t\t\tif (ignoreTextNode && preNode.nodeType == 3) {\n\t\t\t\t\tif (preNode.nodeType != preNode.nextSibling.nodeType) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn i;\n\t\t},\n\n\t\t/**\n\t\t * 检测节点node是否在给定的document对象上\n\t\t * @method inDoc\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @param { DomDocument } doc 需要检测的document对象\n\t\t * @return { Boolean } 该节点node是否在给定的document的dom树上\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var node = document.createElement(\"div\");\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.do.domUtils.inDoc( node, document ) );\n\t\t *\n\t\t * document.body.appendChild( node );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.do.domUtils.inDoc( node, document ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tinDoc: function(node, doc) {\n\t\t\treturn domUtils.getPosition(node, doc) == 10;\n\t\t},\n\t\t/**\n\t\t * 根据给定的过滤规则filterFn， 查找符合该过滤规则的node节点的第一个祖先节点，\n\t\t * 查找的起点是给定node节点的父节点。\n\t\t * @method findParent\n\t\t * @param { Node } node 需要查找的节点\n\t\t * @param { Function } filterFn 自定义的过滤方法。\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @remind 自定义的过滤方法filterFn接受一个Node对象作为参数， 该对象代表当前执行检测的祖先节点。 如果该\n\t\t *          节点满足过滤条件， 则要求返回true， 这时将直接返回该节点作为findParent()的结果， 否则， 请返回false。\n\t\t * @return { Node | Null } 如果找到符合过滤条件的节点， 就返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var filterNode = UE.dom.domUtils.findParent( document.body.firstChild, function ( node ) {\n\t\t *\n\t\t *     //由于查找的终点是body节点， 所以永远也不会匹配当前过滤器的条件， 即这里永远会返回false\n\t\t *     return node.tagName === \"HTML\";\n\t\t *\n\t\t * } );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( filterNode === null );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 根据给定的过滤规则filterFn， 查找符合该过滤规则的node节点的第一个祖先节点，\n\t\t * 如果includeSelf的值为true，则查找的起点是给定的节点node， 否则， 起点是node的父节点\n\t\t * @method findParent\n\t\t * @param { Node } node 需要查找的节点\n\t\t * @param { Function } filterFn 自定义的过滤方法。\n\t\t * @param { Boolean } includeSelf 查找过程是否包含自身\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @remind 自定义的过滤方法filterFn接受一个Node对象作为参数， 该对象代表当前执行检测的祖先节点。 如果该\n\t\t *          节点满足过滤条件， 则要求返回true， 这时将直接返回该节点作为findParent()的结果， 否则， 请返回false。\n\t\t * @remind 如果includeSelf为true， 则过滤器第一次执行时的参数会是节点本身。\n\t\t *          反之， 过滤器第一次执行时的参数将是该节点的父节点。\n\t\t * @return { Node | Null } 如果找到符合过滤条件的节点， 就返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```html\n\t\t * <body>\n\t\t *\n\t\t *      <div id=\"test\">\n\t\t *      </div>\n\t\t *\n\t\t *      <script type=\"text/javascript\">\n\t\t *\n\t\t *          //output: DIV, BODY\n\t\t *          var filterNode = UE.dom.domUtils.findParent( document.getElementById( \"test\" ), function ( node ) {\n\t\t *\n\t\t *              console.log( node.tagName );\n\t\t *              return false;\n\t\t *\n\t\t *          }, true );\n\t\t *\n\t\t *      </script>\n\t\t * </body>\n\t\t * ```\n\t\t */\n\t\tfindParent: function(node, filterFn, includeSelf) {\n\t\t\tif (node && !domUtils.isBody(node)) {\n\t\t\t\tnode = includeSelf ? node : node.parentNode;\n\t\t\t\twhile (node) {\n\t\t\t\t\tif (!filterFn || filterFn(node) || domUtils.isBody(node)) {\n\t\t\t\t\t\treturn filterFn && !filterFn(node) && domUtils.isBody(node) ? null : node;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\t/**\n\t\t * 查找node的节点名为tagName的第一个祖先节点， 查找的起点是node节点的父节点。\n\t\t * @method findParentByTagName\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @param { Array } tagNames 需要查找的父节点的名称数组\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @return { Node | NULL } 如果找到符合条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var node = UE.dom.domUtils.findParentByTagName( document.getElementsByTagName(\"div\")[0], [ \"BODY\" ] );\n\t\t * //output: BODY\n\t\t * console.log( node.tagName );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查找node的节点名为tagName的祖先节点， 如果includeSelf的值为true，则查找的起点是给定的节点node，\n\t\t * 否则， 起点是node的父节点。\n\t\t * @method findParentByTagName\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @param { Array } tagNames 需要查找的父节点的名称数组\n\t\t * @param { Boolean } includeSelf 查找过程是否包含node节点自身\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @return { Node | NULL } 如果找到符合条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var queryTarget = document.getElementsByTagName(\"div\")[0];\n\t\t * var node = UE.dom.domUtils.findParentByTagName( queryTarget, [ \"DIV\" ], true );\n\t\t * //output: true\n\t\t * console.log( queryTarget === node );\n\t\t * ```\n\t\t */\n\t\tfindParentByTagName: function(node, tagNames, includeSelf, excludeFn) {\n\t\t\ttagNames = utils.listToMap(utils.isArray(tagNames) ? tagNames : [tagNames]);\n\t\t\treturn domUtils.findParent(node, function(node) {\n\t\t\t\treturn tagNames[node.tagName] && !(excludeFn && excludeFn(node));\n\t\t\t}, includeSelf);\n\t\t},\n\t\t/**\n\t\t * 查找节点node的祖先节点集合， 查找的起点是给定节点的父节点，结果集中不包含给定的节点。\n\t\t * @method findParents\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @return { Array } 给定节点的祖先节点数组\n\t\t * @grammar UE.dom.domUtils.findParents(node)  => Array  //返回一个祖先节点数组集合，不包含自身\n\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf)  => Array  //返回一个祖先节点数组集合，includeSelf指定是否包含自身\n\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf,filterFn)  => Array  //返回一个祖先节点数组集合，filterFn指定过滤条件，返回true的node将被选取\n\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf,filterFn,closerFirst)  => Array  //返回一个祖先节点数组集合，closerFirst为true的话，node的直接父亲节点是数组的第0个\n\t\t */\n\n\t\t/**\n\t\t * 查找节点node的祖先节点集合， 如果includeSelf的值为true，\n\t\t * 则返回的结果集中允许出现当前给定的节点， 否则， 该节点不会出现在其结果集中。\n\t\t * @method findParents\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @param { Boolean } includeSelf 查找的结果中是否允许包含当前查找的节点对象\n\t\t * @return { Array } 给定节点的祖先节点数组\n\t\t */\n\t\tfindParents: function(node, includeSelf, filterFn, closerFirst) {\n\t\t\tvar parents = includeSelf && (filterFn && filterFn(node) || !filterFn) ? [node] : [];\n\t\t\twhile (node = domUtils.findParent(node, filterFn)) {\n\t\t\t\tparents.push(node);\n\t\t\t}\n\t\t\treturn closerFirst ? parents : parents.reverse();\n\t\t},\n\n\t\t/**\n\t\t * 在节点node后面插入新节点newNode\n\t\t * @method insertAfter\n\t\t * @param { Node } node 目标节点\n\t\t * @param { Node } newNode 新插入的节点， 该节点将置于目标节点之后\n\t\t * @return { Node } 新插入的节点\n\t\t */\n\t\tinsertAfter: function(node, newNode) {\n\t\t\treturn node.nextSibling ? node.parentNode.insertBefore(newNode, node.nextSibling) :\n\t\t\t\tnode.parentNode.appendChild(newNode);\n\t\t},\n\n\t\t/**\n\t\t * 删除节点node及其下属的所有节点\n\t\t * @method remove\n\t\t * @param { Node } node 需要删除的节点对象\n\t\t * @return { Node } 返回刚删除的节点对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *     <div id=\"child\">你好</div>\n\t\t * </div>\n\t\t * <script>\n\t\t *     UE.dom.domUtils.remove( document.body, false );\n\t\t *     //output: false\n\t\t *     console.log( document.getElementById( \"child\" ) !== null );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 删除节点node，并根据keepChildren的值决定是否保留子节点\n\t\t * @method remove\n\t\t * @param { Node } node 需要删除的节点对象\n\t\t * @param { Boolean } keepChildren 是否需要保留子节点\n\t\t * @return { Node } 返回刚删除的节点对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *     <div id=\"child\">你好</div>\n\t\t * </div>\n\t\t * <script>\n\t\t *     UE.dom.domUtils.remove( document.body, true );\n\t\t *     //output: true\n\t\t *     console.log( document.getElementById( \"child\" ) !== null );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremove: function(node, keepChildren) {\n\t\t\tvar parent = node.parentNode,\n\t\t\t\tchild;\n\t\t\tif (parent) {\n\t\t\t\tif (keepChildren && node.hasChildNodes()) {\n\t\t\t\t\twhile (child = node.firstChild) {\n\t\t\t\t\t\tparent.insertBefore(child, node);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent.removeChild(node);\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\t/**\n\t\t * 取得node节点的下一个兄弟节点， 如果该节点其后没有兄弟节点， 则递归查找其父节点之后的第一个兄弟节点，\n\t\t * 直到找到满足条件的节点或者递归到BODY节点之后才会结束。\n\t\t * @method getNextDomNode\n\t\t * @param { Node } node 需要获取其后的兄弟节点的节点对象\n\t\t * @return { Node | NULL } 如果找满足条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```html\n\t\t *     <body>\n\t\t *      <div id=\"test\">\n\t\t *          <span></span>\n\t\t *      </div>\n\t\t *      <i>xxx</i>\n\t\t * </body>\n\t\t * <script>\n\t\t *\n\t\t *     //output: i节点\n\t\t *     console.log( UE.dom.domUtils.getNextDomNode( document.getElementById( \"test\" ) ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t * @example\n\t\t * ```html\n\t\t * <body>\n\t\t *      <div>\n\t\t *          <span></span>\n\t\t *          <i id=\"test\">xxx</i>\n\t\t *      </div>\n\t\t *      <b>xxx</b>\n\t\t * </body>\n\t\t * <script>\n\t\t *\n\t\t *     //由于id为test的i节点之后没有兄弟节点， 则查找其父节点（div）后面的兄弟节点\n\t\t *     //output: b节点\n\t\t *     console.log( UE.dom.domUtils.getNextDomNode( document.getElementById( \"test\" ) ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 取得node节点的下一个兄弟节点， 如果startFromChild的值为ture，则先获取其子节点，\n\t\t * 如果有子节点则直接返回第一个子节点；如果没有子节点或者startFromChild的值为false，\n\t\t * 则执行<a href=\"#UE.dom.domUtils.getNextDomNode(Node)\">getNextDomNode(Node node)</a>的查找过程。\n\t\t * @method getNextDomNode\n\t\t * @param { Node } node 需要获取其后的兄弟节点的节点对象\n\t\t * @param { Boolean } startFromChild 查找过程是否从其子节点开始\n\t\t * @return { Node | NULL } 如果找满足条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @see UE.dom.domUtils.getNextDomNode(Node)\n\t\t */\n\t\tgetNextDomNode: function(node, startFromChild, filterFn, guard) {\n\t\t\treturn getDomNode(node, 'firstChild', 'nextSibling', startFromChild, filterFn, guard);\n\t\t},\n\t\tgetPreDomNode: function(node, startFromChild, filterFn, guard) {\n\t\t\treturn getDomNode(node, 'lastChild', 'previousSibling', startFromChild, filterFn, guard);\n\t\t},\n\t\t/**\n\t\t * 检测节点node是否属是UEditor定义的bookmark节点\n\t\t * @method isBookmarkNode\n\t\t * @private\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 是否是bookmark节点\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"_baidu_bookmark_1\"></span>\n\t\t * <script>\n\t\t *      var bookmarkNode = document.getElementById(\"_baidu_bookmark_1\");\n\t\t *      //output: true\n\t\t *      console.log( UE.dom.domUtils.isBookmarkNode( bookmarkNode ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisBookmarkNode: function(node) {\n\t\t\treturn node.nodeType == 1 && node.id && /^_baidu_bookmark_/i.test(node.id);\n\t\t},\n\t\t/**\n\t\t * 获取节点node所属的window对象\n\t\t * @method  getWindow\n\t\t * @param { Node } node 节点对象\n\t\t * @return { Window } 当前节点所属的window对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * //output: true\n\t\t * console.log( UE.dom.domUtils.getWindow( document.body ) === window );\n\t\t * ```\n\t\t */\n\t\tgetWindow: function(node) {\n\t\t\tvar doc = node.ownerDocument || node;\n\t\t\treturn doc.defaultView || doc.parentWindow;\n\t\t},\n\t\t/**\n\t\t * 获取离nodeA与nodeB最近的公共的祖先节点\n\t\t * @method  getCommonAncestor\n\t\t * @param { Node } nodeA 第一个节点\n\t\t * @param { Node } nodeB 第二个节点\n\t\t * @remind 如果给定的两个节点是同一个节点， 将直接返回该节点。\n\t\t * @return { Node | NULL } 如果未找到公共节点， 返回NULL， 否则返回最近的公共祖先节点。\n\t\t * @example\n\t\t * ```javascript\n\t\t * var commonAncestor = UE.dom.domUtils.getCommonAncestor( document.body, document.body.firstChild );\n\t\t * //output: true\n\t\t * console.log( commonAncestor.tagName.toLowerCase() === 'body' );\n\t\t * ```\n\t\t */\n\t\tgetCommonAncestor: function(nodeA, nodeB) {\n\t\t\tif (nodeA === nodeB)\n\t\t\t\treturn nodeA;\n\t\t\tvar parentsA = [nodeA],\n\t\t\t\tparentsB = [nodeB],\n\t\t\t\tparent = nodeA,\n\t\t\t\ti = -1;\n\t\t\twhile (parent = parent.parentNode) {\n\t\t\t\tif (parent === nodeB) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparentsA.push(parent);\n\t\t\t}\n\t\t\tparent = nodeB;\n\t\t\twhile (parent = parent.parentNode) {\n\t\t\t\tif (parent === nodeA)\n\t\t\t\t\treturn parent;\n\t\t\t\tparentsB.push(parent);\n\t\t\t}\n\t\t\tparentsA.reverse();\n\t\t\tparentsB.reverse();\n\t\t\twhile (i++, parentsA[i] === parentsB[i]) {}\n\t\t\treturn i == 0 ? null : parentsA[i - 1];\n\n\t\t},\n\t\t/**\n\t\t * 清除node节点左右连续为空的兄弟inline节点\n\t\t * @method clearEmptySibling\n\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t * 则这些兄弟节点将被删除\n\t\t * @grammar UE.dom.domUtils.clearEmptySibling(node,ignoreNext)  //ignoreNext指定是否忽略右边空节点\n\t\t * @grammar UE.dom.domUtils.clearEmptySibling(node,ignoreNext,ignorePre)  //ignorePre指定是否忽略左边空节点\n\t\t * @example\n\t\t * ```html\n\t\t * <body>\n\t\t *     <div></div>\n\t\t *     <span id=\"test\"></span>\n\t\t *     <i></i>\n\t\t *     <b></b>\n\t\t *     <em>xxx</em>\n\t\t *     <span></span>\n\t\t * </body>\n\t\t * <script>\n\t\t *\n\t\t *      UE.dom.domUtils.clearEmptySibling( document.getElementById( \"test\" ) );\n\t\t *\n\t\t *      //output: <div></div><span id=\"test\"></span><em>xxx</em><span></span>\n\t\t *      console.log( document.body.innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 清除node节点左右连续为空的兄弟inline节点， 如果ignoreNext的值为true，\n\t\t * 则忽略对右边兄弟节点的操作。\n\t\t * @method clearEmptySibling\n\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t * @param { Boolean } ignoreNext 是否忽略忽略对右边的兄弟节点的操作\n\t\t * 则这些兄弟节点将被删除\n\t\t * @see UE.dom.domUtils.clearEmptySibling(Node)\n\t\t */\n\n\t\t/**\n\t\t * 清除node节点左右连续为空的兄弟inline节点， 如果ignoreNext的值为true，\n\t\t * 则忽略对右边兄弟节点的操作， 如果ignorePre的值为true，则忽略对左边兄弟节点的操作。\n\t\t * @method clearEmptySibling\n\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t * @param { Boolean } ignoreNext 是否忽略忽略对右边的兄弟节点的操作\n\t\t * @param { Boolean } ignorePre 是否忽略忽略对左边的兄弟节点的操作\n\t\t * 则这些兄弟节点将被删除\n\t\t * @see UE.dom.domUtils.clearEmptySibling(Node)\n\t\t */\n\t\tclearEmptySibling: function(node, ignoreNext, ignorePre) {\n\t\t\tfunction clear(next, dir) {\n\t\t\t\tvar tmpNode;\n\t\t\t\twhile (next && !domUtils.isBookmarkNode(next) && (domUtils.isEmptyInlineElement(next)\n\t\t\t\t\t\t//这里不能把空格算进来会吧空格干掉，出现文字间的空格丢掉了\n\t\t\t\t\t\t|| !new RegExp('[^\\t\\n\\r' + domUtils.fillChar + ']').test(next.nodeValue))) {\n\t\t\t\t\ttmpNode = next[dir];\n\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\tnext = tmpNode;\n\t\t\t\t}\n\t\t\t}!ignoreNext && clear(node.nextSibling, 'nextSibling');\n\t\t\t!ignorePre && clear(node.previousSibling, 'previousSibling');\n\t\t},\n\t\t/**\n\t\t * 将一个文本节点textNode拆分成两个文本节点，offset指定拆分位置\n\t\t * @method split\n\t\t * @param { Node } textNode 需要拆分的文本节点对象\n\t\t * @param { int } offset 需要拆分的位置， 位置计算从0开始\n\t\t * @return { Node } 拆分后形成的新节点\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">abcdef</div>\n\t\t * <script>\n\t\t *      var newNode = UE.dom.domUtils.split( document.getElementById( \"test\" ).firstChild, 3 );\n\t\t *      //output: def\n\t\t *      console.log( newNode.nodeValue );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsplit: function(node, offset) {\n\t\t\tvar doc = node.ownerDocument;\n\t\t\tif (browser.ie && offset == node.nodeValue.length) {\n\t\t\t\tvar next = doc.createTextNode('');\n\t\t\t\treturn domUtils.insertAfter(node, next);\n\t\t\t}\n\t\t\tvar retval = node.splitText(offset);\n\t\t\t//ie8下splitText不会跟新childNodes,我们手动触发他的更新\n\t\t\tif (browser.ie8) {\n\t\t\t\tvar tmpNode = doc.createTextNode('');\n\t\t\t\tdomUtils.insertAfter(retval, tmpNode);\n\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t}\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * 检测文本节点textNode是否为空节点（包括空格、换行、占位符等字符）\n\t\t * @method  isWhitespace\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 检测的节点是否为空\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *\n\t\t * </div>\n\t\t * <script>\n\t\t *      //output: true\n\t\t *      console.log( UE.dom.domUtils.isWhitespace( document.getElementById(\"test\").firstChild ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisWhitespace: function(node) {\n\t\t\treturn !new RegExp('[^ \\t\\n\\r' + domUtils.fillChar + ']').test(node.nodeValue);\n\t\t},\n\t\t/**\n\t\t * 获取元素element相对于viewport的位置坐标\n\t\t * @method getXY\n\t\t * @param { Node } element 需要计算位置的节点对象\n\t\t * @return { Object } 返回形如{x:left,y:top}的一个key-value映射对象， 其中键x代表水平偏移距离，\n\t\t *                          y代表垂直偏移距离。\n\t\t *\n\t\t * @example\n\t\t * ```javascript\n\t\t * var location = UE.dom.domUtils.getXY( document.getElementById(\"test\") );\n\t\t * //output: test的坐标为: 12, 24\n\t\t * console.log( 'test的坐标为： ', location.x, ',', location.y );\n\t\t * ```\n\t\t */\n\t\tgetXY: function(element) {\n\t\t\tvar x = 0,\n\t\t\t\ty = 0;\n\t\t\twhile (element.offsetParent) {\n\t\t\t\ty += element.offsetTop;\n\t\t\t\tx += element.offsetLeft;\n\t\t\t\telement = element.offsetParent;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t'x': x,\n\t\t\t\t'y': y\n\t\t\t};\n\t\t},\n\t\t/**\n\t\t * 为元素element绑定原生DOM事件，type为事件类型，handler为处理函数\n\t\t * @method on\n\t\t * @param { Node } element 需要绑定事件的节点对象\n\t\t * @param { String } type 绑定的事件类型\n\t\t * @param { Function } handler 事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.on(document.body,\"click\",function(e){\n\t\t *     //e为事件对象，this为被点击元素对戏那个\n\t\t * });\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 为元素element绑定原生DOM事件，type为事件类型，handler为处理函数\n\t\t * @method on\n\t\t * @param { Node } element 需要绑定事件的节点对象\n\t\t * @param { Array } type 绑定的事件类型数组\n\t\t * @param { Function } handler 事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.on(document.body,[\"click\",\"mousedown\"],function(evt){\n\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t * });\n\t\t * ```\n\t\t */\n\t\ton: function(element, type, handler) {\n\n\t\t\tvar types = utils.isArray(type) ? type : utils.trim(type).split(/\\s+/),\n\t\t\t\tk = types.length;\n\t\t\tif (k)\n\t\t\t\twhile (k--) {\n\t\t\t\t\ttype = types[k];\n\t\t\t\t\tif (element.addEventListener) {\n\t\t\t\t\t\telement.addEventListener(type, handler, false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!handler._d) {\n\t\t\t\t\t\t\thandler._d = {\n\t\t\t\t\t\t\t\tels: []\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar key = type + handler.toString(),\n\t\t\t\t\t\t\tindex = utils.indexOf(handler._d.els, element);\n\t\t\t\t\t\tif (!handler._d[key] || index == -1) {\n\t\t\t\t\t\t\tif (index == -1) {\n\t\t\t\t\t\t\t\thandler._d.els.push(element);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!handler._d[key]) {\n\t\t\t\t\t\t\t\thandler._d[key] = function(evt) {\n\t\t\t\t\t\t\t\t\treturn handler.call(evt.srcElement, evt || window.event);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\telement.attachEvent('on' + type, handler._d[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\telement = null;\n\t\t},\n\t\t/**\n\t\t * 解除DOM事件绑定\n\t\t * @method un\n\t\t * @param { Node } element 需要解除事件绑定的节点对象\n\t\t * @param { String } type 需要接触绑定的事件类型\n\t\t * @param { Function } handler 对应的事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.un(document.body,\"click\",function(evt){\n\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t * });\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 解除DOM事件绑定\n\t\t * @method un\n\t\t * @param { Node } element 需要解除事件绑定的节点对象\n\t\t * @param { Array } type 需要接触绑定的事件类型数组\n\t\t * @param { Function } handler 对应的事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.un(document.body, [\"click\",\"mousedown\"],function(evt){\n\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t * });\n\t\t * ```\n\t\t */\n\t\tun: function(element, type, handler) {\n\t\t\tvar types = utils.isArray(type) ? type : utils.trim(type).split(/\\s+/),\n\t\t\t\tk = types.length;\n\t\t\tif (k)\n\t\t\t\twhile (k--) {\n\t\t\t\t\ttype = types[k];\n\t\t\t\t\tif (element.removeEventListener) {\n\t\t\t\t\t\telement.removeEventListener(type, handler, false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar key = type + handler.toString();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\telement.detachEvent('on' + type, handler._d ? handler._d[key] : handler);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\tif (handler._d && handler._d[key]) {\n\t\t\t\t\t\t\tvar index = utils.indexOf(handler._d.els, element);\n\t\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\t\thandler._d.els.splice(index, 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thandler._d.els.length == 0 && delete handler._d[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 比较节点nodeA与节点nodeB是否具有相同的标签名、属性名以及属性值\n\t\t * @method  isSameElement\n\t\t * @param { Node } nodeA 需要比较的节点\n\t\t * @param { Node } nodeB 需要比较的节点\n\t\t * @return { Boolean } 两个节点是否具有相同的标签名、属性名以及属性值\n\t\t * @example\n\t\t * ```html\n\t\t * <span style=\"font-size:12px\">ssss</span>\n\t\t * <span style=\"font-size:12px\">bbbbb</span>\n\t\t * <span style=\"font-size:13px\">ssss</span>\n\t\t * <span style=\"font-size:14px\">bbbbb</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var nodes = document.getElementsByTagName( \"span\" );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isSameElement( nodes[0], nodes[1] ) );\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.isSameElement( nodes[2], nodes[3] ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisSameElement: function(nodeA, nodeB) {\n\t\t\tif (nodeA.tagName != nodeB.tagName) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar thisAttrs = nodeA.attributes,\n\t\t\t\totherAttrs = nodeB.attributes;\n\t\t\tif (!ie && thisAttrs.length != otherAttrs.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar attrA, attrB, al = 0,\n\t\t\t\tbl = 0;\n\t\t\tfor (var i = 0; attrA = thisAttrs[i++];) {\n\t\t\t\tif (attrA.nodeName == 'style') {\n\t\t\t\t\tif (attrA.specified) {\n\t\t\t\t\t\tal++;\n\t\t\t\t\t}\n\t\t\t\t\tif (domUtils.isSameStyle(nodeA, nodeB)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ie) {\n\t\t\t\t\tif (attrA.specified) {\n\t\t\t\t\t\tal++;\n\t\t\t\t\t\tattrB = otherAttrs.getNamedItem(attrA.nodeName);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tattrB = nodeB.attributes[attrA.nodeName];\n\t\t\t\t}\n\t\t\t\tif (!attrB.specified || attrA.nodeValue != attrB.nodeValue) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// 有可能attrB的属性包含了attrA的属性之外还有自己的属性\n\t\t\tif (ie) {\n\t\t\t\tfor (i = 0; attrB = otherAttrs[i++];) {\n\t\t\t\t\tif (attrB.specified) {\n\t\t\t\t\t\tbl++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (al != bl) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * 判断节点nodeA与节点nodeB的元素的style属性是否一致\n\t\t * @method isSameStyle\n\t\t * @param { Node } nodeA 需要比较的节点\n\t\t * @param { Node } nodeB 需要比较的节点\n\t\t * @return { Boolean } 两个节点是否具有相同的style属性值\n\t\t * @example\n\t\t * ```html\n\t\t * <span style=\"font-size:12px\">ssss</span>\n\t\t * <span style=\"font-size:12px\">bbbbb</span>\n\t\t * <span style=\"font-size:13px\">ssss</span>\n\t\t * <span style=\"font-size:14px\">bbbbb</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var nodes = document.getElementsByTagName( \"span\" );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isSameStyle( nodes[0], nodes[1] ) );\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.isSameStyle( nodes[2], nodes[3] ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisSameStyle: function(nodeA, nodeB) {\n\t\t\tvar styleA = nodeA.style.cssText.replace(/( ?; ?)/g, ';').replace(/( ?: ?)/g, ':'),\n\t\t\t\tstyleB = nodeB.style.cssText.replace(/( ?; ?)/g, ';').replace(/( ?: ?)/g, ':');\n\t\t\tif (browser.opera) {\n\t\t\t\tstyleA = nodeA.style;\n\t\t\t\tstyleB = nodeB.style;\n\t\t\t\tif (styleA.length != styleB.length)\n\t\t\t\t\treturn false;\n\t\t\t\tfor (var p in styleA) {\n\t\t\t\t\tif (/^(\\d+|csstext)$/i.test(p)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (styleA[p] != styleB[p]) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (!styleA || !styleB) {\n\t\t\t\treturn styleA == styleB;\n\t\t\t}\n\t\t\tstyleA = styleA.split(';');\n\t\t\tstyleB = styleB.split(';');\n\t\t\tif (styleA.length != styleB.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (var i = 0, ci; ci = styleA[i++];) {\n\t\t\t\tif (utils.indexOf(styleB, ci) == -1) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\t/**\n\t\t * 检查节点node是否为block元素\n\t\t * @method isBlockElm\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 是否是block元素节点\n\t\t * @warning 该方法的判断规则如下： 如果该元素原本是block元素， 则不论该元素当前的css样式是什么都会返回true；\n\t\t *          否则，检测该元素的css样式， 如果该元素当前是block元素， 则返回true。 其余情况下都返回false。\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test1\" style=\"display: block\"></span>\n\t\t * <span id=\"test2\"></span>\n\t\t * <div id=\"test3\" style=\"display: inline\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test1\") ) );\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test2\") ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test3\") ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisBlockElm: function(node) {\n\t\t\treturn node.nodeType == 1 && (dtd.$block[node.tagName] || styleBlock[domUtils.getComputedStyle(node, 'display')]) && !dtd.$nonChild[node.tagName];\n\t\t},\n\t\t/**\n\t\t * 检测node节点是否为body节点\n\t\t * @method isBody\n\t\t * @param { Element } node 需要检测的dom元素\n\t\t * @return { Boolean } 给定的元素是否是body元素\n\t\t * @example\n\t\t * ```javascript\n\t\t * //output: true\n\t\t * console.log( UE.dom.domUtils.isBody( document.body ) );\n\t\t * ```\n\t\t */\n\t\tisBody: function(node) {\n\t\t\treturn node && node.nodeType == 1 && node.tagName.toLowerCase() == 'body';\n\t\t},\n\t\t/**\n\t\t * 以node节点为分界，将该节点的指定祖先节点parent拆分成两个独立的节点，\n\t\t * 拆分形成的两个节点之间是node节点\n\t\t * @method breakParent\n\t\t * @param { Node } node 作为分界的节点对象\n\t\t * @param { Node } parent 该节点必须是node节点的祖先节点， 且是block节点。\n\t\t * @return { Node } 给定的node分界节点\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t *      var node = document.createElement(\"span\"),\n\t\t *          wrapNode = document.createElement( \"div\" ),\n\t\t *          parent = document.createElement(\"p\");\n\t\t *\n\t\t *      parent.appendChild( node );\n\t\t *      wrapNode.appendChild( parent );\n\t\t *\n\t\t *      //拆分前\n\t\t *      //output: <p><span></span></p>\n\t\t *      console.log( wrapNode.innerHTML );\n\t\t *\n\t\t *\n\t\t *      UE.dom.domUtils.breakParent( node, parent );\n\t\t *      //拆分后\n\t\t *      //output: <p></p><span></span><p></p>\n\t\t *      console.log( wrapNode.innerHTML );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tbreakParent: function(node, parent) {\n\t\t\tvar tmpNode,\n\t\t\t\tparentClone = node,\n\t\t\t\tclone = node,\n\t\t\t\tleftNodes,\n\t\t\t\trightNodes;\n\t\t\tdo {\n\t\t\t\tparentClone = parentClone.parentNode;\n\t\t\t\tif (leftNodes) {\n\t\t\t\t\ttmpNode = parentClone.cloneNode(false);\n\t\t\t\t\ttmpNode.appendChild(leftNodes);\n\t\t\t\t\tleftNodes = tmpNode;\n\t\t\t\t\ttmpNode = parentClone.cloneNode(false);\n\t\t\t\t\ttmpNode.appendChild(rightNodes);\n\t\t\t\t\trightNodes = tmpNode;\n\t\t\t\t} else {\n\t\t\t\t\tleftNodes = parentClone.cloneNode(false);\n\t\t\t\t\trightNodes = leftNodes.cloneNode(false);\n\t\t\t\t}\n\t\t\t\twhile (tmpNode = clone.previousSibling) {\n\t\t\t\t\tleftNodes.insertBefore(tmpNode, leftNodes.firstChild);\n\t\t\t\t}\n\t\t\t\twhile (tmpNode = clone.nextSibling) {\n\t\t\t\t\trightNodes.appendChild(tmpNode);\n\t\t\t\t}\n\t\t\t\tclone = parentClone;\n\t\t\t} while (parent !== parentClone);\n\t\t\ttmpNode = parent.parentNode;\n\t\t\ttmpNode.insertBefore(leftNodes, parent);\n\t\t\ttmpNode.insertBefore(rightNodes, parent);\n\t\t\ttmpNode.insertBefore(node, rightNodes);\n\t\t\tdomUtils.remove(parent);\n\t\t\treturn node;\n\t\t},\n\t\t/**\n\t\t * 检查节点node是否是空inline节点\n\t\t * @method  isEmptyInlineElement\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Number }  如果给定的节点是空的inline节点， 则返回1, 否则返回0。\n\t\t * @example\n\t\t * ```html\n\t\t * <b><i></i></b> => 1\n\t\t * <b><i></i><u></u></b> => 1\n\t\t * <b></b> => 1\n\t\t * <b>xx<i></i></b> => 0\n\t\t * ```\n\t\t */\n\t\tisEmptyInlineElement: function(node) {\n\t\t\tif (node.nodeType != 1 || !dtd.$removeEmpty[node.tagName]) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tnode = node.firstChild;\n\t\t\twhile (node) {\n\t\t\t\t//如果是创建的bookmark就跳过\n\t\t\t\tif (domUtils.isBookmarkNode(node)) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tif (node.nodeType == 1 && !domUtils.isEmptyInlineElement(node) ||\n\t\t\t\t\tnode.nodeType == 3 && !domUtils.isWhitespace(node)\n\t\t\t\t) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tnode = node.nextSibling;\n\t\t\t}\n\t\t\treturn 1;\n\n\t\t},\n\n\t\t/**\n\t\t * 删除node节点下首尾两端的空白文本子节点\n\t\t * @method trimWhiteTextNode\n\t\t * @param { Element } node 需要执行删除操作的元素对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *      var node = document.createElement(\"div\");\n\t\t *\n\t\t *      node.appendChild( document.createTextNode( \"\" ) );\n\t\t *\n\t\t *      node.appendChild( document.createElement(\"div\") );\n\t\t *\n\t\t *      node.appendChild( document.createTextNode( \"\" ) );\n\t\t *\n\t\t *      //3\n\t\t *      console.log( node.childNodes.length );\n\t\t *\n\t\t *      UE.dom.domUtils.trimWhiteTextNode( node );\n\t\t *\n\t\t *      //1\n\t\t *      console.log( node.childNodes.length );\n\t\t * ```\n\t\t */\n\t\ttrimWhiteTextNode: function(node) {\n\t\t\tfunction remove(dir) {\n\t\t\t\tvar child;\n\t\t\t\twhile ((child = node[dir]) && child.nodeType == 3 && domUtils.isWhitespace(child)) {\n\t\t\t\t\tnode.removeChild(child);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove('firstChild');\n\t\t\tremove('lastChild');\n\t\t},\n\n\t\t/**\n\t\t * 合并node节点下相同的子节点\n\t\t * @name mergeChild\n\t\t * @desc\n\t\t * UE.dom.domUtils.mergeChild(node,tagName) //tagName要合并的子节点的标签\n\t\t * @example\n\t\t * <p><span style=\"font-size:12px;\">xx<span style=\"font-size:12px;\">aa</span>xx</span></p>\n\t\t * ==> UE.dom.domUtils.mergeChild(node,'span')\n\t\t * <p><span style=\"font-size:12px;\">xxaaxx</span></p>\n\t\t */\n\t\tmergeChild: function(node, tagName, attrs) {\n\t\t\tvar list = domUtils.getElementsByTagName(node, node.tagName.toLowerCase());\n\t\t\tfor (var i = 0, ci; ci = list[i++];) {\n\t\t\t\tif (!ci.parentNode || domUtils.isBookmarkNode(ci)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//span单独处理\n\t\t\t\tif (ci.tagName.toLowerCase() == 'span') {\n\t\t\t\t\tif (node === ci.parentNode) {\n\t\t\t\t\t\tdomUtils.trimWhiteTextNode(node);\n\t\t\t\t\t\tif (node.childNodes.length == 1) {\n\t\t\t\t\t\t\tnode.style.cssText = ci.style.cssText + \";\" + node.style.cssText;\n\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tci.style.cssText = node.style.cssText + ';' + ci.style.cssText;\n\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\tvar style = attrs.style;\n\t\t\t\t\t\tif (style) {\n\t\t\t\t\t\t\tstyle = style.split(';');\n\t\t\t\t\t\t\tfor (var j = 0, s; s = style[j++];) {\n\t\t\t\t\t\t\t\tci.style[utils.cssStyleToDomStyle(s.split(':')[0])] = s.split(':')[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (domUtils.isSameStyle(ci, node)) {\n\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (domUtils.isSameElement(node, ci)) {\n\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 原生方法getElementsByTagName的封装\n\t\t * @method getElementsByTagName\n\t\t * @param { Node } node 目标节点对象\n\t\t * @param { String } tagName 需要查找的节点的tagName， 多个tagName以空格分割\n\t\t * @return { Array } 符合条件的节点集合\n\t\t */\n\t\tgetElementsByTagName: function(node, name, filter) {\n\t\t\tif (filter && utils.isString(filter)) {\n\t\t\t\tvar className = filter;\n\t\t\t\tfilter = function(node) {\n\t\t\t\t\treturn domUtils.hasClass(node, className)\n\t\t\t\t}\n\t\t\t}\n\t\t\tname = utils.trim(name).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tvar arr = [];\n\t\t\tfor (var n = 0, ni; ni = name[n++];) {\n\t\t\t\tvar list = node.getElementsByTagName(ni);\n\t\t\t\tfor (var i = 0, ci; ci = list[i++];) {\n\t\t\t\t\tif (!filter || filter(ci))\n\t\t\t\t\t\tarr.push(ci);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn arr;\n\t\t},\n\t\t/**\n\t\t * 将节点node提取到父节点上\n\t\t * @method mergeToParent\n\t\t * @param { Element } node 需要提取的元素对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"parent\">\n\t\t *     <div id=\"sub\">\n\t\t *         <span id=\"child\"></span>\n\t\t *     </div>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var child = document.getElementById( \"child\" );\n\t\t *\n\t\t *     //output: sub\n\t\t *     console.log( child.parentNode.id );\n\t\t *\n\t\t *     UE.dom.domUtils.mergeToParent( child );\n\t\t *\n\t\t *     //output: parent\n\t\t *     console.log( child.parentNode.id );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tmergeToParent: function(node) {\n\t\t\tvar parent = node.parentNode;\n\t\t\twhile (parent && dtd.$removeEmpty[parent.tagName]) {\n\t\t\t\tif (parent.tagName == node.tagName || parent.tagName == 'A') { //针对a标签单独处理\n\t\t\t\t\tdomUtils.trimWhiteTextNode(parent);\n\t\t\t\t\t//span需要特殊处理  不处理这样的情况 <span stlye=\"color:#fff\">xxx<span style=\"color:#ccc\">xxx</span>xxx</span>\n\t\t\t\t\tif (parent.tagName == 'SPAN' && !domUtils.isSameStyle(parent, node) || (parent.tagName == 'A' && node.tagName == 'SPAN')) {\n\t\t\t\t\t\tif (parent.childNodes.length > 1 || parent !== node.parentNode) {\n\t\t\t\t\t\t\tnode.style.cssText = parent.style.cssText + \";\" + node.style.cssText;\n\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tparent.style.cssText += \";\" + node.style.cssText;\n\t\t\t\t\t\t\t//trace:952 a标签要保持下划线\n\t\t\t\t\t\t\tif (parent.tagName == 'A') {\n\t\t\t\t\t\t\t\tparent.style.textDecoration = 'underline';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (parent.tagName != 'A') {\n\t\t\t\t\t\tparent === node.parentNode && domUtils.remove(node, true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent = parent.parentNode;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 合并节点node的左右兄弟节点\n\t\t * @method mergeSibling\n\t\t * @param { Element } node 需要合并的目标节点\n\t\t * @example\n\t\t * ```html\n\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t *\n\t\t * <script>\n\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t *     UE.dom.domUtils.mergeSibling( demoNode );\n\t\t *     //output: xxxxoooxxxx\n\t\t *     console.log( demoNode.innerHTML );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 合并节点node的左右兄弟节点， 可以根据给定的条件选择是否忽略合并左节点。\n\t\t * @method mergeSibling\n\t\t * @param { Element } node 需要合并的目标节点\n\t\t * @param { Boolean } ignorePre 是否忽略合并左节点\n\t\t * @example\n\t\t * ```html\n\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t *\n\t\t * <script>\n\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t *     UE.dom.domUtils.mergeSibling( demoNode, true );\n\t\t *     //output: oooxxxx\n\t\t *     console.log( demoNode.innerHTML );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 合并节点node的左右兄弟节点，可以根据给定的条件选择是否忽略合并左右节点。\n\t\t * @method mergeSibling\n\t\t * @param { Element } node 需要合并的目标节点\n\t\t * @param { Boolean } ignorePre 是否忽略合并左节点\n\t\t * @param { Boolean } ignoreNext 是否忽略合并右节点\n\t\t * @remind 如果同时忽略左右节点， 则该操作什么也不会做\n\t\t * @example\n\t\t * ```html\n\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t *\n\t\t * <script>\n\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t *     UE.dom.domUtils.mergeSibling( demoNode, false, true );\n\t\t *     //output: xxxxooo\n\t\t *     console.log( demoNode.innerHTML );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tmergeSibling: function(node, ignorePre, ignoreNext) {\n\t\t\tfunction merge(rtl, start, node) {\n\t\t\t\tvar next;\n\t\t\t\tif ((next = node[rtl]) && !domUtils.isBookmarkNode(next) && next.nodeType == 1 && domUtils.isSameElement(node, next)) {\n\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\tif (start == 'firstChild') {\n\t\t\t\t\t\t\tnode.insertBefore(next.lastChild, node.firstChild);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.appendChild(next.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t}\n\t\t\t}!ignorePre && merge('previousSibling', 'firstChild', node);\n\t\t\t!ignoreNext && merge('nextSibling', 'lastChild', node);\n\t\t},\n\n\t\t/**\n\t\t * 设置节点node及其子节点不会被选中\n\t\t * @method unSelectable\n\t\t * @param { Element } node 需要执行操作的dom元素\n\t\t * @remind 执行该操作后的节点， 将不能被鼠标选中\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.unSelectable( document.body );\n\t\t * ```\n\t\t */\n\t\tunSelectable: ie && browser.ie9below || browser.opera ? function(node) {\n\t\t\t//for ie9\n\t\t\tnode.onselectstart = function() {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tnode.onclick = node.onkeyup = node.onkeydown = function() {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tnode.unselectable = 'on';\n\t\t\tnode.setAttribute(\"unselectable\", \"on\");\n\t\t\tfor (var i = 0, ci; ci = node.all[i++];) {\n\t\t\t\tswitch (ci.tagName.toLowerCase()) {\n\t\t\t\t\tcase 'iframe':\n\t\t\t\t\tcase 'textarea':\n\t\t\t\t\tcase 'input':\n\t\t\t\t\tcase 'select':\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tci.unselectable = 'on';\n\t\t\t\t\t\tnode.setAttribute(\"unselectable\", \"on\");\n\t\t\t\t}\n\t\t\t}\n\t\t} : function(node) {\n\t\t\tnode.style.MozUserSelect =\n\t\t\t\tnode.style.webkitUserSelect =\n\t\t\t\tnode.style.msUserSelect =\n\t\t\t\tnode.style.KhtmlUserSelect = 'none';\n\t\t},\n\t\t/**\n\t\t * 删除节点node上的指定属性名称的属性\n\t\t * @method  removeAttributes\n\t\t * @param { Node } node 需要删除属性的节点对象\n\t\t * @param { String } attrNames 可以是空格隔开的多个属性名称，该操作将会依次删除相应的属性\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"wrap\">\n\t\t *      <span style=\"font-size:14px;\" id=\"test\" name=\"followMe\">xxxxx</span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     UE.dom.domUtils.removeAttributes( document.getElementById( \"test\" ), \"id name\" );\n\t\t *\n\t\t *     //output: <span style=\"font-size:14px;\">xxxxx</span>\n\t\t *     console.log( document.getElementById(\"wrap\").innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 删除节点node上的指定属性名称的属性\n\t\t * @method  removeAttributes\n\t\t * @param { Node } node 需要删除属性的节点对象\n\t\t * @param { Array } attrNames 需要删除的属性名数组\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"wrap\">\n\t\t *      <span style=\"font-size:14px;\" id=\"test\" name=\"followMe\">xxxxx</span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     UE.dom.domUtils.removeAttributes( document.getElementById( \"test\" ), [\"id\", \"name\"] );\n\t\t *\n\t\t *     //output: <span style=\"font-size:14px;\">xxxxx</span>\n\t\t *     console.log( document.getElementById(\"wrap\").innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremoveAttributes: function(node, attrNames) {\n\t\t\tattrNames = utils.isArray(attrNames) ? attrNames : utils.trim(attrNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci; ci = attrNames[i++];) {\n\t\t\t\tci = attrFix[ci] || ci;\n\t\t\t\tswitch (ci) {\n\t\t\t\t\tcase 'className':\n\t\t\t\t\t\tnode[ci] = '';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'style':\n\t\t\t\t\t\tnode.style.cssText = '';\n\t\t\t\t\t\tvar val = node.getAttributeNode('style');\n\t\t\t\t\t\t!browser.ie && val && node.removeAttributeNode(val);\n\t\t\t\t}\n\t\t\t\tnode.removeAttribute(ci);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 在doc下创建一个标签名为tag，属性为attrs的元素\n\t\t * @method createElement\n\t\t * @param { DomDocument } doc 新创建的元素属于该document节点创建\n\t\t * @param { String } tagName 需要创建的元素的标签名\n\t\t * @param { Object } attrs 新创建的元素的属性key-value集合\n\t\t * @return { Element } 新创建的元素对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * var ele = UE.dom.domUtils.createElement( document, 'div', {\n\t\t *     id: 'test'\n\t\t * } );\n\t\t *\n\t\t * //output: DIV\n\t\t * console.log( ele.tagName );\n\t\t *\n\t\t * //output: test\n\t\t * console.log( ele.id );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tcreateElement: function(doc, tag, attrs) {\n\t\t\treturn domUtils.setAttributes(doc.createElement(tag), attrs)\n\t\t},\n\t\t/**\n\t\t * 为节点node添加属性attrs，attrs为属性键值对\n\t\t * @method setAttributes\n\t\t * @param { Element } node 需要设置属性的元素对象\n\t\t * @param { Object } attrs 需要设置的属性名-值对\n\t\t * @return { Element } 设置属性的元素对象\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\"></span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = UE.dom.domUtils.setAttributes( document.getElementById( \"test\" ), {\n\t\t *         id: 'demo'\n\t\t *     } );\n\t\t *\n\t\t *     //output: demo\n\t\t *     console.log( testNode.id );\n\t\t *\n\t\t * </script>\n\t\t *\n\t\t */\n\t\tsetAttributes: function(node, attrs) {\n\t\t\tfor (var attr in attrs) {\n\t\t\t\tif (attrs.hasOwnProperty(attr)) {\n\t\t\t\t\tvar value = attrs[attr];\n\t\t\t\t\tswitch (attr) {\n\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\t//ie下要这样赋值，setAttribute不起作用\n\t\t\t\t\t\t\tnode.className = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\tnode.style.cssText = node.style.cssText + \";\" + value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'innerHTML':\n\t\t\t\t\t\t\tnode[attr] = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'value':\n\t\t\t\t\t\t\tnode.value = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tnode.setAttribute(attrFix[attr] || attr, value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\t/**\n\t\t * 获取元素element经过计算后的样式值\n\t\t * @method getComputedStyle\n\t\t * @param { Element } element 需要获取样式的元素对象\n\t\t * @param { String } styleName 需要获取的样式名\n\t\t * @return { String } 获取到的样式值\n\t\t * @example\n\t\t * ```html\n\t\t * <style type=\"text/css\">\n\t\t *      #test {\n\t\t *          font-size: 15px;\n\t\t *      }\n\t\t * </style>\n\t\t *\n\t\t * <span id=\"test\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     //output: 15px\n\t\t *     console.log( UE.dom.domUtils.getComputedStyle( document.getElementById( \"test\" ), 'font-size' ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tgetComputedStyle: function(element, styleName) {\n\t\t\t//一下的属性单独处理\n\t\t\tvar pros = 'width height top left';\n\n\t\t\tif (pros.indexOf(styleName) > -1) {\n\t\t\t\treturn element['offset' + styleName.replace(/^\\w/, function(s) {\n\t\t\t\t\treturn s.toUpperCase()\n\t\t\t\t})] + 'px';\n\t\t\t}\n\t\t\t//忽略文本节点\n\t\t\tif (element.nodeType == 3) {\n\t\t\t\telement = element.parentNode;\n\t\t\t}\n\t\t\t//ie下font-size若body下定义了font-size，则从currentStyle里会取到这个font-size. 取不到实际值，故此修改.\n\t\t\tif (browser.ie && browser.version < 9 && styleName == 'font-size' && !element.style.fontSize &&\n\t\t\t\t!dtd.$empty[element.tagName] && !dtd.$nonChild[element.tagName]) {\n\t\t\t\tvar span = element.ownerDocument.createElement('span');\n\t\t\t\tspan.style.cssText = 'padding:0;border:0;font-family:simsun;';\n\t\t\t\tspan.innerHTML = '.';\n\t\t\t\telement.appendChild(span);\n\t\t\t\tvar result = span.offsetHeight;\n\t\t\t\telement.removeChild(span);\n\t\t\t\tspan = null;\n\t\t\t\treturn result + 'px';\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar value = domUtils.getStyle(element, styleName) ||\n\t\t\t\t\t(window.getComputedStyle ? domUtils.getWindow(element).getComputedStyle(element, '').getPropertyValue(styleName) :\n\t\t\t\t\t\t(element.currentStyle || element.style)[utils.cssStyleToDomStyle(styleName)]);\n\n\t\t\t} catch (e) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t\treturn utils.transUnitToPx(utils.fixColor(styleName, value));\n\t\t},\n\t\t/**\n\t\t * 删除元素element指定的className\n\t\t * @method removeClasses\n\t\t * @param { Element } ele 需要删除class的元素节点\n\t\t * @param { String } classNames 需要删除的className， 多个className之间以空格分开\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"test1 test2 test3\">xxx</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById( \"test\" );\n\t\t *     UE.dom.domUtils.removeClasses( testNode, \"test1 test2\" );\n\t\t *\n\t\t *     //output: test3\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 删除元素element指定的className\n\t\t * @method removeClasses\n\t\t * @param { Element } ele 需要删除class的元素节点\n\t\t * @param { Array } classNames 需要删除的className数组\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"test1 test2 test3\">xxx</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById( \"test\" );\n\t\t *     UE.dom.domUtils.removeClasses( testNode, [\"test1\", \"test2\"] );\n\t\t *\n\t\t *     //output: test3\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremoveClasses: function(elm, classNames) {\n\t\t\tclassNames = utils.isArray(classNames) ? classNames :\n\t\t\t\tutils.trim(classNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci, cls = elm.className; ci = classNames[i++];) {\n\t\t\t\tcls = cls.replace(new RegExp('\\\\b' + ci + '\\\\b'), '')\n\t\t\t}\n\t\t\tcls = utils.trim(cls).replace(/[ ]{2,}/g, ' ');\n\t\t\tif (cls) {\n\t\t\t\telm.className = cls;\n\t\t\t} else {\n\t\t\t\tdomUtils.removeAttributes(elm, ['class']);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 给元素element添加className\n\t\t * @method addClass\n\t\t * @param { Node } ele 需要增加className的元素\n\t\t * @param { String } classNames 需要添加的className， 多个className之间以空格分割\n\t\t * @remind 相同的类名不会被重复添加\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.addClass( testNode, \"cls2 cls3 cls4\" );\n\t\t *\n\t\t *     //output: cl1 cls2 cls3 cls4\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * <script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 给元素element添加className\n\t\t * @method addClass\n\t\t * @param { Node } ele 需要增加className的元素\n\t\t * @param { Array } classNames 需要添加的className的数组\n\t\t * @remind 相同的类名不会被重复添加\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.addClass( testNode, [\"cls2\", \"cls3\", \"cls4\"] );\n\t\t *\n\t\t *     //output: cl1 cls2 cls3 cls4\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * <script>\n\t\t * ```\n\t\t */\n\t\taddClass: function(elm, classNames) {\n\t\t\tif (!elm) return;\n\t\t\tclassNames = utils.trim(classNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci, cls = elm.className; ci = classNames[i++];) {\n\t\t\t\tif (!new RegExp('\\\\b' + ci + '\\\\b').test(cls)) {\n\t\t\t\t\tcls += ' ' + ci;\n\t\t\t\t}\n\t\t\t}\n\t\t\telm.className = utils.trim(cls);\n\t\t},\n\t\t/**\n\t\t * 判断元素element是否包含给定的样式类名className\n\t\t * @method hasClass\n\t\t * @param { Node } ele 需要检测的元素\n\t\t * @param { String } classNames 需要检测的className， 多个className之间用空格分割\n\t\t * @return { Boolean } 元素是否包含所有给定的className\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test1\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var test1 = document.getElementById(\"test1\");\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, \"cls2 cls1 cls3\" ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, \"cls2 cls1\" ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 判断元素element是否包含给定的样式类名className\n\t\t * @method hasClass\n\t\t * @param { Node } ele 需要检测的元素\n\t\t * @param { Array } classNames 需要检测的className数组\n\t\t * @return { Boolean } 元素是否包含所有给定的className\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test1\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var test1 = document.getElementById(\"test1\");\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, [ \"cls2\", \"cls1\", \"cls3\" ] ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, [ \"cls2\", \"cls1\" ]) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\thasClass: function(element, className) {\n\t\t\tif (utils.isRegExp(className)) {\n\t\t\t\treturn className.test(element.className)\n\t\t\t}\n\t\t\tclassName = utils.trim(className).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci, cls = element.className; ci = className[i++];) {\n\t\t\t\tif (!new RegExp('\\\\b' + ci + '\\\\b', 'i').test(cls)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn i - 1 == className.length;\n\t\t},\n\n\t\t/**\n\t\t * 阻止事件默认行为\n\t\t * @method preventDefault\n\t\t * @param { Event } evt 需要阻止默认行为的事件对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.preventDefault( evt );\n\t\t * ```\n\t\t */\n\t\tpreventDefault: function(evt) {\n\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t},\n\t\t/**\n\t\t * 删除元素element指定的样式\n\t\t * @method removeStyle\n\t\t * @param { Element } element 需要删除样式的元素\n\t\t * @param { String } styleName 需要删除的样式名\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" style=\"color: red; background: blue;\"></span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.removeStyle( testNode, 'color' );\n\t\t *\n\t\t *     //output: background: blue;\n\t\t *     console.log( testNode.style.cssText );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremoveStyle: function(element, name) {\n\t\t\tif (browser.ie) {\n\t\t\t\t//针对color先单独处理一下\n\t\t\t\tif (name == 'color') {\n\t\t\t\t\tname = '(^|;)' + name;\n\t\t\t\t}\n\t\t\t\telement.style.cssText = element.style.cssText.replace(new RegExp(name + '[^:]*:[^;]+;?', 'ig'), '')\n\t\t\t} else {\n\t\t\t\tif (element.style.removeProperty) {\n\t\t\t\t\telement.style.removeProperty(name);\n\t\t\t\t} else {\n\t\t\t\t\telement.style.removeAttribute(utils.cssStyleToDomStyle(name));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!element.style.cssText) {\n\t\t\t\tdomUtils.removeAttributes(element, ['style']);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 获取元素element的style属性的指定值\n\t\t * @method getStyle\n\t\t * @param { Element } element 需要获取属性值的元素\n\t\t * @param { String } styleName 需要获取的style的名称\n\t\t * @warning 该方法仅获取元素style属性中所标明的值\n\t\t * @return { String } 该元素包含指定的style属性值\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\" style=\"color: red;\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t *\n\t\t *      //output: red\n\t\t *      console.log( UE.dom.domUtils.getStyle( testNode, \"color\" ) );\n\t\t *\n\t\t *      //output: \"\"\n\t\t *      console.log( UE.dom.domUtils.getStyle( testNode, \"background\" ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tgetStyle: function(element, name) {\n\t\t\tvar value = element.style[utils.cssStyleToDomStyle(name)];\n\t\t\treturn utils.fixColor(name, value);\n\t\t},\n\t\t/**\n\t\t * 为元素element设置样式属性值\n\t\t * @method setStyle\n\t\t * @param { Element } element 需要设置样式的元素\n\t\t * @param { String } styleName 样式名\n\t\t * @param { String } styleValue 样式值\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t *\n\t\t *      //output: \"\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t *      UE.dom.domUtils.setStyle( testNode, 'color', 'red' );\n\t\t *      //output: \"red\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsetStyle: function(element, name, value) {\n\t\t\telement.style[utils.cssStyleToDomStyle(name)] = value;\n\t\t\tif (!utils.trim(element.style.cssText)) {\n\t\t\t\tthis.removeAttributes(element, 'style')\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 为元素element设置多个样式属性值\n\t\t * @method setStyles\n\t\t * @param { Element } element 需要设置样式的元素\n\t\t * @param { Object } styles 样式名值对\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t *\n\t\t *      //output: \"\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t *      UE.dom.domUtils.setStyles( testNode, {\n\t\t *          'color': 'red'\n\t\t *      } );\n\t\t *      //output: \"red\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsetStyles: function(element, styles) {\n\t\t\tfor (var name in styles) {\n\t\t\t\tif (styles.hasOwnProperty(name)) {\n\t\t\t\t\tdomUtils.setStyle(element, name, styles[name]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 删除_moz_dirty属性\n\t\t * @private\n\t\t * @method removeDirtyAttr\n\t\t */\n\t\tremoveDirtyAttr: function(node) {\n\t\t\tfor (var i = 0, ci, nodes = node.getElementsByTagName('*'); ci = nodes[i++];) {\n\t\t\t\tci.removeAttribute('_moz_dirty');\n\t\t\t}\n\t\t\tnode.removeAttribute('_moz_dirty');\n\t\t},\n\t\t/**\n\t\t * 获取子节点的数量\n\t\t * @method getChildCount\n\t\t * @param { Element } node 需要检测的元素\n\t\t * @return { Number } 给定的node元素的子节点数量\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: 3\n\t\t *     console.log( UE.dom.domUtils.getChildCount( document.getElementById(\"test\") ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 根据给定的过滤规则， 获取符合条件的子节点的数量\n\t\t * @method getChildCount\n\t\t * @param { Element } node 需要检测的元素\n\t\t * @param { Function } fn 过滤器， 要求对符合条件的子节点返回true， 反之则要求返回false\n\t\t * @return { Number } 符合过滤条件的node元素的子节点数量\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: 1\n\t\t *     console.log( UE.dom.domUtils.getChildCount( document.getElementById(\"test\"), function ( node ) {\n\t\t *\n\t\t *         return node.nodeType === 1;\n\t\t *\n\t\t *     } ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tgetChildCount: function(node, fn) {\n\t\t\tvar count = 0,\n\t\t\t\tfirst = node.firstChild;\n\t\t\tfn = fn || function() {\n\t\t\t\treturn 1;\n\t\t\t};\n\t\t\twhile (first) {\n\t\t\t\tif (fn(first)) {\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t\tfirst = first.nextSibling;\n\t\t\t}\n\t\t\treturn count;\n\t\t},\n\n\t\t/**\n\t\t * 判断给定节点是否为空节点\n\t\t * @method isEmptyNode\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 节点是否为空\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.isEmptyNode( document.body );\n\t\t * ```\n\t\t */\n\t\tisEmptyNode: function(node) {\n\t\t\treturn !node.firstChild || domUtils.getChildCount(node, function(node) {\n\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isBookmarkNode(node) && !domUtils.isWhitespace(node)\n\t\t\t}) == 0\n\t\t},\n\t\tclearSelectedArr: function(nodes) {\n\t\t\tvar node;\n\t\t\twhile (node = nodes.pop()) {\n\t\t\t\tdomUtils.removeAttributes(node, ['class']);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 将显示区域滚动到指定节点的位置\n\t\t * @method scrollToView\n\t\t * @param    {Node}   node    节点\n\t\t * @param    {window}   win      window对象\n\t\t * @param    {Number}    offsetTop    距离上方的偏移量\n\t\t */\n\t\tscrollToView: function(node, win, offsetTop) {\n\t\t\tvar getViewPaneSize = function() {\n\t\t\t\t\tvar doc = win.document,\n\t\t\t\t\t\tmode = doc.compatMode == 'CSS1Compat';\n\t\t\t\t\treturn {\n\t\t\t\t\t\twidth: (mode ? doc.documentElement.clientWidth : doc.body.clientWidth) || 0,\n\t\t\t\t\t\theight: (mode ? doc.documentElement.clientHeight : doc.body.clientHeight) || 0\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tgetScrollPosition = function(win) {\n\t\t\t\t\tif ('pageXOffset' in win) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tx: win.pageXOffset || 0,\n\t\t\t\t\t\t\ty: win.pageYOffset || 0\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar doc = win.document;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tx: doc.documentElement.scrollLeft || doc.body.scrollLeft || 0,\n\t\t\t\t\t\t\ty: doc.documentElement.scrollTop || doc.body.scrollTop || 0\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\tvar winHeight = getViewPaneSize().height,\n\t\t\t\toffset = winHeight * -1 + offsetTop;\n\t\t\toffset += (node.offsetHeight || 0);\n\t\t\tvar elementPosition = domUtils.getXY(node);\n\t\t\toffset += elementPosition.y;\n\t\t\tvar currentScroll = getScrollPosition(win).y;\n\t\t\t// offset += 50;\n\t\t\tif (offset > currentScroll || offset < currentScroll - winHeight) {\n\t\t\t\twin.scrollTo(0, offset + (offset < 0 ? -20 : 20));\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 判断给定节点是否为br\n\t\t * @method isBr\n\t\t * @param { Node } node 需要判断的节点对象\n\t\t * @return { Boolean } 给定的节点是否是br节点\n\t\t */\n\t\tisBr: function(node) {\n\t\t\treturn node.nodeType == 1 && node.tagName == 'BR';\n\t\t},\n\t\t/**\n\t\t * 判断给定的节点是否是一个“填充”节点\n\t\t * @private\n\t\t * @method isFillChar\n\t\t * @param { Node } node 需要判断的节点\n\t\t * @param { Boolean } isInStart 是否从节点内容的开始位置匹配\n\t\t * @returns { Boolean } 节点是否是填充节点\n\t\t */\n\t\tisFillChar: function(node, isInStart) {\n\t\t\tif (node.nodeType != 3)\n\t\t\t\treturn false;\n\t\t\tvar text = node.nodeValue;\n\t\t\tif (isInStart) {\n\t\t\t\treturn new RegExp('^' + domUtils.fillChar).test(text)\n\t\t\t}\n\t\t\treturn !text.replace(new RegExp(domUtils.fillChar, 'g'), '').length\n\t\t},\n\t\tisStartInblock: function(range) {\n\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\tflag = 0,\n\t\t\t\tstart = tmpRange.startContainer,\n\t\t\t\ttmp;\n\t\t\tif (start.nodeType == 1 && start.childNodes[tmpRange.startOffset]) {\n\t\t\t\tstart = start.childNodes[tmpRange.startOffset];\n\t\t\t\tvar pre = start.previousSibling;\n\t\t\t\twhile (pre && domUtils.isFillChar(pre)) {\n\t\t\t\t\tstart = pre;\n\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isFillChar(start, true) && tmpRange.startOffset == 1) {\n\t\t\t\ttmpRange.setStartBefore(start);\n\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t}\n\n\t\t\twhile (start && domUtils.isFillChar(start)) {\n\t\t\t\ttmp = start;\n\t\t\t\tstart = start.previousSibling\n\t\t\t}\n\t\t\tif (tmp) {\n\t\t\t\ttmpRange.setStartBefore(tmp);\n\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t}\n\t\t\tif (start.nodeType == 1 && domUtils.isEmptyNode(start) && tmpRange.startOffset == 1) {\n\t\t\t\ttmpRange.setStart(start, 0).collapse(true);\n\t\t\t}\n\t\t\twhile (!tmpRange.startOffset) {\n\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t\tif (domUtils.isBlockElm(start) || domUtils.isBody(start)) {\n\t\t\t\t\tflag = 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar pre = tmpRange.startContainer.previousSibling,\n\t\t\t\t\ttmpNode;\n\t\t\t\tif (!pre) {\n\t\t\t\t\ttmpRange.setStartBefore(tmpRange.startContainer);\n\t\t\t\t} else {\n\t\t\t\t\twhile (pre && domUtils.isFillChar(pre)) {\n\t\t\t\t\t\ttmpNode = pre;\n\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\ttmpRange.setStartBefore(tmpNode);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttmpRange.setStartBefore(tmpRange.startContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn flag && !domUtils.isBody(tmpRange.startContainer) ? 1 : 0;\n\t\t},\n\n\t\t/**\n\t\t * 判断给定的元素是否是一个空元素\n\t\t * @method isEmptyBlock\n\t\t * @param { Element } node 需要判断的元素\n\t\t * @return { Boolean } 是否是空元素\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isEmptyBlock( document.getElementById(\"test\") ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 根据指定的判断规则判断给定的元素是否是一个空元素\n\t\t * @method isEmptyBlock\n\t\t * @param { Element } node 需要判断的元素\n\t\t * @param { RegExp } reg 对内容执行判断的正则表达式对象\n\t\t * @return { Boolean } 是否是空元素\n\t\t */\n\t\tisEmptyBlock: function(node, reg) {\n\t\t\tif (node.nodeType != 1)\n\t\t\t\treturn 0;\n\t\t\treg = reg || new RegExp('[ \\xa0\\t\\r\\n' + domUtils.fillChar + ']', 'g');\n\n\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(reg, '').length > 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor (var n in dtd.$isNotEmpty) {\n\t\t\t\tif (node.getElementsByTagName(n).length) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 1;\n\t\t},\n\n\t\t/**\n\t\t * 移动元素使得该元素的位置移动指定的偏移量的距离\n\t\t * @method setViewportOffset\n\t\t * @param { Element } element 需要设置偏移量的元素\n\t\t * @param { Object } offset 偏移量， 形如{ left: 100, top: 50 }的一个键值对， 表示该元素将在\n\t\t *                                  现有的位置上向水平方向偏移offset.left的距离， 在竖直方向上偏移\n\t\t *                                  offset.top的距离\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\" style=\"top: 100px; left: 50px; position: absolute;\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.setViewportOffset( testNode, {\n\t\t *         left: 200,\n\t\t *         top: 50\n\t\t *     } );\n\t\t *\n\t\t *     //output: top: 300px; left: 100px; position: absolute;\n\t\t *     console.log( testNode.style.cssText );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsetViewportOffset: function(element, offset) {\n\t\t\tvar left = parseInt(element.style.left) | 0;\n\t\t\tvar top = parseInt(element.style.top) | 0;\n\t\t\tvar rect = element.getBoundingClientRect();\n\t\t\tvar offsetLeft = offset.left - rect.left;\n\t\t\tvar offsetTop = offset.top - rect.top;\n\t\t\tif (offsetLeft) {\n\t\t\t\telement.style.left = left + offsetLeft + 'px';\n\t\t\t}\n\t\t\tif (offsetTop) {\n\t\t\t\telement.style.top = top + offsetTop + 'px';\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 用“填充字符”填充节点\n\t\t * @method fillNode\n\t\t * @private\n\t\t * @param { DomDocument } doc 填充的节点所在的docment对象\n\t\t * @param { Node } node 需要填充的节点对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     //output: 0\n\t\t *     console.log( testNode.childNodes.length );\n\t\t *\n\t\t *     UE.dom.domUtils.fillNode( document, testNode );\n\t\t *\n\t\t *     //output: 1\n\t\t *     console.log( testNode.childNodes.length );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tfillNode: function(doc, node) {\n\t\t\tvar tmpNode = browser.ie ? doc.createTextNode(domUtils.fillChar) : doc.createElement('br');\n\t\t\tnode.innerHTML = '';\n\t\t\tnode.appendChild(tmpNode);\n\t\t},\n\n\t\t/**\n\t\t * 把节点src的所有子节点追加到另一个节点tag上去\n\t\t * @method moveChild\n\t\t * @param { Node } src 源节点， 该节点下的所有子节点将被移除\n\t\t * @param { Node } tag 目标节点， 从源节点移除的子节点将被追加到该节点下\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test1\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t * <div id=\"test2\">\n\t\t *     <div></div>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var test1 = document.getElementById(\"test1\"),\n\t\t *         test2 = document.getElementById(\"test2\");\n\t\t *\n\t\t *     UE.dom.domUtils.moveChild( test1, test2 );\n\t\t *\n\t\t *     //output: \"\"（空字符串）\n\t\t *     console.log( test1.innerHTML );\n\t\t *\n\t\t *     //output: \"<div></div><span></span>\"\n\t\t *     console.log( test2.innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 把节点src的所有子节点移动到另一个节点tag上去, 可以通过dir参数控制附加的行为是“追加”还是“插入顶部”\n\t\t * @method moveChild\n\t\t * @param { Node } src 源节点， 该节点下的所有子节点将被移除\n\t\t * @param { Node } tag 目标节点， 从源节点移除的子节点将被附加到该节点下\n\t\t * @param { Boolean } dir 附加方式， 如果为true， 则附加进去的节点将被放到目标节点的顶部， 反之，则放到末尾\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test1\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t * <div id=\"test2\">\n\t\t *     <div></div>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var test1 = document.getElementById(\"test1\"),\n\t\t *         test2 = document.getElementById(\"test2\");\n\t\t *\n\t\t *     UE.dom.domUtils.moveChild( test1, test2, true );\n\t\t *\n\t\t *     //output: \"\"（空字符串）\n\t\t *     console.log( test1.innerHTML );\n\t\t *\n\t\t *     //output: \"<span></span><div></div>\"\n\t\t *     console.log( test2.innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tmoveChild: function(src, tag, dir) {\n\t\t\twhile (src.firstChild) {\n\t\t\t\tif (dir && tag.firstChild) {\n\t\t\t\t\ttag.insertBefore(src.lastChild, tag.firstChild);\n\t\t\t\t} else {\n\t\t\t\t\ttag.appendChild(src.firstChild);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 判断节点的标签上是否不存在任何属性\n\t\t * @method hasNoAttributes\n\t\t * @private\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 节点是否不包含任何属性\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"><span>xxxx</span></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.hasNoAttributes( document.getElementById(\"test\") ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.hasNoAttributes( document.getElementById(\"test\").firstChild ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\thasNoAttributes: function(node) {\n\t\t\treturn browser.ie ? /^<\\w+\\s*?>/.test(node.outerHTML) : node.attributes.length == 0;\n\t\t},\n\n\t\t/**\n\t\t * 检测节点是否是UEditor所使用的辅助节点\n\t\t * @method isCustomeNode\n\t\t * @private\n\t\t * @param { Node } node 需要检测的节点\n\t\t * @remind 辅助节点是指编辑器要完成工作临时添加的节点， 在输出的时候将会从编辑器内移除， 不会影响最终的结果。\n\t\t * @return { Boolean } 给定的节点是否是一个辅助节点\n\t\t */\n\t\tisCustomeNode: function(node) {\n\t\t\treturn node.nodeType == 1 && node.getAttribute('_ue_custom_node_');\n\t\t},\n\n\t\t/**\n\t\t * 检测节点的标签是否是给定的标签\n\t\t * @method isTagNode\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @param { String } tagName 标签\n\t\t * @return { Boolean } 节点的标签是否是给定的标签\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isTagNode( document.getElementById(\"test\"), \"div\" ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisTagNode: function(node, tagNames) {\n\t\t\treturn node.nodeType == 1 && new RegExp('\\\\b' + node.tagName + '\\\\b', 'i').test(tagNames)\n\t\t},\n\n\t\t/**\n\t\t * 给定一个节点数组，在通过指定的过滤器过滤后， 获取其中满足过滤条件的第一个节点\n\t\t * @method filterNodeList\n\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t * @param { Function } fn 过滤器， 对符合条件的节点， 执行结果返回true， 反之则返回false\n\t\t * @return { Node | NULL } 如果找到符合过滤条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t *\n\t\t * //output: null\n\t\t * console.log( UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t *     return node.tagName.toLowerCase() !== 'div';\n\t\t * } ) );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 给定一个节点数组nodeList和一组标签名tagNames， 获取其中能够匹配标签名的节点集合中的第一个节点\n\t\t * @method filterNodeList\n\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t * @param { String } tagNames 需要匹配的标签名， 多个标签名之间用空格分割\n\t\t * @return { Node | NULL } 如果找到标签名匹配的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t *\n\t\t * //output: null\n\t\t * console.log( UE.dom.domUtils.filterNodeList( divNodes, 'a span' ) );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 给定一个节点数组，在通过指定的过滤器过滤后， 如果参数forAll为true， 则会返回所有满足过滤\n\t\t * 条件的节点集合， 否则， 返回满足条件的节点集合中的第一个节点\n\t\t * @method filterNodeList\n\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t * @param { Function } fn 过滤器， 对符合条件的节点， 执行结果返回true， 反之则返回false\n\t\t * @param { Boolean } forAll 是否返回整个节点数组, 如果该参数为false， 则返回节点集合中的第一个节点\n\t\t * @return { Array | Node | NULL } 如果找到符合过滤条件的节点， 则根据参数forAll的值决定返回满足\n\t\t *                                      过滤条件的节点数组或第一个节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t *\n\t\t * //output: 3（假定有3个div）\n\t\t * console.log( divNodes.length );\n\t\t *\n\t\t * var nodes = UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t *     return node.tagName.toLowerCase() === 'div';\n\t\t * }, true );\n\t\t *\n\t\t * //output: 3\n\t\t * console.log( nodes.length );\n\t\t *\n\t\t * var node = UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t *     return node.tagName.toLowerCase() === 'div';\n\t\t * }, false );\n\t\t *\n\t\t * //output: div\n\t\t * console.log( node.nodeName );\n\t\t * ```\n\t\t */\n\t\tfilterNodeList: function(nodelist, filter, forAll) {\n\t\t\tvar results = [];\n\t\t\tif (!utils.isFunction(filter)) {\n\t\t\t\tvar str = filter;\n\t\t\t\tfilter = function(n) {\n\t\t\t\t\treturn utils.indexOf(utils.isArray(str) ? str : str.split(' '), n.tagName.toLowerCase()) != -1\n\t\t\t\t};\n\t\t\t}\n\t\t\tutils.each(nodelist, function(n) {\n\t\t\t\tfilter(n) && results.push(n)\n\t\t\t});\n\t\t\treturn results.length == 0 ? null : results.length == 1 || !forAll ? results[0] : results\n\t\t},\n\n\t\t/**\n\t\t * 查询给定的range选区是否在给定的node节点内，且在该节点的最末尾\n\t\t * @method isInNodeEndBoundary\n\t\t * @param { UE.dom.Range } rng 需要判断的range对象， 该对象的startContainer不能为NULL\n\t\t * @param node 需要检测的节点对象\n\t\t * @return { Number } 如果给定的选取range对象是在node内部的最末端， 则返回1, 否则返回0\n\t\t */\n\t\tisInNodeEndBoundary: function(rng, node) {\n\t\t\tvar start = rng.startContainer;\n\t\t\tif (start.nodeType == 3 && rng.startOffset != start.nodeValue.length) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (start.nodeType == 1 && rng.startOffset != start.childNodes.length) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\twhile (start !== node) {\n\t\t\t\tif (start.nextSibling) {\n\t\t\t\t\treturn 0\n\t\t\t\t};\n\t\t\t\tstart = start.parentNode;\n\t\t\t}\n\t\t\treturn 1;\n\t\t},\n\t\tisBoundaryNode: function(node, dir) {\n\t\t\tvar tmp;\n\t\t\twhile (!domUtils.isBody(node)) {\n\t\t\t\ttmp = node;\n\t\t\t\tnode = node.parentNode;\n\t\t\t\tif (tmp !== node[dir]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tfillHtml: browser.ie11below ? '&nbsp;' : '<br/>'\n\t};\n\tvar fillCharReg = new RegExp(domUtils.fillChar, 'g');\n\n\t// core/Range.js\n\t/**\n\t * Range封装\n\t * @file\n\t * @module UE.dom\n\t * @class Range\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * dom操作封装\n\t * @unfile\n\t * @module UE.dom\n\t */\n\n\t/**\n\t * Range实现类，本类是UEditor底层核心类，封装不同浏览器之间的Range操作。\n\t * @unfile\n\t * @module UE.dom\n\t * @class Range\n\t */\n\n\t(function() {\n\t\tvar guid = 0,\n\t\t\tfillChar = domUtils.fillChar,\n\t\t\tfillData;\n\n\t\t/**\n\t\t * 更新range的collapse状态\n\t\t * @param  {Range}   range    range对象\n\t\t */\n\t\tfunction updateCollapse(range) {\n\t\t\trange.collapsed =\n\t\t\t\trange.startContainer && range.endContainer &&\n\t\t\t\trange.startContainer === range.endContainer &&\n\t\t\t\trange.startOffset == range.endOffset;\n\t\t}\n\n\t\tfunction selectOneNode(rng) {\n\t\t\treturn !rng.collapsed && rng.startContainer.nodeType == 1 && rng.startContainer === rng.endContainer && rng.endOffset - rng.startOffset == 1\n\t\t}\n\n\t\tfunction setEndPoint(toStart, node, offset, range) {\n\t\t\t//如果node是自闭合标签要处理\n\t\t\tif (node.nodeType == 1 && (dtd.$empty[node.tagName] || dtd.$nonChild[node.tagName])) {\n\t\t\t\toffset = domUtils.getNodeIndex(node) + (toStart ? 0 : 1);\n\t\t\t\tnode = node.parentNode;\n\t\t\t}\n\t\t\tif (toStart) {\n\t\t\t\trange.startContainer = node;\n\t\t\t\trange.startOffset = offset;\n\t\t\t\tif (!range.endContainer) {\n\t\t\t\t\trange.collapse(true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trange.endContainer = node;\n\t\t\t\trange.endOffset = offset;\n\t\t\t\tif (!range.startContainer) {\n\t\t\t\t\trange.collapse(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\tupdateCollapse(range);\n\t\t\treturn range;\n\t\t}\n\n\t\tfunction execContentsAction(range, action) {\n\t\t\t//调整边界\n\t\t\t//range.includeBookmark();\n\t\t\tvar start = range.startContainer,\n\t\t\t\tend = range.endContainer,\n\t\t\t\tstartOffset = range.startOffset,\n\t\t\t\tendOffset = range.endOffset,\n\t\t\t\tdoc = range.document,\n\t\t\t\tfrag = doc.createDocumentFragment(),\n\t\t\t\ttmpStart, tmpEnd;\n\t\t\tif (start.nodeType == 1) {\n\t\t\t\tstart = start.childNodes[startOffset] || (tmpStart = start.appendChild(doc.createTextNode('')));\n\t\t\t}\n\t\t\tif (end.nodeType == 1) {\n\t\t\t\tend = end.childNodes[endOffset] || (tmpEnd = end.appendChild(doc.createTextNode('')));\n\t\t\t}\n\t\t\tif (start === end && start.nodeType == 3) {\n\t\t\t\tfrag.appendChild(doc.createTextNode(start.substringData(startOffset, endOffset - startOffset)));\n\t\t\t\t//is not clone\n\t\t\t\tif (action) {\n\t\t\t\t\tstart.deleteData(startOffset, endOffset - startOffset);\n\t\t\t\t\trange.collapse(true);\n\t\t\t\t}\n\t\t\t\treturn frag;\n\t\t\t}\n\t\t\tvar current, currentLevel, clone = frag,\n\t\t\t\tstartParents = domUtils.findParents(start, true),\n\t\t\t\tendParents = domUtils.findParents(end, true);\n\t\t\tfor (var i = 0; startParents[i] == endParents[i];) {\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tfor (var j = i, si; si = startParents[j]; j++) {\n\t\t\t\tcurrent = si.nextSibling;\n\t\t\t\tif (si == start) {\n\t\t\t\t\tif (!tmpStart) {\n\t\t\t\t\t\tif (range.startContainer.nodeType == 3) {\n\t\t\t\t\t\t\tclone.appendChild(doc.createTextNode(start.nodeValue.slice(startOffset)));\n\t\t\t\t\t\t\t//is not clone\n\t\t\t\t\t\t\tif (action) {\n\t\t\t\t\t\t\t\tstart.deleteData(startOffset, start.nodeValue.length - startOffset);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone.appendChild(!action ? start.cloneNode(true) : start);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcurrentLevel = si.cloneNode(false);\n\t\t\t\t\tclone.appendChild(currentLevel);\n\t\t\t\t}\n\t\t\t\twhile (current) {\n\t\t\t\t\tif (current === end || current === endParents[j]) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsi = current.nextSibling;\n\t\t\t\t\tclone.appendChild(!action ? current.cloneNode(true) : current);\n\t\t\t\t\tcurrent = si;\n\t\t\t\t}\n\t\t\t\tclone = currentLevel;\n\t\t\t}\n\t\t\tclone = frag;\n\t\t\tif (!startParents[i]) {\n\t\t\t\tclone.appendChild(startParents[i - 1].cloneNode(false));\n\t\t\t\tclone = clone.firstChild;\n\t\t\t}\n\t\t\tfor (var j = i, ei; ei = endParents[j]; j++) {\n\t\t\t\tcurrent = ei.previousSibling;\n\t\t\t\tif (ei == end) {\n\t\t\t\t\tif (!tmpEnd && range.endContainer.nodeType == 3) {\n\t\t\t\t\t\tclone.appendChild(doc.createTextNode(end.substringData(0, endOffset)));\n\t\t\t\t\t\t//is not clone\n\t\t\t\t\t\tif (action) {\n\t\t\t\t\t\t\tend.deleteData(0, endOffset);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcurrentLevel = ei.cloneNode(false);\n\t\t\t\t\tclone.appendChild(currentLevel);\n\t\t\t\t}\n\t\t\t\t//如果两端同级，右边第一次已经被开始做了\n\t\t\t\tif (j != i || !startParents[i]) {\n\t\t\t\t\twhile (current) {\n\t\t\t\t\t\tif (current === start) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tei = current.previousSibling;\n\t\t\t\t\t\tclone.insertBefore(!action ? current.cloneNode(true) : current, clone.firstChild);\n\t\t\t\t\t\tcurrent = ei;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclone = currentLevel;\n\t\t\t}\n\t\t\tif (action) {\n\t\t\t\trange.setStartBefore(!endParents[i] ? endParents[i - 1] : !startParents[i] ? startParents[i - 1] : endParents[i]).collapse(true);\n\t\t\t}\n\t\t\ttmpStart && domUtils.remove(tmpStart);\n\t\t\ttmpEnd && domUtils.remove(tmpEnd);\n\t\t\treturn frag;\n\t\t}\n\n\t\t/**\n\t\t * 创建一个跟document绑定的空的Range实例\n\t\t * @constructor\n\t\t * @param { Document } document 新建的选区所属的文档对象\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } startContainer 当前Range的开始边界的容器节点, 可以是一个元素节点或者是文本节点\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } startOffset 当前Range的开始边界容器节点的偏移量, 如果是元素节点，\n\t\t *                              该值就是childNodes中的第几个节点， 如果是文本节点就是文本内容的第几个字符\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } endContainer 当前Range的结束边界的容器节点, 可以是一个元素节点或者是文本节点\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } endOffset 当前Range的结束边界容器节点的偏移量, 如果是元素节点，\n\t\t *                              该值就是childNodes中的第几个节点， 如果是文本节点就是文本内容的第几个字符\n\t\t */\n\n\t\t/**\n\t\t * @property { Boolean } collapsed 当前Range是否闭合\n\t\t * @default true\n\t\t * @remind Range是闭合的时候， startContainer === endContainer && startOffset === endOffset\n\t\t */\n\n\t\t/**\n\t\t * @property { Document } document 当前Range所属的Document对象\n\t\t * @remind 不同range的的document属性可以是不同的\n\t\t */\n\t\tvar Range = dom.Range = function(document) {\n\t\t\tvar me = this;\n\t\t\tme.startContainer =\n\t\t\t\tme.startOffset =\n\t\t\t\tme.endContainer =\n\t\t\t\tme.endOffset = null;\n\t\t\tme.document = document;\n\t\t\tme.collapsed = true;\n\t\t};\n\n\t\t/**\n\t\t * 删除fillData\n\t\t * @param doc\n\t\t * @param excludeNode\n\t\t */\n\t\tfunction removeFillData(doc, excludeNode) {\n\t\t\ttry {\n\t\t\t\tif (fillData && domUtils.inDoc(fillData, doc)) {\n\t\t\t\t\tif (!fillData.nodeValue.replace(fillCharReg, '').length) {\n\t\t\t\t\t\tvar tmpNode = fillData.parentNode;\n\t\t\t\t\t\tdomUtils.remove(fillData);\n\t\t\t\t\t\twhile (tmpNode && domUtils.isEmptyInlineElement(tmpNode) &&\n\t\t\t\t\t\t\t//safari的contains有bug\n\t\t\t\t\t\t\t(browser.safari ? !(domUtils.getPosition(tmpNode, excludeNode) & domUtils.POSITION_CONTAINS) : !tmpNode.contains(excludeNode))\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tfillData = tmpNode.parentNode;\n\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\ttmpNode = fillData;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfillData.nodeValue = fillData.nodeValue.replace(fillCharReg, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\t/**\n\t\t * @param node\n\t\t * @param dir\n\t\t */\n\t\tfunction mergeSibling(node, dir) {\n\t\t\tvar tmpNode;\n\t\t\tnode = node[dir];\n\t\t\twhile (node && domUtils.isFillChar(node)) {\n\t\t\t\ttmpNode = node[dir];\n\t\t\t\tdomUtils.remove(node);\n\t\t\t\tnode = tmpNode;\n\t\t\t}\n\t\t}\n\n\t\tRange.prototype = {\n\n\t\t\t/**\n\t\t\t * 克隆选区的内容到一个DocumentFragment里\n\t\t\t * @method cloneContents\n\t\t\t * @return { DocumentFragment | NULL } 如果选区是闭合的将返回null， 否则， 返回包含所clone内容的DocumentFragment元素\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t *\n\t\t\t *      <script>\n\t\t\t *          //range是已选中的选区\n\t\t\t *          var fragment = range.cloneContents(),\n\t\t\t *              node = document.createElement(\"div\");\n\t\t\t *\n\t\t\t *          node.appendChild( fragment );\n\t\t\t *\n\t\t\t *          //output: <i>x</i>xx\n\t\t\t *          console.log( node.innerHTML );\n\t\t\t *\n\t\t\t *      </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tcloneContents: function() {\n\t\t\t\treturn this.collapsed ? null : execContentsAction(this, 0);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 删除当前选区范围中的所有内容\n\t\t\t * @method deleteContents\n\t\t\t * @remind 执行完该操作后， 当前Range对象变成了闭合状态\n\t\t\t * @return { UE.dom.Range } 当前操作的Range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t *\n\t\t\t *      <script>\n\t\t\t *          //range是已选中的选区\n\t\t\t *          range.deleteContents();\n\t\t\t *\n\t\t\t *          //竖线表示闭合后的选区位置\n\t\t\t *          //output: <b>x<i>x</i>|x</b>\n\t\t\t *          console.log( document.body.innerHTML );\n\t\t\t *\n\t\t\t *          //此时， range的各项属性为\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.startContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.startOffset );\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.endContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.endOffset );\n\t\t\t *          //output: true\n\t\t\t *          console.log( range.collapsed );\n\t\t\t *\n\t\t\t *      </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tdeleteContents: function() {\n\t\t\t\tvar txt;\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\texecContentsAction(this, 1);\n\t\t\t\t}\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\ttxt = this.startContainer;\n\t\t\t\t\tif (txt.nodeType == 3 && !txt.nodeValue.length) {\n\t\t\t\t\t\tthis.setStartBefore(txt).collapse(true);\n\t\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将当前选区的内容提取到一个DocumentFragment里\n\t\t\t * @method extractContents\n\t\t\t * @remind 执行该操作后， 选区将变成闭合状态\n\t\t\t * @warning 执行该操作后， 原来选区所选中的内容将从dom树上剥离出来\n\t\t\t * @return { DocumentFragment } 返回包含所提取内容的DocumentFragment对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t *\n\t\t\t *      <script>\n\t\t\t *          //range是已选中的选区\n\t\t\t *          var fragment = range.extractContents(),\n\t\t\t *              node = document.createElement( \"div\" );\n\t\t\t *\n\t\t\t *          node.appendChild( fragment );\n\t\t\t *\n\t\t\t *          //竖线表示闭合后的选区位置\n\t\t\t *\n\t\t\t *          //output: <b>x<i>x</i>|x</b>\n\t\t\t *          console.log( document.body.innerHTML );\n\t\t\t *          //output: <i>x</i>xx\n\t\t\t *          console.log( node.innerHTML );\n\t\t\t *\n\t\t\t *          //此时， range的各项属性为\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.startContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.startOffset );\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.endContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.endOffset );\n\t\t\t *          //output: true\n\t\t\t *          console.log( range.collapsed );\n\t\t\t *\n\t\t\t *      </script>\n\t\t\t * </body>\n\t\t\t */\n\t\t\textractContents: function() {\n\t\t\t\treturn this.collapsed ? null : execContentsAction(this, 2);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的开始容器节点和偏移量\n\t\t\t * @method  setStart\n\t\t\t * @remind 如果给定的节点是元素节点，那么offset指的是其子元素中索引为offset的元素，\n\t\t\t *          如果是文本节点，那么offset指的是其文本内容的第offset个字符\n\t\t\t * @remind 如果提供的容器节点是一个不能包含子元素的节点， 则该选区的开始容器将被设置\n\t\t\t *          为该节点的父节点， 此时， 其距离开始容器的偏移量也变成了该节点在其父节点\n\t\t\t *          中的索引\n\t\t\t * @param { Node } node 将被设为当前选区开始边界容器的节点对象\n\t\t\t * @param { int } offset 选区的开始位置偏移量\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区 -->\n\t\t\t * <b>xxx<i>x<span>xx</span>xx<em>xx</em>xxx</i>[xxx]</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStart( document.getElementsByTagName(\"i\")[0], 1 );\n\t\t\t *\n\t\t\t *     //此时， 选区变成了\n\t\t\t *     //<b>xxx<i>x[<span>xx</span>xx<em>xx</em>xxx</i>xxx]</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区 -->\n\t\t\t * <b>xxx<img>[xx]x</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStart( document.getElementsByTagName(\"img\")[0], 3 );\n\t\t\t *\n\t\t\t *     //此时， 选区变成了\n\t\t\t *     //<b>xxx[<img>xx]x</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStart: function(node, offset) {\n\t\t\t\treturn setEndPoint(true, node, offset, this);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的结束容器和偏移量\n\t\t\t * @method  setEnd\n\t\t\t * @param { Node } node 作为当前选区结束边界容器的节点对象\n\t\t\t * @param { int } offset 结束边界的偏移量\n\t\t\t * @see UE.dom.Range:setStart(Node,int)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEnd: function(node, offset) {\n\t\t\t\treturn setEndPoint(false, node, offset, this);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range开始位置设置到node节点之后\n\t\t\t * @method  setStartAfter\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的开始容器， 且偏移量是该节点在其父节点中的位置索引+1\n\t\t\t * @param { Node } node 选区的开始边界将紧接着该节点之后\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>xx[x</span>xxx]</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStartAfter( document.getElementsByTagName(\"i\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>xx<i>xxx</i>[<span>xxx</span>xxx]</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStartAfter: function(node) {\n\t\t\t\treturn this.setStart(node.parentNode, domUtils.getNodeIndex(node) + 1);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range开始位置设置到node节点之前\n\t\t\t * @method  setStartBefore\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的开始容器， 且偏移量是该节点在其父节点中的位置索引\n\t\t\t * @param { Node } node 新的选区开始位置在该节点之前\n\t\t\t * @see UE.dom.Range:setStartAfter(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetStartBefore: function(node) {\n\t\t\t\treturn this.setStart(node.parentNode, domUtils.getNodeIndex(node));\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range结束位置设置到node节点之后\n\t\t\t * @method  setEndAfter\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的结束容器， 且偏移量是该节点在其父节点中的位置索引+1\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setStartAfter(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>[xx<i>xxx</i><span>xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStartAfter( document.getElementsByTagName(\"span\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>[xx<i>xxx</i><span>xxx</span>]xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetEndAfter: function(node) {\n\t\t\t\treturn this.setEnd(node.parentNode, domUtils.getNodeIndex(node) + 1);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range结束位置设置到node节点之前\n\t\t\t * @method  setEndBefore\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的结束容器， 且偏移量是该节点在其父节点中的位置索引\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setEndAfter(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEndBefore: function(node) {\n\t\t\t\treturn this.setEnd(node.parentNode, domUtils.getNodeIndex(node));\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的开始位置到node节点内的第一个子节点之前\n\t\t\t * @method  setStartAtFirst\n\t\t\t * @remind 选区的开始容器将变成给定的节点， 且偏移量为0\n\t\t\t * @remind 如果给定的节点是元素节点， 则该节点必须是允许包含子节点的元素。\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setStartBefore(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStartAtFirst( document.getElementsByTagName(\"i\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>xx<i>[xxx</i><span>xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStartAtFirst: function(node) {\n\t\t\t\treturn this.setStart(node, 0);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的开始位置到node节点内的最后一个节点之后\n\t\t\t * @method setStartAtLast\n\t\t\t * @remind 选区的开始容器将变成给定的节点， 且偏移量为该节点的子节点数\n\t\t\t * @remind 如果给定的节点是元素节点， 则该节点必须是允许包含子节点的元素。\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetStartAtLast: function(node) {\n\t\t\t\treturn this.setStart(node, node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的结束位置到node节点内的第一个节点之前\n\t\t\t * @method  setEndAtFirst\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @remind 选区的结束容器将变成给定的节点， 且偏移量为0\n\t\t\t * @remind node必须是一个元素节点， 且必须是允许包含子节点的元素。\n\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEndAtFirst: function(node) {\n\t\t\t\treturn this.setEnd(node, 0);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的结束位置到node节点内的最后一个节点之后\n\t\t\t * @method  setEndAtLast\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @remind 选区的结束容器将变成给定的节点， 且偏移量为该节点的子节点数量\n\t\t\t * @remind node必须是一个元素节点， 且必须是允许包含子节点的元素。\n\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEndAtLast: function(node) {\n\t\t\t\treturn this.setEnd(node, node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 选中给定节点\n\t\t\t * @method  selectNode\n\t\t\t * @remind 此时， 选区的开始容器和结束容器都是该节点的父节点， 其startOffset是该节点在父节点中的位置索引，\n\t\t\t *          而endOffset为startOffset+1\n\t\t\t * @param { Node } node 需要选中的节点\n\t\t\t * @return { UE.dom.Range } 当前range对象，此时的range仅包含当前给定的节点对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.selectNode( document.getElementsByTagName(\"i\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>xx[<i>xxx</i>]<span>xxx</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tselectNode: function(node) {\n\t\t\t\treturn this.setStartBefore(node).setEndAfter(node);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 选中给定节点内部的所有节点\n\t\t\t * @method  selectNodeContents\n\t\t\t * @remind 此时， 选区的开始容器和结束容器都是该节点， 其startOffset为0，\n\t\t\t *          而endOffset是该节点的子节点数。\n\t\t\t * @param { Node } node 目标节点， 当前range将包含该节点内的所有节点\n\t\t\t * @return { UE.dom.Range } 当前range对象， 此时range仅包含给定节点的所有子节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.selectNode( document.getElementsByTagName(\"b\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>[xx<i>xxx</i><span>xxx</span>xxx]</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tselectNodeContents: function(node) {\n\t\t\t\treturn this.setStart(node, 0).setEndAtLast(node);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * clone当前Range对象\n\t\t\t * @method  cloneRange\n\t\t\t * @remind 返回的range是一个全新的range对象， 其内部所有属性与当前被clone的range相同。\n\t\t\t * @return { UE.dom.Range } 当前range对象的一个副本\n\t\t\t */\n\t\t\tcloneRange: function() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn new Range(me.document).setStart(me.startContainer, me.startOffset).setEnd(me.endContainer, me.endOffset);\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 向当前选区的结束处闭合选区\n\t\t\t * @method  collapse\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.collapse();\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //“|”表示选区已闭合\n\t\t\t *     //<b>xx<i>xxx</i><span>xx|x</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 闭合当前选区，根据给定的toStart参数项决定是向当前选区开始处闭合还是向结束处闭合，\n\t\t\t * 如果toStart的值为true，则向开始位置闭合， 反之，向结束位置闭合。\n\t\t\t * @method  collapse\n\t\t\t * @param { Boolean } toStart 是否向选区开始处闭合\n\t\t\t * @return { UE.dom.Range } 当前range对象，此时range对象处于闭合状态\n\t\t\t * @see UE.dom.Range:collapse()\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.collapse( true );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //“|”表示选区已闭合\n\t\t\t *     //<b>xx<i>xxx</i><span>|xxx</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tcollapse: function(toStart) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (toStart) {\n\t\t\t\t\tme.endContainer = me.startContainer;\n\t\t\t\t\tme.endOffset = me.startOffset;\n\t\t\t\t} else {\n\t\t\t\t\tme.startContainer = me.endContainer;\n\t\t\t\t\tme.startOffset = me.endOffset;\n\t\t\t\t}\n\t\t\t\tme.collapsed = true;\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 调整range的开始位置和结束位置，使其\"收缩\"到最小的位置\n\t\t\t * @method  shrinkBoundary\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span>xx<b>xx[</b>xxxxx]</span> => <span>xx<b>xx</b>[xxxxx]</span>\n\t\t\t * ```\n\t\t\t *\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>x[xx</b><i>]xxx</i>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行收缩\n\t\t\t *     range.shrinkBoundary();\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>x[xx]</b><i>xxx</i>\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t *\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * [<b><i>xxxx</i>xxxxxxx</b>] => <b><i>[xxxx</i>xxxxxxx]</b>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 调整range的开始位置和结束位置，使其\"收缩\"到最小的位置，\n\t\t\t * 如果ignoreEnd的值为true，则忽略对结束位置的调整\n\t\t\t * @method  shrinkBoundary\n\t\t\t * @param { Boolean } ignoreEnd 是否忽略对结束位置的调整\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.domUtils.Range:shrinkBoundary()\n\t\t\t */\n\t\t\tshrinkBoundary: function(ignoreEnd) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tchild,\n\t\t\t\t\tcollapsed = me.collapsed;\n\n\t\t\t\tfunction check(node) {\n\t\t\t\t\treturn node.nodeType == 1 && !domUtils.isBookmarkNode(node) && !dtd.$empty[node.tagName] && !dtd.$nonChild[node.tagName]\n\t\t\t\t}\n\t\t\t\twhile (me.startContainer.nodeType == 1 //是element\n\t\t\t\t\t&& (child = me.startContainer.childNodes[me.startOffset]) //子节点也是element\n\t\t\t\t\t&& check(child)) {\n\t\t\t\t\tme.setStart(child, 0);\n\t\t\t\t}\n\t\t\t\tif (collapsed) {\n\t\t\t\t\treturn me.collapse(true);\n\t\t\t\t}\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\twhile (me.endContainer.nodeType == 1 //是element\n\t\t\t\t\t\t&& me.endOffset > 0 //如果是空元素就退出 endOffset=0那么endOffst-1为负值，childNodes[endOffset]报错\n\t\t\t\t\t\t&& (child = me.endContainer.childNodes[me.endOffset - 1]) //子节点也是element\n\t\t\t\t\t\t&& check(child)) {\n\t\t\t\t\t\tme.setEnd(child, child.childNodes.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取离当前选区内包含的所有节点最近的公共祖先节点，\n\t\t\t * @method  getCommonAncestor\n\t\t\t * @remind 返回的公共祖先节点一定不是range自身的容器节点， 但有可能是一个文本节点\n\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * //选区示例\n\t\t\t * <span>xxx<b>x[x<em>xx]x</em>xxx</b>xx</span>\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var node = range.getCommonAncestor();\n\t\t\t *\n\t\t\t *     //公共祖先节点是： b节点\n\t\t\t *     //输出： B\n\t\t\t *     console.log(node.tagName);\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 获取当前选区所包含的所有节点的公共祖先节点， 可以根据给定的参数 includeSelf 决定获取到\n\t\t\t * 的公共祖先节点是否可以是当前选区的startContainer或endContainer节点， 如果 includeSelf\n\t\t\t * 的取值为true， 则返回的节点可以是自身的容器节点， 否则， 则不能是容器节点\n\t\t\t * @method  getCommonAncestor\n\t\t\t * @param { Boolean } includeSelf 是否允许获取到的公共祖先节点是当前range对象的容器节点\n\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t * @see UE.dom.Range:getCommonAncestor()\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区示例 -->\n\t\t\t *     <b>xxx<i>xxxx<span>xx[x</span>xx]x</i>xxxxxxx</b>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *\n\t\t\t *         var node = range.getCommonAncestor( false );\n\t\t\t *\n\t\t\t *         //这里的公共祖先节点是B而不是I， 是因为参数限制了获取到的节点不能是容器节点\n\t\t\t *         //output: B\n\t\t\t *         console.log( node.tagName );\n\t\t\t *\n\t\t\t *     </script>\n\t\t\t *\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 获取当前选区所包含的所有节点的公共祖先节点， 可以根据给定的参数 includeSelf 决定获取到\n\t\t\t * 的公共祖先节点是否可以是当前选区的startContainer或endContainer节点， 如果 includeSelf\n\t\t\t * 的取值为true， 则返回的节点可以是自身的容器节点， 否则， 则不能是容器节点； 同时可以根据\n\t\t\t * ignoreTextNode 参数的取值决定是否忽略类型为文本节点的祖先节点。\n\t\t\t * @method  getCommonAncestor\n\t\t\t * @param { Boolean } includeSelf 是否允许获取到的公共祖先节点是当前range对象的容器节点\n\t\t\t * @param { Boolean } ignoreTextNode 获取祖先节点的过程中是否忽略类型为文本节点的祖先节点\n\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t * @see UE.dom.Range:getCommonAncestor()\n\t\t\t * @see UE.dom.Range:getCommonAncestor(Boolean)\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区示例 -->\n\t\t\t *     <b>xxx<i>xxxx<span>x[x]x</span>xxx</i>xxxxxxx</b>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *\n\t\t\t *         var node = range.getCommonAncestor( true, false );\n\t\t\t *\n\t\t\t *         //output: SPAN\n\t\t\t *         console.log( node.tagName );\n\t\t\t *\n\t\t\t *     </script>\n\t\t\t *\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetCommonAncestor: function(includeSelf, ignoreTextNode) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tstart = me.startContainer,\n\t\t\t\t\tend = me.endContainer;\n\t\t\t\tif (start === end) {\n\t\t\t\t\tif (includeSelf && selectOneNode(this)) {\n\t\t\t\t\t\tstart = start.childNodes[me.startOffset];\n\t\t\t\t\t\tif (start.nodeType == 1)\n\t\t\t\t\t\t\treturn start;\n\t\t\t\t\t}\n\t\t\t\t\t//只有在上来就相等的情况下才会出现是文本的情况\n\t\t\t\t\treturn ignoreTextNode && start.nodeType == 3 ? start.parentNode : start;\n\t\t\t\t}\n\t\t\t\treturn domUtils.getCommonAncestor(start, end);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 调整当前Range的开始和结束边界容器，如果是容器节点是文本节点,就调整到包含该文本节点的父节点上\n\t\t\t * @method trimBoundary\n\t\t\t * @remind 该操作有可能会引起文本节点被切开\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * //选区示例\n\t\t\t * <b>xxx<i>[xxxxx]</i>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     //未调整前， 选区的开始容器和结束都是文本节点\n\t\t\t *     //执行调整\n\t\t\t *     range.trimBoundary();\n\t\t\t *\n\t\t\t *     //调整之后， 容器节点变成了i节点\n\t\t\t *     //<b>xxx[<i>xxxxx</i>]xxx</b>\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 调整当前Range的开始和结束边界容器，如果是容器节点是文本节点,就调整到包含该文本节点的父节点上，\n\t\t\t * 可以根据 ignoreEnd 参数的值决定是否调整对结束边界的调整\n\t\t\t * @method trimBoundary\n\t\t\t * @param { Boolean } ignoreEnd 是否忽略对结束边界的调整\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * //选区示例\n\t\t\t * <b>xxx<i>[xxxxx]</i>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     //未调整前， 选区的开始容器和结束都是文本节点\n\t\t\t *     //执行调整\n\t\t\t *     range.trimBoundary( true );\n\t\t\t *\n\t\t\t *     //调整之后， 开始容器节点变成了i节点\n\t\t\t *     //但是， 结束容器没有发生变化\n\t\t\t *     //<b>xxx[<i>xxxxx]</i>xxx</b>\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\ttrimBoundary: function(ignoreEnd) {\n\t\t\t\tthis.txtToElmBoundary();\n\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\toffset = this.startOffset,\n\t\t\t\t\tcollapsed = this.collapsed,\n\t\t\t\t\tend = this.endContainer;\n\t\t\t\tif (start.nodeType == 3) {\n\t\t\t\t\tif (offset == 0) {\n\t\t\t\t\t\tthis.setStartBefore(start);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (offset >= start.nodeValue.length) {\n\t\t\t\t\t\t\tthis.setStartAfter(start);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar textNode = domUtils.split(start, offset);\n\t\t\t\t\t\t\t//跟新结束边界\n\t\t\t\t\t\t\tif (start === end) {\n\t\t\t\t\t\t\t\tthis.setEnd(textNode, this.endOffset - offset);\n\t\t\t\t\t\t\t} else if (start.parentNode === end) {\n\t\t\t\t\t\t\t\tthis.endOffset += 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setStartBefore(textNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\treturn this.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\toffset = this.endOffset;\n\t\t\t\t\tend = this.endContainer;\n\t\t\t\t\tif (end.nodeType == 3) {\n\t\t\t\t\t\tif (offset == 0) {\n\t\t\t\t\t\t\tthis.setEndBefore(end);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toffset < end.nodeValue.length && domUtils.split(end, offset);\n\t\t\t\t\t\t\tthis.setEndAfter(end);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 如果选区在文本的边界上，就扩展选区到文本的父节点上, 如果当前选区是闭合的， 则什么也不做\n\t\t\t * @method txtToElmBoundary\n\t\t\t * @remind 该操作不会修改dom节点\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 如果选区在文本的边界上，就扩展选区到文本的父节点上, 如果当前选区是闭合的， 则根据参数项\n\t\t\t * ignoreCollapsed 的值决定是否执行该调整\n\t\t\t * @method txtToElmBoundary\n\t\t\t * @param { Boolean } ignoreCollapsed 是否忽略选区的闭合状态， 如果该参数取值为true， 则\n\t\t\t *                      不论选区是否闭合， 都会执行该操作， 反之， 则不会对闭合的选区执行该操作\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\ttxtToElmBoundary: function(ignoreCollapsed) {\n\t\t\t\tfunction adjust(r, c) {\n\t\t\t\t\tvar container = r[c + 'Container'],\n\t\t\t\t\t\toffset = r[c + 'Offset'];\n\t\t\t\t\tif (container.nodeType == 3) {\n\t\t\t\t\t\tif (!offset) {\n\t\t\t\t\t\t\tr['set' + c.replace(/(\\w)/, function(a) {\n\t\t\t\t\t\t\t\treturn a.toUpperCase();\n\t\t\t\t\t\t\t}) + 'Before'](container);\n\t\t\t\t\t\t} else if (offset >= container.nodeValue.length) {\n\t\t\t\t\t\t\tr['set' + c.replace(/(\\w)/, function(a) {\n\t\t\t\t\t\t\t\treturn a.toUpperCase();\n\t\t\t\t\t\t\t}) + 'After'](container);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (ignoreCollapsed || !this.collapsed) {\n\t\t\t\t\tadjust(this, 'start');\n\t\t\t\t\tadjust(this, 'end');\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在当前选区的开始位置前插入节点，新插入的节点会被该range包含\n\t\t\t * @method  insertNode\n\t\t\t * @param { Node } node 需要插入的节点\n\t\t\t * @remind 插入的节点可以是一个DocumentFragment依次插入多个节点\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tinsertNode: function(node) {\n\t\t\t\tvar first = node,\n\t\t\t\t\tlength = 1;\n\t\t\t\tif (node.nodeType == 11) {\n\t\t\t\t\tfirst = node.firstChild;\n\t\t\t\t\tlength = node.childNodes.length;\n\t\t\t\t}\n\t\t\t\tthis.trimBoundary(true);\n\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\toffset = this.startOffset;\n\t\t\t\tvar nextNode = start.childNodes[offset];\n\t\t\t\tif (nextNode) {\n\t\t\t\t\tstart.insertBefore(node, nextNode);\n\t\t\t\t} else {\n\t\t\t\t\tstart.appendChild(node);\n\t\t\t\t}\n\t\t\t\tif (first.parentNode === this.endContainer) {\n\t\t\t\t\tthis.endOffset = this.endOffset + length;\n\t\t\t\t}\n\t\t\t\treturn this.setStartBefore(first);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 闭合选区到当前选区的开始位置， 并且定位光标到闭合后的位置\n\t\t\t * @method  setCursor\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:collapse()\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 闭合选区，可以根据参数toEnd的值控制选区是向前闭合还是向后闭合， 并且定位光标到闭合后的位置。\n\t\t\t * @method  setCursor\n\t\t\t * @param { Boolean } toEnd 是否向后闭合， 如果为true， 则闭合选区时， 将向结束容器方向闭合，\n\t\t\t *                      反之，则向开始容器方向闭合\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:collapse(Boolean)\n\t\t\t */\n\t\t\tsetCursor: function(toEnd, noFillData) {\n\t\t\t\treturn this.collapse(!toEnd).select(noFillData);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 创建当前range的一个书签，记录下当前range的位置，方便当dom树改变时，还能找回原来的选区位置\n\t\t\t * @method createBookmark\n\t\t\t * @param { Boolean } serialize 控制返回的标记位置是对当前位置的引用还是ID，如果该值为true，则\n\t\t\t *                              返回标记位置的ID， 反之则返回标记位置节点的引用\n\t\t\t * @return { Object } 返回一个书签记录键值对， 其包含的key有： start => 开始标记的ID或者引用，\n\t\t\t *                          end => 结束标记的ID或引用， id => 当前标记的类型， 如果为true，则表示\n\t\t\t *                          返回的记录的类型为ID， 反之则为引用\n\t\t\t */\n\t\t\tcreateBookmark: function(serialize, same) {\n\t\t\t\tvar endNode,\n\t\t\t\t\tstartNode = this.document.createElement('span');\n\t\t\t\tstartNode.style.cssText = 'display:none;line-height:0px;';\n\t\t\t\tstartNode.appendChild(this.document.createTextNode('\\u200D'));\n\t\t\t\tstartNode.id = '_baidu_bookmark_start_' + (same ? '' : guid++);\n\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\tendNode = startNode.cloneNode(true);\n\t\t\t\t\tendNode.id = '_baidu_bookmark_end_' + (same ? '' : guid++);\n\t\t\t\t}\n\t\t\t\tthis.insertNode(startNode);\n\t\t\t\tif (endNode) {\n\t\t\t\t\tthis.collapse().insertNode(endNode).setEndBefore(endNode);\n\t\t\t\t}\n\t\t\t\tthis.setStartAfter(startNode);\n\t\t\t\treturn {\n\t\t\t\t\tstart: serialize ? startNode.id : startNode,\n\t\t\t\t\tend: endNode ? serialize ? endNode.id : endNode : null,\n\t\t\t\t\tid: serialize\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t *  调整当前range的边界到书签位置，并删除该书签对象所标记的位置内的节点\n\t\t\t *  @method  moveToBookmark\n\t\t\t *  @param { BookMark } bookmark createBookmark所创建的标签对象\n\t\t\t *  @return { UE.dom.Range } 当前range对象\n\t\t\t *  @see UE.dom.Range:createBookmark(Boolean)\n\t\t\t */\n\t\t\tmoveToBookmark: function(bookmark) {\n\t\t\t\tvar start = bookmark.id ? this.document.getElementById(bookmark.start) : bookmark.start,\n\t\t\t\t\tend = bookmark.end && bookmark.id ? this.document.getElementById(bookmark.end) : bookmark.end;\n\t\t\t\tthis.setStartBefore(start);\n\t\t\t\tdomUtils.remove(start);\n\t\t\t\tif (end) {\n\t\t\t\t\tthis.setEndBefore(end);\n\t\t\t\t\tdomUtils.remove(end);\n\t\t\t\t} else {\n\t\t\t\t\tthis.collapse(true);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 调整range的边界，使其\"放大\"到最近的父节点\n\t\t\t * @method  enlarge\n\t\t\t * @remind 会引起选区的变化\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 调整range的边界，使其\"放大\"到最近的父节点，根据参数 toBlock 的取值， 可以\n\t\t\t * 要求扩大之后的父节点是block节点\n\t\t\t * @method  enlarge\n\t\t\t * @param { Boolean } toBlock 是否要求扩大之后的父节点必须是block节点\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tenlarge: function(toBlock, stopFn) {\n\t\t\t\tvar isBody = domUtils.isBody,\n\t\t\t\t\tpre, node, tmp = this.document.createTextNode('');\n\t\t\t\tif (toBlock) {\n\t\t\t\t\tnode = this.startContainer;\n\t\t\t\t\tif (node.nodeType == 1) {\n\t\t\t\t\t\tif (node.childNodes[this.startOffset]) {\n\t\t\t\t\t\t\tpre = node = node.childNodes[this.startOffset]\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.appendChild(tmp);\n\t\t\t\t\t\t\tpre = node = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t}\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (domUtils.isBlockElm(node)) {\n\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\twhile ((pre = node.previousSibling) && !domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setStartBefore(node);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tnode = this.endContainer;\n\t\t\t\t\tif (node.nodeType == 1) {\n\t\t\t\t\t\tif (pre = node.childNodes[this.endOffset]) {\n\t\t\t\t\t\t\tnode.insertBefore(tmp, pre);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.appendChild(tmp);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre = node = tmp;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t}\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (domUtils.isBlockElm(node)) {\n\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\twhile ((pre = node.nextSibling) && !domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setEndAfter(node);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (tmp.parentNode === this.endContainer) {\n\t\t\t\t\t\tthis.endOffset--;\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.remove(tmp);\n\t\t\t\t}\n\n\t\t\t\t// 扩展边界到最大\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\twhile (this.startOffset == 0) {\n\t\t\t\t\t\tif (stopFn && stopFn(this.startContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isBody(this.startContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setStartBefore(this.startContainer);\n\t\t\t\t\t}\n\t\t\t\t\twhile (this.endOffset == (this.endContainer.nodeType == 1 ? this.endContainer.childNodes.length : this.endContainer.nodeValue.length)) {\n\t\t\t\t\t\tif (stopFn && stopFn(this.endContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isBody(this.endContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setEndAfter(this.endContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tenlargeToBlockElm: function(ignoreEnd) {\n\t\t\t\twhile (!domUtils.isBlockElm(this.startContainer)) {\n\t\t\t\t\tthis.setStartBefore(this.startContainer);\n\t\t\t\t}\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\twhile (!domUtils.isBlockElm(this.endContainer)) {\n\t\t\t\t\t\tthis.setEndAfter(this.endContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 调整Range的边界，使其\"缩小\"到最合适的位置\n\t\t\t * @method adjustmentBoundary\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:shrinkBoundary()\n\t\t\t */\n\t\t\tadjustmentBoundary: function() {\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\twhile (!domUtils.isBody(this.startContainer) &&\n\t\t\t\t\t\tthis.startOffset == this.startContainer[this.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length &&\n\t\t\t\t\t\tthis.startContainer[this.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t\t) {\n\n\t\t\t\t\t\tthis.setStartAfter(this.startContainer);\n\t\t\t\t\t}\n\t\t\t\t\twhile (!domUtils.isBody(this.endContainer) && !this.endOffset &&\n\t\t\t\t\t\tthis.endContainer[this.endContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.setEndBefore(this.endContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 给range选区中的内容添加给定的inline标签\n\t\t\t * @method applyInlineStyle\n\t\t\t * @param { String } tagName 需要添加的标签名\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <p>xxxx[xxxx]x</p>  ==>  range.applyInlineStyle(\"strong\")  ==>  <p>xxxx[<strong>xxxx</strong>]x</p>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 给range选区中的内容添加给定的inline标签， 并且为标签附加上一些初始化属性。\n\t\t\t * @method applyInlineStyle\n\t\t\t * @param { String } tagName 需要添加的标签名\n\t\t\t * @param { Object } attrs 跟随新添加的标签的属性\n\t\t\t * @return { UE.dom.Range } 当前选区\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <p>xxxx[xxxx]x</p>\n\t\t\t *\n\t\t\t * ==>\n\t\t\t *\n\t\t\t * <!-- 执行操作 -->\n\t\t\t * range.applyInlineStyle(\"strong\",{\"style\":\"font-size:12px\"})\n\t\t\t *\n\t\t\t * ==>\n\t\t\t *\n\t\t\t * <p>xxxx[<strong style=\"font-size:12px\">xxxx</strong>]x</p>\n\t\t\t * ```\n\t\t\t */\n\t\t\tapplyInlineStyle: function(tagName, attrs, list) {\n\t\t\t\tif (this.collapsed) return this;\n\t\t\t\tthis.trimBoundary().enlarge(false,\n\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 && domUtils.isBlockElm(node)\n\t\t\t\t\t}).adjustmentBoundary();\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tend = bookmark.end,\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark.start, false, filterFn),\n\t\t\t\t\tnode,\n\t\t\t\t\tpre,\n\t\t\t\t\trange = this.cloneRange();\n\t\t\t\twhile (current && (domUtils.getPosition(current, end) & domUtils.POSITION_PRECEDING)) {\n\t\t\t\t\tif (current.nodeType == 3 || dtd[tagName][current.tagName]) {\n\t\t\t\t\t\trange.setStartBefore(current);\n\t\t\t\t\t\tnode = current;\n\t\t\t\t\t\twhile (node && (node.nodeType == 3 || dtd[tagName][node.tagName]) && node !== end) {\n\t\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\t\tnode = domUtils.getNextDomNode(node, node.nodeType == 1, null, function(parent) {\n\t\t\t\t\t\t\t\treturn dtd[tagName][parent.tagName];\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar frag = range.setEndAfter(pre).extractContents(),\n\t\t\t\t\t\t\telm;\n\t\t\t\t\t\tif (list && list.length > 0) {\n\t\t\t\t\t\t\tvar level, top;\n\t\t\t\t\t\t\ttop = level = list[0].cloneNode(false);\n\t\t\t\t\t\t\tfor (var i = 1, ci; ci = list[i++];) {\n\t\t\t\t\t\t\t\tlevel.appendChild(ci.cloneNode(false));\n\t\t\t\t\t\t\t\tlevel = level.firstChild;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telm = level;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telm = range.document.createElement(tagName);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(elm, attrs);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telm.appendChild(frag);\n\t\t\t\t\t\trange.insertNode(list ? top : elm);\n\t\t\t\t\t\t//处理下滑线在a上的情况\n\t\t\t\t\t\tvar aNode;\n\t\t\t\t\t\tif (tagName == 'span' && attrs.style && /text\\-decoration/.test(attrs.style) && (aNode = domUtils.findParentByTagName(elm, 'a', true))) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(aNode, attrs);\n\t\t\t\t\t\t\tdomUtils.remove(elm, true);\n\t\t\t\t\t\t\telm = aNode;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.mergeSibling(elm);\n\t\t\t\t\t\t\tdomUtils.clearEmptySibling(elm);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//去除子节点相同的\n\t\t\t\t\t\tdomUtils.mergeChild(elm, attrs);\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(elm, false, filterFn);\n\t\t\t\t\t\tdomUtils.mergeToParent(elm);\n\t\t\t\t\t\tif (node === end) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 移除当前选区内指定的inline标签，但保留其中的内容\n\t\t\t * @method removeInlineStyle\n\t\t\t * @param { String } tagName 需要移除的标签名\n\t\t\t * @return { UE.dom.Range } 当前的range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * xx[x<span>xxx<em>yyy</em>zz]z</span>  => range.removeInlineStyle([\"em\"])  => xx[x<span>xxxyyyzz]z</span>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 移除当前选区内指定的一组inline标签，但保留其中的内容\n\t\t\t * @method removeInlineStyle\n\t\t\t * @param { Array } tagNameArr 需要移除的标签名的数组\n\t\t\t * @return { UE.dom.Range } 当前的range对象\n\t\t\t * @see UE.dom.Range:removeInlineStyle(String)\n\t\t\t */\n\t\t\tremoveInlineStyle: function(tagNames) {\n\t\t\t\tif (this.collapsed) return this;\n\t\t\t\ttagNames = utils.isArray(tagNames) ? tagNames : [tagNames];\n\t\t\t\tthis.shrinkBoundary().adjustmentBoundary();\n\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\tend = this.endContainer;\n\t\t\t\twhile (1) {\n\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\tif (utils.indexOf(tagNames, start.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (start.tagName.toLowerCase() == 'body') {\n\t\t\t\t\t\t\tstart = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t}\n\t\t\t\twhile (1) {\n\t\t\t\t\tif (end.nodeType == 1) {\n\t\t\t\t\t\tif (utils.indexOf(tagNames, end.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (end.tagName.toLowerCase() == 'body') {\n\t\t\t\t\t\t\tend = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tend = end.parentNode;\n\t\t\t\t}\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tfrag,\n\t\t\t\t\ttmpRange;\n\t\t\t\tif (start) {\n\t\t\t\t\ttmpRange = this.cloneRange().setEndBefore(bookmark.start).setStartBefore(start);\n\t\t\t\t\tfrag = tmpRange.extractContents();\n\t\t\t\t\ttmpRange.insertNode(frag);\n\t\t\t\t\tdomUtils.clearEmptySibling(start, true);\n\t\t\t\t\tstart.parentNode.insertBefore(bookmark.start, start);\n\t\t\t\t}\n\t\t\t\tif (end) {\n\t\t\t\t\ttmpRange = this.cloneRange().setStartAfter(bookmark.end).setEndAfter(end);\n\t\t\t\t\tfrag = tmpRange.extractContents();\n\t\t\t\t\ttmpRange.insertNode(frag);\n\t\t\t\t\tdomUtils.clearEmptySibling(end, false, true);\n\t\t\t\t\tend.parentNode.insertBefore(bookmark.end, end.nextSibling);\n\t\t\t\t}\n\t\t\t\tvar current = domUtils.getNextDomNode(bookmark.start, false, function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t}),\n\t\t\t\t\tnext;\n\t\t\t\twhile (current && current !== bookmark.end) {\n\t\t\t\t\tnext = domUtils.getNextDomNode(current, true, function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t});\n\t\t\t\t\tif (utils.indexOf(tagNames, current.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = next;\n\t\t\t\t}\n\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前选中的自闭合的节点\n\t\t\t * @method  getClosedNode\n\t\t\t * @return { Node | NULL } 如果当前选中的是自闭合节点， 则返回该节点， 否则返回NULL\n\t\t\t */\n\t\t\tgetClosedNode: function() {\n\t\t\t\tvar node;\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\tvar range = this.cloneRange().adjustmentBoundary().shrinkBoundary();\n\t\t\t\t\tif (selectOneNode(range)) {\n\t\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset];\n\t\t\t\t\t\tif (child && child.nodeType == 1 && (dtd.$empty[child.tagName] || dtd.$nonChild[child.tagName])) {\n\t\t\t\t\t\t\tnode = child;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在页面上高亮range所表示的选区\n\t\t\t * @method select\n\t\t\t * @return { UE.dom.Range } 返回当前Range对象\n\t\t\t */\n\t\t\t//这里不区分ie9以上，trace:3824\n\t\t\tselect: browser.ie ? function(noFillData, textRange) {\n\t\t\t\tvar nativeRange;\n\t\t\t\tif (!this.collapsed)\n\t\t\t\t\tthis.shrinkBoundary();\n\t\t\t\tvar node = this.getClosedNode();\n\t\t\t\tif (node && !textRange) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tnativeRange = this.document.body.createControlRange();\n\t\t\t\t\t\tnativeRange.addElement(node);\n\t\t\t\t\t\tnativeRange.select();\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tstart = bookmark.start,\n\t\t\t\t\tend;\n\t\t\t\tnativeRange = this.document.body.createTextRange();\n\t\t\t\tnativeRange.moveToElementText(start);\n\t\t\t\tnativeRange.moveStart('character', 1);\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\tvar nativeRangeEnd = this.document.body.createTextRange();\n\t\t\t\t\tend = bookmark.end;\n\t\t\t\t\tnativeRangeEnd.moveToElementText(end);\n\t\t\t\t\tnativeRange.setEndPoint('EndToEnd', nativeRangeEnd);\n\t\t\t\t} else {\n\t\t\t\t\tif (!noFillData && this.startContainer.nodeType != 3) {\n\t\t\t\t\t\t//使用<span>|x<span>固定住光标\n\t\t\t\t\t\tvar tmpText = this.document.createTextNode(fillChar),\n\t\t\t\t\t\t\ttmp = this.document.createElement('span');\n\t\t\t\t\t\ttmp.appendChild(this.document.createTextNode(fillChar));\n\t\t\t\t\t\tstart.parentNode.insertBefore(tmp, start);\n\t\t\t\t\t\tstart.parentNode.insertBefore(tmpText, start);\n\t\t\t\t\t\t//当点b,i,u时，不能清除i上边的b\n\t\t\t\t\t\tremoveFillData(this.document, tmpText);\n\t\t\t\t\t\tfillData = tmpText;\n\t\t\t\t\t\tmergeSibling(tmp, 'previousSibling');\n\t\t\t\t\t\tmergeSibling(start, 'nextSibling');\n\t\t\t\t\t\tnativeRange.moveStart('character', -1);\n\t\t\t\t\t\tnativeRange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.moveToBookmark(bookmark);\n\t\t\t\ttmp && domUtils.remove(tmp);\n\t\t\t\t//IE在隐藏状态下不支持range操作，catch一下\n\t\t\t\ttry {\n\t\t\t\t\tnativeRange.select();\n\t\t\t\t} catch (e) {}\n\t\t\t\treturn this;\n\t\t\t} : function(notInsertFillData) {\n\t\t\t\tfunction checkOffset(rng) {\n\n\t\t\t\t\tfunction check(node, offset, dir) {\n\t\t\t\t\t\tif (node.nodeType == 3 && node.nodeValue.length < offset) {\n\t\t\t\t\t\t\trng[dir + 'Offset'] = node.nodeValue.length\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcheck(rng.startContainer, rng.startOffset, 'start');\n\t\t\t\t\tcheck(rng.endContainer, rng.endOffset, 'end');\n\t\t\t\t}\n\t\t\t\tvar win = domUtils.getWindow(this.document),\n\t\t\t\t\tsel = win.getSelection(),\n\t\t\t\t\ttxtNode;\n\t\t\t\t//FF下关闭自动长高时滚动条在关闭dialog时会跳\n\t\t\t\t//ff下如果不body.focus将不能定位闭合光标到编辑器内\n\t\t\t\tbrowser.gecko ? this.document.body.focus() : win.focus();\n\t\t\t\tif (sel) {\n\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t// trace:870 chrome/safari后边是br对于闭合得range不能定位 所以去掉了判断\n\t\t\t\t\t// this.startContainer.nodeType != 3 &&! ((child = this.startContainer.childNodes[this.startOffset]) && child.nodeType == 1 && child.tagName == 'BR'\n\t\t\t\t\tif (this.collapsed && !notInsertFillData) {\n\t\t\t\t\t\t//                    //opear如果没有节点接着，原生的不能够定位,不能在body的第一级插入空白节点\n\t\t\t\t\t\t//                    if (notInsertFillData && browser.opera && !domUtils.isBody(this.startContainer) && this.startContainer.nodeType == 1) {\n\t\t\t\t\t\t//                        var tmp = this.document.createTextNode('');\n\t\t\t\t\t\t//                        this.insertNode(tmp).setStart(tmp, 0).collapse(true);\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//处理光标落在文本节点的情况\n\t\t\t\t\t\t//处理以下的情况\n\t\t\t\t\t\t//<b>|xxxx</b>\n\t\t\t\t\t\t//<b>xxxx</b>|xxxx\n\t\t\t\t\t\t//xxxx<b>|</b>\n\t\t\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\t\t\tchild = start;\n\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\tchild = start.childNodes[this.startOffset];\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!(start.nodeType == 3 && this.startOffset) &&\n\t\t\t\t\t\t\t(child ?\n\t\t\t\t\t\t\t\t(!child.previousSibling || child.previousSibling.nodeType != 3) :\n\t\t\t\t\t\t\t\t(!start.lastChild || start.lastChild.nodeType != 3)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\ttxtNode = this.document.createTextNode(fillChar);\n\t\t\t\t\t\t\t//跟着前边走\n\t\t\t\t\t\t\tthis.insertNode(txtNode);\n\t\t\t\t\t\t\tremoveFillData(this.document, txtNode);\n\t\t\t\t\t\t\tmergeSibling(txtNode, 'previousSibling');\n\t\t\t\t\t\t\tmergeSibling(txtNode, 'nextSibling');\n\t\t\t\t\t\t\tfillData = txtNode;\n\t\t\t\t\t\t\tthis.setStart(txtNode, browser.webkit ? 1 : 0).collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar nativeRange = this.document.createRange();\n\t\t\t\t\tif (this.collapsed && browser.opera && this.startContainer.nodeType == 1) {\n\t\t\t\t\t\tvar child = this.startContainer.childNodes[this.startOffset];\n\t\t\t\t\t\tif (!child) {\n\t\t\t\t\t\t\t//往前靠拢\n\t\t\t\t\t\t\tchild = this.startContainer.lastChild;\n\t\t\t\t\t\t\tif (child && domUtils.isBr(child)) {\n\t\t\t\t\t\t\t\tthis.setStartBefore(child).collapse(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//向后靠拢\n\t\t\t\t\t\t\twhile (child && domUtils.isBlockElm(child)) {\n\t\t\t\t\t\t\t\tif (child.nodeType == 1 && child.childNodes[0]) {\n\t\t\t\t\t\t\t\t\tchild = child.childNodes[0]\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchild && this.setStartBefore(child).collapse(true)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\t//是createAddress最后一位算的不准，现在这里进行微调\n\t\t\t\t\tcheckOffset(this);\n\t\t\t\t\tnativeRange.setStart(this.startContainer, this.startOffset);\n\t\t\t\t\tnativeRange.setEnd(this.endContainer, this.endOffset);\n\t\t\t\t\tsel.addRange(nativeRange);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 滚动到当前range开始的位置\n\t\t\t * @method scrollToView\n\t\t\t * @param { Window } win 当前range对象所属的window对象\n\t\t\t * @return { UE.dom.Range } 当前Range对象\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 滚动到距离当前range开始位置 offset 的位置处\n\t\t\t * @method scrollToView\n\t\t\t * @param { Window } win 当前range对象所属的window对象\n\t\t\t * @param { Number } offset 距离range开始位置处的偏移量， 如果为正数， 则向下偏移， 反之， 则向上偏移\n\t\t\t * @return { UE.dom.Range } 当前Range对象\n\t\t\t */\n\t\t\tscrollToView: function(win, offset) {\n\t\t\t\twin = win ? window : domUtils.getWindow(this.document);\n\t\t\t\tvar me = this,\n\t\t\t\t\tspan = me.document.createElement('span');\n\t\t\t\t//trace:717\n\t\t\t\tspan.innerHTML = '&nbsp;';\n\t\t\t\tme.cloneRange().insertNode(span);\n\t\t\t\tdomUtils.scrollToView(span, win, offset);\n\t\t\t\tdomUtils.remove(span);\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 判断当前选区内容是否占位符\n\t\t\t * @private\n\t\t\t * @method inFillChar\n\t\t\t * @return { Boolean } 如果是占位符返回true，否则返回false\n\t\t\t */\n\t\t\tinFillChar: function() {\n\t\t\t\tvar start = this.startContainer;\n\t\t\t\tif (this.collapsed && start.nodeType == 3 && start.nodeValue.replace(new RegExp('^' + domUtils.fillChar), '').length + 1 == start.nodeValue.length) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 保存\n\t\t\t * @method createAddress\n\t\t\t * @private\n\t\t\t * @return { Boolean } 返回开始和结束的位置\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *     <p>\n\t\t\t *         aaaa\n\t\t\t *         <em>\n\t\t\t *             <!-- 选区开始 -->\n\t\t\t *             bbbb\n\t\t\t *             <!-- 选区结束 -->\n\t\t\t *         </em>\n\t\t\t *     </p>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *         //output: {startAddress:[0,1,0,0],endAddress:[0,1,0,4]}\n\t\t\t *         console.log( range.createAddress() );\n\t\t\t *     </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tcreateAddress: function(ignoreEnd, ignoreTxt) {\n\t\t\t\tvar addr = {},\n\t\t\t\t\tme = this;\n\n\t\t\t\tfunction getAddress(isStart) {\n\t\t\t\t\tvar node = isStart ? me.startContainer : me.endContainer;\n\t\t\t\t\tvar parents = domUtils.findParents(node, true, function(node) {\n\t\t\t\t\t\t\treturn !domUtils.isBody(node)\n\t\t\t\t\t\t}),\n\t\t\t\t\t\taddrs = [];\n\t\t\t\t\tfor (var i = 0, ci; ci = parents[i++];) {\n\t\t\t\t\t\taddrs.push(domUtils.getNodeIndex(ci, ignoreTxt));\n\t\t\t\t\t}\n\t\t\t\t\tvar firstIndex = 0;\n\n\t\t\t\t\tif (ignoreTxt) {\n\t\t\t\t\t\tif (node.nodeType == 3) {\n\t\t\t\t\t\t\tvar tmpNode = node.previousSibling;\n\t\t\t\t\t\t\twhile (tmpNode && tmpNode.nodeType == 3) {\n\t\t\t\t\t\t\t\tfirstIndex += tmpNode.nodeValue.replace(fillCharReg, '').length;\n\t\t\t\t\t\t\t\ttmpNode = tmpNode.previousSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfirstIndex += (isStart ? me.startOffset : me.endOffset) // - (fillCharReg.test(node.nodeValue) ? 1 : 0 )\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode = node.childNodes[isStart ? me.startOffset : me.endOffset];\n\t\t\t\t\t\t\tif (node) {\n\t\t\t\t\t\t\t\tfirstIndex = domUtils.getNodeIndex(node, ignoreTxt);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnode = isStart ? me.startContainer : me.endContainer;\n\t\t\t\t\t\t\t\tvar first = node.firstChild;\n\t\t\t\t\t\t\t\twhile (first) {\n\t\t\t\t\t\t\t\t\tif (domUtils.isFillChar(first)) {\n\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfirstIndex++;\n\t\t\t\t\t\t\t\t\tif (first.nodeType == 3) {\n\t\t\t\t\t\t\t\t\t\twhile (first && first.nodeType == 3) {\n\t\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfirstIndex = isStart ? domUtils.isFillChar(node) ? 0 : me.startOffset : me.endOffset\n\t\t\t\t\t}\n\t\t\t\t\tif (firstIndex < 0) {\n\t\t\t\t\t\tfirstIndex = 0;\n\t\t\t\t\t}\n\t\t\t\t\taddrs.push(firstIndex);\n\t\t\t\t\treturn addrs;\n\t\t\t\t}\n\t\t\t\taddr.startAddress = getAddress(true);\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\taddr.endAddress = me.collapsed ? [].concat(addr.startAddress) : getAddress();\n\t\t\t\t}\n\t\t\t\treturn addr;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 保存\n\t\t\t * @method createAddress\n\t\t\t * @private\n\t\t\t * @return { Boolean } 返回开始和结束的位置\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *     <p>\n\t\t\t *         aaaa\n\t\t\t *         <em>\n\t\t\t *             <!-- 选区开始 -->\n\t\t\t *             bbbb\n\t\t\t *             <!-- 选区结束 -->\n\t\t\t *         </em>\n\t\t\t *     </p>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *         var range = editor.selection.getRange();\n\t\t\t *         range.moveToAddress({startAddress:[0,1,0,0],endAddress:[0,1,0,4]});\n\t\t\t *         range.select();\n\t\t\t *         //output: 'bbbb'\n\t\t\t *         console.log(editor.selection.getText());\n\t\t\t *     </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tmoveToAddress: function(addr, ignoreEnd) {\n\t\t\t\tvar me = this;\n\n\t\t\t\tfunction getNode(address, isStart) {\n\t\t\t\t\tvar tmpNode = me.document.body,\n\t\t\t\t\t\tparentNode, offset;\n\t\t\t\t\tfor (var i = 0, ci, l = address.length; i < l; i++) {\n\t\t\t\t\t\tci = address[i];\n\t\t\t\t\t\tparentNode = tmpNode;\n\t\t\t\t\t\ttmpNode = tmpNode.childNodes[ci];\n\t\t\t\t\t\tif (!tmpNode) {\n\t\t\t\t\t\t\toffset = ci;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (isStart) {\n\t\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\t\tme.setStartBefore(tmpNode)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.setStart(parentNode, offset)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\t\tme.setEndBefore(tmpNode)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.setEnd(parentNode, offset)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgetNode(addr.startAddress, true);\n\t\t\t\t!ignoreEnd && addr.endAddress && getNode(addr.endAddress);\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 判断给定的Range对象是否和当前Range对象表示的是同一个选区\n\t\t\t * @method equals\n\t\t\t * @param { UE.dom.Range } 需要判断的Range对象\n\t\t\t * @return { Boolean } 如果给定的Range对象与当前Range对象表示的是同一个选区， 则返回true， 否则返回false\n\t\t\t */\n\t\t\tequals: function(rng) {\n\t\t\t\tfor (var p in this) {\n\t\t\t\t\tif (this.hasOwnProperty(p)) {\n\t\t\t\t\t\tif (this[p] !== rng[p])\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 遍历range内的节点。每当遍历一个节点时， 都会执行参数项 doFn 指定的函数， 该函数的接受当前遍历的节点\n\t\t\t * 作为其参数。\n\t\t\t * @method traversal\n\t\t\t * @param { Function }  doFn 对每个遍历的节点要执行的方法， 该方法接受当前遍历的节点作为其参数\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区开始 -->\n\t\t\t *     <span></span>\n\t\t\t *     <a></a>\n\t\t\t *     <!-- 选区结束 -->\n\t\t\t * </body>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: <span></span><a></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t *     range.traversal( function ( node ) {\n\t\t\t *\n\t\t\t *         if ( node.nodeType === 1 ) {\n\t\t\t *             node.className = \"test\";\n\t\t\t *         }\n\t\t\t *\n\t\t\t *     } );\n\t\t\t *\n\t\t\t *     //output: <span class=\"test\"></span><a class=\"test\"></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 遍历range内的节点。\n\t\t\t * 每当遍历一个节点时， 都会执行参数项 doFn 指定的函数， 该函数的接受当前遍历的节点\n\t\t\t * 作为其参数。\n\t\t\t * 可以通过参数项 filterFn 来指定一个过滤器， 只有符合该过滤器过滤规则的节点才会触\n\t\t\t * 发doFn函数的执行\n\t\t\t * @method traversal\n\t\t\t * @param { Function } doFn 对每个遍历的节点要执行的方法， 该方法接受当前遍历的节点作为其参数\n\t\t\t * @param { Function } filterFn 过滤器， 该函数接受当前遍历的节点作为参数， 如果该节点满足过滤\n\t\t\t *                      规则， 请返回true， 该节点会触发doFn， 否则， 请返回false， 则该节点不\n\t\t\t *                      会触发doFn。\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:traversal(Function)\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区开始 -->\n\t\t\t *     <span></span>\n\t\t\t *     <a></a>\n\t\t\t *     <!-- 选区结束 -->\n\t\t\t * </body>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: <span></span><a></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t *     range.traversal( function ( node ) {\n\t\t\t *\n\t\t\t *         node.className = \"test\";\n\t\t\t *\n\t\t\t *     }, function ( node ) {\n\t\t\t *          return node.nodeType === 1;\n\t\t\t *     } );\n\t\t\t *\n\t\t\t *     //output: <span class=\"test\"></span><a class=\"test\"></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\ttraversal: function(doFn, filterFn) {\n\t\t\t\tif (this.collapsed)\n\t\t\t\t\treturn this;\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tend = bookmark.end,\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark.start, false, filterFn);\n\t\t\t\twhile (current && current !== end && (domUtils.getPosition(current, end) & domUtils.POSITION_PRECEDING)) {\n\t\t\t\t\tvar tmpNode = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\tdoFn(current);\n\t\t\t\t\tcurrent = tmpNode;\n\t\t\t\t}\n\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t}\n\t\t};\n\t})();\n\n\t// core/Selection.js\n\t/**\n\t * 选集\n\t * @file\n\t * @module UE.dom\n\t * @class Selection\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 选区集合\n\t * @unfile\n\t * @module UE.dom\n\t * @class Selection\n\t */\n\t(function() {\n\n\t\tfunction getBoundaryInformation(range, start) {\n\t\t\tvar getIndex = domUtils.getNodeIndex;\n\t\t\trange = range.duplicate();\n\t\t\trange.collapse(start);\n\t\t\tvar parent = range.parentElement();\n\t\t\t//如果节点里没有子节点，直接退出\n\t\t\tif (!parent.hasChildNodes()) {\n\t\t\t\treturn {\n\t\t\t\t\tcontainer: parent,\n\t\t\t\t\toffset: 0\n\t\t\t\t};\n\t\t\t}\n\t\t\tvar siblings = parent.children,\n\t\t\t\tchild,\n\t\t\t\ttestRange = range.duplicate(),\n\t\t\t\tstartIndex = 0,\n\t\t\t\tendIndex = siblings.length - 1,\n\t\t\t\tindex = -1,\n\t\t\t\tdistance;\n\t\t\twhile (startIndex <= endIndex) {\n\t\t\t\tindex = Math.floor((startIndex + endIndex) / 2);\n\t\t\t\tchild = siblings[index];\n\t\t\t\ttestRange.moveToElementText(child);\n\t\t\t\tvar position = testRange.compareEndPoints('StartToStart', range);\n\t\t\t\tif (position > 0) {\n\t\t\t\t\tendIndex = index - 1;\n\t\t\t\t} else if (position < 0) {\n\t\t\t\t\tstartIndex = index + 1;\n\t\t\t\t} else {\n\t\t\t\t\t//trace:1043\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\toffset: getIndex(child)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index == -1) {\n\t\t\t\ttestRange.moveToElementText(parent);\n\t\t\t\ttestRange.setEndPoint('StartToStart', range);\n\t\t\t\tdistance = testRange.text.replace(/(\\r\\n|\\r)/g, '\\n').length;\n\t\t\t\tsiblings = parent.childNodes;\n\t\t\t\tif (!distance) {\n\t\t\t\t\tchild = siblings[siblings.length - 1];\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: child,\n\t\t\t\t\t\toffset: child.nodeValue.length\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tvar i = siblings.length;\n\t\t\t\twhile (distance > 0) {\n\t\t\t\t\tdistance -= siblings[--i].nodeValue.length;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tcontainer: siblings[i],\n\t\t\t\t\toffset: -distance\n\t\t\t\t};\n\t\t\t}\n\t\t\ttestRange.collapse(position > 0);\n\t\t\ttestRange.setEndPoint(position > 0 ? 'StartToStart' : 'EndToStart', range);\n\t\t\tdistance = testRange.text.replace(/(\\r\\n|\\r)/g, '\\n').length;\n\t\t\tif (!distance) {\n\t\t\t\treturn dtd.$empty[child.tagName] || dtd.$nonChild[child.tagName] ? {\n\t\t\t\t\tcontainer: parent,\n\t\t\t\t\toffset: getIndex(child) + (position > 0 ? 0 : 1)\n\t\t\t\t} : {\n\t\t\t\t\tcontainer: child,\n\t\t\t\t\toffset: position > 0 ? 0 : child.childNodes.length\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (distance > 0) {\n\t\t\t\ttry {\n\t\t\t\t\tvar pre = child;\n\t\t\t\t\tchild = child[position > 0 ? 'previousSibling' : 'nextSibling'];\n\t\t\t\t\tdistance -= child.nodeValue.length;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\toffset: getIndex(pre)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcontainer: child,\n\t\t\t\toffset: position > 0 ? -distance : child.nodeValue.length + distance\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 将ieRange转换为Range对象\n\t\t * @param {Range}   ieRange    ieRange对象\n\t\t * @param {Range}   range      Range对象\n\t\t * @return  {Range}  range       返回转换后的Range对象\n\t\t */\n\t\tfunction transformIERangeToRange(ieRange, range) {\n\t\t\tif (ieRange.item) {\n\t\t\t\trange.selectNode(ieRange.item(0));\n\t\t\t} else {\n\t\t\t\tvar bi = getBoundaryInformation(ieRange, true);\n\t\t\t\trange.setStart(bi.container, bi.offset);\n\t\t\t\tif (ieRange.compareEndPoints('StartToEnd', ieRange) != 0) {\n\t\t\t\t\tbi = getBoundaryInformation(ieRange, false);\n\t\t\t\t\trange.setEnd(bi.container, bi.offset);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn range;\n\t\t}\n\n\t\t/**\n\t\t * 获得ieRange\n\t\t * @param {Selection} sel    Selection对象\n\t\t * @return {ieRange}    得到ieRange\n\t\t */\n\t\tfunction _getIERange(sel) {\n\t\t\tvar ieRange;\n\t\t\t//ie下有可能报错\n\t\t\ttry {\n\t\t\t\tieRange = sel.getNative().createRange();\n\t\t\t} catch (e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar el = ieRange.item ? ieRange.item(0) : ieRange.parentElement();\n\t\t\tif ((el.ownerDocument || el) === sel.document) {\n\t\t\t\treturn ieRange;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tvar Selection = dom.Selection = function(doc) {\n\t\t\tvar me = this,\n\t\t\t\tiframe;\n\t\t\tme.document = doc;\n\t\t\tif (browser.ie9below) {\n\t\t\t\tiframe = domUtils.getWindow(doc).frameElement;\n\t\t\t\tdomUtils.on(iframe, 'beforedeactivate', function() {\n\t\t\t\t\tme._bakIERange = me.getIERange();\n\t\t\t\t});\n\t\t\t\tdomUtils.on(iframe, 'activate', function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_getIERange(me) && me._bakIERange) {\n\t\t\t\t\t\t\tme._bakIERange.select();\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (ex) {}\n\t\t\t\t\tme._bakIERange = null;\n\t\t\t\t});\n\t\t\t}\n\t\t\tiframe = doc = null;\n\t\t};\n\n\t\tSelection.prototype = {\n\n\t\t\trangeInBody: function(rng, txtRange) {\n\t\t\t\tvar node = browser.ie9below || txtRange ? rng.item ? rng.item() : rng.parentElement() : rng.startContainer;\n\n\t\t\t\treturn node === this.document.body || domUtils.inDoc(node, this.document);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取原生seleciton对象\n\t\t\t * @method getNative\n\t\t\t * @return { Object } 获得selection对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getNative();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetNative: function() {\n\t\t\t\tvar doc = this.document;\n\t\t\t\ttry {\n\t\t\t\t\treturn !doc ? null : browser.ie9below ? doc.selection : domUtils.getWindow(doc).getSelection();\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获得ieRange\n\t\t\t * @method getIERange\n\t\t\t * @return { Object } 返回ie原生的Range\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getIERange();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetIERange: function() {\n\t\t\t\tvar ieRange = _getIERange(this);\n\t\t\t\tif (!ieRange) {\n\t\t\t\t\tif (this._bakIERange) {\n\t\t\t\t\t\treturn this._bakIERange;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn ieRange;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 缓存当前选区的range和选区的开始节点\n\t\t\t * @method cache\n\t\t\t */\n\t\t\tcache: function() {\n\t\t\t\tthis.clear();\n\t\t\t\tthis._cachedRange = this.getRange();\n\t\t\t\tthis._cachedStartElement = this.getStart();\n\t\t\t\tthis._cachedStartElementPath = this.getStartElementPath();\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取选区开始位置的父节点到body\n\t\t\t * @method getStartElementPath\n\t\t\t * @return { Array } 返回父节点集合\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getStartElementPath();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetStartElementPath: function() {\n\t\t\t\tif (this._cachedStartElementPath) {\n\t\t\t\t\treturn this._cachedStartElementPath;\n\t\t\t\t}\n\t\t\t\tvar start = this.getStart();\n\t\t\t\tif (start) {\n\t\t\t\t\treturn domUtils.findParents(start, true, null, true)\n\t\t\t\t}\n\t\t\t\treturn [];\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 清空缓存\n\t\t\t * @method clear\n\t\t\t */\n\t\t\tclear: function() {\n\t\t\t\tthis._cachedStartElementPath = this._cachedRange = this._cachedStartElement = null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 编辑器是否得到了选区\n\t\t\t * @method isFocus\n\t\t\t */\n\t\t\tisFocus: function() {\n\t\t\t\ttry {\n\t\t\t\t\tif (browser.ie9below) {\n\n\t\t\t\t\t\tvar nativeRange = _getIERange(this);\n\t\t\t\t\t\treturn !!(nativeRange && this.rangeInBody(nativeRange));\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn !!this.getNative().rangeCount;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取选区对应的Range\n\t\t\t * @method getRange\n\t\t\t * @return { Object } 得到Range对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getRange();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetRange: function() {\n\t\t\t\tvar me = this;\n\n\t\t\t\tfunction optimze(range) {\n\t\t\t\t\tvar child = me.document.body.firstChild,\n\t\t\t\t\t\tcollapsed = range.collapsed;\n\t\t\t\t\twhile (child && child.firstChild) {\n\t\t\t\t\t\trange.setStart(child, 0);\n\t\t\t\t\t\tchild = child.firstChild;\n\t\t\t\t\t}\n\t\t\t\t\tif (!range.startContainer) {\n\t\t\t\t\t\trange.setStart(me.document.body, 0)\n\t\t\t\t\t}\n\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (me._cachedRange != null) {\n\t\t\t\t\treturn this._cachedRange;\n\t\t\t\t}\n\t\t\t\tvar range = new baidu.editor.dom.Range(me.document);\n\n\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\tvar nativeRange = me.getIERange();\n\t\t\t\t\tif (nativeRange) {\n\t\t\t\t\t\t//备份的_bakIERange可能已经实效了，dom树发生了变化比如从源码模式切回来，所以try一下，实效就放到body开始位置\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\ttransformIERangeToRange(nativeRange, range);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar sel = me.getNative();\n\t\t\t\t\tif (sel && sel.rangeCount) {\n\t\t\t\t\t\tvar firstRange = sel.getRangeAt(0);\n\t\t\t\t\t\tvar lastRange = sel.getRangeAt(sel.rangeCount - 1);\n\t\t\t\t\t\trange.setStart(firstRange.startContainer, firstRange.startOffset).setEnd(lastRange.endContainer, lastRange.endOffset);\n\t\t\t\t\t\tif (range.collapsed && domUtils.isBody(range.startContainer) && !range.startOffset) {\n\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//trace:1734 有可能已经不在dom树上了，标识的节点\n\t\t\t\t\t\tif (this._bakRange && domUtils.inDoc(this._bakRange.startContainer, this.document)) {\n\t\t\t\t\t\t\treturn this._bakRange;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this._bakRange = range;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取开始元素，用于状态反射\n\t\t\t * @method getStart\n\t\t\t * @return { Element } 获得开始元素\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getStart();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetStart: function() {\n\t\t\t\tif (this._cachedStartElement) {\n\t\t\t\t\treturn this._cachedStartElement;\n\t\t\t\t}\n\t\t\t\tvar range = browser.ie9below ? this.getIERange() : this.getRange(),\n\t\t\t\t\ttmpRange,\n\t\t\t\t\tstart, tmp, parent;\n\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\tif (!range) {\n\t\t\t\t\t\t//todo 给第一个值可能会有问题\n\t\t\t\t\t\treturn this.document.body.firstChild;\n\t\t\t\t\t}\n\t\t\t\t\t//control元素\n\t\t\t\t\tif (range.item) {\n\t\t\t\t\t\treturn range.item(0);\n\t\t\t\t\t}\n\t\t\t\t\ttmpRange = range.duplicate();\n\t\t\t\t\t//修正ie下<b>x</b>[xx] 闭合后 <b>x|</b>xx\n\t\t\t\t\ttmpRange.text.length > 0 && tmpRange.moveStart('character', 1);\n\t\t\t\t\ttmpRange.collapse(1);\n\t\t\t\t\tstart = tmpRange.parentElement();\n\t\t\t\t\tparent = tmp = range.parentElement();\n\t\t\t\t\twhile (tmp = tmp.parentNode) {\n\t\t\t\t\t\tif (tmp == start) {\n\t\t\t\t\t\t\tstart = parent;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trange.shrinkBoundary();\n\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\tif (start.nodeType == 1 && start.hasChildNodes()) {\n\t\t\t\t\t\tstart = start.childNodes[Math.min(start.childNodes.length - 1, range.startOffset)];\n\t\t\t\t\t}\n\t\t\t\t\tif (start.nodeType == 3) {\n\t\t\t\t\t\treturn start.parentNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn start;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 得到选区中的文本\n\t\t\t * @method getText\n\t\t\t * @return { String } 选区中包含的文本\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getText();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetText: function() {\n\t\t\t\tvar nativeSel, nativeRange;\n\t\t\t\tif (this.isFocus() && (nativeSel = this.getNative())) {\n\t\t\t\t\tnativeRange = browser.ie9below ? nativeSel.createRange() : nativeSel.getRangeAt(0);\n\t\t\t\t\treturn browser.ie9below ? nativeRange.text : nativeRange.toString();\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 清除选区\n\t\t\t * @method clearRange\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.clearRange();\n\t\t\t * ```\n\t\t\t */\n\t\t\tclearRange: function() {\n\t\t\t\tthis.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t}\n\t\t};\n\t})();\n\n\t// core/Editor.js\n\t/**\n\t * 编辑器主类，包含编辑器提供的大部分公用接口\n\t * @file\n\t * @module UE\n\t * @class Editor\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t/**\n\t * UEditor的核心类，为用户提供与编辑器交互的接口。\n\t * @unfile\n\t * @module UE\n\t * @class Editor\n\t */\n\n\t(function() {\n\t\tvar uid = 0,\n\t\t\t_selectionChangeTimer;\n\n\t\t/**\n\t\t * 获取编辑器的html内容，赋值到编辑器所在表单的textarea文本域里面\n\t\t * @private\n\t\t * @method setValue\n\t\t * @param { UE.Editor } editor 编辑器事例\n\t\t */\n\t\tfunction setValue(form, editor) {\n\t\t\tvar textarea;\n\t\t\tif (editor.textarea) {\n\t\t\t\tif (utils.isString(editor.textarea)) {\n\t\t\t\t\tfor (var i = 0, ti, tis = domUtils.getElementsByTagName(form, 'textarea'); ti = tis[i++];) {\n\t\t\t\t\t\tif (ti.id == 'ueditor_textarea_' + editor.options.textarea) {\n\t\t\t\t\t\t\ttextarea = ti;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttextarea = editor.textarea;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!textarea) {\n\t\t\t\tform.appendChild(textarea = domUtils.createElement(document, 'textarea', {\n\t\t\t\t\t'name': editor.options.textarea,\n\t\t\t\t\t'id': 'ueditor_textarea_' + editor.options.textarea,\n\t\t\t\t\t'style': \"display:none\"\n\t\t\t\t}));\n\t\t\t\t//不要产生多个textarea\n\t\t\t\teditor.textarea = textarea;\n\t\t\t}!textarea.getAttribute('name') && textarea.setAttribute('name', editor.options.textarea);\n\t\t\ttextarea.value = editor.hasContents() ?\n\t\t\t\t(editor.options.allHtmlEnabled ? editor.getAllHtml() : editor.getContent(null, null, true)) :\n\t\t\t\t''\n\t\t}\n\n\t\tfunction loadPlugins(me) {\n\t\t\t//初始化插件\n\t\t\tfor (var pi in UE.plugins) {\n\t\t\t\tUE.plugins[pi].call(me);\n\t\t\t}\n\n\t\t}\n\n\t\tfunction checkCurLang(I18N) {\n\t\t\tfor (var lang in I18N) {\n\t\t\t\treturn lang\n\t\t\t}\n\t\t}\n\n\t\tfunction langReadied(me) {\n\t\t\tme.langIsReady = true;\n\n\t\t\tme.fireEvent(\"langReady\");\n\t\t}\n\n\t\t/**\n\t\t * 编辑器准备就绪后会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event ready\n\t\t * @remind render方法执行完成之后,会触发该事件\n\t\t * @remind\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.addListener( 'ready', function( editor ) {\n\t\t *     editor.execCommand( 'focus' ); //编辑器家在完成后，让编辑器拿到焦点\n\t\t * } );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 执行destroy方法,会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event destroy\n\t\t * @see UE.Editor:destroy()\n\t\t */\n\t\t/**\n\t\t * 执行reset方法,会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event reset\n\t\t * @see UE.Editor:reset()\n\t\t */\n\t\t/**\n\t\t * 执行focus方法,会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event focus\n\t\t * @see UE.Editor:focus(Boolean)\n\t\t */\n\t\t/**\n\t\t * 语言加载完成会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event langReady\n\t\t */\n\t\t/**\n\t\t * 运行命令之后会触发该命令\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeExecCommand\n\t\t */\n\t\t/**\n\t\t * 运行命令之后会触发该命令\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterExecCommand\n\t\t */\n\t\t/**\n\t\t * 运行命令之前会触发该命令\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event firstBeforeExecCommand\n\t\t */\n\t\t/**\n\t\t * 在getContent方法执行之前会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeGetContent\n\t\t * @see UE.Editor:getContent()\n\t\t */\n\t\t/**\n\t\t * 在getContent方法执行之后会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterGetContent\n\t\t * @see UE.Editor:getContent()\n\t\t */\n\t\t/**\n\t\t * 在getAllHtml方法执行时会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event getAllHtml\n\t\t * @see UE.Editor:getAllHtml()\n\t\t */\n\t\t/**\n\t\t * 在setContent方法执行之前会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeSetContent\n\t\t * @see UE.Editor:setContent(String)\n\t\t */\n\t\t/**\n\t\t * 在setContent方法执行之后会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterSetContent\n\t\t * @see UE.Editor:setContent(String)\n\t\t */\n\t\t/**\n\t\t * 每当编辑器内部选区发生改变时，将触发该事件\n\t\t * @event selectionchange\n\t\t * @warning 该事件的触发非常频繁，不建议在该事件的处理过程中做重量级的处理\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.addListener( 'selectionchange', function( editor ) {\n\t\t *     console.log('选区发生改变');\n\t\t * }\n\t\t */\n\t\t/**\n\t\t * 在所有selectionchange的监听函数执行之前，会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeSelectionChange\n\t\t * @see UE.Editor:selectionchange\n\t\t */\n\t\t/**\n\t\t * 在所有selectionchange的监听函数执行完之后，会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterSelectionChange\n\t\t * @see UE.Editor:selectionchange\n\t\t */\n\t\t/**\n\t\t * 编辑器内容发生改变时会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event contentChange\n\t\t */\n\n\t\t/**\n\t\t * 以默认参数构建一个编辑器实例\n\t\t * @constructor\n\t\t * @remind 通过 改构造方法实例化的编辑器,不带ui层.需要render到一个容器,编辑器实例才能正常渲染到页面\n\t\t * @example\n\t\t * ```javascript\n\t\t * var editor = new UE.Editor();\n\t\t * editor.execCommand('blod');\n\t\t * ```\n\t\t * @see UE.Config\n\t\t */\n\n\t\t/**\n\t\t * 以给定的参数集合创建一个编辑器实例，对于未指定的参数，将应用默认参数。\n\t\t * @constructor\n\t\t * @remind 通过 改构造方法实例化的编辑器,不带ui层.需要render到一个容器,编辑器实例才能正常渲染到页面\n\t\t * @param { Object } setting 创建编辑器的参数\n\t\t * @example\n\t\t * ```javascript\n\t\t * var editor = new UE.Editor();\n\t\t * editor.execCommand('blod');\n\t\t * ```\n\t\t * @see UE.Config\n\t\t */\n\t\tvar Editor = UE.Editor = function(options) {\n\t\t\tvar me = this;\n\t\t\tme.uid = uid++;\n\t\t\tEventBase.call(me);\n\t\t\tme.commands = {};\n\t\t\tme.options = utils.extend(utils.clone(options || {}), UEDITOR_CONFIG, true);\n\t\t\tme.shortcutkeys = {};\n\t\t\tme.inputRules = [];\n\t\t\tme.outputRules = [];\n\t\t\t//设置默认的常用属性\n\t\t\tme.setOpt(Editor.defaultOptions(me));\n\n\t\t\t/* 尝试异步加载后台配置 */\n\t\t\tme.loadServerConfig();\n\n\t\t\tif (!utils.isEmptyObject(UE.I18N)) {\n\t\t\t\t//修改默认的语言类型\n\t\t\t\tme.options.lang = checkCurLang(UE.I18N);\n\t\t\t\tUE.plugin.load(me);\n\t\t\t\tlangReadied(me);\n\n\t\t\t} else {\n\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\tsrc: me.options.langPath + me.options.lang + \"/\" + me.options.lang + \".js\",\n\t\t\t\t\ttag: \"script\",\n\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t}, function() {\n\t\t\t\t\tUE.plugin.load(me);\n\t\t\t\t\tlangReadied(me);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tUE.instants['ueditorInstant' + me.uid] = me;\n\t\t};\n\t\tEditor.prototype = {\n\t\t\tregisterCommand: function(name, obj) {\n\t\t\t\tthis.commands[name] = obj;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 编辑器对外提供的监听ready事件的接口， 通过调用该方法，达到的效果与监听ready事件是一致的\n\t\t\t * @method ready\n\t\t\t * @param { Function } fn 编辑器ready之后所执行的回调, 如果在注册事件之前编辑器已经ready，将会\n\t\t\t * 立即触发该回调。\n\t\t\t * @remind 需要等待编辑器加载完成后才能执行的代码,可以使用该方法传入\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.ready( function( editor ) {\n\t\t\t *     editor.setContent('初始化完毕');\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t * @see UE.Editor.event:ready\n\t\t\t */\n\t\t\tready: function(fn) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (fn) {\n\t\t\t\t\tme.isReady ? fn.apply(me) : me.addListener('ready', fn);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 该方法是提供给插件里面使用，设置配置项默认值\n\t\t\t * @method setOpt\n\t\t\t * @warning 三处设置配置项的优先级: 实例化时传入参数 > setOpt()设置 > config文件里设置\n\t\t\t * @warning 该方法仅供编辑器插件内部和编辑器初始化时调用，其他地方不能调用。\n\t\t\t * @param { String } key 编辑器的可接受的选项名称\n\t\t\t * @param { * } val  该选项可接受的值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setOpt( 'initContent', '欢迎使用编辑器' );\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 该方法是提供给插件里面使用，以{key:value}集合的方式设置插件内用到的配置项默认值\n\t\t\t * @method setOpt\n\t\t\t * @warning 三处设置配置项的优先级: 实例化时传入参数 > setOpt()设置 > config文件里设置\n\t\t\t * @warning 该方法仅供编辑器插件内部和编辑器初始化时调用，其他地方不能调用。\n\t\t\t * @param { Object } options 将要设置的选项的键值对对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setOpt( {\n\t\t\t *     'initContent': '欢迎使用编辑器'\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetOpt: function(key, val) {\n\t\t\t\tvar obj = {};\n\t\t\t\tif (utils.isString(key)) {\n\t\t\t\t\tobj[key] = val\n\t\t\t\t} else {\n\t\t\t\t\tobj = key;\n\t\t\t\t}\n\t\t\t\tutils.extend(this.options, obj, true);\n\t\t\t},\n\t\t\tgetOpt: function(key) {\n\t\t\t\treturn this.options[key]\n\t\t\t},\n\t\t\t/**\n\t\t\t * 销毁编辑器实例，使用textarea代替\n\t\t\t * @method destroy\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.destroy();\n\t\t\t * ```\n\t\t\t */\n\t\t\tdestroy: function() {\n\n\t\t\t\tvar me = this;\n\t\t\t\tme.fireEvent('destroy');\n\t\t\t\tvar container = me.container.parentNode;\n\t\t\t\tvar textarea = me.textarea;\n\t\t\t\tif (!textarea) {\n\t\t\t\t\ttextarea = document.createElement('textarea');\n\t\t\t\t\tcontainer.parentNode.insertBefore(textarea, container);\n\t\t\t\t} else {\n\t\t\t\t\ttextarea.style.display = ''\n\t\t\t\t}\n\n\t\t\t\ttextarea.style.width = me.iframe.offsetWidth + 'px';\n\t\t\t\ttextarea.style.height = me.iframe.offsetHeight + 'px';\n\t\t\t\ttextarea.value = me.getContent();\n\t\t\t\ttextarea.id = me.key;\n\t\t\t\tcontainer.innerHTML = '';\n\t\t\t\tdomUtils.remove(container);\n\t\t\t\tvar key = me.key;\n\t\t\t\t//trace:2004\n\t\t\t\tfor (var p in me) {\n\t\t\t\t\tif (me.hasOwnProperty(p)) {\n\t\t\t\t\t\tdelete this[p];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tUE.delEditor(key);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 渲染编辑器的DOM到指定容器\n\t\t\t * @method render\n\t\t\t * @param { String } containerId 指定一个容器ID\n\t\t\t * @remind 执行该方法,会触发ready事件\n\t\t\t * @warning 必须且只能调用一次\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 渲染编辑器的DOM到指定容器\n\t\t\t * @method render\n\t\t\t * @param { Element } containerDom 直接指定容器对象\n\t\t\t * @remind 执行该方法,会触发ready事件\n\t\t\t * @warning 必须且只能调用一次\n\t\t\t */\n\t\t\trender: function(container) {\n\t\t\t\tvar me = this,\n\t\t\t\t\toptions = me.options,\n\t\t\t\t\tgetStyleValue = function(attr) {\n\t\t\t\t\t\treturn parseInt(domUtils.getComputedStyle(container, attr));\n\t\t\t\t\t};\n\t\t\t\tif (utils.isString(container)) {\n\t\t\t\t\tcontainer = document.getElementById(container);\n\t\t\t\t}\n\t\t\t\tif (container) {\n\t\t\t\t\tif (options.initialFrameWidth) {\n\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth = container.offsetWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (options.initialFrameHeight) {\n\t\t\t\t\t\toptions.minFrameHeight = options.initialFrameHeight\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions.initialFrameHeight = options.minFrameHeight = container.offsetHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontainer.style.width = /%$/.test(options.initialFrameWidth) ? '100%' : options.initialFrameWidth -\n\t\t\t\t\t\tgetStyleValue(\"padding-left\") - getStyleValue(\"padding-right\") + 'px';\n\t\t\t\t\tcontainer.style.height = /%$/.test(options.initialFrameHeight) ? '100%' : options.initialFrameHeight -\n\t\t\t\t\t\tgetStyleValue(\"padding-top\") - getStyleValue(\"padding-bottom\") + 'px';\n\n\t\t\t\t\tcontainer.style.zIndex = options.zIndex;\n\n\t\t\t\t\tvar html = (ie && browser.version < 9 ? '' : '<!DOCTYPE html>') +\n\t\t\t\t\t\t'<html xmlns=\\'http://www.w3.org/1999/xhtml\\' class=\\'view\\' ><head>' +\n\t\t\t\t\t\t'<style type=\\'text/css\\'>' +\n\t\t\t\t\t\t//设置四周的留边\n\t\t\t\t\t\t'.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\\n' +\n\t\t\t\t\t\t//设置默认字体和字号\n\t\t\t\t\t\t//font-family不能呢随便改，在safari下fillchar会有解析问题\n\t\t\t\t\t\t'body{margin:8px;font-family:sans-serif;font-size:16px;}' +\n\t\t\t\t\t\t//设置段落间距\n\t\t\t\t\t\t'p{margin:5px 0;}</style>' +\n\t\t\t\t\t\t(options.iframeCssUrl ? '<link rel=\\'stylesheet\\' type=\\'text/css\\' href=\\'' + utils.unhtml(options.iframeCssUrl) + '\\'/>' : '') +\n\t\t\t\t\t\t(options.initialStyle ? '<style>' + options.initialStyle + '</style>' : '') +\n\t\t\t\t\t\t'</head><body class=\\'view\\' ></body>' +\n\t\t\t\t\t\t'<script type=\\'text/javascript\\' ' + (ie ? 'defer=\\'defer\\'' : '') + ' id=\\'_initialScript\\'>' +\n\t\t\t\t\t\t'setTimeout(function(){editor = window.parent.UE.instants[\\'ueditorInstant' + me.uid + '\\'];editor._setup(document);},0);' +\n\t\t\t\t\t\t'var _tmpScript = document.getElementById(\\'_initialScript\\');_tmpScript.parentNode.removeChild(_tmpScript);</script></html>';\n\t\t\t\t\tcontainer.appendChild(domUtils.createElement(document, 'iframe', {\n\t\t\t\t\t\tid: 'ueditor_' + me.uid,\n\t\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\t\theight: \"100%\",\n\t\t\t\t\t\tframeborder: \"0\",\n\t\t\t\t\t\t//先注释掉了，加的原因忘记了，但开启会直接导致全屏模式下内容多时不会出现滚动条\n\t\t\t\t\t\t//                    scrolling :'no',\n\t\t\t\t\t\tsrc: 'javascript:void(function(){document.open();' + (options.customDomain && document.domain != location.hostname ? 'document.domain=\"' + document.domain + '\";' : '') +\n\t\t\t\t\t\t\t'document.write(\"' + html + '\");document.close();}())'\n\t\t\t\t\t}));\n\t\t\t\t\tcontainer.style.overflow = 'hidden';\n\t\t\t\t\t//解决如果是给定的百分比，会导致高度算不对的问题\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tif (/%$/.test(options.initialFrameWidth)) {\n\t\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth = container.offsetWidth;\n\t\t\t\t\t\t\t//如果这里给定宽度，会导致ie在拖动窗口大小时，编辑区域不随着变化\n\t\t\t\t\t\t\t//                        container.style.width = options.initialFrameWidth + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (/%$/.test(options.initialFrameHeight)) {\n\t\t\t\t\t\t\toptions.minFrameHeight = options.initialFrameHeight = container.offsetHeight;\n\t\t\t\t\t\t\tcontainer.style.height = options.initialFrameHeight + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 编辑器初始化\n\t\t\t * @method _setup\n\t\t\t * @private\n\t\t\t * @param { Element } doc 编辑器Iframe中的文档对象\n\t\t\t */\n\t\t\t_setup: function(doc) {\n\n\t\t\t\tvar me = this,\n\t\t\t\t\toptions = me.options;\n\t\t\t\tif (ie) {\n\t\t\t\t\tdoc.body.disabled = true;\n\t\t\t\t\tdoc.body.contentEditable = true;\n\t\t\t\t\tdoc.body.disabled = false;\n\t\t\t\t} else {\n\t\t\t\t\tdoc.body.contentEditable = true;\n\t\t\t\t}\n\t\t\t\tdoc.body.spellcheck = false;\n\t\t\t\tme.document = doc;\n\t\t\t\tme.window = doc.defaultView || doc.parentWindow;\n\t\t\t\tme.iframe = me.window.frameElement;\n\t\t\t\tme.body = doc.body;\n\t\t\t\tme.selection = new dom.Selection(doc);\n\t\t\t\t//gecko初始化就能得到range,无法判断isFocus了\n\t\t\t\tvar geckoSel;\n\t\t\t\tif (browser.gecko && (geckoSel = this.selection.getNative())) {\n\t\t\t\t\tgeckoSel.removeAllRanges();\n\t\t\t\t}\n\t\t\t\tthis._initEvents();\n\t\t\t\t//为form提交提供一个隐藏的textarea\n\t\t\t\tfor (var form = this.iframe.parentNode; !domUtils.isBody(form); form = form.parentNode) {\n\t\t\t\t\tif (form.tagName == 'FORM') {\n\t\t\t\t\t\tme.form = form;\n\t\t\t\t\t\tif (me.options.autoSyncData) {\n\t\t\t\t\t\t\tdomUtils.on(me.window, 'blur', function() {\n\t\t\t\t\t\t\t\tsetValue(form, me);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.on(form, 'submit', function() {\n\t\t\t\t\t\t\t\tsetValue(this, me);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (options.initialContent) {\n\t\t\t\t\tif (options.autoClearinitialContent) {\n\t\t\t\t\t\tvar oldExecCommand = me.execCommand;\n\t\t\t\t\t\tme.execCommand = function() {\n\t\t\t\t\t\t\tme.fireEvent('firstBeforeExecCommand');\n\t\t\t\t\t\t\treturn oldExecCommand.apply(me, arguments);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._setDefaultContent(options.initialContent);\n\t\t\t\t\t} else\n\t\t\t\t\t\tthis.setContent(options.initialContent, false, true);\n\t\t\t\t}\n\n\t\t\t\t//编辑器不能为空内容\n\n\t\t\t\tif (domUtils.isEmptyNode(me.body)) {\n\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t}\n\t\t\t\t//如果要求focus, 就把光标定位到内容开始\n\t\t\t\tif (options.focus) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tme.focus(me.options.focusInEnd);\n\t\t\t\t\t\t//如果自动清除开着，就不需要做selectionchange;\n\t\t\t\t\t\t!me.options.autoClearinitialContent && me._selectionChange();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t\tif (!me.container) {\n\t\t\t\t\tme.container = this.iframe.parentNode;\n\t\t\t\t}\n\t\t\t\tif (options.fullscreen && me.ui) {\n\t\t\t\t\tme.ui.setFullScreen(true);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tme.document.execCommand('2D-position', false, false);\n\t\t\t\t} catch (e) {}\n\t\t\t\ttry {\n\t\t\t\t\tme.document.execCommand('enableInlineTableEditing', false, false);\n\t\t\t\t} catch (e) {}\n\t\t\t\ttry {\n\t\t\t\t\tme.document.execCommand('enableObjectResizing', false, false);\n\t\t\t\t} catch (e) {}\n\n\t\t\t\t//挂接快捷键\n\t\t\t\tme._bindshortcutKeys();\n\t\t\t\tme.isReady = 1;\n\t\t\t\tme.fireEvent('ready');\n\t\t\t\toptions.onready && options.onready.call(me);\n\t\t\t\tif (!browser.ie9below) {\n\t\t\t\t\tdomUtils.on(me.window, ['blur', 'focus'], function(e) {\n\t\t\t\t\t\t//chrome下会出现alt+tab切换时，导致选区位置不对\n\t\t\t\t\t\tif (e.type == 'blur') {\n\t\t\t\t\t\t\tme._bakRange = me.selection.getRange();\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tme._bakNativeRange = me.selection.getNative().getRangeAt(0);\n\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tme._bakNativeRange = null;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tme._bakRange && me._bakRange.select();\n\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t//trace:1518 ff3.6body不够寛，会导致点击空白处无法获得焦点\n\t\t\t\tif (browser.gecko && browser.version <= 10902) {\n\t\t\t\t\t//修复ff3.6初始化进来，不能点击获得焦点\n\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\t}, 100);\n\t\t\t\t\tsetInterval(function() {\n\t\t\t\t\t\tme.body.style.height = me.iframe.offsetHeight - 20 + 'px'\n\t\t\t\t\t}, 100)\n\t\t\t\t}\n\n\t\t\t\t!options.isShow && me.setHide();\n\t\t\t\toptions.readonly && me.setDisabled();\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 同步数据到编辑器所在的form\n\t\t\t * 从编辑器的容器节点向上查找form元素，若找到，就同步编辑内容到找到的form里，为提交数据做准备，主要用于是手动提交的情况\n\t\t\t * 后台取得数据的键值，使用你容器上的name属性，如果没有就使用参数里的textarea项\n\t\t\t * @method sync\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.sync();\n\t\t\t * form.sumbit(); //form变量已经指向了form元素\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 根据传入的formId，在页面上查找要同步数据的表单，若找到，就同步编辑内容到找到的form里，为提交数据做准备\n\t\t\t * 后台取得数据的键值，该键值默认使用给定的编辑器容器的name属性，如果没有name属性则使用参数项里给定的“textarea”项\n\t\t\t * @method sync\n\t\t\t * @param { String } formID 指定一个要同步数据的form的id,编辑器的数据会同步到你指定form下\n\t\t\t */\n\t\t\tsync: function(formId) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tform = formId ? document.getElementById(formId) :\n\t\t\t\t\tdomUtils.findParent(me.iframe.parentNode, function(node) {\n\t\t\t\t\t\treturn node.tagName == 'FORM'\n\t\t\t\t\t}, true);\n\t\t\t\tform && setValue(form, me);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置编辑器高度\n\t\t\t * @method setHeight\n\t\t\t * @remind 当配置项autoHeightEnabled为真时,该方法无效\n\t\t\t * @param { Number } number 设置的高度值，纯数值，不带单位\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setHeight(number);\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetHeight: function(height, notSetHeight) {\n\t\t\t\tif (height !== parseInt(this.iframe.parentNode.style.height)) {\n\t\t\t\t\tthis.iframe.parentNode.style.height = height + 'px';\n\t\t\t\t}!notSetHeight && (this.options.minFrameHeight = this.options.initialFrameHeight = height);\n\t\t\t\tthis.body.style.height = height + 'px';\n\t\t\t\t!notSetHeight && this.trigger('setHeight')\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 为编辑器的编辑命令提供快捷键\n\t\t\t * 这个接口是为插件扩展提供的接口,主要是为新添加的插件，如果需要添加快捷键，所提供的接口\n\t\t\t * @method addshortcutkey\n\t\t\t * @param { Object } keyset 命令名和快捷键键值对对象，多个按钮的快捷键用“＋”分隔\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addshortcutkey({\n\t\t\t *     \"Bold\" : \"ctrl+66\",//^B\n\t\t\t *     \"Italic\" : \"ctrl+73\", //^I\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 这个接口是为插件扩展提供的接口,主要是为新添加的插件，如果需要添加快捷键，所提供的接口\n\t\t\t * @method addshortcutkey\n\t\t\t * @param { String } cmd 触发快捷键时，响应的命令\n\t\t\t * @param { String } keys 快捷键的字符串，多个按钮用“＋”分隔\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addshortcutkey(\"Underline\", \"ctrl+85\"); //^U\n\t\t\t * ```\n\t\t\t */\n\t\t\taddshortcutkey: function(cmd, keys) {\n\t\t\t\tvar obj = {};\n\t\t\t\tif (keys) {\n\t\t\t\t\tobj[cmd] = keys\n\t\t\t\t} else {\n\t\t\t\t\tobj = cmd;\n\t\t\t\t}\n\t\t\t\tutils.extend(this.shortcutkeys, obj)\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 对编辑器设置keydown事件监听，绑定快捷键和命令，当快捷键组合触发成功，会响应对应的命令\n\t\t\t * @method _bindshortcutKeys\n\t\t\t * @private\n\t\t\t */\n\t\t\t_bindshortcutKeys: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tshortcutkeys = this.shortcutkeys;\n\t\t\t\tme.addListener('keydown', function(type, e) {\n\t\t\t\t\tvar keyCode = e.keyCode || e.which;\n\t\t\t\t\tfor (var i in shortcutkeys) {\n\t\t\t\t\t\tvar tmp = shortcutkeys[i].split(',');\n\t\t\t\t\t\tfor (var t = 0, ti; ti = tmp[t++];) {\n\t\t\t\t\t\t\tti = ti.split(':');\n\t\t\t\t\t\t\tvar key = ti[0],\n\t\t\t\t\t\t\t\tparam = ti[1];\n\t\t\t\t\t\t\tif (/^(ctrl)(\\+shift)?\\+(\\d+)$/.test(key.toLowerCase()) || /^(\\d+)$/.test(key)) {\n\t\t\t\t\t\t\t\tif (((RegExp.$1 == 'ctrl' ? (e.ctrlKey || e.metaKey) : 0) && (RegExp.$2 != \"\" ? e[RegExp.$2.slice(1) + \"Key\"] : 1) && keyCode == RegExp.$3) ||\n\t\t\t\t\t\t\t\t\tkeyCode == RegExp.$1\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tif (me.queryCommandState(i, param) != -1)\n\t\t\t\t\t\t\t\t\t\tme.execCommand(i, param);\n\t\t\t\t\t\t\t\t\tdomUtils.preventDefault(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取编辑器的内容\n\t\t\t * @method getContent\n\t\t\t * @warning 该方法获取到的是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @return { String } 编辑器的内容字符串, 如果编辑器的内容为空，或者是空的标签内容（如:”&lt;p&gt;&lt;br/&gt;&lt;/p&gt;“）， 则返回空字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容:<p>1<strong>2<em>34</em>5</strong>6</p>\n\t\t\t * var content = editor.getContent(); //返回值:<p>1<strong>2<em>34</em>5</strong>6</p>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 获取编辑器的内容。 可以通过参数定义编辑器内置的判空规则\n\t\t\t * @method getContent\n\t\t\t * @param { Function } fn 自定的判空规则， 要求该方法返回一个boolean类型的值，\n\t\t\t *                      代表当前编辑器的内容是否空，\n\t\t\t *                      如果返回true， 则该方法将直接返回空字符串；如果返回false，则编辑器将返回\n\t\t\t *                      经过内置过滤规则处理后的内容。\n\t\t\t * @remind 该方法在处理包含有初始化内容的时候能起到很好的作用。\n\t\t\t * @warning 该方法获取到的是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @return { String } 编辑器的内容字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * // editor 是一个编辑器的实例\n\t\t\t * var content = editor.getContent( function ( editor ) {\n\t\t\t *      return editor.body.innerHTML === '欢迎使用UEditor'; //返回空字符串\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetContent: function(cmd, fn, notSetCursor, ignoreBlank, formatter) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (cmd && utils.isFunction(cmd)) {\n\t\t\t\t\tfn = cmd;\n\t\t\t\t\tcmd = '';\n\t\t\t\t}\n\t\t\t\tif (fn ? !fn() : !this.hasContents()) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tme.fireEvent('beforegetcontent');\n\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML, ignoreBlank);\n\t\t\t\tme.filterOutputRule(root);\n\t\t\t\tme.fireEvent('aftergetcontent', cmd, root);\n\t\t\t\treturn root.toHtml(formatter);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 取得完整的html代码，可以直接显示成完整的html文档\n\t\t\t * @method getAllHtml\n\t\t\t * @return { String } 编辑器的内容html文档字符串\n\t\t\t * @eaxmple\n\t\t\t * ```javascript\n\t\t\t * editor.getAllHtml(); //返回格式大致是: <html><head>...</head><body>...</body></html>\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetAllHtml: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\theadHtml = [],\n\t\t\t\t\thtml = '';\n\t\t\t\tme.fireEvent('getAllHtml', headHtml);\n\t\t\t\tif (browser.ie && browser.version > 8) {\n\t\t\t\t\tvar headHtmlForIE9 = '';\n\t\t\t\t\tutils.each(me.document.styleSheets, function(si) {\n\t\t\t\t\t\theadHtmlForIE9 += (si.href ? '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + si.href + '\" />' : '<style>' + si.cssText + '</style>');\n\t\t\t\t\t});\n\t\t\t\t\tutils.each(me.document.getElementsByTagName('script'), function(si) {\n\t\t\t\t\t\theadHtmlForIE9 += si.outerHTML;\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\treturn '<html><head>' + (me.options.charset ? '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=' + me.options.charset + '\"/>' : '') + (headHtmlForIE9 || me.document.getElementsByTagName('head')[0].innerHTML) + headHtml.join('\\n') + '</head>' + '<body ' + (ie && browser.version < 9 ? 'class=\"view\"' : '') + '>' + me.getContent(null, null, true) + '</body></html>';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 得到编辑器的纯文本内容，但会保留段落格式\n\t\t\t * @method getPlainTxt\n\t\t\t * @return { String } 编辑器带段落格式的纯文本内容字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容:<p><strong>1</strong></p><p><strong>2</strong></p>\n\t\t\t * console.log(editor.getPlainTxt()); //输出:\"1\\n2\\n\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetPlainTxt: function() {\n\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g'),\n\t\t\t\t\thtml = this.body.innerHTML.replace(/[\\n\\r]/g, ''); //ie要先去了\\n在处理\n\t\t\t\thtml = html.replace(/<(p|div)[^>]*>(<br\\/?>|&nbsp;)<\\/\\1>/gi, '\\n')\n\t\t\t\t\t.replace(/<br\\/?>/gi, '\\n')\n\t\t\t\t\t.replace(/<[^>/]+>/g, '')\n\t\t\t\t\t.replace(/(\\n)?<\\/([^>]+)>/g, function(a, b, c) {\n\t\t\t\t\t\treturn dtd.$block[c] ? '\\n' : b ? b : '';\n\t\t\t\t\t});\n\t\t\t\t//取出来的空格会有c2a0会变成乱码，处理这种情况\\u00a0\n\t\t\t\treturn html.replace(reg, '').replace(/\\u00a0/g, ' ').replace(/&nbsp;/g, ' ');\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取编辑器中的纯文本内容,没有段落格式\n\t\t\t * @method getContentTxt\n\t\t\t * @return { String } 编辑器不带段落格式的纯文本内容字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容:<p><strong>1</strong></p><p><strong>2</strong></p>\n\t\t\t * console.log(editor.getPlainTxt()); //输出:\"12\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetContentTxt: function() {\n\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\t\t//取出来的空格会有c2a0会变成乱码，处理这种情况\\u00a0\n\t\t\t\treturn this.body[browser.ie ? 'innerText' : 'textContent'].replace(reg, '').replace(/\\u00a0/g, ' ');\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置编辑器的内容，可修改编辑器当前的html内容\n\t\t\t * @method setContent\n\t\t\t * @warning 通过该方法插入的内容，是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @warning 该方法会触发selectionchange事件\n\t\t\t * @param { String } html 要插入的html内容\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.getContent('<p>test</p>');\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 设置编辑器的内容，可修改编辑器当前的html内容\n\t\t\t * @method setContent\n\t\t\t * @warning 通过该方法插入的内容，是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @warning 该方法会触发selectionchange事件\n\t\t\t * @param { String } html 要插入的html内容\n\t\t\t * @param { Boolean } isAppendTo 若传入true，不清空原来的内容，在最后插入内容，否则，清空内容再插入\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //假设设置前的编辑器内容是 <p>old text</p>\n\t\t\t * editor.setContent('<p>new text</p>', true); //插入的结果是<p>old text</p><p>new text</p>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetContent: function(html, isAppendTo, notFireSelectionchange) {\n\t\t\t\tvar me = this;\n\n\t\t\t\tme.fireEvent('beforesetcontent', html);\n\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\thtml = root.toHtml();\n\n\t\t\t\tme.body.innerHTML = (isAppendTo ? me.body.innerHTML : '') + html;\n\n\t\t\t\tfunction isCdataDiv(node) {\n\t\t\t\t\treturn node.tagName == 'DIV' && node.getAttribute('cdata_tag');\n\t\t\t\t}\n\t\t\t\t//给文本或者inline节点套p标签\n\t\t\t\tif (me.options.enterTag == 'p') {\n\n\t\t\t\t\tvar child = this.body.firstChild,\n\t\t\t\t\t\ttmpNode;\n\t\t\t\t\tif (!child || child.nodeType == 1 &&\n\t\t\t\t\t\t(dtd.$cdata[child.tagName] || isCdataDiv(child) ||\n\t\t\t\t\t\t\tdomUtils.isCustomeNode(child)\n\t\t\t\t\t\t) && child === this.body.lastChild) {\n\t\t\t\t\t\tthis.body.innerHTML = '<p>' + (browser.ie ? '&nbsp;' : '<br/>') + '</p>' + this.body.innerHTML;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\twhile (child) {\n\t\t\t\t\t\t\twhile (child && (child.nodeType == 3 || child.nodeType == 1 && dtd.p[child.tagName] && !dtd.$cdata[child.tagName])) {\n\t\t\t\t\t\t\t\ttmpNode = child.nextSibling;\n\t\t\t\t\t\t\t\tp.appendChild(child);\n\t\t\t\t\t\t\t\tchild = tmpNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (p.firstChild) {\n\t\t\t\t\t\t\t\tif (!child) {\n\t\t\t\t\t\t\t\t\tme.body.appendChild(p);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchild.parentNode.insertBefore(p, child);\n\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tme.fireEvent('aftersetcontent');\n\t\t\t\tme.fireEvent('contentchange');\n\n\t\t\t\t!notFireSelectionchange && me._selectionChange();\n\t\t\t\t//清除保存的选区\n\t\t\t\tme._bakRange = me._bakIERange = me._bakNativeRange = null;\n\t\t\t\t//trace:1742 setContent后gecko能得到焦点问题\n\t\t\t\tvar geckoSel;\n\t\t\t\tif (browser.gecko && (geckoSel = this.selection.getNative())) {\n\t\t\t\t\tgeckoSel.removeAllRanges();\n\t\t\t\t}\n\t\t\t\tif (me.options.autoSyncData) {\n\t\t\t\t\tme.form && setValue(me.form, me);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 让编辑器获得焦点，默认focus到编辑器头部\n\t\t\t * @method focus\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.focus()\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 让编辑器获得焦点，toEnd确定focus位置\n\t\t\t * @method focus\n\t\t\t * @param { Boolean } toEnd 默认focus到编辑器头部，toEnd为true时focus到内容尾部\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.focus(true)\n\t\t\t * ```\n\t\t\t */\n\t\t\tfocus: function(toEnd) {\n\t\t\t\ttry {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\tif (toEnd) {\n\t\t\t\t\t\tvar node = me.body.lastChild;\n\t\t\t\t\t\tif (node && node.nodeType == 1 && !dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\t\t\t\t\trng.setStartAtFirst(node)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trng.setStartAtLast(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.setCursor(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!rng.collapsed && domUtils.isBody(rng.startContainer) && rng.startOffset == 0) {\n\n\t\t\t\t\t\t\tvar node = me.body.firstChild;\n\t\t\t\t\t\t\tif (node && node.nodeType == 1 && !dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\trng.setStartAtFirst(node).collapse(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trng.select(true);\n\n\t\t\t\t\t}\n\t\t\t\t\tthis.fireEvent('focus selectionchange');\n\t\t\t\t} catch (e) {}\n\n\t\t\t},\n\t\t\tisFocus: function() {\n\t\t\t\treturn this.selection.isFocus();\n\t\t\t},\n\t\t\tblur: function() {\n\t\t\t\tvar sel = this.selection.getNative();\n\t\t\t\tif (sel.empty && browser.ie) {\n\t\t\t\t\tvar nativeRng = document.body.createTextRange();\n\t\t\t\t\tnativeRng.moveToElementText(document.body);\n\t\t\t\t\tnativeRng.collapse(true);\n\t\t\t\t\tnativeRng.select();\n\t\t\t\t\tsel.empty()\n\t\t\t\t} else {\n\t\t\t\t\tsel.removeAllRanges()\n\t\t\t\t}\n\n\t\t\t\t//this.fireEvent('blur selectionchange');\n\t\t\t},\n\t\t\t/**\n\t\t\t * 初始化UE事件及部分事件代理\n\t\t\t * @method _initEvents\n\t\t\t * @private\n\t\t\t */\n\t\t\t_initEvents: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tdoc = me.document,\n\t\t\t\t\twin = me.window;\n\t\t\t\tme._proxyDomEvent = utils.bind(me._proxyDomEvent, me);\n\t\t\t\tdomUtils.on(doc, ['click', 'contextmenu', 'mousedown', 'keydown', 'keyup', 'keypress', 'mouseup', 'mouseover', 'mouseout', 'selectstart'], me._proxyDomEvent);\n\t\t\t\tdomUtils.on(win, ['focus', 'blur'], me._proxyDomEvent);\n\t\t\t\tdomUtils.on(me.body, 'drop', function(e) {\n\t\t\t\t\t//阻止ff下默认的弹出新页面打开图片\n\t\t\t\t\tif (browser.gecko && e.stopPropagation) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('contentchange')\n\t\t\t\t});\n\t\t\t\tdomUtils.on(doc, ['mouseup', 'keydown'], function(evt) {\n\t\t\t\t\t//特殊键不触发selectionchange\n\t\t\t\t\tif (evt.type == 'keydown' && (evt.ctrlKey || evt.metaKey || evt.shiftKey || evt.altKey)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (evt.button == 2) return;\n\t\t\t\t\tme._selectionChange(250, evt);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/**\n\t\t\t * 触发事件代理\n\t\t\t * @method _proxyDomEvent\n\t\t\t * @private\n\t\t\t * @return { * } fireEvent的返回值\n\t\t\t * @see UE.EventBase:fireEvent(String)\n\t\t\t */\n\t\t\t_proxyDomEvent: function(evt) {\n\t\t\t\tif (this.fireEvent('before' + evt.type.replace(/^on/, '').toLowerCase()) === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (this.fireEvent(evt.type.replace(/^on/, ''), evt) === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn this.fireEvent('after' + evt.type.replace(/^on/, '').toLowerCase())\n\t\t\t},\n\t\t\t/**\n\t\t\t * 变化选区\n\t\t\t * @method _selectionChange\n\t\t\t * @private\n\t\t\t */\n\t\t\t_selectionChange: function(delay, evt) {\n\t\t\t\tvar me = this;\n\t\t\t\t//有光标才做selectionchange 为了解决未focus时点击source不能触发更改工具栏状态的问题（source命令notNeedUndo=1）\n\t\t\t\t//            if ( !me.selection.isFocus() ){\n\t\t\t\t//                return;\n\t\t\t\t//            }\n\n\t\t\t\tvar hackForMouseUp = false;\n\t\t\t\tvar mouseX, mouseY;\n\t\t\t\tif (browser.ie && browser.version < 9 && evt && evt.type == 'mouseup') {\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\thackForMouseUp = true;\n\t\t\t\t\t\tmouseX = evt.clientX;\n\t\t\t\t\t\tmouseY = evt.clientY;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclearTimeout(_selectionChangeTimer);\n\t\t\t\t_selectionChangeTimer = setTimeout(function() {\n\t\t\t\t\tif (!me.selection || !me.selection.getNative()) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//修复一个IE下的bug: 鼠标点击一段已选择的文本中间时，可能在mouseup后的一段时间内取到的range是在selection的type为None下的错误值.\n\t\t\t\t\t//IE下如果用户是拖拽一段已选择文本，则不会触发mouseup事件，所以这里的特殊处理不会对其有影响\n\t\t\t\t\tvar ieRange;\n\t\t\t\t\tif (hackForMouseUp && me.selection.getNative().type == 'None') {\n\t\t\t\t\t\tieRange = me.document.body.createTextRange();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tieRange.moveToPoint(mouseX, mouseY);\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\tieRange = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar bakGetIERange;\n\t\t\t\t\tif (ieRange) {\n\t\t\t\t\t\tbakGetIERange = me.selection.getIERange;\n\t\t\t\t\t\tme.selection.getIERange = function() {\n\t\t\t\t\t\t\treturn ieRange;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tme.selection.cache();\n\t\t\t\t\tif (bakGetIERange) {\n\t\t\t\t\t\tme.selection.getIERange = bakGetIERange;\n\t\t\t\t\t}\n\t\t\t\t\tif (me.selection._cachedRange && me.selection._cachedStartElement) {\n\t\t\t\t\t\tme.fireEvent('beforeselectionchange');\n\t\t\t\t\t\t// 第二个参数causeByUi为true代表由用户交互造成的selectionchange.\n\t\t\t\t\t\tme.fireEvent('selectionchange', !!evt);\n\t\t\t\t\t\tme.fireEvent('afterselectionchange');\n\t\t\t\t\t\tme.selection.clear();\n\t\t\t\t\t}\n\t\t\t\t}, delay || 50);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 执行编辑命令\n\t\t\t * @method _callCmdFn\n\t\t\t * @private\n\t\t\t * @param { String } fnName 函数名称\n\t\t\t * @param { * } args 传给命令函数的参数\n\t\t\t * @return { * } 返回命令函数运行的返回值\n\t\t\t */\n\t\t\t_callCmdFn: function(fnName, args) {\n\t\t\t\tvar cmdName = args[0].toLowerCase(),\n\t\t\t\t\tcmd, cmdFn;\n\t\t\t\tcmd = this.commands[cmdName] || UE.commands[cmdName];\n\t\t\t\tcmdFn = cmd && cmd[fnName];\n\t\t\t\t//没有querycommandstate或者没有command的都默认返回0\n\t\t\t\tif ((!cmd || !cmdFn) && fnName == 'queryCommandState') {\n\t\t\t\t\treturn 0;\n\t\t\t\t} else if (cmdFn) {\n\t\t\t\t\treturn cmdFn.apply(this, args);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 执行编辑命令cmdName，完成富文本编辑效果\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmdName 需要执行的命令\n\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t * @return { * } 返回命令函数运行的返回值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand(cmdName);\n\t\t\t * ```\n\t\t\t */\n\t\t\texecCommand: function(cmdName) {\n\t\t\t\tcmdName = cmdName.toLowerCase();\n\t\t\t\tvar me = this,\n\t\t\t\t\tresult,\n\t\t\t\t\tcmd = me.commands[cmdName] || UE.commands[cmdName];\n\t\t\t\tif (!cmd || !cmd.execCommand) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tif (!cmd.notNeedUndo && !me.__hasEnterExecCommand) {\n\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\tif (me.queryCommandState.apply(me, arguments) != -1) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tme.fireEvent.apply(me, ['beforeexeccommand', cmdName].concat(arguments));\n\t\t\t\t\t\tresult = this._callCmdFn('execCommand', arguments);\n\t\t\t\t\t\t//保存场景时，做了内容对比，再看是否进行contentchange触发，这里多触发了一次，去掉\n\t\t\t\t\t\t//                    (!cmd.ignoreContentChange && !me._ignoreContentChange) && me.fireEvent('contentchange');\n\t\t\t\t\t\tme.fireEvent.apply(me, ['afterexeccommand', cmdName].concat(arguments));\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t}\n\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t} else {\n\t\t\t\t\tresult = this._callCmdFn('execCommand', arguments);\n\t\t\t\t\t(!me.__hasEnterExecCommand && !cmd.ignoreContentChange && !me._ignoreContentChange) && me.fireEvent('contentchange')\n\t\t\t\t}\n\t\t\t\t(!me.__hasEnterExecCommand && !cmd.ignoreContentChange && !me._ignoreContentChange) && me._selectionChange();\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据传入的command命令，查选编辑器当前的选区，返回命令的状态\n\t\t\t * @method  queryCommandState\n\t\t\t * @param { String } cmdName 需要查询的命令名称\n\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t * @return { Number } number 返回放前命令的状态，返回值三种情况：(-1|0|1)\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState(cmdName)  => (-1|0|1)\n\t\t\t * ```\n\t\t\t * @see COMMAND.LIST\n\t\t\t */\n\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\treturn this._callCmdFn('queryCommandState', arguments);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据传入的command命令，查选编辑器当前的选区，根据命令返回相关的值\n\t\t\t * @method queryCommandValue\n\t\t\t * @param { String } cmdName 需要查询的命令名称\n\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t * @remind 只有部分插件有此方法\n\t\t\t * @return { * } 返回每个命令特定的当前状态值\n\t\t\t * @grammar editor.queryCommandValue(cmdName)  =>  {*}\n\t\t\t * @see COMMAND.LIST\n\t\t\t */\n\t\t\tqueryCommandValue: function(cmdName) {\n\t\t\t\treturn this._callCmdFn('queryCommandValue', arguments);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 检查编辑区域中是否有内容\n\t\t\t * @method  hasContents\n\t\t\t * @remind 默认有文本内容，或者有以下节点都不认为是空\n\t\t\t * table,ul,ol,dl,iframe,area,base,col,hr,img,embed,input,link,meta,param\n\t\t\t * @return { Boolean } 检查有内容返回true，否则返回false\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.hasContents()\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 检查编辑区域中是否有内容，若包含参数tags中的节点类型，直接返回true\n\t\t\t * @method  hasContents\n\t\t\t * @param { Array } tags 传入数组判断时用到的节点类型\n\t\t\t * @return { Boolean } 若文档中包含tags数组里对应的tag，返回true，否则返回false\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.hasContents(['span']);\n\t\t\t * ```\n\t\t\t */\n\t\t\thasContents: function(tags) {\n\t\t\t\tif (tags) {\n\t\t\t\t\tfor (var i = 0, ci; ci = tags[i++];) {\n\t\t\t\t\t\tif (this.document.getElementsByTagName(ci).length > 0) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!domUtils.isEmptyBlock(this.body)) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\t//随时添加,定义的特殊标签如果存在，不能认为是空\n\t\t\t\ttags = ['div'];\n\t\t\t\tfor (i = 0; ci = tags[i++];) {\n\t\t\t\t\tvar nodes = domUtils.getElementsByTagName(this.document, ci);\n\t\t\t\t\tfor (var n = 0, cn; cn = nodes[n++];) {\n\t\t\t\t\t\tif (domUtils.isCustomeNode(cn)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 重置编辑器，可用来做多个tab使用同一个编辑器实例\n\t\t\t * @method  reset\n\t\t\t * @remind 此方法会清空编辑器内容，清空回退列表，会触发reset事件\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.reset()\n\t\t\t * ```\n\t\t\t */\n\t\t\treset: function() {\n\t\t\t\tthis.fireEvent('reset');\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置当前编辑区域可以编辑\n\t\t\t * @method setEnabled\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setEnabled()\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetEnabled: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange;\n\t\t\t\tif (me.body.contentEditable == 'false') {\n\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t//有可能内容丢失了\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.moveToBookmark(me.lastBk);\n\t\t\t\t\t\tdelete me.lastBk\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\trange.setStartAtFirst(me.body).collapse(true)\n\t\t\t\t\t}\n\t\t\t\t\trange.select(true);\n\t\t\t\t\tif (me.bkqueryCommandState) {\n\t\t\t\t\t\tme.queryCommandState = me.bkqueryCommandState;\n\t\t\t\t\t\tdelete me.bkqueryCommandState;\n\t\t\t\t\t}\n\t\t\t\t\tif (me.bkqueryCommandValue) {\n\t\t\t\t\t\tme.queryCommandValue = me.bkqueryCommandValue;\n\t\t\t\t\t\tdelete me.bkqueryCommandValue;\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('selectionchange');\n\t\t\t\t}\n\t\t\t},\n\t\t\tenable: function() {\n\t\t\t\treturn this.setEnabled();\n\t\t\t},\n\n\t\t\t/** 设置当前编辑区域不可编辑\n\t\t\t * @method setDisabled\n\t\t\t */\n\n\t\t\t/** 设置当前编辑区域不可编辑,except中的命令除外\n\t\t\t * @method setDisabled\n\t\t\t * @param { String } except 例外命令的字符串\n\t\t\t * @remind 即使设置了disable，此处配置的例外命令仍然可以执行\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setDisabled('bold'); //禁用工具栏中除加粗之外的所有功能\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/** 设置当前编辑区域不可编辑,except中的命令除外\n\t\t\t * @method setDisabled\n\t\t\t * @param { Array } except 例外命令的字符串数组，数组中的命令仍然可以执行\n\t\t\t * @remind 即使设置了disable，此处配置的例外命令仍然可以执行\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setDisabled(['bold','insertimage']); //禁用工具栏中除加粗和插入图片之外的所有功能\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetDisabled: function(except) {\n\t\t\t\tvar me = this;\n\t\t\t\texcept = except ? utils.isArray(except) ? except : [except] : [];\n\t\t\t\tif (me.body.contentEditable == 'true') {\n\t\t\t\t\tif (!me.lastBk) {\n\t\t\t\t\t\tme.lastBk = me.selection.getRange().createBookmark(true);\n\t\t\t\t\t}\n\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\tme.bkqueryCommandState = me.queryCommandState;\n\t\t\t\t\tme.bkqueryCommandValue = me.queryCommandValue;\n\t\t\t\t\tme.queryCommandState = function(type) {\n\t\t\t\t\t\tif (utils.indexOf(except, type) != -1) {\n\t\t\t\t\t\t\treturn me.bkqueryCommandState.apply(me, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t};\n\t\t\t\t\tme.queryCommandValue = function(type) {\n\t\t\t\t\t\tif (utils.indexOf(except, type) != -1) {\n\t\t\t\t\t\t\treturn me.bkqueryCommandValue.apply(me, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t};\n\t\t\t\t\tme.fireEvent('selectionchange');\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisable: function(except) {\n\t\t\t\treturn this.setDisabled(except);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置默认内容\n\t\t\t * @method _setDefaultContent\n\t\t\t * @private\n\t\t\t * @param  { String } cont 要存入的内容\n\t\t\t */\n\t\t\t_setDefaultContent: function() {\n\t\t\t\tfunction clear() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (me.document.getElementById('initContent')) {\n\t\t\t\t\t\tme.body.innerHTML = '<p>' + (ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\tme.removeListener('firstBeforeExecCommand focus', clear);\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tme.focus();\n\t\t\t\t\t\t\tme._selectionChange();\n\t\t\t\t\t\t}, 0)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn function(cont) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.body.innerHTML = '<p id=\"initContent\">' + cont + '</p>';\n\n\t\t\t\t\tme.addListener('firstBeforeExecCommand focus', clear);\n\t\t\t\t}\n\t\t\t}(),\n\n\t\t\t/**\n\t\t\t * 显示编辑器\n\t\t\t * @method setShow\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setShow()\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetShow: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (me.container.style.display == 'none') {\n\t\t\t\t\t//有可能内容丢失了\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.moveToBookmark(me.lastBk);\n\t\t\t\t\t\tdelete me.lastBk\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\trange.setStartAtFirst(me.body).collapse(true)\n\t\t\t\t\t}\n\t\t\t\t\t//ie下focus实效，所以做了个延迟\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\trange.select(true);\n\t\t\t\t\t}, 100);\n\t\t\t\t\tme.container.style.display = '';\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tshow: function() {\n\t\t\t\treturn this.setShow();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 隐藏编辑器\n\t\t\t * @method setHide\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setHide()\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetHide: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!me.lastBk) {\n\t\t\t\t\tme.lastBk = me.selection.getRange().createBookmark(true);\n\t\t\t\t}\n\t\t\t\tme.container.style.display = 'none'\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\treturn this.setHide();\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据指定的路径，获取对应的语言资源\n\t\t\t * @method getLang\n\t\t\t * @param { String } path 路径根据的是lang目录下的语言文件的路径结构\n\t\t\t * @return { Object | String } 根据路径返回语言资源的Json格式对象或者语言字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.getLang('contextMenu.delete'); //如果当前是中文，那返回是的是'删除'\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetLang: function(path) {\n\t\t\t\tvar lang = UE.I18N[this.options.lang];\n\t\t\t\tif (!lang) {\n\t\t\t\t\tthrow Error(\"not import language file\");\n\t\t\t\t}\n\t\t\t\tpath = (path || \"\").split(\".\");\n\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\tlang = lang[ci];\n\t\t\t\t\tif (!lang) break;\n\t\t\t\t}\n\t\t\t\treturn lang;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 计算编辑器html内容字符串的长度\n\t\t\t * @method  getContentLength\n\t\t\t * @return { Number } 返回计算的长度\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容<p><strong>132</strong></p>\n\t\t\t * editor.getContentLength() //返回27\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 计算编辑器当前纯文本内容的长度\n\t\t\t * @method  getContentLength\n\t\t\t * @param { Boolean } ingoneHtml 传入true时，只按照纯文本来计算\n\t\t\t * @return { Number } 返回计算的长度，内容中有hr/img/iframe标签，长度加1\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容<p><strong>132</strong></p>\n\t\t\t * editor.getContentLength() //返回3\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetContentLength: function(ingoneHtml, tagNames) {\n\t\t\t\tvar count = this.getContent(false, false, true).length;\n\t\t\t\tif (ingoneHtml) {\n\t\t\t\t\ttagNames = (tagNames || []).concat(['hr', 'img', 'iframe']);\n\t\t\t\t\tcount = this.getContentTxt().replace(/[\\t\\r\\n]+/g, '').length;\n\t\t\t\t\tfor (var i = 0, ci; ci = tagNames[i++];) {\n\t\t\t\t\t\tcount += this.document.getElementsByTagName(ci).length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn count;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 注册输入过滤规则\n\t\t\t * @method  addInputRule\n\t\t\t * @param { Function } rule 要添加的过滤规则\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addInputRule(function(root){\n\t\t\t *   $.each(root.getNodesByTagName('div'),function(i,node){\n\t\t\t *       node.tagName=\"p\";\n\t\t\t *   });\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\taddInputRule: function(rule) {\n\t\t\t\tthis.inputRules.push(rule);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 执行注册的过滤规则\n\t\t\t * @method  filterInputRule\n\t\t\t * @param { UE.uNode } root 要过滤的uNode节点\n\t\t\t * @remind 执行editor.setContent方法和执行'inserthtml'命令后，会运行该过滤函数\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.filterInputRule(editor.body);\n\t\t\t * ```\n\t\t\t * @see UE.Editor:addInputRule\n\t\t\t */\n\t\t\tfilterInputRule: function(root) {\n\t\t\t\tfor (var i = 0, ci; ci = this.inputRules[i++];) {\n\t\t\t\t\tci.call(this, root)\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 注册输出过滤规则\n\t\t\t * @method  addOutputRule\n\t\t\t * @param { Function } rule 要添加的过滤规则\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addOutputRule(function(root){\n\t\t\t *   $.each(root.getNodesByTagName('p'),function(i,node){\n\t\t\t *       node.tagName=\"div\";\n\t\t\t *   });\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\taddOutputRule: function(rule) {\n\t\t\t\tthis.outputRules.push(rule)\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据输出过滤规则，过滤编辑器内容\n\t\t\t * @method  filterOutputRule\n\t\t\t * @remind 执行editor.getContent方法的时候，会先运行该过滤函数\n\t\t\t * @param { UE.uNode } root 要过滤的uNode节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.filterOutputRule(editor.body);\n\t\t\t * ```\n\t\t\t * @see UE.Editor:addOutputRule\n\t\t\t */\n\t\t\tfilterOutputRule: function(root) {\n\t\t\t\tfor (var i = 0, ci; ci = this.outputRules[i++];) {\n\t\t\t\t\tci.call(this, root)\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据action名称获取请求的路径\n\t\t\t * @method  getActionUrl\n\t\t\t * @remind 假如没有设置serverUrl,会根据imageUrl设置默认的controller路径\n\t\t\t * @param { String } action action名称\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.getActionUrl('config'); //返回 \"/ueditor/php/controller.php?action=config\"\n\t\t\t * editor.getActionUrl('image'); //返回 \"/ueditor/php/controller.php?action=uplaodimage\"\n\t\t\t * editor.getActionUrl('scrawl'); //返回 \"/ueditor/php/controller.php?action=uplaodscrawl\"\n\t\t\t * editor.getActionUrl('imageManager'); //返回 \"/ueditor/php/controller.php?action=listimage\"\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetActionUrl: function(action) {\n\t\t\t\tvar actionName = this.getOpt(action) || action,\n\t\t\t\t\timageUrl = this.getOpt('imageUrl'),\n\t\t\t\t\tserverUrl = this.getOpt('serverUrl');\n\n\t\t\t\tif (!serverUrl && imageUrl) {\n\t\t\t\t\tserverUrl = imageUrl.replace(/^(.*[\\/]).+([\\.].+)$/, '$1controller$2');\n\t\t\t\t}\n\n\t\t\t\tif (serverUrl) {\n\t\t\t\t\tserverUrl = serverUrl + (serverUrl.indexOf('?') == -1 ? '?' : '&') + 'action=' + (actionName || '');\n\t\t\t\t\treturn utils.formatUrl(serverUrl);\n\t\t\t\t} else {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Editor, EventBase);\n\t})();\n\n\t// core/Editor.defaultoptions.js\n\t//维护编辑器一下默认的不在插件中的配置项\n\tUE.Editor.defaultOptions = function(editor) {\n\n\t\tvar _url = editor.options.UEDITOR_HOME_URL;\n\t\treturn {\n\t\t\tisShow: true,\n\t\t\tinitialContent: '',\n\t\t\tinitialStyle: '',\n\t\t\tautoClearinitialContent: false,\n\t\t\tiframeCssUrl: _url + 'themes/iframe.css',\n\t\t\ttextarea: 'editorValue',\n\t\t\tfocus: false,\n\t\t\tfocusInEnd: true,\n\t\t\tautoClearEmptyNode: true,\n\t\t\tfullscreen: false,\n\t\t\treadonly: false,\n\t\t\tzIndex: 999,\n\t\t\timagePopup: true,\n\t\t\tenterTag: 'p',\n\t\t\tcustomDomain: false,\n\t\t\tlang: 'zh-cn',\n\t\t\tlangPath: _url + 'lang/',\n\t\t\ttheme: 'default',\n\t\t\tthemePath: _url + 'themes/',\n\t\t\tallHtmlEnabled: false,\n\t\t\tscaleEnabled: false,\n\t\t\ttableNativeEditInFF: false,\n\t\t\tautoSyncData: true,\n\t\t\tfileNameFormat: '{time}{rand:6}'\n\t\t}\n\t};\n\n\t// core/loadconfig.js\n\t(function() {\n\n\t\tUE.Editor.prototype.loadServerConfig = function() {\n\t\t\tvar me = this;\n\t\t\tsetTimeout(function() {\n\t\t\t\ttry {\n\t\t\t\t\tme.options.imageUrl && me.setOpt('serverUrl', me.options.imageUrl.replace(/^(.*[\\/]).+([\\.].+)$/, '$1controller$2'));\n\n\t\t\t\t\tvar configUrl = me.getActionUrl('config'),\n\t\t\t\t\t\tisJsonp = utils.isCrossDomainUrl(configUrl);\n\t\t\t\t\t/* 发出ajax请求 */\n\t\t\t\t\tme._serverConfigLoaded = false;\n\n\t\t\t\t\tconfigUrl && UE.ajax.request(configUrl, {\n\t\t\t\t\t\t'method': 'GET',\n\t\t\t\t\t\t'dataType': isJsonp ? 'jsonp' : '',\n\t\t\t\t\t\t'onsuccess': function(r) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tvar config = isJsonp ? r : eval(\"(\" + r.responseText + \")\");\n\t\t\t\t\t\t\t\tutils.extend(me.options, config);\n\t\t\t\t\t\t\t\tme.fireEvent('serverConfigLoaded');\n\t\t\t\t\t\t\t\tme._serverConfigLoaded = true;\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigFormatError'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'onerror': function() {\n\t\t\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigHttpError'));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigError'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction showErrorMsg(msg) {\n\t\t\t\tconsole && console.error(msg);\n\t\t\t\t//me.fireEvent('showMessage', {\n\t\t\t\t//    'title': msg,\n\t\t\t\t//    'type': 'error'\n\t\t\t\t//});\n\t\t\t}\n\t\t};\n\n\t\tUE.Editor.prototype.isServerConfigLoaded = function() {\n\t\t\tvar me = this;\n\t\t\treturn me._serverConfigLoaded || false;\n\t\t};\n\n\t\tUE.Editor.prototype.afterConfigReady = function(handler) {\n\t\t\tif (!handler || !utils.isFunction(handler)) return;\n\t\t\tvar me = this;\n\t\t\tvar readyHandler = function() {\n\t\t\t\thandler.apply(me, arguments);\n\t\t\t\tme.removeListener('serverConfigLoaded', readyHandler);\n\t\t\t};\n\n\t\t\tif (me.isServerConfigLoaded()) {\n\t\t\t\thandler.call(me, 'serverConfigLoaded');\n\t\t\t} else {\n\t\t\t\tme.addListener('serverConfigLoaded', readyHandler);\n\t\t\t}\n\t\t};\n\n\t})();\n\n\t// core/ajax.js\n\t/**\n\t * @file\n\t * @module UE.ajax\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 提供对ajax请求的支持\n\t * @module UE.ajax\n\t */\n\tUE.ajax = function() {\n\n\t\t//创建一个ajaxRequest对象\n\t\tvar fnStr = 'XMLHttpRequest()';\n\t\ttry {\n\t\t\tnew ActiveXObject(\"Msxml2.XMLHTTP\");\n\t\t\tfnStr = 'ActiveXObject(\\'Msxml2.XMLHTTP\\')';\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tnew ActiveXObject(\"Microsoft.XMLHTTP\");\n\t\t\t\tfnStr = 'ActiveXObject(\\'Microsoft.XMLHTTP\\')'\n\t\t\t} catch (e) {}\n\t\t}\n\t\tvar creatAjaxRequest = new Function('return new ' + fnStr);\n\n\t\t/**\n\t\t * 将json参数转化成适合ajax提交的参数列表\n\t\t * @param json\n\t\t */\n\t\tfunction json2str(json) {\n\t\t\tvar strArr = [];\n\t\t\tfor (var i in json) {\n\t\t\t\t//忽略默认的几个参数\n\t\t\t\tif (i == \"method\" || i == \"timeout\" || i == \"async\" || i == \"dataType\" || i == \"callback\") continue;\n\t\t\t\t//忽略控制\n\t\t\t\tif (json[i] == undefined || json[i] == null) continue;\n\t\t\t\t//传递过来的对象和函数不在提交之列\n\t\t\t\tif (!((typeof json[i]).toLowerCase() == \"function\" || (typeof json[i]).toLowerCase() == \"object\")) {\n\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"=\" + encodeURIComponent(json[i]));\n\t\t\t\t} else if (utils.isArray(json[i])) {\n\t\t\t\t\t//支持传数组内容\n\t\t\t\t\tfor (var j = 0; j < json[i].length; j++) {\n\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"[]=\" + encodeURIComponent(json[i][j]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn strArr.join(\"&\");\n\t\t}\n\n\t\tfunction doAjax(url, ajaxOptions) {\n\t\t\tvar xhr = creatAjaxRequest(),\n\t\t\t\t//是否超时\n\t\t\t\ttimeIsOut = false,\n\t\t\t\t//默认参数\n\t\t\t\tdefaultAjaxOptions = {\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\ttimeout: 5000,\n\t\t\t\t\tasync: true,\n\t\t\t\t\tdata: {}, //需要传递对象的话只能覆盖\n\t\t\t\t\tonsuccess: function() {},\n\t\t\t\t\tonerror: function() {}\n\t\t\t\t};\n\n\t\t\tif (typeof url === \"object\") {\n\t\t\t\tajaxOptions = url;\n\t\t\t\turl = ajaxOptions.url;\n\t\t\t}\n\t\t\tif (!xhr || !url) return;\n\t\t\tvar ajaxOpts = ajaxOptions ? utils.extend(defaultAjaxOptions, ajaxOptions) : defaultAjaxOptions;\n\n\t\t\tvar submitStr = json2str(ajaxOpts); // { name:\"Jim\",city:\"Beijing\" } --> \"name=Jim&city=Beijing\"\n\t\t\t//如果用户直接通过data参数传递json对象过来，则也要将此json对象转化为字符串\n\t\t\tif (!utils.isEmptyObject(ajaxOpts.data)) {\n\t\t\t\tsubmitStr += (submitStr ? \"&\" : \"\") + json2str(ajaxOpts.data);\n\t\t\t}\n\t\t\t//超时检测\n\t\t\tvar timerID = setTimeout(function() {\n\t\t\t\tif (xhr.readyState != 4) {\n\t\t\t\t\ttimeIsOut = true;\n\t\t\t\t\txhr.abort();\n\t\t\t\t\tclearTimeout(timerID);\n\t\t\t\t}\n\t\t\t}, ajaxOpts.timeout);\n\n\t\t\tvar method = ajaxOpts.method.toUpperCase();\n\t\t\tvar str = url + (url.indexOf(\"?\") == -1 ? \"?\" : \"&\") + (method == \"POST\" ? \"\" : submitStr + \"&noCache=\" + +new Date);\n\t\t\txhr.open(method, str, ajaxOpts.async);\n\t\t\txhr.onreadystatechange = function() {\n\t\t\t\tif (xhr.readyState == 4) {\n\t\t\t\t\tif (!timeIsOut && xhr.status == 200) {\n\t\t\t\t\t\tajaxOpts.onsuccess(xhr);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tajaxOpts.onerror(xhr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (method == \"POST\") {\n\t\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\t\t\t\txhr.send(submitStr);\n\t\t\t} else {\n\t\t\t\txhr.send(null);\n\t\t\t}\n\t\t}\n\n\t\tfunction doJsonp(url, opts) {\n\n\t\t\tvar successhandler = opts.onsuccess || function() {},\n\t\t\t\tscr = document.createElement('SCRIPT'),\n\t\t\t\toptions = opts || {},\n\t\t\t\tcharset = options['charset'],\n\t\t\t\tcallbackField = options['jsonp'] || 'callback',\n\t\t\t\tcallbackFnName,\n\t\t\t\ttimeOut = options['timeOut'] || 0,\n\t\t\t\ttimer,\n\t\t\t\treg = new RegExp('(\\\\?|&)' + callbackField + '=([^&]*)'),\n\t\t\t\tmatches;\n\n\t\t\tif (utils.isFunction(successhandler)) {\n\t\t\t\tcallbackFnName = 'bd__editor__' + Math.floor(Math.random() * 2147483648).toString(36);\n\t\t\t\twindow[callbackFnName] = getCallBack(0);\n\t\t\t} else if (utils.isString(successhandler)) {\n\t\t\t\tcallbackFnName = successhandler;\n\t\t\t} else {\n\t\t\t\tif (matches = reg.exec(url)) {\n\t\t\t\t\tcallbackFnName = matches[2];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\turl = url.replace(reg, '\\x241' + callbackField + '=' + callbackFnName);\n\n\t\t\tif (url.search(reg) < 0) {\n\t\t\t\turl += (url.indexOf('?') < 0 ? '?' : '&') + callbackField + '=' + callbackFnName;\n\t\t\t}\n\n\t\t\tvar queryStr = json2str(opts); // { name:\"Jim\",city:\"Beijing\" } --> \"name=Jim&city=Beijing\"\n\t\t\t//如果用户直接通过data参数传递json对象过来，则也要将此json对象转化为字符串\n\t\t\tif (!utils.isEmptyObject(opts.data)) {\n\t\t\t\tqueryStr += (queryStr ? \"&\" : \"\") + json2str(opts.data);\n\t\t\t}\n\t\t\tif (queryStr) {\n\t\t\t\turl = url.replace(/\\?/, '?' + queryStr + '&');\n\t\t\t}\n\n\t\t\tscr.onerror = getCallBack(1);\n\t\t\tif (timeOut) {\n\t\t\t\ttimer = setTimeout(getCallBack(1), timeOut);\n\t\t\t}\n\t\t\tcreateScriptTag(scr, url, charset);\n\n\t\t\tfunction createScriptTag(scr, url, charset) {\n\t\t\t\tscr.setAttribute('type', 'text/javascript');\n\t\t\t\tscr.setAttribute('defer', 'defer');\n\t\t\t\tcharset && scr.setAttribute('charset', charset);\n\t\t\t\tscr.setAttribute('src', url);\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(scr);\n\t\t\t}\n\n\t\t\tfunction getCallBack(onTimeOut) {\n\t\t\t\treturn function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (onTimeOut) {\n\t\t\t\t\t\t\toptions.onerror && options.onerror();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t\t\t\tsuccesshandler.apply(window, arguments);\n\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (exception) {\n\t\t\t\t\t\toptions.onerror && options.onerror.call(window, exception);\n\t\t\t\t\t} finally {\n\t\t\t\t\t\toptions.oncomplete && options.oncomplete.apply(window, arguments);\n\t\t\t\t\t\tscr.parentNode && scr.parentNode.removeChild(scr);\n\t\t\t\t\t\twindow[callbackFnName] = null;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdelete window[callbackFnName];\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\t/**\n\t\t\t * 根据给定的参数项，向指定的url发起一个ajax请求。 ajax请求完成后，会根据请求结果调用相应回调： 如果请求\n\t\t\t * 成功， 则调用onsuccess回调， 失败则调用 onerror 回调\n\t\t\t * @method request\n\t\t\t * @param { URLString } url ajax请求的url地址\n\t\t\t * @param { Object } ajaxOptions ajax请求选项的键值对，支持的选项如下：\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //向sayhello.php发起一个异步的Ajax GET请求, 请求超时时间为10s， 请求完成后执行相应的回调。\n\t\t\t * UE.ajax.requeset( 'sayhello.php', {\n\t\t\t *\n\t\t\t *     //请求方法。可选值： 'GET', 'POST'，默认值是'POST'\n\t\t\t *     method: 'GET',\n\t\t\t *\n\t\t\t *     //超时时间。 默认为5000， 单位是ms\n\t\t\t *     timeout: 10000,\n\t\t\t *\n\t\t\t *     //是否是异步请求。 true为异步请求， false为同步请求\n\t\t\t *     async: true,\n\t\t\t *\n\t\t\t *     //请求携带的数据。如果请求为GET请求， data会经过stringify后附加到请求url之后。\n\t\t\t *     data: {\n\t\t\t *         name: 'ueditor'\n\t\t\t *     },\n\t\t\t *\n\t\t\t *     //请求成功后的回调， 该回调接受当前的XMLHttpRequest对象作为参数。\n\t\t\t *     onsuccess: function ( xhr ) {\n\t\t\t *         console.log( xhr.responseText );\n\t\t\t *     },\n\t\t\t *\n\t\t\t *     //请求失败或者超时后的回调。\n\t\t\t *     onerror: function ( xhr ) {\n\t\t\t *          alert( 'Ajax请求失败' );\n\t\t\t *     }\n\t\t\t *\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 根据给定的参数项发起一个ajax请求， 参数项里必须包含一个url地址。 ajax请求完成后，会根据请求结果调用相应回调： 如果请求\n\t\t\t * 成功， 则调用onsuccess回调， 失败则调用 onerror 回调。\n\t\t\t * @method request\n\t\t\t * @warning 如果在参数项里未提供一个key为“url”的地址值，则该请求将直接退出。\n\t\t\t * @param { Object } ajaxOptions ajax请求选项的键值对，支持的选项如下：\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * //向sayhello.php发起一个异步的Ajax POST请求, 请求超时时间为5s， 请求完成后不执行任何回调。\n\t\t\t * UE.ajax.requeset( 'sayhello.php', {\n\t\t\t *\n\t\t\t *     //请求的地址， 该项是必须的。\n\t\t\t *     url: 'sayhello.php'\n\t\t\t *\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\trequest: function(url, opts) {\n\t\t\t\tif (opts && opts.dataType == 'jsonp') {\n\t\t\t\t\tdoJsonp(url, opts);\n\t\t\t\t} else {\n\t\t\t\t\tdoAjax(url, opts);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetJSONP: function(url, data, fn) {\n\t\t\t\tvar opts = {\n\t\t\t\t\t'data': data,\n\t\t\t\t\t'oncomplete': fn\n\t\t\t\t};\n\t\t\t\tdoJsonp(url, opts);\n\t\t\t}\n\t\t};\n\n\t}();\n\n\t// core/filterword.js\n\t/**\n\t * UE过滤word的静态方法\n\t * @file\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @module UE\n\t */\n\n\t/**\n\t * 根据传入html字符串过滤word\n\t * @module UE\n\t * @since 1.2.6.1\n\t * @method filterWord\n\t * @param { String } html html字符串\n\t * @return { String } 已过滤后的结果字符串\n\t * @example\n\t * ```javascript\n\t * UE.filterWord(html);\n\t * ```\n\t */\n\tvar filterWord = UE.filterWord = function() {\n\n\t\t//是否是word过来的内容\n\t\tfunction isWordDocument(str) {\n\t\t\treturn /(class=\"?Mso|style=\"[^\"]*\\bmso\\-|w:WordDocument|<(v|o):|lang=)/ig.test(str);\n\t\t}\n\t\t//去掉小数\n\t\tfunction transUnit(v) {\n\t\t\tv = v.replace(/[\\d.]+\\w+/g, function(m) {\n\t\t\t\treturn utils.transUnitToPx(m);\n\t\t\t});\n\t\t\treturn v;\n\t\t}\n\n\t\tfunction filterPasteWord(str) {\n\t\t\treturn str.replace(/[\\t\\r\\n]+/g, ' ')\n\t\t\t\t.replace(/<!--[\\s\\S]*?-->/ig, \"\")\n\t\t\t\t//转换图片\n\t\t\t\t.replace(/<v:shape [^>]*>[\\s\\S]*?.<\\/v:shape>/gi, function(str) {\n\t\t\t\t\t//opera能自己解析出image所这里直接返回空\n\t\t\t\t\tif (browser.opera) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//有可能是bitmap占为图，无用，直接过滤掉，主要体现在粘贴excel表格中\n\t\t\t\t\t\tif (/Bitmap/i.test(str)) {\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar width = str.match(/width:([ \\d.]*p[tx])/i)[1],\n\t\t\t\t\t\t\theight = str.match(/height:([ \\d.]*p[tx])/i)[1],\n\t\t\t\t\t\t\tsrc = str.match(/src=\\s*\"([^\"]*)\"/i)[1];\n\t\t\t\t\t\treturn '<img width=\"' + transUnit(width) + '\" height=\"' + transUnit(height) + '\" src=\"' + src + '\" />';\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t//针对wps添加的多余标签处理\n\t\t\t\t.replace(/<\\/?div[^>]*>/g, '')\n\t\t\t\t//去掉多余的属性\n\t\t\t\t.replace(/v:\\w+=([\"']?)[^'\"]+\\1/g, '')\n\t\t\t\t.replace(/<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|xml|meta|link|style|\\w+:\\w+)(?=[\\s\\/>]))[^>]*>/gi, \"\")\n\t\t\t\t.replace(/<p [^>]*class=\"?MsoHeading\"?[^>]*>(.*?)<\\/p>/gi, \"<p><strong>$1</strong></p>\")\n\t\t\t\t//去掉多余的属性\n\t\t\t\t.replace(/\\s+(class|lang|align)\\s*=\\s*(['\"]?)([\\w-]+)\\2/ig, function(str, name, marks, val) {\n\t\t\t\t\t//保留list的标示\n\t\t\t\t\treturn name == 'class' && val == 'MsoListParagraph' ? str : ''\n\t\t\t\t})\n\t\t\t\t//清除多余的font/span不能匹配&nbsp;有可能是空格\n\t\t\t\t.replace(/<(font|span)[^>]*>(\\s*)<\\/\\1>/gi, function(a, b, c) {\n\t\t\t\t\treturn c.replace(/[\\t\\r\\n ]+/g, ' ')\n\t\t\t\t})\n\t\t\t\t//处理style的问题\n\t\t\t\t.replace(/(<[a-z][^>]*)\\sstyle=([\"'])([^\\2]*?)\\2/gi, function(str, tag, tmp, style) {\n\t\t\t\t\tvar n = [],\n\t\t\t\t\t\ts = style.replace(/^\\s+|\\s+$/, '')\n\t\t\t\t\t\t.replace(/&#39;/g, '\\'')\n\t\t\t\t\t\t.replace(/&quot;/gi, \"'\")\n\t\t\t\t\t\t.replace(/[\\d.]+(cm|pt)/g, function(str) {\n\t\t\t\t\t\t\treturn utils.transUnitToPx(str)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.split(/;\\s*/g);\n\n\t\t\t\t\tfor (var i = 0, v; v = s[i]; i++) {\n\n\t\t\t\t\t\tvar name, value,\n\t\t\t\t\t\t\tparts = v.split(\":\");\n\n\t\t\t\t\t\tif (parts.length == 2) {\n\t\t\t\t\t\t\tname = parts[0].toLowerCase();\n\t\t\t\t\t\t\tvalue = parts[1].toLowerCase();\n\t\t\t\t\t\t\tif (/^(background)\\w*/.test(name) && value.replace(/(initial|\\s)/g, '').length == 0 ||\n\t\t\t\t\t\t\t\t/^(margin)\\w*/.test(name) && /^0\\w+$/.test(value)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tswitch (name) {\n\t\t\t\t\t\t\t\tcase \"mso-padding-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-top-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-right-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-bottom-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-left-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-top-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-right-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-bottom-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-left-alt\":\n\t\t\t\t\t\t\t\t\t//ie下会出现挤到一起的情况\n\t\t\t\t\t\t\t\t\t//case \"mso-table-layout-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-height\":\n\t\t\t\t\t\t\t\tcase \"mso-width\":\n\t\t\t\t\t\t\t\tcase \"mso-vertical-align-alt\":\n\t\t\t\t\t\t\t\t\t//trace:1819 ff下会解析出padding在table上\n\t\t\t\t\t\t\t\t\tif (!/<table/.test(tag))\n\t\t\t\t\t\t\t\t\t\tn[i] = name.replace(/^mso-|-alt$/g, \"\") + \":\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\tcase \"horiz-align\":\n\t\t\t\t\t\t\t\t\tn[i] = \"text-align:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"vert-align\":\n\t\t\t\t\t\t\t\t\tn[i] = \"vertical-align:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"font-color\":\n\t\t\t\t\t\t\t\tcase \"mso-foreground\":\n\t\t\t\t\t\t\t\t\tn[i] = \"color:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-background\":\n\t\t\t\t\t\t\t\tcase \"mso-highlight\":\n\t\t\t\t\t\t\t\t\tn[i] = \"background:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-default-height\":\n\t\t\t\t\t\t\t\t\tn[i] = \"min-height:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-default-width\":\n\t\t\t\t\t\t\t\t\tn[i] = \"min-width:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-padding-between-alt\":\n\t\t\t\t\t\t\t\t\tn[i] = \"border-collapse:separate;border-spacing:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"text-line-through\":\n\t\t\t\t\t\t\t\t\tif ((value == \"single\") || (value == \"double\")) {\n\t\t\t\t\t\t\t\t\t\tn[i] = \"text-decoration:line-through\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\tcase \"mso-zero-height\":\n\t\t\t\t\t\t\t\t\tif (value == \"yes\") {\n\t\t\t\t\t\t\t\t\t\tn[i] = \"display:none\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t//                                case 'background':\n\t\t\t\t\t\t\t\t\t//                                    break;\n\t\t\t\t\t\t\t\tcase 'margin':\n\t\t\t\t\t\t\t\t\tif (!/[1-9]/.test(value)) {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(name) ||\n\t\t\t\t\t\t\t\t/text\\-indent|padding|margin/.test(name) && /\\-[\\d.]+/.test(value)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tn[i] = name + \":\" + parts[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn tag + (n.length ? ' style=\"' + n.join(';').replace(/;{2,}/g, ';') + '\"' : '');\n\t\t\t\t})\n\n\t\t}\n\n\t\treturn function(html) {\n\t\t\treturn (isWordDocument(html) ? filterPasteWord(html) : html);\n\t\t};\n\t}();\n\n\t// core/node.js\n\t/**\n\t * 编辑器模拟的节点类\n\t * @file\n\t * @module UE\n\t * @class uNode\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t(function() {\n\n\t\t/**\n\t\t * 编辑器模拟的节点类\n\t\t * @unfile\n\t\t * @module UE\n\t\t * @class uNode\n\t\t */\n\n\t\t/**\n\t\t * 通过一个键值对，创建一个uNode对象\n\t\t * @constructor\n\t\t * @param { Object } attr 传入要创建的uNode的初始属性\n\t\t * @example\n\t\t * ```javascript\n\t\t * var node = new uNode({\n\t\t *     type:'element',\n\t\t *     tagName:'span',\n\t\t *     attrs:{style:'font-size:14px;'}\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tvar uNode = UE.uNode = function(obj) {\n\t\t\tthis.type = obj.type;\n\t\t\tthis.data = obj.data;\n\t\t\tthis.tagName = obj.tagName;\n\t\t\tthis.parentNode = obj.parentNode;\n\t\t\tthis.attrs = obj.attrs || {};\n\t\t\tthis.children = obj.children;\n\t\t};\n\n\t\tvar notTransAttrs = {\n\t\t\t'href': 1,\n\t\t\t'src': 1,\n\t\t\t'_src': 1,\n\t\t\t'_href': 1,\n\t\t\t'cdata_data': 1\n\t\t};\n\n\t\tvar notTransTagName = {\n\t\t\tstyle: 1,\n\t\t\tscript: 1\n\t\t};\n\n\t\tvar indentChar = '    ',\n\t\t\tbreakChar = '\\n';\n\n\t\tfunction insertLine(arr, current, begin) {\n\t\t\tarr.push(breakChar);\n\t\t\treturn current + (begin ? 1 : -1);\n\t\t}\n\n\t\tfunction insertIndent(arr, current) {\n\t\t\t//插入缩进\n\t\t\tfor (var i = 0; i < current; i++) {\n\t\t\t\tarr.push(indentChar);\n\t\t\t}\n\t\t}\n\n\t\t//创建uNode的静态方法\n\t\t//支持标签和html\n\t\tuNode.createElement = function(html) {\n\t\t\tif (/[<>]/.test(html)) {\n\t\t\t\treturn UE.htmlparser(html).children[0]\n\t\t\t} else {\n\t\t\t\treturn new uNode({\n\t\t\t\t\ttype: 'element',\n\t\t\t\t\tchildren: [],\n\t\t\t\t\ttagName: html\n\t\t\t\t})\n\t\t\t}\n\t\t};\n\t\tuNode.createText = function(data, noTrans) {\n\t\t\treturn new UE.uNode({\n\t\t\t\ttype: 'text',\n\t\t\t\t'data': noTrans ? data : utils.unhtml(data || '')\n\t\t\t})\n\t\t};\n\n\t\tfunction nodeToHtml(node, arr, formatter, current) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'root':\n\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\t\t//插入新行\n\t\t\t\t\t\tif (formatter && ci.type == 'element' && !dtd.$inlineWithA[ci.tagName] && i > 1) {\n\t\t\t\t\t\t\tinsertLine(arr, current, true);\n\t\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnodeToHtml(ci, arr, formatter, current)\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'text':\n\t\t\t\t\tisText(node, arr);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'element':\n\t\t\t\t\tisElement(node, arr, formatter, current);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'comment':\n\t\t\t\t\tisComment(node, arr, formatter);\n\t\t\t}\n\t\t\treturn arr;\n\t\t}\n\n\t\tfunction isText(node, arr) {\n\t\t\tif (node.parentNode.tagName == 'pre') {\n\t\t\t\t//源码模式下输入html标签，不能做转换处理，直接输出\n\t\t\t\tarr.push(node.data)\n\t\t\t} else {\n\t\t\t\tarr.push(notTransTagName[node.parentNode.tagName] ? utils.html(node.data) : node.data.replace(/[ ]{2}/g, ' &nbsp;'))\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isElement(node, arr, formatter, current) {\n\t\t\tvar attrhtml = '';\n\t\t\tif (node.attrs) {\n\t\t\t\tattrhtml = [];\n\t\t\t\tvar attrs = node.attrs;\n\t\t\t\tfor (var a in attrs) {\n\t\t\t\t\t//这里就针对\n\t\t\t\t\t//<p>'<img src='http://nsclick.baidu.com/u.gif?&asdf=\\\"sdf&asdfasdfs;asdf'></p>\n\t\t\t\t\t//这里边的\\\"做转换，要不用innerHTML直接被截断了，属性src\n\t\t\t\t\t//有可能做的不够\n\t\t\t\t\tattrhtml.push(a + (attrs[a] !== undefined ? '=\"' + (notTransAttrs[a] ? utils.html(attrs[a]).replace(/[\"]/g, function(a) {\n\t\t\t\t\t\treturn '&quot;'\n\t\t\t\t\t}) : utils.unhtml(attrs[a])) + '\"' : ''))\n\t\t\t\t}\n\t\t\t\tattrhtml = attrhtml.join(' ');\n\t\t\t}\n\t\t\tarr.push('<' + node.tagName +\n\t\t\t\t(attrhtml ? ' ' + attrhtml : '') +\n\t\t\t\t(dtd.$empty[node.tagName] ? '\\/' : '') + '>'\n\t\t\t);\n\t\t\t//插入新行\n\t\t\tif (formatter && !dtd.$inlineWithA[node.tagName] && node.tagName != 'pre') {\n\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\tcurrent = insertLine(arr, current, true);\n\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (node.children && node.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\tif (formatter && ci.type == 'element' && !dtd.$inlineWithA[ci.tagName] && i > 1) {\n\t\t\t\t\t\tinsertLine(arr, current);\n\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t}\n\t\t\t\t\tnodeToHtml(ci, arr, formatter, current)\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!dtd.$empty[node.tagName]) {\n\t\t\t\tif (formatter && !dtd.$inlineWithA[node.tagName] && node.tagName != 'pre') {\n\n\t\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\t\tcurrent = insertLine(arr, current);\n\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tarr.push('<\\/' + node.tagName + '>');\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isComment(node, arr) {\n\t\t\tarr.push('<!--' + node.data + '-->');\n\t\t}\n\n\t\tfunction getNodeById(root, id) {\n\t\t\tvar node;\n\t\t\tif (root.type == 'element' && root.getAttr('id') == id) {\n\t\t\t\treturn root;\n\t\t\t}\n\t\t\tif (root.children && root.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = root.children[i++];) {\n\t\t\t\t\tif (node = getNodeById(ci, id)) {\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction getNodesByTagName(node, tagName, arr) {\n\t\t\tif (node.type == 'element' && node.tagName == tagName) {\n\t\t\t\tarr.push(node);\n\t\t\t}\n\t\t\tif (node.children && node.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\tgetNodesByTagName(ci, tagName, arr)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction nodeTraversal(root, fn) {\n\t\t\tif (root.children && root.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = root.children[i];) {\n\t\t\t\t\tnodeTraversal(ci, fn);\n\t\t\t\t\t//ci被替换的情况，这里就不再走 fn了\n\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\tif (ci.children && ci.children.length) {\n\t\t\t\t\t\t\tfn(ci)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ci.parentNode) i++\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfn(root)\n\t\t\t}\n\n\t\t}\n\t\tuNode.prototype = {\n\n\t\t\t/**\n\t\t\t * 当前节点对象，转换成html文本\n\t\t\t * @method toHtml\n\t\t\t * @return { String } 返回转换后的html字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.toHtml();\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 当前节点对象，转换成html文本\n\t\t\t * @method toHtml\n\t\t\t * @param { Boolean } formatter 是否格式化返回值\n\t\t\t * @return { String } 返回转换后的html字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.toHtml( true );\n\t\t\t * ```\n\t\t\t */\n\t\t\ttoHtml: function(formatter) {\n\t\t\t\tvar arr = [];\n\t\t\t\tnodeToHtml(this, arr, formatter, 0);\n\t\t\t\treturn arr.join('')\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取节点的html内容\n\t\t\t * @method innerHTML\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @return { String } 返回节点的html内容\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var htmlstr = node.innerHTML();\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 设置节点的html内容\n\t\t\t * @method innerHTML\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @param { String } htmlstr 传入要设置的html内容\n\t\t\t * @return { UE.uNode } 返回节点本身\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.innerHTML('<span>text</span>');\n\t\t\t * ```\n\t\t\t */\n\t\t\tinnerHTML: function(htmlstr) {\n\t\t\t\tif (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tif (utils.isString(htmlstr)) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.children = [];\n\t\t\t\t\tvar tmpRoot = UE.htmlparser(htmlstr);\n\t\t\t\t\tfor (var i = 0, ci; ci = tmpRoot.children[i++];) {\n\t\t\t\t\t\tthis.children.push(ci);\n\t\t\t\t\t\tci.parentNode = this;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t} else {\n\t\t\t\t\tvar tmpRoot = new UE.uNode({\n\t\t\t\t\t\ttype: 'root',\n\t\t\t\t\t\tchildren: this.children\n\t\t\t\t\t});\n\t\t\t\t\treturn tmpRoot.toHtml();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取节点的纯文本内容\n\t\t\t * @method innerText\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @return { String } 返回节点的存文本内容\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var textStr = node.innerText();\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 设置节点的纯文本内容\n\t\t\t * @method innerText\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @param { String } textStr 传入要设置的文本内容\n\t\t\t * @return { UE.uNode } 返回节点本身\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.innerText('<span>text</span>');\n\t\t\t * ```\n\t\t\t */\n\t\t\tinnerText: function(textStr, noTrans) {\n\t\t\t\tif (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tif (textStr) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.children = [];\n\t\t\t\t\tthis.appendChild(uNode.createText(textStr, noTrans));\n\t\t\t\t\treturn this;\n\t\t\t\t} else {\n\t\t\t\t\treturn this.toHtml().replace(/<[^>]+>/g, '');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前对象的data属性\n\t\t\t * @method getData\n\t\t\t * @return { Object } 若节点的type值是elemenet，返回空字符串，否则返回节点的data属性\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getData();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetData: function() {\n\t\t\t\tif (this.type == 'element')\n\t\t\t\t\treturn '';\n\t\t\t\treturn this.data\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点下的第一个子节点\n\t\t\t * @method firstChild\n\t\t\t * @return { UE.uNode } 返回第一个子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.firstChild(); //返回第一个子节点\n\t\t\t * ```\n\t\t\t */\n\t\t\tfirstChild: function() {\n\t\t\t\t//            if (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t//                return this;\n\t\t\t\t//            }\n\t\t\t\treturn this.children ? this.children[0] : null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点下的最后一个子节点\n\t\t\t * @method lastChild\n\t\t\t * @return { UE.uNode } 返回最后一个子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.lastChild(); //返回最后一个子节点\n\t\t\t * ```\n\t\t\t */\n\t\t\tlastChild: function() {\n\t\t\t\t//            if (this.type != 'element' || dtd.$empty[this.tagName] ) {\n\t\t\t\t//                return this;\n\t\t\t\t//            }\n\t\t\t\treturn this.children ? this.children[this.children.length - 1] : null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取和当前节点有相同父亲节点的前一个节点\n\t\t\t * @method previousSibling\n\t\t\t * @return { UE.uNode } 返回前一个节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.children[2].previousSibling(); //返回子节点node.children[1]\n\t\t\t * ```\n\t\t\t */\n\t\t\tpreviousSibling: function() {\n\t\t\t\tvar parent = this.parentNode;\n\t\t\t\tfor (var i = 0, ci; ci = parent.children[i]; i++) {\n\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\treturn i == 0 ? null : parent.children[i - 1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取和当前节点有相同父亲节点的后一个节点\n\t\t\t * @method nextSibling\n\t\t\t * @return { UE.uNode } 返回后一个节点,找不到返回null\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.children[2].nextSibling(); //如果有，返回子节点node.children[3]\n\t\t\t * ```\n\t\t\t */\n\t\t\tnextSibling: function() {\n\t\t\t\tvar parent = this.parentNode;\n\t\t\t\tfor (var i = 0, ci; ci = parent.children[i++];) {\n\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\treturn parent.children[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 用新的节点替换当前节点\n\t\t\t * @method replaceChild\n\t\t\t * @param { UE.uNode } target 要替换成该节点参数\n\t\t\t * @param { UE.uNode } source 要被替换掉的节点\n\t\t\t * @return { UE.uNode } 返回替换之后的节点对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.replaceChild(newNode, childNode); //用newNode替换childNode,childNode是node的子节点\n\t\t\t * ```\n\t\t\t */\n\t\t\treplaceChild: function(target, source) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\tthis.children.splice(i, 1, target);\n\t\t\t\t\t\t\tsource.parentNode = null;\n\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在节点的子节点列表最后位置插入一个节点\n\t\t\t * @method appendChild\n\t\t\t * @param { UE.uNode } node 要插入的节点\n\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.appendChild( newNode ); //在node内插入子节点newNode\n\t\t\t * ```\n\t\t\t */\n\t\t\tappendChild: function(node) {\n\t\t\t\tif (this.type == 'root' || (this.type == 'element' && !dtd.$empty[this.tagName])) {\n\t\t\t\t\tif (!this.children) {\n\t\t\t\t\t\tthis.children = []\n\t\t\t\t\t}\n\t\t\t\t\tif (node.parentNode) {\n\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === node) {\n\t\t\t\t\t\t\tthis.children.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.children.push(node);\n\t\t\t\t\tnode.parentNode = this;\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在传入节点的前面插入一个节点\n\t\t\t * @method insertBefore\n\t\t\t * @param { UE.uNode } target 要插入的节点\n\t\t\t * @param { UE.uNode } source 在该参数节点前面插入\n\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.parentNode.insertBefore(newNode, node); //在node节点后面插入newNode\n\t\t\t * ```\n\t\t\t */\n\t\t\tinsertBefore: function(target, source) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\tthis.children.splice(i, 0, target);\n\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在传入节点的后面插入一个节点\n\t\t\t * @method insertAfter\n\t\t\t * @param { UE.uNode } target 要插入的节点\n\t\t\t * @param { UE.uNode } source 在该参数节点后面插入\n\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.parentNode.insertAfter(newNode, node); //在node节点后面插入newNode\n\t\t\t * ```\n\t\t\t */\n\t\t\tinsertAfter: function(target, source) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\tthis.children.splice(i + 1, 0, target);\n\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 从当前节点的子节点列表中，移除节点\n\t\t\t * @method removeChild\n\t\t\t * @param { UE.uNode } node 要移除的节点引用\n\t\t\t * @param { Boolean } keepChildren 是否保留移除节点的子节点，若传入true，自动把移除节点的子节点插入到移除的位置\n\t\t\t * @return { * } 返回刚移除的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.removeChild(childNode,true); //在node的子节点列表中移除child节点，并且吧child的子节点插入到移除的位置\n\t\t\t * ```\n\t\t\t */\n\t\t\tremoveChild: function(node, keepChildren) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === node) {\n\t\t\t\t\t\t\tthis.children.splice(i, 1);\n\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t\tif (keepChildren && ci.children && ci.children.length) {\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci.children[j]; j++) {\n\t\t\t\t\t\t\t\t\tthis.children.splice(i + j, 0, cj);\n\t\t\t\t\t\t\t\t\tcj.parentNode = this;\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn ci;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点所代表的元素属性，即获取attrs对象下的属性值\n\t\t\t * @method getAttr\n\t\t\t * @param { String } attrName 要获取的属性名称\n\t\t\t * @return { * } 返回attrs对象下的属性值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getAttr('title');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetAttr: function(attrName) {\n\t\t\t\treturn this.attrs && this.attrs[attrName.toLowerCase()]\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置当前节点所代表的元素属性，即设置attrs对象下的属性值\n\t\t\t * @method setAttr\n\t\t\t * @param { String } attrName 要设置的属性名称\n\t\t\t * @param { * } attrVal 要设置的属性值，类型视设置的属性而定\n\t\t\t * @return { * } 返回attrs对象下的属性值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.setAttr('title','标题');\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetAttr: function(attrName, attrVal) {\n\t\t\t\tif (!attrName) {\n\t\t\t\t\tdelete this.attrs;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.attrs) {\n\t\t\t\t\tthis.attrs = {};\n\t\t\t\t}\n\t\t\t\tif (utils.isObject(attrName)) {\n\t\t\t\t\tfor (var a in attrName) {\n\t\t\t\t\t\tif (!attrName[a]) {\n\t\t\t\t\t\t\tdelete this.attrs[a]\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.attrs[a.toLowerCase()] = attrName[a];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!attrVal) {\n\t\t\t\t\t\tdelete this.attrs[attrName]\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.attrs[attrName.toLowerCase()] = attrVal;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点在父节点下的位置索引\n\t\t\t * @method getIndex\n\t\t\t * @return { Number } 返回索引数值，如果没有父节点，返回-1\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getIndex();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetIndex: function() {\n\t\t\t\tvar parent = this.parentNode;\n\t\t\t\tfor (var i = 0, ci; ci = parent.children[i]; i++) {\n\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在当前节点下，根据id查找节点\n\t\t\t * @method getNodeById\n\t\t\t * @param { String } id 要查找的id\n\t\t\t * @return { UE.uNode } 返回找到的节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getNodeById('textId');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetNodeById: function(id) {\n\t\t\t\tvar node;\n\t\t\t\tif (this.children && this.children.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\tif (node = getNodeById(ci, id)) {\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在当前节点下，根据元素名称查找节点列表\n\t\t\t * @method getNodesByTagName\n\t\t\t * @param { String } tagNames 要查找的元素名称\n\t\t\t * @return { Array } 返回找到的节点列表\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getNodesByTagName('span');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetNodesByTagName: function(tagNames) {\n\t\t\t\ttagNames = utils.trim(tagNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\tvar arr = [],\n\t\t\t\t\tme = this;\n\t\t\t\tutils.each(tagNames, function(tagName) {\n\t\t\t\t\tif (me.children && me.children.length) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = me.children[i++];) {\n\t\t\t\t\t\t\tgetNodesByTagName(ci, tagName, arr)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn arr;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据样式名称，获取节点的样式值\n\t\t\t * @method getStyle\n\t\t\t * @param { String } name 要获取的样式名称\n\t\t\t * @return { String } 返回样式值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getStyle('font-size');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetStyle: function(name) {\n\t\t\t\tvar cssStyle = this.getAttr('style');\n\t\t\t\tif (!cssStyle) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\t\t\t\tvar reg = new RegExp('(^|;)\\\\s*' + name + ':([^;]+)', 'i');\n\t\t\t\tvar match = cssStyle.match(reg);\n\t\t\t\tif (match && match[0]) {\n\t\t\t\t\treturn match[2]\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 给节点设置样式\n\t\t\t * @method setStyle\n\t\t\t * @param { String } name 要设置的的样式名称\n\t\t\t * @param { String } val 要设置的的样值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.setStyle('font-size', '12px');\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStyle: function(name, val) {\n\t\t\t\tfunction exec(name, val) {\n\t\t\t\t\tvar reg = new RegExp('(^|;)\\\\s*' + name + ':([^;]+;?)', 'gi');\n\t\t\t\t\tcssStyle = cssStyle.replace(reg, '$1');\n\t\t\t\t\tif (val) {\n\t\t\t\t\t\tcssStyle = name + ':' + utils.unhtml(val) + ';' + cssStyle\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar cssStyle = this.getAttr('style');\n\t\t\t\tif (!cssStyle) {\n\t\t\t\t\tcssStyle = '';\n\t\t\t\t}\n\t\t\t\tif (utils.isObject(name)) {\n\t\t\t\t\tfor (var a in name) {\n\t\t\t\t\t\texec(a, name[a])\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\texec(name, val)\n\t\t\t\t}\n\t\t\t\tthis.setAttr('style', utils.trim(cssStyle))\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 传入一个函数，递归遍历当前节点下的所有节点\n\t\t\t * @method traversal\n\t\t\t * @param { Function } fn 遍历到节点的时，传入节点作为参数，运行此函数\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * traversal(node, function(){\n\t\t\t *     console.log(node.type);\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\ttraversal: function(fn) {\n\t\t\t\tif (this.children && this.children.length) {\n\t\t\t\t\tnodeTraversal(this, fn);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t})();\n\n\t// core/htmlparser.js\n\t/**\n\t * html字符串转换成uNode节点\n\t * @file\n\t * @module UE\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t/**\n\t * html字符串转换成uNode节点的静态方法\n\t * @method htmlparser\n\t * @param { String } htmlstr 要转换的html代码\n\t * @param { Boolean } ignoreBlank 若设置为true，转换的时候忽略\\n\\r\\t等空白字符\n\t * @return { uNode } 给定的html片段转换形成的uNode对象\n\t * @example\n\t * ```javascript\n\t * var root = UE.htmlparser('<p><b>htmlparser</b></p>', true);\n\t * ```\n\t */\n\n\tvar htmlparser = UE.htmlparser = function(htmlstr, ignoreBlank) {\n\t\t//todo 原来的方式  [^\"'<>\\/] 有\\/就不能配对上 <TD vAlign=top background=../AAA.JPG> 这样的标签了\n\t\t//先去掉了，加上的原因忘了，这里先记录\n\t\tvar re_tag = /<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)-->)|(?:([^\\s\\/<>]+)\\s*((?:(?:\"[^\"]*\")|(?:'[^']*')|[^\"'<>])*)\\/?>))/g,\n\t\t\tre_attr = /([\\w\\-:.]+)(?:(?:\\s*=\\s*(?:(?:\"([^\"]*)\")|(?:'([^']*)')|([^\\s>]+)))|(?=\\s|$))/g;\n\n\t\t//ie下取得的html可能会有\\n存在，要去掉，在处理replace(/[\\t\\r\\n]*/g,'');代码高量的\\n不能去除\n\t\tvar allowEmptyTags = {\n\t\t\tb: 1,\n\t\t\tcode: 1,\n\t\t\ti: 1,\n\t\t\tu: 1,\n\t\t\tstrike: 1,\n\t\t\ts: 1,\n\t\t\ttt: 1,\n\t\t\tstrong: 1,\n\t\t\tq: 1,\n\t\t\tsamp: 1,\n\t\t\tem: 1,\n\t\t\tspan: 1,\n\t\t\tsub: 1,\n\t\t\timg: 1,\n\t\t\tsup: 1,\n\t\t\tfont: 1,\n\t\t\tbig: 1,\n\t\t\tsmall: 1,\n\t\t\tiframe: 1,\n\t\t\ta: 1,\n\t\t\tbr: 1,\n\t\t\tpre: 1\n\t\t};\n\t\thtmlstr = htmlstr.replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\tif (!ignoreBlank) {\n\t\t\thtmlstr = htmlstr.replace(new RegExp('[\\\\r\\\\t\\\\n' + (ignoreBlank ? '' : ' ') + ']*<\\/?(\\\\w+)\\\\s*(?:[^>]*)>[\\\\r\\\\t\\\\n' + (ignoreBlank ? '' : ' ') + ']*', 'g'), function(a, b) {\n\t\t\t\t//br暂时单独处理\n\t\t\t\tif (b && allowEmptyTags[b.toLowerCase()]) {\n\t\t\t\t\treturn a.replace(/(^[\\n\\r]+)|([\\n\\r]+$)/g, '');\n\t\t\t\t}\n\t\t\t\treturn a.replace(new RegExp('^[\\\\r\\\\n' + (ignoreBlank ? '' : ' ') + ']+'), '').replace(new RegExp('[\\\\r\\\\n' + (ignoreBlank ? '' : ' ') + ']+$'), '');\n\t\t\t});\n\t\t}\n\n\t\tvar notTransAttrs = {\n\t\t\t'href': 1,\n\t\t\t'src': 1\n\t\t};\n\n\t\tvar uNode = UE.uNode,\n\t\t\tneedParentNode = {\n\t\t\t\t'td': 'tr',\n\t\t\t\t'tr': ['tbody', 'thead', 'tfoot'],\n\t\t\t\t'tbody': 'table',\n\t\t\t\t'th': 'tr',\n\t\t\t\t'thead': 'table',\n\t\t\t\t'tfoot': 'table',\n\t\t\t\t'caption': 'table',\n\t\t\t\t'li': ['ul', 'ol'],\n\t\t\t\t'dt': 'dl',\n\t\t\t\t'dd': 'dl',\n\t\t\t\t'option': 'select'\n\t\t\t},\n\t\t\tneedChild = {\n\t\t\t\t'ol': 'li',\n\t\t\t\t'ul': 'li'\n\t\t\t};\n\n\t\tfunction text(parent, data) {\n\n\t\t\tif (needChild[parent.tagName]) {\n\t\t\t\tvar tmpNode = uNode.createElement(needChild[parent.tagName]);\n\t\t\t\tparent.appendChild(tmpNode);\n\t\t\t\ttmpNode.appendChild(uNode.createText(data));\n\t\t\t\tparent = tmpNode;\n\t\t\t} else {\n\n\t\t\t\tparent.appendChild(uNode.createText(data));\n\t\t\t}\n\t\t}\n\n\t\tfunction element(parent, tagName, htmlattr) {\n\t\t\tvar needParentTag;\n\t\t\tif (needParentTag = needParentNode[tagName]) {\n\t\t\t\tvar tmpParent = parent,\n\t\t\t\t\thasParent;\n\t\t\t\twhile (tmpParent.type != 'root') {\n\t\t\t\t\tif (utils.isArray(needParentTag) ? utils.indexOf(needParentTag, tmpParent.tagName) != -1 : needParentTag == tmpParent.tagName) {\n\t\t\t\t\t\tparent = tmpParent;\n\t\t\t\t\t\thasParent = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttmpParent = tmpParent.parentNode;\n\t\t\t\t}\n\t\t\t\tif (!hasParent) {\n\t\t\t\t\tparent = element(parent, utils.isArray(needParentTag) ? needParentTag[0] : needParentTag)\n\t\t\t\t}\n\t\t\t}\n\t\t\t//按dtd处理嵌套\n\t\t\t//        if(parent.type != 'root' && !dtd[parent.tagName][tagName])\n\t\t\t//            parent = parent.parentNode;\n\t\t\tvar elm = new uNode({\n\t\t\t\tparentNode: parent,\n\t\t\t\ttype: 'element',\n\t\t\t\ttagName: tagName.toLowerCase(),\n\t\t\t\t//是自闭合的处理一下\n\t\t\t\tchildren: dtd.$empty[tagName] ? null : []\n\t\t\t});\n\t\t\t//如果属性存在，处理属性\n\t\t\tif (htmlattr) {\n\t\t\t\tvar attrs = {},\n\t\t\t\t\tmatch;\n\t\t\t\twhile (match = re_attr.exec(htmlattr)) {\n\t\t\t\t\tattrs[match[1].toLowerCase()] = notTransAttrs[match[1].toLowerCase()] ? (match[2] || match[3] || match[4]) : utils.unhtml(match[2] || match[3] || match[4])\n\t\t\t\t}\n\t\t\t\telm.attrs = attrs;\n\t\t\t}\n\t\t\t//trace:3970\n\t\t\t//        //如果parent下不能放elm\n\t\t\t//        if(dtd.$inline[parent.tagName] && dtd.$block[elm.tagName] && !dtd[parent.tagName][elm.tagName]){\n\t\t\t//            parent = parent.parentNode;\n\t\t\t//            elm.parentNode = parent;\n\t\t\t//        }\n\t\t\tparent.children.push(elm);\n\t\t\t//如果是自闭合节点返回父亲节点\n\t\t\treturn dtd.$empty[tagName] ? parent : elm\n\t\t}\n\n\t\tfunction comment(parent, data) {\n\t\t\tparent.children.push(new uNode({\n\t\t\t\ttype: 'comment',\n\t\t\t\tdata: data,\n\t\t\t\tparentNode: parent\n\t\t\t}));\n\t\t}\n\n\t\tvar match, currentIndex = 0,\n\t\t\tnextIndex = 0;\n\t\t//设置根节点\n\t\tvar root = new uNode({\n\t\t\ttype: 'root',\n\t\t\tchildren: []\n\t\t});\n\t\tvar currentParent = root;\n\n\t\twhile (match = re_tag.exec(htmlstr)) {\n\t\t\tcurrentIndex = match.index;\n\t\t\ttry {\n\t\t\t\tif (currentIndex > nextIndex) {\n\t\t\t\t\t//text node\n\t\t\t\t\ttext(currentParent, htmlstr.slice(nextIndex, currentIndex));\n\t\t\t\t}\n\t\t\t\tif (match[3]) {\n\n\t\t\t\t\tif (dtd.$cdata[currentParent.tagName]) {\n\t\t\t\t\t\ttext(currentParent, match[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//start tag\n\t\t\t\t\t\tcurrentParent = element(currentParent, match[3].toLowerCase(), match[4]);\n\t\t\t\t\t}\n\n\t\t\t\t} else if (match[1]) {\n\t\t\t\t\tif (currentParent.type != 'root') {\n\t\t\t\t\t\tif (dtd.$cdata[currentParent.tagName] && !dtd.$cdata[match[1]]) {\n\t\t\t\t\t\t\ttext(currentParent, match[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpParent = currentParent;\n\t\t\t\t\t\t\twhile (currentParent.type == 'element' && currentParent.tagName != match[1].toLowerCase()) {\n\t\t\t\t\t\t\t\tcurrentParent = currentParent.parentNode;\n\t\t\t\t\t\t\t\tif (currentParent.type == 'root') {\n\t\t\t\t\t\t\t\t\tcurrentParent = tmpParent;\n\t\t\t\t\t\t\t\t\tthrow 'break'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//end tag\n\t\t\t\t\t\t\tcurrentParent = currentParent.parentNode;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if (match[2]) {\n\t\t\t\t\t//comment\n\t\t\t\t\tcomment(currentParent, match[2])\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\n\t\t\tnextIndex = re_tag.lastIndex;\n\n\t\t}\n\t\t//如果结束是文本，就有可能丢掉，所以这里手动判断一下\n\t\t//例如 <li>sdfsdfsdf<li>sdfsdfsdfsdf\n\t\tif (nextIndex < htmlstr.length) {\n\t\t\ttext(currentParent, htmlstr.slice(nextIndex));\n\t\t}\n\t\treturn root;\n\t};\n\n\t// core/filternode.js\n\t/**\n\t * UE过滤节点的静态方法\n\t * @file\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @module UE\n\t */\n\n\t/**\n\t * 根据传入节点和过滤规则过滤相应节点\n\t * @module UE\n\t * @since 1.2.6.1\n\t * @method filterNode\n\t * @param { Object } root 指定root节点\n\t * @param { Object } rules 过滤规则json对象\n\t * @example\n\t * ```javascript\n\t * UE.filterNode(root,editor.options.filterRules);\n\t * ```\n\t */\n\tvar filterNode = UE.filterNode = function() {\n\t\tfunction filterNode(node, rules) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'text':\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'element':\n\t\t\t\t\tvar val;\n\t\t\t\t\tif (val = rules[node.tagName]) {\n\t\t\t\t\t\tif (val === '-') {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t} else if (utils.isFunction(val)) {\n\t\t\t\t\t\t\tvar parentNode = node.parentNode,\n\t\t\t\t\t\t\t\tindex = node.getIndex();\n\t\t\t\t\t\t\tval(node);\n\t\t\t\t\t\t\tif (node.parentNode) {\n\t\t\t\t\t\t\t\tif (node.children) {\n\t\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i];) {\n\t\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfor (var i = index, ci; ci = parentNode.children[i];) {\n\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar attrs = val['$'];\n\t\t\t\t\t\t\tif (attrs && node.attrs) {\n\t\t\t\t\t\t\t\tvar tmpAttrs = {},\n\t\t\t\t\t\t\t\t\ttmpVal;\n\t\t\t\t\t\t\t\tfor (var a in attrs) {\n\t\t\t\t\t\t\t\t\ttmpVal = node.getAttr(a);\n\t\t\t\t\t\t\t\t\t//todo 只先对style单独处理\n\t\t\t\t\t\t\t\t\tif (a == 'style' && utils.isArray(attrs[a])) {\n\t\t\t\t\t\t\t\t\t\tvar tmpCssStyle = [];\n\t\t\t\t\t\t\t\t\t\tutils.each(attrs[a], function(v) {\n\t\t\t\t\t\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\t\t\t\t\t\tif (tmp = node.getStyle(v)) {\n\t\t\t\t\t\t\t\t\t\t\t\ttmpCssStyle.push(v + ':' + tmp);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\ttmpVal = tmpCssStyle.join(';')\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (tmpVal) {\n\t\t\t\t\t\t\t\t\t\ttmpAttrs[a] = tmpVal;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnode.attrs = tmpAttrs;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (node.children) {\n\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i];) {\n\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//如果不在名单里扣出子节点并删除该节点,cdata除外\n\t\t\t\t\t\tif (dtd.$cdata[node.tagName]) {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar parentNode = node.parentNode,\n\t\t\t\t\t\t\t\tindex = node.getIndex();\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true);\n\t\t\t\t\t\t\tfor (var i = index, ci; ci = parentNode.children[i];) {\n\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'comment':\n\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t}\n\n\t\t}\n\t\treturn function(root, rules) {\n\t\t\tif (utils.isEmptyObject(rules)) {\n\t\t\t\treturn root;\n\t\t\t}\n\t\t\tvar val;\n\t\t\tif (val = rules['-']) {\n\t\t\t\tutils.each(val.split(' '), function(k) {\n\t\t\t\t\trules[k] = '-'\n\t\t\t\t})\n\t\t\t}\n\t\t\tfor (var i = 0, ci; ci = root.children[i];) {\n\t\t\t\tfilterNode(ci, rules);\n\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn root;\n\t\t}\n\t}();\n\n\t// core/plugin.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: campaign\n\t * Date: 10/8/13\n\t * Time: 6:15 PM\n\t * To change this template use File | Settings | File Templates.\n\t */\n\tUE.plugin = function() {\n\t\tvar _plugins = {};\n\t\treturn {\n\t\t\tregister: function(pluginName, fn, oldOptionName, afterDisabled) {\n\t\t\t\tif (oldOptionName && utils.isFunction(oldOptionName)) {\n\t\t\t\t\tafterDisabled = oldOptionName;\n\t\t\t\t\toldOptionName = null\n\t\t\t\t}\n\t\t\t\t_plugins[pluginName] = {\n\t\t\t\t\toptionName: oldOptionName || pluginName,\n\t\t\t\t\texecFn: fn,\n\t\t\t\t\t//当插件被禁用时执行\n\t\t\t\t\tafterDisabled: afterDisabled\n\t\t\t\t}\n\t\t\t},\n\t\t\tload: function(editor) {\n\t\t\t\tutils.each(_plugins, function(plugin) {\n\t\t\t\t\tvar _export = plugin.execFn.call(editor);\n\t\t\t\t\tif (editor.options[plugin.optionName] !== false) {\n\t\t\t\t\t\tif (_export) {\n\t\t\t\t\t\t\t//后边需要再做扩展\n\t\t\t\t\t\t\tutils.each(_export, function(v, k) {\n\t\t\t\t\t\t\t\tswitch (k.toLowerCase()) {\n\t\t\t\t\t\t\t\t\tcase 'shortcutkey':\n\t\t\t\t\t\t\t\t\t\teditor.addshortcutkey(v);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'bindevents':\n\t\t\t\t\t\t\t\t\t\tutils.each(v, function(fn, eventName) {\n\t\t\t\t\t\t\t\t\t\t\teditor.addListener(eventName, fn);\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'bindmultievents':\n\t\t\t\t\t\t\t\t\t\tutils.each(utils.isArray(v) ? v : [v], function(event) {\n\t\t\t\t\t\t\t\t\t\t\tvar types = utils.trim(event.type).split(/\\s+/);\n\t\t\t\t\t\t\t\t\t\t\tutils.each(types, function(eventName) {\n\t\t\t\t\t\t\t\t\t\t\t\teditor.addListener(eventName, event.handler);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'commands':\n\t\t\t\t\t\t\t\t\t\tutils.each(v, function(execFn, execName) {\n\t\t\t\t\t\t\t\t\t\t\teditor.commands[execName] = execFn\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'outputrule':\n\t\t\t\t\t\t\t\t\t\teditor.addOutputRule(v);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'inputrule':\n\t\t\t\t\t\t\t\t\t\teditor.addInputRule(v);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'defaultoptions':\n\t\t\t\t\t\t\t\t\t\teditor.setOpt(v)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if (plugin.afterDisabled) {\n\t\t\t\t\t\tplugin.afterDisabled.call(editor)\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t\t//向下兼容\n\t\t\t\tutils.each(UE.plugins, function(plugin) {\n\t\t\t\t\tplugin.call(editor);\n\t\t\t\t});\n\t\t\t},\n\t\t\trun: function(pluginName, editor) {\n\t\t\t\tvar plugin = _plugins[pluginName];\n\t\t\t\tif (plugin) {\n\t\t\t\t\tplugin.exeFn.call(editor)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}();\n\n\t// core/keymap.js\n\tvar keymap = UE.keymap = {\n\t\t'Backspace': 8,\n\t\t'Tab': 9,\n\t\t'Enter': 13,\n\n\t\t'Shift': 16,\n\t\t'Control': 17,\n\t\t'Alt': 18,\n\t\t'CapsLock': 20,\n\n\t\t'Esc': 27,\n\n\t\t'Spacebar': 32,\n\n\t\t'PageUp': 33,\n\t\t'PageDown': 34,\n\t\t'End': 35,\n\t\t'Home': 36,\n\n\t\t'Left': 37,\n\t\t'Up': 38,\n\t\t'Right': 39,\n\t\t'Down': 40,\n\n\t\t'Insert': 45,\n\n\t\t'Del': 46,\n\n\t\t'NumLock': 144,\n\n\t\t'Cmd': 91,\n\n\t\t'=': 187,\n\t\t'-': 189,\n\n\t\t\"b\": 66,\n\t\t'i': 73,\n\t\t//回退\n\t\t'z': 90,\n\t\t'y': 89,\n\t\t//粘贴\n\t\t'v': 86,\n\t\t'x': 88,\n\n\t\t's': 83,\n\n\t\t'n': 78\n\t};\n\n\t// core/localstorage.js\n\t//存储媒介封装\n\tvar LocalStorage = UE.LocalStorage = (function() {\n\n\t\tvar storage = window.localStorage || getUserData() || null,\n\t\t\tLOCAL_FILE = 'localStorage';\n\n\t\treturn {\n\n\t\t\tsaveLocalData: function(key, data) {\n\n\t\t\t\tif (storage && data) {\n\t\t\t\t\tstorage.setItem(key, data);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t},\n\n\t\t\tgetLocalData: function(key) {\n\n\t\t\t\tif (storage) {\n\t\t\t\t\treturn storage.getItem(key);\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t},\n\n\t\t\tremoveItem: function(key) {\n\n\t\t\t\tstorage && storage.removeItem(key);\n\n\t\t\t}\n\n\t\t};\n\n\t\tfunction getUserData() {\n\n\t\t\tvar container = document.createElement(\"div\");\n\t\t\tcontainer.style.display = \"none\";\n\n\t\t\tif (!container.addBehavior) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tcontainer.addBehavior(\"#default#userdata\");\n\n\t\t\treturn {\n\n\t\t\t\tgetItem: function(key) {\n\n\t\t\t\t\tvar result = null;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\t\tcontainer.load(LOCAL_FILE);\n\t\t\t\t\t\tresult = container.getAttribute(key);\n\t\t\t\t\t\tdocument.body.removeChild(container);\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\treturn result;\n\n\t\t\t\t},\n\n\t\t\t\tsetItem: function(key, value) {\n\n\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\tcontainer.setAttribute(key, value);\n\t\t\t\t\tcontainer.save(LOCAL_FILE);\n\t\t\t\t\tdocument.body.removeChild(container);\n\n\t\t\t\t},\n\n\t\t\t\t//// 暂时没有用到\n\t\t\t\t//clear: function () {\n\t\t\t\t//\n\t\t\t\t//    var expiresTime = new Date();\n\t\t\t\t//    expiresTime.setFullYear(expiresTime.getFullYear() - 1);\n\t\t\t\t//    document.body.appendChild(container);\n\t\t\t\t//    container.expires = expiresTime.toUTCString();\n\t\t\t\t//    container.save(LOCAL_FILE);\n\t\t\t\t//    document.body.removeChild(container);\n\t\t\t\t//\n\t\t\t\t//},\n\n\t\t\t\tremoveItem: function(key) {\n\n\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\tcontainer.removeAttribute(key);\n\t\t\t\t\tcontainer.save(LOCAL_FILE);\n\t\t\t\t\tdocument.body.removeChild(container);\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t})();\n\n\t(function() {\n\n\t\tvar ROOTKEY = 'ueditor_preference';\n\n\t\tUE.Editor.prototype.setPreferences = function(key, value) {\n\t\t\tvar obj = {};\n\t\t\tif (utils.isString(key)) {\n\t\t\t\tobj[key] = value;\n\t\t\t} else {\n\t\t\t\tobj = key;\n\t\t\t}\n\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\tutils.extend(data, obj);\n\t\t\t} else {\n\t\t\t\tdata = obj;\n\t\t\t}\n\t\t\tdata && LocalStorage.saveLocalData(ROOTKEY, utils.json2str(data));\n\t\t};\n\n\t\tUE.Editor.prototype.getPreferences = function(key) {\n\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\treturn key ? data[key] : data\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tUE.Editor.prototype.removePreferences = function(key) {\n\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\tdata[key] = undefined;\n\t\t\t\tdelete data[key]\n\t\t\t}\n\t\t\tdata && LocalStorage.saveLocalData(ROOTKEY, utils.json2str(data));\n\t\t};\n\n\t})();\n\n\t// plugins/defaultfilter.js\n\t///import core\n\t///plugin 编辑器默认的过滤转换机制\n\n\tUE.plugins['defaultfilter'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'allowDivTransToP': true,\n\t\t\t'disabledTableInTable': true\n\t\t});\n\t\t//默认的过滤处理\n\t\t//进入编辑器的内容处理\n\t\tme.addInputRule(function(root) {\n\t\t\tvar allowDivTransToP = this.options.allowDivTransToP;\n\t\t\tvar val;\n\n\t\t\tfunction tdParent(node) {\n\t\t\t\twhile (node && node.type == 'element') {\n\t\t\t\t\tif (node.tagName == 'td') {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//进行默认的处理\n\t\t\troot.traversal(function(node) {\n\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\tif (!dtd.$cdata[node.tagName] && me.options.autoClearEmptyNode && dtd.$inline[node.tagName] && !dtd.$empty[node.tagName] && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\tif (!node.firstChild()) node.parentNode.removeChild(node);\n\t\t\t\t\t\telse if (node.tagName == 'span' && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\tcase 'script':\n\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\tcdata_tag: node.tagName,\n\t\t\t\t\t\t\t\tcdata_data: (node.innerHTML() || ''),\n\t\t\t\t\t\t\t\t'_ue_custom_node_': 'true'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnode.tagName = 'div';\n\t\t\t\t\t\t\tnode.innerHTML('');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'a':\n\t\t\t\t\t\t\tif (val = node.getAttr('href')) {\n\t\t\t\t\t\t\t\tnode.setAttr('_href', val)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\t\t//todo base64暂时去掉，后边做远程图片上传后，干掉这个\n\t\t\t\t\t\t\tif (val = node.getAttr('src')) {\n\t\t\t\t\t\t\t\tif (/^data:/.test(val)) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode.setAttr('_src', node.getAttr('src'));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'span':\n\t\t\t\t\t\t\tif (browser.webkit && (val = node.getStyle('white-space'))) {\n\t\t\t\t\t\t\t\tif (/nowrap|normal/.test(val)) {\n\t\t\t\t\t\t\t\t\tnode.setStyle('white-space', '');\n\t\t\t\t\t\t\t\t\tif (me.options.autoClearEmptyNode && utils.isEmptyObject(node.attrs)) {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tval = node.getAttr('id');\n\t\t\t\t\t\t\tif (val && /^_baidu_bookmark_/i.test(val)) {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'p':\n\t\t\t\t\t\t\tif (val = node.getAttr('align')) {\n\t\t\t\t\t\t\t\tnode.setAttr('align');\n\t\t\t\t\t\t\t\tnode.setStyle('text-align', val)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//trace:3431\n\t\t\t\t\t\t\t//                        var cssStyle = node.getAttr('style');\n\t\t\t\t\t\t\t//                        if (cssStyle) {\n\t\t\t\t\t\t\t//                            cssStyle = cssStyle.replace(/(margin|padding)[^;]+/g, '');\n\t\t\t\t\t\t\t//                            node.setAttr('style', cssStyle)\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t//                        }\n\t\t\t\t\t\t\t//p标签不允许嵌套\n\t\t\t\t\t\t\tutils.each(node.children, function(n) {\n\t\t\t\t\t\t\t\tif (n.type == 'element' && n.tagName == 'p') {\n\t\t\t\t\t\t\t\t\tvar next = n.nextSibling();\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(n, node);\n\t\t\t\t\t\t\t\t\tvar last = n;\n\t\t\t\t\t\t\t\t\twhile (next) {\n\t\t\t\t\t\t\t\t\t\tvar tmp = next.nextSibling();\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(next, last);\n\t\t\t\t\t\t\t\t\t\tlast = next;\n\t\t\t\t\t\t\t\t\t\tnext = tmp;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (!node.firstChild()) {\n\t\t\t\t\t\t\t\tnode.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'div':\n\t\t\t\t\t\t\tif (node.getAttr('cdata_tag')) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//针对代码这里不处理插入代码的div\n\t\t\t\t\t\t\tval = node.getAttr('class');\n\t\t\t\t\t\t\tif (val && /^line number\\d+/.test(val)) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!allowDivTransToP) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tmpNode, p = UE.uNode.createElement('p');\n\t\t\t\t\t\t\twhile (tmpNode = node.firstChild()) {\n\t\t\t\t\t\t\t\tif (tmpNode.type == 'text' || !UE.dom.dtd.$block[tmpNode.tagName]) {\n\t\t\t\t\t\t\t\t\tp.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t\t\t\tp = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(tmpNode, node);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'dl':\n\t\t\t\t\t\t\tnode.tagName = 'ul';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'dt':\n\t\t\t\t\t\tcase 'dd':\n\t\t\t\t\t\t\tnode.tagName = 'li';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'li':\n\t\t\t\t\t\t\tvar className = node.getAttr('class');\n\t\t\t\t\t\t\tif (!className || !/list\\-/.test(className)) {\n\t\t\t\t\t\t\t\tnode.setAttr()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tmpNodes = node.getNodesByTagName('ol ul');\n\t\t\t\t\t\t\tUE.utils.each(tmpNodes, function(n) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(n, node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'td':\n\t\t\t\t\t\tcase 'th':\n\t\t\t\t\t\tcase 'caption':\n\t\t\t\t\t\t\tif (!node.children || !node.children.length) {\n\t\t\t\t\t\t\t\tnode.appendChild(browser.ie11below ? UE.uNode.createText(' ') : UE.uNode.createElement('br'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'table':\n\t\t\t\t\t\t\tif (me.options.disabledTableInTable && tdParent(node)) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(UE.uNode.createText(node.innerText()), node);\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t//            if(node.type == 'comment'){\n\t\t\t\t//                node.parentNode.removeChild(node);\n\t\t\t\t//            }\n\t\t\t})\n\n\t\t});\n\n\t\t//从编辑器出去的内容处理\n\t\tme.addOutputRule(function(root) {\n\n\t\t\tvar val;\n\t\t\troot.traversal(function(node) {\n\t\t\t\tif (node.type == 'element') {\n\n\t\t\t\t\tif (me.options.autoClearEmptyNode && dtd.$inline[node.tagName] && !dtd.$empty[node.tagName] && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\n\t\t\t\t\t\tif (!node.firstChild()) node.parentNode.removeChild(node);\n\t\t\t\t\t\telse if (node.tagName == 'span' && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\tcase 'div':\n\t\t\t\t\t\t\tif (val = node.getAttr('cdata_tag')) {\n\t\t\t\t\t\t\t\tnode.tagName = val;\n\t\t\t\t\t\t\t\tnode.appendChild(UE.uNode.createText(node.getAttr('cdata_data')));\n\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\tcdata_tag: '',\n\t\t\t\t\t\t\t\t\tcdata_data: '',\n\t\t\t\t\t\t\t\t\t'_ue_custom_node_': ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'a':\n\t\t\t\t\t\t\tif (val = node.getAttr('_href')) {\n\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\t'href': utils.html(val),\n\t\t\t\t\t\t\t\t\t'_href': ''\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'span':\n\t\t\t\t\t\t\tval = node.getAttr('id');\n\t\t\t\t\t\t\tif (val && /^_baidu_bookmark_/i.test(val)) {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\t\tif (val = node.getAttr('_src')) {\n\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\t'src': node.getAttr('_src'),\n\t\t\t\t\t\t\t\t\t'_src': ''\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t})\n\n\t\t});\n\t};\n\n\t// plugins/inserthtml.js\n\t/**\n\t * 插入html字符串插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入html代码\n\t * @command inserthtml\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } html 插入的html字符串\n\t * @remaind 插入的标签内容是在当前的选区位置上插入，如果当前是闭合状态，那直接插入内容， 如果当前是选中状态，将先清除当前选中内容后，再做插入\n\t * @warning 注意:该命令会对当前选区的位置，对插入的内容进行过滤转换处理。 过滤的规则遵循html语意化的原则。\n\t * @example\n\t * ```javascript\n\t * //xxx[BB]xxx 当前选区为非闭合选区，选中BB这两个文本\n\t * //执行命令，插入<b>CC</b>\n\t * //插入后的效果 xxx<b>CC</b>xxx\n\t * //<p>xx|xxx</p> 当前选区为闭合状态\n\t * //插入<p>CC</p>\n\t * //结果 <p>xx</p><p>CC</p><p>xxx</p>\n\t * //<p>xxxx</p>|</p>xxx</p> 当前选区在两个p标签之间\n\t * //插入 xxxx\n\t * //结果 <p>xxxx</p><p>xxxx</p></p>xxx</p>\n\t * ```\n\t */\n\n\tUE.commands['inserthtml'] = {\n\t\texecCommand: function(command, html, notNeedFilter) {\n\t\t\tvar me = this,\n\t\t\t\trange,\n\t\t\t\tdiv;\n\t\t\tif (!html) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (me.fireEvent('beforeinserthtml', html) === true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\trange = me.selection.getRange();\n\t\t\tdiv = range.document.createElement('div');\n\t\t\tdiv.style.display = 'inline';\n\n\t\t\tif (!notNeedFilter) {\n\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t//如果给了过滤规则就先进行过滤\n\t\t\t\tif (me.options.filterRules) {\n\t\t\t\t\tUE.filterNode(root, me.options.filterRules);\n\t\t\t\t}\n\t\t\t\t//执行默认的处理\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\thtml = root.toHtml()\n\t\t\t}\n\t\t\tdiv.innerHTML = utils.trim(html);\n\n\t\t\tif (!range.collapsed) {\n\t\t\t\tvar tmpNode = range.startContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trange.setStartBefore(tmpNode)\n\t\t\t\t}\n\t\t\t\ttmpNode = range.endContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trange.setEndAfter(tmpNode)\n\t\t\t\t}\n\t\t\t\trange.txtToElmBoundary();\n\t\t\t\t//结束边界可能放到了br的前边，要把br包含进来\n\t\t\t\t// x[xxx]<br/>\n\t\t\t\tif (range.endContainer && range.endContainer.nodeType == 1) {\n\t\t\t\t\ttmpNode = range.endContainer.childNodes[range.endOffset];\n\t\t\t\t\tif (tmpNode && domUtils.isBr(tmpNode)) {\n\t\t\t\t\t\trange.setEndAfter(tmpNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\ttmpNode = range.startContainer;\n\t\t\t\t\tif (domUtils.isBoundaryNode(tmpNode, 'firstChild')) {\n\t\t\t\t\t\ttmpNode = range.endContainer;\n\t\t\t\t\t\tif (range.endOffset == (tmpNode.nodeType == 3 ? tmpNode.nodeValue.length : tmpNode.childNodes.length) && domUtils.isBoundaryNode(tmpNode, 'lastChild')) {\n\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\trange.setStart(me.body.firstChild, 0).collapse(true)\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}!range.collapsed && range.deleteContents();\n\t\t\t\tif (range.startContainer.nodeType == 1) {\n\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset],\n\t\t\t\t\t\tpre;\n\t\t\t\t\tif (child && domUtils.isBlockElm(child) && (pre = child.previousSibling) && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\trange.setEnd(pre, pre.childNodes.length).collapse();\n\t\t\t\t\t\twhile (child.firstChild) {\n\t\t\t\t\t\t\tpre.appendChild(child.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar child, parent, pre, tmp, hadBreak = 0,\n\t\t\t\tnextNode;\n\t\t\t//如果当前位置选中了fillchar要干掉，要不会产生空行\n\t\t\tif (range.inFillChar()) {\n\t\t\t\tchild = range.startContainer;\n\t\t\t\tif (domUtils.isFillChar(child)) {\n\t\t\t\t\trange.setStartBefore(child).collapse(true);\n\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t} else if (domUtils.isFillChar(child, true)) {\n\t\t\t\t\tchild.nodeValue = child.nodeValue.replace(fillCharReg, '');\n\t\t\t\t\trange.startOffset--;\n\t\t\t\t\trange.collapsed && range.collapse(true)\n\t\t\t\t}\n\t\t\t}\n\t\t\t//列表单独处理\n\t\t\tvar li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\tif (li) {\n\t\t\t\tvar next, last;\n\t\t\t\twhile (child = div.firstChild) {\n\t\t\t\t\t//针对hr单独处理一下先\n\t\t\t\t\twhile (child && (child.nodeType == 3 || !domUtils.isBlockElm(child) || child.tagName == 'HR')) {\n\t\t\t\t\t\tnext = child.nextSibling;\n\t\t\t\t\t\trange.insertNode(child).collapse();\n\t\t\t\t\t\tlast = child;\n\t\t\t\t\t\tchild = next;\n\n\t\t\t\t\t}\n\t\t\t\t\tif (child) {\n\t\t\t\t\t\tif (/^(ol|ul)$/i.test(child.tagName)) {\n\t\t\t\t\t\t\twhile (child.firstChild) {\n\t\t\t\t\t\t\t\tlast = child.firstChild;\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(li, child.firstChild);\n\t\t\t\t\t\t\t\tli = li.nextSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(child)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpLi;\n\t\t\t\t\t\t\tnext = child.nextSibling;\n\t\t\t\t\t\t\ttmpLi = me.document.createElement('li');\n\t\t\t\t\t\t\tdomUtils.insertAfter(li, tmpLi);\n\t\t\t\t\t\t\ttmpLi.appendChild(child);\n\t\t\t\t\t\t\tlast = child;\n\t\t\t\t\t\t\tchild = next;\n\t\t\t\t\t\t\tli = tmpLi;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\tif (domUtils.isEmptyBlock(li)) {\n\t\t\t\t\tdomUtils.remove(li)\n\t\t\t\t}\n\t\t\t\tif (last) {\n\n\t\t\t\t\trange.setStartAfter(last).collapse(true).select(true)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile (child = div.firstChild) {\n\t\t\t\t\tif (hadBreak) {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\twhile (child && (child.nodeType == 3 || !dtd.$block[child.tagName])) {\n\t\t\t\t\t\t\tnextNode = child.nextSibling;\n\t\t\t\t\t\t\tp.appendChild(child);\n\t\t\t\t\t\t\tchild = nextNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (p.firstChild) {\n\n\t\t\t\t\t\t\tchild = p\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.insertNode(child);\n\t\t\t\t\tnextNode = child.nextSibling;\n\t\t\t\t\tif (!hadBreak && child.nodeType == domUtils.NODE_ELEMENT && domUtils.isBlockElm(child)) {\n\n\t\t\t\t\t\tparent = domUtils.findParent(child, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (parent && parent.tagName.toLowerCase() != 'body' && !(dtd[parent.tagName][child.nodeName] && child.parentNode === parent)) {\n\t\t\t\t\t\t\tif (!dtd[parent.tagName][child.nodeName]) {\n\t\t\t\t\t\t\t\tpre = parent;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttmp = child.parentNode;\n\t\t\t\t\t\t\t\twhile (tmp !== parent) {\n\t\t\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\t\t\ttmp = tmp.parentNode;\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdomUtils.breakParent(child, pre || tmp);\n\t\t\t\t\t\t\t//去掉break后前一个多余的节点  <p>|<[p> ==> <p></p><div></div><p>|</p>\n\t\t\t\t\t\t\tvar pre = child.previousSibling;\n\t\t\t\t\t\t\tdomUtils.trimWhiteTextNode(pre);\n\t\t\t\t\t\t\tif (!pre.childNodes.length) {\n\t\t\t\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//trace:2012,在非ie的情况，切开后剩下的节点有可能不能点入光标添加br占位\n\n\t\t\t\t\t\t\tif (!browser.ie &&\n\t\t\t\t\t\t\t\t(next = child.nextSibling) &&\n\t\t\t\t\t\t\t\tdomUtils.isBlockElm(next) &&\n\t\t\t\t\t\t\t\tnext.lastChild &&\n\t\t\t\t\t\t\t\t!domUtils.isBr(next.lastChild)) {\n\t\t\t\t\t\t\t\tnext.appendChild(me.document.createElement('br'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thadBreak = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar next = child.nextSibling;\n\t\t\t\t\tif (!div.firstChild && next && domUtils.isBlockElm(next)) {\n\n\t\t\t\t\t\trange.setStart(next, 0).collapse(true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\trange.setEndAfter(child).collapse();\n\n\t\t\t\t}\n\n\t\t\t\tchild = range.startContainer;\n\n\t\t\t\tif (nextNode && domUtils.isBr(nextNode)) {\n\t\t\t\t\tdomUtils.remove(nextNode)\n\t\t\t\t}\n\t\t\t\t//用chrome可能有空白展位符\n\t\t\t\tif (domUtils.isBlockElm(child) && domUtils.isEmptyNode(child)) {\n\t\t\t\t\tif (nextNode = child.nextSibling) {\n\t\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t\t\tif (nextNode.nodeType == 1 && dtd.$block[nextNode.tagName]) {\n\n\t\t\t\t\t\t\trange.setStart(nextNode, 0).collapse(true).shrinkBoundary()\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tchild.innerHTML = browser.ie ? domUtils.fillChar : '<br/>';\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\trange.setStartBefore(child);\n\t\t\t\t\t\t\tdomUtils.remove(child)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t//加上true因为在删除表情等时会删两次，第一次是删的fillData\n\t\t\t\ttry {\n\t\t\t\t\trange.select(true);\n\t\t\t\t} catch (e) {}\n\n\t\t\t}\n\n\t\t\tsetTimeout(function() {\n\t\t\t\trange = me.selection.getRange();\n\t\t\t\trange.scrollToView(me.autoHeightEnabled, me.autoHeightEnabled ? domUtils.getXY(me.iframe).y : 0);\n\t\t\t\tme.fireEvent('afterinserthtml', html);\n\t\t\t}, 200);\n\t\t}\n\t};\n\n\t// plugins/autotypeset.js\n\t/**\n\t * 自动排版\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 对当前编辑器的内容执行自动排版， 排版的行为根据config配置文件里的“autotypeset”选项进行控制。\n\t * @command autotypeset\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'autotypeset' );\n\t * ```\n\t */\n\n\tUE.plugins['autotypeset'] = function() {\n\n\t\tthis.setOpt({\n\t\t\t'autotypeset': {\n\t\t\t\tmergeEmptyline: true, //合并空行\n\t\t\t\tremoveClass: true, //去掉冗余的class\n\t\t\t\tremoveEmptyline: false, //去掉空行\n\t\t\t\ttextAlign: \"left\", //段落的排版方式，可以是 left,right,center,justify 去掉这个属性表示不执行排版\n\t\t\t\timageBlockLine: 'center', //图片的浮动方式，独占一行剧中,左右浮动，默认: center,left,right,none 去掉这个属性表示不执行排版\n\t\t\t\tpasteFilter: false, //根据规则过滤没事粘贴进来的内容\n\t\t\t\tclearFontSize: false, //去掉所有的内嵌字号，使用编辑器默认的字号\n\t\t\t\tclearFontFamily: false, //去掉所有的内嵌字体，使用编辑器默认的字体\n\t\t\t\tremoveEmptyNode: false, // 去掉空节点\n\t\t\t\t//可以去掉的标签\n\t\t\t\tremoveTagNames: utils.extend({\n\t\t\t\t\tdiv: 1\n\t\t\t\t}, dtd.$removeEmpty),\n\t\t\t\tindent: false, // 行首缩进\n\t\t\t\tindentValue: '2em', //行首缩进的大小\n\t\t\t\tbdc2sb: false,\n\t\t\t\ttobdc: false\n\t\t\t}\n\t\t});\n\n\t\tvar me = this,\n\t\t\topt = me.options.autotypeset,\n\t\t\tremainClass = {\n\t\t\t\t'selectTdClass': 1,\n\t\t\t\t'pagebreak': 1,\n\t\t\t\t'anchorclass': 1\n\t\t\t},\n\t\t\tremainTag = {\n\t\t\t\t'li': 1\n\t\t\t},\n\t\t\ttags = {\n\t\t\t\tdiv: 1,\n\t\t\t\tp: 1,\n\t\t\t\t//trace:2183 这些也认为是行\n\t\t\t\tblockquote: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\th1: 1,\n\t\t\t\th2: 1,\n\t\t\t\th3: 1,\n\t\t\t\th4: 1,\n\t\t\t\th5: 1,\n\t\t\t\th6: 1,\n\t\t\t\tspan: 1\n\t\t\t},\n\t\t\thighlightCont;\n\t\t//升级了版本，但配置项目里没有autotypeset\n\t\tif (!opt) {\n\t\t\treturn;\n\t\t}\n\n\t\treadLocalOpts();\n\n\t\tfunction isLine(node, notEmpty) {\n\t\t\tif (!node || node.nodeType == 3)\n\t\t\t\treturn 0;\n\t\t\tif (domUtils.isBr(node))\n\t\t\t\treturn 1;\n\t\t\tif (node && node.parentNode && tags[node.tagName.toLowerCase()]) {\n\t\t\t\tif (highlightCont && highlightCont.contains(node) ||\n\t\t\t\t\tnode.getAttribute('pagebreak')\n\t\t\t\t) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn notEmpty ? !domUtils.isEmptyBlock(node) : domUtils.isEmptyBlock(node, new RegExp('[\\\\s' + domUtils.fillChar + ']', 'g'));\n\t\t\t}\n\t\t}\n\n\t\tfunction removeNotAttributeSpan(node) {\n\t\t\tif (!node.style.cssText) {\n\t\t\t\tdomUtils.removeAttributes(node, ['style']);\n\t\t\t\tif (node.tagName.toLowerCase() == 'span' && domUtils.hasNoAttributes(node)) {\n\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction autotype(type, html) {\n\n\t\t\tvar me = this,\n\t\t\t\tcont;\n\t\t\tif (html) {\n\t\t\t\tif (!opt.pasteFilter) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcont = me.document.createElement('div');\n\t\t\t\tcont.innerHTML = html.html;\n\t\t\t} else {\n\t\t\t\tcont = me.document.body;\n\t\t\t}\n\t\t\tvar nodes = domUtils.getElementsByTagName(cont, '*');\n\n\t\t\t// 行首缩进，段落方向，段间距，段内间距\n\t\t\tfor (var i = 0, ci; ci = nodes[i++];) {\n\n\t\t\t\tif (me.fireEvent('excludeNodeinautotype', ci) === true) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//font-size\n\t\t\t\tif (opt.clearFontSize && ci.style.fontSize) {\n\t\t\t\t\tdomUtils.removeStyle(ci, 'font-size');\n\n\t\t\t\t\tremoveNotAttributeSpan(ci);\n\n\t\t\t\t}\n\t\t\t\t//font-family\n\t\t\t\tif (opt.clearFontFamily && ci.style.fontFamily) {\n\t\t\t\t\tdomUtils.removeStyle(ci, 'font-family');\n\t\t\t\t\tremoveNotAttributeSpan(ci);\n\t\t\t\t}\n\n\t\t\t\tif (isLine(ci)) {\n\t\t\t\t\t//合并空行\n\t\t\t\t\tif (opt.mergeEmptyline) {\n\t\t\t\t\t\tvar next = ci.nextSibling,\n\t\t\t\t\t\t\ttmpNode, isBr = domUtils.isBr(ci);\n\t\t\t\t\t\twhile (isLine(next)) {\n\t\t\t\t\t\t\ttmpNode = next;\n\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\tif (isBr && (!next || next && !domUtils.isBr(next))) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\t//去掉空行，保留占位的空行\n\t\t\t\t\tif (opt.removeEmptyline && domUtils.inDoc(ci, cont) && !remainTag[ci.parentNode.tagName.toLowerCase()]) {\n\t\t\t\t\t\tif (domUtils.isBr(ci)) {\n\t\t\t\t\t\t\tnext = ci.nextSibling;\n\t\t\t\t\t\t\tif (next && !domUtils.isBr(next)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif (isLine(ci, true) && ci.tagName != 'SPAN') {\n\t\t\t\t\tif (opt.indent) {\n\t\t\t\t\t\tci.style.textIndent = opt.indentValue;\n\t\t\t\t\t}\n\t\t\t\t\tif (opt.textAlign) {\n\t\t\t\t\t\tci.style.textAlign = opt.textAlign;\n\t\t\t\t\t}\n\t\t\t\t\t// if(opt.lineHeight)\n\t\t\t\t\t//     ci.style.lineHeight = opt.lineHeight + 'cm';\n\n\t\t\t\t}\n\n\t\t\t\t//去掉class,保留的class不去掉\n\t\t\t\tif (opt.removeClass && ci.className && !remainClass[ci.className.toLowerCase()]) {\n\n\t\t\t\t\tif (highlightCont && highlightCont.contains(ci)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.removeAttributes(ci, ['class']);\n\t\t\t\t}\n\n\t\t\t\t//表情不处理\n\t\t\t\tif (opt.imageBlockLine && ci.tagName.toLowerCase() == 'img' && !ci.getAttribute('emotion')) {\n\t\t\t\t\tif (html) {\n\t\t\t\t\t\tvar img = ci;\n\t\t\t\t\t\tswitch (opt.imageBlockLine) {\n\t\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\t\tvar pN = img.parentNode,\n\t\t\t\t\t\t\t\t\ttmpNode, pre, next;\n\t\t\t\t\t\t\t\twhile (dtd.$inline[pN.tagName] || pN.tagName == 'A') {\n\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\tif (tmpNode.tagName == 'P' && domUtils.getStyle(tmpNode, 'text-align') == 'center') {\n\t\t\t\t\t\t\t\t\tif (!domUtils.isBody(tmpNode) && domUtils.getChildCount(tmpNode, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node)\n\t\t\t\t\t\t\t\t\t\t}) == 1) {\n\t\t\t\t\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\t\t\tif (pre && next && pre.nodeType == 1 && next.nodeType == 1 && pre.tagName == next.tagName && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(tmpNode.firstChild);\n\t\t\t\t\t\t\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(next.firstChild);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'text-align', '');\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', opt.imageBlockLine);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\t\tif (me.queryCommandValue('imagefloat') != 'center') {\n\t\t\t\t\t\t\t\t\tpN = img.parentNode;\n\t\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', 'none');\n\t\t\t\t\t\t\t\t\ttmpNode = img;\n\t\t\t\t\t\t\t\t\twhile (pN && domUtils.getChildCount(pN, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node)\n\t\t\t\t\t\t\t\t\t\t}) == 1 && (dtd.$inline[pN.tagName] || pN.tagName == 'A')) {\n\t\t\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar pNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(pNode, {\n\n\t\t\t\t\t\t\t\t\t\tstyle: 'text-align:center'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\ttmpNode.parentNode.insertBefore(pNode, tmpNode);\n\t\t\t\t\t\t\t\t\tpNode.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'float', '');\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\t\trange.selectNode(ci).select();\n\t\t\t\t\t\tme.execCommand('imagefloat', opt.imageBlockLine);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//去掉冗余的标签\n\t\t\t\tif (opt.removeEmptyNode) {\n\t\t\t\t\tif (opt.removeTagNames[ci.tagName.toLowerCase()] && domUtils.hasNoAttributes(ci) && domUtils.isEmptyBlock(ci)) {\n\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (opt.tobdc) {\n\t\t\t\tvar root = UE.htmlparser(cont.innerHTML);\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type == 'text') {\n\t\t\t\t\t\tnode.data = ToDBC(node.data)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tcont.innerHTML = root.toHtml()\n\t\t\t}\n\t\t\tif (opt.bdc2sb) {\n\t\t\t\tvar root = UE.htmlparser(cont.innerHTML);\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type == 'text') {\n\t\t\t\t\t\tnode.data = DBC2SB(node.data)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tcont.innerHTML = root.toHtml()\n\t\t\t}\n\t\t\tif (html) {\n\t\t\t\thtml.html = cont.innerHTML;\n\t\t\t}\n\t\t}\n\t\tif (opt.pasteFilter) {\n\t\t\tme.addListener('beforepaste', autotype);\n\t\t}\n\n\t\tfunction DBC2SB(str) {\n\t\t\tvar result = '';\n\t\t\tfor (var i = 0; i < str.length; i++) {\n\t\t\t\tvar code = str.charCodeAt(i); //获取当前字符的unicode编码\n\t\t\t\tif (code >= 65281 && code <= 65373) //在这个unicode编码范围中的是所有的英文字母已经各种字符\n\t\t\t\t{\n\t\t\t\t\tresult += String.fromCharCode(str.charCodeAt(i) - 65248); //把全角字符的unicode编码转换为对应半角字符的unicode码\n\t\t\t\t} else if (code == 12288) //空格\n\t\t\t\t{\n\t\t\t\t\tresult += String.fromCharCode(str.charCodeAt(i) - 12288 + 32);\n\t\t\t\t} else {\n\t\t\t\t\tresult += str.charAt(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\tfunction ToDBC(txtstring) {\n\t\t\ttxtstring = utils.html(txtstring);\n\t\t\tvar tmp = \"\";\n\t\t\tvar mark = \"\"; /*用于判断,如果是html尖括里的标记,则不进行全角的转换*/\n\t\t\tfor (var i = 0; i < txtstring.length; i++) {\n\t\t\t\tif (txtstring.charCodeAt(i) == 32) {\n\t\t\t\t\ttmp = tmp + String.fromCharCode(12288);\n\t\t\t\t} else if (txtstring.charCodeAt(i) < 127) {\n\t\t\t\t\ttmp = tmp + String.fromCharCode(txtstring.charCodeAt(i) + 65248);\n\t\t\t\t} else {\n\t\t\t\t\ttmp += txtstring.charAt(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tmp;\n\t\t}\n\n\t\tfunction readLocalOpts() {\n\t\t\tvar cookieOpt = me.getPreferences('autotypeset');\n\t\t\tutils.extend(me.options.autotypeset, cookieOpt);\n\t\t}\n\n\t\tme.commands['autotypeset'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tme.removeListener('beforepaste', autotype);\n\t\t\t\tif (opt.pasteFilter) {\n\t\t\t\t\tme.addListener('beforepaste', autotype);\n\t\t\t\t}\n\t\t\t\tautotype.call(me)\n\t\t\t}\n\n\t\t};\n\n\t};\n\n\t// plugins/autosubmit.js\n\t/**\n\t * 快捷键提交\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 提交表单\n\t * @command autosubmit\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'autosubmit' );\n\t * ```\n\t */\n\n\tUE.plugin.register('autosubmit', function() {\n\t\treturn {\n\t\t\tshortcutkey: {\n\t\t\t\t\"autosubmit\": \"ctrl+13\" //手动提交\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'autosubmit': {\n\t\t\t\t\texecCommand: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tform = domUtils.findParentByTagName(me.iframe, \"form\", false);\n\t\t\t\t\t\tif (form) {\n\t\t\t\t\t\t\tif (me.fireEvent(\"beforesubmit\") === false) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.sync();\n\t\t\t\t\t\t\tform.submit();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/background.js\n\t/**\n\t * 背景插件，为UEditor提供设置背景功能\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugin.register('background', function() {\n\t\tvar me = this,\n\t\t\tcssRuleId = 'editor_background',\n\t\t\tisSetColored,\n\t\t\treg = new RegExp('body[\\\\s]*\\\\{(.+)\\\\}', 'i');\n\n\t\tfunction stringToObj(str) {\n\t\t\tvar obj = {},\n\t\t\t\tstyles = str.split(';');\n\t\t\tutils.each(styles, function(v) {\n\t\t\t\tvar index = v.indexOf(':'),\n\t\t\t\t\tkey = utils.trim(v.substr(0, index)).toLowerCase();\n\t\t\t\tkey && (obj[key] = utils.trim(v.substr(index + 1) || ''));\n\t\t\t});\n\t\t\treturn obj;\n\t\t}\n\n\t\tfunction setBackground(obj) {\n\t\t\tif (obj) {\n\t\t\t\tvar styles = [];\n\t\t\t\tfor (var name in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(name)) {\n\t\t\t\t\t\tstyles.push(name + \":\" + obj[name] + '; ');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tutils.cssRule(cssRuleId, styles.length ? ('body{' + styles.join(\"\") + '}') : '', me.document);\n\t\t\t} else {\n\t\t\t\tutils.cssRule(cssRuleId, '', me.document)\n\t\t\t}\n\t\t}\n\t\t//重写editor.hasContent方法\n\n\t\tvar orgFn = me.hasContents;\n\t\tme.hasContents = function() {\n\t\t\tif (me.queryCommandValue('background')) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\treturn orgFn.apply(me, arguments);\n\t\t};\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'getAllHtml': function(type, headHtml) {\n\t\t\t\t\tvar body = this.body,\n\t\t\t\t\t\tsu = domUtils.getComputedStyle(body, \"background-image\"),\n\t\t\t\t\t\turl = \"\";\n\t\t\t\t\tif (su.indexOf(me.options.imagePath) > 0) {\n\t\t\t\t\t\turl = su.substring(su.indexOf(me.options.imagePath), su.length - 1).replace(/\"|\\(|\\)/ig, \"\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl = su != \"none\" ? su.replace(/url\\(\"?|\"?\\)/ig, \"\") : \"\";\n\t\t\t\t\t}\n\t\t\t\t\tvar html = '<style type=\"text/css\">body{';\n\t\t\t\t\tvar bgObj = {\n\t\t\t\t\t\t\"background-color\": domUtils.getComputedStyle(body, \"background-color\") || \"#ffffff\",\n\t\t\t\t\t\t'background-image': url ? 'url(' + url + ')' : '',\n\t\t\t\t\t\t'background-repeat': domUtils.getComputedStyle(body, \"background-repeat\") || \"\",\n\t\t\t\t\t\t'background-position': browser.ie ? (domUtils.getComputedStyle(body, \"background-position-x\") + \" \" + domUtils.getComputedStyle(body, \"background-position-y\")) : domUtils.getComputedStyle(body, \"background-position\"),\n\t\t\t\t\t\t'height': domUtils.getComputedStyle(body, \"height\")\n\t\t\t\t\t};\n\t\t\t\t\tfor (var name in bgObj) {\n\t\t\t\t\t\tif (bgObj.hasOwnProperty(name)) {\n\t\t\t\t\t\t\thtml += name + \":\" + bgObj[name] + \"; \";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\thtml += '}</style> ';\n\t\t\t\t\theadHtml.push(html);\n\t\t\t\t},\n\t\t\t\t'aftersetcontent': function() {\n\t\t\t\t\tif (isSetColored == false) setBackground();\n\t\t\t\t}\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tisSetColored = false;\n\t\t\t\tutils.each(root.getNodesByTagName('p'), function(p) {\n\t\t\t\t\tvar styles = p.getAttr('data-background');\n\t\t\t\t\tif (styles) {\n\t\t\t\t\t\tisSetColored = true;\n\t\t\t\t\t\tsetBackground(stringToObj(styles));\n\t\t\t\t\t\tp.parentNode.removeChild(p);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tstyles = (utils.cssRule(cssRuleId, me.document) || '').replace(/[\\n\\r]+/g, '').match(reg);\n\t\t\t\tif (styles) {\n\t\t\t\t\troot.appendChild(UE.uNode.createElement('<p style=\"display:none;\" data-background=\"' + utils.trim(styles[1].replace(/\"/g, '').replace(/[\\s]+/g, ' ')) + '\"><br/></p>'));\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'background': {\n\t\t\t\t\texecCommand: function(cmd, obj) {\n\t\t\t\t\t\tsetBackground(obj);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tstyles = (utils.cssRule(cssRuleId, me.document) || '').replace(/[\\n\\r]+/g, '').match(reg);\n\t\t\t\t\t\treturn styles ? stringToObj(styles[1]) : null;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/image.js\n\t/**\n\t * 图片插入、排版插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 图片对齐方式\n\t * @command imagefloat\n\t * @method execCommand\n\t * @remind 值center为独占一行居中\n\t * @param { String } cmd 命令字符串\n\t * @param { String } align 对齐方式，可传left、right、none、center\n\t * @remaind center表示图片独占一行\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'imagefloat', 'center' );\n\t * ```\n\t */\n\n\t/**\n\t * 如果选区所在位置是图片区域\n\t * @command imagefloat\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回图片对齐方式\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'imagefloat' );\n\t * ```\n\t */\n\n\tUE.commands['imagefloat'] = {\n\t\texecCommand: function(cmd, align) {\n\t\t\tvar me = this,\n\t\t\t\trange = me.selection.getRange();\n\t\t\tif (!range.collapsed) {\n\t\t\t\tvar img = range.getClosedNode();\n\t\t\t\tif (img && img.tagName == 'IMG') {\n\t\t\t\t\tswitch (align) {\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\tvar pN = img.parentNode,\n\t\t\t\t\t\t\t\ttmpNode, pre, next;\n\t\t\t\t\t\t\twhile (dtd.$inline[pN.tagName] || pN.tagName == 'A') {\n\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\tif (tmpNode.tagName == 'P' && domUtils.getStyle(tmpNode, 'text-align') == 'center') {\n\t\t\t\t\t\t\t\tif (!domUtils.isBody(tmpNode) && domUtils.getChildCount(tmpNode, function(node) {\n\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t\t\t\t\t}) == 1) {\n\t\t\t\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\t\tif (pre && next && pre.nodeType == 1 && next.nodeType == 1 && pre.tagName == next.tagName && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(tmpNode.firstChild);\n\t\t\t\t\t\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(next.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'text-align', '');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trange.selectNode(img).select();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', align == 'none' ? '' : align);\n\t\t\t\t\t\t\tif (align == 'none') {\n\t\t\t\t\t\t\t\tdomUtils.removeAttributes(img, 'align');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\tif (me.queryCommandValue('imagefloat') != 'center') {\n\t\t\t\t\t\t\t\tpN = img.parentNode;\n\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', '');\n\t\t\t\t\t\t\t\tdomUtils.removeAttributes(img, 'align');\n\t\t\t\t\t\t\t\ttmpNode = img;\n\t\t\t\t\t\t\t\twhile (pN && domUtils.getChildCount(pN, function(node) {\n\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t\t\t\t\t}) == 1 && (dtd.$inline[pN.tagName] || pN.tagName == 'A')) {\n\t\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.setStartBefore(tmpNode).setCursor(false);\n\t\t\t\t\t\t\t\tpN = me.document.createElement('div');\n\t\t\t\t\t\t\t\tpN.appendChild(tmpNode);\n\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'float', '');\n\n\t\t\t\t\t\t\t\tme.execCommand('insertHtml', '<p id=\"_img_parent_tmp\" style=\"text-align:center\">' + pN.innerHTML + '</p>');\n\n\t\t\t\t\t\t\t\ttmpNode = me.document.getElementById('_img_parent_tmp');\n\t\t\t\t\t\t\t\ttmpNode.removeAttribute('id');\n\t\t\t\t\t\t\t\ttmpNode = tmpNode.firstChild;\n\t\t\t\t\t\t\t\trange.selectNode(tmpNode).select();\n\t\t\t\t\t\t\t\t//去掉后边多余的元素\n\t\t\t\t\t\t\t\tnext = tmpNode.parentNode.nextSibling;\n\t\t\t\t\t\t\t\tif (next && domUtils.isEmptyNode(next)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tqueryCommandValue: function() {\n\t\t\tvar range = this.selection.getRange(),\n\t\t\t\tstartNode, floatStyle;\n\t\t\tif (range.collapsed) {\n\t\t\t\treturn 'none';\n\t\t\t}\n\t\t\tstartNode = range.getClosedNode();\n\t\t\tif (startNode && startNode.nodeType == 1 && startNode.tagName == 'IMG') {\n\t\t\t\tfloatStyle = domUtils.getComputedStyle(startNode, 'float') || startNode.getAttribute('align');\n\n\t\t\t\tif (floatStyle == 'none') {\n\t\t\t\t\tfloatStyle = domUtils.getComputedStyle(startNode.parentNode, 'text-align') == 'center' ? 'center' : floatStyle;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tleft: 1,\n\t\t\t\t\tright: 1,\n\t\t\t\t\tcenter: 1\n\t\t\t\t}[floatStyle] ? floatStyle: 'none';\n\t\t\t}\n\t\t\treturn 'none';\n\n\t\t},\n\t\tqueryCommandState: function() {\n\t\t\tvar range = this.selection.getRange(),\n\t\t\t\tstartNode;\n\n\t\t\tif (range.collapsed) return -1;\n\n\t\t\tstartNode = range.getClosedNode();\n\t\t\tif (startNode && startNode.nodeType == 1 && startNode.tagName == 'IMG') {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\t};\n\n\t/**\n\t * 插入图片\n\t * @command insertimage\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { Object } opt 属性键值对，这些属性都将被复制到当前插入图片\n\t * @remind 该命令第二个参数可接受一个图片配置项对象的数组，可以插入多张图片，\n\t * 此时数组的每一个元素都是一个Object类型的图片属性集合。\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'insertimage', {\n\t *     src:'a/b/c.jpg',\n\t *     width:'100',\n\t *     height:'100'\n\t * } );\n\t * ```\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'insertimage', [{\n\t *     src:'a/b/c.jpg',\n\t *     width:'100',\n\t *     height:'100'\n\t * },{\n\t *     src:'a/b/d.jpg',\n\t *     width:'100',\n\t *     height:'100'\n\t * }] );\n\t * ```\n\t */\n\n\tUE.commands['insertimage'] = {\n\t\texecCommand: function(cmd, opt) {\n\n\t\t\topt = utils.isArray(opt) ? opt : [opt];\n\t\t\tif (!opt.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar me = this,\n\t\t\t\trange = me.selection.getRange(),\n\t\t\t\timg = range.getClosedNode();\n\n\t\t\tif (me.fireEvent('beforeinsertimage', opt) === true) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfunction unhtmlData(imgCi) {\n\n\t\t\t\tutils.each('width,height,border,hspace,vspace'.split(','), function(item) {\n\n\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\timgCi[item] = parseInt(imgCi[item], 10) || 0;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tutils.each('src,_src'.split(','), function(item) {\n\n\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\timgCi[item] = utils.unhtmlForUrl(imgCi[item]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tutils.each('title,alt'.split(','), function(item) {\n\n\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\timgCi[item] = utils.unhtml(imgCi[item]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (img && /img/i.test(img.tagName) && (img.className != \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1) && !img.getAttribute(\"word_img\")) {\n\t\t\t\tvar first = opt.shift();\n\t\t\t\tvar floatStyle = first['floatStyle'];\n\t\t\t\tdelete first['floatStyle'];\n\t\t\t\t////                img.style.border = (first.border||0) +\"px solid #000\";\n\t\t\t\t////                img.style.margin = (first.margin||0) +\"px\";\n\t\t\t\t//                img.style.cssText += ';margin:' + (first.margin||0) +\"px;\" + 'border:' + (first.border||0) +\"px solid #000\";\n\t\t\t\tdomUtils.setAttributes(img, first);\n\t\t\t\tme.execCommand('imagefloat', floatStyle);\n\t\t\t\tif (opt.length > 0) {\n\t\t\t\t\trange.setStartAfter(img).setCursor(false, true);\n\t\t\t\t\tme.execCommand('insertimage', opt);\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tvar html = [],\n\t\t\t\t\tstr = '',\n\t\t\t\t\tci;\n\t\t\t\tci = opt[0];\n\t\t\t\tif (opt.length == 1) {\n\t\t\t\t\tunhtmlData(ci);\n\n\t\t\t\t\tstr = '<img src=\"' + ci.src + '\" ' + (ci._src ? ' _src=\"' + ci._src + '\" ' : '') +\n\t\t\t\t\t\t(ci.width ? 'width=\"' + ci.width + '\" ' : '') +\n\t\t\t\t\t\t(ci.height ? ' height=\"' + ci.height + '\" ' : '') +\n\t\t\t\t\t\t(ci['floatStyle'] == 'left' || ci['floatStyle'] == 'right' ? ' style=\"float:' + ci['floatStyle'] + ';\"' : '') +\n\t\t\t\t\t\t(ci.title && ci.title != \"\" ? ' title=\"' + ci.title + '\"' : '') +\n\t\t\t\t\t\t(ci.border && ci.border != \"0\" ? ' border=\"' + ci.border + '\"' : '') +\n\t\t\t\t\t\t(ci.alt && ci.alt != \"\" ? ' alt=\"' + ci.alt + '\"' : '') +\n\t\t\t\t\t\t(ci.hspace && ci.hspace != \"0\" ? ' hspace = \"' + ci.hspace + '\"' : '') +\n\t\t\t\t\t\t(ci.vspace && ci.vspace != \"0\" ? ' vspace = \"' + ci.vspace + '\"' : '') + '/>';\n\t\t\t\t\tif (ci['floatStyle'] == 'center') {\n\t\t\t\t\t\tstr = '<p style=\"text-align: center\">' + str + '</p>';\n\t\t\t\t\t}\n\t\t\t\t\thtml.push(str);\n\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = 0; ci = opt[i++];) {\n\t\t\t\t\t\tunhtmlData(ci);\n\t\t\t\t\t\tstr = '<p ' + (ci['floatStyle'] == 'center' ? 'style=\"text-align: center\" ' : '') + '><img src=\"' + ci.src + '\" ' +\n\t\t\t\t\t\t\t(ci.width ? 'width=\"' + ci.width + '\" ' : '') + (ci._src ? ' _src=\"' + ci._src + '\" ' : '') +\n\t\t\t\t\t\t\t(ci.height ? ' height=\"' + ci.height + '\" ' : '') +\n\t\t\t\t\t\t\t' style=\"' + (ci['floatStyle'] && ci['floatStyle'] != 'center' ? 'float:' + ci['floatStyle'] + ';' : '') +\n\t\t\t\t\t\t\t(ci.border || '') + '\" ' +\n\t\t\t\t\t\t\t(ci.title ? ' title=\"' + ci.title + '\"' : '') + ' /></p>';\n\t\t\t\t\t\thtml.push(str);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tme.execCommand('insertHtml', html.join(''));\n\t\t\t}\n\n\t\t\tme.fireEvent('afterinsertimage', opt)\n\t\t}\n\t};\n\n\t// plugins/justify.js\n\t/**\n\t * 段落格式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 段落对齐方式\n\t * @command justify\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } align 对齐方式：left => 居左，right => 居右，center => 居中，justify => 两端对齐\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'justify', 'center' );\n\t * ```\n\t */\n\t/**\n\t * 如果选区所在位置是段落区域，返回当前段落对齐方式\n\t * @command justify\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回段落对齐方式\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'justify' );\n\t * ```\n\t */\n\n\tUE.plugins['justify'] = function() {\n\t\tvar me = this,\n\t\t\tblock = domUtils.isBlockElm,\n\t\t\tdefaultValue = {\n\t\t\t\tleft: 1,\n\t\t\t\tright: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\tjustify: 1\n\t\t\t},\n\t\t\tdoJustify = function(range, style) {\n\t\t\t\tvar bookmark = range.createBookmark(),\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t};\n\n\t\t\t\trange.enlarge(true);\n\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\ttmpNode;\n\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\t\t\t\t\tvar common = tmpRange.getCommonAncestor();\n\t\t\t\t\t\tif (!domUtils.isBody(common) && block(common)) {\n\t\t\t\t\t\t\tdomUtils.setStyles(common, utils.isString(style) ? {\n\t\t\t\t\t\t\t\t'text-align': style\n\t\t\t\t\t\t\t} : style);\n\t\t\t\t\t\t\tcurrent = common;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar p = range.document.createElement('p');\n\t\t\t\t\t\t\tdomUtils.setStyles(p, utils.isString(style) ? {\n\t\t\t\t\t\t\t\t'text-align': style\n\t\t\t\t\t\t\t} : style);\n\t\t\t\t\t\t\tvar frag = tmpRange.extractContents();\n\t\t\t\t\t\t\tp.appendChild(frag);\n\t\t\t\t\t\t\ttmpRange.insertNode(p);\n\t\t\t\t\t\t\tcurrent = p;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t};\n\n\t\tUE.commands['justify'] = {\n\t\t\texecCommand: function(cmdName, align) {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\ttxt;\n\n\t\t\t\t//闭合时单独处理\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\ttxt = this.document.createTextNode('p');\n\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t}\n\t\t\t\tdoJustify(range, align);\n\t\t\t\tif (txt) {\n\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t}\n\n\t\t\t\trange.select();\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar startNode = this.selection.getStart(),\n\t\t\t\t\tvalue = domUtils.getComputedStyle(startNode, 'text-align');\n\t\t\t\treturn defaultValue[value] ? value : 'left';\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar start = this.selection.getStart(),\n\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\n\t\t\t\treturn cell ? -1 : 0;\n\t\t\t}\n\n\t\t};\n\t};\n\n\t// plugins/font.js\n\t/**\n\t * 字体颜色,背景色,字号,字体,下划线,删除线\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 字体颜色\n\t * @command forecolor\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 色值(必须十六进制)\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'forecolor', '#000' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体颜色\n\t * @command forecolor\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体颜色\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'forecolor' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体背景颜色\n\t * @command backcolor\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 色值(必须十六进制)\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'backcolor', '#000' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体颜色\n\t * @command backcolor\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体背景颜色\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'backcolor' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体大小\n\t * @command fontsize\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 字体大小\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'fontsize', '14px' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体大小\n\t * @command fontsize\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体大小\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'fontsize' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体样式\n\t * @command fontfamily\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 字体样式\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'fontfamily', '微软雅黑' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体样式\n\t * @command fontfamily\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体样式\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'fontfamily' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体下划线,与删除线互斥\n\t * @command underline\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'underline' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体删除线,与下划线互斥\n\t * @command strikethrough\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'strikethrough' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体边框\n\t * @command fontborder\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'fontborder' );\n\t * ```\n\t */\n\n\tUE.plugins['font'] = function() {\n\t\tvar me = this,\n\t\t\tfonts = {\n\t\t\t\t'forecolor': 'color',\n\t\t\t\t'backcolor': 'background-color',\n\t\t\t\t'fontsize': 'font-size',\n\t\t\t\t'fontfamily': 'font-family',\n\t\t\t\t'underline': 'text-decoration',\n\t\t\t\t'strikethrough': 'text-decoration',\n\t\t\t\t'fontborder': 'border'\n\t\t\t},\n\t\t\tneedCmd = {\n\t\t\t\t'underline': 1,\n\t\t\t\t'strikethrough': 1,\n\t\t\t\t'fontborder': 1\n\t\t\t},\n\t\t\tneedSetChild = {\n\t\t\t\t'forecolor': 'color',\n\t\t\t\t'backcolor': 'background-color',\n\t\t\t\t'fontsize': 'font-size',\n\t\t\t\t'fontfamily': 'font-family'\n\n\t\t\t};\n\t\tme.setOpt({\n\t\t\t'fontfamily': [{\n\t\t\t\tname: 'songti',\n\t\t\t\tval: '宋体,SimSun'\n\t\t\t}, {\n\t\t\t\tname: 'yahei',\n\t\t\t\tval: '微软雅黑,Microsoft YaHei'\n\t\t\t}, {\n\t\t\t\tname: 'kaiti',\n\t\t\t\tval: '楷体,楷体_GB2312, SimKai'\n\t\t\t}, {\n\t\t\t\tname: 'heiti',\n\t\t\t\tval: '黑体, SimHei'\n\t\t\t}, {\n\t\t\t\tname: 'lishu',\n\t\t\t\tval: '隶书, SimLi'\n\t\t\t}, {\n\t\t\t\tname: 'andaleMono',\n\t\t\t\tval: 'andale mono'\n\t\t\t}, {\n\t\t\t\tname: 'arial',\n\t\t\t\tval: 'arial, helvetica,sans-serif'\n\t\t\t}, {\n\t\t\t\tname: 'arialBlack',\n\t\t\t\tval: 'arial black,avant garde'\n\t\t\t}, {\n\t\t\t\tname: 'comicSansMs',\n\t\t\t\tval: 'comic sans ms'\n\t\t\t}, {\n\t\t\t\tname: 'impact',\n\t\t\t\tval: 'impact,chicago'\n\t\t\t}, {\n\t\t\t\tname: 'timesNewRoman',\n\t\t\t\tval: 'times new roman'\n\t\t\t}],\n\t\t\t'fontsize': [10, 11, 12, 14, 16, 18, 20, 24, 36]\n\t\t});\n\n\t\tfunction mergeWithParent(node) {\n\t\t\tvar parent;\n\t\t\twhile (parent = node.parentNode) {\n\t\t\t\tif (parent.tagName == 'SPAN' && domUtils.getChildCount(parent, function(child) {\n\t\t\t\t\t\treturn !domUtils.isBookmarkNode(child) && !domUtils.isBr(child)\n\t\t\t\t\t}) == 1) {\n\t\t\t\t\tparent.style.cssText += node.style.cssText;\n\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t\tnode = parent;\n\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tfunction mergeChild(rng, cmdName, value) {\n\t\t\tif (needSetChild[cmdName]) {\n\t\t\t\trng.adjustmentBoundary();\n\t\t\t\tif (!rng.collapsed && rng.startContainer.nodeType == 1) {\n\t\t\t\t\tvar start = rng.startContainer.childNodes[rng.startOffset];\n\t\t\t\t\tif (start && domUtils.isTagNode(start, 'span')) {\n\t\t\t\t\t\tvar bk = rng.createBookmark();\n\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(start, 'span'), function(span) {\n\t\t\t\t\t\t\tif (!span.parentNode || domUtils.isBookmarkNode(span)) return;\n\t\t\t\t\t\t\tif (cmdName == 'backcolor' && domUtils.getComputedStyle(span, 'background-color').toLowerCase() === value) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.removeStyle(span, needSetChild[cmdName]);\n\t\t\t\t\t\t\tif (span.style.cssText.replace(/^\\s+$/, '').length == 0) {\n\t\t\t\t\t\t\t\tdomUtils.remove(span, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\trng.moveToBookmark(bk)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tfunction mergesibling(rng, cmdName, value) {\n\t\t\tvar collapsed = rng.collapsed,\n\t\t\t\tbk = rng.createBookmark(),\n\t\t\t\tcommon;\n\t\t\tif (collapsed) {\n\t\t\t\tcommon = bk.start.parentNode;\n\t\t\t\twhile (dtd.$inline[common.tagName]) {\n\t\t\t\t\tcommon = common.parentNode;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcommon = domUtils.getCommonAncestor(bk.start, bk.end);\n\t\t\t}\n\t\t\tutils.each(domUtils.getElementsByTagName(common, 'span'), function(span) {\n\t\t\t\tif (!span.parentNode || domUtils.isBookmarkNode(span)) return;\n\t\t\t\tif (/\\s*border\\s*:\\s*none;?\\s*/i.test(span.style.cssText)) {\n\t\t\t\t\tif (/^\\s*border\\s*:\\s*none;?\\s*$/.test(span.style.cssText)) {\n\t\t\t\t\t\tdomUtils.remove(span, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomUtils.removeStyle(span, 'border');\n\t\t\t\t\t}\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (/border/i.test(span.style.cssText) && span.parentNode.tagName == 'SPAN' && /border/i.test(span.parentNode.style.cssText)) {\n\t\t\t\t\tspan.style.cssText = span.style.cssText.replace(/border[^:]*:[^;]+;?/gi, '');\n\t\t\t\t}\n\t\t\t\tif (!(cmdName == 'fontborder' && value == 'none')) {\n\t\t\t\t\tvar next = span.nextSibling;\n\t\t\t\t\twhile (next && next.nodeType == 1 && next.tagName == 'SPAN') {\n\t\t\t\t\t\tif (domUtils.isBookmarkNode(next) && cmdName == 'fontborder') {\n\t\t\t\t\t\t\tspan.appendChild(next);\n\t\t\t\t\t\t\tnext = span.nextSibling;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (next.style.cssText == span.style.cssText) {\n\t\t\t\t\t\t\tdomUtils.moveChild(next, span);\n\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (span.nextSibling === next)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tnext = span.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tmergeWithParent(span);\n\t\t\t\tif (browser.ie && browser.version > 8) {\n\t\t\t\t\t//拷贝父亲们的特别的属性,这里只做背景颜色的处理\n\t\t\t\t\tvar parent = domUtils.findParent(span, function(n) {\n\t\t\t\t\t\treturn n.tagName == 'SPAN' && /background-color/.test(n.style.cssText)\n\t\t\t\t\t});\n\t\t\t\t\tif (parent && !/background-color/.test(span.style.cssText)) {\n\t\t\t\t\t\tspan.style.backgroundColor = parent.style.backgroundColor;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\trng.moveToBookmark(bk);\n\t\t\tmergeChild(rng, cmdName, value)\n\t\t}\n\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('u s del font strike'), function(node) {\n\t\t\t\tif (node.tagName == 'font') {\n\t\t\t\t\tvar cssStyle = [];\n\t\t\t\t\tfor (var p in node.attrs) {\n\t\t\t\t\t\tswitch (p) {\n\t\t\t\t\t\t\tcase 'size':\n\t\t\t\t\t\t\t\tcssStyle.push('font-size:' +\n\t\t\t\t\t\t\t\t\t({\n\t\t\t\t\t\t\t\t\t\t'1': '10',\n\t\t\t\t\t\t\t\t\t\t'2': '12',\n\t\t\t\t\t\t\t\t\t\t'3': '16',\n\t\t\t\t\t\t\t\t\t\t'4': '18',\n\t\t\t\t\t\t\t\t\t\t'5': '24',\n\t\t\t\t\t\t\t\t\t\t'6': '32',\n\t\t\t\t\t\t\t\t\t\t'7': '48'\n\t\t\t\t\t\t\t\t\t}[node.attrs[p]] || node.attrs[p]) + 'px');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'color':\n\t\t\t\t\t\t\t\tcssStyle.push('color:' + node.attrs[p]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'face':\n\t\t\t\t\t\t\t\tcssStyle.push('font-family:' + node.attrs[p]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\t\tcssStyle.push(node.attrs[p]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnode.attrs = {\n\t\t\t\t\t\t'style': cssStyle.join(';')\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tvar val = node.tagName == 'u' ? 'underline' : 'line-through';\n\t\t\t\t\tnode.attrs = {\n\t\t\t\t\t\t'style': (node.getAttr('style') || '') + 'text-decoration:' + val + ';'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnode.tagName = 'span';\n\t\t\t});\n\t\t\t//        utils.each(root.getNodesByTagName('span'), function (node) {\n\t\t\t//            var val;\n\t\t\t//            if(val = node.getAttr('class')){\n\t\t\t//                if(/fontstrikethrough/.test(val)){\n\t\t\t//                    node.setStyle('text-decoration','line-through');\n\t\t\t//                    if(node.attrs['class']){\n\t\t\t//                        node.attrs['class'] = node.attrs['class'].replace(/fontstrikethrough/,'');\n\t\t\t//                    }else{\n\t\t\t//                        node.setAttr('class')\n\t\t\t//                    }\n\t\t\t//                }\n\t\t\t//                if(/fontborder/.test(val)){\n\t\t\t//                    node.setStyle('border','1px solid #000');\n\t\t\t//                    if(node.attrs['class']){\n\t\t\t//                        node.attrs['class'] = node.attrs['class'].replace(/fontborder/,'');\n\t\t\t//                    }else{\n\t\t\t//                        node.setAttr('class')\n\t\t\t//                    }\n\t\t\t//                }\n\t\t\t//            }\n\t\t\t//        });\n\t\t});\n\t\t//    me.addOutputRule(function(root){\n\t\t//        utils.each(root.getNodesByTagName('span'), function (node) {\n\t\t//            var val;\n\t\t//            if(val = node.getStyle('text-decoration')){\n\t\t//                if(/line-through/.test(val)){\n\t\t//                    if(node.attrs['class']){\n\t\t//                        node.attrs['class'] += ' fontstrikethrough';\n\t\t//                    }else{\n\t\t//                        node.setAttr('class','fontstrikethrough')\n\t\t//                    }\n\t\t//                }\n\t\t//\n\t\t//                node.setStyle('text-decoration')\n\t\t//            }\n\t\t//            if(val = node.getStyle('border')){\n\t\t//                if(/1px/.test(val) && /solid/.test(val)){\n\t\t//                    if(node.attrs['class']){\n\t\t//                        node.attrs['class'] += ' fontborder';\n\t\t//\n\t\t//                    }else{\n\t\t//                        node.setAttr('class','fontborder')\n\t\t//                    }\n\t\t//                }\n\t\t//                node.setStyle('border')\n\t\t//\n\t\t//            }\n\t\t//        });\n\t\t//    });\n\t\tfor (var p in fonts) {\n\t\t\t(function(cmd, style) {\n\t\t\t\tUE.commands[cmd] = {\n\t\t\t\t\texecCommand: function(cmdName, value) {\n\t\t\t\t\t\tvalue = value || (this.queryCommandState(cmdName) ? 'none' : cmdName == 'underline' ? 'underline' :\n\t\t\t\t\t\t\tcmdName == 'fontborder' ? '1px solid #000' :\n\t\t\t\t\t\t\t'line-through');\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = this.selection.getRange(),\n\t\t\t\t\t\t\ttext;\n\n\t\t\t\t\t\tif (value == 'default') {\n\n\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\ttext = me.document.createTextNode('font');\n\t\t\t\t\t\t\t\trange.insertNode(text).select();\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\tif (text) {\n\t\t\t\t\t\t\t\trange.setStartBefore(text).collapse(true);\n\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\trange.select()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\t\tif (needCmd[cmd] && me.queryCommandValue(cmd)) {\n\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange = me.selection.getRange();\n\n\t\t\t\t\t\t\t\trange.applyInlineStyle('span', {\n\t\t\t\t\t\t\t\t\t'style': style + ':' + value\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tvar span = domUtils.findParentByTagName(range.startContainer, 'span', true);\n\t\t\t\t\t\t\t\ttext = me.document.createTextNode('font');\n\t\t\t\t\t\t\t\tif (span && !span.children.length && !span[browser.ie ? 'innerText' : 'textContent'].replace(fillCharReg, '').length) {\n\t\t\t\t\t\t\t\t\t//for ie hack when enter\n\t\t\t\t\t\t\t\t\trange.insertNode(text);\n\t\t\t\t\t\t\t\t\tif (needCmd[cmd]) {\n\t\t\t\t\t\t\t\t\t\trange.selectNode(text).select();\n\t\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style, null);\n\n\t\t\t\t\t\t\t\t\t\tspan = domUtils.findParentByTagName(text, 'span', true);\n\t\t\t\t\t\t\t\t\t\trange.setStartBefore(text);\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tspan && (span.style.cssText += ';' + style + ':' + value);\n\t\t\t\t\t\t\t\t\trange.collapse(true).select();\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.insertNode(text);\n\t\t\t\t\t\t\t\t\trange.selectNode(text).select();\n\t\t\t\t\t\t\t\t\tspan = range.document.createElement('span');\n\n\t\t\t\t\t\t\t\t\tif (needCmd[cmd]) {\n\t\t\t\t\t\t\t\t\t\t//a标签内的不处理跳过\n\t\t\t\t\t\t\t\t\t\tif (domUtils.findParentByTagName(text, 'a', true)) {\n\t\t\t\t\t\t\t\t\t\t\trange.setStartBefore(text).setCursor();\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tspan.style.cssText = style + ':' + value;\n\n\t\t\t\t\t\t\t\t\ttext.parentNode.insertBefore(span, text);\n\t\t\t\t\t\t\t\t\t//修复，span套span 但样式不继承的问题\n\t\t\t\t\t\t\t\t\tif (!browser.ie || browser.ie && browser.version == 9) {\n\t\t\t\t\t\t\t\t\t\tvar spanParent = span.parentNode;\n\t\t\t\t\t\t\t\t\t\twhile (!domUtils.isBlockElm(spanParent)) {\n\t\t\t\t\t\t\t\t\t\t\tif (spanParent.tagName == 'SPAN') {\n\t\t\t\t\t\t\t\t\t\t\t\t//opera合并style不会加入\";\"\n\t\t\t\t\t\t\t\t\t\t\t\tspan.style.cssText = spanParent.style.cssText + \";\" + span.style.cssText;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tspanParent = spanParent.parentNode;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (opera) {\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\trange.setStart(span, 0).collapse(true);\n\t\t\t\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trange.setStart(span, 0).collapse(true);\n\t\t\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t//trace:981\n\t\t\t\t\t\t\t\t\t//domUtils.mergeToParent(span)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandValue: function(cmdName) {\n\t\t\t\t\t\tvar startNode = this.selection.getStart();\n\n\t\t\t\t\t\t//trace:946\n\t\t\t\t\t\tif (cmdName == 'underline' || cmdName == 'strikethrough') {\n\t\t\t\t\t\t\tvar tmpNode = startNode,\n\t\t\t\t\t\t\t\tvalue;\n\t\t\t\t\t\t\twhile (tmpNode && !domUtils.isBlockElm(tmpNode) && !domUtils.isBody(tmpNode)) {\n\t\t\t\t\t\t\t\tif (tmpNode.nodeType == 1) {\n\t\t\t\t\t\t\t\t\tvalue = domUtils.getComputedStyle(tmpNode, style);\n\t\t\t\t\t\t\t\t\tif (value != 'none') {\n\t\t\t\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttmpNode = tmpNode.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (cmdName == 'fontborder') {\n\t\t\t\t\t\t\tvar tmp = startNode,\n\t\t\t\t\t\t\t\tval;\n\t\t\t\t\t\t\twhile (tmp && dtd.$inline[tmp.tagName]) {\n\t\t\t\t\t\t\t\tif (val = domUtils.getComputedStyle(tmp, 'border')) {\n\n\t\t\t\t\t\t\t\t\tif (/1px/.test(val) && /solid/.test(val)) {\n\t\t\t\t\t\t\t\t\t\treturn val;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmp = tmp.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn ''\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (cmdName == 'FontSize') {\n\t\t\t\t\t\t\tvar styleVal = domUtils.getComputedStyle(startNode, style),\n\t\t\t\t\t\t\t\ttmp = /^([\\d\\.]+)(\\w+)$/.exec(styleVal);\n\n\t\t\t\t\t\t\tif (tmp) {\n\n\t\t\t\t\t\t\t\treturn Math.floor(tmp[1]) + tmp[2];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn styleVal;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn domUtils.getComputedStyle(startNode, style);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\t\t\tif (!needCmd[cmdName])\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\tvar val = this.queryCommandValue(cmdName);\n\t\t\t\t\t\tif (cmdName == 'fontborder') {\n\t\t\t\t\t\t\treturn /1px/.test(val) && /solid/.test(val)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn cmdName == 'underline' ? /underline/.test(val) : /line\\-through/.test(val);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t})(p, fonts[p]);\n\t\t}\n\t};\n\n\t// plugins/link.js\n\t/**\n\t * 超链接\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入超链接\n\t * @command link\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { Object } options   设置自定义属性，例如：url、title、target\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'link', '{\n\t *     url:'ueditor.baidu.com',\n\t *     title:'ueditor',\n\t *     target:'_blank'\n\t * }' );\n\t * ```\n\t */\n\t/**\n\t * 返回当前选中的第一个超链接节点\n\t * @command link\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { Element } 超链接节点\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'link' );\n\t * ```\n\t */\n\n\t/**\n\t * 取消超链接\n\t * @command unlink\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'unlink');\n\t * ```\n\t */\n\n\tUE.plugins['link'] = function() {\n\t\tfunction optimize(range) {\n\t\t\tvar start = range.startContainer,\n\t\t\t\tend = range.endContainer;\n\n\t\t\tif (start = domUtils.findParentByTagName(start, 'a', true)) {\n\t\t\t\trange.setStartBefore(start);\n\t\t\t}\n\t\t\tif (end = domUtils.findParentByTagName(end, 'a', true)) {\n\t\t\t\trange.setEndAfter(end);\n\t\t\t}\n\t\t}\n\n\t\tUE.commands['unlink'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tbookmark;\n\t\t\t\tif (range.collapsed && !domUtils.findParentByTagName(range.startContainer, 'a', true)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbookmark = range.createBookmark();\n\t\t\t\toptimize(range);\n\t\t\t\trange.removeInlineStyle('a').moveToBookmark(bookmark).select();\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn !this.highlight && this.queryCommandValue('link') ? 0 : -1;\n\t\t\t}\n\n\t\t};\n\n\t\tfunction doLink(range, opt, me) {\n\t\t\tvar rngClone = range.cloneRange(),\n\t\t\t\tlink = me.queryCommandValue('link');\n\t\t\toptimize(range = range.adjustmentBoundary());\n\t\t\tvar start = range.startContainer;\n\t\t\tif (start.nodeType == 1 && link) {\n\t\t\t\tstart = start.childNodes[range.startOffset];\n\t\t\t\tif (start && start.nodeType == 1 && start.tagName == 'A' && /^(?:https?|ftp|file)\\s*:\\s*\\/\\//.test(start[browser.ie ? 'innerText' : 'textContent'])) {\n\t\t\t\t\tstart[browser.ie ? 'innerText' : 'textContent'] = utils.html(opt.textValue || opt.href);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!rngClone.collapsed || link) {\n\t\t\t\trange.removeInlineStyle('a');\n\t\t\t\trngClone = range.cloneRange();\n\t\t\t}\n\n\t\t\tif (rngClone.collapsed) {\n\t\t\t\tvar a = range.document.createElement('a'),\n\t\t\t\t\ttext = '';\n\t\t\t\tif (opt.textValue) {\n\n\t\t\t\t\ttext = utils.html(opt.textValue);\n\t\t\t\t\tdelete opt.textValue;\n\t\t\t\t} else {\n\t\t\t\t\ttext = utils.html(opt.href);\n\n\t\t\t\t}\n\t\t\t\tdomUtils.setAttributes(a, opt);\n\t\t\t\tstart = domUtils.findParentByTagName(rngClone.startContainer, 'a', true);\n\t\t\t\tif (start && domUtils.isInNodeEndBoundary(rngClone, start)) {\n\t\t\t\t\trange.setStartAfter(start).collapse(true);\n\n\t\t\t\t}\n\t\t\t\ta[browser.ie ? 'innerText' : 'textContent'] = text;\n\t\t\t\trange.insertNode(a).selectNode(a);\n\t\t\t} else {\n\t\t\t\trange.applyInlineStyle('a', opt);\n\n\t\t\t}\n\t\t}\n\t\tUE.commands['link'] = {\n\t\t\texecCommand: function(cmdName, opt) {\n\t\t\t\tvar range;\n\t\t\t\topt._href && (opt._href = utils.unhtml(opt._href, /[<\">]/g));\n\t\t\t\topt.href && (opt.href = utils.unhtml(opt.href, /[<\">]/g));\n\t\t\t\topt.textValue && (opt.textValue = utils.unhtml(opt.textValue, /[<\">]/g));\n\t\t\t\tdoLink(range = this.selection.getRange(), opt, this);\n\t\t\t\t//闭合都不加占位符，如果加了会在a后边多个占位符节点，导致a是图片背景组成的列表，出现空白问题\n\t\t\t\trange.collapse().select(true);\n\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tnode;\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t//                    node = this.selection.getStart();\n\t\t\t\t\t//在ie下getstart()取值偏上了\n\t\t\t\t\tnode = range.startContainer;\n\t\t\t\t\tnode = node.nodeType == 1 ? node : node.parentNode;\n\n\t\t\t\t\tif (node && (node = domUtils.findParentByTagName(node, 'a', true)) && !domUtils.isInNodeEndBoundary(range, node)) {\n\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//trace:1111  如果是<p><a>xx</a></p> startContainer是p就会找不到a\n\t\t\t\t\trange.shrinkBoundary();\n\t\t\t\t\tvar start = range.startContainer.nodeType == 3 || !range.startContainer.childNodes[range.startOffset] ? range.startContainer : range.startContainer.childNodes[range.startOffset],\n\t\t\t\t\t\tend = range.endContainer.nodeType == 3 || range.endOffset == 0 ? range.endContainer : range.endContainer.childNodes[range.endOffset - 1],\n\t\t\t\t\t\tcommon = range.getCommonAncestor();\n\t\t\t\t\tnode = domUtils.findParentByTagName(common, 'a', true);\n\t\t\t\t\tif (!node && common.nodeType == 1) {\n\n\t\t\t\t\t\tvar as = common.getElementsByTagName('a'),\n\t\t\t\t\t\t\tps, pe;\n\n\t\t\t\t\t\tfor (var i = 0, ci; ci = as[i++];) {\n\t\t\t\t\t\t\tps = domUtils.getPosition(ci, start), pe = domUtils.getPosition(ci, end);\n\t\t\t\t\t\t\tif ((ps & domUtils.POSITION_FOLLOWING || ps & domUtils.POSITION_CONTAINS) &&\n\t\t\t\t\t\t\t\t(pe & domUtils.POSITION_PRECEDING || pe & domUtils.POSITION_CONTAINS)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tnode = ci;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\t//判断如果是视频的话连接不可用\n\t\t\t\t//fix 853\n\t\t\t\tvar img = this.selection.getRange().getClosedNode(),\n\t\t\t\t\tflag = img && (img.className == \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1);\n\t\t\t\treturn flag ? -1 : 0;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/iframe.js\n\t///import core\n\t///import plugins\\inserthtml.js\n\t///commands 插入框架\n\t///commandsName  InsertFrame\n\t///commandsTitle  插入Iframe\n\t///commandsDialog  dialogs\\insertframe\n\n\tUE.plugins['insertframe'] = function() {\n\t\tvar me = this;\n\n\t\tfunction deleteIframe() {\n\t\t\tme._iframe && delete me._iframe;\n\t\t}\n\n\t\tme.addListener(\"selectionchange\", function() {\n\t\t\tdeleteIframe();\n\t\t});\n\n\t};\n\n\t// plugins/scrawl.js\n\t///import core\n\t///commands 涂鸦\n\t///commandsName  Scrawl\n\t///commandsTitle  涂鸦\n\t///commandsDialog  dialogs\\scrawl\n\tUE.commands['scrawl'] = {\n\t\tqueryCommandState: function() {\n\t\t\treturn (browser.ie && browser.version <= 8) ? -1 : 0;\n\t\t}\n\t};\n\n\t// plugins/removeformat.js\n\t/**\n\t * 清除格式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 清除文字样式\n\t * @command removeformat\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param   {String}   tags     以逗号隔开的标签。如：strong\n\t * @param   {String}   style    样式如：color\n\t * @param   {String}   attrs    属性如:width\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'removeformat', 'strong','color','width' );\n\t * ```\n\t */\n\n\tUE.plugins['removeformat'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'removeFormatTags': 'b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var',\n\t\t\t'removeFormatAttributes': 'class,style,lang,width,height,align,hspace,valign'\n\t\t});\n\t\tme.commands['removeformat'] = {\n\t\t\texecCommand: function(cmdName, tags, style, attrs, notIncludeA) {\n\n\t\t\t\tvar tagReg = new RegExp('^(?:' + (tags || this.options.removeFormatTags).replace(/,/g, '|') + ')$', 'i'),\n\t\t\t\t\tremoveFormatAttributes = style ? [] : (attrs || this.options.removeFormatAttributes).split(','),\n\t\t\t\t\trange = new dom.Range(this.document),\n\t\t\t\t\tbookmark, node, parent,\n\t\t\t\t\tfilter = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t};\n\n\t\t\t\tfunction isRedundantSpan(node) {\n\t\t\t\t\tif (node.nodeType == 3 || node.tagName.toLowerCase() != 'span') {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t//ie 下判断实效，所以只能简单用style来判断\n\t\t\t\t\t\t//return node.style.cssText == '' ? 1 : 0;\n\t\t\t\t\t\tvar attrs = node.attributes;\n\t\t\t\t\t\tif (attrs.length) {\n\t\t\t\t\t\t\tfor (var i = 0, l = attrs.length; i < l; i++) {\n\t\t\t\t\t\t\t\tif (attrs[i].specified) {\n\t\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn !node.attributes.length;\n\t\t\t\t}\n\n\t\t\t\tfunction doRemove(range) {\n\n\t\t\t\t\tvar bookmark1 = range.createBookmark();\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\t}\n\n\t\t\t\t\t//不能把a标签切了\n\t\t\t\t\tif (!notIncludeA) {\n\t\t\t\t\t\tvar aNode = domUtils.findParentByTagName(range.startContainer, 'a', true);\n\t\t\t\t\t\tif (aNode) {\n\t\t\t\t\t\t\trange.setStartBefore(aNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\taNode = domUtils.findParentByTagName(range.endContainer, 'a', true);\n\t\t\t\t\t\tif (aNode) {\n\t\t\t\t\t\t\trange.setEndAfter(aNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbookmark = range.createBookmark();\n\n\t\t\t\t\tnode = bookmark.start;\n\n\t\t\t\t\t//切开始\n\t\t\t\t\twhile ((parent = node.parentNode) && !domUtils.isBlockElm(parent)) {\n\t\t\t\t\t\tdomUtils.breakParent(node, parent);\n\n\t\t\t\t\t\tdomUtils.clearEmptySibling(node);\n\t\t\t\t\t}\n\t\t\t\t\tif (bookmark.end) {\n\t\t\t\t\t\t//切结束\n\t\t\t\t\t\tnode = bookmark.end;\n\t\t\t\t\t\twhile ((parent = node.parentNode) && !domUtils.isBlockElm(parent)) {\n\t\t\t\t\t\t\tdomUtils.breakParent(node, parent);\n\t\t\t\t\t\t\tdomUtils.clearEmptySibling(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//开始去除样式\n\t\t\t\t\t\tvar current = domUtils.getNextDomNode(bookmark.start, false, filter),\n\t\t\t\t\t\t\tnext;\n\t\t\t\t\t\twhile (current) {\n\t\t\t\t\t\t\tif (current == bookmark.end) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tnext = domUtils.getNextDomNode(current, true, filter);\n\n\t\t\t\t\t\t\tif (!dtd.$empty[current.tagName.toLowerCase()] && !domUtils.isBookmarkNode(current)) {\n\t\t\t\t\t\t\t\tif (tagReg.test(current.tagName)) {\n\t\t\t\t\t\t\t\t\tif (style) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.removeStyle(current, style);\n\t\t\t\t\t\t\t\t\t\tif (isRedundantSpan(current) && style != 'text-decoration') {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t//trace:939  不能把list上的样式去掉\n\t\t\t\t\t\t\t\t\tif (!dtd.$tableContent[current.tagName] && !dtd.$list[current.tagName]) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(current, removeFormatAttributes);\n\t\t\t\t\t\t\t\t\t\tif (isRedundantSpan(current)) {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcurrent = next;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//trace:1035\n\t\t\t\t\t//trace:1096 不能把td上的样式去掉，比如边框\n\t\t\t\t\tvar pN = bookmark.start.parentNode;\n\t\t\t\t\tif (domUtils.isBlockElm(pN) && !dtd.$tableContent[pN.tagName] && !dtd.$list[pN.tagName]) {\n\t\t\t\t\t\tdomUtils.removeAttributes(pN, removeFormatAttributes);\n\t\t\t\t\t}\n\t\t\t\t\tpN = bookmark.end.parentNode;\n\t\t\t\t\tif (bookmark.end && domUtils.isBlockElm(pN) && !dtd.$tableContent[pN.tagName] && !dtd.$list[pN.tagName]) {\n\t\t\t\t\t\tdomUtils.removeAttributes(pN, removeFormatAttributes);\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bookmark).moveToBookmark(bookmark1);\n\t\t\t\t\t//清除冗余的代码 <b><bookmark></b>\n\t\t\t\t\tvar node = range.startContainer,\n\t\t\t\t\t\ttmp,\n\t\t\t\t\t\tcollapsed = range.collapsed;\n\t\t\t\t\twhile (node.nodeType == 1 && domUtils.isEmptyNode(node) && dtd.$removeEmpty[node.tagName]) {\n\t\t\t\t\t\ttmp = node.parentNode;\n\t\t\t\t\t\trange.setStartBefore(node);\n\t\t\t\t\t\t//trace:937\n\t\t\t\t\t\t//更新结束边界\n\t\t\t\t\t\tif (range.startContainer === range.endContainer) {\n\t\t\t\t\t\t\trange.endOffset--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!collapsed) {\n\t\t\t\t\t\tnode = range.endContainer;\n\t\t\t\t\t\twhile (node.nodeType == 1 && domUtils.isEmptyNode(node) && dtd.$removeEmpty[node.tagName]) {\n\t\t\t\t\t\t\ttmp = node.parentNode;\n\t\t\t\t\t\t\trange.setEndBefore(node);\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\n\t\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trange = this.selection.getRange();\n\t\t\t\tdoRemove(range);\n\t\t\t\trange.select();\n\n\t\t\t}\n\n\t\t};\n\n\t};\n\n\t// plugins/blockquote.js\n\t/**\n\t * 添加引用\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 添加引用\n\t * @command blockquote\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'blockquote' );\n\t * ```\n\t */\n\n\t/**\n\t * 添加引用\n\t * @command blockquote\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { Object } attrs 节点属性\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'blockquote',{\n\t *     style: \"color: red;\"\n\t * } );\n\t * ```\n\t */\n\n\tUE.plugins['blockquote'] = function() {\n\t\tvar me = this;\n\n\t\tfunction getObj(editor) {\n\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), 'blockquote');\n\t\t}\n\t\tme.commands['blockquote'] = {\n\t\t\texecCommand: function(cmdName, attrs) {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tobj = getObj(this),\n\t\t\t\t\tblockquote = dtd.blockquote,\n\t\t\t\t\tbookmark = range.createBookmark();\n\n\t\t\t\tif (obj) {\n\n\t\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\t\tstartBlock = domUtils.isBlockElm(start) ? start : domUtils.findParent(start, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t}),\n\n\t\t\t\t\t\tend = range.endContainer,\n\t\t\t\t\t\tendBlock = domUtils.isBlockElm(end) ? end : domUtils.findParent(end, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t});\n\n\t\t\t\t\t//处理一下li\n\t\t\t\t\tstartBlock = domUtils.findParentByTagName(startBlock, 'li', true) || startBlock;\n\t\t\t\t\tendBlock = domUtils.findParentByTagName(endBlock, 'li', true) || endBlock;\n\n\t\t\t\t\tif (startBlock.tagName == 'LI' || startBlock.tagName == 'TD' || startBlock === obj || domUtils.isBody(startBlock)) {\n\t\t\t\t\t\tdomUtils.remove(obj, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomUtils.breakParent(startBlock, obj);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (startBlock !== endBlock) {\n\t\t\t\t\t\tobj = domUtils.findParentByTagName(endBlock, 'blockquote');\n\t\t\t\t\t\tif (obj) {\n\t\t\t\t\t\t\tif (endBlock.tagName == 'LI' || endBlock.tagName == 'TD' || domUtils.isBody(endBlock)) {\n\t\t\t\t\t\t\t\tobj.parentNode && domUtils.remove(obj, true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.breakParent(endBlock, obj);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar blockquotes = domUtils.getElementsByTagName(this.document, 'blockquote');\n\t\t\t\t\tfor (var i = 0, bi; bi = blockquotes[i++];) {\n\t\t\t\t\t\tif (!bi.childNodes.length) {\n\t\t\t\t\t\t\tdomUtils.remove(bi);\n\t\t\t\t\t\t} else if (domUtils.getPosition(bi, startBlock) & domUtils.POSITION_FOLLOWING && domUtils.getPosition(bi, endBlock) & domUtils.POSITION_PRECEDING) {\n\t\t\t\t\t\t\tdomUtils.remove(bi, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\t\t\tnode = tmpRange.startContainer.nodeType == 1 ? tmpRange.startContainer : tmpRange.startContainer.parentNode,\n\t\t\t\t\t\tpreNode = node,\n\t\t\t\t\t\tdoEnd = 1;\n\n\t\t\t\t\t//调整开始\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\t\t\t\tif (preNode !== node) {\n\t\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\t\ttmpRange.selectNode(preNode);\n\t\t\t\t\t\t\t\t\tdoEnd = 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpRange.setStartBefore(preNode);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttmpRange.setStart(node, 0);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!blockquote[node.tagName]) {\n\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\ttmpRange.selectNode(preNode);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttmpRange.setStartBefore(preNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpreNode = node;\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\n\t\t\t\t\t//调整结束\n\t\t\t\t\tif (doEnd) {\n\t\t\t\t\t\tpreNode = node = node = tmpRange.endContainer.nodeType == 1 ? tmpRange.endContainer : tmpRange.endContainer.parentNode;\n\t\t\t\t\t\twhile (1) {\n\n\t\t\t\t\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\t\t\t\t\tif (preNode !== node) {\n\n\t\t\t\t\t\t\t\t\ttmpRange.setEndAfter(preNode);\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpRange.setEnd(node, node.childNodes.length);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!blockquote[node.tagName]) {\n\t\t\t\t\t\t\t\ttmpRange.setEndAfter(preNode);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tpreNode = node;\n\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tnode = range.document.createElement('blockquote');\n\t\t\t\t\tdomUtils.setAttributes(node, attrs);\n\t\t\t\t\tnode.appendChild(tmpRange.extractContents());\n\t\t\t\t\ttmpRange.insertNode(node);\n\t\t\t\t\t//去除重复的\n\t\t\t\t\tvar childs = domUtils.getElementsByTagName(node, 'blockquote');\n\t\t\t\t\tfor (var i = 0, ci; ci = childs[i++];) {\n\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\trange.moveToBookmark(bookmark).select();\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getObj(this) ? 1 : 0;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/convertcase.js\n\t/**\n\t * 大小写转换\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 把选区内文本变大写，与“tolowercase”命令互斥\n\t * @command touppercase\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'touppercase' );\n\t * ```\n\t */\n\n\t/**\n\t * 把选区内文本变小写，与“touppercase”命令互斥\n\t * @command tolowercase\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'tolowercase' );\n\t * ```\n\t */\n\tUE.commands['touppercase'] =\n\t\tUE.commands['tolowercase'] = {\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\treturn rng;\n\t\t\t\t}\n\t\t\t\tvar bk = rng.createBookmark(),\n\t\t\t\t\tbkEnd = bk.end,\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\t\t\t\t\tcurNode = domUtils.getNextDomNode(bk.start, false, filterFn);\n\t\t\t\twhile (curNode && (domUtils.getPosition(curNode, bkEnd) & domUtils.POSITION_PRECEDING)) {\n\n\t\t\t\t\tif (curNode.nodeType == 3) {\n\t\t\t\t\t\tcurNode.nodeValue = curNode.nodeValue[cmd == 'touppercase' ? 'toUpperCase' : 'toLowerCase']();\n\t\t\t\t\t}\n\t\t\t\t\tcurNode = domUtils.getNextDomNode(curNode, true, filterFn);\n\t\t\t\t\tif (curNode === bkEnd) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\n\t// plugins/indent.js\n\t/**\n\t * 首行缩进\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 缩进\n\t * @command indent\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'indent' );\n\t * ```\n\t */\n\tUE.commands['indent'] = {\n\t\texecCommand: function() {\n\t\t\tvar me = this,\n\t\t\t\tvalue = me.queryCommandState(\"indent\") ? \"0em\" : (me.options.indentValue || '2em');\n\t\t\tme.execCommand('Paragraph', 'p', {\n\t\t\t\tstyle: 'text-indent:' + value\n\t\t\t});\n\t\t},\n\t\tqueryCommandState: function() {\n\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), 'p h1 h2 h3 h4 h5 h6');\n\t\t\treturn pN && pN.style.textIndent && parseInt(pN.style.textIndent) ? 1 : 0;\n\t\t}\n\n\t};\n\n\t// plugins/print.js\n\t/**\n\t * 打印\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 打印\n\t * @command print\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'print' );\n\t * ```\n\t */\n\tUE.commands['print'] = {\n\t\texecCommand: function() {\n\t\t\tthis.window.print();\n\t\t},\n\t\tnotNeedUndo: 1\n\t};\n\n\t// plugins/preview.js\n\t/**\n\t * 预览\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 预览\n\t * @command preview\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'preview' );\n\t * ```\n\t */\n\tUE.commands['preview'] = {\n\t\texecCommand: function() {\n\t\t\tvar w = window.open('', '_blank', ''),\n\t\t\t\td = w.document;\n\t\t\td.open();\n\t\t\td.write('<!DOCTYPE html><html><head><meta charset=\"utf-8\"/><script src=\"' + this.options.UEDITOR_HOME_URL + 'ueditor.parse.js\"></script><script>' +\n\t\t\t\t\"setTimeout(function(){uParse('div',{rootPath: '\" + this.options.UEDITOR_HOME_URL + \"'})},300)\" +\n\t\t\t\t'</script></head><body><div>' + this.getContent(null, null, true) + '</div></body></html>');\n\t\t\td.close();\n\t\t},\n\t\tnotNeedUndo: 1\n\t};\n\n\t// plugins/selectall.js\n\t/**\n\t * 全选\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 选中所有内容\n\t * @command selectall\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'selectall' );\n\t * ```\n\t */\n\tUE.plugins['selectall'] = function() {\n\t\tvar me = this;\n\t\tme.commands['selectall'] = {\n\t\t\texecCommand: function() {\n\t\t\t\t//去掉了原生的selectAll,因为会出现报错和当内容为空时，不能出现闭合状态的光标\n\t\t\t\tvar me = this,\n\t\t\t\t\tbody = me.body,\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\trange.selectNodeContents(body);\n\t\t\t\tif (domUtils.isEmptyBlock(body)) {\n\t\t\t\t\t//opera不能自动合并到元素的里边，要手动处理一下\n\t\t\t\t\tif (browser.opera && body.firstChild && body.firstChild.nodeType == 1) {\n\t\t\t\t\t\trange.setStartAtFirst(body.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\trange.collapse(true);\n\t\t\t\t}\n\t\t\t\trange.select(true);\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\n\t\t//快捷键\n\t\tme.addshortcutkey({\n\t\t\t\"selectAll\": \"ctrl+65\"\n\t\t});\n\t};\n\n\t// plugins/paragraph.js\n\t/**\n\t * 段落样式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 段落格式\n\t * @command paragraph\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param {String}   style               标签值为：'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'\n\t * @param {Object}   attrs               标签的属性\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'Paragraph','h1','{\n\t *     class:'test'\n\t * }' );\n\t * ```\n\t */\n\n\t/**\n\t * 返回选区内节点标签名\n\t * @command paragraph\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 节点标签名\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'Paragraph' );\n\t * ```\n\t */\n\n\tUE.plugins['paragraph'] = function() {\n\t\tvar me = this,\n\t\t\tblock = domUtils.isBlockElm,\n\t\t\tnotExchange = ['TD', 'LI', 'PRE'],\n\n\t\t\tdoParagraph = function(range, style, attrs, sourceCmdName) {\n\t\t\t\tvar bookmark = range.createBookmark(),\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\t\t\t\t\tpara;\n\n\t\t\t\trange.enlarge(true);\n\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\ttmpNode;\n\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\n\t\t\t\t\t\tpara = range.document.createElement(style);\n\t\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(para, attrs);\n\t\t\t\t\t\t\tif (sourceCmdName && sourceCmdName == 'customstyle' && attrs.style) {\n\t\t\t\t\t\t\t\tpara.style.cssText = attrs.style;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpara.appendChild(tmpRange.extractContents());\n\t\t\t\t\t\t//需要内容占位\n\t\t\t\t\t\tif (domUtils.isEmptyNode(para)) {\n\t\t\t\t\t\t\tdomUtils.fillChar(range.document, para);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttmpRange.insertNode(para);\n\n\t\t\t\t\t\tvar parent = para.parentNode;\n\t\t\t\t\t\t//如果para上一级是一个block元素且不是body,td就删除它\n\t\t\t\t\t\tif (block(parent) && !domUtils.isBody(para.parentNode) && utils.indexOf(notExchange, parent.tagName) == -1) {\n\t\t\t\t\t\t\t//存储dir,style\n\t\t\t\t\t\t\tif (!(sourceCmdName && sourceCmdName == 'customstyle')) {\n\t\t\t\t\t\t\t\tparent.getAttribute('dir') && para.setAttribute('dir', parent.getAttribute('dir'));\n\t\t\t\t\t\t\t\t//trace:1070\n\t\t\t\t\t\t\t\tparent.style.cssText && (para.style.cssText = parent.style.cssText + ';' + para.style.cssText);\n\t\t\t\t\t\t\t\t//trace:1030\n\t\t\t\t\t\t\t\tparent.style.textAlign && !para.style.textAlign && (para.style.textAlign = parent.style.textAlign);\n\t\t\t\t\t\t\t\tparent.style.textIndent && !para.style.textIndent && (para.style.textIndent = parent.style.textIndent);\n\t\t\t\t\t\t\t\tparent.style.padding && !para.style.padding && (para.style.padding = parent.style.padding);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//trace:1706 选择的就是h1-6要删除\n\t\t\t\t\t\t\tif (attrs && /h\\d/i.test(parent.tagName) && !/h\\d/i.test(para.tagName)) {\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(parent, attrs);\n\t\t\t\t\t\t\t\tif (sourceCmdName && sourceCmdName == 'customstyle' && attrs.style) {\n\t\t\t\t\t\t\t\t\tparent.style.cssText = attrs.style;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(para, true);\n\t\t\t\t\t\t\t\tpara = parent;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.remove(para.parentNode, true);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (utils.indexOf(notExchange, parent.tagName) != -1) {\n\t\t\t\t\t\t\tcurrent = parent;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = para;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t};\n\t\tme.setOpt('paragraph', {\n\t\t\t'p': '',\n\t\t\t'h1': '',\n\t\t\t'h2': '',\n\t\t\t'h3': '',\n\t\t\t'h4': '',\n\t\t\t'h5': '',\n\t\t\t'h6': ''\n\t\t});\n\t\tme.commands['paragraph'] = {\n\t\t\texecCommand: function(cmdName, style, attrs, sourceCmdName) {\n\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t//闭合时单独处理\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tvar txt = this.document.createTextNode('p');\n\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t\t//去掉冗余的fillchar\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\tvar node = txt.previousSibling;\n\t\t\t\t\t\tif (node && domUtils.isWhitespace(node)) {\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = txt.nextSibling;\n\t\t\t\t\t\tif (node && domUtils.isWhitespace(node)) {\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\trange = doParagraph(range, style, attrs, sourceCmdName);\n\t\t\t\tif (txt) {\n\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\tpN = txt.parentNode;\n\n\t\t\t\t\tdomUtils.remove(txt);\n\n\t\t\t\t\tif (domUtils.isBlockElm(pN) && domUtils.isEmptyNode(pN)) {\n\t\t\t\t\t\tdomUtils.fillNode(this.document, pN);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (browser.gecko && range.collapsed && range.startContainer.nodeType == 1) {\n\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset];\n\t\t\t\t\tif (child && child.nodeType == 1 && child.tagName.toLowerCase() == style) {\n\t\t\t\t\t\trange.setStart(child, 0).collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//trace:1097 原来有true，原因忘了，但去了就不能清除多余的占位符了\n\t\t\t\trange.select();\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar node = domUtils.filterNodeList(this.selection.getStartElementPath(), 'p h1 h2 h3 h4 h5 h6');\n\t\t\t\treturn node ? node.tagName.toLowerCase() : '';\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/directionality.js\n\t/**\n\t * 设置文字输入的方向的插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\t(function() {\n\t\tvar block = domUtils.isBlockElm,\n\t\t\tgetObj = function(editor) {\n\t\t\t\t//            var startNode = editor.selection.getStart(),\n\t\t\t\t//                parents;\n\t\t\t\t//            if ( startNode ) {\n\t\t\t\t//                //查找所有的是block的父亲节点\n\t\t\t\t//                parents = domUtils.findParents( startNode, true, block, true );\n\t\t\t\t//                for ( var i = 0,ci; ci = parents[i++]; ) {\n\t\t\t\t//                    if ( ci.getAttribute( 'dir' ) ) {\n\t\t\t\t//                        return ci;\n\t\t\t\t//                    }\n\t\t\t\t//                }\n\t\t\t\t//            }\n\t\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), function(n) {\n\t\t\t\t\treturn n && n.nodeType == 1 && n.getAttribute('dir')\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tdoDirectionality = function(range, editor, forward) {\n\n\t\t\t\tvar bookmark,\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\n\t\t\t\t\tobj = getObj(editor);\n\n\t\t\t\tif (obj && range.collapsed) {\n\t\t\t\t\tobj.setAttribute('dir', forward);\n\t\t\t\t\treturn range;\n\t\t\t\t}\n\t\t\t\tbookmark = range.createBookmark();\n\t\t\t\trange.enlarge(true);\n\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\ttmpNode;\n\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\t\t\t\t\tvar common = tmpRange.getCommonAncestor();\n\t\t\t\t\t\tif (!domUtils.isBody(common) && block(common)) {\n\t\t\t\t\t\t\t//遍历到了block节点\n\t\t\t\t\t\t\tcommon.setAttribute('dir', forward);\n\t\t\t\t\t\t\tcurrent = common;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//没有遍历到，添加一个block节点\n\t\t\t\t\t\t\tvar p = range.document.createElement('p');\n\t\t\t\t\t\t\tp.setAttribute('dir', forward);\n\t\t\t\t\t\t\tvar frag = tmpRange.extractContents();\n\t\t\t\t\t\t\tp.appendChild(frag);\n\t\t\t\t\t\t\ttmpRange.insertNode(p);\n\t\t\t\t\t\t\tcurrent = p;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t};\n\n\t\t/**\n\t\t * 文字输入方向\n\t\t * @command directionality\n\t\t * @method execCommand\n\t\t * @param { String } cmdName 命令字符串\n\t\t * @param { String } forward 传入'ltr'表示从左向右输入，传入'rtl'表示从右向左输入\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'directionality', 'ltr');\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查询当前选区的文字输入方向\n\t\t * @command directionality\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmdName 命令字符串\n\t\t * @return { String } 返回'ltr'表示从左向右输入，返回'rtl'表示从右向左输入\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'directionality');\n\t\t * ```\n\t\t */\n\t\tUE.commands['directionality'] = {\n\t\t\texecCommand: function(cmdName, forward) {\n\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t//闭合时单独处理\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tvar txt = this.document.createTextNode('d');\n\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t}\n\t\t\t\tdoDirectionality(range, this, forward);\n\t\t\t\tif (txt) {\n\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t}\n\n\t\t\t\trange.select();\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar node = getObj(this);\n\t\t\t\treturn node ? node.getAttribute('dir') : 'ltr';\n\t\t\t}\n\t\t};\n\t})();\n\n\t// plugins/horizontal.js\n\t/**\n\t * 插入分割线插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入分割线\n\t * @command horizontal\n\t * @method execCommand\n\t * @param { String } cmdName 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'horizontal' );\n\t * ```\n\t */\n\tUE.plugins['horizontal'] = function() {\n\t\tvar me = this;\n\t\tme.commands['horizontal'] = {\n\t\t\texecCommand: function(cmdName) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (me.queryCommandState(cmdName) !== -1) {\n\t\t\t\t\tme.execCommand('insertHtml', '<hr>');\n\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\tif (start.nodeType == 1 && !start.childNodes[range.startOffset]) {\n\n\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\tif (tmp = start.childNodes[range.startOffset - 1]) {\n\t\t\t\t\t\t\tif (tmp.nodeType == 1 && tmp.tagName == 'HR') {\n\t\t\t\t\t\t\t\tif (me.options.enterTag == 'p') {\n\t\t\t\t\t\t\t\t\ttmp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\t\trange.setStart(tmp, 0).setCursor();\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmp = me.document.createElement('br');\n\t\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\t\trange.setStartBefore(tmp).setCursor();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t//边界在table里不能加分隔线\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn domUtils.filterNodeList(this.selection.getStartElementPath(), 'table') ? -1 : 0;\n\t\t\t}\n\t\t};\n\t\t//    me.addListener('delkeyup',function(){\n\t\t//        var rng = this.selection.getRange();\n\t\t//        if(browser.ie && browser.version > 8){\n\t\t//            rng.txtToElmBoundary(true);\n\t\t//            if(domUtils.isStartInblock(rng)){\n\t\t//                var tmpNode = rng.startContainer;\n\t\t//                var pre = tmpNode.previousSibling;\n\t\t//                if(pre && domUtils.isTagNode(pre,'hr')){\n\t\t//                    domUtils.remove(pre);\n\t\t//                    rng.select();\n\t\t//                    return;\n\t\t//                }\n\t\t//            }\n\t\t//        }\n\t\t//        if(domUtils.isBody(rng.startContainer)){\n\t\t//            var hr = rng.startContainer.childNodes[rng.startOffset -1];\n\t\t//            if(hr && hr.nodeName == 'HR'){\n\t\t//                var next = hr.nextSibling;\n\t\t//                if(next){\n\t\t//                    rng.setStart(next,0)\n\t\t//                }else if(hr.previousSibling){\n\t\t//                    rng.setStartAtLast(hr.previousSibling)\n\t\t//                }else{\n\t\t//                    var p = this.document.createElement('p');\n\t\t//                    hr.parentNode.insertBefore(p,hr);\n\t\t//                    domUtils.fillNode(this.document,p);\n\t\t//                    rng.setStart(p,0);\n\t\t//                }\n\t\t//                domUtils.remove(hr);\n\t\t//                rng.setCursor(false,true);\n\t\t//            }\n\t\t//        }\n\t\t//    })\n\t\tme.addListener('delkeydown', function(name, evt) {\n\t\t\tvar rng = this.selection.getRange();\n\t\t\trng.txtToElmBoundary(true);\n\t\t\tif (domUtils.isStartInblock(rng)) {\n\t\t\t\tvar tmpNode = rng.startContainer;\n\t\t\t\tvar pre = tmpNode.previousSibling;\n\t\t\t\tif (pre && domUtils.isTagNode(pre, 'hr')) {\n\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\trng.select();\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t})\n\t};\n\n\t// plugins/time.js\n\t/**\n\t * 插入时间和日期\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入时间，默认格式：12:59:59\n\t * @command time\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'time');\n\t * ```\n\t */\n\n\t/**\n\t * 插入日期，默认格式：2013-08-30\n\t * @command date\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'date');\n\t * ```\n\t */\n\tUE.commands['time'] = UE.commands[\"date\"] = {\n\t\texecCommand: function(cmd, format) {\n\t\t\tvar date = new Date;\n\n\t\t\tfunction formatTime(date, format) {\n\t\t\t\tvar hh = ('0' + date.getHours()).slice(-2),\n\t\t\t\t\tii = ('0' + date.getMinutes()).slice(-2),\n\t\t\t\t\tss = ('0' + date.getSeconds()).slice(-2);\n\t\t\t\tformat = format || 'hh:ii:ss';\n\t\t\t\treturn format.replace(/hh/ig, hh).replace(/ii/ig, ii).replace(/ss/ig, ss);\n\t\t\t}\n\n\t\t\tfunction formatDate(date, format) {\n\t\t\t\tvar yyyy = ('000' + date.getFullYear()).slice(-4),\n\t\t\t\t\tyy = yyyy.slice(-2),\n\t\t\t\t\tmm = ('0' + (date.getMonth() + 1)).slice(-2),\n\t\t\t\t\tdd = ('0' + date.getDate()).slice(-2);\n\t\t\t\tformat = format || 'yyyy-mm-dd';\n\t\t\t\treturn format.replace(/yyyy/ig, yyyy).replace(/yy/ig, yy).replace(/mm/ig, mm).replace(/dd/ig, dd);\n\t\t\t}\n\n\t\t\tthis.execCommand('insertHtml', cmd == \"time\" ? formatTime(date, format) : formatDate(date, format));\n\t\t}\n\t};\n\n\t// plugins/rowspacing.js\n\t/**\n\t * 段前段后间距插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 设置段间距\n\t * @command rowspacing\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 段间距的值，以px为单位\n\t * @param { String } dir 间距位置，top或bottom，分别表示段前和段后\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'rowspacing', '10', 'top' );\n\t * ```\n\t */\n\n\tUE.plugins['rowspacing'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'rowspacingtop': ['5', '10', '15', '20', '25'],\n\t\t\t'rowspacingbottom': ['5', '10', '15', '20', '25']\n\n\t\t});\n\t\tme.commands['rowspacing'] = {\n\t\t\texecCommand: function(cmdName, value, dir) {\n\t\t\t\tthis.execCommand('paragraph', 'p', {\n\t\t\t\t\tstyle: 'margin-' + dir + ':' + value + 'px'\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function(cmdName, dir) {\n\t\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t}),\n\t\t\t\t\tvalue;\n\t\t\t\t//trace:1026\n\t\t\t\tif (pN) {\n\t\t\t\t\tvalue = domUtils.getComputedStyle(pN, 'margin-' + dir).replace(/[^\\d]/g, '');\n\t\t\t\t\treturn !value ? 0 : value;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/lineheight.js\n\t/**\n\t * 设置行内间距\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugins['lineheight'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'lineheight': ['1', '1.5', '1.75', '2', '3', '4', '5']\n\t\t});\n\n\t\t/**\n\t\t * 行距\n\t\t * @command lineheight\n\t\t * @method execCommand\n\t\t * @param { String } cmdName 命令字符串\n\t\t * @param { String } value 传入的行高值， 该值是当前字体的倍数， 例如： 1.5, 1.75\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'lineheight', 1.5);\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容的行高大小\n\t\t * @command lineheight\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回当前行高大小\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'lineheight' );\n\t\t * ```\n\t\t */\n\n\t\tme.commands['lineheight'] = {\n\t\t\texecCommand: function(cmdName, value) {\n\t\t\t\tthis.execCommand('paragraph', 'p', {\n\t\t\t\t\tstyle: 'line-height:' + (value == \"1\" ? \"normal\" : value + 'em')\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), function(node) {\n\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t});\n\t\t\t\tif (pN) {\n\t\t\t\t\tvar value = domUtils.getComputedStyle(pN, 'line-height');\n\t\t\t\t\treturn value == 'normal' ? 1 : value.replace(/[^\\d.]*/ig, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/insertcode.js\n\t/**\n\t * 插入代码插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['insertcode'] = function() {\n\t\tvar me = this;\n\t\tme.ready(function() {\n\t\t\tutils.cssRule('pre', 'pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}',\n\t\t\t\tme.document)\n\t\t});\n\t\tme.setOpt('insertcode', {\n\t\t\t'as3': 'ActionScript3',\n\t\t\t'bash': 'Bash/Shell',\n\t\t\t'cpp': 'C/C++',\n\t\t\t'css': 'Css',\n\t\t\t'cf': 'CodeFunction',\n\t\t\t'c#': 'C#',\n\t\t\t'delphi': 'Delphi',\n\t\t\t'diff': 'Diff',\n\t\t\t'erlang': 'Erlang',\n\t\t\t'groovy': 'Groovy',\n\t\t\t'html': 'Html',\n\t\t\t'java': 'Java',\n\t\t\t'jfx': 'JavaFx',\n\t\t\t'js': 'Javascript',\n\t\t\t'pl': 'Perl',\n\t\t\t'php': 'Php',\n\t\t\t'plain': 'Plain Text',\n\t\t\t'ps': 'PowerShell',\n\t\t\t'python': 'Python',\n\t\t\t'ruby': 'Ruby',\n\t\t\t'scala': 'Scala',\n\t\t\t'sql': 'Sql',\n\t\t\t'vb': 'Vb',\n\t\t\t'xml': 'Xml'\n\t\t});\n\n\t\t/**\n\t\t * 插入代码\n\t\t * @command insertcode\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } lang 插入代码的语言\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertcode', 'javascript' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 如果选区所在位置是插入插入代码区域，返回代码的语言\n\t\t * @command insertcode\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回代码的语言\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'insertcode' );\n\t\t * ```\n\t\t */\n\n\t\tme.commands['insertcode'] = {\n\t\t\texecCommand: function(cmd, lang) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\tpre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\t\tif (pre) {\n\t\t\t\t\tpre.className = 'brush:' + lang + ';toolbar:false;';\n\t\t\t\t} else {\n\t\t\t\t\tvar code = '';\n\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\tcode = browser.ie && browser.ie11below ? (browser.version <= 8 ? '&nbsp;' : '') : '<br/>';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar frag = rng.extractContents();\n\t\t\t\t\t\tvar div = me.document.createElement('div');\n\t\t\t\t\t\tdiv.appendChild(frag);\n\n\t\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(div.innerHTML.replace(/[\\r\\t]/g, '')), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\t\tif (browser.ie && browser.ie11below && browser.version > 8) {\n\n\t\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.data\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\tif (!/\\n$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\tcode += '\\n';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcode += node.data + '\\n'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!node.nextSibling() && /\\n$/.test(code)) {\n\t\t\t\t\t\t\t\t\tcode = code.replace(/\\n$/, '');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (browser.ie && browser.ie11below) {\n\n\t\t\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.data\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tif (!/br>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\t\tcode += '<br>';\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcode += node.data + '<br>'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!node.nextSibling() && /<br>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\tcode = code.replace(/<br>$/, '');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcode += (node.type == 'element' ? (dtd.$empty[node.tagName] ? '' : node.innerText()) : node.data);\n\t\t\t\t\t\t\t\t\tif (!/br\\/?\\s*>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\tif (!node.nextSibling())\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tme.execCommand('inserthtml', '<pre id=\"coder\"class=\"brush:' + lang + ';toolbar:false\">' + code + '</pre>', true);\n\n\t\t\t\t\tpre = me.document.getElementById('coder');\n\t\t\t\t\tdomUtils.removeAttributes(pre, 'id');\n\t\t\t\t\tvar tmpNode = pre.previousSibling;\n\n\t\t\t\t\tif (tmpNode && (tmpNode.nodeType == 3 && tmpNode.nodeValue.length == 1 && browser.ie && browser.version == 6 || domUtils.isEmptyBlock(tmpNode))) {\n\n\t\t\t\t\t\tdomUtils.remove(tmpNode)\n\t\t\t\t\t}\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tif (domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\trng.setStart(pre, 0).setCursor(false, true)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.selectNodeContents(pre).select()\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar path = this.selection.getStartElementPath();\n\t\t\t\tvar lang = '';\n\t\t\t\tutils.each(path, function(node) {\n\t\t\t\t\tif (node.nodeName == 'PRE') {\n\t\t\t\t\t\tvar match = node.className.match(/brush:([^;]+)/);\n\t\t\t\t\t\tlang = match && match[1] ? match[1] : '';\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn lang;\n\t\t\t}\n\t\t};\n\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('pre'), function(pre) {\n\t\t\t\tvar brs = pre.getNodesByTagName('br');\n\t\t\t\tif (brs.length) {\n\t\t\t\t\tbrowser.ie && browser.ie11below && browser.version > 8 && utils.each(brs, function(br) {\n\t\t\t\t\t\tvar txt = UE.uNode.createText('\\n');\n\t\t\t\t\t\tbr.parentNode.insertBefore(txt, br);\n\t\t\t\t\t\tbr.parentNode.removeChild(br);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (browser.ie && browser.ie11below && browser.version > 8)\n\t\t\t\t\treturn;\n\t\t\t\tvar code = pre.innerText().split(/\\n/);\n\t\t\t\tpre.innerHTML('');\n\t\t\t\tutils.each(code, function(c) {\n\t\t\t\t\tif (c.length) {\n\t\t\t\t\t\tpre.appendChild(UE.uNode.createText(c));\n\t\t\t\t\t}\n\t\t\t\t\tpre.appendChild(UE.uNode.createElement('br'))\n\t\t\t\t})\n\t\t\t})\n\t\t});\n\t\tme.addOutputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('pre'), function(pre) {\n\t\t\t\tvar code = '';\n\t\t\t\tutils.each(pre.children, function(n) {\n\t\t\t\t\tif (n.type == 'text') {\n\t\t\t\t\t\t//在ie下文本内容有可能末尾带有\\n要去掉\n\t\t\t\t\t\t//trace:3396\n\t\t\t\t\t\tcode += n.data.replace(/[ ]/g, '&nbsp;').replace(/\\n$/, '');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (n.tagName == 'br') {\n\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcode += (!dtd.$empty[n.tagName] ? '' : n.innerText());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\tpre.innerText(code.replace(/(&nbsp;|\\n)+$/, ''))\n\t\t\t})\n\t\t});\n\t\t//不需要判断highlight的command列表\n\t\tme.notNeedCodeQuery = {\n\t\t\thelp: 1,\n\t\t\tundo: 1,\n\t\t\tredo: 1,\n\t\t\tsource: 1,\n\t\t\tprint: 1,\n\t\t\tsearchreplace: 1,\n\t\t\tfullscreen: 1,\n\t\t\tpreview: 1,\n\t\t\tinsertparagraph: 1,\n\t\t\telementpath: 1,\n\t\t\tinsertcode: 1,\n\t\t\tinserthtml: 1,\n\t\t\tselectall: 1\n\t\t};\n\t\t//将queyCommamndState重置\n\t\tvar orgQuery = me.queryCommandState;\n\t\tme.queryCommandState = function(cmd) {\n\t\t\tvar me = this;\n\n\t\t\tif (!me.notNeedCodeQuery[cmd.toLowerCase()] && me.selection && me.queryCommandValue('insertcode')) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn UE.Editor.prototype.queryCommandState.apply(this, arguments)\n\t\t};\n\t\tme.addListener('beforeenterkeydown', function() {\n\t\t\tvar rng = me.selection.getRange();\n\t\t\tvar pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\tif (pre) {\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\trng.deleteContents();\n\t\t\t\t}\n\t\t\t\tif (!browser.ie || browser.ie9above) {\n\t\t\t\t\tvar tmpNode = me.document.createElement('br'),\n\t\t\t\t\t\tpre;\n\t\t\t\t\trng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true);\n\t\t\t\t\tvar next = tmpNode.nextSibling;\n\t\t\t\t\tif (!next && (!browser.ie || browser.version > 10)) {\n\t\t\t\t\t\trng.insertNode(tmpNode.cloneNode(false));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.setStartAfter(tmpNode);\n\t\t\t\t\t}\n\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\tvar tmp;\n\t\t\t\t\twhile (pre) {\n\t\t\t\t\t\ttmp = pre;\n\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t\tif (!pre || pre.nodeName == 'BR') {\n\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tvar str = '';\n\t\t\t\t\t\twhile (pre && pre.nodeName != 'BR' && new RegExp('^[\\\\s' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\tstr += pre.nodeValue;\n\t\t\t\t\t\t\tpre = pre.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pre.nodeName != 'BR') {\n\t\t\t\t\t\t\tvar match = pre.nodeValue.match(new RegExp('^([\\\\s' + domUtils.fillChar + ']+)'));\n\t\t\t\t\t\t\tif (match && match[1]) {\n\t\t\t\t\t\t\t\tstr += match[1]\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (str) {\n\t\t\t\t\t\t\tstr = me.document.createTextNode(str);\n\t\t\t\t\t\t\trng.insertNode(str).setStartAfter(str);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trng.collapse(true).select(true);\n\t\t\t\t} else {\n\t\t\t\t\tif (browser.version > 8) {\n\n\t\t\t\t\t\tvar txt = me.document.createTextNode('\\n');\n\t\t\t\t\t\tvar start = rng.startContainer;\n\t\t\t\t\t\tif (rng.startOffset == 0) {\n\t\t\t\t\t\t\tvar preNode = start.previousSibling;\n\t\t\t\t\t\t\tif (preNode) {\n\t\t\t\t\t\t\t\trng.insertNode(txt);\n\t\t\t\t\t\t\t\tvar fillchar = me.document.createTextNode(' ');\n\t\t\t\t\t\t\t\trng.setStartAfter(txt).insertNode(fillchar).setStart(fillchar, 0).collapse(true).select(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.insertNode(txt).setStartAfter(txt);\n\t\t\t\t\t\t\tvar fillchar = me.document.createTextNode(' ');\n\t\t\t\t\t\t\tstart = rng.startContainer.childNodes[rng.startOffset];\n\t\t\t\t\t\t\tif (start && !/^\\n/.test(start.nodeValue)) {\n\t\t\t\t\t\t\t\trng.setStartBefore(txt)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.insertNode(fillchar).setStart(fillchar, 0).collapse(true).select(true)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar tmpNode = me.document.createElement('br');\n\t\t\t\t\t\trng.insertNode(tmpNode);\n\t\t\t\t\t\trng.insertNode(me.document.createTextNode(domUtils.fillChar));\n\t\t\t\t\t\trng.setStartAfter(tmpNode);\n\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\twhile (pre) {\n\t\t\t\t\t\t\ttmp = pre;\n\t\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t\t\tif (!pre || pre.nodeName == 'BR') {\n\t\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pre) {\n\t\t\t\t\t\t\tvar str = '';\n\t\t\t\t\t\t\twhile (pre && pre.nodeName != 'BR' && new RegExp('^[ ' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\t\tstr += pre.nodeValue;\n\t\t\t\t\t\t\t\tpre = pre.nextSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (pre.nodeName != 'BR') {\n\t\t\t\t\t\t\t\tvar match = pre.nodeValue.match(new RegExp('^([ ' + domUtils.fillChar + ']+)'));\n\t\t\t\t\t\t\t\tif (match && match[1]) {\n\t\t\t\t\t\t\t\t\tstr += match[1]\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tstr = me.document.createTextNode(str);\n\t\t\t\t\t\t\trng.insertNode(str).setStartAfter(str);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.collapse(true).select();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\n\t\tme.addListener('tabkeydown', function(cmd, evt) {\n\t\t\tvar rng = me.selection.getRange();\n\t\t\tvar pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\tif (pre) {\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\tif (evt.shiftKey) {\n\n\t\t\t\t} else {\n\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\tvar bk = rng.createBookmark();\n\t\t\t\t\t\tvar start = bk.start.previousSibling;\n\n\t\t\t\t\t\twhile (start) {\n\t\t\t\t\t\t\tif (pre.firstChild === start && !domUtils.isBr(start)) {\n\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start);\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.isBr(start)) {\n\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling);\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstart = start.previousSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar end = bk.end;\n\t\t\t\t\t\tstart = bk.start.nextSibling;\n\t\t\t\t\t\tif (pre.firstChild === bk.start) {\n\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling)\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (start && start !== end) {\n\t\t\t\t\t\t\tif (domUtils.isBr(start) && start.nextSibling) {\n\t\t\t\t\t\t\t\tif (start.nextSibling === end) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tstart = start.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar tmpNode = me.document.createTextNode('    ');\n\t\t\t\t\t\trng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true).select(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\n\t\tme.addListener('beforeinserthtml', function(evtName, html) {\n\t\t\tvar me = this,\n\t\t\t\trng = me.selection.getRange(),\n\t\t\t\tpre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\tif (pre) {\n\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\trng.deleteContents()\n\t\t\t\t}\n\t\t\t\tvar htmlstr = '';\n\t\t\t\tif (browser.ie && browser.version > 8) {\n\n\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(html), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\thtmlstr += '\\n'\n\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\thtmlstr += '\\n'\n\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\thtmlstr += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thtmlstr += cn.data\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tif (!/\\n$/.test(htmlstr)) {\n\t\t\t\t\t\t\t\t\thtmlstr += '\\n';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thtmlstr += node.data + '\\n'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!node.nextSibling() && /\\n$/.test(htmlstr)) {\n\t\t\t\t\t\t\thtmlstr = htmlstr.replace(/\\n$/, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tvar tmpNode = me.document.createTextNode(utils.html(htmlstr.replace(/&nbsp;/g, ' ')));\n\t\t\t\t\trng.insertNode(tmpNode).selectNode(tmpNode).select();\n\t\t\t\t} else {\n\t\t\t\t\tvar frag = me.document.createDocumentFragment();\n\n\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(html), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(cn.innerText().replace(/&nbsp;/g, ' '))));\n\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(cn.data.replace(/&nbsp;/g, ' '))));\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tif (frag.lastChild.nodeName != 'BR') {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(node.data.replace(/&nbsp;/g, ' '))));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!node.nextSibling() && frag.lastChild.nodeName == 'BR') {\n\t\t\t\t\t\t\tfrag.removeChild(frag.lastChild)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t\trng.insertNode(frag).select();\n\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\t//方向键的处理\n\t\tme.addListener('keydown', function(cmd, evt) {\n\t\t\tvar me = this,\n\t\t\t\tkeyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 40) {\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tpre, start = rng.startContainer;\n\t\t\t\tif (rng.collapsed && (pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true)) && !pre.nextSibling) {\n\t\t\t\t\tvar last = pre.lastChild\n\t\t\t\t\twhile (last && last.nodeName == 'BR') {\n\t\t\t\t\t\tlast = last.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t\tif (last === start || rng.startContainer === pre && rng.startOffset == pre.childNodes.length) {\n\t\t\t\t\t\tme.execCommand('insertparagraph');\n\t\t\t\t\t\tdomUtils.preventDefault(evt)\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t//trace:3395\n\t\tme.addListener('delkeydown', function(type, evt) {\n\t\t\tvar rng = this.selection.getRange();\n\t\t\trng.txtToElmBoundary(true);\n\t\t\tvar start = rng.startContainer;\n\t\t\tif (domUtils.isTagNode(start, 'pre') && rng.collapsed && domUtils.isStartInblock(rng)) {\n\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\tstart.parentNode.insertBefore(p, start);\n\t\t\t\tdomUtils.remove(start);\n\t\t\t\trng.setStart(p, 0).setCursor(false, true);\n\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t})\n\t};\n\n\t// plugins/cleardoc.js\n\t/**\n\t * 清空文档插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 清空文档\n\t * @command cleardoc\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * //editor 是编辑器实例\n\t * editor.execCommand('cleardoc');\n\t * ```\n\t */\n\n\tUE.commands['cleardoc'] = {\n\t\texecCommand: function(cmdName) {\n\t\t\tvar me = this,\n\t\t\t\tenterTag = me.options.enterTag,\n\t\t\t\trange = me.selection.getRange();\n\t\t\tif (enterTag == \"br\") {\n\t\t\t\tme.body.innerHTML = \"<br/>\";\n\t\t\t\trange.setStart(me.body, 0).setCursor();\n\t\t\t} else {\n\t\t\t\tme.body.innerHTML = \"<p>\" + (ie ? \"\" : \"<br/>\") + \"</p>\";\n\t\t\t\trange.setStart(me.body.firstChild, 0).setCursor(false, true);\n\t\t\t}\n\t\t\tsetTimeout(function() {\n\t\t\t\tme.fireEvent(\"clearDoc\");\n\t\t\t}, 0);\n\n\t\t}\n\t};\n\n\t// plugins/anchor.js\n\t/**\n\t * 锚点插件，为UEditor提供插入锚点支持\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugin.register('anchor', function() {\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\t\t\t\t\tutils.cssRule('anchor',\n\t\t\t\t\t\t'.anchorclass{background: url(\\'' + this.options.themePath + this.options.theme + '/images/anchor.gif\\') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}',\n\t\t\t\t\t\tthis.document);\n\t\t\t\t}\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(a) {\n\t\t\t\t\tvar val;\n\t\t\t\t\tif (val = a.getAttr('anchorname')) {\n\t\t\t\t\t\ta.tagName = 'a';\n\t\t\t\t\t\ta.setAttr({\n\t\t\t\t\t\t\tanchorname: '',\n\t\t\t\t\t\t\tname: val,\n\t\t\t\t\t\t\t'class': ''\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('a'), function(a) {\n\t\t\t\t\tvar val;\n\t\t\t\t\tif ((val = a.getAttr('name')) && !a.getAttr('href')) {\n\t\t\t\t\t\ta.tagName = 'img';\n\t\t\t\t\t\ta.setAttr({\n\t\t\t\t\t\t\tanchorname: a.getAttr('name'),\n\t\t\t\t\t\t\t'class': 'anchorclass'\n\t\t\t\t\t\t});\n\t\t\t\t\t\ta.setAttr('name')\n\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 插入锚点\n\t\t\t\t * @command anchor\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { String } name 锚点名称字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //editor 是编辑器实例\n\t\t\t\t * editor.execCommand('anchor', 'anchor1');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'anchor': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\t\timg = range.getClosedNode();\n\t\t\t\t\t\tif (img && img.getAttribute('anchorname')) {\n\t\t\t\t\t\t\tif (name) {\n\t\t\t\t\t\t\t\timg.setAttribute('anchorname', name);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.setStartBefore(img).setCursor();\n\t\t\t\t\t\t\t\tdomUtils.remove(img);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (name) {\n\t\t\t\t\t\t\t\t//只在选区的开始插入\n\t\t\t\t\t\t\t\tvar anchor = this.document.createElement('img');\n\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(anchor, {\n\t\t\t\t\t\t\t\t\t'anchorname': name,\n\t\t\t\t\t\t\t\t\t'class': 'anchorclass'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\trange.insertNode(anchor).setStartAfter(anchor).setCursor(false, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/wordcount.js\n\t///import core\n\t///commands 字数统计\n\t///commandsName  WordCount,wordCount\n\t///commandsTitle  字数统计\n\t/*\n\t * Created by JetBrains WebStorm.\n\t * User: taoqili\n\t * Date: 11-9-7\n\t * Time: 下午8:18\n\t * To change this template use File | Settings | File Templates.\n\t */\n\n\tUE.plugins['wordcount'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt('wordCount', true);\n\t\tme.addListener('contentchange', function() {\n\t\t\tme.fireEvent('wordcount');\n\t\t});\n\t\tvar timer;\n\t\tme.addListener('ready', function() {\n\t\t\tvar me = this;\n\t\t\tdomUtils.on(me.body, \"keyup\", function(evt) {\n\t\t\t\tvar code = evt.keyCode || evt.which,\n\t\t\t\t\t//忽略的按键,ctr,alt,shift,方向键\n\t\t\t\t\tignores = {\n\t\t\t\t\t\t\"16\": 1,\n\t\t\t\t\t\t\"18\": 1,\n\t\t\t\t\t\t\"20\": 1,\n\t\t\t\t\t\t\"37\": 1,\n\t\t\t\t\t\t\"38\": 1,\n\t\t\t\t\t\t\"39\": 1,\n\t\t\t\t\t\t\"40\": 1\n\t\t\t\t\t};\n\t\t\t\tif (code in ignores) return;\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\tme.fireEvent('wordcount');\n\t\t\t\t}, 200)\n\t\t\t})\n\t\t});\n\t};\n\n\t// plugins/pagebreak.js\n\t/**\n\t * 分页功能插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugins['pagebreak'] = function() {\n\t\tvar me = this,\n\t\t\tnotBreakTags = ['td'];\n\t\tme.setOpt('pageBreakTag', '_ueditor_page_break_tag_');\n\n\t\tfunction fillNode(node) {\n\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\tvar firstChild = node.firstChild,\n\t\t\t\t\ttmpNode;\n\n\t\t\t\twhile (firstChild && firstChild.nodeType == 1 && domUtils.isEmptyBlock(firstChild)) {\n\t\t\t\t\ttmpNode = firstChild;\n\t\t\t\t\tfirstChild = firstChild.firstChild;\n\t\t\t\t}!tmpNode && (tmpNode = node);\n\t\t\t\tdomUtils.fillNode(me.document, tmpNode);\n\t\t\t}\n\t\t}\n\t\t//分页符样式添加\n\n\t\tme.ready(function() {\n\t\t\tutils.cssRule('pagebreak', '.pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}', me.document);\n\t\t});\n\n\t\tfunction isHr(node) {\n\t\t\treturn node && node.nodeType == 1 && node.tagName == 'HR' && node.className == 'pagebreak';\n\t\t}\n\t\tme.addInputRule(function(root) {\n\t\t\troot.traversal(function(node) {\n\t\t\t\tif (node.type == 'text' && node.data == me.options.pageBreakTag) {\n\t\t\t\t\tvar hr = UE.uNode.createElement('<hr class=\"pagebreak\" noshade=\"noshade\" size=\"5\" style=\"-webkit-user-select: none;\">');\n\t\t\t\t\tnode.parentNode.insertBefore(hr, node);\n\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t\tme.addOutputRule(function(node) {\n\t\t\tutils.each(node.getNodesByTagName('hr'), function(n) {\n\t\t\t\tif (n.getAttr('class') == 'pagebreak') {\n\t\t\t\t\tvar txt = UE.uNode.createText(me.options.pageBreakTag);\n\t\t\t\t\tn.parentNode.insertBefore(txt, n);\n\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t}\n\t\t\t})\n\n\t\t});\n\n\t\t/**\n\t\t * 插入分页符\n\t\t * @command pagebreak\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @remind 在表格中插入分页符会把表格切分成两部分\n\t\t * @remind 获取编辑器内的数据时， 编辑器会把分页符转换成“_ueditor_page_break_tag_”字符串，\n\t\t *          以便于提交数据到服务器端后处理分页。\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'pagebreak'); //插入一个hr标签，带有样式类名pagebreak\n\t\t * ```\n\t\t */\n\n\t\tme.commands['pagebreak'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\thr = me.document.createElement('hr');\n\t\t\t\tdomUtils.setAttributes(hr, {\n\t\t\t\t\t'class': 'pagebreak',\n\t\t\t\t\tnoshade: \"noshade\",\n\t\t\t\t\tsize: \"5\"\n\t\t\t\t});\n\t\t\t\tdomUtils.unSelectable(hr);\n\t\t\t\t//table单独处理\n\t\t\t\tvar node = domUtils.findParentByTagName(range.startContainer, notBreakTags, true),\n\n\t\t\t\t\tparents = [],\n\t\t\t\t\tpN;\n\t\t\t\tif (node) {\n\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\tcase 'TD':\n\t\t\t\t\t\t\tpN = node.parentNode;\n\t\t\t\t\t\t\tif (!pN.previousSibling) {\n\t\t\t\t\t\t\t\tvar table = domUtils.findParentByTagName(pN, 'table');\n\t\t\t\t\t\t\t\t//                            var tableWrapDiv = table.parentNode;\n\t\t\t\t\t\t\t\t//                            if(tableWrapDiv && tableWrapDiv.nodeType == 1\n\t\t\t\t\t\t\t\t//                                && tableWrapDiv.tagName == 'DIV'\n\t\t\t\t\t\t\t\t//                                && tableWrapDiv.getAttribute('dropdrag')\n\t\t\t\t\t\t\t\t//                                ){\n\t\t\t\t\t\t\t\t//                                domUtils.remove(tableWrapDiv,true);\n\t\t\t\t\t\t\t\t//                            }\n\t\t\t\t\t\t\t\ttable.parentNode.insertBefore(hr, table);\n\t\t\t\t\t\t\t\tparents = domUtils.findParents(hr, true);\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpN.parentNode.insertBefore(hr, pN);\n\t\t\t\t\t\t\t\tparents = domUtils.findParents(hr);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpN = parents[1];\n\t\t\t\t\t\t\tif (hr !== pN) {\n\t\t\t\t\t\t\t\tdomUtils.breakParent(hr, pN);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//table要重写绑定一下拖拽\n\t\t\t\t\t\t\tme.fireEvent('afteradjusttable', me.document);\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\twhile (!domUtils.isBody(start) && domUtils.isBlockElm(start) && domUtils.isEmptyNode(start)) {\n\t\t\t\t\t\t\trange.setStartBefore(start).collapse(true);\n\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\trange.insertNode(hr);\n\n\t\t\t\t\tvar pN = hr.parentNode,\n\t\t\t\t\t\tnextNode;\n\t\t\t\t\twhile (!domUtils.isBody(pN)) {\n\t\t\t\t\t\tdomUtils.breakParent(hr, pN);\n\t\t\t\t\t\tnextNode = hr.nextSibling;\n\t\t\t\t\t\tif (nextNode && domUtils.isEmptyBlock(nextNode)) {\n\t\t\t\t\t\t\tdomUtils.remove(nextNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpN = hr.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tnextNode = hr.nextSibling;\n\t\t\t\t\tvar pre = hr.previousSibling;\n\t\t\t\t\tif (isHr(pre)) {\n\t\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpre && fillNode(pre);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!nextNode) {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\n\t\t\t\t\t\thr.parentNode.appendChild(p);\n\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\trange.setStart(p, 0).collapse(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (isHr(nextNode)) {\n\t\t\t\t\t\t\tdomUtils.remove(nextNode);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfillNode(nextNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setEndAfter(hr).collapse(false);\n\t\t\t\t\t}\n\n\t\t\t\t\trange.select(true);\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/wordimage.js\n\t///import core\n\t///commands 本地图片引导上传\n\t///commandsName  WordImage\n\t///commandsTitle  本地图片引导上传\n\t///commandsDialog  dialogs\\wordimage\n\n\tUE.plugin.register('wordimage', function() {\n\t\tvar me = this,\n\t\t\timages = [];\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t'wordimage': {\n\t\t\t\t\texecCommand: function() {\n\t\t\t\t\t\tvar images = domUtils.getElementsByTagName(me.body, \"img\");\n\t\t\t\t\t\tvar urlList = [];\n\t\t\t\t\t\tfor (var i = 0, ci; ci = images[i++];) {\n\t\t\t\t\t\t\tvar url = ci.getAttribute(\"word_img\");\n\t\t\t\t\t\t\turl && urlList.push(url);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn urlList;\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\timages = domUtils.getElementsByTagName(me.body, \"img\");\n\t\t\t\t\t\tfor (var i = 0, ci; ci = images[i++];) {\n\t\t\t\t\t\t\tif (ci.getAttribute(\"word_img\")) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t}\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(img) {\n\t\t\t\t\tvar attrs = img.attrs,\n\t\t\t\t\t\tflag = parseInt(attrs.width) < 128 || parseInt(attrs.height) < 43,\n\t\t\t\t\t\topt = me.options;\n\t\t\t\t\t\t//src = opt.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif';\n\t\t\t\t\t\tvar src = $GLOBAL_CONFIG['pcimgpath'] + '/images/editor/spacer.jpg';\n\t\t\t\t\tif (attrs['src'] && /^(?:(file:\\/+))/.test(attrs['src'])) {\n\t\t\t\t\t\timg.setAttr({\n\t\t\t\t\t\t\twidth: attrs.width,\n\t\t\t\t\t\t\theight: attrs.height,\n\t\t\t\t\t\t\talt: attrs.alt,\n\t\t\t\t\t\t\tword_img: attrs.src,\n\t\t\t\t\t\t\tsrc: src,\n\t\t\t\t\t\t\t'style': 'background:url(' + (flag ? opt.themePath + opt.theme + '/images/word.gif' : opt.langPath + opt.lang + '/images/localimage.png') + ') no-repeat center center;border:1px solid #ddd'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/dragdrop.js\n\tUE.plugins['dragdrop'] = function() {\n\n\t\tvar me = this;\n\t\tme.ready(function() {\n\t\t\tdomUtils.on(this.body, 'dragend', function() {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar node = rng.getClosedNode() || me.selection.getStart();\n\n\t\t\t\tif (node && node.tagName == 'IMG') {\n\n\t\t\t\t\tvar pre = node.previousSibling,\n\t\t\t\t\t\tnext;\n\t\t\t\t\twhile (next = node.nextSibling) {\n\t\t\t\t\t\tif (next.nodeType == 1 && next.tagName == 'SPAN' && !next.firstChild) {\n\t\t\t\t\t\t\tdomUtils.remove(next)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((pre && pre.nodeType == 1 && !domUtils.isEmptyBlock(pre) || !pre) && (!next || next && !domUtils.isEmptyBlock(next))) {\n\t\t\t\t\t\tif (pre && pre.tagName == 'P' && !domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\tpre.appendChild(node);\n\t\t\t\t\t\t\tdomUtils.moveChild(next, pre);\n\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t} else if (next && next.tagName == 'P' && !domUtils.isEmptyBlock(next)) {\n\t\t\t\t\t\t\tnext.insertBefore(node, next.firstChild);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (pre && pre.tagName == 'P' && domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\tdomUtils.remove(pre)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (next && next.tagName == 'P' && domUtils.isEmptyBlock(next)) {\n\t\t\t\t\t\t\tdomUtils.remove(next)\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.selectNode(node).select();\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t})\n\t\t});\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13) {\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tnode;\n\t\t\t\tif (node = domUtils.findParentByTagName(rng.startContainer, 'p', true)) {\n\t\t\t\t\tif (domUtils.getComputedStyle(node, 'text-align') == 'center') {\n\t\t\t\t\t\tdomUtils.removeStyle(node, 'text-align')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t};\n\n\t// plugins/undo.js\n\t/**\n\t * undo redo\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 撤销上一次执行的命令\n\t * @command undo\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'undo' );\n\t * ```\n\t */\n\n\t/**\n\t * 重做上一次执行的命令\n\t * @command redo\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'redo' );\n\t * ```\n\t */\n\n\tUE.plugins['undo'] = function() {\n\t\tvar saveSceneTimer;\n\t\tvar me = this,\n\t\t\tmaxUndoCount = me.options.maxUndoCount || 20,\n\t\t\tmaxInputCount = me.options.maxInputCount || 20,\n\t\t\tfillchar = new RegExp(domUtils.fillChar + '|<\\/hr>', 'gi'); // ie会产生多余的</hr>\n\t\tvar noNeedFillCharTags = {\n\t\t\tol: 1,\n\t\t\tul: 1,\n\t\t\ttable: 1,\n\t\t\ttbody: 1,\n\t\t\ttr: 1,\n\t\t\tbody: 1\n\t\t};\n\t\tvar orgState = me.options.autoClearEmptyNode;\n\n\t\tfunction compareAddr(indexA, indexB) {\n\t\t\tif (indexA.length != indexB.length)\n\t\t\t\treturn 0;\n\t\t\tfor (var i = 0, l = indexA.length; i < l; i++) {\n\t\t\t\tif (indexA[i] != indexB[i])\n\t\t\t\t\treturn 0\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction compareRangeAddress(rngAddrA, rngAddrB) {\n\t\t\tif (rngAddrA.collapsed != rngAddrB.collapsed) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (!compareAddr(rngAddrA.startAddress, rngAddrB.startAddress) || !compareAddr(rngAddrA.endAddress, rngAddrB.endAddress)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction UndoManager() {\n\t\t\tthis.list = [];\n\t\t\tthis.index = 0;\n\t\t\tthis.hasUndo = false;\n\t\t\tthis.hasRedo = false;\n\t\t\tthis.undo = function() {\n\t\t\t\tif (this.hasUndo) {\n\t\t\t\t\tif (!this.list[this.index - 1] && this.list.length == 1) {\n\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twhile (this.list[this.index].content == this.list[this.index - 1].content) {\n\t\t\t\t\t\tthis.index--;\n\t\t\t\t\t\tif (this.index == 0) {\n\t\t\t\t\t\t\treturn this.restore(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.restore(--this.index);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.redo = function() {\n\t\t\t\tif (this.hasRedo) {\n\t\t\t\t\twhile (this.list[this.index].content == this.list[this.index + 1].content) {\n\t\t\t\t\t\tthis.index++;\n\t\t\t\t\t\tif (this.index == this.list.length - 1) {\n\t\t\t\t\t\t\treturn this.restore(this.index);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.restore(++this.index);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.restore = function() {\n\t\t\t\tvar me = this.editor;\n\t\t\t\tvar scene = this.list[this.index];\n\t\t\t\tvar root = UE.htmlparser(scene.content.replace(fillchar, ''));\n\t\t\t\tme.options.autoClearEmptyNode = false;\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\tme.options.autoClearEmptyNode = orgState;\n\t\t\t\t//trace:873\n\t\t\t\t//去掉展位符\n\t\t\t\tme.document.body.innerHTML = root.toHtml();\n\t\t\t\tme.fireEvent('afterscencerestore');\n\t\t\t\t//处理undo后空格不展位的问题\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(me.document, 'td th caption p'), function(node) {\n\t\t\t\t\t\tif (domUtils.isEmptyNode(node)) {\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar rng = new dom.Range(me.document).moveToAddress(scene.address);\n\t\t\t\t\trng.select(noNeedFillCharTags[rng.startContainer.nodeName.toLowerCase()]);\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tthis.update();\n\t\t\t\tthis.clearKey();\n\t\t\t\t//不能把自己reset了\n\t\t\t\tme.fireEvent('reset', true);\n\t\t\t};\n\n\t\t\tthis.getScene = function() {\n\t\t\t\tvar me = this.editor;\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\trngAddress = rng.createAddress(false, true);\n\t\t\t\tme.fireEvent('beforegetscene');\n\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML);\n\t\t\t\tme.options.autoClearEmptyNode = false;\n\t\t\t\tme.filterOutputRule(root);\n\t\t\t\tme.options.autoClearEmptyNode = orgState;\n\t\t\t\tvar cont = root.toHtml();\n\t\t\t\t//trace:3461\n\t\t\t\t//这个会引起回退时导致空格丢失的情况\n\t\t\t\t//            browser.ie && (cont = cont.replace(/>&nbsp;</g, '><').replace(/\\s*</g, '<').replace(/>\\s*/g, '>'));\n\t\t\t\tme.fireEvent('aftergetscene');\n\n\t\t\t\treturn {\n\t\t\t\t\taddress: rngAddress,\n\t\t\t\t\tcontent: cont\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.save = function(notCompareRange, notSetCursor) {\n\t\t\t\tclearTimeout(saveSceneTimer);\n\t\t\t\tvar currentScene = this.getScene(notSetCursor),\n\t\t\t\t\tlastScene = this.list[this.index];\n\n\t\t\t\tif (lastScene && lastScene.content != currentScene.content) {\n\t\t\t\t\tme.trigger('contentchange')\n\t\t\t\t}\n\t\t\t\t//内容相同位置相同不存\n\t\t\t\tif (lastScene && lastScene.content == currentScene.content &&\n\t\t\t\t\t(notCompareRange ? 1 : compareRangeAddress(lastScene.address, currentScene.address))\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.list = this.list.slice(0, this.index + 1);\n\t\t\t\tthis.list.push(currentScene);\n\t\t\t\t//如果大于最大数量了，就把最前的剔除\n\t\t\t\tif (this.list.length > maxUndoCount) {\n\t\t\t\t\tthis.list.shift();\n\t\t\t\t}\n\t\t\t\tthis.index = this.list.length - 1;\n\t\t\t\tthis.clearKey();\n\t\t\t\t//跟新undo/redo状态\n\t\t\t\tthis.update();\n\n\t\t\t};\n\t\t\tthis.update = function() {\n\t\t\t\tthis.hasRedo = !!this.list[this.index + 1];\n\t\t\t\tthis.hasUndo = !!this.list[this.index - 1];\n\t\t\t};\n\t\t\tthis.reset = function() {\n\t\t\t\tthis.list = [];\n\t\t\t\tthis.index = 0;\n\t\t\t\tthis.hasUndo = false;\n\t\t\t\tthis.hasRedo = false;\n\t\t\t\tthis.clearKey();\n\t\t\t};\n\t\t\tthis.clearKey = function() {\n\t\t\t\tkeycont = 0;\n\t\t\t\tlastKeyCode = null;\n\t\t\t};\n\t\t}\n\n\t\tme.undoManger = new UndoManager();\n\t\tme.undoManger.editor = me;\n\n\t\tfunction saveScene() {\n\t\t\tthis.undoManger.save();\n\t\t}\n\n\t\tme.addListener('saveScene', function() {\n\t\t\tvar args = Array.prototype.splice.call(arguments, 1);\n\t\t\tthis.undoManger.save.apply(this.undoManger, args);\n\t\t});\n\n\t\t//    me.addListener('beforeexeccommand', saveScene);\n\t\t//    me.addListener('afterexeccommand', saveScene);\n\n\t\tme.addListener('reset', function(type, exclude) {\n\t\t\tif (!exclude) {\n\t\t\t\tthis.undoManger.reset();\n\t\t\t}\n\t\t});\n\t\tme.commands['redo'] = me.commands['undo'] = {\n\t\t\texecCommand: function(cmdName) {\n\t\t\t\tthis.undoManger[cmdName]();\n\t\t\t},\n\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\treturn this.undoManger['has' + (cmdName.toLowerCase() == 'undo' ? 'Undo' : 'Redo')] ? 0 : -1;\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\n\t\tvar keys = {\n\t\t\t\t//  /*Backspace*/ 8:1, /*Delete*/ 46:1,\n\t\t\t\t/*Shift*/\n\t\t\t\t16: 1,\n\t\t\t\t/*Ctrl*/ 17: 1,\n\t\t\t\t/*Alt*/ 18: 1,\n\t\t\t\t37: 1,\n\t\t\t\t38: 1,\n\t\t\t\t39: 1,\n\t\t\t\t40: 1\n\n\t\t\t},\n\t\t\tkeycont = 0,\n\t\t\tlastKeyCode;\n\t\t//输入法状态下不计算字符数\n\t\tvar inputType = false;\n\t\tme.addListener('ready', function() {\n\t\t\tdomUtils.on(this.body, 'compositionstart', function() {\n\t\t\t\tinputType = true;\n\t\t\t});\n\t\t\tdomUtils.on(this.body, 'compositionend', function() {\n\t\t\t\tinputType = false;\n\t\t\t})\n\t\t});\n\t\t//快捷键\n\t\tme.addshortcutkey({\n\t\t\t\"Undo\": \"ctrl+90\", //undo\n\t\t\t\"Redo\": \"ctrl+89\" //redo\n\n\t\t});\n\t\tvar isCollapsed = true;\n\t\tme.addListener('keydown', function(type, evt) {\n\n\t\t\tvar me = this;\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (!keys[keyCode] && !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\tif (inputType)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (!me.selection.getRange().collapsed) {\n\t\t\t\t\tme.undoManger.save(false, true);\n\t\t\t\t\tisCollapsed = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (me.undoManger.list.length == 0) {\n\t\t\t\t\tme.undoManger.save(true);\n\t\t\t\t}\n\t\t\t\tclearTimeout(saveSceneTimer);\n\n\t\t\t\tfunction save(cont) {\n\t\t\t\t\tcont.undoManger.save(false, true);\n\t\t\t\t\tcont.fireEvent('selectionchange');\n\t\t\t\t}\n\t\t\t\tsaveSceneTimer = setTimeout(function() {\n\t\t\t\t\tif (inputType) {\n\t\t\t\t\t\tvar interalTimer = setInterval(function() {\n\t\t\t\t\t\t\tif (!inputType) {\n\t\t\t\t\t\t\t\tsave(me);\n\t\t\t\t\t\t\t\tclearInterval(interalTimer)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 300)\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tsave(me);\n\t\t\t\t}, 200);\n\n\t\t\t\tlastKeyCode = keyCode;\n\t\t\t\tkeycont++;\n\t\t\t\tif (keycont >= maxInputCount) {\n\t\t\t\t\tsave(me)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (!keys[keyCode] && !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\tif (inputType)\n\t\t\t\t\treturn;\n\t\t\t\tif (!isCollapsed) {\n\t\t\t\t\tthis.undoManger.save(false, true);\n\t\t\t\t\tisCollapsed = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t//扩展实例，添加关闭和开启命令undo\n\t\tme.stopCmdUndo = function() {\n\t\t\tme.__hasEnterExecCommand = true;\n\t\t};\n\t\tme.startCmdUndo = function() {\n\t\t\tme.__hasEnterExecCommand = false;\n\t\t}\n\t};\n\n\t// plugins/copy.js\n\tUE.plugin.register('copy', function() {\n\t\treturn;\n\t\tvar me = this;\n\t\tvar jsPath = $GLOBAL_CONFIG['pcjspath'];\n\t\tfunction initZeroClipboard() {\n\n\t\t\tZeroClipboard.config({\n\t\t\t\tdebug: false,\n\t\t\t\t//swfPath: me.options.UEDITOR_HOME_URL + 'third-party/zeroclipboard/ZeroClipboard.swf'\n\t\t\t\tswfPath:jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.swf'\n\t\t\t});\n\n\t\t\tvar client = me.zeroclipboard = new ZeroClipboard();\n\n\t\t\t// 复制内容\n\t\t\tclient.on('copy', function(e) {\n\t\t\t\tvar client = e.client,\n\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\tdiv = document.createElement('div');\n\n\t\t\t\tdiv.appendChild(rng.cloneContents());\n\t\t\t\tclient.setText(div.innerText || div.textContent);\n\t\t\t\tclient.setHtml(div.innerHTML);\n\t\t\t\trng.select();\n\t\t\t});\n\t\t\t// hover事件传递到target\n\t\t\tclient.on('mouseover mouseout', function(e) {\n\t\t\t\tvar target = e.target;\n\t\t\t\tif (e.type == 'mouseover') {\n\t\t\t\t\tdomUtils.addClass(target, 'edui-state-hover');\n\t\t\t\t} else if (e.type == 'mouseout') {\n\t\t\t\t\tdomUtils.removeClasses(target, 'edui-state-hover');\n\t\t\t\t}\n\t\t\t});\n\t\t\t// flash加载不成功\n\t\t\tclient.on('wrongflash noflash', function() {\n\t\t\t\tZeroClipboard.destroy();\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\t\t\t\t\tif (!browser.ie) {\n\t\t\t\t\t\tif (window.ZeroClipboard) {\n\t\t\t\t\t\t\tinitZeroClipboard();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.log(jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.js')\n\t\t\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\t\t   // src: me.options.UEDITOR_HOME_URL + \"third-party/zeroclipboard/ZeroClipboard.js\",\n\t\t\t\t\t\t\t   src:jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.js',\n\t\t\t\t\t\t\t\ttag: \"script\",\n\t\t\t\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t\t\t\t}, function() {\n\t\t\t\t\t\t\t\tinitZeroClipboard();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'copy': {\n\t\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\t\tif (!me.document.execCommand('copy')) {\n\t\t\t\t\t\t\talert(me.getLang('copymsg'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/paste.js\n\t///import core\n\t///import plugins/inserthtml.js\n\t///import plugins/undo.js\n\t///import plugins/serialize.js\n\t///commands 粘贴\n\t///commandsName  PastePlain\n\t///commandsTitle  纯文本粘贴模式\n\t/**\n\t * @description 粘贴\n\t * @author zhanyi\n\t */\n\tUE.plugins['paste'] = function() {\n\t\tfunction getClipboardData(callback) {\n\t\t\tvar doc = this.document;\n\t\t\tif (doc.getElementById('baidu_pastebin')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar range = this.selection.getRange(),\n\t\t\t\tbk = range.createBookmark(),\n\t\t\t\t//创建剪贴的容器div\n\t\t\t\tpastebin = doc.createElement('div');\n\t\t\tpastebin.id = 'baidu_pastebin';\n\t\t\t// Safari 要求div必须有内容，才能粘贴内容进来\n\t\t\tbrowser.webkit && pastebin.appendChild(doc.createTextNode(domUtils.fillChar + domUtils.fillChar));\n\t\t\tdoc.body.appendChild(pastebin);\n\t\t\t//trace:717 隐藏的span不能得到top\n\t\t\t//bk.start.innerHTML = '&nbsp;';\n\t\t\tbk.start.style.display = '';\n\t\t\tpastebin.style.cssText = \"position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:\" +\n\t\t\t\t//要在现在光标平行的位置加入，否则会出现跳动的问题\n\t\t\t\tdomUtils.getXY(bk.start).y + 'px';\n\n\t\t\trange.selectNodeContents(pastebin).select(true);\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\tfor (var i = 0, pastebins = doc.querySelectorAll('#baidu_pastebin'), pi; pi = pastebins[i++];) {\n\t\t\t\t\t\tif (domUtils.isEmptyNode(pi)) {\n\t\t\t\t\t\t\tdomUtils.remove(pi);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpastebin = pi;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tpastebin.parentNode.removeChild(pastebin);\n\t\t\t\t} catch (e) {}\n\t\t\t\trange.moveToBookmark(bk).select(true);\n\t\t\t\tcallback(pastebin);\n\t\t\t}, 0);\n\t\t}\n\n\t\tvar me = this;\n\n\t\tme.setOpt({\n\t\t\tretainOnlyLabelPasted: false\n\t\t});\n\n\t\tvar txtContent, htmlContent, address;\n\n\t\tfunction getPureHtml(html) {\n\t\t\treturn html.replace(/<(\\/?)([\\w\\-]+)([^>]*)>/gi, function(a, b, tagName, attrs) {\n\t\t\t\ttagName = tagName.toLowerCase();\n\t\t\t\tif ({\n\t\t\t\t\t\timg: 1\n\t\t\t\t\t}[tagName]) {\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t\t\tattrs = attrs.replace(/([\\w\\-]*?)\\s*=\\s*((\"([^\"]*)\")|('([^']*)')|([^\\s>]+))/gi, function(str, atr, val) {\n\t\t\t\t\tif ({\n\t\t\t\t\t\t\t'src': 1,\n\t\t\t\t\t\t\t'href': 1,\n\t\t\t\t\t\t\t'name': 1\n\t\t\t\t\t\t}[atr.toLowerCase()]) {\n\t\t\t\t\t\treturn atr + '=' + val + ' '\n\t\t\t\t\t}\n\t\t\t\t\treturn ''\n\t\t\t\t});\n\t\t\t\tif ({\n\t\t\t\t\t\t'span': 1,\n\t\t\t\t\t\t'div': 1\n\t\t\t\t\t}[tagName]) {\n\t\t\t\t\treturn ''\n\t\t\t\t} else {\n\n\t\t\t\t\treturn '<' + b + tagName + ' ' + utils.trim(attrs) + '>'\n\t\t\t\t}\n\n\t\t\t});\n\t\t}\n\n\t\tfunction filter(div) {\n\t\t\tvar html;\n\t\t\tif (div.firstChild) {\n\t\t\t\t//去掉cut中添加的边界值\n\t\t\t\tvar nodes = domUtils.getElementsByTagName(div, 'span');\n\t\t\t\tfor (var i = 0, ni; ni = nodes[i++];) {\n\t\t\t\t\tif (ni.id == '_baidu_cut_start' || ni.id == '_baidu_cut_end') {\n\t\t\t\t\t\tdomUtils.remove(ni);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (browser.webkit) {\n\n\t\t\t\t\tvar brs = div.querySelectorAll('div br');\n\t\t\t\t\tfor (var i = 0, bi; bi = brs[i++];) {\n\t\t\t\t\t\tvar pN = bi.parentNode;\n\t\t\t\t\t\tif (pN.tagName == 'DIV' && pN.childNodes.length == 1) {\n\t\t\t\t\t\t\tpN.innerHTML = '<p><br/></p>';\n\t\t\t\t\t\t\tdomUtils.remove(pN);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar divs = div.querySelectorAll('#baidu_pastebin');\n\t\t\t\t\tfor (var i = 0, di; di = divs[i++];) {\n\t\t\t\t\t\tvar tmpP = me.document.createElement('p');\n\t\t\t\t\t\tdi.parentNode.insertBefore(tmpP, di);\n\t\t\t\t\t\twhile (di.firstChild) {\n\t\t\t\t\t\t\ttmpP.appendChild(di.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(di);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar metas = div.querySelectorAll('meta');\n\t\t\t\t\tfor (var i = 0, ci; ci = metas[i++];) {\n\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar brs = div.querySelectorAll('br');\n\t\t\t\t\tfor (i = 0; ci = brs[i++];) {\n\t\t\t\t\t\tif (/^apple-/i.test(ci.className)) {\n\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (browser.gecko) {\n\t\t\t\t\tvar dirtyNodes = div.querySelectorAll('[_moz_dirty]');\n\t\t\t\t\tfor (i = 0; ci = dirtyNodes[i++];) {\n\t\t\t\t\t\tci.removeAttribute('_moz_dirty');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!browser.ie) {\n\t\t\t\t\tvar spans = div.querySelectorAll('span.Apple-style-span');\n\t\t\t\t\tfor (var i = 0, ci; ci = spans[i++];) {\n\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//ie下使用innerHTML会产生多余的\\r\\n字符，也会产生&nbsp;这里过滤掉\n\t\t\t\thtml = div.innerHTML; //.replace(/>(?:(\\s|&nbsp;)*?)</g,'><');\n\n\t\t\t\t//过滤word粘贴过来的冗余属性\n\t\t\t\thtml = UE.filterWord(html);\n\t\t\t\t//取消了忽略空白的第二个参数，粘贴过来的有些是有空白的，会被套上相关的标签\n\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t//如果给了过滤规则就先进行过滤\n\t\t\t\tif (me.options.filterRules) {\n\t\t\t\t\tUE.filterNode(root, me.options.filterRules);\n\t\t\t\t}\n\t\t\t\t//执行默认的处理\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\t//针对chrome的处理\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\tvar br = root.lastChild();\n\t\t\t\t\tif (br && br.type == 'element' && br.tagName == 'br') {\n\t\t\t\t\t\troot.removeChild(br)\n\t\t\t\t\t}\n\t\t\t\t\tutils.each(me.body.querySelectorAll('div'), function(node) {\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\t\t\t\tdomUtils.remove(node, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\thtml = {\n\t\t\t\t\t'html': root.toHtml()\n\t\t\t\t};\n\t\t\t\tme.fireEvent('beforepaste', html, root);\n\t\t\t\t//抢了默认的粘贴，那后边的内容就不执行了，比如表格粘贴\n\t\t\t\tif (!html.html) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\troot = UE.htmlparser(html.html, true);\n\t\t\t\t//如果开启了纯文本模式\n\t\t\t\tif (me.queryCommandState('pasteplain') === 1) {\n\t\t\t\t\tme.execCommand('insertHtml', UE.filterNode(root, me.options.filterTxtRules).toHtml(), true);\n\t\t\t\t} else {\n\t\t\t\t\t//文本模式\n\t\t\t\t\tUE.filterNode(root, me.options.filterTxtRules);\n\t\t\t\t\ttxtContent = root.toHtml();\n\t\t\t\t\t//完全模式\n\t\t\t\t\thtmlContent = html.html;\n\n\t\t\t\t\taddress = me.selection.getRange().createAddress(true);\n\t\t\t\t\tme.execCommand('insertHtml', me.getOpt('retainOnlyLabelPasted') === true ? getPureHtml(htmlContent) : htmlContent, true);\n\t\t\t\t}\n\t\t\t\tme.fireEvent(\"afterpaste\", html);\n\t\t\t}\n\t\t}\n\n\t\tme.addListener('pasteTransfer', function(cmd, plainType) {\n\n\t\t\tif (address && txtContent && htmlContent && txtContent != htmlContent) {\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\trange.moveToAddress(address, true);\n\n\t\t\t\tif (!range.collapsed) {\n\n\t\t\t\t\twhile (!domUtils.isBody(range.startContainer)) {\n\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\tstart = start.childNodes[range.startOffset];\n\t\t\t\t\t\t\tif (!start) {\n\t\t\t\t\t\t\t\trange.setStartBefore(range.startContainer);\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar pre = start.previousSibling;\n\n\t\t\t\t\t\t\tif (pre && pre.nodeType == 3 && new RegExp('^[\\n\\r\\t ' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\t\trange.setStartBefore(pre)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\t\t\trange.setStartBefore(range.startContainer);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\twhile (!domUtils.isBody(range.endContainer)) {\n\t\t\t\t\t\tvar end = range.endContainer;\n\t\t\t\t\t\tif (end.nodeType == 1) {\n\t\t\t\t\t\t\tend = end.childNodes[range.endOffset];\n\t\t\t\t\t\t\tif (!end) {\n\t\t\t\t\t\t\t\trange.setEndAfter(range.endContainer);\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar next = end.nextSibling;\n\t\t\t\t\t\t\tif (next && next.nodeType == 3 && new RegExp('^[\\n\\r\\t' + domUtils.fillChar + ']*$').test(next.nodeValue)) {\n\t\t\t\t\t\t\t\trange.setEndAfter(next)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (range.endOffset == range.endContainer[range.endContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length) {\n\t\t\t\t\t\t\trange.setEndAfter(range.endContainer);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\trange.deleteContents();\n\t\t\t\trange.select(true);\n\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\tvar html = htmlContent;\n\t\t\t\tif (plainType === 2) {\n\t\t\t\t\thtml = getPureHtml(html);\n\t\t\t\t} else if (plainType) {\n\t\t\t\t\thtml = txtContent;\n\t\t\t\t}\n\t\t\t\tme.execCommand('inserthtml', html, true);\n\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\twhile (!domUtils.isBody(rng.startContainer) && !rng.startOffset &&\n\t\t\t\t\trng.startContainer[rng.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t) {\n\t\t\t\t\trng.setStartBefore(rng.startContainer);\n\t\t\t\t}\n\t\t\t\tvar tmpAddress = rng.createAddress(true);\n\t\t\t\taddress.endAddress = tmpAddress.startAddress;\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('ready', function() {\n\t\t\tdomUtils.on(me.body, 'cut', function() {\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\tif (!range.collapsed && me.undoManger) {\n\t\t\t\t\tme.undoManger.save();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//ie下beforepaste在点击右键时也会触发，所以用监控键盘才处理\n\t\t\tdomUtils.on(me.body, browser.ie || browser.opera ? 'keydown' : 'paste', function(e) {\n\t\t\t\tif ((browser.ie || browser.opera) && ((!e.ctrlKey && !e.metaKey) || e.keyCode != '86')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgetClipboardData.call(me, function(div) {\n\t\t\t\t\tfilter(div);\n\t\t\t\t});\n\t\t\t});\n\n\t\t});\n\n\t\tme.commands['paste'] = {\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tgetClipboardData.call(me, function(div) {\n\t\t\t\t\t\tfilter(div);\n\t\t\t\t\t});\n\t\t\t\t\tme.document.execCommand('paste');\n\t\t\t\t} else {\n\t\t\t\t\talert(me.getLang('pastemsg'));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t// plugins/puretxtpaste.js\n\t/**\n\t * 纯文本粘贴插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['pasteplain'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'pasteplain': false,\n\t\t\t'filterTxtRules': function() {\n\t\t\t\tfunction transP(node) {\n\t\t\t\t\tnode.tagName = 'p';\n\t\t\t\t\tnode.setStyle();\n\t\t\t\t}\n\n\t\t\t\tfunction removeNode(node) {\n\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t//直接删除及其字节点内容\n\t\t\t\t\t'-': 'script style object iframe embed input select',\n\t\t\t\t\t'p': {\n\t\t\t\t\t\t$: {}\n\t\t\t\t\t},\n\t\t\t\t\t'br': {\n\t\t\t\t\t\t$: {}\n\t\t\t\t\t},\n\t\t\t\t\tdiv: function(node) {\n\t\t\t\t\t\tvar tmpNode, p = UE.uNode.createElement('p');\n\t\t\t\t\t\twhile (tmpNode = node.firstChild()) {\n\t\t\t\t\t\t\tif (tmpNode.type == 'text' || !UE.dom.dtd.$block[tmpNode.tagName]) {\n\t\t\t\t\t\t\t\tp.appendChild(tmpNode);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t\t\tp = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(tmpNode, node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t},\n\t\t\t\t\tol: removeNode,\n\t\t\t\t\tul: removeNode,\n\t\t\t\t\tdl: removeNode,\n\t\t\t\t\tdt: removeNode,\n\t\t\t\t\tdd: removeNode,\n\t\t\t\t\t'li': removeNode,\n\t\t\t\t\t'caption': transP,\n\t\t\t\t\t'th': transP,\n\t\t\t\t\t'tr': transP,\n\t\t\t\t\t'h1': transP,\n\t\t\t\t\t'h2': transP,\n\t\t\t\t\t'h3': transP,\n\t\t\t\t\t'h4': transP,\n\t\t\t\t\t'h5': transP,\n\t\t\t\t\t'h6': transP,\n\t\t\t\t\t'td': function(node) {\n\t\t\t\t\t\t//没有内容的td直接删掉\n\t\t\t\t\t\tvar txt = !!node.innerText();\n\t\t\t\t\t\tif (txt) {\n\t\t\t\t\t\t\tnode.parentNode.insertAfter(UE.uNode.createText(' &nbsp; &nbsp;'), node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.parentNode.removeChild(node, node.innerText())\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}()\n\t\t});\n\t\t//暂时这里支持一下老版本的属性\n\t\tvar pasteplain = me.options.pasteplain;\n\n\t\t/**\n\t\t * 启用或取消纯文本粘贴模式\n\t\t * @command pasteplain\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'pasteplain' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查询当前是否处于纯文本粘贴模式\n\t\t * @command pasteplain\n\t\t * @method queryCommandState\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { int } 如果处于纯文本模式，返回1，否则，返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'pasteplain' );\n\t\t * ```\n\t\t */\n\t\tme.commands['pasteplain'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn pasteplain ? 1 : 0;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tpasteplain = !pasteplain | 0;\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\t};\n\n\t// plugins/list.js\n\t/**\n\t * 有序列表,无序列表插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['list'] = function() {\n\t\tvar me = this,\n\t\t\tnotExchange = {\n\t\t\t\t'TD': 1,\n\t\t\t\t'PRE': 1,\n\t\t\t\t'BLOCKQUOTE': 1\n\t\t\t};\n\t\tvar customStyle = {\n\t\t\t'cn': 'cn-1-',\n\t\t\t'cn1': 'cn-2-',\n\t\t\t'cn2': 'cn-3-',\n\t\t\t'num': 'num-1-',\n\t\t\t'num1': 'num-2-',\n\t\t\t'num2': 'num-3-',\n\t\t\t'dash': 'dash',\n\t\t\t'dot': 'dot'\n\t\t};\n\n\t\tme.setOpt({\n\t\t\t'autoTransWordToList': false,\n\t\t\t'insertorderedlist': {\n\t\t\t\t'num': '',\n\t\t\t\t'num1': '',\n\t\t\t\t'num2': '',\n\t\t\t\t'cn': '',\n\t\t\t\t'cn1': '',\n\t\t\t\t'cn2': '',\n\t\t\t\t'decimal': '',\n\t\t\t\t'lower-alpha': '',\n\t\t\t\t'lower-roman': '',\n\t\t\t\t'upper-alpha': '',\n\t\t\t\t'upper-roman': ''\n\t\t\t},\n\t\t\t'insertunorderedlist': {\n\t\t\t\t'circle': '',\n\t\t\t\t'disc': '',\n\t\t\t\t'square': '',\n\t\t\t\t'dash': '',\n\t\t\t\t'dot': ''\n\t\t\t},\n\t\t\tlistDefaultPaddingLeft: '30',\n\t\t\tlisticonpath: 'http://bs.baidu.com/listicon/',\n\t\t\tmaxListLevel: -1, //-1不限制\n\t\t\tdisablePInList: false\n\t\t});\n\n\t\tfunction listToArray(list) {\n\t\t\tvar arr = [];\n\t\t\tfor (var p in list) {\n\t\t\t\tarr.push(p)\n\t\t\t}\n\t\t\treturn arr;\n\t\t}\n\t\tvar listStyle = {\n\t\t\t'OL': listToArray(me.options.insertorderedlist),\n\t\t\t'UL': listToArray(me.options.insertunorderedlist)\n\t\t};\n\t\tvar liiconpath = me.options.listiconpath;\n\n\t\t//根据用户配置，调整customStyle\n\t\tfor (var s in customStyle) {\n\t\t\tif (!me.options.insertorderedlist.hasOwnProperty(s) && !me.options.insertunorderedlist.hasOwnProperty(s)) {\n\t\t\t\tdelete customStyle[s];\n\t\t\t}\n\t\t}\n\n\t\tme.ready(function() {\n\t\t\tvar customCss = [];\n\t\t\tfor (var p in customStyle) {\n\t\t\t\tif (p == 'dash' || p == 'dot') {\n\t\t\t\t\tcustomCss.push('li.list-' + customStyle[p] + '{background-image:url(' + liiconpath + customStyle[p] + '.gif)}');\n\t\t\t\t\tcustomCss.push('ul.custom_' + p + '{list-style:none;}ul.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = 0; i < 99; i++) {\n\t\t\t\t\t\tcustomCss.push('li.list-' + customStyle[p] + i + '{background-image:url(' + liiconpath + 'list-' + customStyle[p] + i + '.gif)}')\n\t\t\t\t\t}\n\t\t\t\t\tcustomCss.push('ol.custom_' + p + '{list-style:none;}ol.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t\t\t\t}\n\t\t\t\tswitch (p) {\n\t\t\t\t\tcase 'cn':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cn1':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:30px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cn2':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:40px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:55px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:68px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'num':\n\t\t\t\t\tcase 'num1':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'num2':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:35px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'dash':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft{padding-left:35px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'dot':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft{padding-left:20px}');\n\t\t\t\t}\n\t\t\t}\n\t\t\tcustomCss.push('.list-paddingleft-1{padding-left:0}');\n\t\t\tcustomCss.push('.list-paddingleft-2{padding-left:' + me.options.listDefaultPaddingLeft + 'px}');\n\t\t\tcustomCss.push('.list-paddingleft-3{padding-left:' + me.options.listDefaultPaddingLeft * 2 + 'px}');\n\t\t\t//如果不给宽度会在自定应样式里出现滚动条\n\t\t\tutils.cssRule('list', 'ol,ul{margin:0;pading:0;' + (browser.ie ? '' : 'width:95%') + '}li{clear:both;}' + customCss.join('\\n'), me.document);\n\t\t});\n\t\t//单独处理剪切的问题\n\t\tme.ready(function() {\n\t\t\tdomUtils.on(me.body, 'cut', function() {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tli;\n\t\t\t\t\t//trace:3416\n\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\tif (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t\t\t\t\t\t\tif (!li.nextSibling && domUtils.isEmptyBlock(li)) {\n\t\t\t\t\t\t\t\tvar pn = li.parentNode,\n\t\t\t\t\t\t\t\t\tnode;\n\t\t\t\t\t\t\t\tif (node = pn.previousSibling) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\trng.setStartAtLast(node).collapse(true);\n\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t} else if (node = pn.nextSibling) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\trng.setStartAtFirst(node).collapse(true);\n\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar tmpNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, tmpNode);\n\t\t\t\t\t\t\t\t\tpn.parentNode.insertBefore(tmpNode, pn);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\trng.setStart(tmpNode, 0).collapse(true);\n\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t})\n\t\t});\n\n\t\tfunction getStyle(node) {\n\t\t\tvar cls = node.className;\n\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\treturn cls.match(/custom_(\\w+)/)[1]\n\t\t\t}\n\t\t\treturn domUtils.getStyle(node, 'list-style-type')\n\n\t\t}\n\n\t\tme.addListener('beforepaste', function(type, html) {\n\t\t\tvar me = this,\n\t\t\t\trng = me.selection.getRange(),\n\t\t\t\tli;\n\t\t\tvar root = UE.htmlparser(html.html, true);\n\t\t\tif (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t\t\t\tvar list = li.parentNode,\n\t\t\t\t\ttagName = list.tagName == 'OL' ? 'ul' : 'ol';\n\t\t\t\tutils.each(root.getNodesByTagName(tagName), function(n) {\n\t\t\t\t\tn.tagName = list.tagName;\n\t\t\t\t\tn.setAttr();\n\t\t\t\t\tif (n.parentNode === root) {\n\t\t\t\t\t\ttype = getStyle(list) || (list.tagName == 'OL' ? 'decimal' : 'disc')\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar className = n.parentNode.getAttr('class');\n\t\t\t\t\t\tif (className && /custom_/.test(className)) {\n\t\t\t\t\t\t\ttype = className.match(/custom_(\\w+)/)[1]\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttype = n.parentNode.getStyle('list-style-type');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!type) {\n\t\t\t\t\t\t\ttype = list.tagName == 'OL' ? 'decimal' : 'disc';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar index = utils.indexOf(listStyle[list.tagName], type);\n\t\t\t\t\tif (n.parentNode !== root)\n\t\t\t\t\t\tindex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\tvar currentStyle = listStyle[list.tagName][index];\n\t\t\t\t\tif (customStyle[currentStyle]) {\n\t\t\t\t\t\tn.setAttr('class', 'custom_' + currentStyle)\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tn.setStyle('list-style-type', currentStyle)\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t}\n\n\t\t\thtml.html = root.toHtml();\n\t\t});\n\t\t//导出时，去掉p标签\n\t\tme.getOpt('disablePInList') === true && me.addOutputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('li'), function(li) {\n\t\t\t\tvar newChildrens = [],\n\t\t\t\t\tindex = 0;\n\t\t\t\tutils.each(li.children, function(n) {\n\t\t\t\t\tif (n.tagName == 'p') {\n\t\t\t\t\t\tvar tmpNode;\n\t\t\t\t\t\twhile (tmpNode = n.children.pop()) {\n\t\t\t\t\t\t\tnewChildrens.splice(index, 0, tmpNode);\n\t\t\t\t\t\t\ttmpNode.parentNode = li;\n\t\t\t\t\t\t\tlastNode = tmpNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpNode = newChildrens[newChildrens.length - 1];\n\t\t\t\t\t\tif (!tmpNode || tmpNode.type != 'element' || tmpNode.tagName != 'br') {\n\t\t\t\t\t\t\tvar br = UE.uNode.createElement('br');\n\t\t\t\t\t\t\tbr.parentNode = li;\n\t\t\t\t\t\t\tnewChildrens.push(br);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tindex = newChildrens.length;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (newChildrens.length) {\n\t\t\t\t\tli.children = newChildrens;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t//进入编辑器的li要套p标签\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('li'), function(li) {\n\t\t\t\tvar tmpP = UE.uNode.createElement('p');\n\t\t\t\tfor (var i = 0, ci; ci = li.children[i];) {\n\t\t\t\t\tif (ci.type == 'text' || dtd.p[ci.tagName]) {\n\t\t\t\t\t\ttmpP.appendChild(ci);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tmpP.firstChild()) {\n\t\t\t\t\t\t\tli.insertBefore(tmpP, ci);\n\t\t\t\t\t\t\ttmpP = UE.uNode.createElement('p');\n\t\t\t\t\t\t\ti = i + 2;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (tmpP.firstChild() && !tmpP.parentNode || !li.firstChild()) {\n\t\t\t\t\tli.appendChild(tmpP);\n\t\t\t\t}\n\t\t\t\t//trace:3357\n\t\t\t\t//p不能为空\n\t\t\t\tif (!tmpP.firstChild()) {\n\t\t\t\t\ttmpP.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n\t\t\t\t}\n\t\t\t\t//去掉末尾的空白\n\t\t\t\tvar p = li.firstChild();\n\t\t\t\tvar lastChild = p.lastChild();\n\t\t\t\tif (lastChild && lastChild.type == 'text' && /^\\s*$/.test(lastChild.data)) {\n\t\t\t\t\tp.removeChild(lastChild)\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (me.options.autoTransWordToList) {\n\t\t\t\tvar orderlisttype = {\n\t\t\t\t\t\t'num1': /^\\d+\\)/,\n\t\t\t\t\t\t'decimal': /^\\d+\\./,\n\t\t\t\t\t\t'lower-alpha': /^[a-z]+\\)/,\n\t\t\t\t\t\t'upper-alpha': /^[A-Z]+\\./,\n\t\t\t\t\t\t'cn': /^[\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+[\\u3001]/,\n\t\t\t\t\t\t'cn2': /^\\([\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+\\)/\n\t\t\t\t\t},\n\t\t\t\t\tunorderlisttype = {\n\t\t\t\t\t\t'square': 'n'\n\t\t\t\t\t};\n\n\t\t\t\tfunction checkListType(content, container) {\n\t\t\t\t\tvar span = container.firstChild();\n\t\t\t\t\tif (span && span.type == 'element' && span.tagName == 'span' && /Wingdings|Symbol/.test(span.getStyle('font-family'))) {\n\t\t\t\t\t\tfor (var p in unorderlisttype) {\n\t\t\t\t\t\t\tif (unorderlisttype[p] == span.data) {\n\t\t\t\t\t\t\t\treturn p\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 'disc'\n\t\t\t\t\t}\n\t\t\t\t\tfor (var p in orderlisttype) {\n\t\t\t\t\t\tif (orderlisttype[p].test(content)) {\n\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tutils.each(root.getNodesByTagName('p'), function(node) {\n\t\t\t\t\tif (node.getAttr('class') != 'MsoListParagraph') {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\t//word粘贴过来的会带有margin要去掉,但这样也可能会误命中一些央视\n\t\t\t\t\tnode.setStyle('margin', '');\n\t\t\t\t\tnode.setStyle('margin-left', '');\n\t\t\t\t\tnode.setAttr('class', '');\n\n\t\t\t\t\tfunction appendLi(list, p, type) {\n\t\t\t\t\t\tif (list.tagName == 'ol') {\n\t\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\t\tvar first = p.firstChild();\n\t\t\t\t\t\t\t\tif (first.type == 'element' && first.tagName == 'span' && orderlisttype[type].test(first.innerText())) {\n\t\t\t\t\t\t\t\t\tp.removeChild(first);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tp.innerHTML(p.innerHTML().replace(orderlisttype[type], ''));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tp.removeChild(p.firstChild())\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar li = UE.uNode.createElement('li');\n\t\t\t\t\t\tli.appendChild(p);\n\t\t\t\t\t\tlist.appendChild(li);\n\t\t\t\t\t}\n\t\t\t\t\tvar tmp = node,\n\t\t\t\t\t\ttype, cacheNode = node;\n\n\t\t\t\t\tif (node.parentNode.tagName != 'li' && (type = checkListType(node.innerText(), node))) {\n\n\t\t\t\t\t\tvar list = UE.uNode.createElement(me.options.insertorderedlist.hasOwnProperty(type) ? 'ol' : 'ul');\n\t\t\t\t\t\tif (customStyle[type]) {\n\t\t\t\t\t\t\tlist.setAttr('class', 'custom_' + type)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlist.setStyle('list-style-type', type)\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (node && node.parentNode.tagName != 'li' && checkListType(node.innerText(), node)) {\n\t\t\t\t\t\t\ttmp = node.nextSibling();\n\t\t\t\t\t\t\tif (!tmp) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(list, node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tappendLi(list, node, type);\n\t\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!list.parentNode && node && node.parentNode) {\n\t\t\t\t\t\t\tnode.parentNode.insertBefore(list, node)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar span = cacheNode.firstChild();\n\t\t\t\t\tif (span && span.type == 'element' && span.tagName == 'span' && /^\\s*(&nbsp;)+\\s*$/.test(span.innerText())) {\n\t\t\t\t\t\tspan.parentNode.removeChild(span)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t});\n\n\t\t//调整索引标签\n\t\tme.addListener('contentchange', function() {\n\t\t\tadjustListStyle(me.document)\n\t\t});\n\n\t\tfunction adjustListStyle(doc, ignore) {\n\t\t\tutils.each(domUtils.getElementsByTagName(doc, 'ol ul'), function(node) {\n\n\t\t\t\tif (!domUtils.inDoc(node, doc))\n\t\t\t\t\treturn;\n\n\t\t\t\tvar parent = node.parentNode;\n\t\t\t\tif (parent.tagName == node.tagName) {\n\t\t\t\t\tvar nodeStyleType = getStyle(node) || (node.tagName == 'OL' ? 'decimal' : 'disc'),\n\t\t\t\t\t\tparentStyleType = getStyle(parent) || (parent.tagName == 'OL' ? 'decimal' : 'disc');\n\t\t\t\t\tif (nodeStyleType == parentStyleType) {\n\t\t\t\t\t\tvar styleIndex = utils.indexOf(listStyle[node.tagName], nodeStyleType);\n\t\t\t\t\t\tstyleIndex = styleIndex + 1 == listStyle[node.tagName].length ? 0 : styleIndex + 1;\n\t\t\t\t\t\tsetListStyle(node, listStyle[node.tagName][styleIndex])\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tvar index = 0,\n\t\t\t\t\ttype = 2;\n\t\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\t\tif (!(/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/))) {\n\t\t\t\t\t\ttype = 1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/)) {\n\t\t\t\t\t\ttype = 3;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar style = domUtils.getStyle(node, 'list-style-type');\n\t\t\t\tstyle && (node.style.cssText = 'list-style-type:' + style);\n\t\t\t\tnode.className = utils.trim(node.className.replace(/list-paddingleft-\\w+/, '')) + ' list-paddingleft-' + type;\n\t\t\t\tutils.each(domUtils.getElementsByTagName(node, 'li'), function(li) {\n\t\t\t\t\tli.style.cssText && (li.style.cssText = '');\n\t\t\t\t\tif (!li.firstChild) {\n\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (li.parentNode !== node) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tindex++;\n\t\t\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\t\t\tvar paddingLeft = 1,\n\t\t\t\t\t\t\tcurrentStyle = getStyle(node);\n\t\t\t\t\t\tif (node.tagName == 'OL') {\n\t\t\t\t\t\t\tif (currentStyle) {\n\t\t\t\t\t\t\t\tswitch (currentStyle) {\n\t\t\t\t\t\t\t\t\tcase 'cn':\n\t\t\t\t\t\t\t\t\tcase 'cn1':\n\t\t\t\t\t\t\t\t\tcase 'cn2':\n\t\t\t\t\t\t\t\t\t\tif (index > 10 && (index % 10 == 0 || index > 10 && index < 20)) {\n\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 2\n\t\t\t\t\t\t\t\t\t\t} else if (index > 20) {\n\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 3\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'num2':\n\t\t\t\t\t\t\t\t\t\tif (index > 9) {\n\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 2\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tli.className = 'list-' + customStyle[currentStyle] + index + ' ' + 'list-' + currentStyle + '-paddingleft-' + paddingLeft;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tli.className = 'list-' + customStyle[currentStyle] + ' ' + 'list-' + currentStyle + '-paddingleft';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tli.className = li.className.replace(/list-[\\w\\-]+/gi, '');\n\t\t\t\t\t}\n\t\t\t\t\tvar className = li.getAttribute('class');\n\t\t\t\t\tif (className !== null && !className.replace(/\\s/g, '')) {\n\t\t\t\t\t\tdomUtils.removeAttributes(li, 'class')\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t!ignore && adjustList(node, node.tagName.toLowerCase(), getStyle(node) || domUtils.getStyle(node, 'list-style-type'), true);\n\t\t\t})\n\t\t}\n\n\t\tfunction adjustList(list, tag, style, ignoreEmpty) {\n\t\t\tvar nextList = list.nextSibling;\n\t\t\tif (nextList && nextList.nodeType == 1 && nextList.tagName.toLowerCase() == tag && (getStyle(nextList) || domUtils.getStyle(nextList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t\t\t\tdomUtils.moveChild(nextList, list);\n\t\t\t\tif (nextList.childNodes.length == 0) {\n\t\t\t\t\tdomUtils.remove(nextList);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (nextList && domUtils.isFillChar(nextList)) {\n\t\t\t\tdomUtils.remove(nextList);\n\t\t\t}\n\t\t\tvar preList = list.previousSibling;\n\t\t\tif (preList && preList.nodeType == 1 && preList.tagName.toLowerCase() == tag && (getStyle(preList) || domUtils.getStyle(preList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t\t\t\tdomUtils.moveChild(list, preList);\n\t\t\t}\n\t\t\tif (preList && domUtils.isFillChar(preList)) {\n\t\t\t\tdomUtils.remove(preList);\n\t\t\t}!ignoreEmpty && domUtils.isEmptyBlock(list) && domUtils.remove(list);\n\t\t\tif (getStyle(list)) {\n\t\t\t\tadjustListStyle(list.ownerDocument, true)\n\t\t\t}\n\t\t}\n\n\t\tfunction setListStyle(list, style) {\n\t\t\tif (customStyle[style]) {\n\t\t\t\tlist.className = 'custom_' + style;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tdomUtils.setStyle(list, 'list-style-type', style);\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\tfunction clearEmptySibling(node) {\n\t\t\tvar tmpNode = node.previousSibling;\n\t\t\tif (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t}\n\t\t\ttmpNode = node.nextSibling;\n\t\t\tif (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t}\n\t\t}\n\n\t\tme.addListener('keydown', function(type, evt) {\n\t\t\tfunction preventAndSave() {\n\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t}\n\n\t\t\tfunction findList(node, filterFn) {\n\t\t\t\twhile (node && !domUtils.isBody(node)) {\n\t\t\t\t\tif (filterFn(node)) {\n\t\t\t\t\t\treturn null\n\t\t\t\t\t}\n\t\t\t\t\tif (node.nodeType == 1 && /[ou]l/i.test(node.tagName)) {\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13 && !evt.shiftKey) { //回车\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tparent = domUtils.findParent(rng.startContainer, function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t}, true),\n\t\t\t\t\tli = domUtils.findParentByTagName(rng.startContainer, 'li', true);\n\t\t\t\tif (parent && parent.tagName != 'PRE' && !li) {\n\t\t\t\t\tvar html = parent.innerHTML.replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\t\t\t\tif (/^\\s*1\\s*\\.[^\\d]/.test(html)) {\n\t\t\t\t\t\tparent.innerHTML = html.replace(/^\\s*1\\s*\\./, '');\n\t\t\t\t\t\trng.setStartAtLast(parent).collapse(true).select();\n\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\tme.execCommand('insertorderedlist');\n\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\tstart = findList(range.startContainer, function(node) {\n\t\t\t\t\t\treturn node.tagName == 'TABLE';\n\t\t\t\t\t}),\n\t\t\t\t\tend = range.collapsed ? start : findList(range.endContainer, function(node) {\n\t\t\t\t\t\treturn node.tagName == 'TABLE';\n\t\t\t\t\t});\n\n\t\t\t\tif (start && end && start === end) {\n\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, 'li', true);\n\t\t\t\t\t\tif (start && end && start === end) {\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t\t\tif (li && domUtils.isEmptyBlock(li)) {\n\n\t\t\t\t\t\t\t\tpre = li.previousSibling;\n\t\t\t\t\t\t\t\tnext = li.nextSibling;\n\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\tparentList = li.parentNode;\n\t\t\t\t\t\t\t\tif (pre && next) {\n\t\t\t\t\t\t\t\t\trange.setStart(next, 0).collapse(true).select(true);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (!pre && !next || !pre) {\n\n\t\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(p, parentList);\n\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tli.parentNode.parentNode.insertBefore(p, parentList.nextSibling);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\t\tif (!parentList.firstChild) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\t\t\t\t\tbk = tmpRange.collapse(false).createBookmark();\n\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\ttmpRange.moveToBookmark(bk);\n\t\t\t\t\t\t\tvar li = domUtils.findParentByTagName(tmpRange.startContainer, 'li', true);\n\n\t\t\t\t\t\t\tclearEmptySibling(li);\n\t\t\t\t\t\t\ttmpRange.select();\n\t\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\n\t\t\t\t\tif (li) {\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(li)) {\n\t\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\t\tvar parentList = li.parentNode;\n\t\t\t\t\t\t\tif (li !== parentList.lastChild) {\n\t\t\t\t\t\t\t\tdomUtils.breakParent(li, parentList);\n\t\t\t\t\t\t\t\tclearEmptySibling(li);\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li, parentList.nextSibling);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//嵌套不处理\n\t\t\t\t\t\t\tif (!dtd.$list[li.parentNode.tagName]) {\n\n\t\t\t\t\t\t\t\tif (!domUtils.isBlockElm(li.firstChild)) {\n\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tli.parentNode.insertBefore(p, li);\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.moveToBookmark(bk).select();\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar first = li.firstChild;\n\t\t\t\t\t\t\tif (!first || !domUtils.isBlockElm(first)) {\n\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\n\t\t\t\t\t\t\t\t!li.firstChild && domUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\n\t\t\t\t\t\t\t\t\tp.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tli.appendChild(p);\n\t\t\t\t\t\t\t\tfirst = p;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar span = me.document.createElement('span');\n\n\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\tdomUtils.breakParent(span, li);\n\n\t\t\t\t\t\t\tvar nextLi = span.nextSibling;\n\t\t\t\t\t\t\tfirst = nextLi.firstChild;\n\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\tnextLi.appendChild(p);\n\t\t\t\t\t\t\t\tfirst = p;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(first)) {\n\t\t\t\t\t\t\t\tfirst.innerHTML = '';\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, first);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trange.setStart(first, 0).collapse(true).shrinkBoundary().select();\n\t\t\t\t\t\t\tdomUtils.remove(span);\n\t\t\t\t\t\t\tvar pre = nextLi.previousSibling;\n\t\t\t\t\t\t\tif (pre && domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\tpre.innerHTML = '<p></p>';\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, pre.firstChild);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//                        }\n\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (keyCode == 8) {\n\t\t\t\t//修中ie中li下的问题\n\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (range.collapsed && domUtils.isStartInblock(range)) {\n\t\t\t\t\ttmpRange = range.cloneRange().trimBoundary();\n\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t//要在li的最左边，才能处理\n\t\t\t\t\tif (li && domUtils.isStartInblock(tmpRange)) {\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'p', true);\n\t\t\t\t\t\tif (start && start !== li.firstChild) {\n\t\t\t\t\t\t\tvar parentList = domUtils.findParentByTagName(start, ['ol', 'ul']);\n\t\t\t\t\t\t\tdomUtils.breakParent(start, parentList);\n\t\t\t\t\t\t\tclearEmptySibling(start);\n\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\trange.setStart(start, 0).setCursor(false, true);\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (li && (pre = li.previousSibling)) {\n\t\t\t\t\t\t\tif (keyCode == 46 && li.childNodes.length) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//有可能上边的兄弟节点是个2级菜单，要追加到2级菜单的最后的li\n\t\t\t\t\t\t\tif (dtd.$list[pre.tagName]) {\n\t\t\t\t\t\t\t\tpre = pre.lastChild;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t\tfirst = li.firstChild;\n\t\t\t\t\t\t\tif (domUtils.isBlockElm(first)) {\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(first)) {\n\t\t\t\t\t\t\t\t\t//                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t\t\t\t\t\t\t\t\tpre.appendChild(first);\n\t\t\t\t\t\t\t\t\trange.setStart(first, 0).setCursor(false, true);\n\t\t\t\t\t\t\t\t\t//first不是唯一的节点\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tspan = me.document.createElement('span');\n\t\t\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\t\t\t//判断pre是否是空的节点,如果是<p><br/></p>类型的空节点，干掉p标签防止它占位\n\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\t\t\tpre.innerHTML = '';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.moveChild(li, pre);\n\t\t\t\t\t\t\t\t\trange.setStartBefore(span).collapse(true).select(true);\n\n\t\t\t\t\t\t\t\t\tdomUtils.remove(span);\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(li)) {\n\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tpre.appendChild(p);\n\t\t\t\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\t\t\t\t\t\t\t\t\t//                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.setEnd(pre, pre.childNodes.length).collapse().select(true);\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//trace:980\n\n\t\t\t\t\t\tif (li && !li.previousSibling) {\n\t\t\t\t\t\t\tvar parentList = li.parentNode;\n\t\t\t\t\t\t\tvar bk = range.createBookmark();\n\t\t\t\t\t\t\tif (domUtils.isTagNode(parentList.parentNode, 'ol ul')) {\n\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li, parentList);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li.firstChild, parentList);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList)\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.moveToBookmark(bk).setCursor(false, true);\n\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 8) {\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tlist;\n\t\t\t\tif (list = domUtils.findParentByTagName(rng.startContainer, ['ol', 'ul'], true)) {\n\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), getStyle(list) || domUtils.getComputedStyle(list, 'list-style-type'), true)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t//处理tab键\n\t\tme.addListener('tabkeydown', function() {\n\n\t\t\tvar range = me.selection.getRange();\n\n\t\t\t//控制级数\n\t\t\tfunction checkLevel(li) {\n\t\t\t\tif (me.options.maxListLevel != -1) {\n\t\t\t\t\tvar level = li.parentNode,\n\t\t\t\t\t\tlevelNum = 0;\n\t\t\t\t\twhile (/[ou]l/i.test(level.tagName)) {\n\t\t\t\t\t\tlevelNum++;\n\t\t\t\t\t\tlevel = level.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (levelNum >= me.options.maxListLevel) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//只以开始为准\n\t\t\t//todo 后续改进\n\t\t\tvar li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\tif (li) {\n\n\t\t\t\tvar bk;\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tif (checkLevel(li))\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tvar parentLi = li.parentNode,\n\t\t\t\t\t\tlist = me.document.createElement(parentLi.tagName),\n\t\t\t\t\t\tindex = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t\t\t\t\tindex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\tvar currentStyle = listStyle[list.tagName][index];\n\t\t\t\t\tsetListStyle(list, currentStyle);\n\t\t\t\t\tif (domUtils.isStartInblock(range)) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\tparentLi.insertBefore(list, li);\n\t\t\t\t\t\tlist.appendChild(li);\n\t\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\trange.moveToBookmark(bk).select(true);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\tfor (var i = 0, closeList, parents = domUtils.findParents(li), ci; ci = parents[i++];) {\n\t\t\t\t\t\tif (domUtils.isTagNode(ci, 'ol ul')) {\n\t\t\t\t\t\t\tcloseList = ci;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar current = li;\n\t\t\t\t\tif (bk.end) {\n\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\tif (checkLevel(current)) {\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\treturn node !== closeList\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar parentLi = current.parentNode,\n\t\t\t\t\t\t\t\tlist = me.document.createElement(parentLi.tagName),\n\t\t\t\t\t\t\t\tindex = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t\t\t\t\t\t\tvar currentIndex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\t\t\tvar currentStyle = listStyle[list.tagName][currentIndex];\n\t\t\t\t\t\t\tsetListStyle(list, currentStyle);\n\t\t\t\t\t\t\tparentLi.insertBefore(list, current);\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tli = current.nextSibling;\n\t\t\t\t\t\t\t\tlist.appendChild(current);\n\t\t\t\t\t\t\t\tif (!li || domUtils.isTagNode(li, 'ol ul')) {\n\t\t\t\t\t\t\t\t\tif (li) {\n\t\t\t\t\t\t\t\t\t\twhile (li = li.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tif (li.tagName == 'LI') {\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tli = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn node !== closeList\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcurrent = li;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t\t\t\t\t\t\tcurrent = li;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\trange.moveToBookmark(bk).select();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\tfunction getLi(start) {\n\t\t\twhile (start && !domUtils.isBody(start)) {\n\t\t\t\tif (start.nodeName == 'TABLE') {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tif (start.nodeName == 'LI') {\n\t\t\t\t\treturn start\n\t\t\t\t}\n\t\t\t\tstart = start.parentNode;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 有序列表，与“insertunorderedlist”命令互斥\n\t\t * @command insertorderedlist\n\t\t * @method execCommand\n\t\t * @param { String } command 命令字符串\n\t\t * @param { String } style 插入的有序列表类型，值为：decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertorderedlist','decimal');\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容是否有序列表\n\t\t * @command insertorderedlist\n\t\t * @method queryCommandState\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { int } 如果当前选区是有序列表返回1，否则返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'insertorderedlist' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容是否有序列表\n\t\t * @command insertorderedlist\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回当前有序列表的类型，值为null或decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'insertorderedlist' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 无序列表，与“insertorderedlist”命令互斥\n\t\t * @command insertunorderedlist\n\t\t * @method execCommand\n\t\t * @param { String } command 命令字符串\n\t\t * @param { String } style 插入的无序列表类型，值为：circle,disc,square,dash,dot\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertunorderedlist','circle');\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前是否有word文档粘贴进来的图片\n\t\t * @command insertunorderedlist\n\t\t * @method insertunorderedlist\n\t\t * @param { String } command 命令字符串\n\t\t * @return { int } 如果当前选区是无序列表返回1，否则返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'insertunorderedlist' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容是否有序列表\n\t\t * @command insertunorderedlist\n\t\t * @method queryCommandValue\n\t\t * @param { String } command 命令字符串\n\t\t * @return { String } 返回当前无序列表的类型，值为null或circle,disc,square,dash,dot\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'insertunorderedlist' );\n\t\t * ```\n\t\t */\n\n\t\tme.commands['insertorderedlist'] =\n\t\t\tme.commands['insertunorderedlist'] = {\n\t\t\t\texecCommand: function(command, style) {\n\n\t\t\t\t\tif (!style) {\n\t\t\t\t\t\tstyle = command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc';\n\t\t\t\t\t}\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trange = this.selection.getRange(),\n\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul',\n\t\t\t\t\t\tfrag = me.document.createDocumentFragment();\n\t\t\t\t\t//去掉是因为会出现选到末尾，导致adjustmentBoundary缩到ol/ul的位置\n\t\t\t\t\t//range.shrinkBoundary();//.adjustmentBoundary();\n\t\t\t\t\trange.adjustmentBoundary().shrinkBoundary();\n\t\t\t\t\tvar bko = range.createBookmark(true),\n\t\t\t\t\t\tstart = getLi(me.document.getElementById(bko.start)),\n\t\t\t\t\t\tmodifyStart = 0,\n\t\t\t\t\t\tend = getLi(me.document.getElementById(bko.end)),\n\t\t\t\t\t\tmodifyEnd = 0,\n\t\t\t\t\t\tstartParent, endParent,\n\t\t\t\t\t\tlist, tmp;\n\n\t\t\t\t\tif (start || end) {\n\t\t\t\t\t\tstart && (startParent = start.parentNode);\n\t\t\t\t\t\tif (!bko.end) {\n\t\t\t\t\t\t\tend = start;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tend && (endParent = end.parentNode);\n\n\t\t\t\t\t\tif (startParent === endParent) {\n\t\t\t\t\t\t\twhile (start !== end) {\n\t\t\t\t\t\t\t\ttmp = start;\n\t\t\t\t\t\t\t\tstart = start.nextSibling;\n\t\t\t\t\t\t\t\tif (!domUtils.isBlockElm(tmp.firstChild)) {\n\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\twhile (tmp.firstChild) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(tmp.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttmp.appendChild(p);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfrag.appendChild(tmp);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmp = me.document.createElement('span');\n\t\t\t\t\t\t\tstartParent.insertBefore(tmp, end);\n\t\t\t\t\t\t\tif (!domUtils.isBlockElm(end.firstChild)) {\n\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\twhile (end.firstChild) {\n\t\t\t\t\t\t\t\t\tp.appendChild(end.firstChild);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tend.appendChild(p);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfrag.appendChild(end);\n\t\t\t\t\t\t\tdomUtils.breakParent(tmp, startParent);\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(tmp.previousSibling)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(tmp.previousSibling);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(tmp.nextSibling)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(tmp.nextSibling)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar nodeStyle = getStyle(startParent) || domUtils.getComputedStyle(startParent, 'list-style-type') || (command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc');\n\t\t\t\t\t\t\tif (startParent.tagName.toLowerCase() == tag && nodeStyle == style) {\n\t\t\t\t\t\t\t\tfor (var i = 0, ci, tmpFrag = me.document.createDocumentFragment(); ci = frag.firstChild;) {\n\t\t\t\t\t\t\t\t\tif (domUtils.isTagNode(ci, 'ol ul')) {\n\t\t\t\t\t\t\t\t\t\t//                                  删除时，子列表不处理\n\t\t\t\t\t\t\t\t\t\t//                                  utils.each(domUtils.getElementsByTagName(ci,'li'),function(li){\n\t\t\t\t\t\t\t\t\t\t//                                        while(li.firstChild){\n\t\t\t\t\t\t\t\t\t\t//                                            tmpFrag.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t\t//                                        }\n\t\t\t\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t\t\t\t//                                    });\n\t\t\t\t\t\t\t\t\t\ttmpFrag.appendChild(ci);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twhile (ci.firstChild) {\n\n\t\t\t\t\t\t\t\t\t\t\ttmpFrag.appendChild(ci.firstChild);\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmp.parentNode.insertBefore(tmpFrag, tmp);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlist = me.document.createElement(tag);\n\t\t\t\t\t\t\t\tsetListStyle(list, style);\n\t\t\t\t\t\t\t\tlist.appendChild(frag);\n\t\t\t\t\t\t\t\ttmp.parentNode.insertBefore(list, tmp);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdomUtils.remove(tmp);\n\t\t\t\t\t\t\tlist && adjustList(list, tag, style);\n\t\t\t\t\t\t\trange.moveToBookmark(bko).select();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//开始\n\t\t\t\t\t\tif (start) {\n\t\t\t\t\t\t\twhile (start) {\n\t\t\t\t\t\t\t\ttmp = start.nextSibling;\n\t\t\t\t\t\t\t\tif (domUtils.isTagNode(start, 'ol ul')) {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(start);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar tmpfrag = me.document.createDocumentFragment(),\n\t\t\t\t\t\t\t\t\t\thasBlock = 0;\n\t\t\t\t\t\t\t\t\twhile (start.firstChild) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isBlockElm(start.firstChild)) {\n\t\t\t\t\t\t\t\t\t\t\thasBlock = 1;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ttmpfrag.appendChild(start.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!hasBlock) {\n\t\t\t\t\t\t\t\t\t\tvar tmpP = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\ttmpP.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpP);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tstart = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstartParent.parentNode.insertBefore(frag, startParent.nextSibling);\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(startParent)) {\n\t\t\t\t\t\t\t\trange.setStartBefore(startParent);\n\t\t\t\t\t\t\t\tdomUtils.remove(startParent);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.setStartAfter(startParent);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmodifyStart = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (end && domUtils.inDoc(endParent, me.document)) {\n\t\t\t\t\t\t\t//结束\n\t\t\t\t\t\t\tstart = endParent.firstChild;\n\t\t\t\t\t\t\twhile (start && start !== end) {\n\t\t\t\t\t\t\t\ttmp = start.nextSibling;\n\t\t\t\t\t\t\t\tif (domUtils.isTagNode(start, 'ol ul')) {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(start);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpfrag = me.document.createDocumentFragment();\n\t\t\t\t\t\t\t\t\thasBlock = 0;\n\t\t\t\t\t\t\t\t\twhile (start.firstChild) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isBlockElm(start.firstChild)) {\n\t\t\t\t\t\t\t\t\t\t\thasBlock = 1;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ttmpfrag.appendChild(start.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!hasBlock) {\n\t\t\t\t\t\t\t\t\t\ttmpP = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\ttmpP.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpP);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstart = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tmpDiv = domUtils.createElement(me.document, 'div', {\n\t\t\t\t\t\t\t\t'tmpDiv': 1\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tdomUtils.moveChild(end, tmpDiv);\n\n\t\t\t\t\t\t\tfrag.appendChild(tmpDiv);\n\t\t\t\t\t\t\tdomUtils.remove(end);\n\t\t\t\t\t\t\tendParent.parentNode.insertBefore(frag, endParent);\n\t\t\t\t\t\t\trange.setEndBefore(endParent);\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(endParent)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(endParent);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmodifyEnd = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!modifyStart) {\n\t\t\t\t\t\trange.setStartBefore(me.document.getElementById(bko.start));\n\t\t\t\t\t}\n\t\t\t\t\tif (bko.end && !modifyEnd) {\n\t\t\t\t\t\trange.setEndAfter(me.document.getElementById(bko.end));\n\t\t\t\t\t}\n\t\t\t\t\trange.enlarge(true, function(node) {\n\t\t\t\t\t\treturn notExchange[node.tagName];\n\t\t\t\t\t});\n\n\t\t\t\t\tfrag = me.document.createDocumentFragment();\n\n\t\t\t\t\tvar bk = range.createBookmark(),\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bk.start, false, filterFn),\n\t\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\t\ttmpNode,\n\t\t\t\t\t\tblock = domUtils.isBlockElm;\n\n\t\t\t\t\twhile (current && current !== bk.end && (domUtils.getPosition(current, bk.end) & domUtils.POSITION_PRECEDING)) {\n\n\t\t\t\t\t\tif (current.nodeType == 3 || dtd.li[current.tagName]) {\n\t\t\t\t\t\t\tif (current.nodeType == 1 && dtd.$list[current.tagName]) {\n\t\t\t\t\t\t\t\twhile (current.firstChild) {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(current.firstChild);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmpNode = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t\t\tcurrent = tmpNode;\n\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\n\t\t\t\t\t\t\twhile (current && current !== bk.end && (!block(current) || domUtils.isBookmarkNode(current))) {\n\t\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\treturn !notExchange[node.tagName];\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (current && block(current)) {\n\t\t\t\t\t\t\t\ttmp = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\t\t\t\t\t\t\t\tif (tmp && domUtils.isBookmarkNode(tmp)) {\n\t\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(tmp, false, filterFn);\n\t\t\t\t\t\t\t\t\ttmpNode = tmp;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\n\t\t\t\t\t\t\tvar li = range.document.createElement('li');\n\n\t\t\t\t\t\t\tli.appendChild(tmpRange.extractContents());\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(li)) {\n\t\t\t\t\t\t\t\tvar tmpNode = range.document.createElement('p');\n\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\ttmpNode.appendChild(li.firstChild)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tli.appendChild(tmpNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfrag.appendChild(li);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bk).collapse(true);\n\t\t\t\t\tlist = me.document.createElement(tag);\n\t\t\t\t\tsetListStyle(list, style);\n\t\t\t\t\tlist.appendChild(frag);\n\t\t\t\t\trange.insertNode(list);\n\t\t\t\t\t//当前list上下看能否合并\n\t\t\t\t\tadjustList(list, tag, style);\n\t\t\t\t\t//去掉冗余的tmpDiv\n\t\t\t\t\tfor (var i = 0, ci, tmpDivs = domUtils.getElementsByTagName(list, 'div'); ci = tmpDivs[i++];) {\n\t\t\t\t\t\tif (ci.getAttribute('tmpDiv')) {\n\t\t\t\t\t\t\tdomUtils.remove(ci, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bko).select();\n\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function(command) {\n\t\t\t\t\tvar tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t\t\t\t\tvar path = this.selection.getStartElementPath();\n\t\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\t\tif (ci.nodeName == 'TABLE') {\n\t\t\t\t\t\t\treturn 0\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tag == ci.nodeName.toLowerCase()) {\n\t\t\t\t\t\t\treturn 1\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function(command) {\n\t\t\t\t\tvar tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t\t\t\t\tvar path = this.selection.getStartElementPath(),\n\t\t\t\t\t\tnode;\n\t\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\t\tif (ci.nodeName == 'TABLE') {\n\t\t\t\t\t\t\tnode = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tag == ci.nodeName.toLowerCase()) {\n\t\t\t\t\t\t\tnode = ci;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn node ? getStyle(node) || domUtils.getComputedStyle(node, 'list-style-type') : null;\n\t\t\t\t}\n\t\t\t};\n\t};\n\n\t// plugins/source.js\n\t/**\n\t * 源码编辑插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t(function() {\n\t\tvar sourceEditors = {\n\t\t\ttextarea: function(editor, holder) {\n\t\t\t\tvar textarea = holder.ownerDocument.createElement('textarea');\n\t\t\t\ttextarea.style.cssText = 'position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;';\n\t\t\t\t// todo: IE下只有onresize属性可用... 很纠结\n\t\t\t\tif (browser.ie && browser.version < 8) {\n\t\t\t\t\ttextarea.style.width = holder.offsetWidth + 'px';\n\t\t\t\t\ttextarea.style.height = holder.offsetHeight + 'px';\n\t\t\t\t\tholder.onresize = function() {\n\t\t\t\t\t\ttextarea.style.width = holder.offsetWidth + 'px';\n\t\t\t\t\t\ttextarea.style.height = holder.offsetHeight + 'px';\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tholder.appendChild(textarea);\n\t\t\t\treturn {\n\t\t\t\t\tsetContent: function(content) {\n\t\t\t\t\t\ttextarea.value = content;\n\t\t\t\t\t},\n\t\t\t\t\tgetContent: function() {\n\t\t\t\t\t\treturn textarea.value;\n\t\t\t\t\t},\n\t\t\t\t\tselect: function() {\n\t\t\t\t\t\tvar range;\n\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\trange = textarea.createTextRange();\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//todo: chrome下无法设置焦点\n\t\t\t\t\t\t\ttextarea.setSelectionRange(0, 0);\n\t\t\t\t\t\t\ttextarea.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tdispose: function() {\n\t\t\t\t\t\tholder.removeChild(textarea);\n\t\t\t\t\t\t// todo\n\t\t\t\t\t\tholder.onresize = null;\n\t\t\t\t\t\ttextarea = null;\n\t\t\t\t\t\tholder = null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tcodemirror: function(editor, holder) {\n\n\t\t\t\tvar codeEditor = window.CodeMirror(holder, {\n\t\t\t\t\tmode: \"text/html\",\n\t\t\t\t\ttabMode: \"indent\",\n\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\tlineWrapping: true\n\t\t\t\t});\n\t\t\t\tvar dom = codeEditor.getWrapperElement();\n\t\t\t\tdom.style.cssText = 'position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,\"Courier new\",monospace;font-size:13px;';\n\t\t\t\tcodeEditor.getScrollerElement().style.cssText = 'position:absolute;left:0;top:0;width:100%;height:100%;';\n\t\t\t\tcodeEditor.refresh();\n\t\t\t\treturn {\n\t\t\t\t\tgetCodeMirror: function() {\n\t\t\t\t\t\treturn codeEditor;\n\t\t\t\t\t},\n\t\t\t\t\tsetContent: function(content) {\n\t\t\t\t\t\tcodeEditor.setValue(content);\n\t\t\t\t\t},\n\t\t\t\t\tgetContent: function() {\n\t\t\t\t\t\treturn codeEditor.getValue();\n\t\t\t\t\t},\n\t\t\t\t\tselect: function() {\n\t\t\t\t\t\tcodeEditor.focus();\n\t\t\t\t\t},\n\t\t\t\t\tdispose: function() {\n\t\t\t\t\t\tholder.removeChild(dom);\n\t\t\t\t\t\tdom = null;\n\t\t\t\t\t\tcodeEditor = null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tUE.plugins['source'] = function() {\n\t\t\tvar me = this;\n\t\t\tvar opt = this.options;\n\t\t\tvar sourceMode = false;\n\t\t\tvar sourceEditor;\n\t\t\tvar orgSetContent;\n\t\t\topt.sourceEditor = browser.ie ? 'textarea' : (opt.sourceEditor || 'codemirror');\n\n\t\t\tme.setOpt({\n\t\t\t\tsourceEditorFirst: false\n\t\t\t});\n\n\t\t\tfunction createSourceEditor(holder) {\n\t\t\t\treturn sourceEditors[opt.sourceEditor == 'codemirror' && window.CodeMirror ? 'codemirror' : 'textarea'](me, holder);\n\t\t\t}\n\n\t\t\tvar bakCssText;\n\t\t\t//解决在源码模式下getContent不能得到最新的内容问题\n\t\t\tvar oldGetContent,\n\t\t\t\tbakAddress;\n\n\t\t\t/**\n\t\t\t * 切换源码模式和编辑模式\n\t\t\t * @command source\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'source');\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 查询当前编辑区域的状态是源码模式还是可视化模式\n\t\t\t * @command source\n\t\t\t * @method queryCommandState\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @return { int } 如果当前是源码编辑模式，返回1，否则返回0\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState( 'source' );\n\t\t\t * ```\n\t\t\t */\n\n\t\t\tme.commands['source'] = {\n\t\t\t\texecCommand: function() {\n\n\t\t\t\t\tsourceMode = !sourceMode;\n\t\t\t\t\tif (sourceMode) {\n\t\t\t\t\t\tbakAddress = me.selection.getRange().createAddress(false, true);\n\t\t\t\t\t\tme.undoManger && me.undoManger.save(true);\n\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbakCssText = me.iframe.style.cssText;\n\t\t\t\t\t\tme.iframe.style.cssText += 'position:absolute;left:-32768px;top:-32768px;';\n\n\t\t\t\t\t\tme.fireEvent('beforegetcontent');\n\t\t\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML);\n\t\t\t\t\t\tme.filterOutputRule(root);\n\t\t\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\t\t\t\tcase 'td':\n\t\t\t\t\t\t\t\t\tcase 'th':\n\t\t\t\t\t\t\t\t\tcase 'caption':\n\t\t\t\t\t\t\t\t\t\tif (node.children && node.children.length == 1) {\n\t\t\t\t\t\t\t\t\t\t\tif (node.firstChild().tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\tnode.removeChild(node.firstChild())\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'pre':\n\t\t\t\t\t\t\t\t\t\tnode.innerText(node.innerText().replace(/&nbsp;/g, ' '))\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tme.fireEvent('aftergetcontent');\n\n\t\t\t\t\t\tvar content = root.toHtml(true);\n\n\t\t\t\t\t\tsourceEditor = createSourceEditor(me.iframe.parentNode);\n\n\t\t\t\t\t\tsourceEditor.setContent(content);\n\n\t\t\t\t\t\torgSetContent = me.setContent;\n\n\t\t\t\t\t\tme.setContent = function(html) {\n\t\t\t\t\t\t\t//这里暂时不触发事件，防止报错\n\t\t\t\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t\t\t\tme.filterInputRule(root);\n\t\t\t\t\t\t\thtml = root.toHtml();\n\t\t\t\t\t\t\tsourceEditor.setContent(html);\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tsourceEditor.select();\n\t\t\t\t\t\t\tme.addListener('fullscreenchanged', function() {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tsourceEditor.getCodeMirror().refresh()\n\t\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t//重置getContent，源码模式下取值也能是最新的数据\n\t\t\t\t\t\toldGetContent = me.getContent;\n\t\t\t\t\t\tme.getContent = function() {\n\t\t\t\t\t\t\treturn sourceEditor.getContent() || '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.iframe.style.cssText = bakCssText;\n\t\t\t\t\t\tvar cont = sourceEditor.getContent() || '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t//处理掉block节点前后的空格,有可能会误命中，暂时不考虑\n\t\t\t\t\t\tcont = cont.replace(new RegExp('[\\\\r\\\\t\\\\n ]*<\\/?(\\\\w+)\\\\s*(?:[^>]*)>', 'g'), function(a, b) {\n\t\t\t\t\t\t\tif (b && !dtd.$inlineWithA[b.toLowerCase()]) {\n\t\t\t\t\t\t\t\treturn a.replace(/(^[\\n\\r\\t ]*)|([\\n\\r\\t ]*$)/g, '');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn a.replace(/(^[\\n\\r\\t]*)|([\\n\\r\\t]*$)/g, '')\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tme.setContent = orgSetContent;\n\n\t\t\t\t\t\tme.setContent(cont);\n\t\t\t\t\t\tsourceEditor.dispose();\n\t\t\t\t\t\tsourceEditor = null;\n\t\t\t\t\t\t//还原getContent方法\n\t\t\t\t\t\tme.getContent = oldGetContent;\n\t\t\t\t\t\tvar first = me.body.firstChild;\n\t\t\t\t\t\t//trace:1106 都删除空了，下边会报错，所以补充一个p占位\n\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\tfirst = me.body.firstChild;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//要在ifm为显示时ff才能取到selection,否则报错\n\t\t\t\t\t\t//这里不能比较位置了\n\t\t\t\t\t\tme.undoManger && me.undoManger.save(true);\n\n\t\t\t\t\t\tif (browser.gecko) {\n\n\t\t\t\t\t\t\tvar input = document.createElement('input');\n\t\t\t\t\t\t\tinput.style.cssText = 'position:absolute;left:0;top:-32768px';\n\n\t\t\t\t\t\t\tdocument.body.appendChild(input);\n\n\t\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tdomUtils.setViewportOffset(input, {\n\t\t\t\t\t\t\t\t\tleft: -32768,\n\t\t\t\t\t\t\t\t\ttop: 0\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\t\t\t\t\tme.selection.getRange().moveToAddress(bakAddress).select(true);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(input);\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//ie下有可能报错，比如在代码顶头的情况\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tme.selection.getRange().moveToAddress(bakAddress).select(true);\n\t\t\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.fireEvent('sourcemodechanged', sourceMode);\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn sourceMode | 0;\n\t\t\t\t},\n\t\t\t\tnotNeedUndo: 1\n\t\t\t};\n\t\t\tvar oldQueryCommandState = me.queryCommandState;\n\n\t\t\tme.queryCommandState = function(cmdName) {\n\t\t\t\tcmdName = cmdName.toLowerCase();\n\t\t\t\tif (sourceMode) {\n\t\t\t\t\t//源码模式下可以开启的命令\n\t\t\t\t\treturn cmdName in {\n\t\t\t\t\t\t'source': 1,\n\t\t\t\t\t\t'fullscreen': 1\n\t\t\t\t\t} ? 1 : -1\n\t\t\t\t}\n\t\t\t\treturn oldQueryCommandState.apply(this, arguments);\n\t\t\t};\n\n\t\t\tif (opt.sourceEditor == \"codemirror\") {\n\n\t\t\t\tme.addListener(\"ready\", function() {\n\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\tsrc: opt.codeMirrorJsUrl || opt.UEDITOR_HOME_URL + \"third-party/codemirror/codemirror.js\",\n\t\t\t\t\t\ttag: \"script\",\n\t\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t\t}, function() {\n\t\t\t\t\t\tif (opt.sourceEditorFirst) {\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tme.execCommand(\"source\");\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\ttag: \"link\",\n\t\t\t\t\t\trel: \"stylesheet\",\n\t\t\t\t\t\ttype: \"text/css\",\n\t\t\t\t\t\thref: opt.codeMirrorCssUrl || opt.UEDITOR_HOME_URL + \"third-party/codemirror/codemirror.css\"\n\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t}\n\n\t\t};\n\n\t})();\n\n\t// plugins/enterkey.js\n\t///import core\n\t///import plugins/undo.js\n\t///commands 设置回车标签p或br\n\t///commandsName  EnterKey\n\t///commandsTitle  设置回车标签p或br\n\t/**\n\t * @description 处理回车\n\t * @author zhanyi\n\t */\n\tUE.plugins['enterkey'] = function() {\n\t\tvar hTag,\n\t\t\tme = this,\n\t\t\ttag = me.options.enterTag;\n\t\tme.addListener('keyup', function(type, evt) {\n\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13) {\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\tstart = range.startContainer,\n\t\t\t\t\tdoSave;\n\n\t\t\t\t//修正在h1-h6里边回车后不能嵌套p的问题\n\t\t\t\tif (!browser.ie) {\n\n\t\t\t\t\tif (/h\\d/i.test(hTag)) {\n\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\tvar h = domUtils.findParentByTagName(start, ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'caption', 'table'], true);\n\t\t\t\t\t\t\tif (!h) {\n\t\t\t\t\t\t\t\tme.document.execCommand('formatBlock', false, '<p>');\n\t\t\t\t\t\t\t\tdoSave = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//chrome remove div\n\t\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\t\tvar tmp = me.document.createTextNode(''),\n\t\t\t\t\t\t\t\t\tdiv;\n\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\tdiv = domUtils.findParentByTagName(tmp, 'div', true);\n\t\t\t\t\t\t\t\tif (div) {\n\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\twhile (div.firstChild) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(div.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdiv.parentNode.insertBefore(p, div);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(div);\n\t\t\t\t\t\t\t\t\trange.setStartBefore(tmp).setCursor();\n\t\t\t\t\t\t\t\t\tdoSave = 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(tmp);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (me.undoManger && doSave) {\n\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//没有站位符，会出现多行的问题\n\t\t\t\t\tbrowser.opera && range.select();\n\t\t\t\t} else {\n\t\t\t\t\tme.fireEvent('saveScene', true, true)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('keydown', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13) { //回车\n\t\t\t\tif (me.fireEvent('beforeenterkeydown')) {\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tme.fireEvent('saveScene', true, true);\n\t\t\t\thTag = '';\n\n\t\t\t\tvar range = me.selection.getRange();\n\n\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t//跨td不能删\n\t\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\t\tend = range.endContainer,\n\t\t\t\t\t\tstartTd = domUtils.findParentByTagName(start, 'td', true),\n\t\t\t\t\t\tendTd = domUtils.findParentByTagName(end, 'td', true);\n\t\t\t\t\tif (startTd && endTd && startTd !== endTd || !startTd && endTd || startTd && !endTd) {\n\t\t\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (tag == 'p') {\n\n\t\t\t\t\tif (!browser.ie) {\n\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, ['ol', 'ul', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'caption'], true);\n\n\t\t\t\t\t\t//opera下执行formatblock会在table的场景下有问题，回车在opera原生支持很好，所以暂时在opera去掉调用这个原生的command\n\t\t\t\t\t\t//trace:2431\n\t\t\t\t\t\tif (!start && !browser.opera) {\n\n\t\t\t\t\t\t\tme.document.execCommand('formatBlock', false, '<p>');\n\n\t\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'p', true);\n\t\t\t\t\t\t\t\tstart && domUtils.removeDirtyAttr(start);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thTag = start.tagName;\n\t\t\t\t\t\t\tstart.tagName.toLowerCase() == 'p' && browser.gecko && domUtils.removeDirtyAttr(start);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\tif (start.nodeType == 1 && (start = start.childNodes[range.startOffset])) {\n\t\t\t\t\t\t\twhile (start.nodeType == 1) {\n\t\t\t\t\t\t\t\tif (dtd.$empty[start.tagName]) {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(start).setCursor();\n\t\t\t\t\t\t\t\t\tif (me.undoManger) {\n\t\t\t\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!start.firstChild) {\n\t\t\t\t\t\t\t\t\tvar br = range.document.createElement('br');\n\t\t\t\t\t\t\t\t\tstart.appendChild(br);\n\t\t\t\t\t\t\t\t\trange.setStart(start, 0).setCursor();\n\t\t\t\t\t\t\t\t\tif (me.undoManger) {\n\t\t\t\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstart = start.firstChild;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (start === range.startContainer.childNodes[range.startOffset]) {\n\t\t\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\t\t\trange.insertNode(br).setCursor();\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.setStart(start, 0).setCursor();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\t\trange.insertNode(br).setStartAfter(br).setCursor();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\trange.insertNode(br);\n\t\t\t\t\t\tvar parent = br.parentNode;\n\t\t\t\t\t\tif (parent.lastChild === br) {\n\t\t\t\t\t\t\tbr.parentNode.insertBefore(br.cloneNode(true), br);\n\t\t\t\t\t\t\trange.setStartBefore(br);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.setStartAfter(br);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setCursor();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/keystrokes.js\n\t/* 处理特殊键的兼容性问题 */\n\tUE.plugins['keystrokes'] = function() {\n\t\tvar me = this;\n\t\tvar collapsed = true;\n\t\tme.addListener('keydown', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which,\n\t\t\t\trng = me.selection.getRange();\n\n\t\t\t//处理全选的情况\n\t\t\tif (!rng.collapsed && !(evt.ctrlKey || evt.shiftKey || evt.altKey || evt.metaKey) && (keyCode >= 65 && keyCode <= 90 || keyCode >= 48 && keyCode <= 57 ||\n\t\t\t\t\tkeyCode >= 96 && keyCode <= 111 || {\n\t\t\t\t\t\t13: 1,\n\t\t\t\t\t\t8: 1,\n\t\t\t\t\t\t46: 1\n\t\t\t\t\t}[keyCode])) {\n\n\t\t\t\tvar tmpNode = rng.startContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trng.setStartBefore(tmpNode)\n\t\t\t\t}\n\t\t\t\ttmpNode = rng.endContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trng.setEndAfter(tmpNode)\n\t\t\t\t}\n\t\t\t\trng.txtToElmBoundary();\n\t\t\t\t//结束边界可能放到了br的前边，要把br包含进来\n\t\t\t\t// x[xxx]<br/>\n\t\t\t\tif (rng.endContainer && rng.endContainer.nodeType == 1) {\n\t\t\t\t\ttmpNode = rng.endContainer.childNodes[rng.endOffset];\n\t\t\t\t\tif (tmpNode && domUtils.isBr(tmpNode)) {\n\t\t\t\t\t\trng.setEndAfter(tmpNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (rng.startOffset == 0) {\n\t\t\t\t\ttmpNode = rng.startContainer;\n\t\t\t\t\tif (domUtils.isBoundaryNode(tmpNode, 'firstChild')) {\n\t\t\t\t\t\ttmpNode = rng.endContainer;\n\t\t\t\t\t\tif (rng.endOffset == (tmpNode.nodeType == 3 ? tmpNode.nodeValue.length : tmpNode.childNodes.length) && domUtils.isBoundaryNode(tmpNode, 'lastChild')) {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\trng.setStart(me.body.firstChild, 0).setCursor(false, true);\n\t\t\t\t\t\t\tme._selectionChange();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//处理backspace\n\t\t\tif (keyCode == keymap.Backspace) {\n\t\t\t\trng = me.selection.getRange();\n\t\t\t\tcollapsed = rng.collapsed;\n\t\t\t\tif (me.fireEvent('delkeydown', evt)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar start, end;\n\t\t\t\t//避免按两次删除才能生效的问题\n\t\t\t\tif (rng.collapsed && rng.inFillChar()) {\n\t\t\t\t\tstart = rng.startContainer;\n\n\t\t\t\t\tif (domUtils.isFillChar(start)) {\n\t\t\t\t\t\trng.setStartBefore(start).shrinkBoundary(true).collapse(true);\n\t\t\t\t\t\tdomUtils.remove(start)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.nodeValue = start.nodeValue.replace(new RegExp('^' + domUtils.fillChar), '');\n\t\t\t\t\t\trng.startOffset--;\n\t\t\t\t\t\trng.collapse(true).select(true)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//解决选中control元素不能删除的问题\n\t\t\t\tif (start = rng.getClosedNode()) {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\trng.setStartBefore(start);\n\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\trng.setCursor();\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//阻止在table上的删除\n\t\t\t\tif (!browser.ie) {\n\t\t\t\t\tstart = domUtils.findParentByTagName(rng.startContainer, 'table', true);\n\t\t\t\t\tend = domUtils.findParentByTagName(rng.endContainer, 'table', true);\n\t\t\t\t\tif (start && !end || !start && end || start !== end) {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\t//处理tab键的逻辑\n\t\t\tif (keyCode == keymap.Tab) {\n\t\t\t\t//不处理以下标签\n\t\t\t\tvar excludeTagNameForTabKey = {\n\t\t\t\t\t'ol': 1,\n\t\t\t\t\t'ul': 1,\n\t\t\t\t\t'table': 1\n\t\t\t\t};\n\t\t\t\t//处理组件里的tab按下事件\n\t\t\t\tif (me.fireEvent('tabkeydown', evt)) {\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\tfor (var i = 0, txt = '', tabSize = me.options.tabSize || 4, tabNode = me.options.tabNode || '&nbsp;'; i < tabSize; i++) {\n\t\t\t\t\ttxt += tabNode;\n\t\t\t\t}\n\t\t\t\tvar span = me.document.createElement('span');\n\t\t\t\tspan.innerHTML = txt + domUtils.fillChar;\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\trange.insertNode(span.cloneNode(true).firstChild).setCursor(true);\n\t\t\t\t} else {\n\t\t\t\t\tvar filterFn = function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node) && !excludeTagNameForTabKey[node.tagName.toLowerCase()]\n\n\t\t\t\t\t};\n\t\t\t\t\t//普通的情况\n\t\t\t\t\tstart = domUtils.findParent(range.startContainer, filterFn, true);\n\t\t\t\t\tend = domUtils.findParent(range.endContainer, filterFn, true);\n\t\t\t\t\tif (start && end && start === end) {\n\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\trange.insertNode(span.cloneNode(true).firstChild).setCursor(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar bookmark = range.createBookmark();\n\t\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn);\n\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\tcurrent.insertBefore(span.cloneNode(true).firstChild, current.firstChild);\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.moveToBookmark(bookmark2).moveToBookmark(bookmark).select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdomUtils.preventDefault(evt)\n\t\t\t}\n\t\t\t//trace:1634\n\t\t\t//ff的del键在容器空的时候，也会删除\n\t\t\tif (browser.gecko && keyCode == 46) {\n\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\tif (domUtils.isEmptyBlock(start)) {\n\t\t\t\t\t\tvar parent = start.parentNode;\n\t\t\t\t\t\twhile (domUtils.getChildCount(parent) == 1 && !domUtils.isBody(parent)) {\n\t\t\t\t\t\t\tstart = parent;\n\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (start === parent.lastChild)\n\t\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which,\n\t\t\t\trng, me = this;\n\t\t\tif (keyCode == keymap.Backspace) {\n\t\t\t\tif (me.fireEvent('delkeyup')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\trng = me.selection.getRange();\n\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\tvar tmpNode,\n\t\t\t\t\t\tautoClearTagName = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\t\t\t\t\tif (tmpNode = domUtils.findParentByTagName(rng.startContainer, autoClearTagName, true)) {\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\t\t\t\tvar pre = tmpNode.previousSibling;\n\t\t\t\t\t\t\tif (pre && pre.nodeName != 'TABLE') {\n\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\trng.setStartAtLast(pre).setCursor(false, true);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar next = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\tif (next && next.nodeName != 'TABLE') {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\trng.setStartAtFirst(next).setCursor(false, true);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//处理当删除到body时，要重新给p标签展位\n\t\t\t\t\tif (domUtils.isBody(rng.startContainer)) {\n\t\t\t\t\t\tvar tmpNode = domUtils.createElement(me.document, 'p', {\n\t\t\t\t\t\t\t'innerHTML': browser.ie ? domUtils.fillChar : '<br/>'\n\t\t\t\t\t\t});\n\t\t\t\t\t\trng.insertNode(tmpNode).setStart(tmpNode, 0).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//chrome下如果删除了inline标签，浏览器会有记忆，在输入文字还是会套上刚才删除的标签，所以这里再选一次就不会了\n\t\t\t\tif (!collapsed && (rng.startContainer.nodeType == 3 || rng.startContainer.nodeType == 1 && domUtils.isEmptyBlock(rng.startContainer))) {\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\tvar span = rng.document.createElement('span');\n\t\t\t\t\t\trng.insertNode(span).setStartBefore(span).collapse(true);\n\t\t\t\t\t\trng.select();\n\t\t\t\t\t\tdomUtils.remove(span)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.select()\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t})\n\t};\n\n\t// plugins/fiximgclick.js\n\t///import core\n\t///commands 修复chrome下图片不能点击的问题，出现八个角可改变大小\n\t///commandsName  FixImgClick\n\t///commandsTitle  修复chrome下图片不能点击的问题，出现八个角可改变大小\n\t//修复chrome下图片不能点击的问题，出现八个角可改变大小\n\n\tUE.plugins['fiximgclick'] = (function() {\n\n\t\tvar elementUpdated = false;\n\n\t\tfunction Scale() {\n\t\t\tthis.editor = null;\n\t\t\tthis.resizer = null;\n\t\t\tthis.cover = null;\n\t\t\tthis.doc = document;\n\t\t\tthis.prePos = {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t};\n\t\t\tthis.startPos = {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t};\n\t\t}\n\n\t\t(function() {\n\t\t\tvar rect = [\n\t\t\t\t//[left, top, width, height]\n\t\t\t\t[0, 0, -1, -1],\n\t\t\t\t[0, 0, 0, -1],\n\t\t\t\t[0, 0, 1, -1],\n\t\t\t\t[0, 0, -1, 0],\n\t\t\t\t[0, 0, 1, 0],\n\t\t\t\t[0, 0, -1, 1],\n\t\t\t\t[0, 0, 0, 1],\n\t\t\t\t[0, 0, 1, 1]\n\t\t\t];\n\n\t\t\tScale.prototype = {\n\t\t\t\tinit: function(editor) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.editor = editor;\n\t\t\t\t\tme.startPos = this.prePos = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t};\n\t\t\t\t\tme.dragId = -1;\n\n\t\t\t\t\tvar hands = [],\n\t\t\t\t\t\tcover = me.cover = document.createElement('div'),\n\t\t\t\t\t\tresizer = me.resizer = document.createElement('div');\n\n\t\t\t\t\tcover.id = me.editor.ui.id + '_imagescale_cover';\n\t\t\t\t\tcover.style.cssText = 'position:absolute;display:none;z-index:' + (me.editor.options.zIndex) + ';filter:alpha(opacity=0); opacity:0;background:#CCC;';\n\t\t\t\t\tdomUtils.on(cover, 'mousedown click', function() {\n\t\t\t\t\t\tme.hide();\n\t\t\t\t\t});\n\n\t\t\t\t\tfor (i = 0; i < 8; i++) {\n\t\t\t\t\t\thands.push('<span class=\"edui-editor-imagescale-hand' + i + '\"></span>');\n\t\t\t\t\t}\n\t\t\t\t\tresizer.id = me.editor.ui.id + '_imagescale';\n\t\t\t\t\tresizer.className = 'edui-editor-imagescale';\n\t\t\t\t\tresizer.innerHTML = hands.join('');\n\t\t\t\t\tresizer.style.cssText += ';display:none;border:1px solid #3b77ff;z-index:' + (me.editor.options.zIndex) + ';';\n\n\t\t\t\t\tme.editor.ui.getDom().appendChild(cover);\n\t\t\t\t\tme.editor.ui.getDom().appendChild(resizer);\n\n\t\t\t\t\tme.initStyle();\n\t\t\t\t\tme.initEvents();\n\t\t\t\t},\n\t\t\t\tinitStyle: function() {\n\t\t\t\t\tutils.cssRule('imagescale', '.edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}' +\n\t\t\t\t\t\t'.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}');\n\t\t\t\t},\n\t\t\t\tinitEvents: function() {\n\t\t\t\t\tvar me = this;\n\n\t\t\t\t\tme.startPos.x = me.startPos.y = 0;\n\t\t\t\t\tme.isDraging = false;\n\t\t\t\t},\n\t\t\t\t_eventHandler: function(e) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tswitch (e.type) {\n\t\t\t\t\t\tcase 'mousedown':\n\t\t\t\t\t\t\tvar hand = e.target || e.srcElement,\n\t\t\t\t\t\t\t\thand;\n\t\t\t\t\t\t\tif (hand.className.indexOf('edui-editor-imagescale-hand') != -1 && me.dragId == -1) {\n\t\t\t\t\t\t\t\tme.dragId = hand.className.slice(-1);\n\t\t\t\t\t\t\t\tme.startPos.x = me.prePos.x = e.clientX;\n\t\t\t\t\t\t\t\tme.startPos.y = me.prePos.y = e.clientY;\n\t\t\t\t\t\t\t\tdomUtils.on(me.doc, 'mousemove', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mousemove':\n\t\t\t\t\t\t\tif (me.dragId != -1) {\n\t\t\t\t\t\t\t\tme.updateContainerStyle(me.dragId, {\n\t\t\t\t\t\t\t\t\tx: e.clientX - me.prePos.x,\n\t\t\t\t\t\t\t\t\ty: e.clientY - me.prePos.y\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tme.prePos.x = e.clientX;\n\t\t\t\t\t\t\t\tme.prePos.y = e.clientY;\n\t\t\t\t\t\t\t\telementUpdated = true;\n\t\t\t\t\t\t\t\tme.updateTargetElement();\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mouseup':\n\t\t\t\t\t\t\tif (me.dragId != -1) {\n\t\t\t\t\t\t\t\tme.updateContainerStyle(me.dragId, {\n\t\t\t\t\t\t\t\t\tx: e.clientX - me.prePos.x,\n\t\t\t\t\t\t\t\t\ty: e.clientY - me.prePos.y\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tme.updateTargetElement();\n\t\t\t\t\t\t\t\tif (me.target.parentNode) me.attachTo(me.target);\n\t\t\t\t\t\t\t\tme.dragId = -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.un(me.doc, 'mousemove', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\t\t//修复只是点击挪动点，但没有改变大小，不应该触发contentchange\n\t\t\t\t\t\t\tif (elementUpdated) {\n\t\t\t\t\t\t\t\telementUpdated = false;\n\t\t\t\t\t\t\t\tme.editor.fireEvent('contentchange');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tupdateTargetElement: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tdomUtils.setStyles(me.target, {\n\t\t\t\t\t\t'width': me.resizer.style.width,\n\t\t\t\t\t\t'height': me.resizer.style.height\n\t\t\t\t\t});\n\t\t\t\t\tme.target.width = parseInt(me.resizer.style.width);\n\t\t\t\t\tme.target.height = parseInt(me.resizer.style.height);\n\t\t\t\t\tme.attachTo(me.target);\n\t\t\t\t},\n\t\t\t\tupdateContainerStyle: function(dir, offset) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tdom = me.resizer,\n\t\t\t\t\t\ttmp;\n\n\t\t\t\t\tif (rect[dir][0] != 0) {\n\t\t\t\t\t\ttmp = parseInt(dom.style.left) + offset.x;\n\t\t\t\t\t\tdom.style.left = me._validScaledProp('left', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (rect[dir][1] != 0) {\n\t\t\t\t\t\ttmp = parseInt(dom.style.top) + offset.y;\n\t\t\t\t\t\tdom.style.top = me._validScaledProp('top', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (rect[dir][2] != 0) {\n\t\t\t\t\t\ttmp = dom.clientWidth + rect[dir][2] * offset.x;\n\t\t\t\t\t\tdom.style.width = me._validScaledProp('width', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (rect[dir][3] != 0) {\n\t\t\t\t\t\ttmp = dom.clientHeight + rect[dir][3] * offset.y;\n\t\t\t\t\t\tdom.style.height = me._validScaledProp('height', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_validScaledProp: function(prop, value) {\n\t\t\t\t\tvar ele = this.resizer,\n\t\t\t\t\t\twrap = document;\n\n\t\t\t\t\tvalue = isNaN(value) ? 0 : value;\n\t\t\t\t\tswitch (prop) {\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\treturn value < 0 ? 0 : (value + ele.clientWidth) > wrap.clientWidth ? wrap.clientWidth - ele.clientWidth : value;\n\t\t\t\t\t\tcase 'top':\n\t\t\t\t\t\t\treturn value < 0 ? 0 : (value + ele.clientHeight) > wrap.clientHeight ? wrap.clientHeight - ele.clientHeight : value;\n\t\t\t\t\t\tcase 'width':\n\t\t\t\t\t\t\treturn value <= 0 ? 1 : (value + ele.offsetLeft) > wrap.clientWidth ? wrap.clientWidth - ele.offsetLeft : value;\n\t\t\t\t\t\tcase 'height':\n\t\t\t\t\t\t\treturn value <= 0 ? 1 : (value + ele.offsetTop) > wrap.clientHeight ? wrap.clientHeight - ele.offsetTop : value;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\thideCover: function() {\n\t\t\t\t\tthis.cover.style.display = 'none';\n\t\t\t\t},\n\t\t\t\tshowCover: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\teditorPos = domUtils.getXY(me.editor.ui.getDom()),\n\t\t\t\t\t\tiframePos = domUtils.getXY(me.editor.iframe);\n\n\t\t\t\t\tdomUtils.setStyles(me.cover, {\n\t\t\t\t\t\t'width': me.editor.iframe.offsetWidth + 'px',\n\t\t\t\t\t\t'height': me.editor.iframe.offsetHeight + 'px',\n\t\t\t\t\t\t'top': iframePos.y - editorPos.y + 'px',\n\t\t\t\t\t\t'left': iframePos.x - editorPos.x + 'px',\n\t\t\t\t\t\t'position': 'absolute',\n\t\t\t\t\t\t'display': ''\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tshow: function(targetObj) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.resizer.style.display = 'block';\n\t\t\t\t\tif (targetObj) me.attachTo(targetObj);\n\n\t\t\t\t\tdomUtils.on(this.resizer, 'mousedown', me.proxy(me._eventHandler, me));\n\t\t\t\t\tdomUtils.on(me.doc, 'mouseup', me.proxy(me._eventHandler, me));\n\n\t\t\t\t\tme.showCover();\n\t\t\t\t\tme.editor.fireEvent('afterscaleshow', me);\n\t\t\t\t\tme.editor.fireEvent('saveScene');\n\t\t\t\t},\n\t\t\t\thide: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.hideCover();\n\t\t\t\t\tme.resizer.style.display = 'none';\n\n\t\t\t\t\tdomUtils.un(me.resizer, 'mousedown', me.proxy(me._eventHandler, me));\n\t\t\t\t\tdomUtils.un(me.doc, 'mouseup', me.proxy(me._eventHandler, me));\n\t\t\t\t\tme.editor.fireEvent('afterscalehide', me);\n\t\t\t\t},\n\t\t\t\tproxy: function(fn, context) {\n\t\t\t\t\treturn function(e) {\n\t\t\t\t\t\treturn fn.apply(context || this, arguments);\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tattachTo: function(targetObj) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\ttarget = me.target = targetObj,\n\t\t\t\t\t\tresizer = this.resizer,\n\t\t\t\t\t\timgPos = domUtils.getXY(target),\n\t\t\t\t\t\tiframePos = domUtils.getXY(me.editor.iframe),\n\t\t\t\t\t\teditorPos = domUtils.getXY(resizer.parentNode);\n\n\t\t\t\t\tdomUtils.setStyles(resizer, {\n\t\t\t\t\t\t'width': target.width + 'px',\n\t\t\t\t\t\t'height': target.height + 'px',\n\t\t\t\t\t\t'left': iframePos.x + imgPos.x - me.editor.document.body.scrollLeft - editorPos.x - parseInt(resizer.style.borderLeftWidth) + 'px',\n\t\t\t\t\t\t'top': iframePos.y + imgPos.y - me.editor.document.body.scrollTop - editorPos.y - parseInt(resizer.style.borderTopWidth) + 'px'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\n\t\treturn function() {\n\t\t\tvar me = this,\n\t\t\t\timageScale;\n\n\t\t\tme.setOpt('imageScaleEnabled', true);\n\n\t\t\tif (!browser.ie && me.options.imageScaleEnabled) {\n\t\t\t\tme.addListener('click', function(type, e) {\n\n\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\timg = range.getClosedNode();\n\n\t\t\t\t\tif (img && img.tagName == 'IMG' && me.body.contentEditable != \"false\") {\n\n\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-music\") != -1 ||\n\t\t\t\t\t\t\timg.getAttribute(\"anchorname\") ||\n\t\t\t\t\t\t\tdomUtils.hasClass(img, 'loadingclass') ||\n\t\t\t\t\t\t\tdomUtils.hasClass(img, 'loaderrorclass')) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!imageScale) {\n\t\t\t\t\t\t\timageScale = new Scale();\n\t\t\t\t\t\t\timageScale.init(me);\n\t\t\t\t\t\t\tme.ui.getDom().appendChild(imageScale.resizer);\n\n\t\t\t\t\t\t\tvar _keyDownHandler = function(e) {\n\t\t\t\t\t\t\t\t\timageScale.hide();\n\t\t\t\t\t\t\t\t\tif (imageScale.target) me.selection.getRange().selectNode(imageScale.target).select();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t_mouseDownHandler = function(e) {\n\t\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\t\tif (ele && (ele.className === undefined || ele.className.indexOf('edui-editor-imagescale') == -1)) {\n\t\t\t\t\t\t\t\t\t\t_keyDownHandler(e);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttimer;\n\n\t\t\t\t\t\t\tme.addListener('afterscaleshow', function(e) {\n\t\t\t\t\t\t\t\tme.addListener('beforekeydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tme.addListener('beforemousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.on(document, 'keydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.on(document, 'mousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tme.addListener('afterscalehide', function(e) {\n\t\t\t\t\t\t\t\tme.removeListener('beforekeydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tme.removeListener('beforemousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.un(document, 'keydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.un(document, 'mousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tvar target = imageScale.target;\n\t\t\t\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\t\t\t\tme.selection.getRange().selectNode(target).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t//TODO 有iframe的情况，mousedown不能往下传。。\n\t\t\t\t\t\t\tdomUtils.on(imageScale.resizer, 'mousedown', function(e) {\n\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\tif (ele && ele.className.indexOf('edui-editor-imagescale-hand') == -1) {\n\t\t\t\t\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\timageScale.hide();\n\t\t\t\t\t\t\t\t\t\tif (imageScale.target) me.selection.getRange().selectNode(ele).select();\n\t\t\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tdomUtils.on(imageScale.resizer, 'mouseup', function(e) {\n\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\tif (ele && ele.className.indexOf('edui-editor-imagescale-hand') == -1) {\n\t\t\t\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\timageScale.show(img);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (imageScale && imageScale.resizer.style.display != 'none') imageScale.hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (browser.webkit) {\n\t\t\t\tme.addListener('click', function(type, e) {\n\t\t\t\t\tif (e.target.tagName == 'IMG' && me.body.contentEditable != \"false\") {\n\t\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\t\trange.selectNode(e.target).select();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t})();\n\n\t// plugins/autolink.js\n\t///import core\n\t///commands 为非ie浏览器自动添加a标签\n\t///commandsName  AutoLink\n\t///commandsTitle  自动增加链接\n\t/**\n\t * @description 为非ie浏览器自动添加a标签\n\t * @author zhanyi\n\t */\n\n\tUE.plugin.register('autolink', function() {\n\t\tvar cont = 0;\n\n\t\treturn !browser.ie ? {\n\n\t\t\tbindEvents: {\n\t\t\t\t'reset': function() {\n\t\t\t\t\tcont = 0;\n\t\t\t\t},\n\t\t\t\t'keydown': function(type, evt) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\n\t\t\t\t\tif (keyCode == 32 || keyCode == 13) {\n\n\t\t\t\t\t\tvar sel = me.selection.getNative(),\n\t\t\t\t\t\t\trange = sel.getRangeAt(0).cloneRange(),\n\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\tcharCode;\n\n\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\twhile (start.nodeType == 1 && range.startOffset > 0) {\n\t\t\t\t\t\t\tstart = range.startContainer.childNodes[range.startOffset - 1];\n\t\t\t\t\t\t\tif (!start) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.setStart(start, start.nodeType == 1 ? start.childNodes.length : start.nodeValue.length);\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\t\t\t\tstart = range.startContainer.previousSibling;\n\n\t\t\t\t\t\t\t\twhile (start && start.nodeType == 1) {\n\t\t\t\t\t\t\t\t\tstart = start.lastChild;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!start || domUtils.isFillChar(start)) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\toffset = start.nodeValue.length;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t\t\toffset = range.startOffset;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.setStart(start, offset - 1);\n\t\t\t\t\t\t\tcharCode = range.toString().charCodeAt(0);\n\t\t\t\t\t\t} while (charCode != 160 && charCode != 32);\n\n\t\t\t\t\t\tif (range.toString().replace(new RegExp(domUtils.fillChar, 'g'), '').match(/(?:https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.)/i)) {\n\t\t\t\t\t\t\twhile (range.toString().length) {\n\t\t\t\t\t\t\t\tif (/^(?:https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.)/i.test(range.toString())) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\trange.setStart(range.startContainer, range.startOffset + 1);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\t//trace:2121\n\t\t\t\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\t\t\t\twhile (!(next = start.nextSibling)) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isBody(start)) {\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tstart = start.parentNode;\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trange.setStart(next, 0);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//range的开始边界已经在a标签里的不再处理\n\t\t\t\t\t\t\tif (domUtils.findParentByTagName(range.startContainer, 'a', true)) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar a = me.document.createElement('a'),\n\t\t\t\t\t\t\t\ttext = me.document.createTextNode(' '),\n\t\t\t\t\t\t\t\thref;\n\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t\ta.appendChild(range.extractContents());\n\t\t\t\t\t\t\ta.href = a.innerHTML = a.innerHTML.replace(/<[^>]+>/g, '');\n\t\t\t\t\t\t\thref = a.getAttribute(\"href\").replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\t\t\t\t\t\thref = /^(?:https?:\\/\\/)/ig.test(href) ? href : \"http://\" + href;\n\t\t\t\t\t\t\ta.setAttribute('_src', utils.html(href));\n\t\t\t\t\t\t\ta.href = utils.html(href);\n\n\t\t\t\t\t\t\trange.insertNode(a);\n\t\t\t\t\t\t\ta.parentNode.insertBefore(text, a.nextSibling);\n\t\t\t\t\t\t\trange.setStart(text, 0);\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\tsel.addRange(range);\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} : {}\n\t}, function() {\n\t\tvar keyCodes = {\n\t\t\t37: 1,\n\t\t\t38: 1,\n\t\t\t39: 1,\n\t\t\t40: 1,\n\t\t\t13: 1,\n\t\t\t32: 1\n\t\t};\n\n\t\tfunction checkIsCludeLink(node) {\n\t\t\tif (node.nodeType == 3) {\n\t\t\t\treturn null\n\t\t\t}\n\t\t\tif (node.nodeName == 'A') {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\tvar lastChild = node.lastChild;\n\n\t\t\twhile (lastChild) {\n\t\t\t\tif (lastChild.nodeName == 'A') {\n\t\t\t\t\treturn lastChild;\n\t\t\t\t}\n\t\t\t\tif (lastChild.nodeType == 3) {\n\t\t\t\t\tif (domUtils.isWhitespace(lastChild)) {\n\t\t\t\t\t\tlastChild = lastChild.previousSibling;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\tlastChild = lastChild.lastChild;\n\t\t\t}\n\t\t}\n\t\tbrowser.ie && this.addListener('keyup', function(cmd, evt) {\n\t\t\tvar me = this,\n\t\t\t\tkeyCode = evt.keyCode;\n\t\t\tif (keyCodes[keyCode]) {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar start = rng.startContainer;\n\n\t\t\t\tif (keyCode == 13) {\n\t\t\t\t\twhile (start && !domUtils.isBody(start) && !domUtils.isBlockElm(start)) {\n\t\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (start && !domUtils.isBody(start) && start.nodeName == 'P') {\n\t\t\t\t\t\tvar pre = start.previousSibling;\n\t\t\t\t\t\tif (pre && pre.nodeType == 1) {\n\t\t\t\t\t\t\tvar pre = checkIsCludeLink(pre);\n\t\t\t\t\t\t\tif (pre && !pre.getAttribute('_href')) {\n\t\t\t\t\t\t\t\tdomUtils.remove(pre, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (keyCode == 32) {\n\t\t\t\t\tif (start.nodeType == 3 && /^\\s$/.test(start.nodeValue)) {\n\t\t\t\t\t\tstart = start.previousSibling;\n\t\t\t\t\t\tif (start && start.nodeName == 'A' && !start.getAttribute('_href')) {\n\t\t\t\t\t\t\tdomUtils.remove(start, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tstart = domUtils.findParentByTagName(start, 'a', true);\n\t\t\t\t\tif (start && !start.getAttribute('_href')) {\n\t\t\t\t\t\tvar bk = rng.createBookmark();\n\n\t\t\t\t\t\tdomUtils.remove(start, true);\n\t\t\t\t\t\trng.moveToBookmark(bk).select(true)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t});\n\t});\n\n\t// plugins/autoheight.js\n\t///import core\n\t///commands 当输入内容超过编辑器高度时，编辑器自动增高\n\t///commandsName  AutoHeight,autoHeightEnabled\n\t///commandsTitle  自动增高\n\t/**\n\t * @description 自动伸展\n\t * @author zhanyi\n\t */\n\tUE.plugins['autoheight'] = function() {\n\t\tvar me = this;\n\t\t//提供开关，就算加载也可以关闭\n\t\tme.autoHeightEnabled = me.options.autoHeightEnabled !== false;\n\t\tif (!me.autoHeightEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar bakOverflow,\n\t\t\tlastHeight = 0,\n\t\t\toptions = me.options,\n\t\t\tcurrentHeight,\n\t\t\ttimer;\n\n\t\tfunction adjustHeight() {\n\t\t\tvar me = this;\n\t\t\tclearTimeout(timer);\n\t\t\tif (isFullscreen) return;\n\t\t\tif (!me.queryCommandState || me.queryCommandState && me.queryCommandState('source') != 1) {\n\t\t\t\ttimer = setTimeout(function() {\n\n\t\t\t\t\tvar node = me.body.lastChild;\n\t\t\t\t\twhile (node && node.nodeType != 1) {\n\t\t\t\t\t\tnode = node.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t\tif (node && node.nodeType == 1) {\n\t\t\t\t\t\tnode.style.clear = 'both';\n\t\t\t\t\t\tcurrentHeight = Math.max(domUtils.getXY(node).y + node.offsetHeight + 25, Math.max(options.minFrameHeight, options.initialFrameHeight));\n\t\t\t\t\t\tif (currentHeight != lastHeight) {\n\t\t\t\t\t\t\tif (currentHeight !== parseInt(me.iframe.parentNode.style.height)) {\n\t\t\t\t\t\t\t\tme.iframe.parentNode.style.height = currentHeight + 'px';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.body.style.height = currentHeight + 'px';\n\t\t\t\t\t\t\tlastHeight = currentHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.removeStyle(node, 'clear');\n\t\t\t\t\t}\n\n\t\t\t\t}, 50)\n\t\t\t}\n\t\t}\n\t\tvar isFullscreen;\n\t\tme.addListener('fullscreenchanged', function(cmd, f) {\n\t\t\tisFullscreen = f\n\t\t});\n\t\tme.addListener('destroy', function() {\n\t\t\tme.removeListener('contentchange afterinserthtml keyup mouseup', adjustHeight)\n\t\t});\n\t\tme.enableAutoHeight = function() {\n\t\t\tvar me = this;\n\t\t\tif (!me.autoHeightEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar doc = me.document;\n\t\t\tme.autoHeightEnabled = true;\n\t\t\tbakOverflow = doc.body.style.overflowY;\n\t\t\tdoc.body.style.overflowY = 'hidden';\n\t\t\tme.addListener('contentchange afterinserthtml keyup mouseup', adjustHeight);\n\t\t\t//ff不给事件算得不对\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tadjustHeight.call(me);\n\t\t\t}, browser.gecko ? 100 : 0);\n\t\t\tme.fireEvent('autoheightchanged', me.autoHeightEnabled);\n\t\t};\n\t\tme.disableAutoHeight = function() {\n\n\t\t\tme.body.style.overflowY = bakOverflow || '';\n\n\t\t\tme.removeListener('contentchange', adjustHeight);\n\t\t\tme.removeListener('keyup', adjustHeight);\n\t\t\tme.removeListener('mouseup', adjustHeight);\n\t\t\tme.autoHeightEnabled = false;\n\t\t\tme.fireEvent('autoheightchanged', me.autoHeightEnabled);\n\t\t};\n\n\t\tme.on('setHeight', function() {\n\t\t\tme.disableAutoHeight()\n\t\t});\n\t\tme.addListener('ready', function() {\n\t\t\tme.enableAutoHeight();\n\t\t\t//trace:1764\n\t\t\tvar timer;\n\t\t\tdomUtils.on(browser.ie ? me.body : me.document, browser.webkit ? 'dragover' : 'drop', function() {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t//trace:3681\n\t\t\t\t\tadjustHeight.call(me);\n\t\t\t\t}, 100);\n\n\t\t\t});\n\t\t\t//修复内容过多时，回到顶部，顶部内容被工具栏遮挡问题\n\t\t\tvar lastScrollY;\n\t\t\twindow.onscroll = function() {\n\t\t\t\tif (lastScrollY === null) {\n\t\t\t\t\tlastScrollY = this.scrollY\n\t\t\t\t} else if (this.scrollY == 0 && lastScrollY != 0) {\n\t\t\t\t\tme.window.scrollTo(0, 0);\n\t\t\t\t\tlastScrollY = null;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t};\n\n\t// plugins/autofloat.js\n\t///import core\n\t///commands 悬浮工具栏\n\t///commandsName  AutoFloat,autoFloatEnabled\n\t///commandsTitle  悬浮工具栏\n\t/**\n\t *  modified by chengchao01\n\t *  注意： 引入此功能后，在IE6下会将body的背景图片覆盖掉！\n\t */\n\tUE.plugins['autofloat'] = function() {\n\t\tvar me = this,\n\t\t\tlang = me.getLang();\n\t\tme.setOpt({\n\t\t\ttopOffset: 0\n\t\t});\n\t\tvar optsAutoFloatEnabled = me.options.autoFloatEnabled !== false,\n\t\t\ttopOffset = me.options.topOffset;\n\n\t\t//如果不固定toolbar的位置，则直接退出\n\t\tif (!optsAutoFloatEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tvar uiUtils = UE.ui.uiUtils,\n\t\t\tLteIE6 = browser.ie && browser.version <= 6,\n\t\t\tquirks = browser.quirks;\n\n\t\tfunction checkHasUI() {\n\t\t\tif (!UE.ui) {\n\t\t\t\talert(lang.autofloatMsg);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction fixIE6FixedPos() {\n\t\t\tvar docStyle = document.body.style;\n\t\t\tdocStyle.backgroundImage = 'url(\"about:blank\")';\n\t\t\tdocStyle.backgroundAttachment = 'fixed';\n\t\t}\n\t\tvar bakCssText,\n\t\t\tplaceHolder = document.createElement('div'),\n\t\t\ttoolbarBox, orgTop,\n\t\t\tgetPosition,\n\t\t\tflag = true; //ie7模式下需要偏移\n\t\tfunction setFloating() {\n\t\t\tvar toobarBoxPos = domUtils.getXY(toolbarBox),\n\t\t\t\torigalFloat = domUtils.getComputedStyle(toolbarBox, 'position'),\n\t\t\t\torigalLeft = domUtils.getComputedStyle(toolbarBox, 'left');\n\t\t\ttoolbarBox.style.width = toolbarBox.offsetWidth + 'px';\n\t\t\ttoolbarBox.style.zIndex = me.options.zIndex * 1 + 1;\n\t\t\ttoolbarBox.parentNode.insertBefore(placeHolder, toolbarBox);\n\t\t\tif (LteIE6 || (quirks && browser.ie)) {\n\t\t\t\tif (toolbarBox.style.position != 'absolute') {\n\t\t\t\t\ttoolbarBox.style.position = 'absolute';\n\t\t\t\t}\n\t\t\t\ttoolbarBox.style.top = (document.body.scrollTop || document.documentElement.scrollTop) - orgTop + topOffset + 'px';\n\t\t\t} else {\n\t\t\t\tif (browser.ie7Compat && flag) {\n\t\t\t\t\tflag = false;\n\t\t\t\t\ttoolbarBox.style.left = domUtils.getXY(toolbarBox).x - document.documentElement.getBoundingClientRect().left + 2 + 'px';\n\t\t\t\t}\n\t\t\t\tif (toolbarBox.style.position != 'fixed') {\n\t\t\t\t\ttoolbarBox.style.position = 'fixed';\n\t\t\t\t\ttoolbarBox.style.top = topOffset + \"px\";\n\t\t\t\t\t((origalFloat == 'absolute' || origalFloat == 'relative') && parseFloat(origalLeft)) && (toolbarBox.style.left = toobarBoxPos.x + 'px');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction unsetFloating() {\n\t\t\tflag = true;\n\t\t\tif (placeHolder.parentNode) {\n\t\t\t\tplaceHolder.parentNode.removeChild(placeHolder);\n\t\t\t}\n\n\t\t\ttoolbarBox.style.cssText = bakCssText;\n\t\t}\n\n\t\tfunction updateFloating() {\n\t\t\tvar rect3 = getPosition(me.container);\n\t\t\tvar offset = me.options.toolbarTopOffset || 0;\n\t\t\tif (rect3.top < 0 && rect3.bottom - toolbarBox.offsetHeight > offset) {\n\t\t\t\tsetFloating();\n\t\t\t} else {\n\t\t\t\tunsetFloating();\n\t\t\t}\n\t\t}\n\t\tvar defer_updateFloating = utils.defer(function() {\n\t\t\tupdateFloating();\n\t\t}, browser.ie ? 200 : 100, true);\n\n\t\tme.addListener('destroy', function() {\n\t\t\tdomUtils.un(window, ['scroll', 'resize'], updateFloating);\n\t\t\tme.removeListener('keydown', defer_updateFloating);\n\t\t});\n\n\t\tme.addListener('ready', function() {\n\t\t\tif (checkHasUI(me)) {\n\t\t\t\t//加载了ui组件，但在new时，没有加载ui，导致编辑器实例上没有ui类，所以这里做判断\n\t\t\t\tif (!me.ui) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgetPosition = uiUtils.getClientRect;\n\t\t\t\ttoolbarBox = me.ui.getDom('toolbarbox');\n\t\t\t\torgTop = getPosition(toolbarBox).top;\n\t\t\t\tbakCssText = toolbarBox.style.cssText;\n\t\t\t\tplaceHolder.style.height = toolbarBox.offsetHeight + 'px';\n\t\t\t\tif (LteIE6) {\n\t\t\t\t\tfixIE6FixedPos();\n\t\t\t\t}\n\t\t\t\tdomUtils.on(window, ['scroll', 'resize'], updateFloating);\n\t\t\t\tme.addListener('keydown', defer_updateFloating);\n\n\t\t\t\tme.addListener('beforefullscreenchange', function(t, enabled) {\n\t\t\t\t\tif (enabled) {\n\t\t\t\t\t\tunsetFloating();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tme.addListener('fullscreenchanged', function(t, enabled) {\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tme.addListener('sourcemodechanged', function(t, enabled) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t}, 0);\n\t\t\t\t});\n\t\t\t\tme.addListener(\"clearDoc\", function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t}, 0);\n\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/video.js\n\t/**\n\t * video插件， 为UEditor提供视频插入支持\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['video'] = function() {\n\t\tvar me = this;\n\n\t\t/**\n\t\t * 创建插入视频字符窜\n\t\t * @param url 视频地址\n\t\t * @param width 视频宽度\n\t\t * @param height 视频高度\n\t\t * @param align 视频对齐\n\t\t * @param toEmbed 是否以flash代替显示\n\t\t * @param addParagraph  是否需要添加P 标签\n\t\t */\n\t\tfunction creatInsertStr(url, width, height, id, align, classname, type) {\n\n\t\t\turl = utils.unhtmlForUrl(url);\n\t\t\talign = utils.unhtml(align);\n\t\t\tclassname = utils.unhtml(classname);\n\n\t\t\twidth = parseInt(width, 10) || 0;\n\t\t\theight = parseInt(height, 10) || 0;\n\n\t\t\tvar str;\n\t\t\tswitch (type) {\n\t\t\t\tcase 'image':\n\t\t\t\t\tstr = '<img ' + (id ? 'id=\"' + id + '\"' : '') + ' width=\"' + width + '\" height=\"' + height + '\" _url=\"' + url + '\" class=\"' + classname.replace(/\\bvideo-js\\b/, '') + '\"' +\n\t\t\t\t\t\t' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" style=\"background:url(' + me.options.UEDITOR_HOME_URL + 'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;' + (align ? 'float:' + align + ';' : '') + '\" />'\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'embed':\n\t\t\t\t\tstr = '<embed type=\"application/x-shockwave-flash\" class=\"' + classname + '\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"' +\n\t\t\t\t\t\t' src=\"' + utils.html(url) + '\" width=\"' + width + '\" height=\"' + height + '\"' + (align ? ' style=\"float:' + align + '\"' : '') +\n\t\t\t\t\t\t' wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" allowscriptaccess=\"never\" allowfullscreen=\"true\" >';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'video':\n\t\t\t\t\tvar ext = url.substr(url.lastIndexOf('.') + 1);\n\t\t\t\t\tif (ext == 'ogv') ext = 'ogg';\n\t\t\t\t\tstr = '<video' + (id ? ' id=\"' + id + '\"' : '') + ' class=\"' + classname + ' video-js\" ' + (align ? ' style=\"float:' + align + '\"' : '') +\n\t\t\t\t\t\t' controls preload=\"none\" width=\"' + width + '\" height=\"' + height + '\" src=\"' + url + '\" data-setup=\"{}\">' +\n\t\t\t\t\t\t'<source src=\"' + url + '\" type=\"video/' + ext + '\" /></video>';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn str;\n\t\t}\n\n\t\tfunction switchImgAndVideo(root, img2video) {\n\t\t\tutils.each(root.getNodesByTagName(img2video ? 'img' : 'embed video'), function(node) {\n\t\t\t\tvar className = node.getAttr('class');\n\t\t\t\tif (className && className.indexOf('edui-faked-video') != -1) {\n\t\t\t\t\tvar html = creatInsertStr(img2video ? node.getAttr('_url') : node.getAttr('src'), node.getAttr('width'), node.getAttr('height'), null, node.getStyle('float') || '', className, img2video ? 'embed' : 'image');\n\t\t\t\t\tnode.parentNode.replaceChild(UE.uNode.createElement(html), node);\n\t\t\t\t}\n\t\t\t\tif (className && className.indexOf('edui-upload-video') != -1) {\n\t\t\t\t\tvar html = creatInsertStr(img2video ? node.getAttr('_url') : node.getAttr('src'), node.getAttr('width'), node.getAttr('height'), null, node.getStyle('float') || '', className, img2video ? 'video' : 'image');\n\t\t\t\t\tnode.parentNode.replaceChild(UE.uNode.createElement(html), node);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tme.addOutputRule(function(root) {\n\t\t\tswitchImgAndVideo(root, true)\n\t\t});\n\t\tme.addInputRule(function(root) {\n\t\t\tswitchImgAndVideo(root)\n\t\t});\n\n\t\t/**\n\t\t * 插入视频\n\t\t * @command insertvideo\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { Object } videoAttr 键值对对象， 描述一个视频的所有属性\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var videoAttr = {\n\t\t *      //视频地址\n\t\t *      url: 'http://www.youku.com/xxx',\n\t\t *      //视频宽高值， 单位px\n\t\t *      width: 200,\n\t\t *      height: 100\n\t\t * };\n\t\t *\n\t\t * //editor 是编辑器实例\n\t\t * //向编辑器插入单个视频\n\t\t * editor.execCommand( 'insertvideo', videoAttr );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 插入视频\n\t\t * @command insertvideo\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { Array } videoArr 需要插入的视频的数组， 其中的每一个元素都是一个键值对对象， 描述了一个视频的所有属性\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var videoAttr1 = {\n\t\t *      //视频地址\n\t\t *      url: 'http://www.youku.com/xxx',\n\t\t *      //视频宽高值， 单位px\n\t\t *      width: 200,\n\t\t *      height: 100\n\t\t * },\n\t\t * videoAttr2 = {\n\t\t *      //视频地址\n\t\t *      url: 'http://www.youku.com/xxx',\n\t\t *      //视频宽高值， 单位px\n\t\t *      width: 200,\n\t\t *      height: 100\n\t\t * }\n\t\t *\n\t\t * //editor 是编辑器实例\n\t\t * //该方法将会向编辑器内插入两个视频\n\t\t * editor.execCommand( 'insertvideo', [ videoAttr1, videoAttr2 ] );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查询当前光标所在处是否是一个视频\n\t\t * @command insertvideo\n\t\t * @method queryCommandState\n\t\t * @param { String } cmd 需要查询的命令字符串\n\t\t * @return { int } 如果当前光标所在处的元素是一个视频对象， 则返回1，否则返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //editor 是编辑器实例\n\t\t * editor.queryCommandState( 'insertvideo' );\n\t\t * ```\n\t\t */\n\t\tme.commands[\"insertvideo\"] = {\n\t\t\texecCommand: function(cmd, videoObjs, type) {\n\t\t\t\tvideoObjs = utils.isArray(videoObjs) ? videoObjs : [videoObjs];\n\t\t\t\tvar html = [],\n\t\t\t\t\tid = 'tmpVedio',\n\t\t\t\t\tcl;\n\t\t\t\tfor (var i = 0, vi, len = videoObjs.length; i < len; i++) {\n\t\t\t\t\tvi = videoObjs[i];\n\t\t\t\t\tcl = (type == 'upload' ? 'edui-upload-video video-js vjs-default-skin' : 'edui-faked-video');\n\t\t\t\t\thtml.push(creatInsertStr(vi.url, vi.width || 420, vi.height || 280, id + i, null, cl, 'image'));\n\t\t\t\t}\n\t\t\t\tme.execCommand(\"inserthtml\", html.join(\"\"), true);\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\tfor (var i = 0, len = videoObjs.length; i < len; i++) {\n\t\t\t\t\tvar img = this.document.getElementById('tmpVedio' + i);\n\t\t\t\t\tdomUtils.removeAttributes(img, 'id');\n\t\t\t\t\trng.selectNode(img).select();\n\t\t\t\t\tme.execCommand('imagefloat', videoObjs[i].align)\n\t\t\t\t}\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar img = me.selection.getRange().getClosedNode(),\n\t\t\t\t\tflag = img && (img.className == \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1);\n\t\t\t\treturn flag ? 1 : 0;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/table.core.js\n\t/**\n\t * Created with JetBrains WebStorm.\n\t * User: taoqili\n\t * Date: 13-1-18\n\t * Time: 上午11:09\n\t * To change this template use File | Settings | File Templates.\n\t */\n\t/**\n\t * UE表格操作类\n\t * @param table\n\t * @constructor\n\t */\n\t(function() {\n\t\tvar UETable = UE.UETable = function(table) {\n\t\t\tthis.table = table;\n\t\t\tthis.indexTable = [];\n\t\t\tthis.selectedTds = [];\n\t\t\tthis.cellsRange = {};\n\t\t\tthis.update(table);\n\t\t};\n\n\t\t//===以下为静态工具方法===\n\t\tUETable.removeSelectedClass = function(cells) {\n\t\t\tutils.each(cells, function(cell) {\n\t\t\t\tdomUtils.removeClasses(cell, \"selectTdClass\");\n\t\t\t})\n\t\t};\n\t\tUETable.addSelectedClass = function(cells) {\n\t\t\tutils.each(cells, function(cell) {\n\t\t\t\tdomUtils.addClass(cell, \"selectTdClass\");\n\t\t\t})\n\t\t};\n\t\tUETable.isEmptyBlock = function(node) {\n\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(/^\\s*$/, '').replace(reg, '').length > 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor (var i in dtd.$isNotEmpty)\n\t\t\t\tif (dtd.$isNotEmpty.hasOwnProperty(i)) {\n\t\t\t\t\tif (node.getElementsByTagName(i).length) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\treturn 1;\n\t\t};\n\t\tUETable.getWidth = function(cell) {\n\t\t\tif (!cell) return 0;\n\t\t\treturn parseInt(domUtils.getComputedStyle(cell, \"width\"), 10);\n\t\t};\n\n\t\t/**\n\t\t * 获取单元格或者单元格组的“对齐”状态。 如果当前的检测对象是一个单元格组， 只有在满足所有单元格的 水平和竖直 对齐属性都相同的\n\t\t * 条件时才会返回其状态值，否则将返回null； 如果当前只检测了一个单元格， 则直接返回当前单元格的对齐状态；\n\t\t * @param table cell or table cells , 支持单个单元格dom对象 或者 单元格dom对象数组\n\t\t * @return { align: 'left' || 'right' || 'center', valign: 'top' || 'middle' || 'bottom' } 或者 null\n\t\t */\n\t\tUETable.getTableCellAlignState = function(cells) {\n\n\t\t\t!utils.isArray(cells) && (cells = [cells]);\n\n\t\t\tvar result = {},\n\t\t\t\tstatus = ['align', 'valign'],\n\t\t\t\ttempStatus = null,\n\t\t\t\tisSame = true; //状态是否相同\n\n\t\t\tutils.each(cells, function(cellNode) {\n\n\t\t\t\tutils.each(status, function(currentState) {\n\n\t\t\t\t\ttempStatus = cellNode.getAttribute(currentState);\n\n\t\t\t\t\tif (!result[currentState] && tempStatus) {\n\t\t\t\t\t\tresult[currentState] = tempStatus;\n\t\t\t\t\t} else if (!result[currentState] || (tempStatus !== result[currentState])) {\n\t\t\t\t\t\tisSame = false;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\treturn isSame;\n\n\t\t\t});\n\n\t\t\treturn isSame ? result : null;\n\n\t\t};\n\n\t\t/**\n\t\t * 根据当前选区获取相关的table信息\n\t\t * @return {Object}\n\t\t */\n\t\tUETable.getTableItemsByRange = function(editor) {\n\t\t\tvar start = editor.selection.getStart();\n\n\t\t\t//ff下会选中bookmark\n\t\t\tif (start && start.id && start.id.indexOf('_baidu_bookmark_start_') === 0 && start.nextSibling) {\n\t\t\t\tstart = start.nextSibling;\n\t\t\t}\n\n\t\t\t//在table或者td边缘有可能存在选中tr的情况\n\t\t\tvar cell = start && domUtils.findParentByTagName(start, [\"td\", \"th\"], true),\n\t\t\t\ttr = cell && cell.parentNode,\n\t\t\t\tcaption = start && domUtils.findParentByTagName(start, 'caption', true),\n\t\t\t\ttable = caption ? caption.parentNode : tr && tr.parentNode.parentNode;\n\n\t\t\treturn {\n\t\t\t\tcell: cell,\n\t\t\t\ttr: tr,\n\t\t\t\ttable: table,\n\t\t\t\tcaption: caption\n\t\t\t}\n\t\t};\n\t\tUETable.getUETableBySelected = function(editor) {\n\t\t\tvar table = UETable.getTableItemsByRange(editor).table;\n\t\t\tif (table && table.ueTable && table.ueTable.selectedTds.length) {\n\t\t\t\treturn table.ueTable;\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tUETable.getDefaultValue = function(editor, table) {\n\t\t\tvar borderMap = {\n\t\t\t\t\tthin: '0px',\n\t\t\t\t\tmedium: '1px',\n\t\t\t\t\tthick: '2px'\n\t\t\t\t},\n\t\t\t\ttableBorder, tdPadding, tdBorder, tmpValue;\n\t\t\tif (!table) {\n\t\t\t\ttable = editor.document.createElement('table');\n\t\t\t\ttable.insertRow(0).insertCell(0).innerHTML = 'xxx';\n\t\t\t\teditor.body.appendChild(table);\n\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\ttmpValue = domUtils.getComputedStyle(table, 'border-left-width');\n\t\t\t\ttableBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'padding-left');\n\t\t\t\ttdPadding = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'border-left-width');\n\t\t\t\ttdBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\tdomUtils.remove(table);\n\t\t\t\treturn {\n\t\t\t\t\ttableBorder: tableBorder,\n\t\t\t\t\ttdPadding: tdPadding,\n\t\t\t\t\ttdBorder: tdBorder\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\ttd = table.getElementsByTagName('td')[0];\n\t\t\t\ttmpValue = domUtils.getComputedStyle(table, 'border-left-width');\n\t\t\t\ttableBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'padding-left');\n\t\t\t\ttdPadding = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'border-left-width');\n\t\t\t\ttdBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\treturn {\n\t\t\t\t\ttableBorder: tableBorder,\n\t\t\t\t\ttdPadding: tdPadding,\n\t\t\t\t\ttdBorder: tdBorder\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t * 根据当前点击的td或者table获取索引对象\n\t\t * @param tdOrTable\n\t\t */\n\t\tUETable.getUETable = function(tdOrTable) {\n\t\t\tvar tag = tdOrTable.tagName.toLowerCase();\n\t\t\ttdOrTable = (tag == \"td\" || tag == \"th\" || tag == 'caption') ? domUtils.findParentByTagName(tdOrTable, \"table\", true) : tdOrTable;\n\t\t\tif (!tdOrTable.ueTable) {\n\t\t\t\ttdOrTable.ueTable = new UETable(tdOrTable);\n\t\t\t}\n\t\t\treturn tdOrTable.ueTable;\n\t\t};\n\n\t\tUETable.cloneCell = function(cell, ignoreMerge, keepPro) {\n\t\t\tif (!cell || utils.isString(cell)) {\n\t\t\t\treturn this.table.ownerDocument.createElement(cell || 'td');\n\t\t\t}\n\t\t\tvar flag = domUtils.hasClass(cell, \"selectTdClass\");\n\t\t\tflag && domUtils.removeClasses(cell, \"selectTdClass\");\n\t\t\tvar tmpCell = cell.cloneNode(true);\n\t\t\tif (ignoreMerge) {\n\t\t\t\ttmpCell.rowSpan = tmpCell.colSpan = 1;\n\t\t\t}\n\t\t\t//去掉宽高\n\t\t\t!keepPro && domUtils.removeAttributes(tmpCell, 'width height');\n\t\t\t!keepPro && domUtils.removeAttributes(tmpCell, 'style');\n\n\t\t\ttmpCell.style.borderLeftStyle = \"\";\n\t\t\ttmpCell.style.borderTopStyle = \"\";\n\t\t\ttmpCell.style.borderLeftColor = cell.style.borderRightColor;\n\t\t\ttmpCell.style.borderLeftWidth = cell.style.borderRightWidth;\n\t\t\ttmpCell.style.borderTopColor = cell.style.borderBottomColor;\n\t\t\ttmpCell.style.borderTopWidth = cell.style.borderBottomWidth;\n\t\t\tflag && domUtils.addClass(cell, \"selectTdClass\");\n\t\t\treturn tmpCell;\n\t\t}\n\n\t\tUETable.prototype = {\n\t\t\tgetMaxRows: function() {\n\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\tmaxLen = 1;\n\t\t\t\tfor (var i = 0, row; row = rows[i]; i++) {\n\t\t\t\t\tvar currentMax = 1;\n\t\t\t\t\tfor (var j = 0, cj; cj = row.cells[j++];) {\n\t\t\t\t\t\tcurrentMax = Math.max(cj.rowSpan || 1, currentMax);\n\t\t\t\t\t}\n\t\t\t\t\tmaxLen = Math.max(currentMax + i, maxLen);\n\t\t\t\t}\n\t\t\t\treturn maxLen;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取当前表格的最大列数\n\t\t\t */\n\t\t\tgetMaxCols: function() {\n\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\tmaxLen = 0,\n\t\t\t\t\tcellRows = {};\n\t\t\t\tfor (var i = 0, row; row = rows[i]; i++) {\n\t\t\t\t\tvar cellsNum = 0;\n\t\t\t\t\tfor (var j = 0, cj; cj = row.cells[j++];) {\n\t\t\t\t\t\tcellsNum += (cj.colSpan || 1);\n\t\t\t\t\t\tif (cj.rowSpan && cj.rowSpan > 1) {\n\t\t\t\t\t\t\tfor (var k = 1; k < cj.rowSpan; k++) {\n\t\t\t\t\t\t\t\tif (!cellRows['row_' + (i + k)]) {\n\t\t\t\t\t\t\t\t\tcellRows['row_' + (i + k)] = (cj.colSpan || 1);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcellRows['row_' + (i + k)]++\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcellsNum += cellRows['row_' + i] || 0;\n\t\t\t\t\tmaxLen = Math.max(cellsNum, maxLen);\n\t\t\t\t}\n\t\t\t\treturn maxLen;\n\t\t\t},\n\t\t\tgetCellColIndex: function(cell) {\n\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取当前cell旁边的单元格，\n\t\t\t * @param cell\n\t\t\t * @param right\n\t\t\t */\n\t\t\tgetHSideCell: function(cell, right) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tpreviewRowIndex, previewColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//首行或者首列没有前置单元格\n\t\t\t\t\tif ((!right && (!len ? !cellInfo.colIndex : !range.beginColIndex)) || (right && (!len ? (cellInfo.colIndex == (this.colsNum - 1)) : (range.endColIndex == this.colsNum - 1)))) return null;\n\n\t\t\t\t\tpreviewRowIndex = !len ? cellInfo.rowIndex : range.beginRowIndex;\n\t\t\t\t\tpreviewColIndex = !right ? (!len ? (cellInfo.colIndex < 1 ? 0 : (cellInfo.colIndex - 1)) : range.beginColIndex - 1) : (!len ? cellInfo.colIndex + 1 : range.endColIndex + 1);\n\t\t\t\t\treturn this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex, this.indexTable[previewRowIndex][previewColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetTabNextCell: function(cell, preRowIndex) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\trowIndex = preRowIndex || cellInfo.rowIndex,\n\t\t\t\t\tcolIndex = cellInfo.colIndex + 1 + (cellInfo.colSpan - 1),\n\t\t\t\t\tnextCell;\n\t\t\t\ttry {\n\t\t\t\t\tnextCell = this.getCell(this.indexTable[rowIndex][colIndex].rowIndex, this.indexTable[rowIndex][colIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\trowIndex = rowIndex * 1 + 1;\n\t\t\t\t\t\tcolIndex = 0;\n\t\t\t\t\t\tnextCell = this.getCell(this.indexTable[rowIndex][colIndex].rowIndex, this.indexTable[rowIndex][colIndex].cellIndex);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\t\t\t\treturn nextCell;\n\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取视觉上的后置单元格\n\t\t\t * @param cell\n\t\t\t * @param bottom\n\t\t\t */\n\t\t\tgetVSideCell: function(cell, bottom, ignoreRange) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tnextRowIndex, nextColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length && !ignoreRange,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//末行或者末列没有后置单元格\n\t\t\t\t\tif ((!bottom && (cellInfo.rowIndex == 0)) || (bottom && (!len ? (cellInfo.rowIndex + cellInfo.rowSpan > this.rowsNum - 1) : (range.endRowIndex == this.rowsNum - 1)))) return null;\n\n\t\t\t\t\tnextRowIndex = !bottom ? (!len ? cellInfo.rowIndex - 1 : range.beginRowIndex - 1) : (!len ? (cellInfo.rowIndex + cellInfo.rowSpan) : range.endRowIndex + 1);\n\t\t\t\t\tnextColIndex = !len ? cellInfo.colIndex : range.beginColIndex;\n\t\t\t\t\treturn this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex, this.indexTable[nextRowIndex][nextColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取相同结束位置的单元格，xOrY指代了是获取x轴相同还是y轴相同\n\t\t\t */\n\t\t\tgetSameEndPosCells: function(cell, xOrY) {\n\t\t\t\ttry {\n\t\t\t\t\tvar flag = (xOrY.toLowerCase() === \"x\"),\n\t\t\t\t\t\tend = domUtils.getXY(cell)[flag ? 'x' : 'y'] + cell[\"offset\" + (flag ? 'Width' : 'Height')],\n\t\t\t\t\t\trows = this.table.rows,\n\t\t\t\t\t\tcells = null,\n\t\t\t\t\t\treturns = [];\n\t\t\t\t\tfor (var i = 0; i < this.rowsNum; i++) {\n\t\t\t\t\t\tcells = rows[i].cells;\n\t\t\t\t\t\tfor (var j = 0, tmpCell; tmpCell = cells[j++];) {\n\t\t\t\t\t\t\tvar tmpEnd = domUtils.getXY(tmpCell)[flag ? 'x' : 'y'] + tmpCell[\"offset\" + (flag ? 'Width' : 'Height')];\n\t\t\t\t\t\t\t//对应行的td已经被上面行rowSpan了\n\t\t\t\t\t\t\tif (tmpEnd > end && flag) break;\n\t\t\t\t\t\t\tif (cell == tmpCell || end == tmpEnd) {\n\t\t\t\t\t\t\t\t//只获取单一的单元格\n\t\t\t\t\t\t\t\t//todo 仅获取单一单元格在特定情况下会造成returns为空，从而影响后续的拖拽实现，修正这个。需考虑性能\n\t\t\t\t\t\t\t\tif (tmpCell[flag ? \"colSpan\" : \"rowSpan\"] == 1) {\n\t\t\t\t\t\t\t\t\treturns.push(tmpCell);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (flag) break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn returns;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetCellContent: function(cell, content) {\n\t\t\t\tcell.innerHTML = content || (browser.ie ? domUtils.fillChar : \"<br />\");\n\t\t\t},\n\t\t\tcloneCell: UETable.cloneCell,\n\t\t\t/**\n\t\t\t * 获取跟当前单元格的右边竖线为左边的所有未合并单元格\n\t\t\t */\n\t\t\tgetSameStartPosXCells: function(cell) {\n\t\t\t\ttry {\n\t\t\t\t\tvar start = domUtils.getXY(cell).x + cell.offsetWidth,\n\t\t\t\t\t\trows = this.table.rows,\n\t\t\t\t\t\tcells, returns = [];\n\t\t\t\t\tfor (var i = 0; i < this.rowsNum; i++) {\n\t\t\t\t\t\tcells = rows[i].cells;\n\t\t\t\t\t\tfor (var j = 0, tmpCell; tmpCell = cells[j++];) {\n\t\t\t\t\t\t\tvar tmpStart = domUtils.getXY(tmpCell).x;\n\t\t\t\t\t\t\tif (tmpStart > start) break;\n\t\t\t\t\t\t\tif (tmpStart == start && tmpCell.colSpan == 1) {\n\t\t\t\t\t\t\t\treturns.push(tmpCell);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn returns;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 更新table对应的索引表\n\t\t\t */\n\t\t\tupdate: function(table) {\n\t\t\t\tthis.table = table || this.table;\n\t\t\t\tthis.selectedTds = [];\n\t\t\t\tthis.cellsRange = {};\n\t\t\t\tthis.indexTable = [];\n\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\trowsNum = this.getMaxRows(),\n\t\t\t\t\tdNum = rowsNum - rows.length,\n\t\t\t\t\tcolsNum = this.getMaxCols();\n\t\t\t\twhile (dNum--) {\n\t\t\t\t\tthis.table.insertRow(rows.length);\n\t\t\t\t}\n\t\t\t\tthis.rowsNum = rowsNum;\n\t\t\t\tthis.colsNum = colsNum;\n\t\t\t\tfor (var i = 0, len = rows.length; i < len; i++) {\n\t\t\t\t\tthis.indexTable[i] = new Array(colsNum);\n\t\t\t\t}\n\t\t\t\t//填充索引表\n\t\t\t\tfor (var rowIndex = 0, row; row = rows[rowIndex]; rowIndex++) {\n\t\t\t\t\tfor (var cellIndex = 0, cell, cells = row.cells; cell = cells[cellIndex]; cellIndex++) {\n\t\t\t\t\t\t//修正整行被rowSpan时导致的行数计算错误\n\t\t\t\t\t\tif (cell.rowSpan > rowsNum) {\n\t\t\t\t\t\t\tcell.rowSpan = rowsNum;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar colIndex = cellIndex,\n\t\t\t\t\t\t\trowSpan = cell.rowSpan || 1,\n\t\t\t\t\t\t\tcolSpan = cell.colSpan || 1;\n\t\t\t\t\t\t//当已经被上一行rowSpan或者被前一列colSpan了，则跳到下一个单元格进行\n\t\t\t\t\t\twhile (this.indexTable[rowIndex][colIndex]) colIndex++;\n\t\t\t\t\t\tfor (var j = 0; j < rowSpan; j++) {\n\t\t\t\t\t\t\tfor (var k = 0; k < colSpan; k++) {\n\t\t\t\t\t\t\t\tthis.indexTable[rowIndex + j][colIndex + k] = {\n\t\t\t\t\t\t\t\t\trowIndex: rowIndex,\n\t\t\t\t\t\t\t\t\tcellIndex: cellIndex,\n\t\t\t\t\t\t\t\t\tcolIndex: colIndex,\n\t\t\t\t\t\t\t\t\trowSpan: rowSpan,\n\t\t\t\t\t\t\t\t\tcolSpan: colSpan\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//修复残缺td\n\t\t\t\tfor (j = 0; j < rowsNum; j++) {\n\t\t\t\t\tfor (k = 0; k < colsNum; k++) {\n\t\t\t\t\t\tif (this.indexTable[j][k] === undefined) {\n\t\t\t\t\t\t\trow = rows[j];\n\t\t\t\t\t\t\tcell = row.cells[row.cells.length - 1];\n\t\t\t\t\t\t\tcell = cell ? cell.cloneNode(true) : this.table.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\tif (cell.colSpan !== 1) cell.colSpan = 1;\n\t\t\t\t\t\t\tif (cell.rowSpan !== 1) cell.rowSpan = 1;\n\t\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\t\tthis.indexTable[j][k] = {\n\t\t\t\t\t\t\t\trowIndex: j,\n\t\t\t\t\t\t\t\tcellIndex: cell.cellIndex,\n\t\t\t\t\t\t\t\tcolIndex: k,\n\t\t\t\t\t\t\t\trowSpan: 1,\n\t\t\t\t\t\t\t\tcolSpan: 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//当框选后删除行或者列后撤销，需要重建选区。\n\t\t\t\tvar tds = domUtils.getElementsByTagName(this.table, \"td\"),\n\t\t\t\t\tselectTds = [];\n\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\tif (domUtils.hasClass(td, \"selectTdClass\")) {\n\t\t\t\t\t\tselectTds.push(td);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (selectTds.length) {\n\t\t\t\t\tvar start = selectTds[0],\n\t\t\t\t\t\tend = selectTds[selectTds.length - 1],\n\t\t\t\t\t\tstartInfo = this.getCellInfo(start),\n\t\t\t\t\t\tendInfo = this.getCellInfo(end);\n\t\t\t\t\tthis.selectedTds = selectTds;\n\t\t\t\t\tthis.cellsRange = {\n\t\t\t\t\t\tbeginRowIndex: startInfo.rowIndex,\n\t\t\t\t\t\tbeginColIndex: startInfo.colIndex,\n\t\t\t\t\t\tendRowIndex: endInfo.rowIndex + endInfo.rowSpan - 1,\n\t\t\t\t\t\tendColIndex: endInfo.colIndex + endInfo.colSpan - 1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t//给第一行设置firstRow的样式名称,在排序图标的样式上使用到\n\t\t\t\tif (!domUtils.hasClass(this.table.rows[0], \"firstRow\")) {\n\t\t\t\t\tdomUtils.addClass(this.table.rows[0], \"firstRow\");\n\t\t\t\t\tfor (var i = 1; i < this.table.rows.length; i++) {\n\t\t\t\t\t\tdomUtils.removeClasses(this.table.rows[i], \"firstRow\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取单元格的索引信息\n\t\t\t */\n\t\t\tgetCellInfo: function(cell) {\n\t\t\t\tif (!cell) return;\n\t\t\t\tvar cellIndex = cell.cellIndex,\n\t\t\t\t\trowIndex = cell.parentNode.rowIndex,\n\t\t\t\t\trowInfo = this.indexTable[rowIndex],\n\t\t\t\t\tnumCols = this.colsNum;\n\t\t\t\tfor (var colIndex = cellIndex; colIndex < numCols; colIndex++) {\n\t\t\t\t\tvar cellInfo = rowInfo[colIndex];\n\t\t\t\t\tif (cellInfo.rowIndex === rowIndex && cellInfo.cellIndex === cellIndex) {\n\t\t\t\t\t\treturn cellInfo;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 根据行列号获取单元格\n\t\t\t */\n\t\t\tgetCell: function(rowIndex, cellIndex) {\n\t\t\t\treturn rowIndex < this.rowsNum && this.table.rows[rowIndex].cells[cellIndex] || null;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除单元格\n\t\t\t */\n\t\t\tdeleteCell: function(cell, rowIndex) {\n\t\t\t\trowIndex = typeof rowIndex == 'number' ? rowIndex : cell.parentNode.rowIndex;\n\t\t\t\tvar row = this.table.rows[rowIndex];\n\t\t\t\trow.deleteCell(cell.cellIndex);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 根据始末两个单元格获取被框选的所有单元格范围\n\t\t\t */\n\t\t\tgetCellsRange: function(cellA, cellB) {\n\t\t\t\tfunction checkRange(beginRowIndex, beginColIndex, endRowIndex, endColIndex) {\n\t\t\t\t\tvar tmpBeginRowIndex = beginRowIndex,\n\t\t\t\t\t\ttmpBeginColIndex = beginColIndex,\n\t\t\t\t\t\ttmpEndRowIndex = endRowIndex,\n\t\t\t\t\t\ttmpEndColIndex = endColIndex,\n\t\t\t\t\t\tcellInfo, colIndex, rowIndex;\n\t\t\t\t\t// 通过indexTable检查是否存在超出TableRange上边界的情况\n\t\t\t\t\tif (beginRowIndex > 0) {\n\t\t\t\t\t\tfor (colIndex = beginColIndex; colIndex < endColIndex; colIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[beginRowIndex][colIndex];\n\t\t\t\t\t\t\trowIndex = cellInfo.rowIndex;\n\t\t\t\t\t\t\tif (rowIndex < beginRowIndex) {\n\t\t\t\t\t\t\t\ttmpBeginRowIndex = Math.min(rowIndex, tmpBeginRowIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// 通过indexTable检查是否存在超出TableRange右边界的情况\n\t\t\t\t\tif (endColIndex < me.colsNum) {\n\t\t\t\t\t\tfor (rowIndex = beginRowIndex; rowIndex < endRowIndex; rowIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[rowIndex][endColIndex];\n\t\t\t\t\t\t\tcolIndex = cellInfo.colIndex + cellInfo.colSpan - 1;\n\t\t\t\t\t\t\tif (colIndex > endColIndex) {\n\t\t\t\t\t\t\t\ttmpEndColIndex = Math.max(colIndex, tmpEndColIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// 检查是否有超出TableRange下边界的情况\n\t\t\t\t\tif (endRowIndex < me.rowsNum) {\n\t\t\t\t\t\tfor (colIndex = beginColIndex; colIndex < endColIndex; colIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[endRowIndex][colIndex];\n\t\t\t\t\t\t\trowIndex = cellInfo.rowIndex + cellInfo.rowSpan - 1;\n\t\t\t\t\t\t\tif (rowIndex > endRowIndex) {\n\t\t\t\t\t\t\t\ttmpEndRowIndex = Math.max(rowIndex, tmpEndRowIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// 检查是否有超出TableRange左边界的情况\n\t\t\t\t\tif (beginColIndex > 0) {\n\t\t\t\t\t\tfor (rowIndex = beginRowIndex; rowIndex < endRowIndex; rowIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[rowIndex][beginColIndex];\n\t\t\t\t\t\t\tcolIndex = cellInfo.colIndex;\n\t\t\t\t\t\t\tif (colIndex < beginColIndex) {\n\t\t\t\t\t\t\t\ttmpBeginColIndex = Math.min(cellInfo.colIndex, tmpBeginColIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//递归调用直至所有完成所有框选单元格的扩展\n\t\t\t\t\tif (tmpBeginRowIndex != beginRowIndex || tmpBeginColIndex != beginColIndex || tmpEndRowIndex != endRowIndex || tmpEndColIndex != endColIndex) {\n\t\t\t\t\t\treturn checkRange(tmpBeginRowIndex, tmpBeginColIndex, tmpEndRowIndex, tmpEndColIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 不需要扩展TableRange的情况\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tbeginRowIndex: beginRowIndex,\n\t\t\t\t\t\t\tbeginColIndex: beginColIndex,\n\t\t\t\t\t\t\tendRowIndex: endRowIndex,\n\t\t\t\t\t\t\tendColIndex: endColIndex\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tcellAInfo = me.getCellInfo(cellA);\n\t\t\t\t\tif (cellA === cellB) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tbeginRowIndex: cellAInfo.rowIndex,\n\t\t\t\t\t\t\tbeginColIndex: cellAInfo.colIndex,\n\t\t\t\t\t\t\tendRowIndex: cellAInfo.rowIndex + cellAInfo.rowSpan - 1,\n\t\t\t\t\t\t\tendColIndex: cellAInfo.colIndex + cellAInfo.colSpan - 1\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tvar cellBInfo = me.getCellInfo(cellB);\n\t\t\t\t\t// 计算TableRange的四个边\n\t\t\t\t\tvar beginRowIndex = Math.min(cellAInfo.rowIndex, cellBInfo.rowIndex),\n\t\t\t\t\t\tbeginColIndex = Math.min(cellAInfo.colIndex, cellBInfo.colIndex),\n\t\t\t\t\t\tendRowIndex = Math.max(cellAInfo.rowIndex + cellAInfo.rowSpan - 1, cellBInfo.rowIndex + cellBInfo.rowSpan - 1),\n\t\t\t\t\t\tendColIndex = Math.max(cellAInfo.colIndex + cellAInfo.colSpan - 1, cellBInfo.colIndex + cellBInfo.colSpan - 1);\n\n\t\t\t\t\treturn checkRange(beginRowIndex, beginColIndex, endRowIndex, endColIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t//throw e;\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 依据cellsRange获取对应的单元格集合\n\t\t\t */\n\t\t\tgetCells: function(range) {\n\t\t\t\t//每次获取cells之前必须先清除上次的选择，否则会对后续获取操作造成影响\n\t\t\t\tthis.clearSelected();\n\t\t\t\tvar beginRowIndex = range.beginRowIndex,\n\t\t\t\t\tbeginColIndex = range.beginColIndex,\n\t\t\t\t\tendRowIndex = range.endRowIndex,\n\t\t\t\t\tendColIndex = range.endColIndex,\n\t\t\t\t\tcellInfo, rowIndex, colIndex, tdHash = {},\n\t\t\t\t\treturnTds = [];\n\t\t\t\tfor (var i = beginRowIndex; i <= endRowIndex; i++) {\n\t\t\t\t\tfor (var j = beginColIndex; j <= endColIndex; j++) {\n\t\t\t\t\t\tcellInfo = this.indexTable[i][j];\n\t\t\t\t\t\trowIndex = cellInfo.rowIndex;\n\t\t\t\t\t\tcolIndex = cellInfo.colIndex;\n\t\t\t\t\t\t// 如果Cells里已经包含了此Cell则跳过\n\t\t\t\t\t\tvar key = rowIndex + '|' + colIndex;\n\t\t\t\t\t\tif (tdHash[key]) continue;\n\t\t\t\t\t\ttdHash[key] = 1;\n\t\t\t\t\t\tif (rowIndex < i || colIndex < j || rowIndex + cellInfo.rowSpan - 1 > endRowIndex || colIndex + cellInfo.colSpan - 1 > endColIndex) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturnTds.push(this.getCell(rowIndex, cellInfo.cellIndex));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn returnTds;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 清理已经选中的单元格\n\t\t\t */\n\t\t\tclearSelected: function() {\n\t\t\t\tUETable.removeSelectedClass(this.selectedTds);\n\t\t\t\tthis.selectedTds = [];\n\t\t\t\tthis.cellsRange = {};\n\t\t\t},\n\t\t\t/**\n\t\t\t * 根据range设置已经选中的单元格\n\t\t\t */\n\t\t\tsetSelected: function(range) {\n\t\t\t\tvar cells = this.getCells(range);\n\t\t\t\tUETable.addSelectedClass(cells);\n\t\t\t\tthis.selectedTds = cells;\n\t\t\t\tthis.cellsRange = range;\n\t\t\t},\n\t\t\tisFullRow: function() {\n\t\t\t\tvar range = this.cellsRange;\n\t\t\t\treturn (range.endColIndex - range.beginColIndex + 1) == this.colsNum;\n\t\t\t},\n\t\t\tisFullCol: function() {\n\t\t\t\tvar range = this.cellsRange,\n\t\t\t\t\ttable = this.table,\n\t\t\t\t\tths = table.getElementsByTagName(\"th\"),\n\t\t\t\t\trows = range.endRowIndex - range.beginRowIndex + 1;\n\t\t\t\treturn !ths.length ? rows == this.rowsNum : rows == this.rowsNum || (rows == this.rowsNum - 1);\n\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取视觉上的前置单元格，默认是左边，top传入时\n\t\t\t * @param cell\n\t\t\t * @param top\n\t\t\t */\n\t\t\tgetNextCell: function(cell, bottom, ignoreRange) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tnextRowIndex, nextColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length && !ignoreRange,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//末行或者末列没有后置单元格\n\t\t\t\t\tif ((!bottom && (cellInfo.rowIndex == 0)) || (bottom && (!len ? (cellInfo.rowIndex + cellInfo.rowSpan > this.rowsNum - 1) : (range.endRowIndex == this.rowsNum - 1)))) return null;\n\n\t\t\t\t\tnextRowIndex = !bottom ? (!len ? cellInfo.rowIndex - 1 : range.beginRowIndex - 1) : (!len ? (cellInfo.rowIndex + cellInfo.rowSpan) : range.endRowIndex + 1);\n\t\t\t\t\tnextColIndex = !len ? cellInfo.colIndex : range.beginColIndex;\n\t\t\t\t\treturn this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex, this.indexTable[nextRowIndex][nextColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetPreviewCell: function(cell, top) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tpreviewRowIndex, previewColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//首行或者首列没有前置单元格\n\t\t\t\t\tif ((!top && (!len ? !cellInfo.colIndex : !range.beginColIndex)) || (top && (!len ? (cellInfo.rowIndex > (this.colsNum - 1)) : (range.endColIndex == this.colsNum - 1)))) return null;\n\n\t\t\t\t\tpreviewRowIndex = !top ? (!len ? cellInfo.rowIndex : range.beginRowIndex) : (!len ? (cellInfo.rowIndex < 1 ? 0 : (cellInfo.rowIndex - 1)) : range.beginRowIndex);\n\t\t\t\t\tpreviewColIndex = !top ? (!len ? (cellInfo.colIndex < 1 ? 0 : (cellInfo.colIndex - 1)) : range.beginColIndex - 1) : (!len ? cellInfo.colIndex : range.endColIndex + 1);\n\t\t\t\t\treturn this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex, this.indexTable[previewRowIndex][previewColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 移动单元格中的内容\n\t\t\t */\n\t\t\tmoveContent: function(cellTo, cellFrom) {\n\t\t\t\tif (UETable.isEmptyBlock(cellFrom)) return;\n\t\t\t\tif (UETable.isEmptyBlock(cellTo)) {\n\t\t\t\t\tcellTo.innerHTML = cellFrom.innerHTML;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar child = cellTo.lastChild;\n\t\t\t\tif (child.nodeType == 3 || !dtd.$block[child.tagName]) {\n\t\t\t\t\tcellTo.appendChild(cellTo.ownerDocument.createElement('br'))\n\t\t\t\t}\n\t\t\t\twhile (child = cellFrom.firstChild) {\n\t\t\t\t\tcellTo.appendChild(child);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 向右合并单元格\n\t\t\t */\n\t\t\tmergeRight: function(cell) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\trightColIndex = cellInfo.colIndex + cellInfo.colSpan,\n\t\t\t\t\trightCellInfo = this.indexTable[cellInfo.rowIndex][rightColIndex],\n\t\t\t\t\trightCell = this.getCell(rightCellInfo.rowIndex, rightCellInfo.cellIndex);\n\t\t\t\t//合并\n\t\t\t\tcell.colSpan = cellInfo.colSpan + rightCellInfo.colSpan;\n\t\t\t\t//被合并的单元格不应存在宽度属性\n\t\t\t\tcell.removeAttribute(\"width\");\n\t\t\t\t//移动内容\n\t\t\t\tthis.moveContent(cell, rightCell);\n\t\t\t\t//删掉被合并的Cell\n\t\t\t\tthis.deleteCell(rightCell, rightCellInfo.rowIndex);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 向下合并单元格\n\t\t\t */\n\t\t\tmergeDown: function(cell) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\tdownRowIndex = cellInfo.rowIndex + cellInfo.rowSpan,\n\t\t\t\t\tdownCellInfo = this.indexTable[downRowIndex][cellInfo.colIndex],\n\t\t\t\t\tdownCell = this.getCell(downCellInfo.rowIndex, downCellInfo.cellIndex);\n\t\t\t\tcell.rowSpan = cellInfo.rowSpan + downCellInfo.rowSpan;\n\t\t\t\tcell.removeAttribute(\"height\");\n\t\t\t\tthis.moveContent(cell, downCell);\n\t\t\t\tthis.deleteCell(downCell, downCellInfo.rowIndex);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 合并整个range中的内容\n\t\t\t */\n\t\t\tmergeRange: function() {\n\t\t\t\t//由于合并操作可以在任意时刻进行，所以无法通过鼠标位置等信息实时生成range，只能通过缓存实例中的cellsRange对象来访问\n\t\t\t\tvar range = this.cellsRange,\n\t\t\t\t\tleftTopCell = this.getCell(range.beginRowIndex, this.indexTable[range.beginRowIndex][range.beginColIndex].cellIndex);\n\n\t\t\t\tif (leftTopCell.tagName == \"TH\" && range.endRowIndex !== range.beginRowIndex) {\n\t\t\t\t\tvar index = this.indexTable,\n\t\t\t\t\t\tinfo = this.getCellInfo(leftTopCell);\n\t\t\t\t\tleftTopCell = this.getCell(1, index[1][info.colIndex].cellIndex);\n\t\t\t\t\trange = this.getCellsRange(leftTopCell, this.getCell(index[this.rowsNum - 1][info.colIndex].rowIndex, index[this.rowsNum - 1][info.colIndex].cellIndex));\n\t\t\t\t}\n\n\t\t\t\t// 删除剩余的Cells\n\t\t\t\tvar cells = this.getCells(range);\n\t\t\t\tfor (var i = 0, ci; ci = cells[i++];) {\n\t\t\t\t\tif (ci !== leftTopCell) {\n\t\t\t\t\t\tthis.moveContent(leftTopCell, ci);\n\t\t\t\t\t\tthis.deleteCell(ci);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// 修改左上角Cell的rowSpan和colSpan，并调整宽度属性设置\n\t\t\t\tleftTopCell.rowSpan = range.endRowIndex - range.beginRowIndex + 1;\n\t\t\t\tleftTopCell.rowSpan > 1 && leftTopCell.removeAttribute(\"height\");\n\t\t\t\tleftTopCell.colSpan = range.endColIndex - range.beginColIndex + 1;\n\t\t\t\tleftTopCell.colSpan > 1 && leftTopCell.removeAttribute(\"width\");\n\t\t\t\tif (leftTopCell.rowSpan == this.rowsNum && leftTopCell.colSpan != 1) {\n\t\t\t\t\tleftTopCell.colSpan = 1;\n\t\t\t\t}\n\n\t\t\t\tif (leftTopCell.colSpan == this.colsNum && leftTopCell.rowSpan != 1) {\n\t\t\t\t\tvar rowIndex = leftTopCell.parentNode.rowIndex;\n\t\t\t\t\t//解决IE下的表格操作问题\n\t\t\t\t\tif (this.table.deleteRow) {\n\t\t\t\t\t\tfor (var i = rowIndex + 1, curIndex = rowIndex + 1, len = leftTopCell.rowSpan; i < len; i++) {\n\t\t\t\t\t\t\tthis.table.deleteRow(curIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (var i = 0, len = leftTopCell.rowSpan - 1; i < len; i++) {\n\t\t\t\t\t\t\tvar row = this.table.rows[rowIndex + 1];\n\t\t\t\t\t\t\trow.parentNode.removeChild(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tleftTopCell.rowSpan = 1;\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 插入一行单元格\n\t\t\t */\n\t\t\tinsertRow: function(rowIndex, sourceCell) {\n\t\t\t\tvar numCols = this.colsNum,\n\t\t\t\t\ttable = this.table,\n\t\t\t\t\trow = table.insertRow(rowIndex),\n\t\t\t\t\tcell,\n\t\t\t\t\tisInsertTitle = typeof sourceCell == 'string' && sourceCell.toUpperCase() == 'TH';\n\n\t\t\t\tfunction replaceTdToTh(colIndex, cell, tableRow) {\n\t\t\t\t\tif (colIndex == 0) {\n\t\t\t\t\t\tvar tr = tableRow.nextSibling || tableRow.previousSibling,\n\t\t\t\t\t\t\tth = tr.cells[colIndex];\n\t\t\t\t\t\tif (th.tagName == 'TH') {\n\t\t\t\t\t\t\tth = cell.ownerDocument.createElement(\"th\");\n\t\t\t\t\t\t\tth.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(th, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\t\tvar td = cell.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\ttd.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(td, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//首行直接插入,无需考虑部分单元格被rowspan的情况\n\t\t\t\tif (rowIndex == 0 || rowIndex == this.rowsNum) {\n\t\t\t\t\tfor (var colIndex = 0; colIndex < numCols; colIndex++) {\n\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true);\n\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\tcell.getAttribute('vAlign') && cell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\tif (!isInsertTitle) replaceTdToTh(colIndex, cell, row);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar infoRow = this.indexTable[rowIndex],\n\t\t\t\t\t\tcellIndex = 0;\n\t\t\t\t\tfor (colIndex = 0; colIndex < numCols; colIndex++) {\n\t\t\t\t\t\tvar cellInfo = infoRow[colIndex];\n\t\t\t\t\t\t//如果存在某个单元格的rowspan穿过待插入行的位置，则修改该单元格的rowspan即可，无需插入单元格\n\t\t\t\t\t\tif (cellInfo.rowIndex < rowIndex) {\n\t\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\t\tcell.rowSpan = cellInfo.rowSpan + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true);\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isInsertTitle) replaceTdToTh(colIndex, cell, row);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//框选时插入不触发contentchange，需要手动更新索引。\n\t\t\t\tthis.update();\n\t\t\t\treturn row;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除一行单元格\n\t\t\t * @param rowIndex\n\t\t\t */\n\t\t\tdeleteRow: function(rowIndex) {\n\t\t\t\tvar row = this.table.rows[rowIndex],\n\t\t\t\t\tinfoRow = this.indexTable[rowIndex],\n\t\t\t\t\tcolsNum = this.colsNum,\n\t\t\t\t\tcount = 0; //处理计数\n\t\t\t\tfor (var colIndex = 0; colIndex < colsNum;) {\n\t\t\t\t\tvar cellInfo = infoRow[colIndex],\n\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\tif (cell.rowSpan > 1) {\n\t\t\t\t\t\tif (cellInfo.rowIndex == rowIndex) {\n\t\t\t\t\t\t\tvar clone = cell.cloneNode(true);\n\t\t\t\t\t\t\tclone.rowSpan = cell.rowSpan - 1;\n\t\t\t\t\t\t\tclone.innerHTML = \"\";\n\t\t\t\t\t\t\tcell.rowSpan = 1;\n\t\t\t\t\t\t\tvar nextRowIndex = rowIndex + 1,\n\t\t\t\t\t\t\t\tnextRow = this.table.rows[nextRowIndex],\n\t\t\t\t\t\t\t\tinsertCellIndex,\n\t\t\t\t\t\t\t\tpreMerged = this.getPreviewMergedCellsNum(nextRowIndex, colIndex) - count;\n\t\t\t\t\t\t\tif (preMerged < colIndex) {\n\t\t\t\t\t\t\t\tinsertCellIndex = colIndex - preMerged - 1;\n\t\t\t\t\t\t\t\t//nextRow.insertCell(insertCellIndex);\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(nextRow.cells[insertCellIndex], clone);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (nextRow.cells.length) nextRow.insertBefore(clone, nextRow.cells[0])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcount += 1;\n\t\t\t\t\t\t\t//cell.parentNode.removeChild(cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcolIndex += cell.colSpan || 1;\n\t\t\t\t}\n\t\t\t\tvar deleteTds = [],\n\t\t\t\t\tcacheMap = {};\n\t\t\t\tfor (colIndex = 0; colIndex < colsNum; colIndex++) {\n\t\t\t\t\tvar tmpRowIndex = infoRow[colIndex].rowIndex,\n\t\t\t\t\t\ttmpCellIndex = infoRow[colIndex].cellIndex,\n\t\t\t\t\t\tkey = tmpRowIndex + \"_\" + tmpCellIndex;\n\t\t\t\t\tif (cacheMap[key]) continue;\n\t\t\t\t\tcacheMap[key] = 1;\n\t\t\t\t\tcell = this.getCell(tmpRowIndex, tmpCellIndex);\n\t\t\t\t\tdeleteTds.push(cell);\n\t\t\t\t}\n\t\t\t\tvar mergeTds = [];\n\t\t\t\tutils.each(deleteTds, function(td) {\n\t\t\t\t\tif (td.rowSpan == 1) {\n\t\t\t\t\t\ttd.parentNode.removeChild(td);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmergeTds.push(td);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tutils.each(mergeTds, function(td) {\n\t\t\t\t\ttd.rowSpan--;\n\t\t\t\t});\n\t\t\t\trow.parentNode.removeChild(row);\n\t\t\t\t//浏览器方法本身存在bug,采用自定义方法删除\n\t\t\t\t//this.table.deleteRow(rowIndex);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\tinsertCol: function(colIndex, sourceCell, defaultValue) {\n\t\t\t\tvar rowsNum = this.rowsNum,\n\t\t\t\t\trowIndex = 0,\n\t\t\t\t\ttableRow, cell,\n\t\t\t\t\tbackWidth = parseInt((this.table.offsetWidth - (this.colsNum + 1) * 20 - (this.colsNum + 1)) / (this.colsNum + 1), 10),\n\t\t\t\t\tisInsertTitleCol = typeof sourceCell == 'string' && sourceCell.toUpperCase() == 'TH';\n\n\t\t\t\tfunction replaceTdToTh(rowIndex, cell, tableRow) {\n\t\t\t\t\tif (rowIndex == 0) {\n\t\t\t\t\t\tvar th = cell.nextSibling || cell.previousSibling;\n\t\t\t\t\t\tif (th.tagName == 'TH') {\n\t\t\t\t\t\t\tth = cell.ownerDocument.createElement(\"th\");\n\t\t\t\t\t\t\tth.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(th, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\t\tvar td = cell.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\ttd.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(td, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar preCell;\n\t\t\t\tif (colIndex == 0 || colIndex == this.colsNum) {\n\t\t\t\t\tfor (; rowIndex < rowsNum; rowIndex++) {\n\t\t\t\t\t\ttableRow = this.table.rows[rowIndex];\n\t\t\t\t\t\tpreCell = tableRow.cells[colIndex == 0 ? colIndex : tableRow.cells.length];\n\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true); //tableRow.insertCell(colIndex == 0 ? colIndex : tableRow.cells.length);\n\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\tcell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\tpreCell && cell.setAttribute('width', preCell.getAttribute('width'));\n\t\t\t\t\t\tif (!colIndex) {\n\t\t\t\t\t\t\ttableRow.insertBefore(cell, tableRow.cells[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.insertAfter(tableRow.cells[tableRow.cells.length - 1], cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isInsertTitleCol) replaceTdToTh(rowIndex, cell, tableRow)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (; rowIndex < rowsNum; rowIndex++) {\n\t\t\t\t\t\tvar cellInfo = this.indexTable[rowIndex][colIndex];\n\t\t\t\t\t\tif (cellInfo.colIndex < colIndex) {\n\t\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\t\tcell.colSpan = cellInfo.colSpan + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttableRow = this.table.rows[rowIndex];\n\t\t\t\t\t\t\tpreCell = tableRow.cells[cellInfo.cellIndex];\n\n\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true); //tableRow.insertCell(cellInfo.cellIndex);\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\tcell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\t\tpreCell && cell.setAttribute('width', preCell.getAttribute('width'));\n\t\t\t\t\t\t\t//防止IE下报错\n\t\t\t\t\t\t\tpreCell ? tableRow.insertBefore(cell, preCell) : tableRow.appendChild(cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isInsertTitleCol) replaceTdToTh(rowIndex, cell, tableRow);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//框选时插入不触发contentchange，需要手动更新索引\n\t\t\t\tthis.update();\n\t\t\t\tthis.updateWidth(backWidth, defaultValue || {\n\t\t\t\t\ttdPadding: 10,\n\t\t\t\t\ttdBorder: 1\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWidth: function(width, defaultValue) {\n\t\t\t\tvar table = this.table,\n\t\t\t\t\ttmpWidth = UETable.getWidth(table) - defaultValue.tdPadding * 2 - defaultValue.tdBorder + width;\n\t\t\t\tif (tmpWidth < table.ownerDocument.body.offsetWidth) {\n\t\t\t\t\ttable.setAttribute(\"width\", tmpWidth);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar tds = domUtils.getElementsByTagName(this.table, \"td th\");\n\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\ttd.setAttribute(\"width\", width);\n\t\t\t\t})\n\t\t\t},\n\t\t\tdeleteCol: function(colIndex) {\n\t\t\t\tvar indexTable = this.indexTable,\n\t\t\t\t\ttableRows = this.table.rows,\n\t\t\t\t\tbackTableWidth = this.table.getAttribute(\"width\"),\n\t\t\t\t\tbackTdWidth = 0,\n\t\t\t\t\trowsNum = this.rowsNum,\n\t\t\t\t\tcacheMap = {};\n\t\t\t\tfor (var rowIndex = 0; rowIndex < rowsNum;) {\n\t\t\t\t\tvar infoRow = indexTable[rowIndex],\n\t\t\t\t\t\tcellInfo = infoRow[colIndex],\n\t\t\t\t\t\tkey = cellInfo.rowIndex + '_' + cellInfo.colIndex;\n\t\t\t\t\t// 跳过已经处理过的Cell\n\t\t\t\t\tif (cacheMap[key]) continue;\n\t\t\t\t\tcacheMap[key] = 1;\n\t\t\t\t\tvar cell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\tif (!backTdWidth) backTdWidth = cell && parseInt(cell.offsetWidth / cell.colSpan, 10).toFixed(0);\n\t\t\t\t\t// 如果Cell的colSpan大于1, 就修改colSpan, 否则就删掉这个Cell\n\t\t\t\t\tif (cell.colSpan > 1) {\n\t\t\t\t\t\tcell.colSpan--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttableRows[rowIndex].deleteCell(cellInfo.cellIndex);\n\t\t\t\t\t}\n\t\t\t\t\trowIndex += cellInfo.rowSpan || 1;\n\t\t\t\t}\n\t\t\t\tthis.table.setAttribute(\"width\", backTableWidth - backTdWidth);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\tsplitToCells: function(cell) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tcells = this.splitToRows(cell);\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tme.splitToCols(cell);\n\t\t\t\t})\n\t\t\t},\n\t\t\tsplitToRows: function(cell) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\trowIndex = cellInfo.rowIndex,\n\t\t\t\t\tcolIndex = cellInfo.colIndex,\n\t\t\t\t\tresults = [];\n\t\t\t\t// 修改Cell的rowSpan\n\t\t\t\tcell.rowSpan = 1;\n\t\t\t\tresults.push(cell);\n\t\t\t\t// 补齐单元格\n\t\t\t\tfor (var i = rowIndex, endRow = rowIndex + cellInfo.rowSpan; i < endRow; i++) {\n\t\t\t\t\tif (i == rowIndex) continue;\n\t\t\t\t\tvar tableRow = this.table.rows[i],\n\t\t\t\t\t\ttmpCell = tableRow.insertCell(colIndex - this.getPreviewMergedCellsNum(i, colIndex));\n\t\t\t\t\ttmpCell.colSpan = cellInfo.colSpan;\n\t\t\t\t\tthis.setCellContent(tmpCell);\n\t\t\t\t\ttmpCell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\ttmpCell.setAttribute('align', cell.getAttribute('align'));\n\t\t\t\t\tif (cell.style.cssText) {\n\t\t\t\t\t\ttmpCell.style.cssText = cell.style.cssText;\n\t\t\t\t\t}\n\t\t\t\t\tresults.push(tmpCell);\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t\treturn results;\n\t\t\t},\n\t\t\tgetPreviewMergedCellsNum: function(rowIndex, colIndex) {\n\t\t\t\tvar indexRow = this.indexTable[rowIndex],\n\t\t\t\t\tnum = 0;\n\t\t\t\tfor (var i = 0; i < colIndex;) {\n\t\t\t\t\tvar colSpan = indexRow[i].colSpan,\n\t\t\t\t\t\ttmpRowIndex = indexRow[i].rowIndex;\n\t\t\t\t\tnum += (colSpan - (tmpRowIndex == rowIndex ? 1 : 0));\n\t\t\t\t\ti += colSpan;\n\t\t\t\t}\n\t\t\t\treturn num;\n\t\t\t},\n\t\t\tsplitToCols: function(cell) {\n\t\t\t\tvar backWidth = (cell.offsetWidth / cell.colSpan - 22).toFixed(0),\n\n\t\t\t\t\tcellInfo = this.getCellInfo(cell),\n\t\t\t\t\trowIndex = cellInfo.rowIndex,\n\t\t\t\t\tcolIndex = cellInfo.colIndex,\n\t\t\t\t\tresults = [];\n\t\t\t\t// 修改Cell的rowSpan\n\t\t\t\tcell.colSpan = 1;\n\t\t\t\tcell.setAttribute(\"width\", backWidth);\n\t\t\t\tresults.push(cell);\n\t\t\t\t// 补齐单元格\n\t\t\t\tfor (var j = colIndex, endCol = colIndex + cellInfo.colSpan; j < endCol; j++) {\n\t\t\t\t\tif (j == colIndex) continue;\n\t\t\t\t\tvar tableRow = this.table.rows[rowIndex],\n\t\t\t\t\t\ttmpCell = tableRow.insertCell(this.indexTable[rowIndex][j].cellIndex + 1);\n\t\t\t\t\ttmpCell.rowSpan = cellInfo.rowSpan;\n\t\t\t\t\tthis.setCellContent(tmpCell);\n\t\t\t\t\ttmpCell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\ttmpCell.setAttribute('align', cell.getAttribute('align'));\n\t\t\t\t\ttmpCell.setAttribute('width', backWidth);\n\t\t\t\t\tif (cell.style.cssText) {\n\t\t\t\t\t\ttmpCell.style.cssText = cell.style.cssText;\n\t\t\t\t\t}\n\t\t\t\t\t//处理th的情况\n\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\tvar th = cell.ownerDocument.createElement('th');\n\t\t\t\t\t\tth.appendChild(tmpCell.firstChild);\n\t\t\t\t\t\tth.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\tth.rowSpan = tmpCell.rowSpan;\n\t\t\t\t\t\ttableRow.insertBefore(th, tmpCell);\n\t\t\t\t\t\tdomUtils.remove(tmpCell);\n\t\t\t\t\t}\n\t\t\t\t\tresults.push(tmpCell);\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t\treturn results;\n\t\t\t},\n\t\t\tisLastCell: function(cell, rowsNum, colsNum) {\n\t\t\t\trowsNum = rowsNum || this.rowsNum;\n\t\t\t\tcolsNum = colsNum || this.colsNum;\n\t\t\t\tvar cellInfo = this.getCellInfo(cell);\n\t\t\t\treturn ((cellInfo.rowIndex + cellInfo.rowSpan) == rowsNum) &&\n\t\t\t\t\t((cellInfo.colIndex + cellInfo.colSpan) == colsNum);\n\t\t\t},\n\t\t\tgetLastCell: function(cells) {\n\t\t\t\tcells = cells || this.table.getElementsByTagName(\"td\");\n\t\t\t\tvar firstInfo = this.getCellInfo(cells[0]);\n\t\t\t\tvar me = this,\n\t\t\t\t\tlast = cells[0],\n\t\t\t\t\ttr = last.parentNode,\n\t\t\t\t\tcellsNum = 0,\n\t\t\t\t\tcols = 0,\n\t\t\t\t\trows;\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tif (cell.parentNode == tr) cols += cell.colSpan || 1;\n\t\t\t\t\tcellsNum += cell.rowSpan * cell.colSpan || 1;\n\t\t\t\t});\n\t\t\t\trows = cellsNum / cols;\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tif (me.isLastCell(cell, rows, cols)) {\n\t\t\t\t\t\tlast = cell;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn last;\n\n\t\t\t},\n\t\t\tselectRow: function(rowIndex) {\n\t\t\t\tvar indexRow = this.indexTable[rowIndex],\n\t\t\t\t\tstart = this.getCell(indexRow[0].rowIndex, indexRow[0].cellIndex),\n\t\t\t\t\tend = this.getCell(indexRow[this.colsNum - 1].rowIndex, indexRow[this.colsNum - 1].cellIndex),\n\t\t\t\t\trange = this.getCellsRange(start, end);\n\t\t\t\tthis.setSelected(range);\n\t\t\t},\n\t\t\tselectTable: function() {\n\t\t\t\tvar tds = this.table.getElementsByTagName(\"td\"),\n\t\t\t\t\trange = this.getCellsRange(tds[0], tds[tds.length - 1]);\n\t\t\t\tthis.setSelected(range);\n\t\t\t},\n\t\t\tsetBackground: function(cells, value) {\n\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\tcell.style.backgroundColor = value;\n\t\t\t\t\t})\n\t\t\t\t} else if (typeof value === \"object\") {\n\t\t\t\t\tvalue = utils.extend({\n\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\tcolorList: [\"#ddd\", \"#fff\"]\n\t\t\t\t\t}, value);\n\t\t\t\t\tvar rowIndex = this.getCellInfo(cells[0]).rowIndex,\n\t\t\t\t\t\tcount = 0,\n\t\t\t\t\t\tcolors = value.colorList,\n\t\t\t\t\t\tgetColor = function(list, index, repeat) {\n\t\t\t\t\t\t\treturn list[index] ? list[index] : repeat ? list[index % list.length] : \"\";\n\t\t\t\t\t\t};\n\t\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\t\tvar cellInfo = this.getCellInfo(cell);\n\t\t\t\t\t\tcell.style.backgroundColor = getColor(colors, ((rowIndex + count) == cellInfo.rowIndex) ? count : ++count, value.repeat);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveBackground: function(cells) {\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tcell.style.backgroundColor = \"\";\n\t\t\t\t})\n\t\t\t}\n\n\t\t};\n\n\t\tfunction showError(e) {}\n\t})();\n\n\t// plugins/table.cmds.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: taoqili\n\t * Date: 13-2-20\n\t * Time: 下午6:25\n\t * To change this template use File | Settings | File Templates.\n\t */\n\t;\n\t(function() {\n\t\tvar UT = UE.UETable,\n\t\t\tgetTableItemsByRange = function(editor) {\n\t\t\t\treturn UT.getTableItemsByRange(editor);\n\t\t\t},\n\t\t\tgetUETableBySelected = function(editor) {\n\t\t\t\treturn UT.getUETableBySelected(editor)\n\t\t\t},\n\t\t\tgetDefaultValue = function(editor, table) {\n\t\t\t\treturn UT.getDefaultValue(editor, table);\n\t\t\t},\n\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t};\n\n\t\tUE.commands['inserttable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? -1 : 0;\n\t\t\t},\n\t\t\texecCommand: function(cmd, opt) {\n\t\t\t\tfunction createTable(opt, tdWidth) {\n\t\t\t\t\tvar html = [],\n\t\t\t\t\t\trowsNum = opt.numRows,\n\t\t\t\t\t\tcolsNum = opt.numCols;\n\t\t\t\t\tfor (var r = 0; r < rowsNum; r++) {\n\t\t\t\t\t\thtml.push('<tr' + (r == 0 ? ' class=\"firstRow\"' : '') + '>');\n\t\t\t\t\t\tfor (var c = 0; c < colsNum; c++) {\n\t\t\t\t\t\t\thtml.push('<td width=\"' + tdWidth + '\"  vAlign=\"' + opt.tdvalign + '\" >' + (browser.ie && browser.version < 11 ? domUtils.fillChar : '<br/>') + '</td>')\n\t\t\t\t\t\t}\n\t\t\t\t\t\thtml.push('</tr>')\n\t\t\t\t\t}\n\t\t\t\t\t//禁止指定table-width\n\t\t\t\t\treturn '<table><tbody>' + html.join('') + '</tbody></table>'\n\t\t\t\t}\n\n\t\t\t\tif (!opt) {\n\t\t\t\t\topt = utils.extend({}, {\n\t\t\t\t\t\tnumCols: this.options.defaultCols,\n\t\t\t\t\t\tnumRows: this.options.defaultRows,\n\t\t\t\t\t\ttdvalign: this.options.tdvalign\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tvar me = this;\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tstart = range.startContainer,\n\t\t\t\t\tfirstParentBlock = domUtils.findParent(start, function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node);\n\t\t\t\t\t}, true) || me.body;\n\n\t\t\t\tvar defaultValue = getDefaultValue(me),\n\t\t\t\t\ttableWidth = firstParentBlock.offsetWidth,\n\t\t\t\t\ttdWidth = Math.floor(tableWidth / opt.numCols - defaultValue.tdPadding * 2 - defaultValue.tdBorder);\n\n\t\t\t\t//todo其他属性\n\t\t\t\t!opt.tdvalign && (opt.tdvalign = me.options.tdvalign);\n\t\t\t\tme.execCommand(\"inserthtml\", createTable(opt, tdWidth));\n\t\t\t}\n\t\t};\n\n\t\tUE.commands['insertparagraphbeforetable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).cell ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar p = this.document.createElement(\"p\");\n\t\t\t\t\tp.innerHTML = browser.ie ? '&nbsp;' : '<br />';\n\t\t\t\t\ttable.parentNode.insertBefore(p, table);\n\t\t\t\t\tthis.selection.getRange().setStart(p, 0).setCursor();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tUE.commands['deletetable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\treturn domUtils.findParentByTagName(rng.startContainer, 'table', true) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd, table) {\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\ttable = table || domUtils.findParentByTagName(rng.startContainer, 'table', true);\n\t\t\t\tif (table) {\n\t\t\t\t\tvar next = table.nextSibling;\n\t\t\t\t\tif (!next) {\n\t\t\t\t\t\tnext = domUtils.createElement(this.document, 'p', {\n\t\t\t\t\t\t\t'innerHTML': browser.ie ? domUtils.fillChar : '<br/>'\n\t\t\t\t\t\t});\n\t\t\t\t\t\ttable.parentNode.insertBefore(next, table);\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\trng = this.selection.getRange();\n\t\t\t\t\tif (next.nodeType == 3) {\n\t\t\t\t\t\trng.setStartBefore(next)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.setStart(next, 0)\n\t\t\t\t\t}\n\t\t\t\t\trng.setCursor(false, true)\n\t\t\t\t\tthis.fireEvent(\"tablehasdeleted\")\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands['cellalign'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getSelectedArr(this).length ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, align) {\n\t\t\t\tvar selectedTds = getSelectedArr(this);\n\t\t\t\tif (selectedTds.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = selectedTds[i++];) {\n\t\t\t\t\t\tci.setAttribute('align', align);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands['cellvalign'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getSelectedArr(this).length ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd, valign) {\n\t\t\t\tvar selectedTds = getSelectedArr(this);\n\t\t\t\tif (selectedTds.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = selectedTds[i++];) {\n\t\t\t\t\t\tci.setAttribute('vAlign', valign);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands['insertcaption'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\treturn table.getElementsByTagName('caption').length == 0 ? 1 : -1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar caption = this.document.createElement('caption');\n\t\t\t\t\tcaption.innerHTML = browser.ie ? domUtils.fillChar : '<br/>';\n\t\t\t\t\ttable.insertBefore(caption, table.firstChild);\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\trange.setStart(caption, 0).setCursor();\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands['deletecaption'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\treturn table.getElementsByTagName('caption').length == 0 ? -1 : 1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\tdomUtils.remove(table.getElementsByTagName('caption')[0]);\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\trange.setStart(table.rows[0].cells[0], 0).setCursor();\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands['inserttitle'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar firstRow = table.rows[0];\n\t\t\t\t\treturn firstRow.cells[firstRow.cells.length - 1].tagName.toLowerCase() != 'th' ? 0 : -1\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tgetUETable(table).insertRow(0, 'th');\n\t\t\t\t}\n\t\t\t\tvar th = table.getElementsByTagName('th')[0];\n\t\t\t\tthis.selection.getRange().setStart(th, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\t\tUE.commands['deletetitle'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar firstRow = table.rows[0];\n\t\t\t\t\treturn firstRow.cells[firstRow.cells.length - 1].tagName.toLowerCase() == 'th' ? 0 : -1\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tdomUtils.remove(table.rows[0])\n\t\t\t\t}\n\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\tthis.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\t\tUE.commands['inserttitlecol'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar lastRow = table.rows[table.rows.length - 1];\n\t\t\t\t\treturn lastRow.getElementsByTagName('th').length ? -1 : 0;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tgetUETable(table).insertCol(0, 'th');\n\t\t\t\t}\n\t\t\t\tresetTdWidth(table, this);\n\t\t\t\tvar th = table.getElementsByTagName('th')[0];\n\t\t\t\tthis.selection.getRange().setStart(th, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\t\tUE.commands['deletetitlecol'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar lastRow = table.rows[table.rows.length - 1];\n\t\t\t\t\treturn lastRow.getElementsByTagName('th').length ? 0 : -1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tfor (var i = 0; i < table.rows.length; i++) {\n\t\t\t\t\t\tdomUtils.remove(table.rows[i].children[0])\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresetTdWidth(table, this);\n\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\tthis.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"mergeright\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tcell = tableItems.cell;\n\n\t\t\t\tif (!table || !cell) return -1;\n\t\t\t\tvar ut = getUETable(table);\n\t\t\t\tif (ut.selectedTds.length) return -1;\n\n\t\t\t\tvar cellInfo = ut.getCellInfo(cell),\n\t\t\t\t\trightColIndex = cellInfo.colIndex + cellInfo.colSpan;\n\t\t\t\tif (rightColIndex >= ut.colsNum) return -1; // 如果处于最右边则不能向右合并\n\n\t\t\t\tvar rightCellInfo = ut.indexTable[cellInfo.rowIndex][rightColIndex],\n\t\t\t\t\trightCell = table.rows[rightCellInfo.rowIndex].cells[rightCellInfo.cellIndex];\n\t\t\t\tif (!rightCell || cell.tagName != rightCell.tagName) return -1; // TH和TD不能相互合并\n\n\t\t\t\t// 当且仅当两个Cell的开始列号和结束列号一致时能进行合并\n\t\t\t\treturn (rightCellInfo.rowIndex == cellInfo.rowIndex && rightCellInfo.rowSpan == cellInfo.rowSpan) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.mergeRight(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"mergedown\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tcell = tableItems.cell;\n\n\t\t\t\tif (!table || !cell) return -1;\n\t\t\t\tvar ut = getUETable(table);\n\t\t\t\tif (ut.selectedTds.length) return -1;\n\n\t\t\t\tvar cellInfo = ut.getCellInfo(cell),\n\t\t\t\t\tdownRowIndex = cellInfo.rowIndex + cellInfo.rowSpan;\n\t\t\t\tif (downRowIndex >= ut.rowsNum) return -1; // 如果处于最下边则不能向下合并\n\n\t\t\t\tvar downCellInfo = ut.indexTable[downRowIndex][cellInfo.colIndex],\n\t\t\t\t\tdownCell = table.rows[downCellInfo.rowIndex].cells[downCellInfo.cellIndex];\n\t\t\t\tif (!downCell || cell.tagName != downCell.tagName) return -1; // TH和TD不能相互合并\n\n\t\t\t\t// 当且仅当两个Cell的开始列号和结束列号一致时能进行合并\n\t\t\t\treturn (downCellInfo.colIndex == cellInfo.colIndex && downCellInfo.colSpan == cellInfo.colSpan) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.mergeDown(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"mergecells\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getUETableBySelected(this) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\tvar cell = ut.selectedTds[0];\n\t\t\t\t\tut.mergeRange();\n\t\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\t\tif (domUtils.isEmptyBlock(cell)) {\n\t\t\t\t\t\trng.setStart(cell, 0).collapse(true)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.selectNodeContents(cell)\n\t\t\t\t\t}\n\t\t\t\t\trng.select();\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"insertrow\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && (cell.tagName == \"TD\" || (cell.tagName == 'TH' && tableItems.tr !== tableItems.table.rows[0])) &&\n\t\t\t\t\tgetUETable(tableItems.table).rowsNum < this.options.maxRowNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tut = getUETable(table),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t//ut.insertRow(!ut.selectedTds.length ? cellInfo.rowIndex:ut.cellsRange.beginRowIndex,'');\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertRow(cellInfo.rowIndex, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endRowIndex - range.beginRowIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertRow(range.beginRowIndex, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t}\n\t\t};\n\t\t//后插入行\n\t\tUE.commands[\"insertrownext\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && (cell.tagName == \"TD\") && getUETable(tableItems.table).rowsNum < this.options.maxRowNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tut = getUETable(table),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t//ut.insertRow(!ut.selectedTds.length? cellInfo.rowIndex + cellInfo.rowSpan : ut.cellsRange.endRowIndex + 1,'');\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertRow(cellInfo.rowIndex + cellInfo.rowSpan, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endRowIndex - range.beginRowIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertRow(range.endRowIndex + 1, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"deleterow\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this);\n\t\t\t\treturn tableItems.cell ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\tcellsRange = ut.cellsRange,\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell),\n\t\t\t\t\tpreCell = ut.getVSideCell(cell),\n\t\t\t\t\tnextCell = ut.getVSideCell(cell, true),\n\t\t\t\t\trng = this.selection.getRange();\n\t\t\t\tif (utils.isEmptyObject(cellsRange)) {\n\t\t\t\t\tut.deleteRow(cellInfo.rowIndex);\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = cellsRange.beginRowIndex; i < cellsRange.endRowIndex + 1; i++) {\n\t\t\t\t\t\tut.deleteRow(cellsRange.beginRowIndex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar table = ut.table;\n\t\t\t\tif (!table.getElementsByTagName('td').length) {\n\t\t\t\t\tvar nextSibling = table.nextSibling;\n\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\tif (nextSibling) {\n\t\t\t\t\t\trng.setStart(nextSibling, 0).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (cellInfo.rowSpan == 1 || cellInfo.rowSpan == cellsRange.endRowIndex - cellsRange.beginRowIndex + 1) {\n\t\t\t\t\t\tif (nextCell || preCell) rng.selectNodeContents(nextCell || preCell).setCursor(false, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar newCell = ut.getCell(cellInfo.rowIndex, ut.indexTable[cellInfo.rowIndex][cellInfo.colIndex].cellIndex);\n\t\t\t\t\t\tif (newCell) rng.selectNodeContents(newCell).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"insertcol\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && (cell.tagName == \"TD\" || (cell.tagName == 'TH' && cell !== tableItems.tr.cells[0])) &&\n\t\t\t\t\tgetUETable(tableItems.table).colsNum < this.options.maxColNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tif (this.queryCommandState(cmd) == -1) return;\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\n\t\t\t\t//ut.insertCol(!ut.selectedTds.length ? cellInfo.colIndex:ut.cellsRange.beginColIndex);\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertCol(cellInfo.colIndex, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endColIndex - range.beginColIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertCol(range.beginColIndex, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select(true);\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"insertcolnext\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && getUETable(tableItems.table).colsNum < this.options.maxColNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t//ut.insertCol(!ut.selectedTds.length ? cellInfo.colIndex + cellInfo.colSpan:ut.cellsRange.endColIndex +1);\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertCol(cellInfo.colIndex + cellInfo.colSpan, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endColIndex - range.beginColIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertCol(range.endColIndex + 1, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"deletecol\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this);\n\t\t\t\treturn tableItems.cell ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\trange = ut.cellsRange,\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell),\n\t\t\t\t\tpreCell = ut.getHSideCell(cell),\n\t\t\t\t\tnextCell = ut.getHSideCell(cell, true);\n\t\t\t\tif (utils.isEmptyObject(range)) {\n\t\t\t\t\tut.deleteCol(cellInfo.colIndex);\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = range.beginColIndex; i < range.endColIndex + 1; i++) {\n\t\t\t\t\t\tut.deleteCol(range.beginColIndex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar table = ut.table,\n\t\t\t\t\trng = this.selection.getRange();\n\n\t\t\t\tif (!table.getElementsByTagName('td').length) {\n\t\t\t\t\tvar nextSibling = table.nextSibling;\n\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\tif (nextSibling) {\n\t\t\t\t\t\trng.setStart(nextSibling, 0).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (domUtils.inDoc(cell, this.document)) {\n\t\t\t\t\t\trng.setStart(cell, 0).setCursor(false, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (nextCell && domUtils.inDoc(nextCell, this.document)) {\n\t\t\t\t\t\t\trng.selectNodeContents(nextCell).setCursor(false, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (preCell && domUtils.inDoc(preCell, this.document)) {\n\t\t\t\t\t\t\t\trng.selectNodeContents(preCell).setCursor(true, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"splittocells\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\tif (!cell) return -1;\n\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\treturn cell && (cell.colSpan > 1 || cell.rowSpan > 1) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.splitToCells(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"splittorows\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\tif (!cell) return -1;\n\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\treturn cell && cell.rowSpan > 1 ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.splitToRows(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"splittocols\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\tif (!cell) return -1;\n\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\treturn cell && cell.colSpan > 1 ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.splitToCols(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"adaptbytext\"] =\n\t\t\tUE.commands[\"adaptbywindow\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\ttable = tableItems.table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tif (cmd == 'adaptbywindow') {\n\t\t\t\t\t\t\tresetTdWidth(table, this);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar cells = domUtils.getElementsByTagName(table, \"td th\");\n\t\t\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\t\t\tcell.removeAttribute(\"width\");\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\ttable.removeAttribute(\"width\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t//平均分配各列\n\t\tUE.commands['averagedistributecol'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\tif (!ut) return -1;\n\t\t\t\treturn ut.isFullRow() || ut.isFullCol() ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tfunction getAverageWidth() {\n\t\t\t\t\tvar tb = ut.table,\n\t\t\t\t\t\taverageWidth, sumWidth = 0,\n\t\t\t\t\t\tcolsNum = 0,\n\t\t\t\t\t\ttbAttr = getDefaultValue(me, tb);\n\n\t\t\t\t\tif (ut.isFullRow()) {\n\t\t\t\t\t\tsumWidth = tb.offsetWidth;\n\t\t\t\t\t\tcolsNum = ut.colsNum;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar begin = ut.cellsRange.beginColIndex,\n\t\t\t\t\t\t\tend = ut.cellsRange.endColIndex,\n\t\t\t\t\t\t\tnode;\n\t\t\t\t\t\tfor (var i = begin; i <= end;) {\n\t\t\t\t\t\t\tnode = ut.selectedTds[i];\n\t\t\t\t\t\t\tsumWidth += node.offsetWidth;\n\t\t\t\t\t\t\ti += node.colSpan;\n\t\t\t\t\t\t\tcolsNum += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\taverageWidth = Math.ceil(sumWidth / colsNum) - tbAttr.tdBorder * 2 - tbAttr.tdPadding * 2;\n\t\t\t\t\treturn averageWidth;\n\t\t\t\t}\n\n\t\t\t\tfunction setAverageWidth(averageWidth) {\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(ut.table, \"th\"), function(node) {\n\t\t\t\t\t\tnode.setAttribute(\"width\", \"\");\n\t\t\t\t\t});\n\t\t\t\t\tvar cells = ut.isFullRow() ? domUtils.getElementsByTagName(ut.table, \"td\") : ut.selectedTds;\n\n\t\t\t\t\tutils.each(cells, function(node) {\n\t\t\t\t\t\tif (node.colSpan == 1) {\n\t\t\t\t\t\t\tnode.setAttribute(\"width\", averageWidth);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\tsetAverageWidth(getAverageWidth());\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t//平均分配各行\n\t\tUE.commands['averagedistributerow'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\tif (!ut) return -1;\n\t\t\t\tif (ut.selectedTds && /th/ig.test(ut.selectedTds[0].tagName)) return -1;\n\t\t\t\treturn ut.isFullRow() || ut.isFullCol() ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tfunction getAverageHeight() {\n\t\t\t\t\tvar averageHeight, rowNum, sumHeight = 0,\n\t\t\t\t\t\ttb = ut.table,\n\t\t\t\t\t\ttbAttr = getDefaultValue(me, tb),\n\t\t\t\t\t\ttdpadding = parseInt(domUtils.getComputedStyle(tb.getElementsByTagName('td')[0], \"padding-top\"));\n\n\t\t\t\t\tif (ut.isFullCol()) {\n\t\t\t\t\t\tvar captionArr = domUtils.getElementsByTagName(tb, \"caption\"),\n\t\t\t\t\t\t\tthArr = domUtils.getElementsByTagName(tb, \"th\"),\n\t\t\t\t\t\t\tcaptionHeight, thHeight;\n\n\t\t\t\t\t\tif (captionArr.length > 0) {\n\t\t\t\t\t\t\tcaptionHeight = captionArr[0].offsetHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (thArr.length > 0) {\n\t\t\t\t\t\t\tthHeight = thArr[0].offsetHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsumHeight = tb.offsetHeight - (captionHeight || 0) - (thHeight || 0);\n\t\t\t\t\t\trowNum = thArr.length == 0 ? ut.rowsNum : (ut.rowsNum - 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar begin = ut.cellsRange.beginRowIndex,\n\t\t\t\t\t\t\tend = ut.cellsRange.endRowIndex,\n\t\t\t\t\t\t\tcount = 0,\n\t\t\t\t\t\t\ttrs = domUtils.getElementsByTagName(tb, \"tr\");\n\t\t\t\t\t\tfor (var i = begin; i <= end; i++) {\n\t\t\t\t\t\t\tsumHeight += trs[i].offsetHeight;\n\t\t\t\t\t\t\tcount += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trowNum = count;\n\t\t\t\t\t}\n\t\t\t\t\t//ie8下是混杂模式\n\t\t\t\t\tif (browser.ie && browser.version < 9) {\n\t\t\t\t\t\taverageHeight = Math.ceil(sumHeight / rowNum);\n\t\t\t\t\t} else {\n\t\t\t\t\t\taverageHeight = Math.ceil(sumHeight / rowNum) - tbAttr.tdBorder * 2 - tdpadding * 2;\n\t\t\t\t\t}\n\t\t\t\t\treturn averageHeight;\n\t\t\t\t}\n\n\t\t\t\tfunction setAverageHeight(averageHeight) {\n\t\t\t\t\tvar cells = ut.isFullCol() ? domUtils.getElementsByTagName(ut.table, \"td\") : ut.selectedTds;\n\t\t\t\t\tutils.each(cells, function(node) {\n\t\t\t\t\t\tif (node.rowSpan == 1) {\n\t\t\t\t\t\t\tnode.setAttribute(\"height\", averageHeight);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\tsetAverageHeight(getAverageHeight());\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//单元格对齐方式\n\t\tUE.commands['cellalignment'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, data) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tif (!ut) {\n\t\t\t\t\tvar start = me.selection.getStart(),\n\t\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\t\t\t\tif (!/caption/ig.test(cell.tagName)) {\n\t\t\t\t\t\tdomUtils.setAttributes(cell, data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.style.textAlign = data.align;\n\t\t\t\t\t\tcell.style.verticalAlign = data.vAlign;\n\t\t\t\t\t}\n\t\t\t\t\tme.selection.getRange().setCursor(true);\n\t\t\t\t} else {\n\t\t\t\t\tutils.each(ut.selectedTds, function(cell) {\n\t\t\t\t\t\tdomUtils.setAttributes(cell, data);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 查询当前点击的单元格的对齐状态， 如果当前已经选择了多个单元格， 则会返回所有单元格经过统一协调过后的状态\n\t\t\t * @see UE.UETable.getTableCellAlignState\n\t\t\t */\n\t\t\tqueryCommandValue: function(cmd) {\n\n\t\t\t\tvar activeMenuCell = getTableItemsByRange(this).cell;\n\n\t\t\t\tif (!activeMenuCell) {\n\t\t\t\t\tactiveMenuCell = getSelectedArr(this)[0];\n\t\t\t\t}\n\n\t\t\t\tif (!activeMenuCell) {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t//获取同时选中的其他单元格\n\t\t\t\t\tvar cells = UE.UETable.getUETable(activeMenuCell).selectedTds;\n\n\t\t\t\t\t!cells.length && (cells = activeMenuCell);\n\n\t\t\t\t\treturn UE.UETable.getTableCellAlignState(cells);\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\t//表格对齐方式\n\t\tUE.commands['tablealignment'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tif (browser.ie && browser.version < 8) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, value) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tstart = me.selection.getStart(),\n\t\t\t\t\ttable = start && domUtils.findParentByTagName(start, [\"table\"], true);\n\n\t\t\t\tif (table) {\n\t\t\t\t\ttable.setAttribute(\"align\", value);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//表格属性\n\t\tUE.commands['edittable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, color) {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\tvar arr = domUtils.getElementsByTagName(table, \"td\").concat(\n\t\t\t\t\t\tdomUtils.getElementsByTagName(table, \"th\"),\n\t\t\t\t\t\tdomUtils.getElementsByTagName(table, \"caption\")\n\t\t\t\t\t);\n\t\t\t\t\tutils.each(arr, function(node) {\n\t\t\t\t\t\tnode.style.borderColor = color;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t//单元格属性\n\t\tUE.commands['edittd'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, bkColor) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tif (!ut) {\n\t\t\t\t\tvar start = me.selection.getStart(),\n\t\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\t\t\t\tif (cell) {\n\t\t\t\t\t\tcell.style.backgroundColor = bkColor;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tutils.each(ut.selectedTds, function(cell) {\n\t\t\t\t\t\tcell.style.backgroundColor = bkColor;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"settablebackground\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getSelectedArr(this).length > 1 ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd, value) {\n\t\t\t\tvar cells, ut;\n\t\t\t\tcells = getSelectedArr(this);\n\t\t\t\tut = getUETable(cells[0]);\n\t\t\t\tut.setBackground(cells, value);\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"cleartablebackground\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar cells = getSelectedArr(this);\n\t\t\t\tif (!cells.length) return -1;\n\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\tif (cell.style.backgroundColor !== \"\") return 0;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar cells = getSelectedArr(this),\n\t\t\t\t\tut = getUETable(cells[0]);\n\t\t\t\tut.removeBackground(cells);\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"interlacetable\"] = UE.commands[\"uninterlacetable\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (!table) return -1;\n\t\t\t\tvar interlaced = table.getAttribute(\"interlaced\");\n\t\t\t\tif (cmd == \"interlacetable\") {\n\t\t\t\t\t//TODO 待定\n\t\t\t\t\t//是否需要待定，如果设置，则命令只能单次执行成功，但反射具备toggle效果；否则可以覆盖前次命令，但反射将不存在toggle效果\n\t\t\t\t\treturn (interlaced === \"enabled\") ? -1 : 0;\n\t\t\t\t} else {\n\t\t\t\t\treturn (!interlaced || interlaced === \"disabled\") ? -1 : 0;\n\t\t\t\t}\n\t\t\t},\n\t\t\texecCommand: function(cmd, classList) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (cmd == \"interlacetable\") {\n\t\t\t\t\ttable.setAttribute(\"interlaced\", \"enabled\");\n\t\t\t\t\tthis.fireEvent(\"interlacetable\", table, classList);\n\t\t\t\t} else {\n\t\t\t\t\ttable.setAttribute(\"interlaced\", \"disabled\");\n\t\t\t\t\tthis.fireEvent(\"uninterlacetable\", table);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"setbordervisible\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (!table) return -1;\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tutils.each(domUtils.getElementsByTagName(table, 'td'), function(td) {\n\t\t\t\t\ttd.style.borderWidth = '1px';\n\t\t\t\t\ttd.style.borderStyle = 'solid';\n\t\t\t\t})\n\t\t\t}\n\t\t};\n\n\t\tfunction resetTdWidth(table, editor) {\n\t\t\tvar tds = domUtils.getElementsByTagName(table, 'td th');\n\t\t\tutils.each(tds, function(td) {\n\t\t\t\ttd.removeAttribute(\"width\");\n\t\t\t});\n\t\t\ttable.setAttribute('width', getTableWidth(editor, true, getDefaultValue(editor, table)));\n\t\t\tvar tdsWidths = [];\n\t\t\tsetTimeout(function() {\n\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t(td.colSpan == 1) && tdsWidths.push(td.offsetWidth)\n\t\t\t\t})\n\t\t\t\tutils.each(tds, function(td, i) {\n\t\t\t\t\t(td.colSpan == 1) && td.setAttribute(\"width\", tdsWidths[i] + \"\");\n\t\t\t\t})\n\t\t\t}, 0);\n\t\t}\n\n\t\tfunction getTableWidth(editor, needIEHack, defaultValue) {\n\t\t\tvar body = editor.body;\n\t\t\treturn body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (editor.options.offsetWidth || 0);\n\t\t}\n\n\t\tfunction getSelectedArr(editor) {\n\t\t\tvar cell = getTableItemsByRange(editor).cell;\n\t\t\tif (cell) {\n\t\t\t\tvar ut = getUETable(cell);\n\t\t\t\treturn ut.selectedTds.length ? ut.selectedTds : [cell];\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}\n\t})();\n\n\t// plugins/table.action.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: taoqili\n\t * Date: 12-10-12\n\t * Time: 上午10:05\n\t * To change this template use File | Settings | File Templates.\n\t */\n\tUE.plugins['table'] = function() {\n\t\tvar me = this,\n\t\t\ttabTimer = null,\n\t\t\t//拖动计时器\n\t\t\ttableDragTimer = null,\n\t\t\t//双击计时器\n\t\t\ttableResizeTimer = null,\n\t\t\t//单元格最小宽度\n\t\t\tcellMinWidth = 5,\n\t\t\tisInResizeBuffer = false,\n\t\t\t//单元格边框大小\n\t\t\tcellBorderWidth = 5,\n\t\t\t//鼠标偏移距离\n\t\t\toffsetOfTableCell = 10,\n\t\t\t//记录在有限时间内的点击状态， 共有3个取值， 0, 1, 2。 0代表未初始化， 1代表单击了1次，2代表2次\n\t\t\tsingleClickState = 0,\n\t\t\tuserActionStatus = null,\n\t\t\t//双击允许的时间范围\n\t\t\tdblclickTime = 360,\n\t\t\tUT = UE.UETable,\n\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t},\n\t\t\tgetUETableBySelected = function(editor) {\n\t\t\t\treturn UT.getUETableBySelected(editor);\n\t\t\t},\n\t\t\tgetDefaultValue = function(editor, table) {\n\t\t\t\treturn UT.getDefaultValue(editor, table);\n\t\t\t},\n\t\t\tremoveSelectedClass = function(cells) {\n\t\t\t\treturn UT.removeSelectedClass(cells);\n\t\t\t};\n\n\t\tfunction showError(e) {\n\t\t\t//        throw e;\n\t\t}\n\t\tme.ready(function() {\n\t\t\tvar me = this;\n\t\t\tvar orgGetText = me.selection.getText;\n\t\t\tme.selection.getText = function() {\n\t\t\t\tvar table = getUETableBySelected(me);\n\t\t\t\tif (table) {\n\t\t\t\t\tvar str = '';\n\t\t\t\t\tutils.each(table.selectedTds, function(td) {\n\t\t\t\t\t\tstr += td[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\t\t})\n\t\t\t\t\treturn str;\n\t\t\t\t} else {\n\t\t\t\t\treturn orgGetText.call(me.selection)\n\t\t\t\t}\n\n\t\t\t}\n\t\t})\n\n\t\t//处理拖动及框选相关方法\n\t\tvar startTd = null, //鼠标按下时的锚点td\n\t\t\tcurrentTd = null, //当前鼠标经过时的td\n\t\t\tonDrag = \"\", //指示当前拖动状态，其值可为\"\",\"h\",\"v\" ,分别表示未拖动状态，横向拖动状态，纵向拖动状态，用于鼠标移动过程中的判断\n\t\t\tonBorder = false, //检测鼠标按下时是否处在单元格边缘位置\n\t\t\tdragButton = null,\n\t\t\tdragOver = false,\n\t\t\tdragLine = null, //模拟的拖动线\n\t\t\tdragTd = null; //发生拖动的目标td\n\n\t\tvar mousedown = false,\n\t\t\t//todo 判断混乱模式\n\t\t\tneedIEHack = true;\n\n\t\tme.setOpt({\n\t\t\t'maxColNum': 20,\n\t\t\t'maxRowNum': 100,\n\t\t\t'defaultCols': 5,\n\t\t\t'defaultRows': 5,\n\t\t\t'tdvalign': 'top',\n\t\t\t'cursorpath': me.options.UEDITOR_HOME_URL + \"themes/default/images/cursor_\",\n\t\t\t'tableDragable': false,\n\t\t\t'classList': [\"ue-table-interlace-color-single\", \"ue-table-interlace-color-double\"]\n\t\t});\n\t\tme.getUETable = getUETable;\n\t\tvar commands = {\n\t\t\t'deletetable': 1,\n\t\t\t'inserttable': 1,\n\t\t\t'cellvalign': 1,\n\t\t\t'insertcaption': 1,\n\t\t\t'deletecaption': 1,\n\t\t\t'inserttitle': 1,\n\t\t\t'deletetitle': 1,\n\t\t\t\"mergeright\": 1,\n\t\t\t\"mergedown\": 1,\n\t\t\t\"mergecells\": 1,\n\t\t\t\"insertrow\": 1,\n\t\t\t\"insertrownext\": 1,\n\t\t\t\"deleterow\": 1,\n\t\t\t\"insertcol\": 1,\n\t\t\t\"insertcolnext\": 1,\n\t\t\t\"deletecol\": 1,\n\t\t\t\"splittocells\": 1,\n\t\t\t\"splittorows\": 1,\n\t\t\t\"splittocols\": 1,\n\t\t\t\"adaptbytext\": 1,\n\t\t\t\"adaptbywindow\": 1,\n\t\t\t\"adaptbycustomer\": 1,\n\t\t\t\"insertparagraph\": 1,\n\t\t\t\"insertparagraphbeforetable\": 1,\n\t\t\t\"averagedistributecol\": 1,\n\t\t\t\"averagedistributerow\": 1\n\t\t};\n\t\tme.ready(function() {\n\t\t\tutils.cssRule('table',\n\t\t\t\t//选中的td上的样式\n\t\t\t\t'.selectTdClass{background-color:#edf5fa !important}' +\n\t\t\t\t'table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}' +\n\t\t\t\t//插入的表格的默认样式\n\t\t\t\t'table{margin-bottom:10px;border-collapse:collapse;display:table;}' +\n\t\t\t\t'td,th{padding: 5px 10px;border: 1px solid #DDD;}' +\n\t\t\t\t'caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}' +\n\t\t\t\t'th{border-top:1px solid #BBB;background-color:#F7F7F7;}' +\n\t\t\t\t'table tr.firstRow th{border-top-width:2px;}' +\n\t\t\t\t'.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }' +\n\t\t\t\t'td p{margin:0;padding:0;}', me.document);\n\n\t\t\tvar tableCopyList, isFullCol, isFullRow;\n\t\t\t//注册del/backspace事件\n\t\t\tme.addListener('keydown', function(cmd, evt) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\n\t\t\t\tif (keyCode == 8) {\n\n\t\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\t\tif (ut && ut.selectedTds.length) {\n\n\t\t\t\t\t\tif (ut.isFullCol()) {\n\t\t\t\t\t\t\tme.execCommand('deletecol')\n\t\t\t\t\t\t} else if (ut.isFullRow()) {\n\t\t\t\t\t\t\tme.execCommand('deleterow')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.fireEvent('delcells');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar caption = domUtils.findParentByTagName(me.selection.getStart(), 'caption', true),\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (range.collapsed && caption && isEmptyBlock(caption)) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tvar table = caption.parentNode;\n\t\t\t\t\t\tdomUtils.remove(caption);\n\t\t\t\t\t\tif (table) {\n\t\t\t\t\t\t\trange.setStart(table.rows[0].cells[0], 0).setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (keyCode == 46) {\n\n\t\t\t\t\tut = getUETableBySelected(me);\n\t\t\t\t\tif (ut) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tfor (var i = 0, ci; ci = ut.selectedTds[i++];) {\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, ci)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif (keyCode == 13) {\n\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tcaption = domUtils.findParentByTagName(rng.startContainer, 'caption', true);\n\t\t\t\t\tif (caption) {\n\t\t\t\t\t\tvar table = domUtils.findParentByTagName(caption, 'table');\n\t\t\t\t\t\tif (!rng.collapsed) {\n\n\t\t\t\t\t\t\trng.deleteContents();\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (caption) {\n\t\t\t\t\t\t\t\trng.setStart(table.rows[0].cells[0], 0).setCursor(false, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\tvar table = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\t\t\tif (table) {\n\t\t\t\t\t\t\tvar cell = table.rows[0].cells[0],\n\t\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(me.selection.getStart(), ['td', 'th'], true),\n\t\t\t\t\t\t\t\tpreNode = table.previousSibling;\n\t\t\t\t\t\t\tif (cell === start && (!preNode || preNode.nodeType == 1 && preNode.tagName == 'TABLE') && domUtils.isStartInblock(rng)) {\n\t\t\t\t\t\t\t\tvar first = domUtils.findParent(me.selection.getStart(), function(n) {\n\t\t\t\t\t\t\t\t\treturn domUtils.isBlockElm(n)\n\t\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\t\tif (first && (/t(h|d)/i.test(first.tagName) || first === start.firstChild)) {\n\t\t\t\t\t\t\t\t\tme.execCommand('insertparagraphbeforetable');\n\t\t\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ((evt.ctrlKey || evt.metaKey) && evt.keyCode == '67') {\n\t\t\t\t\ttableCopyList = null;\n\t\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\t\tif (ut) {\n\t\t\t\t\t\tvar tds = ut.selectedTds;\n\t\t\t\t\t\tisFullCol = ut.isFullCol();\n\t\t\t\t\t\tisFullRow = ut.isFullRow();\n\t\t\t\t\t\ttableCopyList = [\n\t\t\t\t\t\t\t[ut.cloneCell(tds[0], null, true)]\n\t\t\t\t\t\t];\n\t\t\t\t\t\tfor (var i = 1, ci; ci = tds[i]; i++) {\n\t\t\t\t\t\t\tif (ci.parentNode !== tds[i - 1].parentNode) {\n\t\t\t\t\t\t\t\ttableCopyList.push([ut.cloneCell(ci, null, true)]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttableCopyList[tableCopyList.length - 1].push(ut.cloneCell(ci, null, true));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tme.addListener(\"tablehasdeleted\", function() {\n\t\t\t\ttoggleDraggableState(this, false, \"\", null);\n\t\t\t\tif (dragButton) domUtils.remove(dragButton);\n\t\t\t});\n\n\t\t\tme.addListener('beforepaste', function(cmd, html) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tif (domUtils.findParentByTagName(rng.startContainer, 'caption', true)) {\n\t\t\t\t\tvar div = me.document.createElement(\"div\");\n\t\t\t\t\tdiv.innerHTML = html.html;\n\t\t\t\t\t//trace:3729\n\t\t\t\t\thtml.html = div[browser.ie9below ? 'innerText' : 'textContent'];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar table = getUETableBySelected(me);\n\t\t\t\tif (tableCopyList) {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tvar td = domUtils.findParentByTagName(rng.startContainer, ['td', 'th'], true),\n\t\t\t\t\t\ttmpNode, preNode;\n\t\t\t\t\tif (td) {\n\t\t\t\t\t\tvar ut = getUETable(td);\n\t\t\t\t\t\tif (isFullRow) {\n\t\t\t\t\t\t\tvar rowIndex = ut.getCellInfo(td).rowIndex;\n\t\t\t\t\t\t\tif (td.tagName == 'TH') {\n\t\t\t\t\t\t\t\trowIndex++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\t\tvar tr = ut.insertRow(rowIndex++, \"td\");\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j]; j++) {\n\t\t\t\t\t\t\t\t\tvar cell = tr.cells[j];\n\t\t\t\t\t\t\t\t\tif (!cell) {\n\t\t\t\t\t\t\t\t\t\tcell = tr.insertCell(j)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcell.innerHTML = cj.innerHTML;\n\t\t\t\t\t\t\t\t\tcj.getAttribute('width') && cell.setAttribute('width', cj.getAttribute('width'));\n\t\t\t\t\t\t\t\t\tcj.getAttribute('vAlign') && cell.setAttribute('vAlign', cj.getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\tcj.getAttribute('align') && cell.setAttribute('align', cj.getAttribute('align'));\n\t\t\t\t\t\t\t\t\tcj.style.cssText && (cell.style.cssText = cj.style.cssText)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = tr.cells[j]; j++) {\n\t\t\t\t\t\t\t\t\tif (!ci[j])\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcj.innerHTML = ci[j].innerHTML;\n\t\t\t\t\t\t\t\t\tci[j].getAttribute('width') && cj.setAttribute('width', ci[j].getAttribute('width'));\n\t\t\t\t\t\t\t\t\tci[j].getAttribute('vAlign') && cj.setAttribute('vAlign', ci[j].getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\tci[j].getAttribute('align') && cj.setAttribute('align', ci[j].getAttribute('align'));\n\t\t\t\t\t\t\t\t\tci[j].style.cssText && (cj.style.cssText = ci[j].style.cssText)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (isFullCol) {\n\t\t\t\t\t\t\t\tcellInfo = ut.getCellInfo(td);\n\t\t\t\t\t\t\t\tvar maxColNum = 0;\n\t\t\t\t\t\t\t\tfor (var j = 0, ci = tableCopyList[0], cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\t\tmaxColNum += cj.colSpan || 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t\t\tfor (i = 0; i < maxColNum; i++) {\n\t\t\t\t\t\t\t\t\tme.execCommand('insertcol');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t\t\ttd = ut.table.rows[0].cells[cellInfo.cellIndex];\n\t\t\t\t\t\t\t\tif (td.tagName == 'TH') {\n\t\t\t\t\t\t\t\t\ttd = ut.table.rows[1].cells[cellInfo.cellIndex];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\t\ttmpNode = td;\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\t\tif (td) {\n\t\t\t\t\t\t\t\t\t\ttd.innerHTML = cj.innerHTML;\n\t\t\t\t\t\t\t\t\t\t//todo 定制处理\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('width') && td.setAttribute('width', cj.getAttribute('width'));\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('vAlign') && td.setAttribute('vAlign', cj.getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('align') && td.setAttribute('align', cj.getAttribute('align'));\n\t\t\t\t\t\t\t\t\t\tcj.style.cssText && (td.style.cssText = cj.style.cssText);\n\t\t\t\t\t\t\t\t\t\tpreNode = td;\n\t\t\t\t\t\t\t\t\t\ttd = td.nextSibling;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tvar cloneTd = cj.cloneNode(true);\n\t\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(cloneTd, ['class', 'rowSpan', 'colSpan']);\n\n\t\t\t\t\t\t\t\t\t\tpreNode.parentNode.appendChild(cloneTd)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttd = ut.getNextCell(tmpNode, true, true);\n\t\t\t\t\t\t\t\tif (!tableCopyList[i])\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tif (!td) {\n\t\t\t\t\t\t\t\t\tvar cellInfo = ut.getCellInfo(tmpNode);\n\t\t\t\t\t\t\t\t\tut.table.insertRow(ut.table.rows.length);\n\t\t\t\t\t\t\t\t\tut.update();\n\t\t\t\t\t\t\t\t\ttd = ut.getVSideCell(tmpNode, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tut.update();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttable = me.document.createElement('table');\n\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\tvar tr = table.insertRow(table.rows.length);\n\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\tcloneTd = UT.cloneCell(cj, null, true);\n\t\t\t\t\t\t\t\tdomUtils.removeAttributes(cloneTd, ['class']);\n\t\t\t\t\t\t\t\ttr.appendChild(cloneTd)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j == 2 && cloneTd.rowSpan > 1) {\n\t\t\t\t\t\t\t\tcloneTd.rowSpan = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar defaultValue = getDefaultValue(me),\n\t\t\t\t\t\t\twidth = me.body.offsetWidth -\n\t\t\t\t\t\t\t(needIEHack ? parseInt(domUtils.getComputedStyle(me.body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (me.options.offsetWidth || 0);\n\t\t\t\t\t\tme.execCommand('insertHTML', '<table  ' +\n\t\t\t\t\t\t\t(isFullCol && isFullRow ? 'width=\"' + width + '\"' : '') +\n\t\t\t\t\t\t\t'>' + table.innerHTML.replace(/>\\s*</g, '><').replace(/\\bth\\b/gi, \"td\") + '</table>')\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\thtml.html = '';\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\tvar div = me.document.createElement(\"div\"),\n\t\t\t\t\t\ttables;\n\t\t\t\t\tdiv.innerHTML = html.html;\n\t\t\t\t\ttables = div.getElementsByTagName(\"table\");\n\t\t\t\t\tif (domUtils.findParentByTagName(me.selection.getStart(), 'table')) {\n\t\t\t\t\t\tutils.each(tables, function(t) {\n\t\t\t\t\t\t\tdomUtils.remove(t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (domUtils.findParentByTagName(me.selection.getStart(), 'caption', true)) {\n\t\t\t\t\t\t\tdiv.innerHTML = div[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tutils.each(tables, function(table) {\n\t\t\t\t\t\t\tremoveStyleSize(table, true);\n\t\t\t\t\t\t\tdomUtils.removeAttributes(table, ['style', 'border']);\n\t\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(table, \"td\"), function(td) {\n\t\t\t\t\t\t\t\tif (isEmptyBlock(td)) {\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, td);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tremoveStyleSize(td, true);\n\t\t\t\t\t\t\t\t//                            domUtils.removeAttributes(td, ['style'])\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\thtml.html = div.innerHTML;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.addListener('afterpaste', function() {\n\t\t\t\tutils.each(domUtils.getElementsByTagName(me.body, \"table\"), function(table) {\n\t\t\t\t\tif (table.offsetWidth > me.body.offsetWidth) {\n\t\t\t\t\t\tvar defaultValue = getDefaultValue(me, table);\n\t\t\t\t\t\ttable.style.width = me.body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(me.body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (me.options.offsetWidth || 0) + 'px'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t});\n\t\t\tme.addListener('blur', function() {\n\t\t\t\ttableCopyList = null;\n\t\t\t});\n\t\t\tvar timer;\n\t\t\tme.addListener('keydown', function() {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tcell = domUtils.findParentByTagName(rng.startContainer, ['th', 'td'], true);\n\t\t\t\t\tif (cell) {\n\t\t\t\t\t\tvar table = cell.parentNode.parentNode.parentNode;\n\t\t\t\t\t\tif (table.offsetWidth > table.getAttribute(\"width\")) {\n\t\t\t\t\t\t\tcell.style.wordBreak = \"break-all\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t\tme.addListener(\"selectionchange\", function() {\n\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t});\n\n\t\t\t//内容变化时触发索引更新\n\t\t\t//todo 可否考虑标记检测，如果不涉及表格的变化就不进行索引重建和更新\n\t\t\tme.addListener(\"contentchange\", function() {\n\t\t\t\tvar me = this;\n\t\t\t\t//尽可能排除一些不需要更新的状况\n\t\t\t\thideDragLine(me);\n\t\t\t\tif (getUETableBySelected(me)) return;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar start = rng.startContainer;\n\t\t\t\tstart = domUtils.findParentByTagName(start, ['td', 'th'], true);\n\t\t\t\tutils.each(domUtils.getElementsByTagName(me.document, 'table'), function(table) {\n\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\ttable.ueTable = new UT(table);\n\t\t\t\t\t//trace:3742\n\t\t\t\t\t//                utils.each(domUtils.getElementsByTagName(me.document, 'td'), function (td) {\n\t\t\t\t\t//\n\t\t\t\t\t//                    if (domUtils.isEmptyBlock(td) && td !== start) {\n\t\t\t\t\t//                        domUtils.fillNode(me.document, td);\n\t\t\t\t\t//                        if (browser.ie && browser.version == 6) {\n\t\t\t\t\t//                            td.innerHTML = '&nbsp;'\n\t\t\t\t\t//                        }\n\t\t\t\t\t//                    }\n\t\t\t\t\t//                });\n\t\t\t\t\t//                utils.each(domUtils.getElementsByTagName(me.document, 'th'), function (th) {\n\t\t\t\t\t//                    if (domUtils.isEmptyBlock(th) && th !== start) {\n\t\t\t\t\t//                        domUtils.fillNode(me.document, th);\n\t\t\t\t\t//                        if (browser.ie && browser.version == 6) {\n\t\t\t\t\t//                            th.innerHTML = '&nbsp;'\n\t\t\t\t\t//                        }\n\t\t\t\t\t//                    }\n\t\t\t\t\t//                });\n\t\t\t\t\ttable.onmouseover = function() {\n\t\t\t\t\t\tme.fireEvent('tablemouseover', table);\n\t\t\t\t\t};\n\t\t\t\t\ttable.onmousemove = function() {\n\t\t\t\t\t\tme.fireEvent('tablemousemove', table);\n\t\t\t\t\t\tme.options.tableDragable && toggleDragButton(true, this, me);\n\t\t\t\t\t\tutils.defer(function() {\n\t\t\t\t\t\t\tme.fireEvent('contentchange', 50)\n\t\t\t\t\t\t}, true)\n\t\t\t\t\t};\n\t\t\t\t\ttable.onmouseout = function() {\n\t\t\t\t\t\tme.fireEvent('tablemouseout', table);\n\t\t\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t\t\t\thideDragLine(me);\n\t\t\t\t\t};\n\t\t\t\t\ttable.onclick = function(evt) {\n\t\t\t\t\t\tevt = me.window.event || evt;\n\t\t\t\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement);\n\t\t\t\t\t\tif (!target) return;\n\t\t\t\t\t\tvar ut = getUETable(target),\n\t\t\t\t\t\t\ttable = ut.table,\n\t\t\t\t\t\t\tcellInfo = ut.getCellInfo(target),\n\t\t\t\t\t\t\tcellsRange,\n\t\t\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\t\t//                    if (\"topLeft\" == inPosition(table, mouseCoords(evt))) {\n\t\t\t\t\t\t//                        cellsRange = ut.getCellsRange(ut.table.rows[0].cells[0], ut.getLastCell());\n\t\t\t\t\t\t//                        ut.setSelected(cellsRange);\n\t\t\t\t\t\t//                        return;\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t//                    if (\"bottomRight\" == inPosition(table, mouseCoords(evt))) {\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//                        return;\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\tif (inTableSide(table, target, evt, true)) {\n\t\t\t\t\t\t\tvar endTdCol = ut.getCell(ut.indexTable[ut.rowsNum - 1][cellInfo.colIndex].rowIndex, ut.indexTable[ut.rowsNum - 1][cellInfo.colIndex].cellIndex);\n\t\t\t\t\t\t\tif (evt.shiftKey && ut.selectedTds.length) {\n\t\t\t\t\t\t\t\tif (ut.selectedTds[0] !== endTdCol) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(ut.selectedTds[0], endTdCol);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdCol).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (target !== endTdCol) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(target, endTdCol);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdCol).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (inTableSide(table, target, evt)) {\n\t\t\t\t\t\t\tvar endTdRow = ut.getCell(ut.indexTable[cellInfo.rowIndex][ut.colsNum - 1].rowIndex, ut.indexTable[cellInfo.rowIndex][ut.colsNum - 1].cellIndex);\n\t\t\t\t\t\t\tif (evt.shiftKey && ut.selectedTds.length) {\n\t\t\t\t\t\t\t\tif (ut.selectedTds[0] !== endTdRow) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(ut.selectedTds[0], endTdRow);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdRow).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (target !== endTdRow) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(target, endTdRow);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdRow).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tswitchBorderColor(me, true);\n\t\t\t});\n\n\t\t\tdomUtils.on(me.document, \"mousemove\", mouseMoveEvent);\n\n\t\t\tdomUtils.on(me.document, \"mouseout\", function(evt) {\n\t\t\t\tvar target = evt.target || evt.srcElement;\n\t\t\t\tif (target.tagName == \"TABLE\") {\n\t\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t\t}\n\t\t\t});\n\t\t\t/**\n\t\t\t * 表格隔行变色\n\t\t\t */\n\t\t\tme.addListener(\"interlacetable\", function(type, table, classList) {\n\t\t\t\tif (!table) return;\n\t\t\t\tvar me = this,\n\t\t\t\t\trows = table.rows,\n\t\t\t\t\tlen = rows.length,\n\t\t\t\t\tgetClass = function(list, index, repeat) {\n\t\t\t\t\t\treturn list[index] ? list[index] : repeat ? list[index % list.length] : \"\";\n\t\t\t\t\t};\n\t\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t\trows[i].className = getClass(classList || me.options.classList, i, true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tme.addListener(\"uninterlacetable\", function(type, table) {\n\t\t\t\tif (!table) return;\n\t\t\t\tvar me = this,\n\t\t\t\t\trows = table.rows,\n\t\t\t\t\tclassList = me.options.classList,\n\t\t\t\t\tlen = rows.length;\n\t\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t\tdomUtils.removeClasses(rows[i], classList);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.addListener(\"mousedown\", mouseDownEvent);\n\t\t\tme.addListener(\"mouseup\", mouseUpEvent);\n\t\t\t//拖动的时候触发mouseup\n\t\t\tdomUtils.on(me.body, 'dragstart', function(evt) {\n\t\t\t\tmouseUpEvent.call(me, 'dragstart', evt);\n\t\t\t});\n\t\t\tme.addOutputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('div'), function(n) {\n\t\t\t\t\tif (n.getAttr('id') == 'ue_tableDragLine') {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tvar currentRowIndex = 0;\n\t\t\tme.addListener(\"mousedown\", function() {\n\t\t\t\tcurrentRowIndex = 0;\n\t\t\t});\n\t\t\tme.addListener('tabkeydown', function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tcommon = range.getCommonAncestor(true, true),\n\t\t\t\t\ttable = domUtils.findParentByTagName(common, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\tif (domUtils.findParentByTagName(common, 'caption', true)) {\n\t\t\t\t\t\tvar cell = domUtils.getElementsByTagName(table, 'th td');\n\t\t\t\t\t\tif (cell && cell.length) {\n\t\t\t\t\t\t\trange.setStart(cell[0], 0).setCursor(false, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar cell = domUtils.findParentByTagName(common, ['td', 'th'], true),\n\t\t\t\t\t\t\tua = getUETable(cell);\n\t\t\t\t\t\tcurrentRowIndex = cell.rowSpan > 1 ? currentRowIndex : ua.getCellInfo(cell).rowIndex;\n\t\t\t\t\t\tvar nextCell = ua.getTabNextCell(cell, currentRowIndex);\n\t\t\t\t\t\tif (nextCell) {\n\t\t\t\t\t\t\tif (isEmptyBlock(nextCell)) {\n\t\t\t\t\t\t\t\trange.setStart(nextCell, 0).setCursor(false, true)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.selectNodeContents(nextCell).select()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t\tthis.execCommand('insertrownext');\n\t\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\t\t\t\trange.setStart(table.rows[table.rows.length - 1].cells[0], 0).setCursor();\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t});\n\t\t\tbrowser.ie && me.addListener('selectionchange', function() {\n\t\t\t\ttoggleDraggableState(this, false, \"\", null);\n\t\t\t});\n\t\t\tme.addListener(\"keydown\", function(type, evt) {\n\t\t\t\tvar me = this;\n\t\t\t\t//处理在表格的最后一个输入tab产生新的表格\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 8 || keyCode == 46) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar notCtrlKey = !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey;\n\t\t\t\tnotCtrlKey && removeSelectedClass(domUtils.getElementsByTagName(me.body, \"td\"));\n\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\tif (!ut) return;\n\t\t\t\tnotCtrlKey && ut.clearSelected();\n\t\t\t});\n\n\t\t\tme.addListener(\"beforegetcontent\", function() {\n\t\t\t\tswitchBorderColor(this, false);\n\t\t\t\tbrowser.ie && utils.each(this.document.getElementsByTagName('caption'), function(ci) {\n\t\t\t\t\tif (domUtils.isEmptyNode(ci)) {\n\t\t\t\t\t\tci.innerHTML = '&nbsp;'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tme.addListener(\"aftergetcontent\", function() {\n\t\t\t\tswitchBorderColor(this, true);\n\t\t\t});\n\t\t\tme.addListener(\"getAllHtml\", function() {\n\t\t\t\tremoveSelectedClass(me.document.getElementsByTagName(\"td\"));\n\t\t\t});\n\t\t\t//修正全屏状态下插入的表格宽度在非全屏状态下撑开编辑器的情况\n\t\t\tme.addListener(\"fullscreenchanged\", function(type, fullscreen) {\n\t\t\t\tif (!fullscreen) {\n\t\t\t\t\tvar ratio = this.body.offsetWidth / document.body.offsetWidth,\n\t\t\t\t\t\ttables = domUtils.getElementsByTagName(this.body, \"table\");\n\t\t\t\t\tutils.each(tables, function(table) {\n\t\t\t\t\t\tif (table.offsetWidth < me.body.offsetWidth) return false;\n\t\t\t\t\t\tvar tds = domUtils.getElementsByTagName(table, \"td\"),\n\t\t\t\t\t\t\tbackWidths = [];\n\t\t\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t\t\tbackWidths.push(td.offsetWidth);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfor (var i = 0, td; td = tds[i]; i++) {\n\t\t\t\t\t\t\ttd.setAttribute(\"width\", Math.floor(backWidths[i] * ratio));\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable.setAttribute(\"width\", Math.floor(getTableWidth(me, needIEHack, getDefaultValue(me))))\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//重写execCommand命令，用于处理框选时的处理\n\t\t\tvar oldExecCommand = me.execCommand;\n\t\t\tme.execCommand = function(cmd, datatat) {\n\n\t\t\t\tvar me = this,\n\t\t\t\t\targs = arguments;\n\n\t\t\t\tcmd = cmd.toLowerCase();\n\t\t\t\tvar ut = getUETableBySelected(me),\n\t\t\t\t\ttds,\n\t\t\t\t\trange = new dom.Range(me.document),\n\t\t\t\t\tcmdFun = me.commands[cmd] || UE.commands[cmd],\n\t\t\t\t\tresult;\n\t\t\t\tif (!cmdFun) return;\n\t\t\t\tif (ut && !commands[cmd] && !cmdFun.notNeedUndo && !me.__hasEnterExecCommand) {\n\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\tme.fireEvent(\"beforeexeccommand\", cmd);\n\t\t\t\t\ttds = ut.selectedTds;\n\t\t\t\t\tvar lastState = -2,\n\t\t\t\t\t\tlastValue = -2,\n\t\t\t\t\t\tvalue, state;\n\t\t\t\t\tfor (var i = 0, td; td = tds[i]; i++) {\n\t\t\t\t\t\tif (isEmptyBlock(td)) {\n\t\t\t\t\t\t\trange.setStart(td, 0).setCursor(false, true)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.selectNode(td).select(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstate = me.queryCommandState(cmd);\n\t\t\t\t\t\tvalue = me.queryCommandValue(cmd);\n\t\t\t\t\t\tif (state != -1) {\n\t\t\t\t\t\t\tif (lastState !== state || lastValue !== value) {\n\t\t\t\t\t\t\t\tme._ignoreContentChange = true;\n\t\t\t\t\t\t\t\tresult = oldExecCommand.apply(me, arguments);\n\t\t\t\t\t\t\t\tme._ignoreContentChange = false;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlastState = me.queryCommandState(cmd);\n\t\t\t\t\t\t\tlastValue = me.queryCommandValue(cmd);\n\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(td)) {\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, td)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.setStart(tds[0], 0).shrinkBoundary(true).setCursor(false, true);\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\tme.fireEvent(\"afterexeccommand\", cmd);\n\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\tme._selectionChange();\n\t\t\t\t} else {\n\t\t\t\t\tresult = oldExecCommand.apply(me, arguments);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\n\t\t});\n\t\t/**\n\t\t * 删除obj的宽高style，改成属性宽高\n\t\t * @param obj\n\t\t * @param replaceToProperty\n\t\t */\n\t\tfunction removeStyleSize(obj, replaceToProperty) {\n\t\t\tremoveStyle(obj, \"width\", true);\n\t\t\tremoveStyle(obj, \"height\", true);\n\t\t}\n\n\t\tfunction removeStyle(obj, styleName, replaceToProperty) {\n\t\t\tif (obj.style[styleName]) {\n\t\t\t\treplaceToProperty && obj.setAttribute(styleName, parseInt(obj.style[styleName], 10));\n\t\t\t\tobj.style[styleName] = \"\";\n\t\t\t}\n\t\t}\n\n\t\tfunction getParentTdOrTh(ele) {\n\t\t\tif (ele.tagName == \"TD\" || ele.tagName == \"TH\") return ele;\n\t\t\tvar td;\n\t\t\tif (td = domUtils.findParentByTagName(ele, \"td\", true) || domUtils.findParentByTagName(ele, \"th\", true)) return td;\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction isEmptyBlock(node) {\n\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(/^\\s*$/, '').replace(reg, '').length > 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor (var n in dtd.$isNotEmpty) {\n\t\t\t\tif (node.getElementsByTagName(n).length) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction mouseCoords(evt) {\n\t\t\tif (evt.pageX || evt.pageY) {\n\t\t\t\treturn {\n\t\t\t\t\tx: evt.pageX,\n\t\t\t\t\ty: evt.pageY\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tx: evt.clientX + me.document.body.scrollLeft - me.document.body.clientLeft,\n\t\t\t\ty: evt.clientY + me.document.body.scrollTop - me.document.body.clientTop\n\t\t\t};\n\t\t}\n\n\t\tfunction mouseMoveEvent(evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\n\t\t\t\t//普通状态下鼠标移动\n\t\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement),\n\t\t\t\t\tpos;\n\n\t\t\t\t//区分用户的行为是拖动还是双击\n\t\t\t\tif (isInResizeBuffer) {\n\n\t\t\t\t\tme.body.style.webkitUserSelect = 'none';\n\n\t\t\t\t\tif (Math.abs(userActionStatus.x - evt.clientX) > offsetOfTableCell || Math.abs(userActionStatus.y - evt.clientY) > offsetOfTableCell) {\n\t\t\t\t\t\tclearTableDragTimer();\n\t\t\t\t\t\tisInResizeBuffer = false;\n\t\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\t\t//drag action\n\t\t\t\t\t\ttableBorderDrag(evt);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//修改单元格大小时的鼠标移动\n\t\t\t\tif (onDrag && dragTd) {\n\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\tme.body.style.webkitUserSelect = 'none';\n\t\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t\t\tpos = mouseCoords(evt);\n\t\t\t\t\ttoggleDraggableState(me, true, onDrag, pos, target);\n\t\t\t\t\tif (onDrag == \"h\") {\n\t\t\t\t\t\tdragLine.style.left = getPermissionX(dragTd, evt) + \"px\";\n\t\t\t\t\t} else if (onDrag == \"v\") {\n\t\t\t\t\t\tdragLine.style.top = getPermissionY(dragTd, evt) + \"px\";\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//当鼠标处于table上时，修改移动过程中的光标状态\n\t\t\t\tif (target) {\n\t\t\t\t\t//针对使用table作为容器的组件不触发拖拽效果\n\t\t\t\t\tif (me.fireEvent('excludetable', target) === true)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tpos = mouseCoords(evt);\n\t\t\t\t\tvar state = getRelation(target, pos),\n\t\t\t\t\t\ttable = domUtils.findParentByTagName(target, \"table\", true);\n\n\t\t\t\t\tif (inTableSide(table, target, evt, true)) {\n\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\t\tme.body.style.cursor = \"url(\" + me.options.cursorpath + \"h.png),pointer\";\n\t\t\t\t\t} else if (inTableSide(table, target, evt)) {\n\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\t\tme.body.style.cursor = \"url(\" + me.options.cursorpath + \"v.png),pointer\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.body.style.cursor = \"text\";\n\t\t\t\t\t\tvar curCell = target;\n\t\t\t\t\t\tif (/\\d/.test(state)) {\n\t\t\t\t\t\t\tstate = state.replace(/\\d/, '');\n\t\t\t\t\t\t\ttarget = getUETable(target).getPreviewCell(target, state == \"v\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//位于第一行的顶部或者第一列的左边时不可拖动\n\t\t\t\t\t\ttoggleDraggableState(me, target ? !!state : false, target ? state : '', pos, target);\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttoggleDragButton(false, table, me);\n\t\t\t\t}\n\n\t\t\t} catch (e) {\n\t\t\t\tshowError(e);\n\t\t\t}\n\t\t}\n\n\t\tvar dragButtonTimer;\n\n\t\tfunction toggleDragButton(show, table, editor) {\n\t\t\tif (!show) {\n\t\t\t\tif (dragOver) return;\n\t\t\t\tdragButtonTimer = setTimeout(function() {\n\t\t\t\t\t!dragOver && dragButton && dragButton.parentNode && dragButton.parentNode.removeChild(dragButton);\n\t\t\t\t}, 2000);\n\t\t\t} else {\n\t\t\t\tcreateDragButton(table, editor);\n\t\t\t}\n\t\t}\n\n\t\tfunction createDragButton(table, editor) {\n\t\t\tvar pos = domUtils.getXY(table),\n\t\t\t\tdoc = table.ownerDocument;\n\t\t\tif (dragButton && dragButton.parentNode) return dragButton;\n\t\t\tdragButton = doc.createElement(\"div\");\n\t\t\tdragButton.contentEditable = false;\n\t\t\tdragButton.innerHTML = \"\";\n\t\t\tdragButton.style.cssText = \"width:15px;height:15px;background-image:url(\" + editor.options.UEDITOR_HOME_URL + \"dialogs/table/dragicon.png);position: absolute;cursor:move;top:\" + (pos.y - 15) + \"px;left:\" + (pos.x) + \"px;\";\n\t\t\tdomUtils.unSelectable(dragButton);\n\t\t\tdragButton.onmouseover = function(evt) {\n\t\t\t\tdragOver = true;\n\t\t\t};\n\t\t\tdragButton.onmouseout = function(evt) {\n\t\t\t\tdragOver = false;\n\t\t\t};\n\t\t\tdomUtils.on(dragButton, 'click', function(type, evt) {\n\t\t\t\tdoClick(evt, this);\n\t\t\t});\n\t\t\tdomUtils.on(dragButton, 'dblclick', function(type, evt) {\n\t\t\t\tdoDblClick(evt);\n\t\t\t});\n\t\t\tdomUtils.on(dragButton, 'dragstart', function(type, evt) {\n\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t});\n\t\t\tvar timer;\n\n\t\t\tfunction doClick(evt, button) {\n\t\t\t\t// 部分浏览器下需要清理\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\teditor.fireEvent(\"tableClicked\", table, button);\n\t\t\t\t}, 300);\n\t\t\t}\n\n\t\t\tfunction doDblClick(evt) {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\tvar ut = getUETable(table),\n\t\t\t\t\tstart = table.rows[0].cells[0],\n\t\t\t\t\tend = ut.getLastCell(),\n\t\t\t\t\trange = ut.getCellsRange(start, end);\n\t\t\t\teditor.selection.getRange().setStart(start, 0).setCursor(false, true);\n\t\t\t\tut.setSelected(range);\n\t\t\t}\n\n\t\t\tdoc.body.appendChild(dragButton);\n\t\t}\n\n\t\t//    function inPosition(table, pos) {\n\t\t//        var tablePos = domUtils.getXY(table),\n\t\t//            width = table.offsetWidth,\n\t\t//            height = table.offsetHeight;\n\t\t//        if (pos.x - tablePos.x < 5 && pos.y - tablePos.y < 5) {\n\t\t//            return \"topLeft\";\n\t\t//        } else if (tablePos.x + width - pos.x < 5 && tablePos.y + height - pos.y < 5) {\n\t\t//            return \"bottomRight\";\n\t\t//        }\n\t\t//    }\n\n\t\tfunction inTableSide(table, cell, evt, top) {\n\t\t\tvar pos = mouseCoords(evt),\n\t\t\t\tstate = getRelation(cell, pos);\n\n\t\t\tif (top) {\n\t\t\t\tvar caption = table.getElementsByTagName(\"caption\")[0],\n\t\t\t\t\tcapHeight = caption ? caption.offsetHeight : 0;\n\t\t\t\treturn (state == \"v1\") && ((pos.y - domUtils.getXY(table).y - capHeight) < 8);\n\t\t\t} else {\n\t\t\t\treturn (state == \"h1\") && ((pos.x - domUtils.getXY(table).x) < 8);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 获取拖动时允许的X轴坐标\n\t\t * @param dragTd\n\t\t * @param evt\n\t\t */\n\t\tfunction getPermissionX(dragTd, evt) {\n\t\t\tvar ut = getUETable(dragTd);\n\t\t\tif (ut) {\n\t\t\t\tvar preTd = ut.getSameEndPosCells(dragTd, \"x\")[0],\n\t\t\t\t\tnextTd = ut.getSameStartPosXCells(dragTd)[0],\n\t\t\t\t\tmouseX = mouseCoords(evt).x,\n\t\t\t\t\tleft = (preTd ? domUtils.getXY(preTd).x : domUtils.getXY(ut.table).x) + 20,\n\t\t\t\t\tright = nextTd ? domUtils.getXY(nextTd).x + nextTd.offsetWidth - 20 : (me.body.offsetWidth + 5 || parseInt(domUtils.getComputedStyle(me.body, \"width\"), 10));\n\n\t\t\t\tleft += cellMinWidth;\n\t\t\t\tright -= cellMinWidth;\n\n\t\t\t\treturn mouseX < left ? left : mouseX > right ? right : mouseX;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 获取拖动时允许的Y轴坐标\n\t\t */\n\t\tfunction getPermissionY(dragTd, evt) {\n\t\t\ttry {\n\t\t\t\tvar top = domUtils.getXY(dragTd).y,\n\t\t\t\t\tmousePosY = mouseCoords(evt).y;\n\t\t\t\treturn mousePosY < top ? top : mousePosY;\n\t\t\t} catch (e) {\n\t\t\t\tshowError(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 移动状态切换\n\t\t */\n\t\tfunction toggleDraggableState(editor, draggable, dir, mousePos, cell) {\n\t\t\ttry {\n\t\t\t\teditor.body.style.cursor = dir == \"h\" ? \"col-resize\" : dir == \"v\" ? \"row-resize\" : \"text\";\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tif (dir && !mousedown && !getUETableBySelected(editor)) {\n\t\t\t\t\t\tgetDragLine(editor, editor.document);\n\t\t\t\t\t\tshowDragLineAt(dir, cell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\thideDragLine(editor)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tonBorder = draggable;\n\t\t\t} catch (e) {\n\t\t\t\tshowError(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 获取与UETable相关的resize line\n\t\t * @param uetable UETable对象\n\t\t */\n\t\tfunction getResizeLineByUETable() {\n\n\t\t\tvar lineId = '_UETableResizeLine',\n\t\t\t\tline = this.document.getElementById(lineId);\n\n\t\t\tif (!line) {\n\t\t\t\tline = this.document.createElement(\"div\");\n\t\t\t\tline.id = lineId;\n\t\t\t\tline.contnetEditable = false;\n\t\t\t\tline.setAttribute(\"unselectable\", \"on\");\n\n\t\t\t\tvar styles = {\n\t\t\t\t\twidth: 2 * cellBorderWidth + 1 + 'px',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t'z-index': 100000,\n\t\t\t\t\tcursor: 'col-resize',\n\t\t\t\t\tbackground: 'red',\n\t\t\t\t\tdisplay: 'none'\n\t\t\t\t};\n\n\t\t\t\t//切换状态\n\t\t\t\tline.onmouseout = function() {\n\t\t\t\t\tthis.style.display = 'none';\n\t\t\t\t};\n\n\t\t\t\tutils.extend(line.style, styles);\n\n\t\t\t\tthis.document.body.appendChild(line);\n\n\t\t\t}\n\n\t\t\treturn line;\n\n\t\t}\n\n\t\t/**\n\t\t * 更新resize-line\n\t\t */\n\t\tfunction updateResizeLine(cell, uetable) {\n\n\t\t\tvar line = getResizeLineByUETable.call(this),\n\t\t\t\ttable = uetable.table,\n\t\t\t\tstyles = {\n\t\t\t\t\ttop: domUtils.getXY(table).y + 'px',\n\t\t\t\t\tleft: domUtils.getXY(cell).x + cell.offsetWidth - cellBorderWidth + 'px',\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: table.offsetHeight + 'px'\n\t\t\t\t};\n\n\t\t\tutils.extend(line.style, styles);\n\n\t\t}\n\n\t\t/**\n\t\t * 显示resize-line\n\t\t */\n\t\tfunction showResizeLine(cell) {\n\n\t\t\tvar uetable = getUETable(cell);\n\n\t\t\tupdateResizeLine.call(this, cell, uetable);\n\n\t\t}\n\n\t\t/**\n\t\t * 获取鼠标与当前单元格的相对位置\n\t\t * @param ele\n\t\t * @param mousePos\n\t\t */\n\t\tfunction getRelation(ele, mousePos) {\n\t\t\tvar elePos = domUtils.getXY(ele);\n\n\t\t\tif (!elePos) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif (elePos.x + ele.offsetWidth - mousePos.x < cellBorderWidth) {\n\t\t\t\treturn \"h\";\n\t\t\t}\n\t\t\tif (mousePos.x - elePos.x < cellBorderWidth) {\n\t\t\t\treturn 'h1'\n\t\t\t}\n\t\t\tif (elePos.y + ele.offsetHeight - mousePos.y < cellBorderWidth) {\n\t\t\t\treturn \"v\";\n\t\t\t}\n\t\t\tif (mousePos.y - elePos.y < cellBorderWidth) {\n\t\t\t\treturn 'v1'\n\t\t\t}\n\t\t\treturn '';\n\t\t}\n\n\t\tfunction mouseDownEvent(type, evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tuserActionStatus = {\n\t\t\t\tx: evt.clientX,\n\t\t\t\ty: evt.clientY\n\t\t\t};\n\n\t\t\t//右键菜单单独处理\n\t\t\tif (evt.button == 2) {\n\t\t\t\tvar ut = getUETableBySelected(me),\n\t\t\t\t\tflag = false;\n\n\t\t\t\tif (ut) {\n\t\t\t\t\tvar td = getTargetTd(me, evt);\n\t\t\t\t\tutils.each(ut.selectedTds, function(ti) {\n\t\t\t\t\t\tif (ti === td) {\n\t\t\t\t\t\t\tflag = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!flag) {\n\t\t\t\t\t\tremoveSelectedClass(domUtils.getElementsByTagName(me.body, \"th td\"));\n\t\t\t\t\t\tut.clearSelected()\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttd = ut.selectedTds[0];\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tme.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t\t\t\t}, 0);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttableClickHander(evt);\n\t\t\t}\n\n\t\t}\n\n\t\t//清除表格的计时器\n\t\tfunction clearTableTimer() {\n\t\t\ttabTimer && clearTimeout(tabTimer);\n\t\t\ttabTimer = null;\n\t\t}\n\n\t\t//双击收缩\n\t\tfunction tableDbclickHandler(evt) {\n\t\t\tsingleClickState = 0;\n\t\t\tevt = evt || me.window.event;\n\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement);\n\t\t\tif (target) {\n\t\t\t\tvar h;\n\t\t\t\tif (h = getRelation(target, mouseCoords(evt))) {\n\n\t\t\t\t\thideDragLine(me);\n\n\t\t\t\t\tif (h == 'h1') {\n\t\t\t\t\t\th = 'h';\n\t\t\t\t\t\tif (inTableSide(domUtils.findParentByTagName(target, \"table\"), target, evt)) {\n\t\t\t\t\t\t\tme.execCommand('adaptbywindow');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget = getUETable(target).getPreviewCell(target);\n\t\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\t\t\t\trng.selectNodeContents(target).setCursor(true, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (h == 'h') {\n\t\t\t\t\t\tvar ut = getUETable(target),\n\t\t\t\t\t\t\ttable = ut.table,\n\t\t\t\t\t\t\tcells = getCellsByMoveBorder(target, table, true);\n\n\t\t\t\t\t\tcells = extractArray(cells, 'left');\n\n\t\t\t\t\t\tut.width = ut.offsetWidth;\n\n\t\t\t\t\t\tvar oldWidth = [],\n\t\t\t\t\t\t\tnewWidth = [];\n\n\t\t\t\t\t\tutils.each(cells, function(cell) {\n\n\t\t\t\t\t\t\toldWidth.push(cell.offsetWidth);\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tutils.each(cells, function(cell) {\n\n\t\t\t\t\t\t\tcell.removeAttribute(\"width\");\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\twindow.setTimeout(function() {\n\n\t\t\t\t\t\t\t//是否允许改变\n\t\t\t\t\t\t\tvar changeable = true;\n\n\t\t\t\t\t\t\tutils.each(cells, function(cell, index) {\n\n\t\t\t\t\t\t\t\tvar width = cell.offsetWidth;\n\n\t\t\t\t\t\t\t\tif (width > oldWidth[index]) {\n\t\t\t\t\t\t\t\t\tchangeable = false;\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tnewWidth.push(width);\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tvar change = changeable ? newWidth : oldWidth;\n\n\t\t\t\t\t\t\tutils.each(cells, function(cell, index) {\n\n\t\t\t\t\t\t\t\tcell.width = change[index] - getTabcellSpace();\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t}, 0);\n\n\t\t\t\t\t\t//                    minWidth -= cellMinWidth;\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//                    table.removeAttribute(\"width\");\n\t\t\t\t\t\t//                    utils.each(cells, function (cell) {\n\t\t\t\t\t\t//                        cell.style.width = \"\";\n\t\t\t\t\t\t//                        cell.width -= minWidth;\n\t\t\t\t\t\t//                    });\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction tableClickHander(evt) {\n\n\t\t\tremoveSelectedClass(domUtils.getElementsByTagName(me.body, \"td th\"));\n\t\t\t//trace:3113\n\t\t\t//选中单元格，点击table外部，不会清掉table上挂的ueTable,会引起getUETableBySelected方法返回值\n\t\t\tutils.each(me.document.getElementsByTagName('table'), function(t) {\n\t\t\t\tt.ueTable = null;\n\t\t\t});\n\t\t\tstartTd = getTargetTd(me, evt);\n\t\t\tif (!startTd) return;\n\t\t\tvar table = domUtils.findParentByTagName(startTd, \"table\", true);\n\t\t\tut = getUETable(table);\n\t\t\tut && ut.clearSelected();\n\n\t\t\t//判断当前鼠标状态\n\t\t\tif (!onBorder) {\n\t\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t\tmousedown = true;\n\t\t\t\tme.addListener('mouseover', mouseOverEvent);\n\t\t\t} else {\n\t\t\t\t//边框上的动作处理\n\t\t\t\tborderActionHandler(evt);\n\t\t\t}\n\n\t\t}\n\n\t\t//处理表格边框上的动作, 这里做延时处理，避免两种动作互相影响\n\t\tfunction borderActionHandler(evt) {\n\n\t\t\tif (browser.ie) {\n\t\t\t\tevt = reconstruct(evt);\n\t\t\t}\n\n\t\t\tclearTableDragTimer();\n\n\t\t\t//是否正在等待resize的缓冲中\n\t\t\tisInResizeBuffer = true;\n\n\t\t\ttableDragTimer = setTimeout(function() {\n\t\t\t\ttableBorderDrag(evt);\n\t\t\t}, dblclickTime);\n\n\t\t}\n\n\t\tfunction extractArray(originArr, key) {\n\n\t\t\tvar result = [],\n\t\t\t\ttmp = null;\n\n\t\t\tfor (var i = 0, len = originArr.length; i < len; i++) {\n\n\t\t\t\ttmp = originArr[i][key];\n\n\t\t\t\tif (tmp) {\n\t\t\t\t\tresult.push(tmp);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfunction clearTableDragTimer() {\n\t\t\ttableDragTimer && clearTimeout(tableDragTimer);\n\t\t\ttableDragTimer = null;\n\t\t}\n\n\t\tfunction reconstruct(obj) {\n\n\t\t\tvar attrs = ['pageX', 'pageY', 'clientX', 'clientY', 'srcElement', 'target'],\n\t\t\t\tnewObj = {};\n\n\t\t\tif (obj) {\n\n\t\t\t\tfor (var i = 0, key, val; key = attrs[i]; i++) {\n\t\t\t\t\tval = obj[key];\n\t\t\t\t\tval && (newObj[key] = val);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn newObj;\n\n\t\t}\n\n\t\t//边框拖动\n\t\tfunction tableBorderDrag(evt) {\n\n\t\t\tisInResizeBuffer = false;\n\n\t\t\tstartTd = evt.target || evt.srcElement;\n\t\t\tif (!startTd) return;\n\t\t\tvar state = getRelation(startTd, mouseCoords(evt));\n\t\t\tif (/\\d/.test(state)) {\n\t\t\t\tstate = state.replace(/\\d/, '');\n\t\t\t\tstartTd = getUETable(startTd).getPreviewCell(startTd, state == 'v');\n\t\t\t}\n\t\t\thideDragLine(me);\n\t\t\tgetDragLine(me, me.document);\n\t\t\tme.fireEvent('saveScene');\n\t\t\tshowDragLineAt(state, startTd);\n\t\t\tmousedown = true;\n\t\t\t//拖动开始\n\t\t\tonDrag = state;\n\t\t\tdragTd = startTd;\n\t\t}\n\n\t\tfunction mouseUpEvent(type, evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTableDragTimer();\n\n\t\t\tisInResizeBuffer = false;\n\n\t\t\tif (onBorder) {\n\t\t\t\tsingleClickState = ++singleClickState % 3;\n\n\t\t\t\tuserActionStatus = {\n\t\t\t\t\tx: evt.clientX,\n\t\t\t\t\ty: evt.clientY\n\t\t\t\t};\n\n\t\t\t\ttableResizeTimer = setTimeout(function() {\n\t\t\t\t\tsingleClickState > 0 && singleClickState--;\n\t\t\t\t}, dblclickTime);\n\n\t\t\t\tif (singleClickState === 2) {\n\n\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\ttableDbclickHandler(evt);\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif (evt.button == 2) return;\n\t\t\tvar me = this;\n\t\t\t//清除表格上原生跨选问题\n\t\t\tvar range = me.selection.getRange(),\n\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'table', true),\n\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, 'table', true);\n\n\t\t\tif (start || end) {\n\t\t\t\tif (start === end) {\n\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, ['td', 'th', 'caption'], true);\n\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, ['td', 'th', 'caption'], true);\n\t\t\t\t\tif (start !== end) {\n\t\t\t\t\t\tme.selection.clearRange()\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tme.selection.clearRange()\n\t\t\t\t}\n\t\t\t}\n\t\t\tmousedown = false;\n\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t//拖拽状态下的mouseUP\n\t\t\tif (onDrag && dragTd) {\n\n\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\n\t\t\t\tsingleClickState = 0;\n\t\t\t\tdragLine = me.document.getElementById('ue_tableDragLine');\n\n\t\t\t\t// trace 3973\n\t\t\t\tif (dragLine) {\n\t\t\t\t\tvar dragTdPos = domUtils.getXY(dragTd),\n\t\t\t\t\t\tdragLinePos = domUtils.getXY(dragLine);\n\n\t\t\t\t\tswitch (onDrag) {\n\t\t\t\t\t\tcase \"h\":\n\t\t\t\t\t\t\tchangeColWidth(dragTd, dragLinePos.x - dragTdPos.x);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"v\":\n\t\t\t\t\t\t\tchangeRowHeight(dragTd, dragLinePos.y - dragTdPos.y - dragTd.offsetHeight);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t}\n\t\t\t\t\tonDrag = \"\";\n\t\t\t\t\tdragTd = null;\n\n\t\t\t\t\thideDragLine(me);\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//正常状态下的mouseup\n\t\t\tif (!startTd) {\n\t\t\t\tvar target = domUtils.findParentByTagName(evt.target || evt.srcElement, \"td\", true);\n\t\t\t\tif (!target) target = domUtils.findParentByTagName(evt.target || evt.srcElement, \"th\", true);\n\t\t\t\tif (target && (target.tagName == \"TD\" || target.tagName == \"TH\")) {\n\t\t\t\t\tif (me.fireEvent(\"excludetable\", target) === true) return;\n\t\t\t\t\trange = new dom.Range(me.document);\n\t\t\t\t\trange.setStart(target, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar ut = getUETable(startTd),\n\t\t\t\t\tcell = ut ? ut.selectedTds[0] : null;\n\t\t\t\tif (cell) {\n\t\t\t\t\trange = new dom.Range(me.document);\n\t\t\t\t\tif (domUtils.isEmptyBlock(cell)) {\n\t\t\t\t\t\trange.setStart(cell, 0).setCursor(false, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trange.selectNodeContents(cell).shrinkBoundary().setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trange = me.selection.getRange().shrinkBoundary();\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\tvar start = domUtils.findParentByTagName(range.startContainer, ['td', 'th'], true),\n\t\t\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, ['td', 'th'], true);\n\t\t\t\t\t\t//在table里边的不能清除\n\t\t\t\t\t\tif (start && !end || !start && end || start && end && start !== end) {\n\t\t\t\t\t\t\trange.setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstartTd = null;\n\t\t\t\tme.removeListener('mouseover', mouseOverEvent);\n\t\t\t}\n\t\t\tme._selectionChange(250, evt);\n\t\t}\n\n\t\tfunction mouseOverEvent(type, evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar me = this,\n\t\t\t\ttar = evt.target || evt.srcElement;\n\t\t\tcurrentTd = domUtils.findParentByTagName(tar, \"td\", true) || domUtils.findParentByTagName(tar, \"th\", true);\n\t\t\t//需要判断两个TD是否位于同一个表格内\n\t\t\tif (startTd && currentTd &&\n\t\t\t\t((startTd.tagName == \"TD\" && currentTd.tagName == \"TD\") || (startTd.tagName == \"TH\" && currentTd.tagName == \"TH\")) &&\n\t\t\t\tdomUtils.findParentByTagName(startTd, 'table') == domUtils.findParentByTagName(currentTd, 'table')) {\n\t\t\t\tvar ut = getUETable(currentTd);\n\t\t\t\tif (startTd != currentTd) {\n\t\t\t\t\tme.document.body.style.webkitUserSelect = 'none';\n\t\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t\t\tvar range = ut.getCellsRange(startTd, currentTd);\n\t\t\t\t\tut.setSelected(range);\n\t\t\t\t} else {\n\t\t\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t\t\tut.clearSelected();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t}\n\n\t\tfunction setCellHeight(cell, height, backHeight) {\n\t\t\tvar lineHight = parseInt(domUtils.getComputedStyle(cell, \"line-height\"), 10),\n\t\t\t\ttmpHeight = backHeight + height;\n\t\t\theight = tmpHeight < lineHight ? lineHight : tmpHeight;\n\t\t\tif (cell.style.height) cell.style.height = \"\";\n\t\t\tcell.rowSpan == 1 ? cell.setAttribute(\"height\", height) : (cell.removeAttribute && cell.removeAttribute(\"height\"));\n\t\t}\n\n\t\tfunction getWidth(cell) {\n\t\t\tif (!cell) return 0;\n\t\t\treturn parseInt(domUtils.getComputedStyle(cell, \"width\"), 10);\n\t\t}\n\n\t\tfunction changeColWidth(cell, changeValue) {\n\n\t\t\tvar ut = getUETable(cell);\n\t\t\tif (ut) {\n\n\t\t\t\t//根据当前移动的边框获取相关的单元格\n\t\t\t\tvar table = ut.table,\n\t\t\t\t\tcells = getCellsByMoveBorder(cell, table);\n\n\t\t\t\ttable.style.width = \"\";\n\t\t\t\ttable.removeAttribute(\"width\");\n\n\t\t\t\t//修正改变量\n\t\t\t\tchangeValue = correctChangeValue(changeValue, cell, cells);\n\n\t\t\t\tif (cell.nextSibling) {\n\n\t\t\t\t\tvar i = 0;\n\n\t\t\t\t\tutils.each(cells, function(cellGroup) {\n\n\t\t\t\t\t\tcellGroup.left.width = (+cellGroup.left.width) + changeValue;\n\t\t\t\t\t\tcellGroup.right && (cellGroup.right.width = (+cellGroup.right.width) - changeValue);\n\n\t\t\t\t\t});\n\n\t\t\t\t} else {\n\n\t\t\t\t\tutils.each(cells, function(cellGroup) {\n\t\t\t\t\t\tcellGroup.left.width -= -changeValue;\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isEditorDisabled() {\n\t\t\treturn me.body.contentEditable === \"false\";\n\t\t}\n\n\t\tfunction changeRowHeight(td, changeValue) {\n\t\t\tif (Math.abs(changeValue) < 10) return;\n\t\t\tvar ut = getUETable(td);\n\t\t\tif (ut) {\n\t\t\t\tvar cells = ut.getSameEndPosCells(td, \"y\"),\n\t\t\t\t\t//备份需要连带变化的td的原始高度，否则后期无法获取正确的值\n\t\t\t\t\tbackHeight = cells[0] ? cells[0].offsetHeight : 0;\n\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\tsetCellHeight(cell, changeValue, backHeight);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\t/**\n\t\t * 获取调整单元格大小的相关单元格\n\t\t * @isContainMergeCell 返回的结果中是否包含发生合并后的单元格\n\t\t */\n\t\tfunction getCellsByMoveBorder(cell, table, isContainMergeCell) {\n\n\t\t\tif (!table) {\n\t\t\t\ttable = domUtils.findParentByTagName(cell, 'table');\n\t\t\t}\n\n\t\t\tif (!table) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t//获取到该单元格所在行的序列号\n\t\t\tvar index = domUtils.getNodeIndex(cell),\n\t\t\t\ttemp = cell,\n\t\t\t\trows = table.rows,\n\t\t\t\tcolIndex = 0;\n\n\t\t\twhile (temp) {\n\t\t\t\t//获取到当前单元格在未发生单元格合并时的序列\n\t\t\t\tif (temp.nodeType === 1) {\n\t\t\t\t\tcolIndex += (temp.colSpan || 1);\n\t\t\t\t}\n\t\t\t\ttemp = temp.previousSibling;\n\t\t\t}\n\n\t\t\ttemp = null;\n\n\t\t\t//记录想关的单元格\n\t\t\tvar borderCells = [];\n\n\t\t\tutils.each(rows, function(tabRow) {\n\n\t\t\t\tvar cells = tabRow.cells,\n\t\t\t\t\tcurrIndex = 0;\n\n\t\t\t\tutils.each(cells, function(tabCell) {\n\n\t\t\t\t\tcurrIndex += (tabCell.colSpan || 1);\n\n\t\t\t\t\tif (currIndex === colIndex) {\n\n\t\t\t\t\t\tborderCells.push({\n\t\t\t\t\t\t\tleft: tabCell,\n\t\t\t\t\t\t\tright: tabCell.nextSibling || null\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t} else if (currIndex > colIndex) {\n\n\t\t\t\t\t\tif (isContainMergeCell) {\n\t\t\t\t\t\t\tborderCells.push({\n\t\t\t\t\t\t\t\tleft: tabCell\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t});\n\n\t\t\treturn borderCells;\n\n\t\t}\n\n\t\t/**\n\t\t * 通过给定的单元格集合获取最小的单元格width\n\t\t */\n\t\tfunction getMinWidthByTableCells(cells) {\n\n\t\t\tvar minWidth = Number.MAX_VALUE;\n\n\t\t\tfor (var i = 0, curCell; curCell = cells[i]; i++) {\n\n\t\t\t\tminWidth = Math.min(minWidth, curCell.width || getTableCellWidth(curCell));\n\n\t\t\t}\n\n\t\t\treturn minWidth;\n\n\t\t}\n\n\t\tfunction correctChangeValue(changeValue, relatedCell, cells) {\n\n\t\t\t//为单元格的paading预留空间\n\t\t\tchangeValue -= getTabcellSpace();\n\n\t\t\tif (changeValue < 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tchangeValue -= getTableCellWidth(relatedCell);\n\n\t\t\t//确定方向\n\t\t\tvar direction = changeValue < 0 ? 'left' : 'right';\n\n\t\t\tchangeValue = Math.abs(changeValue);\n\n\t\t\t//只关心非最后一个单元格就可以\n\t\t\tutils.each(cells, function(cellGroup) {\n\n\t\t\t\tvar curCell = cellGroup[direction];\n\n\t\t\t\t//为单元格保留最小空间\n\t\t\t\tif (curCell) {\n\t\t\t\t\tchangeValue = Math.min(changeValue, getTableCellWidth(curCell) - cellMinWidth);\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t//修正越界\n\t\t\tchangeValue = changeValue < 0 ? 0 : changeValue;\n\n\t\t\treturn direction === 'left' ? -changeValue : changeValue;\n\n\t\t}\n\n\t\tfunction getTableCellWidth(cell) {\n\n\t\t\tvar width = 0,\n\t\t\t\t//偏移纠正量\n\t\t\t\toffset = 0,\n\t\t\t\twidth = cell.offsetWidth - getTabcellSpace();\n\n\t\t\t//最后一个节点纠正一下\n\t\t\tif (!cell.nextSibling) {\n\n\t\t\t\twidth -= getTableCellOffset(cell);\n\n\t\t\t}\n\n\t\t\twidth = width < 0 ? 0 : width;\n\n\t\t\ttry {\n\t\t\t\tcell.width = width;\n\t\t\t} catch (e) {}\n\n\t\t\treturn width;\n\n\t\t}\n\n\t\t/**\n\t\t * 获取单元格所在表格的最末单元格的偏移量\n\t\t */\n\t\tfunction getTableCellOffset(cell) {\n\n\t\t\ttab = domUtils.findParentByTagName(cell, \"table\", false);\n\n\t\t\tif (tab.offsetVal === undefined) {\n\n\t\t\t\tvar prev = cell.previousSibling;\n\n\t\t\t\tif (prev) {\n\n\t\t\t\t\t//最后一个单元格和前一个单元格的width diff结果 如果恰好为一个border width， 则条件成立\n\t\t\t\t\ttab.offsetVal = cell.offsetWidth - prev.offsetWidth === UT.borderWidth ? UT.borderWidth : 0;\n\n\t\t\t\t} else {\n\t\t\t\t\ttab.offsetVal = 0;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn tab.offsetVal;\n\n\t\t}\n\n\t\tfunction getTabcellSpace() {\n\n\t\t\tif (UT.tabcellSpace === undefined) {\n\n\t\t\t\tvar cell = null,\n\t\t\t\t\ttab = me.document.createElement(\"table\"),\n\t\t\t\t\ttbody = me.document.createElement(\"tbody\"),\n\t\t\t\t\ttrow = me.document.createElement(\"tr\"),\n\t\t\t\t\ttabcell = me.document.createElement(\"td\"),\n\t\t\t\t\tmirror = null;\n\n\t\t\t\ttabcell.style.cssText = 'border: 0;';\n\t\t\t\ttabcell.width = 1;\n\n\t\t\t\ttrow.appendChild(tabcell);\n\t\t\t\ttrow.appendChild(mirror = tabcell.cloneNode(false));\n\n\t\t\t\ttbody.appendChild(trow);\n\n\t\t\t\ttab.appendChild(tbody);\n\n\t\t\t\ttab.style.cssText = \"visibility: hidden;\";\n\n\t\t\t\tme.body.appendChild(tab);\n\n\t\t\t\tUT.paddingSpace = tabcell.offsetWidth - 1;\n\n\t\t\t\tvar tmpTabWidth = tab.offsetWidth;\n\n\t\t\t\ttabcell.style.cssText = '';\n\t\t\t\tmirror.style.cssText = '';\n\n\t\t\t\tUT.borderWidth = (tab.offsetWidth - tmpTabWidth) / 3;\n\n\t\t\t\tUT.tabcellSpace = UT.paddingSpace + UT.borderWidth;\n\n\t\t\t\tme.body.removeChild(tab);\n\n\t\t\t}\n\n\t\t\tgetTabcellSpace = function() {\n\t\t\t\treturn UT.tabcellSpace;\n\t\t\t};\n\n\t\t\treturn UT.tabcellSpace;\n\n\t\t}\n\n\t\tfunction getDragLine(editor, doc) {\n\t\t\tif (mousedown) return;\n\t\t\tdragLine = editor.document.createElement(\"div\");\n\t\t\tdomUtils.setAttributes(dragLine, {\n\t\t\t\tid: \"ue_tableDragLine\",\n\t\t\t\tunselectable: 'on',\n\t\t\t\tcontenteditable: false,\n\t\t\t\t'onresizestart': 'return false',\n\t\t\t\t'ondragstart': 'return false',\n\t\t\t\t'onselectstart': 'return false',\n\t\t\t\tstyle: \"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)\"\n\t\t\t});\n\t\t\teditor.body.appendChild(dragLine);\n\t\t}\n\n\t\tfunction hideDragLine(editor) {\n\t\t\tif (mousedown) return;\n\t\t\tvar line;\n\t\t\twhile (line = editor.document.getElementById('ue_tableDragLine')) {\n\t\t\t\tdomUtils.remove(line)\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 依据state（v|h）在cell位置显示横线\n\t\t * @param state\n\t\t * @param cell\n\t\t */\n\t\tfunction showDragLineAt(state, cell) {\n\t\t\tif (!cell) return;\n\t\t\tvar table = domUtils.findParentByTagName(cell, \"table\"),\n\t\t\t\tcaption = table.getElementsByTagName('caption'),\n\t\t\t\twidth = table.offsetWidth,\n\t\t\t\theight = table.offsetHeight - (caption.length > 0 ? caption[0].offsetHeight : 0),\n\t\t\t\ttablePos = domUtils.getXY(table),\n\t\t\t\tcellPos = domUtils.getXY(cell),\n\t\t\t\tcss;\n\t\t\tswitch (state) {\n\t\t\t\tcase \"h\":\n\t\t\t\t\tcss = 'height:' + height + 'px;top:' + (tablePos.y + (caption.length > 0 ? caption[0].offsetHeight : 0)) + 'px;left:' + (cellPos.x + cell.offsetWidth);\n\t\t\t\t\tdragLine.style.cssText = css + 'px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)';\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"v\":\n\t\t\t\t\tcss = 'width:' + width + 'px;left:' + tablePos.x + 'px;top:' + (cellPos.y + cell.offsetHeight);\n\t\t\t\t\t//必须加上border:0和color:blue，否则低版ie不支持背景色显示\n\t\t\t\t\tdragLine.style.cssText = css + 'px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 当表格边框颜色为白色时设置为虚线,true为添加虚线\n\t\t * @param editor\n\t\t * @param flag\n\t\t */\n\t\tfunction switchBorderColor(editor, flag) {\n\t\t\tvar tableArr = domUtils.getElementsByTagName(editor.body, \"table\"),\n\t\t\t\tcolor;\n\t\t\tfor (var i = 0, node; node = tableArr[i++];) {\n\t\t\t\tvar td = domUtils.getElementsByTagName(node, \"td\");\n\t\t\t\tif (td[0]) {\n\t\t\t\t\tif (flag) {\n\t\t\t\t\t\tcolor = (td[0].style.borderColor).replace(/\\s/g, \"\");\n\t\t\t\t\t\tif (/(#ffffff)|(rgb\\(255,255,255\\))/ig.test(color))\n\t\t\t\t\t\t\tdomUtils.addClass(node, \"noBorderTable\")\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomUtils.removeClasses(node, \"noBorderTable\")\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tfunction getTableWidth(editor, needIEHack, defaultValue) {\n\t\t\tvar body = editor.body;\n\t\t\treturn body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (editor.options.offsetWidth || 0);\n\t\t}\n\n\t\t/**\n\t\t * 获取当前拖动的单元格\n\t\t */\n\t\tfunction getTargetTd(editor, evt) {\n\n\t\t\tvar target = domUtils.findParentByTagName(evt.target || evt.srcElement, [\"td\", \"th\"], true),\n\t\t\t\tdir = null;\n\n\t\t\tif (!target) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tdir = getRelation(target, mouseCoords(evt));\n\n\t\t\t//如果有前一个节点， 需要做一个修正， 否则可能会得到一个错误的td\n\n\t\t\tif (!target) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (dir === 'h1' && target.previousSibling) {\n\n\t\t\t\tvar position = domUtils.getXY(target),\n\t\t\t\t\tcellWidth = target.offsetWidth;\n\n\t\t\t\tif (Math.abs(position.x + cellWidth - evt.clientX) > cellWidth / 3) {\n\t\t\t\t\ttarget = target.previousSibling;\n\t\t\t\t}\n\n\t\t\t} else if (dir === 'v1' && target.parentNode.previousSibling) {\n\n\t\t\t\tvar position = domUtils.getXY(target),\n\t\t\t\t\tcellHeight = target.offsetHeight;\n\n\t\t\t\tif (Math.abs(position.y + cellHeight - evt.clientY) > cellHeight / 3) {\n\t\t\t\t\ttarget = target.parentNode.previousSibling.firstChild;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//排除了非td内部以及用于代码高亮部分的td\n\t\t\treturn target && !(editor.fireEvent(\"excludetable\", target) === true) ? target : null;\n\t\t}\n\n\t};\n\n\t// plugins/table.sort.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: Jinqn\n\t * Date: 13-10-12\n\t * Time: 上午10:20\n\t * To change this template use File | Settings | File Templates.\n\t */\n\n\tUE.UETable.prototype.sortTable = function(sortByCellIndex, compareFn) {\n\t\tvar table = this.table,\n\t\t\trows = table.rows,\n\t\t\ttrArray = [],\n\t\t\tflag = rows[0].cells[0].tagName === \"TH\",\n\t\t\tlastRowIndex = 0;\n\t\tif (this.selectedTds.length) {\n\t\t\tvar range = this.cellsRange,\n\t\t\t\tlen = range.endRowIndex + 1;\n\t\t\tfor (var i = range.beginRowIndex; i < len; i++) {\n\t\t\t\ttrArray[i] = rows[i];\n\t\t\t}\n\t\t\ttrArray.splice(0, range.beginRowIndex);\n\t\t\tlastRowIndex = (range.endRowIndex + 1) === this.rowsNum ? 0 : range.endRowIndex + 1;\n\t\t} else {\n\t\t\tfor (var i = 0, len = rows.length; i < len; i++) {\n\t\t\t\ttrArray[i] = rows[i];\n\t\t\t}\n\t\t}\n\n\t\tvar Fn = {\n\t\t\t'reversecurrent': function(td1, td2) {\n\t\t\t\treturn 1;\n\t\t\t},\n\t\t\t'orderbyasc': function(td1, td2) {\n\t\t\t\tvar value1 = td1.innerText || td1.textContent,\n\t\t\t\t\tvalue2 = td2.innerText || td2.textContent;\n\t\t\t\treturn value1.localeCompare(value2);\n\t\t\t},\n\t\t\t'reversebyasc': function(td1, td2) {\n\t\t\t\tvar value1 = td1.innerHTML,\n\t\t\t\t\tvalue2 = td2.innerHTML;\n\t\t\t\treturn value2.localeCompare(value1);\n\t\t\t},\n\t\t\t'orderbynum': function(td1, td2) {\n\t\t\t\tvar value1 = td1[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/),\n\t\t\t\t\tvalue2 = td2[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/);\n\t\t\t\tif (value1) value1 = +value1[0];\n\t\t\t\tif (value2) value2 = +value2[0];\n\t\t\t\treturn (value1 || 0) - (value2 || 0);\n\t\t\t},\n\t\t\t'reversebynum': function(td1, td2) {\n\t\t\t\tvar value1 = td1[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/),\n\t\t\t\t\tvalue2 = td2[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/);\n\t\t\t\tif (value1) value1 = +value1[0];\n\t\t\t\tif (value2) value2 = +value2[0];\n\t\t\t\treturn (value2 || 0) - (value1 || 0);\n\t\t\t}\n\t\t};\n\n\t\t//对表格设置排序的标记data-sort-type\n\t\ttable.setAttribute('data-sort-type', compareFn && typeof compareFn === \"string\" && Fn[compareFn] ? compareFn : '');\n\n\t\t//th不参与排序\n\t\tflag && trArray.splice(0, 1);\n\t\ttrArray = utils.sort(trArray, function(tr1, tr2) {\n\t\t\tvar result;\n\t\t\tif (compareFn && typeof compareFn === \"function\") {\n\t\t\t\tresult = compareFn.call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t} else if (compareFn && typeof compareFn === \"number\") {\n\t\t\t\tresult = 1;\n\t\t\t} else if (compareFn && typeof compareFn === \"string\" && Fn[compareFn]) {\n\t\t\t\tresult = Fn[compareFn].call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t} else {\n\t\t\t\tresult = Fn['orderbyasc'].call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t\tvar fragment = table.ownerDocument.createDocumentFragment();\n\t\tfor (var j = 0, len = trArray.length; j < len; j++) {\n\t\t\tfragment.appendChild(trArray[j]);\n\t\t}\n\t\tvar tbody = table.getElementsByTagName(\"tbody\")[0];\n\t\tif (!lastRowIndex) {\n\t\t\ttbody.appendChild(fragment);\n\t\t} else {\n\t\t\ttbody.insertBefore(fragment, rows[lastRowIndex - range.endRowIndex + range.beginRowIndex - 1])\n\t\t}\n\t};\n\n\tUE.plugins['tablesort'] = function() {\n\t\tvar me = this,\n\t\t\tUT = UE.UETable,\n\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t},\n\t\t\tgetTableItemsByRange = function(editor) {\n\t\t\t\treturn UT.getTableItemsByRange(editor);\n\t\t\t};\n\n\t\tme.ready(function() {\n\t\t\t//添加表格可排序的样式\n\t\t\tutils.cssRule('tablesort',\n\t\t\t\t'table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;' +\n\t\t\t\t'   background-image:url(' + me.options.themePath + me.options.theme + '/images/sortable.png);}',\n\t\t\t\tme.document);\n\n\t\t\t//做单元格合并操作时,清除可排序标识\n\t\t\tme.addListener(\"afterexeccommand\", function(type, cmd) {\n\t\t\t\tif (cmd == 'mergeright' || cmd == 'mergedown' || cmd == 'mergecells') {\n\t\t\t\t\tthis.execCommand('disablesort');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t//表格排序\n\t\tUE.commands['sorttable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\ttableItems = getTableItemsByRange(me);\n\t\t\t\tif (!tableItems.cell) return -1;\n\t\t\t\tvar table = tableItems.table,\n\t\t\t\t\tcells = table.getElementsByTagName(\"td\");\n\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\tif (cell.rowSpan != 1 || cell.colSpan != 1) return -1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\texecCommand: function(cmd, fn) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\tbk = range.createBookmark(true),\n\t\t\t\t\ttableItems = getTableItemsByRange(me),\n\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\tut = getUETable(tableItems.table),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\tut.sortTable(cellInfo.cellIndex, fn);\n\t\t\t\trange.moveToBookmark(bk);\n\t\t\t\ttry {\n\t\t\t\t\trange.select();\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\t\t};\n\n\t\t//设置表格可排序,清除表格可排序\n\t\tUE.commands[\"enablesort\"] = UE.commands[\"disablesort\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table && cmd == 'enablesort') {\n\t\t\t\t\tvar cells = domUtils.getElementsByTagName(table, 'th td');\n\t\t\t\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\t\t\t\tif (cells[i].getAttribute('colspan') > 1 || cells[i].getAttribute('rowspan') > 1) return -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn !table ? -1 : cmd == 'enablesort' ^ table.getAttribute('data-sort') != 'sortEnabled' ? -1 : 0;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\ttable.setAttribute(\"data-sort\", cmd == \"enablesort\" ? \"sortEnabled\" : \"sortDisabled\");\n\t\t\t\tcmd == \"enablesort\" ? domUtils.addClass(table, \"sortEnabled\") : domUtils.removeClasses(table, \"sortEnabled\");\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/contextmenu.js\n\t///import core\n\t///commands 右键菜单\n\t///commandsName  ContextMenu\n\t///commandsTitle  右键菜单\n\t/**\n\t * 右键菜单\n\t * @function\n\t * @name baidu.editor.plugins.contextmenu\n\t * @author zhanyi\n\t */\n\n\tUE.plugins['contextmenu'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt('enableContextMenu', true);\n\t\tif (me.getOpt('enableContextMenu') === false) {\n\t\t\treturn;\n\t\t}\n\t\tvar lang = me.getLang(\"contextMenu\"),\n\t\t\tmenu,\n\t\t\titems = me.options.contextMenu || [{\n\t\t\t\t\tlabel: lang['selectall'],\n\t\t\t\t\tcmdName: 'selectall'\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang.cleardoc,\n\t\t\t\t\tcmdName: 'cleardoc',\n\t\t\t\t\texec: function() {\n\t\t\t\t\t\tif (confirm(lang.confirmclear)) {\n\t\t\t\t\t\t\tthis.execCommand('cleardoc');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tlabel: lang.unlink,\n\t\t\t\t\tcmdName: 'unlink'\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tgroup: lang.paragraph,\n\t\t\t\t\ticon: 'justifyjustify',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tlabel: lang.justifyleft,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'left'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.justifyright,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'right'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.justifycenter,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'center'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.justifyjustify,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'justify'\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tgroup: lang.table,\n\t\t\t\t\ticon: 'table',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tlabel: lang.inserttable,\n\t\t\t\t\t\t\tcmdName: 'inserttable'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletetable,\n\t\t\t\t\t\t\tcmdName: 'deletetable'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.deleterow,\n\t\t\t\t\t\t\tcmdName: 'deleterow'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletecol,\n\t\t\t\t\t\t\tcmdName: 'deletecol'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertcol,\n\t\t\t\t\t\t\tcmdName: 'insertcol'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertcolnext,\n\t\t\t\t\t\t\tcmdName: 'insertcolnext'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertrow,\n\t\t\t\t\t\t\tcmdName: 'insertrow'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertrownext,\n\t\t\t\t\t\t\tcmdName: 'insertrownext'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.insertcaption,\n\t\t\t\t\t\t\tcmdName: 'insertcaption'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletecaption,\n\t\t\t\t\t\t\tcmdName: 'deletecaption'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.inserttitle,\n\t\t\t\t\t\t\tcmdName: 'inserttitle'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletetitle,\n\t\t\t\t\t\t\tcmdName: 'deletetitle'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.inserttitlecol,\n\t\t\t\t\t\t\tcmdName: 'inserttitlecol'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletetitlecol,\n\t\t\t\t\t\t\tcmdName: 'deletetitlecol'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.mergecells,\n\t\t\t\t\t\t\tcmdName: 'mergecells'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.mergeright,\n\t\t\t\t\t\t\tcmdName: 'mergeright'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.mergedown,\n\t\t\t\t\t\t\tcmdName: 'mergedown'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.splittorows,\n\t\t\t\t\t\t\tcmdName: 'splittorows'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.splittocols,\n\t\t\t\t\t\t\tcmdName: 'splittocols'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.splittocells,\n\t\t\t\t\t\t\tcmdName: 'splittocells'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.averageDiseRow,\n\t\t\t\t\t\t\tcmdName: 'averagedistributerow'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.averageDisCol,\n\t\t\t\t\t\t\tcmdName: 'averagedistributecol'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.edittd,\n\t\t\t\t\t\t\tcmdName: 'edittd',\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tif (UE.ui['edittd']) {\n\t\t\t\t\t\t\t\t\tnew UE.ui['edittd'](this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.getDialog('edittd').open();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.edittable,\n\t\t\t\t\t\t\tcmdName: 'edittable',\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tif (UE.ui['edittable']) {\n\t\t\t\t\t\t\t\t\tnew UE.ui['edittable'](this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.getDialog('edittable').open();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.setbordervisible,\n\t\t\t\t\t\t\tcmdName: 'setbordervisible'\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.tablesort,\n\t\t\t\t\ticon: 'tablesort',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tlabel: lang.enablesort,\n\t\t\t\t\t\t\tcmdName: 'enablesort'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.disablesort,\n\t\t\t\t\t\t\tcmdName: 'disablesort'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.reversecurrent,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'reversecurrent'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.orderbyasc,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'orderbyasc'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.reversebyasc,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'reversebyasc'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.orderbynum,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'orderbynum'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.reversebynum,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'reversebynum'\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.borderbk,\n\t\t\t\t\ticon: 'borderBack',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tlabel: lang.setcolor,\n\t\t\t\t\t\tcmdName: \"interlacetable\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"interlacetable\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.unsetcolor,\n\t\t\t\t\t\tcmdName: \"uninterlacetable\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"uninterlacetable\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.setbackground,\n\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\tcolorList: [\"#bbb\", \"#ccc\"]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.unsetbackground,\n\t\t\t\t\t\tcmdName: \"cleartablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"cleartablebackground\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.redandblue,\n\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\tcolorList: [\"red\", \"blue\"]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.threecolorgradient,\n\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\tcolorList: [\"#aaa\", \"#bbb\", \"#ccc\"]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.aligntd,\n\t\t\t\t\ticon: 'aligntd',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.aligntable,\n\t\t\t\t\ticon: 'aligntable',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\tclassName: 'left',\n\t\t\t\t\t\tlabel: lang.tableleft,\n\t\t\t\t\t\tvalue: \"left\"\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\tclassName: 'center',\n\t\t\t\t\t\tlabel: lang.tablecenter,\n\t\t\t\t\t\tvalue: \"center\"\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\tclassName: 'right',\n\t\t\t\t\t\tlabel: lang.tableright,\n\t\t\t\t\t\tvalue: \"right\"\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tlabel: lang.insertparagraphbefore,\n\t\t\t\t\tcmdName: 'insertparagraph',\n\t\t\t\t\tvalue: true\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang.insertparagraphafter,\n\t\t\t\t\tcmdName: 'insertparagraph'\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang['copy'],\n\t\t\t\t\tcmdName: 'copy'\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang['paste'],\n\t\t\t\t\tcmdName: 'paste'\n\t\t\t\t}\n\t\t\t];\n\t\tif (!items.length) {\n\t\t\treturn;\n\t\t}\n\t\tvar uiUtils = UE.ui.uiUtils;\n\n\t\tme.addListener('contextmenu', function(type, evt) {\n\n\t\t\tvar offset = uiUtils.getViewportOffsetByEvent(evt);\n\t\t\tme.fireEvent('beforeselectionchange');\n\t\t\tif (menu) {\n\t\t\t\tmenu.destroy();\n\t\t\t}\n\t\t\tfor (var i = 0, ti, contextItems = []; ti = items[i]; i++) {\n\t\t\t\tvar last;\n\t\t\t\t(function(item) {\n\t\t\t\t\tif (item == '-') {\n\t\t\t\t\t\tif ((last = contextItems[contextItems.length - 1]) && last !== '-') {\n\t\t\t\t\t\t\tcontextItems.push('-');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (item.hasOwnProperty(\"group\")) {\n\t\t\t\t\t\tfor (var j = 0, cj, subMenu = []; cj = item.subMenu[j]; j++) {\n\t\t\t\t\t\t\t(function(subItem) {\n\t\t\t\t\t\t\t\tif (subItem == '-') {\n\t\t\t\t\t\t\t\t\tif ((last = subMenu[subMenu.length - 1]) && last !== '-') {\n\t\t\t\t\t\t\t\t\t\tsubMenu.push('-');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsubMenu.splice(subMenu.length - 1);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif ((me.commands[subItem.cmdName] || UE.commands[subItem.cmdName] || subItem.query) &&\n\t\t\t\t\t\t\t\t\t\t(subItem.query ? subItem.query() : me.queryCommandState(subItem.cmdName)) > -1) {\n\t\t\t\t\t\t\t\t\t\tsubMenu.push({\n\t\t\t\t\t\t\t\t\t\t\t'label': subItem.label || me.getLang(\"contextMenu.\" + subItem.cmdName + (subItem.value || '')) || \"\",\n\t\t\t\t\t\t\t\t\t\t\t'className': 'edui-for-' + subItem.cmdName + (subItem.className ? (' edui-for-' + subItem.cmdName + '-' + subItem.className) : ''),\n\t\t\t\t\t\t\t\t\t\t\tonclick: subItem.exec ? function() {\n\t\t\t\t\t\t\t\t\t\t\t\tsubItem.exec.call(me);\n\t\t\t\t\t\t\t\t\t\t\t} : function() {\n\t\t\t\t\t\t\t\t\t\t\t\tme.execCommand(subItem.cmdName, subItem.value);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})(cj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (subMenu.length) {\n\t\t\t\t\t\t\tfunction getLabel() {\n\t\t\t\t\t\t\t\tswitch (item.icon) {\n\t\t\t\t\t\t\t\t\tcase \"table\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.table\");\n\t\t\t\t\t\t\t\t\tcase \"justifyjustify\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.paragraph\");\n\t\t\t\t\t\t\t\t\tcase \"aligntd\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.aligntd\");\n\t\t\t\t\t\t\t\t\tcase \"aligntable\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.aligntable\");\n\t\t\t\t\t\t\t\t\tcase \"tablesort\":\n\t\t\t\t\t\t\t\t\t\treturn lang.tablesort;\n\t\t\t\t\t\t\t\t\tcase \"borderBack\":\n\t\t\t\t\t\t\t\t\t\treturn lang.borderbk;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcontextItems.push({\n\t\t\t\t\t\t\t\t//todo 修正成自动获取方式\n\t\t\t\t\t\t\t\t'label': getLabel(),\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + item.icon,\n\t\t\t\t\t\t\t\t'subMenu': {\n\t\t\t\t\t\t\t\t\titems: subMenu,\n\t\t\t\t\t\t\t\t\teditor: me\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//有可能commmand没有加载右键不能出来，或者没有command也想能展示出来添加query方法\n\t\t\t\t\t\tif ((me.commands[item.cmdName] || UE.commands[item.cmdName] || item.query) &&\n\t\t\t\t\t\t\t(item.query ? item.query.call(me) : me.queryCommandState(item.cmdName)) > -1) {\n\n\t\t\t\t\t\t\tcontextItems.push({\n\t\t\t\t\t\t\t\t'label': item.label || me.getLang(\"contextMenu.\" + item.cmdName),\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + (item.icon ? item.icon : item.cmdName + (item.value || '')),\n\t\t\t\t\t\t\t\tonclick: item.exec ? function() {\n\t\t\t\t\t\t\t\t\titem.exec.call(me);\n\t\t\t\t\t\t\t\t} : function() {\n\t\t\t\t\t\t\t\t\tme.execCommand(item.cmdName, item.value);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t})(ti);\n\t\t\t}\n\t\t\tif (contextItems[contextItems.length - 1] == '-') {\n\t\t\t\tcontextItems.pop();\n\t\t\t}\n\n\t\t\tmenu = new UE.ui.Menu({\n\t\t\t\titems: contextItems,\n\t\t\t\tclassName: \"edui-contextmenu\",\n\t\t\t\teditor: me\n\t\t\t});\n\t\t\tmenu.render();\n\t\t\tmenu.showAt(offset);\n\n\t\t\tme.fireEvent(\"aftershowcontextmenu\", menu);\n\n\t\t\tdomUtils.preventDefault(evt);\n\t\t\tif (browser.ie) {\n\t\t\t\tvar ieRange;\n\t\t\t\ttry {\n\t\t\t\t\tieRange = me.selection.getNative().createRange();\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (ieRange.item) {\n\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\trange.selectNode(ieRange.item(0)).select(true, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// 添加复制的flash按钮\n\t\tme.addListener('aftershowcontextmenu', function(type, menu) {\n\t\t\tif (me.zeroclipboard) {\n\t\t\t\tvar items = menu.items;\n\t\t\t\tfor (var key in items) {\n\t\t\t\t\tif (items[key].className == 'edui-for-copy') {\n\t\t\t\t\t\tme.zeroclipboard.clip(items[key].getDom());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t};\n\n\t// plugins/shortcutmenu.js\n\t///import core\n\t///commands       弹出菜单\n\t// commandsName  popupmenu\n\t///commandsTitle  弹出菜单\n\t/**\n\t * 弹出菜单\n\t * @function\n\t * @name baidu.editor.plugins.popupmenu\n\t * @author xuheng\n\t */\n\n\tUE.plugins['shortcutmenu'] = function() {\n\t\tvar me = this,\n\t\t\tmenu,\n\t\t\titems = me.options.shortcutMenu || [];\n\n\t\tif (!items.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tme.addListener('contextmenu mouseup', function(type, e) {\n\t\t\tvar me = this,\n\t\t\t\tcustomEvt = {\n\t\t\t\t\ttype: type,\n\t\t\t\t\ttarget: e.target || e.srcElement,\n\t\t\t\t\tscreenX: e.screenX,\n\t\t\t\t\tscreenY: e.screenY,\n\t\t\t\t\tclientX: e.clientX,\n\t\t\t\t\tclientY: e.clientY\n\t\t\t\t};\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tif (rng.collapsed === false || type == \"contextmenu\") {\n\n\t\t\t\t\tif (!menu) {\n\t\t\t\t\t\tmenu = new baidu.editor.ui.ShortCutMenu({\n\t\t\t\t\t\t\teditor: me,\n\t\t\t\t\t\t\titems: items,\n\t\t\t\t\t\t\ttheme: me.options.theme,\n\t\t\t\t\t\t\tclassName: 'edui-shortcutmenu'\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tmenu.render();\n\t\t\t\t\t\tme.fireEvent(\"afterrendershortcutmenu\", menu);\n\t\t\t\t\t}\n\n\t\t\t\t\tmenu.show(customEvt, !!UE.plugins['contextmenu']);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (type == 'contextmenu') {\n\t\t\t\tdomUtils.preventDefault(e);\n\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\tvar ieRange;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tieRange = me.selection.getNative().createRange();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (ieRange.item) {\n\t\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\t\trange.selectNode(ieRange.item(0)).select(true, true);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('keydown', function(type) {\n\t\t\tif (type == \"keydown\") {\n\t\t\t\tmenu && !menu.isHidden && menu.hide();\n\t\t\t}\n\n\t\t});\n\n\t};\n\n\t// plugins/basestyle.js\n\t/**\n\t * B、I、sub、super命令支持\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['basestyle'] = function() {\n\n\t\t/**\n\t\t * 字体加粗\n\t\t * @command bold\n\t\t * @param { String } cmd 命令字符串\n\t\t * @remind 对已加粗的文本内容执行该命令， 将取消加粗\n\t\t * @method execCommand\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行加粗操作\n\t\t * //第一次执行， 文本内容加粗\n\t\t * editor.execCommand( 'bold' );\n\t\t *\n\t\t * //第二次执行， 文本内容取消加粗\n\t\t * editor.execCommand( 'bold' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 字体倾斜\n\t\t * @command italic\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @remind 对已倾斜的文本内容执行该命令， 将取消倾斜\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行斜体操作\n\t\t * //第一次操作， 文本内容将变成斜体\n\t\t * editor.execCommand( 'italic' );\n\t\t *\n\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t * editor.execCommand( 'italic' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 下标文本，与“superscript”命令互斥\n\t\t * @command subscript\n\t\t * @method execCommand\n\t\t * @remind  把选中的文本内容切换成下标文本， 如果当前选中的文本已经是下标， 则该操作会把文本内容还原成正常文本\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行下标操作\n\t\t * //第一次操作， 文本内容将变成下标文本\n\t\t * editor.execCommand( 'subscript' );\n\t\t *\n\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t * editor.execCommand( 'subscript' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 上标文本，与“subscript”命令互斥\n\t\t * @command superscript\n\t\t * @method execCommand\n\t\t * @remind 把选中的文本内容切换成上标文本， 如果当前选中的文本已经是上标， 则该操作会把文本内容还原成正常文本\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行上标操作\n\t\t * //第一次操作， 文本内容将变成上标文本\n\t\t * editor.execCommand( 'superscript' );\n\t\t *\n\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t * editor.execCommand( 'superscript' );\n\t\t * ```\n\t\t */\n\t\tvar basestyles = {\n\t\t\t\t'bold': ['strong', 'b'],\n\t\t\t\t'italic': ['em', 'i'],\n\t\t\t\t'subscript': ['sub'],\n\t\t\t\t'superscript': ['sup'],\n\t\t\t\t'underline':['u']\n\t\t\t},\n\t\t\tgetObj = function(editor, tagNames) {\n\t\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), tagNames);\n\t\t\t},\n\t\t\tme = this;\n\t\t//添加快捷键\n\t\tme.addshortcutkey({\n\t\t\t\"Bold\": \"ctrl+66\", //^B\n\t\t\t\"Italic\": \"ctrl+73\", //^I\n\t\t\t\"Underline\": \"ctrl+85\" //^U\n\t\t});\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('b i'), function(node) {\n\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tnode.tagName = 'strong';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\tnode.tagName = 'em';\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tfor (var style in basestyles) {\n\t\t\t(function(cmd, tagNames) {\n\t\t\t\tme.commands[cmd] = {\n\t\t\t\t\texecCommand: function(cmdName) {\n\t\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\t\tobj = getObj(this, tagNames);\n\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\tif (obj) {\n\t\t\t\t\t\t\t\tvar tmpText = me.document.createTextNode('');\n\t\t\t\t\t\t\t\trange.insertNode(tmpText).removeInlineStyle(tagNames);\n\t\t\t\t\t\t\t\trange.setStartBefore(tmpText);\n\t\t\t\t\t\t\t\tdomUtils.remove(tmpText);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar tmpNode = range.document.createElement(tagNames[0]);\n\t\t\t\t\t\t\t\tif (cmdName == 'superscript' || cmdName == 'subscript') {\n\t\t\t\t\t\t\t\t\ttmpText = me.document.createTextNode('');\n\t\t\t\t\t\t\t\t\trange.insertNode(tmpText)\n\t\t\t\t\t\t\t\t\t\t.removeInlineStyle(['sub', 'sup'])\n\t\t\t\t\t\t\t\t\t\t.setStartBefore(tmpText)\n\t\t\t\t\t\t\t\t\t\t.collapse(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.insertNode(tmpNode).setStart(tmpNode, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (cmdName == 'superscript' || cmdName == 'subscript') {\n\t\t\t\t\t\t\t\tif (!obj || obj.tagName.toLowerCase() != cmdName) {\n\t\t\t\t\t\t\t\t\trange.removeInlineStyle(['sub', 'sup']);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobj ? range.removeInlineStyle(tagNames) : range.applyInlineStyle(tagNames[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.select();\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn getObj(this, tagNames) ? 1 : 0;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t})(style, basestyles[style]);\n\t\t}\n\t};\n\n\t// plugins/elementpath.js\n\t/**\n\t * 选取路径命令\n\t * @file\n\t */\n\tUE.plugins['elementpath'] = function() {\n\t\tvar currentLevel,\n\t\t\ttagNames,\n\t\t\tme = this;\n\t\tme.setOpt('elementPathEnabled', true);\n\t\tif (!me.options.elementPathEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tme.commands['elementpath'] = {\n\t\t\texecCommand: function(cmdName, level) {\n\t\t\t\tvar start = tagNames[level],\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\tcurrentLevel = level * 1;\n\t\t\t\trange.selectNode(start).select();\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\t//产生一个副本，不能修改原来的startElementPath;\n\t\t\t\tvar parents = [].concat(this.selection.getStartElementPath()).reverse(),\n\t\t\t\t\tnames = [];\n\t\t\t\ttagNames = parents;\n\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\tif (ci.nodeType == 3) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar name = ci.tagName.toLowerCase();\n\t\t\t\t\tif (name == 'img' && ci.getAttribute('anchorname')) {\n\t\t\t\t\t\tname = 'anchor';\n\t\t\t\t\t}\n\t\t\t\t\tnames[i] = name;\n\t\t\t\t\tif (currentLevel == i) {\n\t\t\t\t\t\tcurrentLevel = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn names;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/formatmatch.js\n\t/**\n\t * 格式刷，只格式inline的\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 格式刷\n\t * @command formatmatch\n\t * @method execCommand\n\t * @remind 该操作不能复制段落格式\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * //editor是编辑器实例\n\t * //获取格式刷\n\t * editor.execCommand( 'formatmatch' );\n\t * ```\n\t */\n\tUE.plugins['formatmatch'] = function() {\n\n\t\tvar me = this,\n\t\t\tlist = [],\n\t\t\timg,\n\t\t\tflag = 0;\n\n\t\tme.addListener('reset', function() {\n\t\t\tlist = [];\n\t\t\tflag = 0;\n\t\t});\n\n\t\tfunction addList(type, evt) {\n\n\t\t\tif (browser.webkit) {\n\t\t\t\tvar target = evt.target.tagName == 'IMG' ? evt.target : null;\n\t\t\t}\n\n\t\t\tfunction addFormat(range) {\n\n\t\t\t\tif (text) {\n\t\t\t\t\trange.selectNode(text);\n\t\t\t\t}\n\t\t\t\treturn range.applyInlineStyle(list[list.length - 1].tagName, null, list);\n\n\t\t\t}\n\n\t\t\tme.undoManger && me.undoManger.save();\n\n\t\t\tvar range = me.selection.getRange(),\n\t\t\t\timgT = target || range.getClosedNode();\n\t\t\tif (img && imgT && imgT.tagName == 'IMG') {\n\t\t\t\t//trace:964\n\n\t\t\t\timgT.style.cssText += ';float:' + (img.style.cssFloat || img.style.styleFloat || 'none') + ';display:' + (img.style.display || 'inline');\n\n\t\t\t\timg = null;\n\t\t\t} else {\n\t\t\t\tif (!img) {\n\t\t\t\t\tvar collapsed = range.collapsed;\n\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\tvar text = me.document.createTextNode('match');\n\t\t\t\t\t\trange.insertNode(text).select();\n\n\t\t\t\t\t}\n\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t//不能把block上的属性干掉\n\t\t\t\t\t//trace:1553\n\t\t\t\t\tvar removeFormatAttributes = me.options.removeFormatAttributes;\n\t\t\t\t\tme.options.removeFormatAttributes = '';\n\t\t\t\t\tme.execCommand('removeformat');\n\t\t\t\t\tme.options.removeFormatAttributes = removeFormatAttributes;\n\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t//trace:969\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (list.length) {\n\t\t\t\t\t\taddFormat(range);\n\t\t\t\t\t}\n\t\t\t\t\tif (text) {\n\t\t\t\t\t\trange.setStartBefore(text).collapse(true);\n\n\t\t\t\t\t}\n\t\t\t\t\trange.select();\n\t\t\t\t\ttext && domUtils.remove(text);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tme.undoManger && me.undoManger.save();\n\t\t\tme.removeListener('mouseup', addList);\n\t\t\tflag = 0;\n\t\t}\n\n\t\tme.commands['formatmatch'] = {\n\t\t\texecCommand: function(cmdName) {\n\n\t\t\t\tif (flag) {\n\t\t\t\t\tflag = 0;\n\t\t\t\t\tlist = [];\n\t\t\t\t\tme.removeListener('mouseup', addList);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\timg = range.getClosedNode();\n\t\t\t\tif (!img || img.tagName != 'IMG') {\n\t\t\t\t\trange.collapse(true).shrinkBoundary();\n\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\tlist = domUtils.findParents(start, true, function(node) {\n\t\t\t\t\t\treturn !domUtils.isBlockElm(node) && node.nodeType == 1;\n\t\t\t\t\t});\n\t\t\t\t\t//a不能加入格式刷, 并且克隆节点\n\t\t\t\t\tfor (var i = 0, ci; ci = list[i]; i++) {\n\t\t\t\t\t\tif (ci.tagName == 'A') {\n\t\t\t\t\t\t\tlist.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tme.addListener('mouseup', addList);\n\t\t\t\tflag = 1;\n\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn flag;\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\t};\n\n\t// plugins/searchreplace.js\n\t///import core\n\t///commands 查找替换\n\t///commandsName  SearchReplace\n\t///commandsTitle  查询替换\n\t///commandsDialog  dialogs\\searchreplace\n\t/**\n\t * @description 查找替换\n\t * @author zhanyi\n\t */\n\n\tUE.plugin.register('searchreplace', function() {\n\t\tvar me = this;\n\n\t\tvar _blockElm = {\n\t\t\t'table': 1,\n\t\t\t'tbody': 1,\n\t\t\t'tr': 1,\n\t\t\t'ol': 1,\n\t\t\t'ul': 1\n\t\t};\n\n\t\tfunction findTextInString(textContent, opt, currentIndex) {\n\t\t\tvar str = opt.searchStr;\n\t\t\tif (opt.dir == -1) {\n\t\t\t\ttextContent = textContent.split('').reverse().join('');\n\t\t\t\tstr = str.split('').reverse().join('');\n\t\t\t\tcurrentIndex = textContent.length - currentIndex;\n\n\t\t\t}\n\t\t\tvar reg = new RegExp(str, 'g' + (opt.casesensitive ? '' : 'i')),\n\t\t\t\tmatch;\n\n\t\t\twhile (match = reg.exec(textContent)) {\n\t\t\t\tif (match.index >= currentIndex) {\n\t\t\t\t\treturn opt.dir == -1 ? textContent.length - match.index - opt.searchStr.length : match.index;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1\n\t\t}\n\n\t\tfunction findTextBlockElm(node, currentIndex, opt) {\n\t\t\tvar textContent, index, methodName = opt.all || opt.dir == 1 ? 'getNextDomNode' : 'getPreDomNode';\n\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\tnode = node.firstChild;\n\t\t\t}\n\t\t\tvar first = 1;\n\t\t\twhile (node) {\n\t\t\t\ttextContent = node.nodeType == 3 ? node.nodeValue : node[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\tindex = findTextInString(textContent, opt, currentIndex);\n\t\t\t\tfirst = 0;\n\t\t\t\tif (index != -1) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'node': node,\n\t\t\t\t\t\t'index': index\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnode = domUtils[methodName](node);\n\t\t\t\twhile (node && _blockElm[node.nodeName.toLowerCase()]) {\n\t\t\t\t\tnode = domUtils[methodName](node, true);\n\t\t\t\t}\n\t\t\t\tif (node) {\n\t\t\t\t\tcurrentIndex = opt.dir == -1 ? (node.nodeType == 3 ? node.nodeValue : node[browser.ie ? 'innerText' : 'textContent']).length : 0;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tfunction findNTextInBlockElm(node, index, str) {\n\t\t\tvar currentIndex = 0,\n\t\t\t\tcurrentNode = node.firstChild,\n\t\t\t\tcurrentNodeLength = 0,\n\t\t\t\tresult;\n\t\t\twhile (currentNode) {\n\t\t\t\tif (currentNode.nodeType == 3) {\n\t\t\t\t\tcurrentNodeLength = currentNode.nodeValue.replace(/(^[\\t\\r\\n]+)|([\\t\\r\\n]+$)/, '').length;\n\t\t\t\t\tcurrentIndex += currentNodeLength;\n\t\t\t\t\tif (currentIndex >= index) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t'node': currentNode,\n\t\t\t\t\t\t\t'index': currentNodeLength - (currentIndex - index)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (!dtd.$empty[currentNode.tagName]) {\n\t\t\t\t\tcurrentNodeLength = currentNode[browser.ie ? 'innerText' : 'textContent'].replace(/(^[\\t\\r\\n]+)|([\\t\\r\\n]+$)/, '').length\n\t\t\t\t\tcurrentIndex += currentNodeLength;\n\t\t\t\t\tif (currentIndex >= index) {\n\t\t\t\t\t\tresult = findNTextInBlockElm(currentNode, currentNodeLength - (currentIndex - index), str);\n\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcurrentNode = domUtils.getNextDomNode(currentNode);\n\n\t\t\t}\n\t\t}\n\n\t\tfunction searchReplace(me, opt) {\n\n\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\tstartBlockNode,\n\t\t\t\tsearchStr = opt.searchStr,\n\t\t\t\tspan = me.document.createElement('span');\n\t\t\tspan.innerHTML = '$$ueditor_searchreplace_key$$';\n\n\t\t\trng.shrinkBoundary(true);\n\n\t\t\t//判断是不是第一次选中\n\t\t\tif (!rng.collapsed) {\n\t\t\t\trng.select();\n\t\t\t\tvar rngText = me.selection.getText();\n\t\t\t\tif (new RegExp('^' + opt.searchStr + '$', (opt.casesensitive ? '' : 'i')).test(rngText)) {\n\t\t\t\t\tif (opt.replaceStr != undefined) {\n\t\t\t\t\t\treplaceText(rng, opt.replaceStr);\n\t\t\t\t\t\trng.select();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.collapse(opt.dir == -1)\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trng.insertNode(span);\n\t\t\trng.enlargeToBlockElm(true);\n\t\t\tstartBlockNode = rng.startContainer;\n\t\t\tvar currentIndex = startBlockNode[browser.ie ? 'innerText' : 'textContent'].indexOf('$$ueditor_searchreplace_key$$');\n\t\t\trng.setStartBefore(span);\n\t\t\tdomUtils.remove(span);\n\t\t\tvar result = findTextBlockElm(startBlockNode, currentIndex, opt);\n\t\t\tif (result) {\n\t\t\t\tvar rngStart = findNTextInBlockElm(result.node, result.index, searchStr);\n\t\t\t\tvar rngEnd = findNTextInBlockElm(result.node, result.index + searchStr.length, searchStr);\n\t\t\t\trng.setStart(rngStart.node, rngStart.index).setEnd(rngEnd.node, rngEnd.index);\n\n\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\treplaceText(rng, opt.replaceStr)\n\t\t\t\t}\n\t\t\t\trng.select();\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\trng.setCursor()\n\t\t\t}\n\n\t\t}\n\n\t\tfunction replaceText(rng, str) {\n\n\t\t\tstr = me.document.createTextNode(str);\n\t\t\trng.deleteContents().insertNode(str);\n\n\t\t}\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t'searchreplace': {\n\t\t\t\t\texecCommand: function(cmdName, opt) {\n\t\t\t\t\t\tutils.extend(opt, {\n\t\t\t\t\t\t\tall: false,\n\t\t\t\t\t\t\tcasesensitive: false,\n\t\t\t\t\t\t\tdir: 1\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tvar num = 0;\n\t\t\t\t\t\tif (opt.all) {\n\n\t\t\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\t\t\tfirst = me.body.firstChild;\n\t\t\t\t\t\t\tif (first && first.nodeType == 1) {\n\t\t\t\t\t\t\t\trng.setStart(first, 0);\n\t\t\t\t\t\t\t\trng.shrinkBoundary(true);\n\t\t\t\t\t\t\t} else if (first.nodeType == 3) {\n\t\t\t\t\t\t\t\trng.setStartBefore(first)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.collapse(true).select(true);\n\t\t\t\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twhile (searchReplace(this, opt)) {\n\t\t\t\t\t\t\t\tnum++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (num) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (searchReplace(this, opt)) {\n\t\t\t\t\t\t\t\tnum++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (num) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn num;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: 1\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/customstyle.js\n\t/**\n\t * 自定义样式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 根据config配置文件里“customstyle”选项的值对匹配的标签执行样式替换。\n\t * @command customstyle\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'customstyle' );\n\t * ```\n\t */\n\tUE.plugins['customstyle'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'customstyle': [{\n\t\t\t\ttag: 'h1',\n\t\t\t\tname: 'tc',\n\t\t\t\tstyle: 'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;'\n\t\t\t}, {\n\t\t\t\ttag: 'h1',\n\t\t\t\tname: 'tl',\n\t\t\t\tstyle: 'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;'\n\t\t\t}, {\n\t\t\t\ttag: 'span',\n\t\t\t\tname: 'im',\n\t\t\t\tstyle: 'font-size:16px;font-style:italic;font-weight:bold;line-height:18px;'\n\t\t\t}, {\n\t\t\t\ttag: 'span',\n\t\t\t\tname: 'hi',\n\t\t\t\tstyle: 'font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;'\n\t\t\t}]\n\t\t});\n\t\tme.commands['customstyle'] = {\n\t\t\texecCommand: function(cmdName, obj) {\n\t\t\t\tvar me = this,\n\t\t\t\t\ttagName = obj.tag,\n\t\t\t\t\tnode = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\treturn node.getAttribute('label');\n\t\t\t\t\t}, true),\n\t\t\t\t\trange, bk, tmpObj = {};\n\t\t\t\tfor (var p in obj) {\n\t\t\t\t\tif (obj[p] !== undefined)\n\t\t\t\t\t\ttmpObj[p] = obj[p];\n\t\t\t\t}\n\t\t\t\tdelete tmpObj.tag;\n\t\t\t\tif (node && node.getAttribute('label') == obj.label) {\n\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t//trace:1732 删掉自定义标签，要有p来回填站位\n\t\t\t\t\t\tif (dtd.$block[node.tagName]) {\n\t\t\t\t\t\t\tvar fillNode = me.document.createElement('p');\n\t\t\t\t\t\t\tdomUtils.moveChild(node, fillNode);\n\t\t\t\t\t\t\tnode.parentNode.insertBefore(fillNode, node);\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tvar common = domUtils.getCommonAncestor(bk.start, bk.end),\n\t\t\t\t\t\t\tnodes = domUtils.getElementsByTagName(common, tagName);\n\t\t\t\t\t\tif (new RegExp(tagName, 'i').test(common.tagName)) {\n\t\t\t\t\t\t\tnodes.push(common);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ni; ni = nodes[i++];) {\n\t\t\t\t\t\t\tif (ni.getAttribute('label') == obj.label) {\n\t\t\t\t\t\t\t\tvar ps = domUtils.getPosition(ni, bk.start),\n\t\t\t\t\t\t\t\t\tpe = domUtils.getPosition(ni, bk.end);\n\t\t\t\t\t\t\t\tif ((ps & domUtils.POSITION_FOLLOWING || ps & domUtils.POSITION_CONTAINS) &&\n\t\t\t\t\t\t\t\t\t(pe & domUtils.POSITION_PRECEDING || pe & domUtils.POSITION_CONTAINS)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tif (dtd.$block[tagName]) {\n\t\t\t\t\t\t\t\t\t\tvar fillNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\tdomUtils.moveChild(ni, fillNode);\n\t\t\t\t\t\t\t\t\t\tni.parentNode.insertBefore(fillNode, ni);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(ni, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = domUtils.findParent(common, function(node) {\n\t\t\t\t\t\t\treturn node.getAttribute('label') == obj.label;\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tif (node) {\n\n\t\t\t\t\t\t\tdomUtils.remove(node, true);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bk).select();\n\t\t\t\t} else {\n\t\t\t\t\tif (dtd.$block[tagName]) {\n\t\t\t\t\t\tthis.execCommand('paragraph', tagName, tmpObj, 'customstyle');\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\trange.collapse();\n\t\t\t\t\t\t\tnode = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\t\t\treturn node.getAttribute('label') == obj.label;\n\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\tvar pNode = me.document.createElement('p');\n\t\t\t\t\t\t\tdomUtils.insertAfter(node, pNode);\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, pNode);\n\t\t\t\t\t\t\trange.setStart(pNode, 0).setCursor();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\tnode = me.document.createElement(tagName);\n\t\t\t\t\t\t\tdomUtils.setAttributes(node, tmpObj);\n\t\t\t\t\t\t\trange.insertNode(node).setStart(node, 0).setCursor();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\trange.applyInlineStyle(tagName, tmpObj).moveToBookmark(bk).select();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar parent = domUtils.filterNodeList(\n\t\t\t\t\tthis.selection.getStartElementPath(),\n\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\treturn node.getAttribute('label')\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treturn parent ? parent.getAttribute('label') : '';\n\t\t\t}\n\t\t};\n\t\t//当去掉customstyle是，如果是块元素，用p代替\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\n\t\t\tif (keyCode == 32 || keyCode == 13) {\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tvar node = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\treturn node.getAttribute('label');\n\t\t\t\t\t}, true);\n\t\t\t\t\tif (node && dtd.$block[node.tagName] && domUtils.isEmptyNode(node)) {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\tdomUtils.insertAfter(node, p);\n\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/catchremoteimage.js\n\t///import core\n\t///commands 远程图片抓取\n\t///commandsName  catchRemoteImage,catchremoteimageenable\n\t///commandsTitle  远程图片抓取\n\t/**\n\t * 远程图片抓取,当开启本插件时所有不符合本地域名的图片都将被抓取成为本地服务器上的图片\n\t */\n\tUE.plugins['catchremoteimage'] = function() {\n\t\tvar me = this,\n\t\t\tajax = UE.ajax;\n\n\t\t/* 设置默认值 */\n\t\tif (me.options.catchRemoteImageEnable === false) return;\n\t\tme.setOpt({\n\t\t\tcatchRemoteImageEnable: false\n\t\t});\n\n\t\tme.addListener(\"afterpaste\", function() {\n\t\t\tme.fireEvent(\"catchRemoteImage\");\n\t\t});\n\n\t\tme.addListener(\"catchRemoteImage\", function() {\n\t\t\treturn;\n\t\t\tvar catcherLocalDomain = me.getOpt('catcherLocalDomain'),\n\t\t\t\tcatcherActionUrl = me.getActionUrl(me.getOpt('catcherActionName')),\n\t\t\t\tcatcherUrlPrefix = me.getOpt('catcherUrlPrefix'),\n\t\t\t\tcatcherFieldName = me.getOpt('catcherFieldName');\n\n\t\t\tvar remoteImages = [],\n\t\t\t\timgs = domUtils.getElementsByTagName(me.document, \"img\"),\n\t\t\t\ttest = function(src, urls) {\n\t\t\t\t\tif (src.indexOf(location.host) != -1 || /(^\\.)|(^\\/)/.test(src)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif (urls) {\n\t\t\t\t\t\tfor (var j = 0, url; url = urls[j++];) {\n\t\t\t\t\t\t\tif (src.indexOf(url) !== -1) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\tfor (var i = 0, ci; ci = imgs[i++];) {\n\t\t\t\tif (ci.getAttribute(\"word_img\")) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar src = ci.getAttribute(\"_src\") || ci.src || \"\";\n\t\t\t\tif (/^(https?|ftp):/i.test(src) && !test(src, catcherLocalDomain)) {\n\t\t\t\t\tremoteImages.push(src);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (remoteImages.length) {\n\t\t\t\tcatchremoteimage(remoteImages, {\n\t\t\t\t\t//成功抓取\n\t\t\t\t\tsuccess: function(r) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar info = r.state !== undefined ? r : eval(\"(\" + r.responseText + \")\");\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t/* 获取源路径和新路径 */\n\t\t\t\t\t\tvar i, j, ci, cj, oldSrc, newSrc, list = info.list;\n\n\t\t\t\t\t\tfor (i = 0; ci = imgs[i++];) {\n\t\t\t\t\t\t\toldSrc = ci.getAttribute(\"_src\") || ci.src || \"\";\n\t\t\t\t\t\t\tfor (j = 0; cj = list[j++];) {\n\t\t\t\t\t\t\t\tif (oldSrc == cj.source && cj.state == \"SUCCESS\") { //抓取失败时不做替换处理\n\t\t\t\t\t\t\t\t\tnewSrc = catcherUrlPrefix + cj.url;\n\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(ci, {\n\t\t\t\t\t\t\t\t\t\t\"src\": newSrc,\n\t\t\t\t\t\t\t\t\t\t\"_src\": newSrc\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('catchremotesuccess')\n\t\t\t\t\t},\n\t\t\t\t\t//回调失败，本次请求超时\n\t\t\t\t\terror: function() {\n\t\t\t\t\t\tme.fireEvent(\"catchremoteerror\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction catchremoteimage(imgs, callbacks) {\n\t\t\t\tvar params = utils.serializeParam(me.queryCommandValue('serverparam')) || '',\n\t\t\t\t\turl = utils.formatUrl(catcherActionUrl + (catcherActionUrl.indexOf('?') == -1 ? '?' : '&') + params),\n\t\t\t\t\tisJsonp = utils.isCrossDomainUrl(url),\n\t\t\t\t\topt = {\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': isJsonp ? 'jsonp' : '',\n\t\t\t\t\t\t'timeout': 60000, //单位：毫秒，回调请求超时设置。目标用户如果网速不是很快的话此处建议设置一个较大的数值\n\t\t\t\t\t\t'onsuccess': callbacks[\"success\"],\n\t\t\t\t\t\t'onerror': callbacks[\"error\"]\n\t\t\t\t\t};\n\t\t\t\topt[catcherFieldName] = imgs;\n\t\t\t\tajax.request(url, opt);\n\t\t\t}\n\n\t\t});\n\t};\n\n\t// plugins/snapscreen.js\n\t/**\n\t * 截屏插件，为UEditor提供插入支持\n\t * @file\n\t * @since 1.4.2\n\t */\n\tUE.plugin.register('snapscreen', function() {\n\n\t\tvar me = this;\n\t\tvar snapplugin;\n\n\t\tfunction getLocation(url) {\n\t\t\tvar search,\n\t\t\t\ta = document.createElement('a'),\n\t\t\t\tparams = utils.serializeParam(me.queryCommandValue('serverparam')) || '';\n\n\t\t\ta.href = url;\n\t\t\tif (browser.ie) {\n\t\t\t\ta.href = a.href;\n\t\t\t}\n\n\t\t\tsearch = a.search;\n\t\t\tif (params) {\n\t\t\t\tsearch = search + (search.indexOf('?') == -1 ? '?' : '&') + params;\n\t\t\t\tsearch = search.replace(/[&]+/ig, '&');\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t'port': a.port,\n\t\t\t\t'hostname': a.hostname,\n\t\t\t\t'path': a.pathname + search || +a.hash\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 字体背景颜色\n\t\t\t\t * @command snapscreen\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('snapscreen');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'snapscreen': {\n\t\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\t\tvar url, local, res;\n\t\t\t\t\t\tvar lang = me.getLang(\"snapScreen_plugin\");\n\n\t\t\t\t\t\tif (!snapplugin) {\n\t\t\t\t\t\t\tvar container = me.container;\n\t\t\t\t\t\t\tvar doc = me.container.ownerDocument || me.container.document;\n\t\t\t\t\t\t\tsnapplugin = doc.createElement(\"object\");\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tsnapplugin.type = \"application/x-pluginbaidusnap\";\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsnapplugin.style.cssText = \"position:absolute;left:-9999px;width:0;height:0;\";\n\t\t\t\t\t\t\tsnapplugin.setAttribute(\"width\", \"0\");\n\t\t\t\t\t\t\tsnapplugin.setAttribute(\"height\", \"0\");\n\t\t\t\t\t\t\tcontainer.appendChild(snapplugin);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfunction onSuccess(rs) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\trs = eval(\"(\" + rs + \")\");\n\t\t\t\t\t\t\t\tif (rs.state == 'SUCCESS') {\n\t\t\t\t\t\t\t\t\tvar opt = me.options;\n\t\t\t\t\t\t\t\t\tme.execCommand('insertimage', {\n\t\t\t\t\t\t\t\t\t\tsrc: opt.snapscreenUrlPrefix + rs.url,\n\t\t\t\t\t\t\t\t\t\t_src: opt.snapscreenUrlPrefix + rs.url,\n\t\t\t\t\t\t\t\t\t\talt: rs.title || '',\n\t\t\t\t\t\t\t\t\t\tfloatStyle: opt.snapscreenImgAlign\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\talert(rs.state);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\talert(lang.callBackErrorMsg);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdebugger;\n\t\t\t\t\t\turl = me.getActionUrl(me.getOpt('snapscreenActionName'));\n\t\t\t\t\t\tlocal = getLocation(url);\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tres = snapplugin.saveSnapshot(local.hostname, local.path, local.port);\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tme.ui._dialogs['snapscreenDialog'].open();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tonSuccess(res);\n\t\t\t\t\t\t}, 50);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn (navigator.userAgent.indexOf(\"Windows\", 0) != -1) ? 0 : -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/insertparagraph.js\n\t/**\n\t * 插入段落\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入段落\n\t * @command insertparagraph\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * //editor是编辑器实例\n\t * editor.execCommand( 'insertparagraph' );\n\t * ```\n\t */\n\n\tUE.commands['insertparagraph'] = {\n\t\texecCommand: function(cmdName, front) {\n\t\t\tvar me = this,\n\t\t\t\trange = me.selection.getRange(),\n\t\t\t\tstart = range.startContainer,\n\t\t\t\ttmpNode;\n\t\t\twhile (start) {\n\t\t\t\tif (domUtils.isBody(start)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttmpNode = start;\n\t\t\t\tstart = start.parentNode;\n\t\t\t}\n\t\t\tif (tmpNode) {\n\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\tif (front) {\n\t\t\t\t\ttmpNode.parentNode.insertBefore(p, tmpNode)\n\t\t\t\t} else {\n\t\t\t\t\ttmpNode.parentNode.insertBefore(p, tmpNode.nextSibling)\n\t\t\t\t}\n\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\trange.setStart(p, 0).setCursor(false, true);\n\t\t\t}\n\t\t}\n\t};\n\n\t// plugins/webapp.js\n\t/**\n\t * 百度应用\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入百度应用\n\t * @command webapp\n\t * @method execCommand\n\t * @remind 需要百度APPKey\n\t * @remind 百度应用主页： <a href=\"http://app.baidu.com/\" target=\"_blank\">http://app.baidu.com/</a>\n\t * @param { Object } appOptions 应用所需的参数项， 支持的key有： title=>应用标题， width=>应用容器宽度，\n\t * height=>应用容器高度，logo=>应用logo，url=>应用地址\n\t * @example\n\t * ```javascript\n\t * //editor是编辑器实例\n\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t * editor.execCommand( 'webapp' , {\n\t *     title: '植物大战僵尸',\n\t *     width: 560,\n\t *     height: 465,\n\t *     logo: '应用展示的图片',\n\t *     url: '百度应用的地址'\n\t * } );\n\t * ```\n\t */\n\n\t//UE.plugins['webapp'] = function () {\n\t//    var me = this;\n\t//    function createInsertStr( obj, toIframe, addParagraph ) {\n\t//        return !toIframe ?\n\t//                (addParagraph ? '<p>' : '') + '<img title=\"'+obj.title+'\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"' +\n\t//                        ' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" style=\"background:url(' + obj.logo+') no-repeat center center; border:1px solid gray;\" class=\"edui-faked-webapp\" _url=\"' + obj.url + '\" />' +\n\t//                        (addParagraph ? '</p>' : '')\n\t//                :\n\t//                '<iframe class=\"edui-faked-webapp\" title=\"'+obj.title+'\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"  scrolling=\"no\" frameborder=\"0\" src=\"' + obj.url + '\" logo_url = '+obj.logo+'></iframe>';\n\t//    }\n\t//\n\t//    function switchImgAndIframe( img2frame ) {\n\t//        var tmpdiv,\n\t//                nodes = domUtils.getElementsByTagName( me.document, !img2frame ? \"iframe\" : \"img\" );\n\t//        for ( var i = 0, node; node = nodes[i++]; ) {\n\t//            if ( node.className != \"edui-faked-webapp\" ){\n\t//                continue;\n\t//            }\n\t//            tmpdiv = me.document.createElement( \"div\" );\n\t//            tmpdiv.innerHTML = createInsertStr( img2frame ? {url:node.getAttribute( \"_url\" ), width:node.width, height:node.height,title:node.title,logo:node.style.backgroundImage.replace(\"url(\",\"\").replace(\")\",\"\")} : {url:node.getAttribute( \"src\", 2 ),title:node.title, width:node.width, height:node.height,logo:node.getAttribute(\"logo_url\")}, img2frame ? true : false,false );\n\t//            node.parentNode.replaceChild( tmpdiv.firstChild, node );\n\t//        }\n\t//    }\n\t//\n\t//    me.addListener( \"beforegetcontent\", function () {\n\t//        switchImgAndIframe( true );\n\t//    } );\n\t//    me.addListener( 'aftersetcontent', function () {\n\t//        switchImgAndIframe( false );\n\t//    } );\n\t//    me.addListener( 'aftergetcontent', function ( cmdName ) {\n\t//        if ( cmdName == 'aftergetcontent' && me.queryCommandState( 'source' ) ){\n\t//            return;\n\t//        }\n\t//        switchImgAndIframe( false );\n\t//    } );\n\t//\n\t//    me.commands['webapp'] = {\n\t//        execCommand:function ( cmd, obj ) {\n\t//            me.execCommand( \"inserthtml\", createInsertStr( obj, false,true ) );\n\t//        }\n\t//    };\n\t//};\n\n\tUE.plugin.register('webapp', function() {\n\t\tvar me = this;\n\n\t\tfunction createInsertStr(obj, toEmbed) {\n\t\t\treturn !toEmbed ?\n\t\t\t\t'<img title=\"' + obj.title + '\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"' +\n\t\t\t\t' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" _logo_url=\"' + obj.logo + '\" style=\"background:url(' + obj.logo + ') no-repeat center center; border:1px solid gray;\" class=\"edui-faked-webapp\" _url=\"' + obj.url + '\" ' +\n\t\t\t\t(obj.align && !obj.cssfloat ? 'align=\"' + obj.align + '\"' : '') +\n\t\t\t\t(obj.cssfloat ? 'style=\"float:' + obj.cssfloat + '\"' : '') +\n\t\t\t\t'/>' :\n\t\t\t\t'<iframe class=\"edui-faked-webapp\" title=\"' + obj.title + '\" ' +\n\t\t\t\t(obj.align && !obj.cssfloat ? 'align=\"' + obj.align + '\"' : '') +\n\t\t\t\t(obj.cssfloat ? 'style=\"float:' + obj.cssfloat + '\"' : '') +\n\t\t\t\t'width=\"' + obj.width + '\" height=\"' + obj.height + '\"  scrolling=\"no\" frameborder=\"0\" src=\"' + obj.url + '\" logo_url = \"' + obj.logo + '\"></iframe>'\n\n\t\t}\n\t\treturn {\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(node) {\n\t\t\t\t\tvar html;\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-webapp') {\n\t\t\t\t\t\thtml = createInsertStr({\n\t\t\t\t\t\t\ttitle: node.getAttr('title'),\n\t\t\t\t\t\t\t'width': node.getAttr('width'),\n\t\t\t\t\t\t\t'height': node.getAttr('height'),\n\t\t\t\t\t\t\t'align': node.getAttr('align'),\n\t\t\t\t\t\t\t'cssfloat': node.getStyle('float'),\n\t\t\t\t\t\t\t'url': node.getAttr(\"_url\"),\n\t\t\t\t\t\t\t'logo': node.getAttr('_logo_url')\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tvar embed = UE.uNode.createElement(html);\n\t\t\t\t\t\tnode.parentNode.replaceChild(embed, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('iframe'), function(node) {\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-webapp') {\n\t\t\t\t\t\tvar img = UE.uNode.createElement(createInsertStr({\n\t\t\t\t\t\t\ttitle: node.getAttr('title'),\n\t\t\t\t\t\t\t'width': node.getAttr('width'),\n\t\t\t\t\t\t\t'height': node.getAttr('height'),\n\t\t\t\t\t\t\t'align': node.getAttr('align'),\n\t\t\t\t\t\t\t'cssfloat': node.getStyle('float'),\n\t\t\t\t\t\t\t'url': node.getAttr(\"src\"),\n\t\t\t\t\t\t\t'logo': node.getAttr('logo_url')\n\t\t\t\t\t\t}));\n\t\t\t\t\t\tnode.parentNode.replaceChild(img, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 插入百度应用\n\t\t\t\t * @command webapp\n\t\t\t\t * @method execCommand\n\t\t\t\t * @remind 需要百度APPKey\n\t\t\t\t * @remind 百度应用主页： <a href=\"http://app.baidu.com/\" target=\"_blank\">http://app.baidu.com/</a>\n\t\t\t\t * @param { Object } appOptions 应用所需的参数项， 支持的key有： title=>应用标题， width=>应用容器宽度，\n\t\t\t\t * height=>应用容器高度，logo=>应用logo，url=>应用地址\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //editor是编辑器实例\n\t\t\t\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t\t\t\t * editor.execCommand( 'webapp' , {\n\t\t\t\t *     title: '植物大战僵尸',\n\t\t\t\t *     width: 560,\n\t\t\t\t *     height: 465,\n\t\t\t\t *     logo: '应用展示的图片',\n\t\t\t\t *     url: '百度应用的地址'\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'webapp': {\n\t\t\t\t\texecCommand: function(cmd, obj) {\n\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tstr = createInsertStr(utils.extend(obj, {\n\t\t\t\t\t\t\t\talign: 'none'\n\t\t\t\t\t\t\t}), false);\n\t\t\t\t\t\tme.execCommand(\"inserthtml\", str);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\timg = me.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-webapp\");\n\t\t\t\t\t\treturn flag ? 1 : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/template.js\n\t///import core\n\t///import plugins\\inserthtml.js\n\t///import plugins\\cleardoc.js\n\t///commands 模板\n\t///commandsName  template\n\t///commandsTitle  模板\n\t///commandsDialog  dialogs\\template\n\tUE.plugins['template'] = function() {\n\t\tUE.commands['template'] = {\n\t\t\texecCommand: function(cmd, obj) {\n\t\t\t\tobj.html && this.execCommand(\"inserthtml\", obj.html);\n\t\t\t}\n\t\t};\n\t\tthis.addListener(\"click\", function(type, evt) {\n\t\t\tvar el = evt.target || evt.srcElement,\n\t\t\t\trange = this.selection.getRange();\n\t\t\tvar tnode = domUtils.findParent(el, function(node) {\n\t\t\t\tif (node.className && domUtils.hasClass(node, \"ue_t\")) {\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\t\t\t}, true);\n\t\t\ttnode && range.selectNode(tnode).shrinkBoundary().select();\n\t\t});\n\t\tthis.addListener(\"keydown\", function(type, evt) {\n\t\t\tvar range = this.selection.getRange();\n\t\t\tif (!range.collapsed) {\n\t\t\t\tif (!evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\t\tvar tnode = domUtils.findParent(range.startContainer, function(node) {\n\t\t\t\t\t\tif (node.className && domUtils.hasClass(node, \"ue_t\")) {\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, true);\n\t\t\t\t\tif (tnode) {\n\t\t\t\t\t\tdomUtils.removeClasses(tnode, [\"ue_t\"]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/music.js\n\t/**\n\t * 插入音乐命令\n\t * @file\n\t */\n\tUE.plugin.register('music', function() {\n\t\tvar me = this;\n\n\t\tfunction creatInsertStr(url, width, height, align, cssfloat, toEmbed) {\n\t\t\treturn !toEmbed ?\n\t\t\t\t'<img ' +\n\t\t\t\t(align && !cssfloat ? 'align=\"' + align + '\"' : '') +\n\t\t\t\t(cssfloat ? 'style=\"float:' + cssfloat + '\"' : '') +\n\t\t\t\t' width=\"' + width + '\" height=\"' + height + '\" _url=\"' + url + '\" class=\"edui-faked-music\"' +\n\t\t\t\t' src=\"' + me.options.langPath + me.options.lang + '/images/music.png\" />' :\n\t\t\t\t'<embed type=\"application/x-shockwave-flash\" class=\"edui-faked-music\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"' +\n\t\t\t\t' src=\"' + url + '\" width=\"' + width + '\" height=\"' + height + '\" ' + (align && !cssfloat ? 'align=\"' + align + '\"' : '') +\n\t\t\t\t(cssfloat ? 'style=\"float:' + cssfloat + '\"' : '') +\n\t\t\t\t' wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" allowscriptaccess=\"never\" allowfullscreen=\"true\" >';\n\t\t}\n\t\treturn {\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(node) {\n\t\t\t\t\tvar html;\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-music') {\n\t\t\t\t\t\tvar cssfloat = node.getStyle('float');\n\t\t\t\t\t\tvar align = node.getAttr('align');\n\t\t\t\t\t\thtml = creatInsertStr(node.getAttr(\"_url\"), node.getAttr('width'), node.getAttr('height'), align, cssfloat, true);\n\t\t\t\t\t\tvar embed = UE.uNode.createElement(html);\n\t\t\t\t\t\tnode.parentNode.replaceChild(embed, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('embed'), function(node) {\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-music') {\n\t\t\t\t\t\tvar cssfloat = node.getStyle('float');\n\t\t\t\t\t\tvar align = node.getAttr('align');\n\t\t\t\t\t\thtml = creatInsertStr(node.getAttr(\"src\"), node.getAttr('width'), node.getAttr('height'), align, cssfloat, false);\n\t\t\t\t\t\tvar img = UE.uNode.createElement(html);\n\t\t\t\t\t\tnode.parentNode.replaceChild(img, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 插入音乐\n\t\t\t\t * @command music\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { Object } musicOptions 插入音乐的参数项， 支持的key有： url=>音乐地址；\n\t\t\t\t * width=>音乐容器宽度；height=>音乐容器高度；align=>音乐文件的对齐方式， 可选值有: left, center, right, none\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //editor是编辑器实例\n\t\t\t\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t\t\t\t * editor.execCommand( 'music' , {\n\t\t\t\t *     width: 400,\n\t\t\t\t *     height: 95,\n\t\t\t\t *     align: \"center\",\n\t\t\t\t *     url: \"音乐地址\"\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'music': {\n\t\t\t\t\texecCommand: function(cmd, musicObj) {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tstr = creatInsertStr(musicObj.url, musicObj.width || 400, musicObj.height || 95, \"none\", false);\n\t\t\t\t\t\tme.execCommand(\"inserthtml\", str);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\timg = me.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-music\");\n\t\t\t\t\t\treturn flag ? 1 : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/autoupload.js\n\t/**\n\t * @description\n\t * 1.拖放文件到编辑区域，自动上传并插入到选区\n\t * 2.插入粘贴板的图片，自动上传并插入到选区\n\t * @author Jinqn\n\t * @date 2013-10-14\n\t */\n\tUE.plugin.register('autoupload', function() {\n\n\t\tfunction sendAndInsertFile(file, editor) {\n\t\t\tvar me = editor;\n\t\t\t//模拟数据\n\t\t\tvar fieldName, urlPrefix, maxSize, allowFiles, actionUrl,\n\t\t\t\tloadingHtml, errorHandler, successHandler,\n\t\t\t\tfiletype = /image\\/\\w+/i.test(file.type) ? 'image' : 'file',\n\t\t\t\tloadingId = 'loading_' + (+new Date()).toString(36);\n\n\t\t\tfieldName = me.getOpt(filetype + 'FieldName');\n\t\t\turlPrefix = me.getOpt(filetype + 'UrlPrefix');\n\t\t\tmaxSize = me.getOpt(filetype + 'MaxSize');\n\t\t\tallowFiles = me.getOpt(filetype + 'AllowFiles');\n\t\t\tactionUrl = me.getActionUrl(me.getOpt(filetype + 'ActionName'));\n\t\t\terrorHandler = function(title) {\n\t\t\t\tvar loader = me.document.getElementById(loadingId);\n\t\t\t\tloader && domUtils.remove(loader);\n\t\t\t\tme.fireEvent('showmessage', {\n\t\t\t\t\t'id': loadingId,\n\t\t\t\t\t'content': title,\n\t\t\t\t\t'type': 'error',\n\t\t\t\t\t'timeout': 4000\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tif (filetype == 'image') {\n\t\t\t\tloadingHtml = '<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' +\n\t\t\t\t\tme.options.themePath + me.options.theme +\n\t\t\t\t\t'/images/spacer.gif\" title=\"' + (me.getLang('autoupload.loading') || '') + '\" >';\n\t\t\t\tsuccessHandler = function(data) {\n\t\t\t\t\tvar link = urlPrefix + data.url,\n\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\t\t\t\t\tif (loader) {\n\t\t\t\t\t\tloader.setAttribute('src', link);\n\t\t\t\t\t\tloader.setAttribute('_src', link);\n\t\t\t\t\t\tloader.setAttribute('title', data.title || '');\n\t\t\t\t\t\tloader.setAttribute('alt', data.original || '');\n\t\t\t\t\t\tloader.removeAttribute('id');\n\t\t\t\t\t\tdomUtils.removeClasses(loader, 'loadingclass');\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tloadingHtml = '<p>' +\n\t\t\t\t\t'<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' +\n\t\t\t\t\tme.options.themePath + me.options.theme +\n\t\t\t\t\t'/images/spacer.gif\" title=\"' + (me.getLang('autoupload.loading') || '') + '\" >' +\n\t\t\t\t\t'</p>';\n\t\t\t\tsuccessHandler = function(data) {\n\t\t\t\t\tvar link = urlPrefix + data.url,\n\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark();\n\t\t\t\t\trng.selectNode(loader).select();\n\t\t\t\t\tme.execCommand('insertfile', {\n\t\t\t\t\t\t'url': link\n\t\t\t\t\t});\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t/* 插入loading的占位符 */\n\t\t\tme.execCommand('inserthtml', loadingHtml);\n\n\t\t\t/* 判断后端配置是否没有加载成功 */\n\t\t\tif (!me.getOpt(filetype + 'ActionName')) {\n\t\t\t\terrorHandler(me.getLang('autoupload.errorLoadConfig'));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/* 判断文件大小是否超出限制 */\n\t\t\tif (file.size > maxSize) {\n\t\t\t\terrorHandler(me.getLang('autoupload.exceedSizeError'));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/* 判断文件格式是否超出允许 */\n\t\t\tvar fileext = file.name ? file.name.substr(file.name.lastIndexOf('.')) : '';\n\t\t\tif ((fileext && filetype != 'image') || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {\n\t\t\t\terrorHandler(me.getLang('autoupload.exceedTypeError'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/* 创建Ajax并提交 */\n\t\t\tvar xhr = new XMLHttpRequest(),\n\t\t\t\tfd = new FormData(),\n\t\t\t\tparams = utils.serializeParam(me.queryCommandValue('serverparam')) || '',\n\t\t\t\turl = utils.formatUrl(actionUrl + (actionUrl.indexOf('?') == -1 ? '?' : '&') + params);\n\n\t\t\tfd.append(fieldName, file, file.name || ('blob.' + file.type.substr('image/'.length)));\n\t\t\tfd.append('type', 'ajax');\n\t\t\txhr.open(\"post\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.addEventListener('load', function(e) {\n\t\t\t\ttry {\n\t\t\t\t\tvar json = (new Function(\"return \" + utils.trim(e.target.response)))();\n\t\t\t\t\tif (json.state == 'SUCCESS' && json.url) {\n\t\t\t\t\t\tsuccessHandler(json);\n\t\t\t\t\t} else {\n\t\t\t\t\t\terrorHandler(json.state);\n\t\t\t\t\t}\n\t\t\t\t} catch (er) {\n\t\t\t\t\terrorHandler(me.getLang('autoupload.loadError'));\n\t\t\t\t}\n\t\t\t});\n\t\t\txhr.send(fd);\n\t\t}\n\n\t\tfunction getPasteImage(e) {\n\t\t\tconsole.log(e.clipboardData)\n\t\t\tconsole.log( e.clipboardData.items)\n\t\t\tconsole.log(e.clipboardData.items[0])\n\t\t\tconsole.log(e.clipboardData.items[0].type)\n\t\t\t//return e.clipboardData && e.clipboardData.items && e.clipboardData.items.length == 1 && /^image\\//.test(e.clipboardData.items[0].type) ? e.clipboardData.items : null;\n\t\t}\n\n\t\tfunction getDropImage(e) {\n\t\t\treturn e.dataTransfer && e.dataTransfer.files ? e.dataTransfer.files : null;\n\t\t}\n\n\t\treturn {\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(n) {\n\t\t\t\t\tif (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tutils.each(root.getNodesByTagName('p'), function(n) {\n\t\t\t\t\tif (/\\bloadpara\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tbindEvents: {\n\t\t\t\t//插入粘贴板的图片，拖放插入图片\n\t\t\t\t'ready': function(e) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (window.FormData && window.FileReader) {\n\t\t\t\t\t\tdomUtils.on(me.body, 'paste drop', function(e) {\n\t\t\t\t\t\t\tvar hasImg = false,\n\t\t\t\t\t\t\t\titems;\n\t\t\t\t\t\t\t//获取粘贴板文件列表或者拖放文件列表\n\t\t\t\t\t\t\titems = e.type == 'paste' ? getPasteImage(e) : getDropImage(e);\n\t\t\t\t\t\t\tif (items) {\n\t\t\t\t\t\t\t\tconsole.log(items,items.length);\n\t\t\t\t\t\t\t\tvar len = items.length,\n\t\t\t\t\t\t\t\t\tfile;\n\t\t\t\t\t\t\t\t\tconsole.log(len,24329)\n\t\t\t\t\t\t\t\twhile (len--) {\n\t\t\t\t\t\t\t\t\tfile = items[len];\n\t\t\t\t\t\t\t\t\tif (file.getAsFile) file = file.getAsFile();\n\t\t\t\t\t\t\t\t\tif (file && file.size > 0) {\n\t\t\t\t\t\t\t\t\t\tsendAndInsertFile(file, me);\n\t\t\t\t\t\t\t\t\t\thasImg = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thasImg && e.preventDefault();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//取消拖放图片时出现的文字光标位置提示\n\t\t\t\t\t\tdomUtils.on(me.body, 'dragover', function(e) {\n\t\t\t\t\t\t\tif (e.dataTransfer.types[0] == 'Files') {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t//设置loading的样式\n\t\t\t\t\t\tutils.cssRule('loading',\n\t\t\t\t\t\t\t'.loadingclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loading.gif\\') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\\n' +\n\t\t\t\t\t\t\t'.loaderrorclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loaderror.png\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +\n\t\t\t\t\t\t\t'}',\n\t\t\t\t\t\t\tthis.document);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/autosave.js\n\tUE.plugin.register('autosave', function() {\n\n\t\tvar me = this,\n\t\t\t//无限循环保护\n\t\t\tlastSaveTime = new Date(),\n\t\t\t//最小保存间隔时间\n\t\t\tMIN_TIME = 20,\n\t\t\t//auto save key\n\t\t\tsaveKey = null;\n\n\t\tif (!me.getOpt('enableAutoSave')) {\n\t\t\treturn;\n\t\t}\n\n\t\tfunction save(editor) {\n\n\t\t\tvar saveData;\n\n\t\t\tif (new Date() - lastSaveTime < MIN_TIME) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!editor.hasContents()) {\n\t\t\t\t//这里不能调用命令来删除， 会造成事件死循环\n\t\t\t\tsaveKey && me.removePreferences(saveKey);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlastSaveTime = new Date();\n\n\t\t\teditor._saveFlag = null;\n\n\t\t\tsaveData = me.body.innerHTML;\n\n\t\t\tif (editor.fireEvent(\"beforeautosave\", {\n\t\t\t\t\tcontent: saveData\n\t\t\t\t}) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tme.setPreferences(saveKey, saveData);\n\n\t\t\teditor.fireEvent(\"afterautosave\", {\n\t\t\t\tcontent: saveData\n\t\t\t});\n\n\t\t}\n\n\t\treturn {\n\t\t\tdefaultOptions: {\n\t\t\t\t//默认间隔时间\n\t\t\t\tsaveInterval: 500\n\t\t\t},\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\n\t\t\t\t\tvar _suffix = \"-drafts-data\",\n\t\t\t\t\t\tkey = null;\n\n\t\t\t\t\tif (me.key) {\n\t\t\t\t\t\tkey = me.key + _suffix;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = (me.container.parentNode.id || 'ue-common') + _suffix;\n\t\t\t\t\t}\n\n\t\t\t\t\t//页面地址+编辑器ID 保持唯一\n\t\t\t\t\tsaveKey = (location.protocol + location.host + location.pathname).replace(/[.:\\/]/g, '_') + key;\n\n\t\t\t\t},\n\n\t\t\t\t'contentchange': function() {\n\n\t\t\t\t\tif (!saveKey) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (me._saveFlag) {\n\t\t\t\t\t\twindow.clearTimeout(me._saveFlag);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (me.options.saveInterval > 0) {\n\n\t\t\t\t\t\tme._saveFlag = window.setTimeout(function() {\n\n\t\t\t\t\t\t\tsave(me);\n\n\t\t\t\t\t\t}, me.options.saveInterval);\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tsave(me);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'clearlocaldata': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\tif (saveKey && me.getPreferences(saveKey)) {\n\t\t\t\t\t\t\tme.removePreferences(saveKey)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\tignoreContentChange: true\n\t\t\t\t},\n\n\t\t\t\t'getlocaldata': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\treturn saveKey ? me.getPreferences(saveKey) || '' : '';\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\tignoreContentChange: true\n\t\t\t\t},\n\n\t\t\t\t'drafts': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\tif (saveKey) {\n\t\t\t\t\t\t\tme.body.innerHTML = me.getPreferences(saveKey) || '<p>' + domUtils.fillHtml + '</p>';\n\t\t\t\t\t\t\tme.focus(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn saveKey ? (me.getPreferences(saveKey) === null ? -1 : 0) : -1;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\tignoreContentChange: true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t});\n\n\t// plugins/charts.js\n\tUE.plugin.register('charts', function() {\n\n\t\tvar me = this;\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'chartserror': function() {}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'charts': {\n\t\t\t\t\texecCommand: function(cmd, data) {\n\n\t\t\t\t\t\tvar tableNode = domUtils.findParentByTagName(this.selection.getRange().startContainer, 'table', true),\n\t\t\t\t\t\t\tflagText = [],\n\t\t\t\t\t\t\tconfig = {};\n\n\t\t\t\t\t\tif (!tableNode) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!validData(tableNode)) {\n\t\t\t\t\t\t\tme.fireEvent(\"chartserror\");\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconfig.title = data.title || '';\n\t\t\t\t\t\tconfig.subTitle = data.subTitle || '';\n\t\t\t\t\t\tconfig.xTitle = data.xTitle || '';\n\t\t\t\t\t\tconfig.yTitle = data.yTitle || '';\n\t\t\t\t\t\tconfig.suffix = data.suffix || '';\n\t\t\t\t\t\tconfig.tip = data.tip || '';\n\t\t\t\t\t\t//数据对齐方式\n\t\t\t\t\t\tconfig.dataFormat = data.tableDataFormat || '';\n\t\t\t\t\t\t//图表类型\n\t\t\t\t\t\tconfig.chartType = data.chartType || 0;\n\n\t\t\t\t\t\tfor (var key in config) {\n\n\t\t\t\t\t\t\tif (!config.hasOwnProperty(key)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tflagText.push(key + \":\" + config[key]);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttableNode.setAttribute(\"data-chart\", flagText.join(\";\"));\n\t\t\t\t\t\tdomUtils.addClass(tableNode, \"edui-charts-table\");\n\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function(cmd, name) {\n\n\t\t\t\t\t\tvar tableNode = domUtils.findParentByTagName(this.selection.getRange().startContainer, 'table', true);\n\t\t\t\t\t\treturn tableNode && validData(tableNode) ? 0 : -1;\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('table'), function(tableNode) {\n\n\t\t\t\t\tif (tableNode.getAttr(\"data-chart\") !== undefined) {\n\t\t\t\t\t\ttableNode.setAttr(\"style\");\n\t\t\t\t\t}\n\n\t\t\t\t})\n\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('table'), function(tableNode) {\n\n\t\t\t\t\tif (tableNode.getAttr(\"data-chart\") !== undefined) {\n\t\t\t\t\t\ttableNode.setAttr(\"style\", \"display: none;\");\n\t\t\t\t\t}\n\n\t\t\t\t})\n\n\t\t\t}\n\t\t}\n\n\t\tfunction validData(table) {\n\n\t\t\tvar firstRows = null,\n\t\t\t\tcellCount = 0;\n\n\t\t\t//行数不够\n\t\t\tif (table.rows.length < 2) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//列数不够\n\t\t\tif (table.rows[0].cells.length < 2) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//第一行所有cell必须是th\n\t\t\tfirstRows = table.rows[0].cells;\n\t\t\tcellCount = firstRows.length;\n\n\t\t\tfor (var i = 0, cell; cell = firstRows[i]; i++) {\n\n\t\t\t\tif (cell.tagName.toLowerCase() !== 'th') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor (var i = 1, row; row = table.rows[i]; i++) {\n\n\t\t\t\t//每行单元格数不匹配， 返回false\n\t\t\t\tif (row.cells.length != cellCount) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t//第一列不是th也返回false\n\t\t\t\tif (row.cells[0].tagName.toLowerCase() !== 'th') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tfor (var j = 1, cell; cell = row.cells[j]; j++) {\n\n\t\t\t\t\tvar value = utils.trim((cell.innerText || cell.textContent || ''));\n\n\t\t\t\t\tvalue = value.replace(new RegExp(UE.dom.domUtils.fillChar, 'g'), '').replace(/^\\s+|\\s+$/g, '');\n\n\t\t\t\t\t//必须是数字\n\t\t\t\t\tif (!/^\\d*\\.?\\d+$/.test(value)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t});\n\n\t// plugins/section.js\n\t/**\n\t * 目录大纲支持插件\n\t * @file\n\t * @since 1.3.0\n\t */\n\tUE.plugin.register('section', function() {\n\t\t/* 目录节点对象 */\n\t\tfunction Section(option) {\n\t\t\tthis.tag = '';\n\t\t\tthis.level = -1,\n\t\t\t\tthis.dom = null;\n\t\t\tthis.nextSection = null;\n\t\t\tthis.previousSection = null;\n\t\t\tthis.parentSection = null;\n\t\t\tthis.startAddress = [];\n\t\t\tthis.endAddress = [];\n\t\t\tthis.children = [];\n\t\t}\n\n\t\tfunction getSection(option) {\n\t\t\tvar section = new Section();\n\t\t\treturn utils.extend(section, option);\n\t\t}\n\n\t\tfunction getNodeFromAddress(startAddress, root) {\n\t\t\tvar current = root;\n\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\tif (!current.childNodes) return null;\n\t\t\t\tcurrent = current.childNodes[startAddress[i]];\n\t\t\t}\n\t\t\treturn current;\n\t\t}\n\n\t\tvar me = this;\n\n\t\treturn {\n\t\t\tbindMultiEvents: {\n\t\t\t\ttype: 'aftersetcontent afterscencerestore',\n\t\t\t\thandler: function() {\n\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbindEvents: {\n\t\t\t\t/* 初始化、拖拽、粘贴、执行setcontent之后 */\n\t\t\t\t'ready': function() {\n\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\tdomUtils.on(me.body, 'drop paste', function() {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t/* 执行paragraph命令之后 */\n\t\t\t\t'afterexeccommand': function(type, cmd) {\n\t\t\t\t\tif (cmd == 'paragraph') {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/* 部分键盘操作，触发updateSections事件 */\n\t\t\t\t'keyup': function(type, e) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (range.collapsed != true) {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar keyCode = e.keyCode || e.which;\n\t\t\t\t\t\tif (keyCode == 13 || keyCode == 8 || keyCode == 46) {\n\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'getsections': {\n\t\t\t\t\texecCommand: function(cmd, levels) {\n\t\t\t\t\t\tvar levelFn = levels || ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\n\t\t\t\t\t\tfor (var i = 0; i < levelFn.length; i++) {\n\t\t\t\t\t\t\tif (typeof levelFn[i] == 'string') {\n\t\t\t\t\t\t\t\tlevelFn[i] = function(fn) {\n\t\t\t\t\t\t\t\t\treturn function(node) {\n\t\t\t\t\t\t\t\t\t\treturn node.tagName == fn.toUpperCase()\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}(levelFn[i]);\n\t\t\t\t\t\t\t} else if (typeof levelFn[i] != 'function') {\n\t\t\t\t\t\t\t\tlevelFn[i] = function(node) {\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfunction getSectionLevel(node) {\n\t\t\t\t\t\t\tfor (var i = 0; i < levelFn.length; i++) {\n\t\t\t\t\t\t\t\tif (levelFn[i](node)) return i;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tDirectory = getSection({\n\t\t\t\t\t\t\t\t'level': -1,\n\t\t\t\t\t\t\t\t'title': 'root'\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tprevious = Directory;\n\n\t\t\t\t\t\tfunction traversal(node, Directory) {\n\t\t\t\t\t\t\tvar level,\n\t\t\t\t\t\t\t\ttmpSection = null,\n\t\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\t\tchild,\n\t\t\t\t\t\t\t\tchildren = node.childNodes;\n\t\t\t\t\t\t\tfor (var i = 0, len = children.length; i < len; i++) {\n\t\t\t\t\t\t\t\tchild = children[i];\n\t\t\t\t\t\t\t\tlevel = getSectionLevel(child);\n\t\t\t\t\t\t\t\tif (level >= 0) {\n\t\t\t\t\t\t\t\t\tvar address = me.selection.getRange().selectNode(child).createAddress(true).startAddress,\n\t\t\t\t\t\t\t\t\t\tcurrent = getSection({\n\t\t\t\t\t\t\t\t\t\t\t'tag': child.tagName,\n\t\t\t\t\t\t\t\t\t\t\t'title': child.innerText || child.textContent || '',\n\t\t\t\t\t\t\t\t\t\t\t'level': level,\n\t\t\t\t\t\t\t\t\t\t\t'dom': child,\n\t\t\t\t\t\t\t\t\t\t\t'startAddress': utils.clone(address, []),\n\t\t\t\t\t\t\t\t\t\t\t'endAddress': utils.clone(address, []),\n\t\t\t\t\t\t\t\t\t\t\t'children': []\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tprevious.nextSection = current;\n\t\t\t\t\t\t\t\t\tcurrent.previousSection = previous;\n\t\t\t\t\t\t\t\t\tparent = previous;\n\t\t\t\t\t\t\t\t\twhile (level <= parent.level) {\n\t\t\t\t\t\t\t\t\t\tparent = parent.parentSection;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcurrent.parentSection = parent;\n\t\t\t\t\t\t\t\t\tparent.children.push(current);\n\t\t\t\t\t\t\t\t\ttmpSection = previous = current;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchild.nodeType === 1 && traversal(child, Directory);\n\t\t\t\t\t\t\t\t\ttmpSection && tmpSection.endAddress[tmpSection.endAddress.length - 1]++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttraversal(me.body, Directory);\n\t\t\t\t\t\treturn Directory;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t},\n\t\t\t\t'movesection': {\n\t\t\t\t\texecCommand: function(cmd, sourceSection, targetSection, isAfter) {\n\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\ttargetAddress,\n\t\t\t\t\t\t\ttarget;\n\n\t\t\t\t\t\tif (!sourceSection || !targetSection || targetSection.level == -1) return;\n\n\t\t\t\t\t\ttargetAddress = isAfter ? targetSection.endAddress : targetSection.startAddress;\n\t\t\t\t\t\ttarget = getNodeFromAddress(targetAddress, me.body);\n\n\t\t\t\t\t\t/* 判断目标地址是否被源章节包含 */\n\t\t\t\t\t\tif (!targetAddress || !target || isContainsAddress(sourceSection.startAddress, sourceSection.endAddress, targetAddress)) return;\n\n\t\t\t\t\t\tvar startNode = getNodeFromAddress(sourceSection.startAddress, me.body),\n\t\t\t\t\t\t\tendNode = getNodeFromAddress(sourceSection.endAddress, me.body),\n\t\t\t\t\t\t\tcurrent,\n\t\t\t\t\t\t\tnextNode;\n\n\t\t\t\t\t\tif (isAfter) {\n\t\t\t\t\t\t\tcurrent = endNode;\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(startNode, current) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tnextNode = current.previousSibling;\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(target, current);\n\t\t\t\t\t\t\t\tif (current == startNode) break;\n\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = startNode;\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, endNode) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tnextNode = current.nextSibling;\n\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(current, target);\n\t\t\t\t\t\t\t\tif (current == endNode) break;\n\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\n\t\t\t\t\t\t/* 获取地址的包含关系 */\n\t\t\t\t\t\tfunction isContainsAddress(startAddress, endAddress, addressTarget) {\n\t\t\t\t\t\t\tvar isAfterStartAddress = false,\n\t\t\t\t\t\t\t\tisBeforeEndAddress = false;\n\t\t\t\t\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\t\t\t\t\tif (i >= addressTarget.length) break;\n\t\t\t\t\t\t\t\tif (addressTarget[i] > startAddress[i]) {\n\t\t\t\t\t\t\t\t\tisAfterStartAddress = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else if (addressTarget[i] < startAddress[i]) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0; i < endAddress.length; i++) {\n\t\t\t\t\t\t\t\tif (i >= addressTarget.length) break;\n\t\t\t\t\t\t\t\tif (addressTarget[i] < startAddress[i]) {\n\t\t\t\t\t\t\t\t\tisBeforeEndAddress = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else if (addressTarget[i] > startAddress[i]) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn isAfterStartAddress && isBeforeEndAddress;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'deletesection': {\n\t\t\t\t\texecCommand: function(cmd, section, keepChildren) {\n\t\t\t\t\t\tvar me = this;\n\n\t\t\t\t\t\tif (!section) return;\n\n\t\t\t\t\t\tfunction getNodeFromAddress(startAddress) {\n\t\t\t\t\t\t\tvar current = me.body;\n\t\t\t\t\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\t\t\t\t\tif (!current.childNodes) return null;\n\t\t\t\t\t\t\t\tcurrent = current.childNodes[startAddress[i]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn current;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar startNode = getNodeFromAddress(section.startAddress),\n\t\t\t\t\t\t\tendNode = getNodeFromAddress(section.endAddress),\n\t\t\t\t\t\t\tcurrent = startNode,\n\t\t\t\t\t\t\tnextNode;\n\n\t\t\t\t\t\tif (!keepChildren) {\n\t\t\t\t\t\t\twhile (current && domUtils.inDoc(endNode, me.document) && !(domUtils.getPosition(current, endNode) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tnextNode = current.nextSibling;\n\t\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'selectsection': {\n\t\t\t\t\texecCommand: function(cmd, section) {\n\t\t\t\t\t\tif (!section && !section.dom) return false;\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\t\t\taddress = {\n\t\t\t\t\t\t\t\t'startAddress': utils.clone(section.startAddress, []),\n\t\t\t\t\t\t\t\t'endAddress': utils.clone(section.endAddress, [])\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\taddress.endAddress[address.endAddress.length - 1]++;\n\t\t\t\t\t\trange.moveToAddress(address).select().scrollToView();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t},\n\t\t\t\t'scrolltosection': {\n\t\t\t\t\texecCommand: function(cmd, section) {\n\t\t\t\t\t\tif (!section && !section.dom) return false;\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\t\t\taddress = {\n\t\t\t\t\t\t\t\t'startAddress': section.startAddress,\n\t\t\t\t\t\t\t\t'endAddress': section.endAddress\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\taddress.endAddress[address.endAddress.length - 1]++;\n\t\t\t\t\t\trange.moveToAddress(address).scrollToView();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/simpleupload.js\n\t/**\n\t * @description\n\t * 简单上传:点击按钮,直接选择文件上传\n\t * @author Jinqn\n\t * @date 2014-03-31\n\t */\n\tUE.plugin.register('simpleupload', function() {\n\t\tvar me = this,\n\t\t\tisLoaded = false,\n\t\t\tcontainerBtn;\n\n\t\tfunction initUploadBtn() {\n\t\t\tvar w = containerBtn.offsetWidth || 20,\n\t\t\t\th = containerBtn.offsetHeight || 20,\n\t\t\t\tbtnIframe = document.createElement('iframe'),\n\t\t\t\tbtnStyle = 'display:block;width:' + w + 'px;height:' + h + 'px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;';\n\n\t\t\tdomUtils.on(btnIframe, 'load', function() {\n\n\t\t\t\tvar timestrap = (+new Date()).toString(36),\n\t\t\t\t\twrapper,\n\t\t\t\t\tbtnIframeDoc,\n\t\t\t\t\tbtnIframeBody;\n\n\t\t\t\tbtnIframeDoc = (btnIframe.contentDocument || btnIframe.contentWindow.document);\n\t\t\t\tbtnIframeBody = btnIframeDoc.body;\n\t\t\t\twrapper = btnIframeDoc.createElement('div');\n\n\t\t\t\twrapper.innerHTML = '<form id=\"edui_form_' + timestrap + '\" target=\"edui_iframe_' + timestrap + '\" method=\"POST\" enctype=\"multipart/form-data\" action=\"' + me.getOpt('serverUrl') + '\" ' +\n\t\t\t\t\t'style=\"' + btnStyle + '\">' +\n\t\t\t\t\t'<input id=\"edui_input_' + timestrap + '\" type=\"file\" accept=\"image/*\" name=\"' + me.options.imageFieldName + '\" ' +\n\t\t\t\t\t'style=\"' + btnStyle + '\">' +\n\t\t\t\t\t'</form>' +\n\t\t\t\t\t'<iframe id=\"edui_iframe_' + timestrap + '\" name=\"edui_iframe_' + timestrap + '\" style=\"display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;\"></iframe>';\n\n\t\t\t\twrapper.className = 'edui-' + me.options.theme;\n\t\t\t\twrapper.id = me.ui.id + '_iframeupload';\n\t\t\t\tbtnIframeBody.style.cssText = btnStyle;\n\t\t\t\tbtnIframeBody.style.width = w + 'px';\n\t\t\t\tbtnIframeBody.style.height = h + 'px';\n\t\t\t\tbtnIframeBody.appendChild(wrapper);\n\n\t\t\t\tif (btnIframeBody.parentNode) {\n\t\t\t\t\tbtnIframeBody.parentNode.style.width = w + 'px';\n\t\t\t\t\tbtnIframeBody.parentNode.style.height = w + 'px';\n\t\t\t\t}\n\n\t\t\t\tvar form = btnIframeDoc.getElementById('edui_form_' + timestrap);\n\t\t\t\tvar input = btnIframeDoc.getElementById('edui_input_' + timestrap);\n\t\t\t\tvar iframe = btnIframeDoc.getElementById('edui_iframe_' + timestrap);\n\n\t\t\t\tdomUtils.on(input, 'change', function() {\n\t\t\t\t\tif (!input.value) return;\n\t\t\t\t\tvar loadingId = 'loading_' + (+new Date()).toString(36);\n\t\t\t\t\tvar params = utils.serializeParam(me.queryCommandValue('serverparam')) || '';\n\n\t\t\t\t\tvar imageActionUrl = me.getActionUrl(me.getOpt('imageActionName'));\n\t\t\t\t\tvar allowFiles = me.getOpt('imageAllowFiles');\n\n\t\t\t\t\tme.focus();\n\t\t\t\t\tme.execCommand('inserthtml', '<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' + me.options.themePath + me.options.theme + '/images/spacer.gif\" title=\"' + (me.getLang('simpleupload.loading') || '') + '\" >');\n\n\t\t\t\t\tfunction callback() {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar link, json, loader,\n\t\t\t\t\t\t\t\tbody = (iframe.contentDocument || iframe.contentWindow.document).body,\n\t\t\t\t\t\t\t\tresult = body.innerText || body.textContent || '';\n\t\t\t\t\t\t\tjson = (new Function(\"return \" + result))();\n\t\t\t\t\t\t\tlink = me.options.imageUrlPrefix + json.url;\n\t\t\t\t\t\t\tif (json.state == 'SUCCESS' && json.url) {\n\t\t\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\t\t\t\t\t\t\t\tloader.setAttribute('src', link);\n\t\t\t\t\t\t\t\tloader.setAttribute('_src', link);\n\t\t\t\t\t\t\t\tloader.setAttribute('title', json.title || '');\n\t\t\t\t\t\t\t\tloader.setAttribute('alt', json.original || '');\n\t\t\t\t\t\t\t\tloader.removeAttribute('id');\n\t\t\t\t\t\t\t\tdomUtils.removeClasses(loader, 'loadingclass');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowErrorLoader && showErrorLoader(json.state);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (er) {\n\t\t\t\t\t\t\tshowErrorLoader && showErrorLoader(me.getLang('simpleupload.loadError'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tform.reset();\n\t\t\t\t\t\tdomUtils.un(iframe, 'load', callback);\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction showErrorLoader(title) {\n\t\t\t\t\t\tif (loadingId) {\n\t\t\t\t\t\t\tvar loader = me.document.getElementById(loadingId);\n\t\t\t\t\t\t\tloader && domUtils.remove(loader);\n\t\t\t\t\t\t\tme.fireEvent('showmessage', {\n\t\t\t\t\t\t\t\t'id': loadingId,\n\t\t\t\t\t\t\t\t'content': title,\n\t\t\t\t\t\t\t\t'type': 'error',\n\t\t\t\t\t\t\t\t'timeout': 4000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t/* 判断后端配置是否没有加载成功 */\n\t\t\t\t\tif (!me.getOpt('imageActionName')) {\n\t\t\t\t\t\terrorHandler(me.getLang('autoupload.errorLoadConfig'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// 判断文件格式是否错误\n\t\t\t\t\tvar filename = input.value,\n\t\t\t\t\t\tfileext = filename ? filename.substr(filename.lastIndexOf('.')) : '';\n\t\t\t\t\tif (!fileext || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {\n\t\t\t\t\t\tshowErrorLoader(me.getLang('simpleupload.exceedTypeError'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdomUtils.on(iframe, 'load', callback);\n\t\t\t\t\tform.action = utils.formatUrl(imageActionUrl + (imageActionUrl.indexOf('?') == -1 ? '?' : '&') + params);\n\t\t\t\t\tform.submit();\n\t\t\t\t});\n\n\t\t\t\tvar stateTimer;\n\t\t\t\tme.addListener('selectionchange', function() {\n\t\t\t\t\tclearTimeout(stateTimer);\n\t\t\t\t\tstateTimer = setTimeout(function() {\n\t\t\t\t\t\tvar state = me.queryCommandState('simpleupload');\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tinput.disabled = 'disabled';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tinput.disabled = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 400);\n\t\t\t\t});\n\t\t\t\tisLoaded = true;\n\t\t\t});\n\n\t\t\tbtnIframe.style.cssText = btnStyle;\n\t\t\tcontainerBtn.appendChild(btnIframe);\n\t\t}\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\t\t\t\t\t//设置loading的样式\n\t\t\t\t\tutils.cssRule('loading',\n\t\t\t\t\t\t'.loadingclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loading.gif\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\\n' +\n\t\t\t\t\t\t'.loaderrorclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loaderror.png\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +\n\t\t\t\t\t\t'}',\n\t\t\t\t\t\tthis.document);\n\t\t\t\t},\n\t\t\t\t/* 初始化简单上传按钮 */\n\t\t\t\t'simpleuploadbtnready': function(type, container) {\n\t\t\t\t\tcontainerBtn = container;\n\t\t\t\t\tme.afterConfigReady(initUploadBtn);\n\t\t\t\t}\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(n) {\n\t\t\t\t\tif (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'simpleupload': {\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn isLoaded ? 0 : -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/serverparam.js\n\t/**\n\t * 服务器提交的额外参数列表设置插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugin.register('serverparam', function() {\n\n\t\tvar me = this,\n\t\t\tserverParam = {};\n\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,清除所有项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam');\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回空\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,删除指定项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { String } key 要清除的属性\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', 'name'); //删除属性name\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,使用键值添加项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { String } key 要添加的属性\n\t\t\t\t * @param { String } value 要添加属性的值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', 'name', 'hello');\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'name': 'hello'}\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,传入键值对对象添加多项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { Object } key 传入的键值对对象\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', {'name': 'hello'});\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'name': 'hello'}\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,使用自定义函数添加多项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { Function } key 自定义获取参数的函数\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', function(editor){\n\t\t\t\t *     return {'key': 'value'};\n\t\t\t\t * });\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'key': 'value'}\n\t\t\t\t * ```\n\t\t\t\t */\n\n\t\t\t\t/**\n\t\t\t\t * 获取服务器提交的额外参数列表\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method queryCommandValue\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.queryCommandValue( 'serverparam' ); //返回对象 {'key': 'value'}\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'serverparam': {\n\t\t\t\t\texecCommand: function(cmd, key, value) {\n\t\t\t\t\t\tif (key === undefined || key === null) { //不传参数,清空列表\n\t\t\t\t\t\t\tserverParam = {};\n\t\t\t\t\t\t} else if (utils.isString(key)) { //传入键值\n\t\t\t\t\t\t\tif (value === undefined || value === null) {\n\t\t\t\t\t\t\t\tdelete serverParam[key];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tserverParam[key] = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (utils.isObject(key)) { //传入对象,覆盖列表项\n\t\t\t\t\t\t\tutils.extend(serverParam, key, true);\n\t\t\t\t\t\t} else if (utils.isFunction(key)) { //传入函数,添加列表项\n\t\t\t\t\t\t\tutils.extend(serverParam, key(), true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\t\treturn serverParam || {};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/insertfile.js\n\t/**\n\t * 插入附件\n\t */\n\tUE.plugin.register('insertfile', function() {\n\n\t\tvar me = this;\n\n\t\tfunction getFileIcon(url) {\n\t\t\tvar ext = url.substr(url.lastIndexOf('.') + 1).toLowerCase(),\n\t\t\t\tmaps = {\n\t\t\t\t\t\"rar\": \"icon_rar.gif\",\n\t\t\t\t\t\"zip\": \"icon_rar.gif\",\n\t\t\t\t\t\"tar\": \"icon_rar.gif\",\n\t\t\t\t\t\"gz\": \"icon_rar.gif\",\n\t\t\t\t\t\"bz2\": \"icon_rar.gif\",\n\t\t\t\t\t\"doc\": \"icon_doc.gif\",\n\t\t\t\t\t\"docx\": \"icon_doc.gif\",\n\t\t\t\t\t\"pdf\": \"icon_pdf.gif\",\n\t\t\t\t\t\"mp3\": \"icon_mp3.gif\",\n\t\t\t\t\t\"xls\": \"icon_xls.gif\",\n\t\t\t\t\t\"chm\": \"icon_chm.gif\",\n\t\t\t\t\t\"ppt\": \"icon_ppt.gif\",\n\t\t\t\t\t\"pptx\": \"icon_ppt.gif\",\n\t\t\t\t\t\"avi\": \"icon_mv.gif\",\n\t\t\t\t\t\"rmvb\": \"icon_mv.gif\",\n\t\t\t\t\t\"wmv\": \"icon_mv.gif\",\n\t\t\t\t\t\"flv\": \"icon_mv.gif\",\n\t\t\t\t\t\"swf\": \"icon_mv.gif\",\n\t\t\t\t\t\"rm\": \"icon_mv.gif\",\n\t\t\t\t\t\"exe\": \"icon_exe.gif\",\n\t\t\t\t\t\"psd\": \"icon_psd.gif\",\n\t\t\t\t\t\"txt\": \"icon_txt.gif\",\n\t\t\t\t\t\"jpg\": \"icon_jpg.gif\",\n\t\t\t\t\t\"png\": \"icon_jpg.gif\",\n\t\t\t\t\t\"jpeg\": \"icon_jpg.gif\",\n\t\t\t\t\t\"gif\": \"icon_jpg.gif\",\n\t\t\t\t\t\"ico\": \"icon_jpg.gif\",\n\t\t\t\t\t\"bmp\": \"icon_jpg.gif\"\n\t\t\t\t};\n\t\t\treturn maps[ext] ? maps[ext] : maps['txt'];\n\t\t}\n\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t'insertfile': {\n\t\t\t\t\texecCommand: function(command, filelist) {\n\t\t\t\t\t\tfilelist = utils.isArray(filelist) ? filelist : [filelist];\n\n\t\t\t\t\t\tvar i, item, icon, title,\n\t\t\t\t\t\t\thtml = '',\n\t\t\t\t\t\t\tURL = me.getOpt('UEDITOR_HOME_URL'),\n\t\t\t\t\t\t\ticonDir = URL + (URL.substr(URL.length - 1) == '/' ? '' : '/') + 'dialogs/attachment/fileTypeImages/';\n\t\t\t\t\t\tfor (i = 0; i < filelist.length; i++) {\n\t\t\t\t\t\t\titem = filelist[i];\n\t\t\t\t\t\t\ticon = iconDir + getFileIcon(item.url);\n\t\t\t\t\t\t\ttitle = item.title || item.url.substr(item.url.lastIndexOf('/') + 1);\n\t\t\t\t\t\t\thtml += '<p style=\"line-height: 16px;\">' +\n\t\t\t\t\t\t\t\t'<img style=\"vertical-align: middle; margin-right: 2px;\" src=\"' + icon + '\" _src=\"' + icon + '\" />' +\n\t\t\t\t\t\t\t\t'<a style=\"font-size:12px; color:#0066cc;\" href=\"' + item.url + '\" title=\"' + title + '\">' + title + '</a>' +\n\t\t\t\t\t\t\t\t'</p>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.execCommand('insertHtml', html);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/xssFilter.js\n\t/**\n\t * @file xssFilter.js\n\t * @desc xss过滤器\n\t * @author robbenmu\n\t */\n\n\tUE.plugins.xssFilter = function() {\n\n\t\tvar config = UEDITOR_CONFIG;\n\t\tvar whitList = config.whitList;\n\n\t\tfunction filter(node) {\n\n\t\t\tvar tagName = node.tagName;\n\t\t\tvar attrs = node.attrs;\n\n\t\t\tif (!whitList.hasOwnProperty(tagName)) {\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tUE.utils.each(attrs, function(val, key) {\n\n\t\t\t\tif (whitList[tagName].indexOf(key) === -1) {\n\t\t\t\t\tnode.setAttr(key);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// 添加inserthtml\\paste等操作用的过滤规则\n\t\tif (whitList && config.xssFilterRules) {\n\t\t\tthis.options.filterRules = function() {\n\n\t\t\t\tvar result = {};\n\n\t\t\t\tUE.utils.each(whitList, function(val, key) {\n\t\t\t\t\tresult[key] = function(node) {\n\t\t\t\t\t\treturn filter(node);\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t}();\n\t\t}\n\n\t\tvar tagList = [];\n\n\t\tUE.utils.each(whitList, function(val, key) {\n\t\t\ttagList.push(key);\n\t\t});\n\n\t\t// 添加input过滤规则\n\t\t//\n\t\tif (whitList && config.inputXssFilter) {\n\t\t\tthis.addInputRule(function(root) {\n\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type !== 'element') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tfilter(node);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t// 添加output过滤规则\n\t\t//\n\t\tif (whitList && config.outputXssFilter) {\n\t\t\tthis.addOutputRule(function(root) {\n\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type !== 'element') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tfilter(node);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t};\n\n\t// ui/ui.js\n\tvar baidu = baidu || {};\n\tbaidu.editor = baidu.editor || {};\n\tUE.ui = baidu.editor.ui = {};\n\n\t// ui/uiutils.js\n\t(function() {\n\t\tvar browser = baidu.editor.browser,\n\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\n\t\tvar magic = '$EDITORUI';\n\t\tvar root = window[magic] = {};\n\t\tvar uidMagic = 'ID' + magic;\n\t\tvar uidCount = 0;\n\n\t\tvar uiUtils = baidu.editor.ui.uiUtils = {\n\t\t\tuid: function(obj) {\n\t\t\t\treturn (obj ? obj[uidMagic] || (obj[uidMagic] = ++uidCount) : ++uidCount);\n\t\t\t},\n\t\t\thook: function(fn, callback) {\n\t\t\t\tvar dg;\n\t\t\t\tif (fn && fn._callbacks) {\n\t\t\t\t\tdg = fn;\n\t\t\t\t} else {\n\t\t\t\t\tdg = function() {\n\t\t\t\t\t\tvar q;\n\t\t\t\t\t\tif (fn) {\n\t\t\t\t\t\t\tq = fn.apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar callbacks = dg._callbacks;\n\t\t\t\t\t\tvar k = callbacks.length;\n\t\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\t\tvar r = callbacks[k].apply(this, arguments);\n\t\t\t\t\t\t\tif (q === undefined) {\n\t\t\t\t\t\t\t\tq = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn q;\n\t\t\t\t\t};\n\t\t\t\t\tdg._callbacks = [];\n\t\t\t\t}\n\t\t\t\tdg._callbacks.push(callback);\n\t\t\t\treturn dg;\n\t\t\t},\n\t\t\tcreateElementByHtml: function(html) {\n\t\t\t\tvar el = document.createElement('div');\n\t\t\t\tel.innerHTML = html;\n\t\t\t\tel = el.firstChild;\n\t\t\t\tel.parentNode.removeChild(el);\n\t\t\t\treturn el;\n\t\t\t},\n\t\t\tgetViewportElement: function() {\n\t\t\t\treturn (browser.ie && browser.quirks) ?\n\t\t\t\t\tdocument.body : document.documentElement;\n\t\t\t},\n\t\t\tgetClientRect: function(element) {\n\t\t\t\tvar bcr;\n\t\t\t\t//trace  IE6下在控制编辑器显隐时可能会报错，catch一下\n\t\t\t\ttry {\n\t\t\t\t\tbcr = element.getBoundingClientRect();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tbcr = {\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\twidth: 0\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar rect = {\n\t\t\t\t\tleft: Math.round(bcr.left),\n\t\t\t\t\ttop: Math.round(bcr.top),\n\t\t\t\t\theight: Math.round(bcr.bottom - bcr.top),\n\t\t\t\t\twidth: Math.round(bcr.right - bcr.left)\n\t\t\t\t};\n\t\t\t\tvar doc;\n\t\t\t\twhile ((doc = element.ownerDocument) !== document &&\n\t\t\t\t\t(element = domUtils.getWindow(doc).frameElement)) {\n\t\t\t\t\tbcr = element.getBoundingClientRect();\n\t\t\t\t\trect.left += bcr.left;\n\t\t\t\t\trect.top += bcr.top;\n\t\t\t\t}\n\t\t\t\trect.bottom = rect.top + rect.height;\n\t\t\t\trect.right = rect.left + rect.width;\n\t\t\t\treturn rect;\n\t\t\t},\n\t\t\tgetViewportRect: function() {\n\t\t\t\tvar viewportEl = uiUtils.getViewportElement();\n\t\t\t\tvar width = (window.innerWidth || viewportEl.clientWidth) | 0;\n\t\t\t\tvar height = (window.innerHeight || viewportEl.clientHeight) | 0;\n\t\t\t\treturn {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width,\n\t\t\t\t\tbottom: height,\n\t\t\t\t\tright: width\n\t\t\t\t};\n\t\t\t},\n\t\t\tsetViewportOffset: function(element, offset) {\n\t\t\t\tvar rect;\n\t\t\t\tvar fixedLayer = uiUtils.getFixedLayer();\n\t\t\t\tif (element.parentNode === fixedLayer) {\n\t\t\t\t\telement.style.left = offset.left + 'px';\n\t\t\t\t\telement.style.top = offset.top + 'px';\n\t\t\t\t} else {\n\t\t\t\t\tdomUtils.setViewportOffset(element, offset);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetEventOffset: function(evt) {\n\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\tvar rect = uiUtils.getClientRect(el);\n\t\t\t\tvar offset = uiUtils.getViewportOffsetByEvent(evt);\n\t\t\t\treturn {\n\t\t\t\t\tleft: offset.left - rect.left,\n\t\t\t\t\ttop: offset.top - rect.top\n\t\t\t\t};\n\t\t\t},\n\t\t\tgetViewportOffsetByEvent: function(evt) {\n\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\tvar frameEl = domUtils.getWindow(el).frameElement;\n\t\t\t\tvar offset = {\n\t\t\t\t\tleft: evt.clientX,\n\t\t\t\t\ttop: evt.clientY\n\t\t\t\t};\n\t\t\t\tif (frameEl && el.ownerDocument !== document) {\n\t\t\t\t\tvar rect = uiUtils.getClientRect(frameEl);\n\t\t\t\t\toffset.left += rect.left;\n\t\t\t\t\toffset.top += rect.top;\n\t\t\t\t}\n\t\t\t\treturn offset;\n\t\t\t},\n\t\t\tsetGlobal: function(id, obj) {\n\t\t\t\troot[id] = obj;\n\t\t\t\treturn magic + '[\"' + id + '\"]';\n\t\t\t},\n\t\t\tunsetGlobal: function(id) {\n\t\t\t\tdelete root[id];\n\t\t\t},\n\t\t\tcopyAttributes: function(tgt, src) {\n\t\t\t\tvar attributes = src.attributes;\n\t\t\t\tvar k = attributes.length;\n\t\t\t\twhile (k--) {\n\t\t\t\t\tvar attrNode = attributes[k];\n\t\t\t\t\tif (attrNode.nodeName != 'style' && attrNode.nodeName != 'class' && (!browser.ie || attrNode.specified)) {\n\t\t\t\t\t\ttgt.setAttribute(attrNode.nodeName, attrNode.nodeValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (src.className) {\n\t\t\t\t\tdomUtils.addClass(tgt, src.className);\n\t\t\t\t}\n\t\t\t\tif (src.style.cssText) {\n\t\t\t\t\ttgt.style.cssText += ';' + src.style.cssText;\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveStyle: function(el, styleName) {\n\t\t\t\tif (el.style.removeProperty) {\n\t\t\t\t\tel.style.removeProperty(styleName);\n\t\t\t\t} else if (el.style.removeAttribute) {\n\t\t\t\t\tel.style.removeAttribute(styleName);\n\t\t\t\t} else throw '';\n\t\t\t},\n\t\t\tcontains: function(elA, elB) {\n\t\t\t\treturn elA && elB && (elA === elB ? false : (\n\t\t\t\t\telA.contains ? elA.contains(elB) :\n\t\t\t\t\telA.compareDocumentPosition(elB) & 16\n\t\t\t\t));\n\t\t\t},\n\t\t\tstartDrag: function(evt, callbacks, doc) {\n\t\t\t\tvar doc = doc || document;\n\t\t\t\tvar startX = evt.clientX;\n\t\t\t\tvar startY = evt.clientY;\n\n\t\t\t\tfunction handleMouseMove(evt) {\n\t\t\t\t\tvar x = evt.clientX - startX;\n\t\t\t\t\tvar y = evt.clientY - startY;\n\t\t\t\t\tcallbacks.ondragmove(x, y, evt);\n\t\t\t\t\tif (evt.stopPropagation) {\n\t\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevt.cancelBubble = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (doc.addEventListener) {\n\t\t\t\t\tfunction handleMouseUp(evt) {\n\t\t\t\t\t\tdoc.removeEventListener('mousemove', handleMouseMove, true);\n\t\t\t\t\t\tdoc.removeEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\t\twindow.removeEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\t\tcallbacks.ondragstop();\n\t\t\t\t\t}\n\t\t\t\t\tdoc.addEventListener('mousemove', handleMouseMove, true);\n\t\t\t\t\tdoc.addEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\twindow.addEventListener('mouseup', handleMouseUp, true);\n\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t} else {\n\t\t\t\t\tvar elm = evt.srcElement;\n\t\t\t\t\telm.setCapture();\n\n\t\t\t\t\tfunction releaseCaptrue() {\n\t\t\t\t\t\telm.releaseCapture();\n\t\t\t\t\t\telm.detachEvent('onmousemove', handleMouseMove);\n\t\t\t\t\t\telm.detachEvent('onmouseup', releaseCaptrue);\n\t\t\t\t\t\telm.detachEvent('onlosecaptrue', releaseCaptrue);\n\t\t\t\t\t\tcallbacks.ondragstop();\n\t\t\t\t\t}\n\t\t\t\t\telm.attachEvent('onmousemove', handleMouseMove);\n\t\t\t\t\telm.attachEvent('onmouseup', releaseCaptrue);\n\t\t\t\t\telm.attachEvent('onlosecaptrue', releaseCaptrue);\n\t\t\t\t\tevt.returnValue = false;\n\t\t\t\t}\n\t\t\t\tcallbacks.ondragstart();\n\t\t\t},\n\t\t\tgetFixedLayer: function() {\n\t\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\t\tif (layer == null) {\n\t\t\t\t\tlayer = document.createElement('div');\n\t\t\t\t\tlayer.id = 'edui_fixedlayer';\n\t\t\t\t\tdocument.body.appendChild(layer);\n\t\t\t\t\tif (browser.ie && browser.version <= 8) {\n\t\t\t\t\t\tlayer.style.position = 'absolute';\n\t\t\t\t\t\tbindFixedLayer();\n\t\t\t\t\t\tsetTimeout(updateFixedOffset);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlayer.style.position = 'fixed';\n\t\t\t\t\t}\n\t\t\t\t\tlayer.style.left = '0';\n\t\t\t\t\tlayer.style.top = '0';\n\t\t\t\t\tlayer.style.width = '0';\n\t\t\t\t\tlayer.style.height = '0';\n\t\t\t\t}\n\t\t\t\treturn layer;\n\t\t\t},\n\t\t\tmakeUnselectable: function(element) {\n\t\t\t\tif (browser.opera || (browser.ie && browser.version < 9)) {\n\t\t\t\t\telement.unselectable = 'on';\n\t\t\t\t\tif (element.hasChildNodes()) {\n\t\t\t\t\t\tfor (var i = 0; i < element.childNodes.length; i++) {\n\t\t\t\t\t\t\tif (element.childNodes[i].nodeType == 1) {\n\t\t\t\t\t\t\t\tuiUtils.makeUnselectable(element.childNodes[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (element.style.MozUserSelect !== undefined) {\n\t\t\t\t\t\telement.style.MozUserSelect = 'none';\n\t\t\t\t\t} else if (element.style.WebkitUserSelect !== undefined) {\n\t\t\t\t\t\telement.style.WebkitUserSelect = 'none';\n\t\t\t\t\t} else if (element.style.KhtmlUserSelect !== undefined) {\n\t\t\t\t\t\telement.style.KhtmlUserSelect = 'none';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction updateFixedOffset() {\n\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\tuiUtils.setViewportOffset(layer, {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0\n\t\t\t});\n\t\t\t//        layer.style.display = 'none';\n\t\t\t//        layer.style.display = 'block';\n\n\t\t\t//#trace: 1354\n\t\t\t//        setTimeout(updateFixedOffset);\n\t\t}\n\n\t\tfunction bindFixedLayer(adjOffset) {\n\t\t\tdomUtils.on(window, 'scroll', updateFixedOffset);\n\t\t\tdomUtils.on(window, 'resize', baidu.editor.utils.defer(updateFixedOffset, 0, true));\n\t\t}\n\t})();\n\n\t// ui/uibase.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tEventBase = baidu.editor.EventBase,\n\t\t\tUIBase = baidu.editor.ui.UIBase = function() {};\n\n\t\tUIBase.prototype = {\n\t\t\tclassName: '',\n\t\t\tuiName: '',\n\t\t\tinitOptions: function(options) {\n\t\t\t\tvar me = this;\n\t\t\t\tfor (var k in options) {\n\t\t\t\t\tme[k] = options[k];\n\t\t\t\t}\n\t\t\t\tthis.id = this.id || 'edui' + uiUtils.uid();\n\t\t\t},\n\t\t\tinitUIBase: function() {\n\t\t\t\tthis._globalKey = utils.unhtml(uiUtils.setGlobal(this.id, this));\n\t\t\t},\n\t\t\trender: function(holder) {\n\t\t\t\tvar html = this.renderHtml();\n\t\t\t\tvar el = uiUtils.createElementByHtml(html);\n\n\t\t\t\t//by xuheng 给每个node添加class\n\t\t\t\tvar list = domUtils.getElementsByTagName(el, \"*\");\n\t\t\t\tvar theme = \"edui-\" + (this.theme || this.editor.options.theme);\n\t\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\t\tfor (var i = 0, node; node = list[i++];) {\n\t\t\t\t\tdomUtils.addClass(node, theme);\n\t\t\t\t}\n\t\t\t\tdomUtils.addClass(el, theme);\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.className = \"\";\n\t\t\t\t\tdomUtils.addClass(layer, theme);\n\t\t\t\t}\n\n\t\t\t\tvar seatEl = this.getDom();\n\t\t\t\tif (seatEl != null) {\n\t\t\t\t\tseatEl.parentNode.replaceChild(el, seatEl);\n\t\t\t\t\tuiUtils.copyAttributes(el, seatEl);\n\t\t\t\t} else {\n\t\t\t\t\tif (typeof holder == 'string') {\n\t\t\t\t\t\tholder = document.getElementById(holder);\n\t\t\t\t\t}\n\t\t\t\t\tholder = holder || uiUtils.getFixedLayer();\n\t\t\t\t\tdomUtils.addClass(holder, theme);\n\t\t\t\t\tholder.appendChild(el);\n\t\t\t\t}\n\t\t\t\tthis.postRender();\n\t\t\t},\n\t\t\tgetDom: function(name) {\n\t\t\t\tif (!name) {\n\t\t\t\t\treturn document.getElementById(this.id);\n\t\t\t\t} else {\n\t\t\t\t\treturn document.getElementById(this.id + '_' + name);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tthis.fireEvent('postrender');\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tformatHtml: function(tpl) {\n\n\t\t\t\tvar prefix = 'edui-' + this.uiName;\n\t\t\t\treturn (tpl\n\t\t\t\t\t.replace(/##/g, this.id)\n\t\t\t\t\t.replace(/%%-/g, this.uiName ? prefix + '-' : '')\n\t\t\t\t\t.replace(/%%/g, (this.uiName ? prefix : '') + ' ' + this.className)\n\t\t\t\t\t.replace(/\\$\\$/g, this._globalKey));\n\t\t\t},\n\t\t\trenderHtml: function() {\n\t\t\t\treturn this.formatHtml(this.getHtmlTpl());\n\t\t\t},\n\t\t\tdispose: function() {\n\t\t\t\tvar box = this.getDom();\n\t\t\t\tif (box) baidu.editor.dom.domUtils.remove(box);\n\t\t\t\tuiUtils.unsetGlobal(this.id);\n\t\t\t}\n\t\t};\n\t\tutils.inherits(UIBase, EventBase);\n\t})();\n\n\t// ui/separator.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tSeparator = baidu.editor.ui.Separator = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initSeparator();\n\t\t\t};\n\t\tSeparator.prototype = {\n\t\t\tuiName: 'separator',\n\t\t\tinitSeparator: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\"></div>';\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Separator, UIBase);\n\n\t})();\n\n\t// ui/mask.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils;\n\n\t\tvar Mask = baidu.editor.ui.Mask = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initUIBase();\n\t\t};\n\t\tMask.prototype = {\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-mask %%\" onclick=\"return $$._onClick(event, this);\" onmousedown=\"return $$._onMouseDown(event, this);\"></div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tdomUtils.on(window, 'resize', function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tif (!me.isHidden()) {\n\t\t\t\t\t\t\tme._fill();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tshow: function(zIndex) {\n\t\t\t\tthis._fill();\n\t\t\t\tthis.getDom().style.display = '';\n\t\t\t\tthis.getDom().style.zIndex = zIndex;\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\tthis.getDom().style.zIndex = '';\n\t\t\t},\n\t\t\tisHidden: function() {\n\t\t\t\treturn this.getDom().style.display == 'none';\n\t\t\t},\n\t\t\t_onMouseDown: function() {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\t_onClick: function(e, target) {\n\t\t\t\tthis.fireEvent('click', e, target);\n\t\t\t},\n\t\t\t_fill: function() {\n\t\t\t\tvar el = this.getDom();\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\tel.style.width = vpRect.width + 'px';\n\t\t\t\tel.style.height = vpRect.height + 'px';\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Mask, UIBase);\n\t})();\n\n\t// ui/popup.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tPopup = baidu.editor.ui.Popup = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initPopup();\n\t\t\t};\n\n\t\tvar allPopups = [];\n\n\t\tfunction closeAllPopup(evt, el) {\n\t\t\tfor (var i = 0; i < allPopups.length; i++) {\n\t\t\t\tvar pop = allPopups[i];\n\t\t\t\tif (!pop.isHidden()) {\n\t\t\t\t\tif (pop.queryAutoHide(el) !== false) {\n\t\t\t\t\t\tif (evt && /scroll/ig.test(evt.type) && pop.className == \"edui-wordpastepop\") return;\n\t\t\t\t\t\tpop.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (allPopups.length)\n\t\t\t\tpop.editor.fireEvent(\"afterhidepop\");\n\t\t}\n\n\t\tPopup.postHide = closeAllPopup;\n\n\t\tvar ANCHOR_CLASSES = ['edui-anchor-topleft', 'edui-anchor-topright',\n\t\t\t'edui-anchor-bottomleft', 'edui-anchor-bottomright'\n\t\t];\n\t\tPopup.prototype = {\n\t\t\tSHADOW_RADIUS: 5,\n\t\t\tcontent: null,\n\t\t\t_hidden: false,\n\t\t\tautoRender: true,\n\t\t\tcanSideLeft: true,\n\t\t\tcanSideUp: true,\n\t\t\tinitPopup: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tallPopups.push(this);\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-popup %%\" onmousedown=\"return false;\">' +\n\t\t\t\t\t' <div id=\"##_body\" class=\"edui-popup-body\">' +\n\t\t\t\t\t' <iframe style=\"position:absolute;z-index:-1;left:0;top:0;background-color: transparent;\" frameborder=\"0\" width=\"100%\" height=\"100%\" src=\"about:blank\"></iframe>' +\n\t\t\t\t\t' <div class=\"edui-shadow\"></div>' +\n\t\t\t\t\t' <div id=\"##_content\" class=\"edui-popup-content\">' +\n\t\t\t\t\tthis.getContentHtmlTpl() +\n\t\t\t\t\t'  </div>' +\n\t\t\t\t\t' </div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tgetContentHtmlTpl: function() {\n\t\t\t\tif (this.content) {\n\t\t\t\t\tif (typeof this.content == 'string') {\n\t\t\t\t\t\treturn this.content;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.content.renderHtml();\n\t\t\t\t} else {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t_UIBase_postRender: UIBase.prototype.postRender,\n\t\t\tpostRender: function() {\n\n\t\t\t\tif (this.content instanceof UIBase) {\n\t\t\t\t\tthis.content.postRender();\n\t\t\t\t}\n\n\t\t\t\t//捕获鼠标滚轮\n\t\t\t\tif (this.captureWheel && !this.captured) {\n\n\t\t\t\t\tthis.captured = true;\n\n\t\t\t\t\tvar winHeight = (document.documentElement.clientHeight || document.body.clientHeight) - 80,\n\t\t\t\t\t\t_height = this.getDom().offsetHeight,\n\t\t\t\t\t\t_top = uiUtils.getClientRect(this.combox.getDom()).top,\n\t\t\t\t\t\tcontent = this.getDom('content'),\n\t\t\t\t\t\tifr = this.getDom('body').getElementsByTagName('iframe'),\n\t\t\t\t\t\tme = this;\n\n\t\t\t\t\tifr.length && (ifr = ifr[0]);\n\n\t\t\t\t\twhile (_top + _height > winHeight) {\n\t\t\t\t\t\t_height -= 30;\n\t\t\t\t\t}\n\t\t\t\t\tcontent.style.height = _height + 'px';\n\t\t\t\t\t//同步更改iframe高度\n\t\t\t\t\tifr && (ifr.style.height = _height + 'px');\n\n\t\t\t\t\t//阻止在combox上的鼠标滚轮事件, 防止用户的正常操作被误解\n\t\t\t\t\tif (window.XMLHttpRequest) {\n\n\t\t\t\t\t\tdomUtils.on(content, ('onmousewheel' in document.body) ? 'mousewheel' : 'DOMMouseScroll', function(e) {\n\n\t\t\t\t\t\t\tif (e.preventDefault) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\te.returnValue = false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.wheelDelta) {\n\n\t\t\t\t\t\t\t\tcontent.scrollTop -= (e.wheelDelta / 120) * 60;\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tcontent.scrollTop -= (e.detail / -3) * 60;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t//ie6\n\t\t\t\t\t\tdomUtils.on(this.getDom(), 'mousewheel', function(e) {\n\n\t\t\t\t\t\t\te.returnValue = false;\n\n\t\t\t\t\t\t\tme.getDom('content').scrollTop -= (e.wheelDelta / 120) * 60;\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tthis.fireEvent('postRenderAfter');\n\t\t\t\tthis.hide(true);\n\t\t\t\tthis._UIBase_postRender();\n\t\t\t},\n\t\t\t_doAutoRender: function() {\n\t\t\t\tif (!this.getDom() && this.autoRender) {\n\t\t\t\t\tthis.render();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmesureSize: function() {\n\t\t\t\tvar box = this.getDom('content');\n\t\t\t\treturn uiUtils.getClientRect(box);\n\t\t\t},\n\t\t\tfitSize: function() {\n\t\t\t\tif (this.captureWheel && this.sized) {\n\t\t\t\t\treturn this.__size;\n\t\t\t\t}\n\t\t\t\tthis.sized = true;\n\t\t\t\tvar popBodyEl = this.getDom('body');\n\t\t\t\tpopBodyEl.style.width = '';\n\t\t\t\tpopBodyEl.style.height = '';\n\t\t\t\tvar size = this.mesureSize();\n\t\t\t\tif (this.captureWheel) {\n\t\t\t\t\tpopBodyEl.style.width = -(-20 - size.width) + 'px';\n\t\t\t\t\tvar height = parseInt(this.getDom('content').style.height, 10);\n\t\t\t\t\t!window.isNaN(height) && (size.height = height);\n\t\t\t\t} else {\n\t\t\t\t\tpopBodyEl.style.width = size.width + 'px';\n\t\t\t\t}\n\t\t\t\tpopBodyEl.style.height = size.height + 'px';\n\t\t\t\tthis.__size = size;\n\t\t\t\tthis.captureWheel && (this.getDom('content').style.overflow = 'auto');\n\t\t\t\treturn size;\n\t\t\t},\n\t\t\tshowAnchor: function(element, hoz) {\n\t\t\t\tthis.showAnchorRect(uiUtils.getClientRect(element), hoz);\n\t\t\t},\n\t\t\tshowAnchorRect: function(rect, hoz, adj) {\n\t\t\t\tthis._doAutoRender();\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\tthis.getDom().style.visibility = 'hidden';\n\t\t\t\tthis._show();\n\t\t\t\tvar popSize = this.fitSize();\n\n\t\t\t\tvar sideLeft, sideUp, left, top;\n\t\t\t\tif (hoz) {\n\t\t\t\t\tsideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n\t\t\t\t\tsideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n\t\t\t\t\tleft = (sideLeft ? rect.left - popSize.width : rect.right);\n\t\t\t\t\ttop = (sideUp ? rect.bottom - popSize.height : rect.top);\n\t\t\t\t} else {\n\t\t\t\t\tsideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n\t\t\t\t\tsideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n\t\t\t\t\tleft = (sideLeft ? rect.right - popSize.width : rect.left);\n\t\t\t\t\ttop = (sideUp ? rect.top - popSize.height : rect.bottom);\n\t\t\t\t}\n\n\t\t\t\tvar popEl = this.getDom();\n\t\t\t\tuiUtils.setViewportOffset(popEl, {\n\t\t\t\t\tleft: left,\n\t\t\t\t\ttop: top\n\t\t\t\t});\n\t\t\t\tdomUtils.removeClasses(popEl, ANCHOR_CLASSES);\n\t\t\t\tpopEl.className += ' ' + ANCHOR_CLASSES[(sideUp ? 1 : 0) * 2 + (sideLeft ? 1 : 0)];\n\t\t\t\tif (this.editor) {\n\t\t\t\t\tpopEl.style.zIndex = this.editor.container.style.zIndex * 1 + 10;\n\t\t\t\t\tbaidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = popEl.style.zIndex - 1;\n\t\t\t\t}\n\t\t\t\tthis.getDom().style.visibility = 'visible';\n\n\t\t\t},\n\t\t\tshowAt: function(offset) {\n\t\t\t\tvar left = offset.left;\n\t\t\t\tvar top = offset.top;\n\t\t\t\tvar rect = {\n\t\t\t\t\tleft: left,\n\t\t\t\t\ttop: top,\n\t\t\t\t\tright: left,\n\t\t\t\t\tbottom: top,\n\t\t\t\t\theight: 0,\n\t\t\t\t\twidth: 0\n\t\t\t\t};\n\t\t\t\tthis.showAnchorRect(rect, false, true);\n\t\t\t},\n\t\t\t_show: function() {\n\t\t\t\tif (this._hidden) {\n\t\t\t\t\tvar box = this.getDom();\n\t\t\t\t\tbox.style.display = '';\n\t\t\t\t\tthis._hidden = false;\n\t\t\t\t\t//                if (box.setActive) {\n\t\t\t\t\t//                    box.setActive();\n\t\t\t\t\t//                }\n\t\t\t\t\tthis.fireEvent('show');\n\t\t\t\t}\n\t\t\t},\n\t\t\tisHidden: function() {\n\t\t\t\treturn this._hidden;\n\t\t\t},\n\t\t\tshow: function() {\n\t\t\t\tthis._doAutoRender();\n\t\t\t\tthis._show();\n\t\t\t},\n\t\t\thide: function(notNofity) {\n\t\t\t\tif (!this._hidden && this.getDom()) {\n\t\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\tif (!notNofity) {\n\t\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tqueryAutoHide: function(el) {\n\t\t\t\treturn !el || !uiUtils.contains(this.getDom(), el);\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Popup, UIBase);\n\n\t\tdomUtils.on(document, 'mousedown', function(evt) {\n\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\tcloseAllPopup(evt, el);\n\t\t});\n\t\tdomUtils.on(window, 'scroll', function(evt, el) {\n\t\t\tcloseAllPopup(evt, el);\n\t\t});\n\n\t})();\n\n\t// ui/colorpicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tColorPicker = baidu.editor.ui.ColorPicker = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.noColorText = this.noColorText || this.editor.getLang(\"clearColor\");\n\t\t\t\tthis.initUIBase();\n\t\t\t};\n\n\t\tColorPicker.prototype = {\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn genColorPicker(this.noColorText, this.editor);\n\t\t\t},\n\t\t\t_onTableClick: function(evt) {\n\t\t\t\tvar tgt = evt.target || evt.srcElement;\n\t\t\t\tvar color = tgt.getAttribute('data-color');\n\t\t\t\tif (color) {\n\t\t\t\t\tthis.fireEvent('pickcolor', color);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onTableOver: function(evt) {\n\t\t\t\tvar tgt = evt.target || evt.srcElement;\n\t\t\t\tvar color = tgt.getAttribute('data-color');\n\t\t\t\tif (color) {\n\t\t\t\t\tthis.getDom('preview').style.backgroundColor = color;\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onTableOut: function() {\n\t\t\t\tthis.getDom('preview').style.backgroundColor = '';\n\t\t\t},\n\t\t\t_onPickNoColor: function() {\n\t\t\t\tthis.fireEvent('picknocolor');\n\t\t\t}\n\t\t};\n\t\tutils.inherits(ColorPicker, UIBase);\n\n\t\tvar COLORS = (\n\t\t\t'ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,' +\n\t\t\t'f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,' +\n\t\t\t'd8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,' +\n\t\t\t'bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,' +\n\t\t\t'a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,' +\n\t\t\t'7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,' +\n\t\t\t'c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,').split(',');\n\n\t\tfunction genColorPicker(noColorText, editor) {\n\t\t\tvar html = '<div id=\"##\" class=\"edui-colorpicker %%\">' +\n\t\t\t\t'<div class=\"edui-colorpicker-topbar edui-clearfix\">' +\n\t\t\t\t'<div unselectable=\"on\" id=\"##_preview\" class=\"edui-colorpicker-preview\"></div>' +\n\t\t\t\t'<div unselectable=\"on\" class=\"edui-colorpicker-nocolor\" onclick=\"$$._onPickNoColor(event, this);\">' + noColorText + '</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<table  class=\"edui-box\" style=\"border-collapse: collapse;\" onmouseover=\"$$._onTableOver(event, this);\" onmouseout=\"$$._onTableOut(event, this);\" onclick=\"return $$._onTableClick(event, this);\" cellspacing=\"0\" cellpadding=\"0\">' +\n\t\t\t\t'<tr style=\"border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px\"><td colspan=\"10\">' + editor.getLang(\"themeColor\") + '</td> </tr>' +\n\t\t\t\t'<tr class=\"edui-colorpicker-tablefirstrow\" >';\n\t\t\tfor (var i = 0; i < COLORS.length; i++) {\n\t\t\t\tif (i && i % 10 === 0) {\n\t\t\t\t\thtml += '</tr>' + (i == 60 ? '<tr style=\"border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;\"><td colspan=\"10\">' + editor.getLang(\"standardColor\") + '</td></tr>' : '') + '<tr' + (i == 60 ? ' class=\"edui-colorpicker-tablefirstrow\"' : '') + '>';\n\t\t\t\t}\n\t\t\t\thtml += i < 70 ? '<td style=\"padding: 0 2px;\"><a hidefocus title=\"' + COLORS[i] + '\" onclick=\"return false;\" href=\"javascript:\" unselectable=\"on\" class=\"edui-box edui-colorpicker-colorcell\"' +\n\t\t\t\t\t' data-color=\"#' + COLORS[i] + '\"' +\n\t\t\t\t\t' style=\"background-color:#' + COLORS[i] + ';border:solid #ccc;' +\n\t\t\t\t\t(i < 10 || i >= 60 ? 'border-width:1px;' :\n\t\t\t\t\t\ti >= 10 && i < 20 ? 'border-width:1px 1px 0 1px;' :\n\n\t\t\t\t\t\t'border-width:0 1px 0 1px;') +\n\t\t\t\t\t'\"' +\n\t\t\t\t\t'></a></td>' : '';\n\t\t\t}\n\t\t\thtml += '</tr></table></div>';\n\t\t\treturn html;\n\t\t}\n\t})();\n\n\t// ui/tablepicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\tvar TablePicker = baidu.editor.ui.TablePicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initTablePicker();\n\t\t};\n\t\tTablePicker.prototype = {\n\t\t\tdefaultNumRows: 10,\n\t\t\tdefaultNumCols: 10,\n\t\t\tmaxNumRows: 20,\n\t\t\tmaxNumCols: 20,\n\t\t\tnumRows: 10,\n\t\t\tnumCols: 10,\n\t\t\tlengthOfCellSide: 22,\n\t\t\tinitTablePicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn '<div id=\"##\" class=\"edui-tablepicker %%\">' +\n\t\t\t\t\t'<div class=\"edui-tablepicker-body\">' +\n\t\t\t\t\t'<div class=\"edui-infoarea\">' +\n\t\t\t\t\t'<span id=\"##_label\" class=\"edui-label\"></span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"edui-pickarea\"' +\n\t\t\t\t\t' onmousemove=\"$$._onMouseMove(event, this);\"' +\n\t\t\t\t\t' onmouseover=\"$$._onMouseOver(event, this);\"' +\n\t\t\t\t\t' onmouseout=\"$$._onMouseOut(event, this);\"' +\n\t\t\t\t\t' onclick=\"$$._onClick(event, this);\"' +\n\t\t\t\t\t'>' +\n\t\t\t\t\t'<div id=\"##_overlay\" class=\"edui-overlay\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render,\n\t\t\trender: function(holder) {\n\t\t\t\tthis._UIBase_render(holder);\n\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_row\") + ' x 0' + this.editor.getLang(\"t_col\");\n\t\t\t},\n\t\t\t_track: function(numCols, numRows) {\n\t\t\t\tvar style = this.getDom('overlay').style;\n\t\t\t\tvar sideLen = this.lengthOfCellSide;\n\t\t\t\tstyle.width = numCols * sideLen + 'px';\n\t\t\t\tstyle.height = numRows * sideLen + 'px';\n\t\t\t\tvar label = this.getDom('label');\n\t\t\t\tlabel.innerHTML = numCols + this.editor.getLang(\"t_col\") + ' x ' + numRows + this.editor.getLang(\"t_row\");\n\t\t\t\tthis.numCols = numCols;\n\t\t\t\tthis.numRows = numRows;\n\t\t\t},\n\t\t\t_onMouseOver: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget || evt.fromElement;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_col\") + ' x 0' + this.editor.getLang(\"t_row\");\n\t\t\t\t\tthis.getDom('overlay').style.visibility = '';\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onMouseOut: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget || evt.toElement;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_col\") + ' x 0' + this.editor.getLang(\"t_row\");\n\t\t\t\t\tthis.getDom('overlay').style.visibility = 'hidden';\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onMouseMove: function(evt, el) {\n\t\t\t\tvar style = this.getDom('overlay').style;\n\t\t\t\tvar offset = uiUtils.getEventOffset(evt);\n\t\t\t\tvar sideLen = this.lengthOfCellSide;\n\t\t\t\tvar numCols = Math.ceil(offset.left / sideLen);\n\t\t\t\tvar numRows = Math.ceil(offset.top / sideLen);\n\t\t\t\tthis._track(numCols, numRows);\n\t\t\t},\n\t\t\t_onClick: function() {\n\t\t\t\tthis.fireEvent('picktable', this.numCols, this.numRows);\n\t\t\t}\n\t\t};\n\t\tutils.inherits(TablePicker, UIBase);\n\t})();\n\n\t// ui/stateful.js\n\t(function() {\n\t\tvar browser = baidu.editor.browser,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils;\n\n\t\tvar TPL_STATEFUL = 'onmousedown=\"$$.Stateful_onMouseDown(event, this);\"' +\n\t\t\t' onmouseup=\"$$.Stateful_onMouseUp(event, this);\"' +\n\t\t\t(browser.ie ? (\n\t\t\t\t' onmouseenter=\"$$.Stateful_onMouseEnter(event, this);\"' +\n\t\t\t\t' onmouseleave=\"$$.Stateful_onMouseLeave(event, this);\"') : (\n\t\t\t\t' onmouseover=\"$$.Stateful_onMouseOver(event, this);\"' +\n\t\t\t\t' onmouseout=\"$$.Stateful_onMouseOut(event, this);\"'));\n\n\t\tbaidu.editor.ui.Stateful = {\n\t\t\talwalysHoverable: false,\n\t\t\ttarget: null, //目标元素和this指向dom不一样\n\t\t\tStateful_init: function() {\n\t\t\t\tthis._Stateful_dGetHtmlTpl = this.getHtmlTpl;\n\t\t\t\tthis.getHtmlTpl = this.Stateful_getHtmlTpl;\n\t\t\t},\n\t\t\tStateful_getHtmlTpl: function() {\n\t\t\t\tvar tpl = this._Stateful_dGetHtmlTpl();\n\t\t\t\t// 使用function避免$转义\n\t\t\t\treturn tpl.replace(/stateful/g, function() {\n\t\t\t\t\treturn TPL_STATEFUL;\n\t\t\t\t});\n\t\t\t},\n\t\t\tStateful_onMouseEnter: function(evt, el) {\n\t\t\t\tthis.target = el;\n\t\t\t\tif (!this.isDisabled() || this.alwalysHoverable) {\n\t\t\t\t\tthis.addState('hover');\n\t\t\t\t\tthis.fireEvent('over');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseLeave: function(evt, el) {\n\t\t\t\tif (!this.isDisabled() || this.alwalysHoverable) {\n\t\t\t\t\tthis.removeState('hover');\n\t\t\t\t\tthis.removeState('active');\n\t\t\t\t\tthis.fireEvent('out');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseOver: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.Stateful_onMouseEnter(evt, el);\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseOut: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.Stateful_onMouseLeave(evt, el);\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseDown: function(evt, el) {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.addState('active');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseUp: function(evt, el) {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.removeState('active');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_postRender: function() {\n\t\t\t\tif (this.disabled && !this.hasState('disabled')) {\n\t\t\t\t\tthis.addState('disabled');\n\t\t\t\t}\n\t\t\t},\n\t\t\thasState: function(state) {\n\t\t\t\treturn domUtils.hasClass(this.getStateDom(), 'edui-state-' + state);\n\t\t\t},\n\t\t\taddState: function(state) {\n\t\t\t\tif (!this.hasState(state)) {\n\t\t\t\t\tthis.getStateDom().className += ' edui-state-' + state;\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveState: function(state) {\n\t\t\t\tif (this.hasState(state)) {\n\t\t\t\t\tdomUtils.removeClasses(this.getStateDom(), ['edui-state-' + state]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.getDom('state');\n\t\t\t},\n\t\t\tisChecked: function() {\n\t\t\t\treturn this.hasState('checked');\n\t\t\t},\n\t\t\tsetChecked: function(checked) {\n\t\t\t\tif (!this.isDisabled() && checked) {\n\t\t\t\t\tthis.addState('checked');\n\t\t\t\t} else {\n\t\t\t\t\tthis.removeState('checked');\n\t\t\t\t}\n\t\t\t},\n\t\t\tisDisabled: function() {\n\t\t\t\treturn this.hasState('disabled');\n\t\t\t},\n\t\t\tsetDisabled: function(disabled) {\n\t\t\t\tif (disabled) {\n\t\t\t\t\tthis.removeState('hover');\n\t\t\t\t\tthis.removeState('checked');\n\t\t\t\t\tthis.removeState('active');\n\t\t\t\t\tthis.addState('disabled');\n\t\t\t\t} else {\n\t\t\t\t\tthis.removeState('disabled');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t})();\n\n\t// ui/button.js\n\t///import core\n\t///import uicore\n\t///import ui/stateful.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tButton = baidu.editor.ui.Button = function(options) {\n\t\t\t\tif (options.name) {\n\t\t\t\t\tvar btnName = options.name;\n\t\t\t\t\tvar cssRules = options.cssRules;\n\t\t\t\t\tif (!options.className) {\n\t\t\t\t\t\toptions.className = 'edui-for-' + btnName;\n\t\t\t\t\t}\n\t\t\t\t\toptions.cssRules = '.edui-default  .edui-for-' + btnName + ' .edui-icon {' + cssRules + '}'\n\t\t\t\t}\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initButton();\n\t\t\t};\n\t\tButton.prototype = {\n\t\t\tuiName: 'button',\n\t\t\tlabel: '',\n\t\t\ttitle: '',\n\t\t\tshowIcon: true,\n\t\t\tshowText: true,\n\t\t\tcssRules: '',\n\t\t\tinitButton: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t\tif (this.cssRules) {\n\t\t\t\t\tutils.cssRule('edui-customize-' + this.name + '-style', this.cssRules);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\">' +\n\t\t\t\t\t'<div id=\"##_state\" stateful>' +\n\t\t\t\t\t'<div class=\"%%-wrap\"><div id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n\t\t\t\t\t' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\">' +\n\t\t\t\t\t(this.showIcon ? '<div class=\"edui-box edui-icon\"></div>' : '') +\n\t\t\t\t\t(this.showText ? '<div class=\"edui-box edui-label\">' + this.label + '</div>' : '') +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div></div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tthis.Stateful_postRender();\n\t\t\t\tthis.setDisabled(this.disabled)\n\t\t\t},\n\t\t\t_onMouseDown: function(e) {\n\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\ttagName = target && target.tagName && target.tagName.toLowerCase();\n\t\t\t\tif (tagName == 'input' || tagName == 'object' || tagName == 'object') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onClick: function() {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.fireEvent('click');\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetTitle: function(text) {\n\t\t\t\tvar label = this.getDom('label');\n\t\t\t\tlabel.innerHTML = text;\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Button, UIBase);\n\t\tutils.extend(Button.prototype, Stateful);\n\n\t})();\n\n\t// ui/splitbutton.js\n\t///import core\n\t///import uicore\n\t///import ui/stateful.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initSplitButton();\n\t\t\t};\n\t\tSplitButton.prototype = {\n\t\t\tpopup: null,\n\t\t\tuiName: 'splitbutton',\n\t\t\ttitle: '',\n\t\t\tinitSplitButton: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t\tvar me = this;\n\t\t\t\tif (this.popup != null) {\n\t\t\t\t\tvar popup = this.popup;\n\t\t\t\t\tthis.popup = null;\n\t\t\t\t\tthis.setPopup(popup);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_UIBase_postRender: UIBase.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tthis.Stateful_postRender();\n\t\t\t\tthis._UIBase_postRender();\n\t\t\t},\n\t\t\tsetPopup: function(popup) {\n\t\t\t\tif (this.popup === popup) return;\n\t\t\t\tif (this.popup != null) {\n\t\t\t\t\tthis.popup.dispose();\n\t\t\t\t}\n\t\t\t\tpopup.addListener('show', utils.bind(this._onPopupShow, this));\n\t\t\t\tpopup.addListener('hide', utils.bind(this._onPopupHide, this));\n\t\t\t\tpopup.addListener('postrender', utils.bind(function() {\n\t\t\t\t\tpopup.getDom('body').appendChild(\n\t\t\t\t\t\tuiUtils.createElementByHtml('<div id=\"' +\n\t\t\t\t\t\t\tthis.popup.id + '_bordereraser\" class=\"edui-bordereraser edui-background\" style=\"width:' +\n\t\t\t\t\t\t\t(uiUtils.getClientRect(this.getDom()).width + 20) + 'px\"></div>')\n\t\t\t\t\t);\n\t\t\t\t\tpopup.getDom().className += ' ' + this.className;\n\t\t\t\t}, this));\n\t\t\t\tthis.popup = popup;\n\t\t\t},\n\t\t\t_onPopupShow: function() {\n\t\t\t\tthis.addState('opened');\n\t\t\t},\n\t\t\t_onPopupHide: function() {\n\t\t\t\tthis.removeState('opened');\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\">' +\n\t\t\t\t\t'<div ' + (this.title ? 'title=\"' + this.title + '\"' : '') + ' id=\"##_state\" stateful><div class=\"%%-body\">' +\n\t\t\t\t\t'<div id=\"##_button_body\" class=\"edui-box edui-button-body\" onclick=\"$$._onButtonClick(event, this);\">' +\n\t\t\t\t\t'<div class=\"edui-box edui-icon\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-splitborder\"></div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-arrow\" onclick=\"$$._onArrowClick();\"></div>' +\n\t\t\t\t\t'</div></div></div>';\n\t\t\t},\n\t\t\tshowPopup: function() {\n\t\t\t\t// 当popup往上弹出的时候，做特殊处理\n\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\trect.top -= this.popup.SHADOW_RADIUS;\n\t\t\t\trect.height += this.popup.SHADOW_RADIUS;\n\t\t\t\tthis.popup.showAnchorRect(rect);\n\t\t\t},\n\t\t\t_onArrowClick: function(event, el) {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onButtonClick: function() {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.fireEvent('buttonclick');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(SplitButton, UIBase);\n\t\tutils.extend(SplitButton.prototype, Stateful, true);\n\n\t})();\n\n\t// ui/colorbutton.js\n\t///import core\n\t///import uicore\n\t///import ui/colorpicker.js\n\t///import ui/popup.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tColorPicker = baidu.editor.ui.ColorPicker,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tColorButton = baidu.editor.ui.ColorButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initColorButton();\n\t\t\t};\n\t\tColorButton.prototype = {\n\t\t\tinitColorButton: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tcontent: new ColorPicker({\n\t\t\t\t\t\tnoColorText: me.editor.getLang(\"clearColor\"),\n\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\tonpickcolor: function(t, color) {\n\t\t\t\t\t\t\tme._onPickColor(color);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonpicknocolor: function(t, color) {\n\t\t\t\t\t\t\tme._onPickNoColor(color);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\teditor: me.editor\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\t_SplitButton_postRender: SplitButton.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tthis._SplitButton_postRender();\n\t\t\t\tthis.getDom('button_body').appendChild(\n\t\t\t\t\tuiUtils.createElementByHtml('<div id=\"' + this.id + '_colorlump\" class=\"edui-colorlump\"></div>')\n\t\t\t\t);\n\t\t\t\tthis.getDom().className += ' edui-colorbutton';\n\t\t\t},\n\t\t\tsetColor: function(color) {\n\t\t\t\tthis.getDom('colorlump').style.backgroundColor = color;\n\t\t\t\tthis.color = color;\n\t\t\t},\n\t\t\t_onPickColor: function(color) {\n\t\t\t\tif (this.fireEvent('pickcolor', color) !== false) {\n\t\t\t\t\tthis.setColor(color);\n\t\t\t\t\tthis.popup.hide();\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onPickNoColor: function(color) {\n\t\t\t\tif (this.fireEvent('picknocolor') !== false) {\n\t\t\t\t\tthis.popup.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(ColorButton, SplitButton);\n\n\t})();\n\n\t// ui/tablebutton.js\n\t///import core\n\t///import uicore\n\t///import ui/popup.js\n\t///import ui/tablepicker.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tTablePicker = baidu.editor.ui.TablePicker,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tTableButton = baidu.editor.ui.TableButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initTableButton();\n\t\t\t};\n\t\tTableButton.prototype = {\n\t\t\tinitTableButton: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tcontent: new TablePicker({\n\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\tonpicktable: function(t, numCols, numRows) {\n\t\t\t\t\t\t\tme._onPickTable(numCols, numRows);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\t'editor': me.editor\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\t_onPickTable: function(numCols, numRows) {\n\t\t\t\tif (this.fireEvent('picktable', numCols, numRows) !== false) {\n\t\t\t\t\tthis.popup.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(TableButton, SplitButton);\n\n\t})();\n\n\t// ui/autotypesetpicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\tvar AutoTypeSetPicker = baidu.editor.ui.AutoTypeSetPicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initAutoTypeSetPicker();\n\t\t};\n\t\tAutoTypeSetPicker.prototype = {\n\t\t\tinitAutoTypeSetPicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar me = this.editor,\n\t\t\t\t\topt = me.options.autotypeset,\n\t\t\t\t\tlang = me.getLang(\"autoTypeSet\");\n\n\t\t\t\tvar textAlignInputName = 'textAlignValue' + me.uid,\n\t\t\t\t\timageBlockInputName = 'imageBlockLineValue' + me.uid,\n\t\t\t\t\tsymbolConverInputName = 'symbolConverValue' + me.uid;\n\n\t\t\t\treturn '<div id=\"##\" class=\"edui-autotypesetpicker %%\">' +\n\t\t\t\t\t'<div class=\"edui-autotypesetpicker-body\">' +\n\t\t\t\t\t'<table >' +\n\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"mergeEmptyline\" ' + (opt[\"mergeEmptyline\"] ? \"checked\" : \"\") + '>' + lang.mergeLine + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"removeEmptyline\" ' + (opt[\"removeEmptyline\"] ? \"checked\" : \"\") + '>' + lang.delLine + '</td></tr>' +\n\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"removeClass\" ' + (opt[\"removeClass\"] ? \"checked\" : \"\") + '>' + lang.removeFormat + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"indent\" ' + (opt[\"indent\"] ? \"checked\" : \"\") + '>' + lang.indent + '</td></tr>' +\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"textAlign\" ' + (opt[\"textAlign\"] ? \"checked\" : \"\") + '>' + lang.alignment + '</td>' +\n\t\t\t\t\t'<td colspan=\"2\" id=\"' + textAlignInputName + '\">' +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"left\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"left\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyleft\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"center\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"center\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifycenter\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"right\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"right\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyright\") +\n\t\t\t\t\t'</td>' +\n\t\t\t\t\t'</tr>' +\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"imageBlockLine\" ' + (opt[\"imageBlockLine\"] ? \"checked\" : \"\") + '>' + lang.imageFloat + '</td>' +\n\t\t\t\t\t'<td nowrap id=\"' + imageBlockInputName + '\">' +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"none\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"none\") ? \"checked\" : \"\") + '>' + me.getLang(\"default\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"left\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"left\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyleft\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"center\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"center\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifycenter\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"right\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"right\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyright\") +\n\t\t\t\t\t'</td>' +\n\t\t\t\t\t'</tr>' +\n\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"clearFontSize\" ' + (opt[\"clearFontSize\"] ? \"checked\" : \"\") + '>' + lang.removeFontsize + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"clearFontFamily\" ' + (opt[\"clearFontFamily\"] ? \"checked\" : \"\") + '>' + lang.removeFontFamily + '</td></tr>' +\n\t\t\t\t\t'<tr><td nowrap colspan=\"3\"><input type=\"checkbox\" name=\"removeEmptyNode\" ' + (opt[\"removeEmptyNode\"] ? \"checked\" : \"\") + '>' + lang.removeHtml + '</td></tr>' +\n\t\t\t\t\t'<tr><td nowrap colspan=\"3\"><input type=\"checkbox\" name=\"pasteFilter\" ' + (opt[\"pasteFilter\"] ? \"checked\" : \"\") + '>' + lang.pasteFilter + '</td></tr>' +\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"symbolConver\" ' + (opt[\"bdc2sb\"] || opt[\"tobdc\"] ? \"checked\" : \"\") + '>' + lang.symbol + '</td>' +\n\t\t\t\t\t'<td id=\"' + symbolConverInputName + '\">' +\n\t\t\t\t\t'<input type=\"radio\" name=\"bdc\" value=\"bdc2sb\" ' + (opt[\"bdc2sb\"] ? \"checked\" : \"\") + '>' + lang.bdc2sb +\n\t\t\t\t\t'<input type=\"radio\" name=\"bdc\" value=\"tobdc\" ' + (opt[\"tobdc\"] ? \"checked\" : \"\") + '>' + lang.tobdc + '' +\n\t\t\t\t\t'</td>' +\n\t\t\t\t\t'<td nowrap align=\"right\"><button >' + lang.run + '</button></td>' +\n\t\t\t\t\t'</tr>' +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t};\n\t\tutils.inherits(AutoTypeSetPicker, UIBase);\n\t})();\n\n\t// ui/autotypesetbutton.js\n\t///import core\n\t///import uicore\n\t///import ui/popup.js\n\t///import ui/autotypesetpicker.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tAutoTypeSetPicker = baidu.editor.ui.AutoTypeSetPicker,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tAutoTypeSetButton = baidu.editor.ui.AutoTypeSetButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initAutoTypeSetButton();\n\t\t\t};\n\n\t\tfunction getPara(me) {\n\n\t\t\tvar opt = {},\n\t\t\t\tcont = me.getDom(),\n\t\t\t\teditorId = me.editor.uid,\n\t\t\t\tinputType = null,\n\t\t\t\tattrName = null,\n\t\t\t\tipts = domUtils.getElementsByTagName(cont, \"input\");\n\t\t\tfor (var i = ipts.length - 1, ipt; ipt = ipts[i--];) {\n\t\t\t\tinputType = ipt.getAttribute(\"type\");\n\t\t\t\tif (inputType == \"checkbox\") {\n\t\t\t\t\tattrName = ipt.getAttribute(\"name\");\n\t\t\t\t\topt[attrName] && delete opt[attrName];\n\t\t\t\t\tif (ipt.checked) {\n\t\t\t\t\t\tvar attrValue = document.getElementById(attrName + \"Value\" + editorId);\n\t\t\t\t\t\tif (attrValue) {\n\t\t\t\t\t\t\tif (/input/ig.test(attrValue.tagName)) {\n\t\t\t\t\t\t\t\topt[attrName] = attrValue.value;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar iptChilds = attrValue.getElementsByTagName(\"input\");\n\t\t\t\t\t\t\t\tfor (var j = iptChilds.length - 1, iptchild; iptchild = iptChilds[j--];) {\n\t\t\t\t\t\t\t\t\tif (iptchild.checked) {\n\t\t\t\t\t\t\t\t\t\topt[attrName] = iptchild.value;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\topt[attrName] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\topt[attrName] = false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\topt[ipt.getAttribute(\"value\")] = ipt.checked;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar selects = domUtils.getElementsByTagName(cont, \"select\");\n\t\t\tfor (var i = 0, si; si = selects[i++];) {\n\t\t\t\tvar attr = si.getAttribute('name');\n\t\t\t\topt[attr] = opt[attr] ? si.value : '';\n\t\t\t}\n\n\t\t\tutils.extend(me.editor.options.autotypeset, opt);\n\n\t\t\tme.editor.setPreferences('autotypeset', opt);\n\t\t}\n\n\t\tAutoTypeSetButton.prototype = {\n\t\t\tinitAutoTypeSetButton: function() {\n\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t//传入配置参数\n\t\t\t\t\tcontent: new AutoTypeSetPicker({\n\t\t\t\t\t\teditor: me.editor\n\t\t\t\t\t}),\n\t\t\t\t\t'editor': me.editor,\n\t\t\t\t\thide: function() {\n\t\t\t\t\t\tif (!this._hidden && this.getDom()) {\n\t\t\t\t\t\t\tgetPara(this);\n\t\t\t\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar flag = 0;\n\t\t\t\tthis.popup.addListener('postRenderAfter', function() {\n\t\t\t\t\tvar popupUI = this;\n\t\t\t\t\tif (flag) return;\n\t\t\t\t\tvar cont = this.getDom(),\n\t\t\t\t\t\tbtn = cont.getElementsByTagName('button')[0];\n\n\t\t\t\t\tbtn.onclick = function() {\n\t\t\t\t\t\tgetPara(popupUI);\n\t\t\t\t\t\tme.editor.execCommand('autotypeset');\n\t\t\t\t\t\tpopupUI.hide()\n\t\t\t\t\t};\n\n\t\t\t\t\tdomUtils.on(cont, 'click', function(e) {\n\t\t\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\t\t\teditorId = me.editor.uid;\n\t\t\t\t\t\tif (target && target.tagName == 'INPUT') {\n\n\t\t\t\t\t\t\t// 点击图片浮动的checkbox,去除对应的radio\n\t\t\t\t\t\t\tif (target.name == 'imageBlockLine' || target.name == 'textAlign' || target.name == 'symbolConver') {\n\t\t\t\t\t\t\t\tvar checked = target.checked,\n\t\t\t\t\t\t\t\t\tradioTd = document.getElementById(target.name + 'Value' + editorId),\n\t\t\t\t\t\t\t\t\tradios = radioTd.getElementsByTagName('input'),\n\t\t\t\t\t\t\t\t\tdefalutSelect = {\n\t\t\t\t\t\t\t\t\t\t'imageBlockLine': 'none',\n\t\t\t\t\t\t\t\t\t\t'textAlign': 'left',\n\t\t\t\t\t\t\t\t\t\t'symbolConver': 'tobdc'\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tfor (var i = 0; i < radios.length; i++) {\n\t\t\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\t\t\tif (radios[i].value == defalutSelect[target.name]) {\n\t\t\t\t\t\t\t\t\t\t\tradios[i].checked = 'checked';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tradios[i].checked = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// 点击radio,选中对应的checkbox\n\t\t\t\t\t\t\tif (target.name == ('imageBlockLineValue' + editorId) || target.name == ('textAlignValue' + editorId) || target.name == 'bdc') {\n\t\t\t\t\t\t\t\tvar checkboxs = target.parentNode.previousSibling.getElementsByTagName('input');\n\t\t\t\t\t\t\t\tcheckboxs && (checkboxs[0].checked = true);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgetPara(popupUI);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tflag = 1;\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t}\n\t\t};\n\t\tutils.inherits(AutoTypeSetButton, SplitButton);\n\n\t})();\n\n\t// ui/cellalignpicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\t/**\n\t\t * 该参数将新增一个参数： selected， 参数类型为一个Object， 形如{ 'align': 'center', 'valign': 'top' }， 表示单元格的初始\n\t\t * 对齐状态为： 竖直居上，水平居中; 其中 align的取值为：'center', 'left', 'right'; valign的取值为: 'top', 'middle', 'bottom'\n\t\t * @update 2013/4/2 hancong03@baidu.com\n\t\t */\n\t\tvar CellAlignPicker = baidu.editor.ui.CellAlignPicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initSelected();\n\t\t\tthis.initCellAlignPicker();\n\t\t};\n\t\tCellAlignPicker.prototype = {\n\t\t\t//初始化选中状态， 该方法将根据传递进来的参数获取到应该选中的对齐方式图标的索引\n\t\t\tinitSelected: function() {\n\n\t\t\t\tvar status = {\n\n\t\t\t\t\t\tvalign: {\n\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\tmiddle: 1,\n\t\t\t\t\t\t\tbottom: 2\n\t\t\t\t\t\t},\n\t\t\t\t\t\talign: {\n\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\tcenter: 1,\n\t\t\t\t\t\t\tright: 2\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcount: 3\n\n\t\t\t\t\t},\n\t\t\t\t\tresult = -1;\n\n\t\t\t\tif (this.selected) {\n\t\t\t\t\tthis.selectedIndex = status.valign[this.selected.valign] * status.count + status.align[this.selected.align];\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tinitCellAlignPicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\n\t\t\t\tvar alignType = ['left', 'center', 'right'],\n\t\t\t\t\tCOUNT = 9,\n\t\t\t\t\ttempClassName = null,\n\t\t\t\t\ttempIndex = -1,\n\t\t\t\t\ttmpl = [];\n\n\t\t\t\tfor (var i = 0; i < COUNT; i++) {\n\n\t\t\t\t\ttempClassName = this.selectedIndex === i ? ' class=\"edui-cellalign-selected\" ' : '';\n\t\t\t\t\ttempIndex = i % 3;\n\n\t\t\t\t\ttempIndex === 0 && tmpl.push('<tr>');\n\n\t\t\t\t\ttmpl.push('<td index=\"' + i + '\" ' + tempClassName + ' stateful><div class=\"edui-icon edui-' + alignType[tempIndex] + '\"></div></td>');\n\n\t\t\t\t\ttempIndex === 2 && tmpl.push('</tr>');\n\n\t\t\t\t}\n\n\t\t\t\treturn '<div id=\"##\" class=\"edui-cellalignpicker %%\">' +\n\t\t\t\t\t'<div class=\"edui-cellalignpicker-body\">' +\n\t\t\t\t\t'<table onclick=\"$$._onClick(event);\">' +\n\t\t\t\t\ttmpl.join('') +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.target;\n\t\t\t},\n\t\t\t_onClick: function(evt) {\n\t\t\t\tvar target = evt.target || evt.srcElement;\n\t\t\t\tif (/icon/.test(target.className)) {\n\t\t\t\t\tthis.items[target.parentNode.getAttribute(\"index\")].onclick();\n\t\t\t\t\tPopup.postHide(evt);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t};\n\t\tutils.inherits(CellAlignPicker, UIBase);\n\t\tutils.extend(CellAlignPicker.prototype, Stateful, true);\n\t})();\n\n\t// ui/pastepicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\tvar PastePicker = baidu.editor.ui.PastePicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initPastePicker();\n\t\t};\n\t\tPastePicker.prototype = {\n\t\t\tinitPastePicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div class=\"edui-pasteicon\" onclick=\"$$._onClick(this)\"></div>' +\n\t\t\t\t\t'<div class=\"edui-pastecontainer\">' +\n\t\t\t\t\t'<div class=\"edui-title\">' + this.editor.getLang(\"pasteOpt\") + '</div>' +\n\t\t\t\t\t'<div class=\"edui-button\">' +\n\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"pasteSourceFormat\") + '\" onclick=\"$$.format(false)\" stateful>' +\n\t\t\t\t\t'<div class=\"edui-richtxticon\"></div></div>' +\n\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"tagFormat\") + '\" onclick=\"$$.format(2)\" stateful>' +\n\t\t\t\t\t'<div class=\"edui-tagicon\"></div></div>' +\n\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"pasteTextFormat\") + '\" onclick=\"$$.format(true)\" stateful>' +\n\t\t\t\t\t'<div class=\"edui-plaintxticon\"></div></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>'\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.target;\n\t\t\t},\n\t\t\tformat: function(param) {\n\t\t\t\tthis.editor.ui._isTransfer = true;\n\t\t\t\tthis.editor.fireEvent('pasteTransfer', param);\n\t\t\t},\n\t\t\t_onClick: function(cur) {\n\t\t\t\tvar node = domUtils.getNextDomNode(cur),\n\t\t\t\t\tscreenHt = uiUtils.getViewportRect().height,\n\t\t\t\t\tsubPop = uiUtils.getClientRect(node);\n\n\t\t\t\tif ((subPop.top + subPop.height) > screenHt)\n\t\t\t\t\tnode.style.top = (-subPop.height - cur.offsetHeight) + \"px\";\n\t\t\t\telse\n\t\t\t\t\tnode.style.top = \"\";\n\n\t\t\t\tif (/hidden/ig.test(domUtils.getComputedStyle(node, \"visibility\"))) {\n\t\t\t\t\tnode.style.visibility = \"visible\";\n\t\t\t\t\tdomUtils.addClass(cur, \"edui-state-opened\");\n\t\t\t\t} else {\n\t\t\t\t\tnode.style.visibility = \"hidden\";\n\t\t\t\t\tdomUtils.removeClasses(cur, \"edui-state-opened\")\n\t\t\t\t}\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t};\n\t\tutils.inherits(PastePicker, UIBase);\n\t\tutils.extend(PastePicker.prototype, Stateful, true);\n\t})();\n\n\t// ui/toolbar.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tToolbar = baidu.editor.ui.Toolbar = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initToolbar();\n\t\t\t};\n\t\tToolbar.prototype = {\n\t\t\titems: null,\n\t\t\tinitToolbar: function() {\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tadd: function(item, index) {\n\t\t\t\tif (index === undefined) {\n\t\t\t\t\tthis.items.push(item);\n\t\t\t\t} else {\n\t\t\t\t\tthis.items.splice(index, 0, item)\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar buff = [];\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tbuff[i] = this.items[i].renderHtml();\n\t\t\t\t}\n\t\t\t\treturn '<div id=\"##\" class=\"edui-toolbar %%\" onselectstart=\"return false;\" onmousedown=\"return $$._onMouseDown(event, this);\">' +\n\t\t\t\t\tbuff.join('') +\n\t\t\t\t\t'</div>'\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar box = this.getDom();\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tthis.items[i].postRender();\n\t\t\t\t}\n\t\t\t\tuiUtils.makeUnselectable(box);\n\t\t\t},\n\t\t\t_onMouseDown: function(e) {\n\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\ttagName = target && target.tagName && target.tagName.toLowerCase();\n\t\t\t\tif (tagName == 'input' || tagName == 'object' || tagName == 'object') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Toolbar, UIBase);\n\n\t})();\n\n\t// ui/menu.js\n\t///import core\n\t///import uicore\n\t///import ui\\popup.js\n\t///import ui\\stateful.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tCellAlignPicker = baidu.editor.ui.CellAlignPicker,\n\n\t\t\tMenu = baidu.editor.ui.Menu = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMenu();\n\t\t\t};\n\n\t\tvar menuSeparator = {\n\t\t\trenderHtml: function() {\n\t\t\t\treturn '<div class=\"edui-menuitem edui-menuseparator\"><div class=\"edui-menuseparator-inner\"></div></div>';\n\t\t\t},\n\t\t\tpostRender: function() {},\n\t\t\tqueryAutoHide: function() {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tMenu.prototype = {\n\t\t\titems: null,\n\t\t\tuiName: 'menu',\n\t\t\tinitMenu: function() {\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tthis.initPopup();\n\t\t\t\tthis.initItems();\n\t\t\t},\n\t\t\tinitItems: function() {\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\tif (item == '-') {\n\t\t\t\t\t\tthis.items[i] = this.getSeparator();\n\t\t\t\t\t} else if (!(item instanceof MenuItem)) {\n\t\t\t\t\t\titem.editor = this.editor;\n\t\t\t\t\t\titem.theme = this.editor.options.theme;\n\t\t\t\t\t\tthis.items[i] = this.createItem(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetSeparator: function() {\n\t\t\t\treturn menuSeparator;\n\t\t\t},\n\t\t\tcreateItem: function(item) {\n\t\t\t\t//新增一个参数menu, 该参数存储了menuItem所对应的menu引用\n\t\t\t\titem.menu = this;\n\t\t\t\treturn new MenuItem(item);\n\t\t\t},\n\t\t\t_Popup_getContentHtmlTpl: Popup.prototype.getContentHtmlTpl,\n\t\t\tgetContentHtmlTpl: function() {\n\t\t\t\tif (this.items.length == 0) {\n\t\t\t\t\treturn this._Popup_getContentHtmlTpl();\n\t\t\t\t}\n\t\t\t\tvar buff = [];\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\tbuff[i] = item.renderHtml();\n\t\t\t\t}\n\t\t\t\treturn ('<div class=\"%%-body\">' + buff.join('') + '</div>');\n\t\t\t},\n\t\t\t_Popup_postRender: Popup.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\titem.ownerMenu = this;\n\t\t\t\t\titem.postRender();\n\t\t\t\t}\n\t\t\t\tdomUtils.on(this.getDom(), 'mouseover', function(evt) {\n\t\t\t\t\tevt = evt || event;\n\t\t\t\t\tvar rel = evt.relatedTarget || evt.fromElement;\n\t\t\t\t\tvar el = me.getDom();\n\t\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\t\tme.fireEvent('over');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._Popup_postRender();\n\t\t\t},\n\t\t\tqueryAutoHide: function(el) {\n\t\t\t\tif (el) {\n\t\t\t\t\tif (uiUtils.contains(this.getDom(), el)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\tif (item.queryAutoHide(el) === false) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tclearItems: function() {\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\tclearTimeout(item._showingTimer);\n\t\t\t\t\tclearTimeout(item._closingTimer);\n\t\t\t\t\tif (item.subMenu) {\n\t\t\t\t\t\titem.subMenu.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.items = [];\n\t\t\t},\n\t\t\tdestroy: function() {\n\t\t\t\tif (this.getDom()) {\n\t\t\t\t\tdomUtils.remove(this.getDom());\n\t\t\t\t}\n\t\t\t\tthis.clearItems();\n\t\t\t},\n\t\t\tdispose: function() {\n\t\t\t\tthis.destroy();\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Menu, Popup);\n\n\t\t/**\n\t\t * @update 2013/04/03 hancong03 新增一个参数menu, 该参数存储了menuItem所对应的menu引用\n\t\t * @type {Function}\n\t\t */\n\t\tvar MenuItem = baidu.editor.ui.MenuItem = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initUIBase();\n\t\t\tthis.Stateful_init();\n\t\t\tif (this.subMenu && !(this.subMenu instanceof Menu)) {\n\t\t\t\tif (options.className && options.className.indexOf(\"aligntd\") != -1) {\n\t\t\t\t\tvar me = this;\n\n\t\t\t\t\t//获取单元格对齐初始状态\n\t\t\t\t\tthis.subMenu.selected = this.editor.queryCommandValue('cellalignment');\n\n\t\t\t\t\tthis.subMenu = new Popup({\n\t\t\t\t\t\tcontent: new CellAlignPicker(this.subMenu),\n\t\t\t\t\t\tparentMenu: me,\n\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\tdestroy: function() {\n\t\t\t\t\t\t\tif (this.getDom()) {\n\t\t\t\t\t\t\t\tdomUtils.remove(this.getDom());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.subMenu.addListener(\"postRenderAfter\", function() {\n\t\t\t\t\t\tdomUtils.on(this.getDom(), \"mouseover\", function() {\n\t\t\t\t\t\t\tme.addState('opened');\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.subMenu = new Menu(this.subMenu);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tMenuItem.prototype = {\n\t\t\tlabel: '',\n\t\t\tsubMenu: null,\n\t\t\townerMenu: null,\n\t\t\tuiName: 'menuitem',\n\t\t\talwalysHoverable: true,\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"%%\" stateful onclick=\"$$._onClick(event, this);\">' +\n\t\t\t\t\t'<div class=\"%%-body\">' +\n\t\t\t\t\tthis.renderLabelHtml() +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.addListener('over', function() {\n\t\t\t\t\tme.ownerMenu.fireEvent('submenuover', me);\n\t\t\t\t\tif (me.subMenu) {\n\t\t\t\t\t\tme.delayShowSubMenu();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (this.subMenu) {\n\t\t\t\t\tthis.getDom().className += ' edui-hassubmenu';\n\t\t\t\t\tthis.subMenu.render();\n\t\t\t\t\tthis.addListener('out', function() {\n\t\t\t\t\t\tme.delayHideSubMenu();\n\t\t\t\t\t});\n\t\t\t\t\tthis.subMenu.addListener('over', function() {\n\t\t\t\t\t\tclearTimeout(me._closingTimer);\n\t\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\t\tme.addState('opened');\n\t\t\t\t\t});\n\t\t\t\t\tthis.ownerMenu.addListener('hide', function() {\n\t\t\t\t\t\tme.hideSubMenu();\n\t\t\t\t\t});\n\t\t\t\t\tthis.ownerMenu.addListener('submenuover', function(t, subMenu) {\n\t\t\t\t\t\tif (subMenu !== me) {\n\t\t\t\t\t\t\tme.delayHideSubMenu();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.subMenu._bakQueryAutoHide = this.subMenu.queryAutoHide;\n\t\t\t\t\tthis.subMenu.queryAutoHide = function(el) {\n\t\t\t\t\t\tif (el && uiUtils.contains(me.getDom(), el)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this._bakQueryAutoHide(el);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthis.getDom().style.tabIndex = '-1';\n\t\t\t\tuiUtils.makeUnselectable(this.getDom());\n\t\t\t\tthis.Stateful_postRender();\n\t\t\t},\n\t\t\tdelayShowSubMenu: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!me.isDisabled()) {\n\t\t\t\t\tme.addState('opened');\n\t\t\t\t\tclearTimeout(me._showingTimer);\n\t\t\t\t\tclearTimeout(me._closingTimer);\n\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\tme._showingTimer = setTimeout(function() {\n\t\t\t\t\t\tme.showSubMenu();\n\t\t\t\t\t}, 250);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelayHideSubMenu: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!me.isDisabled()) {\n\t\t\t\t\tme.removeState('opened');\n\t\t\t\t\tclearTimeout(me._showingTimer);\n\t\t\t\t\tif (!me._closingTimer) {\n\t\t\t\t\t\tme._closingTimer = setTimeout(function() {\n\t\t\t\t\t\t\tif (!me.hasState('opened')) {\n\t\t\t\t\t\t\t\tme.hideSubMenu();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\t\t}, 400);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\trenderLabelHtml: function() {\n\t\t\t\treturn '<div class=\"edui-arrow\"></div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-icon\"></div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-label %%-label\">' + (this.label || '') + '</div>';\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.getDom();\n\t\t\t},\n\t\t\tqueryAutoHide: function(el) {\n\t\t\t\tif (this.subMenu && this.hasState('opened')) {\n\t\t\t\t\treturn this.subMenu.queryAutoHide(el);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onClick: function(event, this_) {\n\t\t\t\tif (this.hasState('disabled')) return;\n\t\t\t\tif (this.fireEvent('click', event, this_) !== false) {\n\t\t\t\t\tif (this.subMenu) {\n\t\t\t\t\t\tthis.showSubMenu();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tPopup.postHide(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowSubMenu: function() {\n\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\trect.right -= 5;\n\t\t\t\trect.left += 2;\n\t\t\t\trect.width -= 7;\n\t\t\t\trect.top -= 4;\n\t\t\t\trect.bottom += 4;\n\t\t\t\trect.height += 8;\n\t\t\t\tthis.subMenu.showAnchorRect(rect, true, true);\n\t\t\t},\n\t\t\thideSubMenu: function() {\n\t\t\t\tthis.subMenu.hide();\n\t\t\t}\n\t\t};\n\t\tutils.inherits(MenuItem, UIBase);\n\t\tutils.extend(MenuItem.prototype, Stateful, true);\n\t})();\n\n\t// ui/combox.js\n\t///import core\n\t///import uicore\n\t///import ui/menu.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\t// todo: menu和item提成通用list\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tMenu = baidu.editor.ui.Menu,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tCombox = baidu.editor.ui.Combox = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initCombox();\n\t\t\t};\n\t\tCombox.prototype = {\n\t\t\tuiName: 'combox',\n\t\t\tonbuttonclick: function() {\n\t\t\t\tthis.showPopup();\n\t\t\t},\n\t\t\tinitCombox: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\titem.uiName = 'listitem';\n\t\t\t\t\titem.index = i;\n\t\t\t\t\titem.onclick = function() {\n\t\t\t\t\t\tme.selectByIndex(this.index);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthis.popup = new Menu({\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tuiName: 'list',\n\t\t\t\t\teditor: this.editor,\n\t\t\t\t\tcaptureWheel: true,\n\t\t\t\t\tcombox: this\n\t\t\t\t});\n\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\t_SplitButton_postRender: SplitButton.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tthis._SplitButton_postRender();\n\t\t\t\tthis.setLabel(this.label || '');\n\t\t\t\tthis.setValue(this.initValue || '');\n\t\t\t},\n\t\t\tshowPopup: function() {\n\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\trect.top += 1;\n\t\t\t\trect.bottom -= 1;\n\t\t\t\trect.height -= 2;\n\t\t\t\tthis.popup.showAnchorRect(rect);\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.value;\n\t\t\t},\n\t\t\tsetValue: function(value) {\n\t\t\t\tvar index = this.indexByValue(value);\n\t\t\t\tif (index != -1) {\n\t\t\t\t\tthis.selectedIndex = index;\n\t\t\t\t\tthis.setLabel(this.items[index].label);\n\t\t\t\t\tthis.value = this.items[index].value;\n\t\t\t\t} else {\n\t\t\t\t\tthis.selectedIndex = -1;\n\t\t\t\t\tthis.setLabel(this.getLabelForUnknowValue(value));\n\t\t\t\t\tthis.value = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetLabel: function(label) {\n\t\t\t\tthis.getDom('button_body').innerHTML = label;\n\t\t\t\tthis.label = label;\n\t\t\t},\n\t\t\tgetLabelForUnknowValue: function(value) {\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tindexByValue: function(value) {\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tif (value == this.items[i].value) {\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\tgetItem: function(index) {\n\t\t\t\treturn this.items[index];\n\t\t\t},\n\t\t\tselectByIndex: function(index) {\n\t\t\t\tif (index < this.items.length && this.fireEvent('select', index) !== false) {\n\t\t\t\t\tthis.selectedIndex = index;\n\t\t\t\t\tthis.value = this.items[index].value;\n\t\t\t\t\tthis.setLabel(this.items[index].label);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Combox, SplitButton);\n\t})();\n\n\t// ui/dialog.js\n\t///import core\n\t///import uicore\n\t///import ui/mask.js\n\t///import ui/button.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tMask = baidu.editor.ui.Mask,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tButton = baidu.editor.ui.Button,\n\t\t\tDialog = baidu.editor.ui.Dialog = function(options) {\n\t\t\t\tif (options.name) {\n\t\t\t\t\tvar name = options.name;\n\t\t\t\t\tvar cssRules = options.cssRules;\n\t\t\t\t\tif (!options.className) {\n\t\t\t\t\t\toptions.className = 'edui-for-' + name;\n\t\t\t\t\t}\n\t\t\t\t\tif (cssRules) {\n\t\t\t\t\t\toptions.cssRules = '.edui-default .edui-for-' + name + ' .edui-dialog-content  {' + cssRules + '}'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.initOptions(utils.extend({\n\t\t\t\t\tautoReset: true,\n\t\t\t\t\tdraggable: true,\n\t\t\t\t\tonok: function() {},\n\t\t\t\t\toncancel: function() {},\n\t\t\t\t\tonclose: function(t, ok) {\n\t\t\t\t\t\treturn ok ? this.onok() : this.oncancel();\n\t\t\t\t\t},\n\t\t\t\t\t//是否控制dialog中的scroll事件， 默认为不阻止\n\t\t\t\t\tholdScroll: false\n\t\t\t\t}, options));\n\t\t\t\tthis.initDialog();\n\t\t\t};\n\t\tvar modalMask;\n\t\tvar dragMask;\n\t\tvar activeDialog;\n\t\tDialog.prototype = {\n\t\t\tdraggable: false,\n\t\t\tuiName: 'dialog',\n\t\t\tinitDialog: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\ttheme = this.editor.options.theme;\n\t\t\t\tif (this.cssRules) {\n\t\t\t\t\tutils.cssRule('edui-customize-' + this.name + '-style', this.cssRules);\n\t\t\t\t}\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.modalMask = (modalMask || (modalMask = new Mask({\n\t\t\t\t\tclassName: 'edui-dialog-modalmask',\n\t\t\t\t\ttheme: theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\tactiveDialog && activeDialog.close(false);\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tthis.dragMask = (dragMask || (dragMask = new Mask({\n\t\t\t\t\tclassName: 'edui-dialog-dragmask',\n\t\t\t\t\ttheme: theme\n\t\t\t\t})));\n\t\t\t\tthis.closeButton = new Button({\n\t\t\t\t\tclassName: 'edui-dialog-closebutton',\n\t\t\t\t\ttitle: me.closeDialog,\n\t\t\t\t\ttheme: theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\tme.close(false);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.fullscreen && this.initResizeEvent();\n\n\t\t\t\tif (this.buttons) {\n\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\tif (!(this.buttons[i] instanceof Button)) {\n\t\t\t\t\t\t\tthis.buttons[i] = new Button(utils.extend(this.buttons[i], {\n\t\t\t\t\t\t\t\teditor: this.editor\n\t\t\t\t\t\t\t}, true));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tinitResizeEvent: function() {\n\n\t\t\t\tvar me = this;\n\n\t\t\t\tdomUtils.on(window, \"resize\", function() {\n\n\t\t\t\t\tif (me._hidden || me._hidden === undefined) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (me.__resizeTimer) {\n\t\t\t\t\t\twindow.clearTimeout(me.__resizeTimer);\n\t\t\t\t\t}\n\n\t\t\t\t\tme.__resizeTimer = window.setTimeout(function() {\n\n\t\t\t\t\t\tme.__resizeTimer = null;\n\n\t\t\t\t\t\tvar dialogWrapNode = me.getDom(),\n\t\t\t\t\t\t\tcontentNode = me.getDom('content'),\n\t\t\t\t\t\t\twrapRect = UE.ui.uiUtils.getClientRect(dialogWrapNode),\n\t\t\t\t\t\t\tcontentRect = UE.ui.uiUtils.getClientRect(contentNode),\n\t\t\t\t\t\t\tvpRect = uiUtils.getViewportRect();\n\n\t\t\t\t\t\tcontentNode.style.width = (vpRect.width - wrapRect.width + contentRect.width) + \"px\";\n\t\t\t\t\t\tcontentNode.style.height = (vpRect.height - wrapRect.height + contentRect.height) + \"px\";\n\n\t\t\t\t\t\tdialogWrapNode.style.width = vpRect.width + \"px\";\n\t\t\t\t\t\tdialogWrapNode.style.height = vpRect.height + \"px\";\n\n\t\t\t\t\t\tme.fireEvent(\"resize\");\n\n\t\t\t\t\t}, 100);\n\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tfitSize: function() {\n\t\t\t\tvar popBodyEl = this.getDom('body');\n\t\t\t\t//            if (!(baidu.editor.browser.ie && baidu.editor.browser.version == 7)) {\n\t\t\t\t//                uiUtils.removeStyle(popBodyEl, 'width');\n\t\t\t\t//                uiUtils.removeStyle(popBodyEl, 'height');\n\t\t\t\t//            }\n\t\t\t\tvar size = this.mesureSize();\n\t\t\t\tpopBodyEl.style.width = size.width + 'px';\n\t\t\t\tpopBodyEl.style.height = size.height + 'px';\n\t\t\t\treturn size;\n\t\t\t},\n\t\t\tsafeSetOffset: function(offset) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar el = me.getDom();\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\tvar rect = uiUtils.getClientRect(el);\n\t\t\t\tvar left = offset.left;\n\t\t\t\tif (left + rect.width > vpRect.right) {\n\t\t\t\t\tleft = vpRect.right - rect.width;\n\t\t\t\t}\n\t\t\t\tvar top = offset.top;\n\t\t\t\tif (top + rect.height > vpRect.bottom) {\n\t\t\t\t\ttop = vpRect.bottom - rect.height;\n\t\t\t\t}\n\t\t\t\tel.style.left = Math.max(left, 0) + 'px';\n\t\t\t\tel.style.top = Math.max(top, 0) + 'px';\n\t\t\t},\n\t\t\tshowAtCenter: function() {\n\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\n\t\t\t\tif (!this.fullscreen) {\n\t\t\t\t\tthis.getDom().style.display = '';\n\t\t\t\t\tvar popSize = this.fitSize();\n\t\t\t\t\tvar titleHeight = this.getDom('titlebar').offsetHeight | 0;\n\t\t\t\t\tvar left = vpRect.width / 2 - popSize.width / 2;\n\t\t\t\t\tvar top = vpRect.height / 2 - (popSize.height - titleHeight) / 2 - titleHeight;\n\t\t\t\t\tvar popEl = this.getDom();\n\t\t\t\t\tthis.safeSetOffset({\n\t\t\t\t\t\tleft: Math.max(left | 0, 0),\n\t\t\t\t\t\ttop: Math.max(top | 0, 0)\n\t\t\t\t\t});\n\t\t\t\t\tif (!domUtils.hasClass(popEl, 'edui-state-centered')) {\n\t\t\t\t\t\tpopEl.className += ' edui-state-centered';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar dialogWrapNode = this.getDom(),\n\t\t\t\t\t\tcontentNode = this.getDom('content');\n\n\t\t\t\t\tdialogWrapNode.style.display = \"block\";\n\n\t\t\t\t\tvar wrapRect = UE.ui.uiUtils.getClientRect(dialogWrapNode),\n\t\t\t\t\t\tcontentRect = UE.ui.uiUtils.getClientRect(contentNode);\n\t\t\t\t\tdialogWrapNode.style.left = \"-100000px\";\n\n\t\t\t\t\tcontentNode.style.width = (vpRect.width - wrapRect.width + contentRect.width) + \"px\";\n\t\t\t\t\tcontentNode.style.height = (vpRect.height - wrapRect.height + contentRect.height) + \"px\";\n\n\t\t\t\t\tdialogWrapNode.style.width = vpRect.width + \"px\";\n\t\t\t\t\tdialogWrapNode.style.height = vpRect.height + \"px\";\n\t\t\t\t\tdialogWrapNode.style.left = 0;\n\n\t\t\t\t\t//保存环境的overflow值\n\t\t\t\t\tthis._originalContext = {\n\t\t\t\t\t\thtml: {\n\t\t\t\t\t\t\toverflowX: document.documentElement.style.overflowX,\n\t\t\t\t\t\t\toverflowY: document.documentElement.style.overflowY\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\toverflowX: document.body.style.overflowX,\n\t\t\t\t\t\t\toverflowY: document.body.style.overflowY\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tdocument.documentElement.style.overflowX = 'hidden';\n\t\t\t\t\tdocument.documentElement.style.overflowY = 'hidden';\n\t\t\t\t\tdocument.body.style.overflowX = 'hidden';\n\t\t\t\t\tdocument.body.style.overflowY = 'hidden';\n\n\t\t\t\t}\n\n\t\t\t\tthis._show();\n\t\t\t},\n\t\t\tgetContentHtml: function() {\n\t\t\t\tvar contentHtml = '';\n\t\t\t\tif (typeof this.content == 'string') {\n\t\t\t\t\tcontentHtml = this.content;\n\t\t\t\t} else if (this.iframeUrl) {\n\t\t\t\t\tcontentHtml = '<span id=\"' + this.id + '_contmask\" class=\"dialogcontmask\"></span><iframe id=\"' + this.id +\n\t\t\t\t\t\t'_iframe\" class=\"%%-iframe\" height=\"100%\" width=\"100%\" frameborder=\"0\" src=\"' + this.iframeUrl + '\"></iframe>';\n\t\t\t\t}\n\t\t\t\treturn contentHtml;\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar footHtml = '';\n\n\t\t\t\tif (this.buttons) {\n\t\t\t\t\tvar buff = [];\n\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\tbuff[i] = this.buttons[i].renderHtml();\n\t\t\t\t\t}\n\t\t\t\t\tfootHtml = '<div class=\"%%-foot\">' +\n\t\t\t\t\t\t'<div id=\"##_buttons\" class=\"%%-buttons\">' + buff.join('') + '</div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\n\t\t\t\treturn '<div id=\"##\" class=\"%%\"><div ' + (!this.fullscreen ? 'class=\"%%\"' : 'class=\"%%-wrap edui-dialog-fullscreen-flag\"') + '><div id=\"##_body\" class=\"%%-body\">' +\n\t\t\t\t\t'<div class=\"%%-shadow\"></div>' +\n\t\t\t\t\t'<div id=\"##_titlebar\" class=\"%%-titlebar\">' +\n\t\t\t\t\t'<div class=\"%%-draghandle\" onmousedown=\"$$._onTitlebarMouseDown(event, this);\">' +\n\t\t\t\t\t'<span class=\"%%-caption\">' + (this.title || '') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\tthis.closeButton.renderHtml() +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"##_content\" class=\"%%-content\">' + (this.autoReset ? '' : this.getContentHtml()) + '</div>' +\n\t\t\t\t\tfootHtml +\n\t\t\t\t\t'</div></div></div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\t// todo: 保持居中/记住上次关闭位置选项\n\t\t\t\tif (!this.modalMask.getDom()) {\n\t\t\t\t\tthis.modalMask.render();\n\t\t\t\t\tthis.modalMask.hide();\n\t\t\t\t}\n\t\t\t\tif (!this.dragMask.getDom()) {\n\t\t\t\t\tthis.dragMask.render();\n\t\t\t\t\tthis.dragMask.hide();\n\t\t\t\t}\n\t\t\t\tvar me = this;\n\t\t\t\tthis.addListener('show', function() {\n\t\t\t\t\tme.modalMask.show(this.getDom().style.zIndex - 2);\n\t\t\t\t});\n\t\t\t\tthis.addListener('hide', function() {\n\t\t\t\t\tme.modalMask.hide();\n\t\t\t\t});\n\t\t\t\tif (this.buttons) {\n\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\tthis.buttons[i].postRender();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdomUtils.on(window, 'resize', function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tif (!me.isHidden()) {\n\t\t\t\t\t\t\tme.safeSetOffset(uiUtils.getClientRect(me.getDom()));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\t//hold住scroll事件，防止dialog的滚动影响页面\n\t\t\t\t//            if( this.holdScroll ) {\n\t\t\t\t//\n\t\t\t\t//                if( !me.iframeUrl ) {\n\t\t\t\t//                    domUtils.on( document.getElementById( me.id + \"_iframe\"), !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t//                        domUtils.preventDefault(e);\n\t\t\t\t//                    } );\n\t\t\t\t//                } else {\n\t\t\t\t//                    me.addListener('dialogafterreset', function(){\n\t\t\t\t//                        window.setTimeout(function(){\n\t\t\t\t//                            var iframeWindow = document.getElementById( me.id + \"_iframe\").contentWindow;\n\t\t\t\t//\n\t\t\t\t//                            if( browser.ie ) {\n\t\t\t\t//\n\t\t\t\t//                                var timer = window.setInterval(function(){\n\t\t\t\t//\n\t\t\t\t//                                    if( iframeWindow.document && iframeWindow.document.body ) {\n\t\t\t\t//                                        window.clearInterval( timer );\n\t\t\t\t//                                        timer = null;\n\t\t\t\t//                                        domUtils.on( iframeWindow.document.body, !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t//                                            domUtils.preventDefault(e);\n\t\t\t\t//                                        } );\n\t\t\t\t//                                    }\n\t\t\t\t//\n\t\t\t\t//                                }, 100);\n\t\t\t\t//\n\t\t\t\t//                            } else {\n\t\t\t\t//                                domUtils.on( iframeWindow, !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t//                                    domUtils.preventDefault(e);\n\t\t\t\t//                                } );\n\t\t\t\t//                            }\n\t\t\t\t//\n\t\t\t\t//                        }, 1);\n\t\t\t\t//                    });\n\t\t\t\t//                }\n\t\t\t\t//\n\t\t\t\t//            }\n\t\t\t\tthis._hide();\n\t\t\t},\n\t\t\tmesureSize: function() {\n\t\t\t\tvar body = this.getDom('body');\n\t\t\t\tvar width = uiUtils.getClientRect(this.getDom('content')).width;\n\t\t\t\tvar dialogBodyStyle = body.style;\n\t\t\t\tdialogBodyStyle.width = width;\n\t\t\t\treturn uiUtils.getClientRect(body);\n\t\t\t},\n\t\t\t_onTitlebarMouseDown: function(evt, el) {\n\t\t\t\tif (this.draggable) {\n\t\t\t\t\tvar rect;\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tuiUtils.startDrag(evt, {\n\t\t\t\t\t\tondragstart: function() {\n\t\t\t\t\t\t\trect = uiUtils.getClientRect(me.getDom());\n\t\t\t\t\t\t\tme.getDom('contmask').style.visibility = 'visible';\n\t\t\t\t\t\t\tme.dragMask.show(me.getDom().style.zIndex - 1);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tondragmove: function(x, y) {\n\t\t\t\t\t\t\tvar left = rect.left + x;\n\t\t\t\t\t\t\tvar top = rect.top + y;\n\t\t\t\t\t\t\tme.safeSetOffset({\n\t\t\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\t\t\ttop: top\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tondragstop: function() {\n\t\t\t\t\t\t\tme.getDom('contmask').style.visibility = 'hidden';\n\t\t\t\t\t\t\tdomUtils.removeClasses(me.getDom(), ['edui-state-centered']);\n\t\t\t\t\t\t\tme.dragMask.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\treset: function() {\n\t\t\t\tthis.getDom('content').innerHTML = this.getContentHtml();\n\t\t\t\tthis.fireEvent('dialogafterreset');\n\t\t\t},\n\t\t\t_show: function() {\n\t\t\t\tif (this._hidden) {\n\t\t\t\t\tthis.getDom().style.display = '';\n\n\t\t\t\t\t//要高过编辑器的zindxe\n\t\t\t\t\tthis.editor.container.style.zIndex && (this.getDom().style.zIndex = this.editor.container.style.zIndex * 1 + 10);\n\t\t\t\t\tthis._hidden = false;\n\t\t\t\t\tthis.fireEvent('show');\n\t\t\t\t\tbaidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = this.getDom().style.zIndex - 4;\n\t\t\t\t}\n\t\t\t},\n\t\t\tisHidden: function() {\n\t\t\t\treturn this._hidden;\n\t\t\t},\n\t\t\t_hide: function() {\n\t\t\t\tif (!this._hidden) {\n\t\t\t\t\tvar wrapNode = this.getDom();\n\t\t\t\t\twrapNode.style.display = 'none';\n\t\t\t\t\twrapNode.style.zIndex = '';\n\t\t\t\t\twrapNode.style.width = '';\n\t\t\t\t\twrapNode.style.height = '';\n\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\tif (this.autoReset) {\n\t\t\t\t\t//有可能还没有渲染\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tthis.render();\n\t\t\t\t\t\tthis.open()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.showAtCenter();\n\t\t\t\tif (this.iframeUrl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.getDom('iframe').focus();\n\t\t\t\t\t} catch (ex) {}\n\t\t\t\t}\n\t\t\t\tactiveDialog = this;\n\t\t\t},\n\t\t\t_onCloseButtonClick: function(evt, el) {\n\t\t\t\tthis.close(false);\n\t\t\t},\n\t\t\tclose: function(ok) {\n\t\t\t\tif (this.fireEvent('close', ok) !== false) {\n\t\t\t\t\t//还原环境\n\t\t\t\t\tif (this.fullscreen) {\n\n\t\t\t\t\t\tdocument.documentElement.style.overflowX = this._originalContext.html.overflowX;\n\t\t\t\t\t\tdocument.documentElement.style.overflowY = this._originalContext.html.overflowY;\n\t\t\t\t\t\tdocument.body.style.overflowX = this._originalContext.body.overflowX;\n\t\t\t\t\t\tdocument.body.style.overflowY = this._originalContext.body.overflowY;\n\t\t\t\t\t\tdelete this._originalContext;\n\n\t\t\t\t\t}\n\t\t\t\t\tthis._hide();\n\n\t\t\t\t\t//销毁content\n\t\t\t\t\tvar content = this.getDom('content');\n\t\t\t\t\tvar iframe = this.getDom('iframe');\n\t\t\t\t\tif (content && iframe) {\n\t\t\t\t\t\tvar doc = iframe.contentDocument || iframe.contentWindow.document;\n\t\t\t\t\t\tdoc && (doc.body.innerHTML = '');\n\t\t\t\t\t\tdomUtils.remove(content);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Dialog, UIBase);\n\t})();\n\n\t// ui/menubutton.js\n\t///import core\n\t///import uicore\n\t///import ui/menu.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tMenu = baidu.editor.ui.Menu,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tMenuButton = baidu.editor.ui.MenuButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMenuButton();\n\t\t\t};\n\t\tMenuButton.prototype = {\n\t\t\tinitMenuButton: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.uiName = \"menubutton\";\n\t\t\t\tthis.popup = new Menu({\n\t\t\t\t\titems: me.items,\n\t\t\t\t\tclassName: me.className,\n\t\t\t\t\teditor: me.editor\n\t\t\t\t});\n\t\t\t\tthis.popup.addListener('show', function() {\n\t\t\t\t\tvar list = this;\n\t\t\t\t\tfor (var i = 0; i < list.items.length; i++) {\n\t\t\t\t\t\tlist.items[i].removeState('checked');\n\t\t\t\t\t\tif (list.items[i].value == me._value) {\n\t\t\t\t\t\t\tlist.items[i].addState('checked');\n\t\t\t\t\t\t\tthis.value = me._value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\tsetValue: function(value) {\n\t\t\t\tthis._value = value;\n\t\t\t}\n\n\t\t};\n\t\tutils.inherits(MenuButton, SplitButton);\n\t})();\n\n\t// ui/multiMenu.js\n\t///import core\n\t///import uicore\n\t///commands 表情\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tMultiMenuPop = baidu.editor.ui.MultiMenuPop = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMultiMenu();\n\t\t\t};\n\n\t\tMultiMenuPop.prototype = {\n\t\t\tinitMultiMenu: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tcontent: '',\n\t\t\t\t\teditor: me.editor,\n\t\t\t\t\tiframe_rendered: false,\n\t\t\t\t\tonshow: function() {\n\t\t\t\t\t\t\tif (!this.iframe_rendered) {\n\t\t\t\t\t\t\t\tthis.iframe_rendered = true;\n\t\t\t\t\t\t\t\tthis.getDom('content').innerHTML = '<iframe id=\"' + me.id + '_iframe\" src=\"' + me.iframeUrl + '\" frameborder=\"0\"></iframe>';\n\t\t\t\t\t\t\t\tme.editor.container.style.zIndex && (this.getDom().style.zIndex = me.editor.container.style.zIndex * 1 + 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// canSideUp:false,\n\t\t\t\t\t\t// canSideLeft:false\n\t\t\t\t});\n\t\t\t\tthis.onbuttonclick = function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t};\n\t\t\t\tthis.initSplitButton();\n\t\t\t}\n\n\t\t};\n\n\t\tutils.inherits(MultiMenuPop, SplitButton);\n\t})();\n\n\t// ui/shortcutmenu.js\n\t(function() {\n\t\tvar UI = baidu.editor.ui,\n\t\t\tUIBase = UI.UIBase,\n\t\t\tuiUtils = UI.uiUtils,\n\t\t\tutils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\n\t\tvar allMenus = [], //存储所有快捷菜单\n\t\t\ttimeID,\n\t\t\tisSubMenuShow = false; //是否有子pop显示\n\n\t\tvar ShortCutMenu = UI.ShortCutMenu = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initShortCutMenu();\n\t\t};\n\n\t\tShortCutMenu.postHide = hideAllMenu;\n\n\t\tShortCutMenu.prototype = {\n\t\t\tisHidden: true,\n\t\t\tSPACE: 5,\n\t\t\tinitShortCutMenu: function() {\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.initItems();\n\t\t\t\tthis.initEvent();\n\t\t\t\tallMenus.push(this);\n\t\t\t},\n\t\t\tinitEvent: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tdoc = me.editor.document;\n\n\t\t\t\tdomUtils.on(doc, \"mousemove\", function(e) {\n\t\t\t\t\tif (me.isHidden === false) {\n\t\t\t\t\t\t//有pop显示就不隐藏快捷菜单\n\t\t\t\t\t\tif (me.getSubMenuMark() || me.eventType == \"contextmenu\") return;\n\n\t\t\t\t\t\tvar flag = true,\n\t\t\t\t\t\t\tel = me.getDom(),\n\t\t\t\t\t\t\twt = el.offsetWidth,\n\t\t\t\t\t\t\tht = el.offsetHeight,\n\t\t\t\t\t\t\tdistanceX = wt / 2 + me.SPACE, //距离中心X标准\n\t\t\t\t\t\t\tdistanceY = ht / 2, //距离中心Y标准\n\t\t\t\t\t\t\tx = Math.abs(e.screenX - me.left), //离中心距离横坐标\n\t\t\t\t\t\t\ty = Math.abs(e.screenY - me.top); //离中心距离纵坐标\n\n\t\t\t\t\t\tclearTimeout(timeID);\n\t\t\t\t\t\ttimeID = setTimeout(function() {\n\t\t\t\t\t\t\tif (y > 0 && y < distanceY) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"1\");\n\t\t\t\t\t\t\t} else if (y > distanceY && y < distanceY + 70) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"0.5\");\n\t\t\t\t\t\t\t\tflag = false;\n\t\t\t\t\t\t\t} else if (y > distanceY + 70 && y < distanceY + 140) {\n\t\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (flag && x > 0 && x < distanceX) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"1\")\n\t\t\t\t\t\t\t} else if (x > distanceX && x < distanceX + 70) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"0.5\")\n\t\t\t\t\t\t\t} else if (x > distanceX + 70 && x < distanceX + 140) {\n\t\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t//ie\\ff下 mouseout不准\n\t\t\t\tif (browser.chrome) {\n\t\t\t\t\tdomUtils.on(doc, \"mouseout\", function(e) {\n\t\t\t\t\t\tvar relatedTgt = e.relatedTarget || e.toElement;\n\n\t\t\t\t\t\tif (relatedTgt == null || relatedTgt.tagName == \"HTML\") {\n\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tme.editor.addListener(\"afterhidepop\", function() {\n\t\t\t\t\tif (!me.isHidden) {\n\t\t\t\t\t\tisSubMenuShow = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tinitItems: function() {\n\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\tfor (var i = 0, len = this.items.length; i < len; i++) {\n\t\t\t\t\t\tvar item = this.items[i].toLowerCase();\n\n\t\t\t\t\t\tif (UI[item]) {\n\t\t\t\t\t\t\tthis.items[i] = new UI[item](this.editor);\n\t\t\t\t\t\t\tthis.items[i].className += \" edui-shortcutsubmenu \";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetOpacity: function(el, value) {\n\t\t\t\tif (browser.ie && browser.version < 9) {\n\t\t\t\t\tel.style.filter = \"alpha(opacity = \" + parseFloat(value) * 100 + \");\"\n\t\t\t\t} else {\n\t\t\t\t\tel.style.opacity = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetSubMenuMark: function() {\n\t\t\t\tisSubMenuShow = false;\n\t\t\t\tvar layerEle = uiUtils.getFixedLayer();\n\t\t\t\tvar list = domUtils.getElementsByTagName(layerEle, \"div\", function(node) {\n\t\t\t\t\treturn domUtils.hasClass(node, \"edui-shortcutsubmenu edui-popup\")\n\t\t\t\t});\n\n\t\t\t\tfor (var i = 0, node; node = list[i++];) {\n\t\t\t\t\tif (node.style.display != \"none\") {\n\t\t\t\t\t\tisSubMenuShow = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn isSubMenuShow;\n\t\t\t},\n\t\t\tshow: function(e, hasContextmenu) {\n\t\t\t\tvar me = this,\n\t\t\t\t\toffset = {},\n\t\t\t\t\tel = this.getDom(),\n\t\t\t\t\tfixedlayer = uiUtils.getFixedLayer();\n\n\t\t\t\tfunction setPos(offset) {\n\t\t\t\t\tif (offset.left < 0) {\n\t\t\t\t\t\toffset.left = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (offset.top < 0) {\n\t\t\t\t\t\toffset.top = 0;\n\t\t\t\t\t}\n\t\t\t\t\tel.style.cssText = \"position:absolute;left:\" + offset.left + \"px;top:\" + offset.top + \"px;\";\n\t\t\t\t}\n\n\t\t\t\tfunction setPosByCxtMenu(menu) {\n\t\t\t\t\tif (!menu.tagName) {\n\t\t\t\t\t\tmenu = menu.getDom();\n\t\t\t\t\t}\n\t\t\t\t\toffset.left = parseInt(menu.style.left);\n\t\t\t\t\toffset.top = parseInt(menu.style.top);\n\t\t\t\t\toffset.top -= el.offsetHeight + 15;\n\t\t\t\t\tsetPos(offset);\n\t\t\t\t}\n\n\t\t\t\tme.eventType = e.type;\n\t\t\t\tel.style.cssText = \"display:block;left:-9999px\";\n\n\t\t\t\tif (e.type == \"contextmenu\" && hasContextmenu) {\n\t\t\t\t\tvar menu = domUtils.getElementsByTagName(fixedlayer, \"div\", \"edui-contextmenu\")[0];\n\t\t\t\t\tif (menu) {\n\t\t\t\t\t\tsetPosByCxtMenu(menu)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.editor.addListener(\"aftershowcontextmenu\", function(type, menu) {\n\t\t\t\t\t\t\tsetPosByCxtMenu(menu);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\toffset = uiUtils.getViewportOffsetByEvent(e);\n\t\t\t\t\toffset.top -= el.offsetHeight + me.SPACE;\n\t\t\t\t\toffset.left += me.SPACE + 20;\n\t\t\t\t\tsetPos(offset);\n\t\t\t\t\tme.setOpacity(el, 0.2);\n\t\t\t\t}\n\n\t\t\t\tme.isHidden = false;\n\t\t\t\tme.left = e.screenX + el.offsetWidth / 2 - me.SPACE;\n\t\t\t\tme.top = e.screenY - (el.offsetHeight / 2) - me.SPACE;\n\n\t\t\t\tif (me.editor) {\n\t\t\t\t\tel.style.zIndex = me.editor.container.style.zIndex * 1 + 10;\n\t\t\t\t\tfixedlayer.style.zIndex = el.style.zIndex - 1;\n\t\t\t\t}\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\tif (this.getDom()) {\n\t\t\t\t\tthis.getDom().style.display = \"none\";\n\t\t\t\t}\n\t\t\t\tthis.isHidden = true;\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\tfor (var i = 0, item; item = this.items[i++];) {\n\t\t\t\t\t\titem.postRender();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar buff;\n\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\tbuff = [];\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tbuff[i] = this.items[i].renderHtml();\n\t\t\t\t\t}\n\t\t\t\t\tbuff = buff.join(\"\");\n\t\t\t\t} else {\n\t\t\t\t\tbuff = this.items;\n\t\t\t\t}\n\n\t\t\t\treturn '<div id=\"##\" class=\"%% edui-toolbar\" data-src=\"shortcutmenu\" onmousedown=\"return false;\" onselectstart=\"return false;\" >' +\n\t\t\t\t\tbuff +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t};\n\n\t\tutils.inherits(ShortCutMenu, UIBase);\n\n\t\tfunction hideAllMenu(e) {\n\t\t\tvar tgt = e.target || e.srcElement,\n\t\t\t\tcur = domUtils.findParent(tgt, function(node) {\n\t\t\t\t\treturn domUtils.hasClass(node, \"edui-shortcutmenu\") || domUtils.hasClass(node, \"edui-popup\");\n\t\t\t\t}, true);\n\n\t\t\tif (!cur) {\n\t\t\t\tfor (var i = 0, menu; menu = allMenus[i++];) {\n\t\t\t\t\tmenu.hide()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdomUtils.on(document, 'mousedown', function(e) {\n\t\t\thideAllMenu(e);\n\t\t});\n\n\t\tdomUtils.on(window, 'scroll', function(e) {\n\t\t\thideAllMenu(e);\n\t\t});\n\n\t})();\n\n\t// ui/breakline.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tBreakline = baidu.editor.ui.Breakline = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initSeparator();\n\t\t\t};\n\t\tBreakline.prototype = {\n\t\t\tuiName: 'Breakline',\n\t\t\tinitSeparator: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<br/>';\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Breakline, UIBase);\n\n\t})();\n\n\t// ui/message.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tMessage = baidu.editor.ui.Message = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMessage();\n\t\t\t};\n\n\t\tMessage.prototype = {\n\t\t\tinitMessage: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-message %%\">' +\n\t\t\t\t\t' <div id=\"##_closer\" class=\"edui-message-closer\">×</div>' +\n\t\t\t\t\t' <div id=\"##_body\" class=\"edui-message-body edui-message-type-info\">' +\n\t\t\t\t\t' <iframe style=\"position:absolute;z-index:-1;left:0;top:0;background-color: transparent;\" frameborder=\"0\" width=\"100%\" height=\"100%\" src=\"about:blank\"></iframe>' +\n\t\t\t\t\t' <div class=\"edui-shadow\"></div>' +\n\t\t\t\t\t' <div id=\"##_content\" class=\"edui-message-content\">' +\n\t\t\t\t\t'  </div>' +\n\t\t\t\t\t' </div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\treset: function(opt) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!opt.keepshow) {\n\t\t\t\t\tclearTimeout(this.timer);\n\t\t\t\t\tme.timer = setTimeout(function() {\n\t\t\t\t\t\tme.hide();\n\t\t\t\t\t}, opt.timeout || 4000);\n\t\t\t\t}\n\n\t\t\t\topt.content !== undefined && me.setContent(opt.content);\n\t\t\t\topt.type !== undefined && me.setType(opt.type);\n\n\t\t\t\tme.show();\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tcloser = this.getDom('closer');\n\t\t\t\tcloser && domUtils.on(closer, 'click', function() {\n\t\t\t\t\tme.hide();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetContent: function(content) {\n\t\t\t\tthis.getDom('content').innerHTML = content;\n\t\t\t},\n\t\t\tsetType: function(type) {\n\t\t\t\ttype = type || 'info';\n\t\t\t\tvar body = this.getDom('body');\n\t\t\t\tbody.className = body.className.replace(/edui-message-type-[\\w-]+/, 'edui-message-type-' + type);\n\t\t\t},\n\t\t\tgetContent: function() {\n\t\t\t\treturn this.getDom('content').innerHTML;\n\t\t\t},\n\t\t\tgetType: function() {\n\t\t\t\tvar arr = this.getDom('body').match(/edui-message-type-([\\w-]+)/);\n\t\t\t\treturn arr ? arr[1] : '';\n\t\t\t},\n\t\t\tshow: function() {\n\t\t\t\tthis.getDom().style.display = 'block';\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\tvar dom = this.getDom();\n\t\t\t\tif (dom) {\n\t\t\t\t\tdom.style.display = 'none';\n\t\t\t\t\tdom.parentNode && dom.parentNode.removeChild(dom);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tutils.inherits(Message, UIBase);\n\n\t})();\n\n\t// adapter/editorui.js\n\t//ui跟编辑器的适配層\n\t//那个按钮弹出是dialog，是下拉筐等都是在这个js中配置\n\t//自己写的ui也要在这里配置，放到baidu.editor.ui下边，当编辑器实例化的时候会根据ueditor.config中的toolbars找到相应的进行实例化\n\t(function() {\n\t\tvar utils = baidu.editor.utils;\n\t\tvar editorui = baidu.editor.ui;\n\t\tvar _Dialog = editorui.Dialog;\n\t\teditorui.buttons = {};\n\n\t\teditorui.Dialog = function(options) {\n\t\t\tvar dialog = new _Dialog(options);\n\t\t\tdialog.addListener('hide', function() {\n\n\t\t\t\tif (dialog.editor) {\n\t\t\t\t\tvar editor = dialog.editor;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\tvar y = editor.window.scrollY,\n\t\t\t\t\t\t\t\tx = editor.window.scrollX;\n\t\t\t\t\t\t\teditor.body.focus();\n\t\t\t\t\t\t\teditor.window.scrollTo(x, y);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} catch (ex) {}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn dialog;\n\t\t};\n\n\t\tvar iframeUrlMap = {\n\t\t\t'anchor': '~/dialogs/anchor/anchor.html',\n\t\t\t'insertimage': '~/dialogs/image/image.html',\n\t\t\t'link': '~/dialogs/link/link.html',\n\t\t\t'spechars': '~/dialogs/spechars/spechars.html',\n\t\t\t'searchreplace': '~/dialogs/searchreplace/searchreplace.html',\n\t\t\t'map': '~/dialogs/map/map.html',\n\t\t\t'gmap': '~/dialogs/gmap/gmap.html',\n\t\t\t'insertvideo': '~/dialogs/video/video.html',\n\t\t\t'help': '~/dialogs/help/help.html',\n\t\t\t'preview': '~/dialogs/preview/preview.html',\n\t\t\t'emotion': '~/dialogs/emotion/emotion.html',\n\t\t\t'wordimage': '~/dialogs/wordimage/wordimage.html',\n\t\t\t'attachment': '~/dialogs/attachment/attachment.html',\n\t\t\t'insertframe': '~/dialogs/insertframe/insertframe.html',\n\t\t\t'edittip': '~/dialogs/table/edittip.html',\n\t\t\t'edittable': '~/dialogs/table/edittable.html',\n\t\t\t'edittd': '~/dialogs/table/edittd.html',\n\t\t\t'webapp': '~/dialogs/webapp/webapp.html',\n\t\t\t'snapscreen': '~/dialogs/snapscreen/snapscreen.html',\n\t\t\t'scrawl': '~/dialogs/scrawl/scrawl.html',\n\t\t\t'music': '~/dialogs/music/music.html',\n\t\t\t'template': '~/dialogs/template/template.html',\n\t\t\t'background': '~/dialogs/background/background.html',\n\t\t\t'charts': '~/dialogs/charts/charts.html'\n\t\t};\n\t\t//为工具栏添加按钮，以下都是统一的按钮触发命令，所以写在一起\n\t\tvar btnCmds = ['undo', 'redo', 'formatmatch',\n\t\t\t'bold', 'italic', 'underline', 'fontborder', 'touppercase', 'tolowercase',\n\t\t\t'strikethrough', 'subscript', 'superscript', 'source', 'indent', 'outdent',\n\t\t\t'blockquote', 'pasteplain', 'pagebreak',\n\t\t\t'selectall', 'print', 'horizontal', 'removeformat', 'time', 'date', 'unlink',\n\t\t\t'insertparagraphbeforetable', 'insertrow', 'insertcol', 'mergeright', 'mergedown', 'deleterow',\n\t\t\t'deletecol', 'splittorows', 'splittocols', 'splittocells', 'mergecells', 'deletetable', 'drafts'\n\t\t];\n\n\t\tfor (var i = 0, ci; ci = btnCmds[i++];) {\n\t\t\tci = ci.toLowerCase();\n\t\t\teditorui[ci] = function(cmd) {\n\t\t\t\treturn function(editor) {\n\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd);\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\tshowText: false\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t\tui.setChecked(false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t};\n\t\t\t}(ci);\n\t\t}\n\n\t\t//清除文档\n\t\teditorui.cleardoc = function(editor) {\n\t\t\tvar ui = new editorui.Button({\n\t\t\t\tclassName: 'edui-for-cleardoc',\n\t\t\t\ttitle: editor.options.labelMap.cleardoc || editor.getLang(\"labelMap.cleardoc\") || '',\n\t\t\t\ttheme: editor.options.theme,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tif (confirm(editor.getLang(\"confirmClear\"))) {\n\t\t\t\t\t\teditor.execCommand('cleardoc');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons[\"cleardoc\"] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('cleardoc') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t//排版，图片排版，文字方向\n\t\tvar typeset = {\n\t\t\t'justify': ['left', 'right', 'center', 'justify'],\n\t\t\t'imagefloat': ['none', 'left', 'center', 'right'],\n\t\t\t'directionality': ['ltr', 'rtl']\n\t\t};\n\n\t\tfor (var p in typeset) {\n\n\t\t\t(function(cmd, val) {\n\t\t\t\tfor (var i = 0, ci; ci = val[i++];) {\n\t\t\t\t\t(function(cmd2) {\n\t\t\t\t\t\teditorui[cmd.replace('float', '') + cmd2] = function(editor) {\n\t\t\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd.replace('float', '') + cmd2,\n\t\t\t\t\t\t\t\ttitle: editor.options.labelMap[cmd.replace('float', '') + cmd2] || editor.getLang(\"labelMap.\" + cmd.replace('float', '') + cmd2) || '',\n\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\teditor.execCommand(cmd, cmd2);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1);\n\t\t\t\t\t\t\t\tui.setChecked(editor.queryCommandValue(cmd) == cmd2 && !uiReady);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn ui;\n\t\t\t\t\t\t};\n\t\t\t\t\t})(ci)\n\t\t\t\t}\n\t\t\t})(p, typeset[p])\n\t\t}\n\n\t\t//字体颜色和背景颜色\n\t\tfor (var i = 0, ci; ci = ['backcolor', 'forecolor'][i++];) {\n\t\t\teditorui[ci] = function(cmd) {\n\t\t\t\treturn function(editor) {\n\t\t\t\t\tvar ui = new editorui.ColorButton({\n\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\tcolor: 'default',\n\t\t\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tonpickcolor: function(t, color) {\n\t\t\t\t\t\t\teditor.execCommand(cmd, color);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonpicknocolor: function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd, 'default');\n\t\t\t\t\t\t\tthis.setColor('transparent');\n\t\t\t\t\t\t\tthis.color = 'default';\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd, this.color);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1);\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t};\n\t\t\t}(ci);\n\t\t}\n\n\t\tvar dialogBtns = {\n\t\t\tnoOk: ['searchreplace', 'help', 'spechars', 'webapp', 'preview'],\n\t\t\tok: ['attachment', 'anchor', 'link', 'insertimage', 'map', 'gmap', 'insertframe', 'wordimage',\n\t\t\t\t'insertvideo', 'insertframe', 'edittip', 'edittable', 'edittd', 'scrawl', 'template', 'music', 'background', 'charts'\n\t\t\t]\n\t\t};\n\n\t\tfor (var p in dialogBtns) {\n\t\t\t(function(type, vals) {\n\t\t\t\tfor (var i = 0, ci; ci = vals[i++];) {\n\t\t\t\t\t//todo opera下存在问题\n\t\t\t\t\tif (browser.opera && ci === \"searchreplace\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t(function(cmd) {\n\t\t\t\t\t\teditorui[cmd] = function(editor, iframeUrl, title) {\n\t\t\t\t\t\t\tiframeUrl = iframeUrl || (editor.options.iframeUrlMap || {})[cmd] || iframeUrlMap[cmd];\n\t\t\t\t\t\t\ttitle = editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '';\n\n\t\t\t\t\t\t\tvar dialog;\n\t\t\t\t\t\t\t//没有iframeUrl不创建dialog\n\t\t\t\t\t\t\tif (iframeUrl) {\n\t\t\t\t\t\t\t\tdialog = new editorui.Dialog(utils.extend({\n\t\t\t\t\t\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl),\n\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\t\tholdScroll: cmd === 'insertimage',\n\t\t\t\t\t\t\t\t\tfullscreen: /charts|preview/.test(cmd),\n\t\t\t\t\t\t\t\t\tcloseDialog: editor.getLang(\"closeDialog\")\n\t\t\t\t\t\t\t\t}, type == 'ok' ? {\n\t\t\t\t\t\t\t\t\tbuttons: [{\n\t\t\t\t\t\t\t\t\t\tclassName: 'edui-okbutton',\n\t\t\t\t\t\t\t\t\t\tlabel: editor.getLang(\"ok\"),\n\t\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\t\tdialog.close(true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\t\t\tclassName: 'edui-cancelbutton',\n\t\t\t\t\t\t\t\t\t\tlabel: editor.getLang(\"cancel\"),\n\t\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\t\tdialog.close(false);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t\t\t} : {}));\n\n\t\t\t\t\t\t\t\teditor.ui._dialogs[cmd + \"Dialog\"] = dialog;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\tif (dialog) {\n\t\t\t\t\t\t\t\t\t\tswitch (cmd) {\n\t\t\t\t\t\t\t\t\t\t\tcase \"wordimage\":\n\t\t\t\t\t\t\t\t\t\t\t\tvar images = editor.execCommand(\"wordimage\");\n\t\t\t\t\t\t\t\t\t\t\t\tif (images && images.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tcase \"scrawl\":\n\t\t\t\t\t\t\t\t\t\t\t\tif (editor.queryCommandState(\"scrawl\") != -1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\tdisabled: (cmd == 'scrawl' && editor.queryCommandState(\"scrawl\") == -1) || (cmd == 'charts')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\t\t\t//只存在于右键菜单而无工具栏按钮的ui不需要检测状态\n\t\t\t\t\t\t\t\tvar unNeedCheckState = {\n\t\t\t\t\t\t\t\t\t'edittable': 1\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (cmd in unNeedCheckState) return;\n\n\t\t\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\t\t\tif (ui.getDom()) {\n\t\t\t\t\t\t\t\t\tui.setDisabled(state == -1);\n\t\t\t\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn ui;\n\t\t\t\t\t\t};\n\t\t\t\t\t})(ci.toLowerCase())\n\t\t\t\t}\n\t\t\t})(p, dialogBtns[p]);\n\t\t}\n\n\t\teditorui.snapscreen = function(editor, iframeUrl, title) {\n\t\t\ttitle = editor.options.labelMap['snapscreen'] || editor.getLang(\"labelMap.snapscreen\") || '';\n\t\t\tvar ui = new editorui.Button({\n\t\t\t\tclassName: 'edui-for-snapscreen',\n\t\t\t\ttitle: title,\n\t\t\t\tonclick: function() {\n\t\t\t\t\teditor.execCommand(\"snapscreen\");\n\t\t\t\t},\n\t\t\t\ttheme: editor.options.theme\n\n\t\t\t});\n\t\t\teditorui.buttons['snapscreen'] = ui;\n\t\t\tiframeUrl = iframeUrl || (editor.options.iframeUrlMap || {})[\"snapscreen\"] || iframeUrlMap[\"snapscreen\"];\n\t\t\tif (iframeUrl) {\n\t\t\t\tvar dialog = new editorui.Dialog({\n\t\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl),\n\t\t\t\t\teditor: editor,\n\t\t\t\t\tclassName: 'edui-for-snapscreen',\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tbuttons: [{\n\t\t\t\t\t\tclassName: 'edui-okbutton',\n\t\t\t\t\t\tlabel: editor.getLang(\"ok\"),\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tdialog.close(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tclassName: 'edui-cancelbutton',\n\t\t\t\t\t\tlabel: editor.getLang(\"cancel\"),\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tdialog.close(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\n\t\t\t\t});\n\t\t\t\tdialog.render();\n\t\t\t\teditor.ui._dialogs[\"snapscreenDialog\"] = dialog;\n\t\t\t}\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('snapscreen') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.insertcode = function(editor, list, title) {\n\t\t\tlist = editor.options['insertcode'] || [];\n\t\t\ttitle = editor.options.labelMap['insertcode'] || editor.getLang(\"labelMap.insertcode\") || '';\n\t\t\t// if (!list.length) return;\n\t\t\tvar items = [];\n\t\t\tutils.each(list, function(key, val) {\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: key,\n\t\t\t\t\tvalue: val,\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" >' + (this.label || '') + '</div>';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('insertcode', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-insertcode',\n\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.items[i]; i++) {\n\t\t\t\t\t\t\tif (ci.value.indexOf(value) != -1)\n\t\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['insertcode'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('insertcode');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('insertcode');\n\t\t\t\t\t\tif (!value) {\n\t\t\t\t\t\t\tui.setValue(title);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//trace:1871 ie下从源码模式切换回来时，字体会带单引号，而且会有逗号\n\t\t\t\t\t\tvalue && (value = value.replace(/['\"]/g, '').split(',')[0]);\n\t\t\t\t\t\tui.setValue(value);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\t\teditorui.fontfamily = function(editor, list, title) {\n\n\t\t\tlist = editor.options['fontfamily'] || [];\n\t\t\ttitle = editor.options.labelMap['fontfamily'] || editor.getLang(\"labelMap.fontfamily\") || '';\n\t\t\tif (!list.length) return;\n\t\t\tfor (var i = 0, ci, items = []; ci = list[i]; i++) {\n\t\t\t\tvar langLabel = editor.getLang('fontfamily')[ci.name] || \"\";\n\t\t\t\t(function(key, val) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: key,\n\t\t\t\t\t\tvalue: val,\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" style=\"font-family:' +\n\t\t\t\t\t\t\t\tutils.unhtml(this.value) + '\">' + (this.label || '') + '</div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})(ci.label || langLabel, ci.val)\n\t\t\t}\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('FontFamily', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-fontfamily',\n\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.items[i]; i++) {\n\t\t\t\t\t\t\tif (ci.value.indexOf(value) != -1)\n\t\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['fontfamily'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('FontFamily');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('FontFamily');\n\t\t\t\t\t\t//trace:1871 ie下从源码模式切换回来时，字体会带单引号，而且会有逗号\n\t\t\t\t\t\tvalue && (value = value.replace(/['\"]/g, '').split(',')[0]);\n\t\t\t\t\t\tui.setValue(value);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.fontsize = function(editor, list, title) {\n\t\t\ttitle = editor.options.labelMap['fontsize'] || editor.getLang(\"labelMap.fontsize\") || '';\n\t\t\tlist = list || editor.options['fontsize'] || [];\n\t\t\tif (!list.length) return;\n\t\t\tvar items = [];\n\t\t\tfor (var i = 0; i < list.length; i++) {\n\t\t\t\tvar size = list[i] + 'px';\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: size,\n\t\t\t\t\tvalue: size,\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" style=\"line-height:1;font-size:' +\n\t\t\t\t\t\t\tthis.value + '\">' + (this.label || '') + '</div>';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('FontSize', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\tclassName: 'edui-for-fontsize'\n\t\t\t});\n\t\t\teditorui.buttons['fontsize'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('FontSize');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tui.setValue(editor.queryCommandValue('FontSize'));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.paragraph = function(editor, list, title) {\n\t\t\ttitle = editor.options.labelMap['paragraph'] || editor.getLang(\"labelMap.paragraph\") || '';\n\t\t\tlist = editor.options['paragraph'] || [];\n\t\t\tif (utils.isEmptyObject(list)) return;\n\t\t\tvar items = [];\n\t\t\tfor (var i in list) {\n\t\t\t\titems.push({\n\t\t\t\t\tvalue: i,\n\t\t\t\t\tlabel: list[i] || editor.getLang(\"paragraph\")[i],\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\"><span class=\"edui-for-' + this.value + '\">' + (this.label || '') + '</span></div>';\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-paragraph',\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('Paragraph', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['paragraph'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('Paragraph');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('Paragraph');\n\t\t\t\t\t\tvar index = ui.indexByValue(value);\n\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setValue(ui.initValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t//自定义标题\n\t\teditorui.customstyle = function(editor) {\n\t\t\tvar list = editor.options['customstyle'] || [],\n\t\t\t\ttitle = editor.options.labelMap['customstyle'] || editor.getLang(\"labelMap.customstyle\") || '';\n\t\t\tif (!list.length) return;\n\t\t\tvar langCs = editor.getLang('customstyle');\n\t\t\tfor (var i = 0, items = [], t; t = list[i++];) {\n\t\t\t\t(function(t) {\n\t\t\t\t\tvar ck = {};\n\t\t\t\t\tck.label = t.label ? t.label : langCs[t.name];\n\t\t\t\t\tck.style = t.style;\n\t\t\t\t\tck.className = t.className;\n\t\t\t\t\tck.tag = t.tag;\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: ck.label,\n\t\t\t\t\t\tvalue: ck,\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\">' + '<' + ck.tag + ' ' + (ck.className ? ' class=\"' + ck.className + '\"' : \"\") + (ck.style ? ' style=\"' + ck.style + '\"' : \"\") + '>' + ck.label + \"<\\/\" + ck.tag + \">\" + '</div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})(t);\n\t\t\t}\n\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-customstyle',\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('customstyle', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\tfor (var i = 0, ti; ti = this.items[i++];) {\n\t\t\t\t\t\tif (ti.label == value) {\n\t\t\t\t\t\t\treturn i - 1\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['customstyle'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('customstyle');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('customstyle');\n\t\t\t\t\t\tvar index = ui.indexByValue(value);\n\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setValue(ui.initValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\t\teditorui.inserttable = function(editor, iframeUrl, title) {\n\t\t\ttitle = editor.options.labelMap['inserttable'] || editor.getLang(\"labelMap.inserttable\") || '';\n\t\t\tvar ui = new editorui.TableButton({\n\t\t\t\teditor: editor,\n\t\t\t\ttitle: title,\n\t\t\t\tclassName: 'edui-for-inserttable',\n\t\t\t\tonpicktable: function(t, numCols, numRows) {\n\t\t\t\t\teditor.execCommand('InsertTable', {\n\t\t\t\t\t\tnumRows: numRows,\n\t\t\t\t\t\tnumCols: numCols,\n\t\t\t\t\t\tborder: 1\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['inserttable'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('inserttable') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.lineheight = function(editor) {\n\t\t\tvar val = editor.options.lineheight || [];\n\t\t\tif (!val.length) return;\n\t\t\tfor (var i = 0, ci, items = []; ci = val[i++];) {\n\t\t\t\titems.push({\n\t\t\t\t\t//todo:写死了\n\t\t\t\t\tlabel: ci,\n\t\t\t\t\tvalue: ci,\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\teditor.execCommand(\"lineheight\", this.value);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\teditor: editor,\n\t\t\t\tclassName: 'edui-for-lineheight',\n\t\t\t\ttitle: editor.options.labelMap['lineheight'] || editor.getLang(\"labelMap.lineheight\") || '',\n\t\t\t\titems: items,\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tvar value = editor.queryCommandValue('LineHeight') || this.value;\n\t\t\t\t\teditor.execCommand(\"LineHeight\", value);\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['lineheight'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tvar state = editor.queryCommandState('LineHeight');\n\t\t\t\tif (state == -1) {\n\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t} else {\n\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\tvar value = editor.queryCommandValue('LineHeight');\n\t\t\t\t\tvalue && ui.setValue((value + '').replace(/cm/, ''));\n\t\t\t\t\tui.setChecked(state)\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\tvar rowspacings = ['top', 'bottom'];\n\t\tfor (var r = 0, ri; ri = rowspacings[r++];) {\n\t\t\t(function(cmd) {\n\t\t\t\teditorui['rowspacing' + cmd] = function(editor) {\n\t\t\t\t\tvar val = editor.options['rowspacing' + cmd] || [];\n\t\t\t\t\tif (!val.length) return null;\n\t\t\t\t\tfor (var i = 0, ci, items = []; ci = val[i++];) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tlabel: ci,\n\t\t\t\t\t\t\tvalue: ci,\n\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\teditor.execCommand(\"rowspacing\", this.value, cmd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tclassName: 'edui-for-rowspacing' + cmd,\n\t\t\t\t\t\ttitle: editor.options.labelMap['rowspacing' + cmd] || editor.getLang(\"labelMap.rowspacing\" + cmd) || '',\n\t\t\t\t\t\titems: items,\n\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('rowspacing', cmd) || this.value;\n\t\t\t\t\t\t\teditor.execCommand(\"rowspacing\", value, cmd);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\tvar state = editor.queryCommandState('rowspacing', cmd);\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('rowspacing', cmd);\n\t\t\t\t\t\t\tvalue && ui.setValue((value + '').replace(/%/, ''));\n\t\t\t\t\t\t\tui.setChecked(state)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t}\n\t\t\t})(ri)\n\t\t}\n\t\t//有序，无序列表\n\t\tvar lists = ['insertorderedlist', 'insertunorderedlist'];\n\t\tfor (var l = 0, cl; cl = lists[l++];) {\n\t\t\t(function(cmd) {\n\t\t\t\teditorui[cmd] = function(editor) {\n\t\t\t\t\tvar vals = editor.options[cmd],\n\t\t\t\t\t\t_onMenuClick = function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd, this.value);\n\t\t\t\t\t\t},\n\t\t\t\t\t\titems = [];\n\t\t\t\t\tfor (var i in vals) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tlabel: vals[i] || editor.getLang()[cmd][i] || \"\",\n\t\t\t\t\t\t\tvalue: i,\n\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\tonclick: _onMenuClick\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\ttitle: editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\t'items': items,\n\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue(cmd) || this.value;\n\t\t\t\t\t\t\teditor.execCommand(cmd, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue(cmd);\n\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t\tui.setChecked(state)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t};\n\t\t\t})(cl)\n\t\t}\n\n\t\teditorui.fullscreen = function(editor, title) {\n\t\t\ttitle = editor.options.labelMap['fullscreen'] || editor.getLang(\"labelMap.fullscreen\") || '';\n\t\t\tvar ui = new editorui.Button({\n\t\t\t\tclassName: 'edui-for-fullscreen',\n\t\t\t\ttitle: title,\n\t\t\t\ttheme: editor.options.theme,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tif (editor.ui) {\n\t\t\t\t\t\teditor.ui.setFullScreen(!editor.ui.isFullScreen());\n\t\t\t\t\t}\n\t\t\t\t\tthis.setChecked(editor.ui.isFullScreen());\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['fullscreen'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tvar state = editor.queryCommandState('fullscreen');\n\t\t\t\tui.setDisabled(state == -1);\n\t\t\t\tui.setChecked(editor.ui.isFullScreen());\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t// 表情\n\t\teditorui[\"emotion\"] = function(editor, iframeUrl) {\n\t\t\tvar cmd = \"emotion\";\n\t\t\tvar ui = new editorui.MultiMenuPop({\n\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd + \"\") || '',\n\t\t\t\teditor: editor,\n\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl || (editor.options.iframeUrlMap || {})[cmd] || iframeUrlMap[cmd])\n\t\t\t});\n\t\t\teditorui.buttons[cmd] = ui;\n\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1)\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.autotypeset = function(editor) {\n\t\t\tvar ui = new editorui.AutoTypeSetButton({\n\t\t\t\teditor: editor,\n\t\t\t\ttitle: editor.options.labelMap['autotypeset'] || editor.getLang(\"labelMap.autotypeset\") || '',\n\t\t\t\tclassName: 'edui-for-autotypeset',\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\teditor.execCommand('autotypeset')\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['autotypeset'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('autotypeset') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t/* 简单上传插件 */\n\t\teditorui[\"simpleupload\"] = function(editor) {\n\t\t\tvar name = 'simpleupload',\n\t\t\t\tui = new editorui.Button({\n\t\t\t\t\tclassName: 'edui-for-' + name,\n\t\t\t\t\ttitle: editor.options.labelMap[name] || editor.getLang(\"labelMap.\" + name) || '',\n\t\t\t\t\tonclick: function() {},\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\tshowText: false\n\t\t\t\t});\n\t\t\teditorui.buttons[name] = ui;\n\t\t\teditor.addListener('ready', function() {\n\t\t\t\tvar b = ui.getDom('body'),\n\t\t\t\t\ticonSpan = b.children[0];\n\t\t\t\teditor.fireEvent('simpleuploadbtnready', iconSpan);\n\t\t\t});\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tvar state = editor.queryCommandState(name);\n\t\t\t\tif (state == -1) {\n\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\tui.setChecked(false);\n\t\t\t\t} else {\n\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t})();\n\n\t// adapter/editor.js\n\t///import core\n\t///commands 全屏\n\t///commandsName FullScreen\n\t///commandsTitle  全屏\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\t\tvar nodeStack = [];\n\n\t\tfunction EditorUI(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initEditorUI();\n\t\t}\n\n\t\tEditorUI.prototype = {\n\t\t\tuiName: 'editor',\n\t\t\tinitEditorUI: function() {\n\t\t\t\tthis.editor.ui = this;\n\t\t\t\tthis._dialogs = {};\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis._initToolbars();\n\t\t\t\tvar editor = this.editor,\n\t\t\t\t\tme = this;\n\n\t\t\t\teditor.addListener('ready', function() {\n\t\t\t\t\t//提供getDialog方法\n\t\t\t\t\teditor.getDialog = function(name) {\n\t\t\t\t\t\treturn editor.ui._dialogs[name + \"Dialog\"];\n\t\t\t\t\t};\n\t\t\t\t\tdomUtils.on(editor.window, 'scroll', function(evt) {\n\t\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt);\n\t\t\t\t\t});\n\t\t\t\t\t//提供编辑器实时宽高(全屏时宽高不变化)\n\t\t\t\t\teditor.ui._actualFrameWidth = editor.options.initialFrameWidth;\n\n\t\t\t\t\tUE.browser.ie && UE.browser.version === 6 && editor.container.ownerDocument.execCommand(\"BackgroundImageCache\", false, true);\n\n\t\t\t\t\t//display bottom-bar label based on config\n\t\t\t\t\tif (editor.options.elementPathEnabled) {\n\t\t\t\t\t\teditor.ui.getDom('elementpath').innerHTML = '<div class=\"edui-editor-breadcrumb\">' + editor.getLang(\"elementPathTip\") + ':</div>';\n\t\t\t\t\t}\n\t\t\t\t\tif (editor.options.wordCount) {\n\t\t\t\t\t\tfunction countFn() {\n\t\t\t\t\t\t\tsetCount(editor, me);\n\t\t\t\t\t\t\tdomUtils.un(editor.document, \"click\", arguments.callee);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.on(editor.document, \"click\", countFn);\n\t\t\t\t\t\teditor.ui.getDom('wordcount').innerHTML = editor.getLang(\"wordCountTip\");\n\t\t\t\t\t}\n\t\t\t\t\teditor.ui._scale();\n\t\t\t\t\tif (editor.options.scaleEnabled) {\n\t\t\t\t\t\tif (editor.autoHeightEnabled) {\n\t\t\t\t\t\t\teditor.disableAutoHeight();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.enableScale();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.disableScale();\n\t\t\t\t\t}\n\t\t\t\t\tif (!editor.options.elementPathEnabled && !editor.options.wordCount && !editor.options.scaleEnabled) {\n\t\t\t\t\t\teditor.ui.getDom('elementpath').style.display = \"none\";\n\t\t\t\t\t\teditor.ui.getDom('wordcount').style.display = \"none\";\n\t\t\t\t\t\teditor.ui.getDom('scale').style.display = \"none\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!editor.selection.isFocus()) return;\n\t\t\t\t\teditor.fireEvent('selectionchange', false, true);\n\n\t\t\t\t});\n\n\t\t\t\teditor.addListener('mousedown', function(t, evt) {\n\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt, el);\n\t\t\t\t\tbaidu.editor.ui.ShortCutMenu.postHide(evt);\n\n\t\t\t\t});\n\t\t\t\teditor.addListener(\"delcells\", function() {\n\t\t\t\t\tif (UE.ui['edittip']) {\n\t\t\t\t\t\tnew UE.ui['edittip'](editor);\n\t\t\t\t\t}\n\t\t\t\t\teditor.getDialog('edittip').open();\n\t\t\t\t});\n\n\t\t\t\tvar pastePop, isPaste = false,\n\t\t\t\t\ttimer;\n\t\t\t\teditor.addListener(\"afterpaste\", function() {\n\t\t\t\t\tif (editor.queryCommandState('pasteplain'))\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (baidu.editor.ui.PastePicker) {\n\t\t\t\t\t\tpastePop = new baidu.editor.ui.Popup({\n\t\t\t\t\t\t\tcontent: new baidu.editor.ui.PastePicker({\n\t\t\t\t\t\t\t\teditor: editor\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\tclassName: 'edui-wordpastepop'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tpastePop.render();\n\t\t\t\t\t}\n\t\t\t\t\tisPaste = true;\n\t\t\t\t});\n\n\t\t\t\teditor.addListener(\"afterinserthtml\", function() {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\tif (pastePop && (isPaste || editor.ui._isTransfer)) {\n\t\t\t\t\t\t\tif (pastePop.isHidden()) {\n\t\t\t\t\t\t\t\tvar span = domUtils.createElement(editor.document, 'span', {\n\t\t\t\t\t\t\t\t\t\t'style': \"line-height:0px;\",\n\t\t\t\t\t\t\t\t\t\t'innerHTML': '\\ufeff'\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\trange = editor.selection.getRange();\n\t\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\t\tvar tmp = getDomNode(span, 'firstChild', 'previousSibling');\n\t\t\t\t\t\t\t\ttmp && pastePop.showAnchor(tmp.nodeType == 3 ? tmp.parentNode : tmp);\n\t\t\t\t\t\t\t\tdomUtils.remove(span);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpastePop.show();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelete editor.ui._isTransfer;\n\t\t\t\t\t\t\tisPaste = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 200)\n\t\t\t\t});\n\t\t\t\teditor.addListener('contextmenu', function(t, evt) {\n\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt);\n\t\t\t\t});\n\t\t\t\teditor.addListener('keydown', function(t, evt) {\n\t\t\t\t\tif (pastePop) pastePop.dispose(evt);\n\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\t\tif (evt.altKey && keyCode == 90) {\n\t\t\t\t\t\tUE.ui.buttons['fullscreen'].onclick();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditor.addListener('wordcount', function(type) {\n\t\t\t\t\tsetCount(this, me);\n\t\t\t\t});\n\n\t\t\t\tfunction setCount(editor, ui) {\n\t\t\t\t\teditor.setOpt({\n\t\t\t\t\t\twordCount: true,\n\t\t\t\t\t\tmaximumWords: 10000,\n\t\t\t\t\t\twordCountMsg: editor.options.wordCountMsg || editor.getLang(\"wordCountMsg\"),\n\t\t\t\t\t\twordOverFlowMsg: editor.options.wordOverFlowMsg || editor.getLang(\"wordOverFlowMsg\")\n\t\t\t\t\t});\n\t\t\t\t\tvar opt = editor.options,\n\t\t\t\t\t\tmax = opt.maximumWords,\n\t\t\t\t\t\tmsg = opt.wordCountMsg,\n\t\t\t\t\t\terrMsg = opt.wordOverFlowMsg,\n\t\t\t\t\t\tcountDom = ui.getDom('wordcount');\n\t\t\t\t\tif (!opt.wordCount) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar count = editor.getContentLength(true);\n\t\t\t\t\tif (count > max) {\n\t\t\t\t\t\tcountDom.innerHTML = errMsg;\n\t\t\t\t\t\teditor.fireEvent(\"wordcountoverflow\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcountDom.innerHTML = msg.replace(\"{#leave}\", max - count).replace(\"{#count}\", count);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tif (editor.options.elementPathEnabled) {\n\t\t\t\t\t\tme[(editor.queryCommandState('elementpath') == -1 ? 'dis' : 'en') + 'ableElementPath']()\n\t\t\t\t\t}\n\t\t\t\t\tif (editor.options.scaleEnabled) {\n\t\t\t\t\t\tme[(editor.queryCommandState('scale') == -1 ? 'dis' : 'en') + 'ableScale']();\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar popup = new baidu.editor.ui.Popup({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\tcontent: '',\n\t\t\t\t\tclassName: 'edui-bubble',\n\t\t\t\t\t_onEditButtonClick: function() {\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\teditor.ui._dialogs.linkDialog.open();\n\t\t\t\t\t},\n\t\t\t\t\t_onImgEditButtonClick: function(name) {\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\teditor.ui._dialogs[name] && editor.ui._dialogs[name].open();\n\n\t\t\t\t\t},\n\t\t\t\t\t_onImgSetFloat: function(value) {\n\t\t\t\t\t\tconsole.log(this)\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\teditor.execCommand(\"imagefloat\", value);\n\n\t\t\t\t\t},\n\t\t\t\t\t_setIframeAlign: function(value) {\n\t\t\t\t\t\tvar frame = popup.anchorEl;\n\t\t\t\t\t\tvar newFrame = frame.cloneNode(true);\n\t\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\t\tcase -2:\n\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase -1:\n\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"left\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"right\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tframe.parentNode.insertBefore(newFrame, frame);\n\t\t\t\t\t\tdomUtils.remove(frame);\n\t\t\t\t\t\tpopup.anchorEl = newFrame;\n\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t},\n\t\t\t\t\t_updateIframe: function() {\n\t\t\t\t\t\tvar frame = editor._iframe = popup.anchorEl;\n\t\t\t\t\t\tif (domUtils.hasClass(frame, 'ueditor_baidumap')) {\n\t\t\t\t\t\t\teditor.selection.getRange().selectNode(frame).select();\n\t\t\t\t\t\t\teditor.ui._dialogs.mapDialog.open();\n\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\teditor.ui._dialogs.insertframeDialog.open();\n\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t_onRemoveButtonClick: function(cmdName) {\n\t\t\t\t\t\teditor.execCommand(cmdName);\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t},\n\t\t\t\t\tqueryAutoHide: function(el) {\n\t\t\t\t\t\tif (el && el.ownerDocument == editor.document) {\n\t\t\t\t\t\t\tif (el.tagName.toLowerCase() == 'img' || domUtils.findParentByTagName(el, 'a', true)) {\n\t\t\t\t\t\t\t\treturn el !== popup.anchorEl;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn baidu.editor.ui.Popup.prototype.queryAutoHide.call(this, el);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpopup.render();\n\t\t\t\tif (editor.options.imagePopup) {\n\t\t\t\t\teditor.addListener('mouseover', function(t, evt) {\n\t\t\t\t\t\tevt = evt || window.event;\n\t\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\t\tif (editor.ui._dialogs.insertframeDialog && /iframe/ig.test(el.tagName)) {\n\t\t\t\t\t\t\tvar html = popup.formatHtml(\n\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"property\") + ': <span onclick=$$._setIframeAlign(-2) class=\"edui-clickable\">' + editor.getLang(\"default\") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class=\"edui-clickable\">' + editor.getLang(\"justifyleft\") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class=\"edui-clickable\">' + editor.getLang(\"justifyright\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t' <span onclick=\"$$._updateIframe( this);\" class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span></nobr>');\n\t\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\t\tpopup.getDom('content').innerHTML = html;\n\t\t\t\t\t\t\t\tpopup.anchorEl = el;\n\t\t\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditor.addListener('selectionchange', function(t, causeByUi) {\n\t\t\t\t\t\tif (!causeByUi) return;\n\t\t\t\t\t\tvar html = '',\n\t\t\t\t\t\t\tstr = \"\",\n\t\t\t\t\t\t\timg = editor.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\tdialogs = editor.ui._dialogs;\n\t\t\t\t\t\tif (img && img.tagName == 'IMG') {\n\t\t\t\t\t\t\tvar dialogName = 'insertimageDialog';\n\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-video\") != -1 || img.className.indexOf(\"edui-upload-video\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"insertvideoDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-webapp\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"webappDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.src.indexOf(\"http://api.map.baidu.com\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"mapDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-music\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"musicDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.src.indexOf(\"http://maps.google.com/maps/api/staticmap\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"gmapDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.getAttribute(\"anchorname\")) {\n\t\t\t\t\t\t\t\tdialogName = \"anchorDialog\";\n\t\t\t\t\t\t\t\thtml = popup.formatHtml(\n\t\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"property\") + ': <span onclick=$$._onImgEditButtonClick(\"anchorDialog\") class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t'<span onclick=$$._onRemoveButtonClick(\\'anchor\\') class=\"edui-clickable\">' + editor.getLang(\"delete\") + '</span></nobr>');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.getAttribute(\"word_img\")) {\n\t\t\t\t\t\t\t\t//todo 放到dialog去做查询\n\t\t\t\t\t\t\t\teditor.word_img = [img.getAttribute(\"word_img\")];\n\t\t\t\t\t\t\t\tdialogName = \"wordimageDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.hasClass(img, 'loadingclass') || domUtils.hasClass(img, 'loaderrorclass')) {\n\t\t\t\t\t\t\t\tdialogName = \"\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!dialogs[dialogName]) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstr = '<nobr>' + editor.getLang(\"property\") + ': ' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"none\") class=\"edui-clickable ssss\">' + editor.getLang(\"default\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"left\") class=\"edui-clickable\">' + editor.getLang(\"justifyleft\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"right\") class=\"edui-clickable\">' + editor.getLang(\"justifyright\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"center\") class=\"edui-clickable\">' + editor.getLang(\"justifycenter\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=\"$$._onImgEditButtonClick(\\'' + dialogName + '\\');\" class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span></nobr>';\n\n\t\t\t\t\t\t\t!html && (html = popup.formatHtml(str))\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (editor.ui._dialogs.linkDialog) {\n\t\t\t\t\t\t\tvar link = editor.queryCommandValue('link');\n\t\t\t\t\t\t\tvar url;\n\t\t\t\t\t\t\tif (link && (url = (link.getAttribute('_href') || link.getAttribute('href', 2)))) {\n\t\t\t\t\t\t\t\tvar txt = url;\n\t\t\t\t\t\t\t\tif (url.length > 30) {\n\t\t\t\t\t\t\t\t\ttxt = url.substring(0, 20) + \"...\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\t\t\thtml += '<div style=\"height:5px;\"></div>'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thtml += popup.formatHtml(\n\t\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"anthorMsg\") + ': <a target=\"_blank\" href=\"' + url + '\" title=\"' + url + '\" >' + txt + '</a>' +\n\t\t\t\t\t\t\t\t\t' <span class=\"edui-clickable\" onclick=\"$$._onEditButtonClick();\">' + editor.getLang(\"modify\") + '</span>' +\n\t\t\t\t\t\t\t\t\t' <span class=\"edui-clickable\" onclick=\"$$._onRemoveButtonClick(\\'unlink\\');\"> ' + editor.getLang(\"clear\") + '</span></nobr>');\n\t\t\t\t\t\t\t\tpopup.showAnchor(link);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\tpopup.getDom('content').innerHTML = html;\n\t\t\t\t\t\t\tpopup.anchorEl = img || link;\n\t\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t_initToolbars: function() {\n\t\t\t\tvar editor = this.editor;\n\t\t\t\tvar toolbars = this.toolbars || [];\n\t\t\t\tvar toolbarUis = [];\n\t\t\t\tfor (var i = 0; i < toolbars.length; i++) {\n\t\t\t\t\tvar toolbar = toolbars[i];\n\t\t\t\t\tvar toolbarUi = new baidu.editor.ui.Toolbar({\n\t\t\t\t\t\ttheme: editor.options.theme\n\t\t\t\t\t});\n\t\t\t\t\tfor (var j = 0; j < toolbar.length; j++) {\n\t\t\t\t\t\tvar toolbarItem = toolbar[j];\n\t\t\t\t\t\tvar toolbarItemUi = null;\n\t\t\t\t\t\tif (typeof toolbarItem == 'string') {\n\t\t\t\t\t\t\ttoolbarItem = toolbarItem.toLowerCase();\n\t\t\t\t\t\t\tif (toolbarItem == '|') {\n\t\t\t\t\t\t\t\ttoolbarItem = 'Separator';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (toolbarItem == '||') {\n\t\t\t\t\t\t\t\ttoolbarItem = 'Breakline';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (baidu.editor.ui[toolbarItem]) {\n\t\t\t\t\t\t\t\ttoolbarItemUi = new baidu.editor.ui[toolbarItem](editor);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//fullscreen这里单独处理一下，放到首行去\n\t\t\t\t\t\t\tif (toolbarItem == 'fullscreen') {\n\t\t\t\t\t\t\t\tif (toolbarUis && toolbarUis[0]) {\n\t\t\t\t\t\t\t\t\ttoolbarUis[0].items.splice(0, 0, toolbarItemUi);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttoolbarItemUi && toolbarUi.items.splice(0, 0, toolbarItemUi);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoolbarItemUi = toolbarItem;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (toolbarItemUi && toolbarItemUi.id) {\n\n\t\t\t\t\t\t\ttoolbarUi.add(toolbarItemUi);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttoolbarUis[i] = toolbarUi;\n\t\t\t\t}\n\n\t\t\t\t//接受外部定制的UI\n\n\t\t\t\tutils.each(UE._customizeUI, function(obj, key) {\n\t\t\t\t\tvar itemUI, index;\n\t\t\t\t\tif (obj.id && obj.id != editor.key) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\titemUI = obj.execFn.call(editor, editor, key);\n\t\t\t\t\tif (itemUI) {\n\t\t\t\t\t\tindex = obj.index;\n\t\t\t\t\t\tif (index === undefined) {\n\t\t\t\t\t\t\tindex = toolbarUi.items.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttoolbarUi.add(itemUI, index)\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.toolbars = toolbarUis;\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"%%\">' +\n\t\t\t\t\t'<div id=\"##_toolbarbox\" class=\"%%-toolbarbox\">' +\n\t\t\t\t\t(this.toolbars.length ?\n\t\t\t\t\t\t'<div id=\"##_toolbarboxouter\" class=\"%%-toolbarboxouter\"><div class=\"%%-toolbarboxinner\">' +\n\t\t\t\t\t\tthis.renderToolbarBoxHtml() +\n\t\t\t\t\t\t'</div></div>' : '') +\n\t\t\t\t\t'<div id=\"##_toolbarmsg\" class=\"%%-toolbarmsg\" style=\"display:none;\">' +\n\t\t\t\t\t'<div id = \"##_upload_dialog\" class=\"%%-toolbarmsg-upload\" onclick=\"$$.showWordImageDialog();\">' + this.editor.getLang(\"clickToUpload\") + '</div>' +\n\t\t\t\t\t'<div class=\"%%-toolbarmsg-close\" onclick=\"$$.hideToolbarMsg();\">x</div>' +\n\t\t\t\t\t'<div id=\"##_toolbarmsg_label\" class=\"%%-toolbarmsg-label\"></div>' +\n\t\t\t\t\t'<div style=\"height:0;overflow:hidden;clear:both;\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"##_message_holder\" class=\"%%-messageholder\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"##_iframeholder\" class=\"%%-iframeholder\">' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t//modify wdcount by matao\n\t\t\t\t\t'<div id=\"##_bottombar\" class=\"%%-bottomContainer\"><table><tr>' +\n\t\t\t\t\t'<td id=\"##_elementpath\" class=\"%%-bottombar\"></td>' +\n\t\t\t\t\t'<td id=\"##_wordcount\" class=\"%%-wordcount\"></td>' +\n\t\t\t\t\t'<td id=\"##_scale\" class=\"%%-scale\"><div class=\"%%-icon\"></div></td>' +\n\t\t\t\t\t'</tr></table></div>' +\n\t\t\t\t\t'<div id=\"##_scalelayer\"></div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tshowWordImageDialog: function() {\n\t\t\t\tthis._dialogs['wordimageDialog'].open();\n\t\t\t},\n\t\t\trenderToolbarBoxHtml: function() {\n\t\t\t\tvar buff = [];\n\t\t\t\tfor (var i = 0; i < this.toolbars.length; i++) {\n\t\t\t\t\tbuff.push(this.toolbars[i].renderHtml());\n\t\t\t\t}\n\t\t\t\treturn buff.join('');\n\t\t\t},\n\t\t\tsetFullScreen: function(fullscreen) {\n\n\t\t\t\tvar editor = this.editor,\n\t\t\t\t\tcontainer = editor.container.parentNode.parentNode;\n\t\t\t\tif (this._fullscreen != fullscreen) {\n\t\t\t\t\tthis._fullscreen = fullscreen;\n\t\t\t\t\tthis.editor.fireEvent('beforefullscreenchange', fullscreen);\n\t\t\t\t\tif (baidu.editor.browser.gecko) {\n\t\t\t\t\t\tvar bk = editor.selection.getRange().createBookmark();\n\t\t\t\t\t}\n\t\t\t\t\tif (fullscreen) {\n\t\t\t\t\t\twhile (container.tagName != \"BODY\") {\n\t\t\t\t\t\t\tvar position = baidu.editor.dom.domUtils.getComputedStyle(container, \"position\");\n\t\t\t\t\t\t\tnodeStack.push(position);\n\t\t\t\t\t\t\tcontainer.style.position = \"static\";\n\t\t\t\t\t\t\tcontainer = container.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._bakHtmlOverflow = document.documentElement.style.overflow;\n\t\t\t\t\t\tthis._bakBodyOverflow = document.body.style.overflow;\n\t\t\t\t\t\tthis._bakAutoHeight = this.editor.autoHeightEnabled;\n\t\t\t\t\t\tthis._bakScrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);\n\n\t\t\t\t\t\tthis._bakEditorContaninerWidth = editor.iframe.parentNode.offsetWidth;\n\t\t\t\t\t\tif (this._bakAutoHeight) {\n\t\t\t\t\t\t\t//当全屏时不能执行自动长高\n\t\t\t\t\t\t\teditor.autoHeightEnabled = false;\n\t\t\t\t\t\t\tthis.editor.disableAutoHeight();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.documentElement.style.overflow = 'hidden';\n\t\t\t\t\t\t//修复，滚动条不收起的问题\n\n\t\t\t\t\t\twindow.scrollTo(0, window.scrollY);\n\t\t\t\t\t\tthis._bakCssText = this.getDom().style.cssText;\n\t\t\t\t\t\tthis._bakCssText1 = this.getDom('iframeholder').style.cssText;\n\t\t\t\t\t\teditor.iframe.parentNode.style.width = '';\n\t\t\t\t\t\tthis._updateFullScreen();\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (container.tagName != \"BODY\") {\n\t\t\t\t\t\t\tcontainer.style.position = nodeStack.shift();\n\t\t\t\t\t\t\tcontainer = container.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.getDom().style.cssText = this._bakCssText;\n\t\t\t\t\t\tthis.getDom('iframeholder').style.cssText = this._bakCssText1;\n\t\t\t\t\t\tif (this._bakAutoHeight) {\n\t\t\t\t\t\t\teditor.autoHeightEnabled = true;\n\t\t\t\t\t\t\tthis.editor.enableAutoHeight();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.documentElement.style.overflow = this._bakHtmlOverflow;\n\t\t\t\t\t\tdocument.body.style.overflow = this._bakBodyOverflow;\n\t\t\t\t\t\teditor.iframe.parentNode.style.width = this._bakEditorContaninerWidth + 'px';\n\t\t\t\t\t\twindow.scrollTo(0, this._bakScrollTop);\n\t\t\t\t\t}\n\t\t\t\t\tif (browser.gecko && editor.body.contentEditable === 'true') {\n\t\t\t\t\t\tvar input = document.createElement('input');\n\t\t\t\t\t\tdocument.body.appendChild(input);\n\t\t\t\t\t\teditor.body.contentEditable = false;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\teditor.body.contentEditable = true;\n\t\t\t\t\t\t\t\teditor.fireEvent('fullscreenchanged', fullscreen);\n\t\t\t\t\t\t\t\teditor.selection.getRange().moveToBookmark(bk).select(true);\n\t\t\t\t\t\t\t\tbaidu.editor.dom.domUtils.remove(input);\n\t\t\t\t\t\t\t\tfullscreen && window.scroll(0, 0);\n\t\t\t\t\t\t\t}, 0)\n\t\t\t\t\t\t}, 0)\n\t\t\t\t\t}\n\n\t\t\t\t\tif (editor.body.contentEditable === 'true') {\n\t\t\t\t\t\tthis.editor.fireEvent('fullscreenchanged', fullscreen);\n\t\t\t\t\t\tthis.triggerLayout();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\t_updateFullScreen: function() {\n\t\t\t\tif (this._fullscreen) {\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\tthis.getDom().style.cssText = 'border:0;position:absolute;left:0;top:' + (this.editor.options.topOffset || 0) + 'px;width:' + vpRect.width + 'px;height:' + vpRect.height + 'px;z-index:' + (this.getDom().style.zIndex * 1 + 100);\n\t\t\t\t\tuiUtils.setViewportOffset(this.getDom(), {\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\ttop: this.editor.options.topOffset || 0\n\t\t\t\t\t});\n\t\t\t\t\tthis.editor.setHeight(vpRect.height - this.getDom('toolbarbox').offsetHeight - this.getDom('bottombar').offsetHeight - (this.editor.options.topOffset || 0), true);\n\t\t\t\t\t//不手动调一下，会导致全屏失效\n\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\twindow.onresize();\n\t\t\t\t\t\t} catch (e) {\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t_updateElementPath: function() {\n\t\t\t\tvar bottom = this.getDom('elementpath'),\n\t\t\t\t\tlist;\n\t\t\t\tif (this.elementPathEnabled && (list = this.editor.queryCommandValue('elementpath'))) {\n\n\t\t\t\t\tvar buff = [];\n\t\t\t\t\tfor (var i = 0, ci; ci = list[i]; i++) {\n\t\t\t\t\t\tbuff[i] = this.formatHtml('<span unselectable=\"on\" onclick=\"$$.editor.execCommand(&quot;elementpath&quot;, &quot;' + i + '&quot;);\">' + ci + '</span>');\n\t\t\t\t\t}\n\t\t\t\t\tbottom.innerHTML = '<div class=\"edui-editor-breadcrumb\" onmousedown=\"return false;\">' + this.editor.getLang(\"elementPathTip\") + ': ' + buff.join(' &gt; ') + '</div>';\n\n\t\t\t\t} else {\n\t\t\t\t\tbottom.style.display = 'none'\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisableElementPath: function() {\n\t\t\t\tvar bottom = this.getDom('elementpath');\n\t\t\t\tbottom.innerHTML = '';\n\t\t\t\tbottom.style.display = 'none';\n\t\t\t\tthis.elementPathEnabled = false;\n\n\t\t\t},\n\t\t\tenableElementPath: function() {\n\t\t\t\tvar bottom = this.getDom('elementpath');\n\t\t\t\tbottom.style.display = '';\n\t\t\t\tthis.elementPathEnabled = true;\n\t\t\t\tthis._updateElementPath();\n\t\t\t},\n\t\t\t_scale: function() {\n\t\t\t\tvar doc = document,\n\t\t\t\t\teditor = this.editor,\n\t\t\t\t\teditorHolder = editor.container,\n\t\t\t\t\teditorDocument = editor.document,\n\t\t\t\t\ttoolbarBox = this.getDom(\"toolbarbox\"),\n\t\t\t\t\tbottombar = this.getDom(\"bottombar\"),\n\t\t\t\t\tscale = this.getDom(\"scale\"),\n\t\t\t\t\tscalelayer = this.getDom(\"scalelayer\");\n\n\t\t\t\tvar isMouseMove = false,\n\t\t\t\t\tposition = null,\n\t\t\t\t\tminEditorHeight = 0,\n\t\t\t\t\tminEditorWidth = editor.options.minFrameWidth,\n\t\t\t\t\tpageX = 0,\n\t\t\t\t\tpageY = 0,\n\t\t\t\t\tscaleWidth = 0,\n\t\t\t\t\tscaleHeight = 0;\n\n\t\t\t\tfunction down() {\n\t\t\t\t\tposition = domUtils.getXY(editorHolder);\n\n\t\t\t\t\tif (!minEditorHeight) {\n\t\t\t\t\t\tminEditorHeight = editor.options.minFrameHeight + toolbarBox.offsetHeight + bottombar.offsetHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tscalelayer.style.cssText = \"position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:\" + editorHolder.offsetWidth + \"px;height:\" + editorHolder.offsetHeight + \"px;z-index:\" + (editor.options.zIndex + 1);\n\n\t\t\t\t\tdomUtils.on(doc, \"mousemove\", move);\n\t\t\t\t\tdomUtils.on(editorDocument, \"mouseup\", up);\n\t\t\t\t\tdomUtils.on(doc, \"mouseup\", up);\n\t\t\t\t}\n\n\t\t\t\tvar me = this;\n\t\t\t\t//by xuheng 全屏时关掉缩放\n\t\t\t\tthis.editor.addListener('fullscreenchanged', function(e, fullScreen) {\n\t\t\t\t\tif (fullScreen) {\n\t\t\t\t\t\tme.disableScale();\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (me.editor.options.scaleEnabled) {\n\t\t\t\t\t\t\tme.enableScale();\n\t\t\t\t\t\t\tvar tmpNode = me.editor.document.createElement('span');\n\t\t\t\t\t\t\tme.editor.body.appendChild(tmpNode);\n\t\t\t\t\t\t\tme.editor.body.style.height = Math.max(domUtils.getXY(tmpNode).y, me.editor.iframe.offsetHeight - 20) + 'px';\n\t\t\t\t\t\t\tdomUtils.remove(tmpNode)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfunction move(event) {\n\t\t\t\t\tclearSelection();\n\t\t\t\t\tvar e = event || window.event;\n\t\t\t\t\tpageX = e.pageX || (doc.documentElement.scrollLeft + e.clientX);\n\t\t\t\t\tpageY = e.pageY || (doc.documentElement.scrollTop + e.clientY);\n\t\t\t\t\tscaleWidth = pageX - position.x;\n\t\t\t\t\tscaleHeight = pageY - position.y;\n\n\t\t\t\t\tif (scaleWidth >= minEditorWidth) {\n\t\t\t\t\t\tisMouseMove = true;\n\t\t\t\t\t\tscalelayer.style.width = scaleWidth + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (scaleHeight >= minEditorHeight) {\n\t\t\t\t\t\tisMouseMove = true;\n\t\t\t\t\t\tscalelayer.style.height = scaleHeight + \"px\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction up() {\n\t\t\t\t\tif (isMouseMove) {\n\t\t\t\t\t\tisMouseMove = false;\n\t\t\t\t\t\teditor.ui._actualFrameWidth = scalelayer.offsetWidth - 2;\n\t\t\t\t\t\teditorHolder.style.width = editor.ui._actualFrameWidth + 'px';\n\n\t\t\t\t\t\teditor.setHeight(scalelayer.offsetHeight - bottombar.offsetHeight - toolbarBox.offsetHeight - 2, true);\n\t\t\t\t\t}\n\t\t\t\t\tif (scalelayer) {\n\t\t\t\t\t\tscalelayer.style.display = \"none\";\n\t\t\t\t\t}\n\t\t\t\t\tclearSelection();\n\t\t\t\t\tdomUtils.un(doc, \"mousemove\", move);\n\t\t\t\t\tdomUtils.un(editorDocument, \"mouseup\", up);\n\t\t\t\t\tdomUtils.un(doc, \"mouseup\", up);\n\t\t\t\t}\n\n\t\t\t\tfunction clearSelection() {\n\t\t\t\t\tif (browser.ie)\n\t\t\t\t\t\tdoc.selection.clear();\n\t\t\t\t\telse\n\t\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\n\t\t\t\tthis.enableScale = function() {\n\t\t\t\t\t//trace:2868\n\t\t\t\t\tif (editor.queryCommandState(\"source\") == 1) return;\n\t\t\t\t\tscale.style.display = \"\";\n\t\t\t\t\tthis.scaleEnabled = true;\n\t\t\t\t\tdomUtils.on(scale, \"mousedown\", down);\n\t\t\t\t};\n\t\t\t\tthis.disableScale = function() {\n\t\t\t\t\tscale.style.display = \"none\";\n\t\t\t\t\tthis.scaleEnabled = false;\n\t\t\t\t\tdomUtils.un(scale, \"mousedown\", down);\n\t\t\t\t};\n\t\t\t},\n\t\t\tisFullScreen: function() {\n\t\t\t\treturn this._fullscreen;\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tUIBase.prototype.postRender.call(this);\n\t\t\t\tfor (var i = 0; i < this.toolbars.length; i++) {\n\t\t\t\t\tthis.toolbars[i].postRender();\n\t\t\t\t}\n\t\t\t\tvar me = this;\n\t\t\t\tvar timerId,\n\t\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\t\tupdateFullScreenTime = function() {\n\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t\ttimerId = setTimeout(function() {\n\t\t\t\t\t\t\tme._updateFullScreen();\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\t\t\t\tdomUtils.on(window, 'resize', updateFullScreenTime);\n\n\t\t\t\tme.addListener('destroy', function() {\n\t\t\t\t\tdomUtils.un(window, 'resize', updateFullScreenTime);\n\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t})\n\t\t\t},\n\t\t\tshowToolbarMsg: function(msg, flag) {\n\t\t\t\tthis.getDom('toolbarmsg_label').innerHTML = msg;\n\t\t\t\tthis.getDom('toolbarmsg').style.display = '';\n\t\t\t\t//\n\t\t\t\tif (!flag) {\n\t\t\t\t\tvar w = this.getDom('upload_dialog');\n\t\t\t\t\tw.style.display = 'none';\n\t\t\t\t}\n\t\t\t},\n\t\t\thideToolbarMsg: function() {\n\t\t\t\tthis.getDom('toolbarmsg').style.display = 'none';\n\t\t\t},\n\t\t\tmapUrl: function(url) {\n\t\t\t\treturn url ? url.replace('~/', this.editor.options.UEDITOR_HOME_URL || '') : ''\n\t\t\t},\n\t\t\ttriggerLayout: function() {\n\t\t\t\tvar dom = this.getDom();\n\t\t\t\tif (dom.style.zoom == '1') {\n\t\t\t\t\tdom.style.zoom = '100%';\n\t\t\t\t} else {\n\t\t\t\t\tdom.style.zoom = '1';\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(EditorUI, baidu.editor.ui.UIBase);\n\n\t\tvar instances = {};\n\n\t\tUE.ui.Editor = function(options) {\n\t\t\tvar editor = new UE.Editor(options);\n\t\t\teditor.options.editor = editor;\n\t\t\tutils.loadFile(document, {\n\t\t\t\thref: editor.options.themePath + \"ueditor.css?v=\"+$GLOBAL_CONFIG['versionData'],\n\t\t\t\ttag: \"link\",\n\t\t\t\ttype: \"text/css\",\n\t\t\t\trel: \"stylesheet\"\n\t\t\t});\n\n\t\t\tvar oldRender = editor.render;\n\t\t\teditor.render = function(holder) {\n\t\t\t\tif (holder.constructor === String) {\n\t\t\t\t\teditor.key = holder;\n\t\t\t\t\tinstances[holder] = editor;\n\t\t\t\t}\n\t\t\t\tutils.domReady(function() {\n\t\t\t\t\teditor.langIsReady ? renderUI() : editor.addListener(\"langReady\", renderUI);\n\n\t\t\t\t\tfunction renderUI() {\n\t\t\t\t\t\teditor.setOpt({\n\t\t\t\t\t\t\tlabelMap: editor.options.labelMap || editor.getLang('labelMap')\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnew EditorUI(editor.options);\n\t\t\t\t\t\tif (holder) {\n\t\t\t\t\t\t\tif (holder.constructor === String) {\n\t\t\t\t\t\t\t\tholder = document.getElementById(holder);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tholder && holder.getAttribute('name') && (editor.options.textarea = holder.getAttribute('name'));\n\t\t\t\t\t\t\tif (holder && /script|textarea/ig.test(holder.tagName)) {\n\t\t\t\t\t\t\t\tvar newDiv = document.createElement('div');\n\t\t\t\t\t\t\t\tholder.parentNode.insertBefore(newDiv, holder);\n\t\t\t\t\t\t\t\tvar cont = holder.value || holder.innerHTML;\n\t\t\t\t\t\t\t\teditor.options.initialContent = /^[\\t\\r\\n ]*$/.test(cont) ? editor.options.initialContent :\n\t\t\t\t\t\t\t\t\tcont.replace(/>[\\n\\r\\t]+([ ]{4})+/g, '>')\n\t\t\t\t\t\t\t\t\t.replace(/[\\n\\r\\t]+([ ]{4})+</g, '<')\n\t\t\t\t\t\t\t\t\t.replace(/>[\\n\\r\\t]+</g, '><');\n\t\t\t\t\t\t\t\tholder.className && (newDiv.className = holder.className);\n\t\t\t\t\t\t\t\tholder.style.cssText && (newDiv.style.cssText = holder.style.cssText);\n\t\t\t\t\t\t\t\tif (/textarea/i.test(holder.tagName)) {\n\t\t\t\t\t\t\t\t\teditor.textarea = holder;\n\t\t\t\t\t\t\t\t\teditor.textarea.style.display = 'none';\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tholder.parentNode.removeChild(holder);\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (holder.id) {\n\t\t\t\t\t\t\t\t\tnewDiv.id = holder.id;\n\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(holder, 'id');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tholder = newDiv;\n\t\t\t\t\t\t\t\tholder.innerHTML = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.addClass(holder, \"edui-\" + editor.options.theme);\n\t\t\t\t\t\teditor.ui.render(holder);\n\t\t\t\t\t\tvar opt = editor.options;\n\t\t\t\t\t\t//给实例添加一个编辑器的容器引用\n\t\t\t\t\t\teditor.container = editor.ui.getDom();\n\t\t\t\t\t\tvar parents = domUtils.findParents(holder, true);\n\t\t\t\t\t\tvar displays = [];\n\t\t\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\t\t\tdisplays[i] = ci.style.display;\n\t\t\t\t\t\t\tci.style.display = 'block'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opt.initialFrameWidth) {\n\t\t\t\t\t\t\topt.minFrameWidth = opt.initialFrameWidth;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\topt.minFrameWidth = opt.initialFrameWidth = holder.offsetWidth;\n\t\t\t\t\t\t\tvar styleWidth = holder.style.width;\n\t\t\t\t\t\t\tif (/%$/.test(styleWidth)) {\n\t\t\t\t\t\t\t\topt.initialFrameWidth = styleWidth;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opt.initialFrameHeight) {\n\t\t\t\t\t\t\topt.minFrameHeight = opt.initialFrameHeight;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\topt.initialFrameHeight = opt.minFrameHeight = holder.offsetHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\t\t\tci.style.display = displays[i]\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//编辑器最外容器设置了高度，会导致，编辑器不占位\n\t\t\t\t\t\t//todo 先去掉，没有找到原因\n\t\t\t\t\t\tif (holder.style.height) {\n\t\t\t\t\t\t\tholder.style.height = ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\teditor.container.style.width = opt.initialFrameWidth + (/%$/.test(opt.initialFrameWidth) ? '' : 'px');\n\t\t\t\t\t\teditor.container.style.zIndex = opt.zIndex;\n\t\t\t\t\t\toldRender.call(editor, editor.ui.getDom('iframeholder'));\n\t\t\t\t\t\teditor.fireEvent(\"afteruiready\");\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t};\n\t\t\treturn editor;\n\t\t};\n\n\t\t/**\n\t\t * @file\n\t\t * @name UE\n\t\t * @short UE\n\t\t * @desc UEditor的顶部命名空间\n\t\t */\n\t\t/**\n\t\t * @name getEditor\n\t\t * @since 1.2.4+\n\t\t * @grammar UE.getEditor(id,[opt])  =>  Editor实例\n\t\t * @desc 提供一个全局的方法得到编辑器实例\n\t\t *\n\t\t * * ''id''  放置编辑器的容器id, 如果容器下的编辑器已经存在，就直接返回\n\t\t * * ''opt'' 编辑器的可选参数\n\t\t * @example\n\t\t *  UE.getEditor('containerId',{onready:function(){//创建一个编辑器实例\n\t\t *      this.setContent('hello')\n\t\t *  }});\n\t\t *  UE.getEditor('containerId'); //返回刚创建的实例\n\t\t *\n\t\t */\n\t\tUE.getEditor = function(id, opt) {\n\t\t\tvar editor = instances[id];\n\t\t\tif (!editor) {\n\t\t\t\teditor = instances[id] = new UE.ui.Editor(opt);\n\t\t\t\teditor.render(id);\n\t\t\t}\n\t\t\treturn editor;\n\t\t};\n\n\t\tUE.delEditor = function(id) {\n\t\t\tvar editor;\n\t\t\tif (editor = instances[id]) {\n\t\t\t\teditor.key && editor.destroy();\n\t\t\t\tdelete instances[id]\n\t\t\t}\n\t\t};\n\n\t\tUE.registerUI = function(uiName, fn, index, editorId) {\n\t\t\tutils.each(uiName.split(/\\s+/), function(name) {\n\t\t\t\tUE._customizeUI[name] = {\n\t\t\t\t\tid: editorId,\n\t\t\t\t\texecFn: fn,\n\t\t\t\t\tindex: index\n\t\t\t\t};\n\t\t\t})\n\n\t\t}\n\n\t})();\n\n\t// adapter/message.js\n\tUE.registerUI('message', function(editor) {\n\n\t\tvar editorui = baidu.editor.ui;\n\t\tvar Message = editorui.Message;\n\t\tvar holder;\n\t\tvar _messageItems = [];\n\t\tvar me = editor;\n\n\t\tme.addListener('ready', function() {\n\t\t\tholder = document.getElementById(me.ui.id + '_message_holder');\n\t\t\tupdateHolderPos();\n\t\t\tsetTimeout(function() {\n\t\t\t\tupdateHolderPos();\n\t\t\t}, 500);\n\t\t});\n\n\t\tme.addListener('showmessage', function(type, opt) {\n\t\t\topt = utils.isString(opt) ? {\n\t\t\t\t'content': opt\n\t\t\t} : opt;\n\t\t\tvar message = new Message({\n\t\t\t\t\t'timeout': opt.timeout,\n\t\t\t\t\t'type': opt.type,\n\t\t\t\t\t'content': opt.content,\n\t\t\t\t\t'keepshow': opt.keepshow,\n\t\t\t\t\t'editor': me\n\t\t\t\t}),\n\t\t\t\tmid = opt.id || ('msg_' + (+new Date()).toString(36));\n\t\t\tmessage.render(holder);\n\t\t\t_messageItems[mid] = message;\n\t\t\tmessage.reset(opt);\n\t\t\tupdateHolderPos();\n\t\t\treturn mid;\n\t\t});\n\n\t\tme.addListener('updatemessage', function(type, id, opt) {\n\t\t\topt = utils.isString(opt) ? {\n\t\t\t\t'content': opt\n\t\t\t} : opt;\n\t\t\tvar message = _messageItems[id];\n\t\t\tmessage.render(holder);\n\t\t\tmessage && message.reset(opt);\n\t\t});\n\n\t\tme.addListener('hidemessage', function(type, id) {\n\t\t\tvar message = _messageItems[id];\n\t\t\tmessage && message.hide();\n\t\t});\n\n\t\tfunction updateHolderPos() {\n\t\t\tvar toolbarbox = me.ui.getDom('toolbarbox');\n\t\t\tif (toolbarbox) {\n\t\t\t\tholder.style.top = toolbarbox.offsetHeight + 3 + 'px';\n\t\t\t}\n\t\t\tholder.style.zIndex = Math.max(me.options.zIndex, me.iframe.style.zIndex) + 1;\n\t\t}\n\n\t});\n\n\t// adapter/autosave.js\n\tUE.registerUI('autosave', function(editor) {\n\t\tvar timer = null,\n\t\t\tuid = null;\n\t\teditor.on('afterautosave', function() {\n\t\t\tclearTimeout(timer);\n\n\t\t\ttimer = setTimeout(function() {\n\t\t\t\tif (uid) {\n\t\t\t\t\teditor.trigger('hidemessage', uid);\n\t\t\t\t}\n\t\t\t\tuid = editor.trigger('showmessage', {\n\t\t\t\t\tcontent: editor.getLang('autosave.success'),\n\t\t\t\t\ttimeout: 2000\n\t\t\t\t});\n\n\t\t\t}, 2000)\n\t\t})\n\n\t});\n\n})();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/ueditor/ueditor.all.js\n// module id = 107\n// module chunks = 5 15","/**\n * Created with JetBrains PhpStorm.\n * User: taoqili\n * Date: 12-6-12\n * Time: 下午5:02\n * To change this template use File | Settings | File Templates.\n */\nUE.I18N['zh-cn'] = {\n    'labelMap': {\n        'anchor': '锚点',\n        'undo': '撤销',\n        'redo': '重做',\n        'bold': '加粗',\n        'indent': '首行缩进',\n        'snapscreen': '截图',\n        'italic': '斜体',\n        'underline': '下划线',\n        'strikethrough': '删除线',\n        'subscript': '下标',\n        'fontborder': '字符边框',\n        'superscript': '上标',\n        'formatmatch': '格式刷',\n        'source': '源代码',\n        'blockquote': '引用',\n        'pasteplain': '纯文本粘贴模式',\n        'selectall': '全选',\n        'print': '打印',\n        'preview': '预览',\n        'horizontal': '分隔线',\n        'removeformat': '清除格式',\n        'time': '时间',\n        'date': '日期',\n        'unlink': '取消链接',\n        'insertrow': '前插入行',\n        'insertcol': '前插入列',\n        'mergeright': '右合并单元格',\n        'mergedown': '下合并单元格',\n        'deleterow': '删除行',\n        'deletecol': '删除列',\n        'splittorows': '拆分成行',\n        'splittocols': '拆分成列',\n        'splittocells': '完全拆分单元格',\n        'deletecaption': '删除表格标题',\n        'inserttitle': '插入标题',\n        'mergecells': '合并多个单元格',\n        'deletetable': '删除表格',\n        'cleardoc': '清空文档',\n        'insertparagraphbeforetable': \"表格前插入行\",\n        'insertcode': '代码语言',\n        'fontfamily': '字体',\n        'fontsize': '字号',\n        'paragraph': '段落格式',\n        'simpleupload': '单图上传',\n        'insertimage': '多图上传',\n        'edittable': '表格属性',\n        'edittd': '单元格属性',\n        'link': '超链接',\n        'emotion': '表情',\n        'spechars': '特殊字符',\n        'searchreplace': '查询替换',\n        'map': 'Baidu地图',\n        'gmap': 'Google地图',\n        'insertvideo': '视频',\n        'help': '帮助',\n        'justifyleft': '居左对齐',\n        'justifyright': '居右对齐',\n        'justifycenter': '居中对齐',\n        'justifyjustify': '两端对齐',\n        'forecolor': '字体颜色',\n        'backcolor': '背景色',\n        'insertorderedlist': '编号',\n        'insertunorderedlist': '项目符号',\n        'fullscreen': '全屏',\n        'directionalityltr': '从左向右输入',\n        'directionalityrtl': '从右向左输入',\n        'rowspacingtop': '段前距',\n        'rowspacingbottom': '段后距',\n        'pagebreak': '分页',\n        'insertframe': '插入Iframe',\n        'imagenone': '默认',\n        'imageleft': '左浮动',\n        'imageright': '右浮动',\n        'attachment': '附件',\n        'imagecenter': '居中',\n        'wordimage': '图片转存',\n        'lineheight': '行间距',\n        'edittip': '编辑提示',\n        'customstyle': '自定义标题',\n        'autotypeset': '自动排版',\n        'webapp': '百度应用',\n        'touppercase': '字母大写',\n        'tolowercase': '字母小写',\n        'background': '背景',\n        'template': '模板',\n        'scrawl': '涂鸦',\n        'music': '音乐',\n        'inserttable': '插入表格',\n        'drafts': '从草稿箱加载',\n        'charts': '图表'\n    },\n    'insertorderedlist': {\n        'num': '1,2,3...',\n        'num1': '1),2),3)...',\n        'num2': '(1),(2),(3)...',\n        'cn': '一,二,三....',\n        'cn1': '一),二),三)....',\n        'cn2': '(一),(二),(三)....',\n        'decimal': '1,2,3...',\n        'lower-alpha': 'a,b,c...',\n        'lower-roman': 'i,ii,iii...',\n        'upper-alpha': 'A,B,C...',\n        'upper-roman': 'I,II,III...'\n    },\n    'insertunorderedlist': {\n        'circle': '○ 大圆圈',\n        'disc': '● 小黑点',\n        'square': '■ 小方块 ',\n        'dash': '— 破折号',\n        'dot': ' 。 小圆圈'\n    },\n    'paragraph': {\n        'p': '段落',\n        'h1': '标题 1',\n        'h2': '标题 2',\n        'h3': '标题 3',\n        'h4': '标题 4',\n        'h5': '标题 5',\n        'h6': '标题 6'\n    },\n    'fontfamily': {\n        'songti': '宋体',\n        'kaiti': '楷体',\n        'heiti': '黑体',\n        'lishu': '隶书',\n        'yahei': '微软雅黑',\n        'andaleMono': 'andale mono',\n        'arial': 'arial',\n        'arialBlack': 'arial black',\n        'comicSansMs': 'comic sans ms',\n        'impact': 'impact',\n        'timesNewRoman': 'times new roman'\n    },\n    'customstyle': {\n        'tc': '标题居中',\n        'tl': '标题居左',\n        'im': '强调',\n        'hi': '明显强调'\n    },\n    'autoupload': {\n        'exceedSizeError': '文件大小超出限制',\n        'exceedTypeError': '文件格式不允许',\n        'jsonEncodeError': '服务器返回格式错误',\n        'loading': \"正在上传...\",\n        'loadError': \"上传错误\",\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'\n    },\n    'simpleupload': {\n        'exceedSizeError': '文件大小超出限制',\n        'exceedTypeError': '文件格式不允许',\n        'jsonEncodeError': '服务器返回格式错误',\n        'loading': \"正在上传...\",\n        'loadError': \"上传错误\",\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'\n    },\n    'elementPathTip': \"元素路径\",\n    'wordCountTip': \"字数统计\",\n    'wordCountMsg': '当前已输入{#count}个字符, 您还可以输入{#leave}个字符。 ',\n    'wordOverFlowMsg': '<span style=\"color:red;\">字数超出最大允许值，服务器可能拒绝保存！</span>',\n    'ok': \"确认\",\n    'cancel': \"取消\",\n    'closeDialog': \"关闭对话框\",\n    'tableDrag': \"表格拖动必须引入uiUtils.js文件！\",\n    'autofloatMsg': \"工具栏浮动依赖编辑器UI，您首先需要引入UI文件!\",\n    'loadconfigError': '获取后台配置项请求出错，上传功能将不能正常使用！',\n    'loadconfigFormatError': '后台配置项返回格式出错，上传功能将不能正常使用！',\n    'loadconfigHttpError': '请求后台配置项http错误，上传功能将不能正常使用！',\n    'snapScreen_plugin': {\n        'browserMsg': \"仅支持IE浏览器！\",\n        'callBackErrorMsg': \"服务器返回数据有误，请检查配置项之后重试。\",\n        'uploadErrorMsg': \"截图上传失败，请检查服务器端环境! \"\n    },\n    'insertcode': {\n        'as3': 'ActionScript 3',\n        'bash': 'Bash/Shell',\n        'cpp': 'C/C++',\n        'css': 'CSS',\n        'cf': 'ColdFusion',\n        'c#': 'C#',\n        'delphi': 'Delphi',\n        'diff': 'Diff',\n        'erlang': 'Erlang',\n        'groovy': 'Groovy',\n        'html': 'HTML',\n        'java': 'Java',\n        'jfx': 'JavaFX',\n        'js': 'JavaScript',\n        'pl': 'Perl',\n        'php': 'PHP',\n        'plain': 'Plain Text',\n        'ps': 'PowerShell',\n        'python': 'Python',\n        'ruby': 'Ruby',\n        'scala': 'Scala',\n        'sql': 'SQL',\n        'vb': 'Visual Basic',\n        'xml': 'XML'\n    },\n    'confirmClear': \"确定清空当前文档么？\",\n    'contextMenu': {\n        'delete': \"删除\",\n        'selectall': \"全选\",\n        'deletecode': \"删除代码\",\n        'cleardoc': \"清空文档\",\n        'confirmclear': \"确定清空当前文档么？\",\n        'unlink': \"删除超链接\",\n        'paragraph': \"段落格式\",\n        'edittable': \"表格属性\",\n        'aligntd': \"单元格对齐方式\",\n        'aligntable': '表格对齐方式',\n        'tableleft': '左浮动',\n        'tablecenter': '居中显示',\n        'tableright': '右浮动',\n        'edittd': \"单元格属性\",\n        'setbordervisible': '设置表格边线可见',\n        'justifyleft': '左对齐',\n        'justifyright': '右对齐',\n        'justifycenter': '居中对齐',\n        'justifyjustify': '两端对齐',\n        'table': \"表格\",\n        'inserttable': '插入表格',\n        'deletetable': \"删除表格\",\n        'insertparagraphbefore': \"前插入段落\",\n        'insertparagraphafter': '后插入段落',\n        'deleterow': \"删除当前行\",\n        'deletecol': \"删除当前列\",\n        'insertrow': \"前插入行\",\n        'insertcol': \"左插入列\",\n        'insertrownext': '后插入行',\n        'insertcolnext': '右插入列',\n        'insertcaption': '插入表格名称',\n        'deletecaption': '删除表格名称',\n        'inserttitle': '插入表格标题行',\n        'deletetitle': '删除表格标题行',\n        'inserttitlecol': '插入表格标题列',\n        'deletetitlecol': '删除表格标题列',\n        'averageDiseRow': '平均分布各行',\n        'averageDisCol': '平均分布各列',\n        'mergeright': \"向右合并\",\n        'mergeleft': \"向左合并\",\n        'mergedown': \"向下合并\",\n        'mergecells': \"合并单元格\",\n        'splittocells': \"完全拆分单元格\",\n        'splittocols': \"拆分成列\",\n        'splittorows': \"拆分成行\",\n        'tablesort': '表格排序',\n        'enablesort': '设置表格可排序',\n        'disablesort': '取消表格可排序',\n        'reversecurrent': '逆序当前',\n        'orderbyasc': '按ASCII字符升序',\n        'reversebyasc': '按ASCII字符降序',\n        'orderbynum': '按数值大小升序',\n        'reversebynum': '按数值大小降序',\n        'borderbk': '边框底纹',\n        'setcolor': '表格隔行变色',\n        'unsetcolor': '取消表格隔行变色',\n        'setbackground': '选区背景隔行',\n        'unsetbackground': '取消选区背景',\n        'redandblue': '红蓝相间',\n        'threecolorgradient': '三色渐变',\n        'copy': \"复制(Ctrl + c)\",\n        'copymsg': \"浏览器不支持,请使用 'Ctrl + c'\",\n        'paste': \"粘贴(Ctrl + v)\",\n        'pastemsg': \"浏览器不支持,请使用 'Ctrl + v'\"\n    },\n    'copymsg': \"浏览器不支持,请使用 'Ctrl + c'\",\n    'pastemsg': \"浏览器不支持,请使用 'Ctrl + v'\",\n    'anthorMsg': \"链接\",\n    'clearColor': '清空颜色',\n    'standardColor': '标准颜色',\n    'themeColor': '主题颜色',\n    'property': '属性',\n    'default': '默认',\n    'modify': '修改',\n    'justifyleft': '左对齐',\n    'justifyright': '右对齐',\n    'justifycenter': '居中',\n    'justify': '默认',\n    'clear': '清除',\n    'anchorMsg': '锚点',\n    'delete': '删除',\n    'clickToUpload': \"点击上传\",\n    'unset': '尚未设置语言文件',\n    't_row': '行',\n    't_col': '列',\n    'more': '更多',\n    'pasteOpt': '粘贴选项',\n    'pasteSourceFormat': \"保留源格式\",\n    'tagFormat': '只保留标签',\n    'pasteTextFormat': '只保留文本',\n    'autoTypeSet': {\n        'mergeLine': \"合并空行\",\n        'delLine': \"清除空行\",\n        'removeFormat': \"清除格式\",\n        'indent': \"首行缩进\",\n        'alignment': \"对齐方式\",\n        'imageFloat': \"图片浮动\",\n        'removeFontsize': \"清除字号\",\n        'removeFontFamily': \"清除字体\",\n        'removeHtml': \"清除冗余HTML代码\",\n        'pasteFilter': \"粘贴过滤\",\n        'run': \"执行\",\n        'symbol': '符号转换',\n        'bdc2sb': '全角转半角',\n        'tobdc': '半角转全角'\n    },\n\n    'background': {\n        'static': {\n            'lang_background_normal': '背景设置',\n            'lang_background_local': '在线图片',\n            'lang_background_set': '选项',\n            'lang_background_none': '无背景色',\n            'lang_background_colored': '有背景色',\n            'lang_background_color': '颜色设置',\n            'lang_background_netimg': '网络图片',\n            'lang_background_align': '对齐方式',\n            'lang_background_position': '精确定位',\n            'repeatType': {\n                'options': [\"居中\", \"横向重复\", \"纵向重复\", \"平铺\", \"自定义\"]\n            }\n\n        },\n        'noUploadImage': \"当前未上传过任何图片！\",\n        'toggleSelect': \"单击可切换选中状态\\n原图尺寸: \"\n    },\n    //===============dialog i18N=======================\n    'insertimage': {\n        'static': {\n            'lang_tab_remote': \"插入图片\", //节点\n            'lang_tab_upload': \"本地上传\",\n            'lang_tab_online': \"在线管理\",\n            'lang_tab_search': \"图片搜索\",\n            'lang_input_url': \"地 址：\",\n            'lang_input_size': \"大 小：\",\n            'lang_input_width': \"宽度\",\n            'lang_input_height': \"高度\",\n            'lang_input_border': \"边 框：\",\n            'lang_input_vhspace': \"边 距：\",\n            'lang_input_title': \"描 述：\",\n            'lang_input_align': '图片浮动方式：',\n            'lang_imgLoading': \"　图片加载中……\",\n            'lang_start_upload': \"开始上传\",\n            'lock': {\n                'title': \"锁定宽高比例\"\n            }, //属性\n            'searchType': {\n                'title': \"图片类型\",\n                'options': [\"新闻\", \"壁纸\", \"表情\", \"头像\"]\n            }, //select的option\n            'searchTxt': {\n                'value': \"请输入搜索关键词\"\n            },\n            'searchBtn': {\n                'value': \"百度一下\"\n            },\n            'searchReset': {\n                'value': \"清空搜索\"\n            },\n            'noneAlign': {\n                'title': '无浮动'\n            },\n            'leftAlign': {\n                'title': '左浮动'\n            },\n            'rightAlign': {\n                'title': '右浮动'\n            },\n            'centerAlign': {\n                'title': '居中独占一行'\n            }\n        },\n        'uploadSelectFile': '点击选择图片',\n        'uploadAddFile': '继续添加',\n        'uploadStart': '开始上传',\n        'uploadPause': '暂停上传',\n        'uploadContinue': '继续上传',\n        'uploadRetry': '重试上传',\n        'uploadDelete': '删除',\n        'uploadTurnLeft': '向左旋转',\n        'uploadTurnRight': '向右旋转',\n        'uploadPreview': '预览中',\n        'uploadNoPreview': '不能预览',\n        'updateStatusReady': '选中_张图片，共_KB。',\n        'updateStatusConfirm': '已成功上传_张照片，_张照片上传失败',\n        'updateStatusFinish': '共_张（_KB），_张上传成功',\n        'updateStatusError': '，_张上传失败。',\n        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n        'errorExceedSize': '文件大小超出',\n        'errorFileType': '文件格式不允许',\n        'errorInterrupt': '文件传输中断',\n        'errorUploadRetry': '上传失败，请重试',\n        'errorHttp': 'http请求错误',\n        'errorServerUpload': '服务器返回出错',\n        'remoteLockError': \"宽高不正确,不能所定比例\",\n        'numError': \"请输入正确的长度或者宽度值！例如：123，400\",\n        'imageUrlError': \"不允许的图片格式或者图片域！\",\n        'imageLoadError': \"图片加载失败！请检查链接地址或网络状态！\",\n        'searchRemind': \"请输入搜索关键词\",\n        'searchLoading': \"图片加载中，请稍后……\",\n        'searchRetry': \" :( ，抱歉，没有找到图片！请重试一次！\"\n    },\n    'attachment': {\n        'static': {\n            'lang_tab_upload': '上传附件',\n            'lang_tab_online': '在线附件',\n            'lang_start_upload': \"开始上传\",\n            'lang_drop_remind': \"可以将文件拖到这里，单次最多可选100个文件\"\n        },\n        'uploadSelectFile': '点击选择文件',\n        'uploadAddFile': '继续添加',\n        'uploadStart': '开始上传',\n        'uploadPause': '暂停上传',\n        'uploadContinue': '继续上传',\n        'uploadRetry': '重试上传',\n        'uploadDelete': '删除',\n        'uploadTurnLeft': '向左旋转',\n        'uploadTurnRight': '向右旋转',\n        'uploadPreview': '预览中',\n        'updateStatusReady': '选中_个文件，共_KB。',\n        'updateStatusConfirm': '已成功上传_个文件，_个文件上传失败',\n        'updateStatusFinish': '共_个（_KB），_个上传成功',\n        'updateStatusError': '，_张上传失败。',\n        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n        'errorExceedSize': '文件大小超出',\n        'errorFileType': '文件格式不允许',\n        'errorInterrupt': '文件传输中断',\n        'errorUploadRetry': '上传失败，请重试',\n        'errorHttp': 'http请求错误',\n        'errorServerUpload': '服务器返回出错'\n    },\n    'insertvideo': {\n        'static': {\n            'lang_tab_insertV': \"插入视频\",\n            'lang_tab_searchV': \"搜索视频\",\n            'lang_tab_uploadV': \"上传视频\",\n            'lang_video_url': \"视频网址\",\n            'lang_video_size': \"视频尺寸\",\n            'lang_videoW': \"宽度\",\n            'lang_videoH': \"高度\",\n            'lang_alignment': \"对齐方式\",\n            'videoSearchTxt': {\n                'value': \"请输入搜索关键字！\"\n            },\n            'videoType': {\n                'options': [\"全部\", \"热门\", \"娱乐\", \"搞笑\", \"体育\", \"科技\", \"综艺\"]\n            },\n            'videoSearchBtn': {\n                'value': \"百度一下\"\n            },\n            'videoSearchReset': {\n                'value': \"清空结果\"\n            },\n\n            'lang_input_fileStatus': ' 当前未上传文件',\n            'startUpload': {\n                'style': \"background:url(upload.png) no-repeat;\"\n            },\n\n            'lang_upload_size': \"视频尺寸\",\n            'lang_upload_width': \"宽度\",\n            'lang_upload_height': \"高度\",\n            'lang_upload_alignment': \"对齐方式\",\n            'lang_format_advice': \"建议使用mp4格式.\"\n\n        },\n        'numError': \"请输入正确的数值，如123,400\",\n        'floatLeft': \"左浮动\",\n        'floatRight': \"右浮动\",\n        '\"default\"': \"默认\",\n        'block': \"独占一行\",\n        'urlError': \"输入的视频地址有误，请检查后再试！\",\n        'loading': \" &nbsp;视频加载中，请等待……\",\n        'clickToSelect': \"点击选中\",\n        'goToSource': '访问源视频',\n        'noVideo': \" &nbsp; &nbsp;抱歉，找不到对应的视频，请重试！\",\n\n        'browseFiles': '浏览文件',\n        'uploadSuccess': '上传成功!',\n        'delSuccessFile': '从成功队列中移除',\n        'delFailSaveFile': '移除保存失败文件',\n        'statusPrompt': ' 个文件已上传！ ',\n        'flashVersionError': '当前Flash版本过低，请更新FlashPlayer后重试！',\n        'flashLoadingError': 'Flash加载失败!请检查路径或网络状态',\n        'fileUploadReady': '等待上传……',\n        'delUploadQueue': '从上传队列中移除',\n        'limitPrompt1': '单次不能选择超过',\n        'limitPrompt2': '个文件！请重新选择！',\n        'delFailFile': '移除失败文件',\n        'fileSizeLimit': '文件大小超出限制！',\n        'emptyFile': '空文件无法上传！',\n        'fileTypeError': '文件类型不允许！',\n        'unknownError': '未知错误！',\n        'fileUploading': '上传中，请等待……',\n        'cancelUpload': '取消上传',\n        'netError': '网络错误',\n        'failUpload': '上传失败!',\n        'serverIOError': '服务器IO错误！',\n        'noAuthority': '无权限！',\n        'fileNumLimit': '上传个数限制',\n        'failCheck': '验证失败，本次上传被跳过！',\n        'fileCanceling': '取消中，请等待……',\n        'stopUploading': '上传已停止……',\n\n        'uploadSelectFile': '点击选择文件',\n        'uploadAddFile': '继续添加',\n        'uploadStart': '开始上传',\n        'uploadPause': '暂停上传',\n        'uploadContinue': '继续上传',\n        'uploadRetry': '重试上传',\n        'uploadDelete': '删除',\n        'uploadTurnLeft': '向左旋转',\n        'uploadTurnRight': '向右旋转',\n        'uploadPreview': '预览中',\n        'updateStatusReady': '选中_个文件，共_KB。',\n        'updateStatusConfirm': '成功上传_个，_个失败',\n        'updateStatusFinish': '共_个(_KB)，_个成功上传',\n        'updateStatusError': '，_张上传失败。',\n        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n        'errorExceedSize': '文件大小超出',\n        'errorFileType': '文件格式不允许',\n        'errorInterrupt': '文件传输中断',\n        'errorUploadRetry': '上传失败，请重试',\n        'errorHttp': 'http请求错误',\n        'errorServerUpload': '服务器返回出错'\n    },\n    'webapp': {\n        'tip1': \"本功能由百度APP提供，如看到此页面，请各位站长首先申请百度APPKey!\",\n        'tip2': \"申请完成之后请至ueditor.config.js中配置获得的appkey! \",\n        'applyFor': \"点此申请\",\n        'anthorApi': \"百度API\"\n    },\n    'template': {\n        'static': {\n            'lang_template_bkcolor': '背景颜色',\n            'lang_template_clear': '保留原有内容',\n            'lang_template_select': '选择模板'\n        },\n        'blank': \"空白文档\",\n        'blog': \"博客文章\",\n        'resume': \"个人简历\",\n        'richText': \"图文混排\",\n        'sciPapers': \"科技论文\"\n\n    },\n    'scrawl': {\n        'static': {\n            'lang_input_previousStep': \"上一步\",\n            'lang_input_nextsStep': \"下一步\",\n            'lang_input_clear': '清空',\n            'lang_input_addPic': '添加背景',\n            'lang_input_ScalePic': '缩放背景',\n            'lang_input_removePic': '删除背景',\n            'J_imgTxt': {\n                title: '添加背景图片'\n            }\n        },\n        'noScarwl': \"尚未作画，白纸一张~\",\n        'scrawlUpLoading': \"涂鸦上传中,别急哦~\",\n        'continueBtn': \"继续\",\n        'imageError': \"糟糕，图片读取失败了！\",\n        'backgroundUploading': '背景图片上传中,别急哦~'\n    },\n    'music': {\n        'static': {\n            'lang_input_tips': \"输入歌手/歌曲/专辑，搜索您感兴趣的音乐！\",\n            'J_searchBtn': {\n                value: '搜索歌曲'\n            }\n        },\n        'emptyTxt': '未搜索到相关音乐结果，请换一个关键词试试。',\n        'chapter': '歌曲',\n        'singer': '歌手',\n        'special': '专辑',\n        'listenTest': '试听'\n    },\n    'anchor': {\n        'static': {\n            'lang_input_anchorName': '锚点名字：'\n        }\n    },\n    'charts': {\n        'static': {\n            'lang_data_source': '数据源：',\n            'lang_chart_format': '图表格式：',\n            'lang_data_align': '数据对齐方式',\n            'lang_chart_align_same': '数据源与图表X轴Y轴一致',\n            'lang_chart_align_reverse': '数据源与图表X轴Y轴相反',\n            'lang_chart_title': '图表标题',\n            'lang_chart_main_title': '主标题：',\n            'lang_chart_sub_title': '子标题：',\n            'lang_chart_x_title': 'X轴标题：',\n            'lang_chart_y_title': 'Y轴标题：',\n            'lang_chart_tip': '提示文字',\n            'lang_cahrt_tip_prefix': '提示文字前缀：',\n            'lang_cahrt_tip_description': '仅饼图有效， 当鼠标移动到饼图中相应的块上时，提示框内的文字的前缀',\n            'lang_chart_data_unit': '数据单位',\n            'lang_chart_data_unit_title': '单位：',\n            'lang_chart_data_unit_description': '显示在每个数据点上的数据的单位， 比如： 温度的单位 ℃',\n            'lang_chart_type': '图表类型：',\n            'lang_prev_btn': '上一个',\n            'lang_next_btn': '下一个'\n        }\n    },\n    'emotion': {\n        'static': {\n            'lang_input_choice': '精选',\n            'lang_input_Tuzki': '兔斯基',\n            'lang_input_BOBO': 'BOBO',\n            'lang_input_lvdouwa': '绿豆蛙',\n            'lang_input_babyCat': 'baby猫',\n            'lang_input_bubble': '泡泡',\n            'lang_input_youa': '有啊'\n        }\n    },\n    'gmap': {\n        'static': {\n            'lang_input_address': '地址',\n            'lang_input_search': '搜索',\n            'address': {\n                value: \"北京\"\n            }\n        },\n        searchError: '无法定位到该地址!'\n    },\n    'help': {\n        'static': {\n            'lang_input_about': '关于UEditor',\n            'lang_input_shortcuts': '快捷键',\n            'lang_input_introduction': 'UEditor是由百度web前端研发部开发的所见即所得富文本web编辑器，具有轻量，可定制，注重用户体验等特点。开源基于BSD协议，允许自由使用和修改代码。',\n            'lang_Txt_shortcuts': '快捷键',\n            'lang_Txt_func': '功能',\n            'lang_Txt_bold': '给选中字设置为加粗',\n            'lang_Txt_copy': '复制选中内容',\n            'lang_Txt_cut': '剪切选中内容',\n            'lang_Txt_Paste': '粘贴',\n            'lang_Txt_undo': '重新执行上次操作',\n            'lang_Txt_redo': '撤销上一次操作',\n            'lang_Txt_italic': '给选中字设置为斜体',\n            'lang_Txt_underline': '给选中字加下划线',\n            'lang_Txt_selectAll': '全部选中',\n            'lang_Txt_visualEnter': '软回车',\n            'lang_Txt_fullscreen': '全屏'\n        }\n    },\n    'insertframe': {\n        'static': {\n            'lang_input_address': '地址：',\n            'lang_input_width': '宽度：',\n            'lang_input_height': '高度：',\n            'lang_input_isScroll': '允许滚动条：',\n            'lang_input_frameborder': '显示框架边框：',\n            'lang_input_alignMode': '对齐方式：',\n            'align': {\n                title: \"对齐方式\",\n                options: [\"默认\", \"左对齐\", \"右对齐\", \"居中\"]\n            }\n        },\n        'enterAddress': '请输入地址!'\n    },\n    'link': {\n        'static': {\n            'lang_input_text': '文本内容：',\n            'lang_input_url': '链接地址：',\n            'lang_input_title': '标题：',\n            'lang_input_target': '是否在新窗口打开：'\n        },\n        'validLink': '只支持选中一个链接时生效',\n        'httpPrompt': '您输入的超链接中不包含http等协议名称，默认将为您添加http://前缀'\n    },\n    'map': {\n        'static': {\n            lang_city: \"城市\",\n            lang_address: \"地址\",\n            city: {\n                value: \"北京\"\n            },\n            lang_search: \"搜索\",\n            lang_dynamicmap: \"插入动态地图\"\n        },\n        cityMsg: \"请选择城市\",\n        errorMsg: \"抱歉，找不到该位置！\"\n    },\n    'searchreplace': {\n        'static': {\n            lang_tab_search: \"查找\",\n            lang_tab_replace: \"替换\",\n            lang_search1: \"查找\",\n            lang_search2: \"查找\",\n            lang_replace: \"替换\",\n            lang_searchReg: '支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”',\n            lang_searchReg1: '支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”',\n            lang_case_sensitive1: \"区分大小写\",\n            lang_case_sensitive2: \"区分大小写\",\n            nextFindBtn: {\n                value: \"下一个\"\n            },\n            preFindBtn: {\n                value: \"上一个\"\n            },\n            nextReplaceBtn: {\n                value: \"下一个\"\n            },\n            preReplaceBtn: {\n                value: \"上一个\"\n            },\n            repalceBtn: {\n                value: \"替换\"\n            },\n            repalceAllBtn: {\n                value: \"全部替换\"\n            }\n        },\n        getEnd: \"已经搜索到文章末尾！\",\n        getStart: \"已经搜索到文章头部\",\n        countMsg: \"总共替换了{#count}处！\"\n    },\n    'snapscreen': {\n        'static': {\n            lang_showMsg: \"截图功能需要首先安装UEditor截图插件！ \",\n            lang_download: \"点此下载\",\n            lang_step1: \"第一步，下载UEditor截图插件并运行安装。\",\n            lang_step2: \"第二步，插件安装完成后即可使用，如不生效，请重启浏览器后再试！\"\n        }\n    },\n    'spechars': {\n        'static': {},\n        tsfh: \"特殊字符\",\n        lmsz: \"罗马字符\",\n        szfh: \"数学字符\",\n        rwfh: \"日文字符\",\n        xlzm: \"希腊字母\",\n        ewzm: \"俄文字符\",\n        pyzm: \"拼音字母\",\n        yyyb: \"英语音标\",\n        zyzf: \"其他\"\n    },\n    'edittable': {\n        'static': {\n            'lang_tableStyle': '表格样式',\n            'lang_insertCaption': '添加表格名称行',\n            'lang_insertTitle': '添加表格标题行',\n            'lang_insertTitleCol': '添加表格标题列',\n            'lang_orderbycontent': \"使表格内容可排序\",\n            'lang_tableSize': '自动调整表格尺寸',\n            'lang_autoSizeContent': '按表格文字自适应',\n            'lang_autoSizePage': '按页面宽度自适应',\n            'lang_example': '示例',\n            'lang_borderStyle': '表格边框',\n            'lang_color': '颜色:'\n        },\n        captionName: '表格名称',\n        titleName: '标题',\n        cellsName: '内容',\n        errorMsg: '有合并单元格，不可排序'\n    },\n    'edittip': {\n        'static': {\n            lang_delRow: '删除整行',\n            lang_delCol: '删除整列'\n        }\n    },\n    'edittd': {\n        'static': {\n            lang_tdBkColor: '背景颜色:'\n        }\n    },\n    'formula': {\n        'static': {}\n    },\n    'wordimage': {\n        'static': {\n            lang_resave: \"转存步骤\",\n            uploadBtn: {\n                src: \"upload.png\",\n                alt: \"上传\"\n            },\n            clipboard: {\n                style: \"background: url(copy.png) -153px -1px no-repeat;\"\n            },\n            lang_step: \"1、点击顶部复制按钮，将地址复制到剪贴板；2、点击添加照片按钮，在弹出的对话框中使用Ctrl+V粘贴地址；3、点击打开后选择图片上传流程。\"\n        },\n        'fileType': \"图片\",\n        'flashError': \"FLASH初始化失败，请检查FLASH插件是否正确安装！\",\n        'netError': \"网络连接错误，请重试！\",\n        'copySuccess': \"图片地址已经复制！\",\n        'flashI18n': {} //留空默认中文\n    },\n    'autosave': {\n        'saving': '保存中...',\n        'success': '本地保存成功'\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ueditor/lang/zh-cn/zh-cn.js","require('./fonts');\nrequire('./emoji');\nrequire('./picture');\nrequire('./goods');\n\n//屏蔽快捷键\n//require('./metakey');\n//删除图片\nrequire('./beforeInput');\n//过滤粘贴\nrequire('./grepPaste');\n//过滤拖拽\nrequire('./grepDrop');\n//修复选中图片\n//require('./selectImg');\n//插入后重新计算高度\nrequire(\"./autoHeight\");\n//粘贴上传\nrequire(\"./autoUpload\");\n//离开页面提示\nrequire(\"./beforeUnload\");\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/index.js","require('./title');\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/fonts/index.js","var domUtils = UE.dom.domUtils;\n\nvar utils = UE.utils;\n\nvar getContent = require('editor/utils/getContent');\n\nvar changeTagName = function(editor, tagName, key, value) {\n    if (tagName == value) {\n        editor.execCommand(key, 'p');\n    } else {\n        editor.execCommand(key, value);\n    }\n}\n\nUE.registerUI('h2 h1', function(editor, uiName) {\n    //console.log(uiName)\n    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    /*  editor.registerCommand(uiName, {\n         execCommand: function() {\n             alert('execCommand:' + uiName)\n         }\n     }); */\n    //创建一个button\n    var aliasName;\n    var args = 0; //参数个数\n    var key = \"\";\n    var value = \"\";\n\n    switch (uiName) {\n        case 'h1':\n            aliasName = \"h1\";\n            args = 1;\n            key = \"Paragraph\";\n            value = \"h1\"\n            break;\n        case 'h2':\n            aliasName = \"h2\";\n            args = 1;\n            key = 'Paragraph';\n            value = 'h2';\n            break;\n    }\n\n    var btn = new UE.ui.Button({\n        //按钮的名字\n        name: aliasName,\n        //提示\n        title: aliasName,\n        //添加额外样式,指定icon图标,这里默认使用一个重复的icon\n        //cssRules: 'background-position: -500px 0;',\n        //iconEle: '<em class=\"insert-imoj iconn-27\">' + aliasName + '</em>',\n        //点击时执行的命令\n        onclick: function(e) {\n            var range = editor.selection.getRange();\n            if (getContent(range).indexOf('gmp-ebox') != -1) {\n                return false;\n            }\n            //这里可以不用执行命令,做你自己的操作也可\n            var startDom = range.startContainer;\n            var tag = domUtils.findParentByTagName(startDom, ['h1', 'h2', 'h3', 'p'], true);\n            if (!tag) return false;\n            var tagName = tag.tagName.toLowerCase();\n\n            switch (tagName) {\n                case 'p':\n                    editor.execCommand(key, value)\n                    break;\n                case 'h1':\n                    changeTagName(editor, tagName, key, value);\n                    break;\n                case 'h2':\n                    changeTagName(editor, tagName, key, value);\n                    break;\n                case 'h3':\n                    changeTagName(editor, tagName, key, value);\n                    break;\n                default:\n                    break;\n\n            }\n            return;\n\n        }\n    });\n    //当点到编辑内容上时，按钮要做的状态反射\n    editor.addListener('selectionchange', function(e) {\n        var range = editor.selection.getRange();\n        var startDom = range.startContainer;\n        var tag = domUtils.findParentByTagName(startDom, ['h1', 'h2', 'p'], true);\n        if (!tag) return false;\n        var tagName = tag.tagName.toLowerCase();\n\n        if (tagName == uiName) {\n            btn.setChecked(1);\n        } else {\n            btn.setChecked(0);\n        }\n\n        /*var state = editor.queryCommandState(uiName);\n        console.log(state)\n        if (state == -1) {\n            btn.setDisabled(true);\n            btn.setChecked(false);\n        } else {\n            btn.setDisabled(false);\n            btn.setChecked(state);\n        }\n        btn.setChecked(1);*/\n    });\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/fonts/title.js","var getContent = function(range) {\n\n    range.select();\n\n    var fragment = range.cloneContents();\n\n    var node = document.createElement(\"div\");\n\n    if (fragment) {\n        node.appendChild(fragment);\n    } else {\n        return '';\n    }\n\n    return node.innerHTML;\n}\n\nmodule.exports = getContent;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/utils/getContent.js","/**\n * 插入表情\n * @author Fu Xiaochun\n */\n\nUE.registerUI('insertemoji', function(editor, uiName) {\n\n    var face = editor.face;\n\n    // 当点击编辑区获得焦点后，表情弹层隐藏。\n    /*editor.addListener('focus', function(editor) {\n    \tface.hide();\n    });*/\n\n    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    editor.registerCommand(uiName, {\n        execCommand: function() {\n            editor.focus();\n            var $btn = $(btn.target);\n            var offset = $btn.offset();\n            var x = offset.left;\n            var y = offset.top / 1 + 30;\n\n            if (!face.isShow) {\n                face.show(x, y);\n            } else {\n                face.hide();\n            }\n        }\n    });\n\n    // 激活光标\n    editor.addListener('afterinserthtml', function() {\n        editor.focus();\n    });\n\n    //创建一个button\n    var btn = new UE.ui.Button({\n        name: 'insertemoji',\n        title: '插入表情',\n        label: '',\n        iconEle: '<em class=\"insert-imoj iconn-27\"></em>',\n        cssRules: '',\n        onclick: function() {\n            editor.execCommand(uiName);\n        }\n    });\n\n    //当点到编辑内容上时，按钮要做的状态反射\n    editor.addListener('selectionchange', function() {\n        var state = editor.queryCommandState(uiName);\n        if (state == -1) {\n            btn.setDisabled(true);\n            btn.setChecked(false);\n        } else {\n            btn.setDisabled(false);\n            btn.setChecked(state);\n        }\n    });\n\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/emoji/index.js","/**\n * 插入图片\n * @author Fu Xiaochun\n */\nvar alert = require('module/popup/alert');\nvar upload = require('module/popup/upload/uploader');\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar pictureTpl = require('./pictures.tpl');\nvar detectQr = require('module/popup/uploadfileQR');\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\nrequire('../transformImg');\n\nvar imgMaxLen = config.imgLimitNUm;\nvar maxLen = imgMaxLen;\nvar imgTimes = 0;\nvar $content = null;\n\nvar $picPopBox = $('[data-node=picPopBox]');\nvar $upLocal = $('[data-node=upLocal]');\nvar $cover = $('[data-node=cover]');\nUE.registerUI('insertpicture', function(editor, uiName) {\n    editor.newPop = \"\";\n    var obj = {\n            time: 2000,\n            $showBox: $('[data-node=picPopBox]'),\n            customCb: \"\",\n            $insertDom: \"\",\n            editor: editor\n        }\n        //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    editor.registerCommand(uiName, {\n        execCommand: function() {\n\n            $content = $(editor.getContent());\n\n            var insertedImgLen = $content.find('img').not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n            maxLen = imgMaxLen - insertedImgLen;\n            if (maxLen <= 0) {\n                alert('您最多能添加' + imgMaxLen + '张图片哦！');\n                return;\n            }\n\n            if (!window.topicQrId) {\n\n                window.topicQrId = [];\n            }\n\n            if (!window.topicQrId['single']) {\n\n                editor.focus();\n\n                window.topicQrId['single'] = {};\n                $.extend(obj, {\n                    $parent: editor,\n                    $target: $(btn.target)\n                })\n                editor.newPop = new detectQr(obj)\n\n                editor.newPop.init();\n\n            } else {\n                var newPop = editor.newPop;\n                if (!newPop.useNewCode) {\n                    newPop.getCode();\n                } else {\n                    if (!newPop.checkShow()) {\n\n                        newPop.show();\n                        newPop.sendNum();\n                    } else {\n                        newPop.hide();\n                    }\n                }\n            }\n\n            $('div[tabindex]').remove();\n            if ($picPopBox.css('display') == 'block') {\n                setTimeout(function() {\n                    upload(maxLen, 20);\n                }, 200)\n\n            } else {}\n\n        }\n    });\n\n    // 激活光标\n    editor.addListener('afterinserthtml', function() {\n        editor.focus();\n    });\n\n    // 接收图片\n    Pubsub(channel.setPubliser.changeImage).sub(function(data) {\n        var $lastNode = null;\n        var pictureHTML = '';\n\n        data.times = ++imgTimes;\n        var images = data.images;\n        var len = images.length;\n        for (var i = 0; i < len; i++) {\n            var temp = imgReplace.imgReplace(images[i]);\n            var proto = imgReplace.imgProto(images[i]);\n            pictureHTML += pictureTpl({\n                times: data.times,\n                src: temp,\n                _src: temp,\n                imgProto: proto\n            })\n        }\n        //pictureHTML = pictureTpl(data)\n\n        /*.replace(/p> <img/gi,'p><img')\n        .replace(/(<img .*?)(> <)(\\/p>)/,function(i,j,k,l){\n        \treturn j + \"><\" + l;\n        });*/\n        editor.focus();\n\n        editor.execCommand('inserthtml', pictureHTML);\n\n        setTimeout(function() {\n            var $editor = $(editor.body);\n\n            $lastNode = $editor.find('[data-t=t-' + imgTimes + ']').last();\n            var lastOffsetTop = $lastNode.offset().top;\n            var lastPosition = lastOffsetTop + $lastNode.height();\n            if (lastPosition > $(window).height()) {\n                $('html,body').scrollTop(lastPosition);\n            }\n\n            imgReplace.changeSrc($editor);\n        }, 300);\n\n    });\n\n    //创建一个button\n    var btn = new UE.ui.Button({\n        name: 'insertpicture',\n        title: '插入图片',\n        label: '',\n        iconEle: '<em class=\"insert-pic icon\">&#xe931;</em>',\n        cssRules: '',\n        onclick: function(e) {\n            editor.execCommand(uiName);\n        }\n    });\n\n    //当点到编辑内容上时，按钮要做的状态反射\n    editor.addListener('selectionchange', function() {\n        var state = editor.queryCommandState(uiName);\n        if (state == -1) {\n            btn.setDisabled(true);\n            btn.setChecked(false);\n        } else {\n            btn.setDisabled(false);\n            btn.setChecked(state);\n        }\n    });\n\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/picture/index.js","var uploadPop = require('module/popup/upload/dialog'),\n    Pubsub = require('io/pubsub'),\n    pubName = require('io/channel');\nvar upload = require('module/upload');\nvar alert = require('module/popup/alert');\nvar imgReplace = require('utils/imgReplace');\n\nvar init = function(maxLen, total) {\n    var dialogUploader,\n        $webUpLoader,\n        maxlength = maxLen;\n    if (maxlength > 0) {\n\n        dialogUploader = uploadPop.create({\n            maxlength: maxlength,\n            total: total\n        }, {\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                var $imgList = $('[data-node=\"uploadList\"] img'),\n                    images = [];\n                for (var i = 0, len = $imgList.length; i < len; i++) {\n                    images.push($imgList.eq(i).attr('src'));\n                }\n                //maxLen -= images.length;\n                Pubsub(pubName.setPubliser.changeImage).pub({\n                    images: images\n                });\n                $('[data-node=picPopBox]').hide();\n            },\n            cancel: function() {\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                $('[data-node=picPopBox]').hide();\n            }\n        });\n\n        $webUpLoader = upload.init({\n            maxlength: maxlength,\n            callbacks: {\n                onFileQueued: function(file, numList, number) {\n                    var $uploadBox = $('[data-node=\"uploadBox\"]');\n                    var picker = '[data-defaultaddfile=\"picker\"]';\n                    $('[data-node=picPopBox]').addClass('webuploader-element-invisible');\n                    dialogUploader.show();\n                    $uploadBox.find(picker).children().eq(0).html('<em class=\"icon-add\"></em>');\n                    var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n                    $uploadBox.find(picker).before(html);\n                    $uploadBox.find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n                    if (numList[file.source.ruid] === ~~number) {\n                        $uploadBox.find(picker).hide();\n                    }\n                    $uploadBox.find(picker).children().eq(1).css({\n                        'width': '78px',\n                        'height': '78px'\n                    })\n                },\n\n                onUploadSuccess: function(file, response) {\n                    if (response.code === 200 && response.success) {\n                        $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                        // 激活提交按钮\n                        $('[i-id=ok]').removeClass('btn-default');\n                    } else {\n                        $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                    }\n                }\n            }\n        });\n    } else {\n        alert('您最多能添加' + maxLen + '张图片哦！');\n    }\n    return $webUpLoader;\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/uploader.js","/***\n * upload.js\n * @author zhaodonghong\n * @params                      object      上传图片参数\n *     maxlength               number      可上传图片最大张数\n *     selector                object      jq选择器\n *         parents             string      每个图片上传外层jq选择器\n *         delSelector         string      删除按钮jq选择器\n *         selector            string      实例化上传插件的pick.id的值\n *     defaultApi              object      实例化webuploader参数\n *     callbacks               object      实例化webuploader方法回调集合\n *         onBeforeFileQueued  function    上传图片添加到上传队列之前\n *         onFileQueued        function    上传图片添加到上传队列后\n *         onUploadSuccess     function    上传成功\n *         onUploadError       function    上传失败\n *         onUploadProgress    function    上传中\n *         onErrored           function    报错\n *         retry               function    重新上传\n *         delImage            function    删除上传图片\n */\n\nvar WebUploader = require('../plugin/webuploader/webuploader');\nvar hint = require('module/hint');\nvar notice = require('module/i18n');\nvar imgReplace = require('utils/imgReplace');\nvar init = function(options) {\n\n    //var number = maxlength;\n    var numList = {};\n    var $webUpLoader;\n    var files = {};\n    var defaultOptions = {\n        //最大上传张数\n        maxlength: options.maxlength || 9,\n        //选择器\n        selector: {\n            parents: '[data-node=\"uploadBox\"]', //每个图片上传外层jq选择器\n            delSelector: '[data-action=\"delImage\"]', //删除按钮jq选择器\n            selector: '[data-defaultAddFile=picker]' //初始化时options.defaultApi.pick 的值，也就是 选择器的值\n        }\n    };\n    //初始化参数\n    defaultOptions.defaultApi = {\n        pick: {\n            id: '[data-defaultAddFile=picker]',\n            innerHTML: '本地上传图片'\n        },\n        accept: {\n            title: 'Images',\n            extensions: 'jpg,jpeg,png,gif',\n            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\n        },\n        method: 'post',\n        // swf文件路径\n        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\n        auto: true,\n        disableGlobalDnd: true,\n        duplicate: true,\n        prepareNextFile: true,\n        chunked: true,\n        fileVal: 'avatar_file',\n        server: '/ajax/crop/crop_img',\n        fileNumLimit: defaultOptions.maxlength * $(defaultOptions.selector).length,\n        fileSizeLimit: defaultOptions.maxlength * $(defaultOptions.selector).length * 4 * 1024 * 1024, // 50 M\n        fileSingleSizeLimit: 4 * 1024 * 1024\n    };\n    defaultOptions.callbacks = {\n        /***\n         * name: 图片加入队列之前\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * number: 最多可上传数\n         */\n        onBeforeFileQueued: function( /*file, numList, number*/ ) {\n            hint.init(notice.upload.excess);\n        },\n\n        /***\n         * name: 图片添加入队列后\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * maxlength: 最多可上传数\n         */\n        onFileQueued: function(file, numList, number) {\n            var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n            $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').before(html);\n\n            $('#rt_' + file.source.ruid).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\n            if (numList[file.source.ruid] === ~~number) {\n                $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').hide();\n            }\n\n        },\n\n        /***\n         * name: 上传成功（此成功指ajax有返回结果，故需要判断返回的状态码）\n         * file: 图片信息对象\n         * response: 上传图片ajax返回数据\n         */\n        onUploadSuccess: function(file, response) {\n            if (response.code === 200 && response.success) {\n                $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                //$('#' + file.id).html('<img src=\"' + imgReplace(response.data[0]) + '\" _src = \"' + response.data[0] + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            } else {\n                $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            }\n        },\n\n        /***\n         * name: 上传失败\n         * file: 图片信息对象\n         * reason: 出错的code\n         */\n        onUploadError: function(file /*, reason*/ ) {\n            $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n        },\n\n        /***\n         * name: 上传时，包含进度条\n         * file: 图片信息对象\n         * percentage: 上传进度\n         */\n        onUploadProgress: function(file, percentage) {\n            $('#' + file.id).find('[data-node=\"progress\"]').css('width', percentage * 100 + '%');\n        },\n\n        /***\n         * name: 报错\n         * type: 报错类型\n         */\n        onErrored: function( /*type*/ ) {\n            hint.init(notice.upload.uploadError);\n        },\n\n        //重新上传\n        retry: function() {\n            var _this = this;\n            $('[data-node=\"uploadList\"]').on('click', '[data-action=\"retry\"]', function() {\n                _this.retry(files[$(this).parents('li').attr('id')]);\n            });\n        },\n\n        /***\n         * name: 删除图片\n         * webuploader: webuploader实例化对象\n         * numList: 自定义json对象，用来存储每个实例化对象已上传的图片个数\n         * id: 每个webuploader实例化时，上传按钮所生成的唯一id\n         */\n        delImage: function(webuploader, numList, id, number) {\n            $webUpLoader.removeFile(files[$(this).parents('li').attr('id')]);\n            $(this).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[id]);\n            $(this).parents('ul').find('[data-defaultAddFile=\"picker\"]').show();\n            $(this).parents('li').eq(0).remove();\n            if (numList[id] === 0) {\n                $('[i-id=ok]').addClass('btn-default');\n            };\n        }\n    };\n    options.callbacks = $.extend({}, defaultOptions.callbacks, options.callbacks);\n    /*var */\n    options = $.extend({}, defaultOptions, options);\n    $webUpLoader = WebUploader.create(options.defaultApi);\n\n    $webUpLoader.onFileQueued = function(file) {\n        var ruid = $('[data-node=\"uploadBox\"]').find('[data-defaultaddfile=\"picker\"]').children().eq(1).attr('id');\n        file.source.ruid = ruid;\n        numList[file.source.ruid] = numList[file.source.ruid] !== undefined ? numList[file.source.ruid] : 0;\n        numList[file.source.ruid]++;\n        files[file.id] = file;\n        options.callbacks.onFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\n    };\n\n    //上传成功\n    $webUpLoader.on('uploadSuccess', function(file, response) {\n        options.callbacks.onUploadSuccess.call($webUpLoader, file, response);\n    });\n\n    //加入队列前\n    $webUpLoader.on('beforeFileQueued', function(file) {\n        if (numList[file.source.ruid] >= options.maxlength) {\n            options.callbacks.onBeforeFileQueued.call($webUpLoader, file, numList, options.maxlength);\n            return false;\n        }\n\n    });\n    //上传失败\n    $webUpLoader.on('uploadError', function(file, reason) {\n        options.callbacks.onUploadError.call($webUpLoader, file, reason);\n    });\n\n    //上传时\n    $webUpLoader.on('uploadProgress', function(file, percentage) {\n        options.callbacks.onUploadProgress.call($webUpLoader, file, percentage);\n    });\n\n    //报错\n    $webUpLoader.on('error', function(type) {\n        options.callbacks.onErrored.call($webUpLoader, type);\n    });\n    options.callbacks.retry.call($webUpLoader);\n\n    //删除图片\n    $(options.selector.parents).on('click', options.selector.delSelector, function() {\n        var id = $(this).parents(options.selector.parents).find(options.defaultApi.pick.id).children().eq(1).attr('id');\n        numList[id]--;\n        options.callbacks.delImage.call(this, $webUpLoader, numList, id, options.maxlength);\n    });\n\n    return $webUpLoader;\n}\n\nmodule.exports = {\n    init: init\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/upload.js"," var rules = /^https?:/i;\n var https = 'https';\n var imgRule = /^http/i;\n/* var grepStr = /-600!80\\./g;\n var grepOldStr = /\\.600q80\\.jpg/gi;*/\n var shotCut = \"-600!80\";\n var imgType = /\\.(jpg|jpeg|png)$/;\n\nvar grepStr1 = /(.+?)-[^\\.]+\\.(jp(e)?g|png|gif).*/;\nvar grepStr2 = /(.+?\\.(jp(e)?g|png|gif)).*/\n\n\n var imgReplace = function(src) {\n    return  src.replace(rules, '');\n }\n\nvar orignalImgReplace = function(src){\n    if(grepStr1.test(src)){\n        return src.replace(grepStr1,\"$1.$2\"); \n    }else{\n        return src.replace(grepStr2,\"$1\");\n    }\n      \n}\n\nvar addShortCut = function(src){\n    return src.replace(imgType,function($1){\n        return shotCut + $1;\n    })\n}\n var imgProto = function(src) {\n     if (src.indexOf(https) != -1) {\n         return 'https:';\n     } else {\n         return 'http:'\n     }\n }\n\n var changeSrc = function(container) {\n     var $imgs = container.find('img').not('[data-node=\"goodsPic\"]');\n     var len = $imgs.length;\n     for (var i = 0; i < len; i++) {\n         var _this = $($imgs[i])\n         var _src = _this.attr(\"_src\");\n         var _orignal = _this.attr(\"data-original\");\n         if (_orignal) {\n             _this.attr({\n                 'src': imgReplace(_orignal),\n                 '_src': imgReplace(_orignal),\n                 'proto': imgProto(_orignal)\n             })\n         } else if (!imgRule.test(_src)) {\n             var proto = _this.attr(\"proto\");\n             _this.attr(\"_src\", _src);\n         }\n\n     }\n }\n\n module.exports = {\n     imgReplace: imgReplace,\n     addShortCut:addShortCut,\n     imgProto: imgProto,\n     changeSrc: changeSrc,\n     orignalImgReplace:orignalImgReplace\n };\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/imgReplace.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/picture/pictures',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,images=$data.images,v=$data.v,$index=$data.$index,$escape=$utils.$escape,times=$data.times,src=$data.src,_src=$data._src,imgProto=$data.imgProto,$out='';$out+='<!-- ';\n$each(images,function(v,$index){\n$out+=' <p> <img data-t=\"t-';\n$out+=$escape(times);\n$out+='\" angle=\"0\" data-type=\"insertImg\" src=\"';\n$out+=$escape(v);\n$out+='\"> </p> ';\n});\n$out+=' --> <p> <img data-t=\"t-';\n$out+=$escape(times);\n$out+='\" angle=\"0\" data-type=\"insertImg\" src=\"';\n$out+=$escape(src);\n$out+='\" _src=\"';\n$out+=$escape(_src);\n$out+='\" proto=\"';\n$out+=$escape(imgProto);\n$out+='\"> </p> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/picture/pictures.tpl\n// module id = 118\n// module chunks = 5 15","var codeTpl = require('./upload.tpl');\nvar imgPath = $GLOBAL_CONFIG['pcimgpath'];\n\n$('body').append(codeTpl({\n    imgPath: imgPath\n}));\n\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar qrTips = require('module/i18n');\nvar alert = require('module/popup/alert');\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\nvar domain = $_CONFIG['group_domain'];\n\nvar pageId = window.pageId;\nvar maxLen = config.imgLimitNUm;\nvar pageId = window.pageId;\nfunction Scans(o) {\n    this.qid = o.qid || 'single'; //是否创建实例的唯一标示\n    this.topicQrId = \"\";\n    this.$parent = o.$parent; //用于寻找插入图片的节点\n    this.uploadMaxNum = o.maxNum || 20; //上传图片限制\n    //this.currentMaxNum = 0; //当前能够上传图片\n    this.useNewCode = 0; //二维码是否过期的判断\n    this.interval = 0;\n    this.type = o.type || 'pubsliser'; //扫码来源  评论页？发布话题页？等\n    this.$showBox = o.$showBox; //二维码弹层\n    this.time = o.time || 2000; //轮询请求间隔\n    this.customInit = o.customInit || \"\";\n    this.customCb = o.customCb; //用户自定义回调函数\n    this.isLoad = 0;\n    // this.$insertDom = o.$insertDom; //插入图片的节点\n    this.imgArr = []; //存储二维码未过期时，获得的的图片总数\n    this.editor = o.editor || \"\"; //用于编辑器\n    this.$cover = o.$showBox.find('[data-node=\"cover\"]'); //是否上传中\n    this.$localBtn = o.$showBox.find('[data-node=\"upLocal\"]'); //是否上传中\n    this.$target = o.$target;\n    this.code = \"\";\n    this.btn = o.btn;\n\n}\n\nScans.prototype = {\n    constructor: Scans,\n    init: function() {\n        var _this = this;\n        if (_this.editor) {\n            //\n            /*_this.editor.document.body.addEventListener('DOMNodeRemoved', function(evt) {\n                var code = evt.keyCode || evt.which\n                if (code == 8) {\n                    var target = evt.target\n                    debugger;\n                    console.log(target.nodeName, target.previousSibling, target.previousSibling.nodeName)\n                    if (target.nodeName == \"#text\") {\n                        if (target.previousSibling && target.previousSibling.nodeName == \"IMG\") {\n            console.log(333)\n                        }\n                    }\n                }\n            })*/\n\n            /*$(_this.editor.document).on('DOMNodeRemoved DOMNodeInserted', 'img', function(e) {\n                if (_this.interval) {\n                    //console.log(666)\n                    setTimeout(function() {\n                        _this.sendNum();\n                    }, 100)\n\n                }\n            })*/\n\n            $(_this.editor.body).on('click', function(e) {\n                //$webUpLoader.destroy();\n                _this.hide();\n                e.preventDefault();\n            })\n        }\n\n        if (typeof _this.customInit == 'function') {\n            this.customInit(this);\n        }\n        $('body').on('click', /* _this.$showBox*/ '[data-node=\"picPopBox\"]', function(e) {\n            var tagName = e.target.tagName;\n            tagName = tagName == 'INPUT' || tagName == 'LABEL'\n            if (!tagName) {\n                e.stopPropagation();\n            } else {\n                _this.hide()\n            }\n\n        });\n\n        this.start();\n    },\n    start: function() {\n        if (!this.useNewCode) {\n            this.getCode()\n        } else {\n\n            if (this.checkShow()) {\n                this.hide()\n            } else {\n                this.show();\n            }\n        }\n    },\n    //获取图片数量\n    imgLength: function() {\n        if (this.editor) {\n            return $(this.$parent.getContent()).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n        } else {\n            return this.$parent.find(\"img\").length;\n        }\n    },\n    //获取二维码\n    getCode: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var datas = {\n            pageId: pageId,\n            maxNum: this.uploadMaxNum - len\n        }\n        var qid = _this.qid;\n        var qidArr = window.topicQrId; //检测window变量是否有此变量 格式为：\n        _this.show();\n        //topicQrId:{\n        //  qid1:s1111,\n        //  qid2:s2222\n        // }\n        if (qidArr[qid].qrcodeId) {\n            datas.qrcodeId = _this.topicQrId;\n        }\n        fetch\n            .get(url.get('getUploadQrCode'), {\n                data: datas\n            })\n            .done(function(data) {\n                if (data.success == true) {\n\n                    if (data.code == 200) {\n\n                        _this.useNewCode = 1;\n\n                        var _data = data.data;\n\n                        var str = domain + 'qrupload/index?pageId=' + _data.pageId + '&qrcodeId=' + _data.qrcodeId + '&type=' + _this.type;;\n                        str = domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(str);\n\n                        window.topicQrId[qid].qrcodeId = _this.topicQrId = _data.qrcodeId; //把data的值赋予 window [qid].qrcodeId\n\n                        _this.code = str; //把二维码的值放入\n                        _this.getCodeCb();\n\n                        _this.interval = setInterval(function() {\n                            _this.monitor();\n                        }, _this.time)\n\n                    }\n                } else {\n                    alert(data.message);\n                }\n            })\n            .fail(function(e, s) {})\n\n    },\n    //扫码轮询\n    monitor: function() {\n        var _this = this;\n        fetch\n            .post(url.get('topListenImg'), {\n                data: {\n                    code: pageId,\n                    groupkey: window.topicQrId[_this.qid].qrcodeId\n                }\n\n            })\n            .done(function(data) {\n\n                if (data.success == true) { //ok\n                    _this.scanCb(data);\n                } else {\n                    _this.hide();\n                }\n            }).fail(function(e, m) {\n                clearInterval(_this.interval);\n                _this.interval = 0;\n                _this.hide();\n                // alert(e);\n            })\n    },\n    sendNum: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var maxNum = this.uploadMaxNum - len;\n        fetch\n            .get(url.get('topicuploadMax'), {\n                data: {\n                    qrcodeId: _this.topicQrId,\n                    maxNum: maxNum\n                }\n            })\n    },\n    //插入图片\n    insertPic: function(data) {\n        for (var i = 0, len = data.length; i < len; i++) {\n            var _data = data[i];\n            var _img = imgReplace.imgReplace(_data);\n            var _proto = imgReplace.imgProto(_data);\n            var str = '<p><img src=\"' + _img + '\" _src=\"' + _img + '\" data-type=\"insertImg\" proto=\"' + _proto + '\"/></p>';\n            this.editor.execCommand('inserthtml', str);\n        }\n    },\n    //用户正在上传中\n    loading: function() {\n        this.isLoad = 1;\n        this.$showBox.show();\n        this.$cover.show();\n        this.$localBtn.addClass('upload-unable');\n        if (this.editor) {\n            this.editor.setDisabled();\n        }\n\n    },\n    //用户不在上传中\n    unLoading: function() {\n        this.isLoad = 0;\n        this.$cover.hide();\n        this.$cover.css(\"display\", \"none\");\n        this.$localBtn.removeClass('upload-unable');\n        if (this.editor) {\n            this.editor.setEnabled();\n        }\n\n    },\n    //检查弹层状态\n    checkShow: function() {\n        if (this.$showBox.is(\":visible\")) {\n            return true;\n        }\n        return false;\n    },\n    //调整弹窗位置\n    fixPop: function() {\n        var $btn = this.$target;\n        var offset = $btn.offset();\n        var x = offset.left;\n        var y = offset.top / 1 + 30;\n\n        return this.$showBox.css({\n            'top': y + 'px',\n            'left': x + 'px'\n        });\n\n    },\n    //显示弹层\n    show: function() {\n        this.$showBox.removeClass('webuploader-element-invisible');\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        this.fixPop().show();\n    },\n    //隐藏弹层\n    hide: function() {\n        if (this.isLoad != 1) {\n            this.$showBox.hide();\n        }\n    },\n    //获得二维码回调\n    getCodeCb: function() {\n        this.sendNum(); //发送二维码数量\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        //this.show();\n    },\n    //扫码回调\n    scanCb: function(data) {\n\n            switch (data.isload) {\n                case 1:\n                    this.unLoading()\n                    break;\n                case 2: //上传中\n                    this.loading()\n\n                    break;\n                case 3: //上传完成\n                    var dataArr = data.data;\n                    var tempArr = [];\n\n                    var diffLen = dataArr.length - this.imgArr.length;\n\n                    if (diffLen) {\n                        this.loading()\n                        this.imgArr = dataArr;\n                        tempArr = dataArr.slice(-diffLen)\n                        var _this = this;\n                        setTimeout(function() {\n                            _this.unLoading()\n                            _this.hide();\n                            if (typeof _this.customCb == 'function') {\n                                _this.customCb(tempArr, _this)\n                            } else {\n                                _this.insertPic(tempArr);\n                            }\n\n                        }, 500)\n                    }\n                    break;\n                case 10000:\n                    this.imgArr = [];\n                    this.isload = 0;\n                    this.useNewCode = 0; //useNewCode 为0 意味着二维码过期\n                    clearInterval(this.interval);\n                    this.interval = 0;\n                    this.hide();\n                    break;\n            }\n        }\n        //prototype end\n}\n\nmodule.exports = Scans;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/uploadfileQR/index.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/uploadfileQR/upload',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgPath=$data.imgPath,$out='';$out+='<div data-node=\"picPopBox\" class=\"picPopBox\" data-node=\"picPopBox\"> <em class=\"sanjiao\"></em> <div class=\"container clearfix\"> <div class=\"left\"> <div class=\"qr\"> <img src=\\'\\'/> <div class=\"cover\" data-node=\"cover\">上传中...</div> </div> <p>扫描二维码,上传手机图片</p> </div> <div class=\"right\" data-node=\"uploadList\"> <div class=\"pc-btn pc-btnh35\" data-defaultAddFile=\\'picker\\'></div> </div> </div> </div> <div data-node=\"picLoading\" class=\"picLoading hide\"> <img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/public/loading.gif\"/> <div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/uploadfileQR/upload.tpl\n// module id = 120\n// module chunks = 5 15 29","//白名单\nvar whiteList = {\n    a: ['target', 'href', 'title', 'class', 'data-node'],\n    div: ['class', 'style', 'data-node', 'unselectable', 'onselectstart', 'data-type', 'data-skuid'],\n    dl: ['class', 'style', 'data-node'],\n    dt: ['class', 'style'],\n    em: ['class', 'style', 'data-node'],\n    h1: ['data-node'],\n    h2: ['data-node'],\n    h3: ['data-node'],\n    h4: ['data-node'],\n    h5: ['data-node'],\n    h6: ['data-node'],\n    img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-index', 'data-type', 'data-node', 'data-original', 'onerror', 'proto'],\n    p: ['class', 'style', 'data-node'],\n    span: ['class', 'style', 'data-node'],\n    ul: ['class', 'style', 'data-node'],\n    ol: ['class', 'style', 'data-node'],\n    li: ['class', 'style', 'data-node']\n};\n\nvar defaults = {\n    //图片张数限制\n    imgLimitNUm: 20,\n    //商品个数限制\n    goodsLimitNUm: 9,\n    initialFrameWidth: 788,\n    initialFrameHeight: 400,\n    zIndex: 9,\n    autoClearinitialContent: true,\n    //服务器根目录\n    UEDITOR_HOME_URL: $_CONFIG['js_domain'],\n    //后台地址\n    //serverUrl:'php/1.php',\n    //serverUrl: $_CONFIG['group_domain'],\n    serverUrl: '',\n    //css 路径\n    themePath: $_CONFIG.csspath + '/css/module/',\n    //白名单\n    whitList: whiteList,\n    //工具栏\n    toolbars: [\n        ['bold', 'italic', 'underline', 'insertunorderedlist', 'insertorderedlist', 'justifyleft', 'justifycenter', 'justifyright']\n        //['insertunorderedlist', 'insertorderedlist']\n    ],\n    //iframe 内置样式\n    iframeCssUrl: $_CONFIG.csspath + '/css/module/iframestyle.css?v=' + $GLOBAL_CONFIG['versionData'],\n    //'//localhost:8017/src/js/editor/themes/iframestyle.css',\n    //纯文本粘贴\n    pasteplain: true,\n    //禁止div转换成p标签\n    allowDivTransToP: false,\n    //禁止缩放图片\n    imageScaleEnabled: false,\n    elementPathEnabled: false, // 关闭元素路径,调试时暂时开启\n    wordCount: false, // 字数统计\n    //禁止非同域上传图片\n    catchRemoteImageEnable: true,\n    //匹配快捷按键回调\n    // callbackKey: shortcutKey.callbackKey,\n    //右键菜单功能\n    enableContextMenu: false,\n    // 因为是用的自定义的弹窗,所以,关闭了编辑器自带的图片弹窗\n    imagePopup: false,\n    // 禁止自动保存\n    enableAutoSave: false,\n    // 自定义过滤规则\n    // filterTxtRules:filterTxtRules()\n};\nmodule.exports = defaults;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/config.js","/**\n * @description\n * 图片角度转化\n *\n * @author 林飞\n */\nvar alert = require('module/popup/alert');\nvar transform = require('./angle');\nUE.plugin.register('tansformImg', function(elm) {\n    var me = this;\n    var domUtils = UE.dom.domUtils;\n    //禁止连续请求\n\n    // img旋转弹层 鼠标离开，键盘事件都需要隐藏\n    var imageTransformPopup = window.imageTransformPopup = new baidu.editor.ui.Popup({\n        editor: me,\n        theme: 'default',\n        cutstomPosition: 'top-right',\n        _filterType: function(el) {\n            var src = $(el).attr(\"src\");\n            if (src.indexOf(\".gif\") != -1) {\n                alert(\"gif图不支持旋转\");\n                return false;\n            } else {\n                return true;\n            }\n        },\n        _left: function() {\n            var el = this.anchorEl;\n            if (this._filterType(el)) {\n                transform(this.anchorEl, 1);\n            }\n            me.focus();\n        },\n        _right: function() {\n            var el = this.anchorEl;\n            if (this._filterType(el)) {\n                transform(this.anchorEl, 2);\n            }\n            me.focus();\n        },\n        _delete: function() {\n            $(this.anchorEl).remove();\n            imageTransformPopup.hide();\n            me.focus();\n        }\n    })\n\n    imageTransformPopup.render();\n\n    me.addListener('mouseover', function(evtName, evt) {\n\n        if (me.loading) return;\n\n        var target = evt.target;\n\n        //console.log(evt.target.tagName === 'IMG')\n        //var img = me.selection.getRange().getClosedNode();\n        //if (img && img.tagName == \"IMG\" && img.parentNode.tagName != \"A\") {\n        if (target && target.tagName == \"IMG\" && target.parentNode.tagName != \"A\") {\n            var html = '',\n                str = \"\",\n                img = target;\n\n            str = '<nobr class=\"edui_angle_box edui-clearfix\">' +\n                '<span onclick=$$._left() class=\"edui-clickable\"></span>' +\n                '<span onclick=$$._right() class=\"edui-clickable\"></span>' +\n                '<span onclick=$$._delete() class=\"edui-clickable\"></span>' +\n                '</nobr>'\n\n            !html && (html = imageTransformPopup.formatHtml(str));\n            if (html) {\n                imageTransformPopup.getDom('content').innerHTML = html;\n                imageTransformPopup.anchorEl = img || link;\n                imageTransformPopup.showAnchor(imageTransformPopup.anchorEl);\n            } else {\n                imageTransformPopup.hide();\n            }\n        }\n    })\n\n    me.addListener('mouseover', function() {\n        imageTransformPopup.hide();\n    })\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/transformImg.js","var fetch = require('io/fetch');\nvar url = require('io/url');\n\nvar imgReplace = require('utils/imgReplace');\nvar firing = 0;\nvar imgArr = [];\nvar $picLoading;\n//var transformUrl = '1.json';\n\nvar transformAngle = function($obj, direction) { //img对象  角度\n    if (firing == 1) {\n        return false;\n    }\n    var def = $.Deferred();\n    var angle = parseInt($obj.attr(\"angle\")) || 0;\n    switch (direction) {\n        case 2:\n            if (angle == 0) {\n                angle = 270;\n            } else {\n                angle -= 90;\n            }\n            break;\n        case 1:\n            if (angle == 270) {\n                angle = 0;\n            } else {\n                angle += 90;\n            }\n            break;\n        case \"reset\":\n            angle = 0;\n            break;\n    }\n    def.resolve($obj, angle);\n    return def.promise();\n}\n\nvar detectImg = function($obj, angle) {\n    if (firing == 1) {\n        return false;\n    }\n    var def = $.Deferred();\n    var _src = $obj.attr(\"_src\");\n    var src = imgReplace.imgReplace(_src);\n\n    //数组是否包含 下标为_src的元素\n    var hasImg = imgArr[_src];\n    var angleStr = 'angle' + angle;\n    //是否包含已有角度的元素，\n    var tempObj = {\n        \"$obj\": $obj,\n        \"src\": src,\n        \"_src\": _src,\n        \"angle\": angle\n    }\n\n    var extendObj = {};\n\n    if (hasImg) {\n        if (hasImg[angleStr]) {\n            extendObj = {\n                \"status\": 1,\n                \"cache\": 1\n            };\n        } else {\n            extendObj = {\n                \"status\": 0,\n                \"cache\": 1\n            };\n        }\n\n    } else {\n        extendObj = {\n            \"status\": 0,\n            \"cache\": 0\n        };\n    }\n\n    $.extend(tempObj, extendObj)\n\n    def.resolve(tempObj);\n    return def.promise();\n}\n\nvar renderImg = function(obj) {\n\n    if (firing == 1) {\n        return false;\n    }\n    firing = 1;\n    var $obj = obj.$obj;\n    var src = obj.src;\n    var _src = obj._src;\n    var angle = obj.angle;\n    var status = obj.status;\n    var cache = obj.cache;\n\n    var angleStr = \"angle\" + angle;\n\n    var renderExist = function() {\n        $obj.attr({\n            'src': imgReplace.imgReplace(imgArr[_src][angleStr]),\n            'angle': angle,\n            \"proto\": imgReplace.imgProto(imgArr[_src][angleStr])\n        });\n        firing = 0;\n    }\n\n    if (obj.status) {\n        renderExist();\n        //直接渲染\n        return false;\n    }\n\n    if (obj.angle == 0) {\n\n        if (!imgArr[_src]) {\n            imgArr[_src] = [];\n        }\n\n        imgArr[_src][angleStr] = imgReplace.imgReplace($obj.attr(\"_src\"));\n        renderExist();\n        return false;\n    }\n\n    // fetch.get(transformUrl, {\n    fetch.post(url.get('topicRotateImg'), {\n        data: {\n            imgPath: _src,\n            angle: angle\n        },\n        beforeSend: function() {\n            if (!$picLoading) {\n                $picLoading = $('[data-node=\"picLoading\"]');\n            }\n            $picLoading.removeClass('hide');\n\n        }\n    }).done(function(data) {\n        var dataSrc = data.data[0];\n        if (data.success == true) {\n            $obj.attr({\n                'src': imgReplace.imgReplace(dataSrc),\n                'angle': angle,\n                'proto': imgReplace.imgProto(dataSrc)\n            });\n            if (!obj.cache) {\n\n                imgArr[_src] = [];\n\n            }\n            imgArr[_src][angleStr] = imgReplace.imgReplace(dataSrc);\n        } else {\n            alert(data.message);\n        }\n    }).always(function(data) {\n        firing = 0;\n        $picLoading.addClass('hide');\n\n    })\n}\n\nvar transform = function(obj, direction) {\n    var def = $.Deferred();\n    def.resolve($(obj), direction);\n\n    def\n        .then(transformAngle) //转化角度\n        .then(detectImg) //判断图片是否命中\n        .then(renderImg); //渲染图片\n}\nmodule.exports = transform;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/angle.js","/**\n * 插入商品\n * @author Fu Xiaochun\n */\n\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar empty = require('module/empty');\nvar toast = require('module/hint').init;\n\nvar dialog = require('module/addGoods');\nvar goodsTpl = require('./goods.tpl');\n\nvar imgReplace = require('utils/imgReplace');\n//var detectQr = require('../detectQr');\n//var maxLen = 9;\n\nvar from = $GLOBAL_CONFIG['from'];\nvar insertedGoods = {};\n\n//插入草稿 延迟2s执行\nif (from) {\n    setTimeout(function() {\n        insertedGoods = window.insertedGoods;\n    }, 2000)\n}\n\nUE.registerUI('insertgoods', function(editor, uiName) {\n\n    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    editor.registerCommand(uiName, {\n        execCommand: function() {\n            var $content = $(editor.body);\n            var $goodsDoms = $content.find('[data-type=insertGoods]');\n            var goodsLen = $goodsDoms.length;\n            var goodsData = {};\n\n            if (goodsLen) {\n                if (empty(insertedGoods)) {\n                    goodsData = $goodsDoms.data('goodsinfo');\n                    insertedGoods[goodsData.skuId] = goodsData;\n                } else {\n                    $.each(insertedGoods, function(k) {\n                        var len = $content.find('[data-skuId=' + k + ']').length;\n                        if (!len) {\n                            delete insertedGoods[k];\n                        }\n                    });\n                }\n\n            } else {\n                insertedGoods = {};\n            }\n            dialog(insertedGoods, 9);\n        }\n    });\n\n    // 插入后激活光标\n    editor.addListener('afterinserthtml', function() {\n        editor.focus();\n    });\n\n    // 接收商品\n    Pubsub(channel.setPubliser.changedItem).sub(function(data) {\n        var range = editor.selection.getRange();\n        var DomArr = editor.selection.getStartElementPath();\n        var startDom = DomArr[DomArr.length - 2];\n        var creatNewP = 0;\n        var nextNode = startDom.nextElementSibling;\n        if (startDom.nodeName == \"OL\" || startDom.nodeName == \"UL\") {\n            toast('列表状态下不能插入商品', {\n                duration: 2000\n            });\n            return false;\n        }\n\n        if (nextNode && nextNode.nodeName == 'DIV') {\n            creatNewP = 1;\n        }\n\n        insertedGoods = $.extend(true, {}, data);\n        var $content = $(editor.body);\n        var $goodsCards = $content.find('[data-type=insertGoods]');\n        $.each($goodsCards, function(i, e) {\n            var skuId = $(e).data('skuid');\n            var $eParent = $(e).parent('div');\n            var $preDom = $eParent.prev('p');\n            var preDomTxt = $.trim($preDom.text());\n            if (typeof data[skuId] === 'undefined') {\n                $content.find('[data-skuId=' + skuId + ']').parent().remove();\n            }\n        });\n        $.each(data, function(k) {\n            var $goodsCard = $content.find('[data-skuId=' + k + ']');\n            if ($goodsCard.length) {\n                delete data[k];\n            }\n        });\n\n        var goodsHTML = goodsTpl({\n            list: data\n        });\n        editor.focus();\n\n        if (creatNewP) {\n            goodsHTML = $.trim(goodsHTML) + '<p>&#8203<br/></p>' //编辑器bug 必须用trim\n        }\n        goodsHTML = imgReplace.imgReplace(goodsHTML);\n        editor.execCommand('insertgoodshtml', goodsHTML, true);\n\n        setTimeout(function() {\n            var $body = $(editor.body); //节点已经变化，重新获取\n            var $el = $body.find('[data-node=\"gmp-ebox\"]').last();\n            var $li = $el.parent('li');\n            var $parent = $li.parent();\n            var $next = $parent.next();\n            if (!$next.length) {\n                $parent.append(\"<li><p>&#8203<p></li>\");\n                editor.focus();\n            }\n\n        }, 200)\n    });\n\n    //创建一个button\n    var btn = new UE.ui.Button({\n        name: 'insertgoods',\n        title: '插入商品',\n        label: '',\n        iconEle: '<em class=\"insert-merchant iconn-29\"></em>',\n        cssRules: '',\n        onclick: function() {\n            editor.execCommand(uiName);\n        }\n    });\n\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/goods/index.js","/**\n * [判断Object是否为空]\n * @Author: Fu Xiaochun\n * @Email: \tfuzhengchun@gomeplus.com\n */\nmodule.exports = function(o) {\n\tfor (var k in o) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/empty.js","var dialog = require('module/popup/addGoods/dialog');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar Pubsub = require('io/pubsub');\nvar tpl = require('module/popup/addGoods/content.tpl');\nvar itemlist = require('module/popup/addGoods/itemContent.tpl');\nvar defaultItemlist = require('module/popup/addGoods/defaultItemContent.tpl');\nvar pubName = require('io/channel');\nvar indexof = require('lodash/indexOf');\nvar alert = require('module/popup/alert');\n\nvar pageNum = 1;\nvar maxlength = 9;\nvar isDefault = true;\nvar keyWord = '';\nvar changedList = [];\nvar isGetMore = false;\nvar options = {};\nvar degree = 1;\n// var delChanged = [];\nvar addDialog;\n\nvar $searchTop = null,\n    $searchInput = null,\n    $searchBtn = null,\n    $searchNormal = null,\n    $searchLoading = null,\n    $searchFail = null,\n    $searchResult = null,\n    $searchList = null,\n    // $searchPage = null,\n    $changeNum = null,\n    $listBox = null,\n    $changeList = null,\n    $title = null,\n    $getMore = null,\n    $searchListBox = null;\n\nvar selectedGoods = {};\n\nvar init = function(changedGoods, max /* 最多可选 */ ) {\n    var returnList = [];\n    selectedGoods = {};\n    // var selectedGoodsBak = {};\n    for (var i in changedGoods) {\n        changedList.push(i);\n        returnList.push(changedGoods[i]);\n    }\n\n    maxlength = max || 9;\n    selectedGoods = $.extend(true, selectedGoods, changedGoods);\n    if (maxlength - returnList.length !== 0) {\n        options = {\n            title: ' ',\n            modal: true,\n            fixed: true,\n            width: 610,\n            content: tpl({\n                imgSrc: $_CONFIG.imgpath,\n                returnList: returnList,\n                maxlength: maxlength,\n                changeNum: maxlength - returnList.length\n            }),\n            className: 'pop-box',\n            okValue: '插入商品',\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            btnWrapCls: 'insert-cancel',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n                dialogClosed();\n            },\n            cancel: function() {\n                dialogClosed();\n            },\n            onshow: function() {\n\n                $('[i=\"title\"]').hide();\n                getNode(); //获取节点\n                defaultItem(pageNum); //默认输出内容\n                searchItem(); //搜索商品\n                reGet(); //重新获取\n                changeItem(); //选择添加的商品\n                getMoreItem(); //加载 更多\n                $('body').css({\n                    height: '100%',\n                    overflowY: 'hidden'\n                });\n            }\n        };\n\n    } else {\n        options = {};\n    }\n\n    addDialog = dialog.create(options);\n    setTimeout(function() {\n        addDialog.show();\n    }, 100)\n\n};\n//获取节点\nvar getNode = function() {\n    $searchTop = $('[data-node=\"addTopBox\"]');\n    $searchInput = $searchTop.find('[data-action=\"addSearchInput\"]');\n    $searchBtn = $searchTop.find('[data-action=\"addSearchBtn\"]');\n    $searchNormal = $('[data-node=\"searchNormal\"]');\n    $searchLoading = $('[data-node=\"searchLoading\"]');\n    $searchFail = $('[data-node=\"searchFail\"]');\n    $searchResult = $('[data-node=\"searchResultBox\"]');\n    $searchList = $searchResult.find('[data-node=\"searchResultList\"]');\n    $listBox = $searchResult.find('[data-node=\"changedBox\"]');\n    $changeList = $listBox.find('[data-node=\"searchChangeList\"]');\n    $changeNum = $searchResult.find('[data-node=\"searchChangeNum\"]');\n    $title = $('[data-node=\"title\"]'),\n        $getMore = $searchResult.find('[data-action=\"moreItem\"]');\n    $searchListBox = $searchList.parent();\n};\n\n//初始化进弹窗获取数据\nvar defaultItem = function(pageNum) {\n    getItems(url.get('getCollectItem'), {\n        data: {\n            page: pageNum,\n            pagesize: 10\n        },\n        done: function(result) {\n            var html = defaultItemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//搜索 商品\nvar searchItem = function() {\n    $searchInput.on('keyup', function(e) {\n        var keycode = e.which;\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).val());\n        //处理回车的情况\n        if (keycode === 13) {\n            if (keyWord !== '') {\n                if (keyWord.length < 2) {\n                    alert('请输入两个字符以上关键词');\n                } else {\n                    pageNum = 1;\n                    $title.hide();\n                    $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                    moreItem(pageNum, keyWord);\n                }\n            } else {\n                alert('请输入关键词');\n            }\n        }\n        //返回我收藏的商品列表\n        if (keyWord === '') {\n            $searchResult.children().eq(0).hide();\n            isDefault = true;\n            pageNum = 1;\n            $title.show();\n            defaultItem(pageNum); //默认输出内容\n\n        }\n    });\n    $searchBtn.on('click', function() {\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).prev().val());\n\n        if (keyWord !== '') {\n            if (keyWord.length < 2) {\n                alert('请输入两个字符以上关键词');\n            } else {\n                $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                pageNum = 1;\n                $title.hide();\n                moreItem(pageNum, keyWord);\n            }\n        } else {\n            alert('请输入关键词');\n        }\n\n    });\n};\n\n//获取更多商品\n\nvar moreItem = function(pageNum, txt) {\n    getItems(url.get('getMoreItem'), {\n        data: {\n            pagenum: pageNum,\n            pagesize: 10,\n            word: txt\n        },\n        done: function(result) {\n            var html = itemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (result.pageCount != \"1\") {\n                $getMore.hide();\n            }\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//ajax\nvar getItems = function(link, options) {\n    if (pageNum === 1) {\n        $searchList.hide();\n        $searchFail.hide();\n        $searchLoading.show();\n        $searchNormal.hide();\n    } else {\n        $getMore.show();\n    }\n    fetch.get(link, {\n        data: options.data\n    }).done(function(result) {\n\n        if (result.code === 200) {\n            var resultItem = result.data.collections === undefined ? result.data.items : result.data.collections;\n            if ((!resultItem || resultItem.length === 0) && isDefault) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('暂无收藏的商品，可以搜索查找！');\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else if (!resultItem || resultItem.length === 0) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('没有找到相关产品');\n                    $searchResult.children().eq(0).hide();\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else {\n                $searchResult.show().children().eq(0).show();\n                $searchList.show();\n                options.done.call(this, result);\n                $getMore.hide();\n                isGetMore = false;\n\n                if (resultItem.length < 10 && pageNum !== 1) {\n\n                    isGetMore = true;\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            }\n\n            // 重新定位弹窗位置\n            // addDialog.reset();\n\n        } else if (result.code === 881001) {\n            if (pageNum === 1) {\n                $searchNormal.show().text('没有找到相关产品');\n                $searchResult.children().eq(0).hide();\n            } else {\n                $getMore.show().find('span').text('没有可加载内容');\n            }\n        } else {\n            if (pageNum === 1) {\n                $searchFail.show();\n            } else {\n                $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n            }\n        }\n    }).fail(function() {\n        if (pageNum === 1) {\n            $searchFail.show();\n        } else {\n            $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n        }\n    }).always(function() {\n        $searchLoading.hide();\n    });\n};\n\n//重新获取\nvar reGet = function() {\n    $searchFail.on('click', function() {\n        if (pageNum === 1) {\n            $searchLoading.show();\n            $searchFail.hide();\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n    $getMore.on('click', '[node-action=\"reget\"]', function() {\n        $(this).parent().html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n        if (isDefault) {\n            defaultItem(pageNum);\n        } else {\n            moreItem(pageNum, keyWord);\n        }\n    });\n};\n\nvar changeItem = function() {\n    if ($changeList.children().length) {\n        $('[i-id=ok]').removeClass('btn-default');\n    }\n    $searchResult.on('click', '[data-action=\"item\"]', function() {\n        var $this = $(this);\n        var imgSrc = $this.find('img').attr('src'),\n            pId = $this.attr('data-pId'),\n            shopId = $this.attr('data-shopid'),\n            itemLink = $this.attr('data-link'),\n            skuId = $this.attr('data-skuId'),\n            html = '';\n        if (maxlength == 1) {\n            if ($changeList.children().length) {\n                $changeList.empty();\n                $searchList.children(\"dl\").removeClass(\"chosed-mer-true\");\n\n            }\n            $this.addClass(\"chosed-mer-true\");\n\n            if ($changeList.children().length === 0) {\n                $listBox.show();\n            }\n            selectedGoods = {};\n            selectedGoods[skuId] = {\n                shopId: shopId,\n                skuId: skuId,\n                PId: pId,\n                title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                img: imgSrc,\n                price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                // 融合后的新商品链接\n                link: itemLink,\n            };\n            html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\n            $changeList.append(html);\n            $changeNum.text(maxlength - $changeList.children().length);\n        } else {\n\n            if (!$(this).hasClass('chosed-mer-true')) {\n                if ($changeList.children().length >= maxlength) {\n                    alert('最多可选取' + maxlength + '个商品');\n                    return false;\n                }\n\n                changedList.push(skuId);\n                selectedGoods[skuId] = {\n                    shopId: shopId,\n                    skuId: skuId,\n                    PId: pId,\n                    title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                    img: imgSrc,\n                    price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                    // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                    // 融合后的新商品链接\n                    link: $(this).attr('data-link'),\n                };\n                $(this).addClass('chosed-mer-true');\n                html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n                if ($changeList.children().length === 0) {\n                    $listBox.show();\n                }\n                $changeList.append(html);\n                $changeNum.text(maxlength - $changeList.children().length);\n            } else {\n                var del = $changeList.find('[data-skuId=\"' + skuId + '\"]');\n                $(this).removeClass('chosed-mer-true');\n                del.remove();\n\n                var id = $(this).attr('data-skuId');\n                var index = changedList.indexOf(id);\n                if (index !== -1) {\n                    changedList.splice(index, 1)\n                }\n                delete selectedGoods[id];\n                if ($changeList.children().length === 0) {\n                    $listBox.hide();\n                }\n                $changeNum.text(maxlength - $changeList.children().length);\n            }\n\n        }\n\n        if ($changeList.children().length) {\n            $('[i-id=ok]').removeClass('btn-default');\n        } else {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n\n        addDialog.reset();\n\n    }).on('click', '[data-action=\"delChanged\"]', function() {\n        var id = $(this).closest('li').attr('data-skuId');\n        var index = changedList.indexOf(id);\n        if (index !== -1) {\n            changedList.splice(index, 1)\n        }\n        var _this = this;\n        $searchList.find('[data-skuId=\"' + $(_this).parent().attr('data-skuId') + '\"]').removeClass('chosed-mer-true');\n\n        $(_this).parents('li').remove();\n        delete selectedGoods[id];\n        if ($changeList.children().length === 0) {\n            $listBox.hide();\n        }\n        $changeNum.text(maxlength - $changeList.children().length);\n        if (!$changeList.children().length) {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n    });\n};\n\n//加载更多\nvar getMoreItem = function() {\n    $searchListBox.on('scroll', function() {\n        if (!isGetMore && $searchListBox.scrollTop() >= ($searchList.height() - $searchListBox.height())) {\n            isGetMore = true;\n            pageNum++;\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n};\n\n//弹窗关闭\nvar dialogClosed = function() {\n    degree++;\n    $('body').css({\n        height: 'auto',\n        overflowY: 'auto'\n    });\n\n    $searchListBox.off('scroll');\n    $searchResult.off('click');\n    $searchFail.off('click');\n    $searchInput.off('keyup');\n    $searchBtn.off('click');\n    pageNum = 1;\n    // delChanged = [];\n    isDefault = true;\n    keyWord = '';\n    isGetMore = false;\n    changedList = [];\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/addGoods.js","var Dialog = require('dialog');\r\n\r\n\r\n\r\nvar create = function(options) {\r\n    options = options || {};\r\n    var defaults = {\r\n        title: ' ',\r\n        modal: true,\r\n        fixed: true,\r\n        width: 350,\r\n        content: '<p class=\"del-pop-p\">您最多能添加9个商品哦！</p>',\r\n        className: 'pop-box',\r\n        okValue: '确定',\r\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\r\n        ok: function() {\r\n\r\n        },\r\n        onshow: function() {\r\n            $('[i=\"title\"]').hide();\r\n        }\r\n    };\r\n    $.extend(true, defaults, options);\r\n    return Dialog(defaults);\r\n};\r\n\r\n\r\nmodule.exports = {\r\n    create: create\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/addGoods/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgSrc=$data.imgSrc,returnList=$data.returnList,$each=$utils.$each,$value=$data.$value,$index=$data.$index,changeNum=$data.changeNum,maxlength=$data.maxlength,$out='';$out+=' <div class=\"search-box\" data-node=\"addTopBox\"> <input type=\"text\" placeholder=\"搜索商品\" data-action=\"addSearchInput\"> <em class=\"icon-search-sw\" data-action=\"addSearchBtn\"></em> </div> <div class=\"ui-dialog-title\" data-node=\"title\">我收藏的商品</div> <p class=\"no-saving-txt\" style=\"display:none;\" data-node=\"searchNormal\">暂无收藏的商品，可以搜索查找！</p> <div class=\"loading\" data-node=\"searchLoading\"><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\" alt=\"\"></div> <p class=\"failed-txt\" style=\"display:none;\" data-node=\"searchFail\">数据获取失败，点击重新加载！</p> <div style=\"display:';\n$out+=$escape((returnList.length === 0 ? 'none':''));\n$out+=';\" data-node=\"searchResultBox\"> <div class=\"merchant-list clearfix\" > <div class=\"clearfix\" data-node=\"searchResultList\"></div> <div class=\"more-comments pop-more-com\" data-action=\"moreItem\" style=\"display:none;\"> <span><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\">正在加载...</span> </div> </div> <div class=\"chosed-merchants\" data-node=\"changedBox\" style=\"display:';\n$out+=$escape((returnList.length>0?'':'none'));\n$out+='\"> <ul class=\"merchants-list clearfix\" data-node=\"searchChangeList\"> ';\n$each(returnList,function($value,$index){\n$out+=' <li data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" data-pid=\"';\n$out+=$escape($value.PId);\n$out+='\"> <img src=\"';\n$out+=$escape($value.img);\n$out+='\" alt=\"\" onerror=\"imgError(this)\"> <a href=\"javascript:;\" data-action=\"delChanged\"> <em class=\"icon-del-pic\"></em> </a> </li> ';\n});\n$out+=' </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"searchChangeNum\">';\n$out+=$escape(changeNum);\n$out+='</span>/<span class=\"deep-gray\">';\n$out+=$escape(maxlength);\n$out+='</span>个商品</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/content.tpl\n// module id = 128\n// module chunks = 5 15 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/itemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$string=$utils.$string,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"11111\" onerror=\"imgError(this)\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$string($value.name);\n$out+='</h4> <span><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.salePrice !== null?$value.salePrice:'暂无售价');\n$out+='</span></span> </dd> </dl> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/itemContent.tpl\n// module id = 129\n// module chunks = 5 15 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/defaultItemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-shopId=\"';\n$out+=$escape($value.shopId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"\" onerror=\"imgError(this,\\'m\\')\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$escape($value.name);\n$out+='</h4><span><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.skuPrice);\n$out+='</span></span> </dd> </dl> ';\n});\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/defaultItemContent.tpl\n// module id = 130\n// module chunks = 5 15 29","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/goods/goods',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,$escape=$utils.$escape,$out='';$each(list,function(v,i){\n$out+='<p>&#8203<br></p><div data-node=\"gmp-ebox\" class=\"card-box\" contenteditable=\"false\"> <div data-type=\"insertGoods\" data-skuId=\"';\n$out+=$escape(v.skuId);\n$out+='\" data-pid=\"';\n$out+=$escape(v.PId);\n$out+='\" data-info=\\'{\"type\":\"item\",\"text\":\"\",\"id\":\"';\n$out+=$escape(v.PId);\n$out+='\",\"kid\":\"\", \"shopId\": \"';\n$out+=$escape(v.shopId);\n$out+='\",\"skuId\":\"';\n$out+=$escape(v.skuId);\n$out+='\"}\\' class=\"publish-item\"> <a href=\"';\n$out+=$escape(v.link);\n$out+='\" class=\"img-out\"> <img src=\"';\n$out+=$escape(v.img);\n$out+='\" data-node=\"goodsPic\"> </a> <div class=\"publish-cont\"> <h3 class=\"pub-tl\"> <a href=\"';\n$out+=$escape(v.link);\n$out+='\">';\n$out+=$escape(v.title);\n$out+='</a> </h3> <div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">';\n$out+=$escape(v.price);\n$out+='</strong> </div> <a href=\"';\n$out+=$escape(v.link);\n$out+='\" target=\"_blank\" class=\"scan-more\">查看详情</a> </div></div><div class=\"cover\">&nbsp;</div></div>';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/goods/goods.tpl\n// module id = 131\n// module chunks = 5 15","/**\n * @description\n * 处理不能正常删除图片\n *\n * @author 林飞\n */\n\nvar browser = baidu.editor.browser;\nvar gecko = browser.gecko ? browser.version : 0;\n\nUE.plugin.register('delImg', function() {\n    var me = this;\n    var domUtils = UE.dom.domUtils;\n    if (browser.version > 10 && !gecko) return; //ie10 以及chrome 不用处理\n    //设置光标位置\n    var setCursor = function(range, newNode, position) {\n\n            range.setStart(newNode);\n            if (position) {\n                range.setEnd(newNode, position);\n            } else {\n                range.setEnd(newNode, 0);\n            }\n\n            range.setCursor(true);\n        }\n        //删除节点\n    var deleteNode = function(node, evt) {\n        node.remove();\n        domUtils.preventDefault(evt);\n    }\n\n    //创建新行\n    var creatNewP = function(range, parent) {\n        var node = node;\n        var doc = me.document;\n\n        var newNode = doc.createElement('p');\n        var textNode = doc.createTextNode(\"\");\n        newNode.appendChild(textNode);\n\n        //插入当前节点前还是后\n        if (range.startOffset == 0) {\n            me.body.insertBefore(newNode, parent);\n        } else {\n            domUtils.insertAfter(parent, newNode);\n        }\n\n        setCursor(range, newNode);\n    }\n\n    me.addListener('keydown', function(evtName, evt) {\n        var keyCode = evt.keyCode || evt.which;\n        var range = me.selection.getRange();\n        var startContainer = range.startContainer;\n\n        var nodeName = startContainer.nodeName.toUpperCase();\n        var startOffset = range.startOffset;\n        var endOffset = range.endOffset;\n        var closedNode = range.getClosedNode();\n\n        var detectKey = function() {\n            switch (keyCode) {\n                case 8:\n                    backspaceKey();\n                    break;\n                case 46:\n                    deleteKey();\n                    break;\n                default:\n                    defaultKey();\n                    break;\n            }\n        }\n\n        //删除键\n        var backspaceKey = function() {\n                if (startOffset == 0) {\n                    //P的情况有以下几种：包括了 标题 h1,h2,h3\n                    //1.1 当前为<p>|</p>或(<p><img></p>), 上一级为<p><img></p> 要删除上一级，否则会和下一级合并\n                    //1.2 当前为<p><img></p>,上级为div 或者文本\n                    //1.3 当前为<p>|</p> 上一级为div 或者文本\n                    if (nodeName == \"#TEXT\") {\n                        var parentNode = startContainer.parentNode;\n\n                        var prev = parentNode.previousSibling;\n                        var $prev = $(prev);\n                        // console.log($prev.find(\"img\").length)\n                        if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                            deleteNode($prev, evt);\n                        }\n\n                    } else {\n                        var prev = startContainer.previousSibling;\n                        var $prev = $(prev);\n                        if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                            deleteNode($prev, evt);\n                        }\n                    }\n                    /*\n                                        if (nodeName == \"P\") {\n                                            var prev = startContainer.previousSibling;\n                                            var $prev = $(prev);\n                                            //第一种情况\n                                            if ($(startContainer).find(\"img\").length) {\n                                                //1.1\n                                                if ($prev.find(\"img\").length) {\n\n                                                    deleteNode($prev, evt);\n                                                } else {\n                                                    //1.2\n                                                    //前一个节点不是光标或者空节点\n                                                    if ($prev.text().replace(/[\\u200b]/gi, \"\") != \"\") {\n                                                        var last = prev.lastChild;\n                                                        //光标插入文本末端\n                                                        if (last.nodeName.toUpperCase() == \"#TEXT\") {\n                                                            var length = last.nodeValue.length;\n                                                            setCursor(range, last, length);\n                                                        } else if (last.nodeName.toUpperCase() == \"BR\") {\n                                                            //UE.dom.domUtils.remove( last, false );\n                                                            deleteNode($(last), false)\n                                                            domUtils.preventDefault(evt);\n                                                        }\n                                                    }\n                                                }\n                                                //第二种情况\n                                            } else if ($prev.find(\"img\").length) {\n                                                deleteNode($prev, evt);\n                                            }\n                                        }*/\n\n                    /* if (nodeName == \"#TEXT\") {\n                         var parentNode = startContainer.parentNode;\n                         var prev = parentNode.previousSibling;\n                         var $prev = $(prev);\n                         console.log($prev.find(\"img\").length)\n                         if ($prev.find(\"img\").length) {\n                             deleteNode($prev, evt);\n                         }\n                     }*/\n                }\n            }\n            // 往后删除键 恶心的玩意 害死人啊。。。\n        var deleteKey = function() {\n            if (startOffset != 0) return false;\n\n            if (nodeName == \"#TEXT\") {\n                var parentNode = startContainer.parentNode;\n\n                var prev = parentNode.previousSibling;\n                var $prev = $(prev);\n                // console.log($prev.find(\"img\").length)\n                console.log($prev && $prev.attr('data-node'))\n                if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                    if ($prev.find('.cover').hasClass('show')) {\n                        deleteNode($prev, evt);\n                    }\n\n                }\n\n            } else {\n                var prev = startContainer.previousSibling;\n                var $prev = $(prev);\n                if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                    if ($prev.find('.cover').hasClass('show')) {\n                        deleteNode($prev, evt);\n                    }\n                }\n            }\n            /* switch (nodeName) {\n                 //在<p><img>|</p>\n                 case \"P\":\n                     if ($(startContainer).find(\"img\").length && startOffset != 0) {\n                         if (startContainer.nextSibling) {\n                             setCursor(range, startContainer.nextSibling)\n                         }\n                     }\n                     break;\n                     //<p><img>光标|</p> 或者<p>xxxx<p>\n                 case \"#TEXT\":\n                     var parent = startContainer.parentNode;\n                     var $parent = $(parent);\n                     if ($parent.find(\"img\").length) {\n                         deleteNode($parent, evt)\n                     } else if (parent.lastChild == startContainer) {\n                         if (startOffset == startContainer.nodeValue.length) {\n                             var $nextNode = $(parent).next();\n                             if ($nextNode.find(\"img\").length) {\n                                 deleteNode($nextNode, evt)\n                             }\n                         }\n                     }\n                     break;\n             }*/\n        }\n\n        var defaultKey = function() {\n            if (closedNode && closedNode.tagName == \"IMG\") {\n                if (gecko) {\n                    //禁止火狐选中图片 用键盘字符替换造成标签溢出\n                    domUtils.preventDefault(evt);\n                } else {\n                    domUtils.remove(closedNode.parentNode, false);\n                }\n            } else if (nodeName == \"P\") {\n                if ($(startContainer).find(\"img\").length != 0) {\n                    creatNewP(range, startContainer);\n                }\n            } else if ($(startContainer).parent().find(\"img\").length != 0) {\n                var prentsNode = startContainer.parentNode;\n                creatNewP(range, prentsNode);\n            }\n        }\n\n        if (evt.ctrlKey || keyCode == 37 || keyCode == 38 || keyCode == 39 || keyCode == 40) {\n\n        } else {\n            detectKey();\n        }\n\n        window.imageTransformPopup.hide();\n    })\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/beforeInput.js","var grepHtml = require('editor/rewrite/grepRule');\nvar pastedCheckImg = require('./pastedCheckImg');\n/**\n * @description\n * 过滤粘贴进来的文本\n *\n * @author linfei\n */\nUE.plugin.register('grepPaste', function(e) {\n\n    var me = this;\n    var domUtils = UE.dom.domUtils;\n    me.addListener('beforepaste', function(type, html) {\n        html.html = grepHtml(me, html.html);\n        if (html.html.indexOf('src') !== -1) {\n            pastedCheckImg(me);\n        }\n\n    });\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/grepPaste.js","var alert = require('module/popup/alert');\nvar config = require('editor/config');\n//过滤回车特殊字符\nvar grepFormat = /[\\n]/gi;\n//匹配商品\nvar grepDiv = /<div (data-node=[\"']gmp-ebox.*?|class=[\"']publish-item.*?)<\\/div><\\/div>/gi;\n//匹配img\nvar grepImg = /<img.*?>/gi;\n//匹配src\nvar grepLocal = /( src=[\"'])https?:(\\/\\/.*?((meixincdn\\.com)|(((atguat)|(gomein))\\.net\\.cn)))/gi;\n//匹配表情\nvar grepFace = /data-face=['\"](.*?)['\"]/;\n\nfunction getHtml(html, num) {\n    var i = 0;\n    var overload = 0;\n\n    html = html.replace(grepImg, function(j) {\n        if (i < num) {\n            i++;\n            return j;\n        } else {\n            overload = 1;\n            return '';\n        }\n    })\n    return {\n        html: html,\n        overload: overload\n    };\n}\n\nfunction selectGetHtml(html, obj) {\n\n    var len = obj.len;\n\n    var innerImgLen = obj.innerImgLen; //粘贴板数量\n    var outerImgLen = obj.outerImgLen; //浏览器内数量\n    var limitNum = obj.limitNum; //限制数量\n    var maybe = innerImgLen + outerImgLen - limitNum;\n\n    return getHtml(html, limitNum - outerImgLen - len);\n}\n\nfunction grepHtml(editor, html) {\n    var me = editor;\n    var limitNum = config.imgLimitNUm;\n    var tempHtml = html;\n    //检测图片数量\n    function checkNum(str) {\n        var innerImg = str.match(grepImg),\n            innerImgLen = innerImg ? innerImg.length : 0; //粘贴板 图片数量\n\n        var outerImg = me.getContent().replace(grepDiv, '')\n            .match(grepImg),\n            outerImgLen = outerImg ? outerImg.length : 0; //编辑器区域 图片数量\n\n        var range = me.selection.getRange(),\n            startContainer = range.startContainer,\n            endContainer = range.endContainer,\n            startOffset = range.startOffset,\n            endOffset = range.endOffset;\n\n        var useAlert = innerImgLen + outerImgLen - limitNum\n        if (useAlert >= 0) {\n            var case_1 = startContainer == endContainer && startOffset != endOffset;\n            var case_2 = startContainer != endContainer;\n            if (case_1 || case_2) {\n                var fragment = range.cloneContents(),\n                    node = document.createElement(\"div\");\n\n                node.appendChild(fragment);\n\n                var html = node.innerHTML;\n\n                var len = html.match(grepImg).length;\n                return selectGetHtml(tempHtml, {\n                    limitNum: limitNum,\n                    outerImgLen: outerImgLen,\n                    innerImgLen: innerImgLen,\n                    len: len\n                })\n            }\n            return getHtml(tempHtml, limitNum - outerImgLen);\n        }\n        return false;\n    }\n\n    var h = checkNum(tempHtml)\n\n    if (h) {\n        if (h.overload) {\n            if (!$(\".pop-box-backdrop\").length) {\n                alert('您最多能添加' + limitNum + '张图片哦！');\n                return h.html;\n            }\n        }\n    }\n    return tempHtml;\n}\n\nmodule.exports = grepHtml;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/grepRule.js","var imgPath = $GLOBAL_CONFIG['pcimgpath'];\nvar fetch = require('io/fetch')\nvar url = require('io/url')\n\nvar imgReplace = require('utils/imgReplace');\n\n//var grepLocal = /^https?\\:\\/\\/(i|js).*?meixincdn\\.com/;\nvar grepLocal = /\\/\\/(((i|js).*?meixincdn\\.com)|.*?((atguat)|(gomein))\\.net\\.cn)/i;\nvar defaultImg = imgReplace.imgReplace(imgPath) + '/images/editor/spacer.jpg';\n\nvar setImgPath = function(o, src, useDefault) {\n    if (useDefault) {\n        o.src = defaultImg;\n        o.setAttribute('_src', defaultImg);\n    } else {\n        if (typeof src == 'object') {\n            src = src[0];\n        }\n        o.src = imgReplace.imgReplace(src);\n        o.setAttribute('_src', imgReplace.imgReplace(src));\n        o.setAttribute('proto', imgReplace.imgProto(src));\n    }\n}\nvar pastedCheckImg = function(ue) {\n    setTimeout(function() {\n        var $imgs = $(ue.body).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]');\n\n        for (let i = 0, len = $imgs.length; i < len; i++) {\n            let _img = $imgs[i];\n            let src = _img.src;\n            let _src = $(_img).attr('_src');\n            let test_src = grepLocal.test(_src) || grepLocal.test(src);\n\n            if (!test_src) {\n                fetch\n                    .post(url.get('topicUrlUpload2'), {\n                        data: {\n                            src: src\n                        },\n                    })\n                    .done(function(data) {\n                        if (data.success == true) {\n                            var src = data.data;\n\n                            if (src.length) {\n                                setImgPath(_img, src)\n                            } else {\n                                setImgPath(_img, defaultImg, true)\n                            }\n\n                        } else {\n\n                            setImgPath(_img, defaultImg, true)\n\n                        }\n\n                    })\n                    .fail(function() {\n                        setImgPath(_img, defaultImg, true)\n\n                    })\n                    .always(function(data) {\n                        //firing = 0;\n                    })\n            } else {\n                var proto = $(_img).attr(\"proto\");\n                var thisSrc = imgReplace.imgReplace(src);\n                if (!proto) {\n                    proto = imgReplace.imgProto(src)\n                    $(_img)\n                        .attr({\n                            'src': thisSrc,\n                            '_src': thisSrc,\n                            'proto': proto\n                        })\n                        //.attr('_src', proto + thisSrc);\n                } else {\n                    $(_img)\n                        .attr({\n                            'src': thisSrc,\n                            '_src': thisSrc\n                        })\n                }\n\n            }\n\n        }\n\n    }, 500)\n\n}\nmodule.exports = pastedCheckImg\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/pastedCheckImg.js","//var grepHtml = require('editor/rewrite/grepRule');\n/**\n * @description \n * 过滤拖拽进来的文本\n * \n * @author linfei\n */\n\n\nUE.plugin.register('grepDrop', function (){\n    var me = this;\n    var body = me.body;\n    var domUtils = UE.dom.domUtils;\n    var target = 0; //判断是否是当前页面做拖拽\n    var browser = baidu.editor.browser;\n    var ieVersion = browser.ie ? browser.version : 0;\n    var dropStr = \"\";   //专门用于ie 【drop】inserthtml 使用到\n    var tempRange = \"\";  //存放拽入的选区 \n    var dropToP = 0;//是否拖拽进入P标签\n\n    var grepRule = {\n\n            grepFormat : /[\\n]/gi,\n\n            grepCursor : /[\\u200b]/gi,  //光标\n\n            grepImg : /(<img.*?>)/gi, \n\n            grepDiv : /<div class=[\"']card-box.*?i<\\/div><\\/div>/gi\n    }\n\n    //过滤html\n    var grepHtml = function(obj,isIe){\n        return  obj\n                    .replace(grepRule.grepFormat,'')\n                    .replace(grepRule.grepDiv,'')\n                    .replace(grepRule.grepCursor,'')\n                    .replace(grepRule.grepImg,function(i,j,k,l){\n\n                            if(isIe){\n                                return '<p>'+i+'</p>';\n                            }else{\n                                return  '<p>'+ i.replace('>','class=\"block\">') + '</p>';\n                            }                           \n                        }) \n    }\n\n    //创建新行\n    var creatNewP = function(parent,node,position){\n        var node = node;\n        var text = node.nodeValue;\n        var doc = me.document;\n\n        var newNode = doc.createElement('p');\n        var textNode = doc.createTextNode(text);\n        newNode.appendChild(textNode);\n        UE.dom.domUtils.remove( node, false );\n\n        //插入当前节点前还是后\n        if(position == 'before'){\n            me.body.insertBefore(newNode,parent);\n        }else{\n            domUtils.insertAfter(parent,newNode);\n        }\n    }\n    //渲染P标签\n    var renderP = function(node){     \n        var childNodes = node.childNodes;\n        var len = childNodes.length;\n        \n        var textOffset = -1;\n        var imgOffset = 0 ;\n        \n        for(var j = 0;j<len ;j++){\n            var _node = childNodes[j];\n            if(_node.nodeName.toUpperCase() == \"#TEXT\"){\n                var value = _node.nodeValue\n                                .replace(grepRule.grepCursor,'')\n                                .replace(\" \",'');\n                if(value){                                                \n                    textOffset = j;\n                }                                            \n            }\n            if(_node.nodeName.toUpperCase() == \"IMG\"){\n                imgOffset = j;\n            }\n        }\n        \n        //判断文本节点的位置\n        if(textOffset != -1){\n            var oldTextNode = childNodes[textOffset];\n            var position = textOffset < imgOffset ? 'before' :'after';\n            \n            creatNewP( node, oldTextNode, position );           \n        }\n        \n    }\n\n    var renderBody = function(){\n\n        if(dropToP == 1){\n            dropToP = 0;\n            return;\n        }\n\n        $body = $(me.body);\n        $body.find(\"img\").removeAttr(\"class\");\n        // 不能在P标签上加任何属性，会被过滤掉\n        var $imgs = $body.find(\"[data-type='insertImg']\");\n        var len = $imgs.length;\n        if( len ) {\n            for(var i = 0;i<len;i++){\n                var img = $imgs[i];\n                var imgPrent = img.parentNode;\n                renderP(imgPrent);  \n            }\n        }\n        dropToP = 0;\n    }\n\n    return {\n       bindEvents:{\n            'ready': function (){\n\n                var _body = me.body;\n                \n                //禁止商品拖拽\n                $(_body).delegate(\"div\",'dragstart',function(e){\n                    target = 0;\n                    domUtils.preventDefault(e);\n                })\n\n                $(_body).delegate(\"p\",'drop',function(e){\n                    \n                    var $this = $(this);\n                    var _this = this;\n                    setTimeout(function(){\n                        $(_body).find(\"img\").removeAttr(\"class\");\n                        if($this.find(\"img\").length!=0){\n                            renderP(_this);   \n                        }\n                    },100);\n                    dropToP = 1;\n                })\n\n                domUtils.on(document, 'dragstart', function(evt){\n                    target = 0;\n                })\n\n                domUtils.on(_body, 'dragstart', function(evt){                   \n                    target = 1;\n\n                    //ie是插入内容，其他浏览器是修改drag的内容\n                    if( ieVersion > 7){\n                        var range = me.selection.getRange();\n                        var fragment = range.cloneContents();\n                        var _node = document.createElement(\"div\");\n\n                        tempRange = range;\n\n                        _node.appendChild(fragment)\n                        dropStr =  _node.innerHTML;\n                        dropStr = grepHtml(dropStr); \n                    }else{\n                        var dataTransfer = evt.dataTransfer;\n                        var data = dataTransfer.getData(\"text/html\");\n                        data = grepHtml(data,false);\n                        dataTransfer.setData(\"text/html\",data);                        \n                    }           \n                })\n\n\n                domUtils.on(_body, 'drop', function(evt){\n                    var range = me.selection.getRange();\n                    if(!target){\n                        domUtils.preventDefault(evt);\n                    }\n\n                    if(ieVersion > 7){\n                        //要清空选区  并且 阻止默认触发事件，\n                        //否则会变成复制内容，两者缺一不可，很奇葩。。\n                        if(tempRange){\n                            tempRange.deleteContents();\n                        }\n                        me.execCommand(\"insertHtml\",dropStr);                    \n                        domUtils.preventDefault(evt);\n\n                    }\n\n                    setTimeout(function(){\n                        renderBody();\n                    },200);\n\n                    tempRange = \"\";\n                    target = 0;\n                    dropStr = \"\"; \n                })\n            } \n        }  \n    }\n})\n\n            \n        /*,备用\n\n        commands:{\n            'haha': {\n                execCommand: function (cmd, str) {\n                    //var range = me.selection.getRange();\n                    //range.select();\n                    //me.focus();\n                    me.execCommand(\"insertHtml\",str,true);                   \n                    //me.execCommand('anchor', 'anchor1')\n                }\n            }\n            \n        }*/\n    \n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/grepDrop.js","/**\n * 处理IE渲染延迟导致高度计算失误\n * \n * @林飞\n */\nUE.plugin.register('fixHeight', function (){\n    var me = this;     \n    var browser = baidu.editor.browser;\n    var ieVersion = browser.ie ? browser.version : 0;  \n\n    if(ieVersion > 7){\n    \tme.addListener('afterinserthtml', function() {\n\t    \tsetTimeout(function(){\n\t\t\t\tme.body.style.height=\"auto\";\n\t\t\t},500)\n\t    })\n    }\n      \n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/autoHeight.js","var fetch = require('io/fetch')\nvar url = require('io/url')\nvar alert = require('module/popup/alert');\nvar i18n = require('module/i18n');\nvar domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\nvar $picLoading;\nvar firing = 0;\n\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\n\nvar limitNum = config.imgLimitNUm;\nvar maxSize = 4 * 1024 * 1024;\nvar fetchData = function(src, editor) {\n    fetch\n    //.get('img.json', {})\n        .post(url.get('topicBase64Upload'), {\n            data: {\n                src: src\n            },\n            beforeSend: function() {\n                if (!$picLoading) {\n                    $picLoading = $('[data-node=\"picLoading\"]');\n                }\n                $picLoading.removeClass('hide');\n\n            }\n        })\n        .done(function(data) {\n            if (data.success == true) {\n                var datas = data.data\n                for (var i = 0, len = datas.length; i < len; i++) {\n                    var _datas = datas[i];\n                    var str = \"<p><img src='\" + imgReplace.imgReplace(_datas) + \"' _src='\" + _datas + \"' data-type='insertImg' proto = '\" + imgReplace.imgProto(_datas) + \"'></p>\";\n                    editor.execCommand(\"insertHtml\", str)\n\n                }\n            } else {\n                alert('上传失败,请重新上传');\n                firing = 0;\n                $picLoading.addClass('hide');\n            }\n\n        })\n        .always(function(data) {\n            firing = 0;\n            $picLoading.addClass('hide');\n\n        })\n}\n\nvar imgReader = function(file, editor) {\n    if (firing == 1) {\n        return false;\n    }\n    firing = 1;\n    var reader = new FileReader();\n\n    // 读取文件后将其显示在网页中\n    reader.onload = function(e) {\n        var img = new Image();\n        var data = e.target.result;\n\n        //图片压缩优化\n        var canvas = document.createElement(\"canvas\");\n        var context = canvas.getContext(\"2d\");\n        var imageBase64;\n\n        img.onload = function() {\n            var _w = img.width;\n            var _h = img.height;\n\n            canvas.width = _w;\n            canvas.height = _h;\n            context.drawImage(img, 0, 0);\n            imageBase64 = canvas.toDataURL(\"image/jpeg\");\n            fetchData(imageBase64, editor);\n        }\n\n        img.src = data;\n\n        domUtils.preventDefault(e)\n    };\n    // 读取文件\n    reader.readAsDataURL(file);\n};\n\nUE.plugin.register('autoupload', function() {\n    function getPasteImage(e) {\n        return e.clipboardData && e.clipboardData.items && e.clipboardData.items.length == 1 && /^image\\//.test(e.clipboardData.items[0].type) ? e.clipboardData.items : null;\n    }\n\n    function getDropImage(e) {\n        return e.dataTransfer && e.dataTransfer.files ? e.dataTransfer.files : null;\n    }\n\n    return {\n        outputRule: function(root) {\n            utils.each(root.getNodesByTagName('img'), function(n) {\n                if (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n                    n.parentNode.removeChild(n);\n                }\n            });\n            utils.each(root.getNodesByTagName('p'), function(n) {\n                if (/\\bloadpara\\b/.test(n.getAttr('class'))) {\n                    n.parentNode.removeChild(n);\n                }\n            });\n        },\n        bindEvents: {\n            //插入粘贴板的图片，拖放插入图片\n            'ready': function(e) {\n                var me = this;\n\n                if (window.FormData && window.FileReader) {\n\n                    domUtils.on(me.body, 'paste', function(e) {\n                        var hasImg = false,\n                            items;\n                        //获取粘贴板文件列表\n                        items = e.type == 'paste' ? getPasteImage(e) : getDropImage(e);\n                        if (items) {\n                            var len = items.length,\n                                file;\n\n                            while (len--) {\n                                file = items[len];\n                                if (file.getAsFile) file = file.getAsFile();\n                                if (file && file.size > 0) {\n                                    if (/image\\/\\w+/i.test(file.type)) { //判断为图片文件\n                                        if (firing) {\n                                            hasImg = true;\n                                            e.preventDefault();\n                                            return;\n                                        }\n                                        if (file.size > maxSize) {\n                                            hasImg = true;\n                                            e.preventDefault();\n                                            alert(i18n.upload.uploadError);\n                                            return;\n                                        } else {\n                                            var $content = $(me.getContent());\n                                            var insertedImgLen = $content.find('[data-type=insertImg]').length;\n\n                                            if (insertedImgLen < limitNum) {\n                                                imgReader(file, me);\n                                            } else {\n\n                                                var range = me.selection.getRange(),\n                                                    startContainer = range.startContainer,\n                                                    nodeName = startContainer.nodeName;\n\n                                                if (insertedImgLen == limitNum) {\n                                                    if (e.target.tagName == \"IMG\") {\n                                                        imgReader(file, me);\n                                                    }\n                                                } else {\n                                                    if (!$(\".pop-box-backdrop\").length) {\n                                                        alert('您最多能添加' + limitNum + '张图片哦！');\n                                                    }\n                                                }\n\n                                            }\n                                            hasImg = true;\n                                        }\n\n                                    }\n                                }\n                            }\n\n                            setTimeout(function() {\n                                imgReplace.changeSrc($(me.body));\n                            }, 2000)\n                            hasImg && e.preventDefault();\n                        }\n                    });\n                }\n            }\n        }\n    }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/autoUpload.js","if (window.navigator.userAgent.indexOf(\"MSIE\") >= 1) {\n    $(document).on(\"click\", '[href^=\"javascript\"]', function(e) {\n        e.preventDefault();\n    })\n}\n\ntop.window.onbeforeunload = function(e) {\n    if (!window.noAlertMessage) {\n        return ' ';\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/beforeUnload.js","//toolbar\nrequire('./toolbar');\n//按钮规则\nrequire('./buttonRules');\n//商品插入数量限制\nrequire(\"./insertGoods\");\n//浮层位置\nrequire(\"./fixPopPosition\");\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/index.js","require('./baseFont');\nrequire('./align');\nrequire('./list');\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/index.js","var domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\n//var domUtils = baidu.editor.dom.domUtils\n\nvar getContent = require('editor/utils/getContent');\n\nUE.plugins['basestyle'] = function() {\n\n    var basestyles = {\n            'bold': ['strong', 'b'],\n            'italic': ['em', 'i'],\n            'subscript': ['sub'],\n            'superscript': ['sup'],\n            'underline': ['u']\n        },\n        getObj = function(editor, tagNames) {\n            return domUtils.filterNodeList(editor.selection.getStartElementPath(), tagNames);\n        },\n        me = this;\n    //添加快捷键\n    me.addshortcutkey({\n        \"Bold\": \"ctrl+66\", //^B\n        \"Italic\": \"ctrl+73\", //^I\n        \"Underline\": \"ctrl+85\" //^U\n    });\n    me.addInputRule(function(root) {\n        utils.each(root.getNodesByTagName('b i'), function(node) {\n            switch (node.tagName) {\n                case 'b':\n                    node.tagName = 'strong';\n                    break;\n                case 'i':\n                    node.tagName = 'em';\n            }\n        });\n    });\n    for (var style in basestyles) {\n        (function(cmd, tagNames) {\n            me.commands[cmd] = {\n                execCommand: function(cmdName) {\n                    var range = me.selection.getRange(),\n                        obj = getObj(this, tagNames);\n\n                    /* range.select();\n\n                     var fragment = range.cloneContents(),\n                         node = document.createElement(\"div\");\n\n                     node.appendChild(fragment);\n                     */\n\n                    if (getContent(range).indexOf('gmp-ebox') != -1) {\n                        return false;\n                    }\n                    if (range.collapsed) {\n\n                        if (obj) {\n                            var tmpText = me.document.createTextNode('');\n                            range.insertNode(tmpText).removeInlineStyle(tagNames);\n                            range.setStartBefore(tmpText);\n                            domUtils.remove(tmpText);\n                        } else {\n                            var tmpNode = range.document.createElement(tagNames[0]);\n                            if (cmdName == 'superscript' || cmdName == 'subscript') {\n                                tmpText = me.document.createTextNode('');\n                                range.insertNode(tmpText)\n                                    .removeInlineStyle(['sub', 'sup'])\n                                    .setStartBefore(tmpText)\n                                    .collapse(true);\n                            }\n                            range.insertNode(tmpNode).setStart(tmpNode, 0);\n                        }\n                        range.collapse(true);\n                    } else {\n                        if (cmdName == 'superscript' || cmdName == 'subscript') {\n                            if (!obj || obj.tagName.toLowerCase() != cmdName) {\n                                range.removeInlineStyle(['sub', 'sup']);\n                            }\n                        }\n                        obj ? range.removeInlineStyle(tagNames) : range.applyInlineStyle(tagNames[0]);\n                    }\n                    range.select();\n                },\n                queryCommandState: function() {\n                    return getObj(this, tagNames) ? 1 : 0;\n                }\n            };\n        })(style, basestyles[style]);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/baseFont.js","var domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\n\nvar getContent = require('editor/utils/getContent');\n\nUE.plugins['justify'] = function() {\n    var me = this,\n        block = domUtils.isBlockElm,\n        defaultValue = {\n            left: 1,\n            right: 1,\n            center: 1,\n            justify: 1\n        },\n        doJustify = function(range, style) {\n            var bookmark = range.createBookmark(),\n                filterFn = function(node) {\n                    return node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n                };\n\n            range.enlarge(true);\n            var bookmark2 = range.createBookmark(),\n                current = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n                tmpRange = range.cloneRange(),\n                tmpNode;\n            while (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n                if (current.nodeType == 3 || !block(current)) {\n                    tmpRange.setStartBefore(current);\n                    while (current && current !== bookmark2.end && !block(current)) {\n                        tmpNode = current;\n                        current = domUtils.getNextDomNode(current, false, null, function(node) {\n                            return !block(node);\n                        });\n                    }\n                    tmpRange.setEndAfter(tmpNode);\n                    var common = tmpRange.getCommonAncestor();\n                    if (!domUtils.isBody(common) && block(common)) {\n                        domUtils.setStyles(common, utils.isString(style) ? {\n                            'text-align': style\n                        } : style);\n                        current = common;\n                    } else {\n                        var p = range.document.createElement('p');\n                        domUtils.setStyles(p, utils.isString(style) ? {\n                            'text-align': style\n                        } : style);\n                        var frag = tmpRange.extractContents();\n                        p.appendChild(frag);\n                        tmpRange.insertNode(p);\n                        current = p;\n                    }\n                    current = domUtils.getNextDomNode(current, false, filterFn);\n                } else {\n                    current = domUtils.getNextDomNode(current, true, filterFn);\n                }\n            }\n            return range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n        };\n\n    UE.commands['justify'] = {\n        execCommand: function(cmdName, align) {\n            var range = this.selection.getRange(),\n                txt;\n\n            if (getContent(range).indexOf('gmp-ebox') != -1) {\n                return false;\n            }\n\n            //闭合时单独处理\n            if (range.collapsed) {\n                txt = this.document.createTextNode('p');\n                range.insertNode(txt);\n            }\n            doJustify(range, align);\n            if (txt) {\n                range.setStartBefore(txt).collapse(true);\n                domUtils.remove(txt);\n            }\n\n            range.select();\n\n            return true;\n        },\n        queryCommandValue: function() {\n            var startNode = this.selection.getStart(),\n                value = domUtils.getComputedStyle(startNode, 'text-align');\n            return defaultValue[value] ? value : 'left';\n        },\n        queryCommandState: function() {\n            var start = this.selection.getStart(),\n                cell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\n            return cell ? -1 : 0;\n        }\n\n    };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/align.js","var domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\nvar browser = UE.browser\nvar dtd = UE.dom.dtd;\nvar getContent = require('editor/utils/getContent');\nvar grepDom = 'gmp-ebox';\n\nUE.plugins['list'] = function() {\n    var me = this,\n        notExchange = {\n            'TD': 1,\n            'PRE': 1,\n            'BLOCKQUOTE': 1\n        };\n    var customStyle = {\n        'cn': 'cn-1-',\n        'cn1': 'cn-2-',\n        'cn2': 'cn-3-',\n        'num': 'num-1-',\n        'num1': 'num-2-',\n        'num2': 'num-3-',\n        'dash': 'dash',\n        'dot': 'dot'\n    };\n\n    me.setOpt({\n        'autoTransWordToList': false,\n        'insertorderedlist': {\n            'num': '',\n            'num1': '',\n            'num2': '',\n            'cn': '',\n            'cn1': '',\n            'cn2': '',\n            'decimal': '',\n            'lower-alpha': '',\n            'lower-roman': '',\n            'upper-alpha': '',\n            'upper-roman': ''\n        },\n        'insertunorderedlist': {\n            'circle': '',\n            'disc': '',\n            'square': '',\n            'dash': '',\n            'dot': ''\n        },\n        listDefaultPaddingLeft: '30',\n        listiconpath: 'http://bs.baidu.com/listicon/',\n        maxListLevel: -1, //-1不限制\n        disablePInList: false\n    });\n\n    function listToArray(list) {\n        var arr = [];\n        for (var p in list) {\n            arr.push(p)\n        }\n        return arr;\n    }\n    var listStyle = {\n        'OL': listToArray(me.options.insertorderedlist),\n        'UL': listToArray(me.options.insertunorderedlist)\n    };\n    var liiconpath = me.options.listiconpath;\n\n    //根据用户配置，调整customStyle\n    for (var s in customStyle) {\n        if (!me.options.insertorderedlist.hasOwnProperty(s) && !me.options.insertunorderedlist.hasOwnProperty(s)) {\n            delete customStyle[s];\n        }\n    }\n\n    me.ready(function() {\n        var customCss = [];\n        for (var p in customStyle) {\n            if (p == 'dash' || p == 'dot') {\n                customCss.push('li.list-' + customStyle[p] + '{background-image:url(' + liiconpath + customStyle[p] + '.gif)}');\n                customCss.push('ul.custom_' + p + '{list-style:none;}ul.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n            } else {\n                for (var i = 0; i < 99; i++) {\n                    customCss.push('li.list-' + customStyle[p] + i + '{background-image:url(' + liiconpath + 'list-' + customStyle[p] + i + '.gif)}')\n                }\n                customCss.push('ol.custom_' + p + '{list-style:none;}ol.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n            }\n            switch (p) {\n                case 'cn':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n                    break;\n                case 'cn1':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:30px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n                    break;\n                case 'cn2':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:40px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:55px}');\n                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:68px}');\n                    break;\n                case 'num':\n                case 'num1':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n                    break;\n                case 'num2':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:35px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n                    break;\n                case 'dash':\n                    customCss.push('li.list-' + p + '-paddingleft{padding-left:35px}');\n                    break;\n                case 'dot':\n                    customCss.push('li.list-' + p + '-paddingleft{padding-left:20px}');\n            }\n        }\n        customCss.push('.list-paddingleft-1{padding-left:0}');\n        customCss.push('.list-paddingleft-2{padding-left:' + me.options.listDefaultPaddingLeft + 'px}');\n        customCss.push('.list-paddingleft-3{padding-left:' + me.options.listDefaultPaddingLeft * 2 + 'px}');\n        //如果不给宽度会在自定应样式里出现滚动条\n        utils.cssRule('list', 'ol,ul{margin:0;pading:0;' + (browser.ie ? '' : 'width:95%') + '}li{clear:both;}' + customCss.join('\\n'), me.document);\n    });\n    //单独处理剪切的问题\n    me.ready(function() {\n        domUtils.on(me.body, 'cut', function() {\n            setTimeout(function() {\n                var rng = me.selection.getRange(),\n                    li;\n                //trace:3416\n                if (!rng.collapsed) {\n                    if (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n                        if (!li.nextSibling && domUtils.isEmptyBlock(li)) {\n                            var pn = li.parentNode,\n                                node;\n                            if (node = pn.previousSibling) {\n                                domUtils.remove(pn);\n                                rng.setStartAtLast(node).collapse(true);\n                                rng.select(true);\n                            } else if (node = pn.nextSibling) {\n                                domUtils.remove(pn);\n                                rng.setStartAtFirst(node).collapse(true);\n                                rng.select(true);\n                            } else {\n                                var tmpNode = me.document.createElement('p');\n                                domUtils.fillNode(me.document, tmpNode);\n                                pn.parentNode.insertBefore(tmpNode, pn);\n                                domUtils.remove(pn);\n                                rng.setStart(tmpNode, 0).collapse(true);\n                                rng.select(true);\n                            }\n                        }\n                    }\n                }\n\n            })\n        })\n    });\n\n    function getStyle(node) {\n        var cls = node.className;\n        if (domUtils.hasClass(node, /custom_/)) {\n            return cls.match(/custom_(\\w+)/)[1]\n        }\n        return domUtils.getStyle(node, 'list-style-type')\n\n    }\n\n    me.addListener('beforepaste', function(type, html) {\n        var me = this,\n            rng = me.selection.getRange(),\n            li;\n        var root = UE.htmlparser(html.html, true);\n        if (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n            var list = li.parentNode,\n                tagName = list.tagName == 'OL' ? 'ul' : 'ol';\n            utils.each(root.getNodesByTagName(tagName), function(n) {\n                n.tagName = list.tagName;\n                n.setAttr();\n                if (n.parentNode === root) {\n                    type = getStyle(list) || (list.tagName == 'OL' ? 'decimal' : 'disc')\n                } else {\n                    var className = n.parentNode.getAttr('class');\n                    if (className && /custom_/.test(className)) {\n                        type = className.match(/custom_(\\w+)/)[1]\n                    } else {\n                        type = n.parentNode.getStyle('list-style-type');\n                    }\n                    if (!type) {\n                        type = list.tagName == 'OL' ? 'decimal' : 'disc';\n                    }\n                }\n                var index = utils.indexOf(listStyle[list.tagName], type);\n                if (n.parentNode !== root)\n                    index = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n                var currentStyle = listStyle[list.tagName][index];\n                if (customStyle[currentStyle]) {\n                    n.setAttr('class', 'custom_' + currentStyle)\n\n                } else {\n                    n.setStyle('list-style-type', currentStyle)\n                }\n            })\n\n        }\n\n        html.html = root.toHtml();\n    });\n    //导出时，去掉p标签\n    me.getOpt('disablePInList') === true && me.addOutputRule(function(root) {\n        utils.each(root.getNodesByTagName('li'), function(li) {\n            var newChildrens = [],\n                index = 0;\n            utils.each(li.children, function(n) {\n                if (n.tagName == 'p') {\n                    var tmpNode;\n                    while (tmpNode = n.children.pop()) {\n                        newChildrens.splice(index, 0, tmpNode);\n                        tmpNode.parentNode = li;\n                        lastNode = tmpNode;\n                    }\n                    tmpNode = newChildrens[newChildrens.length - 1];\n                    if (!tmpNode || tmpNode.type != 'element' || tmpNode.tagName != 'br') {\n                        var br = UE.uNode.createElement('br');\n                        br.parentNode = li;\n                        newChildrens.push(br);\n                    }\n\n                    index = newChildrens.length;\n                }\n            });\n            if (newChildrens.length) {\n                li.children = newChildrens;\n            }\n        });\n    });\n    //进入编辑器的li要套p标签\n    me.addInputRule(function(root) {\n        utils.each(root.getNodesByTagName('li'), function(li) {\n            var tmpP = UE.uNode.createElement('p');\n            for (var i = 0, ci; ci = li.children[i];) {\n                if (ci.type == 'text' || dtd.p[ci.tagName]) {\n                    tmpP.appendChild(ci);\n                } else {\n                    if (tmpP.firstChild()) {\n                        li.insertBefore(tmpP, ci);\n                        tmpP = UE.uNode.createElement('p');\n                        i = i + 2;\n                    } else {\n                        i++;\n                    }\n\n                }\n            }\n            if (tmpP.firstChild() && !tmpP.parentNode || !li.firstChild()) {\n                li.appendChild(tmpP);\n            }\n            //trace:3357\n            //p不能为空\n            if (!tmpP.firstChild()) {\n                tmpP.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n            }\n            //去掉末尾的空白\n            var p = li.firstChild();\n            var lastChild = p.lastChild();\n            if (lastChild && lastChild.type == 'text' && /^\\s*$/.test(lastChild.data)) {\n                p.removeChild(lastChild)\n            }\n        });\n        if (me.options.autoTransWordToList) {\n            var orderlisttype = {\n                    'num1': /^\\d+\\)/,\n                    'decimal': /^\\d+\\./,\n                    'lower-alpha': /^[a-z]+\\)/,\n                    'upper-alpha': /^[A-Z]+\\./,\n                    'cn': /^[\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+[\\u3001]/,\n                    'cn2': /^\\([\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+\\)/\n                },\n                unorderlisttype = {\n                    'square': 'n'\n                };\n\n            function checkListType(content, container) {\n                var span = container.firstChild();\n                if (span && span.type == 'element' && span.tagName == 'span' && /Wingdings|Symbol/.test(span.getStyle('font-family'))) {\n                    for (var p in unorderlisttype) {\n                        if (unorderlisttype[p] == span.data) {\n                            return p\n                        }\n                    }\n                    return 'disc'\n                }\n                for (var p in orderlisttype) {\n                    if (orderlisttype[p].test(content)) {\n                        return p;\n                    }\n                }\n\n            }\n            utils.each(root.getNodesByTagName('p'), function(node) {\n                if (node.getAttr('class') != 'MsoListParagraph') {\n                    return\n                }\n\n                //word粘贴过来的会带有margin要去掉,但这样也可能会误命中一些央视\n                node.setStyle('margin', '');\n                node.setStyle('margin-left', '');\n                node.setAttr('class', '');\n\n                function appendLi(list, p, type) {\n                    if (list.tagName == 'ol') {\n                        if (browser.ie) {\n                            var first = p.firstChild();\n                            if (first.type == 'element' && first.tagName == 'span' && orderlisttype[type].test(first.innerText())) {\n                                p.removeChild(first);\n                            }\n                        } else {\n                            p.innerHTML(p.innerHTML().replace(orderlisttype[type], ''));\n                        }\n                    } else {\n                        p.removeChild(p.firstChild())\n                    }\n\n                    var li = UE.uNode.createElement('li');\n                    li.appendChild(p);\n                    list.appendChild(li);\n                }\n                var tmp = node,\n                    type, cacheNode = node;\n\n                if (node.parentNode.tagName != 'li' && (type = checkListType(node.innerText(), node))) {\n\n                    var list = UE.uNode.createElement(me.options.insertorderedlist.hasOwnProperty(type) ? 'ol' : 'ul');\n                    if (customStyle[type]) {\n                        list.setAttr('class', 'custom_' + type)\n                    } else {\n                        list.setStyle('list-style-type', type)\n                    }\n                    while (node && node.parentNode.tagName != 'li' && checkListType(node.innerText(), node)) {\n                        tmp = node.nextSibling();\n                        if (!tmp) {\n                            node.parentNode.insertBefore(list, node)\n                        }\n                        appendLi(list, node, type);\n                        node = tmp;\n                    }\n                    if (!list.parentNode && node && node.parentNode) {\n                        node.parentNode.insertBefore(list, node)\n                    }\n                }\n                var span = cacheNode.firstChild();\n                if (span && span.type == 'element' && span.tagName == 'span' && /^\\s*(&nbsp;)+\\s*$/.test(span.innerText())) {\n                    span.parentNode.removeChild(span)\n                }\n            })\n        }\n\n    });\n\n    //调整索引标签\n    me.addListener('contentchange', function() {\n        adjustListStyle(me.document)\n    });\n\n    function adjustListStyle(doc, ignore) {\n        utils.each(domUtils.getElementsByTagName(doc, 'ol ul'), function(node) {\n\n            if (!domUtils.inDoc(node, doc))\n                return;\n\n            var parent = node.parentNode;\n            if (parent.tagName == node.tagName) {\n                var nodeStyleType = getStyle(node) || (node.tagName == 'OL' ? 'decimal' : 'disc'),\n                    parentStyleType = getStyle(parent) || (parent.tagName == 'OL' ? 'decimal' : 'disc');\n                if (nodeStyleType == parentStyleType) {\n                    var styleIndex = utils.indexOf(listStyle[node.tagName], nodeStyleType);\n                    styleIndex = styleIndex + 1 == listStyle[node.tagName].length ? 0 : styleIndex + 1;\n                    setListStyle(node, listStyle[node.tagName][styleIndex])\n                }\n\n            }\n            var index = 0,\n                type = 2;\n            if (domUtils.hasClass(node, /custom_/)) {\n                if (!(/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/))) {\n                    type = 1;\n                }\n            } else {\n                if (/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/)) {\n                    type = 3;\n                }\n            }\n\n            var style = domUtils.getStyle(node, 'list-style-type');\n            style && (node.style.cssText = 'list-style-type:' + style);\n            node.className = utils.trim(node.className.replace(/list-paddingleft-\\w+/, '')) + ' list-paddingleft-' + type;\n            utils.each(domUtils.getElementsByTagName(node, 'li'), function(li) {\n                li.style.cssText && (li.style.cssText = '');\n                if (!li.firstChild) {\n                    domUtils.remove(li);\n                    return;\n                }\n                if (li.parentNode !== node) {\n                    return;\n                }\n                index++;\n                if (domUtils.hasClass(node, /custom_/)) {\n                    var paddingLeft = 1,\n                        currentStyle = getStyle(node);\n                    if (node.tagName == 'OL') {\n                        if (currentStyle) {\n                            switch (currentStyle) {\n                                case 'cn':\n                                case 'cn1':\n                                case 'cn2':\n                                    if (index > 10 && (index % 10 == 0 || index > 10 && index < 20)) {\n                                        paddingLeft = 2\n                                    } else if (index > 20) {\n                                        paddingLeft = 3\n                                    }\n                                    break;\n                                case 'num2':\n                                    if (index > 9) {\n                                        paddingLeft = 2\n                                    }\n                            }\n                        }\n                        li.className = 'list-' + customStyle[currentStyle] + index + ' ' + 'list-' + currentStyle + '-paddingleft-' + paddingLeft;\n                    } else {\n                        li.className = 'list-' + customStyle[currentStyle] + ' ' + 'list-' + currentStyle + '-paddingleft';\n                    }\n                } else {\n                    li.className = li.className.replace(/list-[\\w\\-]+/gi, '');\n                }\n                var className = li.getAttribute('class');\n                if (className !== null && !className.replace(/\\s/g, '')) {\n                    domUtils.removeAttributes(li, 'class')\n                }\n            });\n            !ignore && adjustList(node, node.tagName.toLowerCase(), getStyle(node) || domUtils.getStyle(node, 'list-style-type'), true);\n        })\n    }\n\n    function adjustList(list, tag, style, ignoreEmpty) {\n        var nextList = list.nextSibling;\n        if (nextList && nextList.nodeType == 1 && nextList.tagName.toLowerCase() == tag && (getStyle(nextList) || domUtils.getStyle(nextList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n            domUtils.moveChild(nextList, list);\n            if (nextList.childNodes.length == 0) {\n                domUtils.remove(nextList);\n            }\n        }\n        if (nextList && domUtils.isFillChar(nextList)) {\n            domUtils.remove(nextList);\n        }\n        var preList = list.previousSibling;\n        if (preList && preList.nodeType == 1 && preList.tagName.toLowerCase() == tag && (getStyle(preList) || domUtils.getStyle(preList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n            domUtils.moveChild(list, preList);\n        }\n        if (preList && domUtils.isFillChar(preList)) {\n            domUtils.remove(preList);\n        }!ignoreEmpty && domUtils.isEmptyBlock(list) && domUtils.remove(list);\n        if (getStyle(list)) {\n            adjustListStyle(list.ownerDocument, true)\n        }\n    }\n\n    function setListStyle(list, style) {\n        if (customStyle[style]) {\n            list.className = 'custom_' + style;\n        }\n        try {\n            domUtils.setStyle(list, 'list-style-type', style);\n        } catch (e) {}\n    }\n\n    function clearEmptySibling(node) {\n        var tmpNode = node.previousSibling;\n        if (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n            domUtils.remove(tmpNode);\n        }\n        tmpNode = node.nextSibling;\n        if (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n            domUtils.remove(tmpNode);\n        }\n    }\n\n    me.addListener('keydown', function(type, evt) {\n        function preventAndSave() {\n            evt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n            me.fireEvent('contentchange');\n            me.undoManger && me.undoManger.save();\n        }\n\n        function findList(node, filterFn) {\n            while (node && !domUtils.isBody(node)) {\n                if (filterFn(node)) {\n                    return null\n                }\n                if (node.nodeType == 1 && /[ou]l/i.test(node.tagName)) {\n                    return node;\n                }\n                node = node.parentNode;\n            }\n            return null;\n        }\n        var keyCode = evt.keyCode || evt.which;\n        if (keyCode == 13 && !evt.shiftKey) { //回车\n            var rng = me.selection.getRange(),\n                parent = domUtils.findParent(rng.startContainer, function(node) {\n                    return domUtils.isBlockElm(node)\n                }, true),\n                li = domUtils.findParentByTagName(rng.startContainer, 'li', true);\n            if (parent && parent.tagName != 'PRE' && !li) {\n                var html = parent.innerHTML.replace(new RegExp(domUtils.fillChar, 'g'), '');\n                if (/^\\s*1\\s*\\.[^\\d]/.test(html)) {\n                    parent.innerHTML = html.replace(/^\\s*1\\s*\\./, '');\n                    rng.setStartAtLast(parent).collapse(true).select();\n                    me.__hasEnterExecCommand = true;\n                    me.execCommand('insertorderedlist');\n                    me.__hasEnterExecCommand = false;\n                }\n            }\n            var range = me.selection.getRange(),\n                start = findList(range.startContainer, function(node) {\n                    return node.tagName == 'TABLE';\n                }),\n                end = range.collapsed ? start : findList(range.endContainer, function(node) {\n                    return node.tagName == 'TABLE';\n                });\n\n            if (start && end && start === end) {\n\n                if (!range.collapsed) {\n                    start = domUtils.findParentByTagName(range.startContainer, 'li', true);\n                    end = domUtils.findParentByTagName(range.endContainer, 'li', true);\n                    if (start && end && start === end) {\n                        range.deleteContents();\n                        li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n                        if (li && domUtils.isEmptyBlock(li)) {\n\n                            pre = li.previousSibling;\n                            next = li.nextSibling;\n                            p = me.document.createElement('p');\n\n                            domUtils.fillNode(me.document, p);\n                            parentList = li.parentNode;\n                            if (pre && next) {\n                                range.setStart(next, 0).collapse(true).select(true);\n                                domUtils.remove(li);\n\n                            } else {\n                                if (!pre && !next || !pre) {\n\n                                    parentList.parentNode.insertBefore(p, parentList);\n\n                                } else {\n                                    li.parentNode.parentNode.insertBefore(p, parentList.nextSibling);\n                                }\n                                domUtils.remove(li);\n                                if (!parentList.firstChild) {\n                                    domUtils.remove(parentList);\n                                }\n                                range.setStart(p, 0).setCursor();\n\n                            }\n                            preventAndSave();\n                            return;\n\n                        }\n                    } else {\n                        var tmpRange = range.cloneRange(),\n                            bk = tmpRange.collapse(false).createBookmark();\n\n                        range.deleteContents();\n                        tmpRange.moveToBookmark(bk);\n                        var li = domUtils.findParentByTagName(tmpRange.startContainer, 'li', true);\n\n                        clearEmptySibling(li);\n                        tmpRange.select();\n                        preventAndSave();\n                        return;\n                    }\n                }\n\n                li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\n                if (li) {\n                    if (domUtils.isEmptyBlock(li)) {\n                        bk = range.createBookmark();\n                        var parentList = li.parentNode;\n                        if (li !== parentList.lastChild) {\n                            domUtils.breakParent(li, parentList);\n                            clearEmptySibling(li);\n                        } else {\n\n                            parentList.parentNode.insertBefore(li, parentList.nextSibling);\n                            if (domUtils.isEmptyNode(parentList)) {\n                                domUtils.remove(parentList);\n                            }\n                        }\n                        //嵌套不处理\n                        if (!dtd.$list[li.parentNode.tagName]) {\n\n                            if (!domUtils.isBlockElm(li.firstChild)) {\n                                p = me.document.createElement('p');\n                                li.parentNode.insertBefore(p, li);\n                                while (li.firstChild) {\n                                    p.appendChild(li.firstChild);\n                                }\n                                domUtils.remove(li);\n                            } else {\n                                domUtils.remove(li, true);\n                            }\n                        }\n                        range.moveToBookmark(bk).select();\n\n                    } else {\n                        var first = li.firstChild;\n                        if (!first || !domUtils.isBlockElm(first)) {\n                            var p = me.document.createElement('p');\n\n                            !li.firstChild && domUtils.fillNode(me.document, p);\n                            while (li.firstChild) {\n\n                                p.appendChild(li.firstChild);\n                            }\n                            li.appendChild(p);\n                            first = p;\n                        }\n\n                        var span = me.document.createElement('span');\n\n                        range.insertNode(span);\n                        domUtils.breakParent(span, li);\n\n                        var nextLi = span.nextSibling;\n                        first = nextLi.firstChild;\n\n                        if (!first) {\n                            p = me.document.createElement('p');\n\n                            domUtils.fillNode(me.document, p);\n                            nextLi.appendChild(p);\n                            first = p;\n                        }\n                        if (domUtils.isEmptyNode(first)) {\n                            first.innerHTML = '';\n                            domUtils.fillNode(me.document, first);\n                        }\n\n                        range.setStart(first, 0).collapse(true).shrinkBoundary().select();\n                        domUtils.remove(span);\n                        var pre = nextLi.previousSibling;\n                        if (pre && domUtils.isEmptyBlock(pre)) {\n                            pre.innerHTML = '<p></p>';\n                            domUtils.fillNode(me.document, pre.firstChild);\n                        }\n\n                    }\n                    //                        }\n                    preventAndSave();\n                }\n\n            }\n\n        }\n        if (keyCode == 8) {\n            //修中ie中li下的问题\n            range = me.selection.getRange();\n            if (range.collapsed && domUtils.isStartInblock(range)) {\n                tmpRange = range.cloneRange().trimBoundary();\n                li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n                //要在li的最左边，才能处理\n                if (li && domUtils.isStartInblock(tmpRange)) {\n                    start = domUtils.findParentByTagName(range.startContainer, 'p', true);\n                    if (start && start !== li.firstChild) {\n                        var parentList = domUtils.findParentByTagName(start, ['ol', 'ul']);\n                        domUtils.breakParent(start, parentList);\n                        clearEmptySibling(start);\n                        me.fireEvent('contentchange');\n                        range.setStart(start, 0).setCursor(false, true);\n                        me.fireEvent('saveScene');\n                        domUtils.preventDefault(evt);\n                        return;\n                    }\n\n                    if (li && (pre = li.previousSibling)) {\n                        if (keyCode == 46 && li.childNodes.length) {\n                            return;\n                        }\n                        //有可能上边的兄弟节点是个2级菜单，要追加到2级菜单的最后的li\n                        if (dtd.$list[pre.tagName]) {\n                            pre = pre.lastChild;\n                        }\n                        me.undoManger && me.undoManger.save();\n                        first = li.firstChild;\n                        if (domUtils.isBlockElm(first)) {\n                            if (domUtils.isEmptyNode(first)) {\n                                //                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n                                pre.appendChild(first);\n                                range.setStart(first, 0).setCursor(false, true);\n                                //first不是唯一的节点\n                                while (li.firstChild) {\n                                    pre.appendChild(li.firstChild);\n                                }\n                            } else {\n\n                                span = me.document.createElement('span');\n                                range.insertNode(span);\n                                //判断pre是否是空的节点,如果是<p><br/></p>类型的空节点，干掉p标签防止它占位\n                                if (domUtils.isEmptyBlock(pre)) {\n                                    pre.innerHTML = '';\n                                }\n                                domUtils.moveChild(li, pre);\n                                range.setStartBefore(span).collapse(true).select(true);\n\n                                domUtils.remove(span);\n\n                            }\n                        } else {\n                            if (domUtils.isEmptyNode(li)) {\n                                var p = me.document.createElement('p');\n                                pre.appendChild(p);\n                                range.setStart(p, 0).setCursor();\n                                //                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n                            } else {\n                                range.setEnd(pre, pre.childNodes.length).collapse().select(true);\n                                while (li.firstChild) {\n                                    pre.appendChild(li.firstChild);\n                                }\n                            }\n                        }\n                        domUtils.remove(li);\n                        me.fireEvent('contentchange');\n                        me.fireEvent('saveScene');\n                        domUtils.preventDefault(evt);\n                        return;\n\n                    }\n                    //trace:980\n\n                    if (li && !li.previousSibling) {\n                        var parentList = li.parentNode;\n                        var bk = range.createBookmark();\n                        if (domUtils.isTagNode(parentList.parentNode, 'ol ul')) {\n                            parentList.parentNode.insertBefore(li, parentList);\n                            if (domUtils.isEmptyNode(parentList)) {\n                                domUtils.remove(parentList)\n                            }\n                        } else {\n\n                            while (li.firstChild) {\n                                parentList.parentNode.insertBefore(li.firstChild, parentList);\n                            }\n\n                            domUtils.remove(li);\n                            if (domUtils.isEmptyNode(parentList)) {\n                                domUtils.remove(parentList)\n                            }\n\n                        }\n                        range.moveToBookmark(bk).setCursor(false, true);\n                        me.fireEvent('contentchange');\n                        me.fireEvent('saveScene');\n                        domUtils.preventDefault(evt);\n                        return;\n\n                    }\n\n                }\n\n            }\n\n        }\n    });\n\n    me.addListener('keyup', function(type, evt) {\n        var keyCode = evt.keyCode || evt.which;\n        if (keyCode == 8) {\n            var rng = me.selection.getRange(),\n                list;\n            if (list = domUtils.findParentByTagName(rng.startContainer, ['ol', 'ul'], true)) {\n                adjustList(list, list.tagName.toLowerCase(), getStyle(list) || domUtils.getComputedStyle(list, 'list-style-type'), true)\n            }\n        }\n    });\n    //处理tab键\n    me.addListener('tabkeydown', function() {\n\n        var range = me.selection.getRange();\n\n        //控制级数\n        function checkLevel(li) {\n            if (me.options.maxListLevel != -1) {\n                var level = li.parentNode,\n                    levelNum = 0;\n                while (/[ou]l/i.test(level.tagName)) {\n                    levelNum++;\n                    level = level.parentNode;\n                }\n                if (levelNum >= me.options.maxListLevel) {\n                    return true;\n                }\n            }\n        }\n        //只以开始为准\n        //todo 后续改进\n        var li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n        if (li) {\n\n            var bk;\n            if (range.collapsed) {\n                if (checkLevel(li))\n                    return true;\n                var parentLi = li.parentNode,\n                    list = me.document.createElement(parentLi.tagName),\n                    index = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n                index = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n                var currentStyle = listStyle[list.tagName][index];\n                setListStyle(list, currentStyle);\n                if (domUtils.isStartInblock(range)) {\n                    me.fireEvent('saveScene');\n                    bk = range.createBookmark();\n                    parentLi.insertBefore(list, li);\n                    list.appendChild(li);\n                    adjustList(list, list.tagName.toLowerCase(), currentStyle);\n                    me.fireEvent('contentchange');\n                    range.moveToBookmark(bk).select(true);\n                    return true;\n                }\n            } else {\n                me.fireEvent('saveScene');\n                bk = range.createBookmark();\n                for (var i = 0, closeList, parents = domUtils.findParents(li), ci; ci = parents[i++];) {\n                    if (domUtils.isTagNode(ci, 'ol ul')) {\n                        closeList = ci;\n                        break;\n                    }\n                }\n                var current = li;\n                if (bk.end) {\n                    while (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n                        if (checkLevel(current)) {\n                            current = domUtils.getNextDomNode(current, false, null, function(node) {\n                                return node !== closeList\n                            });\n                            continue;\n                        }\n                        var parentLi = current.parentNode,\n                            list = me.document.createElement(parentLi.tagName),\n                            index = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n                        var currentIndex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n                        var currentStyle = listStyle[list.tagName][currentIndex];\n                        setListStyle(list, currentStyle);\n                        parentLi.insertBefore(list, current);\n                        while (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n                            li = current.nextSibling;\n                            list.appendChild(current);\n                            if (!li || domUtils.isTagNode(li, 'ol ul')) {\n                                if (li) {\n                                    while (li = li.firstChild) {\n                                        if (li.tagName == 'LI') {\n                                            break;\n                                        }\n                                    }\n                                } else {\n                                    li = domUtils.getNextDomNode(current, false, null, function(node) {\n                                        return node !== closeList\n                                    });\n                                }\n                                break;\n                            }\n                            current = li;\n                        }\n                        adjustList(list, list.tagName.toLowerCase(), currentStyle);\n                        current = li;\n                    }\n                }\n                me.fireEvent('contentchange');\n                range.moveToBookmark(bk).select();\n                return true;\n            }\n        }\n\n    });\n\n    function getLi(start) {\n        while (start && !domUtils.isBody(start)) {\n            if (start.nodeName == 'TABLE') {\n                return null;\n            }\n            if (start.nodeName == 'LI') {\n                return start\n            }\n            start = start.parentNode;\n        }\n    }\n\n    /**\n     * 有序列表，与“insertunorderedlist”命令互斥\n     * @command insertorderedlist\n     * @method execCommand\n     * @param { String } command 命令字符串\n     * @param { String } style 插入的有序列表类型，值为：decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n     * @example\n     * ```javascript\n     * editor.execCommand( 'insertorderedlist','decimal');\n     * ```\n     */\n    /**\n     * 查询当前选区内容是否有序列表\n     * @command insertorderedlist\n     * @method queryCommandState\n     * @param { String } cmd 命令字符串\n     * @return { int } 如果当前选区是有序列表返回1，否则返回0\n     * @example\n     * ```javascript\n     * editor.queryCommandState( 'insertorderedlist' );\n     * ```\n     */\n    /**\n     * 查询当前选区内容是否有序列表\n     * @command insertorderedlist\n     * @method queryCommandValue\n     * @param { String } cmd 命令字符串\n     * @return { String } 返回当前有序列表的类型，值为null或decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n     * @example\n     * ```javascript\n     * editor.queryCommandValue( 'insertorderedlist' );\n     * ```\n     */\n\n    /**\n     * 无序列表，与“insertorderedlist”命令互斥\n     * @command insertunorderedlist\n     * @method execCommand\n     * @param { String } command 命令字符串\n     * @param { String } style 插入的无序列表类型，值为：circle,disc,square,dash,dot\n     * @example\n     * ```javascript\n     * editor.execCommand( 'insertunorderedlist','circle');\n     * ```\n     */\n    /**\n     * 查询当前是否有word文档粘贴进来的图片\n     * @command insertunorderedlist\n     * @method insertunorderedlist\n     * @param { String } command 命令字符串\n     * @return { int } 如果当前选区是无序列表返回1，否则返回0\n     * @example\n     * ```javascript\n     * editor.queryCommandState( 'insertunorderedlist' );\n     * ```\n     */\n    /**\n     * 查询当前选区内容是否有序列表\n     * @command insertunorderedlist\n     * @method queryCommandValue\n     * @param { String } command 命令字符串\n     * @return { String } 返回当前无序列表的类型，值为null或circle,disc,square,dash,dot\n     * @example\n     * ```javascript\n     * editor.queryCommandValue( 'insertunorderedlist' );\n     * ```\n     */\n\n    me.commands['insertorderedlist'] =\n        me.commands['insertunorderedlist'] = {\n            execCommand: function(command, style) {\n\n                if (!style) {\n                    style = command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc';\n                }\n                var me = this,\n                    range = this.selection.getRange(),\n                    filterFn = function(node) {\n                        return node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n                    },\n                    tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul',\n                    frag = me.document.createDocumentFragment();\n                //去掉是因为会出现选到末尾，导致adjustmentBoundary缩到ol/ul的位置\n                //range.shrinkBoundary();//.adjustmentBoundary();\n\n                if (getContent(range).indexOf(grepDom) != -1) {\n                    return false;\n                }\n                range.adjustmentBoundary().shrinkBoundary();\n                var bko = range.createBookmark(true),\n                    start = getLi(me.document.getElementById(bko.start)),\n                    modifyStart = 0,\n                    end = getLi(me.document.getElementById(bko.end)),\n                    modifyEnd = 0,\n                    startParent, endParent,\n                    list, tmp;\n\n                if (start || end) {\n                    start && (startParent = start.parentNode);\n                    if (!bko.end) {\n                        end = start;\n                    }\n                    end && (endParent = end.parentNode);\n\n                    if (startParent === endParent) {\n                        while (start !== end) {\n                            tmp = start;\n                            start = start.nextSibling;\n                            if (!domUtils.isBlockElm(tmp.firstChild)) {\n                                var p = me.document.createElement('p');\n                                while (tmp.firstChild) {\n                                    p.appendChild(tmp.firstChild);\n                                }\n                                tmp.appendChild(p);\n                            }\n                            frag.appendChild(tmp);\n                        }\n                        tmp = me.document.createElement('span');\n                        startParent.insertBefore(tmp, end);\n                        if (!domUtils.isBlockElm(end.firstChild)) {\n                            p = me.document.createElement('p');\n                            while (end.firstChild) {\n                                p.appendChild(end.firstChild);\n                            }\n                            end.appendChild(p);\n                        }\n                        frag.appendChild(end);\n                        domUtils.breakParent(tmp, startParent);\n                        if (domUtils.isEmptyNode(tmp.previousSibling)) {\n                            domUtils.remove(tmp.previousSibling);\n                        }\n                        if (domUtils.isEmptyNode(tmp.nextSibling)) {\n                            domUtils.remove(tmp.nextSibling)\n                        }\n                        var nodeStyle = getStyle(startParent) || domUtils.getComputedStyle(startParent, 'list-style-type') || (command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc');\n                        if (startParent.tagName.toLowerCase() == tag && nodeStyle == style) {\n                            for (var i = 0, ci, tmpFrag = me.document.createDocumentFragment(); ci = frag.firstChild;) {\n                                if (domUtils.isTagNode(ci, 'ol ul')) {\n                                    //                                  删除时，子列表不处理\n                                    //                                  utils.each(domUtils.getElementsByTagName(ci,'li'),function(li){\n                                    //                                        while(li.firstChild){\n                                    //                                            tmpFrag.appendChild(li.firstChild);\n                                    //                                        }\n                                    //\n                                    //                                    });\n                                    tmpFrag.appendChild(ci);\n                                } else {\n                                    while (ci.firstChild) {\n\n                                        tmpFrag.appendChild(ci.firstChild);\n                                        domUtils.remove(ci);\n                                    }\n                                }\n\n                            }\n                            tmp.parentNode.insertBefore(tmpFrag, tmp);\n                        } else {\n                            list = me.document.createElement(tag);\n                            setListStyle(list, style);\n                            list.appendChild(frag);\n                            tmp.parentNode.insertBefore(list, tmp);\n                        }\n\n                        domUtils.remove(tmp);\n                        list && adjustList(list, tag, style);\n                        range.moveToBookmark(bko).select();\n                        return;\n                    }\n                    //开始\n                    if (start) {\n                        while (start) {\n                            tmp = start.nextSibling;\n                            if (domUtils.isTagNode(start, 'ol ul')) {\n                                frag.appendChild(start);\n                            } else {\n                                var tmpfrag = me.document.createDocumentFragment(),\n                                    hasBlock = 0;\n                                while (start.firstChild) {\n                                    if (domUtils.isBlockElm(start.firstChild)) {\n                                        hasBlock = 1;\n                                    }\n                                    tmpfrag.appendChild(start.firstChild);\n                                }\n                                if (!hasBlock) {\n                                    var tmpP = me.document.createElement('p');\n                                    tmpP.appendChild(tmpfrag);\n                                    frag.appendChild(tmpP);\n                                } else {\n                                    frag.appendChild(tmpfrag);\n                                }\n                                domUtils.remove(start);\n                            }\n\n                            start = tmp;\n                        }\n                        startParent.parentNode.insertBefore(frag, startParent.nextSibling);\n                        if (domUtils.isEmptyNode(startParent)) {\n                            range.setStartBefore(startParent);\n                            domUtils.remove(startParent);\n                        } else {\n                            range.setStartAfter(startParent);\n                        }\n                        modifyStart = 1;\n                    }\n\n                    if (end && domUtils.inDoc(endParent, me.document)) {\n                        //结束\n                        start = endParent.firstChild;\n                        while (start && start !== end) {\n                            tmp = start.nextSibling;\n                            if (domUtils.isTagNode(start, 'ol ul')) {\n                                frag.appendChild(start);\n                            } else {\n                                tmpfrag = me.document.createDocumentFragment();\n                                hasBlock = 0;\n                                while (start.firstChild) {\n                                    if (domUtils.isBlockElm(start.firstChild)) {\n                                        hasBlock = 1;\n                                    }\n                                    tmpfrag.appendChild(start.firstChild);\n                                }\n                                if (!hasBlock) {\n                                    tmpP = me.document.createElement('p');\n                                    tmpP.appendChild(tmpfrag);\n                                    frag.appendChild(tmpP);\n                                } else {\n                                    frag.appendChild(tmpfrag);\n                                }\n                                domUtils.remove(start);\n                            }\n                            start = tmp;\n                        }\n                        var tmpDiv = domUtils.createElement(me.document, 'div', {\n                            'tmpDiv': 1\n                        });\n                        domUtils.moveChild(end, tmpDiv);\n\n                        frag.appendChild(tmpDiv);\n                        domUtils.remove(end);\n                        endParent.parentNode.insertBefore(frag, endParent);\n                        range.setEndBefore(endParent);\n                        if (domUtils.isEmptyNode(endParent)) {\n                            domUtils.remove(endParent);\n                        }\n\n                        modifyEnd = 1;\n                    }\n\n                }\n\n                if (!modifyStart) {\n                    range.setStartBefore(me.document.getElementById(bko.start));\n                }\n                if (bko.end && !modifyEnd) {\n                    range.setEndAfter(me.document.getElementById(bko.end));\n                }\n                range.enlarge(true, function(node) {\n                    return notExchange[node.tagName];\n                });\n\n                frag = me.document.createDocumentFragment();\n\n                var bk = range.createBookmark(),\n                    current = domUtils.getNextDomNode(bk.start, false, filterFn),\n                    tmpRange = range.cloneRange(),\n                    tmpNode,\n                    block = domUtils.isBlockElm;\n\n                while (current && current !== bk.end && (domUtils.getPosition(current, bk.end) & domUtils.POSITION_PRECEDING)) {\n\n                    if (current.nodeType == 3 || dtd.li[current.tagName]) {\n                        if (current.nodeType == 1 && dtd.$list[current.tagName]) {\n                            while (current.firstChild) {\n                                frag.appendChild(current.firstChild);\n                            }\n                            tmpNode = domUtils.getNextDomNode(current, false, filterFn);\n                            domUtils.remove(current);\n                            current = tmpNode;\n                            continue;\n\n                        }\n                        tmpNode = current;\n                        tmpRange.setStartBefore(current);\n\n                        while (current && current !== bk.end && (!block(current) || domUtils.isBookmarkNode(current))) {\n                            tmpNode = current;\n                            current = domUtils.getNextDomNode(current, false, null, function(node) {\n                                return !notExchange[node.tagName];\n                            });\n                        }\n\n                        if (current && block(current)) {\n                            tmp = domUtils.getNextDomNode(tmpNode, false, filterFn);\n                            if (tmp && domUtils.isBookmarkNode(tmp)) {\n                                current = domUtils.getNextDomNode(tmp, false, filterFn);\n                                tmpNode = tmp;\n                            }\n                        }\n                        tmpRange.setEndAfter(tmpNode);\n\n                        current = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\n                        var li = range.document.createElement('li');\n\n                        li.appendChild(tmpRange.extractContents());\n                        if (domUtils.isEmptyNode(li)) {\n                            var tmpNode = range.document.createElement('p');\n                            while (li.firstChild) {\n                                tmpNode.appendChild(li.firstChild)\n                            }\n                            li.appendChild(tmpNode);\n                        }\n                        frag.appendChild(li);\n                    } else {\n                        current = domUtils.getNextDomNode(current, true, filterFn);\n                    }\n                }\n                range.moveToBookmark(bk).collapse(true);\n                list = me.document.createElement(tag);\n                setListStyle(list, style);\n                list.appendChild(frag);\n                range.insertNode(list);\n                //当前list上下看能否合并\n                adjustList(list, tag, style);\n                //去掉冗余的tmpDiv\n                for (var i = 0, ci, tmpDivs = domUtils.getElementsByTagName(list, 'div'); ci = tmpDivs[i++];) {\n                    if (ci.getAttribute('tmpDiv')) {\n                        domUtils.remove(ci, true)\n                    }\n                }\n                range.moveToBookmark(bko).select();\n\n            },\n            queryCommandState: function(command) {\n                var tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n                var path = this.selection.getStartElementPath();\n                for (var i = 0, ci; ci = path[i++];) {\n                    if (ci.nodeName == 'TABLE') {\n                        return 0\n                    }\n                    if (tag == ci.nodeName.toLowerCase()) {\n                        return 1\n                    };\n                }\n                return 0;\n\n            },\n            queryCommandValue: function(command) {\n                var tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n                var path = this.selection.getStartElementPath(),\n                    node;\n                for (var i = 0, ci; ci = path[i++];) {\n                    if (ci.nodeName == 'TABLE') {\n                        node = null;\n                        break;\n                    }\n                    if (tag == ci.nodeName.toLowerCase()) {\n                        node = ci;\n                        break;\n                    };\n                }\n                return node ? getStyle(node) || domUtils.getComputedStyle(node, 'list-style-type') : null;\n            }\n        };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/list.js","baidu.editor.ui.Button.prototype.getHtmlTpl = function() {\n\n    /* if (!this.iconEle) {\n\n         var str;\n         switch (this.title) {\n             case \"加粗\":\n                 str = \"B\";\n                 break;\n             case \"斜体\":\n                 str = \"I\"\n                 break;\n             case \"下划线\":\n                 str = \"U\"\n                 break;\n             case \"有序列表\":\n                 str = \"有\"\n                 break;\n             case \"无序列表\":\n                 str = \"无\";\n                 break;\n             case \"居左对齐\":\n                 str = \"左\"\n                 break;\n             case \"居中对齐\":\n                 str = \"中\"\n                 break;\n             case \"居右对齐\":\n                 str = \"右\"\n                 break;\n             default:\n                 str = \"测试\";\n         }\n         this.iconEle = \"<em>\" + str + \"</em>\";\n     }\n     return '<div id=\"##\" class=\"edui-box %%\">' +\n         '<div id=\"##_state\" stateful>' +\n         '<div class=\"%%-wrap\">' +\n         '<a id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n         ' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\" href=\"javascript:;\" data-node=\"toolbarBtn\">' +\n         (this.showIcon ? this.iconEle : '') +\n         (this.showText ? '<span>' + this.label + '</span>' : '') +\n         '</a>' +\n         '</div>' +\n         '</div></div>';*/\n\n    return '<div id=\"##\" class=\"edui-box %%\">' +\n        '<div id=\"##_state\" stateful>' +\n        '<div class=\"%%-wrap\">' +\n        '<div id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n        ' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\">' +\n        (this.showIcon ? '<div class=\"edui-box edui-icon\"></div>' : '') +\n        /* (this.showText ? '<div class=\"edui-box edui-label\">' + this.label + '</div>' : '') +*/\n        '</div>' +\n        '</div>' +\n        '</div></div>';\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/buttonRules.js","var alert = require('module/popup/alert');\nvar config = require('editor/config');\n\nUE.commands['insertgoodshtml'] = {\n    execCommand: function(command, html, notNeedFilter) {\n        var me = this;\n        //限制商品数量\n        var limitNum = config.goodsLimitNUm;\n        var reg = /<div.*?gmp-ebox.*?>/gi;\n        //获取html的商品数\n        var innerGoods = html.match(reg),\n            innerGoodsLen = innerGoods ? innerGoods.length : 0;\n        //获取editor商品数\n        var ueGoods = me.getContent().match(reg),\n            outerGoodsLen = ueGoods ? ueGoods.length : 0;\n\n        if (innerGoodsLen + outerGoodsLen > limitNum) {\n            html = '';\n            alert('您最多能添加' + limitNum + '张图片哦！');\n            return;\n        }\n\n        me.execCommand('inserthtml', html, true);\n        return false;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/insertGoods.js","var utils = baidu.editor.utils,\n    uiUtils = baidu.editor.ui.uiUtils,\n    domUtils = baidu.editor.dom.domUtils,\n    UIBase = baidu.editor.ui.UIBase;\nvar ANCHOR_CLASSES = ['edui-anchor-topright', 'edui-anchor-topright',\n    'edui-anchor-bottomleft', 'edui-anchor-bottomright'\n];\nbaidu.editor.ui.Popup.prototype.showAnchorRect = function(rect, hoz, adj) {\n    var width = this.anchorEl.width;\n    var height = this.anchorEl.height;\n    this._doAutoRender();\n    var vpRect = uiUtils.getViewportRect();\n    baidu.editor.ui.Button.prototype\n    this.getDom().style.visibility = 'hidden';\n    this._show();\n    var popSize = this.fitSize();\n    var sideLeft, sideUp, left, top;\n    if (hoz) {\n        sideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n        sideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n        left = (sideLeft ? rect.left - popSize.width : rect.right);\n        //top = (sideUp ? rect.bottom - popSize.height : rect.top);\n    } else {\n        sideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n        sideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n        left = (sideLeft ? rect.right - popSize.width : rect.left);\n        //top = (sideUp ? rect.top - popSize.height : rect.bottom);\n\n    }\n\n    var popEl = this.getDom();\n    var objs = {\n        left: left,\n        top: top\n    }\n    if (this.cutstomPosition) {\n        var popWidth = $(popEl).width()\n        objs = {\n            left: rect.right - popWidth,\n            top: rect.top\n        }\n    }\n\n    uiUtils.setViewportOffset(popEl, objs);\n    domUtils.removeClasses(popEl, ANCHOR_CLASSES);\n    popEl.className += ' ' + ANCHOR_CLASSES[(sideUp ? 1 : 0) * 2 + (sideLeft ? 1 : 0)];\n    if (this.editor) {\n        popEl.style.zIndex = this.editor.container.style.zIndex * 1 + 10;\n        baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = popEl.style.zIndex - 1;\n    }\n    this.getDom().style.visibility = 'visible';\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/fixPopPosition.js","//require('./copy');\nrequire('./codemirror');\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ban/index.js","UE.plugins['source'] = function() {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ban/codemirror.js","if (!Array.prototype.indexOf)\n{\n  Array.prototype.indexOf = function(elt /*, from*/)\n  {\n    var len = this.length >>> 0;\n\n    var from = Number(arguments[1]) || 0;\n    from = (from < 0)\n         ? Math.ceil(from)\n         : Math.floor(from);\n    if (from < 0)\n      from += len;\n\n    for (; from < len; from++)\n    {\n      if (from in this &&\n          this[from] === elt)\n        return from;\n    }\n    return -1;\n  };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/indexOf.js","/**\n * [表情]\n * @Author: Fu Xiaochun\n * @Email: \tfuzhengchun@gomeplus.com\n */\nvar emojis = require('./emoji');\nvar backward = require('./backward');\nvar faceTpl = require('./face.tpl');\n\nvar emojiData = null;\n\n// 将表情转换成map\nvar emojiMap = {};\n\n// 数据适配转换\nvar makeData = function(data) {\n    var total = data.length;\n    var offset = 24;\n    var page = Math.ceil(total / offset);\n    var list = [];\n\n    for (var i = 0; i < page; i++) {\n        list[i] = [];\n        var end = offset * (i + 1);\n        end = end > total ? total : end;\n        for (var j = i * offset; j < end; j++) {\n            var emoji = data[j];\n            list[i].push(emoji);\n            emojiMap[emoji.name] = emoji.url;\n        }\n    }\n    emojiData = {\n        page: new Array(page),\n        list: list\n    };\n    return emojiData;\n};\n\nvar Face = function(opts) {\n    var foo = function() {};\n    this.$dom = null;\n    this.isShow = false;\n    this.onSelected = opts.onSelected || foo;\n};\n\nFace.prototype = {\n    constructor: Face,\n    _bindHtml: function() {\n        var data = emojiData || makeData(emojis);\n        var faceHTML = faceTpl(data);\n        this.$dom = $(faceHTML);\n    },\n    _bindEvent: function() {\n        var _this = this;\n\n        // tab方式显示所选页\n        var setShowIndex = function(index) {\n            var activeCls = 'active';\n            var hideCls = 'hide';\n            index = index || 0;\n\n            $('[data-action=facePage] > li').eq(index).addClass(activeCls).siblings('li').removeClass(activeCls);\n            $('[data-node=faceList] > div').eq(index).removeClass(hideCls).siblings('div').addClass(hideCls);\n        };\n\n        this.$dom.on('click.face', function(e) {\n            e.stopPropagation();\n        });\n        $(document).on('click.face', function() {\n            _this.hide();\n        });\n        // 分页切换显示\n        this.$dom.on('mouseenter', '[data-action=facePage] > li', function() {\n            var index = $(this).index();\n            setShowIndex(index);\n        });\n\n        this.$dom.on('click.face', '[data-face]', function() {\n            var $this = $(this);\n            var faceReg = $this.data('face');\n            var faceUrl = $this.attr('src');\n            _this.onSelected({\n                reg: faceReg,\n                url: faceUrl\n            });\n            _this.isShow !== false && _this.hide();\n            return false;\n        });\n    },\n    show: function(x, y) {\n        if (this.isShow) {\n            return;\n        }\n        this.$dom || this._bindHtml();\n        $('body').append(this.$dom);\n        this.$dom.css({\n            left: x + 'px',\n            top: y + 'px'\n        }).show();\n        this.isShow = true;\n        this._bindEvent();\n    },\n    hide: function() {\n        if (!this.isShow) {\n            return;\n        }\n        this.$dom.off('.face');\n        $(document).off('.face');\n        this.$dom.hide().remove();\n        this.isShow = false;\n    }\n};\n\n// 把表情占位符替换成img\nvar parseEmoji = function(str) {\n    var r = /(\\[([\\s\\S]+?)\\])/g;\n    if ($.isEmptyObject(emojiMap)) {\n        makeData(emojis);\n    }\n\n    return str.replace(r, function(s, $1, name) {\n        var img = emojiMap[name];\n        if (img) {\n            return '<img width=\"22\" height=\"22\" src=\"' + img + '\" />';\n        } else {\n            // 兼容旧版表情\n            var old = backward[name];\n            if (old) {\n                return '<img width=\"22\" height=\"22\" src=\"' + old.url + '\" />';\n            }\n            return s;\n        }\n    });\n};\n\nvar faceInstance = null;\nvar init = function(opts) {\n    if (!faceInstance) {\n        faceInstance = new Face(opts);\n    }\n    return faceInstance;\n};\nmodule.exports = {\n    init: init,\n    parseEmoji: parseEmoji\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/index.js","function goodsdMask(ue) {\n    var close = 0;\n\n    ue.addListener('selectionchange', function(editor) {\n        function hideMask() {\n            //var b = ue.body.getElementsByTagName('b');\n            $(ue.body).find(\".cover\").removeClass(\"show\")\n\n        }\n\n        //查找选区范围\n        var range = ue.selection.getRange();\n        //range.select();\n        var s = [].concat(ue.selection.getStartElementPath());\n\n        var len = s.length - 2;\n\n        if (len < 0) return;\n\n        s = s[len];\n\n        var tagName = s.tagName;\n        switch (tagName) {\n            case \"DIV\":\n                hideMask();\n                var $s = $(s);\n                var $el = $s.find(\".cover\");\n                var lenth = $el.length;\n\n                if (!lenth) {\n                    $s.append('<div class=\"cover show\">iii</div>');\n                    $s.attr('contenteditable', 'false');\n                } else {\n                    $el.addClass(\"show\");\n                }\n\n                close = 1;\n                var nextNode = s.nextSibling;\n                if (!nextNode) {\n                    var newNode = ue.createElement('p');\n                    var textNode = ue.createTextNode(text);\n                    newNode.appendChild(textNode);\n                    domUtils.insertAfter(s, newNode);\n                }\n                range.setStart(nextNode, 0).collapse(true).setCursor();\n\n                break;\n            case \"P\":\n                if (close == 0) return;\n                hideMask();\n                close = 0;\n                break;\n            default:\n                if (close == 0) return;\n                hideMask();\n                close = 0;\n                break;\n        }\n    })\n\n}\n\nmodule.exports = goodsdMask;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/goodsMask.js","var rewriteTxtRules = function(ue, fn) {\n    var txtRules = fn(ue);\n    var newRules = ue.options.filterTxtRules;\n    UE.utils.extend(newRules, txtRules);\n    ue.setOpt(\"filterTxtRules\", newRules)\n}\n\nvar rules = function(ue) {\n\n    return {\n        'img': {\n            $: {\n                'src': 1,\n                'data-type': 1,\n                '_src': 1,\n                'angle': 1,\n                'width': 1,\n                'height': 1,\n                'data-original': 1,\n                'proto': 1\n            }\n        }\n    }\n}\n\nvar init = function(ue) {\n    //过滤图片和替换表情\n    rewriteTxtRules(ue, rules);\n\n}\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/filterTxtRules.js","var fetch = require('io/fetch');\nvar url = require('io/url');\n\nvar restoreContent = require('../../utils/restoreContent');\n\nvar editPath = $GLOBAL_CONFIG['from']; //0 新页面  1 编辑话题  2  草稿\nvar editKey = $GLOBAL_CONFIG['tid'];\nvar unsuccessful = require('page/publishTopic/unsuccessful');\nvar imgReplace = require('utils/imgReplace');\n\nfunction restoreData(editor) {\n    //加载草稿箱\n    if (editPath == undefined) return;\n\n    switch (editPath) {\n        case '0':\n            return;\n        case '1':\n            $(\"[data-action=save]\").remove();\n    }\n\n    var datas;\n    var _url;\n    switch (editPath) {\n        case '1':\n            datas = {\n                tid: editKey\n            }\n            _url = url.get('readTopicData');\n            break;\n        case '2':\n            datas = {\n                tid: editKey\n            }\n            _url = url.get('readTopicDraftsData');\n    }\n\n    fetch.get(_url, {\n        data: datas\n    }).done(function(data) {\n        if (data.success === true) {\n            var strs = restoreContent(data);\n            editor.execCommand('inserthtml', strs);\n            setTimeout(function() {\n                imgReplace.changeSrc($(editor.body));\n            }, 2000)\n\n        } else {\n            unsuccessful.init(data);\n        }\n\n    }).fail(function(data) {\n        console.log(data, \"err\")\n    })\n}\n\nmodule.exports = restoreData;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/restore/index.js","var $title = $('[data-node=topicTitle]');\nvar $topicTitleTips = $('[data-node=topicTitleTips]');\nvar $titleCharLen = $('[data-node=titleCharLen]');\nvar $crtLists = $('[data-node=crt-lists]');\nvar $selectGroup = $('[data-action=selectGroup]');\nvar empty = require('module/empty');\nvar decode = require('utils/decodeHtml.js');\n\nvar labelTpl = require('../plugin/restore/lenovoLabel.tpl');\nvar itemTpl = require('../plugin/goods/restoreGoods.tpl');\n\nvar imgReplace = require('utils/imgReplace');\n\nvar isMeihao = $GLOBAL_CONFIG.channel;\n\nvar originRule1 = /\\.600q80\\.jpg/gi;\nvar originRule2 = /-600!80\\./g;\n\n\nfunction orignText(str){\n    str = str.replace(originRule1,'');\n    return str.replace(originRule2,'.');\n}\n\nfunction restore(data) {\n    if (data.success == true) {\n        var num = 0;\n        var strs = \"\";\n        var datas = data.data;\n        var components = datas.components;\n\n        restoreTitle(datas);\n        restoreLabel(datas);\n        restoreGroup(datas)\n\n        for (var i = 0; i < components.length; i++) {\n\n            var arrs = components[i]\n            var type = arrs.type;\n            switch (type) {\n                case 'text':\n                    strs += restoreText(arrs);\n                    break;\n                case 'image':\n                    strs += restoreImg(arrs, num);\n                    break;\n                case 'item':\n                    strs += restoreItem(arrs);\n                    break;\n            }\n\n        }\n        return strs;\n    }\n}\n\nfunction formatText(text) {\n    var strs = \"\";\n    var temp = \"\";\n    temp = text.replace(/[\\n|\\r]/gi, function(i) {\n        return ',';\n    })\n\n    temp = temp.split(',');\n\n    for (var i = 0; i < temp.length; i++) {\n        var content = $.trim(temp[i]);\n        if (content != '') {\n            strs += '<p>' + content + '</p>';\n        }\n    }\n    return strs;\n}\n\n//恢复标题\nfunction restoreTitle(data) {\n    var name = data.name\n\n    if (name) {\n        name = decode(name);       \n        $title.val(name);\n        $topicTitleTips.hide();\n        $titleCharLen.html(name.length);\n    }\n\n}\n\n//恢复文字\n// 有richText键，有值   渲染 richtext\n\n// 有richText键，值为空  不渲染text\n\n// 没有richText键  ，text有值  渲染 text\n\n\nfunction restoreText(data) {\n    var r =data.richText;\n    // 有键\n    if ( r != 'undefined') { \n        //有值\n        if(r != ''){\n\n            var isVideo = /video-id=\"[\\d]+\"/.test(r);\n            //r = imgReplace.orignalImgReplace(r);\n            r = orignText(r);\n            if(isVideo && isMeihao){\n                r = r.replace('</div>',\"\");\n                r = r.replace('<div',\"<img\");\n            }\n            return r;\n        //无值\n        }else{\n            return '';\n        }\n        \n    } else {\n        if (data.text != '') {\n            //return '<p>' + data.text + '</p>';\n            return formatText(data.text);\n        } else {\n            return '';\n        }\n    }\n}\n//恢复图片\n//图片渲染需要渲染的情况：\n// 1、type=image 且 richText有值，用richText渲染\n// 2、type=image 且 没有richText字段，用url渲染\n\n// 不需要渲染的情况：\n// type=image 且 有richText字段但值为空\nfunction restoreImg(data, num) {\n\n    if (data.richText == \"\") {\n        return '';\n    }\n    if (data.richText == undefined) {\n        var tempSrc = imgReplace.imgReplace(data.url);\n        var tempProto = imgReplace.imgProto(data.url);\n        tempSrc = imgReplace.orignalImgReplace(tempSrc);\n        var img = '<img data-t =\"t-' +\n            num +\n            '\" data-type=\"insertImg\" src=\"' +\n            tempSrc +\n            '\" _src=\"' +\n            tempSrc +\n            '\" proto=\"' +\n            tempProto +\n            '\">'\n        num++;\n\n        var text = data.text;\n\n        //处理回车换行符号\n        if (text) {\n            img += formatText(text);\n        }\n\n        return img;\n    } else {\n        return data.richText;\n    }\n\n}\n\n//恢复商品\nfunction restoreItem(data) {\n\n    var item = data.item;\n    var json = {\n        skuId: item.skuId,\n        PId: item.id,\n        shopId: data.shopId,\n        link: item.itemDetailUrl,\n        img: imgReplace.imgReplace(item.mainImage),\n        price: item.salePrice,\n        title: item.name\n    }\n    var tpl = itemTpl(json);\n\n    if (empty(window.insertedGoods)) {\n        window.insertedGoods = {};\n    }\n\n    window.insertedGoods[item.skuId] = json;\n    //Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n    if (data.richText == '') {\n        return ''\n    } else {\n        return tpl;\n    }\n\n}\n\n//恢复标签\nfunction restoreLabel(data) {\n    var labels = data.labels || [];\n    var len = labels.length;\n    if (len) {\n        var str = \"\";\n        for (var i = 0; i < len; i++) {\n            var label = labels[i];\n            str += labelTpl({\n                id: label.id,\n                name: decode(label.name)\n            })\n        }\n        $crtLists.html(str);\n\n    }\n}\n\n//恢复圈子\nfunction restoreGroup(data) {\n\n    var gid = data.groupId;\n    if (gid) {\n        $selectGroup\n            .attr(\"data-groupid\", gid)\n            .text(data.group.name);\n    }\n}\n\nmodule.exports = restore\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/utils/restoreContent.js","var unhtml = function(str) {\n    return str ? str.replace(/&((g|l|quo|ldquo|rdquo)t|amp|#39|nbsp);/g, function(m) {\n        return {\n            '&lt;': '<',\n            '&amp;': '&',\n            '&quot;': '\"',\n            '&ldquo;': '“',\n            '&rdquo;': '”',\n            '&gt;': '>',\n            '&#39;': \"'\",\n            '&nbsp;': ' '\n        }[m]\n    }) : '';\n};\n\nmodule.exports = unhtml;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/decodeHtml.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/restore/lenovoLabel',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,name=$data.name,$out='';$out+='<li class=\"label-crt-items\" data-id=\"';\n$out+=$escape(id);\n$out+='\" title=\"';\n$out+=$escape(name);\n$out+='\"> <span class=\"crt-items-md\">';\n$out+=$escape(name);\n$out+='</span> <i class=\"crt-items-close\" data-node=\"crt-close\">×</i> </li> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/restore/lenovoLabel.tpl\n// module id = 157\n// module chunks = 5 15","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/goods/restoreGoods',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,skuId=$data.skuId,PId=$data.PId,shopId=$data.shopId,link=$data.link,img=$data.img,title=$data.title,price=$data.price,$out='';$out+='<p><br/></p><div data-node=\"gmp-ebox\" class=\"card-box\" contenteditable=\"false\"> <div data-type=\"insertGoods\" data-skuId=\"';\n$out+=$escape(skuId);\n$out+='\" data-pid=\"';\n$out+=$escape(PId);\n$out+='\" data-info=\\'{\"type\":\"item\",\"text\":\"\",\"id\":\"';\n$out+=$escape(PId);\n$out+='\",\"kid\":\"\", \"shopId\": \"';\n$out+=$escape(shopId);\n$out+='\",\"skuId\":\"';\n$out+=$escape(skuId);\n$out+='\"}\\' class=\"publish-item\"> <a href=\"';\n$out+=$escape(link);\n$out+='\" class=\"img-out\"> <img src=\"';\n$out+=$escape(img);\n$out+='\" data-node=\"goodsPic\"> </a> <div class=\"publish-cont\"> <h3 class=\"pub-tl\"> <a href=\"';\n$out+=$escape(link);\n$out+='\">';\n$out+=$escape(title);\n$out+='</a> </h3> <div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">';\n$out+=$escape(price);\n$out+='</strong> </div> <a href=\"';\n$out+=$escape(link);\n$out+='\" target=\"_blank\" class=\"scan-more\">查看详情</a> </div> </div> <div class=\"cover\">&nbsp;</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/goods/restoreGoods.tpl\n// module id = 158\n// module chunks = 5 15","var alert = require('module/popup/alert');\n\nvar unsuccessful = function(msg, relativePath) {\n    /*alert(msg, {\n        ok: function() {\n            window.location.href = $_CONFIG.group_domain + relativePath;\n        }\n    });*/\n    //页面强制跳转会对用户不友好，填写的数据可能会丢失！\n    alert(msg);\n}\n\nvar init = function(data) {\n    var code;\n    var msg = data.message;\n    console.log(typeof data.code)\n    switch (data.code) {\n        case 101:\n            code = 'group';\n            msg = \"图片超出限定数量\";\n            break;\n        case 102:\n            code = 'group';\n            msg = \"上传图片存在非法提交\";\n            break;\n        case 103:\n            code = 'group';\n            msg = \"商品超出限定数量\";\n            break;\n        case 410:\n            code = 'group_dissolve';\n            break;\n        case 403:\n            code = 'group';\n            msg = \"抱歉，该圈子审核不通过！\";\n            break;\n        case 404:\n        case 422:\n        case '911918':\n            window.location.href = $_CONFIG.i_domain + 'expert/error_' + data.code + '.html';\n            return;\n        default:\n            alert(data.message);\n            return;\n    }\n    var relUrl = 'index/get_error?code=' + code;\n    unsuccessful(msg, relUrl);\n}\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/publishTopic/unsuccessful/index.js","/* eslint-disable */\n\nvar str = '<div class=\"test\"  contenteditable=\"false\" data-node=\"gmp-ebox\" data-info= {\"id\":\"123\",\"shopId\":\"456\",\"kid\":\"789\"}>' +\n    '<div data-node=\"goodsItem\" class=\"publish-item hover-dele\">' +\n    '<a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\" class=\"img-out\"> <img src=\"https://i-pre.meixincdn.com/T1haCTBvJT1RXrhCrK.230x230cTzq80.jpg\" data-node=\"999\"> </a>' +\n    '<div class=\"publish-cont\">' +\n    '<h3 class=\"pub-tl\"> <a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\">情人节必备</a> </h3>' +\n    '<div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">0.01</strong> </div>' +\n    '<a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\" class=\"scan-more\">查看详情</a> ' +\n    '</div>' +\n    ' </div>' +\n    '<b data-node=\"ifs\" style=\"position:absolute;top:0;left:0;width:1008px;background:#f00;height:230px;display:none;opacity:0.3;z-index:99999\">122</b>' +\n    '</div>'\n\n//require('editor/rewrite/insertGoods')\n\nvar init = function(ue) {\n    //test\n    $(function() {\n\n        ue.addListener('ready', function() {\n                var $body = $(\"iframe\").contents().find(\"body\");\n                //console.log($body)\n                $body.click(function() {\n                    //console.log($body.find(\"[data-node='gmp-ebox']\"))\n                })\n                $body.on(\"[data-node='gmp-ebox']\", \"click\", function() {\n                    //console.log($(this))\n                    var range = ue.selection.getRange();\n                    range.select();\n                    var s = [].concat(ue.selection.getStartElementPath());\n                    //console.log(s,1122)\n                })\n\n            })\n\n\n        var str2 = '123<b>000<em>111</em>0</b>321';\n        \n        $(\"#insert\").on(\"click\", function() {\n                ue.execCommand('insertHtml', str, true);\n                ue.focus();\n            })\n            /*\n            \t\t$(\"#insert2\").on(\"click\",function(){\n            \t\t\tue.execCommand('insertHtml', '1234567890',true);\n            \t\t})\n            */\n\n        //var tempstr = '<p><video src=\"http://js.dev.meixincdn.com:1314/dist/images/video.mp4\" controls=\"controls\">您的浏览器不支持 video 标签。</video></p>'\n        var tempstr = '<iframe height=498 width=510 src=\"http://player.youku.com/embed/XMTMzNDkzNjQ3Ng==\" frameborder=0 allowfullscreen></iframe>'\n        $(\"#insert2\").on(\"click\", function() {\n            ue.execCommand('insertHtml', tempstr,true);\n            // console.log(UE.htmlparser('<p><b>htmlparser</b></p>', true));\n            //ue.execCommand('haha', tempstr, true);\n        })\n\n        $(\"#viewCode\").on(\"click\", function() {\n            var nodes = ue.document.body.children;\n            var arr = [];\n            for (var i = 0; i < nodes.length; i++) {\n                var tagNode = nodes[i];\n                if (tagNode.tagName = \"P\") {\n                    //var txt = thisNode.innerHTML;\n                    var childNodes = tagNode.childNodes;\n\n                    for (var j = 0; j < childNodes.length; j++) {\n                        var _thisNode = childNodes[j]\n                        if (_thisNode.nodeType == 3) {\n                            var _thisValue = _thisNode.nodeValue;\n                            if (_thisValue !== \"\" || _thisValue !== \"&#8203\") {\n                                arr.push({\n                                    \"type\": \"text\",\n                                    \"text\": _thisValue\n                                });\n                                console.log(_thisValue, typeof _thisValue)\n                            }\n                        } else {\n                            if (_thisNode.tagName == \"IMG\")\n                                arr.push({\n                                    \"type\": \"image\",\n                                    \"text\": \"美图\",\n                                    \"url\": _thisNode.src\n                                });\n                            if (_thisNode.tagName == \"BR\") {\n                                arr.push({\n                                    \"type\": \"text\",\n                                    \"text\": '<br/>'\n                                })\n                            }\n                        }\n                    }\n\n                    /*\n\t\t\t\t\tvar reg = /<img.*?>/gi;\n\t\t\t\t\tvar j = txt.split(reg)\n\t\t\t\t\tconsole.log(j)\n\n\t\t\t\t\tvar newStr = '<p>';\n\t\t\t\t\tvar j = txt.match(reg) ;\n\t\t\t\t\t*/\n                    //var j =txt.replace(/<img.*?>/g,'hahaha');\n                    //console.log(j,12)\n                }\n                if (tagNode.tagName == \"DIV\") {\n                    var data = tagNode.attributes.data.value;\n                    data = JSON.parse(data);\n                    arr.push({\n                        \"type\": \"item\",\n                        \"text\": \"sg\",\n                        \"id\": data.id,\n                        \"shopId\": data.shopId,\n                        \"kid\": data.kid\n                    });\n                }\n            }\n            console.log(arr);\n        })\n\n        $(\"#submitCode\").on(\"click\", function() {\n            //ue.execCommand('insertHtml', '1234567890',true);\n            var t = ue.getContent()\n\n            function htmlNull(str) {\n                var re = str.replace(/\\n|\\r\\n/g, \"</br>\");\n                return re; //去掉所有的html标记\n            }\n            console.log(htmlNull(t));\n        })\n\n        $(\"#del\").on(\"click\", function() {\n            var range = ue.selection.getRange();\n            range.select();\n            var s = [].concat(ue.selection.getStartElementPath());\n\n            var parents = $(s[0]).parents('[data-node=listItemBox]')\n            if (parents.length > 0) {\n                console.log(parents.get(0))\n                    //parents.find('[data-node=mask]').show();\n                range.setStart(parents.prev().get(0), 0)\n                range.setEnd(parents.next().get(0), 0)\n                range.select();\n            }\n        })\n    })\n}\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/editor/test.js"],"sourceRoot":""}
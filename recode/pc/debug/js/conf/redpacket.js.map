{"version":3,"sources":["webpack:///./src/js/page/redpacket/index.js","webpack:///./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js?5041**********","webpack:///./src/js/page/redpacket/prizesList.tpl"],"names":["fetch","require","url","prizesList","$total","$","$prizesList","getTotal","get","done","data","success","text","total_amount","timer","fail","getPrizesList","html","prizes","listScroll","fn","clearTimeout","setTimeout","listTimer","listHTML","listHeight","height","listWrapHeight","offset","top","speed","scroll","css","init"],"mappings":"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","file":"redpacket.js","sourcesContent":["/**\n * 抢红包活动\n * @author QiaoLi\n */\n\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar prizesList = require('./prizesList.tpl');\n\nvar $total = $('[data-node=total]');\nvar $prizesList = $('[data-node=prizesList]');\n\n//获取中奖总金额\nvar getTotal = function() {\n    fetch.get(url.get('getTotalAmount')).done(function(data) {\n        if (data.success === true) {\n            $total.text(data.data.total_amount);\n            timer(getTotal);\n        } else {\n            timer(getTotal);\n        }\n    }).fail(function() {\n        timer(getTotal);\n    });\n};\n\n//获取单次中奖金额大于20元的记录\nvar getPrizesList = function() {\n    fetch.get(url.get('getPrizesList')).done(function(data) {\n        if (data.success === true) {\n            $prizesList.html(prizesList({\n                prizes: data.data\n            }));\n            listScroll();\n            timer(getPrizesList);\n        } else {\n            timer(getPrizesList);\n        }\n    }).fail(function() {\n        timer(getPrizesList);\n    });\n};\n\nvar timer = function(fn) {\n    fn.timer = null;\n    clearTimeout(fn.timer);\n    fn.timer = setTimeout(fn, 180000);\n};\n\nvar listTimer = null;\nvar listScroll = function() {\n    var listHTML = $prizesList.html();\n    var listHeight = $prizesList.height();\n    var listWrapHeight = 141;\n    var offset = 1;\n    var top = 0;\n    var speed = 30;\n\n    if (listHeight > listWrapHeight) {\n        listHTML += listHTML;\n        $prizesList.html(listHTML);\n\n        var scroll = function() {\n            top = top - offset;\n            if (top <= -listHeight) {\n                top = 0;\n            }\n            $prizesList.css('top', top);\n            clearTimeout(listTimer);\n            listTimer = setTimeout(scroll, speed);\n        }\n        scroll();\n    }\n};\n\nvar init = function() {\n    timer(getTotal);\n    timer(getPrizesList);\n    listScroll();\n\n};\ninit();\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/redpacket/index.js","/*TMODJS:{}*/\r\n!function () {\r\n\tfunction a(a, b) {\r\n\t\treturn (/string|function/.test(typeof b) ? h : g)(a, b)\r\n\t}\r\n\r\n\tfunction b(a, c) {\r\n\t\treturn \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a\r\n\t}\r\n\r\n\tfunction c(a) {\r\n\t\treturn l[a]\r\n\t}\r\n\r\n\tfunction d(a) {\r\n\t\treturn b(a).replace(/&(?![\\w#]+;)|[<>\"']/g, c)\r\n\t}\r\n\r\n\tfunction e(a, b) {\r\n\t\tif (m(a))for (var c = 0, d = a.length; d > c; c++)b.call(a, a[c], c, a); else for (c in a)b.call(a, a[c], c)\r\n\t}\r\n\r\n\tfunction f(a, b) {\r\n\t\tvar c = /(\\/)[^\\/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^\\/]+$/, \"\"), e = d + b;\r\n\t\tfor (e = e.replace(/\\/\\.\\//g, \"/\"); e.match(c);)e = e.replace(c, \"/\");\r\n\t\treturn e\r\n\t}\r\n\r\n\tfunction g(b, c) {\r\n\t\tvar d = a.get(b) || i({filename: b, name: \"Render Error\", message: \"Template not found\"});\r\n\t\treturn c ? d(c) : d\r\n\t}\r\n\r\n\tfunction h(a, b) {\r\n\t\tif (\"string\" == typeof b) {\r\n\t\t\tvar c = b;\r\n\t\t\tb = function () {\r\n\t\t\t\treturn new k(c)\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar d = j[a] = function (c) {\r\n\t\t\ttry {\r\n\t\t\t\treturn new b(c, a) + \"\"\r\n\t\t\t} catch (d) {\r\n\t\t\t\treturn i(d)()\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn d.prototype = b.prototype = n, d.toString = function () {\r\n\t\t\treturn b + \"\"\r\n\t\t}, d\r\n\t}\r\n\r\n\tfunction i(a) {\r\n\t\tvar b = \"{Template Error}\", c = a.stack || \"\";\r\n\t\tif (c)c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); else for (var d in a)c += \"<\" + d + \">\\n\" + a[d] + \"\\n\\n\";\r\n\t\treturn function () {\r\n\t\t\treturn \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b\r\n\t\t}\r\n\t}\r\n\r\n\tvar j = a.cache = {}, k = this.String, l = {\r\n\t\t\"<\": \"&#60;\",\r\n\t\t\">\": \"&#62;\",\r\n\t\t'\"': \"&#34;\",\r\n\t\t\"'\": \"&#39;\",\r\n\t\t\"&\": \"&#38;\"\r\n\t}, m = Array.isArray || function (a) {\r\n\t\t\treturn \"[object Array]\" === {}.toString.call(a)\r\n\t\t}, n = a.utils = {\r\n\t\t$helpers: {}, $include: function (a, b, c) {\r\n\t\t\treturn a = f(c, a), g(a, b)\r\n\t\t}, $string: b, $escape: d, $each: e\r\n\t}, o = a.helpers = n.$helpers;\r\n\ta.get = function (a) {\r\n\t\treturn j[a.replace(/^\\.\\//, \"\")]\r\n\t}, a.helper = function (a, b) {\r\n\t\to[a] = b\r\n\t}, module.exports = a\r\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js\n// module id = 34\n// module chunks = 0 1 2 3 4 5 7 9 13 15 16 20 21 22 26 27 29 30 32 34 35 38 43 44 45","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/redpacket/prizesList',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,prizes=$data.prizes,value=$data.value,$index=$data.$index,$escape=$utils.$escape,$out='';$each(prizes,function(value,$index){\n$out+=' <li>';\n$out+=$escape(value.message);\n$out+='</li> ';\n});\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/redpacket/prizesList.tpl\n// module id = 198\n// module chunks = 16"],"sourceRoot":""}
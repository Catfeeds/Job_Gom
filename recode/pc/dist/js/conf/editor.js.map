{"version":3,"sources":["webpack:///editor.js","webpack:///./src/js/page/editor/index.js","webpack:///./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js?5041*****","webpack:///./src/js/module/popup/alert.js?466a****","webpack:///./src/js/module/hint.js?34fa*","webpack:///./src/js/module/popup/face/emoji.js?d6cd*","webpack:///./src/js/module/popup/face/backward.js?6a63","webpack:///./src/js/module/popup/face/face.tpl?dd34","webpack:///./src/js/module/i18n.js?8f86*","webpack:///./src/js/plugin/webuploader/webuploader.js?37bb","webpack:///./src/js/module/popup/upload/dialog.js?5b30","webpack:///./src/js/module/popup/upload/content.tpl?cddf","webpack:///./src/js/editor/index.js","webpack:///./src/js/editor/ueditor/ueditor.config.js","webpack:///./src/js/editor/ueditor/ueditor.all.js","webpack:///./src/js/editor/ueditor/lang/zh-cn/zh-cn.js","webpack:///./src/js/editor/plugin/index.js","webpack:///./src/js/editor/plugin/fonts/index.js","webpack:///./src/js/editor/plugin/fonts/title.js","webpack:///./src/js/editor/utils/getContent.js","webpack:///./src/js/editor/plugin/emoji/index.js","webpack:///./src/js/editor/plugin/picture/index.js","webpack:///./src/js/module/popup/upload/uploader.js","webpack:///./src/js/module/upload.js","webpack:///./src/js/utils/imgReplace.js","webpack:///./src/js/editor/plugin/picture/pictures.tpl","webpack:///./src/js/module/popup/uploadfileQR/index.js","webpack:///./src/js/module/popup/uploadfileQR/upload.tpl","webpack:///./src/js/editor/config.js","webpack:///./src/js/editor/plugin/transformImg.js","webpack:///./src/js/editor/plugin/angle.js","webpack:///./src/js/editor/plugin/link/showText.js","webpack:///./src/js/editor/plugin/link/pop.js","webpack:///./src/js/editor/plugin/link/input.tpl","webpack:///./src/js/editor/plugin/link/dealLink.js","webpack:///./src/js/editor/plugin/goods/index.js","webpack:///./src/js/module/empty.js","webpack:///./src/js/module/addGoods.js","webpack:///./src/js/module/popup/addGoods/dialog.js","webpack:///./src/js/module/popup/addGoods/content.tpl","webpack:///./src/js/module/popup/addGoods/itemContent.tpl","webpack:///./src/js/module/popup/addGoods/defaultItemContent.tpl","webpack:///./src/js/editor/plugin/goods/goods.tpl","webpack:///./src/js/editor/plugin/link/index.js","webpack:///./src/js/editor/plugin/beforeInput.js","webpack:///./src/js/editor/plugin/grepPaste.js","webpack:///./src/js/editor/rewrite/grepRule.js","webpack:///./src/js/editor/plugin/pastedCheckImg.js","webpack:///./src/js/editor/plugin/grepDrop.js","webpack:///./src/js/editor/plugin/selectImg.js","webpack:///./src/js/editor/plugin/autoHeight.js","webpack:///./src/js/editor/plugin/autoUpload.js","webpack:///./src/js/editor/plugin/linkLayer.js","webpack:///./src/js/editor/rewrite/index.js","webpack:///./src/js/editor/rewrite/toolbar/index.js","webpack:///./src/js/editor/rewrite/toolbar/baseFont.js","webpack:///./src/js/editor/rewrite/toolbar/align.js","webpack:///./src/js/editor/rewrite/toolbar/list.js","webpack:///./src/js/editor/rewrite/buttonRules.js","webpack:///./src/js/editor/rewrite/insertGoods.js","webpack:///./src/js/editor/rewrite/fixPopPosition.js","webpack:///./src/js/editor/ban/index.js","webpack:///./src/js/editor/ban/codemirror.js","webpack:///./src/js/utils/indexOf.js","webpack:///./src/js/module/popup/face/index.js","webpack:///./src/js/editor/plugin/goodsMask.js","webpack:///./src/js/editor/rewrite/filterTxtRules.js","webpack:///./src/js/editor/plugin/restore/index.js","webpack:///./src/js/editor/utils/restoreContent.js","webpack:///./src/js/utils/decodeHtml.js","webpack:///./src/js/editor/plugin/restore/lenovoLabel.tpl","webpack:///./src/js/editor/plugin/goods/restoreGoods.tpl","webpack:///./src/js/page/publishTopic/unsuccessful/index.js","webpack:///./src/js/page/editor/test.js"],"names":["webpackJsonp","module","exports","__webpack_require__","ueditor","test","ue","init","a","b","h","g","c","call","l","d","replace","e","m","length","f","match","get","i","filename","name","message","k","j","prototype","n","toString","stack","split","slice","join","console","error","cache","this","String","<",">","\"","'","&","Array","isArray","utils","$helpers","$include","$string","$escape","$each","o","helpers","helper","$","Dialog","noop","create","content","options","defaults","fixed","modal","autofocus","className","okCls","ok","extend","header","_$","title","css","show","$publicMask","$publicTips","timer","events","off","on","hide","msg","duration","callback","clearTimeout","text","append","offsetHeight","width","setTimeout","$_CONFIG","imgPath","imgpath","ext","groupOne","url","groupTwo","groupThree","groupFour","groupFive","format","arr","len","emoji","concat","path","backward","亲","愤怒","惊恐","迷茫","伤心","努力","YY","恶心","template","$data","$filename","$utils","list","v","face","$index","page","$out","inputTip","tel","ept","err","errBack","msgCode","tipGet","tipEpt","tipErr","tipErrEdit","tipWrong","checkCodeWrong","send","tipSend","tipDisabled","tipLimitEdit","btnAfterSend","btnDefault","pwd","commonTip","pwdV","nickName","eptName","existName","sucSub","errLine","wrongName","birthTip","tip","refCode","imgCode","login","errCode","errNum","errPwd","agreement","createCircle","typeEmpty","nameEmpty","upperLimit","circle","unJoin","cannotJoin","review","joinSuccess","joinSuccessPublic","cannotJoinCircle","exit","dissolved","qrCodeTip","loseEffTip","loseEffBtn","failGetTip","failGetBtn","masterApply","nameLength","nameType","isIdCard","type","summary","upload","noUpload","uploadError","uploadFaild","uploadError_Master","Q_EXCEED_NUM_LIMIT","Q_EXCEED_SIZE_LIMIT","Q_TYPE_DENIED","F_EXCEED_SIZE","excess","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","__webpack_provided_window_dot_jQuery","root","factory","modules","_require","deps","args","getModule","push","apply","_define","id","arguments","setModule","returned","undefined","Error","exportsTo","obj","key","host","parts","part","last","ucFirst","str","charAt","toUpperCase","substr","hasOwnProperty","pop","shift","makeExport","dollar","__dollar","window","define","require","jQuery","Zepto","_","Deferred","when","isPromise","anything","then","promise","uncurryThis","fn","bindFn","context","createObject","proto","Object","Function","version","browser","ua","ret","webkit","chrome","ie","firefox","safari","opera","parseFloat","navigator","userAgent","os","android","ios","inherits","Super","protos","staticProtos","child","constructor","__super__","log","nextTick","cb","guid","counter","prefix","Date","Math","floor","random","formatSize","size","pointLength","units","unit","toFixed","Base","findHandlers","grep","handler","_cb","ctx","eachEvent","iterator","each","separator","triggerHanders","stoped","ctx2","set","me","_events","once","trigger","allEvents","installTo","Mediator","Uploader","opts","_init","stop","getFile","getFiles","addFile","addFiles","sort","removeFile","cancelFile","skipFile","retry","isInProgress","makeThumb","md5File","getDimension","addButton","predictRuntimeType","refresh","disable","enable","reset","command","request","state","option","val","isPlainObject","getStats","stats","successNum","numOfSuccess","progressNum","numOfProgress","cancelNum","numOfCancel","invalidNum","numOfInvalid","uploadFailNum","numOfUploadFailed","queueNum","numOfQueue","interruptNum","numofInterrupt","substring","isFunction","destroy","Runtime","container","document","body","uid","factories","getFirstKey","getContainer","parent","_container","createElement","attr","position","top","left","height","overflow","addClass","_parent","exec","remove","removeClass","orders","addRuntime","hasRuntime","runtime","RuntimeClient","component","standalone","deferred","runtimeReady","done","connectRuntime","__promise","resolve","__client","runtimeOrder","add","__standalone","getRuntime","disconnectRuntime","unshift","getRuid","ruid","RuntimeClent","DragAndDrop","accept","disableGlobalDnd","isArrayLike","nodeType","Widget","uploader","owner","_destroy","IGNORE","widgetClass","invoke","apiName","map","responseMap","widgets","_widgets","deactives","disableWidgets","klass","indexOf","_name","widget","rlt","rlts","dfds","pipe","register","widgetProto","toLowerCase","unRegister","splice","Dnd","dnd","files","items","FilePaste","paste","Blob","source","start","end","getSource","File","file","rExt","RegExp","$1","lastModifiedDate","toLocaleString","FilePicker","innerHTML","label","html","button","multiple","_refer","_resizeHandler","shimContainer","outerWidth","outerHeight","pos","offset","bottom","right","btn","pick","pickers","addBtn","promises","picker","swf","Image","_info","_meta","quality","crop","preserveHeaders","allowMagnify","info","meta","loadFromBlob","blob","resize","getAsDataUrl","getAsBlob","throttle","max","occupied","waiting","tick","item","emiter","thumb","compress","image","isArtwork","reason","beforeSendFile","compressSize","noCompressIfLarger","_compressed","always","reject","gid","idPrefix","idSuffix","WUFile","statusText","statusMap","Status","INITED","loaded","setStatus","ERROR","status","prevStatus","getStatus","QUEUED","PROGRESS","COMPLETE","CANCELLED","INTERRUPT","INVALID","Queue","numofDeleted","_queue","_map","STATUS","_fileAdded","prepend","fileId","fetch","sts","inArray","existing","cur","pre","_onFileStatusChange","curStatus","preStatus","extensions","queue","placeholder","_ruid","_wrapFile","acceptFile","invalid","_addFile","auto","fetchFile","noForceStart","sortFiles","support","Transport","_blob","_formData","formData","_headers","headers","_timeout","_timer","server","method","withCredentials","fileVal","timeout","sendAsBinary","appendBlob","value","setRequestHeader","abort","getResponse","getResponseAsJson","CuteFile","chunkSize","api","pending","total","chunks","ceil","index","has","block","min","chunk","cuted","blocks","remaning","prepareNextFile","chunked","chunkRetry","threads","runing","progress","pool","__tick","_tick","transport","_trigged","_promise","startUpload","stopUpload","interrupt","_putback","_popBlock","_tr","_getStats","skipped","_nextBlock","_startSend","idx","_getStack","act","next","preparing","_prepareNextFile","_finishFile","fail","_doSend","percentage","updateFileProgress","requestAccept","tr","data","_raw","flag","retried","hds","totalPercent","uploaded","validators","addValidator","removeValidator","count","parseInt","fileNumLimit","fileSizeLimit","fileSingleSizeLimit","hashString","_char","hash","charCodeAt","mapping","duplicate","__hash","Md5","getResult","md5","notify","CompBase","Html5Runtime","comp","instance","client","components","FileReader","DataView","webkitSlice","mozSlice","elem","dragEnterHandler","_dragEnterHandler","dragOverHandler","_dragOverHandler","dragLeaveHandler","_dragLeaveHandler","dropHandler","_dropHandler","dndOver","denied","_denied","originalEvent","dataTransfer","dropEffect","parentElem","contains","currentTarget","_leaveTimer","getData","_getTansferFiles","results","canAccessFolder","webkitGetAsEntry","isDirectory","_traverseDirectoryTree","entry","isFile","createReader","readEntries","entries","mimeTypes","hander","_pasteHander","allowed","clipboardData","kind","getAsFile","preventDefault","stopPropagation","mouseHandler","input","opacity","display","cursor","background","clone","callee","target","cloneNode","parentNode","replaceChild","urlAPI","createObjectURL","URL","revokeObjectURL","webkitURL","dataURL2Blob","dataURI","byteStr","intArray","ab","mimetype","atob","decodeURIComponent","ArrayBuffer","Uint8Array","arrayBufferToBlob","dataURL2ArrayBuffer","buffer","bb","builder","BlobBuilder","WebKitBlobBuilder","getBlob","canvasToDataUrl","canvas","toDataURL","parseMeta","updateImageHead","Util","parsers","65505","maxMetaDataSize","parse","fr","onload","_parse","result","onerror","readAsArrayBuffer","noParse","byteLength","markerBytes","markerLength","dataview","maxOffset","headLength","getUint16","imageHead","subarray","head","buf1","buf2","bodyoffset","ImageMeta","EXIF","ExifMap","Orientation","exifTagTypes","1","getValue","dataView","dataOffset","getUint8","2","fromCharCode","ascii","3","littleEndian","4","getUint32","5","9","getInt32","10","getExifValue","tiffOffset","tagSize","values","tagType","parseExifTag","tag","exif","parseExifTags","dirOffset","tagsNumber","dirEndOffset","parseExifData","JPEGEncoder","initQuantTables","sf","YQT","t","ffloor","YTable","ZigZag","UVQT","u","UVTable","aasf","row","col","fdtbl_Y","fdtbl_UV","computeHuffmanTbl","nrcodes","std_table","codevalue","pos_in_table","HT","initHuffmanTbl","YDC_HT","std_dc_luminance_nrcodes","std_dc_luminance_values","UVDC_HT","std_dc_chrominance_nrcodes","std_dc_chrominance_values","YAC_HT","std_ac_luminance_nrcodes","std_ac_luminance_values","UVAC_HT","std_ac_chrominance_nrcodes","std_ac_chrominance_values","initCategoryNumber","nrlower","nrupper","cat","nr","category","bitcode","nrneg","initRGBYUVTable","RGB_YUV_TABLE","writeBits","bs","posval","bytenew","bytepos","writeByte","byteout","clt","writeWord","fDCTQuant","fdtbl","d0","d1","d2","d3","d4","d5","d6","d7","dataOff","I8","I64","tmp0","tmp7","tmp1","tmp6","tmp2","tmp5","tmp3","tmp4","tmp10","tmp13","tmp11","tmp12","z1","z5","z2","z4","z3","z11","z13","tmp0p2","tmp7p2","tmp1p2","tmp6p2","tmp2p2","tmp5p2","tmp3p2","tmp4p2","tmp10p2","tmp13p2","tmp11p2","tmp12p2","z1p2","z5p2","z2p2","z4p2","z3p2","z11p2","z13p2","outputfDCTQuant","writeAPP0","writeSOF0","writeDQT","writeDHT","p","writeSOS","processDU","CDU","DC","HTDC","HTAC","EOB","M16zeroes","I16","I63","DU_DCT","DU","Diff","end0pos","lng","startpos","nrzeroes","nrmarker","initCharLookupTable","sfcc","setQuality","currentQuality","round","YDU","UDU","VDU","encode","DCY","DCU","DCV","displayName","x","r","imageData","quadWidth","y","fillbits","jpegDataUri","btoa","encoder","supportJpeg","origin","w","fragement","getContext","getImageData","BLANK","modified","img","_metas","_img","src","_canvas","_resize","s","cvs","iw","naturalWidth","ih","naturalHeight","orientation","getOrientation","_rotate2Orientaion","_renderImageToCanvas","clearRect","scale","translate","rotate","PI","detectVerticalSquash","alpha","ratio","sy","ey","py","drawImage","detectSubsampling","vertSquashRatio","tmpCanvas","tmpCtx","dw","dh","sx","dx","subsampled","doSquash","dy","save","restore","_status","_response","binary","xhr","_initAjax","param","FormData","open","_setRequestHeader","overrideMimeType","_parseJson","_xhr","onprogress","onreadystatechange","XMLHttpRequest","XDomainRequest","lengthComputable","readyState","responseText","json","JSON","ex","FlashRuntime","add32","cmn","q","ff","gg","hh","ii","md5cycle","md5blk","md5blks","md5blk_array","md51","tail","tmp","lo","hi","md51_array","hex_chr","rhex","hex","SparkMD5","lsw","msw","unescape","encodeURIComponent","appendBinary","contents","_buff","_length","_state","raw","buff","_finish","hashBinary","_concatArrayBuffer","first","second","firstLength","loadNext","spark","blobSlice","onloadend","getFlashVersion","plugins","description","ActiveXObject","GetVariable","ex2","evt","clients","jsreciver","flashExec","flash","getFlash","_flash","copy","_responseJson","forceURLStream","mimeType","percent","readBody","base","logUrl","product","location","hostname","dv","master","online","code","c_error_code","c_reason","c_count","c_size","c_usage","preset","tpl","okValue","cancalValue","btnWrapCls","maxlength","faceModule","goodsMask","filterTxtRules","restoreData","editor","UE","getEditor","onSelected","reg","execCommand","addListener","defaultContent","getContent","$editorBody","placeholderCls","$container","delegate","hasDiv","find","isEqDefault","isContentEmpty","trim","$emojiBtn","firstChild","$pictorBtn","$picPopBox","flagY","scrollTop","isShow","$dom","sensitiveWord","getUEBasePath","docUrl","confUrl","getBasePath","self","href","getConfigFilePath","configPath","getElementsByTagName","basePath","optimizationPath","protocol","res","UEDITOR_HOME_URL","UEDITOR_CONFIG","serverUrl","toolbars","xssFilterRules","inputXssFilter","outputXssFilter","whitList","abbr","address","area","article","aside","audio","bdi","bdo","big","blockquote","br","caption","center","cite","colgroup","dd","del","details","div","dl","dt","em","font","footer","h1","h2","h3","h4","h5","h6","hr","ins","li","mark","nav","ol","section","small","span","sub","sup","strong","table","tbody","td","tfoot","th","thead","tt","ul","video","getListener","force","allListeners","__allListeners","getDomNode","node","ltr","startFromChild","guard","tmpNode","tagName","baidu","commands","instants","I18N","_customizeUI","dom","agent","mac","quirks","compatMode","gecko","v1","v2","ie11Compat","documentMode","ie9Compat","ie8","ie8Compat","ie7Compat","ie6Compat","ie9above","ie9below","ie11above","ie11below","geckoRelease","isCompatible","mobile","air","makeInstance","extend2","subClass","superClass","oldP","newP","bind","defer","delay","exclusion","timerID","array","isNumber","removeItem","listToMap","ci","unhtml","unhtmlForUrl","&lt;","&amp;","&quot;","&gt;","&#39;","&nbsp;","cssStyleToDomStyle","style","float","cssFloat","styleFloat","cssName","loadFile","getItem","doc","tmpList","ready","funs","write","getElementById","element","setAttribute","fi","appendChild","isEmptyObject","isString","fixColor","color","optCss","opt","padding","margin","transUnitToPx","domReady","doReady","isReady","fnArr","onready","win","documentElement","doScroll","attachEvent","addEventListener","removeEventListener","cssRule","indexList","styleSheets","cssText","sheetStyle","createStyleSheet","removeChild","compareFn","item1","item2","localeCompare","serializeParam","strArr","formatUrl","isCrossDomainUrl","port","clearEmptyAttrs","str2json","json2str","encodeString","escapeMap","encodeArray","preComma","pad","encodeDate","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","stringify","\b","\t","\n","\f","\r","\\","isFinite","isDate","EventBase","types","listener","ti","removeListener","fireEvent","listeners","dtd","X","A","isindex","fieldset","B","select","textarea","C","D","iframe","E","menu","noscript","dir","noframes","F","script","G","acronym","var","#","kbd","strike","samp","dfn","H","embed","object","basefont","applet","I","J","K","form","L","M","N","O","P","Q","R","S","link","T","U","V","empty","dialog","keygen","track","wbr","$nonBodyContent","$block","$inline","$inlineWithA","$body","$cdata","$empty","$nonChild","$listItem","$list","$isNotEmpty","$removeEmpty","$removeEmptyBlock","$tableContent","$notTransContent","optgroup","legend","attrFix","tabindex","readonly","for","class","cellspacing","cellpadding","rowspan","colspan","usemap","frameborder","styleBlock","domUtils","NODE_ELEMENT","NODE_DOCUMENT","NODE_TEXT","NODE_COMMENT","NODE_DOCUMENT_FRAGMENT","POSITION_IDENTICAL","POSITION_DISCONNECTED","POSITION_FOLLOWING","POSITION_PRECEDING","POSITION_IS_CONTAINED","POSITION_CONTAINS","fillChar","keys","8","46","16","17","18","37","38","39","40","13","getPosition","nodeA","nodeB","parentsA","parentsB","reverse","nextSibling","getNodeIndex","ignoreTextNode","preNode","previousSibling","inDoc","findParent","filterFn","includeSelf","isBody","findParentByTagName","tagNames","excludeFn","findParents","closerFirst","parents","insertAfter","newNode","insertBefore","keepChildren","hasChildNodes","getNextDomNode","getPreDomNode","isBookmarkNode","getWindow","ownerDocument","defaultView","parentWindow","getCommonAncestor","clearEmptySibling","ignoreNext","ignorePre","clear","isEmptyInlineElement","nodeValue","createTextNode","retval","splitText","isWhitespace","getXY","offsetParent","offsetTop","offsetLeft","_d","els","srcElement","event","un","detachEvent","isSameElement","thisAttrs","attributes","otherAttrs","attrA","attrB","al","bl","nodeName","specified","isSameStyle","getNamedItem","styleA","styleB","isBlockElm","getComputedStyle","breakParent","leftNodes","rightNodes","parentClone","trimWhiteTextNode","mergeChild","attrs","childNodes","filter","hasClass","ni","mergeToParent","textDecoration","mergeSibling","merge","rtl","lastChild","unSelectable","onselectstart","onclick","onkeyup","onkeydown","unselectable","all","MozUserSelect","webkitUserSelect","msUserSelect","KhtmlUserSelect","removeAttributes","attrNames","getAttributeNode","removeAttributeNode","removeAttribute","setAttributes","styleName","pros","fontSize","getStyle","getPropertyValue","currentStyle","removeClasses","elm","classNames","cls","isRegExp","returnValue","removeStyle","removeProperty","setStyle","setStyles","styles","removeDirtyAttr","nodes","getChildCount","isEmptyNode","isBr","clearSelectedArr","scrollToView","getViewPaneSize","mode","clientWidth","clientHeight","getScrollPosition","pageXOffset","pageYOffset","scrollLeft","winHeight","elementPosition","currentScroll","scrollTo","isFillChar","isInStart","isStartInblock","range","tmpRange","cloneRange","startContainer","startOffset","setStartBefore","setStart","collapse","isEmptyBlock","setViewportOffset","rect","getBoundingClientRect","fillNode","moveChild","hasNoAttributes","outerHTML","isCustomeNode","getAttribute","isTagNode","filterNodeList","nodelist","forAll","isInNodeEndBoundary","rng","isBoundaryNode","fillHtml","fillCharReg","updateCollapse","collapsed","endContainer","endOffset","selectOneNode","setEndPoint","toStart","execContentsAction","action","tmpStart","tmpEnd","frag","createDocumentFragment","substringData","deleteData","current","currentLevel","startParents","endParents","si","ei","removeFillData","excludeNode","fillData","Range","cloneContents","deleteContents","txt","extractContents","setEnd","setStartAfter","setEndAfter","setEndBefore","setStartAtFirst","setStartAtLast","setEndAtFirst","setEndAtLast","selectNode","selectNodeContents","shrinkBoundary","ignoreEnd","check","trimBoundary","txtToElmBoundary","textNode","ignoreCollapsed","adjust","insertNode","nextNode","setCursor","toEnd","noFillData","createBookmark","serialize","same","endNode","startNode","moveToBookmark","bookmark","enlarge","toBlock","stopFn","enlargeToBlockElm","adjustmentBoundary","applyInlineStyle","level","aNode","removeInlineStyle","getClosedNode","textRange","nativeRange","createControlRange","addElement","createTextRange","moveToElementText","moveStart","tmpText","nativeRangeEnd","notInsertFillData","checkOffset","txtNode","sel","getSelection","focus","removeAllRanges","createRange","addRange","inFillChar","createAddress","ignoreTxt","getAddress","isStart","addrs","firstIndex","addr","startAddress","endAddress","moveToAddress","getNode","equals","traversal","doFn","getBoundaryInformation","getIndex","parentElement","distance","siblings","children","testRange","startIndex","endIndex","compareEndPoints","transformIERangeToRange","ieRange","bi","_getIERange","getNative","el","Selection","frameElement","_bakIERange","getIERange","rangeInBody","txtRange","selection","_cachedRange","getRange","_cachedStartElement","getStart","_cachedStartElementPath","getStartElementPath","isFocus","rangeCount","optimze","firstRange","getRangeAt","lastRange","_bakRange","getText","nativeSel","clearRange","setValue","tis","hasContents","allHtmlEnabled","getAllHtml","checkCurLang","lang","langReadied","langIsReady","_selectionChangeTimer","Editor","shortcutkeys","inputRules","outputRules","setOpt","defaultOptions","loadServerConfig","langPath","plugin","load","registerCommand","getOpt","offsetWidth","delEditor","render","getStyleValue","initialFrameWidth","minFrameWidth","initialFrameHeight","minFrameHeight","zIndex","iframeCssUrl","initialStyle","customDomain","domain","_setup","disabled","contentEditable","spellcheck","geckoSel","_initEvents","autoSyncData","initialContent","autoClearinitialContent","oldExecCommand","_setDefaultContent","setContent","focusInEnd","_selectionChange","fullscreen","ui","setFullScreen","_bindshortcutKeys","_bakNativeRange","setInterval","setHide","setDisabled","sync","formId","setHeight","notSetHeight","addshortcutkey","cmd","keyCode","which","ctrlKey","metaKey","$2","$3","queryCommandState","notSetCursor","ignoreBlank","formatter","htmlparser","filterOutputRule","toHtml","headHtml","headHtmlForIE9","charset","getPlainTxt","getContentTxt","isAppendTo","notFireSelectionchange","isCdataDiv","filterInputRule","enterTag","blur","nativeRng","_proxyDomEvent","shiftKey","altKey","mouseX","mouseY","hackForMouseUp","clientX","clientY","moveToPoint","bakGetIERange","_callCmdFn","fnName","cmdFn","cmdName","notNeedUndo","__hasEnterExecCommand","ignoreContentChange","_ignoreContentChange","queryCommandValue","tags","cn","setEnabled","lastBk","bkqueryCommandState","bkqueryCommandValue","except","cont","setShow","getLang","getContentLength","ingoneHtml","addInputRule","rule","addOutputRule","getActionUrl","actionName","imageUrl","_url","autoClearEmptyNode","imagePopup","theme","themePath","scaleEnabled","tableNativeEditInFF","fileNameFormat","showErrorMsg","configUrl","isJsonp","_serverConfigLoaded","ajax","dataType","onsuccess","config","eval","isServerConfigLoaded","afterConfigReady","readyHandler","doAjax","ajaxOptions","creatAjaxRequest","timeIsOut","defaultAjaxOptions","async","ajaxOpts","submitStr","doJsonp","createScriptTag","scr","getCallBack","onTimeOut","successhandler","exception","oncomplete","callbackFnName","matches","callbackField","timeOut","search","queryStr","fnStr","getJSONP","filterWord","isWordDocument","transUnit","filterPasteWord","marks","insertLine","begin","breakChar","insertIndent","indentChar","nodeToHtml","isText","isElement","isComment","notTransTagName","attrhtml","notTransAttrs","getNodeById","getAttr","getNodesByTagName","nodeTraversal","uNode","_src","_href","cdata_data","createText","noTrans","htmlstr","tmpRoot","innerText","textStr","cj","attrName","setAttr","attrVal","isObject","cssStyle","needChild","htmlattr","needParentTag","needParentNode","hasParent","tmpParent","re_attr","comment","re_tag","allowEmptyTags","currentIndex","nextIndex","currentParent","lastIndex","filterNode","rules","tmpVal","tmpAttrs","tmpCssStyle","_plugins","pluginName","oldOptionName","afterDisabled","optionName","execFn","_export","eventName","execName","run","exeFn","keymap","Backspace","Tab","Enter","Shift","Control","Alt","CapsLock","Esc","Spacebar","PageUp","PageDown","End","Home","Left","Up","Right","Down","Insert","Del","NumLock","Cmd","=","-","z","LocalStorage","getUserData","addBehavior","LOCAL_FILE","setItem","storage","localStorage","saveLocalData","getLocalData","ROOTKEY","setPreferences","getPreferences","removePreferences","allowDivTransToP","disabledTableInTable","tdParent","cdata_tag","_ue_custom_node_","tmpNodes","notNeedFilter","filterRules","hadBreak","tmpLi","autoHeightEnabled","isLine","notEmpty","highlightCont","removeNotAttributeSpan","autotype","pasteFilter","clearFontSize","clearFontFamily","fontFamily","mergeEmptyline","removeEmptyline","remainTag","indent","textIndent","indentValue","textAlign","remainClass","imageBlockLine","pN","pNode","removeEmptyNode","removeTagNames","tobdc","ToDBC","bdc2sb","DBC2SB","txtstring","readLocalOpts","cookieOpt","autotypeset","selectTdClass","pagebreak","anchorclass","shortcutkey","autosubmit","submit","stringToObj","setBackground","cssRuleId","isSetColored","orgFn","bindEvents","su","imagePath","bgObj","background-color","background-image","background-repeat","background-position","aftersetcontent","inputRule","outputRule","align","floatStyle","unhtmlData","imgCi","border","alt","hspace","vspace","defaultValue","justify","doJustify","bookmark2","common","text-align","cell","mergeWithParent","needSetChild","bk","mergesibling","backgroundColor","fonts","forecolor","backcolor","fontsize","fontfamily","underline","strikethrough","fontborder","needCmd","6","7","spanParent","styleVal","optimize","doLink","rngClone","textValue","highlight","ps","pe","as","deleteIframe","_iframe","removeFormatTags","removeFormatAttributes","notIncludeA","isRedundantSpan","doRemove","bookmark1","tagReg","getObj","startBlock","endBlock","blockquotes","doEnd","childs","bkEnd","curNode","print","close","selectAll","notExchange","doParagraph","sourceCmdName","para","doDirectionality","forward","formatTime","date","ss","formatDate","yyyy","yy","mm","rowspacingtop","rowspacingbottom","lineheight","as3","bash","cpp","cf","c#","delphi","diff","erlang","groovy","java","jfx","js","pl","php","plain","python","ruby","scala","sql","vb","xml","brs","notNeedCodeQuery","help","undo","redo","searchreplace","preview","insertparagraph","elementpath","insertcode","inserthtml","selectall","fillchar","evtName","anchorname","anchor","ignores","20","isHr","notBreakTags","pageBreakTag","noshade","images","wordimage","urlList","$GLOBAL_CONFIG","word_img","compareAddr","indexA","indexB","compareRangeAddress","rngAddrA","rngAddrB","UndoManager","hasUndo","hasRedo","scene","orgState","noNeedFillCharTags","update","clearKey","getScene","rngAddress","notCompareRange","saveSceneTimer","currentScene","lastScene","maxUndoCount","keycont","lastKeyCode","maxInputCount","undoManger","exclude","inputType","Undo","Redo","isCollapsed","interalTimer","clearInterval","stopCmdUndo","startCmdUndo","getClipboardData","pastebin","pi","pastebins","querySelectorAll","getPureHtml","atr","di","divs","tmpP","metas","dirtyNodes","spans","txtContent","htmlContent","retainOnlyLabelPasted","plainType","tmpAddress","alert","pasteplain","transP","removeNode","listToArray","adjustListStyle","ignore","nodeStyleType","parentStyleType","styleIndex","listStyle","setListStyle","paddingLeft","customStyle","adjustList","ignoreEmpty","nextList","preList","getLi","TD","PRE","BLOCKQUOTE","cn1","cn2","num","num1","num2","dash","dot","autoTransWordToList","insertorderedlist","decimal","lower-alpha","lower-roman","upper-alpha","upper-roman","insertunorderedlist","disc","square","listDefaultPaddingLeft","listiconpath","maxListLevel","disablePInList","OL","UL","liiconpath","customCss","pn","newChildrens","lastNode","checkListType","unorderlisttype","orderlisttype","appendLi","cacheNode","preventAndSave","findList","parentList","nextLi","checkLevel","levelNum","closeList","parentLi","startParent","endParent","bko","modifyStart","modifyEnd","nodeStyle","tmpFrag","tmpfrag","hasBlock","tmpDiv","tmpDivs","sourceEditors","holder","onresize","setSelectionRange","dispose","codemirror","codeEditor","CodeMirror","tabMode","lineNumbers","lineWrapping","getWrapperElement","getScrollerElement","getCodeMirror","createSourceEditor","sourceEditor","orgSetContent","sourceMode","sourceEditorFirst","bakCssText","oldGetContent","bakAddress","oldQueryCommandState","codeMirrorJsUrl","rel","codeMirrorCssUrl","hTag","doSave","startTd","endTd","excludeTagNameForTabKey","tabSize","tabNode","autoClearTagName","Scale","resizer","cover","prePos","startPos","elementUpdated","dragId","hands","getDom","initStyle","initEvents","isDraging","_eventHandler","hand","proxy","updateContainerStyle","updateTargetElement","attachTo","_validScaledProp","prop","ele","wrap","isNaN","hideCover","showCover","editorPos","iframePos","targetObj","imgPos","borderLeftWidth","borderTopWidth","imageScale","imageScaleEnabled","_keyDownHandler","_mouseDownHandler","keydown","charCode","checkIsCludeLink","keyCodes","32","adjustHeight","isFullscreen","currentHeight","lastHeight","bakOverflow","enableAutoHeight","overflowY","disableAutoHeight","lastScrollY","onscroll","scrollY","checkHasUI","autofloatMsg","fixIE6FixedPos","docStyle","backgroundImage","backgroundAttachment","setFloating","toobarBoxPos","toolbarBox","origalFloat","origalLeft","placeHolder","LteIE6","orgTop","topOffset","unsetFloating","updateFloating","rect3","toolbarTopOffset","optsAutoFloatEnabled","autoFloatEnabled","uiUtils","defer_updateFloating","getClientRect","enabled","creatInsertStr","classname","lastIndexOf","switchImgAndVideo","img2video","videoObjs","cl","vi","showError","UETable","indexTable","selectedTds","cellsRange","removeSelectedClass","cells","addSelectedClass","getWidth","getTableCellAlignState","tempStatus","isSame","cellNode","currentState","getTableItemsByRange","getUETableBySelected","ueTable","getDefaultValue","tableBorder","tdPadding","tdBorder","tmpValue","borderMap","thin","medium","thick","insertRow","insertCell","getUETable","tdOrTable","cloneCell","ignoreMerge","keepPro","tmpCell","rowSpan","colSpan","borderLeftStyle","borderTopStyle","borderLeftColor","borderRightColor","borderRightWidth","borderTopColor","borderBottomColor","borderBottomWidth","getMaxRows","rows","maxLen","currentMax","getMaxCols","cellRows","cellsNum","getCellColIndex","getHSideCell","previewRowIndex","previewColIndex","cellInfo","getCellInfo","beginColIndex","colIndex","endColIndex","colsNum","beginRowIndex","rowIndex","getCell","cellIndex","getTabNextCell","preRowIndex","nextCell","getVSideCell","ignoreRange","nextRowIndex","nextColIndex","endRowIndex","rowsNum","getSameEndPosCells","xOrY","returns","setCellContent","getSameStartPosXCells","dNum","tds","selectTds","startInfo","endInfo","rowInfo","numCols","deleteCell","getCellsRange","cellA","cellB","checkRange","tmpBeginRowIndex","tmpBeginColIndex","tmpEndRowIndex","tmpEndColIndex","cellAInfo","cellBInfo","getCells","clearSelected","tdHash","returnTds","setSelected","isFullRow","isFullCol","ths","getNextCell","getPreviewCell","moveContent","cellTo","cellFrom","mergeRight","rightColIndex","rightCellInfo","rightCell","mergeDown","downRowIndex","downCellInfo","downCell","mergeRange","leftTopCell","deleteRow","curIndex","sourceCell","replaceTdToTh","tableRow","isInsertTitle","infoRow","insertCellIndex","nextRow","preMerged","getPreviewMergedCellsNum","deleteTds","cacheMap","tmpRowIndex","tmpCellIndex","mergeTds","insertCol","preCell","backWidth","isInsertTitleCol","updateWidth","tmpWidth","deleteCol","tableRows","backTableWidth","backTdWidth","splitToCells","splitToRows","splitToCols","endRow","indexRow","endCol","isLastCell","getLastCell","cols","selectRow","selectTable","repeat","colorList","colors","getColor","removeBackground","resetTdWidth","getTableWidth","tdsWidths","needIEHack","getSelectedArr","ut","UT","createTable","tdWidth","numRows","tdvalign","defaultCols","defaultRows","firstParentBlock","tableWidth","valign","firstRow","lastRow","tableItems","maxRowNum","newCell","maxColNum","getAverageWidth","averageWidth","tb","sumWidth","tbAttr","setAverageWidth","getAverageHeight","averageHeight","rowNum","sumHeight","tdpadding","captionHeight","thHeight","captionArr","thArr","trs","setAverageHeight","verticalAlign","vAlign","activeMenuCell","borderColor","bkColor","interlaced","classList","borderWidth","borderStyle","removeStyleSize","replaceToProperty","getParentTdOrTh","mouseCoords","pageX","pageY","clientLeft","clientTop","mouseMoveEvent","isEditorDisabled","isInResizeBuffer","abs","userActionStatus","offsetOfTableCell","clearTableDragTimer","singleClickState","tableBorderDrag","onDrag","dragTd","toggleDraggableState","dragLine","getPermissionX","getPermissionY","getRelation","inTableSide","cursorpath","toggleDragButton","createDragButton","dragOver","dragButtonTimer","dragButton","doClick","doDblClick","onmouseover","onmouseout","capHeight","preTd","nextTd","cellMinWidth","mousePosY","draggable","mousePos","mousedown","hideDragLine","getDragLine","showDragLineAt","onBorder","elePos","cellBorderWidth","mouseDownEvent","getTargetTd","tableClickHander","tableDbclickHandler","getCellsByMoveBorder","extractArray","oldWidth","newWidth","changeable","change","getTabcellSpace","borderActionHandler","mouseOverEvent","reconstruct","tableDragTimer","dblclickTime","originArr","newObj","mouseUpEvent","tableResizeTimer","dragTdPos","dragLinePos","changeColWidth","changeRowHeight","tar","currentTd","setCellHeight","backHeight","lineHight","tmpHeight","changeValue","correctChangeValue","cellGroup","isContainMergeCell","temp","borderCells","tabRow","currIndex","tabCell","relatedCell","getTableCellWidth","direction","curCell","getTableCellOffset","tab","offsetVal","prev","tabcellSpace","trow","tabcell","mirror","paddingSpace","tmpTabWidth","contenteditable","onresizestart","ondragstart","line","tablePos","cellPos","switchBorderColor","tableArr","cellWidth","cellHeight","orgGetText","tableDragable","deletetable","inserttable","cellvalign","insertcaption","deletecaption","inserttitle","deletetitle","mergeright","mergedown","mergecells","insertrow","insertrownext","deleterow","insertcol","insertcolnext","deletecol","splittocells","splittorows","splittocols","adaptbytext","adaptbywindow","adaptbycustomer","insertparagraphbeforetable","averagedistributecol","averagedistributerow","tableCopyList","cloneTd","tables","wordBreak","onmousemove","endTdCol","endTdRow","getClass","currentRowIndex","notCtrlKey","backWidths","datatat","cmdFun","lastState","lastValue","sortTable","sortByCellIndex","trArray","lastRowIndex","Fn","reversecurrent","td1","td2","orderbyasc","value1","textContent","value2","reversebyasc","orderbynum","reversebynum","tr1","tr2","fragment","contextMenu","cleardoc","confirm","confirmclear","unlink","group","paragraph","icon","subMenu","justifyleft","justifyright","justifycenter","justifyjustify","inserttitlecol","deletetitlecol","averageDiseRow","averageDisCol","edittd","getDialog","edittable","setbordervisible","tablesort","enablesort","disablesort","borderbk","setcolor","unsetcolor","setbackground","unsetbackground","redandblue","threecolorgradient","aligntd","aligntable","tableleft","tablecenter","tableright","insertparagraphbefore","insertparagraphafter","getViewportOffsetByEvent","contextItems","getLabel","subItem","query","Menu","showAt","zeroclipboard","clip","shortcutMenu","customEvt","screenX","screenY","ShortCutMenu","isHidden","basestyles","bold","italic","subscript","superscript","Bold","Italic","Underline","elementPathEnabled","names","addList","addFormat","imgT","findTextInString","searchStr","casesensitive","findTextBlockElm","methodName","_blockElm","findNTextInBlockElm","currentNode","currentNodeLength","searchReplace","startBlockNode","rngText","replaceStr","replaceText","rngStart","rngEnd","customstyle","tmpObj","catchRemoteImageEnable","catchremoteimage","imgs","callbacks","params","catcherActionUrl","catcherFieldName","catcherLocalDomain","catcherUrlPrefix","remoteImages","getLocation","pathname","snapplugin","snapscreen","onSuccess","rs","snapscreenUrlPrefix","snapscreenImgAlign","callBackErrorMsg","local","saveSnapshot","_dialogs","front","createInsertStr","toEmbed","cssfloat","logo","webapp","tnode","music","musicObj","sendAndInsertFile","fieldName","urlPrefix","maxSize","allowFiles","actionUrl","loadingHtml","errorHandler","successHandler","filetype","loadingId","loader","original","fileext","fd","response","er","getPasteImage","getDropImage","hasImg","saveData","lastSaveTime","MIN_TIME","saveKey","_saveFlag","saveInterval","_suffix","contentchange","clearlocaldata","getlocaldata","drafts","validData","firstRows","cellCount","chartserror","charts","tableNode","flagText","subTitle","xTitle","yTitle","suffix","dataFormat","tableDataFormat","chartType","Section","nextSection","previousSection","parentSection","getSection","getNodeFromAddress","bindMultiEvents","afterexeccommand","keyup","getsections","levels","getSectionLevel","levelFn","Directory","tmpSection","previous","movesection","sourceSection","targetSection","isAfter","isContainsAddress","addressTarget","isAfterStartAddress","isBeforeEndAddress","targetAddress","deletesection","selectsection","scrolltosection","initUploadBtn","containerBtn","btnIframe","btnStyle","wrapper","btnIframeDoc","btnIframeBody","timestrap","contentDocument","contentWindow","imageFieldName","imageUrlPrefix","showErrorLoader","imageActionUrl","stateTimer","isLoaded","simpleuploadbtnready","simpleupload","serverParam","serverparam","getFileIcon","maps","rar","zip","gz","bz2","docx","pdf","mp3","xls","chm","ppt","pptx","avi","rmvb","wmv","flv","rm","exe","psd","jpg","png","jpeg","gif","ico","bmp","insertfile","filelist","iconDir","xssFilter","tagList","updateFixedOffset","layer","bindFixedLayer","adjOffset","magic","uidMagic","uidCount","hook","dg","_callbacks","createElementByHtml","getViewportElement","bcr","getViewportRect","viewportEl","innerWidth","innerHeight","fixedLayer","getFixedLayer","getEventOffset","frameEl","setGlobal","unsetGlobal","copyAttributes","tgt","attrNode","elA","elB","compareDocumentPosition","startDrag","handleMouseMove","startX","startY","ondragmove","cancelBubble","handleMouseUp","ondragstop","releaseCaptrue","releaseCapture","setCapture","makeUnselectable","WebkitUserSelect","UIBase","uiName","initOptions","initUIBase","_globalKey","renderHtml","seatEl","postRender","getHtmlTpl","formatHtml","box","Separator","initSeparator","Mask","_fill","_onMouseDown","_onClick","vpRect","closeAllPopup","allPopups","queryAutoHide","Popup","initPopup","postHide","ANCHOR_CLASSES","SHADOW_RADIUS","_hidden","autoRender","canSideLeft","canSideUp","getContentHtmlTpl","_UIBase_postRender","captureWheel","captured","_height","_top","combox","ifr","wheelDelta","detail","_doAutoRender","mesureSize","fitSize","sized","__size","popBodyEl","showAnchor","hoz","showAnchorRect","adj","visibility","_show","sideLeft","sideUp","popSize","popEl","notNofity","genColorPicker","noColorText","COLORS","ColorPicker","_onTableClick","_onTableOver","_onTableOut","_onPickNoColor","TablePicker","initTablePicker","defaultNumRows","defaultNumCols","maxNumRows","maxNumCols","lengthOfCellSide","_UIBase_render","_track","sideLen","_onMouseOver","relatedTarget","fromElement","_onMouseOut","toElement","_onMouseMove","TPL_STATEFUL","Stateful","alwalysHoverable","Stateful_init","_Stateful_dGetHtmlTpl","Stateful_getHtmlTpl","Stateful_onMouseEnter","isDisabled","addState","Stateful_onMouseLeave","removeState","Stateful_onMouseOver","Stateful_onMouseOut","Stateful_onMouseDown","Stateful_onMouseUp","Stateful_postRender","hasState","getStateDom","isChecked","setChecked","checked","Button","btnName","cssRules","initButton","showIcon","showText","setTitle","SplitButton","initSplitButton","popup","setPopup","_onPopupShow","_onPopupHide","showPopup","_onArrowClick","_onButtonClick","ColorButton","initColorButton","onpickcolor","_onPickColor","onpicknocolor","_SplitButton_postRender","setColor","TableButton","initTableButton","onpicktable","_onPickTable","AutoTypeSetPicker","initAutoTypeSetPicker","textAlignInputName","imageBlockInputName","symbolConverInputName","mergeLine","delLine","removeFormat","alignment","imageFloat","removeFontsize","removeFontFamily","removeHtml","symbol","getPara","ipt","editorId","ipts","attrValue","iptchild","iptChilds","selects","AutoTypeSetButton","initAutoTypeSetButton","popupUI","radioTd","radios","defalutSelect","symbolConver","checkboxs","CellAlignPicker","initSelected","initCellAlignPicker","middle","selected","selectedIndex","alignType","COUNT","tempClassName","tempIndex","tmpl","PastePicker","initPastePicker","_isTransfer","screenHt","subPop","Toolbar","initToolbar","initMenu","menuSeparator","initItems","getSeparator","MenuItem","createItem","_Popup_getContentHtmlTpl","_Popup_postRender","ownerMenu","clearItems","_showingTimer","_closingTimer","parentMenu","renderLabelHtml","delayShowSubMenu","delayHideSubMenu","hideSubMenu","_bakQueryAutoHide","tabIndex","showSubMenu","this_","Combox","initCombox","onbuttonclick","selectByIndex","setLabel","initValue","indexByValue","getLabelForUnknowValue","modalMask","dragMask","activeDialog","autoReset","onok","oncancel","onclose","holdScroll","initDialog","closeButton","closeDialog","initResizeEvent","buttons","__resizeTimer","dialogWrapNode","contentNode","wrapRect","contentRect","safeSetOffset","showAtCenter","_originalContext","overflowX","titleHeight","getContentHtml","contentHtml","iframeUrl","footHtml","_hide","dialogBodyStyle","_onTitlebarMouseDown","wrapNode","_onCloseButtonClick","MenuButton","initMenuButton","_value","MultiMenuPop","initMultiMenu","iframe_rendered","onshow","hideAllMenu","allMenus","timeID","UI","isSubMenuShow","initShortCutMenu","SPACE","initEvent","getSubMenuMark","eventType","wt","ht","distanceX","distanceY","setOpacity","relatedTgt","layerEle","hasContextmenu","setPos","setPosByCxtMenu","fixedlayer","Breakline","Message","initMessage","keepshow","setType","closer","getType","editorui","_Dialog","scrollX","iframeUrlMap","insertimage","spechars","gmap","insertvideo","emotion","attachment","insertframe","edittip","scrawl","btnCmds","labelMap","causeByUi","uiReady","typeset","imagefloat","directionality","cmd2","dialogBtns","noOk","vals","mapUrl","unNeedCheckState","onselect","langLabel","langCs","ck","ri","rowspacings","lists","_onMenuClick","isFullScreen","iconSpan","EditorUI","initEditorUI","nodeStack","setCount","wordCount","maximumWords","wordCountMsg","wordOverFlowMsg","errMsg","countDom","_initToolbars","countFn","_actualFrameWidth","_scale","enableScale","disableScale","pastePop","isPaste","_onEditButtonClick","linkDialog","_onImgEditButtonClick","_onImgSetFloat","_setIframeAlign","frame","anchorEl","newFrame","_updateIframe","mapDialog","insertframeDialog","_onRemoveButtonClick","dialogs","dialogName","toolbarUis","toolbar","toolbarUi","toolbarItem","toolbarItemUi","itemUI","renderToolbarBoxHtml","showWordImageDialog","_fullscreen","_bakHtmlOverflow","_bakBodyOverflow","_bakAutoHeight","_bakScrollTop","_bakEditorContaninerWidth","_bakCssText","_bakCssText1","_updateFullScreen","scroll","triggerLayout","_updateElementPath","disableElementPath","enableElementPath","down","editorHolder","minEditorHeight","bottombar","scalelayer","move","editorDocument","up","clearSelection","scaleWidth","scaleHeight","minEditorWidth","isMouseMove","fullScreen","timerId","updateFullScreenTime","showToolbarMsg","hideToolbarMsg","zoom","instances","oldRender","renderUI","newDiv","displays","styleWidth","registerUI","updateHolderPos","toolbarbox","_messageItems","mid","formatmatch","horizontal","removeformat","time","directionalityltr","directionalityrtl","imagenone","imageleft","imageright","imagecenter","touppercase","tolowercase","songti","kaiti","heiti","lishu","yahei","andaleMono","arial","arialBlack","comicSansMs","impact","timesNewRoman","tc","tl","im","autoupload","exceedSizeError","exceedTypeError","jsonEncodeError","loading","loadError","errorLoadConfig","elementPathTip","wordCountTip","cancel","tableDrag","loadconfigError","loadconfigFormatError","loadconfigHttpError","snapScreen_plugin","browserMsg","uploadErrorMsg","confirmClear","delete","deletecode","mergeleft","copymsg","pastemsg","anthorMsg","clearColor","standardColor","themeColor","property","default","modify","anchorMsg","clickToUpload","unset","t_row","t_col","more","pasteOpt","pasteSourceFormat","tagFormat","pasteTextFormat","autoTypeSet","static","lang_background_normal","lang_background_local","lang_background_set","lang_background_none","lang_background_colored","lang_background_color","lang_background_netimg","lang_background_align","lang_background_position","repeatType","noUploadImage","toggleSelect","lang_tab_remote","lang_tab_upload","lang_tab_online","lang_tab_search","lang_input_url","lang_input_size","lang_input_width","lang_input_height","lang_input_border","lang_input_vhspace","lang_input_title","lang_input_align","lang_imgLoading","lang_start_upload","lock","searchType","searchTxt","searchBtn","searchReset","noneAlign","leftAlign","rightAlign","centerAlign","uploadSelectFile","uploadAddFile","uploadStart","uploadPause","uploadContinue","uploadRetry","uploadDelete","uploadTurnLeft","uploadTurnRight","uploadPreview","uploadNoPreview","updateStatusReady","updateStatusConfirm","updateStatusFinish","updateStatusError","errorNotSupport","errorExceedSize","errorFileType","errorInterrupt","errorUploadRetry","errorHttp","errorServerUpload","remoteLockError","numError","imageUrlError","imageLoadError","searchRemind","searchLoading","searchRetry","lang_drop_remind","lang_tab_insertV","lang_tab_searchV","lang_tab_uploadV","lang_video_url","lang_video_size","lang_videoW","lang_videoH","lang_alignment","videoSearchTxt","videoType","videoSearchBtn","videoSearchReset","lang_input_fileStatus","lang_upload_size","lang_upload_width","lang_upload_height","lang_upload_alignment","lang_format_advice","floatLeft","floatRight","\"default\"","urlError","clickToSelect","goToSource","noVideo","browseFiles","uploadSuccess","delSuccessFile","delFailSaveFile","statusPrompt","flashVersionError","flashLoadingError","fileUploadReady","delUploadQueue","limitPrompt1","limitPrompt2","delFailFile","emptyFile","fileTypeError","unknownError","fileUploading","cancelUpload","netError","failUpload","serverIOError","noAuthority","failCheck","fileCanceling","stopUploading","tip1","tip2","applyFor","anthorApi","lang_template_bkcolor","lang_template_clear","lang_template_select","blank","blog","resume","richText","sciPapers","lang_input_previousStep","lang_input_nextsStep","lang_input_clear","lang_input_addPic","lang_input_ScalePic","lang_input_removePic","J_imgTxt","noScarwl","scrawlUpLoading","continueBtn","imageError","backgroundUploading","lang_input_tips","J_searchBtn","emptyTxt","chapter","singer","special","listenTest","lang_input_anchorName","lang_data_source","lang_chart_format","lang_data_align","lang_chart_align_same","lang_chart_align_reverse","lang_chart_title","lang_chart_main_title","lang_chart_sub_title","lang_chart_x_title","lang_chart_y_title","lang_chart_tip","lang_cahrt_tip_prefix","lang_cahrt_tip_description","lang_chart_data_unit","lang_chart_data_unit_title","lang_chart_data_unit_description","lang_chart_type","lang_prev_btn","lang_next_btn","lang_input_choice","lang_input_Tuzki","lang_input_BOBO","lang_input_lvdouwa","lang_input_babyCat","lang_input_bubble","lang_input_youa","lang_input_address","lang_input_search","searchError","lang_input_about","lang_input_shortcuts","lang_input_introduction","lang_Txt_shortcuts","lang_Txt_func","lang_Txt_bold","lang_Txt_copy","lang_Txt_cut","lang_Txt_Paste","lang_Txt_undo","lang_Txt_redo","lang_Txt_italic","lang_Txt_underline","lang_Txt_selectAll","lang_Txt_visualEnter","lang_Txt_fullscreen","lang_input_isScroll","lang_input_frameborder","lang_input_alignMode","enterAddress","lang_input_text","lang_input_target","validLink","httpPrompt","lang_city","lang_address","city","lang_search","lang_dynamicmap","cityMsg","errorMsg","lang_tab_replace","lang_search1","lang_search2","lang_replace","lang_searchReg","lang_searchReg1","lang_case_sensitive1","lang_case_sensitive2","nextFindBtn","preFindBtn","nextReplaceBtn","preReplaceBtn","repalceBtn","repalceAllBtn","getEnd","countMsg","lang_showMsg","lang_download","lang_step1","lang_step2","tsfh","lmsz","szfh","rwfh","xlzm","ewzm","pyzm","yyyb","zyzf","lang_tableStyle","lang_insertCaption","lang_insertTitle","lang_insertTitleCol","lang_orderbycontent","lang_tableSize","lang_autoSizeContent","lang_autoSizePage","lang_example","lang_borderStyle","lang_color","captionName","titleName","cellsName","lang_delRow","lang_delCol","lang_tdBkColor","formula","lang_resave","uploadBtn","clipboard","lang_step","fileType","flashError","copySuccess","flashI18n","autosave","saving","success","changeTagName","aliasName","startDom","$btn","iconEle","Pubsub","channel","pictureTpl","detectQr","imgReplace","imgMaxLen","imgLimitNUm","imgTimes","$content","newPop","$showBox","customCb","$insertDom","insertedImgLen","not","topicQrId","useNewCode","checkShow","sendNum","getCode","$parent","$target","setPubliser","changeImage","$lastNode","pictureHTML","times","imgProto","$editor","lastOffsetTop","lastPosition","changeSrc","uploadPop","pubName","dialogUploader","$webUpLoader","$imgList","eq","pub","onFileQueued","numList","number","$uploadBox","before","onUploadSuccess","WebUploader","hint","notice","selector","delSelector","defaultApi","onBeforeFileQueued","onUploadError","onUploadProgress","onErrored","_this","delImage","webuploader","https","imgRule","shotCut","imgType","grepStr1","grepStr2","orignalImgReplace","addShortCut","$imgs","_orignal","Scans","qid","uploadMaxNum","maxNum","interval","customInit","isLoad","imgArr","$cover","$localBtn","codeTpl","pageId","imgLength","datas","qidArr","qrcodeId","_data","getCodeCb","monitor","post","groupkey","scanCb","insertPic","_proto","unLoading","is","fixPop","isload","dataArr","tempArr","diffLen","whiteList","goodsLimitNUm","csspath","enableContextMenu","enableAutoSave","transform","imageTransformPopup","cutstomPosition","_filterType","_link","_left","_right","_delete","$picLoading","firing","transformAngle","$obj","def","angle","detectImg","angleStr","tempObj","extendObj","renderImg","renderExist","beforeSend","dataSrc","hoverEl","inputTpl","domainReg","grepLocal","dealLink","$this","toast","goodsTpl","from","insertedGoods","$goodsDoms","goodsLen","goodsData","skuId","changedItem","DomArr","creatNewP","nextElementSibling","$goodsCards","$eParent","$preDom","$goodsCard","goodsHTML","$el","$li","$next","addDialog","itemlist","defaultItemlist","indexof","pageNum","isDefault","keyWord","changedList","isGetMore","degree","$searchTop","$searchInput","$searchBtn","$searchNormal","$searchLoading","$searchFail","$searchResult","$searchList","$changeNum","$listBox","$changeList","$title","$getMore","$searchListBox","selectedGoods","changedGoods","returnList","imgSrc","changeNum","dialogClosed","defaultItem","searchItem","reGet","changeItem","getMoreItem","getItems","pagesize","keycode","moreItem","pagenum","word","pageCount","resultItem","collections","pId","shopId","itemLink","PId","price","closest","$value","sUrl","mainImage","salePrice","rebateMoney","skuPrice","rebate","deleteNode","closedNode","detectKey","backspaceKey","deleteKey","defaultKey","$prev","prentsNode","grepHtml","pastedCheckImg","getHtml","overload","grepImg","selectGetHtml","outerImgLen","innerImgLen","limitNum","checkNum","innerImg","outerImg","grepDiv","useAlert","case_1","case_2","tempHtml","_typeof","Symbol","defaultImg","setImgPath","useDefault","_loop","test_src","thisSrc","ieVersion","dropStr","tempRange","dropToP","grepRule","grepFormat","grepCursor","isIe","renderP","textOffset","imgOffset","_node","oldTextNode","renderBody","removeAttr","imgPrent","_body","setData","i18n","fetchData","_datas","imgReader","reader","imageBase64","_w","_h","readAsDataURL","linkTransformPopup","_editLink","_delLink","grepDom","innerGoods","innerGoodsLen","ueGoods","outerGoodsLen","objs","popWidth","elt","Number","emojis","faceTpl","emojiData","emojiMap","makeData","Face","foo","_bindHtml","faceHTML","_bindEvent","setShowIndex","activeCls","hideCls","faceReg","faceUrl","parseEmoji","old","faceInstance","goodsdMask","hideMask","$s","lenth","rewriteTxtRules","txtRules","newRules","data-type","data-original","editPath","tid","editKey","strs","restoreContent","unsuccessful","orignText","originRule1","originRule2","restoreTitle","restoreLabel","restoreGroup","arrs","restoreText","restoreImg","restoreItem","formatText","decode","$topicTitleTips","$titleCharLen","isVideo","isMeihao","tempSrc","tempProto","itemDetailUrl","itemTpl","labels","labelTpl","$crtLists","groupId","$selectGroup","&ldquo;","&rdquo;","relativePath","i_domain","relUrl","click","tempstr","tagNode","_thisNode","_thisValue","kid","htmlNull","re"],"mappings":"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","file":"editor.js","sourcesContent":["webpackJsonp([6],[\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\t/*   使用示例  初始化已经集成至init.js\n\tvar ue = UE.getEditor('editor',{\n\t\t\ttoolbars:[[]]\n\t\t});\n\t*/\n\tvar ueditor = __webpack_require__(106);\n\t//var editorOpt = require(\"editor/pcInit\");\n\t\n\tvar test = __webpack_require__(167);\n\t\n\tvar ue = ueditor();\n\t\n\ttest.init(ue);\n\n/***/ }),\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */,\n/* 32 */,\n/* 33 */,\n/* 34 */\n/***/ (function(module, exports) {\n\n\t/*TMODJS:{}*/\r\n\t!function () {\r\n\t\tfunction a(a, b) {\r\n\t\t\treturn (/string|function/.test(typeof b) ? h : g)(a, b)\r\n\t\t}\r\n\t\r\n\t\tfunction b(a, c) {\r\n\t\t\treturn \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a\r\n\t\t}\r\n\t\r\n\t\tfunction c(a) {\r\n\t\t\treturn l[a]\r\n\t\t}\r\n\t\r\n\t\tfunction d(a) {\r\n\t\t\treturn b(a).replace(/&(?![\\w#]+;)|[<>\"']/g, c)\r\n\t\t}\r\n\t\r\n\t\tfunction e(a, b) {\r\n\t\t\tif (m(a))for (var c = 0, d = a.length; d > c; c++)b.call(a, a[c], c, a); else for (c in a)b.call(a, a[c], c)\r\n\t\t}\r\n\t\r\n\t\tfunction f(a, b) {\r\n\t\t\tvar c = /(\\/)[^\\/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^\\/]+$/, \"\"), e = d + b;\r\n\t\t\tfor (e = e.replace(/\\/\\.\\//g, \"/\"); e.match(c);)e = e.replace(c, \"/\");\r\n\t\t\treturn e\r\n\t\t}\r\n\t\r\n\t\tfunction g(b, c) {\r\n\t\t\tvar d = a.get(b) || i({filename: b, name: \"Render Error\", message: \"Template not found\"});\r\n\t\t\treturn c ? d(c) : d\r\n\t\t}\r\n\t\r\n\t\tfunction h(a, b) {\r\n\t\t\tif (\"string\" == typeof b) {\r\n\t\t\t\tvar c = b;\r\n\t\t\t\tb = function () {\r\n\t\t\t\t\treturn new k(c)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar d = j[a] = function (c) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn new b(c, a) + \"\"\r\n\t\t\t\t} catch (d) {\r\n\t\t\t\t\treturn i(d)()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn d.prototype = b.prototype = n, d.toString = function () {\r\n\t\t\t\treturn b + \"\"\r\n\t\t\t}, d\r\n\t\t}\r\n\t\r\n\t\tfunction i(a) {\r\n\t\t\tvar b = \"{Template Error}\", c = a.stack || \"\";\r\n\t\t\tif (c)c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); else for (var d in a)c += \"<\" + d + \">\\n\" + a[d] + \"\\n\\n\";\r\n\t\t\treturn function () {\r\n\t\t\t\treturn \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tvar j = a.cache = {}, k = this.String, l = {\r\n\t\t\t\"<\": \"&#60;\",\r\n\t\t\t\">\": \"&#62;\",\r\n\t\t\t'\"': \"&#34;\",\r\n\t\t\t\"'\": \"&#39;\",\r\n\t\t\t\"&\": \"&#38;\"\r\n\t\t}, m = Array.isArray || function (a) {\r\n\t\t\t\treturn \"[object Array]\" === {}.toString.call(a)\r\n\t\t\t}, n = a.utils = {\r\n\t\t\t$helpers: {}, $include: function (a, b, c) {\r\n\t\t\t\treturn a = f(c, a), g(a, b)\r\n\t\t\t}, $string: b, $escape: d, $each: e\r\n\t\t}, o = a.helpers = n.$helpers;\r\n\t\ta.get = function (a) {\r\n\t\t\treturn j[a.replace(/^\\.\\//, \"\")]\r\n\t\t}, a.helper = function (a, b) {\r\n\t\t\to[a] = b\r\n\t\t}, module.exports = a\r\n\t}();\n\n/***/ }),\n/* 35 */,\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar Dialog = __webpack_require__(37);\n\tvar noop = function noop() {};\n\t\n\tvar create = function create(content, options) {\n\t    content = content || '';\n\t    options = options || {};\n\t    var defaults = {\n\t        fixed: true,\n\t        modal: true,\n\t        autofocus: false,\n\t        content: '<p class=\"del-pop-p\">' + content + '</p>',\n\t        className: 'pop-box',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        ok: noop\n\t    };\n\t    $.extend(true, defaults, options);\n\t    var d = Dialog(defaults);\n\t\n\t    var header = d._$('header');\n\t    var title = d._$('title');\n\t    if (!options.title) {\n\t        title.css('borderBottom', 'none');\n\t    }\n\t    header.show();\n\t    d.show();\n\t    return d;\n\t};\n\t\n\tmodule.exports = create;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/*\r\n\t * 弹层提示弹窗\r\n\t * zhaodonghong\r\n\t */\n\t\n\tvar $publicMask;\n\tvar $publicTips;\n\tvar timer;\n\t\n\tvar events = function events() {\n\t\n\t    $publicMask.off().on('click', function () {\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t    });\n\t\n\t    $publicTips.off().on('click', function () {\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t    });\n\t};\n\t\n\t/**\r\n\t * msg string 提示信息\r\n\t * options object \r\n\t * options.duration settimout消失时间\r\n\t * options.callback 提示消失的回调\r\n\t*/\n\tvar init = function init(msg, options) {\n\t    var defaults = {\n\t        duration: 2000,\n\t        callback: function callback() {}\n\t    };\n\t\n\t    $.extend(defaults, options || {});\n\t\n\t    clearTimeout(timer);\n\t    $publicMask = $('[data-action=\"publicMask\"]');\n\t    $publicTips = $('[data-action=\"publicTips\"]');\n\t\n\t    if ($publicMask.length > 0) {\n\t\n\t        $publicMask.show();\n\t        $publicTips.show().text(msg);\n\t    } else {\n\t\n\t        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\n\t        $publicMask = $('[data-action=\"publicMask\"]');\n\t        $publicTips = $('[data-action=\"publicTips\"]');\n\t        events();\n\t    }\n\t\n\t    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\n\t\n\t    timer = setTimeout(function () {\n\t\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t\n\t        defaults.callback();\n\t    }, defaults.duration);\n\t};\n\t\n\tmodule.exports = {\n\t    init: init,\n\t    events: events\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 45 */,\n/* 46 */,\n/* 47 */,\n/* 48 */,\n/* 49 */,\n/* 50 */,\n/* 51 */,\n/* 52 */,\n/* 53 */,\n/* 54 */,\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\tvar imgPath = $_CONFIG.imgpath + '/images/emoji/';\n\t\n\tvar ext = '.png';\n\t\n\tvar groupOne = [{\n\t    name: '微笑',\n\t    url: 'weixiao'\n\t}, {\n\t    name: '色',\n\t    url: 'se'\n\t}, {\n\t    name: '亲亲',\n\t    url: 'qinqin'\n\t}, {\n\t    name: '得意',\n\t    url: 'deyi'\n\t}, {\n\t    name: '流泪',\n\t    url: 'liulei'\n\t}, {\n\t    name: '害羞',\n\t    url: 'haixiu'\n\t}, {\n\t    name: '闭嘴',\n\t    url: 'bizui'\n\t}, {\n\t    name: '鼓掌',\n\t    url: 'guzhang'\n\t}, {\n\t    name: '大哭',\n\t    url: 'daku'\n\t}, {\n\t    name: '尴尬',\n\t    url: 'ganga'\n\t}, {\n\t    name: '生气',\n\t    url: 'shengqi'\n\t}, {\n\t    name: '调皮',\n\t    url: 'tiaopi'\n\t}, {\n\t    name: '呲牙',\n\t    url: 'ciya'\n\t}, {\n\t    name: '惊讶',\n\t    url: 'jingya'\n\t}, {\n\t    name: '委屈',\n\t    url: 'weiqu'\n\t}, {\n\t    name: '吐血',\n\t    url: 'tuxue'\n\t}, {\n\t    name: '冷汗',\n\t    url: 'lenghan'\n\t}, {\n\t    name: '抓狂',\n\t    url: 'zhuakuang'\n\t}, {\n\t    name: '难过',\n\t    url: 'nanguo'\n\t}, {\n\t    name: '偷笑',\n\t    url: 'touxiao'\n\t}, {\n\t    name: '白眼',\n\t    url: 'baiyan'\n\t}, {\n\t    name: '不屑',\n\t    url: 'buxie'\n\t}, {\n\t    name: '快哭了',\n\t    url: 'kuaikule'\n\t}];\n\t\n\tvar groupTwo = [{\n\t    name: '困',\n\t    url: 'kun'\n\t}, {\n\t    name: '装酷',\n\t    url: 'zhuangku'\n\t}, {\n\t    name: '大笑',\n\t    url: 'daxiao'\n\t}, {\n\t    name: '偷瞄',\n\t    url: 'toumiao'\n\t}, {\n\t    name: '奋斗',\n\t    url: 'fendou'\n\t}, {\n\t    name: '咒骂',\n\t    url: 'zhouma'\n\t}, {\n\t    name: '疑问',\n\t    url: 'yiwen'\n\t}, {\n\t    name: '晕',\n\t    url: 'yun'\n\t}, {\n\t    name: '捶打',\n\t    url: 'chuida'\n\t}, {\n\t    name: '再见',\n\t    url: 'zaijian'\n\t}, {\n\t    name: '抠鼻',\n\t    url: 'koubi'\n\t}, {\n\t    name: '发呆',\n\t    url: 'fadai'\n\t}, {\n\t    name: '坏笑',\n\t    url: 'huaixiao'\n\t}, {\n\t    name: '哈欠',\n\t    url: 'haqian'\n\t}, {\n\t    name: '鄙视',\n\t    url: 'bishi'\n\t}, {\n\t    name: '睡觉',\n\t    url: 'shuijiao'\n\t}, {\n\t    name: '饿',\n\t    url: 'e'\n\t}, {\n\t    name: '阴险',\n\t    url: 'yinxian'\n\t}, {\n\t    name: '难受',\n\t    url: 'nanshou'\n\t}, {\n\t    name: '可怜',\n\t    url: 'kelian'\n\t}, {\n\t    name: '撇嘴',\n\t    url: 'piezui'\n\t}, {\n\t    name: '石化',\n\t    url: 'shihua'\n\t}, {\n\t    name: '泪眼',\n\t    url: 'leiyan'\n\t}];\n\t\n\tvar groupThree = [{\n\t    name: '嘘',\n\t    url: 'xu'\n\t}, {\n\t    name: '哼哼',\n\t    url: 'hengheng'\n\t}, {\n\t    name: '爱慕',\n\t    url: 'aimu'\n\t}, {\n\t    name: '财迷',\n\t    url: 'caimi'\n\t}, {\n\t    name: '耶',\n\t    url: 'ye'\n\t}, {\n\t    name: '思考',\n\t    url: 'sikao'\n\t}, {\n\t    name: '骷髅',\n\t    url: 'kulou'\n\t}, {\n\t    name: '痛哭',\n\t    url: 'tongku'\n\t}, {\n\t    name: '恭喜',\n\t    url: 'gongxi'\n\t}, {\n\t    name: '捂脸',\n\t    url: 'wulian'\n\t}, {\n\t    name: '嘿哈',\n\t    url: 'heiha'\n\t}, {\n\t    name: '机智',\n\t    url: 'jizhi'\n\t}, {\n\t    name: '皱眉',\n\t    url: 'zhoumei'\n\t}, {\n\t    name: '安慰',\n\t    url: 'anwei'\n\t}, {\n\t    name: '飞吻',\n\t    url: 'feiwen'\n\t}, {\n\t    name: '奸笑',\n\t    url: 'jianxiao'\n\t}, {\n\t    name: '猪头',\n\t    url: 'zhutou'\n\t}, {\n\t    name: '玫瑰',\n\t    url: 'meigui'\n\t}, {\n\t    name: '凋谢',\n\t    url: 'diaoxie'\n\t}, {\n\t    name: '爱心',\n\t    url: 'aixin'\n\t}, {\n\t    name: '心碎',\n\t    url: 'xinsui'\n\t}, {\n\t    name: '蛋糕',\n\t    url: 'dangao'\n\t}, {\n\t    name: '喝水',\n\t    url: 'heshui'\n\t}];\n\t\n\tvar groupFour = [{\n\t    name: '西瓜',\n\t    url: 'xigua'\n\t}, {\n\t    name: '咖啡',\n\t    url: 'kafei'\n\t}, {\n\t    name: '啤酒',\n\t    url: 'pijiu'\n\t}, {\n\t    name: '包包',\n\t    url: 'baobao'\n\t}, {\n\t    name: '高跟鞋',\n\t    url: 'gaogenxie'\n\t}, {\n\t    name: '帽子',\n\t    url: 'maozi'\n\t}, {\n\t    name: '口红',\n\t    url: 'kouhong'\n\t}, {\n\t    name: '裙子',\n\t    url: 'qunzi'\n\t}, {\n\t    name: 'T恤',\n\t    url: 'txu'\n\t}, {\n\t    name: '裤子',\n\t    url: 'kuzi'\n\t}, {\n\t    name: '眼镜',\n\t    url: 'yanjing'\n\t}, {\n\t    name: '太阳镜',\n\t    url: 'taiyangjing'\n\t}, {\n\t    name: '蜡烛',\n\t    url: 'lazhu'\n\t}, {\n\t    name: '礼物',\n\t    url: 'liwu'\n\t}, {\n\t    name: '红包',\n\t    url: 'hongbao'\n\t}, {\n\t    name: '拥抱',\n\t    url: 'yongbao'\n\t}, {\n\t    name: '太阳',\n\t    url: 'taiyang'\n\t}, {\n\t    name: '月亮',\n\t    url: 'yueliang'\n\t}, {\n\t    name: '便便',\n\t    url: 'bianbian'\n\t}, {\n\t    name: '炸弹',\n\t    url: 'zhadan'\n\t}, {\n\t    name: '菜刀',\n\t    url: 'caidao'\n\t}, {\n\t    name: '握手',\n\t    url: 'woshou'\n\t}, {\n\t    name: '胜利',\n\t    url: 'shengli'\n\t}];\n\t\n\tvar groupFive = [{\n\t    name: '赞',\n\t    url: 'zan'\n\t}, {\n\t    name: 'OK',\n\t    url: 'ok'\n\t}, {\n\t    name: '勾引',\n\t    url: 'gouyin'\n\t}, {\n\t    name: 'NO',\n\t    url: 'no'\n\t}, {\n\t    name: '打脸',\n\t    url: 'dalian'\n\t}, {\n\t    name: '抱拳',\n\t    url: 'baoquan'\n\t}, {\n\t    name: '乒乓球',\n\t    url: 'pingpangqiu'\n\t}, {\n\t    name: '足球',\n\t    url: 'zuqiu'\n\t}, {\n\t    name: '篮球',\n\t    url: 'lanqiu'\n\t}];\n\t\n\tvar format = function format(arr) {\n\t    for (var i = 0, len = arr.length; i < len; i++) {\n\t        var emoji = arr[i];\n\t        emoji.url = imgPath + emoji.url + ext;\n\t    }\n\t    return arr;\n\t};\n\t\n\tmodule.exports = format(groupOne.concat(groupTwo, groupThree, groupFour, groupFive));\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 56 */,\n/* 57 */,\n/* 58 */,\n/* 59 */,\n/* 60 */,\n/* 61 */,\n/* 62 */,\n/* 63 */,\n/* 64 */,\n/* 65 */,\n/* 66 */,\n/* 67 */,\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */,\n/* 72 */,\n/* 73 */,\n/* 74 */,\n/* 75 */,\n/* 76 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\tvar path = $_CONFIG.imgpath + '/images/emoji/';\n\tvar ext = '.png';\n\t\n\tvar backward = {\n\t    '亲': {\n\t        name: '亲亲',\n\t        url: path + 'qinqin' + ext\n\t    },\n\t    '愤怒': {\n\t        name: '生气',\n\t        url: path + 'shengqi' + ext\n\t    },\n\t    '惊恐': {\n\t        name: '惊讶',\n\t        url: path + 'jingya' + ext\n\t    },\n\t    '迷茫': {\n\t        name: '委屈',\n\t        url: path + 'weiqu' + ext\n\t    },\n\t    '伤心': {\n\t        name: '难过',\n\t        url: path + 'nanguo' + ext\n\t    },\n\t    '努力': {\n\t        name: '奋斗',\n\t        url: path + 'fendou' + ext\n\t    },\n\t    'YY': {\n\t        name: ' 坏笑',\n\t        url: path + 'huaixiao' + ext\n\t    },\n\t    '恶心': {\n\t        name: '难受',\n\t        url: path + 'nanshou' + ext\n\t    }\n\t};\n\t\n\tmodule.exports = backward;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/face/face',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,face=$data.face,$index=$data.$index,$escape=$utils.$escape,page=$data.page,$out='';$out+='<div data-node=\"faceBox\" class=\"imoj-box\" style=\"position: absolute;z-index: 9999;display:none\"> <em class=\"sanjiao\"></em> <div data-node=\"faceList\" class=\"imoj-list\"> ';\n\t$each(list,function(v,i){\n\t$out+=' <div class=\"imoj-content clearfix ';\n\tif(i){\n\t$out+='hide';\n\t}\n\t$out+='\"> ';\n\t$each(v,function(face,$index){\n\t$out+=' <a href=\"javascript:;\"> <img width=\"22\" height=\"22\" data-face=\"[';\n\t$out+=$escape(face.name);\n\t$out+=']\" src=\"';\n\t$out+=$escape(face.url);\n\t$out+='\" alt=\"';\n\t$out+=$escape(face.name);\n\t$out+='\" title=\"';\n\t$out+=$escape(face.name);\n\t$out+='\"> </a> ';\n\t});\n\t$out+=' </div> ';\n\t});\n\t$out+=' </div> <ul data-action=\"facePage\" class=\"pagination\"> ';\n\t$each(page,function(v,i){\n\t$out+=' <li ';\n\tif(i==0){\n\t$out+='class=\"active\"';\n\t}\n\t$out+='>';\n\t$out+=$escape(i+1);\n\t$out+='</li> ';\n\t});\n\t$out+=' </ul> </div>';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 78 */,\n/* 79 */,\n/* 80 */,\n/* 81 */,\n/* 82 */,\n/* 83 */,\n/* 84 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\n\t * Created by dongyukuan on 2016/7/4.\n\t */\n\tvar inputTip = {\n\t    tel: {\n\t        ept: '请填写11位手机号',\n\t        err: '手机号格式错误',\n\t        errBack: '该手机号已被注册'\n\t    },\n\t    msgCode: {\n\t        tipGet: '请获取短信验证码',\n\t        tipEpt: '请输入短信验证码',\n\t        tipErr: '验证码是6位数字,请重新输入',\n\t        tipErrEdit: '验证码错误',\n\t        tipWrong: '验证码有误,请重新输入',\n\t        checkCodeWrong: '验证码输入错误,请重新输入',\n\t        send: '验证码已发送，请注意查收',\n\t        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n\t        tipDisabled: \"验证码再次获取需间隔60s\",\n\t        tipLimitEdit: '获取验证码超限，请稍后再试',\n\t        btnAfterSend: \"秒后重新获取\",\n\t        btnDefault: \"获取验证码\"\n\t    },\n\t    pwd: {\n\t        commonTip: '请输入6-20位英文字母,数字或符号'\n\t    },\n\t    pwdV: {\n\t        ept: '请再次输入密码',\n\t        err: '两次输入的密码不一致'\n\t    },\n\t    nickName: {\n\t        eptName: '请输入昵称！',\n\t        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n\t        existName: '此昵称太受欢迎了，已经有人抢了~',\n\t        sucSub: '资料修改成功！',\n\t        errLine: \"网络超时!\",\n\t        wrongName: '此昵称含有敏感词,请重新输入'\n\t    },\n\t    birthTip: {\n\t        tip: '生日不能重复设置'\n\t    },\n\t    refCode: {\n\t        err: '推荐码错误'\n\t    },\n\t    imgCode: {\n\t        ept: '请输入验证码',\n\t        err: '验证码输入错误，请重新输入'\n\t    },\n\t    login: {\n\t        errCode: '请输入验证码',\n\t        errNum: '请输入账号',\n\t        errPwd: '请输入密码',\n\t        agreement: '请同意协议并勾选'\n\t    },\n\t    createCircle: {\n\t        typeEmpty: '请选择圈子分类',\n\t        nameEmpty: '圈子名称不能为空',\n\t        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n\t    },\n\t    circle: {\n\t        login: '登录成功！',\n\t        unJoin: '需要先加入该圈子才能发布话题',\n\t        cannotJoin: '抱歉！该圈子不允许发布话题!',\n\t        review: '加入圈子审核中，请耐心等待!',\n\t        joinSuccess: '恭喜您已经加入圈子！',\n\t        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n\t        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n\t        exit: '您已经退出该圈子！',\n\t        dissolved: '抱歉！该圈子已被解散'\n\t    },\n\t    qrCodeTip: {\n\t        loseEffTip: '二维码已失效',\n\t        loseEffBtn: '点击刷新',\n\t        failGetTip: '二维码生成失败',\n\t        failGetBtn: '重新生成'\n\t    },\n\t    masterApply: {\n\t        nameLength: '姓名要2-20个字符',\n\t        nameType: '姓名仅限汉字和字母',\n\t        isIdCard: '请填写18位有效身份证号',\n\t        type: '请选择达人类别',\n\t        summary: '请输入自我介绍，2-100个字符'\n\t    },\n\t    upload: {\n\t        noUpload: '请上传图片',\n\t        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n\t        uploadFaild: '上传失败,请重新上传',\n\t        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n\t        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n\t        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n\t        Q_TYPE_DENIED: '文件类型错误',\n\t        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n\t        excess: '文件个数超出限制'\n\t    },\n\t    errLine: {\n\t        tip: '网络错误,请稍后再试！'\n\t    }\n\t};\n\tmodule.exports = inputTip;\n\n/***/ }),\n/* 85 */,\n/* 86 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* WEBPACK VAR INJECTION */(function(__webpack_provided_window_dot_jQuery) {/*! WebUploader 0.1.5 */\n\t\n\t\n\t/**\n\t * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n\t *\n\t * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n\t */\n\t(function( root, factory ) {\n\t    var modules = {},\n\t\n\t        // 内部require, 简单不完全实现。\n\t        // https://github.com/amdjs/amdjs-api/wiki/require\n\t        _require = function( deps, callback ) {\n\t            var args, len, i;\n\t\n\t            // 如果deps不是数组，则直接返回指定module\n\t            if ( typeof deps === 'string' ) {\n\t                return getModule( deps );\n\t            } else {\n\t                args = [];\n\t                for( len = deps.length, i = 0; i < len; i++ ) {\n\t                    args.push( getModule( deps[ i ] ) );\n\t                }\n\t\n\t                return callback.apply( null, args );\n\t            }\n\t        },\n\t\n\t        // 内部define，暂时不支持不指定id.\n\t        _define = function( id, deps, factory ) {\n\t            if ( arguments.length === 2 ) {\n\t                factory = deps;\n\t                deps = null;\n\t            }\n\t\n\t            _require( deps || [], function() {\n\t                setModule( id, factory, arguments );\n\t            });\n\t        },\n\t\n\t        // 设置module, 兼容CommonJs写法。\n\t        setModule = function( id, factory, args ) {\n\t            var module = {\n\t                    exports: factory\n\t                },\n\t                returned;\n\t\n\t            if ( typeof factory === 'function' ) {\n\t                args.length || (args = [ _require, module.exports, module ,__webpack_provided_window_dot_jQuery]);\n\t                returned = factory.apply( null, args );\n\t                returned !== undefined && (module.exports = returned);\n\t            }\n\t\n\t            modules[ id ] = module.exports;\n\t        },\n\t\n\t        // 根据id获取module\n\t        getModule = function( id ) {\n\t            var module = modules[ id ] || root[ id ];\n\t\n\t            if ( !module ) {\n\t                throw new Error( '`' + id + '` is undefined' );\n\t            }\n\t\n\t            return module;\n\t        },\n\t\n\t        // 将所有modules，将路径ids装换成对象。\n\t        exportsTo = function( obj ) {\n\t            var key, host, parts, part, last, ucFirst;\n\t\n\t            // make the first character upper case.\n\t            ucFirst = function( str ) {\n\t                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n\t            };\n\t\n\t            for ( key in modules ) {\n\t                host = obj;\n\t\n\t                if ( !modules.hasOwnProperty( key ) ) {\n\t                    continue;\n\t                }\n\t\n\t                parts = key.split('/');\n\t                last = ucFirst( parts.pop() );\n\t\n\t                while( (part = ucFirst( parts.shift() )) ) {\n\t                    host[ part ] = host[ part ] || {};\n\t                    host = host[ part ];\n\t                }\n\t\n\t                host[ last ] = modules[ key ];\n\t            }\n\t\n\t            return obj;\n\t        },\n\t\n\t        makeExport = function( dollar ) {\n\t            root.__dollar = dollar;\n\t\n\t            // exports every module.\n\t            return exportsTo( factory( root, _define, _require,__webpack_provided_window_dot_jQuery ) );\n\t        },\n\t\n\t        origin;\n\t\n\t    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\t\n\t        // For CommonJS and CommonJS-like environments where a proper window is present,\n\t        module.exports = makeExport();\n\t    } else if ( true ) {\n\t\n\t        // Allow using this built library as an AMD module\n\t        // in another project. That other project will only\n\t        // see this AMD call, not the internal modules in\n\t        // the closure below.\n\t        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(2) ], __WEBPACK_AMD_DEFINE_FACTORY__ = (makeExport), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t    } else {\n\t\n\t        // Browser globals case. Just assign the\n\t        // result to a property on the global.\n\t        origin = root.WebUploader;\n\t        root.WebUploader = makeExport();\n\t        root.WebUploader.noConflict = function() {\n\t            root.WebUploader = origin;\n\t        };\n\t    }\n\t})( window, function( window, define, require ,jQuery ) {\n\t\n\t\n\t    /**\n\t     * @fileOverview jQuery or Zepto\n\t     */\n\t    define('dollar-third',[],function() {\n\t        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n\t\n\t        if ( !$ ) {\n\t            throw new Error('jQuery or Zepto not found!');\n\t        }\n\t\n\t        return $;\n\t    });\n\t    /**\n\t     * @fileOverview Dom 操作相关\n\t     */\n\t    define('dollar',[\n\t        'dollar-third'\n\t    ], function( _ ) {\n\t        return _;\n\t    });\n\t    /**\n\t     * @fileOverview 使用jQuery的Promise\n\t     */\n\t    define('promise-third',[\n\t        'dollar'\n\t    ], function( $ ) {\n\t        return {\n\t            Deferred: $.Deferred,\n\t            when: $.when,\n\t\n\t            isPromise: function( anything ) {\n\t                return anything && typeof anything.then === 'function';\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * @fileOverview Promise/A+\n\t     */\n\t    define('promise',[\n\t        'promise-third'\n\t    ], function( _ ) {\n\t        return _;\n\t    });\n\t    /**\n\t     * @fileOverview 基础类方法。\n\t     */\n\t\n\t    /**\n\t     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n\t     *\n\t     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n\t     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n\t     *\n\t     * * module `base`：WebUploader.Base\n\t     * * module `file`: WebUploader.File\n\t     * * module `lib/dnd`: WebUploader.Lib.Dnd\n\t     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n\t     *\n\t     *\n\t     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n\t     * @module WebUploader\n\t     * @title WebUploader API文档\n\t     */\n\t    define('base',[\n\t        'dollar',\n\t        'promise'\n\t    ], function( $, promise ) {\n\t\n\t        var noop = function() {},\n\t            call = Function.call;\n\t\n\t        // http://jsperf.com/uncurrythis\n\t        // 反科里化\n\t        function uncurryThis( fn ) {\n\t            return function() {\n\t                return call.apply( fn, arguments );\n\t            };\n\t        }\n\t\n\t        function bindFn( fn, context ) {\n\t            return function() {\n\t                return fn.apply( context, arguments );\n\t            };\n\t        }\n\t\n\t        function createObject( proto ) {\n\t            var f;\n\t\n\t            if ( Object.create ) {\n\t                return Object.create( proto );\n\t            } else {\n\t                f = function() {};\n\t                f.prototype = proto;\n\t                return new f();\n\t            }\n\t        }\n\t\n\t\n\t        /**\n\t         * 基础类，提供一些简单常用的方法。\n\t         * @class Base\n\t         */\n\t        return {\n\t\n\t            /**\n\t             * @property {String} version 当前版本号。\n\t             */\n\t            version: '0.1.5',\n\t\n\t            /**\n\t             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n\t             */\n\t            $: $,\n\t\n\t            Deferred: promise.Deferred,\n\t\n\t            isPromise: promise.isPromise,\n\t\n\t            when: promise.when,\n\t\n\t            /**\n\t             * @description  简单的浏览器检查结果。\n\t             *\n\t             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n\t             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n\t             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n\t             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n\t             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n\t             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n\t             *\n\t             * @property {Object} [browser]\n\t             */\n\t            browser: (function( ua ) {\n\t                var ret = {},\n\t                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n\t                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n\t                        ua.match( /CriOS\\/([\\d.]+)/ ),\n\t\n\t                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n\t                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n\t                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n\t                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n\t                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n\t\n\t                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n\t                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n\t                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n\t                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n\t                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n\t                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n\t\n\t                return ret;\n\t            })( navigator.userAgent ),\n\t\n\t            /**\n\t             * @description  操作系统检查结果。\n\t             *\n\t             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n\t             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n\t             * @property {Object} [os]\n\t             */\n\t            os: (function( ua ) {\n\t                var ret = {},\n\t\n\t                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n\t                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n\t                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n\t\n\t                // osx && (ret.osx = true);\n\t                android && (ret.android = parseFloat( android[ 1 ] ));\n\t                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n\t\n\t                return ret;\n\t            })( navigator.userAgent ),\n\t\n\t            /**\n\t             * 实现类与类之间的继承。\n\t             * @method inherits\n\t             * @grammar Base.inherits( super ) => child\n\t             * @grammar Base.inherits( super, protos ) => child\n\t             * @grammar Base.inherits( super, protos, statics ) => child\n\t             * @param  {Class} super 父类\n\t             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n\t             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n\t             * @param  {Object} [statics] 静态属性或方法。\n\t             * @return {Class} 返回子类。\n\t             * @example\n\t             * function Person() {\n\t             *     console.log( 'Super' );\n\t             * }\n\t             * Person.prototype.hello = function() {\n\t             *     console.log( 'hello' );\n\t             * };\n\t             *\n\t             * var Manager = Base.inherits( Person, {\n\t             *     world: function() {\n\t             *         console.log( 'World' );\n\t             *     }\n\t             * });\n\t             *\n\t             * // 因为没有指定构造器，父类的构造器将会执行。\n\t             * var instance = new Manager();    // => Super\n\t             *\n\t             * // 继承子父类的方法\n\t             * instance.hello();    // => hello\n\t             * instance.world();    // => World\n\t             *\n\t             * // 子类的__super__属性指向父类\n\t             * console.log( Manager.__super__ === Person );    // => true\n\t             */\n\t            inherits: function( Super, protos, staticProtos ) {\n\t                var child;\n\t\n\t                if ( typeof protos === 'function' ) {\n\t                    child = protos;\n\t                    protos = null;\n\t                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n\t                    child = protos.constructor;\n\t                } else {\n\t                    child = function() {\n\t                        return Super.apply( this, arguments );\n\t                    };\n\t                }\n\t\n\t                // 复制静态方法\n\t                $.extend( true, child, Super, staticProtos || {} );\n\t\n\t                /* jshint camelcase: false */\n\t\n\t                // 让子类的__super__属性指向父类。\n\t                child.__super__ = Super.prototype;\n\t\n\t                // 构建原型，添加原型方法或属性。\n\t                // 暂时用Object.create实现。\n\t                child.prototype = createObject( Super.prototype );\n\t                protos && $.extend( true, child.prototype, protos );\n\t\n\t                return child;\n\t            },\n\t\n\t            /**\n\t             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n\t             * @method noop\n\t             */\n\t            noop: noop,\n\t\n\t            /**\n\t             * 返回一个新的方法，此方法将已指定的`context`来执行。\n\t             * @grammar Base.bindFn( fn, context ) => Function\n\t             * @method bindFn\n\t             * @example\n\t             * var doSomething = function() {\n\t             *         console.log( this.name );\n\t             *     },\n\t             *     obj = {\n\t             *         name: 'Object Name'\n\t             *     },\n\t             *     aliasFn = Base.bind( doSomething, obj );\n\t             *\n\t             *  aliasFn();    // => Object Name\n\t             *\n\t             */\n\t            bindFn: bindFn,\n\t\n\t            /**\n\t             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n\t             * @grammar Base.log( args... ) => undefined\n\t             * @method log\n\t             */\n\t            log: (function() {\n\t                if ( window.console ) {\n\t                    return bindFn( console.log, console );\n\t                }\n\t                return noop;\n\t            })(),\n\t\n\t            nextTick: (function() {\n\t\n\t                return function( cb ) {\n\t                    setTimeout( cb, 1 );\n\t                };\n\t\n\t                // @bug 当浏览器不在当前窗口时就停了。\n\t                // var next = window.requestAnimationFrame ||\n\t                //     window.webkitRequestAnimationFrame ||\n\t                //     window.mozRequestAnimationFrame ||\n\t                //     function( cb ) {\n\t                //         window.setTimeout( cb, 1000 / 60 );\n\t                //     };\n\t\n\t                // // fix: Uncaught TypeError: Illegal invocation\n\t                // return bindFn( next, window );\n\t            })(),\n\t\n\t            /**\n\t             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n\t             * 将用来将非数组对象转化成数组对象。\n\t             * @grammar Base.slice( target, start[, end] ) => Array\n\t             * @method slice\n\t             * @example\n\t             * function doSomthing() {\n\t             *     var args = Base.slice( arguments, 1 );\n\t             *     console.log( args );\n\t             * }\n\t             *\n\t             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n\t             */\n\t            slice: uncurryThis( [].slice ),\n\t\n\t            /**\n\t             * 生成唯一的ID\n\t             * @method guid\n\t             * @grammar Base.guid() => String\n\t             * @grammar Base.guid( prefx ) => String\n\t             */\n\t            guid: (function() {\n\t                var counter = 0;\n\t\n\t                return function( prefix ) {\n\t                    var guid = (+new Date()).toString( 32 ),\n\t                        i = 0;\n\t\n\t                    for ( ; i < 5; i++ ) {\n\t                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n\t                    }\n\t\n\t                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n\t                };\n\t            })(),\n\t\n\t            /**\n\t             * 格式化文件大小, 输出成带单位的字符串\n\t             * @method formatSize\n\t             * @grammar Base.formatSize( size ) => String\n\t             * @grammar Base.formatSize( size, pointLength ) => String\n\t             * @grammar Base.formatSize( size, pointLength, units ) => String\n\t             * @param {Number} size 文件大小\n\t             * @param {Number} [pointLength=2] 精确到的小数点数。\n\t             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n\t             * @example\n\t             * console.log( Base.formatSize( 100 ) );    // => 100B\n\t             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n\t             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n\t             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n\t             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n\t             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n\t             */\n\t            formatSize: function( size, pointLength, units ) {\n\t                var unit;\n\t\n\t                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n\t\n\t                while ( (unit = units.shift()) && size > 1024 ) {\n\t                    size = size / 1024;\n\t                }\n\t\n\t                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n\t                        unit;\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n\t     * @fileOverview Mediator\n\t     */\n\t    define('mediator',[\n\t        'base'\n\t    ], function( Base ) {\n\t        var $ = Base.$,\n\t            slice = [].slice,\n\t            separator = /\\s+/,\n\t            protos;\n\t\n\t        // 根据条件过滤出事件handlers.\n\t        function findHandlers( arr, name, callback, context ) {\n\t            return $.grep( arr, function( handler ) {\n\t                return handler &&\n\t                        (!name || handler.e === name) &&\n\t                        (!callback || handler.cb === callback ||\n\t                        handler.cb._cb === callback) &&\n\t                        (!context || handler.ctx === context);\n\t            });\n\t        }\n\t\n\t        function eachEvent( events, callback, iterator ) {\n\t            // 不支持对象，只支持多个event用空格隔开\n\t            $.each( (events || '').split( separator ), function( _, key ) {\n\t                iterator( key, callback );\n\t            });\n\t        }\n\t\n\t        function triggerHanders( events, args ) {\n\t            var stoped = false,\n\t                i = -1,\n\t                len = events.length,\n\t                handler;\n\t\n\t            while ( ++i < len ) {\n\t                handler = events[ i ];\n\t\n\t                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n\t                    stoped = true;\n\t                    break;\n\t                }\n\t            }\n\t\n\t            return !stoped;\n\t        }\n\t\n\t        protos = {\n\t\n\t            /**\n\t             * 绑定事件。\n\t             *\n\t             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n\t             * ```javascript\n\t             * var obj = {};\n\t             *\n\t             * // 使得obj有事件行为\n\t             * Mediator.installTo( obj );\n\t             *\n\t             * obj.on( 'testa', function( arg1, arg2 ) {\n\t             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n\t             * });\n\t             *\n\t             * obj.trigger( 'testa', 'arg1', 'arg2' );\n\t             * ```\n\t             *\n\t             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n\t             * 切会影响到`trigger`方法的返回值，为`false`。\n\t             *\n\t             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n\t             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n\t             * ```javascript\n\t             * obj.on( 'all', function( type, arg1, arg2 ) {\n\t             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n\t             * });\n\t             * ```\n\t             *\n\t             * @method on\n\t             * @grammar on( name, callback[, context] ) => self\n\t             * @param  {String}   name     事件名，支持多个事件用空格隔开\n\t             * @param  {Function} callback 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             * @class Mediator\n\t             */\n\t            on: function( name, callback, context ) {\n\t                var me = this,\n\t                    set;\n\t\n\t                if ( !callback ) {\n\t                    return this;\n\t                }\n\t\n\t                set = this._events || (this._events = []);\n\t\n\t                eachEvent( name, callback, function( name, callback ) {\n\t                    var handler = { e: name };\n\t\n\t                    handler.cb = callback;\n\t                    handler.ctx = context;\n\t                    handler.ctx2 = context || me;\n\t                    handler.id = set.length;\n\t\n\t                    set.push( handler );\n\t                });\n\t\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 绑定事件，且当handler执行完后，自动解除绑定。\n\t             * @method once\n\t             * @grammar once( name, callback[, context] ) => self\n\t             * @param  {String}   name     事件名\n\t             * @param  {Function} callback 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             */\n\t            once: function( name, callback, context ) {\n\t                var me = this;\n\t\n\t                if ( !callback ) {\n\t                    return me;\n\t                }\n\t\n\t                eachEvent( name, callback, function( name, callback ) {\n\t                    var once = function() {\n\t                            me.off( name, once );\n\t                            return callback.apply( context || me, arguments );\n\t                        };\n\t\n\t                    once._cb = callback;\n\t                    me.on( name, once, context );\n\t                });\n\t\n\t                return me;\n\t            },\n\t\n\t            /**\n\t             * 解除事件绑定\n\t             * @method off\n\t             * @grammar off( [name[, callback[, context] ] ] ) => self\n\t             * @param  {String}   [name]     事件名\n\t             * @param  {Function} [callback] 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             */\n\t            off: function( name, cb, ctx ) {\n\t                var events = this._events;\n\t\n\t                if ( !events ) {\n\t                    return this;\n\t                }\n\t\n\t                if ( !name && !cb && !ctx ) {\n\t                    this._events = [];\n\t                    return this;\n\t                }\n\t\n\t                eachEvent( name, cb, function( name, cb ) {\n\t                    $.each( findHandlers( events, name, cb, ctx ), function() {\n\t                        delete events[ this.id ];\n\t                    });\n\t                });\n\t\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 触发事件\n\t             * @method trigger\n\t             * @grammar trigger( name[, args...] ) => self\n\t             * @param  {String}   type     事件名\n\t             * @param  {*} [...] 任意参数\n\t             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n\t             */\n\t            trigger: function( type ) {\n\t                var args, events, allEvents;\n\t\n\t                if ( !this._events || !type ) {\n\t                    return this;\n\t                }\n\t\n\t                args = slice.call( arguments, 1 );\n\t                events = findHandlers( this._events, type );\n\t                allEvents = findHandlers( this._events, 'all' );\n\t\n\t                return triggerHanders( events, args ) &&\n\t                        triggerHanders( allEvents, arguments );\n\t            }\n\t        };\n\t\n\t        /**\n\t         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n\t         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n\t         *\n\t         * @class Mediator\n\t         */\n\t        return $.extend({\n\t\n\t            /**\n\t             * 可以通过这个接口，使任何对象具备事件功能。\n\t             * @method installTo\n\t             * @param  {Object} obj 需要具备事件行为的对象。\n\t             * @return {Object} 返回obj.\n\t             */\n\t            installTo: function( obj ) {\n\t                return $.extend( obj, protos );\n\t            }\n\t\n\t        }, protos );\n\t    });\n\t    /**\n\t     * @fileOverview Uploader上传类\n\t     */\n\t    define('uploader',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        /**\n\t         * 上传入口类。\n\t         * @class Uploader\n\t         * @constructor\n\t         * @grammar new Uploader( opts ) => Uploader\n\t         * @example\n\t         * var uploader = WebUploader.Uploader({\n\t         *     swf: 'path_of_swf/Uploader.swf',\n\t         *\n\t         *     // 开起分片上传。\n\t         *     chunked: true\n\t         * });\n\t         */\n\t        function Uploader( opts ) {\n\t            this.options = $.extend( true, {}, Uploader.options, opts );\n\t            this._init( this.options );\n\t        }\n\t\n\t        // default Options\n\t        // widgets中有相应扩展\n\t        Uploader.options = {};\n\t        Mediator.installTo( Uploader.prototype );\n\t\n\t        // 批量添加纯命令式方法。\n\t        $.each({\n\t            upload: 'start-upload',\n\t            stop: 'stop-upload',\n\t            getFile: 'get-file',\n\t            getFiles: 'get-files',\n\t            addFile: 'add-file',\n\t            addFiles: 'add-file',\n\t            sort: 'sort-files',\n\t            removeFile: 'remove-file',\n\t            cancelFile: 'cancel-file',\n\t            skipFile: 'skip-file',\n\t            retry: 'retry',\n\t            isInProgress: 'is-in-progress',\n\t            makeThumb: 'make-thumb',\n\t            md5File: 'md5-file',\n\t            getDimension: 'get-dimension',\n\t            addButton: 'add-btn',\n\t            predictRuntimeType: 'predict-runtime-type',\n\t            refresh: 'refresh',\n\t            disable: 'disable',\n\t            enable: 'enable',\n\t            reset: 'reset'\n\t        }, function( fn, command ) {\n\t            Uploader.prototype[ fn ] = function() {\n\t                return this.request( command, arguments );\n\t            };\n\t        });\n\t\n\t        $.extend( Uploader.prototype, {\n\t            state: 'pending',\n\t\n\t            _init: function( opts ) {\n\t                var me = this;\n\t\n\t                me.request( 'init', opts, function() {\n\t                    me.state = 'ready';\n\t                    me.trigger('ready');\n\t                });\n\t            },\n\t\n\t            /**\n\t             * 获取或者设置Uploader配置项。\n\t             * @method option\n\t             * @grammar option( key ) => *\n\t             * @grammar option( key, val ) => self\n\t             * @example\n\t             *\n\t             * // 初始状态图片上传前不会压缩\n\t             * var uploader = new WebUploader.Uploader({\n\t             *     compress: null;\n\t             * });\n\t             *\n\t             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n\t             * uploader.option( 'compress', {\n\t             *     width: 1600,\n\t             *     height: 1600\n\t             * });\n\t             */\n\t            option: function( key, val ) {\n\t                var opts = this.options;\n\t\n\t                // setter\n\t                if ( arguments.length > 1 ) {\n\t\n\t                    if ( $.isPlainObject( val ) &&\n\t                            $.isPlainObject( opts[ key ] ) ) {\n\t                        $.extend( opts[ key ], val );\n\t                    } else {\n\t                        opts[ key ] = val;\n\t                    }\n\t\n\t                } else {    // getter\n\t                    return key ? opts[ key ] : opts;\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 获取文件统计信息。返回一个包含一下信息的对象。\n\t             * * `successNum` 上传成功的文件数\n\t             * * `progressNum` 上传中的文件数\n\t             * * `cancelNum` 被删除的文件数\n\t             * * `invalidNum` 无效的文件数\n\t             * * `uploadFailNum` 上传失败的文件数\n\t             * * `queueNum` 还在队列中的文件数\n\t             * * `interruptNum` 被暂停的文件数\n\t             * @method getStats\n\t             * @grammar getStats() => Object\n\t             */\n\t            getStats: function() {\n\t                // return this._mgr.getStats.apply( this._mgr, arguments );\n\t                var stats = this.request('get-stats');\n\t\n\t                return stats ? {\n\t                    successNum: stats.numOfSuccess,\n\t                    progressNum: stats.numOfProgress,\n\t\n\t                    // who care?\n\t                    // queueFailNum: 0,\n\t                    cancelNum: stats.numOfCancel,\n\t                    invalidNum: stats.numOfInvalid,\n\t                    uploadFailNum: stats.numOfUploadFailed,\n\t                    queueNum: stats.numOfQueue,\n\t                    interruptNum: stats.numofInterrupt\n\t                } : {};\n\t            },\n\t\n\t            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n\t            trigger: function( type/*, args...*/ ) {\n\t                var args = [].slice.call( arguments, 1 ),\n\t                    opts = this.options,\n\t                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n\t                        type.substring( 1 );\n\t\n\t                if (\n\t                        // 调用通过on方法注册的handler.\n\t                        Mediator.trigger.apply( this, arguments ) === false ||\n\t\n\t                        // 调用opts.onEvent\n\t                        $.isFunction( opts[ name ] ) &&\n\t                        opts[ name ].apply( this, args ) === false ||\n\t\n\t                        // 调用this.onEvent\n\t                        $.isFunction( this[ name ] ) &&\n\t                        this[ name ].apply( this, args ) === false ||\n\t\n\t                        // 广播所有uploader的事件。\n\t                        Mediator.trigger.apply( Mediator,\n\t                        [ this, type ].concat( args ) ) === false ) {\n\t\n\t                    return false;\n\t                }\n\t\n\t                return true;\n\t            },\n\t\n\t            /**\n\t             * 销毁 webuploader 实例\n\t             * @method destroy\n\t             * @grammar destroy() => undefined\n\t             */\n\t            destroy: function() {\n\t                this.request( 'destroy', arguments );\n\t                this.off();\n\t            },\n\t\n\t            // widgets/widget.js将补充此方法的详细文档。\n\t            request: Base.noop\n\t        });\n\t\n\t        /**\n\t         * 创建Uploader实例，等同于new Uploader( opts );\n\t         * @method create\n\t         * @class Base\n\t         * @static\n\t         * @grammar Base.create( opts ) => Uploader\n\t         */\n\t        Base.create = Uploader.create = function( opts ) {\n\t            return new Uploader( opts );\n\t        };\n\t\n\t        // 暴露Uploader，可以通过它来扩展业务逻辑。\n\t        Base.Uploader = Uploader;\n\t\n\t        return Uploader;\n\t    });\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/runtime',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$,\n\t            factories = {},\n\t\n\t            // 获取对象的第一个key\n\t            getFirstKey = function( obj ) {\n\t                for ( var key in obj ) {\n\t                    if ( obj.hasOwnProperty( key ) ) {\n\t                        return key;\n\t                    }\n\t                }\n\t                return null;\n\t            };\n\t\n\t        // 接口类。\n\t        function Runtime( options ) {\n\t            this.options = $.extend({\n\t                container: document.body\n\t            }, options );\n\t            this.uid = Base.guid('rt_');\n\t        }\n\t\n\t        $.extend( Runtime.prototype, {\n\t\n\t            getContainer: function() {\n\t                var opts = this.options,\n\t                    parent, container;\n\t\n\t                if ( this._container ) {\n\t                    return this._container;\n\t                }\n\t\n\t                parent = $( opts.container || document.body );\n\t                container = $( document.createElement('div') );\n\t\n\t                container.attr( 'id', 'rt_' + this.uid );\n\t                container.css({\n\t                    position: 'absolute',\n\t                    top: '0px',\n\t                    left: '0px',\n\t                    width: '1px',\n\t                    height: '1px',\n\t                    overflow: 'hidden'\n\t                });\n\t\n\t                parent.append( container );\n\t                parent.addClass('webuploader-container');\n\t                this._container = container;\n\t                this._parent = parent;\n\t                return container;\n\t            },\n\t\n\t            init: Base.noop,\n\t            exec: Base.noop,\n\t\n\t            destroy: function() {\n\t                this._container && this._container.remove();\n\t                this._parent && this._parent.removeClass('webuploader-container');\n\t                this.off();\n\t            }\n\t        });\n\t\n\t        Runtime.orders = 'html5,flash';\n\t\n\t\n\t        /**\n\t         * 添加Runtime实现。\n\t         * @param {String} type    类型\n\t         * @param {Runtime} factory 具体Runtime实现。\n\t         */\n\t        Runtime.addRuntime = function( type, factory ) {\n\t            factories[ type ] = factory;\n\t        };\n\t\n\t        Runtime.hasRuntime = function( type ) {\n\t            return !!(type ? factories[ type ] : getFirstKey( factories ));\n\t        };\n\t\n\t        Runtime.create = function( opts, orders ) {\n\t            var type, runtime;\n\t\n\t            orders = orders || Runtime.orders;\n\t            $.each( orders.split( /\\s*,\\s*/g ), function() {\n\t                if ( factories[ this ] ) {\n\t                    type = this;\n\t                    return false;\n\t                }\n\t            });\n\t\n\t            type = type || getFirstKey( factories );\n\t            if ( !type ) {\n\t                throw new Error('Runtime Error');\n\t            }\n\t\n\t            runtime = new factories[ type ]( opts );\n\t            return runtime;\n\t        };\n\t\n\t        Mediator.installTo( Runtime.prototype );\n\t        return Runtime;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/client',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/runtime'\n\t    ], function( Base, Mediator, Runtime ) {\n\t\n\t        var cache;\n\t\n\t        cache = (function() {\n\t            var obj = {};\n\t\n\t            return {\n\t                add: function( runtime ) {\n\t                    obj[ runtime.uid ] = runtime;\n\t                },\n\t\n\t                get: function( ruid, standalone ) {\n\t                    var i;\n\t\n\t                    if ( ruid ) {\n\t                        return obj[ ruid ];\n\t                    }\n\t\n\t                    for ( i in obj ) {\n\t                        // 有些类型不能重用，比如filepicker.\n\t                        if ( standalone && obj[ i ].__standalone ) {\n\t                            continue;\n\t                        }\n\t\n\t                        return obj[ i ];\n\t                    }\n\t\n\t                    return null;\n\t                },\n\t\n\t                remove: function( runtime ) {\n\t                    delete obj[ runtime.uid ];\n\t                }\n\t            };\n\t        })();\n\t\n\t        function RuntimeClient( component, standalone ) {\n\t            var deferred = Base.Deferred(),\n\t                runtime;\n\t\n\t            this.uid = Base.guid('client_');\n\t\n\t            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n\t            this.runtimeReady = function( cb ) {\n\t                return deferred.done( cb );\n\t            };\n\t\n\t            this.connectRuntime = function( opts, cb ) {\n\t\n\t                // already connected.\n\t                if ( runtime ) {\n\t                    throw new Error('already connected!');\n\t                }\n\t\n\t                deferred.done( cb );\n\t\n\t                if ( typeof opts === 'string' && cache.get( opts ) ) {\n\t                    runtime = cache.get( opts );\n\t                }\n\t\n\t                // 像filePicker只能独立存在，不能公用。\n\t                runtime = runtime || cache.get( null, standalone );\n\t\n\t                // 需要创建\n\t                if ( !runtime ) {\n\t                    runtime = Runtime.create( opts, opts.runtimeOrder );\n\t                    runtime.__promise = deferred.promise();\n\t                    runtime.once( 'ready', deferred.resolve );\n\t                    runtime.init();\n\t                    cache.add( runtime );\n\t                    runtime.__client = 1;\n\t                } else {\n\t                    // 来自cache\n\t                    Base.$.extend( runtime.options, opts );\n\t                    runtime.__promise.then( deferred.resolve );\n\t                    runtime.__client++;\n\t                }\n\t\n\t                standalone && (runtime.__standalone = standalone);\n\t                return runtime;\n\t            };\n\t\n\t            this.getRuntime = function() {\n\t                return runtime;\n\t            };\n\t\n\t            this.disconnectRuntime = function() {\n\t                if ( !runtime ) {\n\t                    return;\n\t                }\n\t\n\t                runtime.__client--;\n\t\n\t                if ( runtime.__client <= 0 ) {\n\t                    cache.remove( runtime );\n\t                    delete runtime.__promise;\n\t                    runtime.destroy();\n\t                }\n\t\n\t                runtime = null;\n\t            };\n\t\n\t            this.exec = function() {\n\t                if ( !runtime ) {\n\t                    return;\n\t                }\n\t\n\t                var args = Base.slice( arguments );\n\t                component && args.unshift( component );\n\t\n\t                return runtime.exec.apply( this, args );\n\t            };\n\t\n\t            this.getRuid = function() {\n\t                return runtime && runtime.uid;\n\t            };\n\t\n\t            this.destroy = (function( destroy ) {\n\t                return function() {\n\t                    destroy && destroy.apply( this, arguments );\n\t                    this.trigger('destroy');\n\t                    this.off();\n\t                    this.exec('destroy');\n\t                    this.disconnectRuntime();\n\t                };\n\t            })( this.destroy );\n\t        }\n\t\n\t        Mediator.installTo( RuntimeClient.prototype );\n\t        return RuntimeClient;\n\t    });\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/dnd',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/client'\n\t    ], function( Base, Mediator, RuntimeClent ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function DragAndDrop( opts ) {\n\t            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n\t\n\t            opts.container = $( opts.container );\n\t\n\t            if ( !opts.container.length ) {\n\t                return;\n\t            }\n\t\n\t            RuntimeClent.call( this, 'DragAndDrop' );\n\t        }\n\t\n\t        DragAndDrop.options = {\n\t            accept: null,\n\t            disableGlobalDnd: false\n\t        };\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: DragAndDrop,\n\t\n\t            init: function() {\n\t                var me = this;\n\t\n\t                me.connectRuntime( me.options, function() {\n\t                    me.exec('init');\n\t                    me.trigger('ready');\n\t                });\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( DragAndDrop.prototype );\n\t\n\t        return DragAndDrop;\n\t    });\n\t    /**\n\t     * @fileOverview 组件基类。\n\t     */\n\t    define('widgets/widget',[\n\t        'base',\n\t        'uploader'\n\t    ], function( Base, Uploader ) {\n\t\n\t        var $ = Base.$,\n\t            _init = Uploader.prototype._init,\n\t            _destroy = Uploader.prototype.destroy,\n\t            IGNORE = {},\n\t            widgetClass = [];\n\t\n\t        function isArrayLike( obj ) {\n\t            if ( !obj ) {\n\t                return false;\n\t            }\n\t\n\t            var length = obj.length,\n\t                type = $.type( obj );\n\t\n\t            if ( obj.nodeType === 1 && length ) {\n\t                return true;\n\t            }\n\t\n\t            return type === 'array' || type !== 'function' && type !== 'string' &&\n\t                    (length === 0 || typeof length === 'number' && length > 0 &&\n\t                    (length - 1) in obj);\n\t        }\n\t\n\t        function Widget( uploader ) {\n\t            this.owner = uploader;\n\t            this.options = uploader.options;\n\t        }\n\t\n\t        $.extend( Widget.prototype, {\n\t\n\t            init: Base.noop,\n\t\n\t            // 类Backbone的事件监听声明，监听uploader实例上的事件\n\t            // widget直接无法监听事件，事件只能通过uploader来传递\n\t            invoke: function( apiName, args ) {\n\t\n\t                /*\n\t                    {\n\t                        'make-thumb': 'makeThumb'\n\t                    }\n\t                 */\n\t                var map = this.responseMap;\n\t\n\t                // 如果无API响应声明则忽略\n\t                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n\t                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n\t\n\t                    return IGNORE;\n\t                }\n\t\n\t                return this[ map[ apiName ] ].apply( this, args );\n\t\n\t            },\n\t\n\t            /**\n\t             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n\t             * @method request\n\t             * @grammar request( command, args ) => * | Promise\n\t             * @grammar request( command, args, callback ) => Promise\n\t             * @for  Uploader\n\t             */\n\t            request: function() {\n\t                return this.owner.request.apply( this.owner, arguments );\n\t            }\n\t        });\n\t\n\t        // 扩展Uploader.\n\t        $.extend( Uploader.prototype, {\n\t\n\t            /**\n\t             * @property {String | Array} [disableWidgets=undefined]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n\t             */\n\t\n\t            // 覆写_init用来初始化widgets\n\t            _init: function() {\n\t                var me = this,\n\t                    widgets = me._widgets = [],\n\t                    deactives = me.options.disableWidgets || '';\n\t\n\t                $.each( widgetClass, function( _, klass ) {\n\t                    (!deactives || !~deactives.indexOf( klass._name )) &&\n\t                        widgets.push( new klass( me ) );\n\t                });\n\t\n\t                return _init.apply( me, arguments );\n\t            },\n\t\n\t            request: function( apiName, args, callback ) {\n\t                var i = 0,\n\t                    widgets = this._widgets,\n\t                    len = widgets && widgets.length,\n\t                    rlts = [],\n\t                    dfds = [],\n\t                    widget, rlt, promise, key;\n\t\n\t                args = isArrayLike( args ) ? args : [ args ];\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    widget = widgets[ i ];\n\t                    rlt = widget.invoke( apiName, args );\n\t\n\t                    if ( rlt !== IGNORE ) {\n\t\n\t                        // Deferred对象\n\t                        if ( Base.isPromise( rlt ) ) {\n\t                            dfds.push( rlt );\n\t                        } else {\n\t                            rlts.push( rlt );\n\t                        }\n\t                    }\n\t                }\n\t\n\t                // 如果有callback，则用异步方式。\n\t                if ( callback || dfds.length ) {\n\t                    promise = Base.when.apply( Base, dfds );\n\t                    key = promise.pipe ? 'pipe' : 'then';\n\t\n\t                    // 很重要不能删除。删除了会死循环。\n\t                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n\t                    return promise[ key ](function() {\n\t                                var deferred = Base.Deferred(),\n\t                                    args = arguments;\n\t\n\t                                if ( args.length === 1 ) {\n\t                                    args = args[ 0 ];\n\t                                }\n\t\n\t                                setTimeout(function() {\n\t                                    deferred.resolve( args );\n\t                                }, 1 );\n\t\n\t                                return deferred.promise();\n\t                            })[ callback ? key : 'done' ]( callback || Base.noop );\n\t                } else {\n\t                    return rlts[ 0 ];\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                _destroy.apply( this, arguments );\n\t                this._widgets = null;\n\t            }\n\t        });\n\t\n\t        /**\n\t         * 添加组件\n\t         * @grammar Uploader.register(proto);\n\t         * @grammar Uploader.register(map, proto);\n\t         * @param  {object} responseMap API 名称与函数实现的映射\n\t         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n\t         * @method Uploader.register\n\t         * @for Uploader\n\t         * @example\n\t         * Uploader.register({\n\t         *     'make-thumb': 'makeThumb'\n\t         * }, {\n\t         *     init: function( options ) {},\n\t         *     makeThumb: function() {}\n\t         * });\n\t         *\n\t         * Uploader.register({\n\t         *     'make-thumb': function() {\n\t         *\n\t         *     }\n\t         * });\n\t         */\n\t        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n\t            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n\t                klass;\n\t\n\t            if ( arguments.length === 1 ) {\n\t                widgetProto = responseMap;\n\t\n\t                // 自动生成 map 表。\n\t                $.each(widgetProto, function(key) {\n\t                    if ( key[0] === '_' || key === 'name' ) {\n\t                        key === 'name' && (map.name = widgetProto.name);\n\t                        return;\n\t                    }\n\t\n\t                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n\t                });\n\t\n\t            } else {\n\t                map = $.extend( map, responseMap );\n\t            }\n\t\n\t            widgetProto.responseMap = map;\n\t            klass = Base.inherits( Widget, widgetProto );\n\t            klass._name = map.name;\n\t            widgetClass.push( klass );\n\t\n\t            return klass;\n\t        };\n\t\n\t        /**\n\t         * 删除插件，只有在注册时指定了名字的才能被删除。\n\t         * @grammar Uploader.unRegister(name);\n\t         * @param  {string} name 组件名字\n\t         * @method Uploader.unRegister\n\t         * @for Uploader\n\t         * @example\n\t         *\n\t         * Uploader.register({\n\t         *     name: 'custom',\n\t         *\n\t         *     'make-thumb': function() {\n\t         *\n\t         *     }\n\t         * });\n\t         *\n\t         * Uploader.unRegister('custom');\n\t         */\n\t        Uploader.unRegister = Widget.unRegister = function( name ) {\n\t            if ( !name || name === 'anonymous' ) {\n\t                return;\n\t            }\n\t\n\t            // 删除指定的插件。\n\t            for ( var i = widgetClass.length; i--; ) {\n\t                if ( widgetClass[i]._name === name ) {\n\t                    widgetClass.splice(i, 1)\n\t                }\n\t            }\n\t        };\n\t\n\t        return Widget;\n\t    });\n\t    /**\n\t     * @fileOverview DragAndDrop Widget。\n\t     */\n\t    define('widgets/filednd',[\n\t        'base',\n\t        'uploader',\n\t        'lib/dnd',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Dnd ) {\n\t        var $ = Base.$;\n\t\n\t        Uploader.options.dnd = '';\n\t\n\t        /**\n\t         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t\n\t        /**\n\t         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t\n\t        /**\n\t         * @event dndAccept\n\t         * @param {DataTransferItemList} items DataTransferItem\n\t         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n\t         * @for  Uploader\n\t         */\n\t        return Uploader.register({\n\t            name: 'dnd',\n\t\n\t            init: function( opts ) {\n\t\n\t                if ( !opts.dnd ||\n\t                        this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                var me = this,\n\t                    deferred = Base.Deferred(),\n\t                    options = $.extend({}, {\n\t                        disableGlobalDnd: opts.disableGlobalDnd,\n\t                        container: opts.dnd,\n\t                        accept: opts.accept\n\t                    }),\n\t                    dnd;\n\t\n\t                this.dnd = dnd = new Dnd( options );\n\t\n\t                dnd.once( 'ready', deferred.resolve );\n\t                dnd.on( 'drop', function( files ) {\n\t                    me.request( 'add-file', [ files ]);\n\t                });\n\t\n\t                // 检测文件是否全部允许添加。\n\t                dnd.on( 'accept', function( items ) {\n\t                    return me.owner.trigger( 'dndAccept', items );\n\t                });\n\t\n\t                dnd.init();\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                this.dnd && this.dnd.destroy();\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/filepaste',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/client'\n\t    ], function( Base, Mediator, RuntimeClent ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function FilePaste( opts ) {\n\t            opts = this.options = $.extend({}, opts );\n\t            opts.container = $( opts.container || document.body );\n\t            RuntimeClent.call( this, 'FilePaste' );\n\t        }\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: FilePaste,\n\t\n\t            init: function() {\n\t                var me = this;\n\t\n\t                me.connectRuntime( me.options, function() {\n\t                    me.exec('init');\n\t                    me.trigger('ready');\n\t                });\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( FilePaste.prototype );\n\t\n\t        return FilePaste;\n\t    });\n\t    /**\n\t     * @fileOverview 组件基类。\n\t     */\n\t    define('widgets/filepaste',[\n\t        'base',\n\t        'uploader',\n\t        'lib/filepaste',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, FilePaste ) {\n\t        var $ = Base.$;\n\t\n\t        /**\n\t         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t        return Uploader.register({\n\t            name: 'paste',\n\t\n\t            init: function( opts ) {\n\t\n\t                if ( !opts.paste ||\n\t                        this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                var me = this,\n\t                    deferred = Base.Deferred(),\n\t                    options = $.extend({}, {\n\t                        container: opts.paste,\n\t                        accept: opts.accept\n\t                    }),\n\t                    paste;\n\t\n\t                this.paste = paste = new FilePaste( options );\n\t\n\t                paste.once( 'ready', deferred.resolve );\n\t                paste.on( 'paste', function( files ) {\n\t                    me.owner.request( 'add-file', [ files ]);\n\t                });\n\t                paste.init();\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                this.paste && this.paste.destroy();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Blob\n\t     */\n\t    define('lib/blob',[\n\t        'base',\n\t        'runtime/client'\n\t    ], function( Base, RuntimeClient ) {\n\t\n\t        function Blob( ruid, source ) {\n\t            var me = this;\n\t\n\t            me.source = source;\n\t            me.ruid = ruid;\n\t            this.size = source.size || 0;\n\t\n\t            // 如果没有指定 mimetype, 但是知道文件后缀。\n\t            if ( !source.type && this.ext &&\n\t                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n\t                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n\t            } else {\n\t                this.type = source.type || 'application/octet-stream';\n\t            }\n\t\n\t            RuntimeClient.call( me, 'Blob' );\n\t            this.uid = source.uid || this.uid;\n\t\n\t            if ( ruid ) {\n\t                me.connectRuntime( ruid );\n\t            }\n\t        }\n\t\n\t        Base.inherits( RuntimeClient, {\n\t            constructor: Blob,\n\t\n\t            slice: function( start, end ) {\n\t                return this.exec( 'slice', start, end );\n\t            },\n\t\n\t            getSource: function() {\n\t                return this.source;\n\t            }\n\t        });\n\t\n\t        return Blob;\n\t    });\n\t    /**\n\t     * 为了统一化Flash的File和HTML5的File而存在。\n\t     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n\t     * @fileOverview File\n\t     */\n\t    define('lib/file',[\n\t        'base',\n\t        'lib/blob'\n\t    ], function( Base, Blob ) {\n\t\n\t        var uid = 1,\n\t            rExt = /\\.([^.]+)$/;\n\t\n\t        function File( ruid, file ) {\n\t            var ext;\n\t\n\t            this.name = file.name || ('untitled' + uid++);\n\t            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n\t\n\t            // todo 支持其他类型文件的转换。\n\t            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n\t            if ( !ext && file.type ) {\n\t                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n\t                        RegExp.$1.toLowerCase() : '';\n\t                this.name += '.' + ext;\n\t            }\n\t\n\t            this.ext = ext;\n\t            this.lastModifiedDate = file.lastModifiedDate ||\n\t                    (new Date()).toLocaleString();\n\t\n\t            Blob.apply( this, arguments );\n\t        }\n\t\n\t        return Base.inherits( Blob, File );\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/filepicker',[\n\t        'base',\n\t        'runtime/client',\n\t        'lib/file'\n\t    ], function( Base, RuntimeClent, File ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function FilePicker( opts ) {\n\t            opts = this.options = $.extend({}, FilePicker.options, opts );\n\t\n\t            opts.container = $( opts.id );\n\t\n\t            if ( !opts.container.length ) {\n\t                throw new Error('按钮指定错误');\n\t            }\n\t\n\t            opts.innerHTML = opts.innerHTML || opts.label ||\n\t                    opts.container.html() || '';\n\t\n\t            opts.button = $( opts.button || document.createElement('div') );\n\t            opts.button.html( opts.innerHTML );\n\t            opts.container.html( opts.button );\n\t\n\t            RuntimeClent.call( this, 'FilePicker', true );\n\t        }\n\t\n\t        FilePicker.options = {\n\t            button: null,\n\t            container: null,\n\t            label: null,\n\t            innerHTML: null,\n\t            multiple: true,\n\t            accept: null,\n\t            name: 'file'\n\t        };\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: FilePicker,\n\t\n\t            init: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    button = opts.button;\n\t\n\t                button.addClass('webuploader-pick');\n\t\n\t                me.on( 'all', function( type ) {\n\t                    var files;\n\t\n\t                    switch ( type ) {\n\t                        case 'mouseenter':\n\t                            button.addClass('webuploader-pick-hover');\n\t                            break;\n\t\n\t                        case 'mouseleave':\n\t                            button.removeClass('webuploader-pick-hover');\n\t                            break;\n\t\n\t                        case 'change':\n\t                            files = me.exec('getFiles');\n\t                            me.trigger( 'select', $.map( files, function( file ) {\n\t                                file = new File( me.getRuid(), file );\n\t\n\t                                // 记录来源。\n\t                                file._refer = opts.container;\n\t                                return file;\n\t                            }), opts.container );\n\t                            break;\n\t                    }\n\t                });\n\t\n\t                me.connectRuntime( opts, function() {\n\t                    me.refresh();\n\t                    me.exec( 'init', opts );\n\t                    me.trigger('ready');\n\t                });\n\t\n\t                this._resizeHandler = Base.bindFn( this.refresh, this );\n\t                $( window ).on( 'resize', this._resizeHandler );\n\t            },\n\t\n\t            refresh: function() {\n\t                var shimContainer = this.getRuntime().getContainer(),\n\t                    button = this.options.button,\n\t                    width = button.outerWidth ?\n\t                            button.outerWidth() : button.width(),\n\t\n\t                    height = button.outerHeight ?\n\t                            button.outerHeight() : button.height(),\n\t\n\t                    pos = button.offset();\n\t\n\t                width && height && shimContainer.css({\n\t                    bottom: 'auto',\n\t                    right: 'auto',\n\t                    width: width + 'px',\n\t                    height: height + 'px'\n\t                }).offset( pos );\n\t            },\n\t\n\t            enable: function() {\n\t                var btn = this.options.button;\n\t\n\t                btn.removeClass('webuploader-pick-disable');\n\t                this.refresh();\n\t            },\n\t\n\t            disable: function() {\n\t                var btn = this.options.button;\n\t\n\t                this.getRuntime().getContainer().css({\n\t                    top: '-99999px'\n\t                });\n\t\n\t                btn.addClass('webuploader-pick-disable');\n\t            },\n\t\n\t            destroy: function() {\n\t                var btn = this.options.button;\n\t                $( window ).off( 'resize', this._resizeHandler );\n\t                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n\t                    'webuploader-pick');\n\t            }\n\t        });\n\t\n\t        return FilePicker;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 文件选择相关\n\t     */\n\t    define('widgets/filepicker',[\n\t        'base',\n\t        'uploader',\n\t        'lib/filepicker',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, FilePicker ) {\n\t        var $ = Base.$;\n\t\n\t        $.extend( Uploader.options, {\n\t\n\t            /**\n\t             * @property {Selector | Object} [pick=undefined]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n\t             *\n\t             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n\t             * * `label` {String} 请采用 `innerHTML` 代替\n\t             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n\t             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n\t             */\n\t            pick: null,\n\t\n\t            /**\n\t             * @property {Arroy} [accept=null]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n\t             *\n\t             * * `title` {String} 文字描述\n\t             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n\t             * * `mimeTypes` {String} 多个用逗号分割。\n\t             *\n\t             * 如：\n\t             *\n\t             * ```\n\t             * {\n\t             *     title: 'Images',\n\t             *     extensions: 'gif,jpg,jpeg,bmp,png',\n\t             *     mimeTypes: 'image/*'\n\t             * }\n\t             * ```\n\t             */\n\t            accept: null/*{\n\t                title: 'Images',\n\t                extensions: 'gif,jpg,jpeg,bmp,png',\n\t                mimeTypes: 'image/*'\n\t            }*/\n\t        });\n\t\n\t        return Uploader.register({\n\t            name: 'picker',\n\t\n\t            init: function( opts ) {\n\t                this.pickers = [];\n\t                return opts.pick && this.addBtn( opts.pick );\n\t            },\n\t\n\t            refresh: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.refresh();\n\t                });\n\t            },\n\t\n\t            /**\n\t             * @method addButton\n\t             * @for Uploader\n\t             * @grammar addButton( pick ) => Promise\n\t             * @description\n\t             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n\t             * @example\n\t             * uploader.addButton({\n\t             *     id: '#btnContainer',\n\t             *     innerHTML: '选择文件'\n\t             * });\n\t             */\n\t            addBtn: function( pick ) {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    accept = opts.accept,\n\t                    promises = [];\n\t\n\t                if ( !pick ) {\n\t                    return;\n\t                }\n\t\n\t                $.isPlainObject( pick ) || (pick = {\n\t                    id: pick\n\t                });\n\t\n\t                $( pick.id ).each(function() {\n\t                    var options, picker, deferred;\n\t\n\t                    deferred = Base.Deferred();\n\t\n\t                    options = $.extend({}, pick, {\n\t                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n\t                        swf: opts.swf,\n\t                        runtimeOrder: opts.runtimeOrder,\n\t                        id: this\n\t                    });\n\t\n\t                    picker = new FilePicker( options );\n\t\n\t                    picker.once( 'ready', deferred.resolve );\n\t                    picker.on( 'select', function( files ) {\n\t                        me.owner.request( 'add-file', [ files ]);\n\t                    });\n\t                    picker.init();\n\t\n\t                    me.pickers.push( picker );\n\t\n\t                    promises.push( deferred.promise() );\n\t                });\n\t\n\t                return Base.when.apply( Base, promises );\n\t            },\n\t\n\t            disable: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.disable();\n\t                });\n\t            },\n\t\n\t            enable: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.enable();\n\t                });\n\t            },\n\t\n\t            destroy: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.destroy();\n\t                });\n\t                this.pickers = null;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Image\n\t     */\n\t    define('lib/image',[\n\t        'base',\n\t        'runtime/client',\n\t        'lib/blob'\n\t    ], function( Base, RuntimeClient, Blob ) {\n\t        var $ = Base.$;\n\t\n\t        // 构造器。\n\t        function Image( opts ) {\n\t            this.options = $.extend({}, Image.options, opts );\n\t            RuntimeClient.call( this, 'Image' );\n\t\n\t            this.on( 'load', function() {\n\t                this._info = this.exec('info');\n\t                this._meta = this.exec('meta');\n\t            });\n\t        }\n\t\n\t        // 默认选项。\n\t        Image.options = {\n\t\n\t            // 默认的图片处理质量\n\t            quality: 90,\n\t\n\t            // 是否裁剪\n\t            crop: false,\n\t\n\t            // 是否保留头部信息\n\t            preserveHeaders: false,\n\t\n\t            // 是否允许放大。\n\t            allowMagnify: false\n\t        };\n\t\n\t        // 继承RuntimeClient.\n\t        Base.inherits( RuntimeClient, {\n\t            constructor: Image,\n\t\n\t            info: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._info = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._info;\n\t            },\n\t\n\t            meta: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._meta = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._meta;\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var me = this,\n\t                    ruid = blob.getRuid();\n\t\n\t                this.connectRuntime( ruid, function() {\n\t                    me.exec( 'init', me.options );\n\t                    me.exec( 'loadFromBlob', blob );\n\t                });\n\t            },\n\t\n\t            resize: function() {\n\t                var args = Base.slice( arguments );\n\t                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n\t            },\n\t\n\t            crop: function() {\n\t                var args = Base.slice( arguments );\n\t                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n\t            },\n\t\n\t            getAsDataUrl: function( type ) {\n\t                return this.exec( 'getAsDataUrl', type );\n\t            },\n\t\n\t            getAsBlob: function( type ) {\n\t                var blob = this.exec( 'getAsBlob', type );\n\t\n\t                return new Blob( this.getRuid(), blob );\n\t            }\n\t        });\n\t\n\t        return Image;\n\t    });\n\t    /**\n\t     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n\t     */\n\t    define('widgets/image',[\n\t        'base',\n\t        'uploader',\n\t        'lib/image',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Image ) {\n\t\n\t        var $ = Base.$,\n\t            throttle;\n\t\n\t        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n\t        throttle = (function( max ) {\n\t            var occupied = 0,\n\t                waiting = [],\n\t                tick = function() {\n\t                    var item;\n\t\n\t                    while ( waiting.length && occupied < max ) {\n\t                        item = waiting.shift();\n\t                        occupied += item[ 0 ];\n\t                        item[ 1 ]();\n\t                    }\n\t                };\n\t\n\t            return function( emiter, size, cb ) {\n\t                waiting.push([ size, cb ]);\n\t                emiter.once( 'destroy', function() {\n\t                    occupied -= size;\n\t                    setTimeout( tick, 1 );\n\t                });\n\t                setTimeout( tick, 1 );\n\t            };\n\t        })( 5 * 1024 * 1024 );\n\t\n\t        $.extend( Uploader.options, {\n\t\n\t            /**\n\t             * @property {Object} [thumb]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 配置生成缩略图的选项。\n\t             *\n\t             * 默认为：\n\t             *\n\t             * ```javascript\n\t             * {\n\t             *     width: 110,\n\t             *     height: 110,\n\t             *\n\t             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n\t             *     quality: 70,\n\t             *\n\t             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n\t             *     allowMagnify: true,\n\t             *\n\t             *     // 是否允许裁剪。\n\t             *     crop: true,\n\t             *\n\t             *     // 为空的话则保留原有图片格式。\n\t             *     // 否则强制转换成指定的类型。\n\t             *     type: 'image/jpeg'\n\t             * }\n\t             * ```\n\t             */\n\t            thumb: {\n\t                width: 110,\n\t                height: 110,\n\t                quality: 70,\n\t                allowMagnify: true,\n\t                crop: true,\n\t                preserveHeaders: false,\n\t\n\t                // 为空的话则保留原有图片格式。\n\t                // 否则强制转换成指定的类型。\n\t                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n\t                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n\t                type: 'image/jpeg'\n\t            },\n\t\n\t            /**\n\t             * @property {Object} [compress]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n\t             *\n\t             * 默认为：\n\t             *\n\t             * ```javascript\n\t             * {\n\t             *     width: 1600,\n\t             *     height: 1600,\n\t             *\n\t             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n\t             *     quality: 90,\n\t             *\n\t             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n\t             *     allowMagnify: false,\n\t             *\n\t             *     // 是否允许裁剪。\n\t             *     crop: false,\n\t             *\n\t             *     // 是否保留头部meta信息。\n\t             *     preserveHeaders: true,\n\t             *\n\t             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n\t             *     // 此属性可能会影响图片自动纠正功能\n\t             *     noCompressIfLarger: false,\n\t             *\n\t             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n\t             *     compressSize: 0\n\t             * }\n\t             * ```\n\t             */\n\t            compress: {\n\t                width: 1600,\n\t                height: 1600,\n\t                quality: 90,\n\t                allowMagnify: false,\n\t                crop: false,\n\t                preserveHeaders: true\n\t            }\n\t        });\n\t\n\t        return Uploader.register({\n\t\n\t            name: 'image',\n\t\n\t\n\t            /**\n\t             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n\t             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n\t             *\n\t             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n\t             *\n\t             * `callback`中可以接收到两个参数。\n\t             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n\t             * * 第二个为ret, 缩略图的Data URL值。\n\t             *\n\t             * **注意**\n\t             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n\t             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n\t             *\n\t             * @method makeThumb\n\t             * @grammar makeThumb( file, callback ) => undefined\n\t             * @grammar makeThumb( file, callback, width, height ) => undefined\n\t             * @for Uploader\n\t             * @example\n\t             *\n\t             * uploader.on( 'fileQueued', function( file ) {\n\t             *     var $li = ...;\n\t             *\n\t             *     uploader.makeThumb( file, function( error, ret ) {\n\t             *         if ( error ) {\n\t             *             $li.text('预览错误');\n\t             *         } else {\n\t             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n\t             *         }\n\t             *     });\n\t             *\n\t             * });\n\t             */\n\t            makeThumb: function( file, cb, width, height ) {\n\t                var opts, image;\n\t                var isArtwork = false;\n\t                file = this.request( 'get-file', file );\n\t\n\t                // 只预览图片格式。\n\t                if ( !file.type.match( /^image/ ) ) {\n\t                    cb( true );\n\t                    return;\n\t                }\n\t\n\t                opts = $.extend({}, this.options.thumb );\n\t                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n\t                // 如果传入的是object.\n\t                if ( $.isPlainObject( width ) ) {\n\t                    opts = $.extend( opts, width );\n\t                    width = null;\n\t                }\n\t\n\t                width = width || opts.width;\n\t                height = height || opts.height;\n\t\n\t                image = new Image( opts );\n\t\n\t                image.once( 'load', function() {\n\t                    file._info = file._info || image.info();\n\t                    file._meta = file._meta || image.meta();\n\t\n\t                    // 如果 width 的值介于 0 - 1\n\t                    // 说明设置的是百分比。\n\t                    if ( width <= 1 && width > 0 ) {\n\t                        width = file._info.width * width;\n\t                    }\n\t\n\t                    // 同样的规则应用于 height\n\t                    if ( height <= 1 && height > 0 ) {\n\t                        height = file._info.height * height;\n\t                    }\n\t                    if( isArtwork ){\n\t                        image.resize( file._info.width, file._info.height );\n\t\n\t                    }else{\n\t                        image.resize( width, height );\n\t\n\t\n\t                    }\n\t\n\t                });\n\t\n\t                // 当 resize 完后\n\t                image.once( 'complete', function() {\n\t                    cb( false, image.getAsDataUrl( opts.type ) );\n\t                    image.destroy();\n\t                });\n\t\n\t                image.once( 'error', function( reason ) {\n\t                    cb( reason || true );\n\t                    image.destroy();\n\t                });\n\t\n\t                throttle( image, file.source.size, function() {\n\t                    file._info && image.info( file._info );\n\t                    file._meta && image.meta( file._meta );\n\t                    image.loadFromBlob( file.source );\n\t                });\n\t            },\n\t\n\t            beforeSendFile: function( file ) {\n\t                var opts = this.options.compress || this.options.resize,\n\t                    compressSize = opts && opts.compressSize || 0,\n\t                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n\t                    image, deferred;\n\t\n\t                file = this.request( 'get-file', file );\n\t\n\t                // 只压缩 jpeg 图片格式。\n\t                // gif 可能会丢失针\n\t                // bmp png 基本上尺寸都不大，且压缩比比较小。\n\t                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n\t                        file.size < compressSize ||\n\t                        file._compressed ) {\n\t                    return;\n\t                }\n\t\n\t                opts = $.extend({}, opts );\n\t                deferred = Base.Deferred();\n\t\n\t                image = new Image( opts );\n\t\n\t                deferred.always(function() {\n\t                    image.destroy();\n\t                    image = null;\n\t                });\n\t                image.once( 'error', deferred.reject );\n\t                image.once( 'load', function() {\n\t                    var width = opts.width,\n\t                        height = opts.height;\n\t\n\t                    file._info = file._info || image.info();\n\t                    file._meta = file._meta || image.meta();\n\t\n\t                    // 如果 width 的值介于 0 - 1\n\t                    // 说明设置的是百分比。\n\t                    if ( width <= 1 && width > 0 ) {\n\t                        width = file._info.width * width;\n\t                    }\n\t\n\t                    // 同样的规则应用于 height\n\t                    if ( height <= 1 && height > 0 ) {\n\t                        height = file._info.height * height;\n\t                    }\n\t\n\t                    image.resize( width, height );\n\t                });\n\t\n\t                image.once( 'complete', function() {\n\t                    var blob, size;\n\t\n\t                    // 移动端 UC / qq 浏览器的无图模式下\n\t                    // ctx.getImageData 处理大图的时候会报 Exception\n\t                    // INDEX_SIZE_ERR: DOM Exception 1\n\t                    try {\n\t                        blob = image.getAsBlob( opts.type );\n\t\n\t                        size = file.size;\n\t\n\t                        // 如果压缩后，比原来还大则不用压缩后的。\n\t                        if ( !noCompressIfLarger || blob.size < size ) {\n\t                            // file.source.destroy && file.source.destroy();\n\t                            file.source = blob;\n\t                            file.size = blob.size;\n\t\n\t                            file.trigger( 'resize', blob.size, size );\n\t                        }\n\t\n\t                        // 标记，避免重复压缩。\n\t                        file._compressed = true;\n\t                        deferred.resolve();\n\t                    } catch ( e ) {\n\t                        // 出错了直接继续，让其上传原始图片\n\t                        deferred.resolve();\n\t                    }\n\t                });\n\t\n\t                file._info && image.info( file._info );\n\t                file._meta && image.meta( file._meta );\n\t\n\t                image.loadFromBlob( file.source );\n\t                return deferred.promise();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 文件属性封装\n\t     */\n\t    define('file',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$,\n\t            idPrefix = 'WU_FILE_',\n\t            idSuffix = 0,\n\t            rExt = /\\.([^.]+)$/,\n\t            statusMap = {};\n\t\n\t        function gid() {\n\t            return idPrefix + idSuffix++;\n\t        }\n\t\n\t        /**\n\t         * 文件类\n\t         * @class File\n\t         * @constructor 构造函数\n\t         * @grammar new File( source ) => File\n\t         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n\t         */\n\t        function WUFile( source ) {\n\t\n\t            /**\n\t             * 文件名，包括扩展名（后缀）\n\t             * @property name\n\t             * @type {string}\n\t             */\n\t            this.name = source.name || 'Untitled';\n\t\n\t            /**\n\t             * 文件体积（字节）\n\t             * @property size\n\t             * @type {uint}\n\t             * @default 0\n\t             */\n\t            this.size = source.size || 0;\n\t\n\t            /**\n\t             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n\t             * @property type\n\t             * @type {string}\n\t             * @default 'application/octet-stream'\n\t             */\n\t            this.type = source.type || 'application/octet-stream';\n\t\n\t            /**\n\t             * 文件最后修改日期\n\t             * @property lastModifiedDate\n\t             * @type {int}\n\t             * @default 当前时间戳\n\t             */\n\t            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n\t\n\t            /**\n\t             * 文件ID，每个对象具有唯一ID，与文件名无关\n\t             * @property id\n\t             * @type {string}\n\t             */\n\t            this.id = gid();\n\t\n\t            /**\n\t             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n\t             * @property ext\n\t             * @type {string}\n\t             */\n\t            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n\t\n\t\n\t            /**\n\t             * 状态文字说明。在不同的status语境下有不同的用途。\n\t             * @property statusText\n\t             * @type {string}\n\t             */\n\t            this.statusText = '';\n\t\n\t            // 存储文件状态，防止通过属性直接修改\n\t            statusMap[ this.id ] = WUFile.Status.INITED;\n\t\n\t            this.source = source;\n\t            this.loaded = 0;\n\t\n\t            this.on( 'error', function( msg ) {\n\t                this.setStatus( WUFile.Status.ERROR, msg );\n\t            });\n\t        }\n\t\n\t        $.extend( WUFile.prototype, {\n\t\n\t            /**\n\t             * 设置状态，状态变化时会触发`change`事件。\n\t             * @method setStatus\n\t             * @grammar setStatus( status[, statusText] );\n\t             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n\t             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n\t             */\n\t            setStatus: function( status, text ) {\n\t\n\t                var prevStatus = statusMap[ this.id ];\n\t\n\t                typeof text !== 'undefined' && (this.statusText = text);\n\t\n\t                if ( status !== prevStatus ) {\n\t                    statusMap[ this.id ] = status;\n\t                    /**\n\t                     * 文件状态变化\n\t                     * @event statuschange\n\t                     */\n\t                    this.trigger( 'statuschange', status, prevStatus );\n\t                }\n\t\n\t            },\n\t\n\t            /**\n\t             * 获取文件状态\n\t             * @return {File.Status}\n\t             * @example\n\t                     文件状态具体包括以下几种类型：\n\t                     {\n\t                         // 初始化\n\t                        INITED:     0,\n\t                        // 已入队列\n\t                        QUEUED:     1,\n\t                        // 正在上传\n\t                        PROGRESS:     2,\n\t                        // 上传出错\n\t                        ERROR:         3,\n\t                        // 上传成功\n\t                        COMPLETE:     4,\n\t                        // 上传取消\n\t                        CANCELLED:     5\n\t                    }\n\t             */\n\t            getStatus: function() {\n\t                return statusMap[ this.id ];\n\t            },\n\t\n\t            /**\n\t             * 获取文件原始信息。\n\t             * @return {*}\n\t             */\n\t            getSource: function() {\n\t                return this.source;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.off();\n\t                delete statusMap[ this.id ];\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( WUFile.prototype );\n\t\n\t        /**\n\t         * 文件状态值，具体包括以下几种类型：\n\t         * * `inited` 初始状态\n\t         * * `queued` 已经进入队列, 等待上传\n\t         * * `progress` 上传中\n\t         * * `complete` 上传完成。\n\t         * * `error` 上传出错，可重试\n\t         * * `interrupt` 上传中断，可续传。\n\t         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n\t         * * `cancelled` 文件被移除。\n\t         * @property {Object} Status\n\t         * @namespace File\n\t         * @class File\n\t         * @static\n\t         */\n\t        WUFile.Status = {\n\t            INITED:     'inited',    // 初始状态\n\t            QUEUED:     'queued',    // 已经进入队列, 等待上传\n\t            PROGRESS:   'progress',    // 上传中\n\t            ERROR:      'error',    // 上传出错，可重试\n\t            COMPLETE:   'complete',    // 上传完成。\n\t            CANCELLED:  'cancelled',    // 上传取消。\n\t            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n\t            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n\t        };\n\t\n\t        return WUFile;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 文件队列\n\t     */\n\t    define('queue',[\n\t        'base',\n\t        'mediator',\n\t        'file'\n\t    ], function( Base, Mediator, WUFile ) {\n\t\n\t        var $ = Base.$,\n\t            STATUS = WUFile.Status;\n\t\n\t        /**\n\t         * 文件队列, 用来存储各个状态中的文件。\n\t         * @class Queue\n\t         * @extends Mediator\n\t         */\n\t        function Queue() {\n\t\n\t            /**\n\t             * 统计文件数。\n\t             * * `numOfQueue` 队列中的文件数。\n\t             * * `numOfSuccess` 上传成功的文件数\n\t             * * `numOfCancel` 被取消的文件数\n\t             * * `numOfProgress` 正在上传中的文件数\n\t             * * `numOfUploadFailed` 上传错误的文件数。\n\t             * * `numOfInvalid` 无效的文件数。\n\t             * * `numofDeleted` 被移除的文件数。\n\t             * @property {Object} stats\n\t             */\n\t            this.stats = {\n\t                numOfQueue: 0,\n\t                numOfSuccess: 0,\n\t                numOfCancel: 0,\n\t                numOfProgress: 0,\n\t                numOfUploadFailed: 0,\n\t                numOfInvalid: 0,\n\t                numofDeleted: 0,\n\t                numofInterrupt: 0\n\t            };\n\t\n\t            // 上传队列，仅包括等待上传的文件\n\t            this._queue = [];\n\t\n\t            // 存储所有文件\n\t            this._map = {};\n\t        }\n\t\n\t        $.extend( Queue.prototype, {\n\t\n\t            /**\n\t             * 将新文件加入对队列尾部\n\t             *\n\t             * @method append\n\t             * @param  {File} file   文件对象\n\t             */\n\t            append: function( file ) {\n\t                this._queue.push( file );\n\t                this._fileAdded( file );\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 将新文件加入对队列头部\n\t             *\n\t             * @method prepend\n\t             * @param  {File} file   文件对象\n\t             */\n\t            prepend: function( file ) {\n\t                this._queue.unshift( file );\n\t                this._fileAdded( file );\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 获取文件对象\n\t             *\n\t             * @method getFile\n\t             * @param  {String} fileId   文件ID\n\t             * @return {File}\n\t             */\n\t            getFile: function( fileId ) {\n\t                if ( typeof fileId !== 'string' ) {\n\t                    return fileId;\n\t                }\n\t                return this._map[ fileId ];\n\t            },\n\t\n\t            /**\n\t             * 从队列中取出一个指定状态的文件。\n\t             * @grammar fetch( status ) => File\n\t             * @method fetch\n\t             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n\t             * @return {File} [File](#WebUploader:File)\n\t             */\n\t            fetch: function( status ) {\n\t                var len = this._queue.length,\n\t                    i, file;\n\t\n\t                status = status || STATUS.QUEUED;\n\t\n\t                for ( i = 0; i < len; i++ ) {\n\t                    file = this._queue[ i ];\n\t\n\t                    if ( status === file.getStatus() ) {\n\t                        return file;\n\t                    }\n\t                }\n\t\n\t                return null;\n\t            },\n\t\n\t            /**\n\t             * 对队列进行排序，能够控制文件上传顺序。\n\t             * @grammar sort( fn ) => undefined\n\t             * @method sort\n\t             * @param {Function} fn 排序方法\n\t             */\n\t            sort: function( fn ) {\n\t                if ( typeof fn === 'function' ) {\n\t                    this._queue.sort( fn );\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n\t             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n\t             * @method getFiles\n\t             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n\t             */\n\t            getFiles: function() {\n\t                var sts = [].slice.call( arguments, 0 ),\n\t                    ret = [],\n\t                    i = 0,\n\t                    len = this._queue.length,\n\t                    file;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    file = this._queue[ i ];\n\t\n\t                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n\t                        continue;\n\t                    }\n\t\n\t                    ret.push( file );\n\t                }\n\t\n\t                return ret;\n\t            },\n\t\n\t            /**\n\t             * 在队列中删除文件。\n\t             * @grammar removeFile( file ) => Array\n\t             * @method removeFile\n\t             * @param {File} 文件对象。\n\t             */\n\t            removeFile: function( file ) {\n\t                var me = this,\n\t                    existing = this._map[ file.id ];\n\t\n\t                if ( existing ) {\n\t                    delete this._map[ file.id ];\n\t                    file.destroy();\n\t                    this.stats.numofDeleted++;\n\t                }\n\t            },\n\t\n\t            _fileAdded: function( file ) {\n\t                var me = this,\n\t                    existing = this._map[ file.id ];\n\t\n\t                if ( !existing ) {\n\t                    this._map[ file.id ] = file;\n\t\n\t                    file.on( 'statuschange', function( cur, pre ) {\n\t                        me._onFileStatusChange( cur, pre );\n\t                    });\n\t                }\n\t            },\n\t\n\t            _onFileStatusChange: function( curStatus, preStatus ) {\n\t                var stats = this.stats;\n\t\n\t                switch ( preStatus ) {\n\t                    case STATUS.PROGRESS:\n\t                        stats.numOfProgress--;\n\t                        break;\n\t\n\t                    case STATUS.QUEUED:\n\t                        stats.numOfQueue --;\n\t                        break;\n\t\n\t                    case STATUS.ERROR:\n\t                        stats.numOfUploadFailed--;\n\t                        break;\n\t\n\t                    case STATUS.INVALID:\n\t                        stats.numOfInvalid--;\n\t                        break;\n\t\n\t                    case STATUS.INTERRUPT:\n\t                        stats.numofInterrupt--;\n\t                        break;\n\t                }\n\t\n\t                switch ( curStatus ) {\n\t                    case STATUS.QUEUED:\n\t                        stats.numOfQueue++;\n\t                        break;\n\t\n\t                    case STATUS.PROGRESS:\n\t                        stats.numOfProgress++;\n\t                        break;\n\t\n\t                    case STATUS.ERROR:\n\t                        stats.numOfUploadFailed++;\n\t                        break;\n\t\n\t                    case STATUS.COMPLETE:\n\t                        stats.numOfSuccess++;\n\t                        break;\n\t\n\t                    case STATUS.CANCELLED:\n\t                        stats.numOfCancel++;\n\t                        break;\n\t\n\t\n\t                    case STATUS.INVALID:\n\t                        stats.numOfInvalid++;\n\t                        break;\n\t\n\t                    case STATUS.INTERRUPT:\n\t                        stats.numofInterrupt++;\n\t                        break;\n\t                }\n\t            }\n\t\n\t        });\n\t\n\t        Mediator.installTo( Queue.prototype );\n\t\n\t        return Queue;\n\t    });\n\t    /**\n\t     * @fileOverview 队列\n\t     */\n\t    define('widgets/queue',[\n\t        'base',\n\t        'uploader',\n\t        'queue',\n\t        'file',\n\t        'lib/file',\n\t        'runtime/client',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n\t\n\t        var $ = Base.$,\n\t            rExt = /\\.\\w+$/,\n\t            Status = WUFile.Status;\n\t\n\t        return Uploader.register({\n\t            name: 'queue',\n\t\n\t            init: function( opts ) {\n\t                var me = this,\n\t                    deferred, len, i, item, arr, accept, runtime;\n\t\n\t                if ( $.isPlainObject( opts.accept ) ) {\n\t                    opts.accept = [ opts.accept ];\n\t                }\n\t\n\t                // accept中的中生成匹配正则。\n\t                if ( opts.accept ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        item = opts.accept[ i ].extensions;\n\t                        item && arr.push( item );\n\t                    }\n\t\n\t                    if ( arr.length ) {\n\t                        accept = '\\\\.' + arr.join(',')\n\t                                .replace( /,/g, '$|\\\\.' )\n\t                                .replace( /\\*/g, '.*' ) + '$';\n\t                    }\n\t\n\t                    me.accept = new RegExp( accept, 'i' );\n\t                }\n\t\n\t                me.queue = new Queue();\n\t                me.stats = me.queue.stats;\n\t\n\t                // 如果当前不是html5运行时，那就算了。\n\t                // 不执行后续操作\n\t                if ( this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                // 创建一个 html5 运行时的 placeholder\n\t                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n\t                deferred = Base.Deferred();\n\t                this.placeholder = runtime = new RuntimeClient('Placeholder');\n\t                runtime.connectRuntime({\n\t                    runtimeOrder: 'html5'\n\t                }, function() {\n\t                    me._ruid = runtime.getRuid();\n\t                    deferred.resolve();\n\t                });\n\t                return deferred.promise();\n\t            },\n\t\n\t\n\t            // 为了支持外部直接添加一个原生File对象。\n\t            _wrapFile: function( file ) {\n\t                if ( !(file instanceof WUFile) ) {\n\t\n\t                    if ( !(file instanceof File) ) {\n\t                        if ( !this._ruid ) {\n\t                            throw new Error('Can\\'t add external files.');\n\t                        }\n\t                        file = new File( this._ruid, file );\n\t                    }\n\t\n\t                    file = new WUFile( file );\n\t                }\n\t\n\t                return file;\n\t            },\n\t\n\t            // 判断文件是否可以被加入队列\n\t            acceptFile: function( file ) {\n\t                 var invalid = !file || !file.size || this.accept &&\n\t\n\t                        // 如果名字中有后缀，才做后缀白名单处理。\n\t                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n\t                return !invalid;\n\t            },\n\t\n\t\n\t            /**\n\t             * @event beforeFileQueued\n\t             * @param {File} file File对象\n\t             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event fileQueued\n\t             * @param {File} file File对象\n\t             * @description 当文件被加入队列以后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            _addFile: function( file ) {\n\t                var me = this;\n\t\n\t                file = me._wrapFile( file );\n\t\n\t                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n\t                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n\t                    return;\n\t                }\n\t\n\t                // 类型不匹配，则派送错误事件，并返回。\n\t                if ( !me.acceptFile( file ) ) {\n\t                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n\t                    return;\n\t                }\n\t\n\t                me.queue.append( file );\n\t                me.owner.trigger( 'fileQueued', file );\n\t                return file;\n\t            },\n\t\n\t            getFile: function( fileId ) {\n\t                return this.queue.getFile( fileId );\n\t            },\n\t\n\t            /**\n\t             * @event filesQueued\n\t             * @param {File} files 数组，内容为原始File(lib/File）对象。\n\t             * @description 当一批文件添加进队列以后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @property {Boolean} [auto=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n\t             *\n\t             */\n\t\n\t            /**\n\t             * @method addFiles\n\t             * @grammar addFiles( file ) => undefined\n\t             * @grammar addFiles( [file1, file2 ...] ) => undefined\n\t             * @param {Array of File or File} [files] Files 对象 数组\n\t             * @description 添加文件到队列\n\t             * @for  Uploader\n\t             */\n\t            addFile: function( files ) {\n\t                var me = this;\n\t\n\t                if ( !files.length ) {\n\t                    files = [ files ];\n\t                }\n\t\n\t                files = $.map( files, function( file ) {\n\t                    return me._addFile( file );\n\t                });\n\t\n\t                me.owner.trigger( 'filesQueued', files );\n\t\n\t                if ( me.options.auto ) {\n\t                    setTimeout(function() {\n\t                        me.request('start-upload');\n\t                    }, 20 );\n\t                }\n\t            },\n\t\n\t            getStats: function() {\n\t                return this.stats;\n\t            },\n\t\n\t            /**\n\t             * @event fileDequeued\n\t             * @param {File} file File对象\n\t             * @description 当文件被移除队列后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t             /**\n\t             * @method removeFile\n\t             * @grammar removeFile( file ) => undefined\n\t             * @grammar removeFile( id ) => undefined\n\t             * @grammar removeFile( file, true ) => undefined\n\t             * @grammar removeFile( id, true ) => undefined\n\t             * @param {File|id} file File对象或这File对象的id\n\t             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n\t             * @for  Uploader\n\t             * @example\n\t             *\n\t             * $li.on('click', '.remove-this', function() {\n\t             *     uploader.removeFile( file );\n\t             * })\n\t             */\n\t            removeFile: function( file, remove ) {\n\t                var me = this;\n\t\n\t                file = file.id ? file : me.queue.getFile( file );\n\t\n\t                this.request( 'cancel-file', file );\n\t\n\t                if ( remove ) {\n\t                    this.queue.removeFile( file );\n\t                }\n\t            },\n\t\n\t            /**\n\t             * @method getFiles\n\t             * @grammar getFiles() => Array\n\t             * @grammar getFiles( status1, status2, status... ) => Array\n\t             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n\t             * @for  Uploader\n\t             * @example\n\t             * console.log( uploader.getFiles() );    // => all files\n\t             * console.log( uploader.getFiles('error') )    // => all error files.\n\t             */\n\t            getFiles: function() {\n\t                return this.queue.getFiles.apply( this.queue, arguments );\n\t            },\n\t\n\t            fetchFile: function() {\n\t                return this.queue.fetch.apply( this.queue, arguments );\n\t            },\n\t\n\t            /**\n\t             * @method retry\n\t             * @grammar retry() => undefined\n\t             * @grammar retry( file ) => undefined\n\t             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n\t             * @for  Uploader\n\t             * @example\n\t             * function retry() {\n\t             *     uploader.retry();\n\t             * }\n\t             */\n\t            retry: function( file, noForceStart ) {\n\t                var me = this,\n\t                    files, i, len;\n\t\n\t                if ( file ) {\n\t                    file = file.id ? file : me.queue.getFile( file );\n\t                    file.setStatus( Status.QUEUED );\n\t                    noForceStart || me.request('start-upload');\n\t                    return;\n\t                }\n\t\n\t                files = me.queue.getFiles( Status.ERROR );\n\t                i = 0;\n\t                len = files.length;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    file = files[ i ];\n\t                    file.setStatus( Status.QUEUED );\n\t                }\n\t\n\t                me.request('start-upload');\n\t            },\n\t\n\t            /**\n\t             * @method sort\n\t             * @grammar sort( fn ) => undefined\n\t             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n\t             * @for  Uploader\n\t             */\n\t            sortFiles: function() {\n\t                return this.queue.sort.apply( this.queue, arguments );\n\t            },\n\t\n\t            /**\n\t             * @event reset\n\t             * @description 当 uploader 被重置的时候触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @method reset\n\t             * @grammar reset() => undefined\n\t             * @description 重置uploader。目前只重置了队列。\n\t             * @for  Uploader\n\t             * @example\n\t             * uploader.reset();\n\t             */\n\t            reset: function() {\n\t                this.owner.trigger('reset');\n\t                this.queue = new Queue();\n\t                this.stats = this.queue.stats;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.reset();\n\t                this.placeholder && this.placeholder.destroy();\n\t            }\n\t        });\n\t\n\t    });\n\t    /**\n\t     * @fileOverview 添加获取Runtime相关信息的方法。\n\t     */\n\t    define('widgets/runtime',[\n\t        'uploader',\n\t        'runtime/runtime',\n\t        'widgets/widget'\n\t    ], function( Uploader, Runtime ) {\n\t\n\t        Uploader.support = function() {\n\t            return Runtime.hasRuntime.apply( Runtime, arguments );\n\t        };\n\t\n\t        /**\n\t         * @property {Object} [runtimeOrder=html5,flash]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n\t         *\n\t         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n\t         */\n\t\n\t        return Uploader.register({\n\t            name: 'runtime',\n\t\n\t            init: function() {\n\t                if ( !this.predictRuntimeType() ) {\n\t                    throw Error('Runtime Error');\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 预测Uploader将采用哪个`Runtime`\n\t             * @grammar predictRuntimeType() => String\n\t             * @method predictRuntimeType\n\t             * @for  Uploader\n\t             */\n\t            predictRuntimeType: function() {\n\t                var orders = this.options.runtimeOrder || Runtime.orders,\n\t                    type = this.type,\n\t                    i, len;\n\t\n\t                if ( !type ) {\n\t                    orders = orders.split( /\\s*,\\s*/g );\n\t\n\t                    for ( i = 0, len = orders.length; i < len; i++ ) {\n\t                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n\t                            this.type = type = orders[ i ];\n\t                            break;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                return type;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Transport\n\t     */\n\t    define('lib/transport',[\n\t        'base',\n\t        'runtime/client',\n\t        'mediator'\n\t    ], function( Base, RuntimeClient, Mediator ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function Transport( opts ) {\n\t            var me = this;\n\t\n\t            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n\t            RuntimeClient.call( this, 'Transport' );\n\t\n\t            this._blob = null;\n\t            this._formData = opts.formData || {};\n\t            this._headers = opts.headers || {};\n\t\n\t            this.on( 'progress', this._timeout );\n\t            this.on( 'load error', function() {\n\t                me.trigger( 'progress', 1 );\n\t                clearTimeout( me._timer );\n\t            });\n\t        }\n\t\n\t        Transport.options = {\n\t            server: '',\n\t            method: 'POST',\n\t\n\t            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n\t            withCredentials: false,\n\t            fileVal: 'file',\n\t            timeout: 2 * 60 * 1000,    // 2分钟\n\t            formData: {},\n\t            headers: {},\n\t            sendAsBinary: false\n\t        };\n\t\n\t        $.extend( Transport.prototype, {\n\t\n\t            // 添加Blob, 只能添加一次，最后一次有效。\n\t            appendBlob: function( key, blob, filename ) {\n\t                var me = this,\n\t                    opts = me.options;\n\t\n\t                if ( me.getRuid() ) {\n\t                    me.disconnectRuntime();\n\t                }\n\t\n\t                // 连接到blob归属的同一个runtime.\n\t                me.connectRuntime( blob.ruid, function() {\n\t                    me.exec('init');\n\t                });\n\t\n\t                me._blob = blob;\n\t                opts.fileVal = key || opts.fileVal;\n\t                opts.filename = filename || opts.filename;\n\t\n\t            },\n\t\n\t            // 添加其他字段\n\t            append: function( key, value ) {\n\t                if ( typeof key === 'object' ) {\n\t                    $.extend( this._formData, key );\n\t                } else {\n\t                    this._formData[ key ] = value;\n\t                }\n\t            },\n\t\n\t            setRequestHeader: function( key, value ) {\n\t                if ( typeof key === 'object' ) {\n\t                    $.extend( this._headers, key );\n\t                } else {\n\t                    this._headers[ key ] = value;\n\t                }\n\t            },\n\t\n\t            send: function( method ) {\n\t                this.exec( 'send', method );\n\t                this._timeout();\n\t            },\n\t\n\t            abort: function() {\n\t                clearTimeout( this._timer );\n\t                return this.exec('abort');\n\t            },\n\t\n\t            destroy: function() {\n\t                this.trigger('destroy');\n\t                this.off();\n\t                this.exec('destroy');\n\t                this.disconnectRuntime();\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this.exec('getResponse');\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this.exec('getResponseAsJson');\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this.exec('getStatus');\n\t            },\n\t\n\t            _timeout: function() {\n\t                var me = this,\n\t                    duration = me.options.timeout;\n\t\n\t                if ( !duration ) {\n\t                    return;\n\t                }\n\t\n\t                clearTimeout( me._timer );\n\t                me._timer = setTimeout(function() {\n\t                    me.abort();\n\t                    me.trigger( 'error', 'timeout' );\n\t                }, duration );\n\t            }\n\t\n\t        });\n\t\n\t        // 让Transport具备事件功能。\n\t        Mediator.installTo( Transport.prototype );\n\t\n\t        return Transport;\n\t    });\n\t    /**\n\t     * @fileOverview 负责文件上传相关。\n\t     */\n\t    define('widgets/upload',[\n\t        'base',\n\t        'uploader',\n\t        'file',\n\t        'lib/transport',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, WUFile, Transport ) {\n\t\n\t        var $ = Base.$,\n\t            isPromise = Base.isPromise,\n\t            Status = WUFile.Status;\n\t\n\t        // 添加默认配置项\n\t        $.extend( Uploader.options, {\n\t\n\t\n\t            /**\n\t             * @property {Boolean} [prepareNextFile=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否允许在文件传输时提前把下一个文件准备好。\n\t             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n\t             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n\t             */\n\t            prepareNextFile: false,\n\t\n\t            /**\n\t             * @property {Boolean} [chunked=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否要分片处理大文件上传。\n\t             */\n\t            chunked: false,\n\t\n\t            /**\n\t             * @property {Boolean} [chunkSize=5242880]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 如果要分片，分多大一片？ 默认大小为5M.\n\t             */\n\t            chunkSize: 5 * 1024 * 1024,\n\t\n\t            /**\n\t             * @property {Boolean} [chunkRetry=2]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n\t             */\n\t            chunkRetry: 2,\n\t\n\t            /**\n\t             * @property {Boolean} [threads=3]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 上传并发数。允许同时最大上传进程数。\n\t             */\n\t            threads: 3,\n\t\n\t\n\t            /**\n\t             * @property {Object} [formData={}]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n\t             */\n\t            formData: {}\n\t\n\t            /**\n\t             * @property {Object} [fileVal='file']\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 设置文件上传域的name。\n\t             */\n\t\n\t            /**\n\t             * @property {Object} [method='POST']\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 文件上传方式，`POST`或者`GET`。\n\t             */\n\t\n\t            /**\n\t             * @property {Object} [sendAsBinary=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n\t             * 其他参数在$_GET数组中。\n\t             */\n\t        });\n\t\n\t        // 负责将文件切片。\n\t        function CuteFile( file, chunkSize ) {\n\t            var pending = [],\n\t                blob = file.source,\n\t                total = blob.size,\n\t                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n\t                start = 0,\n\t                index = 0,\n\t                len, api;\n\t\n\t            api = {\n\t                file: file,\n\t\n\t                has: function() {\n\t                    return !!pending.length;\n\t                },\n\t\n\t                shift: function() {\n\t                    return pending.shift();\n\t                },\n\t\n\t                unshift: function( block ) {\n\t                    pending.unshift( block );\n\t                }\n\t            };\n\t\n\t            while ( index < chunks ) {\n\t                len = Math.min( chunkSize, total - start );\n\t\n\t                pending.push({\n\t                    file: file,\n\t                    start: start,\n\t                    end: chunkSize ? (start + len) : total,\n\t                    total: total,\n\t                    chunks: chunks,\n\t                    chunk: index++,\n\t                    cuted: api\n\t                });\n\t                start += len;\n\t            }\n\t\n\t            file.blocks = pending.concat();\n\t            file.remaning = pending.length;\n\t\n\t            return api;\n\t        }\n\t\n\t        Uploader.register({\n\t            name: 'upload',\n\t\n\t            init: function() {\n\t                var owner = this.owner,\n\t                    me = this;\n\t\n\t                this.runing = false;\n\t                this.progress = false;\n\t\n\t                owner\n\t                    .on( 'startUpload', function() {\n\t                        me.progress = true;\n\t                    })\n\t                    .on( 'uploadFinished', function() {\n\t                        me.progress = false;\n\t                    });\n\t\n\t                // 记录当前正在传的数据，跟threads相关\n\t                this.pool = [];\n\t\n\t                // 缓存分好片的文件。\n\t                this.stack = [];\n\t\n\t                // 缓存即将上传的文件。\n\t                this.pending = [];\n\t\n\t                // 跟踪还有多少分片在上传中但是没有完成上传。\n\t                this.remaning = 0;\n\t                this.__tick = Base.bindFn( this._tick, this );\n\t\n\t                owner.on( 'uploadComplete', function( file ) {\n\t\n\t                    // 把其他块取消了。\n\t                    file.blocks && $.each( file.blocks, function( _, v ) {\n\t                        v.transport && (v.transport.abort(), v.transport.destroy());\n\t                        delete v.transport;\n\t                    });\n\t\n\t                    delete file.blocks;\n\t                    delete file.remaning;\n\t                });\n\t            },\n\t\n\t            reset: function() {\n\t                this.request( 'stop-upload', true );\n\t                this.runing = false;\n\t                this.pool = [];\n\t                this.stack = [];\n\t                this.pending = [];\n\t                this.remaning = 0;\n\t                this._trigged = false;\n\t                this._promise = null;\n\t            },\n\t\n\t            /**\n\t             * @event startUpload\n\t             * @description 当开始上传流程时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n\t             *\n\t             * 可以指定开始某一个文件。\n\t             * @grammar upload() => undefined\n\t             * @grammar upload( file | fileId) => undefined\n\t             * @method upload\n\t             * @for  Uploader\n\t             */\n\t            startUpload: function(file) {\n\t                var me = this;\n\t\n\t                // 移出invalid的文件\n\t                $.each( me.request( 'get-files', Status.INVALID ), function() {\n\t                    me.request( 'remove-file', this );\n\t                });\n\t\n\t                // 如果指定了开始某个文件，则只开始指定文件。\n\t                if ( file ) {\n\t                    file = file.id ? file : me.request( 'get-file', file );\n\t\n\t                    if (file.getStatus() === Status.INTERRUPT) {\n\t                        $.each( me.pool, function( _, v ) {\n\t\n\t                            // 之前暂停过。\n\t                            if (v.file !== file) {\n\t                                return;\n\t                            }\n\t\n\t                            v.transport && v.transport.send();\n\t                        });\n\t\n\t                        file.setStatus( Status.QUEUED );\n\t                    } else if (file.getStatus() === Status.PROGRESS) {\n\t                        return;\n\t                    } else {\n\t                        file.setStatus( Status.QUEUED );\n\t                    }\n\t                } else {\n\t                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n\t                        this.setStatus( Status.QUEUED );\n\t                    });\n\t                }\n\t\n\t                if ( me.runing ) {\n\t                    return;\n\t                }\n\t\n\t                me.runing = true;\n\t\n\t                var files = [];\n\t\n\t                // 如果有暂停的，则续传\n\t                $.each( me.pool, function( _, v ) {\n\t                    var file = v.file;\n\t\n\t                    if ( file.getStatus() === Status.INTERRUPT ) {\n\t                        files.push(file);\n\t                        me._trigged = false;\n\t                        v.transport && v.transport.send();\n\t                    }\n\t                });\n\t\n\t                var file;\n\t                while ( (file = files.shift()) ) {\n\t                    file.setStatus( Status.PROGRESS );\n\t                }\n\t\n\t                file || $.each( me.request( 'get-files',\n\t                        Status.INTERRUPT ), function() {\n\t                    this.setStatus( Status.PROGRESS );\n\t                });\n\t\n\t                me._trigged = false;\n\t                Base.nextTick( me.__tick );\n\t                me.owner.trigger('startUpload');\n\t            },\n\t\n\t            /**\n\t             * @event stopUpload\n\t             * @description 当开始上传流程暂停时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n\t             *\n\t             * 如果第一个参数是文件，则只暂停指定文件。\n\t             * @grammar stop() => undefined\n\t             * @grammar stop( true ) => undefined\n\t             * @grammar stop( file ) => undefined\n\t             * @method stop\n\t             * @for  Uploader\n\t             */\n\t            stopUpload: function( file, interrupt ) {\n\t                var me = this;\n\t\n\t                if (file === true) {\n\t                    interrupt = file;\n\t                    file = null;\n\t                }\n\t\n\t                if ( me.runing === false ) {\n\t                    return;\n\t                }\n\t\n\t                // 如果只是暂停某个文件。\n\t                if ( file ) {\n\t                    file = file.id ? file : me.request( 'get-file', file );\n\t\n\t                    if ( file.getStatus() !== Status.PROGRESS &&\n\t                            file.getStatus() !== Status.QUEUED ) {\n\t                        return;\n\t                    }\n\t\n\t                    file.setStatus( Status.INTERRUPT );\n\t                    $.each( me.pool, function( _, v ) {\n\t\n\t                        // 只 abort 指定的文件。\n\t                        if (v.file !== file) {\n\t                            return;\n\t                        }\n\t\n\t                        v.transport && v.transport.abort();\n\t                        me._putback(v);\n\t                        me._popBlock(v);\n\t                    });\n\t\n\t                    return Base.nextTick( me.__tick );\n\t                }\n\t\n\t                me.runing = false;\n\t\n\t                if (this._promise && this._promise.file) {\n\t                    this._promise.file.setStatus( Status.INTERRUPT );\n\t                }\n\t\n\t                interrupt && $.each( me.pool, function( _, v ) {\n\t                    v.transport && v.transport.abort();\n\t                    v.file.setStatus( Status.INTERRUPT );\n\t                });\n\t\n\t                me.owner.trigger('stopUpload');\n\t            },\n\t\n\t            /**\n\t             * @method cancelFile\n\t             * @grammar cancelFile( file ) => undefined\n\t             * @grammar cancelFile( id ) => undefined\n\t             * @param {File|id} file File对象或这File对象的id\n\t             * @description 标记文件状态为已取消, 同时将中断文件传输。\n\t             * @for  Uploader\n\t             * @example\n\t             *\n\t             * $li.on('click', '.remove-this', function() {\n\t             *     uploader.cancelFile( file );\n\t             * })\n\t             */\n\t            cancelFile: function( file ) {\n\t                file = file.id ? file : this.request( 'get-file', file );\n\t\n\t                // 如果正在上传。\n\t                file.blocks && $.each( file.blocks, function( _, v ) {\n\t                    var _tr = v.transport;\n\t\n\t                    if ( _tr ) {\n\t                        _tr.abort();\n\t                        _tr.destroy();\n\t                        delete v.transport;\n\t                    }\n\t                });\n\t\n\t                file.setStatus( Status.CANCELLED );\n\t                this.owner.trigger( 'fileDequeued', file );\n\t            },\n\t\n\t            /**\n\t             * 判断`Uplaode`r是否正在上传中。\n\t             * @grammar isInProgress() => Boolean\n\t             * @method isInProgress\n\t             * @for  Uploader\n\t             */\n\t            isInProgress: function() {\n\t                return !!this.progress;\n\t            },\n\t\n\t            _getStats: function() {\n\t                return this.request('get-stats');\n\t            },\n\t\n\t            /**\n\t             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n\t             * @grammar skipFile( file ) => undefined\n\t             * @method skipFile\n\t             * @for  Uploader\n\t             */\n\t            skipFile: function( file, status ) {\n\t                file = file.id ? file : this.request( 'get-file', file );\n\t\n\t                file.setStatus( status || Status.COMPLETE );\n\t                file.skipped = true;\n\t\n\t                // 如果正在上传。\n\t                file.blocks && $.each( file.blocks, function( _, v ) {\n\t                    var _tr = v.transport;\n\t\n\t                    if ( _tr ) {\n\t                        _tr.abort();\n\t                        _tr.destroy();\n\t                        delete v.transport;\n\t                    }\n\t                });\n\t\n\t                this.owner.trigger( 'uploadSkip', file );\n\t            },\n\t\n\t            /**\n\t             * @event uploadFinished\n\t             * @description 当所有文件上传结束时触发。\n\t             * @for  Uploader\n\t             */\n\t            _tick: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    fn, val;\n\t\n\t                // 上一个promise还没有结束，则等待完成后再执行。\n\t                if ( me._promise ) {\n\t                    return me._promise.always( me.__tick );\n\t                }\n\t\n\t                // 还有位置，且还有文件要处理的话。\n\t                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n\t                    me._trigged = false;\n\t\n\t                    fn = function( val ) {\n\t                        me._promise = null;\n\t\n\t                        // 有可能是reject过来的，所以要检测val的类型。\n\t                        val && val.file && me._startSend( val );\n\t                        Base.nextTick( me.__tick );\n\t                    };\n\t\n\t                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n\t\n\t                // 没有要上传的了，且没有正在传输的了。\n\t                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n\t                    !me._getStats().numofInterrupt ) {\n\t                    me.runing = false;\n\t\n\t                    me._trigged || Base.nextTick(function() {\n\t                        me.owner.trigger('uploadFinished');\n\t                    });\n\t                    me._trigged = true;\n\t                }\n\t            },\n\t\n\t            _putback: function(block) {\n\t                var idx;\n\t\n\t                block.cuted.unshift(block);\n\t                idx = this.stack.indexOf(block.cuted);\n\t\n\t                if (!~idx) {\n\t                    this.stack.unshift(block.cuted);\n\t                }\n\t            },\n\t\n\t            _getStack: function() {\n\t                var i = 0,\n\t                    act;\n\t\n\t                while ( (act = this.stack[ i++ ]) ) {\n\t                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n\t                        return act;\n\t                    } else if (!act.has() ||\n\t                            act.file.getStatus() !== Status.PROGRESS &&\n\t                            act.file.getStatus() !== Status.INTERRUPT ) {\n\t\n\t                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n\t                        // interupt（暂停中） 的移除。\n\t                        this.stack.splice( --i, 1 );\n\t                    }\n\t                }\n\t\n\t                return null;\n\t            },\n\t\n\t            _nextBlock: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    act, next, done, preparing;\n\t\n\t                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n\t                if ( (act = this._getStack()) ) {\n\t\n\t                    // 是否提前准备下一个文件\n\t                    if ( opts.prepareNextFile && !me.pending.length ) {\n\t                        me._prepareNextFile();\n\t                    }\n\t\n\t                    return act.shift();\n\t\n\t                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n\t                } else if ( me.runing ) {\n\t\n\t                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n\t                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n\t                        me._prepareNextFile();\n\t                    }\n\t\n\t                    next = me.pending.shift();\n\t                    done = function( file ) {\n\t                        if ( !file ) {\n\t                            return null;\n\t                        }\n\t\n\t                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n\t                        me.stack.push(act);\n\t                        return act.shift();\n\t                    };\n\t\n\t                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n\t                    if ( isPromise( next) ) {\n\t                        preparing = next.file;\n\t                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n\t                        next.file = preparing;\n\t                        return next;\n\t                    }\n\t\n\t                    return done( next );\n\t                }\n\t            },\n\t\n\t\n\t            /**\n\t             * @event uploadStart\n\t             * @param {File} file File对象\n\t             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n\t             * @for  Uploader\n\t             */\n\t            _prepareNextFile: function() {\n\t                var me = this,\n\t                    file = me.request('fetch-file'),\n\t                    pending = me.pending,\n\t                    promise;\n\t\n\t                if ( file ) {\n\t                    promise = me.request( 'before-send-file', file, function() {\n\t\n\t                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n\t                        if ( file.getStatus() === Status.PROGRESS ||\n\t                            file.getStatus() === Status.INTERRUPT ) {\n\t                            return file;\n\t                        }\n\t\n\t                        return me._finishFile( file );\n\t                    });\n\t\n\t                    me.owner.trigger( 'uploadStart', file );\n\t                    file.setStatus( Status.PROGRESS );\n\t\n\t                    promise.file = file;\n\t\n\t                    // 如果还在pending中，则替换成文件本身。\n\t                    promise.done(function() {\n\t                        var idx = $.inArray( promise, pending );\n\t\n\t                        ~idx && pending.splice( idx, 1, file );\n\t                    });\n\t\n\t                    // befeore-send-file的钩子就有错误发生。\n\t                    promise.fail(function( reason ) {\n\t                        file.setStatus( Status.ERROR, reason );\n\t                        me.owner.trigger( 'uploadError', file, reason );\n\t                        me.owner.trigger( 'uploadComplete', file );\n\t                    });\n\t\n\t                    pending.push( promise );\n\t                }\n\t            },\n\t\n\t            // 让出位置了，可以让其他分片开始上传\n\t            _popBlock: function( block ) {\n\t                var idx = $.inArray( block, this.pool );\n\t\n\t                this.pool.splice( idx, 1 );\n\t                block.file.remaning--;\n\t                this.remaning--;\n\t            },\n\t\n\t            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n\t            _startSend: function( block ) {\n\t                var me = this,\n\t                    file = block.file,\n\t                    promise;\n\t\n\t                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n\t                // 如：暂停，取消\n\t                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n\t                if ( file.getStatus() !== Status.PROGRESS ) {\n\t\n\t                    // 如果是中断，则还需要放回去。\n\t                    if (file.getStatus() === Status.INTERRUPT) {\n\t                        me._putback(block);\n\t                    }\n\t\n\t                    return;\n\t                }\n\t\n\t                me.pool.push( block );\n\t                me.remaning++;\n\t\n\t                // 如果没有分片，则直接使用原始的。\n\t                // 不会丢失content-type信息。\n\t                block.blob = block.chunks === 1 ? file.source :\n\t                        file.source.slice( block.start, block.end );\n\t\n\t                // hook, 每个分片发送之前可能要做些异步的事情。\n\t                promise = me.request( 'before-send', block, function() {\n\t\n\t                    // 有可能文件已经上传出错了，所以不需要再传输了。\n\t                    if ( file.getStatus() === Status.PROGRESS ) {\n\t                        me._doSend( block );\n\t                    } else {\n\t                        me._popBlock( block );\n\t                        Base.nextTick( me.__tick );\n\t                    }\n\t                });\n\t\n\t                // 如果为fail了，则跳过此分片。\n\t                promise.fail(function() {\n\t                    if ( file.remaning === 1 ) {\n\t                        me._finishFile( file ).always(function() {\n\t                            block.percentage = 1;\n\t                            me._popBlock( block );\n\t                            me.owner.trigger( 'uploadComplete', file );\n\t                            Base.nextTick( me.__tick );\n\t                        });\n\t                    } else {\n\t                        block.percentage = 1;\n\t                        me.updateFileProgress( file );\n\t                        me._popBlock( block );\n\t                        Base.nextTick( me.__tick );\n\t                    }\n\t                });\n\t            },\n\t\n\t\n\t            /**\n\t             * @event uploadBeforeSend\n\t             * @param {Object} object\n\t             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n\t             * @param {Object} headers 可以扩展此对象来控制上传头部。\n\t             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadAccept\n\t             * @param {Object} object\n\t             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n\t             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadProgress\n\t             * @param {File} file File对象\n\t             * @param {Number} percentage 上传进度\n\t             * @description 上传过程中触发，携带上传进度。\n\t             * @for  Uploader\n\t             */\n\t\n\t\n\t            /**\n\t             * @event uploadError\n\t             * @param {File} file File对象\n\t             * @param {String} reason 出错的code\n\t             * @description 当文件上传出错时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadSuccess\n\t             * @param {File} file File对象\n\t             * @param {Object} response 服务端返回的数据\n\t             * @description 当文件上传成功时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadComplete\n\t             * @param {File} [file] File对象\n\t             * @description 不管成功或者失败，文件上传完成时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            // 做上传操作。\n\t            _doSend: function( block ) {\n\t                var me = this,\n\t                    owner = me.owner,\n\t                    opts = me.options,\n\t                    file = block.file,\n\t                    tr = new Transport( opts ),\n\t                    data = $.extend({}, opts.formData ),\n\t                    headers = $.extend({}, opts.headers ),\n\t                    requestAccept, ret;\n\t\n\t                block.transport = tr;\n\t\n\t                tr.on( 'destroy', function() {\n\t                    delete block.transport;\n\t                    me._popBlock( block );\n\t                    Base.nextTick( me.__tick );\n\t                });\n\t\n\t                // 广播上传进度。以文件为单位。\n\t                tr.on( 'progress', function( percentage ) {\n\t                    block.percentage = percentage;\n\t                    me.updateFileProgress( file );\n\t                });\n\t\n\t                // 用来询问，是否返回的结果是有错误的。\n\t                requestAccept = function( reject ) {\n\t                    var fn;\n\t\n\t                    ret = tr.getResponseAsJson() || {};\n\t                    ret._raw = tr.getResponse();\n\t                    fn = function( value ) {\n\t                        reject = value;\n\t                    };\n\t\n\t                    // 服务端响应了，不代表成功了，询问是否响应正确。\n\t                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n\t                        reject = reject || 'server';\n\t                    }\n\t\n\t                    return reject;\n\t                };\n\t\n\t                // 尝试重试，然后广播文件上传出错。\n\t                tr.on( 'error', function( type, flag ) {\n\t                    block.retried = block.retried || 0;\n\t\n\t                    // 自动重试\n\t                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n\t                            block.retried < opts.chunkRetry ) {\n\t\n\t                        block.retried++;\n\t                        tr.send();\n\t\n\t                    } else {\n\t\n\t                        // http status 500 ~ 600\n\t                        if ( !flag && type === 'server' ) {\n\t                            type = requestAccept( type );\n\t                        }\n\t\n\t                        file.setStatus( Status.ERROR, type );\n\t                        owner.trigger( 'uploadError', file, type );\n\t                        owner.trigger( 'uploadComplete', file );\n\t                    }\n\t                });\n\t\n\t                // 上传成功\n\t                tr.on( 'load', function() {\n\t                    var reason;\n\t\n\t                    // 如果非预期，转向上传出错。\n\t                    if ( (reason = requestAccept()) ) {\n\t                        tr.trigger( 'error', reason, true );\n\t                        return;\n\t                    }\n\t\n\t                    // 全部上传完成。\n\t                    if ( file.remaning === 1 ) {\n\t                        me._finishFile( file, ret );\n\t                    } else {\n\t                        tr.destroy();\n\t                    }\n\t                });\n\t\n\t                // 配置默认的上传字段。\n\t                data = $.extend( data, {\n\t                    id: file.id,\n\t                    name: file.name,\n\t                    type: file.type,\n\t                    lastModifiedDate: file.lastModifiedDate,\n\t                    size: file.size\n\t                });\n\t\n\t                block.chunks > 1 && $.extend( data, {\n\t                    chunks: block.chunks,\n\t                    chunk: block.chunk\n\t                });\n\t\n\t                // 在发送之间可以添加字段什么的。。。\n\t                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n\t                owner.trigger( 'uploadBeforeSend', block, data, headers );\n\t\n\t                // 开始发送。\n\t                tr.appendBlob( opts.fileVal, block.blob, file.name );\n\t                tr.append( data );\n\t                tr.setRequestHeader( headers );\n\t                tr.send();\n\t            },\n\t\n\t            // 完成上传。\n\t            _finishFile: function( file, ret, hds ) {\n\t                var owner = this.owner;\n\t\n\t                return owner\n\t                        .request( 'after-send-file', arguments, function() {\n\t                            file.setStatus( Status.COMPLETE );\n\t                            owner.trigger( 'uploadSuccess', file, ret, hds );\n\t                        })\n\t                        .fail(function( reason ) {\n\t\n\t                            // 如果外部已经标记为invalid什么的，不再改状态。\n\t                            if ( file.getStatus() === Status.PROGRESS ) {\n\t                                file.setStatus( Status.ERROR, reason );\n\t                            }\n\t\n\t                            owner.trigger( 'uploadError', file, reason );\n\t                        })\n\t                        .always(function() {\n\t                            owner.trigger( 'uploadComplete', file );\n\t                        });\n\t            },\n\t\n\t            updateFileProgress: function(file) {\n\t                var totalPercent = 0,\n\t                    uploaded = 0;\n\t\n\t                if (!file.blocks) {\n\t                    return;\n\t                }\n\t\n\t                $.each( file.blocks, function( _, v ) {\n\t                    uploaded += (v.percentage || 0) * (v.end - v.start);\n\t                });\n\t\n\t                totalPercent = uploaded / file.size;\n\t                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n\t            }\n\t\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n\t     */\n\t\n\t    define('widgets/validator',[\n\t        'base',\n\t        'uploader',\n\t        'file',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, WUFile ) {\n\t\n\t        var $ = Base.$,\n\t            validators = {},\n\t            api;\n\t\n\t        /**\n\t         * @event error\n\t         * @param {String} type 错误类型。\n\t         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n\t         *\n\t         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n\t         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n\t         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n\t         * @for  Uploader\n\t         */\n\t\n\t        // 暴露给外面的api\n\t        api = {\n\t\n\t            // 添加验证器\n\t            addValidator: function( type, cb ) {\n\t                validators[ type ] = cb;\n\t            },\n\t\n\t            // 移除验证器\n\t            removeValidator: function( type ) {\n\t                delete validators[ type ];\n\t            }\n\t        };\n\t\n\t        // 在Uploader初始化的时候启动Validators的初始化\n\t        Uploader.register({\n\t            name: 'validator',\n\t\n\t            init: function() {\n\t                var me = this;\n\t                Base.nextTick(function() {\n\t                    $.each( validators, function() {\n\t                        this.call( me.owner );\n\t                    });\n\t                });\n\t            }\n\t        });\n\t\n\t        /**\n\t         * @property {int} [fileNumLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证文件总数量, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileNumLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                count = 0,\n\t                max = parseInt( opts.fileNumLimit, 10 ),\n\t                flag = true;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t\n\t                if ( count >= max && flag ) {\n\t                    flag = false;\n\t                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n\t                    setTimeout(function() {\n\t                        flag = true;\n\t                    }, 1 );\n\t                }\n\t\n\t                return count >= max ? false : true;\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function() {\n\t                count++;\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function() {\n\t                count--;\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                count = 0;\n\t            });\n\t        });\n\t\n\t\n\t        /**\n\t         * @property {int} [fileSizeLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileSizeLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                count = 0,\n\t                max = parseInt( opts.fileSizeLimit, 10 ),\n\t                flag = true;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t                var invalid = count + file.size > max;\n\t\n\t                if ( invalid && flag ) {\n\t                    flag = false;\n\t                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n\t                    setTimeout(function() {\n\t                        flag = true;\n\t                    }, 1 );\n\t                }\n\t\n\t                return invalid ? false : true;\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function( file ) {\n\t                count += file.size;\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function( file ) {\n\t                count -= file.size;\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                count = 0;\n\t            });\n\t        });\n\t\n\t        /**\n\t         * @property {int} [fileSingleSizeLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileSingleSizeLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                max = opts.fileSingleSizeLimit;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t\n\t                if ( file.size > max ) {\n\t                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n\t                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n\t                    return false;\n\t                }\n\t\n\t            });\n\t\n\t        });\n\t\n\t        /**\n\t         * @property {Boolean} [duplicate=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n\t         */\n\t        api.addValidator( 'duplicate', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                mapping = {};\n\t\n\t            if ( opts.duplicate ) {\n\t                return;\n\t            }\n\t\n\t            function hashString( str ) {\n\t                var hash = 0,\n\t                    i = 0,\n\t                    len = str.length,\n\t                    _char;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    _char = str.charCodeAt( i );\n\t                    hash = _char + (hash << 6) + (hash << 16) - hash;\n\t                }\n\t\n\t                return hash;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t                var hash = file.__hash || (file.__hash = hashString( file.name +\n\t                        file.size + file.lastModifiedDate ));\n\t\n\t                // 已经重复了\n\t                if ( mapping[ hash ] ) {\n\t                    this.trigger( 'error', 'F_DUPLICATE', file );\n\t                    return false;\n\t                }\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function( file ) {\n\t                var hash = file.__hash;\n\t\n\t                hash && (mapping[ hash ] = true);\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function( file ) {\n\t                var hash = file.__hash;\n\t\n\t                hash && (delete mapping[ hash ]);\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                mapping = {};\n\t            });\n\t        });\n\t\n\t        return api;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview Md5\n\t     */\n\t    define('lib/md5',[\n\t        'runtime/client',\n\t        'mediator'\n\t    ], function( RuntimeClient, Mediator ) {\n\t\n\t        function Md5() {\n\t            RuntimeClient.call( this, 'Md5' );\n\t        }\n\t\n\t        // 让 Md5 具备事件功能。\n\t        Mediator.installTo( Md5.prototype );\n\t\n\t        Md5.prototype.loadFromBlob = function( blob ) {\n\t            var me = this;\n\t\n\t            if ( me.getRuid() ) {\n\t                me.disconnectRuntime();\n\t            }\n\t\n\t            // 连接到blob归属的同一个runtime.\n\t            me.connectRuntime( blob.ruid, function() {\n\t                me.exec('init');\n\t                me.exec( 'loadFromBlob', blob );\n\t            });\n\t        };\n\t\n\t        Md5.prototype.getResult = function() {\n\t            return this.exec('getResult');\n\t        };\n\t\n\t        return Md5;\n\t    });\n\t    /**\n\t     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n\t     */\n\t    define('widgets/md5',[\n\t        'base',\n\t        'uploader',\n\t        'lib/md5',\n\t        'lib/blob',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Md5, Blob ) {\n\t\n\t        return Uploader.register({\n\t            name: 'md5',\n\t\n\t\n\t            /**\n\t             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n\t             *\n\t             *\n\t             * @method md5File\n\t             * @grammar md5File( file[, start[, end]] ) => promise\n\t             * @for Uploader\n\t             * @example\n\t             *\n\t             * uploader.on( 'fileQueued', function( file ) {\n\t             *     var $li = ...;\n\t             *\n\t             *     uploader.md5File( file )\n\t             *\n\t             *         // 及时显示进度\n\t             *         .progress(function(percentage) {\n\t             *             console.log('Percentage:', percentage);\n\t             *         })\n\t             *\n\t             *         // 完成\n\t             *         .then(function(val) {\n\t             *             console.log('md5 result:', val);\n\t             *         });\n\t             *\n\t             * });\n\t             */\n\t            md5File: function( file, start, end ) {\n\t                var md5 = new Md5(),\n\t                    deferred = Base.Deferred(),\n\t                    blob = (file instanceof Blob) ? file :\n\t                        this.request( 'get-file', file ).source;\n\t\n\t                md5.on( 'progress load', function( e ) {\n\t                    e = e || {};\n\t                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n\t                });\n\t\n\t                md5.on( 'complete', function() {\n\t                    deferred.resolve( md5.getResult() );\n\t                });\n\t\n\t                md5.on( 'error', function( reason ) {\n\t                    deferred.reject( reason );\n\t                });\n\t\n\t                if ( arguments.length > 1 ) {\n\t                    start = start || 0;\n\t                    end = end || 0;\n\t                    start < 0 && (start = blob.size + start);\n\t                    end < 0 && (end = blob.size + end);\n\t                    end = Math.min( end, blob.size );\n\t                    blob = blob.slice( start, end );\n\t                }\n\t\n\t                md5.loadFromBlob( blob );\n\t\n\t                return deferred.promise();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/compbase',[],function() {\n\t\n\t        function CompBase( owner, runtime ) {\n\t\n\t            this.owner = owner;\n\t            this.options = owner.options;\n\t\n\t            this.getRuntime = function() {\n\t                return runtime;\n\t            };\n\t\n\t            this.getRuid = function() {\n\t                return runtime.uid;\n\t            };\n\t\n\t            this.trigger = function() {\n\t                return owner.trigger.apply( owner, arguments );\n\t            };\n\t        }\n\t\n\t        return CompBase;\n\t    });\n\t    /**\n\t     * @fileOverview Html5Runtime\n\t     */\n\t    define('runtime/html5/runtime',[\n\t        'base',\n\t        'runtime/runtime',\n\t        'runtime/compbase'\n\t    ], function( Base, Runtime, CompBase ) {\n\t\n\t        var type = 'html5',\n\t            components = {};\n\t\n\t        function Html5Runtime() {\n\t            var pool = {},\n\t                me = this,\n\t                destroy = this.destroy;\n\t\n\t            Runtime.apply( me, arguments );\n\t            me.type = type;\n\t\n\t\n\t            // 这个方法的调用者，实际上是RuntimeClient\n\t            me.exec = function( comp, fn/*, args...*/) {\n\t                var client = this,\n\t                    uid = client.uid,\n\t                    args = Base.slice( arguments, 2 ),\n\t                    instance;\n\t\n\t                if ( components[ comp ] ) {\n\t                    instance = pool[ uid ] = pool[ uid ] ||\n\t                            new components[ comp ]( client, me );\n\t\n\t                    if ( instance[ fn ] ) {\n\t                        return instance[ fn ].apply( instance, args );\n\t                    }\n\t                }\n\t            };\n\t\n\t            me.destroy = function() {\n\t                // @todo 删除池子中的所有实例\n\t                return destroy && destroy.apply( this, arguments );\n\t            };\n\t        }\n\t\n\t        Base.inherits( Runtime, {\n\t            constructor: Html5Runtime,\n\t\n\t            // 不需要连接其他程序，直接执行callback\n\t            init: function() {\n\t                var me = this;\n\t                setTimeout(function() {\n\t                    me.trigger('ready');\n\t                }, 1 );\n\t            }\n\t\n\t        });\n\t\n\t        // 注册Components\n\t        Html5Runtime.register = function( name, component ) {\n\t            var klass = components[ name ] = Base.inherits( CompBase, component );\n\t            return klass;\n\t        };\n\t\n\t        // 注册html5运行时。\n\t        // 只有在支持的前提下注册。\n\t        if ( window.Blob && window.FileReader && window.DataView ) {\n\t            Runtime.addRuntime( type, Html5Runtime );\n\t        }\n\t\n\t        return Html5Runtime;\n\t    });\n\t    /**\n\t     * @fileOverview Blob Html实现\n\t     */\n\t    define('runtime/html5/blob',[\n\t        'runtime/html5/runtime',\n\t        'lib/blob'\n\t    ], function( Html5Runtime, Blob ) {\n\t\n\t        return Html5Runtime.register( 'Blob', {\n\t            slice: function( start, end ) {\n\t                var blob = this.owner.source,\n\t                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n\t\n\t                blob = slice.call( blob, start, end );\n\t\n\t                return new Blob( this.getRuid(), blob );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview FilePaste\n\t     */\n\t    define('runtime/html5/dnd',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'lib/file'\n\t    ], function( Base, Html5Runtime, File ) {\n\t\n\t        var $ = Base.$,\n\t            prefix = 'webuploader-dnd-';\n\t\n\t        return Html5Runtime.register( 'DragAndDrop', {\n\t            init: function() {\n\t                var elem = this.elem = this.options.container;\n\t\n\t                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n\t                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n\t                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n\t                this.dropHandler = Base.bindFn( this._dropHandler, this );\n\t                this.dndOver = false;\n\t\n\t                elem.on( 'dragenter', this.dragEnterHandler );\n\t                elem.on( 'dragover', this.dragOverHandler );\n\t                elem.on( 'dragleave', this.dragLeaveHandler );\n\t                elem.on( 'drop', this.dropHandler );\n\t\n\t                if ( this.options.disableGlobalDnd ) {\n\t                    $( document ).on( 'dragover', this.dragOverHandler );\n\t                    $( document ).on( 'drop', this.dropHandler );\n\t                }\n\t            },\n\t\n\t            _dragEnterHandler: function( e ) {\n\t                var me = this,\n\t                    denied = me._denied || false,\n\t                    items;\n\t\n\t                e = e.originalEvent || e;\n\t\n\t                if ( !me.dndOver ) {\n\t                    me.dndOver = true;\n\t\n\t                    // 注意只有 chrome 支持。\n\t                    items = e.dataTransfer.items;\n\t\n\t                    if ( items && items.length ) {\n\t                        me._denied = denied = !me.trigger( 'accept', items );\n\t                    }\n\t\n\t                    me.elem.addClass( prefix + 'over' );\n\t                    me.elem[ denied ? 'addClass' :\n\t                            'removeClass' ]( prefix + 'denied' );\n\t                }\n\t\n\t                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n\t\n\t                return false;\n\t            },\n\t\n\t            _dragOverHandler: function( e ) {\n\t                // 只处理框内的。\n\t                var parentElem = this.elem.parent().get( 0 );\n\t                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n\t                    return false;\n\t                }\n\t\n\t                clearTimeout( this._leaveTimer );\n\t                this._dragEnterHandler.call( this, e );\n\t\n\t                return false;\n\t            },\n\t\n\t            _dragLeaveHandler: function() {\n\t                var me = this,\n\t                    handler;\n\t\n\t                handler = function() {\n\t                    me.dndOver = false;\n\t                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n\t                };\n\t\n\t                clearTimeout( me._leaveTimer );\n\t                me._leaveTimer = setTimeout( handler, 100 );\n\t                return false;\n\t            },\n\t\n\t            _dropHandler: function( e ) {\n\t                var me = this,\n\t                    ruid = me.getRuid(),\n\t                    parentElem = me.elem.parent().get( 0 ),\n\t                    dataTransfer, data;\n\t\n\t                // 只处理框内的。\n\t                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n\t                    return false;\n\t                }\n\t\n\t                e = e.originalEvent || e;\n\t                dataTransfer = e.dataTransfer;\n\t\n\t                // 如果是页面内拖拽，还不能处理，不阻止事件。\n\t                // 此处 ie11 下会报参数错误，\n\t                try {\n\t                    data = dataTransfer.getData('text/html');\n\t                } catch( err ) {\n\t                }\n\t\n\t                if ( data ) {\n\t                    return;\n\t                }\n\t\n\t                me._getTansferFiles( dataTransfer, function( results ) {\n\t                    me.trigger( 'drop', $.map( results, function( file ) {\n\t                        return new File( ruid, file );\n\t                    }) );\n\t                });\n\t\n\t                me.dndOver = false;\n\t                me.elem.removeClass( prefix + 'over' );\n\t                return false;\n\t            },\n\t\n\t            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n\t            _getTansferFiles: function( dataTransfer, callback ) {\n\t                var results  = [],\n\t                    promises = [],\n\t                    items, files, file, item, i, len, canAccessFolder;\n\t\n\t                items = dataTransfer.items;\n\t                files = dataTransfer.files;\n\t\n\t                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n\t\n\t                for ( i = 0, len = files.length; i < len; i++ ) {\n\t                    file = files[ i ];\n\t                    item = items && items[ i ];\n\t\n\t                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n\t\n\t                        promises.push( this._traverseDirectoryTree(\n\t                                item.webkitGetAsEntry(), results ) );\n\t                    } else {\n\t                        results.push( file );\n\t                    }\n\t                }\n\t\n\t                Base.when.apply( Base, promises ).done(function() {\n\t\n\t                    if ( !results.length ) {\n\t                        return;\n\t                    }\n\t\n\t                    callback( results );\n\t                });\n\t            },\n\t\n\t            _traverseDirectoryTree: function( entry, results ) {\n\t                var deferred = Base.Deferred(),\n\t                    me = this;\n\t\n\t                if ( entry.isFile ) {\n\t                    entry.file(function( file ) {\n\t                        results.push( file );\n\t                        deferred.resolve();\n\t                    });\n\t                } else if ( entry.isDirectory ) {\n\t                    entry.createReader().readEntries(function( entries ) {\n\t                        var len = entries.length,\n\t                            promises = [],\n\t                            arr = [],    // 为了保证顺序。\n\t                            i;\n\t\n\t                        for ( i = 0; i < len; i++ ) {\n\t                            promises.push( me._traverseDirectoryTree(\n\t                                    entries[ i ], arr ) );\n\t                        }\n\t\n\t                        Base.when.apply( Base, promises ).then(function() {\n\t                            results.push.apply( results, arr );\n\t                            deferred.resolve();\n\t                        }, deferred.reject );\n\t                    });\n\t                }\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                var elem = this.elem;\n\t\n\t                // 还没 init 就调用 destroy\n\t                if (!elem) {\n\t                    return;\n\t                }\n\t\n\t                elem.off( 'dragenter', this.dragEnterHandler );\n\t                elem.off( 'dragover', this.dragOverHandler );\n\t                elem.off( 'dragleave', this.dragLeaveHandler );\n\t                elem.off( 'drop', this.dropHandler );\n\t\n\t                if ( this.options.disableGlobalDnd ) {\n\t                    $( document ).off( 'dragover', this.dragOverHandler );\n\t                    $( document ).off( 'drop', this.dropHandler );\n\t                }\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview FilePaste\n\t     */\n\t    define('runtime/html5/filepaste',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'lib/file'\n\t    ], function( Base, Html5Runtime, File ) {\n\t\n\t        return Html5Runtime.register( 'FilePaste', {\n\t            init: function() {\n\t                var opts = this.options,\n\t                    elem = this.elem = opts.container,\n\t                    accept = '.*',\n\t                    arr, i, len, item;\n\t\n\t                // accetp的mimeTypes中生成匹配正则。\n\t                if ( opts.accept ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        item = opts.accept[ i ].mimeTypes;\n\t                        item && arr.push( item );\n\t                    }\n\t\n\t                    if ( arr.length ) {\n\t                        accept = arr.join(',');\n\t                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n\t                    }\n\t                }\n\t                this.accept = accept = new RegExp( accept, 'i' );\n\t                this.hander = Base.bindFn( this._pasteHander, this );\n\t                elem.on( 'paste', this.hander );\n\t            },\n\t\n\t            _pasteHander: function( e ) {\n\t                var allowed = [],\n\t                    ruid = this.getRuid(),\n\t                    items, item, blob, i, len;\n\t\n\t                e = e.originalEvent || e;\n\t                items = e.clipboardData.items;\n\t\n\t                for ( i = 0, len = items.length; i < len; i++ ) {\n\t                    item = items[ i ];\n\t\n\t                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n\t                        continue;\n\t                    }\n\t\n\t                    allowed.push( new File( ruid, blob ) );\n\t                }\n\t\n\t                if ( allowed.length ) {\n\t                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n\t                    e.preventDefault();\n\t                    e.stopPropagation();\n\t                    this.trigger( 'paste', allowed );\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.elem.off( 'paste', this.hander );\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview FilePicker\n\t     */\n\t    define('runtime/html5/filepicker',[\n\t        'base',\n\t        'runtime/html5/runtime'\n\t    ], function( Base, Html5Runtime ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        return Html5Runtime.register( 'FilePicker', {\n\t            init: function() {\n\t                var container = this.getRuntime().getContainer(),\n\t                    me = this,\n\t                    owner = me.owner,\n\t                    opts = me.options,\n\t                    label = this.label = $( document.createElement('label') ),\n\t                    input =  this.input = $( document.createElement('input') ),\n\t                    arr, i, len, mouseHandler;\n\t\n\t                input.attr( 'type', 'file' );\n\t                //console.log(opts.name)\n\t                input.attr( 'name', 'file' );\n\t                input.addClass('webuploader-element-invisible');\n\t\n\t                label.on( 'click', function() {\n\t                    input.trigger('click');\n\t                });\n\t\n\t                label.css({\n\t                    opacity: 0,\n\t                    width: '100%',\n\t                    height: '100%',\n\t                    display: 'block',\n\t                    cursor: 'pointer',\n\t                    background: '#ffffff'\n\t                });\n\t\n\t                if ( opts.multiple ) {\n\t                    input.attr( 'multiple', 'multiple' );\n\t                }\n\t\n\t                // @todo Firefox不支持单独指定后缀\n\t                if ( opts.accept && opts.accept.length > 0 ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        arr.push( opts.accept[ i ].mimeTypes );\n\t                    }\n\t\n\t                    input.attr( 'accept', arr.join(',') );\n\t                }\n\t\n\t                container.append( input );\n\t                container.append( label );\n\t\n\t                mouseHandler = function( e ) {\n\t                    owner.trigger( e.type );\n\t                };\n\t\n\t                input.on( 'change', function( e ) {\n\t                    var fn = arguments.callee,\n\t                        clone;\n\t\n\t                    me.files = e.target.files;\n\t\n\t                    // reset input\n\t                    clone = this.cloneNode( true );\n\t                    clone.value = null;\n\t                    this.parentNode.replaceChild( clone, this );\n\t\n\t                    input.off();\n\t                    input = $( clone ).on( 'change', fn )\n\t                            .on( 'mouseenter mouseleave', mouseHandler );\n\t\n\t                    owner.trigger('change');\n\t                });\n\t\n\t                label.on( 'mouseenter mouseleave', mouseHandler );\n\t\n\t            },\n\t\n\t\n\t            getFiles: function() {\n\t                return this.files;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.input.off();\n\t                this.label.off();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * Terms:\n\t     *\n\t     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n\t     * @fileOverview Image控件\n\t     */\n\t    define('runtime/html5/util',[\n\t        'base'\n\t    ], function( Base ) {\n\t\n\t        var urlAPI = window.createObjectURL && window ||\n\t                window.URL && URL.revokeObjectURL && URL ||\n\t                window.webkitURL,\n\t            createObjectURL = Base.noop,\n\t            revokeObjectURL = createObjectURL;\n\t\n\t        if ( urlAPI ) {\n\t\n\t            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n\t            createObjectURL = function() {\n\t                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n\t            };\n\t\n\t            revokeObjectURL = function() {\n\t                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n\t            };\n\t        }\n\t\n\t        return {\n\t            createObjectURL: createObjectURL,\n\t            revokeObjectURL: revokeObjectURL,\n\t\n\t            dataURL2Blob: function( dataURI ) {\n\t                var byteStr, intArray, ab, i, mimetype, parts;\n\t\n\t                parts = dataURI.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    byteStr = atob( parts[ 1 ] );\n\t                } else {\n\t                    byteStr = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                ab = new ArrayBuffer( byteStr.length );\n\t                intArray = new Uint8Array( ab );\n\t\n\t                for ( i = 0; i < byteStr.length; i++ ) {\n\t                    intArray[ i ] = byteStr.charCodeAt( i );\n\t                }\n\t\n\t                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n\t\n\t                return this.arrayBufferToBlob( ab, mimetype );\n\t            },\n\t\n\t            dataURL2ArrayBuffer: function( dataURI ) {\n\t                var byteStr, intArray, i, parts;\n\t\n\t                parts = dataURI.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    byteStr = atob( parts[ 1 ] );\n\t                } else {\n\t                    byteStr = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                intArray = new Uint8Array( byteStr.length );\n\t\n\t                for ( i = 0; i < byteStr.length; i++ ) {\n\t                    intArray[ i ] = byteStr.charCodeAt( i );\n\t                }\n\t\n\t                return intArray.buffer;\n\t            },\n\t\n\t            arrayBufferToBlob: function( buffer, type ) {\n\t                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n\t                    bb;\n\t\n\t                // android不支持直接new Blob, 只能借助blobbuilder.\n\t                if ( builder ) {\n\t                    bb = new builder();\n\t                    bb.append( buffer );\n\t                    return bb.getBlob( type );\n\t                }\n\t\n\t                return new Blob([ buffer ], type ? { type: type } : {} );\n\t            },\n\t\n\t            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n\t            // 你得到的结果是png.\n\t            canvasToDataUrl: function( canvas, type, quality ) {\n\t                return canvas.toDataURL( type, quality / 100 );\n\t            },\n\t\n\t            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n\t            parseMeta: function( blob, callback ) {\n\t                callback( false, {});\n\t            },\n\t\n\t            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n\t            updateImageHead: function( data ) {\n\t                return data;\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * Terms:\n\t     *\n\t     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n\t     * @fileOverview Image控件\n\t     */\n\t    define('runtime/html5/imagemeta',[\n\t        'runtime/html5/util'\n\t    ], function( Util ) {\n\t\n\t        var api;\n\t\n\t        api = {\n\t            parsers: {\n\t                0xffe1: []\n\t            },\n\t\n\t            maxMetaDataSize: 262144,\n\t\n\t            parse: function( blob, cb ) {\n\t                var me = this,\n\t                    fr = new FileReader();\n\t\n\t                fr.onload = function() {\n\t                    cb( false, me._parse( this.result ) );\n\t                    fr = fr.onload = fr.onerror = null;\n\t                };\n\t\n\t                fr.onerror = function( e ) {\n\t                    cb( e.message );\n\t                    fr = fr.onload = fr.onerror = null;\n\t                };\n\t\n\t                blob = blob.slice( 0, me.maxMetaDataSize );\n\t                fr.readAsArrayBuffer( blob.getSource() );\n\t            },\n\t\n\t            _parse: function( buffer, noParse ) {\n\t                if ( buffer.byteLength < 6 ) {\n\t                    return;\n\t                }\n\t\n\t                var dataview = new DataView( buffer ),\n\t                    offset = 2,\n\t                    maxOffset = dataview.byteLength - 4,\n\t                    headLength = offset,\n\t                    ret = {},\n\t                    markerBytes, markerLength, parsers, i;\n\t\n\t                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n\t\n\t                    while ( offset < maxOffset ) {\n\t                        markerBytes = dataview.getUint16( offset );\n\t\n\t                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n\t                                markerBytes === 0xfffe ) {\n\t\n\t                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n\t\n\t                            if ( offset + markerLength > dataview.byteLength ) {\n\t                                break;\n\t                            }\n\t\n\t                            parsers = api.parsers[ markerBytes ];\n\t\n\t                            if ( !noParse && parsers ) {\n\t                                for ( i = 0; i < parsers.length; i += 1 ) {\n\t                                    parsers[ i ].call( api, dataview, offset,\n\t                                            markerLength, ret );\n\t                                }\n\t                            }\n\t\n\t                            offset += markerLength;\n\t                            headLength = offset;\n\t                        } else {\n\t                            break;\n\t                        }\n\t                    }\n\t\n\t                    if ( headLength > 6 ) {\n\t                        if ( buffer.slice ) {\n\t                            ret.imageHead = buffer.slice( 2, headLength );\n\t                        } else {\n\t                            // Workaround for IE10, which does not yet\n\t                            // support ArrayBuffer.slice:\n\t                            ret.imageHead = new Uint8Array( buffer )\n\t                                    .subarray( 2, headLength );\n\t                        }\n\t                    }\n\t                }\n\t\n\t                return ret;\n\t            },\n\t\n\t            updateImageHead: function( buffer, head ) {\n\t                var data = this._parse( buffer, true ),\n\t                    buf1, buf2, bodyoffset;\n\t\n\t\n\t                bodyoffset = 2;\n\t                if ( data.imageHead ) {\n\t                    bodyoffset = 2 + data.imageHead.byteLength;\n\t                }\n\t\n\t                if ( buffer.slice ) {\n\t                    buf2 = buffer.slice( bodyoffset );\n\t                } else {\n\t                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n\t                }\n\t\n\t                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n\t\n\t                buf1[ 0 ] = 0xFF;\n\t                buf1[ 1 ] = 0xD8;\n\t                buf1.set( new Uint8Array( head ), 2 );\n\t                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n\t\n\t                return buf1.buffer;\n\t            }\n\t        };\n\t\n\t        Util.parseMeta = function() {\n\t            return api.parse.apply( api, arguments );\n\t        };\n\t\n\t        Util.updateImageHead = function() {\n\t            return api.updateImageHead.apply( api, arguments );\n\t        };\n\t\n\t        return api;\n\t    });\n\t    /**\n\t     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n\t     * 暂时项目中只用了orientation.\n\t     *\n\t     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n\t     * @fileOverview EXIF解析\n\t     */\n\t\n\t    // Sample\n\t    // ====================================\n\t    // Make : Apple\n\t    // Model : iPhone 4S\n\t    // Orientation : 1\n\t    // XResolution : 72 [72/1]\n\t    // YResolution : 72 [72/1]\n\t    // ResolutionUnit : 2\n\t    // Software : QuickTime 7.7.1\n\t    // DateTime : 2013:09:01 22:53:55\n\t    // ExifIFDPointer : 190\n\t    // ExposureTime : 0.058823529411764705 [1/17]\n\t    // FNumber : 2.4 [12/5]\n\t    // ExposureProgram : Normal program\n\t    // ISOSpeedRatings : 800\n\t    // ExifVersion : 0220\n\t    // DateTimeOriginal : 2013:09:01 22:52:51\n\t    // DateTimeDigitized : 2013:09:01 22:52:51\n\t    // ComponentsConfiguration : YCbCr\n\t    // ShutterSpeedValue : 4.058893515764426\n\t    // ApertureValue : 2.5260688216892597 [4845/1918]\n\t    // BrightnessValue : -0.3126686601998395\n\t    // MeteringMode : Pattern\n\t    // Flash : Flash did not fire, compulsory flash mode\n\t    // FocalLength : 4.28 [107/25]\n\t    // SubjectArea : [4 values]\n\t    // FlashpixVersion : 0100\n\t    // ColorSpace : 1\n\t    // PixelXDimension : 2448\n\t    // PixelYDimension : 3264\n\t    // SensingMethod : One-chip color area sensor\n\t    // ExposureMode : 0\n\t    // WhiteBalance : Auto white balance\n\t    // FocalLengthIn35mmFilm : 35\n\t    // SceneCaptureType : Standard\n\t    define('runtime/html5/imagemeta/exif',[\n\t        'base',\n\t        'runtime/html5/imagemeta'\n\t    ], function( Base, ImageMeta ) {\n\t\n\t        var EXIF = {};\n\t\n\t        EXIF.ExifMap = function() {\n\t            return this;\n\t        };\n\t\n\t        EXIF.ExifMap.prototype.map = {\n\t            'Orientation': 0x0112\n\t        };\n\t\n\t        EXIF.ExifMap.prototype.get = function( id ) {\n\t            return this[ id ] || this[ this.map[ id ] ];\n\t        };\n\t\n\t        EXIF.exifTagTypes = {\n\t            // byte, 8-bit unsigned int:\n\t            1: {\n\t                getValue: function( dataView, dataOffset ) {\n\t                    return dataView.getUint8( dataOffset );\n\t                },\n\t                size: 1\n\t            },\n\t\n\t            // ascii, 8-bit byte:\n\t            2: {\n\t                getValue: function( dataView, dataOffset ) {\n\t                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n\t                },\n\t                size: 1,\n\t                ascii: true\n\t            },\n\t\n\t            // short, 16 bit int:\n\t            3: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint16( dataOffset, littleEndian );\n\t                },\n\t                size: 2\n\t            },\n\t\n\t            // long, 32 bit int:\n\t            4: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint32( dataOffset, littleEndian );\n\t                },\n\t                size: 4\n\t            },\n\t\n\t            // rational = two long values,\n\t            // first is numerator, second is denominator:\n\t            5: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint32( dataOffset, littleEndian ) /\n\t                        dataView.getUint32( dataOffset + 4, littleEndian );\n\t                },\n\t                size: 8\n\t            },\n\t\n\t            // slong, 32 bit signed int:\n\t            9: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getInt32( dataOffset, littleEndian );\n\t                },\n\t                size: 4\n\t            },\n\t\n\t            // srational, two slongs, first is numerator, second is denominator:\n\t            10: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getInt32( dataOffset, littleEndian ) /\n\t                        dataView.getInt32( dataOffset + 4, littleEndian );\n\t                },\n\t                size: 8\n\t            }\n\t        };\n\t\n\t        // undefined, 8-bit byte, value depending on field:\n\t        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n\t\n\t        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n\t                littleEndian ) {\n\t\n\t            var tagType = EXIF.exifTagTypes[ type ],\n\t                tagSize, dataOffset, values, i, str, c;\n\t\n\t            if ( !tagType ) {\n\t                Base.log('Invalid Exif data: Invalid tag type.');\n\t                return;\n\t            }\n\t\n\t            tagSize = tagType.size * length;\n\t\n\t            // Determine if the value is contained in the dataOffset bytes,\n\t            // or if the value at the dataOffset is a pointer to the actual data:\n\t            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n\t                    littleEndian ) : (offset + 8);\n\t\n\t            if ( dataOffset + tagSize > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid data offset.');\n\t                return;\n\t            }\n\t\n\t            if ( length === 1 ) {\n\t                return tagType.getValue( dataView, dataOffset, littleEndian );\n\t            }\n\t\n\t            values = [];\n\t\n\t            for ( i = 0; i < length; i += 1 ) {\n\t                values[ i ] = tagType.getValue( dataView,\n\t                        dataOffset + i * tagType.size, littleEndian );\n\t            }\n\t\n\t            if ( tagType.ascii ) {\n\t                str = '';\n\t\n\t                // Concatenate the chars:\n\t                for ( i = 0; i < values.length; i += 1 ) {\n\t                    c = values[ i ];\n\t\n\t                    // Ignore the terminating NULL byte(s):\n\t                    if ( c === '\\u0000' ) {\n\t                        break;\n\t                    }\n\t                    str += c;\n\t                }\n\t\n\t                return str;\n\t            }\n\t            return values;\n\t        };\n\t\n\t        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n\t                data ) {\n\t\n\t            var tag = dataView.getUint16( offset, littleEndian );\n\t            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n\t                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n\t                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n\t                    littleEndian );\n\t        };\n\t\n\t        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n\t                littleEndian, data ) {\n\t\n\t            var tagsNumber, dirEndOffset, i;\n\t\n\t            if ( dirOffset + 6 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid directory offset.');\n\t                return;\n\t            }\n\t\n\t            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n\t            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n\t\n\t            if ( dirEndOffset + 4 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid directory size.');\n\t                return;\n\t            }\n\t\n\t            for ( i = 0; i < tagsNumber; i += 1 ) {\n\t                this.parseExifTag( dataView, tiffOffset,\n\t                        dirOffset + 2 + 12 * i,    // tag offset\n\t                        littleEndian, data );\n\t            }\n\t\n\t            // Return the offset to the next directory:\n\t            return dataView.getUint32( dirEndOffset, littleEndian );\n\t        };\n\t\n\t        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n\t        //     var hexData,\n\t        //         i,\n\t        //         b;\n\t        //     if (!length || offset + length > dataView.byteLength) {\n\t        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n\t        //         return;\n\t        //     }\n\t        //     hexData = [];\n\t        //     for (i = 0; i < length; i += 1) {\n\t        //         b = dataView.getUint8(offset + i);\n\t        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n\t        //     }\n\t        //     return 'data:image/jpeg,%' + hexData.join('%');\n\t        // };\n\t\n\t        EXIF.parseExifData = function( dataView, offset, length, data ) {\n\t\n\t            var tiffOffset = offset + 10,\n\t                littleEndian, dirOffset;\n\t\n\t            // Check for the ASCII code for \"Exif\" (0x45786966):\n\t            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n\t                // No Exif data, might be XMP data instead\n\t                return;\n\t            }\n\t            if ( tiffOffset + 8 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid segment size.');\n\t                return;\n\t            }\n\t\n\t            // Check for the two null bytes:\n\t            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n\t                Base.log('Invalid Exif data: Missing byte alignment offset.');\n\t                return;\n\t            }\n\t\n\t            // Check the byte alignment:\n\t            switch ( dataView.getUint16( tiffOffset ) ) {\n\t                case 0x4949:\n\t                    littleEndian = true;\n\t                    break;\n\t\n\t                case 0x4D4D:\n\t                    littleEndian = false;\n\t                    break;\n\t\n\t                default:\n\t                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n\t                    return;\n\t            }\n\t\n\t            // Check for the TIFF tag marker (0x002A):\n\t            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n\t                Base.log('Invalid Exif data: Missing TIFF marker.');\n\t                return;\n\t            }\n\t\n\t            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n\t            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n\t            // Create the exif object to store the tags:\n\t            data.exif = new EXIF.ExifMap();\n\t            // Parse the tags of the main image directory and retrieve the\n\t            // offset to the next directory, usually the thumbnail directory:\n\t            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n\t                    tiffOffset + dirOffset, littleEndian, data );\n\t\n\t            // 尝试读取缩略图\n\t            // if ( dirOffset ) {\n\t            //     thumbnailData = {exif: {}};\n\t            //     dirOffset = EXIF.parseExifTags(\n\t            //         dataView,\n\t            //         tiffOffset,\n\t            //         tiffOffset + dirOffset,\n\t            //         littleEndian,\n\t            //         thumbnailData\n\t            //     );\n\t\n\t            //     // Check for JPEG Thumbnail offset:\n\t            //     if (thumbnailData.exif[0x0201]) {\n\t            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n\t            //             dataView,\n\t            //             tiffOffset + thumbnailData.exif[0x0201],\n\t            //             thumbnailData.exif[0x0202] // Thumbnail data length\n\t            //         );\n\t            //     }\n\t            // }\n\t        };\n\t\n\t        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n\t        return EXIF;\n\t    });\n\t    /**\n\t     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n\t     * android里面toDataUrl('image/jpege')得到的结果却是png.\n\t     *\n\t     * 所以这里没辙，只能借助这个工具\n\t     * @fileOverview jpeg encoder\n\t     */\n\t    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n\t\n\t        /*\n\t          Copyright (c) 2008, Adobe Systems Incorporated\n\t          All rights reserved.\n\t\n\t          Redistribution and use in source and binary forms, with or without\n\t          modification, are permitted provided that the following conditions are\n\t          met:\n\t\n\t          * Redistributions of source code must retain the above copyright notice,\n\t            this list of conditions and the following disclaimer.\n\t\n\t          * Redistributions in binary form must reproduce the above copyright\n\t            notice, this list of conditions and the following disclaimer in the\n\t            documentation and/or other materials provided with the distribution.\n\t\n\t          * Neither the name of Adobe Systems Incorporated nor the names of its\n\t            contributors may be used to endorse or promote products derived from\n\t            this software without specific prior written permission.\n\t\n\t          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n\t          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n\t          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n\t          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n\t          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n\t          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n\t          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n\t          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n\t          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n\t          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n\t          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\t        */\n\t        /*\n\t        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n\t\n\t        Basic GUI blocking jpeg encoder\n\t        */\n\t\n\t        function JPEGEncoder(quality) {\n\t          var self = this;\n\t            var fround = Math.round;\n\t            var ffloor = Math.floor;\n\t            var YTable = new Array(64);\n\t            var UVTable = new Array(64);\n\t            var fdtbl_Y = new Array(64);\n\t            var fdtbl_UV = new Array(64);\n\t            var YDC_HT;\n\t            var UVDC_HT;\n\t            var YAC_HT;\n\t            var UVAC_HT;\n\t\n\t            var bitcode = new Array(65535);\n\t            var category = new Array(65535);\n\t            var outputfDCTQuant = new Array(64);\n\t            var DU = new Array(64);\n\t            var byteout = [];\n\t            var bytenew = 0;\n\t            var bytepos = 7;\n\t\n\t            var YDU = new Array(64);\n\t            var UDU = new Array(64);\n\t            var VDU = new Array(64);\n\t            var clt = new Array(256);\n\t            var RGB_YUV_TABLE = new Array(2048);\n\t            var currentQuality;\n\t\n\t            var ZigZag = [\n\t                     0, 1, 5, 6,14,15,27,28,\n\t                     2, 4, 7,13,16,26,29,42,\n\t                     3, 8,12,17,25,30,41,43,\n\t                     9,11,18,24,31,40,44,53,\n\t                    10,19,23,32,39,45,52,54,\n\t                    20,22,33,38,46,51,55,60,\n\t                    21,34,37,47,50,56,59,61,\n\t                    35,36,48,49,57,58,62,63\n\t                ];\n\t\n\t            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n\t            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n\t            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n\t            var std_ac_luminance_values = [\n\t                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n\t                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n\t                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n\t                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n\t                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n\t                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n\t                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n\t                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n\t                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n\t                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n\t                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n\t                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n\t                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n\t                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n\t                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n\t                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n\t                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n\t                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n\t                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n\t                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n\t                    0xf9,0xfa\n\t                ];\n\t\n\t            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n\t            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n\t            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n\t            var std_ac_chrominance_values = [\n\t                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n\t                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n\t                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n\t                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n\t                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n\t                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n\t                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n\t                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n\t                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n\t                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n\t                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n\t                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n\t                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n\t                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n\t                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n\t                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n\t                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n\t                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n\t                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n\t                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n\t                    0xf9,0xfa\n\t                ];\n\t\n\t            function initQuantTables(sf){\n\t                    var YQT = [\n\t                        16, 11, 10, 16, 24, 40, 51, 61,\n\t                        12, 12, 14, 19, 26, 58, 60, 55,\n\t                        14, 13, 16, 24, 40, 57, 69, 56,\n\t                        14, 17, 22, 29, 51, 87, 80, 62,\n\t                        18, 22, 37, 56, 68,109,103, 77,\n\t                        24, 35, 55, 64, 81,104,113, 92,\n\t                        49, 64, 78, 87,103,121,120,101,\n\t                        72, 92, 95, 98,112,100,103, 99\n\t                    ];\n\t\n\t                    for (var i = 0; i < 64; i++) {\n\t                        var t = ffloor((YQT[i]*sf+50)/100);\n\t                        if (t < 1) {\n\t                            t = 1;\n\t                        } else if (t > 255) {\n\t                            t = 255;\n\t                        }\n\t                        YTable[ZigZag[i]] = t;\n\t                    }\n\t                    var UVQT = [\n\t                        17, 18, 24, 47, 99, 99, 99, 99,\n\t                        18, 21, 26, 66, 99, 99, 99, 99,\n\t                        24, 26, 56, 99, 99, 99, 99, 99,\n\t                        47, 66, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99\n\t                    ];\n\t                    for (var j = 0; j < 64; j++) {\n\t                        var u = ffloor((UVQT[j]*sf+50)/100);\n\t                        if (u < 1) {\n\t                            u = 1;\n\t                        } else if (u > 255) {\n\t                            u = 255;\n\t                        }\n\t                        UVTable[ZigZag[j]] = u;\n\t                    }\n\t                    var aasf = [\n\t                        1.0, 1.387039845, 1.306562965, 1.175875602,\n\t                        1.0, 0.785694958, 0.541196100, 0.275899379\n\t                    ];\n\t                    var k = 0;\n\t                    for (var row = 0; row < 8; row++)\n\t                    {\n\t                        for (var col = 0; col < 8; col++)\n\t                        {\n\t                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n\t                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n\t                            k++;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                function computeHuffmanTbl(nrcodes, std_table){\n\t                    var codevalue = 0;\n\t                    var pos_in_table = 0;\n\t                    var HT = new Array();\n\t                    for (var k = 1; k <= 16; k++) {\n\t                        for (var j = 1; j <= nrcodes[k]; j++) {\n\t                            HT[std_table[pos_in_table]] = [];\n\t                            HT[std_table[pos_in_table]][0] = codevalue;\n\t                            HT[std_table[pos_in_table]][1] = k;\n\t                            pos_in_table++;\n\t                            codevalue++;\n\t                        }\n\t                        codevalue*=2;\n\t                    }\n\t                    return HT;\n\t                }\n\t\n\t                function initHuffmanTbl()\n\t                {\n\t                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n\t                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n\t                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n\t                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n\t                }\n\t\n\t                function initCategoryNumber()\n\t                {\n\t                    var nrlower = 1;\n\t                    var nrupper = 2;\n\t                    for (var cat = 1; cat <= 15; cat++) {\n\t                        //Positive numbers\n\t                        for (var nr = nrlower; nr<nrupper; nr++) {\n\t                            category[32767+nr] = cat;\n\t                            bitcode[32767+nr] = [];\n\t                            bitcode[32767+nr][1] = cat;\n\t                            bitcode[32767+nr][0] = nr;\n\t                        }\n\t                        //Negative numbers\n\t                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n\t                            category[32767+nrneg] = cat;\n\t                            bitcode[32767+nrneg] = [];\n\t                            bitcode[32767+nrneg][1] = cat;\n\t                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n\t                        }\n\t                        nrlower <<= 1;\n\t                        nrupper <<= 1;\n\t                    }\n\t                }\n\t\n\t                function initRGBYUVTable() {\n\t                    for(var i = 0; i < 256;i++) {\n\t                        RGB_YUV_TABLE[i]            =  19595 * i;\n\t                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n\t                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n\t                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n\t                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n\t                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n\t                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n\t                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n\t                    }\n\t                }\n\t\n\t                // IO functions\n\t                function writeBits(bs)\n\t                {\n\t                    var value = bs[0];\n\t                    var posval = bs[1]-1;\n\t                    while ( posval >= 0 ) {\n\t                        if (value & (1 << posval) ) {\n\t                            bytenew |= (1 << bytepos);\n\t                        }\n\t                        posval--;\n\t                        bytepos--;\n\t                        if (bytepos < 0) {\n\t                            if (bytenew == 0xFF) {\n\t                                writeByte(0xFF);\n\t                                writeByte(0);\n\t                            }\n\t                            else {\n\t                                writeByte(bytenew);\n\t                            }\n\t                            bytepos=7;\n\t                            bytenew=0;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                function writeByte(value)\n\t                {\n\t                    byteout.push(clt[value]); // write char directly instead of converting later\n\t                }\n\t\n\t                function writeWord(value)\n\t                {\n\t                    writeByte((value>>8)&0xFF);\n\t                    writeByte((value   )&0xFF);\n\t                }\n\t\n\t                // DCT & quantization core\n\t                function fDCTQuant(data, fdtbl)\n\t                {\n\t                    var d0, d1, d2, d3, d4, d5, d6, d7;\n\t                    /* Pass 1: process rows. */\n\t                    var dataOff=0;\n\t                    var i;\n\t                    var I8 = 8;\n\t                    var I64 = 64;\n\t                    for (i=0; i<I8; ++i)\n\t                    {\n\t                        d0 = data[dataOff];\n\t                        d1 = data[dataOff+1];\n\t                        d2 = data[dataOff+2];\n\t                        d3 = data[dataOff+3];\n\t                        d4 = data[dataOff+4];\n\t                        d5 = data[dataOff+5];\n\t                        d6 = data[dataOff+6];\n\t                        d7 = data[dataOff+7];\n\t\n\t                        var tmp0 = d0 + d7;\n\t                        var tmp7 = d0 - d7;\n\t                        var tmp1 = d1 + d6;\n\t                        var tmp6 = d1 - d6;\n\t                        var tmp2 = d2 + d5;\n\t                        var tmp5 = d2 - d5;\n\t                        var tmp3 = d3 + d4;\n\t                        var tmp4 = d3 - d4;\n\t\n\t                        /* Even part */\n\t                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n\t                        var tmp13 = tmp0 - tmp3;\n\t                        var tmp11 = tmp1 + tmp2;\n\t                        var tmp12 = tmp1 - tmp2;\n\t\n\t                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n\t                        data[dataOff+4] = tmp10 - tmp11;\n\t\n\t                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n\t                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n\t                        data[dataOff+6] = tmp13 - z1;\n\t\n\t                        /* Odd part */\n\t                        tmp10 = tmp4 + tmp5; /* phase 2 */\n\t                        tmp11 = tmp5 + tmp6;\n\t                        tmp12 = tmp6 + tmp7;\n\t\n\t                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n\t                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n\t                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n\t                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n\t                        var z3 = tmp11 * 0.707106781; /* c4 */\n\t\n\t                        var z11 = tmp7 + z3;    /* phase 5 */\n\t                        var z13 = tmp7 - z3;\n\t\n\t                        data[dataOff+5] = z13 + z2; /* phase 6 */\n\t                        data[dataOff+3] = z13 - z2;\n\t                        data[dataOff+1] = z11 + z4;\n\t                        data[dataOff+7] = z11 - z4;\n\t\n\t                        dataOff += 8; /* advance pointer to next row */\n\t                    }\n\t\n\t                    /* Pass 2: process columns. */\n\t                    dataOff = 0;\n\t                    for (i=0; i<I8; ++i)\n\t                    {\n\t                        d0 = data[dataOff];\n\t                        d1 = data[dataOff + 8];\n\t                        d2 = data[dataOff + 16];\n\t                        d3 = data[dataOff + 24];\n\t                        d4 = data[dataOff + 32];\n\t                        d5 = data[dataOff + 40];\n\t                        d6 = data[dataOff + 48];\n\t                        d7 = data[dataOff + 56];\n\t\n\t                        var tmp0p2 = d0 + d7;\n\t                        var tmp7p2 = d0 - d7;\n\t                        var tmp1p2 = d1 + d6;\n\t                        var tmp6p2 = d1 - d6;\n\t                        var tmp2p2 = d2 + d5;\n\t                        var tmp5p2 = d2 - d5;\n\t                        var tmp3p2 = d3 + d4;\n\t                        var tmp4p2 = d3 - d4;\n\t\n\t                        /* Even part */\n\t                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n\t                        var tmp13p2 = tmp0p2 - tmp3p2;\n\t                        var tmp11p2 = tmp1p2 + tmp2p2;\n\t                        var tmp12p2 = tmp1p2 - tmp2p2;\n\t\n\t                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n\t                        data[dataOff+32] = tmp10p2 - tmp11p2;\n\t\n\t                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n\t                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n\t                        data[dataOff+48] = tmp13p2 - z1p2;\n\t\n\t                        /* Odd part */\n\t                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n\t                        tmp11p2 = tmp5p2 + tmp6p2;\n\t                        tmp12p2 = tmp6p2 + tmp7p2;\n\t\n\t                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n\t                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n\t                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n\t                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n\t                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n\t\n\t                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n\t                        var z13p2 = tmp7p2 - z3p2;\n\t\n\t                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n\t                        data[dataOff+24] = z13p2 - z2p2;\n\t                        data[dataOff+ 8] = z11p2 + z4p2;\n\t                        data[dataOff+56] = z11p2 - z4p2;\n\t\n\t                        dataOff++; /* advance pointer to next column */\n\t                    }\n\t\n\t                    // Quantize/descale the coefficients\n\t                    var fDCTQuant;\n\t                    for (i=0; i<I64; ++i)\n\t                    {\n\t                        // Apply the quantization and scaling factor & Round to nearest integer\n\t                        fDCTQuant = data[i]*fdtbl[i];\n\t                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n\t                        //outputfDCTQuant[i] = fround(fDCTQuant);\n\t\n\t                    }\n\t                    return outputfDCTQuant;\n\t                }\n\t\n\t                function writeAPP0()\n\t                {\n\t                    writeWord(0xFFE0); // marker\n\t                    writeWord(16); // length\n\t                    writeByte(0x4A); // J\n\t                    writeByte(0x46); // F\n\t                    writeByte(0x49); // I\n\t                    writeByte(0x46); // F\n\t                    writeByte(0); // = \"JFIF\",'\\0'\n\t                    writeByte(1); // versionhi\n\t                    writeByte(1); // versionlo\n\t                    writeByte(0); // xyunits\n\t                    writeWord(1); // xdensity\n\t                    writeWord(1); // ydensity\n\t                    writeByte(0); // thumbnwidth\n\t                    writeByte(0); // thumbnheight\n\t                }\n\t\n\t                function writeSOF0(width, height)\n\t                {\n\t                    writeWord(0xFFC0); // marker\n\t                    writeWord(17);   // length, truecolor YUV JPG\n\t                    writeByte(8);    // precision\n\t                    writeWord(height);\n\t                    writeWord(width);\n\t                    writeByte(3);    // nrofcomponents\n\t                    writeByte(1);    // IdY\n\t                    writeByte(0x11); // HVY\n\t                    writeByte(0);    // QTY\n\t                    writeByte(2);    // IdU\n\t                    writeByte(0x11); // HVU\n\t                    writeByte(1);    // QTU\n\t                    writeByte(3);    // IdV\n\t                    writeByte(0x11); // HVV\n\t                    writeByte(1);    // QTV\n\t                }\n\t\n\t                function writeDQT()\n\t                {\n\t                    writeWord(0xFFDB); // marker\n\t                    writeWord(132);    // length\n\t                    writeByte(0);\n\t                    for (var i=0; i<64; i++) {\n\t                        writeByte(YTable[i]);\n\t                    }\n\t                    writeByte(1);\n\t                    for (var j=0; j<64; j++) {\n\t                        writeByte(UVTable[j]);\n\t                    }\n\t                }\n\t\n\t                function writeDHT()\n\t                {\n\t                    writeWord(0xFFC4); // marker\n\t                    writeWord(0x01A2); // length\n\t\n\t                    writeByte(0); // HTYDCinfo\n\t                    for (var i=0; i<16; i++) {\n\t                        writeByte(std_dc_luminance_nrcodes[i+1]);\n\t                    }\n\t                    for (var j=0; j<=11; j++) {\n\t                        writeByte(std_dc_luminance_values[j]);\n\t                    }\n\t\n\t                    writeByte(0x10); // HTYACinfo\n\t                    for (var k=0; k<16; k++) {\n\t                        writeByte(std_ac_luminance_nrcodes[k+1]);\n\t                    }\n\t                    for (var l=0; l<=161; l++) {\n\t                        writeByte(std_ac_luminance_values[l]);\n\t                    }\n\t\n\t                    writeByte(1); // HTUDCinfo\n\t                    for (var m=0; m<16; m++) {\n\t                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n\t                    }\n\t                    for (var n=0; n<=11; n++) {\n\t                        writeByte(std_dc_chrominance_values[n]);\n\t                    }\n\t\n\t                    writeByte(0x11); // HTUACinfo\n\t                    for (var o=0; o<16; o++) {\n\t                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n\t                    }\n\t                    for (var p=0; p<=161; p++) {\n\t                        writeByte(std_ac_chrominance_values[p]);\n\t                    }\n\t                }\n\t\n\t                function writeSOS()\n\t                {\n\t                    writeWord(0xFFDA); // marker\n\t                    writeWord(12); // length\n\t                    writeByte(3); // nrofcomponents\n\t                    writeByte(1); // IdY\n\t                    writeByte(0); // HTY\n\t                    writeByte(2); // IdU\n\t                    writeByte(0x11); // HTU\n\t                    writeByte(3); // IdV\n\t                    writeByte(0x11); // HTV\n\t                    writeByte(0); // Ss\n\t                    writeByte(0x3f); // Se\n\t                    writeByte(0); // Bf\n\t                }\n\t\n\t                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n\t                    var EOB = HTAC[0x00];\n\t                    var M16zeroes = HTAC[0xF0];\n\t                    var pos;\n\t                    var I16 = 16;\n\t                    var I63 = 63;\n\t                    var I64 = 64;\n\t                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n\t                    //ZigZag reorder\n\t                    for (var j=0;j<I64;++j) {\n\t                        DU[ZigZag[j]]=DU_DCT[j];\n\t                    }\n\t                    var Diff = DU[0] - DC; DC = DU[0];\n\t                    //Encode DC\n\t                    if (Diff==0) {\n\t                        writeBits(HTDC[0]); // Diff might be 0\n\t                    } else {\n\t                        pos = 32767+Diff;\n\t                        writeBits(HTDC[category[pos]]);\n\t                        writeBits(bitcode[pos]);\n\t                    }\n\t                    //Encode ACs\n\t                    var end0pos = 63; // was const... which is crazy\n\t                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n\t                    //end0pos = first element in reverse order !=0\n\t                    if ( end0pos == 0) {\n\t                        writeBits(EOB);\n\t                        return DC;\n\t                    }\n\t                    var i = 1;\n\t                    var lng;\n\t                    while ( i <= end0pos ) {\n\t                        var startpos = i;\n\t                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n\t                        var nrzeroes = i-startpos;\n\t                        if ( nrzeroes >= I16 ) {\n\t                            lng = nrzeroes>>4;\n\t                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n\t                                writeBits(M16zeroes);\n\t                            nrzeroes = nrzeroes&0xF;\n\t                        }\n\t                        pos = 32767+DU[i];\n\t                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n\t                        writeBits(bitcode[pos]);\n\t                        i++;\n\t                    }\n\t                    if ( end0pos != I63 ) {\n\t                        writeBits(EOB);\n\t                    }\n\t                    return DC;\n\t                }\n\t\n\t                function initCharLookupTable(){\n\t                    var sfcc = String.fromCharCode;\n\t                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n\t                        clt[i] = sfcc(i);\n\t                    }\n\t                }\n\t\n\t                this.encode = function(image,quality) // image data object\n\t                {\n\t                    // var time_start = new Date().getTime();\n\t\n\t                    if(quality) setQuality(quality);\n\t\n\t                    // Initialize bit writer\n\t                    byteout = new Array();\n\t                    bytenew=0;\n\t                    bytepos=7;\n\t\n\t                    // Add JPEG headers\n\t                    writeWord(0xFFD8); // SOI\n\t                    writeAPP0();\n\t                    writeDQT();\n\t                    writeSOF0(image.width,image.height);\n\t                    writeDHT();\n\t                    writeSOS();\n\t\n\t\n\t                    // Encode 8x8 macroblocks\n\t                    var DCY=0;\n\t                    var DCU=0;\n\t                    var DCV=0;\n\t\n\t                    bytenew=0;\n\t                    bytepos=7;\n\t\n\t\n\t                    this.encode.displayName = \"_encode_\";\n\t\n\t                    var imageData = image.data;\n\t                    var width = image.width;\n\t                    var height = image.height;\n\t\n\t                    var quadWidth = width*4;\n\t                    var tripleWidth = width*3;\n\t\n\t                    var x, y = 0;\n\t                    var r, g, b;\n\t                    var start,p, col,row,pos;\n\t                    while(y < height){\n\t                        x = 0;\n\t                        while(x < quadWidth){\n\t                        start = quadWidth * y + x;\n\t                        p = start;\n\t                        col = -1;\n\t                        row = 0;\n\t\n\t                        for(pos=0; pos < 64; pos++){\n\t                            row = pos >> 3;// /8\n\t                            col = ( pos & 7 ) * 4; // %8\n\t                            p = start + ( row * quadWidth ) + col;\n\t\n\t                            if(y+row >= height){ // padding bottom\n\t                                p-= (quadWidth*(y+1+row-height));\n\t                            }\n\t\n\t                            if(x+col >= quadWidth){ // padding right\n\t                                p-= ((x+col) - quadWidth +4)\n\t                            }\n\t\n\t                            r = imageData[ p++ ];\n\t                            g = imageData[ p++ ];\n\t                            b = imageData[ p++ ];\n\t\n\t\n\t                            /* // calculate YUV values dynamically\n\t                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n\t                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n\t                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n\t                            */\n\t\n\t                            // use lookup table (slightly faster)\n\t                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n\t                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n\t                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n\t\n\t                        }\n\t\n\t                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n\t                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n\t                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n\t                        x+=32;\n\t                        }\n\t                        y+=8;\n\t                    }\n\t\n\t\n\t                    ////////////////////////////////////////////////////////////////\n\t\n\t                    // Do the bit alignment of the EOI marker\n\t                    if ( bytepos >= 0 ) {\n\t                        var fillbits = [];\n\t                        fillbits[1] = bytepos+1;\n\t                        fillbits[0] = (1<<(bytepos+1))-1;\n\t                        writeBits(fillbits);\n\t                    }\n\t\n\t                    writeWord(0xFFD9); //EOI\n\t\n\t                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n\t\n\t                    byteout = [];\n\t\n\t                    // benchmarking\n\t                    // var duration = new Date().getTime() - time_start;\n\t                    // console.log('Encoding time: '+ currentQuality + 'ms');\n\t                    //\n\t\n\t                    return jpegDataUri\n\t            }\n\t\n\t            function setQuality(quality){\n\t                if (quality <= 0) {\n\t                    quality = 1;\n\t                }\n\t                if (quality > 100) {\n\t                    quality = 100;\n\t                }\n\t\n\t                if(currentQuality == quality) return // don't recalc if unchanged\n\t\n\t                var sf = 0;\n\t                if (quality < 50) {\n\t                    sf = Math.floor(5000 / quality);\n\t                } else {\n\t                    sf = Math.floor(200 - quality*2);\n\t                }\n\t\n\t                initQuantTables(sf);\n\t                currentQuality = quality;\n\t                // console.log('Quality set to: '+quality +'%');\n\t            }\n\t\n\t            function init(){\n\t                // var time_start = new Date().getTime();\n\t                if(!quality) quality = 50;\n\t                // Create tables\n\t                initCharLookupTable()\n\t                initHuffmanTbl();\n\t                initCategoryNumber();\n\t                initRGBYUVTable();\n\t\n\t                setQuality(quality);\n\t                // var duration = new Date().getTime() - time_start;\n\t                // console.log('Initialization '+ duration + 'ms');\n\t            }\n\t\n\t            init();\n\t\n\t        }\n\t\n\t        JPEGEncoder.encode = function( data, quality ) {\n\t            var encoder = new JPEGEncoder( quality );\n\t\n\t            return encoder.encode( data );\n\t        }\n\t\n\t        return JPEGEncoder;\n\t    });\n\t    /**\n\t     * @fileOverview Fix android canvas.toDataUrl bug.\n\t     */\n\t    define('runtime/html5/androidpatch',[\n\t        'runtime/html5/util',\n\t        'runtime/html5/jpegencoder',\n\t        'base'\n\t    ], function( Util, encoder, Base ) {\n\t        var origin = Util.canvasToDataUrl,\n\t            supportJpeg;\n\t\n\t        Util.canvasToDataUrl = function( canvas, type, quality ) {\n\t            var ctx, w, h, fragement, parts;\n\t\n\t            // 非android手机直接跳过。\n\t            if ( !Base.os.android ) {\n\t                return origin.apply( null, arguments );\n\t            }\n\t\n\t            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n\t            // JPEG 前两位分别是：255, 216\n\t            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n\t                fragement = origin.apply( null, arguments );\n\t\n\t                parts = fragement.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    fragement = atob( parts[ 1 ] );\n\t                } else {\n\t                    fragement = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                fragement = fragement.substring( 0, 2 );\n\t\n\t                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n\t                        fragement.charCodeAt( 1 ) === 216;\n\t            }\n\t\n\t            // 只有在android环境下才修复\n\t            if ( type === 'image/jpeg' && !supportJpeg ) {\n\t                w = canvas.width;\n\t                h = canvas.height;\n\t                ctx = canvas.getContext('2d');\n\t\n\t                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n\t            }\n\t\n\t            return origin.apply( null, arguments );\n\t        };\n\t    });\n\t    /**\n\t     * @fileOverview Image\n\t     */\n\t    define('runtime/html5/image',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'runtime/html5/util'\n\t    ], function( Base, Html5Runtime, Util ) {\n\t\n\t        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n\t\n\t        return Html5Runtime.register( 'Image', {\n\t\n\t            // flag: 标记是否被修改过。\n\t            modified: false,\n\t\n\t            init: function() {\n\t                var me = this,\n\t                    img = new Image();\n\t\n\t                img.onload = function() {\n\t\n\t                    me._info = {\n\t                        type: me.type,\n\t                        width: this.width,\n\t                        height: this.height\n\t                    };\n\t\n\t                    // 读取meta信息。\n\t                    if ( !me._metas && 'image/jpeg' === me.type ) {\n\t                        Util.parseMeta( me._blob, function( error, ret ) {\n\t                            me._metas = ret;\n\t                            me.owner.trigger('load');\n\t                        });\n\t                    } else {\n\t                        me.owner.trigger('load');\n\t                    }\n\t                };\n\t\n\t                img.onerror = function() {\n\t                    me.owner.trigger('error');\n\t                };\n\t\n\t                me._img = img;\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var me = this,\n\t                    img = me._img;\n\t\n\t                me._blob = blob;\n\t                me.type = blob.type;\n\t                img.src = Util.createObjectURL( blob.getSource() );\n\t                me.owner.once( 'load', function() {\n\t                    Util.revokeObjectURL( img.src );\n\t                });\n\t            },\n\t\n\t            resize: function( width, height ) {\n\t                var canvas = this._canvas ||\n\t                        (this._canvas = document.createElement('canvas'));\n\t\n\t                this._resize( this._img, canvas, width, height );\n\t                this._blob = null;    // 没用了，可以删掉了。\n\t                this.modified = true;\n\t                this.owner.trigger( 'complete', 'resize' );\n\t            },\n\t\n\t            crop: function( x, y, w, h, s ) {\n\t                var cvs = this._canvas ||\n\t                        (this._canvas = document.createElement('canvas')),\n\t                    opts = this.options,\n\t                    img = this._img,\n\t                    iw = img.naturalWidth,\n\t                    ih = img.naturalHeight,\n\t                    orientation = this.getOrientation();\n\t\n\t                s = s || 1;\n\t\n\t                // todo 解决 orientation 的问题。\n\t                // values that require 90 degree rotation\n\t                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\t\n\t                //     switch ( orientation ) {\n\t                //         case 6:\n\t                //             tmp = x;\n\t                //             x = y;\n\t                //             y = iw * s - tmp - w;\n\t                //             console.log(ih * s, tmp, w)\n\t                //             break;\n\t                //     }\n\t\n\t                //     (w ^= h, h ^= w, w ^= h);\n\t                // }\n\t\n\t                cvs.width = w;\n\t                cvs.height = h;\n\t\n\t                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\t                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n\t\n\t                this._blob = null;    // 没用了，可以删掉了。\n\t                this.modified = true;\n\t                this.owner.trigger( 'complete', 'crop' );\n\t            },\n\t\n\t            getAsBlob: function( type ) {\n\t                var blob = this._blob,\n\t                    opts = this.options,\n\t                    canvas;\n\t\n\t                type = type || this.type;\n\t\n\t                // blob需要重新生成。\n\t                if ( this.modified || this.type !== type ) {\n\t                    canvas = this._canvas;\n\t\n\t                    if ( type === 'image/jpeg' ) {\n\t\n\t                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n\t\n\t                        if ( opts.preserveHeaders && this._metas &&\n\t                                this._metas.imageHead ) {\n\t\n\t                            blob = Util.dataURL2ArrayBuffer( blob );\n\t                            blob = Util.updateImageHead( blob,\n\t                                    this._metas.imageHead );\n\t                            blob = Util.arrayBufferToBlob( blob, type );\n\t                            return blob;\n\t                        }\n\t                    } else {\n\t                        blob = Util.canvasToDataUrl( canvas, type );\n\t                    }\n\t\n\t                    blob = Util.dataURL2Blob( blob );\n\t                }\n\t\n\t                return blob;\n\t            },\n\t\n\t            getAsDataUrl: function( type ) {\n\t                var opts = this.options;\n\t\n\t                type = type || this.type;\n\t\n\t                if ( type === 'image/jpeg' ) {\n\t                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n\t                } else {\n\t                    return this._canvas.toDataURL( type );\n\t                }\n\t            },\n\t\n\t            getOrientation: function() {\n\t                return this._metas && this._metas.exif &&\n\t                        this._metas.exif.get('Orientation') || 1;\n\t            },\n\t\n\t            info: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._info = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._info;\n\t            },\n\t\n\t            meta: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._meta = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._meta;\n\t            },\n\t\n\t            destroy: function() {\n\t                var canvas = this._canvas;\n\t                this._img.onload = null;\n\t\n\t                if ( canvas ) {\n\t                    canvas.getContext('2d')\n\t                            .clearRect( 0, 0, canvas.width, canvas.height );\n\t                    canvas.width = canvas.height = 0;\n\t                    this._canvas = null;\n\t                }\n\t\n\t                // 释放内存。非常重要，否则释放不了image的内存。\n\t                this._img.src = BLANK;\n\t                this._img = this._blob = null;\n\t            },\n\t\n\t            _resize: function( img, cvs, width, height ) {\n\t                var opts = this.options,\n\t                    naturalWidth = img.width,\n\t                    naturalHeight = img.height,\n\t                    orientation = this.getOrientation(),\n\t                    scale, w, h, x, y;\n\t\n\t                // values that require 90 degree rotation\n\t                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\t\n\t                    // 交换width, height的值。\n\t                    width ^= height;\n\t                    height ^= width;\n\t                    width ^= height;\n\t                }\n\t\n\t                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n\t                        height / naturalHeight );\n\t\n\t                // 不允许放大。\n\t                opts.allowMagnify || (scale = Math.min( 1, scale ));\n\t\n\t                w = naturalWidth * scale;\n\t                h = naturalHeight * scale;\n\t\n\t                if ( opts.crop ) {\n\t                    cvs.width = width;\n\t                    cvs.height = height;\n\t                } else {\n\t                    cvs.width = w;\n\t                    cvs.height = h;\n\t                }\n\t\n\t                x = (cvs.width - w) / 2;\n\t                y = (cvs.height - h) / 2;\n\t\n\t                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\t\n\t                this._renderImageToCanvas( cvs, img, x, y, w, h );\n\t            },\n\t\n\t            _rotate2Orientaion: function( canvas, orientation ) {\n\t                var width = canvas.width,\n\t                    height = canvas.height,\n\t                    ctx = canvas.getContext('2d');\n\t\n\t                switch ( orientation ) {\n\t                    case 5:\n\t                    case 6:\n\t                    case 7:\n\t                    case 8:\n\t                        canvas.width = height;\n\t                        canvas.height = width;\n\t                        break;\n\t                }\n\t\n\t                switch ( orientation ) {\n\t                    case 2:    // horizontal flip\n\t                        ctx.translate( width, 0 );\n\t                        ctx.scale( -1, 1 );\n\t                        break;\n\t\n\t                    case 3:    // 180 rotate left\n\t                        ctx.translate( width, height );\n\t                        ctx.rotate( Math.PI );\n\t                        break;\n\t\n\t                    case 4:    // vertical flip\n\t                        ctx.translate( 0, height );\n\t                        ctx.scale( 1, -1 );\n\t                        break;\n\t\n\t                    case 5:    // vertical flip + 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.scale( 1, -1 );\n\t                        break;\n\t\n\t                    case 6:    // 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.translate( 0, -height );\n\t                        break;\n\t\n\t                    case 7:    // horizontal flip + 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.translate( width, -height );\n\t                        ctx.scale( -1, 1 );\n\t                        break;\n\t\n\t                    case 8:    // 90 rotate left\n\t                        ctx.rotate( -0.5 * Math.PI );\n\t                        ctx.translate( -width, 0 );\n\t                        break;\n\t                }\n\t            },\n\t\n\t            // https://github.com/stomita/ios-imagefile-megapixel/\n\t            // blob/master/src/megapix-image.js\n\t            _renderImageToCanvas: (function() {\n\t\n\t                // 如果不是ios, 不需要这么复杂！\n\t                if ( !Base.os.ios ) {\n\t                    return function( canvas ) {\n\t                        var args = Base.slice( arguments, 1 ),\n\t                            ctx = canvas.getContext('2d');\n\t\n\t                        ctx.drawImage.apply( ctx, args );\n\t                    };\n\t                }\n\t\n\t                /**\n\t                 * Detecting vertical squash in loaded image.\n\t                 * Fixes a bug which squash image vertically while drawing into\n\t                 * canvas for some images.\n\t                 */\n\t                function detectVerticalSquash( img, iw, ih ) {\n\t                    var canvas = document.createElement('canvas'),\n\t                        ctx = canvas.getContext('2d'),\n\t                        sy = 0,\n\t                        ey = ih,\n\t                        py = ih,\n\t                        data, alpha, ratio;\n\t\n\t\n\t                    canvas.width = 1;\n\t                    canvas.height = ih;\n\t                    ctx.drawImage( img, 0, 0 );\n\t                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n\t\n\t                    // search image edge pixel position in case\n\t                    // it is squashed vertically.\n\t                    while ( py > sy ) {\n\t                        alpha = data[ (py - 1) * 4 + 3 ];\n\t\n\t                        if ( alpha === 0 ) {\n\t                            ey = py;\n\t                        } else {\n\t                            sy = py;\n\t                        }\n\t\n\t                        py = (ey + sy) >> 1;\n\t                    }\n\t\n\t                    ratio = (py / ih);\n\t                    return (ratio === 0) ? 1 : ratio;\n\t                }\n\t\n\t                // fix ie7 bug\n\t                // http://stackoverflow.com/questions/11929099/\n\t                // html5-canvas-drawimage-ratio-bug-ios\n\t                if ( Base.os.ios >= 7 ) {\n\t                    return function( canvas, img, x, y, w, h ) {\n\t                        var iw = img.naturalWidth,\n\t                            ih = img.naturalHeight,\n\t                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n\t\n\t                        return canvas.getContext('2d').drawImage( img, 0, 0,\n\t                                iw * vertSquashRatio, ih * vertSquashRatio,\n\t                                x, y, w, h );\n\t                    };\n\t                }\n\t\n\t                /**\n\t                 * Detect subsampling in loaded image.\n\t                 * In iOS, larger images than 2M pixels may be\n\t                 * subsampled in rendering.\n\t                 */\n\t                function detectSubsampling( img ) {\n\t                    var iw = img.naturalWidth,\n\t                        ih = img.naturalHeight,\n\t                        canvas, ctx;\n\t\n\t                    // subsampling may happen overmegapixel image\n\t                    if ( iw * ih > 1024 * 1024 ) {\n\t                        canvas = document.createElement('canvas');\n\t                        canvas.width = canvas.height = 1;\n\t                        ctx = canvas.getContext('2d');\n\t                        ctx.drawImage( img, -iw + 1, 0 );\n\t\n\t                        // subsampled image becomes half smaller in rendering size.\n\t                        // check alpha channel value to confirm image is covering\n\t                        // edge pixel or not. if alpha value is 0\n\t                        // image is not covering, hence subsampled.\n\t                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n\t                    } else {\n\t                        return false;\n\t                    }\n\t                }\n\t\n\t\n\t                return function( canvas, img, x, y, width, height ) {\n\t                    var iw = img.naturalWidth,\n\t                        ih = img.naturalHeight,\n\t                        ctx = canvas.getContext('2d'),\n\t                        subsampled = detectSubsampling( img ),\n\t                        doSquash = this.type === 'image/jpeg',\n\t                        d = 1024,\n\t                        sy = 0,\n\t                        dy = 0,\n\t                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n\t\n\t                    if ( subsampled ) {\n\t                        iw /= 2;\n\t                        ih /= 2;\n\t                    }\n\t\n\t                    ctx.save();\n\t                    tmpCanvas = document.createElement('canvas');\n\t                    tmpCanvas.width = tmpCanvas.height = d;\n\t\n\t                    tmpCtx = tmpCanvas.getContext('2d');\n\t                    vertSquashRatio = doSquash ?\n\t                            detectVerticalSquash( img, iw, ih ) : 1;\n\t\n\t                    dw = Math.ceil( d * width / iw );\n\t                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n\t\n\t                    while ( sy < ih ) {\n\t                        sx = 0;\n\t                        dx = 0;\n\t                        while ( sx < iw ) {\n\t                            tmpCtx.clearRect( 0, 0, d, d );\n\t                            tmpCtx.drawImage( img, -sx, -sy );\n\t                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n\t                                    x + dx, y + dy, dw, dh );\n\t                            sx += d;\n\t                            dx += dw;\n\t                        }\n\t                        sy += d;\n\t                        dy += dh;\n\t                    }\n\t                    ctx.restore();\n\t                    tmpCanvas = tmpCtx = null;\n\t                };\n\t            })()\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Transport\n\t     * @todo 支持chunked传输，优势：\n\t     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n\t     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n\t     */\n\t    define('runtime/html5/transport',[\n\t        'base',\n\t        'runtime/html5/runtime'\n\t    ], function( Base, Html5Runtime ) {\n\t\n\t        var noop = Base.noop,\n\t            $ = Base.$;\n\t\n\t        return Html5Runtime.register( 'Transport', {\n\t            init: function() {\n\t                this._status = 0;\n\t                this._response = null;\n\t            },\n\t\n\t            send: function() {\n\t                var owner = this.owner,\n\t                    opts = this.options,\n\t                    xhr = this._initAjax(),\n\t                    blob = owner._blob,\n\t                    server = opts.server,\n\t                    formData, binary, fr;\n\t\n\t                if ( opts.sendAsBinary ) {\n\t                    server += (/\\?/.test( server ) ? '&' : '?') +\n\t                            $.param( owner._formData );\n\t\n\t                    binary = blob.getSource();\n\t                } else {\n\t                    formData = new FormData();\n\t                    $.each( owner._formData, function( k, v ) {\n\t                        formData.append( k, v );\n\t                    });\n\t\n\t                    formData.append( opts.fileVal, blob.getSource(),\n\t                            opts.filename || owner._formData.name || '' );\n\t                }\n\t\n\t                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n\t                    xhr.open( opts.method, server, true );\n\t                    xhr.withCredentials = true;\n\t                } else {\n\t                    xhr.open( opts.method, server );\n\t                }\n\t\n\t                this._setRequestHeader( xhr, opts.headers );\n\t\n\t                if ( binary ) {\n\t                    // 强制设置成 content-type 为文件流。\n\t                    xhr.overrideMimeType &&\n\t                            xhr.overrideMimeType('application/octet-stream');\n\t\n\t                    // android直接发送blob会导致服务端接收到的是空文件。\n\t                    // bug详情。\n\t                    // https://code.google.com/p/android/issues/detail?id=39882\n\t                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n\t                    if ( Base.os.android ) {\n\t                        fr = new FileReader();\n\t\n\t                        fr.onload = function() {\n\t                            xhr.send( this.result );\n\t                            fr = fr.onload = null;\n\t                        };\n\t\n\t                        fr.readAsArrayBuffer( binary );\n\t                    } else {\n\t                        xhr.send( binary );\n\t                    }\n\t                } else {\n\t                    xhr.send( formData );\n\t                }\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this._response;\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this._parseJson( this._response );\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this._status;\n\t            },\n\t\n\t            abort: function() {\n\t                var xhr = this._xhr;\n\t\n\t                if ( xhr ) {\n\t                    xhr.upload.onprogress = noop;\n\t                    xhr.onreadystatechange = noop;\n\t                    xhr.abort();\n\t\n\t                    this._xhr = xhr = null;\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.abort();\n\t            },\n\t\n\t            _initAjax: function() {\n\t                var me = this,\n\t                    xhr = new XMLHttpRequest(),\n\t                    opts = this.options;\n\t\n\t                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n\t                        typeof XDomainRequest !== 'undefined' ) {\n\t                    xhr = new XDomainRequest();\n\t                }\n\t\n\t                xhr.upload.onprogress = function( e ) {\n\t                    var percentage = 0;\n\t\n\t                    if ( e.lengthComputable ) {\n\t                        percentage = e.loaded / e.total;\n\t                    }\n\t\n\t                    return me.trigger( 'progress', percentage );\n\t                };\n\t\n\t                xhr.onreadystatechange = function() {\n\t\n\t                    if ( xhr.readyState !== 4 ) {\n\t                        return;\n\t                    }\n\t\n\t                    xhr.upload.onprogress = noop;\n\t                    xhr.onreadystatechange = noop;\n\t                    me._xhr = null;\n\t                    me._status = xhr.status;\n\t\n\t                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n\t                        me._response = xhr.responseText;\n\t                        return me.trigger('load');\n\t                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n\t                        me._response = xhr.responseText;\n\t                        return me.trigger( 'error', 'server' );\n\t                    }\n\t\n\t\n\t                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n\t                };\n\t\n\t                me._xhr = xhr;\n\t                return xhr;\n\t            },\n\t\n\t            _setRequestHeader: function( xhr, headers ) {\n\t                $.each( headers, function( key, val ) {\n\t                    xhr.setRequestHeader( key, val );\n\t                });\n\t            },\n\t\n\t            _parseJson: function( str ) {\n\t                var json;\n\t\n\t                try {\n\t                    json = JSON.parse( str );\n\t                } catch ( ex ) {\n\t                    json = {};\n\t                }\n\t\n\t                return json;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Transport flash实现\n\t     */\n\t    define('runtime/html5/md5',[\n\t        'runtime/html5/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        /*\n\t         * Fastest md5 implementation around (JKM md5)\n\t         * Credits: Joseph Myers\n\t         *\n\t         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n\t         * @see http://jsperf.com/md5-shootout/7\n\t         */\n\t\n\t        /* this function is much faster,\n\t          so if possible we use it. Some IEs\n\t          are the only ones I know of that\n\t          need the idiotic second function,\n\t          generated by an if clause.  */\n\t        var add32 = function (a, b) {\n\t            return (a + b) & 0xFFFFFFFF;\n\t        },\n\t\n\t        cmn = function (q, a, b, x, s, t) {\n\t            a = add32(add32(a, q), add32(x, t));\n\t            return add32((a << s) | (a >>> (32 - s)), b);\n\t        },\n\t\n\t        ff = function (a, b, c, d, x, s, t) {\n\t            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n\t        },\n\t\n\t        gg = function (a, b, c, d, x, s, t) {\n\t            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n\t        },\n\t\n\t        hh = function (a, b, c, d, x, s, t) {\n\t            return cmn(b ^ c ^ d, a, b, x, s, t);\n\t        },\n\t\n\t        ii = function (a, b, c, d, x, s, t) {\n\t            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n\t        },\n\t\n\t        md5cycle = function (x, k) {\n\t            var a = x[0],\n\t                b = x[1],\n\t                c = x[2],\n\t                d = x[3];\n\t\n\t            a = ff(a, b, c, d, k[0], 7, -680876936);\n\t            d = ff(d, a, b, c, k[1], 12, -389564586);\n\t            c = ff(c, d, a, b, k[2], 17, 606105819);\n\t            b = ff(b, c, d, a, k[3], 22, -1044525330);\n\t            a = ff(a, b, c, d, k[4], 7, -176418897);\n\t            d = ff(d, a, b, c, k[5], 12, 1200080426);\n\t            c = ff(c, d, a, b, k[6], 17, -1473231341);\n\t            b = ff(b, c, d, a, k[7], 22, -45705983);\n\t            a = ff(a, b, c, d, k[8], 7, 1770035416);\n\t            d = ff(d, a, b, c, k[9], 12, -1958414417);\n\t            c = ff(c, d, a, b, k[10], 17, -42063);\n\t            b = ff(b, c, d, a, k[11], 22, -1990404162);\n\t            a = ff(a, b, c, d, k[12], 7, 1804603682);\n\t            d = ff(d, a, b, c, k[13], 12, -40341101);\n\t            c = ff(c, d, a, b, k[14], 17, -1502002290);\n\t            b = ff(b, c, d, a, k[15], 22, 1236535329);\n\t\n\t            a = gg(a, b, c, d, k[1], 5, -165796510);\n\t            d = gg(d, a, b, c, k[6], 9, -1069501632);\n\t            c = gg(c, d, a, b, k[11], 14, 643717713);\n\t            b = gg(b, c, d, a, k[0], 20, -373897302);\n\t            a = gg(a, b, c, d, k[5], 5, -701558691);\n\t            d = gg(d, a, b, c, k[10], 9, 38016083);\n\t            c = gg(c, d, a, b, k[15], 14, -660478335);\n\t            b = gg(b, c, d, a, k[4], 20, -405537848);\n\t            a = gg(a, b, c, d, k[9], 5, 568446438);\n\t            d = gg(d, a, b, c, k[14], 9, -1019803690);\n\t            c = gg(c, d, a, b, k[3], 14, -187363961);\n\t            b = gg(b, c, d, a, k[8], 20, 1163531501);\n\t            a = gg(a, b, c, d, k[13], 5, -1444681467);\n\t            d = gg(d, a, b, c, k[2], 9, -51403784);\n\t            c = gg(c, d, a, b, k[7], 14, 1735328473);\n\t            b = gg(b, c, d, a, k[12], 20, -1926607734);\n\t\n\t            a = hh(a, b, c, d, k[5], 4, -378558);\n\t            d = hh(d, a, b, c, k[8], 11, -2022574463);\n\t            c = hh(c, d, a, b, k[11], 16, 1839030562);\n\t            b = hh(b, c, d, a, k[14], 23, -35309556);\n\t            a = hh(a, b, c, d, k[1], 4, -1530992060);\n\t            d = hh(d, a, b, c, k[4], 11, 1272893353);\n\t            c = hh(c, d, a, b, k[7], 16, -155497632);\n\t            b = hh(b, c, d, a, k[10], 23, -1094730640);\n\t            a = hh(a, b, c, d, k[13], 4, 681279174);\n\t            d = hh(d, a, b, c, k[0], 11, -358537222);\n\t            c = hh(c, d, a, b, k[3], 16, -722521979);\n\t            b = hh(b, c, d, a, k[6], 23, 76029189);\n\t            a = hh(a, b, c, d, k[9], 4, -640364487);\n\t            d = hh(d, a, b, c, k[12], 11, -421815835);\n\t            c = hh(c, d, a, b, k[15], 16, 530742520);\n\t            b = hh(b, c, d, a, k[2], 23, -995338651);\n\t\n\t            a = ii(a, b, c, d, k[0], 6, -198630844);\n\t            d = ii(d, a, b, c, k[7], 10, 1126891415);\n\t            c = ii(c, d, a, b, k[14], 15, -1416354905);\n\t            b = ii(b, c, d, a, k[5], 21, -57434055);\n\t            a = ii(a, b, c, d, k[12], 6, 1700485571);\n\t            d = ii(d, a, b, c, k[3], 10, -1894986606);\n\t            c = ii(c, d, a, b, k[10], 15, -1051523);\n\t            b = ii(b, c, d, a, k[1], 21, -2054922799);\n\t            a = ii(a, b, c, d, k[8], 6, 1873313359);\n\t            d = ii(d, a, b, c, k[15], 10, -30611744);\n\t            c = ii(c, d, a, b, k[6], 15, -1560198380);\n\t            b = ii(b, c, d, a, k[13], 21, 1309151649);\n\t            a = ii(a, b, c, d, k[4], 6, -145523070);\n\t            d = ii(d, a, b, c, k[11], 10, -1120210379);\n\t            c = ii(c, d, a, b, k[2], 15, 718787259);\n\t            b = ii(b, c, d, a, k[9], 21, -343485551);\n\t\n\t            x[0] = add32(a, x[0]);\n\t            x[1] = add32(b, x[1]);\n\t            x[2] = add32(c, x[2]);\n\t            x[3] = add32(d, x[3]);\n\t        },\n\t\n\t        /* there needs to be support for Unicode here,\n\t           * unless we pretend that we can redefine the MD-5\n\t           * algorithm for multi-byte characters (perhaps\n\t           * by adding every four 16-bit characters and\n\t           * shortening the sum to 32 bits). Otherwise\n\t           * I suggest performing MD-5 as if every character\n\t           * was two bytes--e.g., 0040 0025 = @%--but then\n\t           * how will an ordinary MD-5 sum be matched?\n\t           * There is no way to standardize text to something\n\t           * like UTF-8 before transformation; speed cost is\n\t           * utterly prohibitive. The JavaScript standard\n\t           * itself needs to look at this: it should start\n\t           * providing access to strings as preformed UTF-8\n\t           * 8-bit unsigned value arrays.\n\t           */\n\t        md5blk = function (s) {\n\t            var md5blks = [],\n\t                i; /* Andy King said do it this way. */\n\t\n\t            for (i = 0; i < 64; i += 4) {\n\t                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n\t            }\n\t            return md5blks;\n\t        },\n\t\n\t        md5blk_array = function (a) {\n\t            var md5blks = [],\n\t                i; /* Andy King said do it this way. */\n\t\n\t            for (i = 0; i < 64; i += 4) {\n\t                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n\t            }\n\t            return md5blks;\n\t        },\n\t\n\t        md51 = function (s) {\n\t            var n = s.length,\n\t                state = [1732584193, -271733879, -1732584194, 271733878],\n\t                i,\n\t                length,\n\t                tail,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            for (i = 64; i <= n; i += 64) {\n\t                md5cycle(state, md5blk(s.substring(i - 64, i)));\n\t            }\n\t            s = s.substring(i - 64);\n\t            length = s.length;\n\t            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n\t            }\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Beware that the final length might not fit in 32 bits so we take care of that\n\t            tmp = n * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t\n\t            md5cycle(state, tail);\n\t            return state;\n\t        },\n\t\n\t        md51_array = function (a) {\n\t            var n = a.length,\n\t                state = [1732584193, -271733879, -1732584194, 271733878],\n\t                i,\n\t                length,\n\t                tail,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            for (i = 64; i <= n; i += 64) {\n\t                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n\t            }\n\t\n\t            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n\t            // containing the last element of the parent array if the sub array specified starts\n\t            // beyond the length of the parent array - weird.\n\t            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n\t            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\t\n\t            length = a.length;\n\t            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n\t            }\n\t\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Beware that the final length might not fit in 32 bits so we take care of that\n\t            tmp = n * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t\n\t            md5cycle(state, tail);\n\t\n\t            return state;\n\t        },\n\t\n\t        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n\t\n\t        rhex = function (n) {\n\t            var s = '',\n\t                j;\n\t            for (j = 0; j < 4; j += 1) {\n\t                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n\t            }\n\t            return s;\n\t        },\n\t\n\t        hex = function (x) {\n\t            var i;\n\t            for (i = 0; i < x.length; i += 1) {\n\t                x[i] = rhex(x[i]);\n\t            }\n\t            return x.join('');\n\t        },\n\t\n\t        md5 = function (s) {\n\t            return hex(md51(s));\n\t        },\n\t\n\t\n\t\n\t        ////////////////////////////////////////////////////////////////////////////\n\t\n\t        /**\n\t         * SparkMD5 OOP implementation.\n\t         *\n\t         * Use this class to perform an incremental md5, otherwise use the\n\t         * static methods instead.\n\t         */\n\t        SparkMD5 = function () {\n\t            // call reset to init the instance\n\t            this.reset();\n\t        };\n\t\n\t\n\t        // In some cases the fast add32 function cannot be used..\n\t        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n\t            add32 = function (x, y) {\n\t                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n\t                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n\t                return (msw << 16) | (lsw & 0xFFFF);\n\t            };\n\t        }\n\t\n\t\n\t        /**\n\t         * Appends a string.\n\t         * A conversion will be applied if an utf8 string is detected.\n\t         *\n\t         * @param {String} str The string to be appended\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.append = function (str) {\n\t            // converts the string to utf8 bytes if necessary\n\t            if (/[\\u0080-\\uFFFF]/.test(str)) {\n\t                str = unescape(encodeURIComponent(str));\n\t            }\n\t\n\t            // then append as binary\n\t            this.appendBinary(str);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Appends a binary string.\n\t         *\n\t         * @param {String} contents The binary string to be appended\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.appendBinary = function (contents) {\n\t            this._buff += contents;\n\t            this._length += contents.length;\n\t\n\t            var length = this._buff.length,\n\t                i;\n\t\n\t            for (i = 64; i <= length; i += 64) {\n\t                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n\t            }\n\t\n\t            this._buff = this._buff.substr(i - 64);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Finishes the incremental computation, reseting the internal state and\n\t         * returning the result.\n\t         * Use the raw parameter to obtain the raw result instead of the hex one.\n\t         *\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.prototype.end = function (raw) {\n\t            var buff = this._buff,\n\t                length = buff.length,\n\t                i,\n\t                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t                ret;\n\t\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n\t            }\n\t\n\t            this._finish(tail, length);\n\t            ret = raw ? this._state : hex(this._state);\n\t\n\t            this.reset();\n\t\n\t            return ret;\n\t        };\n\t\n\t        /**\n\t         * Finish the final calculation based on the tail.\n\t         *\n\t         * @param {Array}  tail   The tail (will be modified)\n\t         * @param {Number} length The length of the remaining buffer\n\t         */\n\t        SparkMD5.prototype._finish = function (tail, length) {\n\t            var i = length,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(this._state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Do the final computation based on the tail and length\n\t            // Beware that the final length may not fit in 32 bits so we take care of that\n\t            tmp = this._length * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t            md5cycle(this._state, tail);\n\t        };\n\t\n\t        /**\n\t         * Resets the internal state of the computation.\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.reset = function () {\n\t            this._buff = \"\";\n\t            this._length = 0;\n\t            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Releases memory used by the incremental buffer and other aditional\n\t         * resources. If you plan to use the instance again, use reset instead.\n\t         */\n\t        SparkMD5.prototype.destroy = function () {\n\t            delete this._state;\n\t            delete this._buff;\n\t            delete this._length;\n\t        };\n\t\n\t\n\t        /**\n\t         * Performs the md5 hash on a string.\n\t         * A conversion will be applied if utf8 string is detected.\n\t         *\n\t         * @param {String}  str The string\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.hash = function (str, raw) {\n\t            // converts the string to utf8 bytes if necessary\n\t            if (/[\\u0080-\\uFFFF]/.test(str)) {\n\t                str = unescape(encodeURIComponent(str));\n\t            }\n\t\n\t            var hash = md51(str);\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        /**\n\t         * Performs the md5 hash on a binary string.\n\t         *\n\t         * @param {String}  content The binary string\n\t         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.hashBinary = function (content, raw) {\n\t            var hash = md51(content);\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        /**\n\t         * SparkMD5 OOP implementation for array buffers.\n\t         *\n\t         * Use this class to perform an incremental md5 ONLY for array buffers.\n\t         */\n\t        SparkMD5.ArrayBuffer = function () {\n\t            // call reset to init the instance\n\t            this.reset();\n\t        };\n\t\n\t        ////////////////////////////////////////////////////////////////////////////\n\t\n\t        /**\n\t         * Appends an array buffer.\n\t         *\n\t         * @param {ArrayBuffer} arr The array to be appended\n\t         *\n\t         * @return {SparkMD5.ArrayBuffer} The instance itself\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n\t            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n\t            //       if you find yourself needing extra performance, please make a PR.\n\t            var buff = this._concatArrayBuffer(this._buff, arr),\n\t                length = buff.length,\n\t                i;\n\t\n\t            this._length += arr.byteLength;\n\t\n\t            for (i = 64; i <= length; i += 64) {\n\t                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n\t            }\n\t\n\t            // Avoids IE10 weirdness (documented above)\n\t            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Finishes the incremental computation, reseting the internal state and\n\t         * returning the result.\n\t         * Use the raw parameter to obtain the raw result instead of the hex one.\n\t         *\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n\t            var buff = this._buff,\n\t                length = buff.length,\n\t                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t                i,\n\t                ret;\n\t\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n\t            }\n\t\n\t            this._finish(tail, length);\n\t            ret = raw ? this._state : hex(this._state);\n\t\n\t            this.reset();\n\t\n\t            return ret;\n\t        };\n\t\n\t        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\t\n\t        /**\n\t         * Resets the internal state of the computation.\n\t         *\n\t         * @return {SparkMD5.ArrayBuffer} The instance itself\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.reset = function () {\n\t            this._buff = new Uint8Array(0);\n\t            this._length = 0;\n\t            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Releases memory used by the incremental buffer and other aditional\n\t         * resources. If you plan to use the instance again, use reset instead.\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\t\n\t        /**\n\t         * Concats two array buffers, returning a new one.\n\t         *\n\t         * @param  {ArrayBuffer} first  The first array buffer\n\t         * @param  {ArrayBuffer} second The second array buffer\n\t         *\n\t         * @return {ArrayBuffer} The new array buffer\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n\t            var firstLength = first.length,\n\t                result = new Uint8Array(firstLength + second.byteLength);\n\t\n\t            result.set(first);\n\t            result.set(new Uint8Array(second), firstLength);\n\t\n\t            return result;\n\t        };\n\t\n\t        /**\n\t         * Performs the md5 hash on an array buffer.\n\t         *\n\t         * @param {ArrayBuffer} arr The array buffer\n\t         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n\t            var hash = md51_array(new Uint8Array(arr));\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        return FlashRuntime.register( 'Md5', {\n\t            init: function() {\n\t                // do nothing.\n\t            },\n\t\n\t            loadFromBlob: function( file ) {\n\t                var blob = file.getSource(),\n\t                    chunkSize = 2 * 1024 * 1024,\n\t                    chunks = Math.ceil( blob.size / chunkSize ),\n\t                    chunk = 0,\n\t                    owner = this.owner,\n\t                    spark = new SparkMD5.ArrayBuffer(),\n\t                    me = this,\n\t                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n\t                    loadNext, fr;\n\t\n\t                fr = new FileReader();\n\t\n\t                loadNext = function() {\n\t                    var start, end;\n\t\n\t                    start = chunk * chunkSize;\n\t                    end = Math.min( start + chunkSize, blob.size );\n\t\n\t                    fr.onload = function( e ) {\n\t                        spark.append( e.target.result );\n\t                        owner.trigger( 'progress', {\n\t                            total: file.size,\n\t                            loaded: end\n\t                        });\n\t                    };\n\t\n\t                    fr.onloadend = function() {\n\t                        fr.onloadend = fr.onload = null;\n\t\n\t                        if ( ++chunk < chunks ) {\n\t                            setTimeout( loadNext, 1 );\n\t                        } else {\n\t                            setTimeout(function(){\n\t                                owner.trigger('load');\n\t                                me.result = spark.end();\n\t                                loadNext = file = blob = spark = null;\n\t                                owner.trigger('complete');\n\t                            }, 50 );\n\t                        }\n\t                    };\n\t\n\t                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n\t                };\n\t\n\t                loadNext();\n\t            },\n\t\n\t            getResult: function() {\n\t                return this.result;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview FlashRuntime\n\t     */\n\t    define('runtime/flash/runtime',[\n\t        'base',\n\t        'runtime/runtime',\n\t        'runtime/compbase'\n\t    ], function( Base, Runtime, CompBase ) {\n\t\n\t        var $ = Base.$,\n\t            type = 'flash',\n\t            components = {};\n\t\n\t\n\t        function getFlashVersion() {\n\t            var version;\n\t\n\t            try {\n\t                version = navigator.plugins[ 'Shockwave Flash' ];\n\t                version = version.description;\n\t            } catch ( ex ) {\n\t                try {\n\t                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n\t                            .GetVariable('$version');\n\t                } catch ( ex2 ) {\n\t                    version = '0.0';\n\t                }\n\t            }\n\t            version = version.match( /\\d+/g );\n\t            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n\t        }\n\t\n\t        function FlashRuntime() {\n\t            var pool = {},\n\t                clients = {},\n\t                destroy = this.destroy,\n\t                me = this,\n\t                jsreciver = Base.guid('webuploader_');\n\t\n\t            Runtime.apply( me, arguments );\n\t            me.type = type;\n\t\n\t\n\t            // 这个方法的调用者，实际上是RuntimeClient\n\t            me.exec = function( comp, fn/*, args...*/ ) {\n\t                var client = this,\n\t                    uid = client.uid,\n\t                    args = Base.slice( arguments, 2 ),\n\t                    instance;\n\t\n\t                clients[ uid ] = client;\n\t\n\t                if ( components[ comp ] ) {\n\t                    if ( !pool[ uid ] ) {\n\t                        pool[ uid ] = new components[ comp ]( client, me );\n\t                    }\n\t\n\t                    instance = pool[ uid ];\n\t\n\t                    if ( instance[ fn ] ) {\n\t                        return instance[ fn ].apply( instance, args );\n\t                    }\n\t                }\n\t\n\t                return me.flashExec.apply( client, arguments );\n\t            };\n\t\n\t            function handler( evt, obj ) {\n\t                var type = evt.type || evt,\n\t                    parts, uid;\n\t\n\t                parts = type.split('::');\n\t                uid = parts[ 0 ];\n\t                type = parts[ 1 ];\n\t\n\t                // console.log.apply( console, arguments );\n\t\n\t                if ( type === 'Ready' && uid === me.uid ) {\n\t                    me.trigger('ready');\n\t                } else if ( clients[ uid ] ) {\n\t                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n\t                }\n\t\n\t                // Base.log( evt, obj );\n\t            }\n\t\n\t            // flash的接受器。\n\t            window[ jsreciver ] = function() {\n\t                var args = arguments;\n\t\n\t                // 为了能捕获得到。\n\t                setTimeout(function() {\n\t                    handler.apply( null, args );\n\t                }, 1 );\n\t            };\n\t\n\t            this.jsreciver = jsreciver;\n\t\n\t            this.destroy = function() {\n\t                // @todo 删除池子中的所有实例\n\t                return destroy && destroy.apply( this, arguments );\n\t            };\n\t\n\t            this.flashExec = function( comp, fn ) {\n\t                var flash = me.getFlash(),\n\t                    args = Base.slice( arguments, 2 );\n\t\n\t                return flash.exec( this.uid, comp, fn, args );\n\t            };\n\t\n\t            // @todo\n\t        }\n\t\n\t        Base.inherits( Runtime, {\n\t            constructor: FlashRuntime,\n\t\n\t            init: function() {\n\t                var container = this.getContainer(),\n\t                    opts = this.options,\n\t                    html;\n\t\n\t                // if not the minimal height, shims are not initialized\n\t                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n\t                container.css({\n\t                    position: 'absolute',\n\t                    top: '-8px',\n\t                    left: '-8px',\n\t                    width: '9px',\n\t                    height: '9px',\n\t                    overflow: 'hidden'\n\t                });\n\t\n\t                // insert flash object\n\t                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n\t                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n\t\n\t                if ( Base.browser.ie ) {\n\t                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n\t                }\n\t\n\t                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n\t                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n\t                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n\t                    '&jsreciver=' + this.jsreciver + '\" />' +\n\t                    '<param name=\"wmode\" value=\"transparent\" />' +\n\t                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n\t                '</object>';\n\t\n\t                container.html( html );\n\t            },\n\t\n\t            getFlash: function() {\n\t                if ( this._flash ) {\n\t                    return this._flash;\n\t                }\n\t\n\t                this._flash = $( '#' + this.uid ).get( 0 );\n\t                return this._flash;\n\t            }\n\t\n\t        });\n\t\n\t        FlashRuntime.register = function( name, component ) {\n\t            component = components[ name ] = Base.inherits( CompBase, $.extend({\n\t\n\t                // @todo fix this later\n\t                flashExec: function() {\n\t                    var owner = this.owner,\n\t                        runtime = this.getRuntime();\n\t\n\t                    return runtime.flashExec.apply( owner, arguments );\n\t                }\n\t            }, component ) );\n\t\n\t            return component;\n\t        };\n\t\n\t        if ( getFlashVersion() >= 11.4 ) {\n\t            Runtime.addRuntime( type, FlashRuntime );\n\t        }\n\t\n\t        return FlashRuntime;\n\t    });\n\t    /**\n\t     * @fileOverview FilePicker\n\t     */\n\t    define('runtime/flash/filepicker',[\n\t        'base',\n\t        'runtime/flash/runtime'\n\t    ], function( Base, FlashRuntime ) {\n\t        var $ = Base.$;\n\t\n\t        return FlashRuntime.register( 'FilePicker', {\n\t            init: function( opts ) {\n\t                var copy = $.extend({}, opts ),\n\t                    len, i;\n\t\n\t                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n\t                len = copy.accept && copy.accept.length;\n\t                for (  i = 0; i < len; i++ ) {\n\t                    if ( !copy.accept[ i ].title ) {\n\t                        copy.accept[ i ].title = 'Files';\n\t                    }\n\t                }\n\t\n\t                delete copy.button;\n\t                delete copy.id;\n\t                delete copy.container;\n\t\n\t                this.flashExec( 'FilePicker', 'init', copy );\n\t            },\n\t\n\t            destroy: function() {\n\t                this.flashExec( 'FilePicker', 'destroy' );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 图片压缩\n\t     */\n\t    define('runtime/flash/image',[\n\t        'runtime/flash/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        return FlashRuntime.register( 'Image', {\n\t            // init: function( options ) {\n\t            //     var owner = this.owner;\n\t\n\t            //     this.flashExec( 'Image', 'init', options );\n\t            //     owner.on( 'load', function() {\n\t            //         debugger;\n\t            //     });\n\t            // },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var owner = this.owner;\n\t\n\t                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n\t                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n\t\n\t                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Transport flash实现\n\t     */\n\t    define('runtime/flash/transport',[\n\t        'base',\n\t        'runtime/flash/runtime',\n\t        'runtime/client'\n\t    ], function( Base, FlashRuntime, RuntimeClient ) {\n\t        var $ = Base.$;\n\t\n\t        return FlashRuntime.register( 'Transport', {\n\t            init: function() {\n\t                this._status = 0;\n\t                this._response = null;\n\t                this._responseJson = null;\n\t            },\n\t\n\t            send: function() {\n\t                var owner = this.owner,\n\t                    opts = this.options,\n\t                    xhr = this._initAjax(),\n\t                    blob = owner._blob,\n\t                    server = opts.server,\n\t                    binary;\n\t\n\t                xhr.connectRuntime( blob.ruid );\n\t\n\t                if ( opts.sendAsBinary ) {\n\t                    server += (/\\?/.test( server ) ? '&' : '?') +\n\t                            $.param( owner._formData );\n\t\n\t                    binary = blob.uid;\n\t                } else {\n\t                    $.each( owner._formData, function( k, v ) {\n\t                        xhr.exec( 'append', k, v );\n\t                    });\n\t\n\t                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n\t                            opts.filename || owner._formData.name || '' );\n\t                }\n\t\n\t                this._setRequestHeader( xhr, opts.headers );\n\t                xhr.exec( 'send', {\n\t                    method: opts.method,\n\t                    url: server,\n\t                    forceURLStream: opts.forceURLStream,\n\t                    mimeType: 'application/octet-stream',\n\t                }, binary );\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this._status;\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this._response || '';\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this._responseJson;\n\t            },\n\t\n\t            abort: function() {\n\t                var xhr = this._xhr;\n\t\n\t                if ( xhr ) {\n\t                    xhr.exec('abort');\n\t                    xhr.destroy();\n\t                    this._xhr = xhr = null;\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.abort();\n\t            },\n\t\n\t            _initAjax: function() {\n\t                var me = this,\n\t                    xhr = new RuntimeClient('XMLHttpRequest');\n\t\n\t                xhr.on( 'uploadprogress progress', function( e ) {\n\t                    var percent = e.loaded / e.total;\n\t                    percent = Math.min( 1, Math.max( 0, percent ) );\n\t                    return me.trigger( 'progress', percent );\n\t                });\n\t\n\t                xhr.on( 'load', function() {\n\t                    var status = xhr.exec('getStatus'),\n\t                        readBody = false,\n\t                        err = '',\n\t                        p;\n\t\n\t                    xhr.off();\n\t                    me._xhr = null;\n\t\n\t                    if ( status >= 200 && status < 300 ) {\n\t                        readBody = true;\n\t                    } else if ( status >= 500 && status < 600 ) {\n\t                        readBody = true;\n\t                        err = 'server';\n\t                    } else {\n\t                        err = 'http';\n\t                    }\n\t\n\t                    if ( readBody ) {\n\t                        me._response = xhr.exec('getResponse');\n\t                        me._response = decodeURIComponent( me._response );\n\t\n\t                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n\t                        // try {\n\t                        //     me._responseJson = xhr.exec('getResponseAsJson');\n\t                        // } catch ( error ) {\n\t\n\t                        p = window.JSON && window.JSON.parse || function( s ) {\n\t                            try {\n\t                                return new Function('return ' + s).call();\n\t                            } catch ( err ) {\n\t                                return {};\n\t                            }\n\t                        };\n\t                        me._responseJson  = me._response ? p(me._response) : {};\n\t\n\t                        // }\n\t                    }\n\t\n\t                    xhr.destroy();\n\t                    xhr = null;\n\t\n\t                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n\t                });\n\t\n\t                xhr.on( 'error', function() {\n\t                    xhr.off();\n\t                    me._xhr = null;\n\t                    me.trigger( 'error', 'http' );\n\t                });\n\t\n\t                me._xhr = xhr;\n\t                return xhr;\n\t            },\n\t\n\t            _setRequestHeader: function( xhr, headers ) {\n\t                $.each( headers, function( key, val ) {\n\t                    xhr.exec( 'setRequestHeader', key, val );\n\t                });\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Blob Html实现\n\t     */\n\t    define('runtime/flash/blob',[\n\t        'runtime/flash/runtime',\n\t        'lib/blob'\n\t    ], function( FlashRuntime, Blob ) {\n\t\n\t        return FlashRuntime.register( 'Blob', {\n\t            slice: function( start, end ) {\n\t                var blob = this.flashExec( 'Blob', 'slice', start, end );\n\t\n\t                return new Blob( blob.uid, blob );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Md5 flash实现\n\t     */\n\t    define('runtime/flash/md5',[\n\t        'runtime/flash/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        return FlashRuntime.register( 'Md5', {\n\t            init: function() {\n\t                // do nothing.\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 完全版本。\n\t     */\n\t    define('preset/all',[\n\t        'base',\n\t\n\t        // widgets\n\t        'widgets/filednd',\n\t        'widgets/filepaste',\n\t        'widgets/filepicker',\n\t        'widgets/image',\n\t        'widgets/queue',\n\t        'widgets/runtime',\n\t        'widgets/upload',\n\t        'widgets/validator',\n\t        'widgets/md5',\n\t\n\t        // runtimes\n\t        // html5\n\t        'runtime/html5/blob',\n\t        'runtime/html5/dnd',\n\t        'runtime/html5/filepaste',\n\t        'runtime/html5/filepicker',\n\t        'runtime/html5/imagemeta/exif',\n\t        'runtime/html5/androidpatch',\n\t        'runtime/html5/image',\n\t        'runtime/html5/transport',\n\t        'runtime/html5/md5',\n\t\n\t        // flash\n\t        'runtime/flash/filepicker',\n\t        'runtime/flash/image',\n\t        'runtime/flash/transport',\n\t        'runtime/flash/blob',\n\t        'runtime/flash/md5'\n\t    ], function( Base ) {\n\t        return Base;\n\t    });\n\t    /**\n\t     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n\t     *\n\t     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n\t     *\n\t     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n\t     *\n\t     * 如：\n\t     * WebUploader.create({\n\t     *     ...\n\t     *\n\t     *     disableWidgets: 'log',\n\t     *\n\t     *     ...\n\t     * })\n\t     */\n\t    define('widgets/log',[\n\t        'base',\n\t        'uploader',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader ) {\n\t        var $ = Base.$,\n\t            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n\t            product = (location.hostname || location.host || 'protected').toLowerCase(),\n\t\n\t            // 只针对 baidu 内部产品用户做统计功能。\n\t            enable = product && /baidu/i.exec(product),\n\t            base;\n\t\n\t        if (!enable) {\n\t            return;\n\t        }\n\t\n\t        base = {\n\t            dv: 3,\n\t            master: 'webuploader',\n\t            online: /test/.exec(product) ? 0 : 1,\n\t            module: '',\n\t            product: product,\n\t            type: 0\n\t        };\n\t\n\t        function send(data) {\n\t            var obj = $.extend({}, base, data),\n\t                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n\t                image = new Image();\n\t\n\t            image.src = url;\n\t        }\n\t\n\t        return Uploader.register({\n\t            name: 'log',\n\t\n\t            init: function() {\n\t                var owner = this.owner,\n\t                    count = 0,\n\t                    size = 0;\n\t\n\t                owner\n\t                    .on('error', function(code) {\n\t                        send({\n\t                            type: 2,\n\t                            c_error_code: code\n\t                        });\n\t                    })\n\t                    .on('uploadError', function(file, reason) {\n\t                        send({\n\t                            type: 2,\n\t                            c_error_code: 'UPLOAD_ERROR',\n\t                            c_reason: '' + reason\n\t                        });\n\t                    })\n\t                    .on('uploadComplete', function(file) {\n\t                        count++;\n\t                        size += file.size;\n\t                    }).\n\t                    on('uploadFinished', function() {\n\t                        send({\n\t                            c_count: count,\n\t                            c_size: size\n\t                        });\n\t                        count = size = 0;\n\t                    });\n\t\n\t                send({\n\t                    c_usage: 1\n\t                });\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Uploader上传类\n\t     */\n\t    define('webuploader',[\n\t        'preset/all',\n\t        'widgets/log'\n\t    ], function( preset ) {\n\t        return preset;\n\t    });\n\t    return require('webuploader');\n\t});\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 87 */,\n/* 88 */,\n/* 89 */,\n/* 90 */,\n/* 91 */,\n/* 92 */,\n/* 93 */,\n/* 94 */,\n/* 95 */,\n/* 96 */,\n/* 97 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar tpl = __webpack_require__(98);\n\tvar Dialog = __webpack_require__(37);\n\t\n\tvar create = function create(data, options) {\n\t    var content = tpl(data || {}); // 显示编辑弹窗之前,需要自己拼装数据\n\t    options = options || {};\n\t\n\t    var defaults = {\n\t        title: '选择图片',\n\t        modal: true,\n\t        fixed: true,\n\t        content: content,\n\t        className: 'pop-box',\n\t        okValue: '插入图片',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        cancalValue: '取消',\n\t        btnWrapCls: 'insert-cancel'\n\t        /*function () {\n\t            // var value = $('#property-returnValue-demo').val();\n\t            // this.close(value);\n\t            // this.remove();\n\t        }*/\n\t    };\n\t    $.extend(true, defaults, options);\n\t    return Dialog(defaults);\n\t};\n\t\n\tmodule.exports = {\n\t    create: create\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/upload/content',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,maxlength=$data.maxlength,total=$data.total,$out='';$out+='<div data-node=\"uploadBox\"> <div class=\"pics-list-wrap clearfix\"> <ul class=\"pics-list clearfix\" data-node=\"uploadList\"> <li data-defaultAddFile=\\'picker\\'></li> </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"addNum\">';\n\t$out+=$escape(maxlength);\n\t$out+='</span><span class=\"deep-gray\">/';\n\t$out+=$escape(total);\n\t$out+='</span>张图片</div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 99 */,\n/* 100 */,\n/* 101 */,\n/* 102 */,\n/* 103 */,\n/* 104 */,\n/* 105 */,\n/* 106 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t__webpack_require__(107);\n\t__webpack_require__(108);\n\t__webpack_require__(109);\n\t\n\t__webpack_require__(110);\n\t__webpack_require__(147);\n\t__webpack_require__(155);\n\t__webpack_require__(157);\n\tvar alert = __webpack_require__(36);\n\t//var detectQr = require('./plugin/detectQr');\n\t\n\tvar faceModule = __webpack_require__(158);\n\tvar opts = __webpack_require__(122);\n\t\n\t//商品选中增加遮罩\n\tvar goodsMask = __webpack_require__(159);\n\t//新增的文本过滤规则\n\tvar filterTxtRules = __webpack_require__(160);\n\t//草稿箱\n\tvar restoreData = __webpack_require__(161);\n\tvar init = function init(id) {\n\t    id = id || 'editor';\n\t    var editor = UE.getEditor(id, opts);\n\t\n\t    // 实例化表情，传入插入表情的回调方法。\n\t    var face = faceModule.init({\n\t        onSelected: function onSelected(data) {\n\t            var str = data.reg;\n\t            //var str = '<img src= \"' + data.url + '\" data-node=\"emoji\" width=\"22\" height=\"22\"/>'\n\t            editor.execCommand('inserthtml', str);\n\t        }\n\t    });\n\t    editor.face = face;\n\t\n\t    editor.addListener('ready', function () {\n\t\n\t        var defaultContent = editor.getContent();\n\t        var $editorBody = $(editor.body);\n\t        var placeholderCls = 'placeholder';\n\t        var $container = $(editor.container);\n\t        $editorBody.addClass(placeholderCls);\n\t        $editorBody.delegate('.publish-item a', 'click', function (e) {\n\t            e.stopPropagation();\n\t            e.preventDefault();\n\t        });\n\t        editor.addListener('focus', function () {\n\t            $editorBody.removeClass(placeholderCls);\n\t            $container.addClass('edui-nobg');\n\t        });\n\t        editor.addListener('blur', function () {\n\t            var hasDiv = !!$editorBody.find('div').length;\n\t            var isEqDefault = editor.getContent() == defaultContent;\n\t            var isContentEmpty = $.trim(editor.getContent()) == '';\n\t\n\t            if (isEqDefault && hasDiv || isContentEmpty) {\n\t                $editorBody.addClass(placeholderCls);\n\t                $container.removeClass('edui-nobg');\n\t            } else {\n\t                $editorBody.removeClass(placeholderCls);\n\t                $container.addClass('edui-nobg');\n\t            }\n\t        });\n\t        //加载草稿箱\n\t        restoreData(editor);\n\t        //文字过滤规则\n\t        filterTxtRules(editor);\n\t        //点击商品显示遮罩\n\t        goodsMask(editor);\n\t\n\t        var $emojiBtn = $(editor.container.firstChild).find('.edui-for-insertemoji');\n\t        var $pictorBtn = $(editor.container.firstChild).find('.edui-for-insertpicture');\n\t        var $picPopBox = $('[data-node=picPopBox]');\n\t        // 让表情包随着editorBar的fixed一起fixed\n\t        $(window).on('scroll', function () {\n\t            var flagY = $emojiBtn.offset().top;\n\t            var scrollTop = $(window).scrollTop();\n\t            var top;\n\t\n\t            if (scrollTop > flagY) {\n\t                top = 0;\n\t            } else {\n\t                top = flagY;\n\t            }\n\t            top = top / 1 + 30;\n\t\n\t            $picPopBox.css({\n\t                'top': top + 'px'\n\t            });\n\t\n\t            if (!face.isShow) {\n\t                return;\n\t            }\n\t            face.$dom.css({\n\t                top: top + 'px'\n\t            });\n\t        });\n\t\n\t        // 阻止表情按钮事件冒泡\n\t        $emojiBtn.on('click', function (e) {\n\t            $picPopBox.hide();\n\t            e.stopPropagation();\n\t            e.preventDefault();\n\t        });\n\t\n\t        $pictorBtn.on('click', function (e) {\n\t            face.hide();\n\t            e.stopPropagation();\n\t            e.preventDefault();\n\t        });\n\t\n\t        $(\"body\").on('click', function () {\n\t            $picPopBox.hide();\n\t            face.hide();\n\t        });\n\t\n\t        $(editor.body).on('focus', function () {\n\t            if (editor.sensitiveWord) {\n\t                $.each($(editor.body).find('span[class=bg-warning]'), function (i, v) {\n\t                    $(v).on('mouseup', function () {\n\t                        $(v).removeClass('bg-warning');\n\t                    });\n\t                });\n\t                editor.sensitiveWord = false;\n\t            }\n\t            face.hide();\n\t        });\n\t        $(editor.body).on('click', function () {\n\t            face.hide();\n\t        });\n\t    });\n\t\n\t    return editor;\n\t};\n\t\n\tmodule.exports = init;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 107 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\n\t * ueditor完整配置项\n\t * 可以在这里配置整个编辑器的特性\n\t */\n\t/**************************提示********************************\n\t * 所有被注释的配置项均为UEditor默认值。\n\t * 修改默认配置请首先确保已经完全明确该参数的真实用途。\n\t * 主要有两种修改方案，一种是取消此处注释，然后修改成对应参数；另一种是在实例化编辑器时传入对应参数。\n\t * 当升级编辑器时，可直接使用旧版配置文件替换新版配置文件,不用担心旧版配置文件中因缺少新功能所需的参数而导致脚本报错。\n\t **************************提示********************************/\n\t\n\t(function () {\n\t\n\t    /**\n\t     * 编辑器资源文件根路径。它所表示的含义是：以编辑器实例化页面为当前路径，指向编辑器资源文件（即dialog等文件夹）的路径。\n\t     * 鉴于很多同学在使用编辑器的时候出现的种种路径问题，此处强烈建议大家使用\"相对于网站根目录的相对路径\"进行配置。\n\t     * \"相对于网站根目录的相对路径\"也就是以斜杠开头的形如\"/myProject/ueditor/\"这样的路径。\n\t     * 如果站点中有多个不在同一层级的页面需要实例化编辑器，且引用了同一UEditor的时候，此处的URL可能不适用于每个页面的编辑器。\n\t     * 因此，UEditor提供了针对不同页面的编辑器可单独配置的根路径，具体来说，在需要实例化编辑器的页面最顶部写上如下代码即可。当然，需要令此处的URL等于对应的配置。\n\t     * window.UEDITOR_HOME_URL = \"/xxxx/xxxx/\";\n\t     */\n\t\n\t    //window.UEDITOR_HOME_URL = \"http://js.dev.meixincdn.com:8017/src/js/module/editor/\"\n\t    var URL = window.UEDITOR_HOME_URL || getUEBasePath();\n\t\n\t    /**\n\t     * 配置项主体。注意，此处所有涉及到路径的配置别遗漏URL变量。\n\t     */\n\t    window.UEDITOR_CONFIG = {\n\t\n\t        //为编辑器实例添加一个路径，这个不能被注释\n\t        UEDITOR_HOME_URL: URL\n\t        // 服务器统一请求接口路径\n\t        // , serverUrl: URL + \"php/controller.php\"\n\t\n\t        , serverUrl: \"http://127.0.0.1/utf8-php/php/controller.php\"\n\t        //工具栏上的所有的功能按钮和下拉框，可以在new编辑器的实例时选择自己需要的重新定义\n\t\n\t        , /*toolbars: [[\n\t              'fullscreen', 'source', '|', 'undo', 'redo', '|',\n\t              'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', '|',\n\t              'rowspacingtop', 'rowspacingbottom', 'lineheight', '|',\n\t              'customstyle', 'paragraph', 'fontfamily', 'fontsize', '|',\n\t              'directionalityltr', 'directionalityrtl', 'indent', '|',\n\t              'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|', 'touppercase', 'tolowercase', '|',\n\t              'link', 'unlink', 'anchor', '|', 'imagenone', 'imageleft', 'imageright', 'imagecenter', '|',\n\t              'simpleupload', 'insertimage', 'emotion', 'scrawl', 'insertvideo', 'music', 'attachment', 'map', 'gmap', 'insertframe', 'insertcode', 'webapp', 'pagebreak', 'template', 'background', '|',\n\t              'horizontal', 'date', 'time', 'spechars', 'snapscreen', 'wordimage', '|',\n\t              'inserttable', 'deletetable', 'insertparagraphbeforetable', 'insertrow', 'deleterow', 'insertcol', 'deletecol', 'mergecells', 'mergeright', 'mergedown', 'splittocells', 'splittorows', 'splittocols', 'charts', '|',\n\t              'print', 'preview', 'searchreplace', 'drafts', 'help'\n\t          ]]*/\n\t        toolbars: [[]]\n\t        //当鼠标放在工具栏上时显示的tooltip提示,留空支持自动多语言配置，否则以配置值为准\n\t        //,labelMap:{\n\t        //    'anchor':'', 'undo':''\n\t        //}\n\t\n\t        //语言配置项,默认是zh-cn。有需要的话也可以使用如下这样的方式来自动多语言切换，当然，前提条件是lang文件夹下存在对应的语言文件：\n\t        //lang值也可以通过自动获取 (navigator.language||navigator.browserLanguage ||navigator.userLanguage).toLowerCase()\n\t        //,lang:\"zh-cn\"\n\t        //,langPath:URL +\"lang/\"\n\t\n\t        //主题配置项,默认是default。有需要的话也可以使用如下这样的方式来自动多主题切换，当然，前提条件是themes文件夹下存在对应的主题文件：\n\t        //现有如下皮肤:default\n\t        //,theme:'default'\n\t        //,themePath:URL +\"themes/\"\n\t\n\t        //,zIndex : 900     //编辑器层级的基数,默认是900\n\t\n\t        //针对getAllHtml方法，会在对应的head标签中增加该编码设置。\n\t        //,charset:\"utf-8\"\n\t\n\t        //若实例化编辑器的页面手动修改的domain，此处需要设置为true\n\t        //,customDomain:false\n\t\n\t        //常用配置项目\n\t        //,isShow : true    //默认显示编辑器\n\t\n\t        //,textarea:'editorValue' // 提交表单时，服务器获取编辑器提交内容的所用的参数，多实例时可以给容器name属性，会将name给定的值最为每个实例的键值，不用每次实例化的时候都设置这个值\n\t\n\t        //,initialContent:'欢迎使用ueditor!'    //初始化编辑器的内容,也可以通过textarea/script给值，看官网例子\n\t\n\t        //,autoClearinitialContent:true //是否自动清除编辑器初始内容，注意：如果focus属性设置为true,这个也为真，那么编辑器一上来就会触发导致初始化的内容看不到了\n\t\n\t        //,focus:false //初始化时，是否让编辑器获得焦点true或false\n\t\n\t        //如果自定义，最好给p标签如下的行高，要不输入中文时，会有跳动感\n\t        //,initialStyle:'p{line-height:1em}'//编辑器层级的基数,可以用来改变字体等\n\t\n\t        //,iframeCssUrl: URL + '/themes/iframe.css' //给编辑区域的iframe引入一个css文件\n\t\n\t        //indentValue\n\t        //首行缩进距离,默认是2em\n\t        //,indentValue:'2em'\n\t\n\t        //,initialFrameWidth:1000  //初始化编辑器宽度,默认1000\n\t        //,initialFrameHeight:320  //初始化编辑器高度,默认320\n\t\n\t        //,readonly : false //编辑器初始化结束后,编辑区域是否是只读的，默认是false\n\t\n\t        //,autoClearEmptyNode : true //getContent时，是否删除空的inlineElement节点（包括嵌套的情况）\n\t\n\t        //启用自动保存\n\t        //,enableAutoSave: true\n\t        //自动保存间隔时间， 单位ms\n\t        //,saveInterval: 500\n\t\n\t        //,fullscreen : false //是否开启初始化时即全屏，默认关闭\n\t\n\t        //,imagePopup:true      //图片操作的浮层开关，默认打开\n\t\n\t        //,autoSyncData:true //自动同步编辑器要提交的数据\n\t        //,emotionLocalization:false //是否开启表情本地化，默认关闭。若要开启请确保emotion文件夹下包含官网提供的images表情文件夹\n\t\n\t        //粘贴只保留标签，去除标签所有属性\n\t        //,retainOnlyLabelPasted: false\n\t\n\t        //,pasteplain:false  //是否默认为纯文本粘贴。false为不使用纯文本粘贴，true为使用纯文本粘贴\n\t        //纯文本粘贴模式下的过滤规则\n\t        //'filterTxtRules' : function(){\n\t        //    function transP(node){\n\t        //        node.tagName = 'p';\n\t        //        node.setStyle();\n\t        //    }\n\t        //    return {\n\t        //        //直接删除及其字节点内容\n\t        //        '-' : 'script style object iframe embed input select',\n\t        //        'p': {$:{}},\n\t        //        'br':{$:{}},\n\t        //        'div':{'$':{}},\n\t        //        'li':{'$':{}},\n\t        //        'caption':transP,\n\t        //        'th':transP,\n\t        //        'tr':transP,\n\t        //        'h1':transP,'h2':transP,'h3':transP,'h4':transP,'h5':transP,'h6':transP,\n\t        //        'td':function(node){\n\t        //            //没有内容的td直接删掉\n\t        //            var txt = !!node.innerText();\n\t        //            if(txt){\n\t        //                node.parentNode.insertAfter(UE.uNode.createText(' &nbsp; &nbsp;'),node);\n\t        //            }\n\t        //            node.parentNode.removeChild(node,node.innerText())\n\t        //        }\n\t        //    }\n\t        //}()\n\t\n\t        //,allHtmlEnabled:false //提交到后台的数据是否包含整个html字符串\n\t\n\t        //insertorderedlist\n\t        //有序列表的下拉配置,值留空时支持多语言自动识别，若配置值，则以此值为准\n\t        //,'insertorderedlist':{\n\t        //      //自定的样式\n\t        //        'num':'1,2,3...',\n\t        //        'num1':'1),2),3)...',\n\t        //        'num2':'(1),(2),(3)...',\n\t        //        'cn':'一,二,三....',\n\t        //        'cn1':'一),二),三)....',\n\t        //        'cn2':'(一),(二),(三)....',\n\t        //     //系统自带\n\t        //     'decimal' : '' ,         //'1,2,3...'\n\t        //     'lower-alpha' : '' ,    // 'a,b,c...'\n\t        //     'lower-roman' : '' ,    //'i,ii,iii...'\n\t        //     'upper-alpha' : '' , lang   //'A,B,C'\n\t        //     'upper-roman' : ''      //'I,II,III...'\n\t        //}\n\t\n\t        //insertunorderedlist\n\t        //无序列表的下拉配置，值留空时支持多语言自动识别，若配置值，则以此值为准\n\t        //,insertunorderedlist : { //自定的样式\n\t        //    'dash' :'— 破折号', //-破折号\n\t        //    'dot':' 。 小圆圈', //系统自带\n\t        //    'circle' : '',  // '○ 小圆圈'\n\t        //    'disc' : '',    // '● 小圆点'\n\t        //    'square' : ''   //'■ 小方块'\n\t        //}\n\t        //,listDefaultPaddingLeft : '30'//默认的左边缩进的基数倍\n\t        //,listiconpath : 'http://bs.baidu.com/listicon/'//自定义标号的路径\n\t        //,maxListLevel : 3 //限制可以tab的级数, 设置-1为不限制\n\t\n\t        //,autoTransWordToList:false  //禁止word中粘贴进来的列表自动变成列表标签\n\t\n\t        //fontfamily\n\t        //字体设置 label留空支持多语言自动切换，若配置，则以配置值为准\n\t        //,'fontfamily':[\n\t        //    { label:'',name:'songti',val:'宋体,SimSun'},\n\t        //    { label:'',name:'kaiti',val:'楷体,楷体_GB2312, SimKai'},\n\t        //    { label:'',name:'yahei',val:'微软雅黑,Microsoft YaHei'},\n\t        //    { label:'',name:'heiti',val:'黑体, SimHei'},\n\t        //    { label:'',name:'lishu',val:'隶书, SimLi'},\n\t        //    { label:'',name:'andaleMono',val:'andale mono'},\n\t        //    { label:'',name:'arial',val:'arial, helvetica,sans-serif'},\n\t        //    { label:'',name:'arialBlack',val:'arial black,avant garde'},\n\t        //    { label:'',name:'comicSansMs',val:'comic sans ms'},\n\t        //    { label:'',name:'impact',val:'impact,chicago'},\n\t        //    { label:'',name:'timesNewRoman',val:'times new roman'}\n\t        //]\n\t\n\t        //fontsize\n\t        //字号\n\t        //,'fontsize':[10, 11, 12, 14, 16, 18, 20, 24, 36]\n\t\n\t        //paragraph\n\t        //段落格式 值留空时支持多语言自动识别，若配置，则以配置值为准\n\t        //,'paragraph':{'p':'', 'h1':'', 'h2':'', 'h3':'', 'h4':'', 'h5':'', 'h6':''}\n\t\n\t        //rowspacingtop\n\t        //段间距 值和显示的名字相同\n\t        //,'rowspacingtop':['5', '10', '15', '20', '25']\n\t\n\t        //rowspacingBottom\n\t        //段间距 值和显示的名字相同\n\t        //,'rowspacingbottom':['5', '10', '15', '20', '25']\n\t\n\t        //lineheight\n\t        //行内间距 值和显示的名字相同\n\t        //,'lineheight':['1', '1.5','1.75','2', '3', '4', '5']\n\t\n\t        //customstyle\n\t        //自定义样式，不支持国际化，此处配置值即可最后显示值\n\t        //block的元素是依据设置段落的逻辑设置的，inline的元素依据BIU的逻辑设置\n\t        //尽量使用一些常用的标签\n\t        //参数说明\n\t        //tag 使用的标签名字\n\t        //label 显示的名字也是用来标识不同类型的标识符，注意这个值每个要不同，\n\t        //style 添加的样式\n\t        //每一个对象就是一个自定义的样式\n\t        //,'customstyle':[\n\t        //    {tag:'h1', name:'tc', label:'', style:'border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;'},\n\t        //    {tag:'h1', name:'tl',label:'', style:'border-bottom:#ccc 2px solid;padding:0 4px 0 0;margin:0 0 10px 0;'},\n\t        //    {tag:'span',name:'im', label:'', style:'font-style:italic;font-weight:bold'},\n\t        //    {tag:'span',name:'hi', label:'', style:'font-style:italic;font-weight:bold;color:rgb(51, 153, 204)'}\n\t        //]\n\t\n\t        //打开右键菜单功能\n\t        //,enableContextMenu: true\n\t        //右键菜单的内容，可以参考plugins/contextmenu.js里边的默认菜单的例子，label留空支持国际化，否则以此配置为准\n\t        //,contextMenu:[\n\t        //    {\n\t        //        label:'',       //显示的名称\n\t        //        cmdName:'selectall',//执行的command命令，当点击这个右键菜单时\n\t        //        //exec可选，有了exec就会在点击时执行这个function，优先级高于cmdName\n\t        //        exec:function () {\n\t        //            //this是当前编辑器的实例\n\t        //            //this.ui._dialogs['inserttableDialog'].open();\n\t        //        }\n\t        //    }\n\t        //]\n\t\n\t        //快捷菜单\n\t        //,shortcutMenu:[\"fontfamily\", \"fontsize\", \"bold\", \"italic\", \"underline\", \"forecolor\", \"backcolor\", \"insertorderedlist\", \"insertunorderedlist\"]\n\t\n\t        //elementPathEnabled\n\t        //是否启用元素路径，默认是显示\n\t        //,elementPathEnabled : true\n\t\n\t        //wordCount\n\t        //,wordCount:true          //是否开启字数统计\n\t        //,maximumWords:10000       //允许的最大字符数\n\t        //字数统计提示，{#count}代表当前字数，{#leave}代表还可以输入多少字符数,留空支持多语言自动切换，否则按此配置显示\n\t        //,wordCountMsg:''   //当前已输入 {#count} 个字符，您还可以输入{#leave} 个字符\n\t        //超出字数限制提示  留空支持多语言自动切换，否则按此配置显示\n\t        //,wordOverFlowMsg:''    //<span style=\"color:red;\">你输入的字符个数已经超出最大允许值，服务器可能会拒绝保存！</span>\n\t\n\t        //tab\n\t        //点击tab键时移动的距离,tabSize倍数，tabNode什么字符做为单位\n\t        //,tabSize:4\n\t        //,tabNode:'&nbsp;'\n\t\n\t        //removeFormat\n\t        //清除格式时可以删除的标签和属性\n\t        //removeForamtTags标签\n\t        //,removeFormatTags:'b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var'\n\t        //removeFormatAttributes属性\n\t        //,removeFormatAttributes:'class,style,lang,width,height,align,hspace,valign'\n\t\n\t        //undo\n\t        //可以最多回退的次数,默认20\n\t        //,maxUndoCount:20\n\t        //当输入的字符数超过该值时，保存一次现场\n\t        //,maxInputCount:1\n\t\n\t        //autoHeightEnabled\n\t        // 是否自动长高,默认true\n\t        //,autoHeightEnabled:true\n\t\n\t        //scaleEnabled\n\t        //是否可以拉伸长高,默认true(当开启时，自动长高失效)\n\t        //,scaleEnabled:false\n\t        //,minFrameWidth:800    //编辑器拖动时最小宽度,默认800\n\t        //,minFrameHeight:220  //编辑器拖动时最小高度,默认220\n\t\n\t        //autoFloatEnabled\n\t        //是否保持toolbar的位置不动,默认true\n\t        //,autoFloatEnabled:true\n\t        //浮动时工具栏距离浏览器顶部的高度，用于某些具有固定头部的页面\n\t        //,topOffset:30\n\t        //编辑器底部距离工具栏高度(如果参数大于等于编辑器高度，则设置无效)\n\t        //,toolbarTopOffset:400\n\t\n\t        //设置远程图片是否抓取到本地保存\n\t        //,catchRemoteImageEnable: true //设置是否抓取远程图片\n\t\n\t        //pageBreakTag\n\t        //分页标识符,默认是_ueditor_page_break_tag_\n\t        //,pageBreakTag:'_ueditor_page_break_tag_'\n\t\n\t        //autotypeset\n\t        //自动排版参数\n\t        //,autotypeset: {\n\t        //    mergeEmptyline: true,           //合并空行\n\t        //    removeClass: true,              //去掉冗余的class\n\t        //    removeEmptyline: false,         //去掉空行\n\t        //    textAlign:\"left\",               //段落的排版方式，可以是 left,right,center,justify 去掉这个属性表示不执行排版\n\t        //    imageBlockLine: 'center',       //图片的浮动方式，独占一行剧中,左右浮动，默认: center,left,right,none 去掉这个属性表示不执行排版\n\t        //    pasteFilter: false,             //根据规则过滤没事粘贴进来的内容\n\t        //    clearFontSize: false,           //去掉所有的内嵌字号，使用编辑器默认的字号\n\t        //    clearFontFamily: false,         //去掉所有的内嵌字体，使用编辑器默认的字体\n\t        //    removeEmptyNode: false,         // 去掉空节点\n\t        //    //可以去掉的标签\n\t        //    removeTagNames: {标签名字:1},\n\t        //    indent: false,                  // 行首缩进\n\t        //    indentValue : '2em',            //行首缩进的大小\n\t        //    bdc2sb: false,\n\t        //    tobdc: false\n\t        //}\n\t\n\t        //tableDragable\n\t        //表格是否可以拖拽\n\t        //,tableDragable: true\n\t\n\t        //sourceEditor\n\t        //源码的查看方式,codemirror 是代码高亮，textarea是文本框,默认是codemirror\n\t        //注意默认codemirror只能在ie8+和非ie中使用\n\t        //,sourceEditor:\"codemirror\"\n\t        //如果sourceEditor是codemirror，还用配置一下两个参数\n\t        //codeMirrorJsUrl js加载的路径，默认是 URL + \"third-party/codemirror/codemirror.js\"\n\t        //,codeMirrorJsUrl:URL + \"third-party/codemirror/codemirror.js\"\n\t        //codeMirrorCssUrl css加载的路径，默认是 URL + \"third-party/codemirror/codemirror.css\"\n\t        //,codeMirrorCssUrl:URL + \"third-party/codemirror/codemirror.css\"\n\t        //编辑器初始化完成后是否进入源码模式，默认为否。\n\t        //,sourceEditorFirst:false\n\t\n\t        //iframeUrlMap\n\t        //dialog内容的路径 ～会被替换成URL,垓属性一旦打开，将覆盖所有的dialog的默认路径\n\t        //,iframeUrlMap:{\n\t        //    'anchor':'~/dialogs/anchor/anchor.html',\n\t        //}\n\t\n\t        //allowLinkProtocol 允许的链接地址，有这些前缀的链接地址不会自动添加http\n\t        //, allowLinkProtocols: ['http:', 'https:', '#', '/', 'ftp:', 'mailto:', 'tel:', 'git:', 'svn:']\n\t\n\t        //webAppKey 百度应用的APIkey，每个站长必须首先去百度官网注册一个key后方能正常使用app功能，注册介绍，http://app.baidu.com/static/cms/getapikey.html\n\t        //, webAppKey: \"\"\n\t\n\t        //默认过滤规则相关配置项目\n\t        //,disabledTableInTable:true  //禁止表格嵌套\n\t        //,allowDivTransToP:true      //允许进入编辑器的div标签自动变成p标签\n\t        //,rgb2Hex:true               //默认产出的数据中的color自动从rgb格式变成16进制格式\n\t\n\t        // xss 过滤是否开启,inserthtml等操作\n\t\n\t        , xssFilterRules: true\n\t        //input xss过滤\n\t\n\t        , inputXssFilter: true\n\t        //output xss过滤\n\t\n\t        , outputXssFilter: true\n\t        // xss过滤白名单 名单来源: https://raw.githubusercontent.com/leizongmin/js-xss/master/lib/default.js\n\t\n\t        , whitList: {\n\t            a: ['target', 'style', 'href', 'title', 'class'],\n\t            abbr: ['title', 'class', 'style'],\n\t            address: ['class', 'style'],\n\t            area: ['shape', 'coords', 'href', 'alt'],\n\t            article: [],\n\t            aside: [],\n\t            audio: ['autoplay', 'controls', 'loop', 'preload', 'src', 'class', 'style'],\n\t            b: ['class', 'style'],\n\t            bdi: ['dir'],\n\t            bdo: ['dir'],\n\t            big: [],\n\t            blockquote: ['cite', 'class', 'style'],\n\t            br: [],\n\t            caption: ['class', 'style'],\n\t            center: [],\n\t            cite: [],\n\t            code: ['class', 'style'],\n\t            col: ['align', 'valign', 'span', 'width', 'class', 'style'],\n\t            colgroup: ['align', 'valign', 'span', 'width', 'class', 'style'],\n\t            dd: ['class', 'style'],\n\t            del: ['datetime'],\n\t            details: ['open'],\n\t            div: ['class', 'style', 'data-node', 'data-type', 'contenteditable', 'data-pid', 'data-info', 'data-goodsinfo', 'data-skuid'],\n\t            dl: ['class', 'style'],\n\t            dt: ['class', 'style'],\n\t            em: ['class', 'style'],\n\t            font: ['color', 'size', 'face'],\n\t            footer: [],\n\t            h1: ['data-node'],\n\t            h2: ['data-node'],\n\t            h3: ['class', 'data-node'],\n\t            h4: ['data-node'],\n\t            h5: ['data-node'],\n\t            h6: ['data-node'],\n\t            header: [],\n\t            hr: [],\n\t            i: ['class', 'style'],\n\t            img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-type', 'data-face', 'data-t', 'data-original', 'onerror', 'proto'],\n\t            ins: ['datetime'],\n\t            li: ['class', 'style'],\n\t            mark: [],\n\t            nav: [],\n\t            ol: ['class', 'style'],\n\t            p: ['class', 'style'],\n\t            pre: ['class', 'style'],\n\t            s: [],\n\t            section: [],\n\t            small: [],\n\t            span: ['class', 'style'],\n\t            sub: ['class', 'style'],\n\t            sup: ['class', 'style'],\n\t            strong: ['class', 'style'],\n\t            table: ['width', 'border', 'align', 'valign', 'class', 'style'],\n\t            tbody: ['align', 'valign', 'class', 'style'],\n\t            td: ['width', 'rowspan', 'colspan', 'align', 'valign', 'class', 'style'],\n\t            tfoot: ['align', 'valign', 'class', 'style'],\n\t            th: ['width', 'rowspan', 'colspan', 'align', 'valign', 'class', 'style'],\n\t            thead: ['align', 'valign', 'class', 'style'],\n\t            tr: ['rowspan', 'align', 'valign', 'class', 'style'],\n\t            tt: [],\n\t            u: [],\n\t            ul: ['class', 'style'],\n\t            video: ['autoplay', 'controls', 'loop', 'preload', 'src', 'height', 'width', 'class', 'style']\n\t        }\n\t    };\n\t\n\t    function getUEBasePath(docUrl, confUrl) {\n\t\n\t        return getBasePath(docUrl || self.document.URL || self.location.href, confUrl || getConfigFilePath());\n\t    }\n\t\n\t    function getConfigFilePath() {\n\t\n\t        var configPath = document.getElementsByTagName('script');\n\t\n\t        return configPath[configPath.length - 1].src;\n\t    }\n\t\n\t    function getBasePath(docUrl, confUrl) {\n\t\n\t        var basePath = confUrl;\n\t\n\t        if (/^(\\/|\\\\\\\\)/.test(confUrl)) {\n\t\n\t            basePath = /^.+?\\w(\\/|\\\\\\\\)/.exec(docUrl)[0] + confUrl.replace(/^(\\/|\\\\\\\\)/, '');\n\t        } else if (!/^[a-z]+:/i.test(confUrl)) {\n\t\n\t            docUrl = docUrl.split(\"#\")[0].split(\"?\")[0].replace(/[^\\\\\\/]+$/, '');\n\t\n\t            basePath = docUrl + \"\" + confUrl;\n\t        }\n\t\n\t        return optimizationPath(basePath);\n\t    }\n\t\n\t    function optimizationPath(path) {\n\t\n\t        var protocol = /^[a-z]+:\\/\\//.exec(path)[0],\n\t            tmp = null,\n\t            res = [];\n\t\n\t        path = path.replace(protocol, \"\").split(\"?\")[0].split(\"#\")[0];\n\t\n\t        path = path.replace(/\\\\/g, '/').split(/\\//);\n\t\n\t        path[path.length - 1] = \"\";\n\t\n\t        while (path.length) {\n\t\n\t            if ((tmp = path.shift()) === \"..\") {\n\t                res.pop();\n\t            } else if (tmp !== \".\") {\n\t                res.push(tmp);\n\t            }\n\t        }\n\t\n\t        return protocol + res.join(\"/\");\n\t    }\n\t\n\t    window.UE = {\n\t        getUEBasePath: getUEBasePath\n\t    };\n\t})();\n\n/***/ }),\n/* 108 */\n/***/ (function(module, exports) {\n\n\t/*!\n\t * UEditor\n\t * version: ueditor\n\t * build: Wed Aug 10 2016 11:06:02 GMT+0800 (CST)\n\t */\n\t\n\t(function() {\n\t\t// editor.js\n\t\tUEDITOR_CONFIG = window.UEDITOR_CONFIG || {};\n\t\n\t\tvar baidu = window.baidu || {};\n\t\n\t\twindow.baidu = baidu;\n\t\n\t\twindow.UE = baidu.editor = window.UE || {};\n\t\n\t\tUE.plugins = {};\n\t\n\t\tUE.commands = {};\n\t\n\t\tUE.instants = {};\n\t\n\t\tUE.I18N = {};\n\t\n\t\tUE._customizeUI = {};\n\t\n\t\tUE.version = \"1.4.3\";\n\t\n\t\tvar dom = UE.dom = {};\n\t\n\t\t// core/browser.js\n\t\t/**\n\t\t * 浏览器判断模块\n\t\t * @file\n\t\t * @module UE.browser\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 提供浏览器检测的模块\n\t\t * @unfile\n\t\t * @module UE.browser\n\t\t */\n\t\tvar browser = UE.browser = function() {\n\t\t\tvar agent = navigator.userAgent.toLowerCase(),\n\t\t\t\topera = window.opera,\n\t\t\t\tbrowser = {\n\t\t\t\t\t/**\n\t\t\t\t\t * @property {boolean} ie 检测当前浏览器是否为IE\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * if ( UE.browser.ie ) {\n\t\t\t\t\t *     console.log( '当前浏览器是IE' );\n\t\t\t\t\t * }\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\tie: /(msie\\s|trident.*rv:)([\\w.]+)/.test(agent),\n\t\n\t\t\t\t\t/**\n\t\t\t\t\t * @property {boolean} opera 检测当前浏览器是否为Opera\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * if ( UE.browser.opera ) {\n\t\t\t\t\t *     console.log( '当前浏览器是Opera' );\n\t\t\t\t\t * }\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\topera: (!!opera && opera.version),\n\t\n\t\t\t\t\t/**\n\t\t\t\t\t * @property {boolean} webkit 检测当前浏览器是否是webkit内核的浏览器\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * if ( UE.browser.webkit ) {\n\t\t\t\t\t *     console.log( '当前浏览器是webkit内核浏览器' );\n\t\t\t\t\t * }\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\twebkit: (agent.indexOf(' applewebkit/') > -1),\n\t\n\t\t\t\t\t/**\n\t\t\t\t\t * @property {boolean} mac 检测当前浏览器是否是运行在mac平台下\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * if ( UE.browser.mac ) {\n\t\t\t\t\t *     console.log( '当前浏览器运行在mac平台下' );\n\t\t\t\t\t * }\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\tmac: (agent.indexOf('macintosh') > -1),\n\t\n\t\t\t\t\t/**\n\t\t\t\t\t * @property {boolean} quirks 检测当前浏览器是否处于“怪异模式”下\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * if ( UE.browser.quirks ) {\n\t\t\t\t\t *     console.log( '当前浏览器运行处于“怪异模式”' );\n\t\t\t\t\t * }\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\tquirks: (document.compatMode == 'BackCompat')\n\t\t\t\t};\n\t\n\t\t\t/**\n\t\t\t * @property {boolean} gecko 检测当前浏览器内核是否是gecko内核\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.gecko ) {\n\t\t\t *     console.log( '当前浏览器内核是gecko内核' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.gecko = (navigator.product == 'Gecko' && !browser.webkit && !browser.opera && !browser.ie);\n\t\n\t\t\tvar version = 0;\n\t\n\t\t\t// Internet Explorer 6.0+\n\t\t\tif (browser.ie) {\n\t\n\t\t\t\tvar v1 = agent.match(/(?:msie\\s([\\w.]+))/);\n\t\t\t\tvar v2 = agent.match(/(?:trident.*rv:([\\w.]+))/);\n\t\t\t\tif (v1 && v2 && v1[1] && v2[1]) {\n\t\t\t\t\tversion = Math.max(v1[1] * 1, v2[1] * 1);\n\t\t\t\t} else if (v1 && v1[1]) {\n\t\t\t\t\tversion = v1[1] * 1;\n\t\t\t\t} else if (v2 && v2[1]) {\n\t\t\t\t\tversion = v2[1] * 1;\n\t\t\t\t} else {\n\t\t\t\t\tversion = 0;\n\t\t\t\t}\n\t\n\t\t\t\tbrowser.ie11Compat = document.documentMode == 11;\n\t\t\t\t/**\n\t\t\t\t * @property { boolean } ie9Compat 检测浏览器模式是否为 IE9 兼容模式\n\t\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.ie9Compat ) {\n\t\t\t\t *     console.log( '当前浏览器运行在IE9兼容模式下' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tbrowser.ie9Compat = document.documentMode == 9;\n\t\n\t\t\t\t/**\n\t\t\t\t * @property { boolean } ie8 检测浏览器是否是IE8浏览器\n\t\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.ie8 ) {\n\t\t\t\t *     console.log( '当前浏览器是IE8浏览器' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tbrowser.ie8 = !!document.documentMode;\n\t\n\t\t\t\t/**\n\t\t\t\t * @property { boolean } ie8Compat 检测浏览器模式是否为 IE8 兼容模式\n\t\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.ie8Compat ) {\n\t\t\t\t *     console.log( '当前浏览器运行在IE8兼容模式下' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tbrowser.ie8Compat = document.documentMode == 8;\n\t\n\t\t\t\t/**\n\t\t\t\t * @property { boolean } ie7Compat 检测浏览器模式是否为 IE7 兼容模式\n\t\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.ie7Compat ) {\n\t\t\t\t *     console.log( '当前浏览器运行在IE7兼容模式下' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tbrowser.ie7Compat = ((version == 7 && !document.documentMode) || document.documentMode == 7);\n\t\n\t\t\t\t/**\n\t\t\t\t * @property { boolean } ie6Compat 检测浏览器模式是否为 IE6 模式 或者怪异模式\n\t\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.ie6Compat ) {\n\t\t\t\t *     console.log( '当前浏览器运行在IE6模式或者怪异模式下' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tbrowser.ie6Compat = (version < 7 || browser.quirks);\n\t\n\t\t\t\tbrowser.ie9above = version > 8;\n\t\n\t\t\t\tbrowser.ie9below = version < 9;\n\t\n\t\t\t\tbrowser.ie11above = version > 10;\n\t\n\t\t\t\tbrowser.ie11below = version < 11;\n\t\n\t\t\t}\n\t\n\t\t\t// Gecko.\n\t\t\tif (browser.gecko) {\n\t\t\t\tvar geckoRelease = agent.match(/rv:([\\d\\.]+)/);\n\t\t\t\tif (geckoRelease) {\n\t\t\t\t\tgeckoRelease = geckoRelease[1].split('.');\n\t\t\t\t\tversion = geckoRelease[0] * 10000 + (geckoRelease[1] || 0) * 100 + (geckoRelease[2] || 0) * 1;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * @property { Number } chrome 检测当前浏览器是否为Chrome, 如果是，则返回Chrome的大版本号\n\t\t\t * @warning 如果浏览器不是chrome， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.chrome ) {\n\t\t\t *     console.log( '当前浏览器是Chrome' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tif (/chrome\\/(\\d+\\.\\d)/i.test(agent)) {\n\t\t\t\tbrowser.chrome = +RegExp['\\x241'];\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * @property { Number } safari 检测当前浏览器是否为Safari, 如果是，则返回Safari的大版本号\n\t\t\t * @warning 如果浏览器不是safari， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.safari ) {\n\t\t\t *     console.log( '当前浏览器是Safari' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tif (/(\\d+\\.\\d)?(?:\\.\\d)?\\s+safari\\/?(\\d+\\.\\d+)?/i.test(agent) && !/chrome/i.test(agent)) {\n\t\t\t\tbrowser.safari = +(RegExp['\\x241'] || RegExp['\\x242']);\n\t\t\t}\n\t\n\t\t\t// Opera 9.50+\n\t\t\tif (browser.opera)\n\t\t\t\tversion = parseFloat(opera.version());\n\t\n\t\t\t// WebKit 522+ (Safari 3+)\n\t\t\tif (browser.webkit)\n\t\t\t\tversion = parseFloat(agent.match(/ applewebkit\\/(\\d+)/)[1]);\n\t\n\t\t\t/**\n\t\t\t * @property { Number } version 检测当前浏览器版本号\n\t\t\t * @remind\n\t\t\t * <ul>\n\t\t\t *     <li>IE系列返回值为5,6,7,8,9,10等</li>\n\t\t\t *     <li>gecko系列会返回10900，158900等</li>\n\t\t\t *     <li>webkit系列会返回其build号 (如 522等)</li>\n\t\t\t * </ul>\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * console.log( '当前浏览器版本号是： ' + UE.browser.version );\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.version = version;\n\t\n\t\t\t/**\n\t\t\t * @property { boolean } isCompatible 检测当前浏览器是否能够与UEditor良好兼容\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.isCompatible ) {\n\t\t\t *     console.log( '浏览器与UEditor能够良好兼容' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.isCompatible = !browser.mobile && (\n\t\t\t\t(browser.ie && version >= 6) ||\n\t\t\t\t(browser.gecko && version >= 10801) ||\n\t\t\t\t(browser.opera && version >= 9.5) ||\n\t\t\t\t(browser.air && version >= 1) ||\n\t\t\t\t(browser.webkit && version >= 522) ||\n\t\t\t\tfalse);\n\t\t\treturn browser;\n\t\t}();\n\t\t//快捷方式\n\t\tvar ie = browser.ie,\n\t\t\twebkit = browser.webkit,\n\t\t\tgecko = browser.gecko,\n\t\t\topera = browser.opera;\n\t\n\t\t// core/utils.js\n\t\t/**\n\t\t * 工具函数包\n\t\t * @file\n\t\t * @module UE.utils\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor封装使用的静态工具函数\n\t\t * @module UE.utils\n\t\t * @unfile\n\t\t */\n\t\n\t\tvar utils = UE.utils = {\n\t\n\t\t\t/**\n\t\t\t * 用给定的迭代器遍历对象\n\t\t\t * @method each\n\t\t\t * @param { Object } obj 需要遍历的对象\n\t\t\t * @param { Function } iterator 迭代器， 该方法接受两个参数， 第一个参数是当前所处理的value， 第二个参数是当前遍历对象的key\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var demoObj = {\n\t\t\t *     key1: 1,\n\t\t\t *     key2: 2\n\t\t\t * };\n\t\t\t *\n\t\t\t * //output: key1: 1, key2: 2\n\t\t\t * UE.utils.each( demoObj, funciton ( value, key ) {\n\t\t\t *\n\t\t\t *     console.log( key + \":\" + value );\n\t\t\t *\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 用给定的迭代器遍历数组或类数组对象\n\t\t\t * @method each\n\t\t\t * @param { Array } array 需要遍历的数组或者类数组\n\t\t\t * @param { Function } iterator 迭代器， 该方法接受两个参数， 第一个参数是当前所处理的value， 第二个参数是当前遍历对象的key\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var divs = document.getElmentByTagNames( \"div\" );\n\t\t\t *\n\t\t\t * //output: 0: DIV, 1: DIV ...\n\t\t\t * UE.utils.each( divs, funciton ( value, key ) {\n\t\t\t *\n\t\t\t *     console.log( key + \":\" + value.tagName );\n\t\t\t *\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\teach: function(obj, iterator, context) {\n\t\t\t\tif (obj == null) return;\n\t\t\t\tif (obj.length === +obj.length) {\n\t\t\t\t\tfor (var i = 0, l = obj.length; i < l; i++) {\n\t\t\t\t\t\tif (iterator.call(context, obj[i], i, obj) === false)\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (var key in obj) {\n\t\t\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\t\t\tif (iterator.call(context, obj[key], key, obj) === false)\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 以给定对象作为原型创建一个新对象\n\t\t\t * @method makeInstance\n\t\t\t * @param { Object } protoObject 该对象将作为新创建对象的原型\n\t\t\t * @return { Object } 新的对象， 该对象的原型是给定的protoObject对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var protoObject = { sayHello: function () { console.log('Hello UEditor!'); } };\n\t\t\t *\n\t\t\t * var newObject = UE.utils.makeInstance( protoObject );\n\t\t\t * //output: Hello UEditor!\n\t\t\t * newObject.sayHello();\n\t\t\t * ```\n\t\t\t */\n\t\t\tmakeInstance: function(obj) {\n\t\t\t\tvar noop = new Function();\n\t\t\t\tnoop.prototype = obj;\n\t\t\t\tobj = new noop;\n\t\t\t\tnoop.prototype = null;\n\t\t\t\treturn obj;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 将source对象中的属性扩展到target对象上\n\t\t\t * @method extend\n\t\t\t * @remind 该方法将强制把source对象上的属性复制到target对象上\n\t\t\t * @see UE.utils.extend(Object,Object,Boolean)\n\t\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t\t * @param { Object } source 源对象， 该对象的属性会被附加到target对象上\n\t\t\t * @return { Object } 返回target对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var target = { name: 'target', sex: 1 },\n\t\t\t *      source = { name: 'source', age: 17 };\n\t\t\t *\n\t\t\t * UE.utils.extend( target, source );\n\t\t\t *\n\t\t\t * //output: { name: 'source', sex: 1, age: 17 }\n\t\t\t * console.log( target );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 将source对象中的属性扩展到target对象上， 根据指定的isKeepTarget值决定是否保留目标对象中与\n\t\t\t * 源对象属性名相同的属性值。\n\t\t\t * @method extend\n\t\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t\t * @param { Object } source 源对象， 该对象的属性会被附加到target对象上\n\t\t\t * @param { Boolean } isKeepTarget 是否保留目标对象中与源对象中属性名相同的属性\n\t\t\t * @return { Object } 返回target对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var target = { name: 'target', sex: 1 },\n\t\t\t *      source = { name: 'source', age: 17 };\n\t\t\t *\n\t\t\t * UE.utils.extend( target, source, true );\n\t\t\t *\n\t\t\t * //output: { name: 'target', sex: 1, age: 17 }\n\t\t\t * console.log( target );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\textend: function(t, s, b) {\n\t\t\t\tif (s) {\n\t\t\t\t\tfor (var k in s) {\n\t\t\t\t\t\tif (!b || !t.hasOwnProperty(k)) {\n\t\t\t\t\t\t\tt[k] = s[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 将给定的多个对象的属性复制到目标对象target上\n\t\t\t * @method extend2\n\t\t\t * @remind 该方法将强制把源对象上的属性复制到target对象上\n\t\t\t * @remind 该方法支持两个及以上的参数， 从第二个参数开始， 其属性都会被复制到第一个参数上。 如果遇到同名的属性，\n\t\t\t *          将会覆盖掉之前的值。\n\t\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t\t * @param { Object... } source 源对象， 支持多个对象， 该对象的属性会被附加到target对象上\n\t\t\t * @return { Object } 返回target对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var target = {},\n\t\t\t *     source1 = { name: 'source', age: 17 },\n\t\t\t *     source2 = { title: 'dev' };\n\t\t\t *\n\t\t\t * UE.utils.extend2( target, source1, source2 );\n\t\t\t *\n\t\t\t * //output: { name: 'source', age: 17, title: 'dev' }\n\t\t\t * console.log( target );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\textend2: function(t) {\n\t\t\t\tvar a = arguments;\n\t\t\t\tfor (var i = 1; i < a.length; i++) {\n\t\t\t\t\tvar x = a[i];\n\t\t\t\t\tfor (var k in x) {\n\t\t\t\t\t\tif (!t.hasOwnProperty(k)) {\n\t\t\t\t\t\t\tt[k] = x[k];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn t;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 模拟继承机制， 使得subClass继承自superClass\n\t\t\t * @method inherits\n\t\t\t * @param { Object } subClass 子类对象\n\t\t\t * @param { Object } superClass 超类对象\n\t\t\t * @warning 该方法只能让subClass继承超类的原型， subClass对象自身的属性和方法不会被继承\n\t\t\t * @return { Object } 继承superClass后的子类对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * function SuperClass(){\n\t\t\t *     this.name = \"小李\";\n\t\t\t * }\n\t\t\t *\n\t\t\t * SuperClass.prototype = {\n\t\t\t *     hello:function(str){\n\t\t\t *         console.log(this.name + str);\n\t\t\t *     }\n\t\t\t * }\n\t\t\t *\n\t\t\t * function SubClass(){\n\t\t\t *     this.name = \"小张\";\n\t\t\t * }\n\t\t\t *\n\t\t\t * UE.utils.inherits(SubClass,SuperClass);\n\t\t\t *\n\t\t\t * var sub = new SubClass();\n\t\t\t * //output: '小张早上好!\n\t\t\t * sub.hello(\"早上好!\");\n\t\t\t * ```\n\t\t\t */\n\t\t\tinherits: function(subClass, superClass) {\n\t\t\t\tvar oldP = subClass.prototype,\n\t\t\t\t\tnewP = utils.makeInstance(superClass.prototype);\n\t\t\t\tutils.extend(newP, oldP, true);\n\t\t\t\tsubClass.prototype = newP;\n\t\t\t\treturn (newP.constructor = subClass);\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 用指定的context对象作为函数fn的上下文\n\t\t\t * @method bind\n\t\t\t * @param { Function } fn 需要绑定上下文的函数对象\n\t\t\t * @param { Object } content 函数fn新的上下文对象\n\t\t\t * @return { Function } 一个新的函数， 该函数作为原始函数fn的代理， 将完成fn的上下文调换工作。\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var name = 'window',\n\t\t\t *     newTest = null;\n\t\t\t *\n\t\t\t * function test () {\n\t\t\t *     console.log( this.name );\n\t\t\t * }\n\t\t\t *\n\t\t\t * newTest = UE.utils.bind( test, { name: 'object' } );\n\t\t\t *\n\t\t\t * //output: object\n\t\t\t * newTest();\n\t\t\t *\n\t\t\t * //output: window\n\t\t\t * test();\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tbind: function(fn, context) {\n\t\t\t\treturn function() {\n\t\t\t\t\treturn fn.apply(context, arguments);\n\t\t\t\t};\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 创建延迟指定时间后执行的函数fn\n\t\t\t * @method defer\n\t\t\t * @param { Function } fn 需要延迟执行的函数对象\n\t\t\t * @param { int } delay 延迟的时间， 单位是毫秒\n\t\t\t * @warning 该方法的时间控制是不精确的，仅仅只能保证函数的执行是在给定的时间之后，\n\t\t\t *           而不能保证刚好到达延迟时间时执行。\n\t\t\t * @return { Function } 目标函数fn的代理函数， 只有执行该函数才能起到延时效果\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var start = 0;\n\t\t\t *\n\t\t\t * function test(){\n\t\t\t *     console.log( new Date() - start );\n\t\t\t * }\n\t\t\t *\n\t\t\t * var testDefer = UE.utils.defer( test, 1000 );\n\t\t\t * //\n\t\t\t * start = new Date();\n\t\t\t * //output: (大约在1000毫秒之后输出) 1000\n\t\t\t * testDefer();\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 创建延迟指定时间后执行的函数fn, 如果在延迟时间内再次执行该方法， 将会根据指定的exclusion的值，\n\t\t\t * 决定是否取消前一次函数的执行， 如果exclusion的值为true， 则取消执行，反之，将继续执行前一个方法。\n\t\t\t * @method defer\n\t\t\t * @param { Function } fn 需要延迟执行的函数对象\n\t\t\t * @param { int } delay 延迟的时间， 单位是毫秒\n\t\t\t * @param { Boolean } exclusion 如果在延迟时间内再次执行该函数，该值将决定是否取消执行前一次函数的执行，\n\t\t\t *                     值为true表示取消执行， 反之则将在执行前一次函数之后才执行本次函数调用。\n\t\t\t * @warning 该方法的时间控制是不精确的，仅仅只能保证函数的执行是在给定的时间之后，\n\t\t\t *           而不能保证刚好到达延迟时间时执行。\n\t\t\t * @return { Function } 目标函数fn的代理函数， 只有执行该函数才能起到延时效果\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * function test(){\n\t\t\t *     console.log(1);\n\t\t\t * }\n\t\t\t *\n\t\t\t * var testDefer = UE.utils.defer( test, 1000, true );\n\t\t\t *\n\t\t\t * //output: (两次调用仅有一次输出) 1\n\t\t\t * testDefer();\n\t\t\t * testDefer();\n\t\t\t * ```\n\t\t\t */\n\t\t\tdefer: function(fn, delay, exclusion) {\n\t\t\t\tvar timerID;\n\t\t\t\treturn function() {\n\t\t\t\t\tif (exclusion) {\n\t\t\t\t\t\tclearTimeout(timerID);\n\t\t\t\t\t}\n\t\t\t\t\ttimerID = setTimeout(fn, delay);\n\t\t\t\t};\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 获取元素item在数组array中首次出现的位置, 如果未找到item， 则返回-1\n\t\t\t * @method indexOf\n\t\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t\t * @param { Array } array 需要查找的数组对象\n\t\t\t * @param { * } item 需要在目标数组中查找的值\n\t\t\t * @return { int } 返回item在目标数组array中首次出现的位置， 如果在数组中未找到item， 则返回-1\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var item = 1,\n\t\t\t *     arr = [ 3, 4, 6, 8, 1, 1, 2 ];\n\t\t\t *\n\t\t\t * //output: 4\n\t\t\t * console.log( UE.utils.indexOf( arr, item ) );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 获取元素item数组array中首次出现的位置, 如果未找到item， 则返回-1。通过start的值可以指定搜索的起始位置。\n\t\t\t * @method indexOf\n\t\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t\t * @param { Array } array 需要查找的数组对象\n\t\t\t * @param { * } item 需要在目标数组中查找的值\n\t\t\t * @param { int } start 搜索的起始位置\n\t\t\t * @return { int } 返回item在目标数组array中的start位置之后首次出现的位置， 如果在数组中未找到item， 则返回-1\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var item = 1,\n\t\t\t *     arr = [ 3, 4, 6, 8, 1, 2, 8, 3, 2, 1, 1, 4 ];\n\t\t\t *\n\t\t\t * //output: 9\n\t\t\t * console.log( UE.utils.indexOf( arr, item, 5 ) );\n\t\t\t * ```\n\t\t\t */\n\t\t\tindexOf: function(array, item, start) {\n\t\t\t\tvar index = -1;\n\t\t\t\tstart = this.isNumber(start) ? start : 0;\n\t\t\t\tthis.each(array, function(v, i) {\n\t\t\t\t\tif (i >= start && v === item) {\n\t\t\t\t\t\tindex = i;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn index;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 移除数组array中所有的元素item\n\t\t\t * @method removeItem\n\t\t\t * @param { Array } array 要移除元素的目标数组\n\t\t\t * @param { * } item 将要被移除的元素\n\t\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var arr = [ 4, 5, 7, 1, 3, 4, 6 ];\n\t\t\t *\n\t\t\t * UE.utils.removeItem( arr, 4 );\n\t\t\t * //output: [ 5, 7, 1, 3, 6 ]\n\t\t\t * console.log( arr );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tremoveItem: function(array, item) {\n\t\t\t\tfor (var i = 0, l = array.length; i < l; i++) {\n\t\t\t\t\tif (array[i] === item) {\n\t\t\t\t\t\tarray.splice(i, 1);\n\t\t\t\t\t\ti--;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 删除字符串str的首尾空格\n\t\t\t * @method trim\n\t\t\t * @param { String } str 需要删除首尾空格的字符串\n\t\t\t * @return { String } 删除了首尾的空格后的字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var str = \" UEdtior \";\n\t\t\t *\n\t\t\t * //output: 9\n\t\t\t * console.log( str.length );\n\t\t\t *\n\t\t\t * //output: 7\n\t\t\t * console.log( UE.utils.trim( \" UEdtior \" ).length );\n\t\t\t *\n\t\t\t * //output: 9\n\t\t\t * console.log( str.length );\n\t\t\t *\n\t\t\t *  ```\n\t\t\t */\n\t\t\ttrim: function(str) {\n\t\t\t\treturn str.replace(/(^[ \\t\\n\\r]+)|([ \\t\\n\\r]+$)/g, '');\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 将字符串str以','分隔成数组后，将该数组转换成哈希对象， 其生成的hash对象的key为数组中的元素， value为1\n\t\t\t * @method listToMap\n\t\t\t * @warning 该方法在生成的hash对象中，会为每一个key同时生成一个另一个全大写的key。\n\t\t\t * @param { String } str 该字符串将被以','分割为数组， 然后进行转化\n\t\t\t * @return { Object } 转化之后的hash对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * //output: Object {UEdtior: 1, UEDTIOR: 1, Hello: 1, HELLO: 1}\n\t\t\t * console.log( UE.utils.listToMap( 'UEdtior,Hello' ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 将字符串数组转换成哈希对象， 其生成的hash对象的key为数组中的元素， value为1\n\t\t\t * @method listToMap\n\t\t\t * @warning 该方法在生成的hash对象中，会为每一个key同时生成一个另一个全大写的key。\n\t\t\t * @param { Array } arr 字符串数组\n\t\t\t * @return { Object } 转化之后的hash对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * //output: Object {UEdtior: 1, UEDTIOR: 1, Hello: 1, HELLO: 1}\n\t\t\t * console.log( UE.utils.listToMap( [ 'UEdtior', 'Hello' ] ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tlistToMap: function(list) {\n\t\t\t\tif (!list) return {};\n\t\t\t\tlist = utils.isArray(list) ? list : list.split(',');\n\t\t\t\tfor (var i = 0, ci, obj = {}; ci = list[i++];) {\n\t\t\t\t\tobj[ci.toUpperCase()] = obj[ci] = 1;\n\t\t\t\t}\n\t\t\t\treturn obj;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 将str中的html符号转义,将转义“'，&，<，\"，>”五个字符\n\t\t\t * @method unhtml\n\t\t\t * @param { String } str 需要转义的字符串\n\t\t\t * @return { String } 转义后的字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var html = '<body>&</body>';\n\t\t\t *\n\t\t\t * //output: &lt;body&gt;&amp;&lt;/body&gt;\n\t\t\t * console.log( UE.utils.unhtml( html ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tunhtml: function(str, reg) {\n\t\t\t\treturn str ? str.replace(reg || /[&<\">'](?:(amp|lt|quot|gt|#39|nbsp|#\\d+);)?/g, function(a, b) {\n\t\t\t\t\tif (b) {\n\t\t\t\t\t\treturn a;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t'<': '&lt;',\n\t\t\t\t\t\t\t'&': '&amp;',\n\t\t\t\t\t\t\t'\"': '&quot;',\n\t\t\t\t\t\t\t'>': '&gt;',\n\t\t\t\t\t\t\t\"'\": '&#39;'\n\t\t\t\t\t\t}[a]\n\t\t\t\t\t}\n\t\n\t\t\t\t}) : '';\n\t\t\t},\n\t\t\t/**\n\t\t\t * 将url中的html字符转义， 仅转义  ', \", <, > 四个字符\n\t\t\t * @param  { String } str 需要转义的字符串\n\t\t\t * @param  { RegExp } reg 自定义的正则\n\t\t\t * @return { String }     转义后的字符串\n\t\t\t */\n\t\t\tunhtmlForUrl: function(str, reg) {\n\t\t\t\treturn str ? str.replace(reg || /[<\">']/g, function(a) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'<': '&lt;',\n\t\t\t\t\t\t'&': '&amp;',\n\t\t\t\t\t\t'\"': '&quot;',\n\t\t\t\t\t\t'>': '&gt;',\n\t\t\t\t\t\t\"'\": '&#39;'\n\t\t\t\t\t}[a]\n\t\n\t\t\t\t}) : '';\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 将str中的转义字符还原成html字符\n\t\t\t * @see UE.utils.unhtml(String);\n\t\t\t * @method html\n\t\t\t * @param { String } str 需要逆转义的字符串\n\t\t\t * @return { String } 逆转义后的字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var str = '&lt;body&gt;&amp;&lt;/body&gt;';\n\t\t\t *\n\t\t\t * //output: <body>&</body>\n\t\t\t * console.log( UE.utils.html( str ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\thtml: function(str) {\n\t\t\t\treturn str ? str.replace(/&((g|l|quo)t|amp|#39|nbsp);/g, function(m) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'&lt;': '<',\n\t\t\t\t\t\t'&amp;': '&',\n\t\t\t\t\t\t'&quot;': '\"',\n\t\t\t\t\t\t'&gt;': '>',\n\t\t\t\t\t\t'&#39;': \"'\",\n\t\t\t\t\t\t'&nbsp;': ' '\n\t\t\t\t\t}[m]\n\t\t\t\t}) : '';\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 将css样式转换为驼峰的形式\n\t\t\t * @method cssStyleToDomStyle\n\t\t\t * @param { String } cssName 需要转换的css样式名\n\t\t\t * @return { String } 转换成驼峰形式后的css样式名\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var str = 'border-top';\n\t\t\t *\n\t\t\t * //output: borderTop\n\t\t\t * console.log( UE.utils.cssStyleToDomStyle( str ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tcssStyleToDomStyle: function() {\n\t\t\t\tvar test = document.createElement('div').style,\n\t\t\t\t\tcache = {\n\t\t\t\t\t\t'float': test.cssFloat != undefined ? 'cssFloat' : test.styleFloat != undefined ? 'styleFloat' : 'float'\n\t\t\t\t\t};\n\t\n\t\t\t\treturn function(cssName) {\n\t\t\t\t\treturn cache[cssName] || (cache[cssName] = cssName.toLowerCase().replace(/-./g, function(match) {\n\t\t\t\t\t\treturn match.charAt(1).toUpperCase();\n\t\t\t\t\t}));\n\t\t\t\t};\n\t\t\t}(),\n\t\n\t\t\t/**\n\t\t\t * 动态加载文件到doc中\n\t\t\t * @method loadFile\n\t\t\t * @param { DomDocument } document 需要加载资源文件的文档对象\n\t\t\t * @param { Object } options 加载资源文件的属性集合， 取值请参考代码示例\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * UE.utils.loadFile( document, {\n\t\t\t *     src:\"test.js\",\n\t\t\t *     tag:\"script\",\n\t\t\t *     type:\"text/javascript\",\n\t\t\t *     defer:\"defer\"\n\t\t\t * } );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 动态加载文件到doc中，加载成功后执行的回调函数fn\n\t\t\t * @method loadFile\n\t\t\t * @param { DomDocument } document 需要加载资源文件的文档对象\n\t\t\t * @param { Object } options 加载资源文件的属性集合， 该集合支持的值是script标签和style标签支持的所有属性。\n\t\t\t * @param { Function } fn 资源文件加载成功之后执行的回调\n\t\t\t * @warning 对于在同一个文档中多次加载同一URL的文件， 该方法会在第一次加载之后缓存该请求，\n\t\t\t *           在此之后的所有同一URL的请求， 将会直接触发回调。\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * UE.utils.loadFile( document, {\n\t\t\t *     src:\"test.js\",\n\t\t\t *     tag:\"script\",\n\t\t\t *     type:\"text/javascript\",\n\t\t\t *     defer:\"defer\"\n\t\t\t * }, function () {\n\t\t\t *     console.log('加载成功');\n\t\t\t * } );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tloadFile: function() {\n\t\t\t\tvar tmpList = [];\n\t\n\t\t\t\tfunction getItem(doc, obj) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = tmpList[i++];) {\n\t\t\t\t\t\t\tif (ci.doc === doc && ci.url == (obj.src || obj.href)) {\n\t\t\t\t\t\t\t\treturn ci;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\treturn function(doc, obj, fn) {\n\t\t\t\t\tvar item = getItem(doc, obj);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\tif (item.ready) {\n\t\t\t\t\t\t\tfn && fn();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\titem.funs.push(fn)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\ttmpList.push({\n\t\t\t\t\t\tdoc: doc,\n\t\t\t\t\t\turl: obj.src || obj.href,\n\t\t\t\t\t\tfuns: [fn]\n\t\t\t\t\t});\n\t\t\t\t\tif (!doc.body) {\n\t\t\t\t\t\tvar html = [];\n\t\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\t\tif (p == 'tag') continue;\n\t\t\t\t\t\t\thtml.push(p + '=\"' + obj[p] + '\"')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdoc.write('<' + obj.tag + ' ' + html.join(' ') + ' ></' + obj.tag + '>');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (obj.id && doc.getElementById(obj.id)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar element = doc.createElement(obj.tag);\n\t\t\t\t\tdelete obj.tag;\n\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\telement.setAttribute(p, obj[p]);\n\t\t\t\t\t}\n\t\t\t\t\telement.onload = element.onreadystatechange = function() {\n\t\t\t\t\t\tif (!this.readyState || /loaded|complete/.test(this.readyState)) {\n\t\t\t\t\t\t\titem = getItem(doc, obj);\n\t\t\t\t\t\t\tif (item.funs.length > 0) {\n\t\t\t\t\t\t\t\titem.ready = 1;\n\t\t\t\t\t\t\t\tfor (var fi; fi = item.funs.pop();) {\n\t\t\t\t\t\t\t\t\tfi();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telement.onload = element.onreadystatechange = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\telement.onerror = function() {\n\t\t\t\t\t\tthrow Error('The load ' + (obj.href || obj.src) + ' fails,check the url settings of file ueditor.config.js ')\n\t\t\t\t\t};\n\t\t\t\t\tdoc.getElementsByTagName(\"head\")[0].appendChild(element);\n\t\t\t\t}\n\t\t\t}(),\n\t\n\t\t\t/**\n\t\t\t * 判断obj对象是否为空\n\t\t\t * @method isEmptyObject\n\t\t\t * @param { * } obj 需要判断的对象\n\t\t\t * @remind 如果判断的对象是NULL， 将直接返回true， 如果是数组且为空， 返回true， 如果是字符串， 且字符串为空，\n\t\t\t *          返回true， 如果是普通对象， 且该对象没有任何实例属性， 返回true\n\t\t\t * @return { Boolean } 对象是否为空\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * //output: true\n\t\t\t * console.log( UE.utils.isEmptyObject( {} ) );\n\t\t\t *\n\t\t\t * //output: true\n\t\t\t * console.log( UE.utils.isEmptyObject( [] ) );\n\t\t\t *\n\t\t\t * //output: true\n\t\t\t * console.log( UE.utils.isEmptyObject( \"\" ) );\n\t\t\t *\n\t\t\t * //output: false\n\t\t\t * console.log( UE.utils.isEmptyObject( { key: 1 } ) );\n\t\t\t *\n\t\t\t * //output: false\n\t\t\t * console.log( UE.utils.isEmptyObject( [1] ) );\n\t\t\t *\n\t\t\t * //output: false\n\t\t\t * console.log( UE.utils.isEmptyObject( \"1\" ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tisEmptyObject: function(obj) {\n\t\t\t\tif (obj == null) return true;\n\t\t\t\tif (this.isArray(obj) || this.isString(obj)) return obj.length === 0;\n\t\t\t\tfor (var key in obj)\n\t\t\t\t\tif (obj.hasOwnProperty(key)) return false;\n\t\t\t\treturn true;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 把rgb格式的颜色值转换成16进制格式\n\t\t\t * @method fixColor\n\t\t\t * @param { String } rgb格式的颜色值\n\t\t\t * @param { String }\n\t\t\t * @example\n\t\t\t * rgb(255,255,255)  => \"#ffffff\"\n\t\t\t */\n\t\t\tfixColor: function(name, value) {\n\t\t\t\tif (/color/i.test(name) && /rgba?/.test(value)) {\n\t\t\t\t\tvar array = value.split(\",\");\n\t\t\t\t\tif (array.length > 3)\n\t\t\t\t\t\treturn \"\";\n\t\t\t\t\tvalue = \"#\";\n\t\t\t\t\tfor (var i = 0, color; color = array[i++];) {\n\t\t\t\t\t\tcolor = parseInt(color.replace(/[^\\d]/gi, ''), 10).toString(16);\n\t\t\t\t\t\tvalue += color.length == 1 ? \"0\" + color : color;\n\t\t\t\t\t}\n\t\t\t\t\tvalue = value.toUpperCase();\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 只针对border,padding,margin做了处理，因为性能问题\n\t\t\t * @public\n\t\t\t * @function\n\t\t\t * @param {String}    val style字符串\n\t\t\t */\n\t\t\toptCss: function(val) {\n\t\t\t\tvar padding, margin, border;\n\t\t\t\tval = val.replace(/(padding|margin|border)\\-([^:]+):([^;]+);?/gi, function(str, key, name, val) {\n\t\t\t\t\tif (val.split(' ').length == 1) {\n\t\t\t\t\t\tswitch (key) {\n\t\t\t\t\t\t\tcase 'padding':\n\t\t\t\t\t\t\t\t!padding && (padding = {});\n\t\t\t\t\t\t\t\tpadding[name] = val;\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\tcase 'margin':\n\t\t\t\t\t\t\t\t!margin && (margin = {});\n\t\t\t\t\t\t\t\tmargin[name] = val;\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\tcase 'border':\n\t\t\t\t\t\t\t\treturn val == 'initial' ? '' : str;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn str;\n\t\t\t\t});\n\t\n\t\t\t\tfunction opt(obj, name) {\n\t\t\t\t\tif (!obj) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t\tvar t = obj.top,\n\t\t\t\t\t\tb = obj.bottom,\n\t\t\t\t\t\tl = obj.left,\n\t\t\t\t\t\tr = obj.right,\n\t\t\t\t\t\tval = '';\n\t\t\t\t\tif (!t || !l || !b || !r) {\n\t\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\t\tval += ';' + name + '-' + p + ':' + obj[p] + ';';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tval += ';' + name + ':' +\n\t\t\t\t\t\t\t(t == b && b == l && l == r ? t :\n\t\t\t\t\t\t\t\tt == b && l == r ? (t + ' ' + l) :\n\t\t\t\t\t\t\t\tl == r ? (t + ' ' + l + ' ' + b) : (t + ' ' + r + ' ' + b + ' ' + l)) + ';'\n\t\t\t\t\t}\n\t\t\t\t\treturn val;\n\t\t\t\t}\n\t\n\t\t\t\tval += opt(padding, 'padding') + opt(margin, 'margin');\n\t\t\t\treturn val.replace(/^[ \\n\\r\\t;]*|[ \\n\\r\\t]*$/, '').replace(/;([ \\n\\r\\t]+)|\\1;/g, ';')\n\t\t\t\t\t.replace(/(&((l|g)t|quot|#39))?;{2,}/g, function(a, b) {\n\t\t\t\t\t\treturn b ? b + \";;\" : ';'\n\t\t\t\t\t});\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 克隆对象\n\t\t\t * @method clone\n\t\t\t * @param { Object } source 源对象\n\t\t\t * @return { Object } source的一个副本\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 深度克隆对象，将source的属性克隆到target对象， 会覆盖target重名的属性。\n\t\t\t * @method clone\n\t\t\t * @param { Object } source 源对象\n\t\t\t * @param { Object } target 目标对象\n\t\t\t * @return { Object } 附加了source对象所有属性的target对象\n\t\t\t */\n\t\t\tclone: function(source, target) {\n\t\t\t\tvar tmp;\n\t\t\t\ttarget = target || {};\n\t\t\t\tfor (var i in source) {\n\t\t\t\t\tif (source.hasOwnProperty(i)) {\n\t\t\t\t\t\ttmp = source[i];\n\t\t\t\t\t\tif (typeof tmp == 'object') {\n\t\t\t\t\t\t\ttarget[i] = utils.isArray(tmp) ? [] : {};\n\t\t\t\t\t\t\tutils.clone(source[i], target[i])\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget[i] = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn target;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 把cm／pt为单位的值转换为px为单位的值\n\t\t\t * @method transUnitToPx\n\t\t\t * @param { String } 待转换的带单位的字符串\n\t\t\t * @return { String } 转换为px为计量单位的值的字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * //output: 500px\n\t\t\t * console.log( UE.utils.transUnitToPx( '20cm' ) );\n\t\t\t *\n\t\t\t * //output: 27px\n\t\t\t * console.log( UE.utils.transUnitToPx( '20pt' ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\ttransUnitToPx: function(val) {\n\t\t\t\tif (!/(pt|cm)/.test(val)) {\n\t\t\t\t\treturn val\n\t\t\t\t}\n\t\t\t\tvar unit;\n\t\t\t\tval.replace(/([\\d.]+)(\\w+)/, function(str, v, u) {\n\t\t\t\t\tval = v;\n\t\t\t\t\tunit = u;\n\t\t\t\t});\n\t\t\t\tswitch (unit) {\n\t\t\t\t\tcase 'cm':\n\t\t\t\t\t\tval = parseFloat(val) * 25;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'pt':\n\t\t\t\t\t\tval = Math.round(parseFloat(val) * 96 / 72);\n\t\t\t\t}\n\t\t\t\treturn val + (val ? 'px' : '');\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 在dom树ready之后执行给定的回调函数\n\t\t\t * @method domReady\n\t\t\t * @remind 如果在执行该方法的时候， dom树已经ready， 那么回调函数将立刻执行\n\t\t\t * @param { Function } fn dom树ready之后的回调函数\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * UE.utils.domReady( function () {\n\t\t\t *\n\t\t\t *     console.log('123');\n\t\t\t *\n\t\t\t * } );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tdomReady: function() {\n\t\n\t\t\t\tvar fnArr = [];\n\t\n\t\t\t\tfunction doReady(doc) {\n\t\t\t\t\t//确保onready只执行一次\n\t\t\t\t\tdoc.isReady = true;\n\t\t\t\t\tfor (var ci; ci = fnArr.pop(); ci()) {}\n\t\t\t\t}\n\t\n\t\t\t\treturn function(onready, win) {\n\t\t\t\t\twin = win || window;\n\t\t\t\t\tvar doc = win.document;\n\t\t\t\t\tonready && fnArr.push(onready);\n\t\t\t\t\tif (doc.readyState === \"complete\") {\n\t\t\t\t\t\tdoReady(doc);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdoc.isReady && doReady(doc);\n\t\t\t\t\t\tif (browser.ie && browser.version != 11) {\n\t\t\t\t\t\t\t(function() {\n\t\t\t\t\t\t\t\tif (doc.isReady) return;\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tdoc.documentElement.doScroll(\"left\");\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\tsetTimeout(arguments.callee, 0);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdoReady(doc);\n\t\t\t\t\t\t\t})();\n\t\t\t\t\t\t\twin.attachEvent('onload', function() {\n\t\t\t\t\t\t\t\tdoReady(doc)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdoc.addEventListener(\"DOMContentLoaded\", function() {\n\t\t\t\t\t\t\t\tdoc.removeEventListener(\"DOMContentLoaded\", arguments.callee, false);\n\t\t\t\t\t\t\t\tdoReady(doc);\n\t\t\t\t\t\t\t}, false);\n\t\t\t\t\t\t\twin.addEventListener('load', function() {\n\t\t\t\t\t\t\t\tdoReady(doc)\n\t\t\t\t\t\t\t}, false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t}(),\n\t\n\t\t\t/**\n\t\t\t * 动态添加css样式\n\t\t\t * @method cssRule\n\t\t\t * @param { String } 节点名称\n\t\t\t * @grammar UE.utils.cssRule('添加的样式的节点名称',['样式'，'放到哪个document上'])\n\t\t\t * @grammar UE.utils.cssRule('body','body{background:#ccc}') => null  //给body添加背景颜色\n\t\t\t * @grammar UE.utils.cssRule('body') =>样式的字符串  //取得key值为body的样式的内容,如果没有找到key值先关的样式将返回空，例如刚才那个背景颜色，将返回 body{background:#ccc}\n\t\t\t * @grammar UE.utils.cssRule('body',document) => 返回指定key的样式，并且指定是哪个document\n\t\t\t * @grammar UE.utils.cssRule('body','') =>null //清空给定的key值的背景颜色\n\t\t\t */\n\t\t\tcssRule: browser.ie && browser.version != 11 ? function(key, style, doc) {\n\t\t\t\tvar indexList, index;\n\t\t\t\tif (style === undefined || style && style.nodeType && style.nodeType == 9) {\n\t\t\t\t\t//获取样式\n\t\t\t\t\tdoc = style && style.nodeType && style.nodeType == 9 ? style : (doc || document);\n\t\t\t\t\tindexList = doc.indexList || (doc.indexList = {});\n\t\t\t\t\tindex = indexList[key];\n\t\t\t\t\tif (index !== undefined) {\n\t\t\t\t\t\treturn doc.styleSheets[index].cssText\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tdoc = doc || document;\n\t\t\t\tindexList = doc.indexList || (doc.indexList = {});\n\t\t\t\tindex = indexList[key];\n\t\t\t\t//清除样式\n\t\t\t\tif (style === '') {\n\t\t\t\t\tif (index !== undefined) {\n\t\t\t\t\t\tdoc.styleSheets[index].cssText = '';\n\t\t\t\t\t\tdelete indexList[key];\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t//添加样式\n\t\t\t\tif (index !== undefined) {\n\t\t\t\t\tsheetStyle = doc.styleSheets[index];\n\t\t\t\t} else {\n\t\t\t\t\tsheetStyle = doc.createStyleSheet('', index = doc.styleSheets.length);\n\t\t\t\t\tindexList[key] = index;\n\t\t\t\t}\n\t\t\t\tsheetStyle.cssText = style;\n\t\t\t} : function(key, style, doc) {\n\t\t\t\tvar head, node;\n\t\t\t\tif (style === undefined || style && style.nodeType && style.nodeType == 9) {\n\t\t\t\t\t//获取样式\n\t\t\t\t\tdoc = style && style.nodeType && style.nodeType == 9 ? style : (doc || document);\n\t\t\t\t\tnode = doc.getElementById(key);\n\t\t\t\t\treturn node ? node.innerHTML : undefined;\n\t\t\t\t}\n\t\t\t\tdoc = doc || document;\n\t\t\t\tnode = doc.getElementById(key);\n\t\n\t\t\t\t//清除样式\n\t\t\t\tif (style === '') {\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t//添加样式\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.innerHTML = style;\n\t\t\t\t} else {\n\t\t\t\t\tnode = doc.createElement('style');\n\t\t\t\t\tnode.id = key;\n\t\t\t\t\tnode.innerHTML = style;\n\t\t\t\t\tdoc.getElementsByTagName('head')[0].appendChild(node);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsort: function(array, compareFn) {\n\t\t\t\tcompareFn = compareFn || function(item1, item2) {\n\t\t\t\t\treturn item1.localeCompare(item2);\n\t\t\t\t};\n\t\t\t\tfor (var i = 0, len = array.length; i < len; i++) {\n\t\t\t\t\tfor (var j = i, length = array.length; j < length; j++) {\n\t\t\t\t\t\tif (compareFn(array[i], array[j]) > 0) {\n\t\t\t\t\t\t\tvar t = array[i];\n\t\t\t\t\t\t\tarray[i] = array[j];\n\t\t\t\t\t\t\tarray[j] = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn array;\n\t\t\t},\n\t\t\tserializeParam: function(json) {\n\t\t\t\tvar strArr = [];\n\t\t\t\tfor (var i in json) {\n\t\t\t\t\t//忽略默认的几个参数\n\t\t\t\t\tif (i == \"method\" || i == \"timeout\" || i == \"async\") continue;\n\t\t\t\t\t//传递过来的对象和函数不在提交之列\n\t\t\t\t\tif (!((typeof json[i]).toLowerCase() == \"function\" || (typeof json[i]).toLowerCase() == \"object\")) {\n\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"=\" + encodeURIComponent(json[i]));\n\t\t\t\t\t} else if (utils.isArray(json[i])) {\n\t\t\t\t\t\t//支持传数组内容\n\t\t\t\t\t\tfor (var j = 0; j < json[i].length; j++) {\n\t\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"[]=\" + encodeURIComponent(json[i][j]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn strArr.join(\"&\");\n\t\t\t},\n\t\t\tformatUrl: function(url) {\n\t\t\t\tvar u = url.replace(/&&/g, '&');\n\t\t\t\tu = u.replace(/\\?&/g, '?');\n\t\t\t\tu = u.replace(/&$/g, '');\n\t\t\t\tu = u.replace(/&#/g, '#');\n\t\t\t\tu = u.replace(/&+/g, '&');\n\t\t\t\treturn u;\n\t\t\t},\n\t\t\tisCrossDomainUrl: function(url) {\n\t\t\t\tvar a = document.createElement('a');\n\t\t\t\ta.href = url;\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\ta.href = a.href;\n\t\t\t\t}\n\t\t\t\treturn !(a.protocol == location.protocol && a.hostname == location.hostname &&\n\t\t\t\t\t(a.port == location.port || (a.port == '80' && location.port == '') || (a.port == '' && location.port == '80')));\n\t\t\t},\n\t\t\tclearEmptyAttrs: function(obj) {\n\t\t\t\tfor (var p in obj) {\n\t\t\t\t\tif (obj[p] === '') {\n\t\t\t\t\t\tdelete obj[p]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn obj;\n\t\t\t},\n\t\t\tstr2json: function(s) {\n\t\n\t\t\t\tif (!utils.isString(s)) return null;\n\t\t\t\tif (window.JSON) {\n\t\t\t\t\treturn JSON.parse(s);\n\t\t\t\t} else {\n\t\t\t\t\treturn (new Function(\"return \" + utils.trim(s || '')))();\n\t\t\t\t}\n\t\n\t\t\t},\n\t\t\tjson2str: (function() {\n\t\n\t\t\t\tif (window.JSON) {\n\t\n\t\t\t\t\treturn JSON.stringify;\n\t\n\t\t\t\t} else {\n\t\n\t\t\t\t\tvar escapeMap = {\n\t\t\t\t\t\t\"\\b\": '\\\\b',\n\t\t\t\t\t\t\"\\t\": '\\\\t',\n\t\t\t\t\t\t\"\\n\": '\\\\n',\n\t\t\t\t\t\t\"\\f\": '\\\\f',\n\t\t\t\t\t\t\"\\r\": '\\\\r',\n\t\t\t\t\t\t'\"': '\\\\\"',\n\t\t\t\t\t\t\"\\\\\": '\\\\\\\\'\n\t\t\t\t\t};\n\t\n\t\t\t\t\tfunction encodeString(source) {\n\t\t\t\t\t\tif (/[\"\\\\\\x00-\\x1f]/.test(source)) {\n\t\t\t\t\t\t\tsource = source.replace(\n\t\t\t\t\t\t\t\t/[\"\\\\\\x00-\\x1f]/g,\n\t\t\t\t\t\t\t\tfunction(match) {\n\t\t\t\t\t\t\t\t\tvar c = escapeMap[match];\n\t\t\t\t\t\t\t\t\tif (c) {\n\t\t\t\t\t\t\t\t\t\treturn c;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tc = match.charCodeAt();\n\t\t\t\t\t\t\t\t\treturn \"\\\\u00\" + Math.floor(c / 16).toString(16) + (c % 16).toString(16);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn '\"' + source + '\"';\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction encodeArray(source) {\n\t\t\t\t\t\tvar result = [\"[\"],\n\t\t\t\t\t\t\tl = source.length,\n\t\t\t\t\t\t\tpreComma, i, item;\n\t\n\t\t\t\t\t\tfor (i = 0; i < l; i++) {\n\t\t\t\t\t\t\titem = source[i];\n\t\n\t\t\t\t\t\t\tswitch (typeof item) {\n\t\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\t\t\tcase \"unknown\":\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\tif (preComma) {\n\t\t\t\t\t\t\t\t\t\tresult.push(',');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tresult.push(utils.json2str(item));\n\t\t\t\t\t\t\t\t\tpreComma = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresult.push(\"]\");\n\t\t\t\t\t\treturn result.join(\"\");\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction pad(source) {\n\t\t\t\t\t\treturn source < 10 ? '0' + source : source;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction encodeDate(source) {\n\t\t\t\t\t\treturn '\"' + source.getFullYear() + \"-\" + pad(source.getMonth() + 1) + \"-\" + pad(source.getDate()) + \"T\" + pad(source.getHours()) + \":\" + pad(source.getMinutes()) + \":\" + pad(source.getSeconds()) + '\"';\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn function(value) {\n\t\t\t\t\t\tswitch (typeof value) {\n\t\t\t\t\t\t\tcase 'undefined':\n\t\t\t\t\t\t\t\treturn 'undefined';\n\t\n\t\t\t\t\t\t\tcase 'number':\n\t\t\t\t\t\t\t\treturn isFinite(value) ? String(value) : \"null\";\n\t\n\t\t\t\t\t\t\tcase 'string':\n\t\t\t\t\t\t\t\treturn encodeString(value);\n\t\n\t\t\t\t\t\t\tcase 'boolean':\n\t\t\t\t\t\t\t\treturn String(value);\n\t\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\t\t\t\treturn 'null';\n\t\t\t\t\t\t\t\t} else if (utils.isArray(value)) {\n\t\t\t\t\t\t\t\t\treturn encodeArray(value);\n\t\t\t\t\t\t\t\t} else if (utils.isDate(value)) {\n\t\t\t\t\t\t\t\t\treturn encodeDate(value);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar result = ['{'],\n\t\t\t\t\t\t\t\t\t\tencode = utils.json2str,\n\t\t\t\t\t\t\t\t\t\tpreComma,\n\t\t\t\t\t\t\t\t\t\titem;\n\t\n\t\t\t\t\t\t\t\t\tfor (var key in value) {\n\t\t\t\t\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(value, key)) {\n\t\t\t\t\t\t\t\t\t\t\titem = value[key];\n\t\t\t\t\t\t\t\t\t\t\tswitch (typeof item) {\n\t\t\t\t\t\t\t\t\t\t\t\tcase 'undefined':\n\t\t\t\t\t\t\t\t\t\t\t\tcase 'unknown':\n\t\t\t\t\t\t\t\t\t\t\t\tcase 'function':\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (preComma) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tresult.push(',');\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tpreComma = 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\tresult.push(encode(key) + ':' + encode(item));\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tresult.push('}');\n\t\t\t\t\t\t\t\t\treturn result.join('');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\n\t\t\t})()\n\t\n\t\t};\n\t\t/**\n\t\t * 判断给定的对象是否是字符串\n\t\t * @method isString\n\t\t * @param { * } object 需要判断的对象\n\t\t * @return { Boolean } 给定的对象是否是字符串\n\t\t */\n\t\n\t\t/**\n\t\t * 判断给定的对象是否是数组\n\t\t * @method isArray\n\t\t * @param { * } object 需要判断的对象\n\t\t * @return { Boolean } 给定的对象是否是数组\n\t\t */\n\t\n\t\t/**\n\t\t * 判断给定的对象是否是一个Function\n\t\t * @method isFunction\n\t\t * @param { * } object 需要判断的对象\n\t\t * @return { Boolean } 给定的对象是否是Function\n\t\t */\n\t\n\t\t/**\n\t\t * 判断给定的对象是否是Number\n\t\t * @method isNumber\n\t\t * @param { * } object 需要判断的对象\n\t\t * @return { Boolean } 给定的对象是否是Number\n\t\t */\n\t\n\t\t/**\n\t\t * 判断给定的对象是否是一个正则表达式\n\t\t * @method isRegExp\n\t\t * @param { * } object 需要判断的对象\n\t\t * @return { Boolean } 给定的对象是否是正则表达式\n\t\t */\n\t\n\t\t/**\n\t\t * 判断给定的对象是否是一个普通对象\n\t\t * @method isObject\n\t\t * @param { * } object 需要判断的对象\n\t\t * @return { Boolean } 给定的对象是否是普通对象\n\t\t */\n\t\tutils.each(['String', 'Function', 'Array', 'Number', 'RegExp', 'Object', 'Date'], function(v) {\n\t\t\tUE.utils['is' + v] = function(obj) {\n\t\t\t\treturn Object.prototype.toString.apply(obj) == '[object ' + v + ']';\n\t\t\t}\n\t\t});\n\t\n\t\t// core/EventBase.js\n\t\t/**\n\t\t * UE采用的事件基类\n\t\t * @file\n\t\t * @module UE\n\t\t * @class EventBase\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t\t * @unfile\n\t\t * @module UE\n\t\t */\n\t\n\t\t/**\n\t\t * UE采用的事件基类，继承此类的对应类将获取addListener,removeListener,fireEvent方法。\n\t\t * 在UE中，Editor以及所有ui实例都继承了该类，故可以在对应的ui对象以及editor对象上使用上述方法。\n\t\t * @unfile\n\t\t * @module UE\n\t\t * @class EventBase\n\t\t */\n\t\n\t\t/**\n\t\t * 通过此构造器，子类可以继承EventBase获取事件监听的方法\n\t\t * @constructor\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.EventBase.call(editor);\n\t\t * ```\n\t\t */\n\t\tvar EventBase = UE.EventBase = function() {};\n\t\n\t\tEventBase.prototype = {\n\t\n\t\t\t/**\n\t\t\t * 注册事件监听器\n\t\t\t * @method addListener\n\t\t\t * @param { String } types 监听的事件名称，同时监听多个事件使用空格分隔\n\t\t\t * @param { Function } fn 监听的事件被触发时，会执行该回调函数\n\t\t\t * @waining 事件被触发时，监听的函数假如返回的值恒等于true，回调函数的队列中后面的函数将不执行\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addListener('selectionchange',function(){\n\t\t\t *      console.log(\"选区已经变化！\");\n\t\t\t * })\n\t\t\t * editor.addListener('beforegetcontent aftergetcontent',function(type){\n\t\t\t *         if(type == 'beforegetcontent'){\n\t\t\t *             //do something\n\t\t\t *         }else{\n\t\t\t *             //do something\n\t\t\t *         }\n\t\t\t *         console.log(this.getContent) // this是注册的事件的编辑器实例\n\t\t\t * })\n\t\t\t * ```\n\t\t\t * @see UE.EventBase:fireEvent(String)\n\t\t\t */\n\t\t\taddListener: function(types, listener) {\n\t\t\t\ttypes = utils.trim(types).split(/\\s+/);\n\t\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\t\tgetListener(this, ti, true).push(listener);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\ton: function(types, listener) {\n\t\t\t\treturn this.addListener(types, listener);\n\t\t\t},\n\t\t\toff: function(types, listener) {\n\t\t\t\treturn this.removeListener(types, listener)\n\t\t\t},\n\t\t\ttrigger: function() {\n\t\t\t\treturn this.fireEvent.apply(this, arguments);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 移除事件监听器\n\t\t\t * @method removeListener\n\t\t\t * @param { String } types 移除的事件名称，同时移除多个事件使用空格分隔\n\t\t\t * @param { Function } fn 移除监听事件的函数引用\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //changeCallback为方法体\n\t\t\t * editor.removeListener(\"selectionchange\",changeCallback);\n\t\t\t * ```\n\t\t\t */\n\t\t\tremoveListener: function(types, listener) {\n\t\t\t\ttypes = utils.trim(types).split(/\\s+/);\n\t\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\t\tutils.removeItem(getListener(this, ti) || [], listener);\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 触发事件\n\t\t\t * @method fireEvent\n\t\t\t * @param { String } types 触发的事件名称，同时触发多个事件使用空格分隔\n\t\t\t * @remind 该方法会触发addListener\n\t\t\t * @return { * } 返回触发事件的队列中，最后执行的回调函数的返回值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.fireEvent(\"selectionchange\");\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 触发事件\n\t\t\t * @method fireEvent\n\t\t\t * @param { String } types 触发的事件名称，同时触发多个事件使用空格分隔\n\t\t\t * @param { *... } options 可选参数，可以传入一个或多个参数，会传给事件触发的回调函数\n\t\t\t * @return { * } 返回触发事件的队列中，最后执行的回调函数的返回值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * editor.addListener( \"selectionchange\", function ( type, arg1, arg2 ) {\n\t\t\t *\n\t\t\t *     console.log( arg1 + \" \" + arg2 );\n\t\t\t *\n\t\t\t * } );\n\t\t\t *\n\t\t\t * //触发selectionchange事件， 会执行上面的事件监听器\n\t\t\t * //output: Hello World\n\t\t\t * editor.fireEvent(\"selectionchange\", \"Hello\", \"World\");\n\t\t\t * ```\n\t\t\t */\n\t\t\tfireEvent: function() {\n\t\t\t\tvar types = arguments[0];\n\t\t\t\ttypes = utils.trim(types).split(' ');\n\t\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\t\tvar listeners = getListener(this, ti),\n\t\t\t\t\t\tr, t, k;\n\t\t\t\t\tif (listeners) {\n\t\t\t\t\t\tk = listeners.length;\n\t\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\t\tif (!listeners[k]) continue;\n\t\t\t\t\t\t\tt = listeners[k].apply(this, arguments);\n\t\t\t\t\t\t\tif (t === true) {\n\t\t\t\t\t\t\t\treturn t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (t !== undefined) {\n\t\t\t\t\t\t\t\tr = t;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (t = this['on' + ti.toLowerCase()]) {\n\t\t\t\t\t\tr = t.apply(this, arguments);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn r;\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t * 获得对象所拥有监听类型的所有监听器\n\t\t * @unfile\n\t\t * @module UE\n\t\t * @since 1.2.6.1\n\t\t * @method getListener\n\t\t * @public\n\t\t * @param { Object } obj  查询监听器的对象\n\t\t * @param { String } type 事件类型\n\t\t * @param { Boolean } force  为true且当前所有type类型的侦听器不存在时，创建一个空监听器数组\n\t\t * @return { Array } 监听器数组\n\t\t */\n\t\tfunction getListener(obj, type, force) {\n\t\t\tvar allListeners;\n\t\t\ttype = type.toLowerCase();\n\t\t\treturn ((allListeners = (obj.__allListeners || force && (obj.__allListeners = {}))) && (allListeners[type] || force && (allListeners[type] = [])));\n\t\t}\n\t\n\t\t// core/dtd.js\n\t\t///import editor.js\n\t\t///import core/dom/dom.js\n\t\t///import core/utils.js\n\t\t/**\n\t\t * dtd html语义化的体现类\n\t\t * @constructor\n\t\t * @namespace dtd\n\t\t */\n\t\tvar dtd = dom.dtd = (function() {\n\t\t\tfunction _(s) {\n\t\t\t\tfor (var k in s) {\n\t\t\t\t\ts[k.toUpperCase()] = s[k];\n\t\t\t\t}\n\t\t\t\treturn s;\n\t\t\t}\n\t\t\tvar X = utils.extend2;\n\t\t\tvar A = _({\n\t\t\t\t\tisindex: 1,\n\t\t\t\t\tfieldset: 1\n\t\t\t\t}),\n\t\t\t\tB = _({\n\t\t\t\t\tinput: 1,\n\t\t\t\t\tbutton: 1,\n\t\t\t\t\tselect: 1,\n\t\t\t\t\ttextarea: 1,\n\t\t\t\t\tlabel: 1\n\t\t\t\t}),\n\t\t\t\tC = X(_({\n\t\t\t\t\ta: 1\n\t\t\t\t}), B),\n\t\t\t\tD = X({\n\t\t\t\t\tiframe: 1\n\t\t\t\t}, C),\n\t\t\t\tE = _({\n\t\t\t\t\thr: 1,\n\t\t\t\t\tul: 1,\n\t\t\t\t\tmenu: 1,\n\t\t\t\t\tdiv: 1,\n\t\t\t\t\tblockquote: 1,\n\t\t\t\t\tnoscript: 1,\n\t\t\t\t\ttable: 1,\n\t\t\t\t\tcenter: 1,\n\t\t\t\t\taddress: 1,\n\t\t\t\t\tdir: 1,\n\t\t\t\t\tpre: 1,\n\t\t\t\t\th5: 1,\n\t\t\t\t\tdl: 1,\n\t\t\t\t\th4: 1,\n\t\t\t\t\tnoframes: 1,\n\t\t\t\t\th6: 1,\n\t\t\t\t\tol: 1,\n\t\t\t\t\th1: 1,\n\t\t\t\t\th3: 1,\n\t\t\t\t\th2: 1\n\t\t\t\t}),\n\t\t\t\tF = _({\n\t\t\t\t\tins: 1,\n\t\t\t\t\tdel: 1,\n\t\t\t\t\tscript: 1,\n\t\t\t\t\tstyle: 1\n\t\t\t\t}),\n\t\t\t\tG = X(_({\n\t\t\t\t\tb: 1,\n\t\t\t\t\tacronym: 1,\n\t\t\t\t\tbdo: 1,\n\t\t\t\t\t'var': 1,\n\t\t\t\t\t'#': 1,\n\t\t\t\t\tabbr: 1,\n\t\t\t\t\tcode: 1,\n\t\t\t\t\tbr: 1,\n\t\t\t\t\ti: 1,\n\t\t\t\t\tcite: 1,\n\t\t\t\t\tkbd: 1,\n\t\t\t\t\tu: 1,\n\t\t\t\t\tstrike: 1,\n\t\t\t\t\ts: 1,\n\t\t\t\t\ttt: 1,\n\t\t\t\t\tstrong: 1,\n\t\t\t\t\tq: 1,\n\t\t\t\t\tsamp: 1,\n\t\t\t\t\tem: 1,\n\t\t\t\t\tdfn: 1,\n\t\t\t\t\tspan: 1\n\t\t\t\t}), F),\n\t\t\t\tH = X(_({\n\t\t\t\t\tsub: 1,\n\t\t\t\t\timg: 1,\n\t\t\t\t\tembed: 1,\n\t\t\t\t\tobject: 1,\n\t\t\t\t\tsup: 1,\n\t\t\t\t\tbasefont: 1,\n\t\t\t\t\tmap: 1,\n\t\t\t\t\tapplet: 1,\n\t\t\t\t\tfont: 1,\n\t\t\t\t\tbig: 1,\n\t\t\t\t\tsmall: 1\n\t\t\t\t}), G),\n\t\t\t\tI = X(_({\n\t\t\t\t\tp: 1\n\t\t\t\t}), H),\n\t\t\t\tJ = X(_({\n\t\t\t\t\tiframe: 1\n\t\t\t\t}), H, B),\n\t\t\t\tK = _({\n\t\t\t\t\timg: 1,\n\t\t\t\t\tembed: 1,\n\t\t\t\t\tnoscript: 1,\n\t\t\t\t\tbr: 1,\n\t\t\t\t\tkbd: 1,\n\t\t\t\t\tcenter: 1,\n\t\t\t\t\tbutton: 1,\n\t\t\t\t\tbasefont: 1,\n\t\t\t\t\th5: 1,\n\t\t\t\t\th4: 1,\n\t\t\t\t\tsamp: 1,\n\t\t\t\t\th6: 1,\n\t\t\t\t\tol: 1,\n\t\t\t\t\th1: 1,\n\t\t\t\t\th3: 1,\n\t\t\t\t\th2: 1,\n\t\t\t\t\tform: 1,\n\t\t\t\t\tfont: 1,\n\t\t\t\t\t'#': 1,\n\t\t\t\t\tselect: 1,\n\t\t\t\t\tmenu: 1,\n\t\t\t\t\tins: 1,\n\t\t\t\t\tabbr: 1,\n\t\t\t\t\tlabel: 1,\n\t\t\t\t\tcode: 1,\n\t\t\t\t\ttable: 1,\n\t\t\t\t\tscript: 1,\n\t\t\t\t\tcite: 1,\n\t\t\t\t\tinput: 1,\n\t\t\t\t\tiframe: 1,\n\t\t\t\t\tstrong: 1,\n\t\t\t\t\ttextarea: 1,\n\t\t\t\t\tnoframes: 1,\n\t\t\t\t\tbig: 1,\n\t\t\t\t\tsmall: 1,\n\t\t\t\t\tspan: 1,\n\t\t\t\t\thr: 1,\n\t\t\t\t\tsub: 1,\n\t\t\t\t\tbdo: 1,\n\t\t\t\t\t'var': 1,\n\t\t\t\t\tdiv: 1,\n\t\t\t\t\tobject: 1,\n\t\t\t\t\tsup: 1,\n\t\t\t\t\tstrike: 1,\n\t\t\t\t\tdir: 1,\n\t\t\t\t\tmap: 1,\n\t\t\t\t\tdl: 1,\n\t\t\t\t\tapplet: 1,\n\t\t\t\t\tdel: 1,\n\t\t\t\t\tisindex: 1,\n\t\t\t\t\tfieldset: 1,\n\t\t\t\t\tul: 1,\n\t\t\t\t\tb: 1,\n\t\t\t\t\tacronym: 1,\n\t\t\t\t\ta: 1,\n\t\t\t\t\tblockquote: 1,\n\t\t\t\t\ti: 1,\n\t\t\t\t\tu: 1,\n\t\t\t\t\ts: 1,\n\t\t\t\t\ttt: 1,\n\t\t\t\t\taddress: 1,\n\t\t\t\t\tq: 1,\n\t\t\t\t\tpre: 1,\n\t\t\t\t\tp: 1,\n\t\t\t\t\tem: 1,\n\t\t\t\t\tdfn: 1\n\t\t\t\t}),\n\t\n\t\t\t\tL = X(_({\n\t\t\t\t\ta: 0\n\t\t\t\t}), J), //a不能被切开，所以把他\n\t\t\t\tM = _({\n\t\t\t\t\ttr: 1\n\t\t\t\t}),\n\t\t\t\tN = _({\n\t\t\t\t\t'#': 1\n\t\t\t\t}),\n\t\t\t\tO = X(_({\n\t\t\t\t\tparam: 1\n\t\t\t\t}), K),\n\t\t\t\tP = X(_({\n\t\t\t\t\tform: 1\n\t\t\t\t}), A, D, E, I),\n\t\t\t\tQ = _({\n\t\t\t\t\tli: 1,\n\t\t\t\t\tol: 1,\n\t\t\t\t\tul: 1\n\t\t\t\t}),\n\t\t\t\tR = _({\n\t\t\t\t\tstyle: 1,\n\t\t\t\t\tscript: 1\n\t\t\t\t}),\n\t\t\t\tS = _({\n\t\t\t\t\tbase: 1,\n\t\t\t\t\tlink: 1,\n\t\t\t\t\tmeta: 1,\n\t\t\t\t\ttitle: 1\n\t\t\t\t}),\n\t\t\t\tT = X(S, R),\n\t\t\t\tU = _({\n\t\t\t\t\thead: 1,\n\t\t\t\t\tbody: 1\n\t\t\t\t}),\n\t\t\t\tV = _({\n\t\t\t\t\thtml: 1\n\t\t\t\t});\n\t\n\t\t\tvar block = _({\n\t\t\t\t\taddress: 1,\n\t\t\t\t\tblockquote: 1,\n\t\t\t\t\tcenter: 1,\n\t\t\t\t\tdir: 1,\n\t\t\t\t\tdiv: 1,\n\t\t\t\t\tdl: 1,\n\t\t\t\t\tfieldset: 1,\n\t\t\t\t\tform: 1,\n\t\t\t\t\th1: 1,\n\t\t\t\t\th2: 1,\n\t\t\t\t\th3: 1,\n\t\t\t\t\th4: 1,\n\t\t\t\t\th5: 1,\n\t\t\t\t\th6: 1,\n\t\t\t\t\thr: 1,\n\t\t\t\t\tisindex: 1,\n\t\t\t\t\tmenu: 1,\n\t\t\t\t\tnoframes: 1,\n\t\t\t\t\tol: 1,\n\t\t\t\t\tp: 1,\n\t\t\t\t\tpre: 1,\n\t\t\t\t\ttable: 1,\n\t\t\t\t\tul: 1\n\t\t\t\t}),\n\t\n\t\t\t\tempty = _({\n\t\t\t\t\tarea: 1,\n\t\t\t\t\tbase: 1,\n\t\t\t\t\tbasefont: 1,\n\t\t\t\t\tbr: 1,\n\t\t\t\t\tcol: 1,\n\t\t\t\t\tcommand: 1,\n\t\t\t\t\tdialog: 1,\n\t\t\t\t\tembed: 1,\n\t\t\t\t\thr: 1,\n\t\t\t\t\timg: 1,\n\t\t\t\t\tinput: 1,\n\t\t\t\t\tisindex: 1,\n\t\t\t\t\tkeygen: 1,\n\t\t\t\t\tlink: 1,\n\t\t\t\t\tmeta: 1,\n\t\t\t\t\tparam: 1,\n\t\t\t\t\tsource: 1,\n\t\t\t\t\ttrack: 1,\n\t\t\t\t\twbr: 1\n\t\t\t\t});\n\t\n\t\t\treturn _({\n\t\n\t\t\t\t// $ 表示自定的属性\n\t\n\t\t\t\t// body外的元素列表.\n\t\t\t\t$nonBodyContent: X(V, U, S),\n\t\n\t\t\t\t//块结构元素列表\n\t\t\t\t$block: block,\n\t\n\t\t\t\t//内联元素列表\n\t\t\t\t$inline: L,\n\t\n\t\t\t\t$inlineWithA: X(_({\n\t\t\t\t\ta: 1\n\t\t\t\t}), L),\n\t\n\t\t\t\t$body: X(_({\n\t\t\t\t\tscript: 1,\n\t\t\t\t\tstyle: 1\n\t\t\t\t}), block),\n\t\n\t\t\t\t$cdata: _({\n\t\t\t\t\tscript: 1,\n\t\t\t\t\tstyle: 1\n\t\t\t\t}),\n\t\n\t\t\t\t//自闭和元素\n\t\t\t\t$empty: empty,\n\t\n\t\t\t\t//不是自闭合，但不能让range选中里边\n\t\t\t\t$nonChild: _({\n\t\t\t\t\tiframe: 1,\n\t\t\t\t\ttextarea: 1\n\t\t\t\t}),\n\t\t\t\t//列表元素列表\n\t\t\t\t$listItem: _({\n\t\t\t\t\tdd: 1,\n\t\t\t\t\tdt: 1,\n\t\t\t\t\tli: 1\n\t\t\t\t}),\n\t\n\t\t\t\t//列表根元素列表\n\t\t\t\t$list: _({\n\t\t\t\t\tul: 1,\n\t\t\t\t\tol: 1,\n\t\t\t\t\tdl: 1\n\t\t\t\t}),\n\t\n\t\t\t\t//不能认为是空的元素\n\t\t\t\t$isNotEmpty: _({\n\t\t\t\t\ttable: 1,\n\t\t\t\t\tul: 1,\n\t\t\t\t\tol: 1,\n\t\t\t\t\tdl: 1,\n\t\t\t\t\tiframe: 1,\n\t\t\t\t\tarea: 1,\n\t\t\t\t\tbase: 1,\n\t\t\t\t\tcol: 1,\n\t\t\t\t\thr: 1,\n\t\t\t\t\timg: 1,\n\t\t\t\t\tembed: 1,\n\t\t\t\t\tinput: 1,\n\t\t\t\t\tlink: 1,\n\t\t\t\t\tmeta: 1,\n\t\t\t\t\tparam: 1,\n\t\t\t\t\th1: 1,\n\t\t\t\t\th2: 1,\n\t\t\t\t\th3: 1,\n\t\t\t\t\th4: 1,\n\t\t\t\t\th5: 1,\n\t\t\t\t\th6: 1\n\t\t\t\t}),\n\t\n\t\t\t\t//如果没有子节点就可以删除的元素列表，像span,a\n\t\t\t\t$removeEmpty: _({\n\t\t\t\t\ta: 1,\n\t\t\t\t\tabbr: 1,\n\t\t\t\t\tacronym: 1,\n\t\t\t\t\taddress: 1,\n\t\t\t\t\tb: 1,\n\t\t\t\t\tbdo: 1,\n\t\t\t\t\tbig: 1,\n\t\t\t\t\tcite: 1,\n\t\t\t\t\tcode: 1,\n\t\t\t\t\tdel: 1,\n\t\t\t\t\tdfn: 1,\n\t\t\t\t\tem: 1,\n\t\t\t\t\tfont: 1,\n\t\t\t\t\ti: 1,\n\t\t\t\t\tins: 1,\n\t\t\t\t\tlabel: 1,\n\t\t\t\t\tkbd: 1,\n\t\t\t\t\tq: 1,\n\t\t\t\t\ts: 1,\n\t\t\t\t\tsamp: 1,\n\t\t\t\t\tsmall: 1,\n\t\t\t\t\tspan: 1,\n\t\t\t\t\tstrike: 1,\n\t\t\t\t\tstrong: 1,\n\t\t\t\t\tsub: 1,\n\t\t\t\t\tsup: 1,\n\t\t\t\t\ttt: 1,\n\t\t\t\t\tu: 1,\n\t\t\t\t\t'var': 1\n\t\t\t\t}),\n\t\n\t\t\t\t$removeEmptyBlock: _({\n\t\t\t\t\t'p': 1,\n\t\t\t\t\t'div': 1\n\t\t\t\t}),\n\t\n\t\t\t\t//在table元素里的元素列表\n\t\t\t\t$tableContent: _({\n\t\t\t\t\tcaption: 1,\n\t\t\t\t\tcol: 1,\n\t\t\t\t\tcolgroup: 1,\n\t\t\t\t\ttbody: 1,\n\t\t\t\t\ttd: 1,\n\t\t\t\t\ttfoot: 1,\n\t\t\t\t\tth: 1,\n\t\t\t\t\tthead: 1,\n\t\t\t\t\ttr: 1,\n\t\t\t\t\ttable: 1\n\t\t\t\t}),\n\t\t\t\t//不转换的标签\n\t\t\t\t$notTransContent: _({\n\t\t\t\t\tpre: 1,\n\t\t\t\t\tscript: 1,\n\t\t\t\t\tstyle: 1,\n\t\t\t\t\ttextarea: 1\n\t\t\t\t}),\n\t\t\t\thtml: U,\n\t\t\t\thead: T,\n\t\t\t\tstyle: N,\n\t\t\t\tscript: N,\n\t\t\t\tbody: P,\n\t\t\t\tbase: {},\n\t\t\t\tlink: {},\n\t\t\t\tmeta: {},\n\t\t\t\ttitle: N,\n\t\t\t\tcol: {},\n\t\t\t\ttr: _({\n\t\t\t\t\ttd: 1,\n\t\t\t\t\tth: 1\n\t\t\t\t}),\n\t\t\t\timg: {},\n\t\t\t\tembed: {},\n\t\t\t\tcolgroup: _({\n\t\t\t\t\tthead: 1,\n\t\t\t\t\tcol: 1,\n\t\t\t\t\ttbody: 1,\n\t\t\t\t\ttr: 1,\n\t\t\t\t\ttfoot: 1\n\t\t\t\t}),\n\t\t\t\tnoscript: P,\n\t\t\t\ttd: P,\n\t\t\t\tbr: {},\n\t\t\t\tth: P,\n\t\t\t\tcenter: P,\n\t\t\t\tkbd: L,\n\t\t\t\tbutton: X(I, E),\n\t\t\t\tbasefont: {},\n\t\t\t\th5: L,\n\t\t\t\th4: L,\n\t\t\t\tsamp: L,\n\t\t\t\th6: L,\n\t\t\t\tol: Q,\n\t\t\t\th1: L,\n\t\t\t\th3: L,\n\t\t\t\toption: N,\n\t\t\t\th2: L,\n\t\t\t\tform: X(A, D, E, I),\n\t\t\t\tselect: _({\n\t\t\t\t\toptgroup: 1,\n\t\t\t\t\toption: 1\n\t\t\t\t}),\n\t\t\t\tfont: L,\n\t\t\t\tins: L,\n\t\t\t\tmenu: Q,\n\t\t\t\tabbr: L,\n\t\t\t\tlabel: L,\n\t\t\t\ttable: _({\n\t\t\t\t\tthead: 1,\n\t\t\t\t\tcol: 1,\n\t\t\t\t\ttbody: 1,\n\t\t\t\t\ttr: 1,\n\t\t\t\t\tcolgroup: 1,\n\t\t\t\t\tcaption: 1,\n\t\t\t\t\ttfoot: 1\n\t\t\t\t}),\n\t\t\t\tcode: L,\n\t\t\t\ttfoot: M,\n\t\t\t\tcite: L,\n\t\t\t\tli: P,\n\t\t\t\tinput: {},\n\t\t\t\tiframe: P,\n\t\t\t\tstrong: L,\n\t\t\t\ttextarea: N,\n\t\t\t\tnoframes: P,\n\t\t\t\tbig: L,\n\t\t\t\tsmall: L,\n\t\t\t\t//trace:\n\t\t\t\tspan: _({\n\t\t\t\t\t'#': 1,\n\t\t\t\t\tbr: 1,\n\t\t\t\t\tb: 1,\n\t\t\t\t\tstrong: 1,\n\t\t\t\t\tu: 1,\n\t\t\t\t\ti: 1,\n\t\t\t\t\tem: 1,\n\t\t\t\t\tsub: 1,\n\t\t\t\t\tsup: 1,\n\t\t\t\t\tstrike: 1,\n\t\t\t\t\tspan: 1\n\t\t\t\t}),\n\t\t\t\thr: L,\n\t\t\t\tdt: L,\n\t\t\t\tsub: L,\n\t\t\t\toptgroup: _({\n\t\t\t\t\toption: 1\n\t\t\t\t}),\n\t\t\t\tparam: {},\n\t\t\t\tbdo: L,\n\t\t\t\t'var': L,\n\t\t\t\tdiv: P,\n\t\t\t\tobject: O,\n\t\t\t\tsup: L,\n\t\t\t\tdd: P,\n\t\t\t\tstrike: L,\n\t\t\t\tarea: {},\n\t\t\t\tdir: Q,\n\t\t\t\tmap: X(_({\n\t\t\t\t\tarea: 1,\n\t\t\t\t\tform: 1,\n\t\t\t\t\tp: 1\n\t\t\t\t}), A, F, E),\n\t\t\t\tapplet: O,\n\t\t\t\tdl: _({\n\t\t\t\t\tdt: 1,\n\t\t\t\t\tdd: 1\n\t\t\t\t}),\n\t\t\t\tdel: L,\n\t\t\t\tisindex: {},\n\t\t\t\tfieldset: X(_({\n\t\t\t\t\tlegend: 1\n\t\t\t\t}), K),\n\t\t\t\tthead: M,\n\t\t\t\tul: Q,\n\t\t\t\tacronym: L,\n\t\t\t\tb: L,\n\t\t\t\ta: X(_({\n\t\t\t\t\ta: 1\n\t\t\t\t}), J),\n\t\t\t\tblockquote: X(_({\n\t\t\t\t\ttd: 1,\n\t\t\t\t\ttr: 1,\n\t\t\t\t\ttbody: 1,\n\t\t\t\t\tli: 1\n\t\t\t\t}), P),\n\t\t\t\tcaption: L,\n\t\t\t\ti: L,\n\t\t\t\tu: L,\n\t\t\t\ttbody: M,\n\t\t\t\ts: L,\n\t\t\t\taddress: X(D, I),\n\t\t\t\ttt: L,\n\t\t\t\tlegend: L,\n\t\t\t\tq: L,\n\t\t\t\tpre: X(G, C),\n\t\t\t\tp: X(_({\n\t\t\t\t\t'a': 1\n\t\t\t\t}), L),\n\t\t\t\tem: L,\n\t\t\t\tdfn: L\n\t\t\t});\n\t\t})();\n\t\n\t\t// core/domUtils.js\n\t\t/**\n\t\t * Dom操作工具包\n\t\t * @file\n\t\t * @module UE.dom.domUtils\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * Dom操作工具包\n\t\t * @unfile\n\t\t * @module UE.dom.domUtils\n\t\t */\n\t\tfunction getDomNode(node, start, ltr, startFromChild, fn, guard) {\n\t\t\tvar tmpNode = startFromChild && node[start],\n\t\t\t\tparent;\n\t\t\t!tmpNode && (tmpNode = node[ltr]);\n\t\t\twhile (!tmpNode && (parent = (parent || node).parentNode)) {\n\t\t\t\tif (parent.tagName == 'BODY' || guard && !guard(parent)) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\ttmpNode = parent[ltr];\n\t\t\t}\n\t\t\tif (tmpNode && fn && !fn(tmpNode)) {\n\t\t\t\treturn getDomNode(tmpNode, start, ltr, false, fn);\n\t\t\t}\n\t\t\treturn tmpNode;\n\t\t}\n\t\tvar attrFix = ie && browser.version < 9 ? {\n\t\t\t\ttabindex: \"tabIndex\",\n\t\t\t\treadonly: \"readOnly\",\n\t\t\t\t\"for\": \"htmlFor\",\n\t\t\t\t\"class\": \"className\",\n\t\t\t\tmaxlength: \"maxLength\",\n\t\t\t\tcellspacing: \"cellSpacing\",\n\t\t\t\tcellpadding: \"cellPadding\",\n\t\t\t\trowspan: \"rowSpan\",\n\t\t\t\tcolspan: \"colSpan\",\n\t\t\t\tusemap: \"useMap\",\n\t\t\t\tframeborder: \"frameBorder\"\n\t\t\t} : {\n\t\t\t\ttabindex: \"tabIndex\",\n\t\t\t\treadonly: \"readOnly\"\n\t\t\t},\n\t\t\tstyleBlock = utils.listToMap([\n\t\t\t\t'-webkit-box', '-moz-box', 'block',\n\t\t\t\t'list-item', 'table', 'table-row-group',\n\t\t\t\t'table-header-group', 'table-footer-group',\n\t\t\t\t'table-row', 'table-column-group', 'table-column',\n\t\t\t\t'table-cell', 'table-caption'\n\t\t\t]);\n\t\tvar domUtils = dom.domUtils = {\n\t\t\t//节点常量\n\t\t\tNODE_ELEMENT: 1,\n\t\t\tNODE_DOCUMENT: 9,\n\t\t\tNODE_TEXT: 3,\n\t\t\tNODE_COMMENT: 8,\n\t\t\tNODE_DOCUMENT_FRAGMENT: 11,\n\t\n\t\t\t//位置关系\n\t\t\tPOSITION_IDENTICAL: 0,\n\t\t\tPOSITION_DISCONNECTED: 1,\n\t\t\tPOSITION_FOLLOWING: 2,\n\t\t\tPOSITION_PRECEDING: 4,\n\t\t\tPOSITION_IS_CONTAINED: 8,\n\t\t\tPOSITION_CONTAINS: 16,\n\t\t\t//ie6使用其他的会有一段空白出现\n\t\t\tfillChar: ie && browser.version == '6' ? '\\ufeff' : '\\u200B',\n\t\t\t//-------------------------Node部分--------------------------------\n\t\t\tkeys: {\n\t\t\t\t/*Backspace*/\n\t\t\t\t8: 1,\n\t\t\t\t/*Delete*/ 46: 1,\n\t\t\t\t/*Shift*/\n\t\t\t\t16: 1,\n\t\t\t\t/*Ctrl*/ 17: 1,\n\t\t\t\t/*Alt*/ 18: 1,\n\t\t\t\t37: 1,\n\t\t\t\t38: 1,\n\t\t\t\t39: 1,\n\t\t\t\t40: 1,\n\t\t\t\t13: 1 /*enter*/\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取节点A相对于节点B的位置关系\n\t\t\t * @method getPosition\n\t\t\t * @param { Node } nodeA 需要查询位置关系的节点A\n\t\t\t * @param { Node } nodeB 需要查询位置关系的节点B\n\t\t\t * @return { Number } 节点A与节点B的关系\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //output: 20\n\t\t\t * var position = UE.dom.domUtils.getPosition( document.documentElement, document.body );\n\t\t\t *\n\t\t\t * switch ( position ) {\n\t\t\t *\n\t\t\t *      //0\n\t\t\t *      case UE.dom.domUtils.POSITION_IDENTICAL:\n\t\t\t *          console.log('元素相同');\n\t\t\t *          break;\n\t\t\t *      //1\n\t\t\t *      case UE.dom.domUtils.POSITION_DISCONNECTED:\n\t\t\t *          console.log('两个节点在不同的文档中');\n\t\t\t *          break;\n\t\t\t *      //2\n\t\t\t *      case UE.dom.domUtils.POSITION_FOLLOWING:\n\t\t\t *          console.log('节点A在节点B之后');\n\t\t\t *          break;\n\t\t\t *      //4\n\t\t\t *      case UE.dom.domUtils.POSITION_PRECEDING;\n\t\t\t *          console.log('节点A在节点B之前');\n\t\t\t *          break;\n\t\t\t *      //8\n\t\t\t *      case UE.dom.domUtils.POSITION_IS_CONTAINED:\n\t\t\t *          console.log('节点A被节点B包含');\n\t\t\t *          break;\n\t\t\t *      case 10:\n\t\t\t *          console.log('节点A被节点B包含且节点A在节点B之后');\n\t\t\t *          break;\n\t\t\t *      //16\n\t\t\t *      case UE.dom.domUtils.POSITION_CONTAINS:\n\t\t\t *          console.log('节点A包含节点B');\n\t\t\t *          break;\n\t\t\t *      case 20:\n\t\t\t *          console.log('节点A包含节点B且节点A在节点B之前');\n\t\t\t *          break;\n\t\t\t *\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetPosition: function(nodeA, nodeB) {\n\t\t\t\t// 如果两个节点是同一个节点\n\t\t\t\tif (nodeA === nodeB) {\n\t\t\t\t\t// domUtils.POSITION_IDENTICAL\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tvar node,\n\t\t\t\t\tparentsA = [nodeA],\n\t\t\t\t\tparentsB = [nodeB];\n\t\t\t\tnode = nodeA;\n\t\t\t\twhile (node = node.parentNode) {\n\t\t\t\t\t// 如果nodeB是nodeA的祖先节点\n\t\t\t\t\tif (node === nodeB) {\n\t\t\t\t\t\t// domUtils.POSITION_IS_CONTAINED + domUtils.POSITION_FOLLOWING\n\t\t\t\t\t\treturn 10;\n\t\t\t\t\t}\n\t\t\t\t\tparentsA.push(node);\n\t\t\t\t}\n\t\t\t\tnode = nodeB;\n\t\t\t\twhile (node = node.parentNode) {\n\t\t\t\t\t// 如果nodeA是nodeB的祖先节点\n\t\t\t\t\tif (node === nodeA) {\n\t\t\t\t\t\t// domUtils.POSITION_CONTAINS + domUtils.POSITION_PRECEDING\n\t\t\t\t\t\treturn 20;\n\t\t\t\t\t}\n\t\t\t\t\tparentsB.push(node);\n\t\t\t\t}\n\t\t\t\tparentsA.reverse();\n\t\t\t\tparentsB.reverse();\n\t\t\t\tif (parentsA[0] !== parentsB[0]) {\n\t\t\t\t\t// domUtils.POSITION_DISCONNECTED\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t\tvar i = -1;\n\t\t\t\twhile (i++, parentsA[i] === parentsB[i]) {}\n\t\t\t\tnodeA = parentsA[i];\n\t\t\t\tnodeB = parentsB[i];\n\t\t\t\twhile (nodeA = nodeA.nextSibling) {\n\t\t\t\t\tif (nodeA === nodeB) {\n\t\t\t\t\t\t// domUtils.POSITION_PRECEDING\n\t\t\t\t\t\treturn 4\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// domUtils.POSITION_FOLLOWING\n\t\t\t\treturn 2;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 检测节点node在父节点中的索引位置\n\t\t\t * @method getNodeIndex\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @return { Number } 该节点在父节点中的位置\n\t\t\t * @see UE.dom.domUtils.getNodeIndex(Node,Boolean)\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 检测节点node在父节点中的索引位置， 根据给定的mergeTextNode参数决定是否要合并多个连续的文本节点为一个节点\n\t\t\t * @method getNodeIndex\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @param { Boolean } mergeTextNode 是否合并多个连续的文本节点为一个节点\n\t\t\t * @return { Number } 该节点在父节点中的位置\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t *      var node = document.createElement(\"div\");\n\t\t\t *\n\t\t\t *      node.appendChild( document.createTextNode( \"hello\" ) );\n\t\t\t *      node.appendChild( document.createTextNode( \"world\" ) );\n\t\t\t *      node.appendChild( node = document.createElement( \"div\" ) );\n\t\t\t *\n\t\t\t *      //output: 2\n\t\t\t *      console.log( UE.dom.domUtils.getNodeIndex( node ) );\n\t\t\t *\n\t\t\t *      //output: 1\n\t\t\t *      console.log( UE.dom.domUtils.getNodeIndex( node, true ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetNodeIndex: function(node, ignoreTextNode) {\n\t\t\t\tvar preNode = node,\n\t\t\t\t\ti = 0;\n\t\t\t\twhile (preNode = preNode.previousSibling) {\n\t\t\t\t\tif (ignoreTextNode && preNode.nodeType == 3) {\n\t\t\t\t\t\tif (preNode.nodeType != preNode.nextSibling.nodeType) {\n\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\treturn i;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 检测节点node是否在给定的document对象上\n\t\t\t * @method inDoc\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @param { DomDocument } doc 需要检测的document对象\n\t\t\t * @return { Boolean } 该节点node是否在给定的document的dom树上\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var node = document.createElement(\"div\");\n\t\t\t *\n\t\t\t * //output: false\n\t\t\t * console.log( UE.do.domUtils.inDoc( node, document ) );\n\t\t\t *\n\t\t\t * document.body.appendChild( node );\n\t\t\t *\n\t\t\t * //output: true\n\t\t\t * console.log( UE.do.domUtils.inDoc( node, document ) );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tinDoc: function(node, doc) {\n\t\t\t\treturn domUtils.getPosition(node, doc) == 10;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 根据给定的过滤规则filterFn， 查找符合该过滤规则的node节点的第一个祖先节点，\n\t\t\t * 查找的起点是给定node节点的父节点。\n\t\t\t * @method findParent\n\t\t\t * @param { Node } node 需要查找的节点\n\t\t\t * @param { Function } filterFn 自定义的过滤方法。\n\t\t\t * @warning 查找的终点是到body节点为止\n\t\t\t * @remind 自定义的过滤方法filterFn接受一个Node对象作为参数， 该对象代表当前执行检测的祖先节点。 如果该\n\t\t\t *          节点满足过滤条件， 则要求返回true， 这时将直接返回该节点作为findParent()的结果， 否则， 请返回false。\n\t\t\t * @return { Node | Null } 如果找到符合过滤条件的节点， 就返回该节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var filterNode = UE.dom.domUtils.findParent( document.body.firstChild, function ( node ) {\n\t\t\t *\n\t\t\t *     //由于查找的终点是body节点， 所以永远也不会匹配当前过滤器的条件， 即这里永远会返回false\n\t\t\t *     return node.tagName === \"HTML\";\n\t\t\t *\n\t\t\t * } );\n\t\t\t *\n\t\t\t * //output: true\n\t\t\t * console.log( filterNode === null );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 根据给定的过滤规则filterFn， 查找符合该过滤规则的node节点的第一个祖先节点，\n\t\t\t * 如果includeSelf的值为true，则查找的起点是给定的节点node， 否则， 起点是node的父节点\n\t\t\t * @method findParent\n\t\t\t * @param { Node } node 需要查找的节点\n\t\t\t * @param { Function } filterFn 自定义的过滤方法。\n\t\t\t * @param { Boolean } includeSelf 查找过程是否包含自身\n\t\t\t * @warning 查找的终点是到body节点为止\n\t\t\t * @remind 自定义的过滤方法filterFn接受一个Node对象作为参数， 该对象代表当前执行检测的祖先节点。 如果该\n\t\t\t *          节点满足过滤条件， 则要求返回true， 这时将直接返回该节点作为findParent()的结果， 否则， 请返回false。\n\t\t\t * @remind 如果includeSelf为true， 则过滤器第一次执行时的参数会是节点本身。\n\t\t\t *          反之， 过滤器第一次执行时的参数将是该节点的父节点。\n\t\t\t * @return { Node | Null } 如果找到符合过滤条件的节点， 就返回该节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *      <div id=\"test\">\n\t\t\t *      </div>\n\t\t\t *\n\t\t\t *      <script type=\"text/javascript\">\n\t\t\t *\n\t\t\t *          //output: DIV, BODY\n\t\t\t *          var filterNode = UE.dom.domUtils.findParent( document.getElementById( \"test\" ), function ( node ) {\n\t\t\t *\n\t\t\t *              console.log( node.tagName );\n\t\t\t *              return false;\n\t\t\t *\n\t\t\t *          }, true );\n\t\t\t *\n\t\t\t *      </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tfindParent: function(node, filterFn, includeSelf) {\n\t\t\t\tif (node && !domUtils.isBody(node)) {\n\t\t\t\t\tnode = includeSelf ? node : node.parentNode;\n\t\t\t\t\twhile (node) {\n\t\t\t\t\t\tif (!filterFn || filterFn(node) || domUtils.isBody(node)) {\n\t\t\t\t\t\t\treturn filterFn && !filterFn(node) && domUtils.isBody(node) ? null : node;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 查找node的节点名为tagName的第一个祖先节点， 查找的起点是node节点的父节点。\n\t\t\t * @method findParentByTagName\n\t\t\t * @param { Node } node 需要查找的节点对象\n\t\t\t * @param { Array } tagNames 需要查找的父节点的名称数组\n\t\t\t * @warning 查找的终点是到body节点为止\n\t\t\t * @return { Node | NULL } 如果找到符合条件的节点， 则返回该节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var node = UE.dom.domUtils.findParentByTagName( document.getElementsByTagName(\"div\")[0], [ \"BODY\" ] );\n\t\t\t * //output: BODY\n\t\t\t * console.log( node.tagName );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 查找node的节点名为tagName的祖先节点， 如果includeSelf的值为true，则查找的起点是给定的节点node，\n\t\t\t * 否则， 起点是node的父节点。\n\t\t\t * @method findParentByTagName\n\t\t\t * @param { Node } node 需要查找的节点对象\n\t\t\t * @param { Array } tagNames 需要查找的父节点的名称数组\n\t\t\t * @param { Boolean } includeSelf 查找过程是否包含node节点自身\n\t\t\t * @warning 查找的终点是到body节点为止\n\t\t\t * @return { Node | NULL } 如果找到符合条件的节点， 则返回该节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var queryTarget = document.getElementsByTagName(\"div\")[0];\n\t\t\t * var node = UE.dom.domUtils.findParentByTagName( queryTarget, [ \"DIV\" ], true );\n\t\t\t * //output: true\n\t\t\t * console.log( queryTarget === node );\n\t\t\t * ```\n\t\t\t */\n\t\t\tfindParentByTagName: function(node, tagNames, includeSelf, excludeFn) {\n\t\t\t\ttagNames = utils.listToMap(utils.isArray(tagNames) ? tagNames : [tagNames]);\n\t\t\t\treturn domUtils.findParent(node, function(node) {\n\t\t\t\t\treturn tagNames[node.tagName] && !(excludeFn && excludeFn(node));\n\t\t\t\t}, includeSelf);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 查找节点node的祖先节点集合， 查找的起点是给定节点的父节点，结果集中不包含给定的节点。\n\t\t\t * @method findParents\n\t\t\t * @param { Node } node 需要查找的节点对象\n\t\t\t * @return { Array } 给定节点的祖先节点数组\n\t\t\t * @grammar UE.dom.domUtils.findParents(node)  => Array  //返回一个祖先节点数组集合，不包含自身\n\t\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf)  => Array  //返回一个祖先节点数组集合，includeSelf指定是否包含自身\n\t\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf,filterFn)  => Array  //返回一个祖先节点数组集合，filterFn指定过滤条件，返回true的node将被选取\n\t\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf,filterFn,closerFirst)  => Array  //返回一个祖先节点数组集合，closerFirst为true的话，node的直接父亲节点是数组的第0个\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 查找节点node的祖先节点集合， 如果includeSelf的值为true，\n\t\t\t * 则返回的结果集中允许出现当前给定的节点， 否则， 该节点不会出现在其结果集中。\n\t\t\t * @method findParents\n\t\t\t * @param { Node } node 需要查找的节点对象\n\t\t\t * @param { Boolean } includeSelf 查找的结果中是否允许包含当前查找的节点对象\n\t\t\t * @return { Array } 给定节点的祖先节点数组\n\t\t\t */\n\t\t\tfindParents: function(node, includeSelf, filterFn, closerFirst) {\n\t\t\t\tvar parents = includeSelf && (filterFn && filterFn(node) || !filterFn) ? [node] : [];\n\t\t\t\twhile (node = domUtils.findParent(node, filterFn)) {\n\t\t\t\t\tparents.push(node);\n\t\t\t\t}\n\t\t\t\treturn closerFirst ? parents : parents.reverse();\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 在节点node后面插入新节点newNode\n\t\t\t * @method insertAfter\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @param { Node } newNode 新插入的节点， 该节点将置于目标节点之后\n\t\t\t * @return { Node } 新插入的节点\n\t\t\t */\n\t\t\tinsertAfter: function(node, newNode) {\n\t\t\t\treturn node.nextSibling ? node.parentNode.insertBefore(newNode, node.nextSibling) :\n\t\t\t\t\tnode.parentNode.appendChild(newNode);\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 删除节点node及其下属的所有节点\n\t\t\t * @method remove\n\t\t\t * @param { Node } node 需要删除的节点对象\n\t\t\t * @return { Node } 返回刚删除的节点对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\">\n\t\t\t *     <div id=\"child\">你好</div>\n\t\t\t * </div>\n\t\t\t * <script>\n\t\t\t *     UE.dom.domUtils.remove( document.body, false );\n\t\t\t *     //output: false\n\t\t\t *     console.log( document.getElementById( \"child\" ) !== null );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 删除节点node，并根据keepChildren的值决定是否保留子节点\n\t\t\t * @method remove\n\t\t\t * @param { Node } node 需要删除的节点对象\n\t\t\t * @param { Boolean } keepChildren 是否需要保留子节点\n\t\t\t * @return { Node } 返回刚删除的节点对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\">\n\t\t\t *     <div id=\"child\">你好</div>\n\t\t\t * </div>\n\t\t\t * <script>\n\t\t\t *     UE.dom.domUtils.remove( document.body, true );\n\t\t\t *     //output: true\n\t\t\t *     console.log( document.getElementById( \"child\" ) !== null );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tremove: function(node, keepChildren) {\n\t\t\t\tvar parent = node.parentNode,\n\t\t\t\t\tchild;\n\t\t\t\tif (parent) {\n\t\t\t\t\tif (keepChildren && node.hasChildNodes()) {\n\t\t\t\t\t\twhile (child = node.firstChild) {\n\t\t\t\t\t\t\tparent.insertBefore(child, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tparent.removeChild(node);\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 取得node节点的下一个兄弟节点， 如果该节点其后没有兄弟节点， 则递归查找其父节点之后的第一个兄弟节点，\n\t\t\t * 直到找到满足条件的节点或者递归到BODY节点之后才会结束。\n\t\t\t * @method getNextDomNode\n\t\t\t * @param { Node } node 需要获取其后的兄弟节点的节点对象\n\t\t\t * @return { Node | NULL } 如果找满足条件的节点， 则返回该节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *     <body>\n\t\t\t *      <div id=\"test\">\n\t\t\t *          <span></span>\n\t\t\t *      </div>\n\t\t\t *      <i>xxx</i>\n\t\t\t * </body>\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: i节点\n\t\t\t *     console.log( UE.dom.domUtils.getNextDomNode( document.getElementById( \"test\" ) ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *      <div>\n\t\t\t *          <span></span>\n\t\t\t *          <i id=\"test\">xxx</i>\n\t\t\t *      </div>\n\t\t\t *      <b>xxx</b>\n\t\t\t * </body>\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //由于id为test的i节点之后没有兄弟节点， 则查找其父节点（div）后面的兄弟节点\n\t\t\t *     //output: b节点\n\t\t\t *     console.log( UE.dom.domUtils.getNextDomNode( document.getElementById( \"test\" ) ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 取得node节点的下一个兄弟节点， 如果startFromChild的值为ture，则先获取其子节点，\n\t\t\t * 如果有子节点则直接返回第一个子节点；如果没有子节点或者startFromChild的值为false，\n\t\t\t * 则执行<a href=\"#UE.dom.domUtils.getNextDomNode(Node)\">getNextDomNode(Node node)</a>的查找过程。\n\t\t\t * @method getNextDomNode\n\t\t\t * @param { Node } node 需要获取其后的兄弟节点的节点对象\n\t\t\t * @param { Boolean } startFromChild 查找过程是否从其子节点开始\n\t\t\t * @return { Node | NULL } 如果找满足条件的节点， 则返回该节点， 否则返回NULL\n\t\t\t * @see UE.dom.domUtils.getNextDomNode(Node)\n\t\t\t */\n\t\t\tgetNextDomNode: function(node, startFromChild, filterFn, guard) {\n\t\t\t\treturn getDomNode(node, 'firstChild', 'nextSibling', startFromChild, filterFn, guard);\n\t\t\t},\n\t\t\tgetPreDomNode: function(node, startFromChild, filterFn, guard) {\n\t\t\t\treturn getDomNode(node, 'lastChild', 'previousSibling', startFromChild, filterFn, guard);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 检测节点node是否属是UEditor定义的bookmark节点\n\t\t\t * @method isBookmarkNode\n\t\t\t * @private\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @return { Boolean } 是否是bookmark节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"_baidu_bookmark_1\"></span>\n\t\t\t * <script>\n\t\t\t *      var bookmarkNode = document.getElementById(\"_baidu_bookmark_1\");\n\t\t\t *      //output: true\n\t\t\t *      console.log( UE.dom.domUtils.isBookmarkNode( bookmarkNode ) );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tisBookmarkNode: function(node) {\n\t\t\t\treturn node.nodeType == 1 && node.id && /^_baidu_bookmark_/i.test(node.id);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取节点node所属的window对象\n\t\t\t * @method  getWindow\n\t\t\t * @param { Node } node 节点对象\n\t\t\t * @return { Window } 当前节点所属的window对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //output: true\n\t\t\t * console.log( UE.dom.domUtils.getWindow( document.body ) === window );\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetWindow: function(node) {\n\t\t\t\tvar doc = node.ownerDocument || node;\n\t\t\t\treturn doc.defaultView || doc.parentWindow;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取离nodeA与nodeB最近的公共的祖先节点\n\t\t\t * @method  getCommonAncestor\n\t\t\t * @param { Node } nodeA 第一个节点\n\t\t\t * @param { Node } nodeB 第二个节点\n\t\t\t * @remind 如果给定的两个节点是同一个节点， 将直接返回该节点。\n\t\t\t * @return { Node | NULL } 如果未找到公共节点， 返回NULL， 否则返回最近的公共祖先节点。\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var commonAncestor = UE.dom.domUtils.getCommonAncestor( document.body, document.body.firstChild );\n\t\t\t * //output: true\n\t\t\t * console.log( commonAncestor.tagName.toLowerCase() === 'body' );\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetCommonAncestor: function(nodeA, nodeB) {\n\t\t\t\tif (nodeA === nodeB)\n\t\t\t\t\treturn nodeA;\n\t\t\t\tvar parentsA = [nodeA],\n\t\t\t\t\tparentsB = [nodeB],\n\t\t\t\t\tparent = nodeA,\n\t\t\t\t\ti = -1;\n\t\t\t\twhile (parent = parent.parentNode) {\n\t\t\t\t\tif (parent === nodeB) {\n\t\t\t\t\t\treturn parent;\n\t\t\t\t\t}\n\t\t\t\t\tparentsA.push(parent);\n\t\t\t\t}\n\t\t\t\tparent = nodeB;\n\t\t\t\twhile (parent = parent.parentNode) {\n\t\t\t\t\tif (parent === nodeA)\n\t\t\t\t\t\treturn parent;\n\t\t\t\t\tparentsB.push(parent);\n\t\t\t\t}\n\t\t\t\tparentsA.reverse();\n\t\t\t\tparentsB.reverse();\n\t\t\t\twhile (i++, parentsA[i] === parentsB[i]) {}\n\t\t\t\treturn i == 0 ? null : parentsA[i - 1];\n\t\n\t\t\t},\n\t\t\t/**\n\t\t\t * 清除node节点左右连续为空的兄弟inline节点\n\t\t\t * @method clearEmptySibling\n\t\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t\t * 则这些兄弟节点将被删除\n\t\t\t * @grammar UE.dom.domUtils.clearEmptySibling(node,ignoreNext)  //ignoreNext指定是否忽略右边空节点\n\t\t\t * @grammar UE.dom.domUtils.clearEmptySibling(node,ignoreNext,ignorePre)  //ignorePre指定是否忽略左边空节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *     <div></div>\n\t\t\t *     <span id=\"test\"></span>\n\t\t\t *     <i></i>\n\t\t\t *     <b></b>\n\t\t\t *     <em>xxx</em>\n\t\t\t *     <span></span>\n\t\t\t * </body>\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *      UE.dom.domUtils.clearEmptySibling( document.getElementById( \"test\" ) );\n\t\t\t *\n\t\t\t *      //output: <div></div><span id=\"test\"></span><em>xxx</em><span></span>\n\t\t\t *      console.log( document.body.innerHTML );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 清除node节点左右连续为空的兄弟inline节点， 如果ignoreNext的值为true，\n\t\t\t * 则忽略对右边兄弟节点的操作。\n\t\t\t * @method clearEmptySibling\n\t\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t\t * @param { Boolean } ignoreNext 是否忽略忽略对右边的兄弟节点的操作\n\t\t\t * 则这些兄弟节点将被删除\n\t\t\t * @see UE.dom.domUtils.clearEmptySibling(Node)\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 清除node节点左右连续为空的兄弟inline节点， 如果ignoreNext的值为true，\n\t\t\t * 则忽略对右边兄弟节点的操作， 如果ignorePre的值为true，则忽略对左边兄弟节点的操作。\n\t\t\t * @method clearEmptySibling\n\t\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t\t * @param { Boolean } ignoreNext 是否忽略忽略对右边的兄弟节点的操作\n\t\t\t * @param { Boolean } ignorePre 是否忽略忽略对左边的兄弟节点的操作\n\t\t\t * 则这些兄弟节点将被删除\n\t\t\t * @see UE.dom.domUtils.clearEmptySibling(Node)\n\t\t\t */\n\t\t\tclearEmptySibling: function(node, ignoreNext, ignorePre) {\n\t\t\t\tfunction clear(next, dir) {\n\t\t\t\t\tvar tmpNode;\n\t\t\t\t\twhile (next && !domUtils.isBookmarkNode(next) && (domUtils.isEmptyInlineElement(next)\n\t\t\t\t\t\t\t//这里不能把空格算进来会吧空格干掉，出现文字间的空格丢掉了\n\t\t\t\t\t\t\t|| !new RegExp('[^\\t\\n\\r' + domUtils.fillChar + ']').test(next.nodeValue))) {\n\t\t\t\t\t\ttmpNode = next[dir];\n\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\tnext = tmpNode;\n\t\t\t\t\t}\n\t\t\t\t}!ignoreNext && clear(node.nextSibling, 'nextSibling');\n\t\t\t\t!ignorePre && clear(node.previousSibling, 'previousSibling');\n\t\t\t},\n\t\t\t/**\n\t\t\t * 将一个文本节点textNode拆分成两个文本节点，offset指定拆分位置\n\t\t\t * @method split\n\t\t\t * @param { Node } textNode 需要拆分的文本节点对象\n\t\t\t * @param { int } offset 需要拆分的位置， 位置计算从0开始\n\t\t\t * @return { Node } 拆分后形成的新节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\">abcdef</div>\n\t\t\t * <script>\n\t\t\t *      var newNode = UE.dom.domUtils.split( document.getElementById( \"test\" ).firstChild, 3 );\n\t\t\t *      //output: def\n\t\t\t *      console.log( newNode.nodeValue );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsplit: function(node, offset) {\n\t\t\t\tvar doc = node.ownerDocument;\n\t\t\t\tif (browser.ie && offset == node.nodeValue.length) {\n\t\t\t\t\tvar next = doc.createTextNode('');\n\t\t\t\t\treturn domUtils.insertAfter(node, next);\n\t\t\t\t}\n\t\t\t\tvar retval = node.splitText(offset);\n\t\t\t\t//ie8下splitText不会跟新childNodes,我们手动触发他的更新\n\t\t\t\tif (browser.ie8) {\n\t\t\t\t\tvar tmpNode = doc.createTextNode('');\n\t\t\t\t\tdomUtils.insertAfter(retval, tmpNode);\n\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t}\n\t\t\t\treturn retval;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 检测文本节点textNode是否为空节点（包括空格、换行、占位符等字符）\n\t\t\t * @method  isWhitespace\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @return { Boolean } 检测的节点是否为空\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\">\n\t\t\t *\n\t\t\t * </div>\n\t\t\t * <script>\n\t\t\t *      //output: true\n\t\t\t *      console.log( UE.dom.domUtils.isWhitespace( document.getElementById(\"test\").firstChild ) );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tisWhitespace: function(node) {\n\t\t\t\treturn !new RegExp('[^ \\t\\n\\r' + domUtils.fillChar + ']').test(node.nodeValue);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取元素element相对于viewport的位置坐标\n\t\t\t * @method getXY\n\t\t\t * @param { Node } element 需要计算位置的节点对象\n\t\t\t * @return { Object } 返回形如{x:left,y:top}的一个key-value映射对象， 其中键x代表水平偏移距离，\n\t\t\t *                          y代表垂直偏移距离。\n\t\t\t *\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var location = UE.dom.domUtils.getXY( document.getElementById(\"test\") );\n\t\t\t * //output: test的坐标为: 12, 24\n\t\t\t * console.log( 'test的坐标为： ', location.x, ',', location.y );\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetXY: function(element) {\n\t\t\t\tvar x = 0,\n\t\t\t\t\ty = 0;\n\t\t\t\twhile (element.offsetParent) {\n\t\t\t\t\ty += element.offsetTop;\n\t\t\t\t\tx += element.offsetLeft;\n\t\t\t\t\telement = element.offsetParent;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t'x': x,\n\t\t\t\t\t'y': y\n\t\t\t\t};\n\t\t\t},\n\t\t\t/**\n\t\t\t * 为元素element绑定原生DOM事件，type为事件类型，handler为处理函数\n\t\t\t * @method on\n\t\t\t * @param { Node } element 需要绑定事件的节点对象\n\t\t\t * @param { String } type 绑定的事件类型\n\t\t\t * @param { Function } handler 事件处理器\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * UE.dom.domUtils.on(document.body,\"click\",function(e){\n\t\t\t *     //e为事件对象，this为被点击元素对戏那个\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 为元素element绑定原生DOM事件，type为事件类型，handler为处理函数\n\t\t\t * @method on\n\t\t\t * @param { Node } element 需要绑定事件的节点对象\n\t\t\t * @param { Array } type 绑定的事件类型数组\n\t\t\t * @param { Function } handler 事件处理器\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * UE.dom.domUtils.on(document.body,[\"click\",\"mousedown\"],function(evt){\n\t\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\ton: function(element, type, handler) {\n\t\n\t\t\t\tvar types = utils.isArray(type) ? type : utils.trim(type).split(/\\s+/),\n\t\t\t\t\tk = types.length;\n\t\t\t\tif (k)\n\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\ttype = types[k];\n\t\t\t\t\t\tif (element.addEventListener) {\n\t\t\t\t\t\t\telement.addEventListener(type, handler, false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!handler._d) {\n\t\t\t\t\t\t\t\thandler._d = {\n\t\t\t\t\t\t\t\t\tels: []\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar key = type + handler.toString(),\n\t\t\t\t\t\t\t\tindex = utils.indexOf(handler._d.els, element);\n\t\t\t\t\t\t\tif (!handler._d[key] || index == -1) {\n\t\t\t\t\t\t\t\tif (index == -1) {\n\t\t\t\t\t\t\t\t\thandler._d.els.push(element);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!handler._d[key]) {\n\t\t\t\t\t\t\t\t\thandler._d[key] = function(evt) {\n\t\t\t\t\t\t\t\t\t\treturn handler.call(evt.srcElement, evt || window.event);\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\telement.attachEvent('on' + type, handler._d[key]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\telement = null;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 解除DOM事件绑定\n\t\t\t * @method un\n\t\t\t * @param { Node } element 需要解除事件绑定的节点对象\n\t\t\t * @param { String } type 需要接触绑定的事件类型\n\t\t\t * @param { Function } handler 对应的事件处理器\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * UE.dom.domUtils.un(document.body,\"click\",function(evt){\n\t\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 解除DOM事件绑定\n\t\t\t * @method un\n\t\t\t * @param { Node } element 需要解除事件绑定的节点对象\n\t\t\t * @param { Array } type 需要接触绑定的事件类型数组\n\t\t\t * @param { Function } handler 对应的事件处理器\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * UE.dom.domUtils.un(document.body, [\"click\",\"mousedown\"],function(evt){\n\t\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\tun: function(element, type, handler) {\n\t\t\t\tvar types = utils.isArray(type) ? type : utils.trim(type).split(/\\s+/),\n\t\t\t\t\tk = types.length;\n\t\t\t\tif (k)\n\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\ttype = types[k];\n\t\t\t\t\t\tif (element.removeEventListener) {\n\t\t\t\t\t\t\telement.removeEventListener(type, handler, false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar key = type + handler.toString();\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\telement.detachEvent('on' + type, handler._d ? handler._d[key] : handler);\n\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t\tif (handler._d && handler._d[key]) {\n\t\t\t\t\t\t\t\tvar index = utils.indexOf(handler._d.els, element);\n\t\t\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\t\t\thandler._d.els.splice(index, 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thandler._d.els.length == 0 && delete handler._d[key];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 比较节点nodeA与节点nodeB是否具有相同的标签名、属性名以及属性值\n\t\t\t * @method  isSameElement\n\t\t\t * @param { Node } nodeA 需要比较的节点\n\t\t\t * @param { Node } nodeB 需要比较的节点\n\t\t\t * @return { Boolean } 两个节点是否具有相同的标签名、属性名以及属性值\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span style=\"font-size:12px\">ssss</span>\n\t\t\t * <span style=\"font-size:12px\">bbbbb</span>\n\t\t\t * <span style=\"font-size:13px\">ssss</span>\n\t\t\t * <span style=\"font-size:14px\">bbbbb</span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var nodes = document.getElementsByTagName( \"span\" );\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.isSameElement( nodes[0], nodes[1] ) );\n\t\t\t *\n\t\t\t *     //output: false\n\t\t\t *     console.log( UE.dom.domUtils.isSameElement( nodes[2], nodes[3] ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tisSameElement: function(nodeA, nodeB) {\n\t\t\t\tif (nodeA.tagName != nodeB.tagName) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar thisAttrs = nodeA.attributes,\n\t\t\t\t\totherAttrs = nodeB.attributes;\n\t\t\t\tif (!ie && thisAttrs.length != otherAttrs.length) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tvar attrA, attrB, al = 0,\n\t\t\t\t\tbl = 0;\n\t\t\t\tfor (var i = 0; attrA = thisAttrs[i++];) {\n\t\t\t\t\tif (attrA.nodeName == 'style') {\n\t\t\t\t\t\tif (attrA.specified) {\n\t\t\t\t\t\t\tal++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (domUtils.isSameStyle(nodeA, nodeB)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (ie) {\n\t\t\t\t\t\tif (attrA.specified) {\n\t\t\t\t\t\t\tal++;\n\t\t\t\t\t\t\tattrB = otherAttrs.getNamedItem(attrA.nodeName);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tattrB = nodeB.attributes[attrA.nodeName];\n\t\t\t\t\t}\n\t\t\t\t\tif (!attrB.specified || attrA.nodeValue != attrB.nodeValue) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// 有可能attrB的属性包含了attrA的属性之外还有自己的属性\n\t\t\t\tif (ie) {\n\t\t\t\t\tfor (i = 0; attrB = otherAttrs[i++];) {\n\t\t\t\t\t\tif (attrB.specified) {\n\t\t\t\t\t\t\tbl++;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (al != bl) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 判断节点nodeA与节点nodeB的元素的style属性是否一致\n\t\t\t * @method isSameStyle\n\t\t\t * @param { Node } nodeA 需要比较的节点\n\t\t\t * @param { Node } nodeB 需要比较的节点\n\t\t\t * @return { Boolean } 两个节点是否具有相同的style属性值\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span style=\"font-size:12px\">ssss</span>\n\t\t\t * <span style=\"font-size:12px\">bbbbb</span>\n\t\t\t * <span style=\"font-size:13px\">ssss</span>\n\t\t\t * <span style=\"font-size:14px\">bbbbb</span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var nodes = document.getElementsByTagName( \"span\" );\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.isSameStyle( nodes[0], nodes[1] ) );\n\t\t\t *\n\t\t\t *     //output: false\n\t\t\t *     console.log( UE.dom.domUtils.isSameStyle( nodes[2], nodes[3] ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tisSameStyle: function(nodeA, nodeB) {\n\t\t\t\tvar styleA = nodeA.style.cssText.replace(/( ?; ?)/g, ';').replace(/( ?: ?)/g, ':'),\n\t\t\t\t\tstyleB = nodeB.style.cssText.replace(/( ?; ?)/g, ';').replace(/( ?: ?)/g, ':');\n\t\t\t\tif (browser.opera) {\n\t\t\t\t\tstyleA = nodeA.style;\n\t\t\t\t\tstyleB = nodeB.style;\n\t\t\t\t\tif (styleA.length != styleB.length)\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tfor (var p in styleA) {\n\t\t\t\t\t\tif (/^(\\d+|csstext)$/i.test(p)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (styleA[p] != styleB[p]) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\tif (!styleA || !styleB) {\n\t\t\t\t\treturn styleA == styleB;\n\t\t\t\t}\n\t\t\t\tstyleA = styleA.split(';');\n\t\t\t\tstyleB = styleB.split(';');\n\t\t\t\tif (styleA.length != styleB.length) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tfor (var i = 0, ci; ci = styleA[i++];) {\n\t\t\t\t\tif (utils.indexOf(styleB, ci) == -1) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 检查节点node是否为block元素\n\t\t\t * @method isBlockElm\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @return { Boolean } 是否是block元素节点\n\t\t\t * @warning 该方法的判断规则如下： 如果该元素原本是block元素， 则不论该元素当前的css样式是什么都会返回true；\n\t\t\t *          否则，检测该元素的css样式， 如果该元素当前是block元素， 则返回true。 其余情况下都返回false。\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test1\" style=\"display: block\"></span>\n\t\t\t * <span id=\"test2\"></span>\n\t\t\t * <div id=\"test3\" style=\"display: inline\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test1\") ) );\n\t\t\t *\n\t\t\t *     //output: false\n\t\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test2\") ) );\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test3\") ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tisBlockElm: function(node) {\n\t\t\t\treturn node.nodeType == 1 && (dtd.$block[node.tagName] || styleBlock[domUtils.getComputedStyle(node, 'display')]) && !dtd.$nonChild[node.tagName];\n\t\t\t},\n\t\t\t/**\n\t\t\t * 检测node节点是否为body节点\n\t\t\t * @method isBody\n\t\t\t * @param { Element } node 需要检测的dom元素\n\t\t\t * @return { Boolean } 给定的元素是否是body元素\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //output: true\n\t\t\t * console.log( UE.dom.domUtils.isBody( document.body ) );\n\t\t\t * ```\n\t\t\t */\n\t\t\tisBody: function(node) {\n\t\t\t\treturn node && node.nodeType == 1 && node.tagName.toLowerCase() == 'body';\n\t\t\t},\n\t\t\t/**\n\t\t\t * 以node节点为分界，将该节点的指定祖先节点parent拆分成两个独立的节点，\n\t\t\t * 拆分形成的两个节点之间是node节点\n\t\t\t * @method breakParent\n\t\t\t * @param { Node } node 作为分界的节点对象\n\t\t\t * @param { Node } parent 该节点必须是node节点的祖先节点， 且是block节点。\n\t\t\t * @return { Node } 给定的node分界节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t *      var node = document.createElement(\"span\"),\n\t\t\t *          wrapNode = document.createElement( \"div\" ),\n\t\t\t *          parent = document.createElement(\"p\");\n\t\t\t *\n\t\t\t *      parent.appendChild( node );\n\t\t\t *      wrapNode.appendChild( parent );\n\t\t\t *\n\t\t\t *      //拆分前\n\t\t\t *      //output: <p><span></span></p>\n\t\t\t *      console.log( wrapNode.innerHTML );\n\t\t\t *\n\t\t\t *\n\t\t\t *      UE.dom.domUtils.breakParent( node, parent );\n\t\t\t *      //拆分后\n\t\t\t *      //output: <p></p><span></span><p></p>\n\t\t\t *      console.log( wrapNode.innerHTML );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tbreakParent: function(node, parent) {\n\t\t\t\tvar tmpNode,\n\t\t\t\t\tparentClone = node,\n\t\t\t\t\tclone = node,\n\t\t\t\t\tleftNodes,\n\t\t\t\t\trightNodes;\n\t\t\t\tdo {\n\t\t\t\t\tparentClone = parentClone.parentNode;\n\t\t\t\t\tif (leftNodes) {\n\t\t\t\t\t\ttmpNode = parentClone.cloneNode(false);\n\t\t\t\t\t\ttmpNode.appendChild(leftNodes);\n\t\t\t\t\t\tleftNodes = tmpNode;\n\t\t\t\t\t\ttmpNode = parentClone.cloneNode(false);\n\t\t\t\t\t\ttmpNode.appendChild(rightNodes);\n\t\t\t\t\t\trightNodes = tmpNode;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tleftNodes = parentClone.cloneNode(false);\n\t\t\t\t\t\trightNodes = leftNodes.cloneNode(false);\n\t\t\t\t\t}\n\t\t\t\t\twhile (tmpNode = clone.previousSibling) {\n\t\t\t\t\t\tleftNodes.insertBefore(tmpNode, leftNodes.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\twhile (tmpNode = clone.nextSibling) {\n\t\t\t\t\t\trightNodes.appendChild(tmpNode);\n\t\t\t\t\t}\n\t\t\t\t\tclone = parentClone;\n\t\t\t\t} while (parent !== parentClone);\n\t\t\t\ttmpNode = parent.parentNode;\n\t\t\t\ttmpNode.insertBefore(leftNodes, parent);\n\t\t\t\ttmpNode.insertBefore(rightNodes, parent);\n\t\t\t\ttmpNode.insertBefore(node, rightNodes);\n\t\t\t\tdomUtils.remove(parent);\n\t\t\t\treturn node;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 检查节点node是否是空inline节点\n\t\t\t * @method  isEmptyInlineElement\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @return { Number }  如果给定的节点是空的inline节点， 则返回1, 否则返回0。\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <b><i></i></b> => 1\n\t\t\t * <b><i></i><u></u></b> => 1\n\t\t\t * <b></b> => 1\n\t\t\t * <b>xx<i></i></b> => 0\n\t\t\t * ```\n\t\t\t */\n\t\t\tisEmptyInlineElement: function(node) {\n\t\t\t\tif (node.nodeType != 1 || !dtd.$removeEmpty[node.tagName]) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tnode = node.firstChild;\n\t\t\t\twhile (node) {\n\t\t\t\t\t//如果是创建的bookmark就跳过\n\t\t\t\t\tif (domUtils.isBookmarkNode(node)) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (node.nodeType == 1 && !domUtils.isEmptyInlineElement(node) ||\n\t\t\t\t\t\tnode.nodeType == 3 && !domUtils.isWhitespace(node)\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.nextSibling;\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 删除node节点下首尾两端的空白文本子节点\n\t\t\t * @method trimWhiteTextNode\n\t\t\t * @param { Element } node 需要执行删除操作的元素对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *      var node = document.createElement(\"div\");\n\t\t\t *\n\t\t\t *      node.appendChild( document.createTextNode( \"\" ) );\n\t\t\t *\n\t\t\t *      node.appendChild( document.createElement(\"div\") );\n\t\t\t *\n\t\t\t *      node.appendChild( document.createTextNode( \"\" ) );\n\t\t\t *\n\t\t\t *      //3\n\t\t\t *      console.log( node.childNodes.length );\n\t\t\t *\n\t\t\t *      UE.dom.domUtils.trimWhiteTextNode( node );\n\t\t\t *\n\t\t\t *      //1\n\t\t\t *      console.log( node.childNodes.length );\n\t\t\t * ```\n\t\t\t */\n\t\t\ttrimWhiteTextNode: function(node) {\n\t\t\t\tfunction remove(dir) {\n\t\t\t\t\tvar child;\n\t\t\t\t\twhile ((child = node[dir]) && child.nodeType == 3 && domUtils.isWhitespace(child)) {\n\t\t\t\t\t\tnode.removeChild(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tremove('firstChild');\n\t\t\t\tremove('lastChild');\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 合并node节点下相同的子节点\n\t\t\t * @name mergeChild\n\t\t\t * @desc\n\t\t\t * UE.dom.domUtils.mergeChild(node,tagName) //tagName要合并的子节点的标签\n\t\t\t * @example\n\t\t\t * <p><span style=\"font-size:12px;\">xx<span style=\"font-size:12px;\">aa</span>xx</span></p>\n\t\t\t * ==> UE.dom.domUtils.mergeChild(node,'span')\n\t\t\t * <p><span style=\"font-size:12px;\">xxaaxx</span></p>\n\t\t\t */\n\t\t\tmergeChild: function(node, tagName, attrs) {\n\t\t\t\tvar list = domUtils.getElementsByTagName(node, node.tagName.toLowerCase());\n\t\t\t\tfor (var i = 0, ci; ci = list[i++];) {\n\t\t\t\t\tif (!ci.parentNode || domUtils.isBookmarkNode(ci)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t//span单独处理\n\t\t\t\t\tif (ci.tagName.toLowerCase() == 'span') {\n\t\t\t\t\t\tif (node === ci.parentNode) {\n\t\t\t\t\t\t\tdomUtils.trimWhiteTextNode(node);\n\t\t\t\t\t\t\tif (node.childNodes.length == 1) {\n\t\t\t\t\t\t\t\tnode.style.cssText = ci.style.cssText + \";\" + node.style.cssText;\n\t\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tci.style.cssText = node.style.cssText + ';' + ci.style.cssText;\n\t\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\t\tvar style = attrs.style;\n\t\t\t\t\t\t\tif (style) {\n\t\t\t\t\t\t\t\tstyle = style.split(';');\n\t\t\t\t\t\t\t\tfor (var j = 0, s; s = style[j++];) {\n\t\t\t\t\t\t\t\t\tci.style[utils.cssStyleToDomStyle(s.split(':')[0])] = s.split(':')[1];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (domUtils.isSameStyle(ci, node)) {\n\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (domUtils.isSameElement(node, ci)) {\n\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 原生方法getElementsByTagName的封装\n\t\t\t * @method getElementsByTagName\n\t\t\t * @param { Node } node 目标节点对象\n\t\t\t * @param { String } tagName 需要查找的节点的tagName， 多个tagName以空格分割\n\t\t\t * @return { Array } 符合条件的节点集合\n\t\t\t */\n\t\t\tgetElementsByTagName: function(node, name, filter) {\n\t\t\t\tif (filter && utils.isString(filter)) {\n\t\t\t\t\tvar className = filter;\n\t\t\t\t\tfilter = function(node) {\n\t\t\t\t\t\treturn domUtils.hasClass(node, className)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tname = utils.trim(name).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\tvar arr = [];\n\t\t\t\tfor (var n = 0, ni; ni = name[n++];) {\n\t\t\t\t\tvar list = node.getElementsByTagName(ni);\n\t\t\t\t\tfor (var i = 0, ci; ci = list[i++];) {\n\t\t\t\t\t\tif (!filter || filter(ci))\n\t\t\t\t\t\t\tarr.push(ci);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\treturn arr;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 将节点node提取到父节点上\n\t\t\t * @method mergeToParent\n\t\t\t * @param { Element } node 需要提取的元素对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"parent\">\n\t\t\t *     <div id=\"sub\">\n\t\t\t *         <span id=\"child\"></span>\n\t\t\t *     </div>\n\t\t\t * </div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var child = document.getElementById( \"child\" );\n\t\t\t *\n\t\t\t *     //output: sub\n\t\t\t *     console.log( child.parentNode.id );\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.mergeToParent( child );\n\t\t\t *\n\t\t\t *     //output: parent\n\t\t\t *     console.log( child.parentNode.id );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tmergeToParent: function(node) {\n\t\t\t\tvar parent = node.parentNode;\n\t\t\t\twhile (parent && dtd.$removeEmpty[parent.tagName]) {\n\t\t\t\t\tif (parent.tagName == node.tagName || parent.tagName == 'A') { //针对a标签单独处理\n\t\t\t\t\t\tdomUtils.trimWhiteTextNode(parent);\n\t\t\t\t\t\t//span需要特殊处理  不处理这样的情况 <span stlye=\"color:#fff\">xxx<span style=\"color:#ccc\">xxx</span>xxx</span>\n\t\t\t\t\t\tif (parent.tagName == 'SPAN' && !domUtils.isSameStyle(parent, node) || (parent.tagName == 'A' && node.tagName == 'SPAN')) {\n\t\t\t\t\t\t\tif (parent.childNodes.length > 1 || parent !== node.parentNode) {\n\t\t\t\t\t\t\t\tnode.style.cssText = parent.style.cssText + \";\" + node.style.cssText;\n\t\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tparent.style.cssText += \";\" + node.style.cssText;\n\t\t\t\t\t\t\t\t//trace:952 a标签要保持下划线\n\t\t\t\t\t\t\t\tif (parent.tagName == 'A') {\n\t\t\t\t\t\t\t\t\tparent.style.textDecoration = 'underline';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (parent.tagName != 'A') {\n\t\t\t\t\t\t\tparent === node.parentNode && domUtils.remove(node, true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 合并节点node的左右兄弟节点\n\t\t\t * @method mergeSibling\n\t\t\t * @param { Element } node 需要合并的目标节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t\t *     UE.dom.domUtils.mergeSibling( demoNode );\n\t\t\t *     //output: xxxxoooxxxx\n\t\t\t *     console.log( demoNode.innerHTML );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 合并节点node的左右兄弟节点， 可以根据给定的条件选择是否忽略合并左节点。\n\t\t\t * @method mergeSibling\n\t\t\t * @param { Element } node 需要合并的目标节点\n\t\t\t * @param { Boolean } ignorePre 是否忽略合并左节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t\t *     UE.dom.domUtils.mergeSibling( demoNode, true );\n\t\t\t *     //output: oooxxxx\n\t\t\t *     console.log( demoNode.innerHTML );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 合并节点node的左右兄弟节点，可以根据给定的条件选择是否忽略合并左右节点。\n\t\t\t * @method mergeSibling\n\t\t\t * @param { Element } node 需要合并的目标节点\n\t\t\t * @param { Boolean } ignorePre 是否忽略合并左节点\n\t\t\t * @param { Boolean } ignoreNext 是否忽略合并右节点\n\t\t\t * @remind 如果同时忽略左右节点， 则该操作什么也不会做\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t\t *     UE.dom.domUtils.mergeSibling( demoNode, false, true );\n\t\t\t *     //output: xxxxooo\n\t\t\t *     console.log( demoNode.innerHTML );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tmergeSibling: function(node, ignorePre, ignoreNext) {\n\t\t\t\tfunction merge(rtl, start, node) {\n\t\t\t\t\tvar next;\n\t\t\t\t\tif ((next = node[rtl]) && !domUtils.isBookmarkNode(next) && next.nodeType == 1 && domUtils.isSameElement(node, next)) {\n\t\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\t\tif (start == 'firstChild') {\n\t\t\t\t\t\t\t\tnode.insertBefore(next.lastChild, node.firstChild);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnode.appendChild(next.firstChild);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t}\n\t\t\t\t}!ignorePre && merge('previousSibling', 'firstChild', node);\n\t\t\t\t!ignoreNext && merge('nextSibling', 'lastChild', node);\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 设置节点node及其子节点不会被选中\n\t\t\t * @method unSelectable\n\t\t\t * @param { Element } node 需要执行操作的dom元素\n\t\t\t * @remind 执行该操作后的节点， 将不能被鼠标选中\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * UE.dom.domUtils.unSelectable( document.body );\n\t\t\t * ```\n\t\t\t */\n\t\t\tunSelectable: ie && browser.ie9below || browser.opera ? function(node) {\n\t\t\t\t//for ie9\n\t\t\t\tnode.onselectstart = function() {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\tnode.onclick = node.onkeyup = node.onkeydown = function() {\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t\tnode.unselectable = 'on';\n\t\t\t\tnode.setAttribute(\"unselectable\", \"on\");\n\t\t\t\tfor (var i = 0, ci; ci = node.all[i++];) {\n\t\t\t\t\tswitch (ci.tagName.toLowerCase()) {\n\t\t\t\t\t\tcase 'iframe':\n\t\t\t\t\t\tcase 'textarea':\n\t\t\t\t\t\tcase 'input':\n\t\t\t\t\t\tcase 'select':\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tci.unselectable = 'on';\n\t\t\t\t\t\t\tnode.setAttribute(\"unselectable\", \"on\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} : function(node) {\n\t\t\t\tnode.style.MozUserSelect =\n\t\t\t\t\tnode.style.webkitUserSelect =\n\t\t\t\t\tnode.style.msUserSelect =\n\t\t\t\t\tnode.style.KhtmlUserSelect = 'none';\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除节点node上的指定属性名称的属性\n\t\t\t * @method  removeAttributes\n\t\t\t * @param { Node } node 需要删除属性的节点对象\n\t\t\t * @param { String } attrNames 可以是空格隔开的多个属性名称，该操作将会依次删除相应的属性\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"wrap\">\n\t\t\t *      <span style=\"font-size:14px;\" id=\"test\" name=\"followMe\">xxxxx</span>\n\t\t\t * </div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.removeAttributes( document.getElementById( \"test\" ), \"id name\" );\n\t\t\t *\n\t\t\t *     //output: <span style=\"font-size:14px;\">xxxxx</span>\n\t\t\t *     console.log( document.getElementById(\"wrap\").innerHTML );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 删除节点node上的指定属性名称的属性\n\t\t\t * @method  removeAttributes\n\t\t\t * @param { Node } node 需要删除属性的节点对象\n\t\t\t * @param { Array } attrNames 需要删除的属性名数组\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"wrap\">\n\t\t\t *      <span style=\"font-size:14px;\" id=\"test\" name=\"followMe\">xxxxx</span>\n\t\t\t * </div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.removeAttributes( document.getElementById( \"test\" ), [\"id\", \"name\"] );\n\t\t\t *\n\t\t\t *     //output: <span style=\"font-size:14px;\">xxxxx</span>\n\t\t\t *     console.log( document.getElementById(\"wrap\").innerHTML );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tremoveAttributes: function(node, attrNames) {\n\t\t\t\tattrNames = utils.isArray(attrNames) ? attrNames : utils.trim(attrNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\tfor (var i = 0, ci; ci = attrNames[i++];) {\n\t\t\t\t\tci = attrFix[ci] || ci;\n\t\t\t\t\tswitch (ci) {\n\t\t\t\t\t\tcase 'className':\n\t\t\t\t\t\t\tnode[ci] = '';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\tnode.style.cssText = '';\n\t\t\t\t\t\t\tvar val = node.getAttributeNode('style');\n\t\t\t\t\t\t\t!browser.ie && val && node.removeAttributeNode(val);\n\t\t\t\t\t}\n\t\t\t\t\tnode.removeAttribute(ci);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 在doc下创建一个标签名为tag，属性为attrs的元素\n\t\t\t * @method createElement\n\t\t\t * @param { DomDocument } doc 新创建的元素属于该document节点创建\n\t\t\t * @param { String } tagName 需要创建的元素的标签名\n\t\t\t * @param { Object } attrs 新创建的元素的属性key-value集合\n\t\t\t * @return { Element } 新创建的元素对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var ele = UE.dom.domUtils.createElement( document, 'div', {\n\t\t\t *     id: 'test'\n\t\t\t * } );\n\t\t\t *\n\t\t\t * //output: DIV\n\t\t\t * console.log( ele.tagName );\n\t\t\t *\n\t\t\t * //output: test\n\t\t\t * console.log( ele.id );\n\t\t\t *\n\t\t\t * ```\n\t\t\t */\n\t\t\tcreateElement: function(doc, tag, attrs) {\n\t\t\t\treturn domUtils.setAttributes(doc.createElement(tag), attrs)\n\t\t\t},\n\t\t\t/**\n\t\t\t * 为节点node添加属性attrs，attrs为属性键值对\n\t\t\t * @method setAttributes\n\t\t\t * @param { Element } node 需要设置属性的元素对象\n\t\t\t * @param { Object } attrs 需要设置的属性名-值对\n\t\t\t * @return { Element } 设置属性的元素对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test\"></span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var testNode = UE.dom.domUtils.setAttributes( document.getElementById( \"test\" ), {\n\t\t\t *         id: 'demo'\n\t\t\t *     } );\n\t\t\t *\n\t\t\t *     //output: demo\n\t\t\t *     console.log( testNode.id );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t *\n\t\t\t */\n\t\t\tsetAttributes: function(node, attrs) {\n\t\t\t\tfor (var attr in attrs) {\n\t\t\t\t\tif (attrs.hasOwnProperty(attr)) {\n\t\t\t\t\t\tvar value = attrs[attr];\n\t\t\t\t\t\tswitch (attr) {\n\t\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\t\t//ie下要这样赋值，setAttribute不起作用\n\t\t\t\t\t\t\t\tnode.className = value;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\t\tnode.style.cssText = node.style.cssText + \";\" + value;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'innerHTML':\n\t\t\t\t\t\t\t\tnode[attr] = value;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'value':\n\t\t\t\t\t\t\t\tnode.value = value;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tnode.setAttribute(attrFix[attr] || attr, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 获取元素element经过计算后的样式值\n\t\t\t * @method getComputedStyle\n\t\t\t * @param { Element } element 需要获取样式的元素对象\n\t\t\t * @param { String } styleName 需要获取的样式名\n\t\t\t * @return { String } 获取到的样式值\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <style type=\"text/css\">\n\t\t\t *      #test {\n\t\t\t *          font-size: 15px;\n\t\t\t *      }\n\t\t\t * </style>\n\t\t\t *\n\t\t\t * <span id=\"test\"></span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     //output: 15px\n\t\t\t *     console.log( UE.dom.domUtils.getComputedStyle( document.getElementById( \"test\" ), 'font-size' ) );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetComputedStyle: function(element, styleName) {\n\t\t\t\t//一下的属性单独处理\n\t\t\t\tvar pros = 'width height top left';\n\t\n\t\t\t\tif (pros.indexOf(styleName) > -1) {\n\t\t\t\t\treturn element['offset' + styleName.replace(/^\\w/, function(s) {\n\t\t\t\t\t\treturn s.toUpperCase()\n\t\t\t\t\t})] + 'px';\n\t\t\t\t}\n\t\t\t\t//忽略文本节点\n\t\t\t\tif (element.nodeType == 3) {\n\t\t\t\t\telement = element.parentNode;\n\t\t\t\t}\n\t\t\t\t//ie下font-size若body下定义了font-size，则从currentStyle里会取到这个font-size. 取不到实际值，故此修改.\n\t\t\t\tif (browser.ie && browser.version < 9 && styleName == 'font-size' && !element.style.fontSize &&\n\t\t\t\t\t!dtd.$empty[element.tagName] && !dtd.$nonChild[element.tagName]) {\n\t\t\t\t\tvar span = element.ownerDocument.createElement('span');\n\t\t\t\t\tspan.style.cssText = 'padding:0;border:0;font-family:simsun;';\n\t\t\t\t\tspan.innerHTML = '.';\n\t\t\t\t\telement.appendChild(span);\n\t\t\t\t\tvar result = span.offsetHeight;\n\t\t\t\t\telement.removeChild(span);\n\t\t\t\t\tspan = null;\n\t\t\t\t\treturn result + 'px';\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tvar value = domUtils.getStyle(element, styleName) ||\n\t\t\t\t\t\t(window.getComputedStyle ? domUtils.getWindow(element).getComputedStyle(element, '').getPropertyValue(styleName) :\n\t\t\t\t\t\t\t(element.currentStyle || element.style)[utils.cssStyleToDomStyle(styleName)]);\n\t\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn \"\";\n\t\t\t\t}\n\t\t\t\treturn utils.transUnitToPx(utils.fixColor(styleName, value));\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除元素element指定的className\n\t\t\t * @method removeClasses\n\t\t\t * @param { Element } ele 需要删除class的元素节点\n\t\t\t * @param { String } classNames 需要删除的className， 多个className之间以空格分开\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test\" class=\"test1 test2 test3\">xxx</span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var testNode = document.getElementById( \"test\" );\n\t\t\t *     UE.dom.domUtils.removeClasses( testNode, \"test1 test2\" );\n\t\t\t *\n\t\t\t *     //output: test3\n\t\t\t *     console.log( testNode.className );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 删除元素element指定的className\n\t\t\t * @method removeClasses\n\t\t\t * @param { Element } ele 需要删除class的元素节点\n\t\t\t * @param { Array } classNames 需要删除的className数组\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test\" class=\"test1 test2 test3\">xxx</span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var testNode = document.getElementById( \"test\" );\n\t\t\t *     UE.dom.domUtils.removeClasses( testNode, [\"test1\", \"test2\"] );\n\t\t\t *\n\t\t\t *     //output: test3\n\t\t\t *     console.log( testNode.className );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tremoveClasses: function(elm, classNames) {\n\t\t\t\tclassNames = utils.isArray(classNames) ? classNames :\n\t\t\t\t\tutils.trim(classNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\tfor (var i = 0, ci, cls = elm.className; ci = classNames[i++];) {\n\t\t\t\t\tcls = cls.replace(new RegExp('\\\\b' + ci + '\\\\b'), '')\n\t\t\t\t}\n\t\t\t\tcls = utils.trim(cls).replace(/[ ]{2,}/g, ' ');\n\t\t\t\tif (cls) {\n\t\t\t\t\telm.className = cls;\n\t\t\t\t} else {\n\t\t\t\t\tdomUtils.removeAttributes(elm, ['class']);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 给元素element添加className\n\t\t\t * @method addClass\n\t\t\t * @param { Node } ele 需要增加className的元素\n\t\t\t * @param { String } classNames 需要添加的className， 多个className之间以空格分割\n\t\t\t * @remind 相同的类名不会被重复添加\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test\" class=\"cls1 cls2\"></span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var testNode = document.getElementById(\"test\");\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.addClass( testNode, \"cls2 cls3 cls4\" );\n\t\t\t *\n\t\t\t *     //output: cl1 cls2 cls3 cls4\n\t\t\t *     console.log( testNode.className );\n\t\t\t *\n\t\t\t * <script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 给元素element添加className\n\t\t\t * @method addClass\n\t\t\t * @param { Node } ele 需要增加className的元素\n\t\t\t * @param { Array } classNames 需要添加的className的数组\n\t\t\t * @remind 相同的类名不会被重复添加\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test\" class=\"cls1 cls2\"></span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var testNode = document.getElementById(\"test\");\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.addClass( testNode, [\"cls2\", \"cls3\", \"cls4\"] );\n\t\t\t *\n\t\t\t *     //output: cl1 cls2 cls3 cls4\n\t\t\t *     console.log( testNode.className );\n\t\t\t *\n\t\t\t * <script>\n\t\t\t * ```\n\t\t\t */\n\t\t\taddClass: function(elm, classNames) {\n\t\t\t\tif (!elm) return;\n\t\t\t\tclassNames = utils.trim(classNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\tfor (var i = 0, ci, cls = elm.className; ci = classNames[i++];) {\n\t\t\t\t\tif (!new RegExp('\\\\b' + ci + '\\\\b').test(cls)) {\n\t\t\t\t\t\tcls += ' ' + ci;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telm.className = utils.trim(cls);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 判断元素element是否包含给定的样式类名className\n\t\t\t * @method hasClass\n\t\t\t * @param { Node } ele 需要检测的元素\n\t\t\t * @param { String } classNames 需要检测的className， 多个className之间用空格分割\n\t\t\t * @return { Boolean } 元素是否包含所有给定的className\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test1\" class=\"cls1 cls2\"></span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var test1 = document.getElementById(\"test1\");\n\t\t\t *\n\t\t\t *     //output: false\n\t\t\t *     console.log( UE.dom.domUtils.hasClass( test1, \"cls2 cls1 cls3\" ) );\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.hasClass( test1, \"cls2 cls1\" ) );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 判断元素element是否包含给定的样式类名className\n\t\t\t * @method hasClass\n\t\t\t * @param { Node } ele 需要检测的元素\n\t\t\t * @param { Array } classNames 需要检测的className数组\n\t\t\t * @return { Boolean } 元素是否包含所有给定的className\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test1\" class=\"cls1 cls2\"></span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var test1 = document.getElementById(\"test1\");\n\t\t\t *\n\t\t\t *     //output: false\n\t\t\t *     console.log( UE.dom.domUtils.hasClass( test1, [ \"cls2\", \"cls1\", \"cls3\" ] ) );\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.hasClass( test1, [ \"cls2\", \"cls1\" ]) );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\thasClass: function(element, className) {\n\t\t\t\tif (utils.isRegExp(className)) {\n\t\t\t\t\treturn className.test(element.className)\n\t\t\t\t}\n\t\t\t\tclassName = utils.trim(className).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\tfor (var i = 0, ci, cls = element.className; ci = className[i++];) {\n\t\t\t\t\tif (!new RegExp('\\\\b' + ci + '\\\\b', 'i').test(cls)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn i - 1 == className.length;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 阻止事件默认行为\n\t\t\t * @method preventDefault\n\t\t\t * @param { Event } evt 需要阻止默认行为的事件对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * UE.dom.domUtils.preventDefault( evt );\n\t\t\t * ```\n\t\t\t */\n\t\t\tpreventDefault: function(evt) {\n\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除元素element指定的样式\n\t\t\t * @method removeStyle\n\t\t\t * @param { Element } element 需要删除样式的元素\n\t\t\t * @param { String } styleName 需要删除的样式名\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span id=\"test\" style=\"color: red; background: blue;\"></span>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var testNode = document.getElementById(\"test\");\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.removeStyle( testNode, 'color' );\n\t\t\t *\n\t\t\t *     //output: background: blue;\n\t\t\t *     console.log( testNode.style.cssText );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tremoveStyle: function(element, name) {\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\t//针对color先单独处理一下\n\t\t\t\t\tif (name == 'color') {\n\t\t\t\t\t\tname = '(^|;)' + name;\n\t\t\t\t\t}\n\t\t\t\t\telement.style.cssText = element.style.cssText.replace(new RegExp(name + '[^:]*:[^;]+;?', 'ig'), '')\n\t\t\t\t} else {\n\t\t\t\t\tif (element.style.removeProperty) {\n\t\t\t\t\t\telement.style.removeProperty(name);\n\t\t\t\t\t} else {\n\t\t\t\t\t\telement.style.removeAttribute(utils.cssStyleToDomStyle(name));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (!element.style.cssText) {\n\t\t\t\t\tdomUtils.removeAttributes(element, ['style']);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取元素element的style属性的指定值\n\t\t\t * @method getStyle\n\t\t\t * @param { Element } element 需要获取属性值的元素\n\t\t\t * @param { String } styleName 需要获取的style的名称\n\t\t\t * @warning 该方法仅获取元素style属性中所标明的值\n\t\t\t * @return { String } 该元素包含指定的style属性值\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\" style=\"color: red;\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t\t *\n\t\t\t *      //output: red\n\t\t\t *      console.log( UE.dom.domUtils.getStyle( testNode, \"color\" ) );\n\t\t\t *\n\t\t\t *      //output: \"\"\n\t\t\t *      console.log( UE.dom.domUtils.getStyle( testNode, \"background\" ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetStyle: function(element, name) {\n\t\t\t\tvar value = element.style[utils.cssStyleToDomStyle(name)];\n\t\t\t\treturn utils.fixColor(name, value);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 为元素element设置样式属性值\n\t\t\t * @method setStyle\n\t\t\t * @param { Element } element 需要设置样式的元素\n\t\t\t * @param { String } styleName 样式名\n\t\t\t * @param { String } styleValue 样式值\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t\t *\n\t\t\t *      //output: \"\"\n\t\t\t *      console.log( testNode.style.color );\n\t\t\t *\n\t\t\t *      UE.dom.domUtils.setStyle( testNode, 'color', 'red' );\n\t\t\t *      //output: \"red\"\n\t\t\t *      console.log( testNode.style.color );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStyle: function(element, name, value) {\n\t\t\t\telement.style[utils.cssStyleToDomStyle(name)] = value;\n\t\t\t\tif (!utils.trim(element.style.cssText)) {\n\t\t\t\t\tthis.removeAttributes(element, 'style')\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 为元素element设置多个样式属性值\n\t\t\t * @method setStyles\n\t\t\t * @param { Element } element 需要设置样式的元素\n\t\t\t * @param { Object } styles 样式名值对\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t\t *\n\t\t\t *      //output: \"\"\n\t\t\t *      console.log( testNode.style.color );\n\t\t\t *\n\t\t\t *      UE.dom.domUtils.setStyles( testNode, {\n\t\t\t *          'color': 'red'\n\t\t\t *      } );\n\t\t\t *      //output: \"red\"\n\t\t\t *      console.log( testNode.style.color );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStyles: function(element, styles) {\n\t\t\t\tfor (var name in styles) {\n\t\t\t\t\tif (styles.hasOwnProperty(name)) {\n\t\t\t\t\t\tdomUtils.setStyle(element, name, styles[name]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除_moz_dirty属性\n\t\t\t * @private\n\t\t\t * @method removeDirtyAttr\n\t\t\t */\n\t\t\tremoveDirtyAttr: function(node) {\n\t\t\t\tfor (var i = 0, ci, nodes = node.getElementsByTagName('*'); ci = nodes[i++];) {\n\t\t\t\t\tci.removeAttribute('_moz_dirty');\n\t\t\t\t}\n\t\t\t\tnode.removeAttribute('_moz_dirty');\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取子节点的数量\n\t\t\t * @method getChildCount\n\t\t\t * @param { Element } node 需要检测的元素\n\t\t\t * @return { Number } 给定的node元素的子节点数量\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\">\n\t\t\t *      <span></span>\n\t\t\t * </div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: 3\n\t\t\t *     console.log( UE.dom.domUtils.getChildCount( document.getElementById(\"test\") ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 根据给定的过滤规则， 获取符合条件的子节点的数量\n\t\t\t * @method getChildCount\n\t\t\t * @param { Element } node 需要检测的元素\n\t\t\t * @param { Function } fn 过滤器， 要求对符合条件的子节点返回true， 反之则要求返回false\n\t\t\t * @return { Number } 符合过滤条件的node元素的子节点数量\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\">\n\t\t\t *      <span></span>\n\t\t\t * </div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: 1\n\t\t\t *     console.log( UE.dom.domUtils.getChildCount( document.getElementById(\"test\"), function ( node ) {\n\t\t\t *\n\t\t\t *         return node.nodeType === 1;\n\t\t\t *\n\t\t\t *     } ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetChildCount: function(node, fn) {\n\t\t\t\tvar count = 0,\n\t\t\t\t\tfirst = node.firstChild;\n\t\t\t\tfn = fn || function() {\n\t\t\t\t\treturn 1;\n\t\t\t\t};\n\t\t\t\twhile (first) {\n\t\t\t\t\tif (fn(first)) {\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t}\n\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t}\n\t\t\t\treturn count;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 判断给定节点是否为空节点\n\t\t\t * @method isEmptyNode\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @return { Boolean } 节点是否为空\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * UE.dom.domUtils.isEmptyNode( document.body );\n\t\t\t * ```\n\t\t\t */\n\t\t\tisEmptyNode: function(node) {\n\t\t\t\treturn !node.firstChild || domUtils.getChildCount(node, function(node) {\n\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isBookmarkNode(node) && !domUtils.isWhitespace(node)\n\t\t\t\t}) == 0\n\t\t\t},\n\t\t\tclearSelectedArr: function(nodes) {\n\t\t\t\tvar node;\n\t\t\t\twhile (node = nodes.pop()) {\n\t\t\t\t\tdomUtils.removeAttributes(node, ['class']);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 将显示区域滚动到指定节点的位置\n\t\t\t * @method scrollToView\n\t\t\t * @param    {Node}   node    节点\n\t\t\t * @param    {window}   win      window对象\n\t\t\t * @param    {Number}    offsetTop    距离上方的偏移量\n\t\t\t */\n\t\t\tscrollToView: function(node, win, offsetTop) {\n\t\t\t\tvar getViewPaneSize = function() {\n\t\t\t\t\t\tvar doc = win.document,\n\t\t\t\t\t\t\tmode = doc.compatMode == 'CSS1Compat';\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\twidth: (mode ? doc.documentElement.clientWidth : doc.body.clientWidth) || 0,\n\t\t\t\t\t\t\theight: (mode ? doc.documentElement.clientHeight : doc.body.clientHeight) || 0\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\tgetScrollPosition = function(win) {\n\t\t\t\t\t\tif ('pageXOffset' in win) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tx: win.pageXOffset || 0,\n\t\t\t\t\t\t\t\ty: win.pageYOffset || 0\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar doc = win.document;\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tx: doc.documentElement.scrollLeft || doc.body.scrollLeft || 0,\n\t\t\t\t\t\t\t\ty: doc.documentElement.scrollTop || doc.body.scrollTop || 0\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\tvar winHeight = getViewPaneSize().height,\n\t\t\t\t\toffset = winHeight * -1 + offsetTop;\n\t\t\t\toffset += (node.offsetHeight || 0);\n\t\t\t\tvar elementPosition = domUtils.getXY(node);\n\t\t\t\toffset += elementPosition.y;\n\t\t\t\tvar currentScroll = getScrollPosition(win).y;\n\t\t\t\t// offset += 50;\n\t\t\t\tif (offset > currentScroll || offset < currentScroll - winHeight) {\n\t\t\t\t\twin.scrollTo(0, offset + (offset < 0 ? -20 : 20));\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 判断给定节点是否为br\n\t\t\t * @method isBr\n\t\t\t * @param { Node } node 需要判断的节点对象\n\t\t\t * @return { Boolean } 给定的节点是否是br节点\n\t\t\t */\n\t\t\tisBr: function(node) {\n\t\t\t\treturn node.nodeType == 1 && node.tagName == 'BR';\n\t\t\t},\n\t\t\t/**\n\t\t\t * 判断给定的节点是否是一个“填充”节点\n\t\t\t * @private\n\t\t\t * @method isFillChar\n\t\t\t * @param { Node } node 需要判断的节点\n\t\t\t * @param { Boolean } isInStart 是否从节点内容的开始位置匹配\n\t\t\t * @returns { Boolean } 节点是否是填充节点\n\t\t\t */\n\t\t\tisFillChar: function(node, isInStart) {\n\t\t\t\tif (node.nodeType != 3)\n\t\t\t\t\treturn false;\n\t\t\t\tvar text = node.nodeValue;\n\t\t\t\tif (isInStart) {\n\t\t\t\t\treturn new RegExp('^' + domUtils.fillChar).test(text)\n\t\t\t\t}\n\t\t\t\treturn !text.replace(new RegExp(domUtils.fillChar, 'g'), '').length\n\t\t\t},\n\t\t\tisStartInblock: function(range) {\n\t\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\t\tflag = 0,\n\t\t\t\t\tstart = tmpRange.startContainer,\n\t\t\t\t\ttmp;\n\t\t\t\tif (start.nodeType == 1 && start.childNodes[tmpRange.startOffset]) {\n\t\t\t\t\tstart = start.childNodes[tmpRange.startOffset];\n\t\t\t\t\tvar pre = start.previousSibling;\n\t\t\t\t\twhile (pre && domUtils.isFillChar(pre)) {\n\t\t\t\t\t\tstart = pre;\n\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (this.isFillChar(start, true) && tmpRange.startOffset == 1) {\n\t\t\t\t\ttmpRange.setStartBefore(start);\n\t\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t\t}\n\t\n\t\t\t\twhile (start && domUtils.isFillChar(start)) {\n\t\t\t\t\ttmp = start;\n\t\t\t\t\tstart = start.previousSibling\n\t\t\t\t}\n\t\t\t\tif (tmp) {\n\t\t\t\t\ttmpRange.setStartBefore(tmp);\n\t\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t\t}\n\t\t\t\tif (start.nodeType == 1 && domUtils.isEmptyNode(start) && tmpRange.startOffset == 1) {\n\t\t\t\t\ttmpRange.setStart(start, 0).collapse(true);\n\t\t\t\t}\n\t\t\t\twhile (!tmpRange.startOffset) {\n\t\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t\t\tif (domUtils.isBlockElm(start) || domUtils.isBody(start)) {\n\t\t\t\t\t\tflag = 1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tvar pre = tmpRange.startContainer.previousSibling,\n\t\t\t\t\t\ttmpNode;\n\t\t\t\t\tif (!pre) {\n\t\t\t\t\t\ttmpRange.setStartBefore(tmpRange.startContainer);\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (pre && domUtils.isFillChar(pre)) {\n\t\t\t\t\t\t\ttmpNode = pre;\n\t\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\t\ttmpRange.setStartBefore(tmpNode);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttmpRange.setStartBefore(tmpRange.startContainer);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn flag && !domUtils.isBody(tmpRange.startContainer) ? 1 : 0;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 判断给定的元素是否是一个空元素\n\t\t\t * @method isEmptyBlock\n\t\t\t * @param { Element } node 需要判断的元素\n\t\t\t * @return { Boolean } 是否是空元素\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.isEmptyBlock( document.getElementById(\"test\") ) );\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 根据指定的判断规则判断给定的元素是否是一个空元素\n\t\t\t * @method isEmptyBlock\n\t\t\t * @param { Element } node 需要判断的元素\n\t\t\t * @param { RegExp } reg 对内容执行判断的正则表达式对象\n\t\t\t * @return { Boolean } 是否是空元素\n\t\t\t */\n\t\t\tisEmptyBlock: function(node, reg) {\n\t\t\t\tif (node.nodeType != 1)\n\t\t\t\t\treturn 0;\n\t\t\t\treg = reg || new RegExp('[ \\xa0\\t\\r\\n' + domUtils.fillChar + ']', 'g');\n\t\n\t\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(reg, '').length > 0) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tfor (var n in dtd.$isNotEmpty) {\n\t\t\t\t\tif (node.getElementsByTagName(n).length) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 移动元素使得该元素的位置移动指定的偏移量的距离\n\t\t\t * @method setViewportOffset\n\t\t\t * @param { Element } element 需要设置偏移量的元素\n\t\t\t * @param { Object } offset 偏移量， 形如{ left: 100, top: 50 }的一个键值对， 表示该元素将在\n\t\t\t *                                  现有的位置上向水平方向偏移offset.left的距离， 在竖直方向上偏移\n\t\t\t *                                  offset.top的距离\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\" style=\"top: 100px; left: 50px; position: absolute;\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var testNode = document.getElementById(\"test\");\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.setViewportOffset( testNode, {\n\t\t\t *         left: 200,\n\t\t\t *         top: 50\n\t\t\t *     } );\n\t\t\t *\n\t\t\t *     //output: top: 300px; left: 100px; position: absolute;\n\t\t\t *     console.log( testNode.style.cssText );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetViewportOffset: function(element, offset) {\n\t\t\t\tvar left = parseInt(element.style.left) | 0;\n\t\t\t\tvar top = parseInt(element.style.top) | 0;\n\t\t\t\tvar rect = element.getBoundingClientRect();\n\t\t\t\tvar offsetLeft = offset.left - rect.left;\n\t\t\t\tvar offsetTop = offset.top - rect.top;\n\t\t\t\tif (offsetLeft) {\n\t\t\t\t\telement.style.left = left + offsetLeft + 'px';\n\t\t\t\t}\n\t\t\t\tif (offsetTop) {\n\t\t\t\t\telement.style.top = top + offsetTop + 'px';\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 用“填充字符”填充节点\n\t\t\t * @method fillNode\n\t\t\t * @private\n\t\t\t * @param { DomDocument } doc 填充的节点所在的docment对象\n\t\t\t * @param { Node } node 需要填充的节点对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     var testNode = document.getElementById(\"test\");\n\t\t\t *\n\t\t\t *     //output: 0\n\t\t\t *     console.log( testNode.childNodes.length );\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.fillNode( document, testNode );\n\t\t\t *\n\t\t\t *     //output: 1\n\t\t\t *     console.log( testNode.childNodes.length );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tfillNode: function(doc, node) {\n\t\t\t\tvar tmpNode = browser.ie ? doc.createTextNode(domUtils.fillChar) : doc.createElement('br');\n\t\t\t\tnode.innerHTML = '';\n\t\t\t\tnode.appendChild(tmpNode);\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 把节点src的所有子节点追加到另一个节点tag上去\n\t\t\t * @method moveChild\n\t\t\t * @param { Node } src 源节点， 该节点下的所有子节点将被移除\n\t\t\t * @param { Node } tag 目标节点， 从源节点移除的子节点将被追加到该节点下\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test1\">\n\t\t\t *      <span></span>\n\t\t\t * </div>\n\t\t\t * <div id=\"test2\">\n\t\t\t *     <div></div>\n\t\t\t * </div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var test1 = document.getElementById(\"test1\"),\n\t\t\t *         test2 = document.getElementById(\"test2\");\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.moveChild( test1, test2 );\n\t\t\t *\n\t\t\t *     //output: \"\"（空字符串）\n\t\t\t *     console.log( test1.innerHTML );\n\t\t\t *\n\t\t\t *     //output: \"<div></div><span></span>\"\n\t\t\t *     console.log( test2.innerHTML );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 把节点src的所有子节点移动到另一个节点tag上去, 可以通过dir参数控制附加的行为是“追加”还是“插入顶部”\n\t\t\t * @method moveChild\n\t\t\t * @param { Node } src 源节点， 该节点下的所有子节点将被移除\n\t\t\t * @param { Node } tag 目标节点， 从源节点移除的子节点将被附加到该节点下\n\t\t\t * @param { Boolean } dir 附加方式， 如果为true， 则附加进去的节点将被放到目标节点的顶部， 反之，则放到末尾\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test1\">\n\t\t\t *      <span></span>\n\t\t\t * </div>\n\t\t\t * <div id=\"test2\">\n\t\t\t *     <div></div>\n\t\t\t * </div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var test1 = document.getElementById(\"test1\"),\n\t\t\t *         test2 = document.getElementById(\"test2\");\n\t\t\t *\n\t\t\t *     UE.dom.domUtils.moveChild( test1, test2, true );\n\t\t\t *\n\t\t\t *     //output: \"\"（空字符串）\n\t\t\t *     console.log( test1.innerHTML );\n\t\t\t *\n\t\t\t *     //output: \"<span></span><div></div>\"\n\t\t\t *     console.log( test2.innerHTML );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tmoveChild: function(src, tag, dir) {\n\t\t\t\twhile (src.firstChild) {\n\t\t\t\t\tif (dir && tag.firstChild) {\n\t\t\t\t\t\ttag.insertBefore(src.lastChild, tag.firstChild);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttag.appendChild(src.firstChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 判断节点的标签上是否不存在任何属性\n\t\t\t * @method hasNoAttributes\n\t\t\t * @private\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @return { Boolean } 节点是否不包含任何属性\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\"><span>xxxx</span></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: false\n\t\t\t *     console.log( UE.dom.domUtils.hasNoAttributes( document.getElementById(\"test\") ) );\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.hasNoAttributes( document.getElementById(\"test\").firstChild ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\thasNoAttributes: function(node) {\n\t\t\t\treturn browser.ie ? /^<\\w+\\s*?>/.test(node.outerHTML) : node.attributes.length == 0;\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 检测节点是否是UEditor所使用的辅助节点\n\t\t\t * @method isCustomeNode\n\t\t\t * @private\n\t\t\t * @param { Node } node 需要检测的节点\n\t\t\t * @remind 辅助节点是指编辑器要完成工作临时添加的节点， 在输出的时候将会从编辑器内移除， 不会影响最终的结果。\n\t\t\t * @return { Boolean } 给定的节点是否是一个辅助节点\n\t\t\t */\n\t\t\tisCustomeNode: function(node) {\n\t\t\t\treturn node.nodeType == 1 && node.getAttribute('_ue_custom_node_');\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 检测节点的标签是否是给定的标签\n\t\t\t * @method isTagNode\n\t\t\t * @param { Node } node 需要检测的节点对象\n\t\t\t * @param { String } tagName 标签\n\t\t\t * @return { Boolean } 节点的标签是否是给定的标签\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <div id=\"test\"></div>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: true\n\t\t\t *     console.log( UE.dom.domUtils.isTagNode( document.getElementById(\"test\"), \"div\" ) );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tisTagNode: function(node, tagNames) {\n\t\t\t\treturn node.nodeType == 1 && new RegExp('\\\\b' + node.tagName + '\\\\b', 'i').test(tagNames)\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 给定一个节点数组，在通过指定的过滤器过滤后， 获取其中满足过滤条件的第一个节点\n\t\t\t * @method filterNodeList\n\t\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t\t * @param { Function } fn 过滤器， 对符合条件的节点， 执行结果返回true， 反之则返回false\n\t\t\t * @return { Node | NULL } 如果找到符合过滤条件的节点， 则返回该节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t\t *\n\t\t\t * //output: null\n\t\t\t * console.log( UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t\t *     return node.tagName.toLowerCase() !== 'div';\n\t\t\t * } ) );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 给定一个节点数组nodeList和一组标签名tagNames， 获取其中能够匹配标签名的节点集合中的第一个节点\n\t\t\t * @method filterNodeList\n\t\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t\t * @param { String } tagNames 需要匹配的标签名， 多个标签名之间用空格分割\n\t\t\t * @return { Node | NULL } 如果找到标签名匹配的节点， 则返回该节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t\t *\n\t\t\t * //output: null\n\t\t\t * console.log( UE.dom.domUtils.filterNodeList( divNodes, 'a span' ) );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 给定一个节点数组，在通过指定的过滤器过滤后， 如果参数forAll为true， 则会返回所有满足过滤\n\t\t\t * 条件的节点集合， 否则， 返回满足条件的节点集合中的第一个节点\n\t\t\t * @method filterNodeList\n\t\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t\t * @param { Function } fn 过滤器， 对符合条件的节点， 执行结果返回true， 反之则返回false\n\t\t\t * @param { Boolean } forAll 是否返回整个节点数组, 如果该参数为false， 则返回节点集合中的第一个节点\n\t\t\t * @return { Array | Node | NULL } 如果找到符合过滤条件的节点， 则根据参数forAll的值决定返回满足\n\t\t\t *                                      过滤条件的节点数组或第一个节点， 否则返回NULL\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t\t *\n\t\t\t * //output: 3（假定有3个div）\n\t\t\t * console.log( divNodes.length );\n\t\t\t *\n\t\t\t * var nodes = UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t\t *     return node.tagName.toLowerCase() === 'div';\n\t\t\t * }, true );\n\t\t\t *\n\t\t\t * //output: 3\n\t\t\t * console.log( nodes.length );\n\t\t\t *\n\t\t\t * var node = UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t\t *     return node.tagName.toLowerCase() === 'div';\n\t\t\t * }, false );\n\t\t\t *\n\t\t\t * //output: div\n\t\t\t * console.log( node.nodeName );\n\t\t\t * ```\n\t\t\t */\n\t\t\tfilterNodeList: function(nodelist, filter, forAll) {\n\t\t\t\tvar results = [];\n\t\t\t\tif (!utils.isFunction(filter)) {\n\t\t\t\t\tvar str = filter;\n\t\t\t\t\tfilter = function(n) {\n\t\t\t\t\t\treturn utils.indexOf(utils.isArray(str) ? str : str.split(' '), n.tagName.toLowerCase()) != -1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tutils.each(nodelist, function(n) {\n\t\t\t\t\tfilter(n) && results.push(n)\n\t\t\t\t});\n\t\t\t\treturn results.length == 0 ? null : results.length == 1 || !forAll ? results[0] : results\n\t\t\t},\n\t\n\t\t\t/**\n\t\t\t * 查询给定的range选区是否在给定的node节点内，且在该节点的最末尾\n\t\t\t * @method isInNodeEndBoundary\n\t\t\t * @param { UE.dom.Range } rng 需要判断的range对象， 该对象的startContainer不能为NULL\n\t\t\t * @param node 需要检测的节点对象\n\t\t\t * @return { Number } 如果给定的选取range对象是在node内部的最末端， 则返回1, 否则返回0\n\t\t\t */\n\t\t\tisInNodeEndBoundary: function(rng, node) {\n\t\t\t\tvar start = rng.startContainer;\n\t\t\t\tif (start.nodeType == 3 && rng.startOffset != start.nodeValue.length) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tif (start.nodeType == 1 && rng.startOffset != start.childNodes.length) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\twhile (start !== node) {\n\t\t\t\t\tif (start.nextSibling) {\n\t\t\t\t\t\treturn 0\n\t\t\t\t\t};\n\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t},\n\t\t\tisBoundaryNode: function(node, dir) {\n\t\t\t\tvar tmp;\n\t\t\t\twhile (!domUtils.isBody(node)) {\n\t\t\t\t\ttmp = node;\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\tif (tmp !== node[dir]) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tfillHtml: browser.ie11below ? '&nbsp;' : '<br/>'\n\t\t};\n\t\tvar fillCharReg = new RegExp(domUtils.fillChar, 'g');\n\t\n\t\t// core/Range.js\n\t\t/**\n\t\t * Range封装\n\t\t * @file\n\t\t * @module UE.dom\n\t\t * @class Range\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * dom操作封装\n\t\t * @unfile\n\t\t * @module UE.dom\n\t\t */\n\t\n\t\t/**\n\t\t * Range实现类，本类是UEditor底层核心类，封装不同浏览器之间的Range操作。\n\t\t * @unfile\n\t\t * @module UE.dom\n\t\t * @class Range\n\t\t */\n\t\n\t\t(function() {\n\t\t\tvar guid = 0,\n\t\t\t\tfillChar = domUtils.fillChar,\n\t\t\t\tfillData;\n\t\n\t\t\t/**\n\t\t\t * 更新range的collapse状态\n\t\t\t * @param  {Range}   range    range对象\n\t\t\t */\n\t\t\tfunction updateCollapse(range) {\n\t\t\t\trange.collapsed =\n\t\t\t\t\trange.startContainer && range.endContainer &&\n\t\t\t\t\trange.startContainer === range.endContainer &&\n\t\t\t\t\trange.startOffset == range.endOffset;\n\t\t\t}\n\t\n\t\t\tfunction selectOneNode(rng) {\n\t\t\t\treturn !rng.collapsed && rng.startContainer.nodeType == 1 && rng.startContainer === rng.endContainer && rng.endOffset - rng.startOffset == 1\n\t\t\t}\n\t\n\t\t\tfunction setEndPoint(toStart, node, offset, range) {\n\t\t\t\t//如果node是自闭合标签要处理\n\t\t\t\tif (node.nodeType == 1 && (dtd.$empty[node.tagName] || dtd.$nonChild[node.tagName])) {\n\t\t\t\t\toffset = domUtils.getNodeIndex(node) + (toStart ? 0 : 1);\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\tif (toStart) {\n\t\t\t\t\trange.startContainer = node;\n\t\t\t\t\trange.startOffset = offset;\n\t\t\t\t\tif (!range.endContainer) {\n\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trange.endContainer = node;\n\t\t\t\t\trange.endOffset = offset;\n\t\t\t\t\tif (!range.startContainer) {\n\t\t\t\t\t\trange.collapse(false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tupdateCollapse(range);\n\t\t\t\treturn range;\n\t\t\t}\n\t\n\t\t\tfunction execContentsAction(range, action) {\n\t\t\t\t//调整边界\n\t\t\t\t//range.includeBookmark();\n\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\tend = range.endContainer,\n\t\t\t\t\tstartOffset = range.startOffset,\n\t\t\t\t\tendOffset = range.endOffset,\n\t\t\t\t\tdoc = range.document,\n\t\t\t\t\tfrag = doc.createDocumentFragment(),\n\t\t\t\t\ttmpStart, tmpEnd;\n\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\tstart = start.childNodes[startOffset] || (tmpStart = start.appendChild(doc.createTextNode('')));\n\t\t\t\t}\n\t\t\t\tif (end.nodeType == 1) {\n\t\t\t\t\tend = end.childNodes[endOffset] || (tmpEnd = end.appendChild(doc.createTextNode('')));\n\t\t\t\t}\n\t\t\t\tif (start === end && start.nodeType == 3) {\n\t\t\t\t\tfrag.appendChild(doc.createTextNode(start.substringData(startOffset, endOffset - startOffset)));\n\t\t\t\t\t//is not clone\n\t\t\t\t\tif (action) {\n\t\t\t\t\t\tstart.deleteData(startOffset, endOffset - startOffset);\n\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t\treturn frag;\n\t\t\t\t}\n\t\t\t\tvar current, currentLevel, clone = frag,\n\t\t\t\t\tstartParents = domUtils.findParents(start, true),\n\t\t\t\t\tendParents = domUtils.findParents(end, true);\n\t\t\t\tfor (var i = 0; startParents[i] == endParents[i];) {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tfor (var j = i, si; si = startParents[j]; j++) {\n\t\t\t\t\tcurrent = si.nextSibling;\n\t\t\t\t\tif (si == start) {\n\t\t\t\t\t\tif (!tmpStart) {\n\t\t\t\t\t\t\tif (range.startContainer.nodeType == 3) {\n\t\t\t\t\t\t\t\tclone.appendChild(doc.createTextNode(start.nodeValue.slice(startOffset)));\n\t\t\t\t\t\t\t\t//is not clone\n\t\t\t\t\t\t\t\tif (action) {\n\t\t\t\t\t\t\t\t\tstart.deleteData(startOffset, start.nodeValue.length - startOffset);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tclone.appendChild(!action ? start.cloneNode(true) : start);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrentLevel = si.cloneNode(false);\n\t\t\t\t\t\tclone.appendChild(currentLevel);\n\t\t\t\t\t}\n\t\t\t\t\twhile (current) {\n\t\t\t\t\t\tif (current === end || current === endParents[j]) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsi = current.nextSibling;\n\t\t\t\t\t\tclone.appendChild(!action ? current.cloneNode(true) : current);\n\t\t\t\t\t\tcurrent = si;\n\t\t\t\t\t}\n\t\t\t\t\tclone = currentLevel;\n\t\t\t\t}\n\t\t\t\tclone = frag;\n\t\t\t\tif (!startParents[i]) {\n\t\t\t\t\tclone.appendChild(startParents[i - 1].cloneNode(false));\n\t\t\t\t\tclone = clone.firstChild;\n\t\t\t\t}\n\t\t\t\tfor (var j = i, ei; ei = endParents[j]; j++) {\n\t\t\t\t\tcurrent = ei.previousSibling;\n\t\t\t\t\tif (ei == end) {\n\t\t\t\t\t\tif (!tmpEnd && range.endContainer.nodeType == 3) {\n\t\t\t\t\t\t\tclone.appendChild(doc.createTextNode(end.substringData(0, endOffset)));\n\t\t\t\t\t\t\t//is not clone\n\t\t\t\t\t\t\tif (action) {\n\t\t\t\t\t\t\t\tend.deleteData(0, endOffset);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrentLevel = ei.cloneNode(false);\n\t\t\t\t\t\tclone.appendChild(currentLevel);\n\t\t\t\t\t}\n\t\t\t\t\t//如果两端同级，右边第一次已经被开始做了\n\t\t\t\t\tif (j != i || !startParents[i]) {\n\t\t\t\t\t\twhile (current) {\n\t\t\t\t\t\t\tif (current === start) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tei = current.previousSibling;\n\t\t\t\t\t\t\tclone.insertBefore(!action ? current.cloneNode(true) : current, clone.firstChild);\n\t\t\t\t\t\t\tcurrent = ei;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tclone = currentLevel;\n\t\t\t\t}\n\t\t\t\tif (action) {\n\t\t\t\t\trange.setStartBefore(!endParents[i] ? endParents[i - 1] : !startParents[i] ? startParents[i - 1] : endParents[i]).collapse(true);\n\t\t\t\t}\n\t\t\t\ttmpStart && domUtils.remove(tmpStart);\n\t\t\t\ttmpEnd && domUtils.remove(tmpEnd);\n\t\t\t\treturn frag;\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 创建一个跟document绑定的空的Range实例\n\t\t\t * @constructor\n\t\t\t * @param { Document } document 新建的选区所属的文档对象\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * @property { Node } startContainer 当前Range的开始边界的容器节点, 可以是一个元素节点或者是文本节点\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * @property { Node } startOffset 当前Range的开始边界容器节点的偏移量, 如果是元素节点，\n\t\t\t *                              该值就是childNodes中的第几个节点， 如果是文本节点就是文本内容的第几个字符\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * @property { Node } endContainer 当前Range的结束边界的容器节点, 可以是一个元素节点或者是文本节点\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * @property { Node } endOffset 当前Range的结束边界容器节点的偏移量, 如果是元素节点，\n\t\t\t *                              该值就是childNodes中的第几个节点， 如果是文本节点就是文本内容的第几个字符\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * @property { Boolean } collapsed 当前Range是否闭合\n\t\t\t * @default true\n\t\t\t * @remind Range是闭合的时候， startContainer === endContainer && startOffset === endOffset\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * @property { Document } document 当前Range所属的Document对象\n\t\t\t * @remind 不同range的的document属性可以是不同的\n\t\t\t */\n\t\t\tvar Range = dom.Range = function(document) {\n\t\t\t\tvar me = this;\n\t\t\t\tme.startContainer =\n\t\t\t\t\tme.startOffset =\n\t\t\t\t\tme.endContainer =\n\t\t\t\t\tme.endOffset = null;\n\t\t\t\tme.document = document;\n\t\t\t\tme.collapsed = true;\n\t\t\t};\n\t\n\t\t\t/**\n\t\t\t * 删除fillData\n\t\t\t * @param doc\n\t\t\t * @param excludeNode\n\t\t\t */\n\t\t\tfunction removeFillData(doc, excludeNode) {\n\t\t\t\ttry {\n\t\t\t\t\tif (fillData && domUtils.inDoc(fillData, doc)) {\n\t\t\t\t\t\tif (!fillData.nodeValue.replace(fillCharReg, '').length) {\n\t\t\t\t\t\t\tvar tmpNode = fillData.parentNode;\n\t\t\t\t\t\t\tdomUtils.remove(fillData);\n\t\t\t\t\t\t\twhile (tmpNode && domUtils.isEmptyInlineElement(tmpNode) &&\n\t\t\t\t\t\t\t\t//safari的contains有bug\n\t\t\t\t\t\t\t\t(browser.safari ? !(domUtils.getPosition(tmpNode, excludeNode) & domUtils.POSITION_CONTAINS) : !tmpNode.contains(excludeNode))\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tfillData = tmpNode.parentNode;\n\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\ttmpNode = fillData;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfillData.nodeValue = fillData.nodeValue.replace(fillCharReg, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * @param node\n\t\t\t * @param dir\n\t\t\t */\n\t\t\tfunction mergeSibling(node, dir) {\n\t\t\t\tvar tmpNode;\n\t\t\t\tnode = node[dir];\n\t\t\t\twhile (node && domUtils.isFillChar(node)) {\n\t\t\t\t\ttmpNode = node[dir];\n\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\tnode = tmpNode;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tRange.prototype = {\n\t\n\t\t\t\t/**\n\t\t\t\t * 克隆选区的内容到一个DocumentFragment里\n\t\t\t\t * @method cloneContents\n\t\t\t\t * @return { DocumentFragment | NULL } 如果选区是闭合的将返回null， 否则， 返回包含所clone内容的DocumentFragment元素\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <body>\n\t\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t\t *\n\t\t\t\t *      <script>\n\t\t\t\t *          //range是已选中的选区\n\t\t\t\t *          var fragment = range.cloneContents(),\n\t\t\t\t *              node = document.createElement(\"div\");\n\t\t\t\t *\n\t\t\t\t *          node.appendChild( fragment );\n\t\t\t\t *\n\t\t\t\t *          //output: <i>x</i>xx\n\t\t\t\t *          console.log( node.innerHTML );\n\t\t\t\t *\n\t\t\t\t *      </script>\n\t\t\t\t * </body>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tcloneContents: function() {\n\t\t\t\t\treturn this.collapsed ? null : execContentsAction(this, 0);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 删除当前选区范围中的所有内容\n\t\t\t\t * @method deleteContents\n\t\t\t\t * @remind 执行完该操作后， 当前Range对象变成了闭合状态\n\t\t\t\t * @return { UE.dom.Range } 当前操作的Range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <body>\n\t\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t\t *\n\t\t\t\t *      <script>\n\t\t\t\t *          //range是已选中的选区\n\t\t\t\t *          range.deleteContents();\n\t\t\t\t *\n\t\t\t\t *          //竖线表示闭合后的选区位置\n\t\t\t\t *          //output: <b>x<i>x</i>|x</b>\n\t\t\t\t *          console.log( document.body.innerHTML );\n\t\t\t\t *\n\t\t\t\t *          //此时， range的各项属性为\n\t\t\t\t *          //output: B\n\t\t\t\t *          console.log( range.startContainer.tagName );\n\t\t\t\t *          //output: 2\n\t\t\t\t *          console.log( range.startOffset );\n\t\t\t\t *          //output: B\n\t\t\t\t *          console.log( range.endContainer.tagName );\n\t\t\t\t *          //output: 2\n\t\t\t\t *          console.log( range.endOffset );\n\t\t\t\t *          //output: true\n\t\t\t\t *          console.log( range.collapsed );\n\t\t\t\t *\n\t\t\t\t *      </script>\n\t\t\t\t * </body>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tdeleteContents: function() {\n\t\t\t\t\tvar txt;\n\t\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\t\texecContentsAction(this, 1);\n\t\t\t\t\t}\n\t\t\t\t\tif (browser.webkit) {\n\t\t\t\t\t\ttxt = this.startContainer;\n\t\t\t\t\t\tif (txt.nodeType == 3 && !txt.nodeValue.length) {\n\t\t\t\t\t\t\tthis.setStartBefore(txt).collapse(true);\n\t\t\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 将当前选区的内容提取到一个DocumentFragment里\n\t\t\t\t * @method extractContents\n\t\t\t\t * @remind 执行该操作后， 选区将变成闭合状态\n\t\t\t\t * @warning 执行该操作后， 原来选区所选中的内容将从dom树上剥离出来\n\t\t\t\t * @return { DocumentFragment } 返回包含所提取内容的DocumentFragment对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <body>\n\t\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t\t *\n\t\t\t\t *      <script>\n\t\t\t\t *          //range是已选中的选区\n\t\t\t\t *          var fragment = range.extractContents(),\n\t\t\t\t *              node = document.createElement( \"div\" );\n\t\t\t\t *\n\t\t\t\t *          node.appendChild( fragment );\n\t\t\t\t *\n\t\t\t\t *          //竖线表示闭合后的选区位置\n\t\t\t\t *\n\t\t\t\t *          //output: <b>x<i>x</i>|x</b>\n\t\t\t\t *          console.log( document.body.innerHTML );\n\t\t\t\t *          //output: <i>x</i>xx\n\t\t\t\t *          console.log( node.innerHTML );\n\t\t\t\t *\n\t\t\t\t *          //此时， range的各项属性为\n\t\t\t\t *          //output: B\n\t\t\t\t *          console.log( range.startContainer.tagName );\n\t\t\t\t *          //output: 2\n\t\t\t\t *          console.log( range.startOffset );\n\t\t\t\t *          //output: B\n\t\t\t\t *          console.log( range.endContainer.tagName );\n\t\t\t\t *          //output: 2\n\t\t\t\t *          console.log( range.endOffset );\n\t\t\t\t *          //output: true\n\t\t\t\t *          console.log( range.collapsed );\n\t\t\t\t *\n\t\t\t\t *      </script>\n\t\t\t\t * </body>\n\t\t\t\t */\n\t\t\t\textractContents: function() {\n\t\t\t\t\treturn this.collapsed ? null : execContentsAction(this, 2);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置Range的开始容器节点和偏移量\n\t\t\t\t * @method  setStart\n\t\t\t\t * @remind 如果给定的节点是元素节点，那么offset指的是其子元素中索引为offset的元素，\n\t\t\t\t *          如果是文本节点，那么offset指的是其文本内容的第offset个字符\n\t\t\t\t * @remind 如果提供的容器节点是一个不能包含子元素的节点， 则该选区的开始容器将被设置\n\t\t\t\t *          为该节点的父节点， 此时， 其距离开始容器的偏移量也变成了该节点在其父节点\n\t\t\t\t *          中的索引\n\t\t\t\t * @param { Node } node 将被设为当前选区开始边界容器的节点对象\n\t\t\t\t * @param { int } offset 选区的开始位置偏移量\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区 -->\n\t\t\t\t * <b>xxx<i>x<span>xx</span>xx<em>xx</em>xxx</i>[xxx]</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.setStart( document.getElementsByTagName(\"i\")[0], 1 );\n\t\t\t\t *\n\t\t\t\t *     //此时， 选区变成了\n\t\t\t\t *     //<b>xxx<i>x[<span>xx</span>xx<em>xx</em>xxx</i>xxx]</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区 -->\n\t\t\t\t * <b>xxx<img>[xx]x</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.setStart( document.getElementsByTagName(\"img\")[0], 3 );\n\t\t\t\t *\n\t\t\t\t *     //此时， 选区变成了\n\t\t\t\t *     //<b>xxx[<img>xx]x</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetStart: function(node, offset) {\n\t\t\t\t\treturn setEndPoint(true, node, offset, this);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置Range的结束容器和偏移量\n\t\t\t\t * @method  setEnd\n\t\t\t\t * @param { Node } node 作为当前选区结束边界容器的节点对象\n\t\t\t\t * @param { int } offset 结束边界的偏移量\n\t\t\t\t * @see UE.dom.Range:setStart(Node,int)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tsetEnd: function(node, offset) {\n\t\t\t\t\treturn setEndPoint(false, node, offset, this);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 将Range开始位置设置到node节点之后\n\t\t\t\t * @method  setStartAfter\n\t\t\t\t * @remind 该操作将会把给定节点的父节点作为range的开始容器， 且偏移量是该节点在其父节点中的位置索引+1\n\t\t\t\t * @param { Node } node 选区的开始边界将紧接着该节点之后\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>xx<i>xxx</i><span>xx[x</span>xxx]</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.setStartAfter( document.getElementsByTagName(\"i\")[0] );\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //<b>xx<i>xxx</i>[<span>xxx</span>xxx]</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetStartAfter: function(node) {\n\t\t\t\t\treturn this.setStart(node.parentNode, domUtils.getNodeIndex(node) + 1);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 将Range开始位置设置到node节点之前\n\t\t\t\t * @method  setStartBefore\n\t\t\t\t * @remind 该操作将会把给定节点的父节点作为range的开始容器， 且偏移量是该节点在其父节点中的位置索引\n\t\t\t\t * @param { Node } node 新的选区开始位置在该节点之前\n\t\t\t\t * @see UE.dom.Range:setStartAfter(Node)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tsetStartBefore: function(node) {\n\t\t\t\t\treturn this.setStart(node.parentNode, domUtils.getNodeIndex(node));\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 将Range结束位置设置到node节点之后\n\t\t\t\t * @method  setEndAfter\n\t\t\t\t * @remind 该操作将会把给定节点的父节点作为range的结束容器， 且偏移量是该节点在其父节点中的位置索引+1\n\t\t\t\t * @param { Node } node 目标节点\n\t\t\t\t * @see UE.dom.Range:setStartAfter(Node)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>[xx<i>xxx</i><span>xx]x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.setStartAfter( document.getElementsByTagName(\"span\")[0] );\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //<b>[xx<i>xxx</i><span>xxx</span>]xxx</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetEndAfter: function(node) {\n\t\t\t\t\treturn this.setEnd(node.parentNode, domUtils.getNodeIndex(node) + 1);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 将Range结束位置设置到node节点之前\n\t\t\t\t * @method  setEndBefore\n\t\t\t\t * @remind 该操作将会把给定节点的父节点作为range的结束容器， 且偏移量是该节点在其父节点中的位置索引\n\t\t\t\t * @param { Node } node 目标节点\n\t\t\t\t * @see UE.dom.Range:setEndAfter(Node)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tsetEndBefore: function(node) {\n\t\t\t\t\treturn this.setEnd(node.parentNode, domUtils.getNodeIndex(node));\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置Range的开始位置到node节点内的第一个子节点之前\n\t\t\t\t * @method  setStartAtFirst\n\t\t\t\t * @remind 选区的开始容器将变成给定的节点， 且偏移量为0\n\t\t\t\t * @remind 如果给定的节点是元素节点， 则该节点必须是允许包含子节点的元素。\n\t\t\t\t * @param { Node } node 目标节点\n\t\t\t\t * @see UE.dom.Range:setStartBefore(Node)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.setStartAtFirst( document.getElementsByTagName(\"i\")[0] );\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //<b>xx<i>[xxx</i><span>xx]x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetStartAtFirst: function(node) {\n\t\t\t\t\treturn this.setStart(node, 0);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置Range的开始位置到node节点内的最后一个节点之后\n\t\t\t\t * @method setStartAtLast\n\t\t\t\t * @remind 选区的开始容器将变成给定的节点， 且偏移量为该节点的子节点数\n\t\t\t\t * @remind 如果给定的节点是元素节点， 则该节点必须是允许包含子节点的元素。\n\t\t\t\t * @param { Node } node 目标节点\n\t\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tsetStartAtLast: function(node) {\n\t\t\t\t\treturn this.setStart(node, node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置Range的结束位置到node节点内的第一个节点之前\n\t\t\t\t * @method  setEndAtFirst\n\t\t\t\t * @param { Node } node 目标节点\n\t\t\t\t * @remind 选区的结束容器将变成给定的节点， 且偏移量为0\n\t\t\t\t * @remind node必须是一个元素节点， 且必须是允许包含子节点的元素。\n\t\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tsetEndAtFirst: function(node) {\n\t\t\t\t\treturn this.setEnd(node, 0);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置Range的结束位置到node节点内的最后一个节点之后\n\t\t\t\t * @method  setEndAtLast\n\t\t\t\t * @param { Node } node 目标节点\n\t\t\t\t * @remind 选区的结束容器将变成给定的节点， 且偏移量为该节点的子节点数量\n\t\t\t\t * @remind node必须是一个元素节点， 且必须是允许包含子节点的元素。\n\t\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tsetEndAtLast: function(node) {\n\t\t\t\t\treturn this.setEnd(node, node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 选中给定节点\n\t\t\t\t * @method  selectNode\n\t\t\t\t * @remind 此时， 选区的开始容器和结束容器都是该节点的父节点， 其startOffset是该节点在父节点中的位置索引，\n\t\t\t\t *          而endOffset为startOffset+1\n\t\t\t\t * @param { Node } node 需要选中的节点\n\t\t\t\t * @return { UE.dom.Range } 当前range对象，此时的range仅包含当前给定的节点对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.selectNode( document.getElementsByTagName(\"i\")[0] );\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //<b>xx[<i>xxx</i>]<span>xxx</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tselectNode: function(node) {\n\t\t\t\t\treturn this.setStartBefore(node).setEndAfter(node);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 选中给定节点内部的所有节点\n\t\t\t\t * @method  selectNodeContents\n\t\t\t\t * @remind 此时， 选区的开始容器和结束容器都是该节点， 其startOffset为0，\n\t\t\t\t *          而endOffset是该节点的子节点数。\n\t\t\t\t * @param { Node } node 目标节点， 当前range将包含该节点内的所有节点\n\t\t\t\t * @return { UE.dom.Range } 当前range对象， 此时range仅包含给定节点的所有子节点\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.selectNode( document.getElementsByTagName(\"b\")[0] );\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //<b>[xx<i>xxx</i><span>xxx</span>xxx]</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tselectNodeContents: function(node) {\n\t\t\t\t\treturn this.setStart(node, 0).setEndAtLast(node);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * clone当前Range对象\n\t\t\t\t * @method  cloneRange\n\t\t\t\t * @remind 返回的range是一个全新的range对象， 其内部所有属性与当前被clone的range相同。\n\t\t\t\t * @return { UE.dom.Range } 当前range对象的一个副本\n\t\t\t\t */\n\t\t\t\tcloneRange: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\treturn new Range(me.document).setStart(me.startContainer, me.startOffset).setEnd(me.endContainer, me.endOffset);\n\t\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 向当前选区的结束处闭合选区\n\t\t\t\t * @method  collapse\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.collapse();\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //“|”表示选区已闭合\n\t\t\t\t *     //<b>xx<i>xxx</i><span>xx|x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 闭合当前选区，根据给定的toStart参数项决定是向当前选区开始处闭合还是向结束处闭合，\n\t\t\t\t * 如果toStart的值为true，则向开始位置闭合， 反之，向结束位置闭合。\n\t\t\t\t * @method  collapse\n\t\t\t\t * @param { Boolean } toStart 是否向选区开始处闭合\n\t\t\t\t * @return { UE.dom.Range } 当前range对象，此时range对象处于闭合状态\n\t\t\t\t * @see UE.dom.Range:collapse()\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行操作\n\t\t\t\t *     range.collapse( true );\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //“|”表示选区已闭合\n\t\t\t\t *     //<b>xx<i>xxx</i><span>|xxx</span>xxx</b>\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tcollapse: function(toStart) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (toStart) {\n\t\t\t\t\t\tme.endContainer = me.startContainer;\n\t\t\t\t\t\tme.endOffset = me.startOffset;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.startContainer = me.endContainer;\n\t\t\t\t\t\tme.startOffset = me.endOffset;\n\t\t\t\t\t}\n\t\t\t\t\tme.collapsed = true;\n\t\t\t\t\treturn me;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 调整range的开始位置和结束位置，使其\"收缩\"到最小的位置\n\t\t\t\t * @method  shrinkBoundary\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <span>xx<b>xx[</b>xxxxx]</span> => <span>xx<b>xx</b>[xxxxx]</span>\n\t\t\t\t * ```\n\t\t\t\t *\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <!-- 选区示例 -->\n\t\t\t\t * <b>x[xx</b><i>]xxx</i>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //执行收缩\n\t\t\t\t *     range.shrinkBoundary();\n\t\t\t\t *\n\t\t\t\t *     //结果选区\n\t\t\t\t *     //<b>x[xx]</b><i>xxx</i>\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t *\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * [<b><i>xxxx</i>xxxxxxx</b>] => <b><i>[xxxx</i>xxxxxxx]</b>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 调整range的开始位置和结束位置，使其\"收缩\"到最小的位置，\n\t\t\t\t * 如果ignoreEnd的值为true，则忽略对结束位置的调整\n\t\t\t\t * @method  shrinkBoundary\n\t\t\t\t * @param { Boolean } ignoreEnd 是否忽略对结束位置的调整\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @see UE.dom.domUtils.Range:shrinkBoundary()\n\t\t\t\t */\n\t\t\t\tshrinkBoundary: function(ignoreEnd) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tchild,\n\t\t\t\t\t\tcollapsed = me.collapsed;\n\t\n\t\t\t\t\tfunction check(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 && !domUtils.isBookmarkNode(node) && !dtd.$empty[node.tagName] && !dtd.$nonChild[node.tagName]\n\t\t\t\t\t}\n\t\t\t\t\twhile (me.startContainer.nodeType == 1 //是element\n\t\t\t\t\t\t&& (child = me.startContainer.childNodes[me.startOffset]) //子节点也是element\n\t\t\t\t\t\t&& check(child)) {\n\t\t\t\t\t\tme.setStart(child, 0);\n\t\t\t\t\t}\n\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\treturn me.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\t\twhile (me.endContainer.nodeType == 1 //是element\n\t\t\t\t\t\t\t&& me.endOffset > 0 //如果是空元素就退出 endOffset=0那么endOffst-1为负值，childNodes[endOffset]报错\n\t\t\t\t\t\t\t&& (child = me.endContainer.childNodes[me.endOffset - 1]) //子节点也是element\n\t\t\t\t\t\t\t&& check(child)) {\n\t\t\t\t\t\t\tme.setEnd(child, child.childNodes.length);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn me;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取离当前选区内包含的所有节点最近的公共祖先节点，\n\t\t\t\t * @method  getCommonAncestor\n\t\t\t\t * @remind 返回的公共祖先节点一定不是range自身的容器节点， 但有可能是一个文本节点\n\t\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * //选区示例\n\t\t\t\t * <span>xxx<b>x[x<em>xx]x</em>xxx</b>xx</span>\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     var node = range.getCommonAncestor();\n\t\t\t\t *\n\t\t\t\t *     //公共祖先节点是： b节点\n\t\t\t\t *     //输出： B\n\t\t\t\t *     console.log(node.tagName);\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前选区所包含的所有节点的公共祖先节点， 可以根据给定的参数 includeSelf 决定获取到\n\t\t\t\t * 的公共祖先节点是否可以是当前选区的startContainer或endContainer节点， 如果 includeSelf\n\t\t\t\t * 的取值为true， 则返回的节点可以是自身的容器节点， 否则， 则不能是容器节点\n\t\t\t\t * @method  getCommonAncestor\n\t\t\t\t * @param { Boolean } includeSelf 是否允许获取到的公共祖先节点是当前range对象的容器节点\n\t\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t\t * @see UE.dom.Range:getCommonAncestor()\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <body>\n\t\t\t\t *\n\t\t\t\t *     <!-- 选区示例 -->\n\t\t\t\t *     <b>xxx<i>xxxx<span>xx[x</span>xx]x</i>xxxxxxx</b>\n\t\t\t\t *\n\t\t\t\t *     <script>\n\t\t\t\t *\n\t\t\t\t *         var node = range.getCommonAncestor( false );\n\t\t\t\t *\n\t\t\t\t *         //这里的公共祖先节点是B而不是I， 是因为参数限制了获取到的节点不能是容器节点\n\t\t\t\t *         //output: B\n\t\t\t\t *         console.log( node.tagName );\n\t\t\t\t *\n\t\t\t\t *     </script>\n\t\t\t\t *\n\t\t\t\t * </body>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前选区所包含的所有节点的公共祖先节点， 可以根据给定的参数 includeSelf 决定获取到\n\t\t\t\t * 的公共祖先节点是否可以是当前选区的startContainer或endContainer节点， 如果 includeSelf\n\t\t\t\t * 的取值为true， 则返回的节点可以是自身的容器节点， 否则， 则不能是容器节点； 同时可以根据\n\t\t\t\t * ignoreTextNode 参数的取值决定是否忽略类型为文本节点的祖先节点。\n\t\t\t\t * @method  getCommonAncestor\n\t\t\t\t * @param { Boolean } includeSelf 是否允许获取到的公共祖先节点是当前range对象的容器节点\n\t\t\t\t * @param { Boolean } ignoreTextNode 获取祖先节点的过程中是否忽略类型为文本节点的祖先节点\n\t\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t\t * @see UE.dom.Range:getCommonAncestor()\n\t\t\t\t * @see UE.dom.Range:getCommonAncestor(Boolean)\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <body>\n\t\t\t\t *\n\t\t\t\t *     <!-- 选区示例 -->\n\t\t\t\t *     <b>xxx<i>xxxx<span>x[x]x</span>xxx</i>xxxxxxx</b>\n\t\t\t\t *\n\t\t\t\t *     <script>\n\t\t\t\t *\n\t\t\t\t *         var node = range.getCommonAncestor( true, false );\n\t\t\t\t *\n\t\t\t\t *         //output: SPAN\n\t\t\t\t *         console.log( node.tagName );\n\t\t\t\t *\n\t\t\t\t *     </script>\n\t\t\t\t *\n\t\t\t\t * </body>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetCommonAncestor: function(includeSelf, ignoreTextNode) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tstart = me.startContainer,\n\t\t\t\t\t\tend = me.endContainer;\n\t\t\t\t\tif (start === end) {\n\t\t\t\t\t\tif (includeSelf && selectOneNode(this)) {\n\t\t\t\t\t\t\tstart = start.childNodes[me.startOffset];\n\t\t\t\t\t\t\tif (start.nodeType == 1)\n\t\t\t\t\t\t\t\treturn start;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//只有在上来就相等的情况下才会出现是文本的情况\n\t\t\t\t\t\treturn ignoreTextNode && start.nodeType == 3 ? start.parentNode : start;\n\t\t\t\t\t}\n\t\t\t\t\treturn domUtils.getCommonAncestor(start, end);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 调整当前Range的开始和结束边界容器，如果是容器节点是文本节点,就调整到包含该文本节点的父节点上\n\t\t\t\t * @method trimBoundary\n\t\t\t\t * @remind 该操作有可能会引起文本节点被切开\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t *\n\t\t\t\t * //选区示例\n\t\t\t\t * <b>xxx<i>[xxxxx]</i>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *     //未调整前， 选区的开始容器和结束都是文本节点\n\t\t\t\t *     //执行调整\n\t\t\t\t *     range.trimBoundary();\n\t\t\t\t *\n\t\t\t\t *     //调整之后， 容器节点变成了i节点\n\t\t\t\t *     //<b>xxx[<i>xxxxx</i>]xxx</b>\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 调整当前Range的开始和结束边界容器，如果是容器节点是文本节点,就调整到包含该文本节点的父节点上，\n\t\t\t\t * 可以根据 ignoreEnd 参数的值决定是否调整对结束边界的调整\n\t\t\t\t * @method trimBoundary\n\t\t\t\t * @param { Boolean } ignoreEnd 是否忽略对结束边界的调整\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t *\n\t\t\t\t * //选区示例\n\t\t\t\t * <b>xxx<i>[xxxxx]</i>xxx</b>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *     //未调整前， 选区的开始容器和结束都是文本节点\n\t\t\t\t *     //执行调整\n\t\t\t\t *     range.trimBoundary( true );\n\t\t\t\t *\n\t\t\t\t *     //调整之后， 开始容器节点变成了i节点\n\t\t\t\t *     //但是， 结束容器没有发生变化\n\t\t\t\t *     //<b>xxx[<i>xxxxx]</i>xxx</b>\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\ttrimBoundary: function(ignoreEnd) {\n\t\t\t\t\tthis.txtToElmBoundary();\n\t\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\t\toffset = this.startOffset,\n\t\t\t\t\t\tcollapsed = this.collapsed,\n\t\t\t\t\t\tend = this.endContainer;\n\t\t\t\t\tif (start.nodeType == 3) {\n\t\t\t\t\t\tif (offset == 0) {\n\t\t\t\t\t\t\tthis.setStartBefore(start);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (offset >= start.nodeValue.length) {\n\t\t\t\t\t\t\t\tthis.setStartAfter(start);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar textNode = domUtils.split(start, offset);\n\t\t\t\t\t\t\t\t//跟新结束边界\n\t\t\t\t\t\t\t\tif (start === end) {\n\t\t\t\t\t\t\t\t\tthis.setEnd(textNode, this.endOffset - offset);\n\t\t\t\t\t\t\t\t} else if (start.parentNode === end) {\n\t\t\t\t\t\t\t\t\tthis.endOffset += 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.setStartBefore(textNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\t\treturn this.collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\t\toffset = this.endOffset;\n\t\t\t\t\t\tend = this.endContainer;\n\t\t\t\t\t\tif (end.nodeType == 3) {\n\t\t\t\t\t\t\tif (offset == 0) {\n\t\t\t\t\t\t\t\tthis.setEndBefore(end);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\toffset < end.nodeValue.length && domUtils.split(end, offset);\n\t\t\t\t\t\t\t\tthis.setEndAfter(end);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 如果选区在文本的边界上，就扩展选区到文本的父节点上, 如果当前选区是闭合的， 则什么也不做\n\t\t\t\t * @method txtToElmBoundary\n\t\t\t\t * @remind 该操作不会修改dom节点\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 如果选区在文本的边界上，就扩展选区到文本的父节点上, 如果当前选区是闭合的， 则根据参数项\n\t\t\t\t * ignoreCollapsed 的值决定是否执行该调整\n\t\t\t\t * @method txtToElmBoundary\n\t\t\t\t * @param { Boolean } ignoreCollapsed 是否忽略选区的闭合状态， 如果该参数取值为true， 则\n\t\t\t\t *                      不论选区是否闭合， 都会执行该操作， 反之， 则不会对闭合的选区执行该操作\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\ttxtToElmBoundary: function(ignoreCollapsed) {\n\t\t\t\t\tfunction adjust(r, c) {\n\t\t\t\t\t\tvar container = r[c + 'Container'],\n\t\t\t\t\t\t\toffset = r[c + 'Offset'];\n\t\t\t\t\t\tif (container.nodeType == 3) {\n\t\t\t\t\t\t\tif (!offset) {\n\t\t\t\t\t\t\t\tr['set' + c.replace(/(\\w)/, function(a) {\n\t\t\t\t\t\t\t\t\treturn a.toUpperCase();\n\t\t\t\t\t\t\t\t}) + 'Before'](container);\n\t\t\t\t\t\t\t} else if (offset >= container.nodeValue.length) {\n\t\t\t\t\t\t\t\tr['set' + c.replace(/(\\w)/, function(a) {\n\t\t\t\t\t\t\t\t\treturn a.toUpperCase();\n\t\t\t\t\t\t\t\t}) + 'After'](container);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (ignoreCollapsed || !this.collapsed) {\n\t\t\t\t\t\tadjust(this, 'start');\n\t\t\t\t\t\tadjust(this, 'end');\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 在当前选区的开始位置前插入节点，新插入的节点会被该range包含\n\t\t\t\t * @method  insertNode\n\t\t\t\t * @param { Node } node 需要插入的节点\n\t\t\t\t * @remind 插入的节点可以是一个DocumentFragment依次插入多个节点\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tinsertNode: function(node) {\n\t\t\t\t\tvar first = node,\n\t\t\t\t\t\tlength = 1;\n\t\t\t\t\tif (node.nodeType == 11) {\n\t\t\t\t\t\tfirst = node.firstChild;\n\t\t\t\t\t\tlength = node.childNodes.length;\n\t\t\t\t\t}\n\t\t\t\t\tthis.trimBoundary(true);\n\t\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\t\toffset = this.startOffset;\n\t\t\t\t\tvar nextNode = start.childNodes[offset];\n\t\t\t\t\tif (nextNode) {\n\t\t\t\t\t\tstart.insertBefore(node, nextNode);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.appendChild(node);\n\t\t\t\t\t}\n\t\t\t\t\tif (first.parentNode === this.endContainer) {\n\t\t\t\t\t\tthis.endOffset = this.endOffset + length;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.setStartBefore(first);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 闭合选区到当前选区的开始位置， 并且定位光标到闭合后的位置\n\t\t\t\t * @method  setCursor\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @see UE.dom.Range:collapse()\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 闭合选区，可以根据参数toEnd的值控制选区是向前闭合还是向后闭合， 并且定位光标到闭合后的位置。\n\t\t\t\t * @method  setCursor\n\t\t\t\t * @param { Boolean } toEnd 是否向后闭合， 如果为true， 则闭合选区时， 将向结束容器方向闭合，\n\t\t\t\t *                      反之，则向开始容器方向闭合\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @see UE.dom.Range:collapse(Boolean)\n\t\t\t\t */\n\t\t\t\tsetCursor: function(toEnd, noFillData) {\n\t\t\t\t\treturn this.collapse(!toEnd).select(noFillData);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 创建当前range的一个书签，记录下当前range的位置，方便当dom树改变时，还能找回原来的选区位置\n\t\t\t\t * @method createBookmark\n\t\t\t\t * @param { Boolean } serialize 控制返回的标记位置是对当前位置的引用还是ID，如果该值为true，则\n\t\t\t\t *                              返回标记位置的ID， 反之则返回标记位置节点的引用\n\t\t\t\t * @return { Object } 返回一个书签记录键值对， 其包含的key有： start => 开始标记的ID或者引用，\n\t\t\t\t *                          end => 结束标记的ID或引用， id => 当前标记的类型， 如果为true，则表示\n\t\t\t\t *                          返回的记录的类型为ID， 反之则为引用\n\t\t\t\t */\n\t\t\t\tcreateBookmark: function(serialize, same) {\n\t\t\t\t\tvar endNode,\n\t\t\t\t\t\tstartNode = this.document.createElement('span');\n\t\t\t\t\tstartNode.style.cssText = 'display:none;line-height:0px;';\n\t\t\t\t\tstartNode.appendChild(this.document.createTextNode('\\u200D'));\n\t\t\t\t\tstartNode.id = '_baidu_bookmark_start_' + (same ? '' : guid++);\n\t\n\t\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\t\tendNode = startNode.cloneNode(true);\n\t\t\t\t\t\tendNode.id = '_baidu_bookmark_end_' + (same ? '' : guid++);\n\t\t\t\t\t}\n\t\t\t\t\tthis.insertNode(startNode);\n\t\t\t\t\tif (endNode) {\n\t\t\t\t\t\tthis.collapse().insertNode(endNode).setEndBefore(endNode);\n\t\t\t\t\t}\n\t\t\t\t\tthis.setStartAfter(startNode);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstart: serialize ? startNode.id : startNode,\n\t\t\t\t\t\tend: endNode ? serialize ? endNode.id : endNode : null,\n\t\t\t\t\t\tid: serialize\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t *  调整当前range的边界到书签位置，并删除该书签对象所标记的位置内的节点\n\t\t\t\t *  @method  moveToBookmark\n\t\t\t\t *  @param { BookMark } bookmark createBookmark所创建的标签对象\n\t\t\t\t *  @return { UE.dom.Range } 当前range对象\n\t\t\t\t *  @see UE.dom.Range:createBookmark(Boolean)\n\t\t\t\t */\n\t\t\t\tmoveToBookmark: function(bookmark) {\n\t\t\t\t\tvar start = bookmark.id ? this.document.getElementById(bookmark.start) : bookmark.start,\n\t\t\t\t\t\tend = bookmark.end && bookmark.id ? this.document.getElementById(bookmark.end) : bookmark.end;\n\t\t\t\t\tthis.setStartBefore(start);\n\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\tthis.setEndBefore(end);\n\t\t\t\t\t\tdomUtils.remove(end);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 调整range的边界，使其\"放大\"到最近的父节点\n\t\t\t\t * @method  enlarge\n\t\t\t\t * @remind 会引起选区的变化\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 调整range的边界，使其\"放大\"到最近的父节点，根据参数 toBlock 的取值， 可以\n\t\t\t\t * 要求扩大之后的父节点是block节点\n\t\t\t\t * @method  enlarge\n\t\t\t\t * @param { Boolean } toBlock 是否要求扩大之后的父节点必须是block节点\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t */\n\t\t\t\tenlarge: function(toBlock, stopFn) {\n\t\t\t\t\tvar isBody = domUtils.isBody,\n\t\t\t\t\t\tpre, node, tmp = this.document.createTextNode('');\n\t\t\t\t\tif (toBlock) {\n\t\t\t\t\t\tnode = this.startContainer;\n\t\t\t\t\t\tif (node.nodeType == 1) {\n\t\t\t\t\t\t\tif (node.childNodes[this.startOffset]) {\n\t\t\t\t\t\t\t\tpre = node = node.childNodes[this.startOffset]\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnode.appendChild(tmp);\n\t\t\t\t\t\t\t\tpre = node = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (1) {\n\t\t\t\t\t\t\tif (domUtils.isBlockElm(node)) {\n\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t\twhile ((pre = node.previousSibling) && !domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.setStartBefore(node);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = this.endContainer;\n\t\t\t\t\t\tif (node.nodeType == 1) {\n\t\t\t\t\t\t\tif (pre = node.childNodes[this.endOffset]) {\n\t\t\t\t\t\t\t\tnode.insertBefore(tmp, pre);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnode.appendChild(tmp);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpre = node = tmp;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (1) {\n\t\t\t\t\t\t\tif (domUtils.isBlockElm(node)) {\n\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t\twhile ((pre = node.nextSibling) && !domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.setEndAfter(node);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tmp.parentNode === this.endContainer) {\n\t\t\t\t\t\t\tthis.endOffset--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(tmp);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// 扩展边界到最大\n\t\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\t\twhile (this.startOffset == 0) {\n\t\t\t\t\t\t\tif (stopFn && stopFn(this.startContainer)) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (isBody(this.startContainer)) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setStartBefore(this.startContainer);\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (this.endOffset == (this.endContainer.nodeType == 1 ? this.endContainer.childNodes.length : this.endContainer.nodeValue.length)) {\n\t\t\t\t\t\t\tif (stopFn && stopFn(this.endContainer)) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (isBody(this.endContainer)) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setEndAfter(this.endContainer);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\tenlargeToBlockElm: function(ignoreEnd) {\n\t\t\t\t\twhile (!domUtils.isBlockElm(this.startContainer)) {\n\t\t\t\t\t\tthis.setStartBefore(this.startContainer);\n\t\t\t\t\t}\n\t\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\t\twhile (!domUtils.isBlockElm(this.endContainer)) {\n\t\t\t\t\t\t\tthis.setEndAfter(this.endContainer);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 调整Range的边界，使其\"缩小\"到最合适的位置\n\t\t\t\t * @method adjustmentBoundary\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @see UE.dom.Range:shrinkBoundary()\n\t\t\t\t */\n\t\t\t\tadjustmentBoundary: function() {\n\t\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\t\twhile (!domUtils.isBody(this.startContainer) &&\n\t\t\t\t\t\t\tthis.startOffset == this.startContainer[this.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length &&\n\t\t\t\t\t\t\tthis.startContainer[this.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t\t\t) {\n\t\n\t\t\t\t\t\t\tthis.setStartAfter(this.startContainer);\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (!domUtils.isBody(this.endContainer) && !this.endOffset &&\n\t\t\t\t\t\t\tthis.endContainer[this.endContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tthis.setEndBefore(this.endContainer);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 给range选区中的内容添加给定的inline标签\n\t\t\t\t * @method applyInlineStyle\n\t\t\t\t * @param { String } tagName 需要添加的标签名\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <p>xxxx[xxxx]x</p>  ==>  range.applyInlineStyle(\"strong\")  ==>  <p>xxxx[<strong>xxxx</strong>]x</p>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 给range选区中的内容添加给定的inline标签， 并且为标签附加上一些初始化属性。\n\t\t\t\t * @method applyInlineStyle\n\t\t\t\t * @param { String } tagName 需要添加的标签名\n\t\t\t\t * @param { Object } attrs 跟随新添加的标签的属性\n\t\t\t\t * @return { UE.dom.Range } 当前选区\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <p>xxxx[xxxx]x</p>\n\t\t\t\t *\n\t\t\t\t * ==>\n\t\t\t\t *\n\t\t\t\t * <!-- 执行操作 -->\n\t\t\t\t * range.applyInlineStyle(\"strong\",{\"style\":\"font-size:12px\"})\n\t\t\t\t *\n\t\t\t\t * ==>\n\t\t\t\t *\n\t\t\t\t * <p>xxxx[<strong style=\"font-size:12px\">xxxx</strong>]x</p>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tapplyInlineStyle: function(tagName, attrs, list) {\n\t\t\t\t\tif (this.collapsed) return this;\n\t\t\t\t\tthis.trimBoundary().enlarge(false,\n\t\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1 && domUtils.isBlockElm(node)\n\t\t\t\t\t\t}).adjustmentBoundary();\n\t\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\t\tend = bookmark.end,\n\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark.start, false, filterFn),\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\tpre,\n\t\t\t\t\t\trange = this.cloneRange();\n\t\t\t\t\twhile (current && (domUtils.getPosition(current, end) & domUtils.POSITION_PRECEDING)) {\n\t\t\t\t\t\tif (current.nodeType == 3 || dtd[tagName][current.tagName]) {\n\t\t\t\t\t\t\trange.setStartBefore(current);\n\t\t\t\t\t\t\tnode = current;\n\t\t\t\t\t\t\twhile (node && (node.nodeType == 3 || dtd[tagName][node.tagName]) && node !== end) {\n\t\t\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\t\t\tnode = domUtils.getNextDomNode(node, node.nodeType == 1, null, function(parent) {\n\t\t\t\t\t\t\t\t\treturn dtd[tagName][parent.tagName];\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar frag = range.setEndAfter(pre).extractContents(),\n\t\t\t\t\t\t\t\telm;\n\t\t\t\t\t\t\tif (list && list.length > 0) {\n\t\t\t\t\t\t\t\tvar level, top;\n\t\t\t\t\t\t\t\ttop = level = list[0].cloneNode(false);\n\t\t\t\t\t\t\t\tfor (var i = 1, ci; ci = list[i++];) {\n\t\t\t\t\t\t\t\t\tlevel.appendChild(ci.cloneNode(false));\n\t\t\t\t\t\t\t\t\tlevel = level.firstChild;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telm = level;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\telm = range.document.createElement(tagName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(elm, attrs);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telm.appendChild(frag);\n\t\t\t\t\t\t\trange.insertNode(list ? top : elm);\n\t\t\t\t\t\t\t//处理下滑线在a上的情况\n\t\t\t\t\t\t\tvar aNode;\n\t\t\t\t\t\t\tif (tagName == 'span' && attrs.style && /text\\-decoration/.test(attrs.style) && (aNode = domUtils.findParentByTagName(elm, 'a', true))) {\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(aNode, attrs);\n\t\t\t\t\t\t\t\tdomUtils.remove(elm, true);\n\t\t\t\t\t\t\t\telm = aNode;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.mergeSibling(elm);\n\t\t\t\t\t\t\t\tdomUtils.clearEmptySibling(elm);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//去除子节点相同的\n\t\t\t\t\t\t\tdomUtils.mergeChild(elm, attrs);\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(elm, false, filterFn);\n\t\t\t\t\t\t\tdomUtils.mergeToParent(elm);\n\t\t\t\t\t\t\tif (node === end) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 移除当前选区内指定的inline标签，但保留其中的内容\n\t\t\t\t * @method removeInlineStyle\n\t\t\t\t * @param { String } tagName 需要移除的标签名\n\t\t\t\t * @return { UE.dom.Range } 当前的range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * xx[x<span>xxx<em>yyy</em>zz]z</span>  => range.removeInlineStyle([\"em\"])  => xx[x<span>xxxyyyzz]z</span>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 移除当前选区内指定的一组inline标签，但保留其中的内容\n\t\t\t\t * @method removeInlineStyle\n\t\t\t\t * @param { Array } tagNameArr 需要移除的标签名的数组\n\t\t\t\t * @return { UE.dom.Range } 当前的range对象\n\t\t\t\t * @see UE.dom.Range:removeInlineStyle(String)\n\t\t\t\t */\n\t\t\t\tremoveInlineStyle: function(tagNames) {\n\t\t\t\t\tif (this.collapsed) return this;\n\t\t\t\t\ttagNames = utils.isArray(tagNames) ? tagNames : [tagNames];\n\t\t\t\t\tthis.shrinkBoundary().adjustmentBoundary();\n\t\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\t\tend = this.endContainer;\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\tif (utils.indexOf(tagNames, start.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (start.tagName.toLowerCase() == 'body') {\n\t\t\t\t\t\t\t\tstart = null;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (end.nodeType == 1) {\n\t\t\t\t\t\t\tif (utils.indexOf(tagNames, end.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (end.tagName.toLowerCase() == 'body') {\n\t\t\t\t\t\t\t\tend = null;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tend = end.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\t\tfrag,\n\t\t\t\t\t\ttmpRange;\n\t\t\t\t\tif (start) {\n\t\t\t\t\t\ttmpRange = this.cloneRange().setEndBefore(bookmark.start).setStartBefore(start);\n\t\t\t\t\t\tfrag = tmpRange.extractContents();\n\t\t\t\t\t\ttmpRange.insertNode(frag);\n\t\t\t\t\t\tdomUtils.clearEmptySibling(start, true);\n\t\t\t\t\t\tstart.parentNode.insertBefore(bookmark.start, start);\n\t\t\t\t\t}\n\t\t\t\t\tif (end) {\n\t\t\t\t\t\ttmpRange = this.cloneRange().setStartAfter(bookmark.end).setEndAfter(end);\n\t\t\t\t\t\tfrag = tmpRange.extractContents();\n\t\t\t\t\t\ttmpRange.insertNode(frag);\n\t\t\t\t\t\tdomUtils.clearEmptySibling(end, false, true);\n\t\t\t\t\t\tend.parentNode.insertBefore(bookmark.end, end.nextSibling);\n\t\t\t\t\t}\n\t\t\t\t\tvar current = domUtils.getNextDomNode(bookmark.start, false, function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnext;\n\t\t\t\t\twhile (current && current !== bookmark.end) {\n\t\t\t\t\t\tnext = domUtils.getNextDomNode(current, true, function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (utils.indexOf(tagNames, current.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent = next;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前选中的自闭合的节点\n\t\t\t\t * @method  getClosedNode\n\t\t\t\t * @return { Node | NULL } 如果当前选中的是自闭合节点， 则返回该节点， 否则返回NULL\n\t\t\t\t */\n\t\t\t\tgetClosedNode: function() {\n\t\t\t\t\tvar node;\n\t\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\t\tvar range = this.cloneRange().adjustmentBoundary().shrinkBoundary();\n\t\t\t\t\t\tif (selectOneNode(range)) {\n\t\t\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset];\n\t\t\t\t\t\t\tif (child && child.nodeType == 1 && (dtd.$empty[child.tagName] || dtd.$nonChild[child.tagName])) {\n\t\t\t\t\t\t\t\tnode = child;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn node;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 在页面上高亮range所表示的选区\n\t\t\t\t * @method select\n\t\t\t\t * @return { UE.dom.Range } 返回当前Range对象\n\t\t\t\t */\n\t\t\t\t//这里不区分ie9以上，trace:3824\n\t\t\t\tselect: browser.ie ? function(noFillData, textRange) {\n\t\t\t\t\tvar nativeRange;\n\t\t\t\t\tif (!this.collapsed)\n\t\t\t\t\t\tthis.shrinkBoundary();\n\t\t\t\t\tvar node = this.getClosedNode();\n\t\t\t\t\tif (node && !textRange) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tnativeRange = this.document.body.createControlRange();\n\t\t\t\t\t\t\tnativeRange.addElement(node);\n\t\t\t\t\t\t\tnativeRange.select();\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t}\n\t\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\t\tstart = bookmark.start,\n\t\t\t\t\t\tend;\n\t\t\t\t\tnativeRange = this.document.body.createTextRange();\n\t\t\t\t\tnativeRange.moveToElementText(start);\n\t\t\t\t\tnativeRange.moveStart('character', 1);\n\t\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\t\tvar nativeRangeEnd = this.document.body.createTextRange();\n\t\t\t\t\t\tend = bookmark.end;\n\t\t\t\t\t\tnativeRangeEnd.moveToElementText(end);\n\t\t\t\t\t\tnativeRange.setEndPoint('EndToEnd', nativeRangeEnd);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!noFillData && this.startContainer.nodeType != 3) {\n\t\t\t\t\t\t\t//使用<span>|x<span>固定住光标\n\t\t\t\t\t\t\tvar tmpText = this.document.createTextNode(fillChar),\n\t\t\t\t\t\t\t\ttmp = this.document.createElement('span');\n\t\t\t\t\t\t\ttmp.appendChild(this.document.createTextNode(fillChar));\n\t\t\t\t\t\t\tstart.parentNode.insertBefore(tmp, start);\n\t\t\t\t\t\t\tstart.parentNode.insertBefore(tmpText, start);\n\t\t\t\t\t\t\t//当点b,i,u时，不能清除i上边的b\n\t\t\t\t\t\t\tremoveFillData(this.document, tmpText);\n\t\t\t\t\t\t\tfillData = tmpText;\n\t\t\t\t\t\t\tmergeSibling(tmp, 'previousSibling');\n\t\t\t\t\t\t\tmergeSibling(start, 'nextSibling');\n\t\t\t\t\t\t\tnativeRange.moveStart('character', -1);\n\t\t\t\t\t\t\tnativeRange.collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.moveToBookmark(bookmark);\n\t\t\t\t\ttmp && domUtils.remove(tmp);\n\t\t\t\t\t//IE在隐藏状态下不支持range操作，catch一下\n\t\t\t\t\ttry {\n\t\t\t\t\t\tnativeRange.select();\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t\treturn this;\n\t\t\t\t} : function(notInsertFillData) {\n\t\t\t\t\tfunction checkOffset(rng) {\n\t\n\t\t\t\t\t\tfunction check(node, offset, dir) {\n\t\t\t\t\t\t\tif (node.nodeType == 3 && node.nodeValue.length < offset) {\n\t\t\t\t\t\t\t\trng[dir + 'Offset'] = node.nodeValue.length\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcheck(rng.startContainer, rng.startOffset, 'start');\n\t\t\t\t\t\tcheck(rng.endContainer, rng.endOffset, 'end');\n\t\t\t\t\t}\n\t\t\t\t\tvar win = domUtils.getWindow(this.document),\n\t\t\t\t\t\tsel = win.getSelection(),\n\t\t\t\t\t\ttxtNode;\n\t\t\t\t\t//FF下关闭自动长高时滚动条在关闭dialog时会跳\n\t\t\t\t\t//ff下如果不body.focus将不能定位闭合光标到编辑器内\n\t\t\t\t\tbrowser.gecko ? this.document.body.focus() : win.focus();\n\t\t\t\t\tif (sel) {\n\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t// trace:870 chrome/safari后边是br对于闭合得range不能定位 所以去掉了判断\n\t\t\t\t\t\t// this.startContainer.nodeType != 3 &&! ((child = this.startContainer.childNodes[this.startOffset]) && child.nodeType == 1 && child.tagName == 'BR'\n\t\t\t\t\t\tif (this.collapsed && !notInsertFillData) {\n\t\t\t\t\t\t\t//                    //opear如果没有节点接着，原生的不能够定位,不能在body的第一级插入空白节点\n\t\t\t\t\t\t\t//                    if (notInsertFillData && browser.opera && !domUtils.isBody(this.startContainer) && this.startContainer.nodeType == 1) {\n\t\t\t\t\t\t\t//                        var tmp = this.document.createTextNode('');\n\t\t\t\t\t\t\t//                        this.insertNode(tmp).setStart(tmp, 0).collapse(true);\n\t\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t//处理光标落在文本节点的情况\n\t\t\t\t\t\t\t//处理以下的情况\n\t\t\t\t\t\t\t//<b>|xxxx</b>\n\t\t\t\t\t\t\t//<b>xxxx</b>|xxxx\n\t\t\t\t\t\t\t//xxxx<b>|</b>\n\t\t\t\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\t\t\t\tchild = start;\n\t\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\t\tchild = start.childNodes[this.startOffset];\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!(start.nodeType == 3 && this.startOffset) &&\n\t\t\t\t\t\t\t\t(child ?\n\t\t\t\t\t\t\t\t\t(!child.previousSibling || child.previousSibling.nodeType != 3) :\n\t\t\t\t\t\t\t\t\t(!start.lastChild || start.lastChild.nodeType != 3)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\ttxtNode = this.document.createTextNode(fillChar);\n\t\t\t\t\t\t\t\t//跟着前边走\n\t\t\t\t\t\t\t\tthis.insertNode(txtNode);\n\t\t\t\t\t\t\t\tremoveFillData(this.document, txtNode);\n\t\t\t\t\t\t\t\tmergeSibling(txtNode, 'previousSibling');\n\t\t\t\t\t\t\t\tmergeSibling(txtNode, 'nextSibling');\n\t\t\t\t\t\t\t\tfillData = txtNode;\n\t\t\t\t\t\t\t\tthis.setStart(txtNode, browser.webkit ? 1 : 0).collapse(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar nativeRange = this.document.createRange();\n\t\t\t\t\t\tif (this.collapsed && browser.opera && this.startContainer.nodeType == 1) {\n\t\t\t\t\t\t\tvar child = this.startContainer.childNodes[this.startOffset];\n\t\t\t\t\t\t\tif (!child) {\n\t\t\t\t\t\t\t\t//往前靠拢\n\t\t\t\t\t\t\t\tchild = this.startContainer.lastChild;\n\t\t\t\t\t\t\t\tif (child && domUtils.isBr(child)) {\n\t\t\t\t\t\t\t\t\tthis.setStartBefore(child).collapse(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//向后靠拢\n\t\t\t\t\t\t\t\twhile (child && domUtils.isBlockElm(child)) {\n\t\t\t\t\t\t\t\t\tif (child.nodeType == 1 && child.childNodes[0]) {\n\t\t\t\t\t\t\t\t\t\tchild = child.childNodes[0]\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tchild && this.setStartBefore(child).collapse(true)\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//是createAddress最后一位算的不准，现在这里进行微调\n\t\t\t\t\t\tcheckOffset(this);\n\t\t\t\t\t\tnativeRange.setStart(this.startContainer, this.startOffset);\n\t\t\t\t\t\tnativeRange.setEnd(this.endContainer, this.endOffset);\n\t\t\t\t\t\tsel.addRange(nativeRange);\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 滚动到当前range开始的位置\n\t\t\t\t * @method scrollToView\n\t\t\t\t * @param { Window } win 当前range对象所属的window对象\n\t\t\t\t * @return { UE.dom.Range } 当前Range对象\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 滚动到距离当前range开始位置 offset 的位置处\n\t\t\t\t * @method scrollToView\n\t\t\t\t * @param { Window } win 当前range对象所属的window对象\n\t\t\t\t * @param { Number } offset 距离range开始位置处的偏移量， 如果为正数， 则向下偏移， 反之， 则向上偏移\n\t\t\t\t * @return { UE.dom.Range } 当前Range对象\n\t\t\t\t */\n\t\t\t\tscrollToView: function(win, offset) {\n\t\t\t\t\twin = win ? window : domUtils.getWindow(this.document);\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tspan = me.document.createElement('span');\n\t\t\t\t\t//trace:717\n\t\t\t\t\tspan.innerHTML = '&nbsp;';\n\t\t\t\t\tme.cloneRange().insertNode(span);\n\t\t\t\t\tdomUtils.scrollToView(span, win, offset);\n\t\t\t\t\tdomUtils.remove(span);\n\t\t\t\t\treturn me;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 判断当前选区内容是否占位符\n\t\t\t\t * @private\n\t\t\t\t * @method inFillChar\n\t\t\t\t * @return { Boolean } 如果是占位符返回true，否则返回false\n\t\t\t\t */\n\t\t\t\tinFillChar: function() {\n\t\t\t\t\tvar start = this.startContainer;\n\t\t\t\t\tif (this.collapsed && start.nodeType == 3 && start.nodeValue.replace(new RegExp('^' + domUtils.fillChar), '').length + 1 == start.nodeValue.length) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 保存\n\t\t\t\t * @method createAddress\n\t\t\t\t * @private\n\t\t\t\t * @return { Boolean } 返回开始和结束的位置\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <body>\n\t\t\t\t *     <p>\n\t\t\t\t *         aaaa\n\t\t\t\t *         <em>\n\t\t\t\t *             <!-- 选区开始 -->\n\t\t\t\t *             bbbb\n\t\t\t\t *             <!-- 选区结束 -->\n\t\t\t\t *         </em>\n\t\t\t\t *     </p>\n\t\t\t\t *\n\t\t\t\t *     <script>\n\t\t\t\t *         //output: {startAddress:[0,1,0,0],endAddress:[0,1,0,4]}\n\t\t\t\t *         console.log( range.createAddress() );\n\t\t\t\t *     </script>\n\t\t\t\t * </body>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tcreateAddress: function(ignoreEnd, ignoreTxt) {\n\t\t\t\t\tvar addr = {},\n\t\t\t\t\t\tme = this;\n\t\n\t\t\t\t\tfunction getAddress(isStart) {\n\t\t\t\t\t\tvar node = isStart ? me.startContainer : me.endContainer;\n\t\t\t\t\t\tvar parents = domUtils.findParents(node, true, function(node) {\n\t\t\t\t\t\t\t\treturn !domUtils.isBody(node)\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\taddrs = [];\n\t\t\t\t\t\tfor (var i = 0, ci; ci = parents[i++];) {\n\t\t\t\t\t\t\taddrs.push(domUtils.getNodeIndex(ci, ignoreTxt));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar firstIndex = 0;\n\t\n\t\t\t\t\t\tif (ignoreTxt) {\n\t\t\t\t\t\t\tif (node.nodeType == 3) {\n\t\t\t\t\t\t\t\tvar tmpNode = node.previousSibling;\n\t\t\t\t\t\t\t\twhile (tmpNode && tmpNode.nodeType == 3) {\n\t\t\t\t\t\t\t\t\tfirstIndex += tmpNode.nodeValue.replace(fillCharReg, '').length;\n\t\t\t\t\t\t\t\t\ttmpNode = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfirstIndex += (isStart ? me.startOffset : me.endOffset) // - (fillCharReg.test(node.nodeValue) ? 1 : 0 )\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnode = node.childNodes[isStart ? me.startOffset : me.endOffset];\n\t\t\t\t\t\t\t\tif (node) {\n\t\t\t\t\t\t\t\t\tfirstIndex = domUtils.getNodeIndex(node, ignoreTxt);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnode = isStart ? me.startContainer : me.endContainer;\n\t\t\t\t\t\t\t\t\tvar first = node.firstChild;\n\t\t\t\t\t\t\t\t\twhile (first) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isFillChar(first)) {\n\t\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfirstIndex++;\n\t\t\t\t\t\t\t\t\t\tif (first.nodeType == 3) {\n\t\t\t\t\t\t\t\t\t\t\twhile (first && first.nodeType == 3) {\n\t\t\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfirstIndex = isStart ? domUtils.isFillChar(node) ? 0 : me.startOffset : me.endOffset\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (firstIndex < 0) {\n\t\t\t\t\t\t\tfirstIndex = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\taddrs.push(firstIndex);\n\t\t\t\t\t\treturn addrs;\n\t\t\t\t\t}\n\t\t\t\t\taddr.startAddress = getAddress(true);\n\t\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\t\taddr.endAddress = me.collapsed ? [].concat(addr.startAddress) : getAddress();\n\t\t\t\t\t}\n\t\t\t\t\treturn addr;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 保存\n\t\t\t\t * @method createAddress\n\t\t\t\t * @private\n\t\t\t\t * @return { Boolean } 返回开始和结束的位置\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t * <body>\n\t\t\t\t *     <p>\n\t\t\t\t *         aaaa\n\t\t\t\t *         <em>\n\t\t\t\t *             <!-- 选区开始 -->\n\t\t\t\t *             bbbb\n\t\t\t\t *             <!-- 选区结束 -->\n\t\t\t\t *         </em>\n\t\t\t\t *     </p>\n\t\t\t\t *\n\t\t\t\t *     <script>\n\t\t\t\t *         var range = editor.selection.getRange();\n\t\t\t\t *         range.moveToAddress({startAddress:[0,1,0,0],endAddress:[0,1,0,4]});\n\t\t\t\t *         range.select();\n\t\t\t\t *         //output: 'bbbb'\n\t\t\t\t *         console.log(editor.selection.getText());\n\t\t\t\t *     </script>\n\t\t\t\t * </body>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tmoveToAddress: function(addr, ignoreEnd) {\n\t\t\t\t\tvar me = this;\n\t\n\t\t\t\t\tfunction getNode(address, isStart) {\n\t\t\t\t\t\tvar tmpNode = me.document.body,\n\t\t\t\t\t\t\tparentNode, offset;\n\t\t\t\t\t\tfor (var i = 0, ci, l = address.length; i < l; i++) {\n\t\t\t\t\t\t\tci = address[i];\n\t\t\t\t\t\t\tparentNode = tmpNode;\n\t\t\t\t\t\t\ttmpNode = tmpNode.childNodes[ci];\n\t\t\t\t\t\t\tif (!tmpNode) {\n\t\t\t\t\t\t\t\toffset = ci;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isStart) {\n\t\t\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\t\t\tme.setStartBefore(tmpNode)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tme.setStart(parentNode, offset)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\t\t\tme.setEndBefore(tmpNode)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tme.setEnd(parentNode, offset)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tgetNode(addr.startAddress, true);\n\t\t\t\t\t!ignoreEnd && addr.endAddress && getNode(addr.endAddress);\n\t\t\t\t\treturn me;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 判断给定的Range对象是否和当前Range对象表示的是同一个选区\n\t\t\t\t * @method equals\n\t\t\t\t * @param { UE.dom.Range } 需要判断的Range对象\n\t\t\t\t * @return { Boolean } 如果给定的Range对象与当前Range对象表示的是同一个选区， 则返回true， 否则返回false\n\t\t\t\t */\n\t\t\t\tequals: function(rng) {\n\t\t\t\t\tfor (var p in this) {\n\t\t\t\t\t\tif (this.hasOwnProperty(p)) {\n\t\t\t\t\t\t\tif (this[p] !== rng[p])\n\t\t\t\t\t\t\t\treturn false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 遍历range内的节点。每当遍历一个节点时， 都会执行参数项 doFn 指定的函数， 该函数的接受当前遍历的节点\n\t\t\t\t * 作为其参数。\n\t\t\t\t * @method traversal\n\t\t\t\t * @param { Function }  doFn 对每个遍历的节点要执行的方法， 该方法接受当前遍历的节点作为其参数\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t *\n\t\t\t\t * <body>\n\t\t\t\t *\n\t\t\t\t *     <!-- 选区开始 -->\n\t\t\t\t *     <span></span>\n\t\t\t\t *     <a></a>\n\t\t\t\t *     <!-- 选区结束 -->\n\t\t\t\t * </body>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //output: <span></span><a></a>\n\t\t\t\t *     console.log( range.cloneContents() );\n\t\t\t\t *\n\t\t\t\t *     range.traversal( function ( node ) {\n\t\t\t\t *\n\t\t\t\t *         if ( node.nodeType === 1 ) {\n\t\t\t\t *             node.className = \"test\";\n\t\t\t\t *         }\n\t\t\t\t *\n\t\t\t\t *     } );\n\t\t\t\t *\n\t\t\t\t *     //output: <span class=\"test\"></span><a class=\"test\"></a>\n\t\t\t\t *     console.log( range.cloneContents() );\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 遍历range内的节点。\n\t\t\t\t * 每当遍历一个节点时， 都会执行参数项 doFn 指定的函数， 该函数的接受当前遍历的节点\n\t\t\t\t * 作为其参数。\n\t\t\t\t * 可以通过参数项 filterFn 来指定一个过滤器， 只有符合该过滤器过滤规则的节点才会触\n\t\t\t\t * 发doFn函数的执行\n\t\t\t\t * @method traversal\n\t\t\t\t * @param { Function } doFn 对每个遍历的节点要执行的方法， 该方法接受当前遍历的节点作为其参数\n\t\t\t\t * @param { Function } filterFn 过滤器， 该函数接受当前遍历的节点作为参数， 如果该节点满足过滤\n\t\t\t\t *                      规则， 请返回true， 该节点会触发doFn， 否则， 请返回false， 则该节点不\n\t\t\t\t *                      会触发doFn。\n\t\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t\t * @see UE.dom.Range:traversal(Function)\n\t\t\t\t * @example\n\t\t\t\t * ```html\n\t\t\t\t *\n\t\t\t\t * <body>\n\t\t\t\t *\n\t\t\t\t *     <!-- 选区开始 -->\n\t\t\t\t *     <span></span>\n\t\t\t\t *     <a></a>\n\t\t\t\t *     <!-- 选区结束 -->\n\t\t\t\t * </body>\n\t\t\t\t *\n\t\t\t\t * <script>\n\t\t\t\t *\n\t\t\t\t *     //output: <span></span><a></a>\n\t\t\t\t *     console.log( range.cloneContents() );\n\t\t\t\t *\n\t\t\t\t *     range.traversal( function ( node ) {\n\t\t\t\t *\n\t\t\t\t *         node.className = \"test\";\n\t\t\t\t *\n\t\t\t\t *     }, function ( node ) {\n\t\t\t\t *          return node.nodeType === 1;\n\t\t\t\t *     } );\n\t\t\t\t *\n\t\t\t\t *     //output: <span class=\"test\"></span><a class=\"test\"></a>\n\t\t\t\t *     console.log( range.cloneContents() );\n\t\t\t\t *\n\t\t\t\t * </script>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\ttraversal: function(doFn, filterFn) {\n\t\t\t\t\tif (this.collapsed)\n\t\t\t\t\t\treturn this;\n\t\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\t\tend = bookmark.end,\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark.start, false, filterFn);\n\t\t\t\t\twhile (current && current !== end && (domUtils.getPosition(current, end) & domUtils.POSITION_PRECEDING)) {\n\t\t\t\t\t\tvar tmpNode = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\tdoFn(current);\n\t\t\t\t\t\tcurrent = tmpNode;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t\t}\n\t\t\t};\n\t\t})();\n\t\n\t\t// core/Selection.js\n\t\t/**\n\t\t * 选集\n\t\t * @file\n\t\t * @module UE.dom\n\t\t * @class Selection\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 选区集合\n\t\t * @unfile\n\t\t * @module UE.dom\n\t\t * @class Selection\n\t\t */\n\t\t(function() {\n\t\n\t\t\tfunction getBoundaryInformation(range, start) {\n\t\t\t\tvar getIndex = domUtils.getNodeIndex;\n\t\t\t\trange = range.duplicate();\n\t\t\t\trange.collapse(start);\n\t\t\t\tvar parent = range.parentElement();\n\t\t\t\t//如果节点里没有子节点，直接退出\n\t\t\t\tif (!parent.hasChildNodes()) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\toffset: 0\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tvar siblings = parent.children,\n\t\t\t\t\tchild,\n\t\t\t\t\ttestRange = range.duplicate(),\n\t\t\t\t\tstartIndex = 0,\n\t\t\t\t\tendIndex = siblings.length - 1,\n\t\t\t\t\tindex = -1,\n\t\t\t\t\tdistance;\n\t\t\t\twhile (startIndex <= endIndex) {\n\t\t\t\t\tindex = Math.floor((startIndex + endIndex) / 2);\n\t\t\t\t\tchild = siblings[index];\n\t\t\t\t\ttestRange.moveToElementText(child);\n\t\t\t\t\tvar position = testRange.compareEndPoints('StartToStart', range);\n\t\t\t\t\tif (position > 0) {\n\t\t\t\t\t\tendIndex = index - 1;\n\t\t\t\t\t} else if (position < 0) {\n\t\t\t\t\t\tstartIndex = index + 1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//trace:1043\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\t\toffset: getIndex(child)\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (index == -1) {\n\t\t\t\t\ttestRange.moveToElementText(parent);\n\t\t\t\t\ttestRange.setEndPoint('StartToStart', range);\n\t\t\t\t\tdistance = testRange.text.replace(/(\\r\\n|\\r)/g, '\\n').length;\n\t\t\t\t\tsiblings = parent.childNodes;\n\t\t\t\t\tif (!distance) {\n\t\t\t\t\t\tchild = siblings[siblings.length - 1];\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcontainer: child,\n\t\t\t\t\t\t\toffset: child.nodeValue.length\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar i = siblings.length;\n\t\t\t\t\twhile (distance > 0) {\n\t\t\t\t\t\tdistance -= siblings[--i].nodeValue.length;\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: siblings[i],\n\t\t\t\t\t\toffset: -distance\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\ttestRange.collapse(position > 0);\n\t\t\t\ttestRange.setEndPoint(position > 0 ? 'StartToStart' : 'EndToStart', range);\n\t\t\t\tdistance = testRange.text.replace(/(\\r\\n|\\r)/g, '\\n').length;\n\t\t\t\tif (!distance) {\n\t\t\t\t\treturn dtd.$empty[child.tagName] || dtd.$nonChild[child.tagName] ? {\n\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\toffset: getIndex(child) + (position > 0 ? 0 : 1)\n\t\t\t\t\t} : {\n\t\t\t\t\t\tcontainer: child,\n\t\t\t\t\t\toffset: position > 0 ? 0 : child.childNodes.length\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\twhile (distance > 0) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar pre = child;\n\t\t\t\t\t\tchild = child[position > 0 ? 'previousSibling' : 'nextSibling'];\n\t\t\t\t\t\tdistance -= child.nodeValue.length;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\t\toffset: getIndex(pre)\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tcontainer: child,\n\t\t\t\t\toffset: position > 0 ? -distance : child.nodeValue.length + distance\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 将ieRange转换为Range对象\n\t\t\t * @param {Range}   ieRange    ieRange对象\n\t\t\t * @param {Range}   range      Range对象\n\t\t\t * @return  {Range}  range       返回转换后的Range对象\n\t\t\t */\n\t\t\tfunction transformIERangeToRange(ieRange, range) {\n\t\t\t\tif (ieRange.item) {\n\t\t\t\t\trange.selectNode(ieRange.item(0));\n\t\t\t\t} else {\n\t\t\t\t\tvar bi = getBoundaryInformation(ieRange, true);\n\t\t\t\t\trange.setStart(bi.container, bi.offset);\n\t\t\t\t\tif (ieRange.compareEndPoints('StartToEnd', ieRange) != 0) {\n\t\t\t\t\t\tbi = getBoundaryInformation(ieRange, false);\n\t\t\t\t\t\trange.setEnd(bi.container, bi.offset);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range;\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获得ieRange\n\t\t\t * @param {Selection} sel    Selection对象\n\t\t\t * @return {ieRange}    得到ieRange\n\t\t\t */\n\t\t\tfunction _getIERange(sel) {\n\t\t\t\tvar ieRange;\n\t\t\t\t//ie下有可能报错\n\t\t\t\ttry {\n\t\t\t\t\tieRange = sel.getNative().createRange();\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar el = ieRange.item ? ieRange.item(0) : ieRange.parentElement();\n\t\t\t\tif ((el.ownerDocument || el) === sel.document) {\n\t\t\t\t\treturn ieRange;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\tvar Selection = dom.Selection = function(doc) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tiframe;\n\t\t\t\tme.document = doc;\n\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\tiframe = domUtils.getWindow(doc).frameElement;\n\t\t\t\t\tdomUtils.on(iframe, 'beforedeactivate', function() {\n\t\t\t\t\t\tme._bakIERange = me.getIERange();\n\t\t\t\t\t});\n\t\t\t\t\tdomUtils.on(iframe, 'activate', function() {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (!_getIERange(me) && me._bakIERange) {\n\t\t\t\t\t\t\t\tme._bakIERange.select();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (ex) {}\n\t\t\t\t\t\tme._bakIERange = null;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tiframe = doc = null;\n\t\t\t};\n\t\n\t\t\tSelection.prototype = {\n\t\n\t\t\t\trangeInBody: function(rng, txtRange) {\n\t\t\t\t\tvar node = browser.ie9below || txtRange ? rng.item ? rng.item() : rng.parentElement() : rng.startContainer;\n\t\n\t\t\t\t\treturn node === this.document.body || domUtils.inDoc(node, this.document);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取原生seleciton对象\n\t\t\t\t * @method getNative\n\t\t\t\t * @return { Object } 获得selection对象\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.selection.getNative();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetNative: function() {\n\t\t\t\t\tvar doc = this.document;\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn !doc ? null : browser.ie9below ? doc.selection : domUtils.getWindow(doc).getSelection();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获得ieRange\n\t\t\t\t * @method getIERange\n\t\t\t\t * @return { Object } 返回ie原生的Range\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.selection.getIERange();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetIERange: function() {\n\t\t\t\t\tvar ieRange = _getIERange(this);\n\t\t\t\t\tif (!ieRange) {\n\t\t\t\t\t\tif (this._bakIERange) {\n\t\t\t\t\t\t\treturn this._bakIERange;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn ieRange;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 缓存当前选区的range和选区的开始节点\n\t\t\t\t * @method cache\n\t\t\t\t */\n\t\t\t\tcache: function() {\n\t\t\t\t\tthis.clear();\n\t\t\t\t\tthis._cachedRange = this.getRange();\n\t\t\t\t\tthis._cachedStartElement = this.getStart();\n\t\t\t\t\tthis._cachedStartElementPath = this.getStartElementPath();\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取选区开始位置的父节点到body\n\t\t\t\t * @method getStartElementPath\n\t\t\t\t * @return { Array } 返回父节点集合\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.selection.getStartElementPath();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetStartElementPath: function() {\n\t\t\t\t\tif (this._cachedStartElementPath) {\n\t\t\t\t\t\treturn this._cachedStartElementPath;\n\t\t\t\t\t}\n\t\t\t\t\tvar start = this.getStart();\n\t\t\t\t\tif (start) {\n\t\t\t\t\t\treturn domUtils.findParents(start, true, null, true)\n\t\t\t\t\t}\n\t\t\t\t\treturn [];\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 清空缓存\n\t\t\t\t * @method clear\n\t\t\t\t */\n\t\t\t\tclear: function() {\n\t\t\t\t\tthis._cachedStartElementPath = this._cachedRange = this._cachedStartElement = null;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 编辑器是否得到了选区\n\t\t\t\t * @method isFocus\n\t\t\t\t */\n\t\t\t\tisFocus: function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (browser.ie9below) {\n\t\n\t\t\t\t\t\t\tvar nativeRange = _getIERange(this);\n\t\t\t\t\t\t\treturn !!(nativeRange && this.rangeInBody(nativeRange));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn !!this.getNative().rangeCount;\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取选区对应的Range\n\t\t\t\t * @method getRange\n\t\t\t\t * @return { Object } 得到Range对象\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.selection.getRange();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetRange: function() {\n\t\t\t\t\tvar me = this;\n\t\n\t\t\t\t\tfunction optimze(range) {\n\t\t\t\t\t\tvar child = me.document.body.firstChild,\n\t\t\t\t\t\t\tcollapsed = range.collapsed;\n\t\t\t\t\t\twhile (child && child.firstChild) {\n\t\t\t\t\t\t\trange.setStart(child, 0);\n\t\t\t\t\t\t\tchild = child.firstChild;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!range.startContainer) {\n\t\t\t\t\t\t\trange.setStart(me.document.body, 0)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (me._cachedRange != null) {\n\t\t\t\t\t\treturn this._cachedRange;\n\t\t\t\t\t}\n\t\t\t\t\tvar range = new baidu.editor.dom.Range(me.document);\n\t\n\t\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\t\tvar nativeRange = me.getIERange();\n\t\t\t\t\t\tif (nativeRange) {\n\t\t\t\t\t\t\t//备份的_bakIERange可能已经实效了，dom树发生了变化比如从源码模式切回来，所以try一下，实效就放到body开始位置\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\ttransformIERangeToRange(nativeRange, range);\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar sel = me.getNative();\n\t\t\t\t\t\tif (sel && sel.rangeCount) {\n\t\t\t\t\t\t\tvar firstRange = sel.getRangeAt(0);\n\t\t\t\t\t\t\tvar lastRange = sel.getRangeAt(sel.rangeCount - 1);\n\t\t\t\t\t\t\trange.setStart(firstRange.startContainer, firstRange.startOffset).setEnd(lastRange.endContainer, lastRange.endOffset);\n\t\t\t\t\t\t\tif (range.collapsed && domUtils.isBody(range.startContainer) && !range.startOffset) {\n\t\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//trace:1734 有可能已经不在dom树上了，标识的节点\n\t\t\t\t\t\t\tif (this._bakRange && domUtils.inDoc(this._bakRange.startContainer, this.document)) {\n\t\t\t\t\t\t\t\treturn this._bakRange;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this._bakRange = range;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取开始元素，用于状态反射\n\t\t\t\t * @method getStart\n\t\t\t\t * @return { Element } 获得开始元素\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.selection.getStart();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetStart: function() {\n\t\t\t\t\tif (this._cachedStartElement) {\n\t\t\t\t\t\treturn this._cachedStartElement;\n\t\t\t\t\t}\n\t\t\t\t\tvar range = browser.ie9below ? this.getIERange() : this.getRange(),\n\t\t\t\t\t\ttmpRange,\n\t\t\t\t\t\tstart, tmp, parent;\n\t\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\t\tif (!range) {\n\t\t\t\t\t\t\t//todo 给第一个值可能会有问题\n\t\t\t\t\t\t\treturn this.document.body.firstChild;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//control元素\n\t\t\t\t\t\tif (range.item) {\n\t\t\t\t\t\t\treturn range.item(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpRange = range.duplicate();\n\t\t\t\t\t\t//修正ie下<b>x</b>[xx] 闭合后 <b>x|</b>xx\n\t\t\t\t\t\ttmpRange.text.length > 0 && tmpRange.moveStart('character', 1);\n\t\t\t\t\t\ttmpRange.collapse(1);\n\t\t\t\t\t\tstart = tmpRange.parentElement();\n\t\t\t\t\t\tparent = tmp = range.parentElement();\n\t\t\t\t\t\twhile (tmp = tmp.parentNode) {\n\t\t\t\t\t\t\tif (tmp == start) {\n\t\t\t\t\t\t\t\tstart = parent;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trange.shrinkBoundary();\n\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\tif (start.nodeType == 1 && start.hasChildNodes()) {\n\t\t\t\t\t\t\tstart = start.childNodes[Math.min(start.childNodes.length - 1, range.startOffset)];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (start.nodeType == 3) {\n\t\t\t\t\t\t\treturn start.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn start;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 得到选区中的文本\n\t\t\t\t * @method getText\n\t\t\t\t * @return { String } 选区中包含的文本\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.selection.getText();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetText: function() {\n\t\t\t\t\tvar nativeSel, nativeRange;\n\t\t\t\t\tif (this.isFocus() && (nativeSel = this.getNative())) {\n\t\t\t\t\t\tnativeRange = browser.ie9below ? nativeSel.createRange() : nativeSel.getRangeAt(0);\n\t\t\t\t\t\treturn browser.ie9below ? nativeRange.text : nativeRange.toString();\n\t\t\t\t\t}\n\t\t\t\t\treturn '';\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 清除选区\n\t\t\t\t * @method clearRange\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.selection.clearRange();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tclearRange: function() {\n\t\t\t\t\tthis.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t\t}\n\t\t\t};\n\t\t})();\n\t\n\t\t// core/Editor.js\n\t\t/**\n\t\t * 编辑器主类，包含编辑器提供的大部分公用接口\n\t\t * @file\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t\t * @unfile\n\t\t * @module UE\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor的核心类，为用户提供与编辑器交互的接口。\n\t\t * @unfile\n\t\t * @module UE\n\t\t * @class Editor\n\t\t */\n\t\n\t\t(function() {\n\t\t\tvar uid = 0,\n\t\t\t\t_selectionChangeTimer;\n\t\n\t\t\t/**\n\t\t\t * 获取编辑器的html内容，赋值到编辑器所在表单的textarea文本域里面\n\t\t\t * @private\n\t\t\t * @method setValue\n\t\t\t * @param { UE.Editor } editor 编辑器事例\n\t\t\t */\n\t\t\tfunction setValue(form, editor) {\n\t\t\t\tvar textarea;\n\t\t\t\tif (editor.textarea) {\n\t\t\t\t\tif (utils.isString(editor.textarea)) {\n\t\t\t\t\t\tfor (var i = 0, ti, tis = domUtils.getElementsByTagName(form, 'textarea'); ti = tis[i++];) {\n\t\t\t\t\t\t\tif (ti.id == 'ueditor_textarea_' + editor.options.textarea) {\n\t\t\t\t\t\t\t\ttextarea = ti;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttextarea = editor.textarea;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!textarea) {\n\t\t\t\t\tform.appendChild(textarea = domUtils.createElement(document, 'textarea', {\n\t\t\t\t\t\t'name': editor.options.textarea,\n\t\t\t\t\t\t'id': 'ueditor_textarea_' + editor.options.textarea,\n\t\t\t\t\t\t'style': \"display:none\"\n\t\t\t\t\t}));\n\t\t\t\t\t//不要产生多个textarea\n\t\t\t\t\teditor.textarea = textarea;\n\t\t\t\t}!textarea.getAttribute('name') && textarea.setAttribute('name', editor.options.textarea);\n\t\t\t\ttextarea.value = editor.hasContents() ?\n\t\t\t\t\t(editor.options.allHtmlEnabled ? editor.getAllHtml() : editor.getContent(null, null, true)) :\n\t\t\t\t\t''\n\t\t\t}\n\t\n\t\t\tfunction loadPlugins(me) {\n\t\t\t\t//初始化插件\n\t\t\t\tfor (var pi in UE.plugins) {\n\t\t\t\t\tUE.plugins[pi].call(me);\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tfunction checkCurLang(I18N) {\n\t\t\t\tfor (var lang in I18N) {\n\t\t\t\t\treturn lang\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction langReadied(me) {\n\t\t\t\tme.langIsReady = true;\n\t\n\t\t\t\tme.fireEvent(\"langReady\");\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 编辑器准备就绪后会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event ready\n\t\t\t * @remind render方法执行完成之后,会触发该事件\n\t\t\t * @remind\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addListener( 'ready', function( editor ) {\n\t\t\t *     editor.execCommand( 'focus' ); //编辑器家在完成后，让编辑器拿到焦点\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 执行destroy方法,会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event destroy\n\t\t\t * @see UE.Editor:destroy()\n\t\t\t */\n\t\t\t/**\n\t\t\t * 执行reset方法,会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event reset\n\t\t\t * @see UE.Editor:reset()\n\t\t\t */\n\t\t\t/**\n\t\t\t * 执行focus方法,会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event focus\n\t\t\t * @see UE.Editor:focus(Boolean)\n\t\t\t */\n\t\t\t/**\n\t\t\t * 语言加载完成会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event langReady\n\t\t\t */\n\t\t\t/**\n\t\t\t * 运行命令之后会触发该命令\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event beforeExecCommand\n\t\t\t */\n\t\t\t/**\n\t\t\t * 运行命令之后会触发该命令\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event afterExecCommand\n\t\t\t */\n\t\t\t/**\n\t\t\t * 运行命令之前会触发该命令\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event firstBeforeExecCommand\n\t\t\t */\n\t\t\t/**\n\t\t\t * 在getContent方法执行之前会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event beforeGetContent\n\t\t\t * @see UE.Editor:getContent()\n\t\t\t */\n\t\t\t/**\n\t\t\t * 在getContent方法执行之后会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event afterGetContent\n\t\t\t * @see UE.Editor:getContent()\n\t\t\t */\n\t\t\t/**\n\t\t\t * 在getAllHtml方法执行时会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event getAllHtml\n\t\t\t * @see UE.Editor:getAllHtml()\n\t\t\t */\n\t\t\t/**\n\t\t\t * 在setContent方法执行之前会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event beforeSetContent\n\t\t\t * @see UE.Editor:setContent(String)\n\t\t\t */\n\t\t\t/**\n\t\t\t * 在setContent方法执行之后会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event afterSetContent\n\t\t\t * @see UE.Editor:setContent(String)\n\t\t\t */\n\t\t\t/**\n\t\t\t * 每当编辑器内部选区发生改变时，将触发该事件\n\t\t\t * @event selectionchange\n\t\t\t * @warning 该事件的触发非常频繁，不建议在该事件的处理过程中做重量级的处理\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addListener( 'selectionchange', function( editor ) {\n\t\t\t *     console.log('选区发生改变');\n\t\t\t * }\n\t\t\t */\n\t\t\t/**\n\t\t\t * 在所有selectionchange的监听函数执行之前，会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event beforeSelectionChange\n\t\t\t * @see UE.Editor:selectionchange\n\t\t\t */\n\t\t\t/**\n\t\t\t * 在所有selectionchange的监听函数执行完之后，会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event afterSelectionChange\n\t\t\t * @see UE.Editor:selectionchange\n\t\t\t */\n\t\t\t/**\n\t\t\t * 编辑器内容发生改变时会触发该事件\n\t\t\t * @module UE\n\t\t\t * @class Editor\n\t\t\t * @event contentChange\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 以默认参数构建一个编辑器实例\n\t\t\t * @constructor\n\t\t\t * @remind 通过 改构造方法实例化的编辑器,不带ui层.需要render到一个容器,编辑器实例才能正常渲染到页面\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var editor = new UE.Editor();\n\t\t\t * editor.execCommand('blod');\n\t\t\t * ```\n\t\t\t * @see UE.Config\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 以给定的参数集合创建一个编辑器实例，对于未指定的参数，将应用默认参数。\n\t\t\t * @constructor\n\t\t\t * @remind 通过 改构造方法实例化的编辑器,不带ui层.需要render到一个容器,编辑器实例才能正常渲染到页面\n\t\t\t * @param { Object } setting 创建编辑器的参数\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var editor = new UE.Editor();\n\t\t\t * editor.execCommand('blod');\n\t\t\t * ```\n\t\t\t * @see UE.Config\n\t\t\t */\n\t\t\tvar Editor = UE.Editor = function(options) {\n\t\t\t\tvar me = this;\n\t\t\t\tme.uid = uid++;\n\t\t\t\tEventBase.call(me);\n\t\t\t\tme.commands = {};\n\t\t\t\tme.options = utils.extend(utils.clone(options || {}), UEDITOR_CONFIG, true);\n\t\t\t\tme.shortcutkeys = {};\n\t\t\t\tme.inputRules = [];\n\t\t\t\tme.outputRules = [];\n\t\t\t\t//设置默认的常用属性\n\t\t\t\tme.setOpt(Editor.defaultOptions(me));\n\t\n\t\t\t\t/* 尝试异步加载后台配置 */\n\t\t\t\tme.loadServerConfig();\n\t\n\t\t\t\tif (!utils.isEmptyObject(UE.I18N)) {\n\t\t\t\t\t//修改默认的语言类型\n\t\t\t\t\tme.options.lang = checkCurLang(UE.I18N);\n\t\t\t\t\tUE.plugin.load(me);\n\t\t\t\t\tlangReadied(me);\n\t\n\t\t\t\t} else {\n\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\tsrc: me.options.langPath + me.options.lang + \"/\" + me.options.lang + \".js\",\n\t\t\t\t\t\ttag: \"script\",\n\t\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t\t}, function() {\n\t\t\t\t\t\tUE.plugin.load(me);\n\t\t\t\t\t\tlangReadied(me);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t\tUE.instants['ueditorInstant' + me.uid] = me;\n\t\t\t};\n\t\t\tEditor.prototype = {\n\t\t\t\tregisterCommand: function(name, obj) {\n\t\t\t\t\tthis.commands[name] = obj;\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 编辑器对外提供的监听ready事件的接口， 通过调用该方法，达到的效果与监听ready事件是一致的\n\t\t\t\t * @method ready\n\t\t\t\t * @param { Function } fn 编辑器ready之后所执行的回调, 如果在注册事件之前编辑器已经ready，将会\n\t\t\t\t * 立即触发该回调。\n\t\t\t\t * @remind 需要等待编辑器加载完成后才能执行的代码,可以使用该方法传入\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.ready( function( editor ) {\n\t\t\t\t *     editor.setContent('初始化完毕');\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t * @see UE.Editor.event:ready\n\t\t\t\t */\n\t\t\t\tready: function(fn) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (fn) {\n\t\t\t\t\t\tme.isReady ? fn.apply(me) : me.addListener('ready', fn);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 该方法是提供给插件里面使用，设置配置项默认值\n\t\t\t\t * @method setOpt\n\t\t\t\t * @warning 三处设置配置项的优先级: 实例化时传入参数 > setOpt()设置 > config文件里设置\n\t\t\t\t * @warning 该方法仅供编辑器插件内部和编辑器初始化时调用，其他地方不能调用。\n\t\t\t\t * @param { String } key 编辑器的可接受的选项名称\n\t\t\t\t * @param { * } val  该选项可接受的值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setOpt( 'initContent', '欢迎使用编辑器' );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 该方法是提供给插件里面使用，以{key:value}集合的方式设置插件内用到的配置项默认值\n\t\t\t\t * @method setOpt\n\t\t\t\t * @warning 三处设置配置项的优先级: 实例化时传入参数 > setOpt()设置 > config文件里设置\n\t\t\t\t * @warning 该方法仅供编辑器插件内部和编辑器初始化时调用，其他地方不能调用。\n\t\t\t\t * @param { Object } options 将要设置的选项的键值对对象\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setOpt( {\n\t\t\t\t *     'initContent': '欢迎使用编辑器'\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetOpt: function(key, val) {\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tif (utils.isString(key)) {\n\t\t\t\t\t\tobj[key] = val\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj = key;\n\t\t\t\t\t}\n\t\t\t\t\tutils.extend(this.options, obj, true);\n\t\t\t\t},\n\t\t\t\tgetOpt: function(key) {\n\t\t\t\t\treturn this.options[key]\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 销毁编辑器实例，使用textarea代替\n\t\t\t\t * @method destroy\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.destroy();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tdestroy: function() {\n\t\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.fireEvent('destroy');\n\t\t\t\t\tvar container = me.container.parentNode;\n\t\t\t\t\tvar textarea = me.textarea;\n\t\t\t\t\tif (!textarea) {\n\t\t\t\t\t\ttextarea = document.createElement('textarea');\n\t\t\t\t\t\tcontainer.parentNode.insertBefore(textarea, container);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttextarea.style.display = ''\n\t\t\t\t\t}\n\t\n\t\t\t\t\ttextarea.style.width = me.iframe.offsetWidth + 'px';\n\t\t\t\t\ttextarea.style.height = me.iframe.offsetHeight + 'px';\n\t\t\t\t\ttextarea.value = me.getContent();\n\t\t\t\t\ttextarea.id = me.key;\n\t\t\t\t\tcontainer.innerHTML = '';\n\t\t\t\t\tdomUtils.remove(container);\n\t\t\t\t\tvar key = me.key;\n\t\t\t\t\t//trace:2004\n\t\t\t\t\tfor (var p in me) {\n\t\t\t\t\t\tif (me.hasOwnProperty(p)) {\n\t\t\t\t\t\t\tdelete this[p];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tUE.delEditor(key);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 渲染编辑器的DOM到指定容器\n\t\t\t\t * @method render\n\t\t\t\t * @param { String } containerId 指定一个容器ID\n\t\t\t\t * @remind 执行该方法,会触发ready事件\n\t\t\t\t * @warning 必须且只能调用一次\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 渲染编辑器的DOM到指定容器\n\t\t\t\t * @method render\n\t\t\t\t * @param { Element } containerDom 直接指定容器对象\n\t\t\t\t * @remind 执行该方法,会触发ready事件\n\t\t\t\t * @warning 必须且只能调用一次\n\t\t\t\t */\n\t\t\t\trender: function(container) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\toptions = me.options,\n\t\t\t\t\t\tgetStyleValue = function(attr) {\n\t\t\t\t\t\t\treturn parseInt(domUtils.getComputedStyle(container, attr));\n\t\t\t\t\t\t};\n\t\t\t\t\tif (utils.isString(container)) {\n\t\t\t\t\t\tcontainer = document.getElementById(container);\n\t\t\t\t\t}\n\t\t\t\t\tif (container) {\n\t\t\t\t\t\tif (options.initialFrameWidth) {\n\t\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth = container.offsetWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (options.initialFrameHeight) {\n\t\t\t\t\t\t\toptions.minFrameHeight = options.initialFrameHeight\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toptions.initialFrameHeight = options.minFrameHeight = container.offsetHeight;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tcontainer.style.width = /%$/.test(options.initialFrameWidth) ? '100%' : options.initialFrameWidth -\n\t\t\t\t\t\t\tgetStyleValue(\"padding-left\") - getStyleValue(\"padding-right\") + 'px';\n\t\t\t\t\t\tcontainer.style.height = /%$/.test(options.initialFrameHeight) ? '100%' : options.initialFrameHeight -\n\t\t\t\t\t\t\tgetStyleValue(\"padding-top\") - getStyleValue(\"padding-bottom\") + 'px';\n\t\n\t\t\t\t\t\tcontainer.style.zIndex = options.zIndex;\n\t\n\t\t\t\t\t\tvar html = (ie && browser.version < 9 ? '' : '<!DOCTYPE html>') +\n\t\t\t\t\t\t\t'<html xmlns=\\'http://www.w3.org/1999/xhtml\\' class=\\'view\\' ><head>' +\n\t\t\t\t\t\t\t'<style type=\\'text/css\\'>' +\n\t\t\t\t\t\t\t//设置四周的留边\n\t\t\t\t\t\t\t'.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\\n' +\n\t\t\t\t\t\t\t//设置默认字体和字号\n\t\t\t\t\t\t\t//font-family不能呢随便改，在safari下fillchar会有解析问题\n\t\t\t\t\t\t\t'body{margin:8px;font-family:sans-serif;font-size:16px;}' +\n\t\t\t\t\t\t\t//设置段落间距\n\t\t\t\t\t\t\t'p{margin:5px 0;}</style>' +\n\t\t\t\t\t\t\t(options.iframeCssUrl ? '<link rel=\\'stylesheet\\' type=\\'text/css\\' href=\\'' + utils.unhtml(options.iframeCssUrl) + '\\'/>' : '') +\n\t\t\t\t\t\t\t(options.initialStyle ? '<style>' + options.initialStyle + '</style>' : '') +\n\t\t\t\t\t\t\t'</head><body class=\\'view\\' ></body>' +\n\t\t\t\t\t\t\t'<script type=\\'text/javascript\\' ' + (ie ? 'defer=\\'defer\\'' : '') + ' id=\\'_initialScript\\'>' +\n\t\t\t\t\t\t\t'setTimeout(function(){editor = window.parent.UE.instants[\\'ueditorInstant' + me.uid + '\\'];editor._setup(document);},0);' +\n\t\t\t\t\t\t\t'var _tmpScript = document.getElementById(\\'_initialScript\\');_tmpScript.parentNode.removeChild(_tmpScript);</script></html>';\n\t\t\t\t\t\tcontainer.appendChild(domUtils.createElement(document, 'iframe', {\n\t\t\t\t\t\t\tid: 'ueditor_' + me.uid,\n\t\t\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\t\t\theight: \"100%\",\n\t\t\t\t\t\t\tframeborder: \"0\",\n\t\t\t\t\t\t\t//先注释掉了，加的原因忘记了，但开启会直接导致全屏模式下内容多时不会出现滚动条\n\t\t\t\t\t\t\t//                    scrolling :'no',\n\t\t\t\t\t\t\tsrc: 'javascript:void(function(){document.open();' + (options.customDomain && document.domain != location.hostname ? 'document.domain=\"' + document.domain + '\";' : '') +\n\t\t\t\t\t\t\t\t'document.write(\"' + html + '\");document.close();}())'\n\t\t\t\t\t\t}));\n\t\t\t\t\t\tcontainer.style.overflow = 'hidden';\n\t\t\t\t\t\t//解决如果是给定的百分比，会导致高度算不对的问题\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tif (/%$/.test(options.initialFrameWidth)) {\n\t\t\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth = container.offsetWidth;\n\t\t\t\t\t\t\t\t//如果这里给定宽度，会导致ie在拖动窗口大小时，编辑区域不随着变化\n\t\t\t\t\t\t\t\t//                        container.style.width = options.initialFrameWidth + 'px';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (/%$/.test(options.initialFrameHeight)) {\n\t\t\t\t\t\t\t\toptions.minFrameHeight = options.initialFrameHeight = container.offsetHeight;\n\t\t\t\t\t\t\t\tcontainer.style.height = options.initialFrameHeight + 'px';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 编辑器初始化\n\t\t\t\t * @method _setup\n\t\t\t\t * @private\n\t\t\t\t * @param { Element } doc 编辑器Iframe中的文档对象\n\t\t\t\t */\n\t\t\t\t_setup: function(doc) {\n\t\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\toptions = me.options;\n\t\t\t\t\tif (ie) {\n\t\t\t\t\t\tdoc.body.disabled = true;\n\t\t\t\t\t\tdoc.body.contentEditable = true;\n\t\t\t\t\t\tdoc.body.disabled = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdoc.body.contentEditable = true;\n\t\t\t\t\t}\n\t\t\t\t\tdoc.body.spellcheck = false;\n\t\t\t\t\tme.document = doc;\n\t\t\t\t\tme.window = doc.defaultView || doc.parentWindow;\n\t\t\t\t\tme.iframe = me.window.frameElement;\n\t\t\t\t\tme.body = doc.body;\n\t\t\t\t\tme.selection = new dom.Selection(doc);\n\t\t\t\t\t//gecko初始化就能得到range,无法判断isFocus了\n\t\t\t\t\tvar geckoSel;\n\t\t\t\t\tif (browser.gecko && (geckoSel = this.selection.getNative())) {\n\t\t\t\t\t\tgeckoSel.removeAllRanges();\n\t\t\t\t\t}\n\t\t\t\t\tthis._initEvents();\n\t\t\t\t\t//为form提交提供一个隐藏的textarea\n\t\t\t\t\tfor (var form = this.iframe.parentNode; !domUtils.isBody(form); form = form.parentNode) {\n\t\t\t\t\t\tif (form.tagName == 'FORM') {\n\t\t\t\t\t\t\tme.form = form;\n\t\t\t\t\t\t\tif (me.options.autoSyncData) {\n\t\t\t\t\t\t\t\tdomUtils.on(me.window, 'blur', function() {\n\t\t\t\t\t\t\t\t\tsetValue(form, me);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.on(form, 'submit', function() {\n\t\t\t\t\t\t\t\t\tsetValue(this, me);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (options.initialContent) {\n\t\t\t\t\t\tif (options.autoClearinitialContent) {\n\t\t\t\t\t\t\tvar oldExecCommand = me.execCommand;\n\t\t\t\t\t\t\tme.execCommand = function() {\n\t\t\t\t\t\t\t\tme.fireEvent('firstBeforeExecCommand');\n\t\t\t\t\t\t\t\treturn oldExecCommand.apply(me, arguments);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tthis._setDefaultContent(options.initialContent);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tthis.setContent(options.initialContent, false, true);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//编辑器不能为空内容\n\t\n\t\t\t\t\tif (domUtils.isEmptyNode(me.body)) {\n\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t}\n\t\t\t\t\t//如果要求focus, 就把光标定位到内容开始\n\t\t\t\t\tif (options.focus) {\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tme.focus(me.options.focusInEnd);\n\t\t\t\t\t\t\t//如果自动清除开着，就不需要做selectionchange;\n\t\t\t\t\t\t\t!me.options.autoClearinitialContent && me._selectionChange();\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t}\n\t\t\t\t\tif (!me.container) {\n\t\t\t\t\t\tme.container = this.iframe.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (options.fullscreen && me.ui) {\n\t\t\t\t\t\tme.ui.setFullScreen(true);\n\t\t\t\t\t}\n\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tme.document.execCommand('2D-position', false, false);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tme.document.execCommand('enableInlineTableEditing', false, false);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tme.document.execCommand('enableObjectResizing', false, false);\n\t\t\t\t\t} catch (e) {}\n\t\n\t\t\t\t\t//挂接快捷键\n\t\t\t\t\tme._bindshortcutKeys();\n\t\t\t\t\tme.isReady = 1;\n\t\t\t\t\tme.fireEvent('ready');\n\t\t\t\t\toptions.onready && options.onready.call(me);\n\t\t\t\t\tif (!browser.ie9below) {\n\t\t\t\t\t\tdomUtils.on(me.window, ['blur', 'focus'], function(e) {\n\t\t\t\t\t\t\t//chrome下会出现alt+tab切换时，导致选区位置不对\n\t\t\t\t\t\t\tif (e.type == 'blur') {\n\t\t\t\t\t\t\t\tme._bakRange = me.selection.getRange();\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tme._bakNativeRange = me.selection.getNative().getRangeAt(0);\n\t\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tme._bakNativeRange = null;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tme._bakRange && me._bakRange.select();\n\t\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\t//trace:1518 ff3.6body不够寛，会导致点击空白处无法获得焦点\n\t\t\t\t\tif (browser.gecko && browser.version <= 10902) {\n\t\t\t\t\t\t//修复ff3.6初始化进来，不能点击获得焦点\n\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\tsetInterval(function() {\n\t\t\t\t\t\t\tme.body.style.height = me.iframe.offsetHeight - 20 + 'px'\n\t\t\t\t\t\t}, 100)\n\t\t\t\t\t}\n\t\n\t\t\t\t\t!options.isShow && me.setHide();\n\t\t\t\t\toptions.readonly && me.setDisabled();\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 同步数据到编辑器所在的form\n\t\t\t\t * 从编辑器的容器节点向上查找form元素，若找到，就同步编辑内容到找到的form里，为提交数据做准备，主要用于是手动提交的情况\n\t\t\t\t * 后台取得数据的键值，使用你容器上的name属性，如果没有就使用参数里的textarea项\n\t\t\t\t * @method sync\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.sync();\n\t\t\t\t * form.sumbit(); //form变量已经指向了form元素\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据传入的formId，在页面上查找要同步数据的表单，若找到，就同步编辑内容到找到的form里，为提交数据做准备\n\t\t\t\t * 后台取得数据的键值，该键值默认使用给定的编辑器容器的name属性，如果没有name属性则使用参数项里给定的“textarea”项\n\t\t\t\t * @method sync\n\t\t\t\t * @param { String } formID 指定一个要同步数据的form的id,编辑器的数据会同步到你指定form下\n\t\t\t\t */\n\t\t\t\tsync: function(formId) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tform = formId ? document.getElementById(formId) :\n\t\t\t\t\t\tdomUtils.findParent(me.iframe.parentNode, function(node) {\n\t\t\t\t\t\t\treturn node.tagName == 'FORM'\n\t\t\t\t\t\t}, true);\n\t\t\t\t\tform && setValue(form, me);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置编辑器高度\n\t\t\t\t * @method setHeight\n\t\t\t\t * @remind 当配置项autoHeightEnabled为真时,该方法无效\n\t\t\t\t * @param { Number } number 设置的高度值，纯数值，不带单位\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setHeight(number);\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetHeight: function(height, notSetHeight) {\n\t\t\t\t\tif (height !== parseInt(this.iframe.parentNode.style.height)) {\n\t\t\t\t\t\tthis.iframe.parentNode.style.height = height + 'px';\n\t\t\t\t\t}!notSetHeight && (this.options.minFrameHeight = this.options.initialFrameHeight = height);\n\t\t\t\t\tthis.body.style.height = height + 'px';\n\t\t\t\t\t!notSetHeight && this.trigger('setHeight')\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 为编辑器的编辑命令提供快捷键\n\t\t\t\t * 这个接口是为插件扩展提供的接口,主要是为新添加的插件，如果需要添加快捷键，所提供的接口\n\t\t\t\t * @method addshortcutkey\n\t\t\t\t * @param { Object } keyset 命令名和快捷键键值对对象，多个按钮的快捷键用“＋”分隔\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.addshortcutkey({\n\t\t\t\t *     \"Bold\" : \"ctrl+66\",//^B\n\t\t\t\t *     \"Italic\" : \"ctrl+73\", //^I\n\t\t\t\t * });\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 这个接口是为插件扩展提供的接口,主要是为新添加的插件，如果需要添加快捷键，所提供的接口\n\t\t\t\t * @method addshortcutkey\n\t\t\t\t * @param { String } cmd 触发快捷键时，响应的命令\n\t\t\t\t * @param { String } keys 快捷键的字符串，多个按钮用“＋”分隔\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.addshortcutkey(\"Underline\", \"ctrl+85\"); //^U\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\taddshortcutkey: function(cmd, keys) {\n\t\t\t\t\tvar obj = {};\n\t\t\t\t\tif (keys) {\n\t\t\t\t\t\tobj[cmd] = keys\n\t\t\t\t\t} else {\n\t\t\t\t\t\tobj = cmd;\n\t\t\t\t\t}\n\t\t\t\t\tutils.extend(this.shortcutkeys, obj)\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 对编辑器设置keydown事件监听，绑定快捷键和命令，当快捷键组合触发成功，会响应对应的命令\n\t\t\t\t * @method _bindshortcutKeys\n\t\t\t\t * @private\n\t\t\t\t */\n\t\t\t\t_bindshortcutKeys: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tshortcutkeys = this.shortcutkeys;\n\t\t\t\t\tme.addListener('keydown', function(type, e) {\n\t\t\t\t\t\tvar keyCode = e.keyCode || e.which;\n\t\t\t\t\t\tfor (var i in shortcutkeys) {\n\t\t\t\t\t\t\tvar tmp = shortcutkeys[i].split(',');\n\t\t\t\t\t\t\tfor (var t = 0, ti; ti = tmp[t++];) {\n\t\t\t\t\t\t\t\tti = ti.split(':');\n\t\t\t\t\t\t\t\tvar key = ti[0],\n\t\t\t\t\t\t\t\t\tparam = ti[1];\n\t\t\t\t\t\t\t\tif (/^(ctrl)(\\+shift)?\\+(\\d+)$/.test(key.toLowerCase()) || /^(\\d+)$/.test(key)) {\n\t\t\t\t\t\t\t\t\tif (((RegExp.$1 == 'ctrl' ? (e.ctrlKey || e.metaKey) : 0) && (RegExp.$2 != \"\" ? e[RegExp.$2.slice(1) + \"Key\"] : 1) && keyCode == RegExp.$3) ||\n\t\t\t\t\t\t\t\t\t\tkeyCode == RegExp.$1\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\tif (me.queryCommandState(i, param) != -1)\n\t\t\t\t\t\t\t\t\t\t\tme.execCommand(i, param);\n\t\t\t\t\t\t\t\t\t\tdomUtils.preventDefault(e);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取编辑器的内容\n\t\t\t\t * @method getContent\n\t\t\t\t * @warning 该方法获取到的是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t\t * @return { String } 编辑器的内容字符串, 如果编辑器的内容为空，或者是空的标签内容（如:”&lt;p&gt;&lt;br/&gt;&lt;/p&gt;“）， 则返回空字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //编辑器html内容:<p>1<strong>2<em>34</em>5</strong>6</p>\n\t\t\t\t * var content = editor.getContent(); //返回值:<p>1<strong>2<em>34</em>5</strong>6</p>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取编辑器的内容。 可以通过参数定义编辑器内置的判空规则\n\t\t\t\t * @method getContent\n\t\t\t\t * @param { Function } fn 自定的判空规则， 要求该方法返回一个boolean类型的值，\n\t\t\t\t *                      代表当前编辑器的内容是否空，\n\t\t\t\t *                      如果返回true， 则该方法将直接返回空字符串；如果返回false，则编辑器将返回\n\t\t\t\t *                      经过内置过滤规则处理后的内容。\n\t\t\t\t * @remind 该方法在处理包含有初始化内容的时候能起到很好的作用。\n\t\t\t\t * @warning 该方法获取到的是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t\t * @return { String } 编辑器的内容字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * // editor 是一个编辑器的实例\n\t\t\t\t * var content = editor.getContent( function ( editor ) {\n\t\t\t\t *      return editor.body.innerHTML === '欢迎使用UEditor'; //返回空字符串\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetContent: function(cmd, fn, notSetCursor, ignoreBlank, formatter) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (cmd && utils.isFunction(cmd)) {\n\t\t\t\t\t\tfn = cmd;\n\t\t\t\t\t\tcmd = '';\n\t\t\t\t\t}\n\t\t\t\t\tif (fn ? !fn() : !this.hasContents()) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('beforegetcontent');\n\t\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML, ignoreBlank);\n\t\t\t\t\tme.filterOutputRule(root);\n\t\t\t\t\tme.fireEvent('aftergetcontent', cmd, root);\n\t\t\t\t\treturn root.toHtml(formatter);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 取得完整的html代码，可以直接显示成完整的html文档\n\t\t\t\t * @method getAllHtml\n\t\t\t\t * @return { String } 编辑器的内容html文档字符串\n\t\t\t\t * @eaxmple\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.getAllHtml(); //返回格式大致是: <html><head>...</head><body>...</body></html>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetAllHtml: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\theadHtml = [],\n\t\t\t\t\t\thtml = '';\n\t\t\t\t\tme.fireEvent('getAllHtml', headHtml);\n\t\t\t\t\tif (browser.ie && browser.version > 8) {\n\t\t\t\t\t\tvar headHtmlForIE9 = '';\n\t\t\t\t\t\tutils.each(me.document.styleSheets, function(si) {\n\t\t\t\t\t\t\theadHtmlForIE9 += (si.href ? '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + si.href + '\" />' : '<style>' + si.cssText + '</style>');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tutils.each(me.document.getElementsByTagName('script'), function(si) {\n\t\t\t\t\t\t\theadHtmlForIE9 += si.outerHTML;\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t}\n\t\t\t\t\treturn '<html><head>' + (me.options.charset ? '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=' + me.options.charset + '\"/>' : '') + (headHtmlForIE9 || me.document.getElementsByTagName('head')[0].innerHTML) + headHtml.join('\\n') + '</head>' + '<body ' + (ie && browser.version < 9 ? 'class=\"view\"' : '') + '>' + me.getContent(null, null, true) + '</body></html>';\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 得到编辑器的纯文本内容，但会保留段落格式\n\t\t\t\t * @method getPlainTxt\n\t\t\t\t * @return { String } 编辑器带段落格式的纯文本内容字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //编辑器html内容:<p><strong>1</strong></p><p><strong>2</strong></p>\n\t\t\t\t * console.log(editor.getPlainTxt()); //输出:\"1\\n2\\n\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetPlainTxt: function() {\n\t\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g'),\n\t\t\t\t\t\thtml = this.body.innerHTML.replace(/[\\n\\r]/g, ''); //ie要先去了\\n在处理\n\t\t\t\t\thtml = html.replace(/<(p|div)[^>]*>(<br\\/?>|&nbsp;)<\\/\\1>/gi, '\\n')\n\t\t\t\t\t\t.replace(/<br\\/?>/gi, '\\n')\n\t\t\t\t\t\t.replace(/<[^>/]+>/g, '')\n\t\t\t\t\t\t.replace(/(\\n)?<\\/([^>]+)>/g, function(a, b, c) {\n\t\t\t\t\t\t\treturn dtd.$block[c] ? '\\n' : b ? b : '';\n\t\t\t\t\t\t});\n\t\t\t\t\t//取出来的空格会有c2a0会变成乱码，处理这种情况\\u00a0\n\t\t\t\t\treturn html.replace(reg, '').replace(/\\u00a0/g, ' ').replace(/&nbsp;/g, ' ');\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取编辑器中的纯文本内容,没有段落格式\n\t\t\t\t * @method getContentTxt\n\t\t\t\t * @return { String } 编辑器不带段落格式的纯文本内容字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //编辑器html内容:<p><strong>1</strong></p><p><strong>2</strong></p>\n\t\t\t\t * console.log(editor.getPlainTxt()); //输出:\"12\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetContentTxt: function() {\n\t\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\t\t\t//取出来的空格会有c2a0会变成乱码，处理这种情况\\u00a0\n\t\t\t\t\treturn this.body[browser.ie ? 'innerText' : 'textContent'].replace(reg, '').replace(/\\u00a0/g, ' ');\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置编辑器的内容，可修改编辑器当前的html内容\n\t\t\t\t * @method setContent\n\t\t\t\t * @warning 通过该方法插入的内容，是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t\t * @warning 该方法会触发selectionchange事件\n\t\t\t\t * @param { String } html 要插入的html内容\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.getContent('<p>test</p>');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置编辑器的内容，可修改编辑器当前的html内容\n\t\t\t\t * @method setContent\n\t\t\t\t * @warning 通过该方法插入的内容，是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t\t * @warning 该方法会触发selectionchange事件\n\t\t\t\t * @param { String } html 要插入的html内容\n\t\t\t\t * @param { Boolean } isAppendTo 若传入true，不清空原来的内容，在最后插入内容，否则，清空内容再插入\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //假设设置前的编辑器内容是 <p>old text</p>\n\t\t\t\t * editor.setContent('<p>new text</p>', true); //插入的结果是<p>old text</p><p>new text</p>\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetContent: function(html, isAppendTo, notFireSelectionchange) {\n\t\t\t\t\tvar me = this;\n\t\n\t\t\t\t\tme.fireEvent('beforesetcontent', html);\n\t\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t\tme.filterInputRule(root);\n\t\t\t\t\thtml = root.toHtml();\n\t\n\t\t\t\t\tme.body.innerHTML = (isAppendTo ? me.body.innerHTML : '') + html;\n\t\n\t\t\t\t\tfunction isCdataDiv(node) {\n\t\t\t\t\t\treturn node.tagName == 'DIV' && node.getAttribute('cdata_tag');\n\t\t\t\t\t}\n\t\t\t\t\t//给文本或者inline节点套p标签\n\t\t\t\t\tif (me.options.enterTag == 'p') {\n\t\n\t\t\t\t\t\tvar child = this.body.firstChild,\n\t\t\t\t\t\t\ttmpNode;\n\t\t\t\t\t\tif (!child || child.nodeType == 1 &&\n\t\t\t\t\t\t\t(dtd.$cdata[child.tagName] || isCdataDiv(child) ||\n\t\t\t\t\t\t\t\tdomUtils.isCustomeNode(child)\n\t\t\t\t\t\t\t) && child === this.body.lastChild) {\n\t\t\t\t\t\t\tthis.body.innerHTML = '<p>' + (browser.ie ? '&nbsp;' : '<br/>') + '</p>' + this.body.innerHTML;\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\twhile (child) {\n\t\t\t\t\t\t\t\twhile (child && (child.nodeType == 3 || child.nodeType == 1 && dtd.p[child.tagName] && !dtd.$cdata[child.tagName])) {\n\t\t\t\t\t\t\t\t\ttmpNode = child.nextSibling;\n\t\t\t\t\t\t\t\t\tp.appendChild(child);\n\t\t\t\t\t\t\t\t\tchild = tmpNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (p.firstChild) {\n\t\t\t\t\t\t\t\t\tif (!child) {\n\t\t\t\t\t\t\t\t\t\tme.body.appendChild(p);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tchild.parentNode.insertBefore(p, child);\n\t\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('aftersetcontent');\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\n\t\t\t\t\t!notFireSelectionchange && me._selectionChange();\n\t\t\t\t\t//清除保存的选区\n\t\t\t\t\tme._bakRange = me._bakIERange = me._bakNativeRange = null;\n\t\t\t\t\t//trace:1742 setContent后gecko能得到焦点问题\n\t\t\t\t\tvar geckoSel;\n\t\t\t\t\tif (browser.gecko && (geckoSel = this.selection.getNative())) {\n\t\t\t\t\t\tgeckoSel.removeAllRanges();\n\t\t\t\t\t}\n\t\t\t\t\tif (me.options.autoSyncData) {\n\t\t\t\t\t\tme.form && setValue(me.form, me);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 让编辑器获得焦点，默认focus到编辑器头部\n\t\t\t\t * @method focus\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.focus()\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 让编辑器获得焦点，toEnd确定focus位置\n\t\t\t\t * @method focus\n\t\t\t\t * @param { Boolean } toEnd 默认focus到编辑器头部，toEnd为true时focus到内容尾部\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.focus(true)\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tfocus: function(toEnd) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\t\tif (toEnd) {\n\t\t\t\t\t\t\tvar node = me.body.lastChild;\n\t\t\t\t\t\t\tif (node && node.nodeType == 1 && !dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\t\t\t\t\t\trng.setStartAtFirst(node)\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng.setStartAtLast(node)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trng.collapse(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.setCursor(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!rng.collapsed && domUtils.isBody(rng.startContainer) && rng.startOffset == 0) {\n\t\n\t\t\t\t\t\t\t\tvar node = me.body.firstChild;\n\t\t\t\t\t\t\t\tif (node && node.nodeType == 1 && !dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\trng.setStartAtFirst(node).collapse(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\trng.select(true);\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.fireEvent('focus selectionchange');\n\t\t\t\t\t} catch (e) {}\n\t\n\t\t\t\t},\n\t\t\t\tisFocus: function() {\n\t\t\t\t\treturn this.selection.isFocus();\n\t\t\t\t},\n\t\t\t\tblur: function() {\n\t\t\t\t\tvar sel = this.selection.getNative();\n\t\t\t\t\tif (sel.empty && browser.ie) {\n\t\t\t\t\t\tvar nativeRng = document.body.createTextRange();\n\t\t\t\t\t\tnativeRng.moveToElementText(document.body);\n\t\t\t\t\t\tnativeRng.collapse(true);\n\t\t\t\t\t\tnativeRng.select();\n\t\t\t\t\t\tsel.empty()\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsel.removeAllRanges()\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//this.fireEvent('blur selectionchange');\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 初始化UE事件及部分事件代理\n\t\t\t\t * @method _initEvents\n\t\t\t\t * @private\n\t\t\t\t */\n\t\t\t\t_initEvents: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tdoc = me.document,\n\t\t\t\t\t\twin = me.window;\n\t\t\t\t\tme._proxyDomEvent = utils.bind(me._proxyDomEvent, me);\n\t\t\t\t\tdomUtils.on(doc, ['click', 'contextmenu', 'mousedown', 'keydown', 'keyup', 'keypress', 'mouseup', 'mouseover', 'mouseout', 'selectstart'], me._proxyDomEvent);\n\t\t\t\t\tdomUtils.on(win, ['focus', 'blur'], me._proxyDomEvent);\n\t\t\t\t\tdomUtils.on(me.body, 'drop', function(e) {\n\t\t\t\t\t\t//阻止ff下默认的弹出新页面打开图片\n\t\t\t\t\t\tif (browser.gecko && e.stopPropagation) {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('contentchange')\n\t\t\t\t\t});\n\t\t\t\t\tdomUtils.on(doc, ['mouseup', 'keydown'], function(evt) {\n\t\t\t\t\t\t//特殊键不触发selectionchange\n\t\t\t\t\t\tif (evt.type == 'keydown' && (evt.ctrlKey || evt.metaKey || evt.shiftKey || evt.altKey)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (evt.button == 2) return;\n\t\t\t\t\t\tme._selectionChange(250, evt);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 触发事件代理\n\t\t\t\t * @method _proxyDomEvent\n\t\t\t\t * @private\n\t\t\t\t * @return { * } fireEvent的返回值\n\t\t\t\t * @see UE.EventBase:fireEvent(String)\n\t\t\t\t */\n\t\t\t\t_proxyDomEvent: function(evt) {\n\t\t\t\t\tif (this.fireEvent('before' + evt.type.replace(/^on/, '').toLowerCase()) === false) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.fireEvent(evt.type.replace(/^on/, ''), evt) === false) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.fireEvent('after' + evt.type.replace(/^on/, '').toLowerCase())\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 变化选区\n\t\t\t\t * @method _selectionChange\n\t\t\t\t * @private\n\t\t\t\t */\n\t\t\t\t_selectionChange: function(delay, evt) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\t//有光标才做selectionchange 为了解决未focus时点击source不能触发更改工具栏状态的问题（source命令notNeedUndo=1）\n\t\t\t\t\t//            if ( !me.selection.isFocus() ){\n\t\t\t\t\t//                return;\n\t\t\t\t\t//            }\n\t\n\t\t\t\t\tvar hackForMouseUp = false;\n\t\t\t\t\tvar mouseX, mouseY;\n\t\t\t\t\tif (browser.ie && browser.version < 9 && evt && evt.type == 'mouseup') {\n\t\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\thackForMouseUp = true;\n\t\t\t\t\t\t\tmouseX = evt.clientX;\n\t\t\t\t\t\t\tmouseY = evt.clientY;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tclearTimeout(_selectionChangeTimer);\n\t\t\t\t\t_selectionChangeTimer = setTimeout(function() {\n\t\t\t\t\t\tif (!me.selection || !me.selection.getNative()) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//修复一个IE下的bug: 鼠标点击一段已选择的文本中间时，可能在mouseup后的一段时间内取到的range是在selection的type为None下的错误值.\n\t\t\t\t\t\t//IE下如果用户是拖拽一段已选择文本，则不会触发mouseup事件，所以这里的特殊处理不会对其有影响\n\t\t\t\t\t\tvar ieRange;\n\t\t\t\t\t\tif (hackForMouseUp && me.selection.getNative().type == 'None') {\n\t\t\t\t\t\t\tieRange = me.document.body.createTextRange();\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tieRange.moveToPoint(mouseX, mouseY);\n\t\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\t\tieRange = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar bakGetIERange;\n\t\t\t\t\t\tif (ieRange) {\n\t\t\t\t\t\t\tbakGetIERange = me.selection.getIERange;\n\t\t\t\t\t\t\tme.selection.getIERange = function() {\n\t\t\t\t\t\t\t\treturn ieRange;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.selection.cache();\n\t\t\t\t\t\tif (bakGetIERange) {\n\t\t\t\t\t\t\tme.selection.getIERange = bakGetIERange;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (me.selection._cachedRange && me.selection._cachedStartElement) {\n\t\t\t\t\t\t\tme.fireEvent('beforeselectionchange');\n\t\t\t\t\t\t\t// 第二个参数causeByUi为true代表由用户交互造成的selectionchange.\n\t\t\t\t\t\t\tme.fireEvent('selectionchange', !!evt);\n\t\t\t\t\t\t\tme.fireEvent('afterselectionchange');\n\t\t\t\t\t\t\tme.selection.clear();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, delay || 50);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 执行编辑命令\n\t\t\t\t * @method _callCmdFn\n\t\t\t\t * @private\n\t\t\t\t * @param { String } fnName 函数名称\n\t\t\t\t * @param { * } args 传给命令函数的参数\n\t\t\t\t * @return { * } 返回命令函数运行的返回值\n\t\t\t\t */\n\t\t\t\t_callCmdFn: function(fnName, args) {\n\t\t\t\t\tvar cmdName = args[0].toLowerCase(),\n\t\t\t\t\t\tcmd, cmdFn;\n\t\t\t\t\tcmd = this.commands[cmdName] || UE.commands[cmdName];\n\t\t\t\t\tcmdFn = cmd && cmd[fnName];\n\t\t\t\t\t//没有querycommandstate或者没有command的都默认返回0\n\t\t\t\t\tif ((!cmd || !cmdFn) && fnName == 'queryCommandState') {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t} else if (cmdFn) {\n\t\t\t\t\t\treturn cmdFn.apply(this, args);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 执行编辑命令cmdName，完成富文本编辑效果\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmdName 需要执行的命令\n\t\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t\t * @return { * } 返回命令函数运行的返回值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand(cmdName);\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\texecCommand: function(cmdName) {\n\t\t\t\t\tcmdName = cmdName.toLowerCase();\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tresult,\n\t\t\t\t\t\tcmd = me.commands[cmdName] || UE.commands[cmdName];\n\t\t\t\t\tif (!cmd || !cmd.execCommand) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tif (!cmd.notNeedUndo && !me.__hasEnterExecCommand) {\n\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\tif (me.queryCommandState.apply(me, arguments) != -1) {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tme.fireEvent.apply(me, ['beforeexeccommand', cmdName].concat(arguments));\n\t\t\t\t\t\t\tresult = this._callCmdFn('execCommand', arguments);\n\t\t\t\t\t\t\t//保存场景时，做了内容对比，再看是否进行contentchange触发，这里多触发了一次，去掉\n\t\t\t\t\t\t\t//                    (!cmd.ignoreContentChange && !me._ignoreContentChange) && me.fireEvent('contentchange');\n\t\t\t\t\t\t\tme.fireEvent.apply(me, ['afterexeccommand', cmdName].concat(arguments));\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = this._callCmdFn('execCommand', arguments);\n\t\t\t\t\t\t(!me.__hasEnterExecCommand && !cmd.ignoreContentChange && !me._ignoreContentChange) && me.fireEvent('contentchange')\n\t\t\t\t\t}\n\t\t\t\t\t(!me.__hasEnterExecCommand && !cmd.ignoreContentChange && !me._ignoreContentChange) && me._selectionChange();\n\t\t\t\t\treturn result;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据传入的command命令，查选编辑器当前的选区，返回命令的状态\n\t\t\t\t * @method  queryCommandState\n\t\t\t\t * @param { String } cmdName 需要查询的命令名称\n\t\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t\t * @return { Number } number 返回放前命令的状态，返回值三种情况：(-1|0|1)\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.queryCommandState(cmdName)  => (-1|0|1)\n\t\t\t\t * ```\n\t\t\t\t * @see COMMAND.LIST\n\t\t\t\t */\n\t\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\t\treturn this._callCmdFn('queryCommandState', arguments);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据传入的command命令，查选编辑器当前的选区，根据命令返回相关的值\n\t\t\t\t * @method queryCommandValue\n\t\t\t\t * @param { String } cmdName 需要查询的命令名称\n\t\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t\t * @remind 只有部分插件有此方法\n\t\t\t\t * @return { * } 返回每个命令特定的当前状态值\n\t\t\t\t * @grammar editor.queryCommandValue(cmdName)  =>  {*}\n\t\t\t\t * @see COMMAND.LIST\n\t\t\t\t */\n\t\t\t\tqueryCommandValue: function(cmdName) {\n\t\t\t\t\treturn this._callCmdFn('queryCommandValue', arguments);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 检查编辑区域中是否有内容\n\t\t\t\t * @method  hasContents\n\t\t\t\t * @remind 默认有文本内容，或者有以下节点都不认为是空\n\t\t\t\t * table,ul,ol,dl,iframe,area,base,col,hr,img,embed,input,link,meta,param\n\t\t\t\t * @return { Boolean } 检查有内容返回true，否则返回false\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.hasContents()\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 检查编辑区域中是否有内容，若包含参数tags中的节点类型，直接返回true\n\t\t\t\t * @method  hasContents\n\t\t\t\t * @param { Array } tags 传入数组判断时用到的节点类型\n\t\t\t\t * @return { Boolean } 若文档中包含tags数组里对应的tag，返回true，否则返回false\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.hasContents(['span']);\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\thasContents: function(tags) {\n\t\t\t\t\tif (tags) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = tags[i++];) {\n\t\t\t\t\t\t\tif (this.document.getElementsByTagName(ci).length > 0) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!domUtils.isEmptyBlock(this.body)) {\n\t\t\t\t\t\treturn true\n\t\t\t\t\t}\n\t\t\t\t\t//随时添加,定义的特殊标签如果存在，不能认为是空\n\t\t\t\t\ttags = ['div'];\n\t\t\t\t\tfor (i = 0; ci = tags[i++];) {\n\t\t\t\t\t\tvar nodes = domUtils.getElementsByTagName(this.document, ci);\n\t\t\t\t\t\tfor (var n = 0, cn; cn = nodes[n++];) {\n\t\t\t\t\t\t\tif (domUtils.isCustomeNode(cn)) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 重置编辑器，可用来做多个tab使用同一个编辑器实例\n\t\t\t\t * @method  reset\n\t\t\t\t * @remind 此方法会清空编辑器内容，清空回退列表，会触发reset事件\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.reset()\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\treset: function() {\n\t\t\t\t\tthis.fireEvent('reset');\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置当前编辑区域可以编辑\n\t\t\t\t * @method setEnabled\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setEnabled()\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetEnabled: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trange;\n\t\t\t\t\tif (me.body.contentEditable == 'false') {\n\t\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\t//有可能内容丢失了\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\trange.moveToBookmark(me.lastBk);\n\t\t\t\t\t\t\tdelete me.lastBk\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\trange.setStartAtFirst(me.body).collapse(true)\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.select(true);\n\t\t\t\t\t\tif (me.bkqueryCommandState) {\n\t\t\t\t\t\t\tme.queryCommandState = me.bkqueryCommandState;\n\t\t\t\t\t\t\tdelete me.bkqueryCommandState;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (me.bkqueryCommandValue) {\n\t\t\t\t\t\t\tme.queryCommandValue = me.bkqueryCommandValue;\n\t\t\t\t\t\t\tdelete me.bkqueryCommandValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('selectionchange');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tenable: function() {\n\t\t\t\t\treturn this.setEnabled();\n\t\t\t\t},\n\t\n\t\t\t\t/** 设置当前编辑区域不可编辑\n\t\t\t\t * @method setDisabled\n\t\t\t\t */\n\t\n\t\t\t\t/** 设置当前编辑区域不可编辑,except中的命令除外\n\t\t\t\t * @method setDisabled\n\t\t\t\t * @param { String } except 例外命令的字符串\n\t\t\t\t * @remind 即使设置了disable，此处配置的例外命令仍然可以执行\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setDisabled('bold'); //禁用工具栏中除加粗之外的所有功能\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/** 设置当前编辑区域不可编辑,except中的命令除外\n\t\t\t\t * @method setDisabled\n\t\t\t\t * @param { Array } except 例外命令的字符串数组，数组中的命令仍然可以执行\n\t\t\t\t * @remind 即使设置了disable，此处配置的例外命令仍然可以执行\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setDisabled(['bold','insertimage']); //禁用工具栏中除加粗和插入图片之外的所有功能\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetDisabled: function(except) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\texcept = except ? utils.isArray(except) ? except : [except] : [];\n\t\t\t\t\tif (me.body.contentEditable == 'true') {\n\t\t\t\t\t\tif (!me.lastBk) {\n\t\t\t\t\t\t\tme.lastBk = me.selection.getRange().createBookmark(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\tme.bkqueryCommandState = me.queryCommandState;\n\t\t\t\t\t\tme.bkqueryCommandValue = me.queryCommandValue;\n\t\t\t\t\t\tme.queryCommandState = function(type) {\n\t\t\t\t\t\t\tif (utils.indexOf(except, type) != -1) {\n\t\t\t\t\t\t\t\treturn me.bkqueryCommandState.apply(me, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tme.queryCommandValue = function(type) {\n\t\t\t\t\t\t\tif (utils.indexOf(except, type) != -1) {\n\t\t\t\t\t\t\t\treturn me.bkqueryCommandValue.apply(me, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tme.fireEvent('selectionchange');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdisable: function(except) {\n\t\t\t\t\treturn this.setDisabled(except);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置默认内容\n\t\t\t\t * @method _setDefaultContent\n\t\t\t\t * @private\n\t\t\t\t * @param  { String } cont 要存入的内容\n\t\t\t\t */\n\t\t\t\t_setDefaultContent: function() {\n\t\t\t\t\tfunction clear() {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tif (me.document.getElementById('initContent')) {\n\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\tme.removeListener('firstBeforeExecCommand focus', clear);\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tme.focus();\n\t\t\t\t\t\t\t\tme._selectionChange();\n\t\t\t\t\t\t\t}, 0)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn function(cont) {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tme.body.innerHTML = '<p id=\"initContent\">' + cont + '</p>';\n\t\n\t\t\t\t\t\tme.addListener('firstBeforeExecCommand focus', clear);\n\t\t\t\t\t}\n\t\t\t\t}(),\n\t\n\t\t\t\t/**\n\t\t\t\t * 显示编辑器\n\t\t\t\t * @method setShow\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setShow()\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetShow: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (me.container.style.display == 'none') {\n\t\t\t\t\t\t//有可能内容丢失了\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\trange.moveToBookmark(me.lastBk);\n\t\t\t\t\t\t\tdelete me.lastBk\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\trange.setStartAtFirst(me.body).collapse(true)\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//ie下focus实效，所以做了个延迟\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\trange.select(true);\n\t\t\t\t\t\t}, 100);\n\t\t\t\t\t\tme.container.style.display = '';\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\tshow: function() {\n\t\t\t\t\treturn this.setShow();\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 隐藏编辑器\n\t\t\t\t * @method setHide\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.setHide()\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetHide: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (!me.lastBk) {\n\t\t\t\t\t\tme.lastBk = me.selection.getRange().createBookmark(true);\n\t\t\t\t\t}\n\t\t\t\t\tme.container.style.display = 'none'\n\t\t\t\t},\n\t\t\t\thide: function() {\n\t\t\t\t\treturn this.setHide();\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据指定的路径，获取对应的语言资源\n\t\t\t\t * @method getLang\n\t\t\t\t * @param { String } path 路径根据的是lang目录下的语言文件的路径结构\n\t\t\t\t * @return { Object | String } 根据路径返回语言资源的Json格式对象或者语言字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.getLang('contextMenu.delete'); //如果当前是中文，那返回是的是'删除'\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetLang: function(path) {\n\t\t\t\t\tvar lang = UE.I18N[this.options.lang];\n\t\t\t\t\tif (!lang) {\n\t\t\t\t\t\tthrow Error(\"not import language file\");\n\t\t\t\t\t}\n\t\t\t\t\tpath = (path || \"\").split(\".\");\n\t\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\t\tlang = lang[ci];\n\t\t\t\t\t\tif (!lang) break;\n\t\t\t\t\t}\n\t\t\t\t\treturn lang;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 计算编辑器html内容字符串的长度\n\t\t\t\t * @method  getContentLength\n\t\t\t\t * @return { Number } 返回计算的长度\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //编辑器html内容<p><strong>132</strong></p>\n\t\t\t\t * editor.getContentLength() //返回27\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 计算编辑器当前纯文本内容的长度\n\t\t\t\t * @method  getContentLength\n\t\t\t\t * @param { Boolean } ingoneHtml 传入true时，只按照纯文本来计算\n\t\t\t\t * @return { Number } 返回计算的长度，内容中有hr/img/iframe标签，长度加1\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //编辑器html内容<p><strong>132</strong></p>\n\t\t\t\t * editor.getContentLength() //返回3\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetContentLength: function(ingoneHtml, tagNames) {\n\t\t\t\t\tvar count = this.getContent(false, false, true).length;\n\t\t\t\t\tif (ingoneHtml) {\n\t\t\t\t\t\ttagNames = (tagNames || []).concat(['hr', 'img', 'iframe']);\n\t\t\t\t\t\tcount = this.getContentTxt().replace(/[\\t\\r\\n]+/g, '').length;\n\t\t\t\t\t\tfor (var i = 0, ci; ci = tagNames[i++];) {\n\t\t\t\t\t\t\tcount += this.document.getElementsByTagName(ci).length;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn count;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 注册输入过滤规则\n\t\t\t\t * @method  addInputRule\n\t\t\t\t * @param { Function } rule 要添加的过滤规则\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.addInputRule(function(root){\n\t\t\t\t *   $.each(root.getNodesByTagName('div'),function(i,node){\n\t\t\t\t *       node.tagName=\"p\";\n\t\t\t\t *   });\n\t\t\t\t * });\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\taddInputRule: function(rule) {\n\t\t\t\t\tthis.inputRules.push(rule);\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 执行注册的过滤规则\n\t\t\t\t * @method  filterInputRule\n\t\t\t\t * @param { UE.uNode } root 要过滤的uNode节点\n\t\t\t\t * @remind 执行editor.setContent方法和执行'inserthtml'命令后，会运行该过滤函数\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.filterInputRule(editor.body);\n\t\t\t\t * ```\n\t\t\t\t * @see UE.Editor:addInputRule\n\t\t\t\t */\n\t\t\t\tfilterInputRule: function(root) {\n\t\t\t\t\tfor (var i = 0, ci; ci = this.inputRules[i++];) {\n\t\t\t\t\t\tci.call(this, root)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 注册输出过滤规则\n\t\t\t\t * @method  addOutputRule\n\t\t\t\t * @param { Function } rule 要添加的过滤规则\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.addOutputRule(function(root){\n\t\t\t\t *   $.each(root.getNodesByTagName('p'),function(i,node){\n\t\t\t\t *       node.tagName=\"div\";\n\t\t\t\t *   });\n\t\t\t\t * });\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\taddOutputRule: function(rule) {\n\t\t\t\t\tthis.outputRules.push(rule)\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据输出过滤规则，过滤编辑器内容\n\t\t\t\t * @method  filterOutputRule\n\t\t\t\t * @remind 执行editor.getContent方法的时候，会先运行该过滤函数\n\t\t\t\t * @param { UE.uNode } root 要过滤的uNode节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.filterOutputRule(editor.body);\n\t\t\t\t * ```\n\t\t\t\t * @see UE.Editor:addOutputRule\n\t\t\t\t */\n\t\t\t\tfilterOutputRule: function(root) {\n\t\t\t\t\tfor (var i = 0, ci; ci = this.outputRules[i++];) {\n\t\t\t\t\t\tci.call(this, root)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据action名称获取请求的路径\n\t\t\t\t * @method  getActionUrl\n\t\t\t\t * @remind 假如没有设置serverUrl,会根据imageUrl设置默认的controller路径\n\t\t\t\t * @param { String } action action名称\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.getActionUrl('config'); //返回 \"/ueditor/php/controller.php?action=config\"\n\t\t\t\t * editor.getActionUrl('image'); //返回 \"/ueditor/php/controller.php?action=uplaodimage\"\n\t\t\t\t * editor.getActionUrl('scrawl'); //返回 \"/ueditor/php/controller.php?action=uplaodscrawl\"\n\t\t\t\t * editor.getActionUrl('imageManager'); //返回 \"/ueditor/php/controller.php?action=listimage\"\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetActionUrl: function(action) {\n\t\t\t\t\tvar actionName = this.getOpt(action) || action,\n\t\t\t\t\t\timageUrl = this.getOpt('imageUrl'),\n\t\t\t\t\t\tserverUrl = this.getOpt('serverUrl');\n\t\n\t\t\t\t\tif (!serverUrl && imageUrl) {\n\t\t\t\t\t\tserverUrl = imageUrl.replace(/^(.*[\\/]).+([\\.].+)$/, '$1controller$2');\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (serverUrl) {\n\t\t\t\t\t\tserverUrl = serverUrl + (serverUrl.indexOf('?') == -1 ? '?' : '&') + 'action=' + (actionName || '');\n\t\t\t\t\t\treturn utils.formatUrl(serverUrl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Editor, EventBase);\n\t\t})();\n\t\n\t\t// core/Editor.defaultoptions.js\n\t\t//维护编辑器一下默认的不在插件中的配置项\n\t\tUE.Editor.defaultOptions = function(editor) {\n\t\n\t\t\tvar _url = editor.options.UEDITOR_HOME_URL;\n\t\t\treturn {\n\t\t\t\tisShow: true,\n\t\t\t\tinitialContent: '',\n\t\t\t\tinitialStyle: '',\n\t\t\t\tautoClearinitialContent: false,\n\t\t\t\tiframeCssUrl: _url + 'themes/iframe.css',\n\t\t\t\ttextarea: 'editorValue',\n\t\t\t\tfocus: false,\n\t\t\t\tfocusInEnd: true,\n\t\t\t\tautoClearEmptyNode: true,\n\t\t\t\tfullscreen: false,\n\t\t\t\treadonly: false,\n\t\t\t\tzIndex: 999,\n\t\t\t\timagePopup: true,\n\t\t\t\tenterTag: 'p',\n\t\t\t\tcustomDomain: false,\n\t\t\t\tlang: 'zh-cn',\n\t\t\t\tlangPath: _url + 'lang/',\n\t\t\t\ttheme: 'default',\n\t\t\t\tthemePath: _url + 'themes/',\n\t\t\t\tallHtmlEnabled: false,\n\t\t\t\tscaleEnabled: false,\n\t\t\t\ttableNativeEditInFF: false,\n\t\t\t\tautoSyncData: true,\n\t\t\t\tfileNameFormat: '{time}{rand:6}'\n\t\t\t}\n\t\t};\n\t\n\t\t// core/loadconfig.js\n\t\t(function() {\n\t\n\t\t\tUE.Editor.prototype.loadServerConfig = function() {\n\t\t\t\tvar me = this;\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tme.options.imageUrl && me.setOpt('serverUrl', me.options.imageUrl.replace(/^(.*[\\/]).+([\\.].+)$/, '$1controller$2'));\n\t\n\t\t\t\t\t\tvar configUrl = me.getActionUrl('config'),\n\t\t\t\t\t\t\tisJsonp = utils.isCrossDomainUrl(configUrl);\n\t\t\t\t\t\t/* 发出ajax请求 */\n\t\t\t\t\t\tme._serverConfigLoaded = false;\n\t\n\t\t\t\t\t\tconfigUrl && UE.ajax.request(configUrl, {\n\t\t\t\t\t\t\t'method': 'GET',\n\t\t\t\t\t\t\t'dataType': isJsonp ? 'jsonp' : '',\n\t\t\t\t\t\t\t'onsuccess': function(r) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tvar config = isJsonp ? r : eval(\"(\" + r.responseText + \")\");\n\t\t\t\t\t\t\t\t\tutils.extend(me.options, config);\n\t\t\t\t\t\t\t\t\tme.fireEvent('serverConfigLoaded');\n\t\t\t\t\t\t\t\t\tme._serverConfigLoaded = true;\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigFormatError'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'onerror': function() {\n\t\t\t\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigHttpError'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigError'));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\tfunction showErrorMsg(msg) {\n\t\t\t\t\tconsole && console.error(msg);\n\t\t\t\t\t//me.fireEvent('showMessage', {\n\t\t\t\t\t//    'title': msg,\n\t\t\t\t\t//    'type': 'error'\n\t\t\t\t\t//});\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.Editor.prototype.isServerConfigLoaded = function() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn me._serverConfigLoaded || false;\n\t\t\t};\n\t\n\t\t\tUE.Editor.prototype.afterConfigReady = function(handler) {\n\t\t\t\tif (!handler || !utils.isFunction(handler)) return;\n\t\t\t\tvar me = this;\n\t\t\t\tvar readyHandler = function() {\n\t\t\t\t\thandler.apply(me, arguments);\n\t\t\t\t\tme.removeListener('serverConfigLoaded', readyHandler);\n\t\t\t\t};\n\t\n\t\t\t\tif (me.isServerConfigLoaded()) {\n\t\t\t\t\thandler.call(me, 'serverConfigLoaded');\n\t\t\t\t} else {\n\t\t\t\t\tme.addListener('serverConfigLoaded', readyHandler);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t})();\n\t\n\t\t// core/ajax.js\n\t\t/**\n\t\t * @file\n\t\t * @module UE.ajax\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 提供对ajax请求的支持\n\t\t * @module UE.ajax\n\t\t */\n\t\tUE.ajax = function() {\n\t\n\t\t\t//创建一个ajaxRequest对象\n\t\t\tvar fnStr = 'XMLHttpRequest()';\n\t\t\ttry {\n\t\t\t\tnew ActiveXObject(\"Msxml2.XMLHTTP\");\n\t\t\t\tfnStr = 'ActiveXObject(\\'Msxml2.XMLHTTP\\')';\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\tnew ActiveXObject(\"Microsoft.XMLHTTP\");\n\t\t\t\t\tfnStr = 'ActiveXObject(\\'Microsoft.XMLHTTP\\')'\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\t\t\tvar creatAjaxRequest = new Function('return new ' + fnStr);\n\t\n\t\t\t/**\n\t\t\t * 将json参数转化成适合ajax提交的参数列表\n\t\t\t * @param json\n\t\t\t */\n\t\t\tfunction json2str(json) {\n\t\t\t\tvar strArr = [];\n\t\t\t\tfor (var i in json) {\n\t\t\t\t\t//忽略默认的几个参数\n\t\t\t\t\tif (i == \"method\" || i == \"timeout\" || i == \"async\" || i == \"dataType\" || i == \"callback\") continue;\n\t\t\t\t\t//忽略控制\n\t\t\t\t\tif (json[i] == undefined || json[i] == null) continue;\n\t\t\t\t\t//传递过来的对象和函数不在提交之列\n\t\t\t\t\tif (!((typeof json[i]).toLowerCase() == \"function\" || (typeof json[i]).toLowerCase() == \"object\")) {\n\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"=\" + encodeURIComponent(json[i]));\n\t\t\t\t\t} else if (utils.isArray(json[i])) {\n\t\t\t\t\t\t//支持传数组内容\n\t\t\t\t\t\tfor (var j = 0; j < json[i].length; j++) {\n\t\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"[]=\" + encodeURIComponent(json[i][j]));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn strArr.join(\"&\");\n\t\t\t}\n\t\n\t\t\tfunction doAjax(url, ajaxOptions) {\n\t\t\t\tvar xhr = creatAjaxRequest(),\n\t\t\t\t\t//是否超时\n\t\t\t\t\ttimeIsOut = false,\n\t\t\t\t\t//默认参数\n\t\t\t\t\tdefaultAjaxOptions = {\n\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\ttimeout: 5000,\n\t\t\t\t\t\tasync: true,\n\t\t\t\t\t\tdata: {}, //需要传递对象的话只能覆盖\n\t\t\t\t\t\tonsuccess: function() {},\n\t\t\t\t\t\tonerror: function() {}\n\t\t\t\t\t};\n\t\n\t\t\t\tif (typeof url === \"object\") {\n\t\t\t\t\tajaxOptions = url;\n\t\t\t\t\turl = ajaxOptions.url;\n\t\t\t\t}\n\t\t\t\tif (!xhr || !url) return;\n\t\t\t\tvar ajaxOpts = ajaxOptions ? utils.extend(defaultAjaxOptions, ajaxOptions) : defaultAjaxOptions;\n\t\n\t\t\t\tvar submitStr = json2str(ajaxOpts); // { name:\"Jim\",city:\"Beijing\" } --> \"name=Jim&city=Beijing\"\n\t\t\t\t//如果用户直接通过data参数传递json对象过来，则也要将此json对象转化为字符串\n\t\t\t\tif (!utils.isEmptyObject(ajaxOpts.data)) {\n\t\t\t\t\tsubmitStr += (submitStr ? \"&\" : \"\") + json2str(ajaxOpts.data);\n\t\t\t\t}\n\t\t\t\t//超时检测\n\t\t\t\tvar timerID = setTimeout(function() {\n\t\t\t\t\tif (xhr.readyState != 4) {\n\t\t\t\t\t\ttimeIsOut = true;\n\t\t\t\t\t\txhr.abort();\n\t\t\t\t\t\tclearTimeout(timerID);\n\t\t\t\t\t}\n\t\t\t\t}, ajaxOpts.timeout);\n\t\n\t\t\t\tvar method = ajaxOpts.method.toUpperCase();\n\t\t\t\tvar str = url + (url.indexOf(\"?\") == -1 ? \"?\" : \"&\") + (method == \"POST\" ? \"\" : submitStr + \"&noCache=\" + +new Date);\n\t\t\t\txhr.open(method, str, ajaxOpts.async);\n\t\t\t\txhr.onreadystatechange = function() {\n\t\t\t\t\tif (xhr.readyState == 4) {\n\t\t\t\t\t\tif (!timeIsOut && xhr.status == 200) {\n\t\t\t\t\t\t\tajaxOpts.onsuccess(xhr);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tajaxOpts.onerror(xhr);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tif (method == \"POST\") {\n\t\t\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\t\t\t\t\txhr.send(submitStr);\n\t\t\t\t} else {\n\t\t\t\t\txhr.send(null);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction doJsonp(url, opts) {\n\t\n\t\t\t\tvar successhandler = opts.onsuccess || function() {},\n\t\t\t\t\tscr = document.createElement('SCRIPT'),\n\t\t\t\t\toptions = opts || {},\n\t\t\t\t\tcharset = options['charset'],\n\t\t\t\t\tcallbackField = options['jsonp'] || 'callback',\n\t\t\t\t\tcallbackFnName,\n\t\t\t\t\ttimeOut = options['timeOut'] || 0,\n\t\t\t\t\ttimer,\n\t\t\t\t\treg = new RegExp('(\\\\?|&)' + callbackField + '=([^&]*)'),\n\t\t\t\t\tmatches;\n\t\n\t\t\t\tif (utils.isFunction(successhandler)) {\n\t\t\t\t\tcallbackFnName = 'bd__editor__' + Math.floor(Math.random() * 2147483648).toString(36);\n\t\t\t\t\twindow[callbackFnName] = getCallBack(0);\n\t\t\t\t} else if (utils.isString(successhandler)) {\n\t\t\t\t\tcallbackFnName = successhandler;\n\t\t\t\t} else {\n\t\t\t\t\tif (matches = reg.exec(url)) {\n\t\t\t\t\t\tcallbackFnName = matches[2];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\turl = url.replace(reg, '\\x241' + callbackField + '=' + callbackFnName);\n\t\n\t\t\t\tif (url.search(reg) < 0) {\n\t\t\t\t\turl += (url.indexOf('?') < 0 ? '?' : '&') + callbackField + '=' + callbackFnName;\n\t\t\t\t}\n\t\n\t\t\t\tvar queryStr = json2str(opts); // { name:\"Jim\",city:\"Beijing\" } --> \"name=Jim&city=Beijing\"\n\t\t\t\t//如果用户直接通过data参数传递json对象过来，则也要将此json对象转化为字符串\n\t\t\t\tif (!utils.isEmptyObject(opts.data)) {\n\t\t\t\t\tqueryStr += (queryStr ? \"&\" : \"\") + json2str(opts.data);\n\t\t\t\t}\n\t\t\t\tif (queryStr) {\n\t\t\t\t\turl = url.replace(/\\?/, '?' + queryStr + '&');\n\t\t\t\t}\n\t\n\t\t\t\tscr.onerror = getCallBack(1);\n\t\t\t\tif (timeOut) {\n\t\t\t\t\ttimer = setTimeout(getCallBack(1), timeOut);\n\t\t\t\t}\n\t\t\t\tcreateScriptTag(scr, url, charset);\n\t\n\t\t\t\tfunction createScriptTag(scr, url, charset) {\n\t\t\t\t\tscr.setAttribute('type', 'text/javascript');\n\t\t\t\t\tscr.setAttribute('defer', 'defer');\n\t\t\t\t\tcharset && scr.setAttribute('charset', charset);\n\t\t\t\t\tscr.setAttribute('src', url);\n\t\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(scr);\n\t\t\t\t}\n\t\n\t\t\t\tfunction getCallBack(onTimeOut) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (onTimeOut) {\n\t\t\t\t\t\t\t\toptions.onerror && options.onerror();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t\t\t\t\tsuccesshandler.apply(window, arguments);\n\t\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (exception) {\n\t\t\t\t\t\t\toptions.onerror && options.onerror.call(window, exception);\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\toptions.oncomplete && options.oncomplete.apply(window, arguments);\n\t\t\t\t\t\t\tscr.parentNode && scr.parentNode.removeChild(scr);\n\t\t\t\t\t\t\twindow[callbackFnName] = null;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tdelete window[callbackFnName];\n\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\t/**\n\t\t\t\t * 根据给定的参数项，向指定的url发起一个ajax请求。 ajax请求完成后，会根据请求结果调用相应回调： 如果请求\n\t\t\t\t * 成功， 则调用onsuccess回调， 失败则调用 onerror 回调\n\t\t\t\t * @method request\n\t\t\t\t * @param { URLString } url ajax请求的url地址\n\t\t\t\t * @param { Object } ajaxOptions ajax请求选项的键值对，支持的选项如下：\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //向sayhello.php发起一个异步的Ajax GET请求, 请求超时时间为10s， 请求完成后执行相应的回调。\n\t\t\t\t * UE.ajax.requeset( 'sayhello.php', {\n\t\t\t\t *\n\t\t\t\t *     //请求方法。可选值： 'GET', 'POST'，默认值是'POST'\n\t\t\t\t *     method: 'GET',\n\t\t\t\t *\n\t\t\t\t *     //超时时间。 默认为5000， 单位是ms\n\t\t\t\t *     timeout: 10000,\n\t\t\t\t *\n\t\t\t\t *     //是否是异步请求。 true为异步请求， false为同步请求\n\t\t\t\t *     async: true,\n\t\t\t\t *\n\t\t\t\t *     //请求携带的数据。如果请求为GET请求， data会经过stringify后附加到请求url之后。\n\t\t\t\t *     data: {\n\t\t\t\t *         name: 'ueditor'\n\t\t\t\t *     },\n\t\t\t\t *\n\t\t\t\t *     //请求成功后的回调， 该回调接受当前的XMLHttpRequest对象作为参数。\n\t\t\t\t *     onsuccess: function ( xhr ) {\n\t\t\t\t *         console.log( xhr.responseText );\n\t\t\t\t *     },\n\t\t\t\t *\n\t\t\t\t *     //请求失败或者超时后的回调。\n\t\t\t\t *     onerror: function ( xhr ) {\n\t\t\t\t *          alert( 'Ajax请求失败' );\n\t\t\t\t *     }\n\t\t\t\t *\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据给定的参数项发起一个ajax请求， 参数项里必须包含一个url地址。 ajax请求完成后，会根据请求结果调用相应回调： 如果请求\n\t\t\t\t * 成功， 则调用onsuccess回调， 失败则调用 onerror 回调。\n\t\t\t\t * @method request\n\t\t\t\t * @warning 如果在参数项里未提供一个key为“url”的地址值，则该请求将直接退出。\n\t\t\t\t * @param { Object } ajaxOptions ajax请求选项的键值对，支持的选项如下：\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t *\n\t\t\t\t * //向sayhello.php发起一个异步的Ajax POST请求, 请求超时时间为5s， 请求完成后不执行任何回调。\n\t\t\t\t * UE.ajax.requeset( 'sayhello.php', {\n\t\t\t\t *\n\t\t\t\t *     //请求的地址， 该项是必须的。\n\t\t\t\t *     url: 'sayhello.php'\n\t\t\t\t *\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\trequest: function(url, opts) {\n\t\t\t\t\tif (opts && opts.dataType == 'jsonp') {\n\t\t\t\t\t\tdoJsonp(url, opts);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdoAjax(url, opts);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetJSONP: function(url, data, fn) {\n\t\t\t\t\tvar opts = {\n\t\t\t\t\t\t'data': data,\n\t\t\t\t\t\t'oncomplete': fn\n\t\t\t\t\t};\n\t\t\t\t\tdoJsonp(url, opts);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t}();\n\t\n\t\t// core/filterword.js\n\t\t/**\n\t\t * UE过滤word的静态方法\n\t\t * @file\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t\t * @module UE\n\t\t */\n\t\n\t\t/**\n\t\t * 根据传入html字符串过滤word\n\t\t * @module UE\n\t\t * @since 1.2.6.1\n\t\t * @method filterWord\n\t\t * @param { String } html html字符串\n\t\t * @return { String } 已过滤后的结果字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.filterWord(html);\n\t\t * ```\n\t\t */\n\t\tvar filterWord = UE.filterWord = function() {\n\t\n\t\t\t//是否是word过来的内容\n\t\t\tfunction isWordDocument(str) {\n\t\t\t\treturn /(class=\"?Mso|style=\"[^\"]*\\bmso\\-|w:WordDocument|<(v|o):|lang=)/ig.test(str);\n\t\t\t}\n\t\t\t//去掉小数\n\t\t\tfunction transUnit(v) {\n\t\t\t\tv = v.replace(/[\\d.]+\\w+/g, function(m) {\n\t\t\t\t\treturn utils.transUnitToPx(m);\n\t\t\t\t});\n\t\t\t\treturn v;\n\t\t\t}\n\t\n\t\t\tfunction filterPasteWord(str) {\n\t\t\t\treturn str.replace(/[\\t\\r\\n]+/g, ' ')\n\t\t\t\t\t.replace(/<!--[\\s\\S]*?-->/ig, \"\")\n\t\t\t\t\t//转换图片\n\t\t\t\t\t.replace(/<v:shape [^>]*>[\\s\\S]*?.<\\/v:shape>/gi, function(str) {\n\t\t\t\t\t\t//opera能自己解析出image所这里直接返回空\n\t\t\t\t\t\tif (browser.opera) {\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t//有可能是bitmap占为图，无用，直接过滤掉，主要体现在粘贴excel表格中\n\t\t\t\t\t\t\tif (/Bitmap/i.test(str)) {\n\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar width = str.match(/width:([ \\d.]*p[tx])/i)[1],\n\t\t\t\t\t\t\t\theight = str.match(/height:([ \\d.]*p[tx])/i)[1],\n\t\t\t\t\t\t\t\tsrc = str.match(/src=\\s*\"([^\"]*)\"/i)[1];\n\t\t\t\t\t\t\treturn '<img width=\"' + transUnit(width) + '\" height=\"' + transUnit(height) + '\" src=\"' + src + '\" />';\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t//针对wps添加的多余标签处理\n\t\t\t\t\t.replace(/<\\/?div[^>]*>/g, '')\n\t\t\t\t\t//去掉多余的属性\n\t\t\t\t\t.replace(/v:\\w+=([\"']?)[^'\"]+\\1/g, '')\n\t\t\t\t\t.replace(/<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|xml|meta|link|style|\\w+:\\w+)(?=[\\s\\/>]))[^>]*>/gi, \"\")\n\t\t\t\t\t.replace(/<p [^>]*class=\"?MsoHeading\"?[^>]*>(.*?)<\\/p>/gi, \"<p><strong>$1</strong></p>\")\n\t\t\t\t\t//去掉多余的属性\n\t\t\t\t\t.replace(/\\s+(class|lang|align)\\s*=\\s*(['\"]?)([\\w-]+)\\2/ig, function(str, name, marks, val) {\n\t\t\t\t\t\t//保留list的标示\n\t\t\t\t\t\treturn name == 'class' && val == 'MsoListParagraph' ? str : ''\n\t\t\t\t\t})\n\t\t\t\t\t//清除多余的font/span不能匹配&nbsp;有可能是空格\n\t\t\t\t\t.replace(/<(font|span)[^>]*>(\\s*)<\\/\\1>/gi, function(a, b, c) {\n\t\t\t\t\t\treturn c.replace(/[\\t\\r\\n ]+/g, ' ')\n\t\t\t\t\t})\n\t\t\t\t\t//处理style的问题\n\t\t\t\t\t.replace(/(<[a-z][^>]*)\\sstyle=([\"'])([^\\2]*?)\\2/gi, function(str, tag, tmp, style) {\n\t\t\t\t\t\tvar n = [],\n\t\t\t\t\t\t\ts = style.replace(/^\\s+|\\s+$/, '')\n\t\t\t\t\t\t\t.replace(/&#39;/g, '\\'')\n\t\t\t\t\t\t\t.replace(/&quot;/gi, \"'\")\n\t\t\t\t\t\t\t.replace(/[\\d.]+(cm|pt)/g, function(str) {\n\t\t\t\t\t\t\t\treturn utils.transUnitToPx(str)\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.split(/;\\s*/g);\n\t\n\t\t\t\t\t\tfor (var i = 0, v; v = s[i]; i++) {\n\t\n\t\t\t\t\t\t\tvar name, value,\n\t\t\t\t\t\t\t\tparts = v.split(\":\");\n\t\n\t\t\t\t\t\t\tif (parts.length == 2) {\n\t\t\t\t\t\t\t\tname = parts[0].toLowerCase();\n\t\t\t\t\t\t\t\tvalue = parts[1].toLowerCase();\n\t\t\t\t\t\t\t\tif (/^(background)\\w*/.test(name) && value.replace(/(initial|\\s)/g, '').length == 0 ||\n\t\t\t\t\t\t\t\t\t/^(margin)\\w*/.test(name) && /^0\\w+$/.test(value)\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tswitch (name) {\n\t\t\t\t\t\t\t\t\tcase \"mso-padding-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-padding-top-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-padding-right-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-padding-bottom-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-padding-left-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-margin-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-margin-top-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-margin-right-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-margin-bottom-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-margin-left-alt\":\n\t\t\t\t\t\t\t\t\t\t//ie下会出现挤到一起的情况\n\t\t\t\t\t\t\t\t\t\t//case \"mso-table-layout-alt\":\n\t\t\t\t\t\t\t\t\tcase \"mso-height\":\n\t\t\t\t\t\t\t\t\tcase \"mso-width\":\n\t\t\t\t\t\t\t\t\tcase \"mso-vertical-align-alt\":\n\t\t\t\t\t\t\t\t\t\t//trace:1819 ff下会解析出padding在table上\n\t\t\t\t\t\t\t\t\t\tif (!/<table/.test(tag))\n\t\t\t\t\t\t\t\t\t\t\tn[i] = name.replace(/^mso-|-alt$/g, \"\") + \":\" + transUnit(value);\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\tcase \"horiz-align\":\n\t\t\t\t\t\t\t\t\t\tn[i] = \"text-align:\" + value;\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t\tcase \"vert-align\":\n\t\t\t\t\t\t\t\t\t\tn[i] = \"vertical-align:\" + value;\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t\tcase \"font-color\":\n\t\t\t\t\t\t\t\t\tcase \"mso-foreground\":\n\t\t\t\t\t\t\t\t\t\tn[i] = \"color:\" + value;\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t\tcase \"mso-background\":\n\t\t\t\t\t\t\t\t\tcase \"mso-highlight\":\n\t\t\t\t\t\t\t\t\t\tn[i] = \"background:\" + value;\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t\tcase \"mso-default-height\":\n\t\t\t\t\t\t\t\t\t\tn[i] = \"min-height:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t\tcase \"mso-default-width\":\n\t\t\t\t\t\t\t\t\t\tn[i] = \"min-width:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t\tcase \"mso-padding-between-alt\":\n\t\t\t\t\t\t\t\t\t\tn[i] = \"border-collapse:separate;border-spacing:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t\tcase \"text-line-through\":\n\t\t\t\t\t\t\t\t\t\tif ((value == \"single\") || (value == \"double\")) {\n\t\t\t\t\t\t\t\t\t\t\tn[i] = \"text-decoration:line-through\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\tcase \"mso-zero-height\":\n\t\t\t\t\t\t\t\t\t\tif (value == \"yes\") {\n\t\t\t\t\t\t\t\t\t\t\tn[i] = \"display:none\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t\t//                                case 'background':\n\t\t\t\t\t\t\t\t\t\t//                                    break;\n\t\t\t\t\t\t\t\t\tcase 'margin':\n\t\t\t\t\t\t\t\t\t\tif (!/[1-9]/.test(value)) {\n\t\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tif (/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(name) ||\n\t\t\t\t\t\t\t\t\t/text\\-indent|padding|margin/.test(name) && /\\-[\\d.]+/.test(value)\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tn[i] = name + \":\" + parts[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn tag + (n.length ? ' style=\"' + n.join(';').replace(/;{2,}/g, ';') + '\"' : '');\n\t\t\t\t\t})\n\t\n\t\t\t}\n\t\n\t\t\treturn function(html) {\n\t\t\t\treturn (isWordDocument(html) ? filterPasteWord(html) : html);\n\t\t\t};\n\t\t}();\n\t\n\t\t// core/node.js\n\t\t/**\n\t\t * 编辑器模拟的节点类\n\t\t * @file\n\t\t * @module UE\n\t\t * @class uNode\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t\t * @unfile\n\t\t * @module UE\n\t\t */\n\t\n\t\t(function() {\n\t\n\t\t\t/**\n\t\t\t * 编辑器模拟的节点类\n\t\t\t * @unfile\n\t\t\t * @module UE\n\t\t\t * @class uNode\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 通过一个键值对，创建一个uNode对象\n\t\t\t * @constructor\n\t\t\t * @param { Object } attr 传入要创建的uNode的初始属性\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var node = new uNode({\n\t\t\t *     type:'element',\n\t\t\t *     tagName:'span',\n\t\t\t *     attrs:{style:'font-size:14px;'}\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tvar uNode = UE.uNode = function(obj) {\n\t\t\t\tthis.type = obj.type;\n\t\t\t\tthis.data = obj.data;\n\t\t\t\tthis.tagName = obj.tagName;\n\t\t\t\tthis.parentNode = obj.parentNode;\n\t\t\t\tthis.attrs = obj.attrs || {};\n\t\t\t\tthis.children = obj.children;\n\t\t\t};\n\t\n\t\t\tvar notTransAttrs = {\n\t\t\t\t'href': 1,\n\t\t\t\t'src': 1,\n\t\t\t\t'_src': 1,\n\t\t\t\t'_href': 1,\n\t\t\t\t'cdata_data': 1\n\t\t\t};\n\t\n\t\t\tvar notTransTagName = {\n\t\t\t\tstyle: 1,\n\t\t\t\tscript: 1\n\t\t\t};\n\t\n\t\t\tvar indentChar = '    ',\n\t\t\t\tbreakChar = '\\n';\n\t\n\t\t\tfunction insertLine(arr, current, begin) {\n\t\t\t\tarr.push(breakChar);\n\t\t\t\treturn current + (begin ? 1 : -1);\n\t\t\t}\n\t\n\t\t\tfunction insertIndent(arr, current) {\n\t\t\t\t//插入缩进\n\t\t\t\tfor (var i = 0; i < current; i++) {\n\t\t\t\t\tarr.push(indentChar);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t//创建uNode的静态方法\n\t\t\t//支持标签和html\n\t\t\tuNode.createElement = function(html) {\n\t\t\t\tif (/[<>]/.test(html)) {\n\t\t\t\t\treturn UE.htmlparser(html).children[0]\n\t\t\t\t} else {\n\t\t\t\t\treturn new uNode({\n\t\t\t\t\t\ttype: 'element',\n\t\t\t\t\t\tchildren: [],\n\t\t\t\t\t\ttagName: html\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t};\n\t\t\tuNode.createText = function(data, noTrans) {\n\t\t\t\treturn new UE.uNode({\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\t'data': noTrans ? data : utils.unhtml(data || '')\n\t\t\t\t})\n\t\t\t};\n\t\n\t\t\tfunction nodeToHtml(node, arr, formatter, current) {\n\t\t\t\tswitch (node.type) {\n\t\t\t\t\tcase 'root':\n\t\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\t\t\t//插入新行\n\t\t\t\t\t\t\tif (formatter && ci.type == 'element' && !dtd.$inlineWithA[ci.tagName] && i > 1) {\n\t\t\t\t\t\t\t\tinsertLine(arr, current, true);\n\t\t\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnodeToHtml(ci, arr, formatter, current)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'text':\n\t\t\t\t\t\tisText(node, arr);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'element':\n\t\t\t\t\t\tisElement(node, arr, formatter, current);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'comment':\n\t\t\t\t\t\tisComment(node, arr, formatter);\n\t\t\t\t}\n\t\t\t\treturn arr;\n\t\t\t}\n\t\n\t\t\tfunction isText(node, arr) {\n\t\t\t\tif (node.parentNode.tagName == 'pre') {\n\t\t\t\t\t//源码模式下输入html标签，不能做转换处理，直接输出\n\t\t\t\t\tarr.push(node.data)\n\t\t\t\t} else {\n\t\t\t\t\tarr.push(notTransTagName[node.parentNode.tagName] ? utils.html(node.data) : node.data.replace(/[ ]{2}/g, ' &nbsp;'))\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tfunction isElement(node, arr, formatter, current) {\n\t\t\t\tvar attrhtml = '';\n\t\t\t\tif (node.attrs) {\n\t\t\t\t\tattrhtml = [];\n\t\t\t\t\tvar attrs = node.attrs;\n\t\t\t\t\tfor (var a in attrs) {\n\t\t\t\t\t\t//这里就针对\n\t\t\t\t\t\t//<p>'<img src='http://nsclick.baidu.com/u.gif?&asdf=\\\"sdf&asdfasdfs;asdf'></p>\n\t\t\t\t\t\t//这里边的\\\"做转换，要不用innerHTML直接被截断了，属性src\n\t\t\t\t\t\t//有可能做的不够\n\t\t\t\t\t\tattrhtml.push(a + (attrs[a] !== undefined ? '=\"' + (notTransAttrs[a] ? utils.html(attrs[a]).replace(/[\"]/g, function(a) {\n\t\t\t\t\t\t\treturn '&quot;'\n\t\t\t\t\t\t}) : utils.unhtml(attrs[a])) + '\"' : ''))\n\t\t\t\t\t}\n\t\t\t\t\tattrhtml = attrhtml.join(' ');\n\t\t\t\t}\n\t\t\t\tarr.push('<' + node.tagName +\n\t\t\t\t\t(attrhtml ? ' ' + attrhtml : '') +\n\t\t\t\t\t(dtd.$empty[node.tagName] ? '\\/' : '') + '>'\n\t\t\t\t);\n\t\t\t\t//插入新行\n\t\t\t\tif (formatter && !dtd.$inlineWithA[node.tagName] && node.tagName != 'pre') {\n\t\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\t\tcurrent = insertLine(arr, current, true);\n\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\t\tif (formatter && ci.type == 'element' && !dtd.$inlineWithA[ci.tagName] && i > 1) {\n\t\t\t\t\t\t\tinsertLine(arr, current);\n\t\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnodeToHtml(ci, arr, formatter, current)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!dtd.$empty[node.tagName]) {\n\t\t\t\t\tif (formatter && !dtd.$inlineWithA[node.tagName] && node.tagName != 'pre') {\n\t\n\t\t\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\t\t\tcurrent = insertLine(arr, current);\n\t\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tarr.push('<\\/' + node.tagName + '>');\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tfunction isComment(node, arr) {\n\t\t\t\tarr.push('<!--' + node.data + '-->');\n\t\t\t}\n\t\n\t\t\tfunction getNodeById(root, id) {\n\t\t\t\tvar node;\n\t\t\t\tif (root.type == 'element' && root.getAttr('id') == id) {\n\t\t\t\t\treturn root;\n\t\t\t\t}\n\t\t\t\tif (root.children && root.children.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = root.children[i++];) {\n\t\t\t\t\t\tif (node = getNodeById(ci, id)) {\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction getNodesByTagName(node, tagName, arr) {\n\t\t\t\tif (node.type == 'element' && node.tagName == tagName) {\n\t\t\t\t\tarr.push(node);\n\t\t\t\t}\n\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\t\tgetNodesByTagName(ci, tagName, arr)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction nodeTraversal(root, fn) {\n\t\t\t\tif (root.children && root.children.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = root.children[i];) {\n\t\t\t\t\t\tnodeTraversal(ci, fn);\n\t\t\t\t\t\t//ci被替换的情况，这里就不再走 fn了\n\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\tif (ci.children && ci.children.length) {\n\t\t\t\t\t\t\t\tfn(ci)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (ci.parentNode) i++\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfn(root)\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\tuNode.prototype = {\n\t\n\t\t\t\t/**\n\t\t\t\t * 当前节点对象，转换成html文本\n\t\t\t\t * @method toHtml\n\t\t\t\t * @return { String } 返回转换后的html字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.toHtml();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 当前节点对象，转换成html文本\n\t\t\t\t * @method toHtml\n\t\t\t\t * @param { Boolean } formatter 是否格式化返回值\n\t\t\t\t * @return { String } 返回转换后的html字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.toHtml( true );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\ttoHtml: function(formatter) {\n\t\t\t\t\tvar arr = [];\n\t\t\t\t\tnodeToHtml(this, arr, formatter, 0);\n\t\t\t\t\treturn arr.join('')\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取节点的html内容\n\t\t\t\t * @method innerHTML\n\t\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t\t * @return { String } 返回节点的html内容\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * var htmlstr = node.innerHTML();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置节点的html内容\n\t\t\t\t * @method innerHTML\n\t\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t\t * @param { String } htmlstr 传入要设置的html内容\n\t\t\t\t * @return { UE.uNode } 返回节点本身\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.innerHTML('<span>text</span>');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tinnerHTML: function(htmlstr) {\n\t\t\t\t\tif (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t}\n\t\t\t\t\tif (utils.isString(htmlstr)) {\n\t\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.children = [];\n\t\t\t\t\t\tvar tmpRoot = UE.htmlparser(htmlstr);\n\t\t\t\t\t\tfor (var i = 0, ci; ci = tmpRoot.children[i++];) {\n\t\t\t\t\t\t\tthis.children.push(ci);\n\t\t\t\t\t\t\tci.parentNode = this;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar tmpRoot = new UE.uNode({\n\t\t\t\t\t\t\ttype: 'root',\n\t\t\t\t\t\t\tchildren: this.children\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn tmpRoot.toHtml();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取节点的纯文本内容\n\t\t\t\t * @method innerText\n\t\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t\t * @return { String } 返回节点的存文本内容\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * var textStr = node.innerText();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置节点的纯文本内容\n\t\t\t\t * @method innerText\n\t\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t\t * @param { String } textStr 传入要设置的文本内容\n\t\t\t\t * @return { UE.uNode } 返回节点本身\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.innerText('<span>text</span>');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tinnerText: function(textStr, noTrans) {\n\t\t\t\t\tif (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t}\n\t\t\t\t\tif (textStr) {\n\t\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.children = [];\n\t\t\t\t\t\tthis.appendChild(uNode.createText(textStr, noTrans));\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn this.toHtml().replace(/<[^>]+>/g, '');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前对象的data属性\n\t\t\t\t * @method getData\n\t\t\t\t * @return { Object } 若节点的type值是elemenet，返回空字符串，否则返回节点的data属性\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.getData();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetData: function() {\n\t\t\t\t\tif (this.type == 'element')\n\t\t\t\t\t\treturn '';\n\t\t\t\t\treturn this.data\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前节点下的第一个子节点\n\t\t\t\t * @method firstChild\n\t\t\t\t * @return { UE.uNode } 返回第一个子节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.firstChild(); //返回第一个子节点\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tfirstChild: function() {\n\t\t\t\t\t//            if (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t\t//                return this;\n\t\t\t\t\t//            }\n\t\t\t\t\treturn this.children ? this.children[0] : null;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前节点下的最后一个子节点\n\t\t\t\t * @method lastChild\n\t\t\t\t * @return { UE.uNode } 返回最后一个子节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.lastChild(); //返回最后一个子节点\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tlastChild: function() {\n\t\t\t\t\t//            if (this.type != 'element' || dtd.$empty[this.tagName] ) {\n\t\t\t\t\t//                return this;\n\t\t\t\t\t//            }\n\t\t\t\t\treturn this.children ? this.children[this.children.length - 1] : null;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取和当前节点有相同父亲节点的前一个节点\n\t\t\t\t * @method previousSibling\n\t\t\t\t * @return { UE.uNode } 返回前一个节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.children[2].previousSibling(); //返回子节点node.children[1]\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tpreviousSibling: function() {\n\t\t\t\t\tvar parent = this.parentNode;\n\t\t\t\t\tfor (var i = 0, ci; ci = parent.children[i]; i++) {\n\t\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\t\treturn i == 0 ? null : parent.children[i - 1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取和当前节点有相同父亲节点的后一个节点\n\t\t\t\t * @method nextSibling\n\t\t\t\t * @return { UE.uNode } 返回后一个节点,找不到返回null\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.children[2].nextSibling(); //如果有，返回子节点node.children[3]\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tnextSibling: function() {\n\t\t\t\t\tvar parent = this.parentNode;\n\t\t\t\t\tfor (var i = 0, ci; ci = parent.children[i++];) {\n\t\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\t\treturn parent.children[i];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 用新的节点替换当前节点\n\t\t\t\t * @method replaceChild\n\t\t\t\t * @param { UE.uNode } target 要替换成该节点参数\n\t\t\t\t * @param { UE.uNode } source 要被替换掉的节点\n\t\t\t\t * @return { UE.uNode } 返回替换之后的节点对象\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.replaceChild(newNode, childNode); //用newNode替换childNode,childNode是node的子节点\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\treplaceChild: function(target, source) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\t\tthis.children.splice(i, 1, target);\n\t\t\t\t\t\t\t\tsource.parentNode = null;\n\t\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 在节点的子节点列表最后位置插入一个节点\n\t\t\t\t * @method appendChild\n\t\t\t\t * @param { UE.uNode } node 要插入的节点\n\t\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.appendChild( newNode ); //在node内插入子节点newNode\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tappendChild: function(node) {\n\t\t\t\t\tif (this.type == 'root' || (this.type == 'element' && !dtd.$empty[this.tagName])) {\n\t\t\t\t\t\tif (!this.children) {\n\t\t\t\t\t\t\tthis.children = []\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (node.parentNode) {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\t\tif (ci === node) {\n\t\t\t\t\t\t\t\tthis.children.splice(i, 1);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.children.push(node);\n\t\t\t\t\t\tnode.parentNode = this;\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 在传入节点的前面插入一个节点\n\t\t\t\t * @method insertBefore\n\t\t\t\t * @param { UE.uNode } target 要插入的节点\n\t\t\t\t * @param { UE.uNode } source 在该参数节点前面插入\n\t\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.parentNode.insertBefore(newNode, node); //在node节点后面插入newNode\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tinsertBefore: function(target, source) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\t\tthis.children.splice(i, 0, target);\n\t\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 在传入节点的后面插入一个节点\n\t\t\t\t * @method insertAfter\n\t\t\t\t * @param { UE.uNode } target 要插入的节点\n\t\t\t\t * @param { UE.uNode } source 在该参数节点后面插入\n\t\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.parentNode.insertAfter(newNode, node); //在node节点后面插入newNode\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tinsertAfter: function(target, source) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\t\tthis.children.splice(i + 1, 0, target);\n\t\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 从当前节点的子节点列表中，移除节点\n\t\t\t\t * @method removeChild\n\t\t\t\t * @param { UE.uNode } node 要移除的节点引用\n\t\t\t\t * @param { Boolean } keepChildren 是否保留移除节点的子节点，若传入true，自动把移除节点的子节点插入到移除的位置\n\t\t\t\t * @return { * } 返回刚移除的子节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.removeChild(childNode,true); //在node的子节点列表中移除child节点，并且吧child的子节点插入到移除的位置\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tremoveChild: function(node, keepChildren) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\t\tif (ci === node) {\n\t\t\t\t\t\t\t\tthis.children.splice(i, 1);\n\t\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t\t\tif (keepChildren && ci.children && ci.children.length) {\n\t\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci.children[j]; j++) {\n\t\t\t\t\t\t\t\t\t\tthis.children.splice(i + j, 0, cj);\n\t\t\t\t\t\t\t\t\t\tcj.parentNode = this;\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn ci;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前节点所代表的元素属性，即获取attrs对象下的属性值\n\t\t\t\t * @method getAttr\n\t\t\t\t * @param { String } attrName 要获取的属性名称\n\t\t\t\t * @return { * } 返回attrs对象下的属性值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.getAttr('title');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetAttr: function(attrName) {\n\t\t\t\t\treturn this.attrs && this.attrs[attrName.toLowerCase()]\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 设置当前节点所代表的元素属性，即设置attrs对象下的属性值\n\t\t\t\t * @method setAttr\n\t\t\t\t * @param { String } attrName 要设置的属性名称\n\t\t\t\t * @param { * } attrVal 要设置的属性值，类型视设置的属性而定\n\t\t\t\t * @return { * } 返回attrs对象下的属性值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.setAttr('title','标题');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetAttr: function(attrName, attrVal) {\n\t\t\t\t\tif (!attrName) {\n\t\t\t\t\t\tdelete this.attrs;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.attrs) {\n\t\t\t\t\t\tthis.attrs = {};\n\t\t\t\t\t}\n\t\t\t\t\tif (utils.isObject(attrName)) {\n\t\t\t\t\t\tfor (var a in attrName) {\n\t\t\t\t\t\t\tif (!attrName[a]) {\n\t\t\t\t\t\t\t\tdelete this.attrs[a]\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.attrs[a.toLowerCase()] = attrName[a];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!attrVal) {\n\t\t\t\t\t\t\tdelete this.attrs[attrName]\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.attrs[attrName.toLowerCase()] = attrVal;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 获取当前节点在父节点下的位置索引\n\t\t\t\t * @method getIndex\n\t\t\t\t * @return { Number } 返回索引数值，如果没有父节点，返回-1\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.getIndex();\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetIndex: function() {\n\t\t\t\t\tvar parent = this.parentNode;\n\t\t\t\t\tfor (var i = 0, ci; ci = parent.children[i]; i++) {\n\t\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 在当前节点下，根据id查找节点\n\t\t\t\t * @method getNodeById\n\t\t\t\t * @param { String } id 要查找的id\n\t\t\t\t * @return { UE.uNode } 返回找到的节点\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.getNodeById('textId');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetNodeById: function(id) {\n\t\t\t\t\tvar node;\n\t\t\t\t\tif (this.children && this.children.length) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\t\tif (node = getNodeById(ci, id)) {\n\t\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 在当前节点下，根据元素名称查找节点列表\n\t\t\t\t * @method getNodesByTagName\n\t\t\t\t * @param { String } tagNames 要查找的元素名称\n\t\t\t\t * @return { Array } 返回找到的节点列表\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.getNodesByTagName('span');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetNodesByTagName: function(tagNames) {\n\t\t\t\t\ttagNames = utils.trim(tagNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\t\tvar arr = [],\n\t\t\t\t\t\tme = this;\n\t\t\t\t\tutils.each(tagNames, function(tagName) {\n\t\t\t\t\t\tif (me.children && me.children.length) {\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = me.children[i++];) {\n\t\t\t\t\t\t\t\tgetNodesByTagName(ci, tagName, arr)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn arr;\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 根据样式名称，获取节点的样式值\n\t\t\t\t * @method getStyle\n\t\t\t\t * @param { String } name 要获取的样式名称\n\t\t\t\t * @return { String } 返回样式值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.getStyle('font-size');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tgetStyle: function(name) {\n\t\t\t\t\tvar cssStyle = this.getAttr('style');\n\t\t\t\t\tif (!cssStyle) {\n\t\t\t\t\t\treturn ''\n\t\t\t\t\t}\n\t\t\t\t\tvar reg = new RegExp('(^|;)\\\\s*' + name + ':([^;]+)', 'i');\n\t\t\t\t\tvar match = cssStyle.match(reg);\n\t\t\t\t\tif (match && match[0]) {\n\t\t\t\t\t\treturn match[2]\n\t\t\t\t\t}\n\t\t\t\t\treturn '';\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 给节点设置样式\n\t\t\t\t * @method setStyle\n\t\t\t\t * @param { String } name 要设置的的样式名称\n\t\t\t\t * @param { String } val 要设置的的样值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * node.setStyle('font-size', '12px');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tsetStyle: function(name, val) {\n\t\t\t\t\tfunction exec(name, val) {\n\t\t\t\t\t\tvar reg = new RegExp('(^|;)\\\\s*' + name + ':([^;]+;?)', 'gi');\n\t\t\t\t\t\tcssStyle = cssStyle.replace(reg, '$1');\n\t\t\t\t\t\tif (val) {\n\t\t\t\t\t\t\tcssStyle = name + ':' + utils.unhtml(val) + ';' + cssStyle\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar cssStyle = this.getAttr('style');\n\t\t\t\t\tif (!cssStyle) {\n\t\t\t\t\t\tcssStyle = '';\n\t\t\t\t\t}\n\t\t\t\t\tif (utils.isObject(name)) {\n\t\t\t\t\t\tfor (var a in name) {\n\t\t\t\t\t\t\texec(a, name[a])\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\texec(name, val)\n\t\t\t\t\t}\n\t\t\t\t\tthis.setAttr('style', utils.trim(cssStyle))\n\t\t\t\t},\n\t\n\t\t\t\t/**\n\t\t\t\t * 传入一个函数，递归遍历当前节点下的所有节点\n\t\t\t\t * @method traversal\n\t\t\t\t * @param { Function } fn 遍历到节点的时，传入节点作为参数，运行此函数\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * traversal(node, function(){\n\t\t\t\t *     console.log(node.type);\n\t\t\t\t * });\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\ttraversal: function(fn) {\n\t\t\t\t\tif (this.children && this.children.length) {\n\t\t\t\t\t\tnodeTraversal(this, fn);\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\t\n\t\t// core/htmlparser.js\n\t\t/**\n\t\t * html字符串转换成uNode节点\n\t\t * @file\n\t\t * @module UE\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t\t * @unfile\n\t\t * @module UE\n\t\t */\n\t\n\t\t/**\n\t\t * html字符串转换成uNode节点的静态方法\n\t\t * @method htmlparser\n\t\t * @param { String } htmlstr 要转换的html代码\n\t\t * @param { Boolean } ignoreBlank 若设置为true，转换的时候忽略\\n\\r\\t等空白字符\n\t\t * @return { uNode } 给定的html片段转换形成的uNode对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * var root = UE.htmlparser('<p><b>htmlparser</b></p>', true);\n\t\t * ```\n\t\t */\n\t\n\t\tvar htmlparser = UE.htmlparser = function(htmlstr, ignoreBlank) {\n\t\t\t//todo 原来的方式  [^\"'<>\\/] 有\\/就不能配对上 <TD vAlign=top background=../AAA.JPG> 这样的标签了\n\t\t\t//先去掉了，加上的原因忘了，这里先记录\n\t\t\tvar re_tag = /<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)-->)|(?:([^\\s\\/<>]+)\\s*((?:(?:\"[^\"]*\")|(?:'[^']*')|[^\"'<>])*)\\/?>))/g,\n\t\t\t\tre_attr = /([\\w\\-:.]+)(?:(?:\\s*=\\s*(?:(?:\"([^\"]*)\")|(?:'([^']*)')|([^\\s>]+)))|(?=\\s|$))/g;\n\t\n\t\t\t//ie下取得的html可能会有\\n存在，要去掉，在处理replace(/[\\t\\r\\n]*/g,'');代码高量的\\n不能去除\n\t\t\tvar allowEmptyTags = {\n\t\t\t\tb: 1,\n\t\t\t\tcode: 1,\n\t\t\t\ti: 1,\n\t\t\t\tu: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\ts: 1,\n\t\t\t\ttt: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\tq: 1,\n\t\t\t\tsamp: 1,\n\t\t\t\tem: 1,\n\t\t\t\tspan: 1,\n\t\t\t\tsub: 1,\n\t\t\t\timg: 1,\n\t\t\t\tsup: 1,\n\t\t\t\tfont: 1,\n\t\t\t\tbig: 1,\n\t\t\t\tsmall: 1,\n\t\t\t\tiframe: 1,\n\t\t\t\ta: 1,\n\t\t\t\tbr: 1,\n\t\t\t\tpre: 1\n\t\t\t};\n\t\t\thtmlstr = htmlstr.replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\t\tif (!ignoreBlank) {\n\t\t\t\thtmlstr = htmlstr.replace(new RegExp('[\\\\r\\\\t\\\\n' + (ignoreBlank ? '' : ' ') + ']*<\\/?(\\\\w+)\\\\s*(?:[^>]*)>[\\\\r\\\\t\\\\n' + (ignoreBlank ? '' : ' ') + ']*', 'g'), function(a, b) {\n\t\t\t\t\t//br暂时单独处理\n\t\t\t\t\tif (b && allowEmptyTags[b.toLowerCase()]) {\n\t\t\t\t\t\treturn a.replace(/(^[\\n\\r]+)|([\\n\\r]+$)/g, '');\n\t\t\t\t\t}\n\t\t\t\t\treturn a.replace(new RegExp('^[\\\\r\\\\n' + (ignoreBlank ? '' : ' ') + ']+'), '').replace(new RegExp('[\\\\r\\\\n' + (ignoreBlank ? '' : ' ') + ']+$'), '');\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\tvar notTransAttrs = {\n\t\t\t\t'href': 1,\n\t\t\t\t'src': 1\n\t\t\t};\n\t\n\t\t\tvar uNode = UE.uNode,\n\t\t\t\tneedParentNode = {\n\t\t\t\t\t'td': 'tr',\n\t\t\t\t\t'tr': ['tbody', 'thead', 'tfoot'],\n\t\t\t\t\t'tbody': 'table',\n\t\t\t\t\t'th': 'tr',\n\t\t\t\t\t'thead': 'table',\n\t\t\t\t\t'tfoot': 'table',\n\t\t\t\t\t'caption': 'table',\n\t\t\t\t\t'li': ['ul', 'ol'],\n\t\t\t\t\t'dt': 'dl',\n\t\t\t\t\t'dd': 'dl',\n\t\t\t\t\t'option': 'select'\n\t\t\t\t},\n\t\t\t\tneedChild = {\n\t\t\t\t\t'ol': 'li',\n\t\t\t\t\t'ul': 'li'\n\t\t\t\t};\n\t\n\t\t\tfunction text(parent, data) {\n\t\n\t\t\t\tif (needChild[parent.tagName]) {\n\t\t\t\t\tvar tmpNode = uNode.createElement(needChild[parent.tagName]);\n\t\t\t\t\tparent.appendChild(tmpNode);\n\t\t\t\t\ttmpNode.appendChild(uNode.createText(data));\n\t\t\t\t\tparent = tmpNode;\n\t\t\t\t} else {\n\t\n\t\t\t\t\tparent.appendChild(uNode.createText(data));\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction element(parent, tagName, htmlattr) {\n\t\t\t\tvar needParentTag;\n\t\t\t\tif (needParentTag = needParentNode[tagName]) {\n\t\t\t\t\tvar tmpParent = parent,\n\t\t\t\t\t\thasParent;\n\t\t\t\t\twhile (tmpParent.type != 'root') {\n\t\t\t\t\t\tif (utils.isArray(needParentTag) ? utils.indexOf(needParentTag, tmpParent.tagName) != -1 : needParentTag == tmpParent.tagName) {\n\t\t\t\t\t\t\tparent = tmpParent;\n\t\t\t\t\t\t\thasParent = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpParent = tmpParent.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (!hasParent) {\n\t\t\t\t\t\tparent = element(parent, utils.isArray(needParentTag) ? needParentTag[0] : needParentTag)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//按dtd处理嵌套\n\t\t\t\t//        if(parent.type != 'root' && !dtd[parent.tagName][tagName])\n\t\t\t\t//            parent = parent.parentNode;\n\t\t\t\tvar elm = new uNode({\n\t\t\t\t\tparentNode: parent,\n\t\t\t\t\ttype: 'element',\n\t\t\t\t\ttagName: tagName.toLowerCase(),\n\t\t\t\t\t//是自闭合的处理一下\n\t\t\t\t\tchildren: dtd.$empty[tagName] ? null : []\n\t\t\t\t});\n\t\t\t\t//如果属性存在，处理属性\n\t\t\t\tif (htmlattr) {\n\t\t\t\t\tvar attrs = {},\n\t\t\t\t\t\tmatch;\n\t\t\t\t\twhile (match = re_attr.exec(htmlattr)) {\n\t\t\t\t\t\tattrs[match[1].toLowerCase()] = notTransAttrs[match[1].toLowerCase()] ? (match[2] || match[3] || match[4]) : utils.unhtml(match[2] || match[3] || match[4])\n\t\t\t\t\t}\n\t\t\t\t\telm.attrs = attrs;\n\t\t\t\t}\n\t\t\t\t//trace:3970\n\t\t\t\t//        //如果parent下不能放elm\n\t\t\t\t//        if(dtd.$inline[parent.tagName] && dtd.$block[elm.tagName] && !dtd[parent.tagName][elm.tagName]){\n\t\t\t\t//            parent = parent.parentNode;\n\t\t\t\t//            elm.parentNode = parent;\n\t\t\t\t//        }\n\t\t\t\tparent.children.push(elm);\n\t\t\t\t//如果是自闭合节点返回父亲节点\n\t\t\t\treturn dtd.$empty[tagName] ? parent : elm\n\t\t\t}\n\t\n\t\t\tfunction comment(parent, data) {\n\t\t\t\tparent.children.push(new uNode({\n\t\t\t\t\ttype: 'comment',\n\t\t\t\t\tdata: data,\n\t\t\t\t\tparentNode: parent\n\t\t\t\t}));\n\t\t\t}\n\t\n\t\t\tvar match, currentIndex = 0,\n\t\t\t\tnextIndex = 0;\n\t\t\t//设置根节点\n\t\t\tvar root = new uNode({\n\t\t\t\ttype: 'root',\n\t\t\t\tchildren: []\n\t\t\t});\n\t\t\tvar currentParent = root;\n\t\n\t\t\twhile (match = re_tag.exec(htmlstr)) {\n\t\t\t\tcurrentIndex = match.index;\n\t\t\t\ttry {\n\t\t\t\t\tif (currentIndex > nextIndex) {\n\t\t\t\t\t\t//text node\n\t\t\t\t\t\ttext(currentParent, htmlstr.slice(nextIndex, currentIndex));\n\t\t\t\t\t}\n\t\t\t\t\tif (match[3]) {\n\t\n\t\t\t\t\t\tif (dtd.$cdata[currentParent.tagName]) {\n\t\t\t\t\t\t\ttext(currentParent, match[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//start tag\n\t\t\t\t\t\t\tcurrentParent = element(currentParent, match[3].toLowerCase(), match[4]);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t} else if (match[1]) {\n\t\t\t\t\t\tif (currentParent.type != 'root') {\n\t\t\t\t\t\t\tif (dtd.$cdata[currentParent.tagName] && !dtd.$cdata[match[1]]) {\n\t\t\t\t\t\t\t\ttext(currentParent, match[0]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar tmpParent = currentParent;\n\t\t\t\t\t\t\t\twhile (currentParent.type == 'element' && currentParent.tagName != match[1].toLowerCase()) {\n\t\t\t\t\t\t\t\t\tcurrentParent = currentParent.parentNode;\n\t\t\t\t\t\t\t\t\tif (currentParent.type == 'root') {\n\t\t\t\t\t\t\t\t\t\tcurrentParent = tmpParent;\n\t\t\t\t\t\t\t\t\t\tthrow 'break'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//end tag\n\t\t\t\t\t\t\t\tcurrentParent = currentParent.parentNode;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t} else if (match[2]) {\n\t\t\t\t\t\t//comment\n\t\t\t\t\t\tcomment(currentParent, match[2])\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\n\t\t\t\tnextIndex = re_tag.lastIndex;\n\t\n\t\t\t}\n\t\t\t//如果结束是文本，就有可能丢掉，所以这里手动判断一下\n\t\t\t//例如 <li>sdfsdfsdf<li>sdfsdfsdfsdf\n\t\t\tif (nextIndex < htmlstr.length) {\n\t\t\t\ttext(currentParent, htmlstr.slice(nextIndex));\n\t\t\t}\n\t\t\treturn root;\n\t\t};\n\t\n\t\t// core/filternode.js\n\t\t/**\n\t\t * UE过滤节点的静态方法\n\t\t * @file\n\t\t */\n\t\n\t\t/**\n\t\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t\t * @module UE\n\t\t */\n\t\n\t\t/**\n\t\t * 根据传入节点和过滤规则过滤相应节点\n\t\t * @module UE\n\t\t * @since 1.2.6.1\n\t\t * @method filterNode\n\t\t * @param { Object } root 指定root节点\n\t\t * @param { Object } rules 过滤规则json对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.filterNode(root,editor.options.filterRules);\n\t\t * ```\n\t\t */\n\t\tvar filterNode = UE.filterNode = function() {\n\t\t\tfunction filterNode(node, rules) {\n\t\t\t\tswitch (node.type) {\n\t\t\t\t\tcase 'text':\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'element':\n\t\t\t\t\t\tvar val;\n\t\t\t\t\t\tif (val = rules[node.tagName]) {\n\t\t\t\t\t\t\tif (val === '-') {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t} else if (utils.isFunction(val)) {\n\t\t\t\t\t\t\t\tvar parentNode = node.parentNode,\n\t\t\t\t\t\t\t\t\tindex = node.getIndex();\n\t\t\t\t\t\t\t\tval(node);\n\t\t\t\t\t\t\t\tif (node.parentNode) {\n\t\t\t\t\t\t\t\t\tif (node.children) {\n\t\t\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i];) {\n\t\t\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfor (var i = index, ci; ci = parentNode.children[i];) {\n\t\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar attrs = val['$'];\n\t\t\t\t\t\t\t\tif (attrs && node.attrs) {\n\t\t\t\t\t\t\t\t\tvar tmpAttrs = {},\n\t\t\t\t\t\t\t\t\t\ttmpVal;\n\t\t\t\t\t\t\t\t\tfor (var a in attrs) {\n\t\t\t\t\t\t\t\t\t\ttmpVal = node.getAttr(a);\n\t\t\t\t\t\t\t\t\t\t//todo 只先对style单独处理\n\t\t\t\t\t\t\t\t\t\tif (a == 'style' && utils.isArray(attrs[a])) {\n\t\t\t\t\t\t\t\t\t\t\tvar tmpCssStyle = [];\n\t\t\t\t\t\t\t\t\t\t\tutils.each(attrs[a], function(v) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\t\t\t\t\t\t\tif (tmp = node.getStyle(v)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\ttmpCssStyle.push(v + ':' + tmp);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\ttmpVal = tmpCssStyle.join(';')\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (tmpVal) {\n\t\t\t\t\t\t\t\t\t\t\ttmpAttrs[a] = tmpVal;\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tnode.attrs = tmpAttrs;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (node.children) {\n\t\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i];) {\n\t\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//如果不在名单里扣出子节点并删除该节点,cdata除外\n\t\t\t\t\t\t\tif (dtd.$cdata[node.tagName]) {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar parentNode = node.parentNode,\n\t\t\t\t\t\t\t\t\tindex = node.getIndex();\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true);\n\t\t\t\t\t\t\t\tfor (var i = index, ci; ci = parentNode.children[i];) {\n\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'comment':\n\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t}\n\t\n\t\t\t}\n\t\t\treturn function(root, rules) {\n\t\t\t\tif (utils.isEmptyObject(rules)) {\n\t\t\t\t\treturn root;\n\t\t\t\t}\n\t\t\t\tvar val;\n\t\t\t\tif (val = rules['-']) {\n\t\t\t\t\tutils.each(val.split(' '), function(k) {\n\t\t\t\t\t\trules[k] = '-'\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tfor (var i = 0, ci; ci = root.children[i];) {\n\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn root;\n\t\t\t}\n\t\t}();\n\t\n\t\t// core/plugin.js\n\t\t/**\n\t\t * Created with JetBrains PhpStorm.\n\t\t * User: campaign\n\t\t * Date: 10/8/13\n\t\t * Time: 6:15 PM\n\t\t * To change this template use File | Settings | File Templates.\n\t\t */\n\t\tUE.plugin = function() {\n\t\t\tvar _plugins = {};\n\t\t\treturn {\n\t\t\t\tregister: function(pluginName, fn, oldOptionName, afterDisabled) {\n\t\t\t\t\tif (oldOptionName && utils.isFunction(oldOptionName)) {\n\t\t\t\t\t\tafterDisabled = oldOptionName;\n\t\t\t\t\t\toldOptionName = null\n\t\t\t\t\t}\n\t\t\t\t\t_plugins[pluginName] = {\n\t\t\t\t\t\toptionName: oldOptionName || pluginName,\n\t\t\t\t\t\texecFn: fn,\n\t\t\t\t\t\t//当插件被禁用时执行\n\t\t\t\t\t\tafterDisabled: afterDisabled\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tload: function(editor) {\n\t\t\t\t\tutils.each(_plugins, function(plugin) {\n\t\t\t\t\t\tvar _export = plugin.execFn.call(editor);\n\t\t\t\t\t\tif (editor.options[plugin.optionName] !== false) {\n\t\t\t\t\t\t\tif (_export) {\n\t\t\t\t\t\t\t\t//后边需要再做扩展\n\t\t\t\t\t\t\t\tutils.each(_export, function(v, k) {\n\t\t\t\t\t\t\t\t\tswitch (k.toLowerCase()) {\n\t\t\t\t\t\t\t\t\t\tcase 'shortcutkey':\n\t\t\t\t\t\t\t\t\t\t\teditor.addshortcutkey(v);\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'bindevents':\n\t\t\t\t\t\t\t\t\t\t\tutils.each(v, function(fn, eventName) {\n\t\t\t\t\t\t\t\t\t\t\t\teditor.addListener(eventName, fn);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'bindmultievents':\n\t\t\t\t\t\t\t\t\t\t\tutils.each(utils.isArray(v) ? v : [v], function(event) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar types = utils.trim(event.type).split(/\\s+/);\n\t\t\t\t\t\t\t\t\t\t\t\tutils.each(types, function(eventName) {\n\t\t\t\t\t\t\t\t\t\t\t\t\teditor.addListener(eventName, event.handler);\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'commands':\n\t\t\t\t\t\t\t\t\t\t\tutils.each(v, function(execFn, execName) {\n\t\t\t\t\t\t\t\t\t\t\t\teditor.commands[execName] = execFn\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'outputrule':\n\t\t\t\t\t\t\t\t\t\t\teditor.addOutputRule(v);\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'inputrule':\n\t\t\t\t\t\t\t\t\t\t\teditor.addInputRule(v);\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'defaultoptions':\n\t\t\t\t\t\t\t\t\t\t\teditor.setOpt(v)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} else if (plugin.afterDisabled) {\n\t\t\t\t\t\t\tplugin.afterDisabled.call(editor)\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t});\n\t\t\t\t\t//向下兼容\n\t\t\t\t\tutils.each(UE.plugins, function(plugin) {\n\t\t\t\t\t\tplugin.call(editor);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\trun: function(pluginName, editor) {\n\t\t\t\t\tvar plugin = _plugins[pluginName];\n\t\t\t\t\tif (plugin) {\n\t\t\t\t\t\tplugin.exeFn.call(editor)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}();\n\t\n\t\t// core/keymap.js\n\t\tvar keymap = UE.keymap = {\n\t\t\t'Backspace': 8,\n\t\t\t'Tab': 9,\n\t\t\t'Enter': 13,\n\t\n\t\t\t'Shift': 16,\n\t\t\t'Control': 17,\n\t\t\t'Alt': 18,\n\t\t\t'CapsLock': 20,\n\t\n\t\t\t'Esc': 27,\n\t\n\t\t\t'Spacebar': 32,\n\t\n\t\t\t'PageUp': 33,\n\t\t\t'PageDown': 34,\n\t\t\t'End': 35,\n\t\t\t'Home': 36,\n\t\n\t\t\t'Left': 37,\n\t\t\t'Up': 38,\n\t\t\t'Right': 39,\n\t\t\t'Down': 40,\n\t\n\t\t\t'Insert': 45,\n\t\n\t\t\t'Del': 46,\n\t\n\t\t\t'NumLock': 144,\n\t\n\t\t\t'Cmd': 91,\n\t\n\t\t\t'=': 187,\n\t\t\t'-': 189,\n\t\n\t\t\t\"b\": 66,\n\t\t\t'i': 73,\n\t\t\t//回退\n\t\t\t'z': 90,\n\t\t\t'y': 89,\n\t\t\t//粘贴\n\t\t\t'v': 86,\n\t\t\t'x': 88,\n\t\n\t\t\t's': 83,\n\t\n\t\t\t'n': 78\n\t\t};\n\t\n\t\t// core/localstorage.js\n\t\t//存储媒介封装\n\t\tvar LocalStorage = UE.LocalStorage = (function() {\n\t\n\t\t\tvar storage = window.localStorage || getUserData() || null,\n\t\t\t\tLOCAL_FILE = 'localStorage';\n\t\n\t\t\treturn {\n\t\n\t\t\t\tsaveLocalData: function(key, data) {\n\t\n\t\t\t\t\tif (storage && data) {\n\t\t\t\t\t\tstorage.setItem(key, data);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn false;\n\t\n\t\t\t\t},\n\t\n\t\t\t\tgetLocalData: function(key) {\n\t\n\t\t\t\t\tif (storage) {\n\t\t\t\t\t\treturn storage.getItem(key);\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn null;\n\t\n\t\t\t\t},\n\t\n\t\t\t\tremoveItem: function(key) {\n\t\n\t\t\t\t\tstorage && storage.removeItem(key);\n\t\n\t\t\t\t}\n\t\n\t\t\t};\n\t\n\t\t\tfunction getUserData() {\n\t\n\t\t\t\tvar container = document.createElement(\"div\");\n\t\t\t\tcontainer.style.display = \"none\";\n\t\n\t\t\t\tif (!container.addBehavior) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\n\t\t\t\tcontainer.addBehavior(\"#default#userdata\");\n\t\n\t\t\t\treturn {\n\t\n\t\t\t\t\tgetItem: function(key) {\n\t\n\t\t\t\t\t\tvar result = null;\n\t\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\t\t\tcontainer.load(LOCAL_FILE);\n\t\t\t\t\t\t\tresult = container.getAttribute(key);\n\t\t\t\t\t\t\tdocument.body.removeChild(container);\n\t\t\t\t\t\t} catch (e) {}\n\t\n\t\t\t\t\t\treturn result;\n\t\n\t\t\t\t\t},\n\t\n\t\t\t\t\tsetItem: function(key, value) {\n\t\n\t\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\t\tcontainer.setAttribute(key, value);\n\t\t\t\t\t\tcontainer.save(LOCAL_FILE);\n\t\t\t\t\t\tdocument.body.removeChild(container);\n\t\n\t\t\t\t\t},\n\t\n\t\t\t\t\t//// 暂时没有用到\n\t\t\t\t\t//clear: function () {\n\t\t\t\t\t//\n\t\t\t\t\t//    var expiresTime = new Date();\n\t\t\t\t\t//    expiresTime.setFullYear(expiresTime.getFullYear() - 1);\n\t\t\t\t\t//    document.body.appendChild(container);\n\t\t\t\t\t//    container.expires = expiresTime.toUTCString();\n\t\t\t\t\t//    container.save(LOCAL_FILE);\n\t\t\t\t\t//    document.body.removeChild(container);\n\t\t\t\t\t//\n\t\t\t\t\t//},\n\t\n\t\t\t\t\tremoveItem: function(key) {\n\t\n\t\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\t\tcontainer.removeAttribute(key);\n\t\t\t\t\t\tcontainer.save(LOCAL_FILE);\n\t\t\t\t\t\tdocument.body.removeChild(container);\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t};\n\t\n\t\t\t}\n\t\n\t\t})();\n\t\n\t\t(function() {\n\t\n\t\t\tvar ROOTKEY = 'ueditor_preference';\n\t\n\t\t\tUE.Editor.prototype.setPreferences = function(key, value) {\n\t\t\t\tvar obj = {};\n\t\t\t\tif (utils.isString(key)) {\n\t\t\t\t\tobj[key] = value;\n\t\t\t\t} else {\n\t\t\t\t\tobj = key;\n\t\t\t\t}\n\t\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\t\tutils.extend(data, obj);\n\t\t\t\t} else {\n\t\t\t\t\tdata = obj;\n\t\t\t\t}\n\t\t\t\tdata && LocalStorage.saveLocalData(ROOTKEY, utils.json2str(data));\n\t\t\t};\n\t\n\t\t\tUE.Editor.prototype.getPreferences = function(key) {\n\t\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\t\treturn key ? data[key] : data\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\t\n\t\t\tUE.Editor.prototype.removePreferences = function(key) {\n\t\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\t\tdata[key] = undefined;\n\t\t\t\t\tdelete data[key]\n\t\t\t\t}\n\t\t\t\tdata && LocalStorage.saveLocalData(ROOTKEY, utils.json2str(data));\n\t\t\t};\n\t\n\t\t})();\n\t\n\t\t// plugins/defaultfilter.js\n\t\t///import core\n\t\t///plugin 编辑器默认的过滤转换机制\n\t\n\t\tUE.plugins['defaultfilter'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt({\n\t\t\t\t'allowDivTransToP': true,\n\t\t\t\t'disabledTableInTable': true\n\t\t\t});\n\t\t\t//默认的过滤处理\n\t\t\t//进入编辑器的内容处理\n\t\t\tme.addInputRule(function(root) {\n\t\t\t\tvar allowDivTransToP = this.options.allowDivTransToP;\n\t\t\t\tvar val;\n\t\n\t\t\t\tfunction tdParent(node) {\n\t\t\t\t\twhile (node && node.type == 'element') {\n\t\t\t\t\t\tif (node.tagName == 'td') {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t//进行默认的处理\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\tif (!dtd.$cdata[node.tagName] && me.options.autoClearEmptyNode && dtd.$inline[node.tagName] && !dtd.$empty[node.tagName] && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\t\tif (!node.firstChild()) node.parentNode.removeChild(node);\n\t\t\t\t\t\t\telse if (node.tagName == 'span' && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\tcase 'script':\n\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\tcdata_tag: node.tagName,\n\t\t\t\t\t\t\t\t\tcdata_data: (node.innerHTML() || ''),\n\t\t\t\t\t\t\t\t\t'_ue_custom_node_': 'true'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tnode.tagName = 'div';\n\t\t\t\t\t\t\t\tnode.innerHTML('');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'a':\n\t\t\t\t\t\t\t\tif (val = node.getAttr('href')) {\n\t\t\t\t\t\t\t\t\tnode.setAttr('_href', val)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\t\t\t//todo base64暂时去掉，后边做远程图片上传后，干掉这个\n\t\t\t\t\t\t\t\tif (val = node.getAttr('src')) {\n\t\t\t\t\t\t\t\t\tif (/^data:/.test(val)) {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnode.setAttr('_src', node.getAttr('src'));\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'span':\n\t\t\t\t\t\t\t\tif (browser.webkit && (val = node.getStyle('white-space'))) {\n\t\t\t\t\t\t\t\t\tif (/nowrap|normal/.test(val)) {\n\t\t\t\t\t\t\t\t\t\tnode.setStyle('white-space', '');\n\t\t\t\t\t\t\t\t\t\tif (me.options.autoClearEmptyNode && utils.isEmptyObject(node.attrs)) {\n\t\t\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tval = node.getAttr('id');\n\t\t\t\t\t\t\t\tif (val && /^_baidu_bookmark_/i.test(val)) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'p':\n\t\t\t\t\t\t\t\tif (val = node.getAttr('align')) {\n\t\t\t\t\t\t\t\t\tnode.setAttr('align');\n\t\t\t\t\t\t\t\t\tnode.setStyle('text-align', val)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//trace:3431\n\t\t\t\t\t\t\t\t//                        var cssStyle = node.getAttr('style');\n\t\t\t\t\t\t\t\t//                        if (cssStyle) {\n\t\t\t\t\t\t\t\t//                            cssStyle = cssStyle.replace(/(margin|padding)[^;]+/g, '');\n\t\t\t\t\t\t\t\t//                            node.setAttr('style', cssStyle)\n\t\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t\t//                        }\n\t\t\t\t\t\t\t\t//p标签不允许嵌套\n\t\t\t\t\t\t\t\tutils.each(node.children, function(n) {\n\t\t\t\t\t\t\t\t\tif (n.type == 'element' && n.tagName == 'p') {\n\t\t\t\t\t\t\t\t\t\tvar next = n.nextSibling();\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(n, node);\n\t\t\t\t\t\t\t\t\t\tvar last = n;\n\t\t\t\t\t\t\t\t\t\twhile (next) {\n\t\t\t\t\t\t\t\t\t\t\tvar tmp = next.nextSibling();\n\t\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(next, last);\n\t\t\t\t\t\t\t\t\t\t\tlast = next;\n\t\t\t\t\t\t\t\t\t\t\tnext = tmp;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif (!node.firstChild()) {\n\t\t\t\t\t\t\t\t\tnode.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'div':\n\t\t\t\t\t\t\t\tif (node.getAttr('cdata_tag')) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//针对代码这里不处理插入代码的div\n\t\t\t\t\t\t\t\tval = node.getAttr('class');\n\t\t\t\t\t\t\t\tif (val && /^line number\\d+/.test(val)) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!allowDivTransToP) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar tmpNode, p = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\twhile (tmpNode = node.firstChild()) {\n\t\t\t\t\t\t\t\t\tif (tmpNode.type == 'text' || !UE.dom.dtd.$block[tmpNode.tagName]) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t\t\t\t\tp = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(tmpNode, node);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'dl':\n\t\t\t\t\t\t\t\tnode.tagName = 'ul';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'dt':\n\t\t\t\t\t\t\tcase 'dd':\n\t\t\t\t\t\t\t\tnode.tagName = 'li';\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'li':\n\t\t\t\t\t\t\t\tvar className = node.getAttr('class');\n\t\t\t\t\t\t\t\tif (!className || !/list\\-/.test(className)) {\n\t\t\t\t\t\t\t\t\tnode.setAttr()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar tmpNodes = node.getNodesByTagName('ol ul');\n\t\t\t\t\t\t\t\tUE.utils.each(tmpNodes, function(n) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(n, node);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'td':\n\t\t\t\t\t\t\tcase 'th':\n\t\t\t\t\t\t\tcase 'caption':\n\t\t\t\t\t\t\t\tif (!node.children || !node.children.length) {\n\t\t\t\t\t\t\t\t\tnode.appendChild(browser.ie11below ? UE.uNode.createText(' ') : UE.uNode.createElement('br'))\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'table':\n\t\t\t\t\t\t\t\tif (me.options.disabledTableInTable && tdParent(node)) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(UE.uNode.createText(node.innerText()), node);\n\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\t//            if(node.type == 'comment'){\n\t\t\t\t\t//                node.parentNode.removeChild(node);\n\t\t\t\t\t//            }\n\t\t\t\t})\n\t\n\t\t\t});\n\t\n\t\t\t//从编辑器出去的内容处理\n\t\t\tme.addOutputRule(function(root) {\n\t\n\t\t\t\tvar val;\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type == 'element') {\n\t\n\t\t\t\t\t\tif (me.options.autoClearEmptyNode && dtd.$inline[node.tagName] && !dtd.$empty[node.tagName] && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\n\t\t\t\t\t\t\tif (!node.firstChild()) node.parentNode.removeChild(node);\n\t\t\t\t\t\t\telse if (node.tagName == 'span' && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\t\tcase 'div':\n\t\t\t\t\t\t\t\tif (val = node.getAttr('cdata_tag')) {\n\t\t\t\t\t\t\t\t\tnode.tagName = val;\n\t\t\t\t\t\t\t\t\tnode.appendChild(UE.uNode.createText(node.getAttr('cdata_data')));\n\t\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\t\tcdata_tag: '',\n\t\t\t\t\t\t\t\t\t\tcdata_data: '',\n\t\t\t\t\t\t\t\t\t\t'_ue_custom_node_': ''\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'a':\n\t\t\t\t\t\t\t\tif (val = node.getAttr('_href')) {\n\t\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\t\t'href': utils.html(val),\n\t\t\t\t\t\t\t\t\t\t'_href': ''\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'span':\n\t\t\t\t\t\t\t\tval = node.getAttr('id');\n\t\t\t\t\t\t\t\tif (val && /^_baidu_bookmark_/i.test(val)) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\t\t\tif (val = node.getAttr('_src')) {\n\t\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\t\t'src': node.getAttr('_src'),\n\t\t\t\t\t\t\t\t\t\t'_src': ''\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t})\n\t\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/inserthtml.js\n\t\t/**\n\t\t * 插入html字符串插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 插入html代码\n\t\t * @command inserthtml\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } html 插入的html字符串\n\t\t * @remaind 插入的标签内容是在当前的选区位置上插入，如果当前是闭合状态，那直接插入内容， 如果当前是选中状态，将先清除当前选中内容后，再做插入\n\t\t * @warning 注意:该命令会对当前选区的位置，对插入的内容进行过滤转换处理。 过滤的规则遵循html语意化的原则。\n\t\t * @example\n\t\t * ```javascript\n\t\t * //xxx[BB]xxx 当前选区为非闭合选区，选中BB这两个文本\n\t\t * //执行命令，插入<b>CC</b>\n\t\t * //插入后的效果 xxx<b>CC</b>xxx\n\t\t * //<p>xx|xxx</p> 当前选区为闭合状态\n\t\t * //插入<p>CC</p>\n\t\t * //结果 <p>xx</p><p>CC</p><p>xxx</p>\n\t\t * //<p>xxxx</p>|</p>xxx</p> 当前选区在两个p标签之间\n\t\t * //插入 xxxx\n\t\t * //结果 <p>xxxx</p><p>xxxx</p></p>xxx</p>\n\t\t * ```\n\t\t */\n\t\n\t\tUE.commands['inserthtml'] = {\n\t\t\texecCommand: function(command, html, notNeedFilter) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange,\n\t\t\t\t\tdiv;\n\t\t\t\tif (!html) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (me.fireEvent('beforeinserthtml', html) === true) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\trange = me.selection.getRange();\n\t\t\t\tdiv = range.document.createElement('div');\n\t\t\t\tdiv.style.display = 'inline';\n\t\n\t\t\t\tif (!notNeedFilter) {\n\t\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t\t//如果给了过滤规则就先进行过滤\n\t\t\t\t\tif (me.options.filterRules) {\n\t\t\t\t\t\tUE.filterNode(root, me.options.filterRules);\n\t\t\t\t\t}\n\t\t\t\t\t//执行默认的处理\n\t\t\t\t\tme.filterInputRule(root);\n\t\t\t\t\thtml = root.toHtml()\n\t\t\t\t}\n\t\t\t\tdiv.innerHTML = utils.trim(html);\n\t\n\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\tvar tmpNode = range.startContainer;\n\t\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\t\trange.setStartBefore(tmpNode)\n\t\t\t\t\t}\n\t\t\t\t\ttmpNode = range.endContainer;\n\t\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\t\trange.setEndAfter(tmpNode)\n\t\t\t\t\t}\n\t\t\t\t\trange.txtToElmBoundary();\n\t\t\t\t\t//结束边界可能放到了br的前边，要把br包含进来\n\t\t\t\t\t// x[xxx]<br/>\n\t\t\t\t\tif (range.endContainer && range.endContainer.nodeType == 1) {\n\t\t\t\t\t\ttmpNode = range.endContainer.childNodes[range.endOffset];\n\t\t\t\t\t\tif (tmpNode && domUtils.isBr(tmpNode)) {\n\t\t\t\t\t\t\trange.setEndAfter(tmpNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\t\ttmpNode = range.startContainer;\n\t\t\t\t\t\tif (domUtils.isBoundaryNode(tmpNode, 'firstChild')) {\n\t\t\t\t\t\t\ttmpNode = range.endContainer;\n\t\t\t\t\t\t\tif (range.endOffset == (tmpNode.nodeType == 3 ? tmpNode.nodeValue.length : tmpNode.childNodes.length) && domUtils.isBoundaryNode(tmpNode, 'lastChild')) {\n\t\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\t\trange.setStart(me.body.firstChild, 0).collapse(true)\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}!range.collapsed && range.deleteContents();\n\t\t\t\t\tif (range.startContainer.nodeType == 1) {\n\t\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset],\n\t\t\t\t\t\t\tpre;\n\t\t\t\t\t\tif (child && domUtils.isBlockElm(child) && (pre = child.previousSibling) && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\trange.setEnd(pre, pre.childNodes.length).collapse();\n\t\t\t\t\t\t\twhile (child.firstChild) {\n\t\t\t\t\t\t\t\tpre.appendChild(child.firstChild);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\tvar child, parent, pre, tmp, hadBreak = 0,\n\t\t\t\t\tnextNode;\n\t\t\t\t//如果当前位置选中了fillchar要干掉，要不会产生空行\n\t\t\t\tif (range.inFillChar()) {\n\t\t\t\t\tchild = range.startContainer;\n\t\t\t\t\tif (domUtils.isFillChar(child)) {\n\t\t\t\t\t\trange.setStartBefore(child).collapse(true);\n\t\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t\t} else if (domUtils.isFillChar(child, true)) {\n\t\t\t\t\t\tchild.nodeValue = child.nodeValue.replace(fillCharReg, '');\n\t\t\t\t\t\trange.startOffset--;\n\t\t\t\t\t\trange.collapsed && range.collapse(true)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//列表单独处理\n\t\t\t\tvar li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\tif (li) {\n\t\t\t\t\tvar next, last;\n\t\t\t\t\twhile (child = div.firstChild) {\n\t\t\t\t\t\t//针对hr单独处理一下先\n\t\t\t\t\t\twhile (child && (child.nodeType == 3 || !domUtils.isBlockElm(child) || child.tagName == 'HR')) {\n\t\t\t\t\t\t\tnext = child.nextSibling;\n\t\t\t\t\t\t\trange.insertNode(child).collapse();\n\t\t\t\t\t\t\tlast = child;\n\t\t\t\t\t\t\tchild = next;\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (child) {\n\t\t\t\t\t\t\tif (/^(ol|ul)$/i.test(child.tagName)) {\n\t\t\t\t\t\t\t\twhile (child.firstChild) {\n\t\t\t\t\t\t\t\t\tlast = child.firstChild;\n\t\t\t\t\t\t\t\t\tdomUtils.insertAfter(li, child.firstChild);\n\t\t\t\t\t\t\t\t\tli = li.nextSibling;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(child)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar tmpLi;\n\t\t\t\t\t\t\t\tnext = child.nextSibling;\n\t\t\t\t\t\t\t\ttmpLi = me.document.createElement('li');\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(li, tmpLi);\n\t\t\t\t\t\t\t\ttmpLi.appendChild(child);\n\t\t\t\t\t\t\t\tlast = child;\n\t\t\t\t\t\t\t\tchild = next;\n\t\t\t\t\t\t\t\tli = tmpLi;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\tif (domUtils.isEmptyBlock(li)) {\n\t\t\t\t\t\tdomUtils.remove(li)\n\t\t\t\t\t}\n\t\t\t\t\tif (last) {\n\t\n\t\t\t\t\t\trange.setStartAfter(last).collapse(true).select(true)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\twhile (child = div.firstChild) {\n\t\t\t\t\t\tif (hadBreak) {\n\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\twhile (child && (child.nodeType == 3 || !dtd.$block[child.tagName])) {\n\t\t\t\t\t\t\t\tnextNode = child.nextSibling;\n\t\t\t\t\t\t\t\tp.appendChild(child);\n\t\t\t\t\t\t\t\tchild = nextNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (p.firstChild) {\n\t\n\t\t\t\t\t\t\t\tchild = p\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.insertNode(child);\n\t\t\t\t\t\tnextNode = child.nextSibling;\n\t\t\t\t\t\tif (!hadBreak && child.nodeType == domUtils.NODE_ELEMENT && domUtils.isBlockElm(child)) {\n\t\n\t\t\t\t\t\t\tparent = domUtils.findParent(child, function(node) {\n\t\t\t\t\t\t\t\treturn domUtils.isBlockElm(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (parent && parent.tagName.toLowerCase() != 'body' && !(dtd[parent.tagName][child.nodeName] && child.parentNode === parent)) {\n\t\t\t\t\t\t\t\tif (!dtd[parent.tagName][child.nodeName]) {\n\t\t\t\t\t\t\t\t\tpre = parent;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmp = child.parentNode;\n\t\t\t\t\t\t\t\t\twhile (tmp !== parent) {\n\t\t\t\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\t\t\t\ttmp = tmp.parentNode;\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tdomUtils.breakParent(child, pre || tmp);\n\t\t\t\t\t\t\t\t//去掉break后前一个多余的节点  <p>|<[p> ==> <p></p><div></div><p>|</p>\n\t\t\t\t\t\t\t\tvar pre = child.previousSibling;\n\t\t\t\t\t\t\t\tdomUtils.trimWhiteTextNode(pre);\n\t\t\t\t\t\t\t\tif (!pre.childNodes.length) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//trace:2012,在非ie的情况，切开后剩下的节点有可能不能点入光标添加br占位\n\t\n\t\t\t\t\t\t\t\tif (!browser.ie &&\n\t\t\t\t\t\t\t\t\t(next = child.nextSibling) &&\n\t\t\t\t\t\t\t\t\tdomUtils.isBlockElm(next) &&\n\t\t\t\t\t\t\t\t\tnext.lastChild &&\n\t\t\t\t\t\t\t\t\t!domUtils.isBr(next.lastChild)) {\n\t\t\t\t\t\t\t\t\tnext.appendChild(me.document.createElement('br'));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thadBreak = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar next = child.nextSibling;\n\t\t\t\t\t\tif (!div.firstChild && next && domUtils.isBlockElm(next)) {\n\t\n\t\t\t\t\t\t\trange.setStart(next, 0).collapse(true);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setEndAfter(child).collapse();\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\tchild = range.startContainer;\n\t\n\t\t\t\t\tif (nextNode && domUtils.isBr(nextNode)) {\n\t\t\t\t\t\tdomUtils.remove(nextNode)\n\t\t\t\t\t}\n\t\t\t\t\t//用chrome可能有空白展位符\n\t\t\t\t\tif (domUtils.isBlockElm(child) && domUtils.isEmptyNode(child)) {\n\t\t\t\t\t\tif (nextNode = child.nextSibling) {\n\t\t\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t\t\t\tif (nextNode.nodeType == 1 && dtd.$block[nextNode.tagName]) {\n\t\n\t\t\t\t\t\t\t\trange.setStart(nextNode, 0).collapse(true).shrinkBoundary()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tchild.innerHTML = browser.ie ? domUtils.fillChar : '<br/>';\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\trange.setStartBefore(child);\n\t\t\t\t\t\t\t\tdomUtils.remove(child)\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\t//加上true因为在删除表情等时会删两次，第一次是删的fillData\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.select(true);\n\t\t\t\t\t} catch (e) {}\n\t\n\t\t\t\t}\n\t\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\trange.scrollToView(me.autoHeightEnabled, me.autoHeightEnabled ? domUtils.getXY(me.iframe).y : 0);\n\t\t\t\t\tme.fireEvent('afterinserthtml', html);\n\t\t\t\t}, 200);\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/autotypeset.js\n\t\t/**\n\t\t * 自动排版\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 对当前编辑器的内容执行自动排版， 排版的行为根据config配置文件里的“autotypeset”选项进行控制。\n\t\t * @command autotypeset\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'autotypeset' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['autotypeset'] = function() {\n\t\n\t\t\tthis.setOpt({\n\t\t\t\t'autotypeset': {\n\t\t\t\t\tmergeEmptyline: true, //合并空行\n\t\t\t\t\tremoveClass: true, //去掉冗余的class\n\t\t\t\t\tremoveEmptyline: false, //去掉空行\n\t\t\t\t\ttextAlign: \"left\", //段落的排版方式，可以是 left,right,center,justify 去掉这个属性表示不执行排版\n\t\t\t\t\timageBlockLine: 'center', //图片的浮动方式，独占一行剧中,左右浮动，默认: center,left,right,none 去掉这个属性表示不执行排版\n\t\t\t\t\tpasteFilter: false, //根据规则过滤没事粘贴进来的内容\n\t\t\t\t\tclearFontSize: false, //去掉所有的内嵌字号，使用编辑器默认的字号\n\t\t\t\t\tclearFontFamily: false, //去掉所有的内嵌字体，使用编辑器默认的字体\n\t\t\t\t\tremoveEmptyNode: false, // 去掉空节点\n\t\t\t\t\t//可以去掉的标签\n\t\t\t\t\tremoveTagNames: utils.extend({\n\t\t\t\t\t\tdiv: 1\n\t\t\t\t\t}, dtd.$removeEmpty),\n\t\t\t\t\tindent: false, // 行首缩进\n\t\t\t\t\tindentValue: '2em', //行首缩进的大小\n\t\t\t\t\tbdc2sb: false,\n\t\t\t\t\ttobdc: false\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tvar me = this,\n\t\t\t\topt = me.options.autotypeset,\n\t\t\t\tremainClass = {\n\t\t\t\t\t'selectTdClass': 1,\n\t\t\t\t\t'pagebreak': 1,\n\t\t\t\t\t'anchorclass': 1\n\t\t\t\t},\n\t\t\t\tremainTag = {\n\t\t\t\t\t'li': 1\n\t\t\t\t},\n\t\t\t\ttags = {\n\t\t\t\t\tdiv: 1,\n\t\t\t\t\tp: 1,\n\t\t\t\t\t//trace:2183 这些也认为是行\n\t\t\t\t\tblockquote: 1,\n\t\t\t\t\tcenter: 1,\n\t\t\t\t\th1: 1,\n\t\t\t\t\th2: 1,\n\t\t\t\t\th3: 1,\n\t\t\t\t\th4: 1,\n\t\t\t\t\th5: 1,\n\t\t\t\t\th6: 1,\n\t\t\t\t\tspan: 1\n\t\t\t\t},\n\t\t\t\thighlightCont;\n\t\t\t//升级了版本，但配置项目里没有autotypeset\n\t\t\tif (!opt) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\treadLocalOpts();\n\t\n\t\t\tfunction isLine(node, notEmpty) {\n\t\t\t\tif (!node || node.nodeType == 3)\n\t\t\t\t\treturn 0;\n\t\t\t\tif (domUtils.isBr(node))\n\t\t\t\t\treturn 1;\n\t\t\t\tif (node && node.parentNode && tags[node.tagName.toLowerCase()]) {\n\t\t\t\t\tif (highlightCont && highlightCont.contains(node) ||\n\t\t\t\t\t\tnode.getAttribute('pagebreak')\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn notEmpty ? !domUtils.isEmptyBlock(node) : domUtils.isEmptyBlock(node, new RegExp('[\\\\s' + domUtils.fillChar + ']', 'g'));\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction removeNotAttributeSpan(node) {\n\t\t\t\tif (!node.style.cssText) {\n\t\t\t\t\tdomUtils.removeAttributes(node, ['style']);\n\t\t\t\t\tif (node.tagName.toLowerCase() == 'span' && domUtils.hasNoAttributes(node)) {\n\t\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction autotype(type, html) {\n\t\n\t\t\t\tvar me = this,\n\t\t\t\t\tcont;\n\t\t\t\tif (html) {\n\t\t\t\t\tif (!opt.pasteFilter) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcont = me.document.createElement('div');\n\t\t\t\t\tcont.innerHTML = html.html;\n\t\t\t\t} else {\n\t\t\t\t\tcont = me.document.body;\n\t\t\t\t}\n\t\t\t\tvar nodes = domUtils.getElementsByTagName(cont, '*');\n\t\n\t\t\t\t// 行首缩进，段落方向，段间距，段内间距\n\t\t\t\tfor (var i = 0, ci; ci = nodes[i++];) {\n\t\n\t\t\t\t\tif (me.fireEvent('excludeNodeinautotype', ci) === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t//font-size\n\t\t\t\t\tif (opt.clearFontSize && ci.style.fontSize) {\n\t\t\t\t\t\tdomUtils.removeStyle(ci, 'font-size');\n\t\n\t\t\t\t\t\tremoveNotAttributeSpan(ci);\n\t\n\t\t\t\t\t}\n\t\t\t\t\t//font-family\n\t\t\t\t\tif (opt.clearFontFamily && ci.style.fontFamily) {\n\t\t\t\t\t\tdomUtils.removeStyle(ci, 'font-family');\n\t\t\t\t\t\tremoveNotAttributeSpan(ci);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (isLine(ci)) {\n\t\t\t\t\t\t//合并空行\n\t\t\t\t\t\tif (opt.mergeEmptyline) {\n\t\t\t\t\t\t\tvar next = ci.nextSibling,\n\t\t\t\t\t\t\t\ttmpNode, isBr = domUtils.isBr(ci);\n\t\t\t\t\t\t\twhile (isLine(next)) {\n\t\t\t\t\t\t\t\ttmpNode = next;\n\t\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\tif (isBr && (!next || next && !domUtils.isBr(next))) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//去掉空行，保留占位的空行\n\t\t\t\t\t\tif (opt.removeEmptyline && domUtils.inDoc(ci, cont) && !remainTag[ci.parentNode.tagName.toLowerCase()]) {\n\t\t\t\t\t\t\tif (domUtils.isBr(ci)) {\n\t\t\t\t\t\t\t\tnext = ci.nextSibling;\n\t\t\t\t\t\t\t\tif (next && !domUtils.isBr(next)) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\tif (isLine(ci, true) && ci.tagName != 'SPAN') {\n\t\t\t\t\t\tif (opt.indent) {\n\t\t\t\t\t\t\tci.style.textIndent = opt.indentValue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opt.textAlign) {\n\t\t\t\t\t\t\tci.style.textAlign = opt.textAlign;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// if(opt.lineHeight)\n\t\t\t\t\t\t//     ci.style.lineHeight = opt.lineHeight + 'cm';\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//去掉class,保留的class不去掉\n\t\t\t\t\tif (opt.removeClass && ci.className && !remainClass[ci.className.toLowerCase()]) {\n\t\n\t\t\t\t\t\tif (highlightCont && highlightCont.contains(ci)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.removeAttributes(ci, ['class']);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//表情不处理\n\t\t\t\t\tif (opt.imageBlockLine && ci.tagName.toLowerCase() == 'img' && !ci.getAttribute('emotion')) {\n\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\tvar img = ci;\n\t\t\t\t\t\t\tswitch (opt.imageBlockLine) {\n\t\t\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\t\t\tvar pN = img.parentNode,\n\t\t\t\t\t\t\t\t\t\ttmpNode, pre, next;\n\t\t\t\t\t\t\t\t\twhile (dtd.$inline[pN.tagName] || pN.tagName == 'A') {\n\t\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\t\tif (tmpNode.tagName == 'P' && domUtils.getStyle(tmpNode, 'text-align') == 'center') {\n\t\t\t\t\t\t\t\t\t\tif (!domUtils.isBody(tmpNode) && domUtils.getChildCount(tmpNode, function(node) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node)\n\t\t\t\t\t\t\t\t\t\t\t}) == 1) {\n\t\t\t\t\t\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\t\t\t\tif (pre && next && pre.nodeType == 1 && next.nodeType == 1 && pre.tagName == next.tagName && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(tmpNode.firstChild);\n\t\t\t\t\t\t\t\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(next.firstChild);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'text-align', '');\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', opt.imageBlockLine);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\t\t\tif (me.queryCommandValue('imagefloat') != 'center') {\n\t\t\t\t\t\t\t\t\t\tpN = img.parentNode;\n\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', 'none');\n\t\t\t\t\t\t\t\t\t\ttmpNode = img;\n\t\t\t\t\t\t\t\t\t\twhile (pN && domUtils.getChildCount(pN, function(node) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node)\n\t\t\t\t\t\t\t\t\t\t\t}) == 1 && (dtd.$inline[pN.tagName] || pN.tagName == 'A')) {\n\t\t\t\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tvar pNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(pNode, {\n\t\n\t\t\t\t\t\t\t\t\t\t\tstyle: 'text-align:center'\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\ttmpNode.parentNode.insertBefore(pNode, tmpNode);\n\t\t\t\t\t\t\t\t\t\tpNode.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'float', '');\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\t\t\trange.selectNode(ci).select();\n\t\t\t\t\t\t\tme.execCommand('imagefloat', opt.imageBlockLine);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//去掉冗余的标签\n\t\t\t\t\tif (opt.removeEmptyNode) {\n\t\t\t\t\t\tif (opt.removeTagNames[ci.tagName.toLowerCase()] && domUtils.hasNoAttributes(ci) && domUtils.isEmptyBlock(ci)) {\n\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (opt.tobdc) {\n\t\t\t\t\tvar root = UE.htmlparser(cont.innerHTML);\n\t\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\t\tif (node.type == 'text') {\n\t\t\t\t\t\t\tnode.data = ToDBC(node.data)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tcont.innerHTML = root.toHtml()\n\t\t\t\t}\n\t\t\t\tif (opt.bdc2sb) {\n\t\t\t\t\tvar root = UE.htmlparser(cont.innerHTML);\n\t\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\t\tif (node.type == 'text') {\n\t\t\t\t\t\t\tnode.data = DBC2SB(node.data)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tcont.innerHTML = root.toHtml()\n\t\t\t\t}\n\t\t\t\tif (html) {\n\t\t\t\t\thtml.html = cont.innerHTML;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (opt.pasteFilter) {\n\t\t\t\tme.addListener('beforepaste', autotype);\n\t\t\t}\n\t\n\t\t\tfunction DBC2SB(str) {\n\t\t\t\tvar result = '';\n\t\t\t\tfor (var i = 0; i < str.length; i++) {\n\t\t\t\t\tvar code = str.charCodeAt(i); //获取当前字符的unicode编码\n\t\t\t\t\tif (code >= 65281 && code <= 65373) //在这个unicode编码范围中的是所有的英文字母已经各种字符\n\t\t\t\t\t{\n\t\t\t\t\t\tresult += String.fromCharCode(str.charCodeAt(i) - 65248); //把全角字符的unicode编码转换为对应半角字符的unicode码\n\t\t\t\t\t} else if (code == 12288) //空格\n\t\t\t\t\t{\n\t\t\t\t\t\tresult += String.fromCharCode(str.charCodeAt(i) - 12288 + 32);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult += str.charAt(i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\n\t\t\tfunction ToDBC(txtstring) {\n\t\t\t\ttxtstring = utils.html(txtstring);\n\t\t\t\tvar tmp = \"\";\n\t\t\t\tvar mark = \"\"; /*用于判断,如果是html尖括里的标记,则不进行全角的转换*/\n\t\t\t\tfor (var i = 0; i < txtstring.length; i++) {\n\t\t\t\t\tif (txtstring.charCodeAt(i) == 32) {\n\t\t\t\t\t\ttmp = tmp + String.fromCharCode(12288);\n\t\t\t\t\t} else if (txtstring.charCodeAt(i) < 127) {\n\t\t\t\t\t\ttmp = tmp + String.fromCharCode(txtstring.charCodeAt(i) + 65248);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttmp += txtstring.charAt(i);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn tmp;\n\t\t\t}\n\t\n\t\t\tfunction readLocalOpts() {\n\t\t\t\tvar cookieOpt = me.getPreferences('autotypeset');\n\t\t\t\tutils.extend(me.options.autotypeset, cookieOpt);\n\t\t\t}\n\t\n\t\t\tme.commands['autotypeset'] = {\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tme.removeListener('beforepaste', autotype);\n\t\t\t\t\tif (opt.pasteFilter) {\n\t\t\t\t\t\tme.addListener('beforepaste', autotype);\n\t\t\t\t\t}\n\t\t\t\t\tautotype.call(me)\n\t\t\t\t}\n\t\n\t\t\t};\n\t\n\t\t};\n\t\n\t\t// plugins/autosubmit.js\n\t\t/**\n\t\t * 快捷键提交\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 提交表单\n\t\t * @command autosubmit\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'autosubmit' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugin.register('autosubmit', function() {\n\t\t\treturn {\n\t\t\t\tshortcutkey: {\n\t\t\t\t\t\"autosubmit\": \"ctrl+13\" //手动提交\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t'autosubmit': {\n\t\t\t\t\t\texecCommand: function() {\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\tform = domUtils.findParentByTagName(me.iframe, \"form\", false);\n\t\t\t\t\t\t\tif (form) {\n\t\t\t\t\t\t\t\tif (me.fireEvent(\"beforesubmit\") === false) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.sync();\n\t\t\t\t\t\t\t\tform.submit();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/background.js\n\t\t/**\n\t\t * 背景插件，为UEditor提供设置背景功能\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\tUE.plugin.register('background', function() {\n\t\t\tvar me = this,\n\t\t\t\tcssRuleId = 'editor_background',\n\t\t\t\tisSetColored,\n\t\t\t\treg = new RegExp('body[\\\\s]*\\\\{(.+)\\\\}', 'i');\n\t\n\t\t\tfunction stringToObj(str) {\n\t\t\t\tvar obj = {},\n\t\t\t\t\tstyles = str.split(';');\n\t\t\t\tutils.each(styles, function(v) {\n\t\t\t\t\tvar index = v.indexOf(':'),\n\t\t\t\t\t\tkey = utils.trim(v.substr(0, index)).toLowerCase();\n\t\t\t\t\tkey && (obj[key] = utils.trim(v.substr(index + 1) || ''));\n\t\t\t\t});\n\t\t\t\treturn obj;\n\t\t\t}\n\t\n\t\t\tfunction setBackground(obj) {\n\t\t\t\tif (obj) {\n\t\t\t\t\tvar styles = [];\n\t\t\t\t\tfor (var name in obj) {\n\t\t\t\t\t\tif (obj.hasOwnProperty(name)) {\n\t\t\t\t\t\t\tstyles.push(name + \":\" + obj[name] + '; ');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tutils.cssRule(cssRuleId, styles.length ? ('body{' + styles.join(\"\") + '}') : '', me.document);\n\t\t\t\t} else {\n\t\t\t\t\tutils.cssRule(cssRuleId, '', me.document)\n\t\t\t\t}\n\t\t\t}\n\t\t\t//重写editor.hasContent方法\n\t\n\t\t\tvar orgFn = me.hasContents;\n\t\t\tme.hasContents = function() {\n\t\t\t\tif (me.queryCommandValue('background')) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn orgFn.apply(me, arguments);\n\t\t\t};\n\t\t\treturn {\n\t\t\t\tbindEvents: {\n\t\t\t\t\t'getAllHtml': function(type, headHtml) {\n\t\t\t\t\t\tvar body = this.body,\n\t\t\t\t\t\t\tsu = domUtils.getComputedStyle(body, \"background-image\"),\n\t\t\t\t\t\t\turl = \"\";\n\t\t\t\t\t\tif (su.indexOf(me.options.imagePath) > 0) {\n\t\t\t\t\t\t\turl = su.substring(su.indexOf(me.options.imagePath), su.length - 1).replace(/\"|\\(|\\)/ig, \"\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\turl = su != \"none\" ? su.replace(/url\\(\"?|\"?\\)/ig, \"\") : \"\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar html = '<style type=\"text/css\">body{';\n\t\t\t\t\t\tvar bgObj = {\n\t\t\t\t\t\t\t\"background-color\": domUtils.getComputedStyle(body, \"background-color\") || \"#ffffff\",\n\t\t\t\t\t\t\t'background-image': url ? 'url(' + url + ')' : '',\n\t\t\t\t\t\t\t'background-repeat': domUtils.getComputedStyle(body, \"background-repeat\") || \"\",\n\t\t\t\t\t\t\t'background-position': browser.ie ? (domUtils.getComputedStyle(body, \"background-position-x\") + \" \" + domUtils.getComputedStyle(body, \"background-position-y\")) : domUtils.getComputedStyle(body, \"background-position\"),\n\t\t\t\t\t\t\t'height': domUtils.getComputedStyle(body, \"height\")\n\t\t\t\t\t\t};\n\t\t\t\t\t\tfor (var name in bgObj) {\n\t\t\t\t\t\t\tif (bgObj.hasOwnProperty(name)) {\n\t\t\t\t\t\t\t\thtml += name + \":\" + bgObj[name] + \"; \";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\thtml += '}</style> ';\n\t\t\t\t\t\theadHtml.push(html);\n\t\t\t\t\t},\n\t\t\t\t\t'aftersetcontent': function() {\n\t\t\t\t\t\tif (isSetColored == false) setBackground();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinputRule: function(root) {\n\t\t\t\t\tisSetColored = false;\n\t\t\t\t\tutils.each(root.getNodesByTagName('p'), function(p) {\n\t\t\t\t\t\tvar styles = p.getAttr('data-background');\n\t\t\t\t\t\tif (styles) {\n\t\t\t\t\t\t\tisSetColored = true;\n\t\t\t\t\t\t\tsetBackground(stringToObj(styles));\n\t\t\t\t\t\t\tp.parentNode.removeChild(p);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\toutputRule: function(root) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tstyles = (utils.cssRule(cssRuleId, me.document) || '').replace(/[\\n\\r]+/g, '').match(reg);\n\t\t\t\t\tif (styles) {\n\t\t\t\t\t\troot.appendChild(UE.uNode.createElement('<p style=\"display:none;\" data-background=\"' + utils.trim(styles[1].replace(/\"/g, '').replace(/[\\s]+/g, ' ')) + '\"><br/></p>'));\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t'background': {\n\t\t\t\t\t\texecCommand: function(cmd, obj) {\n\t\t\t\t\t\t\tsetBackground(obj);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\tstyles = (utils.cssRule(cssRuleId, me.document) || '').replace(/[\\n\\r]+/g, '').match(reg);\n\t\t\t\t\t\t\treturn styles ? stringToObj(styles[1]) : null;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/image.js\n\t\t/**\n\t\t * 图片插入、排版插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 图片对齐方式\n\t\t * @command imagefloat\n\t\t * @method execCommand\n\t\t * @remind 值center为独占一行居中\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } align 对齐方式，可传left、right、none、center\n\t\t * @remaind center表示图片独占一行\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'imagefloat', 'center' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 如果选区所在位置是图片区域\n\t\t * @command imagefloat\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回图片对齐方式\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'imagefloat' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.commands['imagefloat'] = {\n\t\t\texecCommand: function(cmd, align) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\tvar img = range.getClosedNode();\n\t\t\t\t\tif (img && img.tagName == 'IMG') {\n\t\t\t\t\t\tswitch (align) {\n\t\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\t\tvar pN = img.parentNode,\n\t\t\t\t\t\t\t\t\ttmpNode, pre, next;\n\t\t\t\t\t\t\t\twhile (dtd.$inline[pN.tagName] || pN.tagName == 'A') {\n\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\tif (tmpNode.tagName == 'P' && domUtils.getStyle(tmpNode, 'text-align') == 'center') {\n\t\t\t\t\t\t\t\t\tif (!domUtils.isBody(tmpNode) && domUtils.getChildCount(tmpNode, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t\t\t\t\t\t}) == 1) {\n\t\t\t\t\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\t\t\tif (pre && next && pre.nodeType == 1 && next.nodeType == 1 && pre.tagName == next.tagName && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(tmpNode.firstChild);\n\t\t\t\t\t\t\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(next.firstChild);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'text-align', '');\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\trange.selectNode(img).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', align == 'none' ? '' : align);\n\t\t\t\t\t\t\t\tif (align == 'none') {\n\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(img, 'align');\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\t\tif (me.queryCommandValue('imagefloat') != 'center') {\n\t\t\t\t\t\t\t\t\tpN = img.parentNode;\n\t\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', '');\n\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(img, 'align');\n\t\t\t\t\t\t\t\t\ttmpNode = img;\n\t\t\t\t\t\t\t\t\twhile (pN && domUtils.getChildCount(pN, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t\t\t\t\t\t}) == 1 && (dtd.$inline[pN.tagName] || pN.tagName == 'A')) {\n\t\t\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trange.setStartBefore(tmpNode).setCursor(false);\n\t\t\t\t\t\t\t\t\tpN = me.document.createElement('div');\n\t\t\t\t\t\t\t\t\tpN.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'float', '');\n\t\n\t\t\t\t\t\t\t\t\tme.execCommand('insertHtml', '<p id=\"_img_parent_tmp\" style=\"text-align:center\">' + pN.innerHTML + '</p>');\n\t\n\t\t\t\t\t\t\t\t\ttmpNode = me.document.getElementById('_img_parent_tmp');\n\t\t\t\t\t\t\t\t\ttmpNode.removeAttribute('id');\n\t\t\t\t\t\t\t\t\ttmpNode = tmpNode.firstChild;\n\t\t\t\t\t\t\t\t\trange.selectNode(tmpNode).select();\n\t\t\t\t\t\t\t\t\t//去掉后边多余的元素\n\t\t\t\t\t\t\t\t\tnext = tmpNode.parentNode.nextSibling;\n\t\t\t\t\t\t\t\t\tif (next && domUtils.isEmptyNode(next)) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tstartNode, floatStyle;\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\treturn 'none';\n\t\t\t\t}\n\t\t\t\tstartNode = range.getClosedNode();\n\t\t\t\tif (startNode && startNode.nodeType == 1 && startNode.tagName == 'IMG') {\n\t\t\t\t\tfloatStyle = domUtils.getComputedStyle(startNode, 'float') || startNode.getAttribute('align');\n\t\n\t\t\t\t\tif (floatStyle == 'none') {\n\t\t\t\t\t\tfloatStyle = domUtils.getComputedStyle(startNode.parentNode, 'text-align') == 'center' ? 'center' : floatStyle;\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tleft: 1,\n\t\t\t\t\t\tright: 1,\n\t\t\t\t\t\tcenter: 1\n\t\t\t\t\t}[floatStyle] ? floatStyle: 'none';\n\t\t\t\t}\n\t\t\t\treturn 'none';\n\t\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tstartNode;\n\t\n\t\t\t\tif (range.collapsed) return -1;\n\t\n\t\t\t\tstartNode = range.getClosedNode();\n\t\t\t\tif (startNode && startNode.nodeType == 1 && startNode.tagName == 'IMG') {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t};\n\t\n\t\t/**\n\t\t * 插入图片\n\t\t * @command insertimage\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { Object } opt 属性键值对，这些属性都将被复制到当前插入图片\n\t\t * @remind 该命令第二个参数可接受一个图片配置项对象的数组，可以插入多张图片，\n\t\t * 此时数组的每一个元素都是一个Object类型的图片属性集合。\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertimage', {\n\t\t *     src:'a/b/c.jpg',\n\t\t *     width:'100',\n\t\t *     height:'100'\n\t\t * } );\n\t\t * ```\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertimage', [{\n\t\t *     src:'a/b/c.jpg',\n\t\t *     width:'100',\n\t\t *     height:'100'\n\t\t * },{\n\t\t *     src:'a/b/d.jpg',\n\t\t *     width:'100',\n\t\t *     height:'100'\n\t\t * }] );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.commands['insertimage'] = {\n\t\t\texecCommand: function(cmd, opt) {\n\t\n\t\t\t\topt = utils.isArray(opt) ? opt : [opt];\n\t\t\t\tif (!opt.length) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar me = this,\n\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\timg = range.getClosedNode();\n\t\n\t\t\t\tif (me.fireEvent('beforeinsertimage', opt) === true) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tfunction unhtmlData(imgCi) {\n\t\n\t\t\t\t\tutils.each('width,height,border,hspace,vspace'.split(','), function(item) {\n\t\n\t\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\t\timgCi[item] = parseInt(imgCi[item], 10) || 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\tutils.each('src,_src'.split(','), function(item) {\n\t\n\t\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\t\timgCi[item] = utils.unhtmlForUrl(imgCi[item]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tutils.each('title,alt'.split(','), function(item) {\n\t\n\t\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\t\timgCi[item] = utils.unhtml(imgCi[item]);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t\tif (img && /img/i.test(img.tagName) && (img.className != \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1) && !img.getAttribute(\"word_img\")) {\n\t\t\t\t\tvar first = opt.shift();\n\t\t\t\t\tvar floatStyle = first['floatStyle'];\n\t\t\t\t\tdelete first['floatStyle'];\n\t\t\t\t\t////                img.style.border = (first.border||0) +\"px solid #000\";\n\t\t\t\t\t////                img.style.margin = (first.margin||0) +\"px\";\n\t\t\t\t\t//                img.style.cssText += ';margin:' + (first.margin||0) +\"px;\" + 'border:' + (first.border||0) +\"px solid #000\";\n\t\t\t\t\tdomUtils.setAttributes(img, first);\n\t\t\t\t\tme.execCommand('imagefloat', floatStyle);\n\t\t\t\t\tif (opt.length > 0) {\n\t\t\t\t\t\trange.setStartAfter(img).setCursor(false, true);\n\t\t\t\t\t\tme.execCommand('insertimage', opt);\n\t\t\t\t\t}\n\t\n\t\t\t\t} else {\n\t\t\t\t\tvar html = [],\n\t\t\t\t\t\tstr = '',\n\t\t\t\t\t\tci;\n\t\t\t\t\tci = opt[0];\n\t\t\t\t\tif (opt.length == 1) {\n\t\t\t\t\t\tunhtmlData(ci);\n\t\n\t\t\t\t\t\tstr = '<img src=\"' + ci.src + '\" ' + (ci._src ? ' _src=\"' + ci._src + '\" ' : '') +\n\t\t\t\t\t\t\t(ci.width ? 'width=\"' + ci.width + '\" ' : '') +\n\t\t\t\t\t\t\t(ci.height ? ' height=\"' + ci.height + '\" ' : '') +\n\t\t\t\t\t\t\t(ci['floatStyle'] == 'left' || ci['floatStyle'] == 'right' ? ' style=\"float:' + ci['floatStyle'] + ';\"' : '') +\n\t\t\t\t\t\t\t(ci.title && ci.title != \"\" ? ' title=\"' + ci.title + '\"' : '') +\n\t\t\t\t\t\t\t(ci.border && ci.border != \"0\" ? ' border=\"' + ci.border + '\"' : '') +\n\t\t\t\t\t\t\t(ci.alt && ci.alt != \"\" ? ' alt=\"' + ci.alt + '\"' : '') +\n\t\t\t\t\t\t\t(ci.hspace && ci.hspace != \"0\" ? ' hspace = \"' + ci.hspace + '\"' : '') +\n\t\t\t\t\t\t\t(ci.vspace && ci.vspace != \"0\" ? ' vspace = \"' + ci.vspace + '\"' : '') + '/>';\n\t\t\t\t\t\tif (ci['floatStyle'] == 'center') {\n\t\t\t\t\t\t\tstr = '<p style=\"text-align: center\">' + str + '</p>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\thtml.push(str);\n\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (var i = 0; ci = opt[i++];) {\n\t\t\t\t\t\t\tunhtmlData(ci);\n\t\t\t\t\t\t\tstr = '<p ' + (ci['floatStyle'] == 'center' ? 'style=\"text-align: center\" ' : '') + '><img src=\"' + ci.src + '\" ' +\n\t\t\t\t\t\t\t\t(ci.width ? 'width=\"' + ci.width + '\" ' : '') + (ci._src ? ' _src=\"' + ci._src + '\" ' : '') +\n\t\t\t\t\t\t\t\t(ci.height ? ' height=\"' + ci.height + '\" ' : '') +\n\t\t\t\t\t\t\t\t' style=\"' + (ci['floatStyle'] && ci['floatStyle'] != 'center' ? 'float:' + ci['floatStyle'] + ';' : '') +\n\t\t\t\t\t\t\t\t(ci.border || '') + '\" ' +\n\t\t\t\t\t\t\t\t(ci.title ? ' title=\"' + ci.title + '\"' : '') + ' /></p>';\n\t\t\t\t\t\t\thtml.push(str);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tme.execCommand('insertHtml', html.join(''));\n\t\t\t\t}\n\t\n\t\t\t\tme.fireEvent('afterinsertimage', opt)\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/justify.js\n\t\t/**\n\t\t * 段落格式\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 段落对齐方式\n\t\t * @command justify\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } align 对齐方式：left => 居左，right => 居右，center => 居中，justify => 两端对齐\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'justify', 'center' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 如果选区所在位置是段落区域，返回当前段落对齐方式\n\t\t * @command justify\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回段落对齐方式\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'justify' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['justify'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tblock = domUtils.isBlockElm,\n\t\t\t\tdefaultValue = {\n\t\t\t\t\tleft: 1,\n\t\t\t\t\tright: 1,\n\t\t\t\t\tcenter: 1,\n\t\t\t\t\tjustify: 1\n\t\t\t\t},\n\t\t\t\tdoJustify = function(range, style) {\n\t\t\t\t\tvar bookmark = range.createBookmark(),\n\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t\t};\n\t\n\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\t\ttmpNode;\n\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\t\t\t\t\t\tvar common = tmpRange.getCommonAncestor();\n\t\t\t\t\t\t\tif (!domUtils.isBody(common) && block(common)) {\n\t\t\t\t\t\t\t\tdomUtils.setStyles(common, utils.isString(style) ? {\n\t\t\t\t\t\t\t\t\t'text-align': style\n\t\t\t\t\t\t\t\t} : style);\n\t\t\t\t\t\t\t\tcurrent = common;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar p = range.document.createElement('p');\n\t\t\t\t\t\t\t\tdomUtils.setStyles(p, utils.isString(style) ? {\n\t\t\t\t\t\t\t\t\t'text-align': style\n\t\t\t\t\t\t\t\t} : style);\n\t\t\t\t\t\t\t\tvar frag = tmpRange.extractContents();\n\t\t\t\t\t\t\t\tp.appendChild(frag);\n\t\t\t\t\t\t\t\ttmpRange.insertNode(p);\n\t\t\t\t\t\t\t\tcurrent = p;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t\t};\n\t\n\t\t\tUE.commands['justify'] = {\n\t\t\t\texecCommand: function(cmdName, align) {\n\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\ttxt;\n\t\n\t\t\t\t\t//闭合时单独处理\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\ttxt = this.document.createTextNode('p');\n\t\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t\t}\n\t\t\t\t\tdoJustify(range, align);\n\t\t\t\t\tif (txt) {\n\t\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t\t}\n\t\n\t\t\t\t\trange.select();\n\t\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\tvar startNode = this.selection.getStart(),\n\t\t\t\t\t\tvalue = domUtils.getComputedStyle(startNode, 'text-align');\n\t\t\t\t\treturn defaultValue[value] ? value : 'left';\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar start = this.selection.getStart(),\n\t\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\n\t\t\t\t\treturn cell ? -1 : 0;\n\t\t\t\t}\n\t\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/font.js\n\t\t/**\n\t\t * 字体颜色,背景色,字号,字体,下划线,删除线\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 字体颜色\n\t\t * @command forecolor\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } value 色值(必须十六进制)\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'forecolor', '#000' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 返回选区字体颜色\n\t\t * @command forecolor\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回字体颜色\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'forecolor' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 字体背景颜色\n\t\t * @command backcolor\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } value 色值(必须十六进制)\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'backcolor', '#000' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 返回选区字体颜色\n\t\t * @command backcolor\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回字体背景颜色\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'backcolor' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 字体大小\n\t\t * @command fontsize\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } value 字体大小\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'fontsize', '14px' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 返回选区字体大小\n\t\t * @command fontsize\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回字体大小\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'fontsize' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 字体样式\n\t\t * @command fontfamily\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } value 字体样式\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'fontfamily', '微软雅黑' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 返回选区字体样式\n\t\t * @command fontfamily\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回字体样式\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'fontfamily' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 字体下划线,与删除线互斥\n\t\t * @command underline\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'underline' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 字体删除线,与下划线互斥\n\t\t * @command strikethrough\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'strikethrough' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 字体边框\n\t\t * @command fontborder\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'fontborder' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['font'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tfonts = {\n\t\t\t\t\t'forecolor': 'color',\n\t\t\t\t\t'backcolor': 'background-color',\n\t\t\t\t\t'fontsize': 'font-size',\n\t\t\t\t\t'fontfamily': 'font-family',\n\t\t\t\t\t'underline': 'text-decoration',\n\t\t\t\t\t'strikethrough': 'text-decoration',\n\t\t\t\t\t'fontborder': 'border'\n\t\t\t\t},\n\t\t\t\tneedCmd = {\n\t\t\t\t\t'underline': 1,\n\t\t\t\t\t'strikethrough': 1,\n\t\t\t\t\t'fontborder': 1\n\t\t\t\t},\n\t\t\t\tneedSetChild = {\n\t\t\t\t\t'forecolor': 'color',\n\t\t\t\t\t'backcolor': 'background-color',\n\t\t\t\t\t'fontsize': 'font-size',\n\t\t\t\t\t'fontfamily': 'font-family'\n\t\n\t\t\t\t};\n\t\t\tme.setOpt({\n\t\t\t\t'fontfamily': [{\n\t\t\t\t\tname: 'songti',\n\t\t\t\t\tval: '宋体,SimSun'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'yahei',\n\t\t\t\t\tval: '微软雅黑,Microsoft YaHei'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'kaiti',\n\t\t\t\t\tval: '楷体,楷体_GB2312, SimKai'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'heiti',\n\t\t\t\t\tval: '黑体, SimHei'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'lishu',\n\t\t\t\t\tval: '隶书, SimLi'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'andaleMono',\n\t\t\t\t\tval: 'andale mono'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'arial',\n\t\t\t\t\tval: 'arial, helvetica,sans-serif'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'arialBlack',\n\t\t\t\t\tval: 'arial black,avant garde'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'comicSansMs',\n\t\t\t\t\tval: 'comic sans ms'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'impact',\n\t\t\t\t\tval: 'impact,chicago'\n\t\t\t\t}, {\n\t\t\t\t\tname: 'timesNewRoman',\n\t\t\t\t\tval: 'times new roman'\n\t\t\t\t}],\n\t\t\t\t'fontsize': [10, 11, 12, 14, 16, 18, 20, 24, 36]\n\t\t\t});\n\t\n\t\t\tfunction mergeWithParent(node) {\n\t\t\t\tvar parent;\n\t\t\t\twhile (parent = node.parentNode) {\n\t\t\t\t\tif (parent.tagName == 'SPAN' && domUtils.getChildCount(parent, function(child) {\n\t\t\t\t\t\t\treturn !domUtils.isBookmarkNode(child) && !domUtils.isBr(child)\n\t\t\t\t\t\t}) == 1) {\n\t\t\t\t\t\tparent.style.cssText += node.style.cssText;\n\t\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t\t\tnode = parent;\n\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tfunction mergeChild(rng, cmdName, value) {\n\t\t\t\tif (needSetChild[cmdName]) {\n\t\t\t\t\trng.adjustmentBoundary();\n\t\t\t\t\tif (!rng.collapsed && rng.startContainer.nodeType == 1) {\n\t\t\t\t\t\tvar start = rng.startContainer.childNodes[rng.startOffset];\n\t\t\t\t\t\tif (start && domUtils.isTagNode(start, 'span')) {\n\t\t\t\t\t\t\tvar bk = rng.createBookmark();\n\t\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(start, 'span'), function(span) {\n\t\t\t\t\t\t\t\tif (!span.parentNode || domUtils.isBookmarkNode(span)) return;\n\t\t\t\t\t\t\t\tif (cmdName == 'backcolor' && domUtils.getComputedStyle(span, 'background-color').toLowerCase() === value) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.removeStyle(span, needSetChild[cmdName]);\n\t\t\t\t\t\t\t\tif (span.style.cssText.replace(/^\\s+$/, '').length == 0) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(span, true)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\trng.moveToBookmark(bk)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tfunction mergesibling(rng, cmdName, value) {\n\t\t\t\tvar collapsed = rng.collapsed,\n\t\t\t\t\tbk = rng.createBookmark(),\n\t\t\t\t\tcommon;\n\t\t\t\tif (collapsed) {\n\t\t\t\t\tcommon = bk.start.parentNode;\n\t\t\t\t\twhile (dtd.$inline[common.tagName]) {\n\t\t\t\t\t\tcommon = common.parentNode;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcommon = domUtils.getCommonAncestor(bk.start, bk.end);\n\t\t\t\t}\n\t\t\t\tutils.each(domUtils.getElementsByTagName(common, 'span'), function(span) {\n\t\t\t\t\tif (!span.parentNode || domUtils.isBookmarkNode(span)) return;\n\t\t\t\t\tif (/\\s*border\\s*:\\s*none;?\\s*/i.test(span.style.cssText)) {\n\t\t\t\t\t\tif (/^\\s*border\\s*:\\s*none;?\\s*$/.test(span.style.cssText)) {\n\t\t\t\t\t\t\tdomUtils.remove(span, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.removeStyle(span, 'border');\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\t\t\t\t\tif (/border/i.test(span.style.cssText) && span.parentNode.tagName == 'SPAN' && /border/i.test(span.parentNode.style.cssText)) {\n\t\t\t\t\t\tspan.style.cssText = span.style.cssText.replace(/border[^:]*:[^;]+;?/gi, '');\n\t\t\t\t\t}\n\t\t\t\t\tif (!(cmdName == 'fontborder' && value == 'none')) {\n\t\t\t\t\t\tvar next = span.nextSibling;\n\t\t\t\t\t\twhile (next && next.nodeType == 1 && next.tagName == 'SPAN') {\n\t\t\t\t\t\t\tif (domUtils.isBookmarkNode(next) && cmdName == 'fontborder') {\n\t\t\t\t\t\t\t\tspan.appendChild(next);\n\t\t\t\t\t\t\t\tnext = span.nextSibling;\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (next.style.cssText == span.style.cssText) {\n\t\t\t\t\t\t\t\tdomUtils.moveChild(next, span);\n\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (span.nextSibling === next)\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tnext = span.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tmergeWithParent(span);\n\t\t\t\t\tif (browser.ie && browser.version > 8) {\n\t\t\t\t\t\t//拷贝父亲们的特别的属性,这里只做背景颜色的处理\n\t\t\t\t\t\tvar parent = domUtils.findParent(span, function(n) {\n\t\t\t\t\t\t\treturn n.tagName == 'SPAN' && /background-color/.test(n.style.cssText)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (parent && !/background-color/.test(span.style.cssText)) {\n\t\t\t\t\t\t\tspan.style.backgroundColor = parent.style.backgroundColor;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t\trng.moveToBookmark(bk);\n\t\t\t\tmergeChild(rng, cmdName, value)\n\t\t\t}\n\t\n\t\t\tme.addInputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('u s del font strike'), function(node) {\n\t\t\t\t\tif (node.tagName == 'font') {\n\t\t\t\t\t\tvar cssStyle = [];\n\t\t\t\t\t\tfor (var p in node.attrs) {\n\t\t\t\t\t\t\tswitch (p) {\n\t\t\t\t\t\t\t\tcase 'size':\n\t\t\t\t\t\t\t\t\tcssStyle.push('font-size:' +\n\t\t\t\t\t\t\t\t\t\t({\n\t\t\t\t\t\t\t\t\t\t\t'1': '10',\n\t\t\t\t\t\t\t\t\t\t\t'2': '12',\n\t\t\t\t\t\t\t\t\t\t\t'3': '16',\n\t\t\t\t\t\t\t\t\t\t\t'4': '18',\n\t\t\t\t\t\t\t\t\t\t\t'5': '24',\n\t\t\t\t\t\t\t\t\t\t\t'6': '32',\n\t\t\t\t\t\t\t\t\t\t\t'7': '48'\n\t\t\t\t\t\t\t\t\t\t}[node.attrs[p]] || node.attrs[p]) + 'px');\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'color':\n\t\t\t\t\t\t\t\t\tcssStyle.push('color:' + node.attrs[p]);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'face':\n\t\t\t\t\t\t\t\t\tcssStyle.push('font-family:' + node.attrs[p]);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\t\t\tcssStyle.push(node.attrs[p]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.attrs = {\n\t\t\t\t\t\t\t'style': cssStyle.join(';')\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar val = node.tagName == 'u' ? 'underline' : 'line-through';\n\t\t\t\t\t\tnode.attrs = {\n\t\t\t\t\t\t\t'style': (node.getAttr('style') || '') + 'text-decoration:' + val + ';'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnode.tagName = 'span';\n\t\t\t\t});\n\t\t\t\t//        utils.each(root.getNodesByTagName('span'), function (node) {\n\t\t\t\t//            var val;\n\t\t\t\t//            if(val = node.getAttr('class')){\n\t\t\t\t//                if(/fontstrikethrough/.test(val)){\n\t\t\t\t//                    node.setStyle('text-decoration','line-through');\n\t\t\t\t//                    if(node.attrs['class']){\n\t\t\t\t//                        node.attrs['class'] = node.attrs['class'].replace(/fontstrikethrough/,'');\n\t\t\t\t//                    }else{\n\t\t\t\t//                        node.setAttr('class')\n\t\t\t\t//                    }\n\t\t\t\t//                }\n\t\t\t\t//                if(/fontborder/.test(val)){\n\t\t\t\t//                    node.setStyle('border','1px solid #000');\n\t\t\t\t//                    if(node.attrs['class']){\n\t\t\t\t//                        node.attrs['class'] = node.attrs['class'].replace(/fontborder/,'');\n\t\t\t\t//                    }else{\n\t\t\t\t//                        node.setAttr('class')\n\t\t\t\t//                    }\n\t\t\t\t//                }\n\t\t\t\t//            }\n\t\t\t\t//        });\n\t\t\t});\n\t\t\t//    me.addOutputRule(function(root){\n\t\t\t//        utils.each(root.getNodesByTagName('span'), function (node) {\n\t\t\t//            var val;\n\t\t\t//            if(val = node.getStyle('text-decoration')){\n\t\t\t//                if(/line-through/.test(val)){\n\t\t\t//                    if(node.attrs['class']){\n\t\t\t//                        node.attrs['class'] += ' fontstrikethrough';\n\t\t\t//                    }else{\n\t\t\t//                        node.setAttr('class','fontstrikethrough')\n\t\t\t//                    }\n\t\t\t//                }\n\t\t\t//\n\t\t\t//                node.setStyle('text-decoration')\n\t\t\t//            }\n\t\t\t//            if(val = node.getStyle('border')){\n\t\t\t//                if(/1px/.test(val) && /solid/.test(val)){\n\t\t\t//                    if(node.attrs['class']){\n\t\t\t//                        node.attrs['class'] += ' fontborder';\n\t\t\t//\n\t\t\t//                    }else{\n\t\t\t//                        node.setAttr('class','fontborder')\n\t\t\t//                    }\n\t\t\t//                }\n\t\t\t//                node.setStyle('border')\n\t\t\t//\n\t\t\t//            }\n\t\t\t//        });\n\t\t\t//    });\n\t\t\tfor (var p in fonts) {\n\t\t\t\t(function(cmd, style) {\n\t\t\t\t\tUE.commands[cmd] = {\n\t\t\t\t\t\texecCommand: function(cmdName, value) {\n\t\t\t\t\t\t\tvalue = value || (this.queryCommandState(cmdName) ? 'none' : cmdName == 'underline' ? 'underline' :\n\t\t\t\t\t\t\t\tcmdName == 'fontborder' ? '1px solid #000' :\n\t\t\t\t\t\t\t\t'line-through');\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\trange = this.selection.getRange(),\n\t\t\t\t\t\t\t\ttext;\n\t\n\t\t\t\t\t\t\tif (value == 'default') {\n\t\n\t\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\t\ttext = me.document.createTextNode('font');\n\t\t\t\t\t\t\t\t\trange.insertNode(text).select();\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\t\tif (text) {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(text).collapse(true);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\trange.select()\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\t\t\tif (needCmd[cmd] && me.queryCommandValue(cmd)) {\n\t\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\n\t\t\t\t\t\t\t\t\trange.applyInlineStyle('span', {\n\t\t\t\t\t\t\t\t\t\t'style': style + ':' + value\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\t\t\tvar span = domUtils.findParentByTagName(range.startContainer, 'span', true);\n\t\t\t\t\t\t\t\t\ttext = me.document.createTextNode('font');\n\t\t\t\t\t\t\t\t\tif (span && !span.children.length && !span[browser.ie ? 'innerText' : 'textContent'].replace(fillCharReg, '').length) {\n\t\t\t\t\t\t\t\t\t\t//for ie hack when enter\n\t\t\t\t\t\t\t\t\t\trange.insertNode(text);\n\t\t\t\t\t\t\t\t\t\tif (needCmd[cmd]) {\n\t\t\t\t\t\t\t\t\t\t\trange.selectNode(text).select();\n\t\t\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style, null);\n\t\n\t\t\t\t\t\t\t\t\t\t\tspan = domUtils.findParentByTagName(text, 'span', true);\n\t\t\t\t\t\t\t\t\t\t\trange.setStartBefore(text);\n\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tspan && (span.style.cssText += ';' + style + ':' + value);\n\t\t\t\t\t\t\t\t\t\trange.collapse(true).select();\n\t\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trange.insertNode(text);\n\t\t\t\t\t\t\t\t\t\trange.selectNode(text).select();\n\t\t\t\t\t\t\t\t\t\tspan = range.document.createElement('span');\n\t\n\t\t\t\t\t\t\t\t\t\tif (needCmd[cmd]) {\n\t\t\t\t\t\t\t\t\t\t\t//a标签内的不处理跳过\n\t\t\t\t\t\t\t\t\t\t\tif (domUtils.findParentByTagName(text, 'a', true)) {\n\t\t\t\t\t\t\t\t\t\t\t\trange.setStartBefore(text).setCursor();\n\t\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t\tspan.style.cssText = style + ':' + value;\n\t\n\t\t\t\t\t\t\t\t\t\ttext.parentNode.insertBefore(span, text);\n\t\t\t\t\t\t\t\t\t\t//修复，span套span 但样式不继承的问题\n\t\t\t\t\t\t\t\t\t\tif (!browser.ie || browser.ie && browser.version == 9) {\n\t\t\t\t\t\t\t\t\t\t\tvar spanParent = span.parentNode;\n\t\t\t\t\t\t\t\t\t\t\twhile (!domUtils.isBlockElm(spanParent)) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (spanParent.tagName == 'SPAN') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t//opera合并style不会加入\";\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tspan.style.cssText = spanParent.style.cssText + \";\" + span.style.cssText;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tspanParent = spanParent.parentNode;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t\tif (opera) {\n\t\t\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\t\trange.setStart(span, 0).collapse(true);\n\t\t\t\t\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\trange.setStart(span, 0).collapse(true);\n\t\t\t\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t\t//trace:981\n\t\t\t\t\t\t\t\t\t\t//domUtils.mergeToParent(span)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandValue: function(cmdName) {\n\t\t\t\t\t\t\tvar startNode = this.selection.getStart();\n\t\n\t\t\t\t\t\t\t//trace:946\n\t\t\t\t\t\t\tif (cmdName == 'underline' || cmdName == 'strikethrough') {\n\t\t\t\t\t\t\t\tvar tmpNode = startNode,\n\t\t\t\t\t\t\t\t\tvalue;\n\t\t\t\t\t\t\t\twhile (tmpNode && !domUtils.isBlockElm(tmpNode) && !domUtils.isBody(tmpNode)) {\n\t\t\t\t\t\t\t\t\tif (tmpNode.nodeType == 1) {\n\t\t\t\t\t\t\t\t\t\tvalue = domUtils.getComputedStyle(tmpNode, style);\n\t\t\t\t\t\t\t\t\t\tif (value != 'none') {\n\t\t\t\t\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\ttmpNode = tmpNode.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn 'none';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (cmdName == 'fontborder') {\n\t\t\t\t\t\t\t\tvar tmp = startNode,\n\t\t\t\t\t\t\t\t\tval;\n\t\t\t\t\t\t\t\twhile (tmp && dtd.$inline[tmp.tagName]) {\n\t\t\t\t\t\t\t\t\tif (val = domUtils.getComputedStyle(tmp, 'border')) {\n\t\n\t\t\t\t\t\t\t\t\t\tif (/1px/.test(val) && /solid/.test(val)) {\n\t\t\t\t\t\t\t\t\t\t\treturn val;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttmp = tmp.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn ''\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (cmdName == 'FontSize') {\n\t\t\t\t\t\t\t\tvar styleVal = domUtils.getComputedStyle(startNode, style),\n\t\t\t\t\t\t\t\t\ttmp = /^([\\d\\.]+)(\\w+)$/.exec(styleVal);\n\t\n\t\t\t\t\t\t\t\tif (tmp) {\n\t\n\t\t\t\t\t\t\t\t\treturn Math.floor(tmp[1]) + tmp[2];\n\t\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\treturn styleVal;\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\treturn domUtils.getComputedStyle(startNode, style);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\t\t\t\tif (!needCmd[cmdName])\n\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\tvar val = this.queryCommandValue(cmdName);\n\t\t\t\t\t\t\tif (cmdName == 'fontborder') {\n\t\t\t\t\t\t\t\treturn /1px/.test(val) && /solid/.test(val)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn cmdName == 'underline' ? /underline/.test(val) : /line\\-through/.test(val);\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t})(p, fonts[p]);\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/link.js\n\t\t/**\n\t\t * 超链接\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 插入超链接\n\t\t * @command link\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { Object } options   设置自定义属性，例如：url、title、target\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'link', '{\n\t\t *     url:'ueditor.baidu.com',\n\t\t *     title:'ueditor',\n\t\t *     target:'_blank'\n\t\t * }' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 返回当前选中的第一个超链接节点\n\t\t * @command link\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { Element } 超链接节点\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'link' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 取消超链接\n\t\t * @command unlink\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'unlink');\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['link'] = function() {\n\t\t\tfunction optimize(range) {\n\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\tend = range.endContainer;\n\t\n\t\t\t\tif (start = domUtils.findParentByTagName(start, 'a', true)) {\n\t\t\t\t\trange.setStartBefore(start);\n\t\t\t\t}\n\t\t\t\tif (end = domUtils.findParentByTagName(end, 'a', true)) {\n\t\t\t\t\trange.setEndAfter(end);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tUE.commands['unlink'] = {\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\tbookmark;\n\t\t\t\t\tif (range.collapsed && !domUtils.findParentByTagName(range.startContainer, 'a', true)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tbookmark = range.createBookmark();\n\t\t\t\t\toptimize(range);\n\t\t\t\t\trange.removeInlineStyle('a').moveToBookmark(bookmark).select();\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn !this.highlight && this.queryCommandValue('link') ? 0 : -1;\n\t\t\t\t}\n\t\n\t\t\t};\n\t\n\t\t\tfunction doLink(range, opt, me) {\n\t\t\t\tvar rngClone = range.cloneRange(),\n\t\t\t\t\tlink = me.queryCommandValue('link');\n\t\t\t\toptimize(range = range.adjustmentBoundary());\n\t\t\t\tvar start = range.startContainer;\n\t\t\t\tif (start.nodeType == 1 && link) {\n\t\t\t\t\tstart = start.childNodes[range.startOffset];\n\t\t\t\t\tif (start && start.nodeType == 1 && start.tagName == 'A' && /^(?:https?|ftp|file)\\s*:\\s*\\/\\//.test(start[browser.ie ? 'innerText' : 'textContent'])) {\n\t\t\t\t\t\tstart[browser.ie ? 'innerText' : 'textContent'] = utils.html(opt.textValue || opt.href);\n\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!rngClone.collapsed || link) {\n\t\t\t\t\trange.removeInlineStyle('a');\n\t\t\t\t\trngClone = range.cloneRange();\n\t\t\t\t}\n\t\n\t\t\t\tif (rngClone.collapsed) {\n\t\t\t\t\tvar a = range.document.createElement('a'),\n\t\t\t\t\t\ttext = '';\n\t\t\t\t\tif (opt.textValue) {\n\t\n\t\t\t\t\t\ttext = utils.html(opt.textValue);\n\t\t\t\t\t\tdelete opt.textValue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttext = utils.html(opt.href);\n\t\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.setAttributes(a, opt);\n\t\t\t\t\tstart = domUtils.findParentByTagName(rngClone.startContainer, 'a', true);\n\t\t\t\t\tif (start && domUtils.isInNodeEndBoundary(rngClone, start)) {\n\t\t\t\t\t\trange.setStartAfter(start).collapse(true);\n\t\n\t\t\t\t\t}\n\t\t\t\t\ta[browser.ie ? 'innerText' : 'textContent'] = text;\n\t\t\t\t\trange.insertNode(a).selectNode(a);\n\t\t\t\t} else {\n\t\t\t\t\trange.applyInlineStyle('a', opt);\n\t\n\t\t\t\t}\n\t\t\t}\n\t\t\tUE.commands['link'] = {\n\t\t\t\texecCommand: function(cmdName, opt) {\n\t\t\t\t\tvar range;\n\t\t\t\t\topt._href && (opt._href = utils.unhtml(opt._href, /[<\">]/g));\n\t\t\t\t\topt.href && (opt.href = utils.unhtml(opt.href, /[<\">]/g));\n\t\t\t\t\topt.textValue && (opt.textValue = utils.unhtml(opt.textValue, /[<\">]/g));\n\t\t\t\t\tdoLink(range = this.selection.getRange(), opt, this);\n\t\t\t\t\t//闭合都不加占位符，如果加了会在a后边多个占位符节点，导致a是图片背景组成的列表，出现空白问题\n\t\t\t\t\trange.collapse().select(true);\n\t\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\tnode;\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t//                    node = this.selection.getStart();\n\t\t\t\t\t\t//在ie下getstart()取值偏上了\n\t\t\t\t\t\tnode = range.startContainer;\n\t\t\t\t\t\tnode = node.nodeType == 1 ? node : node.parentNode;\n\t\n\t\t\t\t\t\tif (node && (node = domUtils.findParentByTagName(node, 'a', true)) && !domUtils.isInNodeEndBoundary(range, node)) {\n\t\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//trace:1111  如果是<p><a>xx</a></p> startContainer是p就会找不到a\n\t\t\t\t\t\trange.shrinkBoundary();\n\t\t\t\t\t\tvar start = range.startContainer.nodeType == 3 || !range.startContainer.childNodes[range.startOffset] ? range.startContainer : range.startContainer.childNodes[range.startOffset],\n\t\t\t\t\t\t\tend = range.endContainer.nodeType == 3 || range.endOffset == 0 ? range.endContainer : range.endContainer.childNodes[range.endOffset - 1],\n\t\t\t\t\t\t\tcommon = range.getCommonAncestor();\n\t\t\t\t\t\tnode = domUtils.findParentByTagName(common, 'a', true);\n\t\t\t\t\t\tif (!node && common.nodeType == 1) {\n\t\n\t\t\t\t\t\t\tvar as = common.getElementsByTagName('a'),\n\t\t\t\t\t\t\t\tps, pe;\n\t\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = as[i++];) {\n\t\t\t\t\t\t\t\tps = domUtils.getPosition(ci, start), pe = domUtils.getPosition(ci, end);\n\t\t\t\t\t\t\t\tif ((ps & domUtils.POSITION_FOLLOWING || ps & domUtils.POSITION_CONTAINS) &&\n\t\t\t\t\t\t\t\t\t(pe & domUtils.POSITION_PRECEDING || pe & domUtils.POSITION_CONTAINS)\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tnode = ci;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t//判断如果是视频的话连接不可用\n\t\t\t\t\t//fix 853\n\t\t\t\t\tvar img = this.selection.getRange().getClosedNode(),\n\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1);\n\t\t\t\t\treturn flag ? -1 : 0;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/iframe.js\n\t\t///import core\n\t\t///import plugins\\inserthtml.js\n\t\t///commands 插入框架\n\t\t///commandsName  InsertFrame\n\t\t///commandsTitle  插入Iframe\n\t\t///commandsDialog  dialogs\\insertframe\n\t\n\t\tUE.plugins['insertframe'] = function() {\n\t\t\tvar me = this;\n\t\n\t\t\tfunction deleteIframe() {\n\t\t\t\tme._iframe && delete me._iframe;\n\t\t\t}\n\t\n\t\t\tme.addListener(\"selectionchange\", function() {\n\t\t\t\tdeleteIframe();\n\t\t\t});\n\t\n\t\t};\n\t\n\t\t// plugins/scrawl.js\n\t\t///import core\n\t\t///commands 涂鸦\n\t\t///commandsName  Scrawl\n\t\t///commandsTitle  涂鸦\n\t\t///commandsDialog  dialogs\\scrawl\n\t\tUE.commands['scrawl'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn (browser.ie && browser.version <= 8) ? -1 : 0;\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/removeformat.js\n\t\t/**\n\t\t * 清除格式\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 清除文字样式\n\t\t * @command removeformat\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param   {String}   tags     以逗号隔开的标签。如：strong\n\t\t * @param   {String}   style    样式如：color\n\t\t * @param   {String}   attrs    属性如:width\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'removeformat', 'strong','color','width' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['removeformat'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt({\n\t\t\t\t'removeFormatTags': 'b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var',\n\t\t\t\t'removeFormatAttributes': 'class,style,lang,width,height,align,hspace,valign'\n\t\t\t});\n\t\t\tme.commands['removeformat'] = {\n\t\t\t\texecCommand: function(cmdName, tags, style, attrs, notIncludeA) {\n\t\n\t\t\t\t\tvar tagReg = new RegExp('^(?:' + (tags || this.options.removeFormatTags).replace(/,/g, '|') + ')$', 'i'),\n\t\t\t\t\t\tremoveFormatAttributes = style ? [] : (attrs || this.options.removeFormatAttributes).split(','),\n\t\t\t\t\t\trange = new dom.Range(this.document),\n\t\t\t\t\t\tbookmark, node, parent,\n\t\t\t\t\t\tfilter = function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t\t};\n\t\n\t\t\t\t\tfunction isRedundantSpan(node) {\n\t\t\t\t\t\tif (node.nodeType == 3 || node.tagName.toLowerCase() != 'span') {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\t//ie 下判断实效，所以只能简单用style来判断\n\t\t\t\t\t\t\t//return node.style.cssText == '' ? 1 : 0;\n\t\t\t\t\t\t\tvar attrs = node.attributes;\n\t\t\t\t\t\t\tif (attrs.length) {\n\t\t\t\t\t\t\t\tfor (var i = 0, l = attrs.length; i < l; i++) {\n\t\t\t\t\t\t\t\t\tif (attrs[i].specified) {\n\t\t\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn !node.attributes.length;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction doRemove(range) {\n\t\n\t\t\t\t\t\tvar bookmark1 = range.createBookmark();\n\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t//不能把a标签切了\n\t\t\t\t\t\tif (!notIncludeA) {\n\t\t\t\t\t\t\tvar aNode = domUtils.findParentByTagName(range.startContainer, 'a', true);\n\t\t\t\t\t\t\tif (aNode) {\n\t\t\t\t\t\t\t\trange.setStartBefore(aNode);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\taNode = domUtils.findParentByTagName(range.endContainer, 'a', true);\n\t\t\t\t\t\t\tif (aNode) {\n\t\t\t\t\t\t\t\trange.setEndAfter(aNode);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tbookmark = range.createBookmark();\n\t\n\t\t\t\t\t\tnode = bookmark.start;\n\t\n\t\t\t\t\t\t//切开始\n\t\t\t\t\t\twhile ((parent = node.parentNode) && !domUtils.isBlockElm(parent)) {\n\t\t\t\t\t\t\tdomUtils.breakParent(node, parent);\n\t\n\t\t\t\t\t\t\tdomUtils.clearEmptySibling(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (bookmark.end) {\n\t\t\t\t\t\t\t//切结束\n\t\t\t\t\t\t\tnode = bookmark.end;\n\t\t\t\t\t\t\twhile ((parent = node.parentNode) && !domUtils.isBlockElm(parent)) {\n\t\t\t\t\t\t\t\tdomUtils.breakParent(node, parent);\n\t\t\t\t\t\t\t\tdomUtils.clearEmptySibling(node);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t//开始去除样式\n\t\t\t\t\t\t\tvar current = domUtils.getNextDomNode(bookmark.start, false, filter),\n\t\t\t\t\t\t\t\tnext;\n\t\t\t\t\t\t\twhile (current) {\n\t\t\t\t\t\t\t\tif (current == bookmark.end) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tnext = domUtils.getNextDomNode(current, true, filter);\n\t\n\t\t\t\t\t\t\t\tif (!dtd.$empty[current.tagName.toLowerCase()] && !domUtils.isBookmarkNode(current)) {\n\t\t\t\t\t\t\t\t\tif (tagReg.test(current.tagName)) {\n\t\t\t\t\t\t\t\t\t\tif (style) {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.removeStyle(current, style);\n\t\t\t\t\t\t\t\t\t\t\tif (isRedundantSpan(current) && style != 'text-decoration') {\n\t\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t//trace:939  不能把list上的样式去掉\n\t\t\t\t\t\t\t\t\t\tif (!dtd.$tableContent[current.tagName] && !dtd.$list[current.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(current, removeFormatAttributes);\n\t\t\t\t\t\t\t\t\t\t\tif (isRedundantSpan(current)) {\n\t\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcurrent = next;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//trace:1035\n\t\t\t\t\t\t//trace:1096 不能把td上的样式去掉，比如边框\n\t\t\t\t\t\tvar pN = bookmark.start.parentNode;\n\t\t\t\t\t\tif (domUtils.isBlockElm(pN) && !dtd.$tableContent[pN.tagName] && !dtd.$list[pN.tagName]) {\n\t\t\t\t\t\t\tdomUtils.removeAttributes(pN, removeFormatAttributes);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpN = bookmark.end.parentNode;\n\t\t\t\t\t\tif (bookmark.end && domUtils.isBlockElm(pN) && !dtd.$tableContent[pN.tagName] && !dtd.$list[pN.tagName]) {\n\t\t\t\t\t\t\tdomUtils.removeAttributes(pN, removeFormatAttributes);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.moveToBookmark(bookmark).moveToBookmark(bookmark1);\n\t\t\t\t\t\t//清除冗余的代码 <b><bookmark></b>\n\t\t\t\t\t\tvar node = range.startContainer,\n\t\t\t\t\t\t\ttmp,\n\t\t\t\t\t\t\tcollapsed = range.collapsed;\n\t\t\t\t\t\twhile (node.nodeType == 1 && domUtils.isEmptyNode(node) && dtd.$removeEmpty[node.tagName]) {\n\t\t\t\t\t\t\ttmp = node.parentNode;\n\t\t\t\t\t\t\trange.setStartBefore(node);\n\t\t\t\t\t\t\t//trace:937\n\t\t\t\t\t\t\t//更新结束边界\n\t\t\t\t\t\t\tif (range.startContainer === range.endContainer) {\n\t\t\t\t\t\t\t\trange.endOffset--;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (!collapsed) {\n\t\t\t\t\t\t\tnode = range.endContainer;\n\t\t\t\t\t\t\twhile (node.nodeType == 1 && domUtils.isEmptyNode(node) && dtd.$removeEmpty[node.tagName]) {\n\t\t\t\t\t\t\t\ttmp = node.parentNode;\n\t\t\t\t\t\t\t\trange.setEndBefore(node);\n\t\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\n\t\t\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\t\tdoRemove(range);\n\t\t\t\t\trange.select();\n\t\n\t\t\t\t}\n\t\n\t\t\t};\n\t\n\t\t};\n\t\n\t\t// plugins/blockquote.js\n\t\t/**\n\t\t * 添加引用\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 添加引用\n\t\t * @command blockquote\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'blockquote' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 添加引用\n\t\t * @command blockquote\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { Object } attrs 节点属性\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'blockquote',{\n\t\t *     style: \"color: red;\"\n\t\t * } );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['blockquote'] = function() {\n\t\t\tvar me = this;\n\t\n\t\t\tfunction getObj(editor) {\n\t\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), 'blockquote');\n\t\t\t}\n\t\t\tme.commands['blockquote'] = {\n\t\t\t\texecCommand: function(cmdName, attrs) {\n\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\tobj = getObj(this),\n\t\t\t\t\t\tblockquote = dtd.blockquote,\n\t\t\t\t\t\tbookmark = range.createBookmark();\n\t\n\t\t\t\t\tif (obj) {\n\t\n\t\t\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\t\t\tstartBlock = domUtils.isBlockElm(start) ? start : domUtils.findParent(start, function(node) {\n\t\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t\t}),\n\t\n\t\t\t\t\t\t\tend = range.endContainer,\n\t\t\t\t\t\t\tendBlock = domUtils.isBlockElm(end) ? end : domUtils.findParent(end, function(node) {\n\t\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t//处理一下li\n\t\t\t\t\t\tstartBlock = domUtils.findParentByTagName(startBlock, 'li', true) || startBlock;\n\t\t\t\t\t\tendBlock = domUtils.findParentByTagName(endBlock, 'li', true) || endBlock;\n\t\n\t\t\t\t\t\tif (startBlock.tagName == 'LI' || startBlock.tagName == 'TD' || startBlock === obj || domUtils.isBody(startBlock)) {\n\t\t\t\t\t\t\tdomUtils.remove(obj, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.breakParent(startBlock, obj);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (startBlock !== endBlock) {\n\t\t\t\t\t\t\tobj = domUtils.findParentByTagName(endBlock, 'blockquote');\n\t\t\t\t\t\t\tif (obj) {\n\t\t\t\t\t\t\t\tif (endBlock.tagName == 'LI' || endBlock.tagName == 'TD' || domUtils.isBody(endBlock)) {\n\t\t\t\t\t\t\t\t\tobj.parentNode && domUtils.remove(obj, true);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdomUtils.breakParent(endBlock, obj);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tvar blockquotes = domUtils.getElementsByTagName(this.document, 'blockquote');\n\t\t\t\t\t\tfor (var i = 0, bi; bi = blockquotes[i++];) {\n\t\t\t\t\t\t\tif (!bi.childNodes.length) {\n\t\t\t\t\t\t\t\tdomUtils.remove(bi);\n\t\t\t\t\t\t\t} else if (domUtils.getPosition(bi, startBlock) & domUtils.POSITION_FOLLOWING && domUtils.getPosition(bi, endBlock) & domUtils.POSITION_PRECEDING) {\n\t\t\t\t\t\t\t\tdomUtils.remove(bi, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\t\t\t\tnode = tmpRange.startContainer.nodeType == 1 ? tmpRange.startContainer : tmpRange.startContainer.parentNode,\n\t\t\t\t\t\t\tpreNode = node,\n\t\t\t\t\t\t\tdoEnd = 1;\n\t\n\t\t\t\t\t\t//调整开始\n\t\t\t\t\t\twhile (1) {\n\t\t\t\t\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\t\t\t\t\tif (preNode !== node) {\n\t\t\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\t\t\ttmpRange.selectNode(preNode);\n\t\t\t\t\t\t\t\t\t\tdoEnd = 0;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\ttmpRange.setStartBefore(preNode);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpRange.setStart(node, 0);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!blockquote[node.tagName]) {\n\t\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\t\ttmpRange.selectNode(preNode);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpRange.setStartBefore(preNode);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tpreNode = node;\n\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t//调整结束\n\t\t\t\t\t\tif (doEnd) {\n\t\t\t\t\t\t\tpreNode = node = node = tmpRange.endContainer.nodeType == 1 ? tmpRange.endContainer : tmpRange.endContainer.parentNode;\n\t\t\t\t\t\t\twhile (1) {\n\t\n\t\t\t\t\t\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\t\t\t\t\t\tif (preNode !== node) {\n\t\n\t\t\t\t\t\t\t\t\t\ttmpRange.setEndAfter(preNode);\n\t\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\ttmpRange.setEnd(node, node.childNodes.length);\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!blockquote[node.tagName]) {\n\t\t\t\t\t\t\t\t\ttmpRange.setEndAfter(preNode);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tpreNode = node;\n\t\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tnode = range.document.createElement('blockquote');\n\t\t\t\t\t\tdomUtils.setAttributes(node, attrs);\n\t\t\t\t\t\tnode.appendChild(tmpRange.extractContents());\n\t\t\t\t\t\ttmpRange.insertNode(node);\n\t\t\t\t\t\t//去除重复的\n\t\t\t\t\t\tvar childs = domUtils.getElementsByTagName(node, 'blockquote');\n\t\t\t\t\t\tfor (var i = 0, ci; ci = childs[i++];) {\n\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bookmark).select();\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getObj(this) ? 1 : 0;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/convertcase.js\n\t\t/**\n\t\t * 大小写转换\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 把选区内文本变大写，与“tolowercase”命令互斥\n\t\t * @command touppercase\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'touppercase' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 把选区内文本变小写，与“touppercase”命令互斥\n\t\t * @command tolowercase\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'tolowercase' );\n\t\t * ```\n\t\t */\n\t\tUE.commands['touppercase'] =\n\t\t\tUE.commands['tolowercase'] = {\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\treturn rng;\n\t\t\t\t\t}\n\t\t\t\t\tvar bk = rng.createBookmark(),\n\t\t\t\t\t\tbkEnd = bk.end,\n\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcurNode = domUtils.getNextDomNode(bk.start, false, filterFn);\n\t\t\t\t\twhile (curNode && (domUtils.getPosition(curNode, bkEnd) & domUtils.POSITION_PRECEDING)) {\n\t\n\t\t\t\t\t\tif (curNode.nodeType == 3) {\n\t\t\t\t\t\t\tcurNode.nodeValue = curNode.nodeValue[cmd == 'touppercase' ? 'toUpperCase' : 'toLowerCase']();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurNode = domUtils.getNextDomNode(curNode, true, filterFn);\n\t\t\t\t\t\tif (curNode === bkEnd) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t// plugins/indent.js\n\t\t/**\n\t\t * 首行缩进\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 缩进\n\t\t * @command indent\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'indent' );\n\t\t * ```\n\t\t */\n\t\tUE.commands['indent'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tvalue = me.queryCommandState(\"indent\") ? \"0em\" : (me.options.indentValue || '2em');\n\t\t\t\tme.execCommand('Paragraph', 'p', {\n\t\t\t\t\tstyle: 'text-indent:' + value\n\t\t\t\t});\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), 'p h1 h2 h3 h4 h5 h6');\n\t\t\t\treturn pN && pN.style.textIndent && parseInt(pN.style.textIndent) ? 1 : 0;\n\t\t\t}\n\t\n\t\t};\n\t\n\t\t// plugins/print.js\n\t\t/**\n\t\t * 打印\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 打印\n\t\t * @command print\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'print' );\n\t\t * ```\n\t\t */\n\t\tUE.commands['print'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tthis.window.print();\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\t\n\t\t// plugins/preview.js\n\t\t/**\n\t\t * 预览\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 预览\n\t\t * @command preview\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'preview' );\n\t\t * ```\n\t\t */\n\t\tUE.commands['preview'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tvar w = window.open('', '_blank', ''),\n\t\t\t\t\td = w.document;\n\t\t\t\td.open();\n\t\t\t\td.write('<!DOCTYPE html><html><head><meta charset=\"utf-8\"/><script src=\"' + this.options.UEDITOR_HOME_URL + 'ueditor.parse.js\"></script><script>' +\n\t\t\t\t\t\"setTimeout(function(){uParse('div',{rootPath: '\" + this.options.UEDITOR_HOME_URL + \"'})},300)\" +\n\t\t\t\t\t'</script></head><body><div>' + this.getContent(null, null, true) + '</div></body></html>');\n\t\t\t\td.close();\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\t\n\t\t// plugins/selectall.js\n\t\t/**\n\t\t * 全选\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 选中所有内容\n\t\t * @command selectall\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'selectall' );\n\t\t * ```\n\t\t */\n\t\tUE.plugins['selectall'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.commands['selectall'] = {\n\t\t\t\texecCommand: function() {\n\t\t\t\t\t//去掉了原生的selectAll,因为会出现报错和当内容为空时，不能出现闭合状态的光标\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tbody = me.body,\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\trange.selectNodeContents(body);\n\t\t\t\t\tif (domUtils.isEmptyBlock(body)) {\n\t\t\t\t\t\t//opera不能自动合并到元素的里边，要手动处理一下\n\t\t\t\t\t\tif (browser.opera && body.firstChild && body.firstChild.nodeType == 1) {\n\t\t\t\t\t\t\trange.setStartAtFirst(body.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t\trange.select(true);\n\t\t\t\t},\n\t\t\t\tnotNeedUndo: 1\n\t\t\t};\n\t\n\t\t\t//快捷键\n\t\t\tme.addshortcutkey({\n\t\t\t\t\"selectAll\": \"ctrl+65\"\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/paragraph.js\n\t\t/**\n\t\t * 段落样式\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 段落格式\n\t\t * @command paragraph\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param {String}   style               标签值为：'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'\n\t\t * @param {Object}   attrs               标签的属性\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'Paragraph','h1','{\n\t\t *     class:'test'\n\t\t * }' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 返回选区内节点标签名\n\t\t * @command paragraph\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 节点标签名\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'Paragraph' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['paragraph'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tblock = domUtils.isBlockElm,\n\t\t\t\tnotExchange = ['TD', 'LI', 'PRE'],\n\t\n\t\t\t\tdoParagraph = function(range, style, attrs, sourceCmdName) {\n\t\t\t\t\tvar bookmark = range.createBookmark(),\n\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tpara;\n\t\n\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\t\ttmpNode;\n\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\n\t\t\t\t\t\t\tpara = range.document.createElement(style);\n\t\t\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(para, attrs);\n\t\t\t\t\t\t\t\tif (sourceCmdName && sourceCmdName == 'customstyle' && attrs.style) {\n\t\t\t\t\t\t\t\t\tpara.style.cssText = attrs.style;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpara.appendChild(tmpRange.extractContents());\n\t\t\t\t\t\t\t//需要内容占位\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(para)) {\n\t\t\t\t\t\t\t\tdomUtils.fillChar(range.document, para);\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\ttmpRange.insertNode(para);\n\t\n\t\t\t\t\t\t\tvar parent = para.parentNode;\n\t\t\t\t\t\t\t//如果para上一级是一个block元素且不是body,td就删除它\n\t\t\t\t\t\t\tif (block(parent) && !domUtils.isBody(para.parentNode) && utils.indexOf(notExchange, parent.tagName) == -1) {\n\t\t\t\t\t\t\t\t//存储dir,style\n\t\t\t\t\t\t\t\tif (!(sourceCmdName && sourceCmdName == 'customstyle')) {\n\t\t\t\t\t\t\t\t\tparent.getAttribute('dir') && para.setAttribute('dir', parent.getAttribute('dir'));\n\t\t\t\t\t\t\t\t\t//trace:1070\n\t\t\t\t\t\t\t\t\tparent.style.cssText && (para.style.cssText = parent.style.cssText + ';' + para.style.cssText);\n\t\t\t\t\t\t\t\t\t//trace:1030\n\t\t\t\t\t\t\t\t\tparent.style.textAlign && !para.style.textAlign && (para.style.textAlign = parent.style.textAlign);\n\t\t\t\t\t\t\t\t\tparent.style.textIndent && !para.style.textIndent && (para.style.textIndent = parent.style.textIndent);\n\t\t\t\t\t\t\t\t\tparent.style.padding && !para.style.padding && (para.style.padding = parent.style.padding);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t//trace:1706 选择的就是h1-6要删除\n\t\t\t\t\t\t\t\tif (attrs && /h\\d/i.test(parent.tagName) && !/h\\d/i.test(para.tagName)) {\n\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(parent, attrs);\n\t\t\t\t\t\t\t\t\tif (sourceCmdName && sourceCmdName == 'customstyle' && attrs.style) {\n\t\t\t\t\t\t\t\t\t\tparent.style.cssText = attrs.style;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(para, true);\n\t\t\t\t\t\t\t\t\tpara = parent;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(para.parentNode, true);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (utils.indexOf(notExchange, parent.tagName) != -1) {\n\t\t\t\t\t\t\t\tcurrent = parent;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcurrent = para;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t\t};\n\t\t\tme.setOpt('paragraph', {\n\t\t\t\t'p': '',\n\t\t\t\t'h1': '',\n\t\t\t\t'h2': '',\n\t\t\t\t'h3': '',\n\t\t\t\t'h4': '',\n\t\t\t\t'h5': '',\n\t\t\t\t'h6': ''\n\t\t\t});\n\t\t\tme.commands['paragraph'] = {\n\t\t\t\texecCommand: function(cmdName, style, attrs, sourceCmdName) {\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\t//闭合时单独处理\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\tvar txt = this.document.createTextNode('p');\n\t\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t\t\t//去掉冗余的fillchar\n\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\tvar node = txt.previousSibling;\n\t\t\t\t\t\t\tif (node && domUtils.isWhitespace(node)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode = txt.nextSibling;\n\t\t\t\t\t\t\tif (node && domUtils.isWhitespace(node)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\trange = doParagraph(range, style, attrs, sourceCmdName);\n\t\t\t\t\tif (txt) {\n\t\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\t\tpN = txt.parentNode;\n\t\n\t\t\t\t\t\tdomUtils.remove(txt);\n\t\n\t\t\t\t\t\tif (domUtils.isBlockElm(pN) && domUtils.isEmptyNode(pN)) {\n\t\t\t\t\t\t\tdomUtils.fillNode(this.document, pN);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (browser.gecko && range.collapsed && range.startContainer.nodeType == 1) {\n\t\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset];\n\t\t\t\t\t\tif (child && child.nodeType == 1 && child.tagName.toLowerCase() == style) {\n\t\t\t\t\t\t\trange.setStart(child, 0).collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//trace:1097 原来有true，原因忘了，但去了就不能清除多余的占位符了\n\t\t\t\t\trange.select();\n\t\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\tvar node = domUtils.filterNodeList(this.selection.getStartElementPath(), 'p h1 h2 h3 h4 h5 h6');\n\t\t\t\t\treturn node ? node.tagName.toLowerCase() : '';\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/directionality.js\n\t\t/**\n\t\t * 设置文字输入的方向的插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\t(function() {\n\t\t\tvar block = domUtils.isBlockElm,\n\t\t\t\tgetObj = function(editor) {\n\t\t\t\t\t//            var startNode = editor.selection.getStart(),\n\t\t\t\t\t//                parents;\n\t\t\t\t\t//            if ( startNode ) {\n\t\t\t\t\t//                //查找所有的是block的父亲节点\n\t\t\t\t\t//                parents = domUtils.findParents( startNode, true, block, true );\n\t\t\t\t\t//                for ( var i = 0,ci; ci = parents[i++]; ) {\n\t\t\t\t\t//                    if ( ci.getAttribute( 'dir' ) ) {\n\t\t\t\t\t//                        return ci;\n\t\t\t\t\t//                    }\n\t\t\t\t\t//                }\n\t\t\t\t\t//            }\n\t\t\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), function(n) {\n\t\t\t\t\t\treturn n && n.nodeType == 1 && n.getAttribute('dir')\n\t\t\t\t\t});\n\t\n\t\t\t\t},\n\t\t\t\tdoDirectionality = function(range, editor, forward) {\n\t\n\t\t\t\t\tvar bookmark,\n\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1 ? !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t\t},\n\t\n\t\t\t\t\t\tobj = getObj(editor);\n\t\n\t\t\t\t\tif (obj && range.collapsed) {\n\t\t\t\t\t\tobj.setAttribute('dir', forward);\n\t\t\t\t\t\treturn range;\n\t\t\t\t\t}\n\t\t\t\t\tbookmark = range.createBookmark();\n\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\t\ttmpNode;\n\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\t\t\t\t\t\tvar common = tmpRange.getCommonAncestor();\n\t\t\t\t\t\t\tif (!domUtils.isBody(common) && block(common)) {\n\t\t\t\t\t\t\t\t//遍历到了block节点\n\t\t\t\t\t\t\t\tcommon.setAttribute('dir', forward);\n\t\t\t\t\t\t\t\tcurrent = common;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//没有遍历到，添加一个block节点\n\t\t\t\t\t\t\t\tvar p = range.document.createElement('p');\n\t\t\t\t\t\t\t\tp.setAttribute('dir', forward);\n\t\t\t\t\t\t\t\tvar frag = tmpRange.extractContents();\n\t\t\t\t\t\t\t\tp.appendChild(frag);\n\t\t\t\t\t\t\t\ttmpRange.insertNode(p);\n\t\t\t\t\t\t\t\tcurrent = p;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t\t};\n\t\n\t\t\t/**\n\t\t\t * 文字输入方向\n\t\t\t * @command directionality\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmdName 命令字符串\n\t\t\t * @param { String } forward 传入'ltr'表示从左向右输入，传入'rtl'表示从右向左输入\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'directionality', 'ltr');\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 查询当前选区的文字输入方向\n\t\t\t * @command directionality\n\t\t\t * @method queryCommandValue\n\t\t\t * @param { String } cmdName 命令字符串\n\t\t\t * @return { String } 返回'ltr'表示从左向右输入，返回'rtl'表示从右向左输入\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandValue( 'directionality');\n\t\t\t * ```\n\t\t\t */\n\t\t\tUE.commands['directionality'] = {\n\t\t\t\texecCommand: function(cmdName, forward) {\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\t//闭合时单独处理\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\tvar txt = this.document.createTextNode('d');\n\t\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t\t}\n\t\t\t\t\tdoDirectionality(range, this, forward);\n\t\t\t\t\tif (txt) {\n\t\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t\t}\n\t\n\t\t\t\t\trange.select();\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\tvar node = getObj(this);\n\t\t\t\t\treturn node ? node.getAttribute('dir') : 'ltr';\n\t\t\t\t}\n\t\t\t};\n\t\t})();\n\t\n\t\t// plugins/horizontal.js\n\t\t/**\n\t\t * 插入分割线插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 插入分割线\n\t\t * @command horizontal\n\t\t * @method execCommand\n\t\t * @param { String } cmdName 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'horizontal' );\n\t\t * ```\n\t\t */\n\t\tUE.plugins['horizontal'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.commands['horizontal'] = {\n\t\t\t\texecCommand: function(cmdName) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (me.queryCommandState(cmdName) !== -1) {\n\t\t\t\t\t\tme.execCommand('insertHtml', '<hr>');\n\t\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\tif (start.nodeType == 1 && !start.childNodes[range.startOffset]) {\n\t\n\t\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\t\tif (tmp = start.childNodes[range.startOffset - 1]) {\n\t\t\t\t\t\t\t\tif (tmp.nodeType == 1 && tmp.tagName == 'HR') {\n\t\t\t\t\t\t\t\t\tif (me.options.enterTag == 'p') {\n\t\t\t\t\t\t\t\t\t\ttmp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\t\t\trange.setStart(tmp, 0).setCursor();\n\t\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\ttmp = me.document.createElement('br');\n\t\t\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\t\t\trange.setStartBefore(tmp).setCursor();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\t//边界在table里不能加分隔线\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn domUtils.filterNodeList(this.selection.getStartElementPath(), 'table') ? -1 : 0;\n\t\t\t\t}\n\t\t\t};\n\t\t\t//    me.addListener('delkeyup',function(){\n\t\t\t//        var rng = this.selection.getRange();\n\t\t\t//        if(browser.ie && browser.version > 8){\n\t\t\t//            rng.txtToElmBoundary(true);\n\t\t\t//            if(domUtils.isStartInblock(rng)){\n\t\t\t//                var tmpNode = rng.startContainer;\n\t\t\t//                var pre = tmpNode.previousSibling;\n\t\t\t//                if(pre && domUtils.isTagNode(pre,'hr')){\n\t\t\t//                    domUtils.remove(pre);\n\t\t\t//                    rng.select();\n\t\t\t//                    return;\n\t\t\t//                }\n\t\t\t//            }\n\t\t\t//        }\n\t\t\t//        if(domUtils.isBody(rng.startContainer)){\n\t\t\t//            var hr = rng.startContainer.childNodes[rng.startOffset -1];\n\t\t\t//            if(hr && hr.nodeName == 'HR'){\n\t\t\t//                var next = hr.nextSibling;\n\t\t\t//                if(next){\n\t\t\t//                    rng.setStart(next,0)\n\t\t\t//                }else if(hr.previousSibling){\n\t\t\t//                    rng.setStartAtLast(hr.previousSibling)\n\t\t\t//                }else{\n\t\t\t//                    var p = this.document.createElement('p');\n\t\t\t//                    hr.parentNode.insertBefore(p,hr);\n\t\t\t//                    domUtils.fillNode(this.document,p);\n\t\t\t//                    rng.setStart(p,0);\n\t\t\t//                }\n\t\t\t//                domUtils.remove(hr);\n\t\t\t//                rng.setCursor(false,true);\n\t\t\t//            }\n\t\t\t//        }\n\t\t\t//    })\n\t\t\tme.addListener('delkeydown', function(name, evt) {\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\trng.txtToElmBoundary(true);\n\t\t\t\tif (domUtils.isStartInblock(rng)) {\n\t\t\t\t\tvar tmpNode = rng.startContainer;\n\t\t\t\t\tvar pre = tmpNode.previousSibling;\n\t\t\t\t\tif (pre && domUtils.isTagNode(pre, 'hr')) {\n\t\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\t\trng.select();\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\treturn true;\n\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t})\n\t\t};\n\t\n\t\t// plugins/time.js\n\t\t/**\n\t\t * 插入时间和日期\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 插入时间，默认格式：12:59:59\n\t\t * @command time\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'time');\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 插入日期，默认格式：2013-08-30\n\t\t * @command date\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'date');\n\t\t * ```\n\t\t */\n\t\tUE.commands['time'] = UE.commands[\"date\"] = {\n\t\t\texecCommand: function(cmd, format) {\n\t\t\t\tvar date = new Date;\n\t\n\t\t\t\tfunction formatTime(date, format) {\n\t\t\t\t\tvar hh = ('0' + date.getHours()).slice(-2),\n\t\t\t\t\t\tii = ('0' + date.getMinutes()).slice(-2),\n\t\t\t\t\t\tss = ('0' + date.getSeconds()).slice(-2);\n\t\t\t\t\tformat = format || 'hh:ii:ss';\n\t\t\t\t\treturn format.replace(/hh/ig, hh).replace(/ii/ig, ii).replace(/ss/ig, ss);\n\t\t\t\t}\n\t\n\t\t\t\tfunction formatDate(date, format) {\n\t\t\t\t\tvar yyyy = ('000' + date.getFullYear()).slice(-4),\n\t\t\t\t\t\tyy = yyyy.slice(-2),\n\t\t\t\t\t\tmm = ('0' + (date.getMonth() + 1)).slice(-2),\n\t\t\t\t\t\tdd = ('0' + date.getDate()).slice(-2);\n\t\t\t\t\tformat = format || 'yyyy-mm-dd';\n\t\t\t\t\treturn format.replace(/yyyy/ig, yyyy).replace(/yy/ig, yy).replace(/mm/ig, mm).replace(/dd/ig, dd);\n\t\t\t\t}\n\t\n\t\t\t\tthis.execCommand('insertHtml', cmd == \"time\" ? formatTime(date, format) : formatDate(date, format));\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/rowspacing.js\n\t\t/**\n\t\t * 段前段后间距插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 设置段间距\n\t\t * @command rowspacing\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } value 段间距的值，以px为单位\n\t\t * @param { String } dir 间距位置，top或bottom，分别表示段前和段后\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'rowspacing', '10', 'top' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['rowspacing'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt({\n\t\t\t\t'rowspacingtop': ['5', '10', '15', '20', '25'],\n\t\t\t\t'rowspacingbottom': ['5', '10', '15', '20', '25']\n\t\n\t\t\t});\n\t\t\tme.commands['rowspacing'] = {\n\t\t\t\texecCommand: function(cmdName, value, dir) {\n\t\t\t\t\tthis.execCommand('paragraph', 'p', {\n\t\t\t\t\t\tstyle: 'margin-' + dir + ':' + value + 'px'\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function(cmdName, dir) {\n\t\t\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tvalue;\n\t\t\t\t\t//trace:1026\n\t\t\t\t\tif (pN) {\n\t\t\t\t\t\tvalue = domUtils.getComputedStyle(pN, 'margin-' + dir).replace(/[^\\d]/g, '');\n\t\t\t\t\t\treturn !value ? 0 : value;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\t\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/lineheight.js\n\t\t/**\n\t\t * 设置行内间距\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\tUE.plugins['lineheight'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt({\n\t\t\t\t'lineheight': ['1', '1.5', '1.75', '2', '3', '4', '5']\n\t\t\t});\n\t\n\t\t\t/**\n\t\t\t * 行距\n\t\t\t * @command lineheight\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmdName 命令字符串\n\t\t\t * @param { String } value 传入的行高值， 该值是当前字体的倍数， 例如： 1.5, 1.75\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'lineheight', 1.5);\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 查询当前选区内容的行高大小\n\t\t\t * @command lineheight\n\t\t\t * @method queryCommandValue\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @return { String } 返回当前行高大小\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandValue( 'lineheight' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\tme.commands['lineheight'] = {\n\t\t\t\texecCommand: function(cmdName, value) {\n\t\t\t\t\tthis.execCommand('paragraph', 'p', {\n\t\t\t\t\t\tstyle: 'line-height:' + (value == \"1\" ? \"normal\" : value + 'em')\n\t\t\t\t\t});\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t});\n\t\t\t\t\tif (pN) {\n\t\t\t\t\t\tvar value = domUtils.getComputedStyle(pN, 'line-height');\n\t\t\t\t\t\treturn value == 'normal' ? 1 : value.replace(/[^\\d.]*/ig, \"\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/insertcode.js\n\t\t/**\n\t\t * 插入代码插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\tUE.plugins['insertcode'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.ready(function() {\n\t\t\t\tutils.cssRule('pre', 'pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}',\n\t\t\t\t\tme.document)\n\t\t\t});\n\t\t\tme.setOpt('insertcode', {\n\t\t\t\t'as3': 'ActionScript3',\n\t\t\t\t'bash': 'Bash/Shell',\n\t\t\t\t'cpp': 'C/C++',\n\t\t\t\t'css': 'Css',\n\t\t\t\t'cf': 'CodeFunction',\n\t\t\t\t'c#': 'C#',\n\t\t\t\t'delphi': 'Delphi',\n\t\t\t\t'diff': 'Diff',\n\t\t\t\t'erlang': 'Erlang',\n\t\t\t\t'groovy': 'Groovy',\n\t\t\t\t'html': 'Html',\n\t\t\t\t'java': 'Java',\n\t\t\t\t'jfx': 'JavaFx',\n\t\t\t\t'js': 'Javascript',\n\t\t\t\t'pl': 'Perl',\n\t\t\t\t'php': 'Php',\n\t\t\t\t'plain': 'Plain Text',\n\t\t\t\t'ps': 'PowerShell',\n\t\t\t\t'python': 'Python',\n\t\t\t\t'ruby': 'Ruby',\n\t\t\t\t'scala': 'Scala',\n\t\t\t\t'sql': 'Sql',\n\t\t\t\t'vb': 'Vb',\n\t\t\t\t'xml': 'Xml'\n\t\t\t});\n\t\n\t\t\t/**\n\t\t\t * 插入代码\n\t\t\t * @command insertcode\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @param { String } lang 插入代码的语言\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'insertcode', 'javascript' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 如果选区所在位置是插入插入代码区域，返回代码的语言\n\t\t\t * @command insertcode\n\t\t\t * @method queryCommandValue\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @return { String } 返回代码的语言\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandValue( 'insertcode' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\tme.commands['insertcode'] = {\n\t\t\t\texecCommand: function(cmd, lang) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\t\tpre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tpre.className = 'brush:' + lang + ';toolbar:false;';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar code = '';\n\t\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\t\tcode = browser.ie && browser.ie11below ? (browser.version <= 8 ? '&nbsp;' : '') : '<br/>';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar frag = rng.extractContents();\n\t\t\t\t\t\t\tvar div = me.document.createElement('div');\n\t\t\t\t\t\t\tdiv.appendChild(frag);\n\t\n\t\t\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(div.innerHTML.replace(/[\\r\\t]/g, '')), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\t\t\tif (browser.ie && browser.ie11below && browser.version > 8) {\n\t\n\t\t\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.data\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\tif (!/\\n$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\t\tcode += '\\n';\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcode += node.data + '\\n'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!node.nextSibling() && /\\n$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\tcode = code.replace(/\\n$/, '');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (browser.ie && browser.ie11below) {\n\t\n\t\t\t\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.data\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\tif (!/br>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += '<br>';\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tcode += node.data + '<br>'\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (!node.nextSibling() && /<br>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\tcode = code.replace(/<br>$/, '');\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcode += (node.type == 'element' ? (dtd.$empty[node.tagName] ? '' : node.innerText()) : node.data);\n\t\t\t\t\t\t\t\t\t\tif (!/br\\/?\\s*>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\tif (!node.nextSibling())\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.execCommand('inserthtml', '<pre id=\"coder\"class=\"brush:' + lang + ';toolbar:false\">' + code + '</pre>', true);\n\t\n\t\t\t\t\t\tpre = me.document.getElementById('coder');\n\t\t\t\t\t\tdomUtils.removeAttributes(pre, 'id');\n\t\t\t\t\t\tvar tmpNode = pre.previousSibling;\n\t\n\t\t\t\t\t\tif (tmpNode && (tmpNode.nodeType == 3 && tmpNode.nodeValue.length == 1 && browser.ie && browser.version == 6 || domUtils.isEmptyBlock(tmpNode))) {\n\t\n\t\t\t\t\t\t\tdomUtils.remove(tmpNode)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\trng.setStart(pre, 0).setCursor(false, true)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.selectNodeContents(pre).select()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\tvar path = this.selection.getStartElementPath();\n\t\t\t\t\tvar lang = '';\n\t\t\t\t\tutils.each(path, function(node) {\n\t\t\t\t\t\tif (node.nodeName == 'PRE') {\n\t\t\t\t\t\t\tvar match = node.className.match(/brush:([^;]+)/);\n\t\t\t\t\t\t\tlang = match && match[1] ? match[1] : '';\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn lang;\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tme.addInputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('pre'), function(pre) {\n\t\t\t\t\tvar brs = pre.getNodesByTagName('br');\n\t\t\t\t\tif (brs.length) {\n\t\t\t\t\t\tbrowser.ie && browser.ie11below && browser.version > 8 && utils.each(brs, function(br) {\n\t\t\t\t\t\t\tvar txt = UE.uNode.createText('\\n');\n\t\t\t\t\t\t\tbr.parentNode.insertBefore(txt, br);\n\t\t\t\t\t\t\tbr.parentNode.removeChild(br);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (browser.ie && browser.ie11below && browser.version > 8)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tvar code = pre.innerText().split(/\\n/);\n\t\t\t\t\tpre.innerHTML('');\n\t\t\t\t\tutils.each(code, function(c) {\n\t\t\t\t\t\tif (c.length) {\n\t\t\t\t\t\t\tpre.appendChild(UE.uNode.createText(c));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre.appendChild(UE.uNode.createElement('br'))\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t});\n\t\t\tme.addOutputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('pre'), function(pre) {\n\t\t\t\t\tvar code = '';\n\t\t\t\t\tutils.each(pre.children, function(n) {\n\t\t\t\t\t\tif (n.type == 'text') {\n\t\t\t\t\t\t\t//在ie下文本内容有可能末尾带有\\n要去掉\n\t\t\t\t\t\t\t//trace:3396\n\t\t\t\t\t\t\tcode += n.data.replace(/[ ]/g, '&nbsp;').replace(/\\n$/, '');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (n.tagName == 'br') {\n\t\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcode += (!dtd.$empty[n.tagName] ? '' : n.innerText());\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t});\n\t\n\t\t\t\t\tpre.innerText(code.replace(/(&nbsp;|\\n)+$/, ''))\n\t\t\t\t})\n\t\t\t});\n\t\t\t//不需要判断highlight的command列表\n\t\t\tme.notNeedCodeQuery = {\n\t\t\t\thelp: 1,\n\t\t\t\tundo: 1,\n\t\t\t\tredo: 1,\n\t\t\t\tsource: 1,\n\t\t\t\tprint: 1,\n\t\t\t\tsearchreplace: 1,\n\t\t\t\tfullscreen: 1,\n\t\t\t\tpreview: 1,\n\t\t\t\tinsertparagraph: 1,\n\t\t\t\telementpath: 1,\n\t\t\t\tinsertcode: 1,\n\t\t\t\tinserthtml: 1,\n\t\t\t\tselectall: 1\n\t\t\t};\n\t\t\t//将queyCommamndState重置\n\t\t\tvar orgQuery = me.queryCommandState;\n\t\t\tme.queryCommandState = function(cmd) {\n\t\t\t\tvar me = this;\n\t\n\t\t\t\tif (!me.notNeedCodeQuery[cmd.toLowerCase()] && me.selection && me.queryCommandValue('insertcode')) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn UE.Editor.prototype.queryCommandState.apply(this, arguments)\n\t\t\t};\n\t\t\tme.addListener('beforeenterkeydown', function() {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\t\tif (pre) {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\trng.deleteContents();\n\t\t\t\t\t}\n\t\t\t\t\tif (!browser.ie || browser.ie9above) {\n\t\t\t\t\t\tvar tmpNode = me.document.createElement('br'),\n\t\t\t\t\t\t\tpre;\n\t\t\t\t\t\trng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true);\n\t\t\t\t\t\tvar next = tmpNode.nextSibling;\n\t\t\t\t\t\tif (!next && (!browser.ie || browser.version > 10)) {\n\t\t\t\t\t\t\trng.insertNode(tmpNode.cloneNode(false));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.setStartAfter(tmpNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\twhile (pre) {\n\t\t\t\t\t\t\ttmp = pre;\n\t\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t\t\tif (!pre || pre.nodeName == 'BR') {\n\t\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pre) {\n\t\t\t\t\t\t\tvar str = '';\n\t\t\t\t\t\t\twhile (pre && pre.nodeName != 'BR' && new RegExp('^[\\\\s' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\t\tstr += pre.nodeValue;\n\t\t\t\t\t\t\t\tpre = pre.nextSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (pre.nodeName != 'BR') {\n\t\t\t\t\t\t\t\tvar match = pre.nodeValue.match(new RegExp('^([\\\\s' + domUtils.fillChar + ']+)'));\n\t\t\t\t\t\t\t\tif (match && match[1]) {\n\t\t\t\t\t\t\t\t\tstr += match[1]\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (str) {\n\t\t\t\t\t\t\t\tstr = me.document.createTextNode(str);\n\t\t\t\t\t\t\t\trng.insertNode(str).setStartAfter(str);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.collapse(true).select(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (browser.version > 8) {\n\t\n\t\t\t\t\t\t\tvar txt = me.document.createTextNode('\\n');\n\t\t\t\t\t\t\tvar start = rng.startContainer;\n\t\t\t\t\t\t\tif (rng.startOffset == 0) {\n\t\t\t\t\t\t\t\tvar preNode = start.previousSibling;\n\t\t\t\t\t\t\t\tif (preNode) {\n\t\t\t\t\t\t\t\t\trng.insertNode(txt);\n\t\t\t\t\t\t\t\t\tvar fillchar = me.document.createTextNode(' ');\n\t\t\t\t\t\t\t\t\trng.setStartAfter(txt).insertNode(fillchar).setStart(fillchar, 0).collapse(true).select(true)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trng.insertNode(txt).setStartAfter(txt);\n\t\t\t\t\t\t\t\tvar fillchar = me.document.createTextNode(' ');\n\t\t\t\t\t\t\t\tstart = rng.startContainer.childNodes[rng.startOffset];\n\t\t\t\t\t\t\t\tif (start && !/^\\n/.test(start.nodeValue)) {\n\t\t\t\t\t\t\t\t\trng.setStartBefore(txt)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trng.insertNode(fillchar).setStart(fillchar, 0).collapse(true).select(true)\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpNode = me.document.createElement('br');\n\t\t\t\t\t\t\trng.insertNode(tmpNode);\n\t\t\t\t\t\t\trng.insertNode(me.document.createTextNode(domUtils.fillChar));\n\t\t\t\t\t\t\trng.setStartAfter(tmpNode);\n\t\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\t\twhile (pre) {\n\t\t\t\t\t\t\t\ttmp = pre;\n\t\t\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t\t\t\tif (!pre || pre.nodeName == 'BR') {\n\t\t\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (pre) {\n\t\t\t\t\t\t\t\tvar str = '';\n\t\t\t\t\t\t\t\twhile (pre && pre.nodeName != 'BR' && new RegExp('^[ ' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\t\t\tstr += pre.nodeValue;\n\t\t\t\t\t\t\t\t\tpre = pre.nextSibling;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (pre.nodeName != 'BR') {\n\t\t\t\t\t\t\t\t\tvar match = pre.nodeValue.match(new RegExp('^([ ' + domUtils.fillChar + ']+)'));\n\t\t\t\t\t\t\t\t\tif (match && match[1]) {\n\t\t\t\t\t\t\t\t\t\tstr += match[1]\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tstr = me.document.createTextNode(str);\n\t\t\t\t\t\t\t\trng.insertNode(str).setStartAfter(str);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.collapse(true).select();\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\n\t\t\t});\n\t\n\t\t\tme.addListener('tabkeydown', function(cmd, evt) {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\t\tif (pre) {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tif (evt.shiftKey) {\n\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\t\tvar bk = rng.createBookmark();\n\t\t\t\t\t\t\tvar start = bk.start.previousSibling;\n\t\n\t\t\t\t\t\t\twhile (start) {\n\t\t\t\t\t\t\t\tif (pre.firstChild === start && !domUtils.isBr(start)) {\n\t\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start);\n\t\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (domUtils.isBr(start)) {\n\t\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling);\n\t\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstart = start.previousSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar end = bk.end;\n\t\t\t\t\t\t\tstart = bk.start.nextSibling;\n\t\t\t\t\t\t\tif (pre.firstChild === bk.start) {\n\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling)\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twhile (start && start !== end) {\n\t\t\t\t\t\t\t\tif (domUtils.isBr(start) && start.nextSibling) {\n\t\t\t\t\t\t\t\t\tif (start.nextSibling === end) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling)\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tstart = start.nextSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpNode = me.document.createTextNode('    ');\n\t\t\t\t\t\t\trng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true).select(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\n\t\t\t});\n\t\n\t\t\tme.addListener('beforeinserthtml', function(evtName, html) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\tpre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\t\tif (pre) {\n\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\trng.deleteContents()\n\t\t\t\t\t}\n\t\t\t\t\tvar htmlstr = '';\n\t\t\t\t\tif (browser.ie && browser.version > 8) {\n\t\n\t\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(html), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\thtmlstr += '\\n'\n\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\thtmlstr += '\\n'\n\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\thtmlstr += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\thtmlstr += cn.data\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\tif (!/\\n$/.test(htmlstr)) {\n\t\t\t\t\t\t\t\t\t\thtmlstr += '\\n';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\thtmlstr += node.data + '\\n'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!node.nextSibling() && /\\n$/.test(htmlstr)) {\n\t\t\t\t\t\t\t\thtmlstr = htmlstr.replace(/\\n$/, '');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar tmpNode = me.document.createTextNode(utils.html(htmlstr.replace(/&nbsp;/g, ' ')));\n\t\t\t\t\t\trng.insertNode(tmpNode).selectNode(tmpNode).select();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar frag = me.document.createDocumentFragment();\n\t\n\t\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(html), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\n\t\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(cn.innerText().replace(/&nbsp;/g, ' '))));\n\t\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(cn.data.replace(/&nbsp;/g, ' '))));\n\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\tif (frag.lastChild.nodeName != 'BR') {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(node.data.replace(/&nbsp;/g, ' '))));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!node.nextSibling() && frag.lastChild.nodeName == 'BR') {\n\t\t\t\t\t\t\t\tfrag.removeChild(frag.lastChild)\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t});\n\t\t\t\t\t\trng.insertNode(frag).select();\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t});\n\t\t\t//方向键的处理\n\t\t\tme.addListener('keydown', function(cmd, evt) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tkeyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 40) {\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tpre, start = rng.startContainer;\n\t\t\t\t\tif (rng.collapsed && (pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true)) && !pre.nextSibling) {\n\t\t\t\t\t\tvar last = pre.lastChild\n\t\t\t\t\t\twhile (last && last.nodeName == 'BR') {\n\t\t\t\t\t\t\tlast = last.previousSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (last === start || rng.startContainer === pre && rng.startOffset == pre.childNodes.length) {\n\t\t\t\t\t\t\tme.execCommand('insertparagraph');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt)\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t//trace:3395\n\t\t\tme.addListener('delkeydown', function(type, evt) {\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\trng.txtToElmBoundary(true);\n\t\t\t\tvar start = rng.startContainer;\n\t\t\t\tif (domUtils.isTagNode(start, 'pre') && rng.collapsed && domUtils.isStartInblock(rng)) {\n\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\tstart.parentNode.insertBefore(p, start);\n\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\trng.setStart(p, 0).setCursor(false, true);\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t})\n\t\t};\n\t\n\t\t// plugins/cleardoc.js\n\t\t/**\n\t\t * 清空文档插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 清空文档\n\t\t * @command cleardoc\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor 是编辑器实例\n\t\t * editor.execCommand('cleardoc');\n\t\t * ```\n\t\t */\n\t\n\t\tUE.commands['cleardoc'] = {\n\t\t\texecCommand: function(cmdName) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tenterTag = me.options.enterTag,\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (enterTag == \"br\") {\n\t\t\t\t\tme.body.innerHTML = \"<br/>\";\n\t\t\t\t\trange.setStart(me.body, 0).setCursor();\n\t\t\t\t} else {\n\t\t\t\t\tme.body.innerHTML = \"<p>\" + (ie ? \"\" : \"<br/>\") + \"</p>\";\n\t\t\t\t\trange.setStart(me.body.firstChild, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tme.fireEvent(\"clearDoc\");\n\t\t\t\t}, 0);\n\t\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/anchor.js\n\t\t/**\n\t\t * 锚点插件，为UEditor提供插入锚点支持\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\tUE.plugin.register('anchor', function() {\n\t\n\t\t\treturn {\n\t\t\t\tbindEvents: {\n\t\t\t\t\t'ready': function() {\n\t\t\t\t\t\tutils.cssRule('anchor',\n\t\t\t\t\t\t\t'.anchorclass{background: url(\\'' + this.options.themePath + this.options.theme + '/images/anchor.gif\\') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}',\n\t\t\t\t\t\t\tthis.document);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\toutputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('img'), function(a) {\n\t\t\t\t\t\tvar val;\n\t\t\t\t\t\tif (val = a.getAttr('anchorname')) {\n\t\t\t\t\t\t\ta.tagName = 'a';\n\t\t\t\t\t\t\ta.setAttr({\n\t\t\t\t\t\t\t\tanchorname: '',\n\t\t\t\t\t\t\t\tname: val,\n\t\t\t\t\t\t\t\t'class': ''\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tinputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('a'), function(a) {\n\t\t\t\t\t\tvar val;\n\t\t\t\t\t\tif ((val = a.getAttr('name')) && !a.getAttr('href')) {\n\t\t\t\t\t\t\ta.tagName = 'img';\n\t\t\t\t\t\t\ta.setAttr({\n\t\t\t\t\t\t\t\tanchorname: a.getAttr('name'),\n\t\t\t\t\t\t\t\t'class': 'anchorclass'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\ta.setAttr('name')\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t/**\n\t\t\t\t\t * 插入锚点\n\t\t\t\t\t * @command anchor\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @param { String } name 锚点名称字符串\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * //editor 是编辑器实例\n\t\t\t\t\t * editor.execCommand('anchor', 'anchor1');\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t'anchor': {\n\t\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\t\t\timg = range.getClosedNode();\n\t\t\t\t\t\t\tif (img && img.getAttribute('anchorname')) {\n\t\t\t\t\t\t\t\tif (name) {\n\t\t\t\t\t\t\t\t\timg.setAttribute('anchorname', name);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(img).setCursor();\n\t\t\t\t\t\t\t\t\tdomUtils.remove(img);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (name) {\n\t\t\t\t\t\t\t\t\t//只在选区的开始插入\n\t\t\t\t\t\t\t\t\tvar anchor = this.document.createElement('img');\n\t\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(anchor, {\n\t\t\t\t\t\t\t\t\t\t'anchorname': name,\n\t\t\t\t\t\t\t\t\t\t'class': 'anchorclass'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\trange.insertNode(anchor).setStartAfter(anchor).setCursor(false, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/wordcount.js\n\t\t///import core\n\t\t///commands 字数统计\n\t\t///commandsName  WordCount,wordCount\n\t\t///commandsTitle  字数统计\n\t\t/*\n\t\t * Created by JetBrains WebStorm.\n\t\t * User: taoqili\n\t\t * Date: 11-9-7\n\t\t * Time: 下午8:18\n\t\t * To change this template use File | Settings | File Templates.\n\t\t */\n\t\n\t\tUE.plugins['wordcount'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt('wordCount', true);\n\t\t\tme.addListener('contentchange', function() {\n\t\t\t\tme.fireEvent('wordcount');\n\t\t\t});\n\t\t\tvar timer;\n\t\t\tme.addListener('ready', function() {\n\t\t\t\tvar me = this;\n\t\t\t\tdomUtils.on(me.body, \"keyup\", function(evt) {\n\t\t\t\t\tvar code = evt.keyCode || evt.which,\n\t\t\t\t\t\t//忽略的按键,ctr,alt,shift,方向键\n\t\t\t\t\t\tignores = {\n\t\t\t\t\t\t\t\"16\": 1,\n\t\t\t\t\t\t\t\"18\": 1,\n\t\t\t\t\t\t\t\"20\": 1,\n\t\t\t\t\t\t\t\"37\": 1,\n\t\t\t\t\t\t\t\"38\": 1,\n\t\t\t\t\t\t\t\"39\": 1,\n\t\t\t\t\t\t\t\"40\": 1\n\t\t\t\t\t\t};\n\t\t\t\t\tif (code in ignores) return;\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\tme.fireEvent('wordcount');\n\t\t\t\t\t}, 200)\n\t\t\t\t})\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/pagebreak.js\n\t\t/**\n\t\t * 分页功能插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\tUE.plugins['pagebreak'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tnotBreakTags = ['td'];\n\t\t\tme.setOpt('pageBreakTag', '_ueditor_page_break_tag_');\n\t\n\t\t\tfunction fillNode(node) {\n\t\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\t\tvar firstChild = node.firstChild,\n\t\t\t\t\t\ttmpNode;\n\t\n\t\t\t\t\twhile (firstChild && firstChild.nodeType == 1 && domUtils.isEmptyBlock(firstChild)) {\n\t\t\t\t\t\ttmpNode = firstChild;\n\t\t\t\t\t\tfirstChild = firstChild.firstChild;\n\t\t\t\t\t}!tmpNode && (tmpNode = node);\n\t\t\t\t\tdomUtils.fillNode(me.document, tmpNode);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//分页符样式添加\n\t\n\t\t\tme.ready(function() {\n\t\t\t\tutils.cssRule('pagebreak', '.pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}', me.document);\n\t\t\t});\n\t\n\t\t\tfunction isHr(node) {\n\t\t\t\treturn node && node.nodeType == 1 && node.tagName == 'HR' && node.className == 'pagebreak';\n\t\t\t}\n\t\t\tme.addInputRule(function(root) {\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type == 'text' && node.data == me.options.pageBreakTag) {\n\t\t\t\t\t\tvar hr = UE.uNode.createElement('<hr class=\"pagebreak\" noshade=\"noshade\" size=\"5\" style=\"-webkit-user-select: none;\">');\n\t\t\t\t\t\tnode.parentNode.insertBefore(hr, node);\n\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t});\n\t\t\tme.addOutputRule(function(node) {\n\t\t\t\tutils.each(node.getNodesByTagName('hr'), function(n) {\n\t\t\t\t\tif (n.getAttr('class') == 'pagebreak') {\n\t\t\t\t\t\tvar txt = UE.uNode.createText(me.options.pageBreakTag);\n\t\t\t\t\t\tn.parentNode.insertBefore(txt, n);\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\n\t\t\t});\n\t\n\t\t\t/**\n\t\t\t * 插入分页符\n\t\t\t * @command pagebreak\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @remind 在表格中插入分页符会把表格切分成两部分\n\t\t\t * @remind 获取编辑器内的数据时， 编辑器会把分页符转换成“_ueditor_page_break_tag_”字符串，\n\t\t\t *          以便于提交数据到服务器端后处理分页。\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'pagebreak'); //插入一个hr标签，带有样式类名pagebreak\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\tme.commands['pagebreak'] = {\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\thr = me.document.createElement('hr');\n\t\t\t\t\tdomUtils.setAttributes(hr, {\n\t\t\t\t\t\t'class': 'pagebreak',\n\t\t\t\t\t\tnoshade: \"noshade\",\n\t\t\t\t\t\tsize: \"5\"\n\t\t\t\t\t});\n\t\t\t\t\tdomUtils.unSelectable(hr);\n\t\t\t\t\t//table单独处理\n\t\t\t\t\tvar node = domUtils.findParentByTagName(range.startContainer, notBreakTags, true),\n\t\n\t\t\t\t\t\tparents = [],\n\t\t\t\t\t\tpN;\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\t\tcase 'TD':\n\t\t\t\t\t\t\t\tpN = node.parentNode;\n\t\t\t\t\t\t\t\tif (!pN.previousSibling) {\n\t\t\t\t\t\t\t\t\tvar table = domUtils.findParentByTagName(pN, 'table');\n\t\t\t\t\t\t\t\t\t//                            var tableWrapDiv = table.parentNode;\n\t\t\t\t\t\t\t\t\t//                            if(tableWrapDiv && tableWrapDiv.nodeType == 1\n\t\t\t\t\t\t\t\t\t//                                && tableWrapDiv.tagName == 'DIV'\n\t\t\t\t\t\t\t\t\t//                                && tableWrapDiv.getAttribute('dropdrag')\n\t\t\t\t\t\t\t\t\t//                                ){\n\t\t\t\t\t\t\t\t\t//                                domUtils.remove(tableWrapDiv,true);\n\t\t\t\t\t\t\t\t\t//                            }\n\t\t\t\t\t\t\t\t\ttable.parentNode.insertBefore(hr, table);\n\t\t\t\t\t\t\t\t\tparents = domUtils.findParents(hr, true);\n\t\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tpN.parentNode.insertBefore(hr, pN);\n\t\t\t\t\t\t\t\t\tparents = domUtils.findParents(hr);\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpN = parents[1];\n\t\t\t\t\t\t\t\tif (hr !== pN) {\n\t\t\t\t\t\t\t\t\tdomUtils.breakParent(hr, pN);\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//table要重写绑定一下拖拽\n\t\t\t\t\t\t\t\tme.fireEvent('afteradjusttable', me.document);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\t\twhile (!domUtils.isBody(start) && domUtils.isBlockElm(start) && domUtils.isEmptyNode(start)) {\n\t\t\t\t\t\t\t\trange.setStartBefore(start).collapse(true);\n\t\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.insertNode(hr);\n\t\n\t\t\t\t\t\tvar pN = hr.parentNode,\n\t\t\t\t\t\t\tnextNode;\n\t\t\t\t\t\twhile (!domUtils.isBody(pN)) {\n\t\t\t\t\t\t\tdomUtils.breakParent(hr, pN);\n\t\t\t\t\t\t\tnextNode = hr.nextSibling;\n\t\t\t\t\t\t\tif (nextNode && domUtils.isEmptyBlock(nextNode)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(nextNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpN = hr.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnextNode = hr.nextSibling;\n\t\t\t\t\t\tvar pre = hr.previousSibling;\n\t\t\t\t\t\tif (isHr(pre)) {\n\t\t\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpre && fillNode(pre);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (!nextNode) {\n\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\n\t\t\t\t\t\t\thr.parentNode.appendChild(p);\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\trange.setStart(p, 0).collapse(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (isHr(nextNode)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(nextNode);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfillNode(nextNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.setEndAfter(hr).collapse(false);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\trange.select(true);\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/wordimage.js\n\t\t///import core\n\t\t///commands 本地图片引导上传\n\t\t///commandsName  WordImage\n\t\t///commandsTitle  本地图片引导上传\n\t\t///commandsDialog  dialogs\\wordimage\n\t\n\t\tUE.plugin.register('wordimage', function() {\n\t\t\tvar me = this,\n\t\t\t\timages = [];\n\t\t\treturn {\n\t\t\t\tcommands: {\n\t\t\t\t\t'wordimage': {\n\t\t\t\t\t\texecCommand: function() {\n\t\t\t\t\t\t\tvar images = domUtils.getElementsByTagName(me.body, \"img\");\n\t\t\t\t\t\t\tvar urlList = [];\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = images[i++];) {\n\t\t\t\t\t\t\t\tvar url = ci.getAttribute(\"word_img\");\n\t\t\t\t\t\t\t\turl && urlList.push(url);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn urlList;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\t\timages = domUtils.getElementsByTagName(me.body, \"img\");\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = images[i++];) {\n\t\t\t\t\t\t\t\tif (ci.getAttribute(\"word_img\")) {\n\t\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('img'), function(img) {\n\t\t\t\t\t\tvar attrs = img.attrs,\n\t\t\t\t\t\t\tflag = parseInt(attrs.width) < 128 || parseInt(attrs.height) < 43,\n\t\t\t\t\t\t\topt = me.options;\n\t\t\t\t\t\t\t//src = opt.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif';\n\t\t\t\t\t\t\tvar src = $GLOBAL_CONFIG['pcimgpath'] + '/images/editor/spacer.jpg';\n\t\t\t\t\t\tif (attrs['src'] && /^(?:(file:\\/+))/.test(attrs['src'])) {\n\t\t\t\t\t\t\timg.setAttr({\n\t\t\t\t\t\t\t\twidth: attrs.width,\n\t\t\t\t\t\t\t\theight: attrs.height,\n\t\t\t\t\t\t\t\talt: attrs.alt,\n\t\t\t\t\t\t\t\tword_img: attrs.src,\n\t\t\t\t\t\t\t\tsrc: src,\n\t\t\t\t\t\t\t\t'style': 'background:url(' + (flag ? opt.themePath + opt.theme + '/images/word.gif' : opt.langPath + opt.lang + '/images/localimage.png') + ') no-repeat center center;border:1px solid #ddd'\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/dragdrop.js\n\t\tUE.plugins['dragdrop'] = function() {\n\t\n\t\t\tvar me = this;\n\t\t\tme.ready(function() {\n\t\t\t\tdomUtils.on(this.body, 'dragend', function() {\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tvar node = rng.getClosedNode() || me.selection.getStart();\n\t\n\t\t\t\t\tif (node && node.tagName == 'IMG') {\n\t\n\t\t\t\t\t\tvar pre = node.previousSibling,\n\t\t\t\t\t\t\tnext;\n\t\t\t\t\t\twhile (next = node.nextSibling) {\n\t\t\t\t\t\t\tif (next.nodeType == 1 && next.tagName == 'SPAN' && !next.firstChild) {\n\t\t\t\t\t\t\t\tdomUtils.remove(next)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif ((pre && pre.nodeType == 1 && !domUtils.isEmptyBlock(pre) || !pre) && (!next || next && !domUtils.isEmptyBlock(next))) {\n\t\t\t\t\t\t\tif (pre && pre.tagName == 'P' && !domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\tpre.appendChild(node);\n\t\t\t\t\t\t\t\tdomUtils.moveChild(next, pre);\n\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t} else if (next && next.tagName == 'P' && !domUtils.isEmptyBlock(next)) {\n\t\t\t\t\t\t\t\tnext.insertBefore(node, next.firstChild);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (pre && pre.tagName == 'P' && domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(pre)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (next && next.tagName == 'P' && domUtils.isEmptyBlock(next)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(next)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.selectNode(node).select();\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t})\n\t\t\t});\n\t\t\tme.addListener('keyup', function(type, evt) {\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 13) {\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tnode;\n\t\t\t\t\tif (node = domUtils.findParentByTagName(rng.startContainer, 'p', true)) {\n\t\t\t\t\t\tif (domUtils.getComputedStyle(node, 'text-align') == 'center') {\n\t\t\t\t\t\t\tdomUtils.removeStyle(node, 'text-align')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t};\n\t\n\t\t// plugins/undo.js\n\t\t/**\n\t\t * undo redo\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 撤销上一次执行的命令\n\t\t * @command undo\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'undo' );\n\t\t * ```\n\t\t */\n\t\n\t\t/**\n\t\t * 重做上一次执行的命令\n\t\t * @command redo\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'redo' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.plugins['undo'] = function() {\n\t\t\tvar saveSceneTimer;\n\t\t\tvar me = this,\n\t\t\t\tmaxUndoCount = me.options.maxUndoCount || 20,\n\t\t\t\tmaxInputCount = me.options.maxInputCount || 20,\n\t\t\t\tfillchar = new RegExp(domUtils.fillChar + '|<\\/hr>', 'gi'); // ie会产生多余的</hr>\n\t\t\tvar noNeedFillCharTags = {\n\t\t\t\tol: 1,\n\t\t\t\tul: 1,\n\t\t\t\ttable: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\ttr: 1,\n\t\t\t\tbody: 1\n\t\t\t};\n\t\t\tvar orgState = me.options.autoClearEmptyNode;\n\t\n\t\t\tfunction compareAddr(indexA, indexB) {\n\t\t\t\tif (indexA.length != indexB.length)\n\t\t\t\t\treturn 0;\n\t\t\t\tfor (var i = 0, l = indexA.length; i < l; i++) {\n\t\t\t\t\tif (indexA[i] != indexB[i])\n\t\t\t\t\t\treturn 0\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t}\n\t\n\t\t\tfunction compareRangeAddress(rngAddrA, rngAddrB) {\n\t\t\t\tif (rngAddrA.collapsed != rngAddrB.collapsed) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tif (!compareAddr(rngAddrA.startAddress, rngAddrB.startAddress) || !compareAddr(rngAddrA.endAddress, rngAddrB.endAddress)) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t}\n\t\n\t\t\tfunction UndoManager() {\n\t\t\t\tthis.list = [];\n\t\t\t\tthis.index = 0;\n\t\t\t\tthis.hasUndo = false;\n\t\t\t\tthis.hasRedo = false;\n\t\t\t\tthis.undo = function() {\n\t\t\t\t\tif (this.hasUndo) {\n\t\t\t\t\t\tif (!this.list[this.index - 1] && this.list.length == 1) {\n\t\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (this.list[this.index].content == this.list[this.index - 1].content) {\n\t\t\t\t\t\t\tthis.index--;\n\t\t\t\t\t\t\tif (this.index == 0) {\n\t\t\t\t\t\t\t\treturn this.restore(0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.restore(--this.index);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis.redo = function() {\n\t\t\t\t\tif (this.hasRedo) {\n\t\t\t\t\t\twhile (this.list[this.index].content == this.list[this.index + 1].content) {\n\t\t\t\t\t\t\tthis.index++;\n\t\t\t\t\t\t\tif (this.index == this.list.length - 1) {\n\t\t\t\t\t\t\t\treturn this.restore(this.index);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.restore(++this.index);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\n\t\t\t\tthis.restore = function() {\n\t\t\t\t\tvar me = this.editor;\n\t\t\t\t\tvar scene = this.list[this.index];\n\t\t\t\t\tvar root = UE.htmlparser(scene.content.replace(fillchar, ''));\n\t\t\t\t\tme.options.autoClearEmptyNode = false;\n\t\t\t\t\tme.filterInputRule(root);\n\t\t\t\t\tme.options.autoClearEmptyNode = orgState;\n\t\t\t\t\t//trace:873\n\t\t\t\t\t//去掉展位符\n\t\t\t\t\tme.document.body.innerHTML = root.toHtml();\n\t\t\t\t\tme.fireEvent('afterscencerestore');\n\t\t\t\t\t//处理undo后空格不展位的问题\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(me.document, 'td th caption p'), function(node) {\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(node)) {\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar rng = new dom.Range(me.document).moveToAddress(scene.address);\n\t\t\t\t\t\trng.select(noNeedFillCharTags[rng.startContainer.nodeName.toLowerCase()]);\n\t\t\t\t\t} catch (e) {}\n\t\n\t\t\t\t\tthis.update();\n\t\t\t\t\tthis.clearKey();\n\t\t\t\t\t//不能把自己reset了\n\t\t\t\t\tme.fireEvent('reset', true);\n\t\t\t\t};\n\t\n\t\t\t\tthis.getScene = function() {\n\t\t\t\t\tvar me = this.editor;\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\trngAddress = rng.createAddress(false, true);\n\t\t\t\t\tme.fireEvent('beforegetscene');\n\t\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML);\n\t\t\t\t\tme.options.autoClearEmptyNode = false;\n\t\t\t\t\tme.filterOutputRule(root);\n\t\t\t\t\tme.options.autoClearEmptyNode = orgState;\n\t\t\t\t\tvar cont = root.toHtml();\n\t\t\t\t\t//trace:3461\n\t\t\t\t\t//这个会引起回退时导致空格丢失的情况\n\t\t\t\t\t//            browser.ie && (cont = cont.replace(/>&nbsp;</g, '><').replace(/\\s*</g, '<').replace(/>\\s*/g, '>'));\n\t\t\t\t\tme.fireEvent('aftergetscene');\n\t\n\t\t\t\t\treturn {\n\t\t\t\t\t\taddress: rngAddress,\n\t\t\t\t\t\tcontent: cont\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis.save = function(notCompareRange, notSetCursor) {\n\t\t\t\t\tclearTimeout(saveSceneTimer);\n\t\t\t\t\tvar currentScene = this.getScene(notSetCursor),\n\t\t\t\t\t\tlastScene = this.list[this.index];\n\t\n\t\t\t\t\tif (lastScene && lastScene.content != currentScene.content) {\n\t\t\t\t\t\tme.trigger('contentchange')\n\t\t\t\t\t}\n\t\t\t\t\t//内容相同位置相同不存\n\t\t\t\t\tif (lastScene && lastScene.content == currentScene.content &&\n\t\t\t\t\t\t(notCompareRange ? 1 : compareRangeAddress(lastScene.address, currentScene.address))\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.list = this.list.slice(0, this.index + 1);\n\t\t\t\t\tthis.list.push(currentScene);\n\t\t\t\t\t//如果大于最大数量了，就把最前的剔除\n\t\t\t\t\tif (this.list.length > maxUndoCount) {\n\t\t\t\t\t\tthis.list.shift();\n\t\t\t\t\t}\n\t\t\t\t\tthis.index = this.list.length - 1;\n\t\t\t\t\tthis.clearKey();\n\t\t\t\t\t//跟新undo/redo状态\n\t\t\t\t\tthis.update();\n\t\n\t\t\t\t};\n\t\t\t\tthis.update = function() {\n\t\t\t\t\tthis.hasRedo = !!this.list[this.index + 1];\n\t\t\t\t\tthis.hasUndo = !!this.list[this.index - 1];\n\t\t\t\t};\n\t\t\t\tthis.reset = function() {\n\t\t\t\t\tthis.list = [];\n\t\t\t\t\tthis.index = 0;\n\t\t\t\t\tthis.hasUndo = false;\n\t\t\t\t\tthis.hasRedo = false;\n\t\t\t\t\tthis.clearKey();\n\t\t\t\t};\n\t\t\t\tthis.clearKey = function() {\n\t\t\t\t\tkeycont = 0;\n\t\t\t\t\tlastKeyCode = null;\n\t\t\t\t};\n\t\t\t}\n\t\n\t\t\tme.undoManger = new UndoManager();\n\t\t\tme.undoManger.editor = me;\n\t\n\t\t\tfunction saveScene() {\n\t\t\t\tthis.undoManger.save();\n\t\t\t}\n\t\n\t\t\tme.addListener('saveScene', function() {\n\t\t\t\tvar args = Array.prototype.splice.call(arguments, 1);\n\t\t\t\tthis.undoManger.save.apply(this.undoManger, args);\n\t\t\t});\n\t\n\t\t\t//    me.addListener('beforeexeccommand', saveScene);\n\t\t\t//    me.addListener('afterexeccommand', saveScene);\n\t\n\t\t\tme.addListener('reset', function(type, exclude) {\n\t\t\t\tif (!exclude) {\n\t\t\t\t\tthis.undoManger.reset();\n\t\t\t\t}\n\t\t\t});\n\t\t\tme.commands['redo'] = me.commands['undo'] = {\n\t\t\t\texecCommand: function(cmdName) {\n\t\t\t\t\tthis.undoManger[cmdName]();\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\t\treturn this.undoManger['has' + (cmdName.toLowerCase() == 'undo' ? 'Undo' : 'Redo')] ? 0 : -1;\n\t\t\t\t},\n\t\t\t\tnotNeedUndo: 1\n\t\t\t};\n\t\n\t\t\tvar keys = {\n\t\t\t\t\t//  /*Backspace*/ 8:1, /*Delete*/ 46:1,\n\t\t\t\t\t/*Shift*/\n\t\t\t\t\t16: 1,\n\t\t\t\t\t/*Ctrl*/ 17: 1,\n\t\t\t\t\t/*Alt*/ 18: 1,\n\t\t\t\t\t37: 1,\n\t\t\t\t\t38: 1,\n\t\t\t\t\t39: 1,\n\t\t\t\t\t40: 1\n\t\n\t\t\t\t},\n\t\t\t\tkeycont = 0,\n\t\t\t\tlastKeyCode;\n\t\t\t//输入法状态下不计算字符数\n\t\t\tvar inputType = false;\n\t\t\tme.addListener('ready', function() {\n\t\t\t\tdomUtils.on(this.body, 'compositionstart', function() {\n\t\t\t\t\tinputType = true;\n\t\t\t\t});\n\t\t\t\tdomUtils.on(this.body, 'compositionend', function() {\n\t\t\t\t\tinputType = false;\n\t\t\t\t})\n\t\t\t});\n\t\t\t//快捷键\n\t\t\tme.addshortcutkey({\n\t\t\t\t\"Undo\": \"ctrl+90\", //undo\n\t\t\t\t\"Redo\": \"ctrl+89\" //redo\n\t\n\t\t\t});\n\t\t\tvar isCollapsed = true;\n\t\t\tme.addListener('keydown', function(type, evt) {\n\t\n\t\t\t\tvar me = this;\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (!keys[keyCode] && !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\t\tif (inputType)\n\t\t\t\t\t\treturn;\n\t\n\t\t\t\t\tif (!me.selection.getRange().collapsed) {\n\t\t\t\t\t\tme.undoManger.save(false, true);\n\t\t\t\t\t\tisCollapsed = false;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (me.undoManger.list.length == 0) {\n\t\t\t\t\t\tme.undoManger.save(true);\n\t\t\t\t\t}\n\t\t\t\t\tclearTimeout(saveSceneTimer);\n\t\n\t\t\t\t\tfunction save(cont) {\n\t\t\t\t\t\tcont.undoManger.save(false, true);\n\t\t\t\t\t\tcont.fireEvent('selectionchange');\n\t\t\t\t\t}\n\t\t\t\t\tsaveSceneTimer = setTimeout(function() {\n\t\t\t\t\t\tif (inputType) {\n\t\t\t\t\t\t\tvar interalTimer = setInterval(function() {\n\t\t\t\t\t\t\t\tif (!inputType) {\n\t\t\t\t\t\t\t\t\tsave(me);\n\t\t\t\t\t\t\t\t\tclearInterval(interalTimer)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, 300)\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsave(me);\n\t\t\t\t\t}, 200);\n\t\n\t\t\t\t\tlastKeyCode = keyCode;\n\t\t\t\t\tkeycont++;\n\t\t\t\t\tif (keycont >= maxInputCount) {\n\t\t\t\t\t\tsave(me)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tme.addListener('keyup', function(type, evt) {\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (!keys[keyCode] && !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\t\tif (inputType)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (!isCollapsed) {\n\t\t\t\t\t\tthis.undoManger.save(false, true);\n\t\t\t\t\t\tisCollapsed = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t//扩展实例，添加关闭和开启命令undo\n\t\t\tme.stopCmdUndo = function() {\n\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t};\n\t\t\tme.startCmdUndo = function() {\n\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/copy.js\n\t\tUE.plugin.register('copy', function() {\n\t\t\treturn;\n\t\t\tvar me = this;\n\t\t\tvar jsPath = $GLOBAL_CONFIG['pcjspath'];\n\t\t\tfunction initZeroClipboard() {\n\t\n\t\t\t\tZeroClipboard.config({\n\t\t\t\t\tdebug: false,\n\t\t\t\t\t//swfPath: me.options.UEDITOR_HOME_URL + 'third-party/zeroclipboard/ZeroClipboard.swf'\n\t\t\t\t\tswfPath:jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.swf'\n\t\t\t\t});\n\t\n\t\t\t\tvar client = me.zeroclipboard = new ZeroClipboard();\n\t\n\t\t\t\t// 复制内容\n\t\t\t\tclient.on('copy', function(e) {\n\t\t\t\t\tvar client = e.client,\n\t\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\t\tdiv = document.createElement('div');\n\t\n\t\t\t\t\tdiv.appendChild(rng.cloneContents());\n\t\t\t\t\tclient.setText(div.innerText || div.textContent);\n\t\t\t\t\tclient.setHtml(div.innerHTML);\n\t\t\t\t\trng.select();\n\t\t\t\t});\n\t\t\t\t// hover事件传递到target\n\t\t\t\tclient.on('mouseover mouseout', function(e) {\n\t\t\t\t\tvar target = e.target;\n\t\t\t\t\tif (e.type == 'mouseover') {\n\t\t\t\t\t\tdomUtils.addClass(target, 'edui-state-hover');\n\t\t\t\t\t} else if (e.type == 'mouseout') {\n\t\t\t\t\t\tdomUtils.removeClasses(target, 'edui-state-hover');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// flash加载不成功\n\t\t\t\tclient.on('wrongflash noflash', function() {\n\t\t\t\t\tZeroClipboard.destroy();\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\tbindEvents: {\n\t\t\t\t\t'ready': function() {\n\t\t\t\t\t\tif (!browser.ie) {\n\t\t\t\t\t\t\tif (window.ZeroClipboard) {\n\t\t\t\t\t\t\t\tinitZeroClipboard();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log(jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.js')\n\t\t\t\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\t\t\t   // src: me.options.UEDITOR_HOME_URL + \"third-party/zeroclipboard/ZeroClipboard.js\",\n\t\t\t\t\t\t\t\t   src:jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.js',\n\t\t\t\t\t\t\t\t\ttag: \"script\",\n\t\t\t\t\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t\t\t\t\t}, function() {\n\t\t\t\t\t\t\t\t\tinitZeroClipboard();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t'copy': {\n\t\t\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\t\t\tif (!me.document.execCommand('copy')) {\n\t\t\t\t\t\t\t\talert(me.getLang('copymsg'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/paste.js\n\t\t///import core\n\t\t///import plugins/inserthtml.js\n\t\t///import plugins/undo.js\n\t\t///import plugins/serialize.js\n\t\t///commands 粘贴\n\t\t///commandsName  PastePlain\n\t\t///commandsTitle  纯文本粘贴模式\n\t\t/**\n\t\t * @description 粘贴\n\t\t * @author zhanyi\n\t\t */\n\t\tUE.plugins['paste'] = function() {\n\t\t\tfunction getClipboardData(callback) {\n\t\t\t\tvar doc = this.document;\n\t\t\t\tif (doc.getElementById('baidu_pastebin')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tbk = range.createBookmark(),\n\t\t\t\t\t//创建剪贴的容器div\n\t\t\t\t\tpastebin = doc.createElement('div');\n\t\t\t\tpastebin.id = 'baidu_pastebin';\n\t\t\t\t// Safari 要求div必须有内容，才能粘贴内容进来\n\t\t\t\tbrowser.webkit && pastebin.appendChild(doc.createTextNode(domUtils.fillChar + domUtils.fillChar));\n\t\t\t\tdoc.body.appendChild(pastebin);\n\t\t\t\t//trace:717 隐藏的span不能得到top\n\t\t\t\t//bk.start.innerHTML = '&nbsp;';\n\t\t\t\tbk.start.style.display = '';\n\t\t\t\tpastebin.style.cssText = \"position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:\" +\n\t\t\t\t\t//要在现在光标平行的位置加入，否则会出现跳动的问题\n\t\t\t\t\tdomUtils.getXY(bk.start).y + 'px';\n\t\n\t\t\t\trange.selectNodeContents(pastebin).select(true);\n\t\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tif (browser.webkit) {\n\t\t\t\t\t\tfor (var i = 0, pastebins = doc.querySelectorAll('#baidu_pastebin'), pi; pi = pastebins[i++];) {\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(pi)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(pi);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpastebin = pi;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\tpastebin.parentNode.removeChild(pastebin);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t\trange.moveToBookmark(bk).select(true);\n\t\t\t\t\tcallback(pastebin);\n\t\t\t\t}, 0);\n\t\t\t}\n\t\n\t\t\tvar me = this;\n\t\n\t\t\tme.setOpt({\n\t\t\t\tretainOnlyLabelPasted: false\n\t\t\t});\n\t\n\t\t\tvar txtContent, htmlContent, address;\n\t\n\t\t\tfunction getPureHtml(html) {\n\t\t\t\treturn html.replace(/<(\\/?)([\\w\\-]+)([^>]*)>/gi, function(a, b, tagName, attrs) {\n\t\t\t\t\ttagName = tagName.toLowerCase();\n\t\t\t\t\tif ({\n\t\t\t\t\t\t\timg: 1\n\t\t\t\t\t\t}[tagName]) {\n\t\t\t\t\t\treturn a;\n\t\t\t\t\t}\n\t\t\t\t\tattrs = attrs.replace(/([\\w\\-]*?)\\s*=\\s*((\"([^\"]*)\")|('([^']*)')|([^\\s>]+))/gi, function(str, atr, val) {\n\t\t\t\t\t\tif ({\n\t\t\t\t\t\t\t\t'src': 1,\n\t\t\t\t\t\t\t\t'href': 1,\n\t\t\t\t\t\t\t\t'name': 1\n\t\t\t\t\t\t\t}[atr.toLowerCase()]) {\n\t\t\t\t\t\t\treturn atr + '=' + val + ' '\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn ''\n\t\t\t\t\t});\n\t\t\t\t\tif ({\n\t\t\t\t\t\t\t'span': 1,\n\t\t\t\t\t\t\t'div': 1\n\t\t\t\t\t\t}[tagName]) {\n\t\t\t\t\t\treturn ''\n\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\treturn '<' + b + tagName + ' ' + utils.trim(attrs) + '>'\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\tfunction filter(div) {\n\t\t\t\tvar html;\n\t\t\t\tif (div.firstChild) {\n\t\t\t\t\t//去掉cut中添加的边界值\n\t\t\t\t\tvar nodes = domUtils.getElementsByTagName(div, 'span');\n\t\t\t\t\tfor (var i = 0, ni; ni = nodes[i++];) {\n\t\t\t\t\t\tif (ni.id == '_baidu_cut_start' || ni.id == '_baidu_cut_end') {\n\t\t\t\t\t\t\tdomUtils.remove(ni);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (browser.webkit) {\n\t\n\t\t\t\t\t\tvar brs = div.querySelectorAll('div br');\n\t\t\t\t\t\tfor (var i = 0, bi; bi = brs[i++];) {\n\t\t\t\t\t\t\tvar pN = bi.parentNode;\n\t\t\t\t\t\t\tif (pN.tagName == 'DIV' && pN.childNodes.length == 1) {\n\t\t\t\t\t\t\t\tpN.innerHTML = '<p><br/></p>';\n\t\t\t\t\t\t\t\tdomUtils.remove(pN);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar divs = div.querySelectorAll('#baidu_pastebin');\n\t\t\t\t\t\tfor (var i = 0, di; di = divs[i++];) {\n\t\t\t\t\t\t\tvar tmpP = me.document.createElement('p');\n\t\t\t\t\t\t\tdi.parentNode.insertBefore(tmpP, di);\n\t\t\t\t\t\t\twhile (di.firstChild) {\n\t\t\t\t\t\t\t\ttmpP.appendChild(di.firstChild);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(di);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tvar metas = div.querySelectorAll('meta');\n\t\t\t\t\t\tfor (var i = 0, ci; ci = metas[i++];) {\n\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tvar brs = div.querySelectorAll('br');\n\t\t\t\t\t\tfor (i = 0; ci = brs[i++];) {\n\t\t\t\t\t\t\tif (/^apple-/i.test(ci.className)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\tvar dirtyNodes = div.querySelectorAll('[_moz_dirty]');\n\t\t\t\t\t\tfor (i = 0; ci = dirtyNodes[i++];) {\n\t\t\t\t\t\t\tci.removeAttribute('_moz_dirty');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (!browser.ie) {\n\t\t\t\t\t\tvar spans = div.querySelectorAll('span.Apple-style-span');\n\t\t\t\t\t\tfor (var i = 0, ci; ci = spans[i++];) {\n\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//ie下使用innerHTML会产生多余的\\r\\n字符，也会产生&nbsp;这里过滤掉\n\t\t\t\t\thtml = div.innerHTML; //.replace(/>(?:(\\s|&nbsp;)*?)</g,'><');\n\t\n\t\t\t\t\t//过滤word粘贴过来的冗余属性\n\t\t\t\t\thtml = UE.filterWord(html);\n\t\t\t\t\t//取消了忽略空白的第二个参数，粘贴过来的有些是有空白的，会被套上相关的标签\n\t\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t\t//如果给了过滤规则就先进行过滤\n\t\t\t\t\tif (me.options.filterRules) {\n\t\t\t\t\t\tUE.filterNode(root, me.options.filterRules);\n\t\t\t\t\t}\n\t\t\t\t\t//执行默认的处理\n\t\t\t\t\tme.filterInputRule(root);\n\t\t\t\t\t//针对chrome的处理\n\t\t\t\t\tif (browser.webkit) {\n\t\t\t\t\t\tvar br = root.lastChild();\n\t\t\t\t\t\tif (br && br.type == 'element' && br.tagName == 'br') {\n\t\t\t\t\t\t\troot.removeChild(br)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tutils.each(me.body.querySelectorAll('div'), function(node) {\n\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(node, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\thtml = {\n\t\t\t\t\t\t'html': root.toHtml()\n\t\t\t\t\t};\n\t\t\t\t\tme.fireEvent('beforepaste', html, root);\n\t\t\t\t\t//抢了默认的粘贴，那后边的内容就不执行了，比如表格粘贴\n\t\t\t\t\tif (!html.html) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\troot = UE.htmlparser(html.html, true);\n\t\t\t\t\t//如果开启了纯文本模式\n\t\t\t\t\tif (me.queryCommandState('pasteplain') === 1) {\n\t\t\t\t\t\tme.execCommand('insertHtml', UE.filterNode(root, me.options.filterTxtRules).toHtml(), true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//文本模式\n\t\t\t\t\t\tUE.filterNode(root, me.options.filterTxtRules);\n\t\t\t\t\t\ttxtContent = root.toHtml();\n\t\t\t\t\t\t//完全模式\n\t\t\t\t\t\thtmlContent = html.html;\n\t\n\t\t\t\t\t\taddress = me.selection.getRange().createAddress(true);\n\t\t\t\t\t\tme.execCommand('insertHtml', me.getOpt('retainOnlyLabelPasted') === true ? getPureHtml(htmlContent) : htmlContent, true);\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent(\"afterpaste\", html);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tme.addListener('pasteTransfer', function(cmd, plainType) {\n\t\n\t\t\t\tif (address && txtContent && htmlContent && txtContent != htmlContent) {\n\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\trange.moveToAddress(address, true);\n\t\n\t\t\t\t\tif (!range.collapsed) {\n\t\n\t\t\t\t\t\twhile (!domUtils.isBody(range.startContainer)) {\n\t\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\t\tstart = start.childNodes[range.startOffset];\n\t\t\t\t\t\t\t\tif (!start) {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(range.startContainer);\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar pre = start.previousSibling;\n\t\n\t\t\t\t\t\t\t\tif (pre && pre.nodeType == 3 && new RegExp('^[\\n\\r\\t ' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(pre)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\t\t\t\trange.setStartBefore(range.startContainer);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (!domUtils.isBody(range.endContainer)) {\n\t\t\t\t\t\t\tvar end = range.endContainer;\n\t\t\t\t\t\t\tif (end.nodeType == 1) {\n\t\t\t\t\t\t\t\tend = end.childNodes[range.endOffset];\n\t\t\t\t\t\t\t\tif (!end) {\n\t\t\t\t\t\t\t\t\trange.setEndAfter(range.endContainer);\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar next = end.nextSibling;\n\t\t\t\t\t\t\t\tif (next && next.nodeType == 3 && new RegExp('^[\\n\\r\\t' + domUtils.fillChar + ']*$').test(next.nodeValue)) {\n\t\t\t\t\t\t\t\t\trange.setEndAfter(next)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (range.endOffset == range.endContainer[range.endContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length) {\n\t\t\t\t\t\t\t\trange.setEndAfter(range.endContainer);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\trange.deleteContents();\n\t\t\t\t\trange.select(true);\n\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\tvar html = htmlContent;\n\t\t\t\t\tif (plainType === 2) {\n\t\t\t\t\t\thtml = getPureHtml(html);\n\t\t\t\t\t} else if (plainType) {\n\t\t\t\t\t\thtml = txtContent;\n\t\t\t\t\t}\n\t\t\t\t\tme.execCommand('inserthtml', html, true);\n\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\twhile (!domUtils.isBody(rng.startContainer) && !rng.startOffset &&\n\t\t\t\t\t\trng.startContainer[rng.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t\t) {\n\t\t\t\t\t\trng.setStartBefore(rng.startContainer);\n\t\t\t\t\t}\n\t\t\t\t\tvar tmpAddress = rng.createAddress(true);\n\t\t\t\t\taddress.endAddress = tmpAddress.startAddress;\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tme.addListener('ready', function() {\n\t\t\t\tdomUtils.on(me.body, 'cut', function() {\n\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\tif (!range.collapsed && me.undoManger) {\n\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\t//ie下beforepaste在点击右键时也会触发，所以用监控键盘才处理\n\t\t\t\tdomUtils.on(me.body, browser.ie || browser.opera ? 'keydown' : 'paste', function(e) {\n\t\t\t\t\tif ((browser.ie || browser.opera) && ((!e.ctrlKey && !e.metaKey) || e.keyCode != '86')) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgetClipboardData.call(me, function(div) {\n\t\t\t\t\t\tfilter(div);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\n\t\t\t});\n\t\n\t\t\tme.commands['paste'] = {\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\tgetClipboardData.call(me, function(div) {\n\t\t\t\t\t\t\tfilter(div);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tme.document.execCommand('paste');\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(me.getLang('pastemsg'));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/puretxtpaste.js\n\t\t/**\n\t\t * 纯文本粘贴插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\tUE.plugins['pasteplain'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt({\n\t\t\t\t'pasteplain': false,\n\t\t\t\t'filterTxtRules': function() {\n\t\t\t\t\tfunction transP(node) {\n\t\t\t\t\t\tnode.tagName = 'p';\n\t\t\t\t\t\tnode.setStyle();\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction removeNode(node) {\n\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\t//直接删除及其字节点内容\n\t\t\t\t\t\t'-': 'script style object iframe embed input select',\n\t\t\t\t\t\t'p': {\n\t\t\t\t\t\t\t$: {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'br': {\n\t\t\t\t\t\t\t$: {}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdiv: function(node) {\n\t\t\t\t\t\t\tvar tmpNode, p = UE.uNode.createElement('p');\n\t\t\t\t\t\t\twhile (tmpNode = node.firstChild()) {\n\t\t\t\t\t\t\t\tif (tmpNode.type == 'text' || !UE.dom.dtd.$block[tmpNode.tagName]) {\n\t\t\t\t\t\t\t\t\tp.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t\t\t\tp = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(tmpNode, node);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tol: removeNode,\n\t\t\t\t\t\tul: removeNode,\n\t\t\t\t\t\tdl: removeNode,\n\t\t\t\t\t\tdt: removeNode,\n\t\t\t\t\t\tdd: removeNode,\n\t\t\t\t\t\t'li': removeNode,\n\t\t\t\t\t\t'caption': transP,\n\t\t\t\t\t\t'th': transP,\n\t\t\t\t\t\t'tr': transP,\n\t\t\t\t\t\t'h1': transP,\n\t\t\t\t\t\t'h2': transP,\n\t\t\t\t\t\t'h3': transP,\n\t\t\t\t\t\t'h4': transP,\n\t\t\t\t\t\t'h5': transP,\n\t\t\t\t\t\t'h6': transP,\n\t\t\t\t\t\t'td': function(node) {\n\t\t\t\t\t\t\t//没有内容的td直接删掉\n\t\t\t\t\t\t\tvar txt = !!node.innerText();\n\t\t\t\t\t\t\tif (txt) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(UE.uNode.createText(' &nbsp; &nbsp;'), node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node, node.innerText())\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}()\n\t\t\t});\n\t\t\t//暂时这里支持一下老版本的属性\n\t\t\tvar pasteplain = me.options.pasteplain;\n\t\n\t\t\t/**\n\t\t\t * 启用或取消纯文本粘贴模式\n\t\t\t * @command pasteplain\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState( 'pasteplain' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 查询当前是否处于纯文本粘贴模式\n\t\t\t * @command pasteplain\n\t\t\t * @method queryCommandState\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @return { int } 如果处于纯文本模式，返回1，否则，返回0\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState( 'pasteplain' );\n\t\t\t * ```\n\t\t\t */\n\t\t\tme.commands['pasteplain'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn pasteplain ? 1 : 0;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tpasteplain = !pasteplain | 0;\n\t\t\t\t},\n\t\t\t\tnotNeedUndo: 1\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/list.js\n\t\t/**\n\t\t * 有序列表,无序列表插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\tUE.plugins['list'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tnotExchange = {\n\t\t\t\t\t'TD': 1,\n\t\t\t\t\t'PRE': 1,\n\t\t\t\t\t'BLOCKQUOTE': 1\n\t\t\t\t};\n\t\t\tvar customStyle = {\n\t\t\t\t'cn': 'cn-1-',\n\t\t\t\t'cn1': 'cn-2-',\n\t\t\t\t'cn2': 'cn-3-',\n\t\t\t\t'num': 'num-1-',\n\t\t\t\t'num1': 'num-2-',\n\t\t\t\t'num2': 'num-3-',\n\t\t\t\t'dash': 'dash',\n\t\t\t\t'dot': 'dot'\n\t\t\t};\n\t\n\t\t\tme.setOpt({\n\t\t\t\t'autoTransWordToList': false,\n\t\t\t\t'insertorderedlist': {\n\t\t\t\t\t'num': '',\n\t\t\t\t\t'num1': '',\n\t\t\t\t\t'num2': '',\n\t\t\t\t\t'cn': '',\n\t\t\t\t\t'cn1': '',\n\t\t\t\t\t'cn2': '',\n\t\t\t\t\t'decimal': '',\n\t\t\t\t\t'lower-alpha': '',\n\t\t\t\t\t'lower-roman': '',\n\t\t\t\t\t'upper-alpha': '',\n\t\t\t\t\t'upper-roman': ''\n\t\t\t\t},\n\t\t\t\t'insertunorderedlist': {\n\t\t\t\t\t'circle': '',\n\t\t\t\t\t'disc': '',\n\t\t\t\t\t'square': '',\n\t\t\t\t\t'dash': '',\n\t\t\t\t\t'dot': ''\n\t\t\t\t},\n\t\t\t\tlistDefaultPaddingLeft: '30',\n\t\t\t\tlisticonpath: 'http://bs.baidu.com/listicon/',\n\t\t\t\tmaxListLevel: -1, //-1不限制\n\t\t\t\tdisablePInList: false\n\t\t\t});\n\t\n\t\t\tfunction listToArray(list) {\n\t\t\t\tvar arr = [];\n\t\t\t\tfor (var p in list) {\n\t\t\t\t\tarr.push(p)\n\t\t\t\t}\n\t\t\t\treturn arr;\n\t\t\t}\n\t\t\tvar listStyle = {\n\t\t\t\t'OL': listToArray(me.options.insertorderedlist),\n\t\t\t\t'UL': listToArray(me.options.insertunorderedlist)\n\t\t\t};\n\t\t\tvar liiconpath = me.options.listiconpath;\n\t\n\t\t\t//根据用户配置，调整customStyle\n\t\t\tfor (var s in customStyle) {\n\t\t\t\tif (!me.options.insertorderedlist.hasOwnProperty(s) && !me.options.insertunorderedlist.hasOwnProperty(s)) {\n\t\t\t\t\tdelete customStyle[s];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tme.ready(function() {\n\t\t\t\tvar customCss = [];\n\t\t\t\tfor (var p in customStyle) {\n\t\t\t\t\tif (p == 'dash' || p == 'dot') {\n\t\t\t\t\t\tcustomCss.push('li.list-' + customStyle[p] + '{background-image:url(' + liiconpath + customStyle[p] + '.gif)}');\n\t\t\t\t\t\tcustomCss.push('ul.custom_' + p + '{list-style:none;}ul.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (var i = 0; i < 99; i++) {\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + customStyle[p] + i + '{background-image:url(' + liiconpath + 'list-' + customStyle[p] + i + '.gif)}')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcustomCss.push('ol.custom_' + p + '{list-style:none;}ol.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t\t\t\t\t}\n\t\t\t\t\tswitch (p) {\n\t\t\t\t\t\tcase 'cn':\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'cn1':\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:30px}');\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'cn2':\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:40px}');\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:55px}');\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:68px}');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'num':\n\t\t\t\t\t\tcase 'num1':\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'num2':\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:35px}');\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'dash':\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft{padding-left:35px}');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'dot':\n\t\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft{padding-left:20px}');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcustomCss.push('.list-paddingleft-1{padding-left:0}');\n\t\t\t\tcustomCss.push('.list-paddingleft-2{padding-left:' + me.options.listDefaultPaddingLeft + 'px}');\n\t\t\t\tcustomCss.push('.list-paddingleft-3{padding-left:' + me.options.listDefaultPaddingLeft * 2 + 'px}');\n\t\t\t\t//如果不给宽度会在自定应样式里出现滚动条\n\t\t\t\tutils.cssRule('list', 'ol,ul{margin:0;pading:0;' + (browser.ie ? '' : 'width:95%') + '}li{clear:both;}' + customCss.join('\\n'), me.document);\n\t\t\t});\n\t\t\t//单独处理剪切的问题\n\t\t\tme.ready(function() {\n\t\t\t\tdomUtils.on(me.body, 'cut', function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\t\tli;\n\t\t\t\t\t\t//trace:3416\n\t\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\t\tif (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t\t\t\t\t\t\t\tif (!li.nextSibling && domUtils.isEmptyBlock(li)) {\n\t\t\t\t\t\t\t\t\tvar pn = li.parentNode,\n\t\t\t\t\t\t\t\t\t\tnode;\n\t\t\t\t\t\t\t\t\tif (node = pn.previousSibling) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\t\trng.setStartAtLast(node).collapse(true);\n\t\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t\t} else if (node = pn.nextSibling) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\t\trng.setStartAtFirst(node).collapse(true);\n\t\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tvar tmpNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, tmpNode);\n\t\t\t\t\t\t\t\t\t\tpn.parentNode.insertBefore(tmpNode, pn);\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\t\trng.setStart(tmpNode, 0).collapse(true);\n\t\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t});\n\t\n\t\t\tfunction getStyle(node) {\n\t\t\t\tvar cls = node.className;\n\t\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\t\treturn cls.match(/custom_(\\w+)/)[1]\n\t\t\t\t}\n\t\t\t\treturn domUtils.getStyle(node, 'list-style-type')\n\t\n\t\t\t}\n\t\n\t\t\tme.addListener('beforepaste', function(type, html) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\tli;\n\t\t\t\tvar root = UE.htmlparser(html.html, true);\n\t\t\t\tif (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t\t\t\t\tvar list = li.parentNode,\n\t\t\t\t\t\ttagName = list.tagName == 'OL' ? 'ul' : 'ol';\n\t\t\t\t\tutils.each(root.getNodesByTagName(tagName), function(n) {\n\t\t\t\t\t\tn.tagName = list.tagName;\n\t\t\t\t\t\tn.setAttr();\n\t\t\t\t\t\tif (n.parentNode === root) {\n\t\t\t\t\t\t\ttype = getStyle(list) || (list.tagName == 'OL' ? 'decimal' : 'disc')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar className = n.parentNode.getAttr('class');\n\t\t\t\t\t\t\tif (className && /custom_/.test(className)) {\n\t\t\t\t\t\t\t\ttype = className.match(/custom_(\\w+)/)[1]\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttype = n.parentNode.getStyle('list-style-type');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!type) {\n\t\t\t\t\t\t\t\ttype = list.tagName == 'OL' ? 'decimal' : 'disc';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar index = utils.indexOf(listStyle[list.tagName], type);\n\t\t\t\t\t\tif (n.parentNode !== root)\n\t\t\t\t\t\t\tindex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\t\tvar currentStyle = listStyle[list.tagName][index];\n\t\t\t\t\t\tif (customStyle[currentStyle]) {\n\t\t\t\t\t\t\tn.setAttr('class', 'custom_' + currentStyle)\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tn.setStyle('list-style-type', currentStyle)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\n\t\t\t\t}\n\t\n\t\t\t\thtml.html = root.toHtml();\n\t\t\t});\n\t\t\t//导出时，去掉p标签\n\t\t\tme.getOpt('disablePInList') === true && me.addOutputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('li'), function(li) {\n\t\t\t\t\tvar newChildrens = [],\n\t\t\t\t\t\tindex = 0;\n\t\t\t\t\tutils.each(li.children, function(n) {\n\t\t\t\t\t\tif (n.tagName == 'p') {\n\t\t\t\t\t\t\tvar tmpNode;\n\t\t\t\t\t\t\twhile (tmpNode = n.children.pop()) {\n\t\t\t\t\t\t\t\tnewChildrens.splice(index, 0, tmpNode);\n\t\t\t\t\t\t\t\ttmpNode.parentNode = li;\n\t\t\t\t\t\t\t\tlastNode = tmpNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpNode = newChildrens[newChildrens.length - 1];\n\t\t\t\t\t\t\tif (!tmpNode || tmpNode.type != 'element' || tmpNode.tagName != 'br') {\n\t\t\t\t\t\t\t\tvar br = UE.uNode.createElement('br');\n\t\t\t\t\t\t\t\tbr.parentNode = li;\n\t\t\t\t\t\t\t\tnewChildrens.push(br);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tindex = newChildrens.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (newChildrens.length) {\n\t\t\t\t\t\tli.children = newChildrens;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\t//进入编辑器的li要套p标签\n\t\t\tme.addInputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('li'), function(li) {\n\t\t\t\t\tvar tmpP = UE.uNode.createElement('p');\n\t\t\t\t\tfor (var i = 0, ci; ci = li.children[i];) {\n\t\t\t\t\t\tif (ci.type == 'text' || dtd.p[ci.tagName]) {\n\t\t\t\t\t\t\ttmpP.appendChild(ci);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (tmpP.firstChild()) {\n\t\t\t\t\t\t\t\tli.insertBefore(tmpP, ci);\n\t\t\t\t\t\t\t\ttmpP = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\ti = i + 2;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (tmpP.firstChild() && !tmpP.parentNode || !li.firstChild()) {\n\t\t\t\t\t\tli.appendChild(tmpP);\n\t\t\t\t\t}\n\t\t\t\t\t//trace:3357\n\t\t\t\t\t//p不能为空\n\t\t\t\t\tif (!tmpP.firstChild()) {\n\t\t\t\t\t\ttmpP.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n\t\t\t\t\t}\n\t\t\t\t\t//去掉末尾的空白\n\t\t\t\t\tvar p = li.firstChild();\n\t\t\t\t\tvar lastChild = p.lastChild();\n\t\t\t\t\tif (lastChild && lastChild.type == 'text' && /^\\s*$/.test(lastChild.data)) {\n\t\t\t\t\t\tp.removeChild(lastChild)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (me.options.autoTransWordToList) {\n\t\t\t\t\tvar orderlisttype = {\n\t\t\t\t\t\t\t'num1': /^\\d+\\)/,\n\t\t\t\t\t\t\t'decimal': /^\\d+\\./,\n\t\t\t\t\t\t\t'lower-alpha': /^[a-z]+\\)/,\n\t\t\t\t\t\t\t'upper-alpha': /^[A-Z]+\\./,\n\t\t\t\t\t\t\t'cn': /^[\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+[\\u3001]/,\n\t\t\t\t\t\t\t'cn2': /^\\([\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+\\)/\n\t\t\t\t\t\t},\n\t\t\t\t\t\tunorderlisttype = {\n\t\t\t\t\t\t\t'square': 'n'\n\t\t\t\t\t\t};\n\t\n\t\t\t\t\tfunction checkListType(content, container) {\n\t\t\t\t\t\tvar span = container.firstChild();\n\t\t\t\t\t\tif (span && span.type == 'element' && span.tagName == 'span' && /Wingdings|Symbol/.test(span.getStyle('font-family'))) {\n\t\t\t\t\t\t\tfor (var p in unorderlisttype) {\n\t\t\t\t\t\t\t\tif (unorderlisttype[p] == span.data) {\n\t\t\t\t\t\t\t\t\treturn p\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 'disc'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var p in orderlisttype) {\n\t\t\t\t\t\t\tif (orderlisttype[p].test(content)) {\n\t\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\tutils.each(root.getNodesByTagName('p'), function(node) {\n\t\t\t\t\t\tif (node.getAttr('class') != 'MsoListParagraph') {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t//word粘贴过来的会带有margin要去掉,但这样也可能会误命中一些央视\n\t\t\t\t\t\tnode.setStyle('margin', '');\n\t\t\t\t\t\tnode.setStyle('margin-left', '');\n\t\t\t\t\t\tnode.setAttr('class', '');\n\t\n\t\t\t\t\t\tfunction appendLi(list, p, type) {\n\t\t\t\t\t\t\tif (list.tagName == 'ol') {\n\t\t\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\t\t\tvar first = p.firstChild();\n\t\t\t\t\t\t\t\t\tif (first.type == 'element' && first.tagName == 'span' && orderlisttype[type].test(first.innerText())) {\n\t\t\t\t\t\t\t\t\t\tp.removeChild(first);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tp.innerHTML(p.innerHTML().replace(orderlisttype[type], ''));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tp.removeChild(p.firstChild())\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tvar li = UE.uNode.createElement('li');\n\t\t\t\t\t\t\tli.appendChild(p);\n\t\t\t\t\t\t\tlist.appendChild(li);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar tmp = node,\n\t\t\t\t\t\t\ttype, cacheNode = node;\n\t\n\t\t\t\t\t\tif (node.parentNode.tagName != 'li' && (type = checkListType(node.innerText(), node))) {\n\t\n\t\t\t\t\t\t\tvar list = UE.uNode.createElement(me.options.insertorderedlist.hasOwnProperty(type) ? 'ol' : 'ul');\n\t\t\t\t\t\t\tif (customStyle[type]) {\n\t\t\t\t\t\t\t\tlist.setAttr('class', 'custom_' + type)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlist.setStyle('list-style-type', type)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twhile (node && node.parentNode.tagName != 'li' && checkListType(node.innerText(), node)) {\n\t\t\t\t\t\t\t\ttmp = node.nextSibling();\n\t\t\t\t\t\t\t\tif (!tmp) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(list, node)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tappendLi(list, node, type);\n\t\t\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!list.parentNode && node && node.parentNode) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(list, node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar span = cacheNode.firstChild();\n\t\t\t\t\t\tif (span && span.type == 'element' && span.tagName == 'span' && /^\\s*(&nbsp;)+\\s*$/.test(span.innerText())) {\n\t\t\t\t\t\t\tspan.parentNode.removeChild(span)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\n\t\t\t});\n\t\n\t\t\t//调整索引标签\n\t\t\tme.addListener('contentchange', function() {\n\t\t\t\tadjustListStyle(me.document)\n\t\t\t});\n\t\n\t\t\tfunction adjustListStyle(doc, ignore) {\n\t\t\t\tutils.each(domUtils.getElementsByTagName(doc, 'ol ul'), function(node) {\n\t\n\t\t\t\t\tif (!domUtils.inDoc(node, doc))\n\t\t\t\t\t\treturn;\n\t\n\t\t\t\t\tvar parent = node.parentNode;\n\t\t\t\t\tif (parent.tagName == node.tagName) {\n\t\t\t\t\t\tvar nodeStyleType = getStyle(node) || (node.tagName == 'OL' ? 'decimal' : 'disc'),\n\t\t\t\t\t\t\tparentStyleType = getStyle(parent) || (parent.tagName == 'OL' ? 'decimal' : 'disc');\n\t\t\t\t\t\tif (nodeStyleType == parentStyleType) {\n\t\t\t\t\t\t\tvar styleIndex = utils.indexOf(listStyle[node.tagName], nodeStyleType);\n\t\t\t\t\t\t\tstyleIndex = styleIndex + 1 == listStyle[node.tagName].length ? 0 : styleIndex + 1;\n\t\t\t\t\t\t\tsetListStyle(node, listStyle[node.tagName][styleIndex])\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\tvar index = 0,\n\t\t\t\t\t\ttype = 2;\n\t\t\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\t\t\tif (!(/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/))) {\n\t\t\t\t\t\t\ttype = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/)) {\n\t\t\t\t\t\t\ttype = 3;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar style = domUtils.getStyle(node, 'list-style-type');\n\t\t\t\t\tstyle && (node.style.cssText = 'list-style-type:' + style);\n\t\t\t\t\tnode.className = utils.trim(node.className.replace(/list-paddingleft-\\w+/, '')) + ' list-paddingleft-' + type;\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(node, 'li'), function(li) {\n\t\t\t\t\t\tli.style.cssText && (li.style.cssText = '');\n\t\t\t\t\t\tif (!li.firstChild) {\n\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (li.parentNode !== node) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tindex++;\n\t\t\t\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\t\t\t\tvar paddingLeft = 1,\n\t\t\t\t\t\t\t\tcurrentStyle = getStyle(node);\n\t\t\t\t\t\t\tif (node.tagName == 'OL') {\n\t\t\t\t\t\t\t\tif (currentStyle) {\n\t\t\t\t\t\t\t\t\tswitch (currentStyle) {\n\t\t\t\t\t\t\t\t\t\tcase 'cn':\n\t\t\t\t\t\t\t\t\t\tcase 'cn1':\n\t\t\t\t\t\t\t\t\t\tcase 'cn2':\n\t\t\t\t\t\t\t\t\t\t\tif (index > 10 && (index % 10 == 0 || index > 10 && index < 20)) {\n\t\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 2\n\t\t\t\t\t\t\t\t\t\t\t} else if (index > 20) {\n\t\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 3\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'num2':\n\t\t\t\t\t\t\t\t\t\t\tif (index > 9) {\n\t\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 2\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tli.className = 'list-' + customStyle[currentStyle] + index + ' ' + 'list-' + currentStyle + '-paddingleft-' + paddingLeft;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tli.className = 'list-' + customStyle[currentStyle] + ' ' + 'list-' + currentStyle + '-paddingleft';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tli.className = li.className.replace(/list-[\\w\\-]+/gi, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar className = li.getAttribute('class');\n\t\t\t\t\t\tif (className !== null && !className.replace(/\\s/g, '')) {\n\t\t\t\t\t\t\tdomUtils.removeAttributes(li, 'class')\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t!ignore && adjustList(node, node.tagName.toLowerCase(), getStyle(node) || domUtils.getStyle(node, 'list-style-type'), true);\n\t\t\t\t})\n\t\t\t}\n\t\n\t\t\tfunction adjustList(list, tag, style, ignoreEmpty) {\n\t\t\t\tvar nextList = list.nextSibling;\n\t\t\t\tif (nextList && nextList.nodeType == 1 && nextList.tagName.toLowerCase() == tag && (getStyle(nextList) || domUtils.getStyle(nextList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t\t\t\t\tdomUtils.moveChild(nextList, list);\n\t\t\t\t\tif (nextList.childNodes.length == 0) {\n\t\t\t\t\t\tdomUtils.remove(nextList);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (nextList && domUtils.isFillChar(nextList)) {\n\t\t\t\t\tdomUtils.remove(nextList);\n\t\t\t\t}\n\t\t\t\tvar preList = list.previousSibling;\n\t\t\t\tif (preList && preList.nodeType == 1 && preList.tagName.toLowerCase() == tag && (getStyle(preList) || domUtils.getStyle(preList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t\t\t\t\tdomUtils.moveChild(list, preList);\n\t\t\t\t}\n\t\t\t\tif (preList && domUtils.isFillChar(preList)) {\n\t\t\t\t\tdomUtils.remove(preList);\n\t\t\t\t}!ignoreEmpty && domUtils.isEmptyBlock(list) && domUtils.remove(list);\n\t\t\t\tif (getStyle(list)) {\n\t\t\t\t\tadjustListStyle(list.ownerDocument, true)\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction setListStyle(list, style) {\n\t\t\t\tif (customStyle[style]) {\n\t\t\t\t\tlist.className = 'custom_' + style;\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tdomUtils.setStyle(list, 'list-style-type', style);\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\t\n\t\t\tfunction clearEmptySibling(node) {\n\t\t\t\tvar tmpNode = node.previousSibling;\n\t\t\t\tif (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t}\n\t\t\t\ttmpNode = node.nextSibling;\n\t\t\t\tif (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tme.addListener('keydown', function(type, evt) {\n\t\t\t\tfunction preventAndSave() {\n\t\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t}\n\t\n\t\t\t\tfunction findList(node, filterFn) {\n\t\t\t\t\twhile (node && !domUtils.isBody(node)) {\n\t\t\t\t\t\tif (filterFn(node)) {\n\t\t\t\t\t\t\treturn null\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (node.nodeType == 1 && /[ou]l/i.test(node.tagName)) {\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 13 && !evt.shiftKey) { //回车\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tparent = domUtils.findParent(rng.startContainer, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t}, true),\n\t\t\t\t\t\tli = domUtils.findParentByTagName(rng.startContainer, 'li', true);\n\t\t\t\t\tif (parent && parent.tagName != 'PRE' && !li) {\n\t\t\t\t\t\tvar html = parent.innerHTML.replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\t\t\t\t\tif (/^\\s*1\\s*\\.[^\\d]/.test(html)) {\n\t\t\t\t\t\t\tparent.innerHTML = html.replace(/^\\s*1\\s*\\./, '');\n\t\t\t\t\t\t\trng.setStartAtLast(parent).collapse(true).select();\n\t\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t\tme.execCommand('insertorderedlist');\n\t\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\tstart = findList(range.startContainer, function(node) {\n\t\t\t\t\t\t\treturn node.tagName == 'TABLE';\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tend = range.collapsed ? start : findList(range.endContainer, function(node) {\n\t\t\t\t\t\t\treturn node.tagName == 'TABLE';\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\tif (start && end && start === end) {\n\t\n\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, 'li', true);\n\t\t\t\t\t\t\tif (start && end && start === end) {\n\t\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t\t\t\tif (li && domUtils.isEmptyBlock(li)) {\n\t\n\t\t\t\t\t\t\t\t\tpre = li.previousSibling;\n\t\t\t\t\t\t\t\t\tnext = li.nextSibling;\n\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\t\tparentList = li.parentNode;\n\t\t\t\t\t\t\t\t\tif (pre && next) {\n\t\t\t\t\t\t\t\t\t\trange.setStart(next, 0).collapse(true).select(true);\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tif (!pre && !next || !pre) {\n\t\n\t\t\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(p, parentList);\n\t\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tli.parentNode.parentNode.insertBefore(p, parentList.nextSibling);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\t\t\tif (!parentList.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t\t\t\t\treturn;\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\t\t\t\t\t\tbk = tmpRange.collapse(false).createBookmark();\n\t\n\t\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\t\ttmpRange.moveToBookmark(bk);\n\t\t\t\t\t\t\t\tvar li = domUtils.findParentByTagName(tmpRange.startContainer, 'li', true);\n\t\n\t\t\t\t\t\t\t\tclearEmptySibling(li);\n\t\t\t\t\t\t\t\ttmpRange.select();\n\t\t\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\n\t\t\t\t\t\tif (li) {\n\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(li)) {\n\t\t\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\t\t\tvar parentList = li.parentNode;\n\t\t\t\t\t\t\t\tif (li !== parentList.lastChild) {\n\t\t\t\t\t\t\t\t\tdomUtils.breakParent(li, parentList);\n\t\t\t\t\t\t\t\t\tclearEmptySibling(li);\n\t\t\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li, parentList.nextSibling);\n\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//嵌套不处理\n\t\t\t\t\t\t\t\tif (!dtd.$list[li.parentNode.tagName]) {\n\t\n\t\t\t\t\t\t\t\t\tif (!domUtils.isBlockElm(li.firstChild)) {\n\t\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\tli.parentNode.insertBefore(p, li);\n\t\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tp.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(li, true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.moveToBookmark(bk).select();\n\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar first = li.firstChild;\n\t\t\t\t\t\t\t\tif (!first || !domUtils.isBlockElm(first)) {\n\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\n\t\t\t\t\t\t\t\t\t!li.firstChild && domUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\n\t\t\t\t\t\t\t\t\t\tp.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tli.appendChild(p);\n\t\t\t\t\t\t\t\t\tfirst = p;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tvar span = me.document.createElement('span');\n\t\n\t\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\t\tdomUtils.breakParent(span, li);\n\t\n\t\t\t\t\t\t\t\tvar nextLi = span.nextSibling;\n\t\t\t\t\t\t\t\tfirst = nextLi.firstChild;\n\t\n\t\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\t\tnextLi.appendChild(p);\n\t\t\t\t\t\t\t\t\tfirst = p;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(first)) {\n\t\t\t\t\t\t\t\t\tfirst.innerHTML = '';\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, first);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\trange.setStart(first, 0).collapse(true).shrinkBoundary().select();\n\t\t\t\t\t\t\t\tdomUtils.remove(span);\n\t\t\t\t\t\t\t\tvar pre = nextLi.previousSibling;\n\t\t\t\t\t\t\t\tif (pre && domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\t\tpre.innerHTML = '<p></p>';\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, pre.firstChild);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//                        }\n\t\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t\tif (keyCode == 8) {\n\t\t\t\t\t//修中ie中li下的问题\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (range.collapsed && domUtils.isStartInblock(range)) {\n\t\t\t\t\t\ttmpRange = range.cloneRange().trimBoundary();\n\t\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t\t//要在li的最左边，才能处理\n\t\t\t\t\t\tif (li && domUtils.isStartInblock(tmpRange)) {\n\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'p', true);\n\t\t\t\t\t\t\tif (start && start !== li.firstChild) {\n\t\t\t\t\t\t\t\tvar parentList = domUtils.findParentByTagName(start, ['ol', 'ul']);\n\t\t\t\t\t\t\t\tdomUtils.breakParent(start, parentList);\n\t\t\t\t\t\t\t\tclearEmptySibling(start);\n\t\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\t\trange.setStart(start, 0).setCursor(false, true);\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (li && (pre = li.previousSibling)) {\n\t\t\t\t\t\t\t\tif (keyCode == 46 && li.childNodes.length) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//有可能上边的兄弟节点是个2级菜单，要追加到2级菜单的最后的li\n\t\t\t\t\t\t\t\tif (dtd.$list[pre.tagName]) {\n\t\t\t\t\t\t\t\t\tpre = pre.lastChild;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t\t\tfirst = li.firstChild;\n\t\t\t\t\t\t\t\tif (domUtils.isBlockElm(first)) {\n\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(first)) {\n\t\t\t\t\t\t\t\t\t\t//                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(first);\n\t\t\t\t\t\t\t\t\t\trange.setStart(first, 0).setCursor(false, true);\n\t\t\t\t\t\t\t\t\t\t//first不是唯一的节点\n\t\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\t\t\t\tspan = me.document.createElement('span');\n\t\t\t\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\t\t\t\t//判断pre是否是空的节点,如果是<p><br/></p>类型的空节点，干掉p标签防止它占位\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\t\t\t\tpre.innerHTML = '';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdomUtils.moveChild(li, pre);\n\t\t\t\t\t\t\t\t\t\trange.setStartBefore(span).collapse(true).select(true);\n\t\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(span);\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(li)) {\n\t\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(p);\n\t\t\t\t\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\t\t\t\t\t\t\t\t\t\t//                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trange.setEnd(pre, pre.childNodes.length).collapse().select(true);\n\t\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\t\treturn;\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//trace:980\n\t\n\t\t\t\t\t\t\tif (li && !li.previousSibling) {\n\t\t\t\t\t\t\t\tvar parentList = li.parentNode;\n\t\t\t\t\t\t\t\tvar bk = range.createBookmark();\n\t\t\t\t\t\t\t\tif (domUtils.isTagNode(parentList.parentNode, 'ol ul')) {\n\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li, parentList);\n\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li.firstChild, parentList);\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList)\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.moveToBookmark(bk).setCursor(false, true);\n\t\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\t\treturn;\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tme.addListener('keyup', function(type, evt) {\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 8) {\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tlist;\n\t\t\t\t\tif (list = domUtils.findParentByTagName(rng.startContainer, ['ol', 'ul'], true)) {\n\t\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), getStyle(list) || domUtils.getComputedStyle(list, 'list-style-type'), true)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t//处理tab键\n\t\t\tme.addListener('tabkeydown', function() {\n\t\n\t\t\t\tvar range = me.selection.getRange();\n\t\n\t\t\t\t//控制级数\n\t\t\t\tfunction checkLevel(li) {\n\t\t\t\t\tif (me.options.maxListLevel != -1) {\n\t\t\t\t\t\tvar level = li.parentNode,\n\t\t\t\t\t\t\tlevelNum = 0;\n\t\t\t\t\t\twhile (/[ou]l/i.test(level.tagName)) {\n\t\t\t\t\t\t\tlevelNum++;\n\t\t\t\t\t\t\tlevel = level.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (levelNum >= me.options.maxListLevel) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//只以开始为准\n\t\t\t\t//todo 后续改进\n\t\t\t\tvar li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\tif (li) {\n\t\n\t\t\t\t\tvar bk;\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\tif (checkLevel(li))\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\tvar parentLi = li.parentNode,\n\t\t\t\t\t\t\tlist = me.document.createElement(parentLi.tagName),\n\t\t\t\t\t\t\tindex = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t\t\t\t\t\tindex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\t\tvar currentStyle = listStyle[list.tagName][index];\n\t\t\t\t\t\tsetListStyle(list, currentStyle);\n\t\t\t\t\t\tif (domUtils.isStartInblock(range)) {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\t\tparentLi.insertBefore(list, li);\n\t\t\t\t\t\t\tlist.appendChild(li);\n\t\t\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\trange.moveToBookmark(bk).select(true);\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\tfor (var i = 0, closeList, parents = domUtils.findParents(li), ci; ci = parents[i++];) {\n\t\t\t\t\t\t\tif (domUtils.isTagNode(ci, 'ol ul')) {\n\t\t\t\t\t\t\t\tcloseList = ci;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar current = li;\n\t\t\t\t\t\tif (bk.end) {\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tif (checkLevel(current)) {\n\t\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\t\treturn node !== closeList\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar parentLi = current.parentNode,\n\t\t\t\t\t\t\t\t\tlist = me.document.createElement(parentLi.tagName),\n\t\t\t\t\t\t\t\t\tindex = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t\t\t\t\t\t\t\tvar currentIndex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\t\t\t\tvar currentStyle = listStyle[list.tagName][currentIndex];\n\t\t\t\t\t\t\t\tsetListStyle(list, currentStyle);\n\t\t\t\t\t\t\t\tparentLi.insertBefore(list, current);\n\t\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\t\tli = current.nextSibling;\n\t\t\t\t\t\t\t\t\tlist.appendChild(current);\n\t\t\t\t\t\t\t\t\tif (!li || domUtils.isTagNode(li, 'ol ul')) {\n\t\t\t\t\t\t\t\t\t\tif (li) {\n\t\t\t\t\t\t\t\t\t\t\twhile (li = li.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (li.tagName == 'LI') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tli = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn node !== closeList\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcurrent = li;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t\t\t\t\t\t\t\tcurrent = li;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\trange.moveToBookmark(bk).select();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t});\n\t\n\t\t\tfunction getLi(start) {\n\t\t\t\twhile (start && !domUtils.isBody(start)) {\n\t\t\t\t\tif (start.nodeName == 'TABLE') {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t\tif (start.nodeName == 'LI') {\n\t\t\t\t\t\treturn start\n\t\t\t\t\t}\n\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 有序列表，与“insertunorderedlist”命令互斥\n\t\t\t * @command insertorderedlist\n\t\t\t * @method execCommand\n\t\t\t * @param { String } command 命令字符串\n\t\t\t * @param { String } style 插入的有序列表类型，值为：decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'insertorderedlist','decimal');\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 查询当前选区内容是否有序列表\n\t\t\t * @command insertorderedlist\n\t\t\t * @method queryCommandState\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @return { int } 如果当前选区是有序列表返回1，否则返回0\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState( 'insertorderedlist' );\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 查询当前选区内容是否有序列表\n\t\t\t * @command insertorderedlist\n\t\t\t * @method queryCommandValue\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @return { String } 返回当前有序列表的类型，值为null或decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandValue( 'insertorderedlist' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 无序列表，与“insertorderedlist”命令互斥\n\t\t\t * @command insertunorderedlist\n\t\t\t * @method execCommand\n\t\t\t * @param { String } command 命令字符串\n\t\t\t * @param { String } style 插入的无序列表类型，值为：circle,disc,square,dash,dot\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'insertunorderedlist','circle');\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 查询当前是否有word文档粘贴进来的图片\n\t\t\t * @command insertunorderedlist\n\t\t\t * @method insertunorderedlist\n\t\t\t * @param { String } command 命令字符串\n\t\t\t * @return { int } 如果当前选区是无序列表返回1，否则返回0\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState( 'insertunorderedlist' );\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 查询当前选区内容是否有序列表\n\t\t\t * @command insertunorderedlist\n\t\t\t * @method queryCommandValue\n\t\t\t * @param { String } command 命令字符串\n\t\t\t * @return { String } 返回当前无序列表的类型，值为null或circle,disc,square,dash,dot\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandValue( 'insertunorderedlist' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\tme.commands['insertorderedlist'] =\n\t\t\t\tme.commands['insertunorderedlist'] = {\n\t\t\t\t\texecCommand: function(command, style) {\n\t\n\t\t\t\t\t\tif (!style) {\n\t\t\t\t\t\t\tstyle = command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = this.selection.getRange(),\n\t\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul',\n\t\t\t\t\t\t\tfrag = me.document.createDocumentFragment();\n\t\t\t\t\t\t//去掉是因为会出现选到末尾，导致adjustmentBoundary缩到ol/ul的位置\n\t\t\t\t\t\t//range.shrinkBoundary();//.adjustmentBoundary();\n\t\t\t\t\t\trange.adjustmentBoundary().shrinkBoundary();\n\t\t\t\t\t\tvar bko = range.createBookmark(true),\n\t\t\t\t\t\t\tstart = getLi(me.document.getElementById(bko.start)),\n\t\t\t\t\t\t\tmodifyStart = 0,\n\t\t\t\t\t\t\tend = getLi(me.document.getElementById(bko.end)),\n\t\t\t\t\t\t\tmodifyEnd = 0,\n\t\t\t\t\t\t\tstartParent, endParent,\n\t\t\t\t\t\t\tlist, tmp;\n\t\n\t\t\t\t\t\tif (start || end) {\n\t\t\t\t\t\t\tstart && (startParent = start.parentNode);\n\t\t\t\t\t\t\tif (!bko.end) {\n\t\t\t\t\t\t\t\tend = start;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tend && (endParent = end.parentNode);\n\t\n\t\t\t\t\t\t\tif (startParent === endParent) {\n\t\t\t\t\t\t\t\twhile (start !== end) {\n\t\t\t\t\t\t\t\t\ttmp = start;\n\t\t\t\t\t\t\t\t\tstart = start.nextSibling;\n\t\t\t\t\t\t\t\t\tif (!domUtils.isBlockElm(tmp.firstChild)) {\n\t\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\twhile (tmp.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tp.appendChild(tmp.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ttmp.appendChild(p);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfrag.appendChild(tmp);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmp = me.document.createElement('span');\n\t\t\t\t\t\t\t\tstartParent.insertBefore(tmp, end);\n\t\t\t\t\t\t\t\tif (!domUtils.isBlockElm(end.firstChild)) {\n\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\twhile (end.firstChild) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(end.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tend.appendChild(p);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfrag.appendChild(end);\n\t\t\t\t\t\t\t\tdomUtils.breakParent(tmp, startParent);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(tmp.previousSibling)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(tmp.previousSibling);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(tmp.nextSibling)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(tmp.nextSibling)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar nodeStyle = getStyle(startParent) || domUtils.getComputedStyle(startParent, 'list-style-type') || (command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc');\n\t\t\t\t\t\t\t\tif (startParent.tagName.toLowerCase() == tag && nodeStyle == style) {\n\t\t\t\t\t\t\t\t\tfor (var i = 0, ci, tmpFrag = me.document.createDocumentFragment(); ci = frag.firstChild;) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isTagNode(ci, 'ol ul')) {\n\t\t\t\t\t\t\t\t\t\t\t//                                  删除时，子列表不处理\n\t\t\t\t\t\t\t\t\t\t\t//                                  utils.each(domUtils.getElementsByTagName(ci,'li'),function(li){\n\t\t\t\t\t\t\t\t\t\t\t//                                        while(li.firstChild){\n\t\t\t\t\t\t\t\t\t\t\t//                                            tmpFrag.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t\t\t//                                        }\n\t\t\t\t\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t\t\t\t\t//                                    });\n\t\t\t\t\t\t\t\t\t\t\ttmpFrag.appendChild(ci);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\twhile (ci.firstChild) {\n\t\n\t\t\t\t\t\t\t\t\t\t\t\ttmpFrag.appendChild(ci.firstChild);\n\t\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttmp.parentNode.insertBefore(tmpFrag, tmp);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tlist = me.document.createElement(tag);\n\t\t\t\t\t\t\t\t\tsetListStyle(list, style);\n\t\t\t\t\t\t\t\t\tlist.appendChild(frag);\n\t\t\t\t\t\t\t\t\ttmp.parentNode.insertBefore(list, tmp);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tdomUtils.remove(tmp);\n\t\t\t\t\t\t\t\tlist && adjustList(list, tag, style);\n\t\t\t\t\t\t\t\trange.moveToBookmark(bko).select();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//开始\n\t\t\t\t\t\t\tif (start) {\n\t\t\t\t\t\t\t\twhile (start) {\n\t\t\t\t\t\t\t\t\ttmp = start.nextSibling;\n\t\t\t\t\t\t\t\t\tif (domUtils.isTagNode(start, 'ol ul')) {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(start);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tvar tmpfrag = me.document.createDocumentFragment(),\n\t\t\t\t\t\t\t\t\t\t\thasBlock = 0;\n\t\t\t\t\t\t\t\t\t\twhile (start.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tif (domUtils.isBlockElm(start.firstChild)) {\n\t\t\t\t\t\t\t\t\t\t\t\thasBlock = 1;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\ttmpfrag.appendChild(start.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (!hasBlock) {\n\t\t\t\t\t\t\t\t\t\t\tvar tmpP = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\t\ttmpP.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpP);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\tstart = tmp;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstartParent.parentNode.insertBefore(frag, startParent.nextSibling);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(startParent)) {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(startParent);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(startParent);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.setStartAfter(startParent);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tmodifyStart = 1;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (end && domUtils.inDoc(endParent, me.document)) {\n\t\t\t\t\t\t\t\t//结束\n\t\t\t\t\t\t\t\tstart = endParent.firstChild;\n\t\t\t\t\t\t\t\twhile (start && start !== end) {\n\t\t\t\t\t\t\t\t\ttmp = start.nextSibling;\n\t\t\t\t\t\t\t\t\tif (domUtils.isTagNode(start, 'ol ul')) {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(start);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\ttmpfrag = me.document.createDocumentFragment();\n\t\t\t\t\t\t\t\t\t\thasBlock = 0;\n\t\t\t\t\t\t\t\t\t\twhile (start.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tif (domUtils.isBlockElm(start.firstChild)) {\n\t\t\t\t\t\t\t\t\t\t\t\thasBlock = 1;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\ttmpfrag.appendChild(start.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (!hasBlock) {\n\t\t\t\t\t\t\t\t\t\t\ttmpP = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\t\ttmpP.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpP);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tstart = tmp;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar tmpDiv = domUtils.createElement(me.document, 'div', {\n\t\t\t\t\t\t\t\t\t'tmpDiv': 1\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tdomUtils.moveChild(end, tmpDiv);\n\t\n\t\t\t\t\t\t\t\tfrag.appendChild(tmpDiv);\n\t\t\t\t\t\t\t\tdomUtils.remove(end);\n\t\t\t\t\t\t\t\tendParent.parentNode.insertBefore(frag, endParent);\n\t\t\t\t\t\t\t\trange.setEndBefore(endParent);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(endParent)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(endParent);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tmodifyEnd = 1;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (!modifyStart) {\n\t\t\t\t\t\t\trange.setStartBefore(me.document.getElementById(bko.start));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (bko.end && !modifyEnd) {\n\t\t\t\t\t\t\trange.setEndAfter(me.document.getElementById(bko.end));\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.enlarge(true, function(node) {\n\t\t\t\t\t\t\treturn notExchange[node.tagName];\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tfrag = me.document.createDocumentFragment();\n\t\n\t\t\t\t\t\tvar bk = range.createBookmark(),\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bk.start, false, filterFn),\n\t\t\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\t\t\ttmpNode,\n\t\t\t\t\t\t\tblock = domUtils.isBlockElm;\n\t\n\t\t\t\t\t\twhile (current && current !== bk.end && (domUtils.getPosition(current, bk.end) & domUtils.POSITION_PRECEDING)) {\n\t\n\t\t\t\t\t\t\tif (current.nodeType == 3 || dtd.li[current.tagName]) {\n\t\t\t\t\t\t\t\tif (current.nodeType == 1 && dtd.$list[current.tagName]) {\n\t\t\t\t\t\t\t\t\twhile (current.firstChild) {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(current.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttmpNode = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t\t\t\tcurrent = tmpNode;\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\n\t\t\t\t\t\t\t\twhile (current && current !== bk.end && (!block(current) || domUtils.isBookmarkNode(current))) {\n\t\t\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\t\treturn !notExchange[node.tagName];\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tif (current && block(current)) {\n\t\t\t\t\t\t\t\t\ttmp = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\t\t\t\t\t\t\t\t\tif (tmp && domUtils.isBookmarkNode(tmp)) {\n\t\t\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(tmp, false, filterFn);\n\t\t\t\t\t\t\t\t\t\ttmpNode = tmp;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\t\n\t\t\t\t\t\t\t\tvar li = range.document.createElement('li');\n\t\n\t\t\t\t\t\t\t\tli.appendChild(tmpRange.extractContents());\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(li)) {\n\t\t\t\t\t\t\t\t\tvar tmpNode = range.document.createElement('p');\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\ttmpNode.appendChild(li.firstChild)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tli.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfrag.appendChild(li);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.moveToBookmark(bk).collapse(true);\n\t\t\t\t\t\tlist = me.document.createElement(tag);\n\t\t\t\t\t\tsetListStyle(list, style);\n\t\t\t\t\t\tlist.appendChild(frag);\n\t\t\t\t\t\trange.insertNode(list);\n\t\t\t\t\t\t//当前list上下看能否合并\n\t\t\t\t\t\tadjustList(list, tag, style);\n\t\t\t\t\t\t//去掉冗余的tmpDiv\n\t\t\t\t\t\tfor (var i = 0, ci, tmpDivs = domUtils.getElementsByTagName(list, 'div'); ci = tmpDivs[i++];) {\n\t\t\t\t\t\t\tif (ci.getAttribute('tmpDiv')) {\n\t\t\t\t\t\t\t\tdomUtils.remove(ci, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.moveToBookmark(bko).select();\n\t\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function(command) {\n\t\t\t\t\t\tvar tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t\t\t\t\t\tvar path = this.selection.getStartElementPath();\n\t\t\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\t\t\tif (ci.nodeName == 'TABLE') {\n\t\t\t\t\t\t\t\treturn 0\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (tag == ci.nodeName.toLowerCase()) {\n\t\t\t\t\t\t\t\treturn 1\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 0;\n\t\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandValue: function(command) {\n\t\t\t\t\t\tvar tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t\t\t\t\t\tvar path = this.selection.getStartElementPath(),\n\t\t\t\t\t\t\tnode;\n\t\t\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\t\t\tif (ci.nodeName == 'TABLE') {\n\t\t\t\t\t\t\t\tnode = null;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (tag == ci.nodeName.toLowerCase()) {\n\t\t\t\t\t\t\t\tnode = ci;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn node ? getStyle(node) || domUtils.getComputedStyle(node, 'list-style-type') : null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t};\n\t\n\t\t// plugins/source.js\n\t\t/**\n\t\t * 源码编辑插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t(function() {\n\t\t\tvar sourceEditors = {\n\t\t\t\ttextarea: function(editor, holder) {\n\t\t\t\t\tvar textarea = holder.ownerDocument.createElement('textarea');\n\t\t\t\t\ttextarea.style.cssText = 'position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;';\n\t\t\t\t\t// todo: IE下只有onresize属性可用... 很纠结\n\t\t\t\t\tif (browser.ie && browser.version < 8) {\n\t\t\t\t\t\ttextarea.style.width = holder.offsetWidth + 'px';\n\t\t\t\t\t\ttextarea.style.height = holder.offsetHeight + 'px';\n\t\t\t\t\t\tholder.onresize = function() {\n\t\t\t\t\t\t\ttextarea.style.width = holder.offsetWidth + 'px';\n\t\t\t\t\t\t\ttextarea.style.height = holder.offsetHeight + 'px';\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tholder.appendChild(textarea);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tsetContent: function(content) {\n\t\t\t\t\t\t\ttextarea.value = content;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetContent: function() {\n\t\t\t\t\t\t\treturn textarea.value;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselect: function() {\n\t\t\t\t\t\t\tvar range;\n\t\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\t\trange = textarea.createTextRange();\n\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//todo: chrome下无法设置焦点\n\t\t\t\t\t\t\t\ttextarea.setSelectionRange(0, 0);\n\t\t\t\t\t\t\t\ttextarea.focus();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdispose: function() {\n\t\t\t\t\t\t\tholder.removeChild(textarea);\n\t\t\t\t\t\t\t// todo\n\t\t\t\t\t\t\tholder.onresize = null;\n\t\t\t\t\t\t\ttextarea = null;\n\t\t\t\t\t\t\tholder = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tcodemirror: function(editor, holder) {\n\t\n\t\t\t\t\tvar codeEditor = window.CodeMirror(holder, {\n\t\t\t\t\t\tmode: \"text/html\",\n\t\t\t\t\t\ttabMode: \"indent\",\n\t\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\t\tlineWrapping: true\n\t\t\t\t\t});\n\t\t\t\t\tvar dom = codeEditor.getWrapperElement();\n\t\t\t\t\tdom.style.cssText = 'position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,\"Courier new\",monospace;font-size:13px;';\n\t\t\t\t\tcodeEditor.getScrollerElement().style.cssText = 'position:absolute;left:0;top:0;width:100%;height:100%;';\n\t\t\t\t\tcodeEditor.refresh();\n\t\t\t\t\treturn {\n\t\t\t\t\t\tgetCodeMirror: function() {\n\t\t\t\t\t\t\treturn codeEditor;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsetContent: function(content) {\n\t\t\t\t\t\t\tcodeEditor.setValue(content);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetContent: function() {\n\t\t\t\t\t\t\treturn codeEditor.getValue();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tselect: function() {\n\t\t\t\t\t\t\tcodeEditor.focus();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdispose: function() {\n\t\t\t\t\t\t\tholder.removeChild(dom);\n\t\t\t\t\t\t\tdom = null;\n\t\t\t\t\t\t\tcodeEditor = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.plugins['source'] = function() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar opt = this.options;\n\t\t\t\tvar sourceMode = false;\n\t\t\t\tvar sourceEditor;\n\t\t\t\tvar orgSetContent;\n\t\t\t\topt.sourceEditor = browser.ie ? 'textarea' : (opt.sourceEditor || 'codemirror');\n\t\n\t\t\t\tme.setOpt({\n\t\t\t\t\tsourceEditorFirst: false\n\t\t\t\t});\n\t\n\t\t\t\tfunction createSourceEditor(holder) {\n\t\t\t\t\treturn sourceEditors[opt.sourceEditor == 'codemirror' && window.CodeMirror ? 'codemirror' : 'textarea'](me, holder);\n\t\t\t\t}\n\t\n\t\t\t\tvar bakCssText;\n\t\t\t\t//解决在源码模式下getContent不能得到最新的内容问题\n\t\t\t\tvar oldGetContent,\n\t\t\t\t\tbakAddress;\n\t\n\t\t\t\t/**\n\t\t\t\t * 切换源码模式和编辑模式\n\t\t\t\t * @command source\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand( 'source');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\t/**\n\t\t\t\t * 查询当前编辑区域的状态是源码模式还是可视化模式\n\t\t\t\t * @command source\n\t\t\t\t * @method queryCommandState\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @return { int } 如果当前是源码编辑模式，返回1，否则返回0\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.queryCommandState( 'source' );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\n\t\t\t\tme.commands['source'] = {\n\t\t\t\t\texecCommand: function() {\n\t\n\t\t\t\t\t\tsourceMode = !sourceMode;\n\t\t\t\t\t\tif (sourceMode) {\n\t\t\t\t\t\t\tbakAddress = me.selection.getRange().createAddress(false, true);\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save(true);\n\t\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tbakCssText = me.iframe.style.cssText;\n\t\t\t\t\t\t\tme.iframe.style.cssText += 'position:absolute;left:-32768px;top:-32768px;';\n\t\n\t\t\t\t\t\t\tme.fireEvent('beforegetcontent');\n\t\t\t\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML);\n\t\t\t\t\t\t\tme.filterOutputRule(root);\n\t\t\t\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\t\t\t\t\tcase 'td':\n\t\t\t\t\t\t\t\t\t\tcase 'th':\n\t\t\t\t\t\t\t\t\t\tcase 'caption':\n\t\t\t\t\t\t\t\t\t\t\tif (node.children && node.children.length == 1) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (node.firstChild().tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tnode.removeChild(node.firstChild())\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcase 'pre':\n\t\t\t\t\t\t\t\t\t\t\tnode.innerText(node.innerText().replace(/&nbsp;/g, ' '))\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\tme.fireEvent('aftergetcontent');\n\t\n\t\t\t\t\t\t\tvar content = root.toHtml(true);\n\t\n\t\t\t\t\t\t\tsourceEditor = createSourceEditor(me.iframe.parentNode);\n\t\n\t\t\t\t\t\t\tsourceEditor.setContent(content);\n\t\n\t\t\t\t\t\t\torgSetContent = me.setContent;\n\t\n\t\t\t\t\t\t\tme.setContent = function(html) {\n\t\t\t\t\t\t\t\t//这里暂时不触发事件，防止报错\n\t\t\t\t\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t\t\t\t\tme.filterInputRule(root);\n\t\t\t\t\t\t\t\thtml = root.toHtml();\n\t\t\t\t\t\t\t\tsourceEditor.setContent(html);\n\t\t\t\t\t\t\t};\n\t\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tsourceEditor.select();\n\t\t\t\t\t\t\t\tme.addListener('fullscreenchanged', function() {\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tsourceEditor.getCodeMirror().refresh()\n\t\t\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\t//重置getContent，源码模式下取值也能是最新的数据\n\t\t\t\t\t\t\toldGetContent = me.getContent;\n\t\t\t\t\t\t\tme.getContent = function() {\n\t\t\t\t\t\t\t\treturn sourceEditor.getContent() || '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.iframe.style.cssText = bakCssText;\n\t\t\t\t\t\t\tvar cont = sourceEditor.getContent() || '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\t//处理掉block节点前后的空格,有可能会误命中，暂时不考虑\n\t\t\t\t\t\t\tcont = cont.replace(new RegExp('[\\\\r\\\\t\\\\n ]*<\\/?(\\\\w+)\\\\s*(?:[^>]*)>', 'g'), function(a, b) {\n\t\t\t\t\t\t\t\tif (b && !dtd.$inlineWithA[b.toLowerCase()]) {\n\t\t\t\t\t\t\t\t\treturn a.replace(/(^[\\n\\r\\t ]*)|([\\n\\r\\t ]*$)/g, '');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn a.replace(/(^[\\n\\r\\t]*)|([\\n\\r\\t]*$)/g, '')\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\tme.setContent = orgSetContent;\n\t\n\t\t\t\t\t\t\tme.setContent(cont);\n\t\t\t\t\t\t\tsourceEditor.dispose();\n\t\t\t\t\t\t\tsourceEditor = null;\n\t\t\t\t\t\t\t//还原getContent方法\n\t\t\t\t\t\t\tme.getContent = oldGetContent;\n\t\t\t\t\t\t\tvar first = me.body.firstChild;\n\t\t\t\t\t\t\t//trace:1106 都删除空了，下边会报错，所以补充一个p占位\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\t\tfirst = me.body.firstChild;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t//要在ifm为显示时ff才能取到selection,否则报错\n\t\t\t\t\t\t\t//这里不能比较位置了\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save(true);\n\t\n\t\t\t\t\t\t\tif (browser.gecko) {\n\t\n\t\t\t\t\t\t\t\tvar input = document.createElement('input');\n\t\t\t\t\t\t\t\tinput.style.cssText = 'position:absolute;left:0;top:-32768px';\n\t\n\t\t\t\t\t\t\t\tdocument.body.appendChild(input);\n\t\n\t\t\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tdomUtils.setViewportOffset(input, {\n\t\t\t\t\t\t\t\t\t\tleft: -32768,\n\t\t\t\t\t\t\t\t\t\ttop: 0\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\t\t\t\t\t\tme.selection.getRange().moveToAddress(bakAddress).select(true);\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(input);\n\t\t\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//ie下有可能报错，比如在代码顶头的情况\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tme.selection.getRange().moveToAddress(bakAddress).select(true);\n\t\t\t\t\t\t\t\t} catch (e) {}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.fireEvent('sourcemodechanged', sourceMode);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn sourceMode | 0;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: 1\n\t\t\t\t};\n\t\t\t\tvar oldQueryCommandState = me.queryCommandState;\n\t\n\t\t\t\tme.queryCommandState = function(cmdName) {\n\t\t\t\t\tcmdName = cmdName.toLowerCase();\n\t\t\t\t\tif (sourceMode) {\n\t\t\t\t\t\t//源码模式下可以开启的命令\n\t\t\t\t\t\treturn cmdName in {\n\t\t\t\t\t\t\t'source': 1,\n\t\t\t\t\t\t\t'fullscreen': 1\n\t\t\t\t\t\t} ? 1 : -1\n\t\t\t\t\t}\n\t\t\t\t\treturn oldQueryCommandState.apply(this, arguments);\n\t\t\t\t};\n\t\n\t\t\t\tif (opt.sourceEditor == \"codemirror\") {\n\t\n\t\t\t\t\tme.addListener(\"ready\", function() {\n\t\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\t\tsrc: opt.codeMirrorJsUrl || opt.UEDITOR_HOME_URL + \"third-party/codemirror/codemirror.js\",\n\t\t\t\t\t\t\ttag: \"script\",\n\t\t\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t\t\t}, function() {\n\t\t\t\t\t\t\tif (opt.sourceEditorFirst) {\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tme.execCommand(\"source\");\n\t\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\t\ttag: \"link\",\n\t\t\t\t\t\t\trel: \"stylesheet\",\n\t\t\t\t\t\t\ttype: \"text/css\",\n\t\t\t\t\t\t\thref: opt.codeMirrorCssUrl || opt.UEDITOR_HOME_URL + \"third-party/codemirror/codemirror.css\"\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t};\n\t\n\t\t})();\n\t\n\t\t// plugins/enterkey.js\n\t\t///import core\n\t\t///import plugins/undo.js\n\t\t///commands 设置回车标签p或br\n\t\t///commandsName  EnterKey\n\t\t///commandsTitle  设置回车标签p或br\n\t\t/**\n\t\t * @description 处理回车\n\t\t * @author zhanyi\n\t\t */\n\t\tUE.plugins['enterkey'] = function() {\n\t\t\tvar hTag,\n\t\t\t\tme = this,\n\t\t\t\ttag = me.options.enterTag;\n\t\t\tme.addListener('keyup', function(type, evt) {\n\t\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 13) {\n\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\tstart = range.startContainer,\n\t\t\t\t\t\tdoSave;\n\t\n\t\t\t\t\t//修正在h1-h6里边回车后不能嵌套p的问题\n\t\t\t\t\tif (!browser.ie) {\n\t\n\t\t\t\t\t\tif (/h\\d/i.test(hTag)) {\n\t\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\t\tvar h = domUtils.findParentByTagName(start, ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'caption', 'table'], true);\n\t\t\t\t\t\t\t\tif (!h) {\n\t\t\t\t\t\t\t\t\tme.document.execCommand('formatBlock', false, '<p>');\n\t\t\t\t\t\t\t\t\tdoSave = 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t//chrome remove div\n\t\t\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\t\t\tvar tmp = me.document.createTextNode(''),\n\t\t\t\t\t\t\t\t\t\tdiv;\n\t\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\t\tdiv = domUtils.findParentByTagName(tmp, 'div', true);\n\t\t\t\t\t\t\t\t\tif (div) {\n\t\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\twhile (div.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tp.appendChild(div.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdiv.parentNode.insertBefore(p, div);\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(div);\n\t\t\t\t\t\t\t\t\t\trange.setStartBefore(tmp).setCursor();\n\t\t\t\t\t\t\t\t\t\tdoSave = 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(tmp);\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (me.undoManger && doSave) {\n\t\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//没有站位符，会出现多行的问题\n\t\t\t\t\t\tbrowser.opera && range.select();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.fireEvent('saveScene', true, true)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tme.addListener('keydown', function(type, evt) {\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 13) { //回车\n\t\t\t\t\tif (me.fireEvent('beforeenterkeydown')) {\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('saveScene', true, true);\n\t\t\t\t\thTag = '';\n\t\n\t\t\t\t\tvar range = me.selection.getRange();\n\t\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t//跨td不能删\n\t\t\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\t\t\tend = range.endContainer,\n\t\t\t\t\t\t\tstartTd = domUtils.findParentByTagName(start, 'td', true),\n\t\t\t\t\t\t\tendTd = domUtils.findParentByTagName(end, 'td', true);\n\t\t\t\t\t\tif (startTd && endTd && startTd !== endTd || !startTd && endTd || startTd && !endTd) {\n\t\t\t\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (tag == 'p') {\n\t\n\t\t\t\t\t\tif (!browser.ie) {\n\t\n\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, ['ol', 'ul', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'caption'], true);\n\t\n\t\t\t\t\t\t\t//opera下执行formatblock会在table的场景下有问题，回车在opera原生支持很好，所以暂时在opera去掉调用这个原生的command\n\t\t\t\t\t\t\t//trace:2431\n\t\t\t\t\t\t\tif (!start && !browser.opera) {\n\t\n\t\t\t\t\t\t\t\tme.document.execCommand('formatBlock', false, '<p>');\n\t\n\t\t\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'p', true);\n\t\t\t\t\t\t\t\t\tstart && domUtils.removeDirtyAttr(start);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\thTag = start.tagName;\n\t\t\t\t\t\t\t\tstart.tagName.toLowerCase() == 'p' && browser.gecko && domUtils.removeDirtyAttr(start);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\n\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t\tif (start.nodeType == 1 && (start = start.childNodes[range.startOffset])) {\n\t\t\t\t\t\t\t\twhile (start.nodeType == 1) {\n\t\t\t\t\t\t\t\t\tif (dtd.$empty[start.tagName]) {\n\t\t\t\t\t\t\t\t\t\trange.setStartBefore(start).setCursor();\n\t\t\t\t\t\t\t\t\t\tif (me.undoManger) {\n\t\t\t\t\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!start.firstChild) {\n\t\t\t\t\t\t\t\t\t\tvar br = range.document.createElement('br');\n\t\t\t\t\t\t\t\t\t\tstart.appendChild(br);\n\t\t\t\t\t\t\t\t\t\trange.setStart(start, 0).setCursor();\n\t\t\t\t\t\t\t\t\t\tif (me.undoManger) {\n\t\t\t\t\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tstart = start.firstChild;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (start === range.startContainer.childNodes[range.startOffset]) {\n\t\t\t\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\t\t\t\trange.insertNode(br).setCursor();\n\t\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.setStart(start, 0).setCursor();\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\t\t\trange.insertNode(br).setStartAfter(br).setCursor();\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\t\trange.insertNode(br);\n\t\t\t\t\t\t\tvar parent = br.parentNode;\n\t\t\t\t\t\t\tif (parent.lastChild === br) {\n\t\t\t\t\t\t\t\tbr.parentNode.insertBefore(br.cloneNode(true), br);\n\t\t\t\t\t\t\t\trange.setStartBefore(br);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.setStartAfter(br);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.setCursor();\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/keystrokes.js\n\t\t/* 处理特殊键的兼容性问题 */\n\t\tUE.plugins['keystrokes'] = function() {\n\t\t\tvar me = this;\n\t\t\tvar collapsed = true;\n\t\t\tme.addListener('keydown', function(type, evt) {\n\t\t\t\tvar keyCode = evt.keyCode || evt.which,\n\t\t\t\t\trng = me.selection.getRange();\n\t\n\t\t\t\t//处理全选的情况\n\t\t\t\tif (!rng.collapsed && !(evt.ctrlKey || evt.shiftKey || evt.altKey || evt.metaKey) && (keyCode >= 65 && keyCode <= 90 || keyCode >= 48 && keyCode <= 57 ||\n\t\t\t\t\t\tkeyCode >= 96 && keyCode <= 111 || {\n\t\t\t\t\t\t\t13: 1,\n\t\t\t\t\t\t\t8: 1,\n\t\t\t\t\t\t\t46: 1\n\t\t\t\t\t\t}[keyCode])) {\n\t\n\t\t\t\t\tvar tmpNode = rng.startContainer;\n\t\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\t\trng.setStartBefore(tmpNode)\n\t\t\t\t\t}\n\t\t\t\t\ttmpNode = rng.endContainer;\n\t\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\t\trng.setEndAfter(tmpNode)\n\t\t\t\t\t}\n\t\t\t\t\trng.txtToElmBoundary();\n\t\t\t\t\t//结束边界可能放到了br的前边，要把br包含进来\n\t\t\t\t\t// x[xxx]<br/>\n\t\t\t\t\tif (rng.endContainer && rng.endContainer.nodeType == 1) {\n\t\t\t\t\t\ttmpNode = rng.endContainer.childNodes[rng.endOffset];\n\t\t\t\t\t\tif (tmpNode && domUtils.isBr(tmpNode)) {\n\t\t\t\t\t\t\trng.setEndAfter(tmpNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (rng.startOffset == 0) {\n\t\t\t\t\t\ttmpNode = rng.startContainer;\n\t\t\t\t\t\tif (domUtils.isBoundaryNode(tmpNode, 'firstChild')) {\n\t\t\t\t\t\t\ttmpNode = rng.endContainer;\n\t\t\t\t\t\t\tif (rng.endOffset == (tmpNode.nodeType == 3 ? tmpNode.nodeValue.length : tmpNode.childNodes.length) && domUtils.isBoundaryNode(tmpNode, 'lastChild')) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\t\trng.setStart(me.body.firstChild, 0).setCursor(false, true);\n\t\t\t\t\t\t\t\tme._selectionChange();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t//处理backspace\n\t\t\t\tif (keyCode == keymap.Backspace) {\n\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\tcollapsed = rng.collapsed;\n\t\t\t\t\tif (me.fireEvent('delkeydown', evt)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar start, end;\n\t\t\t\t\t//避免按两次删除才能生效的问题\n\t\t\t\t\tif (rng.collapsed && rng.inFillChar()) {\n\t\t\t\t\t\tstart = rng.startContainer;\n\t\n\t\t\t\t\t\tif (domUtils.isFillChar(start)) {\n\t\t\t\t\t\t\trng.setStartBefore(start).shrinkBoundary(true).collapse(true);\n\t\t\t\t\t\t\tdomUtils.remove(start)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstart.nodeValue = start.nodeValue.replace(new RegExp('^' + domUtils.fillChar), '');\n\t\t\t\t\t\t\trng.startOffset--;\n\t\t\t\t\t\t\trng.collapse(true).select(true)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//解决选中control元素不能删除的问题\n\t\t\t\t\tif (start = rng.getClosedNode()) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\trng.setStartBefore(start);\n\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\trng.setCursor();\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//阻止在table上的删除\n\t\t\t\t\tif (!browser.ie) {\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(rng.startContainer, 'table', true);\n\t\t\t\t\t\tend = domUtils.findParentByTagName(rng.endContainer, 'table', true);\n\t\t\t\t\t\tif (start && !end || !start && end || start !== end) {\n\t\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t\t//处理tab键的逻辑\n\t\t\t\tif (keyCode == keymap.Tab) {\n\t\t\t\t\t//不处理以下标签\n\t\t\t\t\tvar excludeTagNameForTabKey = {\n\t\t\t\t\t\t'ol': 1,\n\t\t\t\t\t\t'ul': 1,\n\t\t\t\t\t\t'table': 1\n\t\t\t\t\t};\n\t\t\t\t\t//处理组件里的tab按下事件\n\t\t\t\t\tif (me.fireEvent('tabkeydown', evt)) {\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tfor (var i = 0, txt = '', tabSize = me.options.tabSize || 4, tabNode = me.options.tabNode || '&nbsp;'; i < tabSize; i++) {\n\t\t\t\t\t\ttxt += tabNode;\n\t\t\t\t\t}\n\t\t\t\t\tvar span = me.document.createElement('span');\n\t\t\t\t\tspan.innerHTML = txt + domUtils.fillChar;\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\trange.insertNode(span.cloneNode(true).firstChild).setCursor(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar filterFn = function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node) && !excludeTagNameForTabKey[node.tagName.toLowerCase()]\n\t\n\t\t\t\t\t\t};\n\t\t\t\t\t\t//普通的情况\n\t\t\t\t\t\tstart = domUtils.findParent(range.startContainer, filterFn, true);\n\t\t\t\t\t\tend = domUtils.findParent(range.endContainer, filterFn, true);\n\t\t\t\t\t\tif (start && end && start === end) {\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\trange.insertNode(span.cloneNode(true).firstChild).setCursor(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar bookmark = range.createBookmark();\n\t\t\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn);\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tcurrent.insertBefore(span.cloneNode(true).firstChild, current.firstChild);\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.moveToBookmark(bookmark2).moveToBookmark(bookmark).select();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.preventDefault(evt)\n\t\t\t\t}\n\t\t\t\t//trace:1634\n\t\t\t\t//ff的del键在容器空的时候，也会删除\n\t\t\t\tif (browser.gecko && keyCode == 46) {\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(start)) {\n\t\t\t\t\t\t\tvar parent = start.parentNode;\n\t\t\t\t\t\t\twhile (domUtils.getChildCount(parent) == 1 && !domUtils.isBody(parent)) {\n\t\t\t\t\t\t\t\tstart = parent;\n\t\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (start === parent.lastChild)\n\t\t\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tme.addListener('keyup', function(type, evt) {\n\t\t\t\tvar keyCode = evt.keyCode || evt.which,\n\t\t\t\t\trng, me = this;\n\t\t\t\tif (keyCode == keymap.Backspace) {\n\t\t\t\t\tif (me.fireEvent('delkeyup')) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\tvar tmpNode,\n\t\t\t\t\t\t\tautoClearTagName = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\t\t\t\t\t\tif (tmpNode = domUtils.findParentByTagName(rng.startContainer, autoClearTagName, true)) {\n\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\t\t\t\t\tvar pre = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\tif (pre && pre.nodeName != 'TABLE') {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\trng.setStartAtLast(pre).setCursor(false, true);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar next = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\t\tif (next && next.nodeName != 'TABLE') {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\t\trng.setStartAtFirst(next).setCursor(false, true);\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//处理当删除到body时，要重新给p标签展位\n\t\t\t\t\t\tif (domUtils.isBody(rng.startContainer)) {\n\t\t\t\t\t\t\tvar tmpNode = domUtils.createElement(me.document, 'p', {\n\t\t\t\t\t\t\t\t'innerHTML': browser.ie ? domUtils.fillChar : '<br/>'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\trng.insertNode(tmpNode).setStart(tmpNode, 0).setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//chrome下如果删除了inline标签，浏览器会有记忆，在输入文字还是会套上刚才删除的标签，所以这里再选一次就不会了\n\t\t\t\t\tif (!collapsed && (rng.startContainer.nodeType == 3 || rng.startContainer.nodeType == 1 && domUtils.isEmptyBlock(rng.startContainer))) {\n\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\tvar span = rng.document.createElement('span');\n\t\t\t\t\t\t\trng.insertNode(span).setStartBefore(span).collapse(true);\n\t\t\t\t\t\t\trng.select();\n\t\t\t\t\t\t\tdomUtils.remove(span)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.select()\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t})\n\t\t};\n\t\n\t\t// plugins/fiximgclick.js\n\t\t///import core\n\t\t///commands 修复chrome下图片不能点击的问题，出现八个角可改变大小\n\t\t///commandsName  FixImgClick\n\t\t///commandsTitle  修复chrome下图片不能点击的问题，出现八个角可改变大小\n\t\t//修复chrome下图片不能点击的问题，出现八个角可改变大小\n\t\n\t\tUE.plugins['fiximgclick'] = (function() {\n\t\n\t\t\tvar elementUpdated = false;\n\t\n\t\t\tfunction Scale() {\n\t\t\t\tthis.editor = null;\n\t\t\t\tthis.resizer = null;\n\t\t\t\tthis.cover = null;\n\t\t\t\tthis.doc = document;\n\t\t\t\tthis.prePos = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t};\n\t\t\t\tthis.startPos = {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0\n\t\t\t\t};\n\t\t\t}\n\t\n\t\t\t(function() {\n\t\t\t\tvar rect = [\n\t\t\t\t\t//[left, top, width, height]\n\t\t\t\t\t[0, 0, -1, -1],\n\t\t\t\t\t[0, 0, 0, -1],\n\t\t\t\t\t[0, 0, 1, -1],\n\t\t\t\t\t[0, 0, -1, 0],\n\t\t\t\t\t[0, 0, 1, 0],\n\t\t\t\t\t[0, 0, -1, 1],\n\t\t\t\t\t[0, 0, 0, 1],\n\t\t\t\t\t[0, 0, 1, 1]\n\t\t\t\t];\n\t\n\t\t\t\tScale.prototype = {\n\t\t\t\t\tinit: function(editor) {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tme.editor = editor;\n\t\t\t\t\t\tme.startPos = this.prePos = {\n\t\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\t\ty: 0\n\t\t\t\t\t\t};\n\t\t\t\t\t\tme.dragId = -1;\n\t\n\t\t\t\t\t\tvar hands = [],\n\t\t\t\t\t\t\tcover = me.cover = document.createElement('div'),\n\t\t\t\t\t\t\tresizer = me.resizer = document.createElement('div');\n\t\n\t\t\t\t\t\tcover.id = me.editor.ui.id + '_imagescale_cover';\n\t\t\t\t\t\tcover.style.cssText = 'position:absolute;display:none;z-index:' + (me.editor.options.zIndex) + ';filter:alpha(opacity=0); opacity:0;background:#CCC;';\n\t\t\t\t\t\tdomUtils.on(cover, 'mousedown click', function() {\n\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tfor (i = 0; i < 8; i++) {\n\t\t\t\t\t\t\thands.push('<span class=\"edui-editor-imagescale-hand' + i + '\"></span>');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresizer.id = me.editor.ui.id + '_imagescale';\n\t\t\t\t\t\tresizer.className = 'edui-editor-imagescale';\n\t\t\t\t\t\tresizer.innerHTML = hands.join('');\n\t\t\t\t\t\tresizer.style.cssText += ';display:none;border:1px solid #3b77ff;z-index:' + (me.editor.options.zIndex) + ';';\n\t\n\t\t\t\t\t\tme.editor.ui.getDom().appendChild(cover);\n\t\t\t\t\t\tme.editor.ui.getDom().appendChild(resizer);\n\t\n\t\t\t\t\t\tme.initStyle();\n\t\t\t\t\t\tme.initEvents();\n\t\t\t\t\t},\n\t\t\t\t\tinitStyle: function() {\n\t\t\t\t\t\tutils.cssRule('imagescale', '.edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}' +\n\t\t\t\t\t\t\t'.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}');\n\t\t\t\t\t},\n\t\t\t\t\tinitEvents: function() {\n\t\t\t\t\t\tvar me = this;\n\t\n\t\t\t\t\t\tme.startPos.x = me.startPos.y = 0;\n\t\t\t\t\t\tme.isDraging = false;\n\t\t\t\t\t},\n\t\t\t\t\t_eventHandler: function(e) {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tswitch (e.type) {\n\t\t\t\t\t\t\tcase 'mousedown':\n\t\t\t\t\t\t\t\tvar hand = e.target || e.srcElement,\n\t\t\t\t\t\t\t\t\thand;\n\t\t\t\t\t\t\t\tif (hand.className.indexOf('edui-editor-imagescale-hand') != -1 && me.dragId == -1) {\n\t\t\t\t\t\t\t\t\tme.dragId = hand.className.slice(-1);\n\t\t\t\t\t\t\t\t\tme.startPos.x = me.prePos.x = e.clientX;\n\t\t\t\t\t\t\t\t\tme.startPos.y = me.prePos.y = e.clientY;\n\t\t\t\t\t\t\t\t\tdomUtils.on(me.doc, 'mousemove', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'mousemove':\n\t\t\t\t\t\t\t\tif (me.dragId != -1) {\n\t\t\t\t\t\t\t\t\tme.updateContainerStyle(me.dragId, {\n\t\t\t\t\t\t\t\t\t\tx: e.clientX - me.prePos.x,\n\t\t\t\t\t\t\t\t\t\ty: e.clientY - me.prePos.y\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tme.prePos.x = e.clientX;\n\t\t\t\t\t\t\t\t\tme.prePos.y = e.clientY;\n\t\t\t\t\t\t\t\t\telementUpdated = true;\n\t\t\t\t\t\t\t\t\tme.updateTargetElement();\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'mouseup':\n\t\t\t\t\t\t\t\tif (me.dragId != -1) {\n\t\t\t\t\t\t\t\t\tme.updateContainerStyle(me.dragId, {\n\t\t\t\t\t\t\t\t\t\tx: e.clientX - me.prePos.x,\n\t\t\t\t\t\t\t\t\t\ty: e.clientY - me.prePos.y\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tme.updateTargetElement();\n\t\t\t\t\t\t\t\t\tif (me.target.parentNode) me.attachTo(me.target);\n\t\t\t\t\t\t\t\t\tme.dragId = -1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.un(me.doc, 'mousemove', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\t\t\t//修复只是点击挪动点，但没有改变大小，不应该触发contentchange\n\t\t\t\t\t\t\t\tif (elementUpdated) {\n\t\t\t\t\t\t\t\t\telementUpdated = false;\n\t\t\t\t\t\t\t\t\tme.editor.fireEvent('contentchange');\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tupdateTargetElement: function() {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tdomUtils.setStyles(me.target, {\n\t\t\t\t\t\t\t'width': me.resizer.style.width,\n\t\t\t\t\t\t\t'height': me.resizer.style.height\n\t\t\t\t\t\t});\n\t\t\t\t\t\tme.target.width = parseInt(me.resizer.style.width);\n\t\t\t\t\t\tme.target.height = parseInt(me.resizer.style.height);\n\t\t\t\t\t\tme.attachTo(me.target);\n\t\t\t\t\t},\n\t\t\t\t\tupdateContainerStyle: function(dir, offset) {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tdom = me.resizer,\n\t\t\t\t\t\t\ttmp;\n\t\n\t\t\t\t\t\tif (rect[dir][0] != 0) {\n\t\t\t\t\t\t\ttmp = parseInt(dom.style.left) + offset.x;\n\t\t\t\t\t\t\tdom.style.left = me._validScaledProp('left', tmp) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (rect[dir][1] != 0) {\n\t\t\t\t\t\t\ttmp = parseInt(dom.style.top) + offset.y;\n\t\t\t\t\t\t\tdom.style.top = me._validScaledProp('top', tmp) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (rect[dir][2] != 0) {\n\t\t\t\t\t\t\ttmp = dom.clientWidth + rect[dir][2] * offset.x;\n\t\t\t\t\t\t\tdom.style.width = me._validScaledProp('width', tmp) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (rect[dir][3] != 0) {\n\t\t\t\t\t\t\ttmp = dom.clientHeight + rect[dir][3] * offset.y;\n\t\t\t\t\t\t\tdom.style.height = me._validScaledProp('height', tmp) + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t_validScaledProp: function(prop, value) {\n\t\t\t\t\t\tvar ele = this.resizer,\n\t\t\t\t\t\t\twrap = document;\n\t\n\t\t\t\t\t\tvalue = isNaN(value) ? 0 : value;\n\t\t\t\t\t\tswitch (prop) {\n\t\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\t\treturn value < 0 ? 0 : (value + ele.clientWidth) > wrap.clientWidth ? wrap.clientWidth - ele.clientWidth : value;\n\t\t\t\t\t\t\tcase 'top':\n\t\t\t\t\t\t\t\treturn value < 0 ? 0 : (value + ele.clientHeight) > wrap.clientHeight ? wrap.clientHeight - ele.clientHeight : value;\n\t\t\t\t\t\t\tcase 'width':\n\t\t\t\t\t\t\t\treturn value <= 0 ? 1 : (value + ele.offsetLeft) > wrap.clientWidth ? wrap.clientWidth - ele.offsetLeft : value;\n\t\t\t\t\t\t\tcase 'height':\n\t\t\t\t\t\t\t\treturn value <= 0 ? 1 : (value + ele.offsetTop) > wrap.clientHeight ? wrap.clientHeight - ele.offsetTop : value;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\thideCover: function() {\n\t\t\t\t\t\tthis.cover.style.display = 'none';\n\t\t\t\t\t},\n\t\t\t\t\tshowCover: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\teditorPos = domUtils.getXY(me.editor.ui.getDom()),\n\t\t\t\t\t\t\tiframePos = domUtils.getXY(me.editor.iframe);\n\t\n\t\t\t\t\t\tdomUtils.setStyles(me.cover, {\n\t\t\t\t\t\t\t'width': me.editor.iframe.offsetWidth + 'px',\n\t\t\t\t\t\t\t'height': me.editor.iframe.offsetHeight + 'px',\n\t\t\t\t\t\t\t'top': iframePos.y - editorPos.y + 'px',\n\t\t\t\t\t\t\t'left': iframePos.x - editorPos.x + 'px',\n\t\t\t\t\t\t\t'position': 'absolute',\n\t\t\t\t\t\t\t'display': ''\n\t\t\t\t\t\t})\n\t\t\t\t\t},\n\t\t\t\t\tshow: function(targetObj) {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tme.resizer.style.display = 'block';\n\t\t\t\t\t\tif (targetObj) me.attachTo(targetObj);\n\t\n\t\t\t\t\t\tdomUtils.on(this.resizer, 'mousedown', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\tdomUtils.on(me.doc, 'mouseup', me.proxy(me._eventHandler, me));\n\t\n\t\t\t\t\t\tme.showCover();\n\t\t\t\t\t\tme.editor.fireEvent('afterscaleshow', me);\n\t\t\t\t\t\tme.editor.fireEvent('saveScene');\n\t\t\t\t\t},\n\t\t\t\t\thide: function() {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tme.hideCover();\n\t\t\t\t\t\tme.resizer.style.display = 'none';\n\t\n\t\t\t\t\t\tdomUtils.un(me.resizer, 'mousedown', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\tdomUtils.un(me.doc, 'mouseup', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\tme.editor.fireEvent('afterscalehide', me);\n\t\t\t\t\t},\n\t\t\t\t\tproxy: function(fn, context) {\n\t\t\t\t\t\treturn function(e) {\n\t\t\t\t\t\t\treturn fn.apply(context || this, arguments);\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\tattachTo: function(targetObj) {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\ttarget = me.target = targetObj,\n\t\t\t\t\t\t\tresizer = this.resizer,\n\t\t\t\t\t\t\timgPos = domUtils.getXY(target),\n\t\t\t\t\t\t\tiframePos = domUtils.getXY(me.editor.iframe),\n\t\t\t\t\t\t\teditorPos = domUtils.getXY(resizer.parentNode);\n\t\n\t\t\t\t\t\tdomUtils.setStyles(resizer, {\n\t\t\t\t\t\t\t'width': target.width + 'px',\n\t\t\t\t\t\t\t'height': target.height + 'px',\n\t\t\t\t\t\t\t'left': iframePos.x + imgPos.x - me.editor.document.body.scrollLeft - editorPos.x - parseInt(resizer.style.borderLeftWidth) + 'px',\n\t\t\t\t\t\t\t'top': iframePos.y + imgPos.y - me.editor.document.body.scrollTop - editorPos.y - parseInt(resizer.style.borderTopWidth) + 'px'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})();\n\t\n\t\t\treturn function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\timageScale;\n\t\n\t\t\t\tme.setOpt('imageScaleEnabled', true);\n\t\n\t\t\t\tif (!browser.ie && me.options.imageScaleEnabled) {\n\t\t\t\t\tme.addListener('click', function(type, e) {\n\t\n\t\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\t\timg = range.getClosedNode();\n\t\n\t\t\t\t\t\tif (img && img.tagName == 'IMG' && me.body.contentEditable != \"false\") {\n\t\n\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-music\") != -1 ||\n\t\t\t\t\t\t\t\timg.getAttribute(\"anchorname\") ||\n\t\t\t\t\t\t\t\tdomUtils.hasClass(img, 'loadingclass') ||\n\t\t\t\t\t\t\t\tdomUtils.hasClass(img, 'loaderrorclass')) {\n\t\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (!imageScale) {\n\t\t\t\t\t\t\t\timageScale = new Scale();\n\t\t\t\t\t\t\t\timageScale.init(me);\n\t\t\t\t\t\t\t\tme.ui.getDom().appendChild(imageScale.resizer);\n\t\n\t\t\t\t\t\t\t\tvar _keyDownHandler = function(e) {\n\t\t\t\t\t\t\t\t\t\timageScale.hide();\n\t\t\t\t\t\t\t\t\t\tif (imageScale.target) me.selection.getRange().selectNode(imageScale.target).select();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t_mouseDownHandler = function(e) {\n\t\t\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\t\t\tif (ele && (ele.className === undefined || ele.className.indexOf('edui-editor-imagescale') == -1)) {\n\t\t\t\t\t\t\t\t\t\t\t_keyDownHandler(e);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttimer;\n\t\n\t\t\t\t\t\t\t\tme.addListener('afterscaleshow', function(e) {\n\t\t\t\t\t\t\t\t\tme.addListener('beforekeydown', _keyDownHandler);\n\t\t\t\t\t\t\t\t\tme.addListener('beforemousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\t\tdomUtils.on(document, 'keydown', _keyDownHandler);\n\t\t\t\t\t\t\t\t\tdomUtils.on(document, 'mousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tme.addListener('afterscalehide', function(e) {\n\t\t\t\t\t\t\t\t\tme.removeListener('beforekeydown', _keyDownHandler);\n\t\t\t\t\t\t\t\t\tme.removeListener('beforemousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\t\tdomUtils.un(document, 'keydown', _keyDownHandler);\n\t\t\t\t\t\t\t\t\tdomUtils.un(document, 'mousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\t\tvar target = imageScale.target;\n\t\t\t\t\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\t\t\t\t\tme.selection.getRange().selectNode(target).select();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t//TODO 有iframe的情况，mousedown不能往下传。。\n\t\t\t\t\t\t\t\tdomUtils.on(imageScale.resizer, 'mousedown', function(e) {\n\t\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\t\tif (ele && ele.className.indexOf('edui-editor-imagescale-hand') == -1) {\n\t\t\t\t\t\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\timageScale.hide();\n\t\t\t\t\t\t\t\t\t\t\tif (imageScale.target) me.selection.getRange().selectNode(ele).select();\n\t\t\t\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tdomUtils.on(imageScale.resizer, 'mouseup', function(e) {\n\t\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\t\tif (ele && ele.className.indexOf('edui-editor-imagescale-hand') == -1) {\n\t\t\t\t\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\timageScale.show(img);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (imageScale && imageScale.resizer.style.display != 'none') imageScale.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\tme.addListener('click', function(type, e) {\n\t\t\t\t\t\tif (e.target.tagName == 'IMG' && me.body.contentEditable != \"false\") {\n\t\t\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\t\t\trange.selectNode(e.target).select();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\t\n\t\t// plugins/autolink.js\n\t\t///import core\n\t\t///commands 为非ie浏览器自动添加a标签\n\t\t///commandsName  AutoLink\n\t\t///commandsTitle  自动增加链接\n\t\t/**\n\t\t * @description 为非ie浏览器自动添加a标签\n\t\t * @author zhanyi\n\t\t */\n\t\n\t\tUE.plugin.register('autolink', function() {\n\t\t\tvar cont = 0;\n\t\n\t\t\treturn !browser.ie ? {\n\t\n\t\t\t\tbindEvents: {\n\t\t\t\t\t'reset': function() {\n\t\t\t\t\t\tcont = 0;\n\t\t\t\t\t},\n\t\t\t\t\t'keydown': function(type, evt) {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\n\t\t\t\t\t\tif (keyCode == 32 || keyCode == 13) {\n\t\n\t\t\t\t\t\t\tvar sel = me.selection.getNative(),\n\t\t\t\t\t\t\t\trange = sel.getRangeAt(0).cloneRange(),\n\t\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\t\tcharCode;\n\t\n\t\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\t\twhile (start.nodeType == 1 && range.startOffset > 0) {\n\t\t\t\t\t\t\t\tstart = range.startContainer.childNodes[range.startOffset - 1];\n\t\t\t\t\t\t\t\tif (!start) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.setStart(start, start.nodeType == 1 ? start.childNodes.length : start.nodeValue.length);\n\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\t\t\t\t\tstart = range.startContainer.previousSibling;\n\t\n\t\t\t\t\t\t\t\t\twhile (start && start.nodeType == 1) {\n\t\t\t\t\t\t\t\t\t\tstart = start.lastChild;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!start || domUtils.isFillChar(start)) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\toffset = start.nodeValue.length;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t\t\t\toffset = range.startOffset;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.setStart(start, offset - 1);\n\t\t\t\t\t\t\t\tcharCode = range.toString().charCodeAt(0);\n\t\t\t\t\t\t\t} while (charCode != 160 && charCode != 32);\n\t\n\t\t\t\t\t\t\tif (range.toString().replace(new RegExp(domUtils.fillChar, 'g'), '').match(/(?:https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.)/i)) {\n\t\t\t\t\t\t\t\twhile (range.toString().length) {\n\t\t\t\t\t\t\t\t\tif (/^(?:https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.)/i.test(range.toString())) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\trange.setStart(range.startContainer, range.startOffset + 1);\n\t\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\t\t//trace:2121\n\t\t\t\t\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\t\t\t\t\twhile (!(next = start.nextSibling)) {\n\t\t\t\t\t\t\t\t\t\t\tif (domUtils.isBody(start)) {\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tstart = start.parentNode;\n\t\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\trange.setStart(next, 0);\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t//range的开始边界已经在a标签里的不再处理\n\t\t\t\t\t\t\t\tif (domUtils.findParentByTagName(range.startContainer, 'a', true)) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tvar a = me.document.createElement('a'),\n\t\t\t\t\t\t\t\t\ttext = me.document.createTextNode(' '),\n\t\t\t\t\t\t\t\t\thref;\n\t\n\t\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t\t\ta.appendChild(range.extractContents());\n\t\t\t\t\t\t\t\ta.href = a.innerHTML = a.innerHTML.replace(/<[^>]+>/g, '');\n\t\t\t\t\t\t\t\thref = a.getAttribute(\"href\").replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\t\t\t\t\t\t\thref = /^(?:https?:\\/\\/)/ig.test(href) ? href : \"http://\" + href;\n\t\t\t\t\t\t\t\ta.setAttribute('_src', utils.html(href));\n\t\t\t\t\t\t\t\ta.href = utils.html(href);\n\t\n\t\t\t\t\t\t\t\trange.insertNode(a);\n\t\t\t\t\t\t\t\ta.parentNode.insertBefore(text, a.nextSibling);\n\t\t\t\t\t\t\t\trange.setStart(text, 0);\n\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\t\tsel.addRange(range);\n\t\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} : {}\n\t\t}, function() {\n\t\t\tvar keyCodes = {\n\t\t\t\t37: 1,\n\t\t\t\t38: 1,\n\t\t\t\t39: 1,\n\t\t\t\t40: 1,\n\t\t\t\t13: 1,\n\t\t\t\t32: 1\n\t\t\t};\n\t\n\t\t\tfunction checkIsCludeLink(node) {\n\t\t\t\tif (node.nodeType == 3) {\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\tif (node.nodeName == 'A') {\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\t\t\t\tvar lastChild = node.lastChild;\n\t\n\t\t\t\twhile (lastChild) {\n\t\t\t\t\tif (lastChild.nodeName == 'A') {\n\t\t\t\t\t\treturn lastChild;\n\t\t\t\t\t}\n\t\t\t\t\tif (lastChild.nodeType == 3) {\n\t\t\t\t\t\tif (domUtils.isWhitespace(lastChild)) {\n\t\t\t\t\t\t\tlastChild = lastChild.previousSibling;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null\n\t\t\t\t\t}\n\t\t\t\t\tlastChild = lastChild.lastChild;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbrowser.ie && this.addListener('keyup', function(cmd, evt) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tkeyCode = evt.keyCode;\n\t\t\t\tif (keyCodes[keyCode]) {\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tvar start = rng.startContainer;\n\t\n\t\t\t\t\tif (keyCode == 13) {\n\t\t\t\t\t\twhile (start && !domUtils.isBody(start) && !domUtils.isBlockElm(start)) {\n\t\t\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (start && !domUtils.isBody(start) && start.nodeName == 'P') {\n\t\t\t\t\t\t\tvar pre = start.previousSibling;\n\t\t\t\t\t\t\tif (pre && pre.nodeType == 1) {\n\t\t\t\t\t\t\t\tvar pre = checkIsCludeLink(pre);\n\t\t\t\t\t\t\t\tif (pre && !pre.getAttribute('_href')) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pre, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (keyCode == 32) {\n\t\t\t\t\t\tif (start.nodeType == 3 && /^\\s$/.test(start.nodeValue)) {\n\t\t\t\t\t\t\tstart = start.previousSibling;\n\t\t\t\t\t\t\tif (start && start.nodeName == 'A' && !start.getAttribute('_href')) {\n\t\t\t\t\t\t\t\tdomUtils.remove(start, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(start, 'a', true);\n\t\t\t\t\t\tif (start && !start.getAttribute('_href')) {\n\t\t\t\t\t\t\tvar bk = rng.createBookmark();\n\t\n\t\t\t\t\t\t\tdomUtils.remove(start, true);\n\t\t\t\t\t\t\trng.moveToBookmark(bk).select(true)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t});\n\t\t});\n\t\n\t\t// plugins/autoheight.js\n\t\t///import core\n\t\t///commands 当输入内容超过编辑器高度时，编辑器自动增高\n\t\t///commandsName  AutoHeight,autoHeightEnabled\n\t\t///commandsTitle  自动增高\n\t\t/**\n\t\t * @description 自动伸展\n\t\t * @author zhanyi\n\t\t */\n\t\tUE.plugins['autoheight'] = function() {\n\t\t\tvar me = this;\n\t\t\t//提供开关，就算加载也可以关闭\n\t\t\tme.autoHeightEnabled = me.options.autoHeightEnabled !== false;\n\t\t\tif (!me.autoHeightEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tvar bakOverflow,\n\t\t\t\tlastHeight = 0,\n\t\t\t\toptions = me.options,\n\t\t\t\tcurrentHeight,\n\t\t\t\ttimer;\n\t\n\t\t\tfunction adjustHeight() {\n\t\t\t\tvar me = this;\n\t\t\t\tclearTimeout(timer);\n\t\t\t\tif (isFullscreen) return;\n\t\t\t\tif (!me.queryCommandState || me.queryCommandState && me.queryCommandState('source') != 1) {\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\n\t\t\t\t\t\tvar node = me.body.lastChild;\n\t\t\t\t\t\twhile (node && node.nodeType != 1) {\n\t\t\t\t\t\t\tnode = node.previousSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (node && node.nodeType == 1) {\n\t\t\t\t\t\t\tnode.style.clear = 'both';\n\t\t\t\t\t\t\tcurrentHeight = Math.max(domUtils.getXY(node).y + node.offsetHeight + 25, Math.max(options.minFrameHeight, options.initialFrameHeight));\n\t\t\t\t\t\t\tif (currentHeight != lastHeight) {\n\t\t\t\t\t\t\t\tif (currentHeight !== parseInt(me.iframe.parentNode.style.height)) {\n\t\t\t\t\t\t\t\t\tme.iframe.parentNode.style.height = currentHeight + 'px';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.body.style.height = currentHeight + 'px';\n\t\t\t\t\t\t\t\tlastHeight = currentHeight;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.removeStyle(node, 'clear');\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}, 50)\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar isFullscreen;\n\t\t\tme.addListener('fullscreenchanged', function(cmd, f) {\n\t\t\t\tisFullscreen = f\n\t\t\t});\n\t\t\tme.addListener('destroy', function() {\n\t\t\t\tme.removeListener('contentchange afterinserthtml keyup mouseup', adjustHeight)\n\t\t\t});\n\t\t\tme.enableAutoHeight = function() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!me.autoHeightEnabled) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar doc = me.document;\n\t\t\t\tme.autoHeightEnabled = true;\n\t\t\t\tbakOverflow = doc.body.style.overflowY;\n\t\t\t\tdoc.body.style.overflowY = 'hidden';\n\t\t\t\tme.addListener('contentchange afterinserthtml keyup mouseup', adjustHeight);\n\t\t\t\t//ff不给事件算得不对\n\t\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tadjustHeight.call(me);\n\t\t\t\t}, browser.gecko ? 100 : 0);\n\t\t\t\tme.fireEvent('autoheightchanged', me.autoHeightEnabled);\n\t\t\t};\n\t\t\tme.disableAutoHeight = function() {\n\t\n\t\t\t\tme.body.style.overflowY = bakOverflow || '';\n\t\n\t\t\t\tme.removeListener('contentchange', adjustHeight);\n\t\t\t\tme.removeListener('keyup', adjustHeight);\n\t\t\t\tme.removeListener('mouseup', adjustHeight);\n\t\t\t\tme.autoHeightEnabled = false;\n\t\t\t\tme.fireEvent('autoheightchanged', me.autoHeightEnabled);\n\t\t\t};\n\t\n\t\t\tme.on('setHeight', function() {\n\t\t\t\tme.disableAutoHeight()\n\t\t\t});\n\t\t\tme.addListener('ready', function() {\n\t\t\t\tme.enableAutoHeight();\n\t\t\t\t//trace:1764\n\t\t\t\tvar timer;\n\t\t\t\tdomUtils.on(browser.ie ? me.body : me.document, browser.webkit ? 'dragover' : 'drop', function() {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\t//trace:3681\n\t\t\t\t\t\tadjustHeight.call(me);\n\t\t\t\t\t}, 100);\n\t\n\t\t\t\t});\n\t\t\t\t//修复内容过多时，回到顶部，顶部内容被工具栏遮挡问题\n\t\t\t\tvar lastScrollY;\n\t\t\t\twindow.onscroll = function() {\n\t\t\t\t\tif (lastScrollY === null) {\n\t\t\t\t\t\tlastScrollY = this.scrollY\n\t\t\t\t\t} else if (this.scrollY == 0 && lastScrollY != 0) {\n\t\t\t\t\t\tme.window.scrollTo(0, 0);\n\t\t\t\t\t\tlastScrollY = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t};\n\t\n\t\t// plugins/autofloat.js\n\t\t///import core\n\t\t///commands 悬浮工具栏\n\t\t///commandsName  AutoFloat,autoFloatEnabled\n\t\t///commandsTitle  悬浮工具栏\n\t\t/**\n\t\t *  modified by chengchao01\n\t\t *  注意： 引入此功能后，在IE6下会将body的背景图片覆盖掉！\n\t\t */\n\t\tUE.plugins['autofloat'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tlang = me.getLang();\n\t\t\tme.setOpt({\n\t\t\t\ttopOffset: 0\n\t\t\t});\n\t\t\tvar optsAutoFloatEnabled = me.options.autoFloatEnabled !== false,\n\t\t\t\ttopOffset = me.options.topOffset;\n\t\n\t\t\t//如果不固定toolbar的位置，则直接退出\n\t\t\tif (!optsAutoFloatEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar uiUtils = UE.ui.uiUtils,\n\t\t\t\tLteIE6 = browser.ie && browser.version <= 6,\n\t\t\t\tquirks = browser.quirks;\n\t\n\t\t\tfunction checkHasUI() {\n\t\t\t\tif (!UE.ui) {\n\t\t\t\t\talert(lang.autofloatMsg);\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t}\n\t\n\t\t\tfunction fixIE6FixedPos() {\n\t\t\t\tvar docStyle = document.body.style;\n\t\t\t\tdocStyle.backgroundImage = 'url(\"about:blank\")';\n\t\t\t\tdocStyle.backgroundAttachment = 'fixed';\n\t\t\t}\n\t\t\tvar bakCssText,\n\t\t\t\tplaceHolder = document.createElement('div'),\n\t\t\t\ttoolbarBox, orgTop,\n\t\t\t\tgetPosition,\n\t\t\t\tflag = true; //ie7模式下需要偏移\n\t\t\tfunction setFloating() {\n\t\t\t\tvar toobarBoxPos = domUtils.getXY(toolbarBox),\n\t\t\t\t\torigalFloat = domUtils.getComputedStyle(toolbarBox, 'position'),\n\t\t\t\t\torigalLeft = domUtils.getComputedStyle(toolbarBox, 'left');\n\t\t\t\ttoolbarBox.style.width = toolbarBox.offsetWidth + 'px';\n\t\t\t\ttoolbarBox.style.zIndex = me.options.zIndex * 1 + 1;\n\t\t\t\ttoolbarBox.parentNode.insertBefore(placeHolder, toolbarBox);\n\t\t\t\tif (LteIE6 || (quirks && browser.ie)) {\n\t\t\t\t\tif (toolbarBox.style.position != 'absolute') {\n\t\t\t\t\t\ttoolbarBox.style.position = 'absolute';\n\t\t\t\t\t}\n\t\t\t\t\ttoolbarBox.style.top = (document.body.scrollTop || document.documentElement.scrollTop) - orgTop + topOffset + 'px';\n\t\t\t\t} else {\n\t\t\t\t\tif (browser.ie7Compat && flag) {\n\t\t\t\t\t\tflag = false;\n\t\t\t\t\t\ttoolbarBox.style.left = domUtils.getXY(toolbarBox).x - document.documentElement.getBoundingClientRect().left + 2 + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (toolbarBox.style.position != 'fixed') {\n\t\t\t\t\t\ttoolbarBox.style.position = 'fixed';\n\t\t\t\t\t\ttoolbarBox.style.top = topOffset + \"px\";\n\t\t\t\t\t\t((origalFloat == 'absolute' || origalFloat == 'relative') && parseFloat(origalLeft)) && (toolbarBox.style.left = toobarBoxPos.x + 'px');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction unsetFloating() {\n\t\t\t\tflag = true;\n\t\t\t\tif (placeHolder.parentNode) {\n\t\t\t\t\tplaceHolder.parentNode.removeChild(placeHolder);\n\t\t\t\t}\n\t\n\t\t\t\ttoolbarBox.style.cssText = bakCssText;\n\t\t\t}\n\t\n\t\t\tfunction updateFloating() {\n\t\t\t\tvar rect3 = getPosition(me.container);\n\t\t\t\tvar offset = me.options.toolbarTopOffset || 0;\n\t\t\t\tif (rect3.top < 0 && rect3.bottom - toolbarBox.offsetHeight > offset) {\n\t\t\t\t\tsetFloating();\n\t\t\t\t} else {\n\t\t\t\t\tunsetFloating();\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar defer_updateFloating = utils.defer(function() {\n\t\t\t\tupdateFloating();\n\t\t\t}, browser.ie ? 200 : 100, true);\n\t\n\t\t\tme.addListener('destroy', function() {\n\t\t\t\tdomUtils.un(window, ['scroll', 'resize'], updateFloating);\n\t\t\t\tme.removeListener('keydown', defer_updateFloating);\n\t\t\t});\n\t\n\t\t\tme.addListener('ready', function() {\n\t\t\t\tif (checkHasUI(me)) {\n\t\t\t\t\t//加载了ui组件，但在new时，没有加载ui，导致编辑器实例上没有ui类，所以这里做判断\n\t\t\t\t\tif (!me.ui) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tgetPosition = uiUtils.getClientRect;\n\t\t\t\t\ttoolbarBox = me.ui.getDom('toolbarbox');\n\t\t\t\t\torgTop = getPosition(toolbarBox).top;\n\t\t\t\t\tbakCssText = toolbarBox.style.cssText;\n\t\t\t\t\tplaceHolder.style.height = toolbarBox.offsetHeight + 'px';\n\t\t\t\t\tif (LteIE6) {\n\t\t\t\t\t\tfixIE6FixedPos();\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.on(window, ['scroll', 'resize'], updateFloating);\n\t\t\t\t\tme.addListener('keydown', defer_updateFloating);\n\t\n\t\t\t\t\tme.addListener('beforefullscreenchange', function(t, enabled) {\n\t\t\t\t\t\tif (enabled) {\n\t\t\t\t\t\t\tunsetFloating();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tme.addListener('fullscreenchanged', function(t, enabled) {\n\t\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tme.addListener('sourcemodechanged', function(t, enabled) {\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t\t}, 0);\n\t\t\t\t\t});\n\t\t\t\t\tme.addListener(\"clearDoc\", function() {\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t\t}, 0);\n\t\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/video.js\n\t\t/**\n\t\t * video插件， 为UEditor提供视频插入支持\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\tUE.plugins['video'] = function() {\n\t\t\tvar me = this;\n\t\n\t\t\t/**\n\t\t\t * 创建插入视频字符窜\n\t\t\t * @param url 视频地址\n\t\t\t * @param width 视频宽度\n\t\t\t * @param height 视频高度\n\t\t\t * @param align 视频对齐\n\t\t\t * @param toEmbed 是否以flash代替显示\n\t\t\t * @param addParagraph  是否需要添加P 标签\n\t\t\t */\n\t\t\tfunction creatInsertStr(url, width, height, id, align, classname, type) {\n\t\n\t\t\t\turl = utils.unhtmlForUrl(url);\n\t\t\t\talign = utils.unhtml(align);\n\t\t\t\tclassname = utils.unhtml(classname);\n\t\n\t\t\t\twidth = parseInt(width, 10) || 0;\n\t\t\t\theight = parseInt(height, 10) || 0;\n\t\n\t\t\t\tvar str;\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase 'image':\n\t\t\t\t\t\tstr = '<img ' + (id ? 'id=\"' + id + '\"' : '') + ' width=\"' + width + '\" height=\"' + height + '\" _url=\"' + url + '\" class=\"' + classname.replace(/\\bvideo-js\\b/, '') + '\"' +\n\t\t\t\t\t\t\t' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" style=\"background:url(' + me.options.UEDITOR_HOME_URL + 'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;' + (align ? 'float:' + align + ';' : '') + '\" />'\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'embed':\n\t\t\t\t\t\tstr = '<embed type=\"application/x-shockwave-flash\" class=\"' + classname + '\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"' +\n\t\t\t\t\t\t\t' src=\"' + utils.html(url) + '\" width=\"' + width + '\" height=\"' + height + '\"' + (align ? ' style=\"float:' + align + '\"' : '') +\n\t\t\t\t\t\t\t' wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" allowscriptaccess=\"never\" allowfullscreen=\"true\" >';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'video':\n\t\t\t\t\t\tvar ext = url.substr(url.lastIndexOf('.') + 1);\n\t\t\t\t\t\tif (ext == 'ogv') ext = 'ogg';\n\t\t\t\t\t\tstr = '<video' + (id ? ' id=\"' + id + '\"' : '') + ' class=\"' + classname + ' video-js\" ' + (align ? ' style=\"float:' + align + '\"' : '') +\n\t\t\t\t\t\t\t' controls preload=\"none\" width=\"' + width + '\" height=\"' + height + '\" src=\"' + url + '\" data-setup=\"{}\">' +\n\t\t\t\t\t\t\t'<source src=\"' + url + '\" type=\"video/' + ext + '\" /></video>';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn str;\n\t\t\t}\n\t\n\t\t\tfunction switchImgAndVideo(root, img2video) {\n\t\t\t\tutils.each(root.getNodesByTagName(img2video ? 'img' : 'embed video'), function(node) {\n\t\t\t\t\tvar className = node.getAttr('class');\n\t\t\t\t\tif (className && className.indexOf('edui-faked-video') != -1) {\n\t\t\t\t\t\tvar html = creatInsertStr(img2video ? node.getAttr('_url') : node.getAttr('src'), node.getAttr('width'), node.getAttr('height'), null, node.getStyle('float') || '', className, img2video ? 'embed' : 'image');\n\t\t\t\t\t\tnode.parentNode.replaceChild(UE.uNode.createElement(html), node);\n\t\t\t\t\t}\n\t\t\t\t\tif (className && className.indexOf('edui-upload-video') != -1) {\n\t\t\t\t\t\tvar html = creatInsertStr(img2video ? node.getAttr('_url') : node.getAttr('src'), node.getAttr('width'), node.getAttr('height'), null, node.getStyle('float') || '', className, img2video ? 'video' : 'image');\n\t\t\t\t\t\tnode.parentNode.replaceChild(UE.uNode.createElement(html), node);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\n\t\t\tme.addOutputRule(function(root) {\n\t\t\t\tswitchImgAndVideo(root, true)\n\t\t\t});\n\t\t\tme.addInputRule(function(root) {\n\t\t\t\tswitchImgAndVideo(root)\n\t\t\t});\n\t\n\t\t\t/**\n\t\t\t * 插入视频\n\t\t\t * @command insertvideo\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @param { Object } videoAttr 键值对对象， 描述一个视频的所有属性\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var videoAttr = {\n\t\t\t *      //视频地址\n\t\t\t *      url: 'http://www.youku.com/xxx',\n\t\t\t *      //视频宽高值， 单位px\n\t\t\t *      width: 200,\n\t\t\t *      height: 100\n\t\t\t * };\n\t\t\t *\n\t\t\t * //editor 是编辑器实例\n\t\t\t * //向编辑器插入单个视频\n\t\t\t * editor.execCommand( 'insertvideo', videoAttr );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 插入视频\n\t\t\t * @command insertvideo\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @param { Array } videoArr 需要插入的视频的数组， 其中的每一个元素都是一个键值对对象， 描述了一个视频的所有属性\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * var videoAttr1 = {\n\t\t\t *      //视频地址\n\t\t\t *      url: 'http://www.youku.com/xxx',\n\t\t\t *      //视频宽高值， 单位px\n\t\t\t *      width: 200,\n\t\t\t *      height: 100\n\t\t\t * },\n\t\t\t * videoAttr2 = {\n\t\t\t *      //视频地址\n\t\t\t *      url: 'http://www.youku.com/xxx',\n\t\t\t *      //视频宽高值， 单位px\n\t\t\t *      width: 200,\n\t\t\t *      height: 100\n\t\t\t * }\n\t\t\t *\n\t\t\t * //editor 是编辑器实例\n\t\t\t * //该方法将会向编辑器内插入两个视频\n\t\t\t * editor.execCommand( 'insertvideo', [ videoAttr1, videoAttr2 ] );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 查询当前光标所在处是否是一个视频\n\t\t\t * @command insertvideo\n\t\t\t * @method queryCommandState\n\t\t\t * @param { String } cmd 需要查询的命令字符串\n\t\t\t * @return { int } 如果当前光标所在处的元素是一个视频对象， 则返回1，否则返回0\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * //editor 是编辑器实例\n\t\t\t * editor.queryCommandState( 'insertvideo' );\n\t\t\t * ```\n\t\t\t */\n\t\t\tme.commands[\"insertvideo\"] = {\n\t\t\t\texecCommand: function(cmd, videoObjs, type) {\n\t\t\t\t\tvideoObjs = utils.isArray(videoObjs) ? videoObjs : [videoObjs];\n\t\t\t\t\tvar html = [],\n\t\t\t\t\t\tid = 'tmpVedio',\n\t\t\t\t\t\tcl;\n\t\t\t\t\tfor (var i = 0, vi, len = videoObjs.length; i < len; i++) {\n\t\t\t\t\t\tvi = videoObjs[i];\n\t\t\t\t\t\tcl = (type == 'upload' ? 'edui-upload-video video-js vjs-default-skin' : 'edui-faked-video');\n\t\t\t\t\t\thtml.push(creatInsertStr(vi.url, vi.width || 420, vi.height || 280, id + i, null, cl, 'image'));\n\t\t\t\t\t}\n\t\t\t\t\tme.execCommand(\"inserthtml\", html.join(\"\"), true);\n\t\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\t\tfor (var i = 0, len = videoObjs.length; i < len; i++) {\n\t\t\t\t\t\tvar img = this.document.getElementById('tmpVedio' + i);\n\t\t\t\t\t\tdomUtils.removeAttributes(img, 'id');\n\t\t\t\t\t\trng.selectNode(img).select();\n\t\t\t\t\t\tme.execCommand('imagefloat', videoObjs[i].align)\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar img = me.selection.getRange().getClosedNode(),\n\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1);\n\t\t\t\t\treturn flag ? 1 : 0;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/table.core.js\n\t\t/**\n\t\t * Created with JetBrains WebStorm.\n\t\t * User: taoqili\n\t\t * Date: 13-1-18\n\t\t * Time: 上午11:09\n\t\t * To change this template use File | Settings | File Templates.\n\t\t */\n\t\t/**\n\t\t * UE表格操作类\n\t\t * @param table\n\t\t * @constructor\n\t\t */\n\t\t(function() {\n\t\t\tvar UETable = UE.UETable = function(table) {\n\t\t\t\tthis.table = table;\n\t\t\t\tthis.indexTable = [];\n\t\t\t\tthis.selectedTds = [];\n\t\t\t\tthis.cellsRange = {};\n\t\t\t\tthis.update(table);\n\t\t\t};\n\t\n\t\t\t//===以下为静态工具方法===\n\t\t\tUETable.removeSelectedClass = function(cells) {\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tdomUtils.removeClasses(cell, \"selectTdClass\");\n\t\t\t\t})\n\t\t\t};\n\t\t\tUETable.addSelectedClass = function(cells) {\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tdomUtils.addClass(cell, \"selectTdClass\");\n\t\t\t\t})\n\t\t\t};\n\t\t\tUETable.isEmptyBlock = function(node) {\n\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(/^\\s*$/, '').replace(reg, '').length > 0) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tfor (var i in dtd.$isNotEmpty)\n\t\t\t\t\tif (dtd.$isNotEmpty.hasOwnProperty(i)) {\n\t\t\t\t\t\tif (node.getElementsByTagName(i).length) {\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t};\n\t\t\tUETable.getWidth = function(cell) {\n\t\t\t\tif (!cell) return 0;\n\t\t\t\treturn parseInt(domUtils.getComputedStyle(cell, \"width\"), 10);\n\t\t\t};\n\t\n\t\t\t/**\n\t\t\t * 获取单元格或者单元格组的“对齐”状态。 如果当前的检测对象是一个单元格组， 只有在满足所有单元格的 水平和竖直 对齐属性都相同的\n\t\t\t * 条件时才会返回其状态值，否则将返回null； 如果当前只检测了一个单元格， 则直接返回当前单元格的对齐状态；\n\t\t\t * @param table cell or table cells , 支持单个单元格dom对象 或者 单元格dom对象数组\n\t\t\t * @return { align: 'left' || 'right' || 'center', valign: 'top' || 'middle' || 'bottom' } 或者 null\n\t\t\t */\n\t\t\tUETable.getTableCellAlignState = function(cells) {\n\t\n\t\t\t\t!utils.isArray(cells) && (cells = [cells]);\n\t\n\t\t\t\tvar result = {},\n\t\t\t\t\tstatus = ['align', 'valign'],\n\t\t\t\t\ttempStatus = null,\n\t\t\t\t\tisSame = true; //状态是否相同\n\t\n\t\t\t\tutils.each(cells, function(cellNode) {\n\t\n\t\t\t\t\tutils.each(status, function(currentState) {\n\t\n\t\t\t\t\t\ttempStatus = cellNode.getAttribute(currentState);\n\t\n\t\t\t\t\t\tif (!result[currentState] && tempStatus) {\n\t\t\t\t\t\t\tresult[currentState] = tempStatus;\n\t\t\t\t\t\t} else if (!result[currentState] || (tempStatus !== result[currentState])) {\n\t\t\t\t\t\t\tisSame = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t});\n\t\n\t\t\t\t\treturn isSame;\n\t\n\t\t\t\t});\n\t\n\t\t\t\treturn isSame ? result : null;\n\t\n\t\t\t};\n\t\n\t\t\t/**\n\t\t\t * 根据当前选区获取相关的table信息\n\t\t\t * @return {Object}\n\t\t\t */\n\t\t\tUETable.getTableItemsByRange = function(editor) {\n\t\t\t\tvar start = editor.selection.getStart();\n\t\n\t\t\t\t//ff下会选中bookmark\n\t\t\t\tif (start && start.id && start.id.indexOf('_baidu_bookmark_start_') === 0 && start.nextSibling) {\n\t\t\t\t\tstart = start.nextSibling;\n\t\t\t\t}\n\t\n\t\t\t\t//在table或者td边缘有可能存在选中tr的情况\n\t\t\t\tvar cell = start && domUtils.findParentByTagName(start, [\"td\", \"th\"], true),\n\t\t\t\t\ttr = cell && cell.parentNode,\n\t\t\t\t\tcaption = start && domUtils.findParentByTagName(start, 'caption', true),\n\t\t\t\t\ttable = caption ? caption.parentNode : tr && tr.parentNode.parentNode;\n\t\n\t\t\t\treturn {\n\t\t\t\t\tcell: cell,\n\t\t\t\t\ttr: tr,\n\t\t\t\t\ttable: table,\n\t\t\t\t\tcaption: caption\n\t\t\t\t}\n\t\t\t};\n\t\t\tUETable.getUETableBySelected = function(editor) {\n\t\t\t\tvar table = UETable.getTableItemsByRange(editor).table;\n\t\t\t\tif (table && table.ueTable && table.ueTable.selectedTds.length) {\n\t\t\t\t\treturn table.ueTable;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\t\n\t\t\tUETable.getDefaultValue = function(editor, table) {\n\t\t\t\tvar borderMap = {\n\t\t\t\t\t\tthin: '0px',\n\t\t\t\t\t\tmedium: '1px',\n\t\t\t\t\t\tthick: '2px'\n\t\t\t\t\t},\n\t\t\t\t\ttableBorder, tdPadding, tdBorder, tmpValue;\n\t\t\t\tif (!table) {\n\t\t\t\t\ttable = editor.document.createElement('table');\n\t\t\t\t\ttable.insertRow(0).insertCell(0).innerHTML = 'xxx';\n\t\t\t\t\teditor.body.appendChild(table);\n\t\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\t\ttmpValue = domUtils.getComputedStyle(table, 'border-left-width');\n\t\t\t\t\ttableBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'padding-left');\n\t\t\t\t\ttdPadding = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'border-left-width');\n\t\t\t\t\ttdBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttableBorder: tableBorder,\n\t\t\t\t\t\ttdPadding: tdPadding,\n\t\t\t\t\t\ttdBorder: tdBorder\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\ttd = table.getElementsByTagName('td')[0];\n\t\t\t\t\ttmpValue = domUtils.getComputedStyle(table, 'border-left-width');\n\t\t\t\t\ttableBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'padding-left');\n\t\t\t\t\ttdPadding = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'border-left-width');\n\t\t\t\t\ttdBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\t\treturn {\n\t\t\t\t\t\ttableBorder: tableBorder,\n\t\t\t\t\t\ttdPadding: tdPadding,\n\t\t\t\t\t\ttdBorder: tdBorder\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\t\t\t/**\n\t\t\t * 根据当前点击的td或者table获取索引对象\n\t\t\t * @param tdOrTable\n\t\t\t */\n\t\t\tUETable.getUETable = function(tdOrTable) {\n\t\t\t\tvar tag = tdOrTable.tagName.toLowerCase();\n\t\t\t\ttdOrTable = (tag == \"td\" || tag == \"th\" || tag == 'caption') ? domUtils.findParentByTagName(tdOrTable, \"table\", true) : tdOrTable;\n\t\t\t\tif (!tdOrTable.ueTable) {\n\t\t\t\t\ttdOrTable.ueTable = new UETable(tdOrTable);\n\t\t\t\t}\n\t\t\t\treturn tdOrTable.ueTable;\n\t\t\t};\n\t\n\t\t\tUETable.cloneCell = function(cell, ignoreMerge, keepPro) {\n\t\t\t\tif (!cell || utils.isString(cell)) {\n\t\t\t\t\treturn this.table.ownerDocument.createElement(cell || 'td');\n\t\t\t\t}\n\t\t\t\tvar flag = domUtils.hasClass(cell, \"selectTdClass\");\n\t\t\t\tflag && domUtils.removeClasses(cell, \"selectTdClass\");\n\t\t\t\tvar tmpCell = cell.cloneNode(true);\n\t\t\t\tif (ignoreMerge) {\n\t\t\t\t\ttmpCell.rowSpan = tmpCell.colSpan = 1;\n\t\t\t\t}\n\t\t\t\t//去掉宽高\n\t\t\t\t!keepPro && domUtils.removeAttributes(tmpCell, 'width height');\n\t\t\t\t!keepPro && domUtils.removeAttributes(tmpCell, 'style');\n\t\n\t\t\t\ttmpCell.style.borderLeftStyle = \"\";\n\t\t\t\ttmpCell.style.borderTopStyle = \"\";\n\t\t\t\ttmpCell.style.borderLeftColor = cell.style.borderRightColor;\n\t\t\t\ttmpCell.style.borderLeftWidth = cell.style.borderRightWidth;\n\t\t\t\ttmpCell.style.borderTopColor = cell.style.borderBottomColor;\n\t\t\t\ttmpCell.style.borderTopWidth = cell.style.borderBottomWidth;\n\t\t\t\tflag && domUtils.addClass(cell, \"selectTdClass\");\n\t\t\t\treturn tmpCell;\n\t\t\t}\n\t\n\t\t\tUETable.prototype = {\n\t\t\t\tgetMaxRows: function() {\n\t\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\t\tmaxLen = 1;\n\t\t\t\t\tfor (var i = 0, row; row = rows[i]; i++) {\n\t\t\t\t\t\tvar currentMax = 1;\n\t\t\t\t\t\tfor (var j = 0, cj; cj = row.cells[j++];) {\n\t\t\t\t\t\t\tcurrentMax = Math.max(cj.rowSpan || 1, currentMax);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmaxLen = Math.max(currentMax + i, maxLen);\n\t\t\t\t\t}\n\t\t\t\t\treturn maxLen;\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 获取当前表格的最大列数\n\t\t\t\t */\n\t\t\t\tgetMaxCols: function() {\n\t\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\t\tmaxLen = 0,\n\t\t\t\t\t\tcellRows = {};\n\t\t\t\t\tfor (var i = 0, row; row = rows[i]; i++) {\n\t\t\t\t\t\tvar cellsNum = 0;\n\t\t\t\t\t\tfor (var j = 0, cj; cj = row.cells[j++];) {\n\t\t\t\t\t\t\tcellsNum += (cj.colSpan || 1);\n\t\t\t\t\t\t\tif (cj.rowSpan && cj.rowSpan > 1) {\n\t\t\t\t\t\t\t\tfor (var k = 1; k < cj.rowSpan; k++) {\n\t\t\t\t\t\t\t\t\tif (!cellRows['row_' + (i + k)]) {\n\t\t\t\t\t\t\t\t\t\tcellRows['row_' + (i + k)] = (cj.colSpan || 1);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcellRows['row_' + (i + k)]++\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcellsNum += cellRows['row_' + i] || 0;\n\t\t\t\t\t\tmaxLen = Math.max(cellsNum, maxLen);\n\t\t\t\t\t}\n\t\t\t\t\treturn maxLen;\n\t\t\t\t},\n\t\t\t\tgetCellColIndex: function(cell) {\n\t\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 获取当前cell旁边的单元格，\n\t\t\t\t * @param cell\n\t\t\t\t * @param right\n\t\t\t\t */\n\t\t\t\tgetHSideCell: function(cell, right) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\t\tpreviewRowIndex, previewColIndex;\n\t\t\t\t\t\tvar len = this.selectedTds.length,\n\t\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t\t//首行或者首列没有前置单元格\n\t\t\t\t\t\tif ((!right && (!len ? !cellInfo.colIndex : !range.beginColIndex)) || (right && (!len ? (cellInfo.colIndex == (this.colsNum - 1)) : (range.endColIndex == this.colsNum - 1)))) return null;\n\t\n\t\t\t\t\t\tpreviewRowIndex = !len ? cellInfo.rowIndex : range.beginRowIndex;\n\t\t\t\t\t\tpreviewColIndex = !right ? (!len ? (cellInfo.colIndex < 1 ? 0 : (cellInfo.colIndex - 1)) : range.beginColIndex - 1) : (!len ? cellInfo.colIndex + 1 : range.endColIndex + 1);\n\t\t\t\t\t\treturn this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex, this.indexTable[previewRowIndex][previewColIndex].cellIndex);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowError(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetTabNextCell: function(cell, preRowIndex) {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\trowIndex = preRowIndex || cellInfo.rowIndex,\n\t\t\t\t\t\tcolIndex = cellInfo.colIndex + 1 + (cellInfo.colSpan - 1),\n\t\t\t\t\t\tnextCell;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tnextCell = this.getCell(this.indexTable[rowIndex][colIndex].rowIndex, this.indexTable[rowIndex][colIndex].cellIndex);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\trowIndex = rowIndex * 1 + 1;\n\t\t\t\t\t\t\tcolIndex = 0;\n\t\t\t\t\t\t\tnextCell = this.getCell(this.indexTable[rowIndex][colIndex].rowIndex, this.indexTable[rowIndex][colIndex].cellIndex);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\t\t\t\t\treturn nextCell;\n\t\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 获取视觉上的后置单元格\n\t\t\t\t * @param cell\n\t\t\t\t * @param bottom\n\t\t\t\t */\n\t\t\t\tgetVSideCell: function(cell, bottom, ignoreRange) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\t\tnextRowIndex, nextColIndex;\n\t\t\t\t\t\tvar len = this.selectedTds.length && !ignoreRange,\n\t\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t\t//末行或者末列没有后置单元格\n\t\t\t\t\t\tif ((!bottom && (cellInfo.rowIndex == 0)) || (bottom && (!len ? (cellInfo.rowIndex + cellInfo.rowSpan > this.rowsNum - 1) : (range.endRowIndex == this.rowsNum - 1)))) return null;\n\t\n\t\t\t\t\t\tnextRowIndex = !bottom ? (!len ? cellInfo.rowIndex - 1 : range.beginRowIndex - 1) : (!len ? (cellInfo.rowIndex + cellInfo.rowSpan) : range.endRowIndex + 1);\n\t\t\t\t\t\tnextColIndex = !len ? cellInfo.colIndex : range.beginColIndex;\n\t\t\t\t\t\treturn this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex, this.indexTable[nextRowIndex][nextColIndex].cellIndex);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowError(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 获取相同结束位置的单元格，xOrY指代了是获取x轴相同还是y轴相同\n\t\t\t\t */\n\t\t\t\tgetSameEndPosCells: function(cell, xOrY) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar flag = (xOrY.toLowerCase() === \"x\"),\n\t\t\t\t\t\t\tend = domUtils.getXY(cell)[flag ? 'x' : 'y'] + cell[\"offset\" + (flag ? 'Width' : 'Height')],\n\t\t\t\t\t\t\trows = this.table.rows,\n\t\t\t\t\t\t\tcells = null,\n\t\t\t\t\t\t\treturns = [];\n\t\t\t\t\t\tfor (var i = 0; i < this.rowsNum; i++) {\n\t\t\t\t\t\t\tcells = rows[i].cells;\n\t\t\t\t\t\t\tfor (var j = 0, tmpCell; tmpCell = cells[j++];) {\n\t\t\t\t\t\t\t\tvar tmpEnd = domUtils.getXY(tmpCell)[flag ? 'x' : 'y'] + tmpCell[\"offset\" + (flag ? 'Width' : 'Height')];\n\t\t\t\t\t\t\t\t//对应行的td已经被上面行rowSpan了\n\t\t\t\t\t\t\t\tif (tmpEnd > end && flag) break;\n\t\t\t\t\t\t\t\tif (cell == tmpCell || end == tmpEnd) {\n\t\t\t\t\t\t\t\t\t//只获取单一的单元格\n\t\t\t\t\t\t\t\t\t//todo 仅获取单一单元格在特定情况下会造成returns为空，从而影响后续的拖拽实现，修正这个。需考虑性能\n\t\t\t\t\t\t\t\t\tif (tmpCell[flag ? \"colSpan\" : \"rowSpan\"] == 1) {\n\t\t\t\t\t\t\t\t\t\treturns.push(tmpCell);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (flag) break;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn returns;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowError(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetCellContent: function(cell, content) {\n\t\t\t\t\tcell.innerHTML = content || (browser.ie ? domUtils.fillChar : \"<br />\");\n\t\t\t\t},\n\t\t\t\tcloneCell: UETable.cloneCell,\n\t\t\t\t/**\n\t\t\t\t * 获取跟当前单元格的右边竖线为左边的所有未合并单元格\n\t\t\t\t */\n\t\t\t\tgetSameStartPosXCells: function(cell) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar start = domUtils.getXY(cell).x + cell.offsetWidth,\n\t\t\t\t\t\t\trows = this.table.rows,\n\t\t\t\t\t\t\tcells, returns = [];\n\t\t\t\t\t\tfor (var i = 0; i < this.rowsNum; i++) {\n\t\t\t\t\t\t\tcells = rows[i].cells;\n\t\t\t\t\t\t\tfor (var j = 0, tmpCell; tmpCell = cells[j++];) {\n\t\t\t\t\t\t\t\tvar tmpStart = domUtils.getXY(tmpCell).x;\n\t\t\t\t\t\t\t\tif (tmpStart > start) break;\n\t\t\t\t\t\t\t\tif (tmpStart == start && tmpCell.colSpan == 1) {\n\t\t\t\t\t\t\t\t\treturns.push(tmpCell);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn returns;\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowError(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 更新table对应的索引表\n\t\t\t\t */\n\t\t\t\tupdate: function(table) {\n\t\t\t\t\tthis.table = table || this.table;\n\t\t\t\t\tthis.selectedTds = [];\n\t\t\t\t\tthis.cellsRange = {};\n\t\t\t\t\tthis.indexTable = [];\n\t\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\t\trowsNum = this.getMaxRows(),\n\t\t\t\t\t\tdNum = rowsNum - rows.length,\n\t\t\t\t\t\tcolsNum = this.getMaxCols();\n\t\t\t\t\twhile (dNum--) {\n\t\t\t\t\t\tthis.table.insertRow(rows.length);\n\t\t\t\t\t}\n\t\t\t\t\tthis.rowsNum = rowsNum;\n\t\t\t\t\tthis.colsNum = colsNum;\n\t\t\t\t\tfor (var i = 0, len = rows.length; i < len; i++) {\n\t\t\t\t\t\tthis.indexTable[i] = new Array(colsNum);\n\t\t\t\t\t}\n\t\t\t\t\t//填充索引表\n\t\t\t\t\tfor (var rowIndex = 0, row; row = rows[rowIndex]; rowIndex++) {\n\t\t\t\t\t\tfor (var cellIndex = 0, cell, cells = row.cells; cell = cells[cellIndex]; cellIndex++) {\n\t\t\t\t\t\t\t//修正整行被rowSpan时导致的行数计算错误\n\t\t\t\t\t\t\tif (cell.rowSpan > rowsNum) {\n\t\t\t\t\t\t\t\tcell.rowSpan = rowsNum;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar colIndex = cellIndex,\n\t\t\t\t\t\t\t\trowSpan = cell.rowSpan || 1,\n\t\t\t\t\t\t\t\tcolSpan = cell.colSpan || 1;\n\t\t\t\t\t\t\t//当已经被上一行rowSpan或者被前一列colSpan了，则跳到下一个单元格进行\n\t\t\t\t\t\t\twhile (this.indexTable[rowIndex][colIndex]) colIndex++;\n\t\t\t\t\t\t\tfor (var j = 0; j < rowSpan; j++) {\n\t\t\t\t\t\t\t\tfor (var k = 0; k < colSpan; k++) {\n\t\t\t\t\t\t\t\t\tthis.indexTable[rowIndex + j][colIndex + k] = {\n\t\t\t\t\t\t\t\t\t\trowIndex: rowIndex,\n\t\t\t\t\t\t\t\t\t\tcellIndex: cellIndex,\n\t\t\t\t\t\t\t\t\t\tcolIndex: colIndex,\n\t\t\t\t\t\t\t\t\t\trowSpan: rowSpan,\n\t\t\t\t\t\t\t\t\t\tcolSpan: colSpan\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//修复残缺td\n\t\t\t\t\tfor (j = 0; j < rowsNum; j++) {\n\t\t\t\t\t\tfor (k = 0; k < colsNum; k++) {\n\t\t\t\t\t\t\tif (this.indexTable[j][k] === undefined) {\n\t\t\t\t\t\t\t\trow = rows[j];\n\t\t\t\t\t\t\t\tcell = row.cells[row.cells.length - 1];\n\t\t\t\t\t\t\t\tcell = cell ? cell.cloneNode(true) : this.table.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\t\tif (cell.colSpan !== 1) cell.colSpan = 1;\n\t\t\t\t\t\t\t\tif (cell.rowSpan !== 1) cell.rowSpan = 1;\n\t\t\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\t\t\tthis.indexTable[j][k] = {\n\t\t\t\t\t\t\t\t\trowIndex: j,\n\t\t\t\t\t\t\t\t\tcellIndex: cell.cellIndex,\n\t\t\t\t\t\t\t\t\tcolIndex: k,\n\t\t\t\t\t\t\t\t\trowSpan: 1,\n\t\t\t\t\t\t\t\t\tcolSpan: 1\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//当框选后删除行或者列后撤销，需要重建选区。\n\t\t\t\t\tvar tds = domUtils.getElementsByTagName(this.table, \"td\"),\n\t\t\t\t\t\tselectTds = [];\n\t\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t\tif (domUtils.hasClass(td, \"selectTdClass\")) {\n\t\t\t\t\t\t\tselectTds.push(td);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (selectTds.length) {\n\t\t\t\t\t\tvar start = selectTds[0],\n\t\t\t\t\t\t\tend = selectTds[selectTds.length - 1],\n\t\t\t\t\t\t\tstartInfo = this.getCellInfo(start),\n\t\t\t\t\t\t\tendInfo = this.getCellInfo(end);\n\t\t\t\t\t\tthis.selectedTds = selectTds;\n\t\t\t\t\t\tthis.cellsRange = {\n\t\t\t\t\t\t\tbeginRowIndex: startInfo.rowIndex,\n\t\t\t\t\t\t\tbeginColIndex: startInfo.colIndex,\n\t\t\t\t\t\t\tendRowIndex: endInfo.rowIndex + endInfo.rowSpan - 1,\n\t\t\t\t\t\t\tendColIndex: endInfo.colIndex + endInfo.colSpan - 1\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\t//给第一行设置firstRow的样式名称,在排序图标的样式上使用到\n\t\t\t\t\tif (!domUtils.hasClass(this.table.rows[0], \"firstRow\")) {\n\t\t\t\t\t\tdomUtils.addClass(this.table.rows[0], \"firstRow\");\n\t\t\t\t\t\tfor (var i = 1; i < this.table.rows.length; i++) {\n\t\t\t\t\t\t\tdomUtils.removeClasses(this.table.rows[i], \"firstRow\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 获取单元格的索引信息\n\t\t\t\t */\n\t\t\t\tgetCellInfo: function(cell) {\n\t\t\t\t\tif (!cell) return;\n\t\t\t\t\tvar cellIndex = cell.cellIndex,\n\t\t\t\t\t\trowIndex = cell.parentNode.rowIndex,\n\t\t\t\t\t\trowInfo = this.indexTable[rowIndex],\n\t\t\t\t\t\tnumCols = this.colsNum;\n\t\t\t\t\tfor (var colIndex = cellIndex; colIndex < numCols; colIndex++) {\n\t\t\t\t\t\tvar cellInfo = rowInfo[colIndex];\n\t\t\t\t\t\tif (cellInfo.rowIndex === rowIndex && cellInfo.cellIndex === cellIndex) {\n\t\t\t\t\t\t\treturn cellInfo;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 根据行列号获取单元格\n\t\t\t\t */\n\t\t\t\tgetCell: function(rowIndex, cellIndex) {\n\t\t\t\t\treturn rowIndex < this.rowsNum && this.table.rows[rowIndex].cells[cellIndex] || null;\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 删除单元格\n\t\t\t\t */\n\t\t\t\tdeleteCell: function(cell, rowIndex) {\n\t\t\t\t\trowIndex = typeof rowIndex == 'number' ? rowIndex : cell.parentNode.rowIndex;\n\t\t\t\t\tvar row = this.table.rows[rowIndex];\n\t\t\t\t\trow.deleteCell(cell.cellIndex);\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 根据始末两个单元格获取被框选的所有单元格范围\n\t\t\t\t */\n\t\t\t\tgetCellsRange: function(cellA, cellB) {\n\t\t\t\t\tfunction checkRange(beginRowIndex, beginColIndex, endRowIndex, endColIndex) {\n\t\t\t\t\t\tvar tmpBeginRowIndex = beginRowIndex,\n\t\t\t\t\t\t\ttmpBeginColIndex = beginColIndex,\n\t\t\t\t\t\t\ttmpEndRowIndex = endRowIndex,\n\t\t\t\t\t\t\ttmpEndColIndex = endColIndex,\n\t\t\t\t\t\t\tcellInfo, colIndex, rowIndex;\n\t\t\t\t\t\t// 通过indexTable检查是否存在超出TableRange上边界的情况\n\t\t\t\t\t\tif (beginRowIndex > 0) {\n\t\t\t\t\t\t\tfor (colIndex = beginColIndex; colIndex < endColIndex; colIndex++) {\n\t\t\t\t\t\t\t\tcellInfo = me.indexTable[beginRowIndex][colIndex];\n\t\t\t\t\t\t\t\trowIndex = cellInfo.rowIndex;\n\t\t\t\t\t\t\t\tif (rowIndex < beginRowIndex) {\n\t\t\t\t\t\t\t\t\ttmpBeginRowIndex = Math.min(rowIndex, tmpBeginRowIndex);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 通过indexTable检查是否存在超出TableRange右边界的情况\n\t\t\t\t\t\tif (endColIndex < me.colsNum) {\n\t\t\t\t\t\t\tfor (rowIndex = beginRowIndex; rowIndex < endRowIndex; rowIndex++) {\n\t\t\t\t\t\t\t\tcellInfo = me.indexTable[rowIndex][endColIndex];\n\t\t\t\t\t\t\t\tcolIndex = cellInfo.colIndex + cellInfo.colSpan - 1;\n\t\t\t\t\t\t\t\tif (colIndex > endColIndex) {\n\t\t\t\t\t\t\t\t\ttmpEndColIndex = Math.max(colIndex, tmpEndColIndex);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 检查是否有超出TableRange下边界的情况\n\t\t\t\t\t\tif (endRowIndex < me.rowsNum) {\n\t\t\t\t\t\t\tfor (colIndex = beginColIndex; colIndex < endColIndex; colIndex++) {\n\t\t\t\t\t\t\t\tcellInfo = me.indexTable[endRowIndex][colIndex];\n\t\t\t\t\t\t\t\trowIndex = cellInfo.rowIndex + cellInfo.rowSpan - 1;\n\t\t\t\t\t\t\t\tif (rowIndex > endRowIndex) {\n\t\t\t\t\t\t\t\t\ttmpEndRowIndex = Math.max(rowIndex, tmpEndRowIndex);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 检查是否有超出TableRange左边界的情况\n\t\t\t\t\t\tif (beginColIndex > 0) {\n\t\t\t\t\t\t\tfor (rowIndex = beginRowIndex; rowIndex < endRowIndex; rowIndex++) {\n\t\t\t\t\t\t\t\tcellInfo = me.indexTable[rowIndex][beginColIndex];\n\t\t\t\t\t\t\t\tcolIndex = cellInfo.colIndex;\n\t\t\t\t\t\t\t\tif (colIndex < beginColIndex) {\n\t\t\t\t\t\t\t\t\ttmpBeginColIndex = Math.min(cellInfo.colIndex, tmpBeginColIndex);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//递归调用直至所有完成所有框选单元格的扩展\n\t\t\t\t\t\tif (tmpBeginRowIndex != beginRowIndex || tmpBeginColIndex != beginColIndex || tmpEndRowIndex != endRowIndex || tmpEndColIndex != endColIndex) {\n\t\t\t\t\t\t\treturn checkRange(tmpBeginRowIndex, tmpBeginColIndex, tmpEndRowIndex, tmpEndColIndex);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 不需要扩展TableRange的情况\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tbeginRowIndex: beginRowIndex,\n\t\t\t\t\t\t\t\tbeginColIndex: beginColIndex,\n\t\t\t\t\t\t\t\tendRowIndex: endRowIndex,\n\t\t\t\t\t\t\t\tendColIndex: endColIndex\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tcellAInfo = me.getCellInfo(cellA);\n\t\t\t\t\t\tif (cellA === cellB) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tbeginRowIndex: cellAInfo.rowIndex,\n\t\t\t\t\t\t\t\tbeginColIndex: cellAInfo.colIndex,\n\t\t\t\t\t\t\t\tendRowIndex: cellAInfo.rowIndex + cellAInfo.rowSpan - 1,\n\t\t\t\t\t\t\t\tendColIndex: cellAInfo.colIndex + cellAInfo.colSpan - 1\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar cellBInfo = me.getCellInfo(cellB);\n\t\t\t\t\t\t// 计算TableRange的四个边\n\t\t\t\t\t\tvar beginRowIndex = Math.min(cellAInfo.rowIndex, cellBInfo.rowIndex),\n\t\t\t\t\t\t\tbeginColIndex = Math.min(cellAInfo.colIndex, cellBInfo.colIndex),\n\t\t\t\t\t\t\tendRowIndex = Math.max(cellAInfo.rowIndex + cellAInfo.rowSpan - 1, cellBInfo.rowIndex + cellBInfo.rowSpan - 1),\n\t\t\t\t\t\t\tendColIndex = Math.max(cellAInfo.colIndex + cellAInfo.colSpan - 1, cellBInfo.colIndex + cellBInfo.colSpan - 1);\n\t\n\t\t\t\t\t\treturn checkRange(beginRowIndex, beginColIndex, endRowIndex, endColIndex);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t//throw e;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 依据cellsRange获取对应的单元格集合\n\t\t\t\t */\n\t\t\t\tgetCells: function(range) {\n\t\t\t\t\t//每次获取cells之前必须先清除上次的选择，否则会对后续获取操作造成影响\n\t\t\t\t\tthis.clearSelected();\n\t\t\t\t\tvar beginRowIndex = range.beginRowIndex,\n\t\t\t\t\t\tbeginColIndex = range.beginColIndex,\n\t\t\t\t\t\tendRowIndex = range.endRowIndex,\n\t\t\t\t\t\tendColIndex = range.endColIndex,\n\t\t\t\t\t\tcellInfo, rowIndex, colIndex, tdHash = {},\n\t\t\t\t\t\treturnTds = [];\n\t\t\t\t\tfor (var i = beginRowIndex; i <= endRowIndex; i++) {\n\t\t\t\t\t\tfor (var j = beginColIndex; j <= endColIndex; j++) {\n\t\t\t\t\t\t\tcellInfo = this.indexTable[i][j];\n\t\t\t\t\t\t\trowIndex = cellInfo.rowIndex;\n\t\t\t\t\t\t\tcolIndex = cellInfo.colIndex;\n\t\t\t\t\t\t\t// 如果Cells里已经包含了此Cell则跳过\n\t\t\t\t\t\t\tvar key = rowIndex + '|' + colIndex;\n\t\t\t\t\t\t\tif (tdHash[key]) continue;\n\t\t\t\t\t\t\ttdHash[key] = 1;\n\t\t\t\t\t\t\tif (rowIndex < i || colIndex < j || rowIndex + cellInfo.rowSpan - 1 > endRowIndex || colIndex + cellInfo.colSpan - 1 > endColIndex) {\n\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturnTds.push(this.getCell(rowIndex, cellInfo.cellIndex));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn returnTds;\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 清理已经选中的单元格\n\t\t\t\t */\n\t\t\t\tclearSelected: function() {\n\t\t\t\t\tUETable.removeSelectedClass(this.selectedTds);\n\t\t\t\t\tthis.selectedTds = [];\n\t\t\t\t\tthis.cellsRange = {};\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 根据range设置已经选中的单元格\n\t\t\t\t */\n\t\t\t\tsetSelected: function(range) {\n\t\t\t\t\tvar cells = this.getCells(range);\n\t\t\t\t\tUETable.addSelectedClass(cells);\n\t\t\t\t\tthis.selectedTds = cells;\n\t\t\t\t\tthis.cellsRange = range;\n\t\t\t\t},\n\t\t\t\tisFullRow: function() {\n\t\t\t\t\tvar range = this.cellsRange;\n\t\t\t\t\treturn (range.endColIndex - range.beginColIndex + 1) == this.colsNum;\n\t\t\t\t},\n\t\t\t\tisFullCol: function() {\n\t\t\t\t\tvar range = this.cellsRange,\n\t\t\t\t\t\ttable = this.table,\n\t\t\t\t\t\tths = table.getElementsByTagName(\"th\"),\n\t\t\t\t\t\trows = range.endRowIndex - range.beginRowIndex + 1;\n\t\t\t\t\treturn !ths.length ? rows == this.rowsNum : rows == this.rowsNum || (rows == this.rowsNum - 1);\n\t\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 获取视觉上的前置单元格，默认是左边，top传入时\n\t\t\t\t * @param cell\n\t\t\t\t * @param top\n\t\t\t\t */\n\t\t\t\tgetNextCell: function(cell, bottom, ignoreRange) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\t\tnextRowIndex, nextColIndex;\n\t\t\t\t\t\tvar len = this.selectedTds.length && !ignoreRange,\n\t\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t\t//末行或者末列没有后置单元格\n\t\t\t\t\t\tif ((!bottom && (cellInfo.rowIndex == 0)) || (bottom && (!len ? (cellInfo.rowIndex + cellInfo.rowSpan > this.rowsNum - 1) : (range.endRowIndex == this.rowsNum - 1)))) return null;\n\t\n\t\t\t\t\t\tnextRowIndex = !bottom ? (!len ? cellInfo.rowIndex - 1 : range.beginRowIndex - 1) : (!len ? (cellInfo.rowIndex + cellInfo.rowSpan) : range.endRowIndex + 1);\n\t\t\t\t\t\tnextColIndex = !len ? cellInfo.colIndex : range.beginColIndex;\n\t\t\t\t\t\treturn this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex, this.indexTable[nextRowIndex][nextColIndex].cellIndex);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowError(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetPreviewCell: function(cell, top) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\t\tpreviewRowIndex, previewColIndex;\n\t\t\t\t\t\tvar len = this.selectedTds.length,\n\t\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t\t//首行或者首列没有前置单元格\n\t\t\t\t\t\tif ((!top && (!len ? !cellInfo.colIndex : !range.beginColIndex)) || (top && (!len ? (cellInfo.rowIndex > (this.colsNum - 1)) : (range.endColIndex == this.colsNum - 1)))) return null;\n\t\n\t\t\t\t\t\tpreviewRowIndex = !top ? (!len ? cellInfo.rowIndex : range.beginRowIndex) : (!len ? (cellInfo.rowIndex < 1 ? 0 : (cellInfo.rowIndex - 1)) : range.beginRowIndex);\n\t\t\t\t\t\tpreviewColIndex = !top ? (!len ? (cellInfo.colIndex < 1 ? 0 : (cellInfo.colIndex - 1)) : range.beginColIndex - 1) : (!len ? cellInfo.colIndex : range.endColIndex + 1);\n\t\t\t\t\t\treturn this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex, this.indexTable[previewRowIndex][previewColIndex].cellIndex);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tshowError(e);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 移动单元格中的内容\n\t\t\t\t */\n\t\t\t\tmoveContent: function(cellTo, cellFrom) {\n\t\t\t\t\tif (UETable.isEmptyBlock(cellFrom)) return;\n\t\t\t\t\tif (UETable.isEmptyBlock(cellTo)) {\n\t\t\t\t\t\tcellTo.innerHTML = cellFrom.innerHTML;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar child = cellTo.lastChild;\n\t\t\t\t\tif (child.nodeType == 3 || !dtd.$block[child.tagName]) {\n\t\t\t\t\t\tcellTo.appendChild(cellTo.ownerDocument.createElement('br'))\n\t\t\t\t\t}\n\t\t\t\t\twhile (child = cellFrom.firstChild) {\n\t\t\t\t\t\tcellTo.appendChild(child);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 向右合并单元格\n\t\t\t\t */\n\t\t\t\tmergeRight: function(cell) {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\trightColIndex = cellInfo.colIndex + cellInfo.colSpan,\n\t\t\t\t\t\trightCellInfo = this.indexTable[cellInfo.rowIndex][rightColIndex],\n\t\t\t\t\t\trightCell = this.getCell(rightCellInfo.rowIndex, rightCellInfo.cellIndex);\n\t\t\t\t\t//合并\n\t\t\t\t\tcell.colSpan = cellInfo.colSpan + rightCellInfo.colSpan;\n\t\t\t\t\t//被合并的单元格不应存在宽度属性\n\t\t\t\t\tcell.removeAttribute(\"width\");\n\t\t\t\t\t//移动内容\n\t\t\t\t\tthis.moveContent(cell, rightCell);\n\t\t\t\t\t//删掉被合并的Cell\n\t\t\t\t\tthis.deleteCell(rightCell, rightCellInfo.rowIndex);\n\t\t\t\t\tthis.update();\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 向下合并单元格\n\t\t\t\t */\n\t\t\t\tmergeDown: function(cell) {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tdownRowIndex = cellInfo.rowIndex + cellInfo.rowSpan,\n\t\t\t\t\t\tdownCellInfo = this.indexTable[downRowIndex][cellInfo.colIndex],\n\t\t\t\t\t\tdownCell = this.getCell(downCellInfo.rowIndex, downCellInfo.cellIndex);\n\t\t\t\t\tcell.rowSpan = cellInfo.rowSpan + downCellInfo.rowSpan;\n\t\t\t\t\tcell.removeAttribute(\"height\");\n\t\t\t\t\tthis.moveContent(cell, downCell);\n\t\t\t\t\tthis.deleteCell(downCell, downCellInfo.rowIndex);\n\t\t\t\t\tthis.update();\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 合并整个range中的内容\n\t\t\t\t */\n\t\t\t\tmergeRange: function() {\n\t\t\t\t\t//由于合并操作可以在任意时刻进行，所以无法通过鼠标位置等信息实时生成range，只能通过缓存实例中的cellsRange对象来访问\n\t\t\t\t\tvar range = this.cellsRange,\n\t\t\t\t\t\tleftTopCell = this.getCell(range.beginRowIndex, this.indexTable[range.beginRowIndex][range.beginColIndex].cellIndex);\n\t\n\t\t\t\t\tif (leftTopCell.tagName == \"TH\" && range.endRowIndex !== range.beginRowIndex) {\n\t\t\t\t\t\tvar index = this.indexTable,\n\t\t\t\t\t\t\tinfo = this.getCellInfo(leftTopCell);\n\t\t\t\t\t\tleftTopCell = this.getCell(1, index[1][info.colIndex].cellIndex);\n\t\t\t\t\t\trange = this.getCellsRange(leftTopCell, this.getCell(index[this.rowsNum - 1][info.colIndex].rowIndex, index[this.rowsNum - 1][info.colIndex].cellIndex));\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// 删除剩余的Cells\n\t\t\t\t\tvar cells = this.getCells(range);\n\t\t\t\t\tfor (var i = 0, ci; ci = cells[i++];) {\n\t\t\t\t\t\tif (ci !== leftTopCell) {\n\t\t\t\t\t\t\tthis.moveContent(leftTopCell, ci);\n\t\t\t\t\t\t\tthis.deleteCell(ci);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// 修改左上角Cell的rowSpan和colSpan，并调整宽度属性设置\n\t\t\t\t\tleftTopCell.rowSpan = range.endRowIndex - range.beginRowIndex + 1;\n\t\t\t\t\tleftTopCell.rowSpan > 1 && leftTopCell.removeAttribute(\"height\");\n\t\t\t\t\tleftTopCell.colSpan = range.endColIndex - range.beginColIndex + 1;\n\t\t\t\t\tleftTopCell.colSpan > 1 && leftTopCell.removeAttribute(\"width\");\n\t\t\t\t\tif (leftTopCell.rowSpan == this.rowsNum && leftTopCell.colSpan != 1) {\n\t\t\t\t\t\tleftTopCell.colSpan = 1;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (leftTopCell.colSpan == this.colsNum && leftTopCell.rowSpan != 1) {\n\t\t\t\t\t\tvar rowIndex = leftTopCell.parentNode.rowIndex;\n\t\t\t\t\t\t//解决IE下的表格操作问题\n\t\t\t\t\t\tif (this.table.deleteRow) {\n\t\t\t\t\t\t\tfor (var i = rowIndex + 1, curIndex = rowIndex + 1, len = leftTopCell.rowSpan; i < len; i++) {\n\t\t\t\t\t\t\t\tthis.table.deleteRow(curIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfor (var i = 0, len = leftTopCell.rowSpan - 1; i < len; i++) {\n\t\t\t\t\t\t\t\tvar row = this.table.rows[rowIndex + 1];\n\t\t\t\t\t\t\t\trow.parentNode.removeChild(row);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tleftTopCell.rowSpan = 1;\n\t\t\t\t\t}\n\t\t\t\t\tthis.update();\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 插入一行单元格\n\t\t\t\t */\n\t\t\t\tinsertRow: function(rowIndex, sourceCell) {\n\t\t\t\t\tvar numCols = this.colsNum,\n\t\t\t\t\t\ttable = this.table,\n\t\t\t\t\t\trow = table.insertRow(rowIndex),\n\t\t\t\t\t\tcell,\n\t\t\t\t\t\tisInsertTitle = typeof sourceCell == 'string' && sourceCell.toUpperCase() == 'TH';\n\t\n\t\t\t\t\tfunction replaceTdToTh(colIndex, cell, tableRow) {\n\t\t\t\t\t\tif (colIndex == 0) {\n\t\t\t\t\t\t\tvar tr = tableRow.nextSibling || tableRow.previousSibling,\n\t\t\t\t\t\t\t\tth = tr.cells[colIndex];\n\t\t\t\t\t\t\tif (th.tagName == 'TH') {\n\t\t\t\t\t\t\t\tth = cell.ownerDocument.createElement(\"th\");\n\t\t\t\t\t\t\t\tth.appendChild(cell.firstChild);\n\t\t\t\t\t\t\t\ttableRow.insertBefore(th, cell);\n\t\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\t\t\tvar td = cell.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\t\ttd.appendChild(cell.firstChild);\n\t\t\t\t\t\t\t\ttableRow.insertBefore(td, cell);\n\t\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//首行直接插入,无需考虑部分单元格被rowspan的情况\n\t\t\t\t\tif (rowIndex == 0 || rowIndex == this.rowsNum) {\n\t\t\t\t\t\tfor (var colIndex = 0; colIndex < numCols; colIndex++) {\n\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true);\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\tcell.getAttribute('vAlign') && cell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\t\tif (!isInsertTitle) replaceTdToTh(colIndex, cell, row);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar infoRow = this.indexTable[rowIndex],\n\t\t\t\t\t\t\tcellIndex = 0;\n\t\t\t\t\t\tfor (colIndex = 0; colIndex < numCols; colIndex++) {\n\t\t\t\t\t\t\tvar cellInfo = infoRow[colIndex];\n\t\t\t\t\t\t\t//如果存在某个单元格的rowspan穿过待插入行的位置，则修改该单元格的rowspan即可，无需插入单元格\n\t\t\t\t\t\t\tif (cellInfo.rowIndex < rowIndex) {\n\t\t\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\t\t\tcell.rowSpan = cellInfo.rowSpan + 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true);\n\t\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!isInsertTitle) replaceTdToTh(colIndex, cell, row);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//框选时插入不触发contentchange，需要手动更新索引。\n\t\t\t\t\tthis.update();\n\t\t\t\t\treturn row;\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 删除一行单元格\n\t\t\t\t * @param rowIndex\n\t\t\t\t */\n\t\t\t\tdeleteRow: function(rowIndex) {\n\t\t\t\t\tvar row = this.table.rows[rowIndex],\n\t\t\t\t\t\tinfoRow = this.indexTable[rowIndex],\n\t\t\t\t\t\tcolsNum = this.colsNum,\n\t\t\t\t\t\tcount = 0; //处理计数\n\t\t\t\t\tfor (var colIndex = 0; colIndex < colsNum;) {\n\t\t\t\t\t\tvar cellInfo = infoRow[colIndex],\n\t\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\tif (cell.rowSpan > 1) {\n\t\t\t\t\t\t\tif (cellInfo.rowIndex == rowIndex) {\n\t\t\t\t\t\t\t\tvar clone = cell.cloneNode(true);\n\t\t\t\t\t\t\t\tclone.rowSpan = cell.rowSpan - 1;\n\t\t\t\t\t\t\t\tclone.innerHTML = \"\";\n\t\t\t\t\t\t\t\tcell.rowSpan = 1;\n\t\t\t\t\t\t\t\tvar nextRowIndex = rowIndex + 1,\n\t\t\t\t\t\t\t\t\tnextRow = this.table.rows[nextRowIndex],\n\t\t\t\t\t\t\t\t\tinsertCellIndex,\n\t\t\t\t\t\t\t\t\tpreMerged = this.getPreviewMergedCellsNum(nextRowIndex, colIndex) - count;\n\t\t\t\t\t\t\t\tif (preMerged < colIndex) {\n\t\t\t\t\t\t\t\t\tinsertCellIndex = colIndex - preMerged - 1;\n\t\t\t\t\t\t\t\t\t//nextRow.insertCell(insertCellIndex);\n\t\t\t\t\t\t\t\t\tdomUtils.insertAfter(nextRow.cells[insertCellIndex], clone);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (nextRow.cells.length) nextRow.insertBefore(clone, nextRow.cells[0])\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcount += 1;\n\t\t\t\t\t\t\t\t//cell.parentNode.removeChild(cell);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcolIndex += cell.colSpan || 1;\n\t\t\t\t\t}\n\t\t\t\t\tvar deleteTds = [],\n\t\t\t\t\t\tcacheMap = {};\n\t\t\t\t\tfor (colIndex = 0; colIndex < colsNum; colIndex++) {\n\t\t\t\t\t\tvar tmpRowIndex = infoRow[colIndex].rowIndex,\n\t\t\t\t\t\t\ttmpCellIndex = infoRow[colIndex].cellIndex,\n\t\t\t\t\t\t\tkey = tmpRowIndex + \"_\" + tmpCellIndex;\n\t\t\t\t\t\tif (cacheMap[key]) continue;\n\t\t\t\t\t\tcacheMap[key] = 1;\n\t\t\t\t\t\tcell = this.getCell(tmpRowIndex, tmpCellIndex);\n\t\t\t\t\t\tdeleteTds.push(cell);\n\t\t\t\t\t}\n\t\t\t\t\tvar mergeTds = [];\n\t\t\t\t\tutils.each(deleteTds, function(td) {\n\t\t\t\t\t\tif (td.rowSpan == 1) {\n\t\t\t\t\t\t\ttd.parentNode.removeChild(td);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tmergeTds.push(td);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tutils.each(mergeTds, function(td) {\n\t\t\t\t\t\ttd.rowSpan--;\n\t\t\t\t\t});\n\t\t\t\t\trow.parentNode.removeChild(row);\n\t\t\t\t\t//浏览器方法本身存在bug,采用自定义方法删除\n\t\t\t\t\t//this.table.deleteRow(rowIndex);\n\t\t\t\t\tthis.update();\n\t\t\t\t},\n\t\t\t\tinsertCol: function(colIndex, sourceCell, defaultValue) {\n\t\t\t\t\tvar rowsNum = this.rowsNum,\n\t\t\t\t\t\trowIndex = 0,\n\t\t\t\t\t\ttableRow, cell,\n\t\t\t\t\t\tbackWidth = parseInt((this.table.offsetWidth - (this.colsNum + 1) * 20 - (this.colsNum + 1)) / (this.colsNum + 1), 10),\n\t\t\t\t\t\tisInsertTitleCol = typeof sourceCell == 'string' && sourceCell.toUpperCase() == 'TH';\n\t\n\t\t\t\t\tfunction replaceTdToTh(rowIndex, cell, tableRow) {\n\t\t\t\t\t\tif (rowIndex == 0) {\n\t\t\t\t\t\t\tvar th = cell.nextSibling || cell.previousSibling;\n\t\t\t\t\t\t\tif (th.tagName == 'TH') {\n\t\t\t\t\t\t\t\tth = cell.ownerDocument.createElement(\"th\");\n\t\t\t\t\t\t\t\tth.appendChild(cell.firstChild);\n\t\t\t\t\t\t\t\ttableRow.insertBefore(th, cell);\n\t\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\t\t\tvar td = cell.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\t\ttd.appendChild(cell.firstChild);\n\t\t\t\t\t\t\t\ttableRow.insertBefore(td, cell);\n\t\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar preCell;\n\t\t\t\t\tif (colIndex == 0 || colIndex == this.colsNum) {\n\t\t\t\t\t\tfor (; rowIndex < rowsNum; rowIndex++) {\n\t\t\t\t\t\t\ttableRow = this.table.rows[rowIndex];\n\t\t\t\t\t\t\tpreCell = tableRow.cells[colIndex == 0 ? colIndex : tableRow.cells.length];\n\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true); //tableRow.insertCell(colIndex == 0 ? colIndex : tableRow.cells.length);\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\tcell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\t\tpreCell && cell.setAttribute('width', preCell.getAttribute('width'));\n\t\t\t\t\t\t\tif (!colIndex) {\n\t\t\t\t\t\t\t\ttableRow.insertBefore(cell, tableRow.cells[0]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(tableRow.cells[tableRow.cells.length - 1], cell);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!isInsertTitleCol) replaceTdToTh(rowIndex, cell, tableRow)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (; rowIndex < rowsNum; rowIndex++) {\n\t\t\t\t\t\t\tvar cellInfo = this.indexTable[rowIndex][colIndex];\n\t\t\t\t\t\t\tif (cellInfo.colIndex < colIndex) {\n\t\t\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\t\t\tcell.colSpan = cellInfo.colSpan + 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttableRow = this.table.rows[rowIndex];\n\t\t\t\t\t\t\t\tpreCell = tableRow.cells[cellInfo.cellIndex];\n\t\n\t\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true); //tableRow.insertCell(cellInfo.cellIndex);\n\t\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\t\tcell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\t\t\tpreCell && cell.setAttribute('width', preCell.getAttribute('width'));\n\t\t\t\t\t\t\t\t//防止IE下报错\n\t\t\t\t\t\t\t\tpreCell ? tableRow.insertBefore(cell, preCell) : tableRow.appendChild(cell);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!isInsertTitleCol) replaceTdToTh(rowIndex, cell, tableRow);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//框选时插入不触发contentchange，需要手动更新索引\n\t\t\t\t\tthis.update();\n\t\t\t\t\tthis.updateWidth(backWidth, defaultValue || {\n\t\t\t\t\t\ttdPadding: 10,\n\t\t\t\t\t\ttdBorder: 1\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tupdateWidth: function(width, defaultValue) {\n\t\t\t\t\tvar table = this.table,\n\t\t\t\t\t\ttmpWidth = UETable.getWidth(table) - defaultValue.tdPadding * 2 - defaultValue.tdBorder + width;\n\t\t\t\t\tif (tmpWidth < table.ownerDocument.body.offsetWidth) {\n\t\t\t\t\t\ttable.setAttribute(\"width\", tmpWidth);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar tds = domUtils.getElementsByTagName(this.table, \"td th\");\n\t\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t\ttd.setAttribute(\"width\", width);\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tdeleteCol: function(colIndex) {\n\t\t\t\t\tvar indexTable = this.indexTable,\n\t\t\t\t\t\ttableRows = this.table.rows,\n\t\t\t\t\t\tbackTableWidth = this.table.getAttribute(\"width\"),\n\t\t\t\t\t\tbackTdWidth = 0,\n\t\t\t\t\t\trowsNum = this.rowsNum,\n\t\t\t\t\t\tcacheMap = {};\n\t\t\t\t\tfor (var rowIndex = 0; rowIndex < rowsNum;) {\n\t\t\t\t\t\tvar infoRow = indexTable[rowIndex],\n\t\t\t\t\t\t\tcellInfo = infoRow[colIndex],\n\t\t\t\t\t\t\tkey = cellInfo.rowIndex + '_' + cellInfo.colIndex;\n\t\t\t\t\t\t// 跳过已经处理过的Cell\n\t\t\t\t\t\tif (cacheMap[key]) continue;\n\t\t\t\t\t\tcacheMap[key] = 1;\n\t\t\t\t\t\tvar cell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\tif (!backTdWidth) backTdWidth = cell && parseInt(cell.offsetWidth / cell.colSpan, 10).toFixed(0);\n\t\t\t\t\t\t// 如果Cell的colSpan大于1, 就修改colSpan, 否则就删掉这个Cell\n\t\t\t\t\t\tif (cell.colSpan > 1) {\n\t\t\t\t\t\t\tcell.colSpan--;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttableRows[rowIndex].deleteCell(cellInfo.cellIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trowIndex += cellInfo.rowSpan || 1;\n\t\t\t\t\t}\n\t\t\t\t\tthis.table.setAttribute(\"width\", backTableWidth - backTdWidth);\n\t\t\t\t\tthis.update();\n\t\t\t\t},\n\t\t\t\tsplitToCells: function(cell) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tcells = this.splitToRows(cell);\n\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\tme.splitToCols(cell);\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tsplitToRows: function(cell) {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\trowIndex = cellInfo.rowIndex,\n\t\t\t\t\t\tcolIndex = cellInfo.colIndex,\n\t\t\t\t\t\tresults = [];\n\t\t\t\t\t// 修改Cell的rowSpan\n\t\t\t\t\tcell.rowSpan = 1;\n\t\t\t\t\tresults.push(cell);\n\t\t\t\t\t// 补齐单元格\n\t\t\t\t\tfor (var i = rowIndex, endRow = rowIndex + cellInfo.rowSpan; i < endRow; i++) {\n\t\t\t\t\t\tif (i == rowIndex) continue;\n\t\t\t\t\t\tvar tableRow = this.table.rows[i],\n\t\t\t\t\t\t\ttmpCell = tableRow.insertCell(colIndex - this.getPreviewMergedCellsNum(i, colIndex));\n\t\t\t\t\t\ttmpCell.colSpan = cellInfo.colSpan;\n\t\t\t\t\t\tthis.setCellContent(tmpCell);\n\t\t\t\t\t\ttmpCell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\ttmpCell.setAttribute('align', cell.getAttribute('align'));\n\t\t\t\t\t\tif (cell.style.cssText) {\n\t\t\t\t\t\t\ttmpCell.style.cssText = cell.style.cssText;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresults.push(tmpCell);\n\t\t\t\t\t}\n\t\t\t\t\tthis.update();\n\t\t\t\t\treturn results;\n\t\t\t\t},\n\t\t\t\tgetPreviewMergedCellsNum: function(rowIndex, colIndex) {\n\t\t\t\t\tvar indexRow = this.indexTable[rowIndex],\n\t\t\t\t\t\tnum = 0;\n\t\t\t\t\tfor (var i = 0; i < colIndex;) {\n\t\t\t\t\t\tvar colSpan = indexRow[i].colSpan,\n\t\t\t\t\t\t\ttmpRowIndex = indexRow[i].rowIndex;\n\t\t\t\t\t\tnum += (colSpan - (tmpRowIndex == rowIndex ? 1 : 0));\n\t\t\t\t\t\ti += colSpan;\n\t\t\t\t\t}\n\t\t\t\t\treturn num;\n\t\t\t\t},\n\t\t\t\tsplitToCols: function(cell) {\n\t\t\t\t\tvar backWidth = (cell.offsetWidth / cell.colSpan - 22).toFixed(0),\n\t\n\t\t\t\t\t\tcellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\trowIndex = cellInfo.rowIndex,\n\t\t\t\t\t\tcolIndex = cellInfo.colIndex,\n\t\t\t\t\t\tresults = [];\n\t\t\t\t\t// 修改Cell的rowSpan\n\t\t\t\t\tcell.colSpan = 1;\n\t\t\t\t\tcell.setAttribute(\"width\", backWidth);\n\t\t\t\t\tresults.push(cell);\n\t\t\t\t\t// 补齐单元格\n\t\t\t\t\tfor (var j = colIndex, endCol = colIndex + cellInfo.colSpan; j < endCol; j++) {\n\t\t\t\t\t\tif (j == colIndex) continue;\n\t\t\t\t\t\tvar tableRow = this.table.rows[rowIndex],\n\t\t\t\t\t\t\ttmpCell = tableRow.insertCell(this.indexTable[rowIndex][j].cellIndex + 1);\n\t\t\t\t\t\ttmpCell.rowSpan = cellInfo.rowSpan;\n\t\t\t\t\t\tthis.setCellContent(tmpCell);\n\t\t\t\t\t\ttmpCell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\ttmpCell.setAttribute('align', cell.getAttribute('align'));\n\t\t\t\t\t\ttmpCell.setAttribute('width', backWidth);\n\t\t\t\t\t\tif (cell.style.cssText) {\n\t\t\t\t\t\t\ttmpCell.style.cssText = cell.style.cssText;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//处理th的情况\n\t\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\t\tvar th = cell.ownerDocument.createElement('th');\n\t\t\t\t\t\t\tth.appendChild(tmpCell.firstChild);\n\t\t\t\t\t\t\tth.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\t\tth.rowSpan = tmpCell.rowSpan;\n\t\t\t\t\t\t\ttableRow.insertBefore(th, tmpCell);\n\t\t\t\t\t\t\tdomUtils.remove(tmpCell);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresults.push(tmpCell);\n\t\t\t\t\t}\n\t\t\t\t\tthis.update();\n\t\t\t\t\treturn results;\n\t\t\t\t},\n\t\t\t\tisLastCell: function(cell, rowsNum, colsNum) {\n\t\t\t\t\trowsNum = rowsNum || this.rowsNum;\n\t\t\t\t\tcolsNum = colsNum || this.colsNum;\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell);\n\t\t\t\t\treturn ((cellInfo.rowIndex + cellInfo.rowSpan) == rowsNum) &&\n\t\t\t\t\t\t((cellInfo.colIndex + cellInfo.colSpan) == colsNum);\n\t\t\t\t},\n\t\t\t\tgetLastCell: function(cells) {\n\t\t\t\t\tcells = cells || this.table.getElementsByTagName(\"td\");\n\t\t\t\t\tvar firstInfo = this.getCellInfo(cells[0]);\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tlast = cells[0],\n\t\t\t\t\t\ttr = last.parentNode,\n\t\t\t\t\t\tcellsNum = 0,\n\t\t\t\t\t\tcols = 0,\n\t\t\t\t\t\trows;\n\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\tif (cell.parentNode == tr) cols += cell.colSpan || 1;\n\t\t\t\t\t\tcellsNum += cell.rowSpan * cell.colSpan || 1;\n\t\t\t\t\t});\n\t\t\t\t\trows = cellsNum / cols;\n\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\tif (me.isLastCell(cell, rows, cols)) {\n\t\t\t\t\t\t\tlast = cell;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn last;\n\t\n\t\t\t\t},\n\t\t\t\tselectRow: function(rowIndex) {\n\t\t\t\t\tvar indexRow = this.indexTable[rowIndex],\n\t\t\t\t\t\tstart = this.getCell(indexRow[0].rowIndex, indexRow[0].cellIndex),\n\t\t\t\t\t\tend = this.getCell(indexRow[this.colsNum - 1].rowIndex, indexRow[this.colsNum - 1].cellIndex),\n\t\t\t\t\t\trange = this.getCellsRange(start, end);\n\t\t\t\t\tthis.setSelected(range);\n\t\t\t\t},\n\t\t\t\tselectTable: function() {\n\t\t\t\t\tvar tds = this.table.getElementsByTagName(\"td\"),\n\t\t\t\t\t\trange = this.getCellsRange(tds[0], tds[tds.length - 1]);\n\t\t\t\t\tthis.setSelected(range);\n\t\t\t\t},\n\t\t\t\tsetBackground: function(cells, value) {\n\t\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\t\tcell.style.backgroundColor = value;\n\t\t\t\t\t\t})\n\t\t\t\t\t} else if (typeof value === \"object\") {\n\t\t\t\t\t\tvalue = utils.extend({\n\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\tcolorList: [\"#ddd\", \"#fff\"]\n\t\t\t\t\t\t}, value);\n\t\t\t\t\t\tvar rowIndex = this.getCellInfo(cells[0]).rowIndex,\n\t\t\t\t\t\t\tcount = 0,\n\t\t\t\t\t\t\tcolors = value.colorList,\n\t\t\t\t\t\t\tgetColor = function(list, index, repeat) {\n\t\t\t\t\t\t\t\treturn list[index] ? list[index] : repeat ? list[index % list.length] : \"\";\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\t\t\tvar cellInfo = this.getCellInfo(cell);\n\t\t\t\t\t\t\tcell.style.backgroundColor = getColor(colors, ((rowIndex + count) == cellInfo.rowIndex) ? count : ++count, value.repeat);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveBackground: function(cells) {\n\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\tcell.style.backgroundColor = \"\";\n\t\t\t\t\t})\n\t\t\t\t}\n\t\n\t\t\t};\n\t\n\t\t\tfunction showError(e) {}\n\t\t})();\n\t\n\t\t// plugins/table.cmds.js\n\t\t/**\n\t\t * Created with JetBrains PhpStorm.\n\t\t * User: taoqili\n\t\t * Date: 13-2-20\n\t\t * Time: 下午6:25\n\t\t * To change this template use File | Settings | File Templates.\n\t\t */\n\t\t;\n\t\t(function() {\n\t\t\tvar UT = UE.UETable,\n\t\t\t\tgetTableItemsByRange = function(editor) {\n\t\t\t\t\treturn UT.getTableItemsByRange(editor);\n\t\t\t\t},\n\t\t\t\tgetUETableBySelected = function(editor) {\n\t\t\t\t\treturn UT.getUETableBySelected(editor)\n\t\t\t\t},\n\t\t\t\tgetDefaultValue = function(editor, table) {\n\t\t\t\t\treturn UT.getDefaultValue(editor, table);\n\t\t\t\t},\n\t\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t\t};\n\t\n\t\t\tUE.commands['inserttable'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getTableItemsByRange(this).table ? -1 : 0;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, opt) {\n\t\t\t\t\tfunction createTable(opt, tdWidth) {\n\t\t\t\t\t\tvar html = [],\n\t\t\t\t\t\t\trowsNum = opt.numRows,\n\t\t\t\t\t\t\tcolsNum = opt.numCols;\n\t\t\t\t\t\tfor (var r = 0; r < rowsNum; r++) {\n\t\t\t\t\t\t\thtml.push('<tr' + (r == 0 ? ' class=\"firstRow\"' : '') + '>');\n\t\t\t\t\t\t\tfor (var c = 0; c < colsNum; c++) {\n\t\t\t\t\t\t\t\thtml.push('<td width=\"' + tdWidth + '\"  vAlign=\"' + opt.tdvalign + '\" >' + (browser.ie && browser.version < 11 ? domUtils.fillChar : '<br/>') + '</td>')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thtml.push('</tr>')\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//禁止指定table-width\n\t\t\t\t\t\treturn '<table><tbody>' + html.join('') + '</tbody></table>'\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (!opt) {\n\t\t\t\t\t\topt = utils.extend({}, {\n\t\t\t\t\t\t\tnumCols: this.options.defaultCols,\n\t\t\t\t\t\t\tnumRows: this.options.defaultRows,\n\t\t\t\t\t\t\ttdvalign: this.options.tdvalign\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\tstart = range.startContainer,\n\t\t\t\t\t\tfirstParentBlock = domUtils.findParent(start, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node);\n\t\t\t\t\t\t}, true) || me.body;\n\t\n\t\t\t\t\tvar defaultValue = getDefaultValue(me),\n\t\t\t\t\t\ttableWidth = firstParentBlock.offsetWidth,\n\t\t\t\t\t\ttdWidth = Math.floor(tableWidth / opt.numCols - defaultValue.tdPadding * 2 - defaultValue.tdBorder);\n\t\n\t\t\t\t\t//todo其他属性\n\t\t\t\t\t!opt.tdvalign && (opt.tdvalign = me.options.tdvalign);\n\t\t\t\t\tme.execCommand(\"inserthtml\", createTable(opt, tdWidth));\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands['insertparagraphbeforetable'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getTableItemsByRange(this).cell ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar p = this.document.createElement(\"p\");\n\t\t\t\t\t\tp.innerHTML = browser.ie ? '&nbsp;' : '<br />';\n\t\t\t\t\t\ttable.parentNode.insertBefore(p, table);\n\t\t\t\t\t\tthis.selection.getRange().setStart(p, 0).setCursor();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands['deletetable'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\t\treturn domUtils.findParentByTagName(rng.startContainer, 'table', true) ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, table) {\n\t\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\t\ttable = table || domUtils.findParentByTagName(rng.startContainer, 'table', true);\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar next = table.nextSibling;\n\t\t\t\t\t\tif (!next) {\n\t\t\t\t\t\t\tnext = domUtils.createElement(this.document, 'p', {\n\t\t\t\t\t\t\t\t'innerHTML': browser.ie ? domUtils.fillChar : '<br/>'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\ttable.parentNode.insertBefore(next, table);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\t\trng = this.selection.getRange();\n\t\t\t\t\t\tif (next.nodeType == 3) {\n\t\t\t\t\t\t\trng.setStartBefore(next)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.setStart(next, 0)\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.setCursor(false, true)\n\t\t\t\t\t\tthis.fireEvent(\"tablehasdeleted\")\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['cellalign'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getSelectedArr(this).length ? 0 : -1\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, align) {\n\t\t\t\t\tvar selectedTds = getSelectedArr(this);\n\t\t\t\t\tif (selectedTds.length) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = selectedTds[i++];) {\n\t\t\t\t\t\t\tci.setAttribute('align', align);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['cellvalign'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getSelectedArr(this).length ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, valign) {\n\t\t\t\t\tvar selectedTds = getSelectedArr(this);\n\t\t\t\t\tif (selectedTds.length) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = selectedTds[i++];) {\n\t\t\t\t\t\t\tci.setAttribute('vAlign', valign);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['insertcaption'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\treturn table.getElementsByTagName('caption').length == 0 ? 1 : -1;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar caption = this.document.createElement('caption');\n\t\t\t\t\t\tcaption.innerHTML = browser.ie ? domUtils.fillChar : '<br/>';\n\t\t\t\t\t\ttable.insertBefore(caption, table.firstChild);\n\t\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\t\trange.setStart(caption, 0).setCursor();\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['deletecaption'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\treturn table.getElementsByTagName('caption').length == 0 ? -1 : 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tdomUtils.remove(table.getElementsByTagName('caption')[0]);\n\t\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\t\trange.setStart(table.rows[0].cells[0], 0).setCursor();\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['inserttitle'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar firstRow = table.rows[0];\n\t\t\t\t\t\treturn firstRow.cells[firstRow.cells.length - 1].tagName.toLowerCase() != 'th' ? 0 : -1\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tgetUETable(table).insertRow(0, 'th');\n\t\t\t\t\t}\n\t\t\t\t\tvar th = table.getElementsByTagName('th')[0];\n\t\t\t\t\tthis.selection.getRange().setStart(th, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['deletetitle'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar firstRow = table.rows[0];\n\t\t\t\t\t\treturn firstRow.cells[firstRow.cells.length - 1].tagName.toLowerCase() == 'th' ? 0 : -1\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tdomUtils.remove(table.rows[0])\n\t\t\t\t\t}\n\t\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\t\tthis.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['inserttitlecol'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar lastRow = table.rows[table.rows.length - 1];\n\t\t\t\t\t\treturn lastRow.getElementsByTagName('th').length ? -1 : 0;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tgetUETable(table).insertCol(0, 'th');\n\t\t\t\t\t}\n\t\t\t\t\tresetTdWidth(table, this);\n\t\t\t\t\tvar th = table.getElementsByTagName('th')[0];\n\t\t\t\t\tthis.selection.getRange().setStart(th, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands['deletetitlecol'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar lastRow = table.rows[table.rows.length - 1];\n\t\t\t\t\t\treturn lastRow.getElementsByTagName('th').length ? 0 : -1;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tfor (var i = 0; i < table.rows.length; i++) {\n\t\t\t\t\t\t\tdomUtils.remove(table.rows[i].children[0])\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresetTdWidth(table, this);\n\t\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\t\tthis.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands[\"mergeright\"] = {\n\t\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\n\t\t\t\t\tif (!table || !cell) return -1;\n\t\t\t\t\tvar ut = getUETable(table);\n\t\t\t\t\tif (ut.selectedTds.length) return -1;\n\t\n\t\t\t\t\tvar cellInfo = ut.getCellInfo(cell),\n\t\t\t\t\t\trightColIndex = cellInfo.colIndex + cellInfo.colSpan;\n\t\t\t\t\tif (rightColIndex >= ut.colsNum) return -1; // 如果处于最右边则不能向右合并\n\t\n\t\t\t\t\tvar rightCellInfo = ut.indexTable[cellInfo.rowIndex][rightColIndex],\n\t\t\t\t\t\trightCell = table.rows[rightCellInfo.rowIndex].cells[rightCellInfo.cellIndex];\n\t\t\t\t\tif (!rightCell || cell.tagName != rightCell.tagName) return -1; // TH和TD不能相互合并\n\t\n\t\t\t\t\t// 当且仅当两个Cell的开始列号和结束列号一致时能进行合并\n\t\t\t\t\treturn (rightCellInfo.rowIndex == cellInfo.rowIndex && rightCellInfo.rowSpan == cellInfo.rowSpan) ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell);\n\t\t\t\t\tut.mergeRight(cell);\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"mergedown\"] = {\n\t\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\n\t\t\t\t\tif (!table || !cell) return -1;\n\t\t\t\t\tvar ut = getUETable(table);\n\t\t\t\t\tif (ut.selectedTds.length) return -1;\n\t\n\t\t\t\t\tvar cellInfo = ut.getCellInfo(cell),\n\t\t\t\t\t\tdownRowIndex = cellInfo.rowIndex + cellInfo.rowSpan;\n\t\t\t\t\tif (downRowIndex >= ut.rowsNum) return -1; // 如果处于最下边则不能向下合并\n\t\n\t\t\t\t\tvar downCellInfo = ut.indexTable[downRowIndex][cellInfo.colIndex],\n\t\t\t\t\t\tdownCell = table.rows[downCellInfo.rowIndex].cells[downCellInfo.cellIndex];\n\t\t\t\t\tif (!downCell || cell.tagName != downCell.tagName) return -1; // TH和TD不能相互合并\n\t\n\t\t\t\t\t// 当且仅当两个Cell的开始列号和结束列号一致时能进行合并\n\t\t\t\t\treturn (downCellInfo.colIndex == cellInfo.colIndex && downCellInfo.colSpan == cellInfo.colSpan) ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell);\n\t\t\t\t\tut.mergeDown(cell);\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"mergecells\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getUETableBySelected(this) ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\t\tvar cell = ut.selectedTds[0];\n\t\t\t\t\t\tut.mergeRange();\n\t\t\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(cell)) {\n\t\t\t\t\t\t\trng.setStart(cell, 0).collapse(true)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.selectNodeContents(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.select();\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"insertrow\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\t\treturn cell && (cell.tagName == \"TD\" || (cell.tagName == 'TH' && tableItems.tr !== tableItems.table.rows[0])) &&\n\t\t\t\t\t\tgetUETable(tableItems.table).rowsNum < this.options.maxRowNum ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\t\tut = getUETable(table),\n\t\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t\t//ut.insertRow(!ut.selectedTds.length ? cellInfo.rowIndex:ut.cellsRange.beginRowIndex,'');\n\t\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\t\tut.insertRow(cellInfo.rowIndex, cell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\t\tfor (var i = 0, len = range.endRowIndex - range.beginRowIndex + 1; i < len; i++) {\n\t\t\t\t\t\t\tut.insertRow(range.beginRowIndex, cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t\t}\n\t\t\t};\n\t\t\t//后插入行\n\t\t\tUE.commands[\"insertrownext\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\t\treturn cell && (cell.tagName == \"TD\") && getUETable(tableItems.table).rowsNum < this.options.maxRowNum ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\t\tut = getUETable(table),\n\t\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t\t//ut.insertRow(!ut.selectedTds.length? cellInfo.rowIndex + cellInfo.rowSpan : ut.cellsRange.endRowIndex + 1,'');\n\t\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\t\tut.insertRow(cellInfo.rowIndex + cellInfo.rowSpan, cell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\t\tfor (var i = 0, len = range.endRowIndex - range.beginRowIndex + 1; i < len; i++) {\n\t\t\t\t\t\t\tut.insertRow(range.endRowIndex + 1, cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"deleterow\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this);\n\t\t\t\t\treturn tableItems.cell ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\t\tcellsRange = ut.cellsRange,\n\t\t\t\t\t\tcellInfo = ut.getCellInfo(cell),\n\t\t\t\t\t\tpreCell = ut.getVSideCell(cell),\n\t\t\t\t\t\tnextCell = ut.getVSideCell(cell, true),\n\t\t\t\t\t\trng = this.selection.getRange();\n\t\t\t\t\tif (utils.isEmptyObject(cellsRange)) {\n\t\t\t\t\t\tut.deleteRow(cellInfo.rowIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (var i = cellsRange.beginRowIndex; i < cellsRange.endRowIndex + 1; i++) {\n\t\t\t\t\t\t\tut.deleteRow(cellsRange.beginRowIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar table = ut.table;\n\t\t\t\t\tif (!table.getElementsByTagName('td').length) {\n\t\t\t\t\t\tvar nextSibling = table.nextSibling;\n\t\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\t\tif (nextSibling) {\n\t\t\t\t\t\t\trng.setStart(nextSibling, 0).setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (cellInfo.rowSpan == 1 || cellInfo.rowSpan == cellsRange.endRowIndex - cellsRange.beginRowIndex + 1) {\n\t\t\t\t\t\t\tif (nextCell || preCell) rng.selectNodeContents(nextCell || preCell).setCursor(false, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar newCell = ut.getCell(cellInfo.rowIndex, ut.indexTable[cellInfo.rowIndex][cellInfo.colIndex].cellIndex);\n\t\t\t\t\t\t\tif (newCell) rng.selectNodeContents(newCell).setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"insertcol\"] = {\n\t\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\t\treturn cell && (cell.tagName == \"TD\" || (cell.tagName == 'TH' && cell !== tableItems.tr.cells[0])) &&\n\t\t\t\t\t\tgetUETable(tableItems.table).colsNum < this.options.maxColNum ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tif (this.queryCommandState(cmd) == -1) return;\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\n\t\t\t\t\t//ut.insertCol(!ut.selectedTds.length ? cellInfo.colIndex:ut.cellsRange.beginColIndex);\n\t\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\t\tut.insertCol(cellInfo.colIndex, cell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\t\tfor (var i = 0, len = range.endColIndex - range.beginColIndex + 1; i < len; i++) {\n\t\t\t\t\t\t\tut.insertCol(range.beginColIndex, cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trng.moveToBookmark(bk).select(true);\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"insertcolnext\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\t\treturn cell && getUETable(tableItems.table).colsNum < this.options.maxColNum ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t\t//ut.insertCol(!ut.selectedTds.length ? cellInfo.colIndex + cellInfo.colSpan:ut.cellsRange.endColIndex +1);\n\t\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\t\tut.insertCol(cellInfo.colIndex + cellInfo.colSpan, cell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\t\tfor (var i = 0, len = range.endColIndex - range.beginColIndex + 1; i < len; i++) {\n\t\t\t\t\t\t\tut.insertCol(range.endColIndex + 1, cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands[\"deletecol\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this);\n\t\t\t\t\treturn tableItems.cell ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\t\trange = ut.cellsRange,\n\t\t\t\t\t\tcellInfo = ut.getCellInfo(cell),\n\t\t\t\t\t\tpreCell = ut.getHSideCell(cell),\n\t\t\t\t\t\tnextCell = ut.getHSideCell(cell, true);\n\t\t\t\t\tif (utils.isEmptyObject(range)) {\n\t\t\t\t\t\tut.deleteCol(cellInfo.colIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (var i = range.beginColIndex; i < range.endColIndex + 1; i++) {\n\t\t\t\t\t\t\tut.deleteCol(range.beginColIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar table = ut.table,\n\t\t\t\t\t\trng = this.selection.getRange();\n\t\n\t\t\t\t\tif (!table.getElementsByTagName('td').length) {\n\t\t\t\t\t\tvar nextSibling = table.nextSibling;\n\t\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\t\tif (nextSibling) {\n\t\t\t\t\t\t\trng.setStart(nextSibling, 0).setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (domUtils.inDoc(cell, this.document)) {\n\t\t\t\t\t\t\trng.setStart(cell, 0).setCursor(false, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (nextCell && domUtils.inDoc(nextCell, this.document)) {\n\t\t\t\t\t\t\t\trng.selectNodeContents(nextCell).setCursor(false, true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (preCell && domUtils.inDoc(preCell, this.document)) {\n\t\t\t\t\t\t\t\t\trng.selectNodeContents(preCell).setCursor(true, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"splittocells\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\t\tif (!cell) return -1;\n\t\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\t\treturn cell && (cell.colSpan > 1 || cell.rowSpan > 1) ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell);\n\t\t\t\t\tut.splitToCells(cell);\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"splittorows\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\t\tif (!cell) return -1;\n\t\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\t\treturn cell && cell.rowSpan > 1 ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell);\n\t\t\t\t\tut.splitToRows(cell);\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"splittocols\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\t\tif (!cell) return -1;\n\t\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\t\treturn cell && cell.colSpan > 1 ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\t\tut = getUETable(cell);\n\t\t\t\t\tut.splitToCols(cell);\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands[\"adaptbytext\"] =\n\t\t\t\tUE.commands[\"adaptbywindow\"] = {\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t\t\t},\n\t\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\t\ttable = tableItems.table;\n\t\t\t\t\t\tif (table) {\n\t\t\t\t\t\t\tif (cmd == 'adaptbywindow') {\n\t\t\t\t\t\t\t\tresetTdWidth(table, this);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar cells = domUtils.getElementsByTagName(table, \"td th\");\n\t\t\t\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\t\t\t\tcell.removeAttribute(\"width\");\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\ttable.removeAttribute(\"width\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\n\t\t\t//平均分配各列\n\t\t\tUE.commands['averagedistributecol'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\t\tif (!ut) return -1;\n\t\t\t\t\treturn ut.isFullRow() || ut.isFullCol() ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tut = getUETableBySelected(me);\n\t\n\t\t\t\t\tfunction getAverageWidth() {\n\t\t\t\t\t\tvar tb = ut.table,\n\t\t\t\t\t\t\taverageWidth, sumWidth = 0,\n\t\t\t\t\t\t\tcolsNum = 0,\n\t\t\t\t\t\t\ttbAttr = getDefaultValue(me, tb);\n\t\n\t\t\t\t\t\tif (ut.isFullRow()) {\n\t\t\t\t\t\t\tsumWidth = tb.offsetWidth;\n\t\t\t\t\t\t\tcolsNum = ut.colsNum;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar begin = ut.cellsRange.beginColIndex,\n\t\t\t\t\t\t\t\tend = ut.cellsRange.endColIndex,\n\t\t\t\t\t\t\t\tnode;\n\t\t\t\t\t\t\tfor (var i = begin; i <= end;) {\n\t\t\t\t\t\t\t\tnode = ut.selectedTds[i];\n\t\t\t\t\t\t\t\tsumWidth += node.offsetWidth;\n\t\t\t\t\t\t\t\ti += node.colSpan;\n\t\t\t\t\t\t\t\tcolsNum += 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\taverageWidth = Math.ceil(sumWidth / colsNum) - tbAttr.tdBorder * 2 - tbAttr.tdPadding * 2;\n\t\t\t\t\t\treturn averageWidth;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction setAverageWidth(averageWidth) {\n\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(ut.table, \"th\"), function(node) {\n\t\t\t\t\t\t\tnode.setAttribute(\"width\", \"\");\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar cells = ut.isFullRow() ? domUtils.getElementsByTagName(ut.table, \"td\") : ut.selectedTds;\n\t\n\t\t\t\t\t\tutils.each(cells, function(node) {\n\t\t\t\t\t\t\tif (node.colSpan == 1) {\n\t\t\t\t\t\t\t\tnode.setAttribute(\"width\", averageWidth);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\t\tsetAverageWidth(getAverageWidth());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\t//平均分配各行\n\t\t\tUE.commands['averagedistributerow'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\t\tif (!ut) return -1;\n\t\t\t\t\tif (ut.selectedTds && /th/ig.test(ut.selectedTds[0].tagName)) return -1;\n\t\t\t\t\treturn ut.isFullRow() || ut.isFullCol() ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tut = getUETableBySelected(me);\n\t\n\t\t\t\t\tfunction getAverageHeight() {\n\t\t\t\t\t\tvar averageHeight, rowNum, sumHeight = 0,\n\t\t\t\t\t\t\ttb = ut.table,\n\t\t\t\t\t\t\ttbAttr = getDefaultValue(me, tb),\n\t\t\t\t\t\t\ttdpadding = parseInt(domUtils.getComputedStyle(tb.getElementsByTagName('td')[0], \"padding-top\"));\n\t\n\t\t\t\t\t\tif (ut.isFullCol()) {\n\t\t\t\t\t\t\tvar captionArr = domUtils.getElementsByTagName(tb, \"caption\"),\n\t\t\t\t\t\t\t\tthArr = domUtils.getElementsByTagName(tb, \"th\"),\n\t\t\t\t\t\t\t\tcaptionHeight, thHeight;\n\t\n\t\t\t\t\t\t\tif (captionArr.length > 0) {\n\t\t\t\t\t\t\t\tcaptionHeight = captionArr[0].offsetHeight;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (thArr.length > 0) {\n\t\t\t\t\t\t\t\tthHeight = thArr[0].offsetHeight;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tsumHeight = tb.offsetHeight - (captionHeight || 0) - (thHeight || 0);\n\t\t\t\t\t\t\trowNum = thArr.length == 0 ? ut.rowsNum : (ut.rowsNum - 1);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar begin = ut.cellsRange.beginRowIndex,\n\t\t\t\t\t\t\t\tend = ut.cellsRange.endRowIndex,\n\t\t\t\t\t\t\t\tcount = 0,\n\t\t\t\t\t\t\t\ttrs = domUtils.getElementsByTagName(tb, \"tr\");\n\t\t\t\t\t\t\tfor (var i = begin; i <= end; i++) {\n\t\t\t\t\t\t\t\tsumHeight += trs[i].offsetHeight;\n\t\t\t\t\t\t\t\tcount += 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trowNum = count;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//ie8下是混杂模式\n\t\t\t\t\t\tif (browser.ie && browser.version < 9) {\n\t\t\t\t\t\t\taverageHeight = Math.ceil(sumHeight / rowNum);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taverageHeight = Math.ceil(sumHeight / rowNum) - tbAttr.tdBorder * 2 - tdpadding * 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn averageHeight;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction setAverageHeight(averageHeight) {\n\t\t\t\t\t\tvar cells = ut.isFullCol() ? domUtils.getElementsByTagName(ut.table, \"td\") : ut.selectedTds;\n\t\t\t\t\t\tutils.each(cells, function(node) {\n\t\t\t\t\t\t\tif (node.rowSpan == 1) {\n\t\t\t\t\t\t\t\tnode.setAttribute(\"height\", averageHeight);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\t\tsetAverageHeight(getAverageHeight());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\t//单元格对齐方式\n\t\t\tUE.commands['cellalignment'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, data) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tut = getUETableBySelected(me);\n\t\n\t\t\t\t\tif (!ut) {\n\t\t\t\t\t\tvar start = me.selection.getStart(),\n\t\t\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\t\t\t\t\tif (!/caption/ig.test(cell.tagName)) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(cell, data);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcell.style.textAlign = data.align;\n\t\t\t\t\t\t\tcell.style.verticalAlign = data.vAlign;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.selection.getRange().setCursor(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tutils.each(ut.selectedTds, function(cell) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(cell, data);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/**\n\t\t\t\t * 查询当前点击的单元格的对齐状态， 如果当前已经选择了多个单元格， 则会返回所有单元格经过统一协调过后的状态\n\t\t\t\t * @see UE.UETable.getTableCellAlignState\n\t\t\t\t */\n\t\t\t\tqueryCommandValue: function(cmd) {\n\t\n\t\t\t\t\tvar activeMenuCell = getTableItemsByRange(this).cell;\n\t\n\t\t\t\t\tif (!activeMenuCell) {\n\t\t\t\t\t\tactiveMenuCell = getSelectedArr(this)[0];\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (!activeMenuCell) {\n\t\n\t\t\t\t\t\treturn null;\n\t\n\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t//获取同时选中的其他单元格\n\t\t\t\t\t\tvar cells = UE.UETable.getUETable(activeMenuCell).selectedTds;\n\t\n\t\t\t\t\t\t!cells.length && (cells = activeMenuCell);\n\t\n\t\t\t\t\t\treturn UE.UETable.getTableCellAlignState(cells);\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t};\n\t\t\t//表格对齐方式\n\t\t\tUE.commands['tablealignment'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tif (browser.ie && browser.version < 8) {\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, value) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tstart = me.selection.getStart(),\n\t\t\t\t\t\ttable = start && domUtils.findParentByTagName(start, [\"table\"], true);\n\t\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\ttable.setAttribute(\"align\", value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\t//表格属性\n\t\t\tUE.commands['edittable'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, color) {\n\t\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar arr = domUtils.getElementsByTagName(table, \"td\").concat(\n\t\t\t\t\t\t\tdomUtils.getElementsByTagName(table, \"th\"),\n\t\t\t\t\t\t\tdomUtils.getElementsByTagName(table, \"caption\")\n\t\t\t\t\t\t);\n\t\t\t\t\t\tutils.each(arr, function(node) {\n\t\t\t\t\t\t\tnode.style.borderColor = color;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\t//单元格属性\n\t\t\tUE.commands['edittd'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, bkColor) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tut = getUETableBySelected(me);\n\t\n\t\t\t\t\tif (!ut) {\n\t\t\t\t\t\tvar start = me.selection.getStart(),\n\t\t\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\t\t\t\t\tif (cell) {\n\t\t\t\t\t\t\tcell.style.backgroundColor = bkColor;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tutils.each(ut.selectedTds, function(cell) {\n\t\t\t\t\t\t\tcell.style.backgroundColor = bkColor;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands[\"settablebackground\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getSelectedArr(this).length > 1 ? 0 : -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, value) {\n\t\t\t\t\tvar cells, ut;\n\t\t\t\t\tcells = getSelectedArr(this);\n\t\t\t\t\tut = getUETable(cells[0]);\n\t\t\t\t\tut.setBackground(cells, value);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands[\"cleartablebackground\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar cells = getSelectedArr(this);\n\t\t\t\t\tif (!cells.length) return -1;\n\t\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\t\tif (cell.style.backgroundColor !== \"\") return 0;\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar cells = getSelectedArr(this),\n\t\t\t\t\t\tut = getUETable(cells[0]);\n\t\t\t\t\tut.removeBackground(cells);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.commands[\"interlacetable\"] = UE.commands[\"uninterlacetable\"] = {\n\t\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (!table) return -1;\n\t\t\t\t\tvar interlaced = table.getAttribute(\"interlaced\");\n\t\t\t\t\tif (cmd == \"interlacetable\") {\n\t\t\t\t\t\t//TODO 待定\n\t\t\t\t\t\t//是否需要待定，如果设置，则命令只能单次执行成功，但反射具备toggle效果；否则可以覆盖前次命令，但反射将不存在toggle效果\n\t\t\t\t\t\treturn (interlaced === \"enabled\") ? -1 : 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn (!interlaced || interlaced === \"disabled\") ? -1 : 0;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, classList) {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (cmd == \"interlacetable\") {\n\t\t\t\t\t\ttable.setAttribute(\"interlaced\", \"enabled\");\n\t\t\t\t\t\tthis.fireEvent(\"interlacetable\", table, classList);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttable.setAttribute(\"interlaced\", \"disabled\");\n\t\t\t\t\t\tthis.fireEvent(\"uninterlacetable\", table);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tUE.commands[\"setbordervisible\"] = {\n\t\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (!table) return -1;\n\t\t\t\t\treturn 0;\n\t\t\t\t},\n\t\t\t\texecCommand: function() {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(table, 'td'), function(td) {\n\t\t\t\t\t\ttd.style.borderWidth = '1px';\n\t\t\t\t\t\ttd.style.borderStyle = 'solid';\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tfunction resetTdWidth(table, editor) {\n\t\t\t\tvar tds = domUtils.getElementsByTagName(table, 'td th');\n\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\ttd.removeAttribute(\"width\");\n\t\t\t\t});\n\t\t\t\ttable.setAttribute('width', getTableWidth(editor, true, getDefaultValue(editor, table)));\n\t\t\t\tvar tdsWidths = [];\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t\t(td.colSpan == 1) && tdsWidths.push(td.offsetWidth)\n\t\t\t\t\t})\n\t\t\t\t\tutils.each(tds, function(td, i) {\n\t\t\t\t\t\t(td.colSpan == 1) && td.setAttribute(\"width\", tdsWidths[i] + \"\");\n\t\t\t\t\t})\n\t\t\t\t}, 0);\n\t\t\t}\n\t\n\t\t\tfunction getTableWidth(editor, needIEHack, defaultValue) {\n\t\t\t\tvar body = editor.body;\n\t\t\t\treturn body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (editor.options.offsetWidth || 0);\n\t\t\t}\n\t\n\t\t\tfunction getSelectedArr(editor) {\n\t\t\t\tvar cell = getTableItemsByRange(editor).cell;\n\t\t\t\tif (cell) {\n\t\t\t\t\tvar ut = getUETable(cell);\n\t\t\t\t\treturn ut.selectedTds.length ? ut.selectedTds : [cell];\n\t\t\t\t} else {\n\t\t\t\t\treturn [];\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\t\n\t\t// plugins/table.action.js\n\t\t/**\n\t\t * Created with JetBrains PhpStorm.\n\t\t * User: taoqili\n\t\t * Date: 12-10-12\n\t\t * Time: 上午10:05\n\t\t * To change this template use File | Settings | File Templates.\n\t\t */\n\t\tUE.plugins['table'] = function() {\n\t\t\tvar me = this,\n\t\t\t\ttabTimer = null,\n\t\t\t\t//拖动计时器\n\t\t\t\ttableDragTimer = null,\n\t\t\t\t//双击计时器\n\t\t\t\ttableResizeTimer = null,\n\t\t\t\t//单元格最小宽度\n\t\t\t\tcellMinWidth = 5,\n\t\t\t\tisInResizeBuffer = false,\n\t\t\t\t//单元格边框大小\n\t\t\t\tcellBorderWidth = 5,\n\t\t\t\t//鼠标偏移距离\n\t\t\t\toffsetOfTableCell = 10,\n\t\t\t\t//记录在有限时间内的点击状态， 共有3个取值， 0, 1, 2。 0代表未初始化， 1代表单击了1次，2代表2次\n\t\t\t\tsingleClickState = 0,\n\t\t\t\tuserActionStatus = null,\n\t\t\t\t//双击允许的时间范围\n\t\t\t\tdblclickTime = 360,\n\t\t\t\tUT = UE.UETable,\n\t\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t\t},\n\t\t\t\tgetUETableBySelected = function(editor) {\n\t\t\t\t\treturn UT.getUETableBySelected(editor);\n\t\t\t\t},\n\t\t\t\tgetDefaultValue = function(editor, table) {\n\t\t\t\t\treturn UT.getDefaultValue(editor, table);\n\t\t\t\t},\n\t\t\t\tremoveSelectedClass = function(cells) {\n\t\t\t\t\treturn UT.removeSelectedClass(cells);\n\t\t\t\t};\n\t\n\t\t\tfunction showError(e) {\n\t\t\t\t//        throw e;\n\t\t\t}\n\t\t\tme.ready(function() {\n\t\t\t\tvar me = this;\n\t\t\t\tvar orgGetText = me.selection.getText;\n\t\t\t\tme.selection.getText = function() {\n\t\t\t\t\tvar table = getUETableBySelected(me);\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tvar str = '';\n\t\t\t\t\t\tutils.each(table.selectedTds, function(td) {\n\t\t\t\t\t\t\tstr += td[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\t\t\t})\n\t\t\t\t\t\treturn str;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn orgGetText.call(me.selection)\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t})\n\t\n\t\t\t//处理拖动及框选相关方法\n\t\t\tvar startTd = null, //鼠标按下时的锚点td\n\t\t\t\tcurrentTd = null, //当前鼠标经过时的td\n\t\t\t\tonDrag = \"\", //指示当前拖动状态，其值可为\"\",\"h\",\"v\" ,分别表示未拖动状态，横向拖动状态，纵向拖动状态，用于鼠标移动过程中的判断\n\t\t\t\tonBorder = false, //检测鼠标按下时是否处在单元格边缘位置\n\t\t\t\tdragButton = null,\n\t\t\t\tdragOver = false,\n\t\t\t\tdragLine = null, //模拟的拖动线\n\t\t\t\tdragTd = null; //发生拖动的目标td\n\t\n\t\t\tvar mousedown = false,\n\t\t\t\t//todo 判断混乱模式\n\t\t\t\tneedIEHack = true;\n\t\n\t\t\tme.setOpt({\n\t\t\t\t'maxColNum': 20,\n\t\t\t\t'maxRowNum': 100,\n\t\t\t\t'defaultCols': 5,\n\t\t\t\t'defaultRows': 5,\n\t\t\t\t'tdvalign': 'top',\n\t\t\t\t'cursorpath': me.options.UEDITOR_HOME_URL + \"themes/default/images/cursor_\",\n\t\t\t\t'tableDragable': false,\n\t\t\t\t'classList': [\"ue-table-interlace-color-single\", \"ue-table-interlace-color-double\"]\n\t\t\t});\n\t\t\tme.getUETable = getUETable;\n\t\t\tvar commands = {\n\t\t\t\t'deletetable': 1,\n\t\t\t\t'inserttable': 1,\n\t\t\t\t'cellvalign': 1,\n\t\t\t\t'insertcaption': 1,\n\t\t\t\t'deletecaption': 1,\n\t\t\t\t'inserttitle': 1,\n\t\t\t\t'deletetitle': 1,\n\t\t\t\t\"mergeright\": 1,\n\t\t\t\t\"mergedown\": 1,\n\t\t\t\t\"mergecells\": 1,\n\t\t\t\t\"insertrow\": 1,\n\t\t\t\t\"insertrownext\": 1,\n\t\t\t\t\"deleterow\": 1,\n\t\t\t\t\"insertcol\": 1,\n\t\t\t\t\"insertcolnext\": 1,\n\t\t\t\t\"deletecol\": 1,\n\t\t\t\t\"splittocells\": 1,\n\t\t\t\t\"splittorows\": 1,\n\t\t\t\t\"splittocols\": 1,\n\t\t\t\t\"adaptbytext\": 1,\n\t\t\t\t\"adaptbywindow\": 1,\n\t\t\t\t\"adaptbycustomer\": 1,\n\t\t\t\t\"insertparagraph\": 1,\n\t\t\t\t\"insertparagraphbeforetable\": 1,\n\t\t\t\t\"averagedistributecol\": 1,\n\t\t\t\t\"averagedistributerow\": 1\n\t\t\t};\n\t\t\tme.ready(function() {\n\t\t\t\tutils.cssRule('table',\n\t\t\t\t\t//选中的td上的样式\n\t\t\t\t\t'.selectTdClass{background-color:#edf5fa !important}' +\n\t\t\t\t\t'table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}' +\n\t\t\t\t\t//插入的表格的默认样式\n\t\t\t\t\t'table{margin-bottom:10px;border-collapse:collapse;display:table;}' +\n\t\t\t\t\t'td,th{padding: 5px 10px;border: 1px solid #DDD;}' +\n\t\t\t\t\t'caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}' +\n\t\t\t\t\t'th{border-top:1px solid #BBB;background-color:#F7F7F7;}' +\n\t\t\t\t\t'table tr.firstRow th{border-top-width:2px;}' +\n\t\t\t\t\t'.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }' +\n\t\t\t\t\t'td p{margin:0;padding:0;}', me.document);\n\t\n\t\t\t\tvar tableCopyList, isFullCol, isFullRow;\n\t\t\t\t//注册del/backspace事件\n\t\t\t\tme.addListener('keydown', function(cmd, evt) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\n\t\t\t\t\tif (keyCode == 8) {\n\t\n\t\t\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\n\t\t\t\t\t\t\tif (ut.isFullCol()) {\n\t\t\t\t\t\t\t\tme.execCommand('deletecol')\n\t\t\t\t\t\t\t} else if (ut.isFullRow()) {\n\t\t\t\t\t\t\t\tme.execCommand('deleterow')\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tme.fireEvent('delcells');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tvar caption = domUtils.findParentByTagName(me.selection.getStart(), 'caption', true),\n\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\tif (range.collapsed && caption && isEmptyBlock(caption)) {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tvar table = caption.parentNode;\n\t\t\t\t\t\t\tdomUtils.remove(caption);\n\t\t\t\t\t\t\tif (table) {\n\t\t\t\t\t\t\t\trange.setStart(table.rows[0].cells[0], 0).setCursor(false, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif (keyCode == 46) {\n\t\n\t\t\t\t\t\tut = getUETableBySelected(me);\n\t\t\t\t\t\tif (ut) {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = ut.selectedTds[i++];) {\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, ci)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\tif (keyCode == 13) {\n\t\n\t\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\t\tcaption = domUtils.findParentByTagName(rng.startContainer, 'caption', true);\n\t\t\t\t\t\tif (caption) {\n\t\t\t\t\t\t\tvar table = domUtils.findParentByTagName(caption, 'table');\n\t\t\t\t\t\t\tif (!rng.collapsed) {\n\t\n\t\t\t\t\t\t\t\trng.deleteContents();\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (caption) {\n\t\t\t\t\t\t\t\t\trng.setStart(table.rows[0].cells[0], 0).setCursor(false, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\t\tvar table = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\t\t\t\tif (table) {\n\t\t\t\t\t\t\t\tvar cell = table.rows[0].cells[0],\n\t\t\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(me.selection.getStart(), ['td', 'th'], true),\n\t\t\t\t\t\t\t\t\tpreNode = table.previousSibling;\n\t\t\t\t\t\t\t\tif (cell === start && (!preNode || preNode.nodeType == 1 && preNode.tagName == 'TABLE') && domUtils.isStartInblock(rng)) {\n\t\t\t\t\t\t\t\t\tvar first = domUtils.findParent(me.selection.getStart(), function(n) {\n\t\t\t\t\t\t\t\t\t\treturn domUtils.isBlockElm(n)\n\t\t\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\t\t\tif (first && (/t(h|d)/i.test(first.tagName) || first === start.firstChild)) {\n\t\t\t\t\t\t\t\t\t\tme.execCommand('insertparagraphbeforetable');\n\t\t\t\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tif ((evt.ctrlKey || evt.metaKey) && evt.keyCode == '67') {\n\t\t\t\t\t\ttableCopyList = null;\n\t\t\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\t\t\tif (ut) {\n\t\t\t\t\t\t\tvar tds = ut.selectedTds;\n\t\t\t\t\t\t\tisFullCol = ut.isFullCol();\n\t\t\t\t\t\t\tisFullRow = ut.isFullRow();\n\t\t\t\t\t\t\ttableCopyList = [\n\t\t\t\t\t\t\t\t[ut.cloneCell(tds[0], null, true)]\n\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\tfor (var i = 1, ci; ci = tds[i]; i++) {\n\t\t\t\t\t\t\t\tif (ci.parentNode !== tds[i - 1].parentNode) {\n\t\t\t\t\t\t\t\t\ttableCopyList.push([ut.cloneCell(ci, null, true)]);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttableCopyList[tableCopyList.length - 1].push(ut.cloneCell(ci, null, true));\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tme.addListener(\"tablehasdeleted\", function() {\n\t\t\t\t\ttoggleDraggableState(this, false, \"\", null);\n\t\t\t\t\tif (dragButton) domUtils.remove(dragButton);\n\t\t\t\t});\n\t\n\t\t\t\tme.addListener('beforepaste', function(cmd, html) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tif (domUtils.findParentByTagName(rng.startContainer, 'caption', true)) {\n\t\t\t\t\t\tvar div = me.document.createElement(\"div\");\n\t\t\t\t\t\tdiv.innerHTML = html.html;\n\t\t\t\t\t\t//trace:3729\n\t\t\t\t\t\thtml.html = div[browser.ie9below ? 'innerText' : 'textContent'];\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar table = getUETableBySelected(me);\n\t\t\t\t\tif (tableCopyList) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\t\tvar td = domUtils.findParentByTagName(rng.startContainer, ['td', 'th'], true),\n\t\t\t\t\t\t\ttmpNode, preNode;\n\t\t\t\t\t\tif (td) {\n\t\t\t\t\t\t\tvar ut = getUETable(td);\n\t\t\t\t\t\t\tif (isFullRow) {\n\t\t\t\t\t\t\t\tvar rowIndex = ut.getCellInfo(td).rowIndex;\n\t\t\t\t\t\t\t\tif (td.tagName == 'TH') {\n\t\t\t\t\t\t\t\t\trowIndex++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\t\t\tvar tr = ut.insertRow(rowIndex++, \"td\");\n\t\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j]; j++) {\n\t\t\t\t\t\t\t\t\t\tvar cell = tr.cells[j];\n\t\t\t\t\t\t\t\t\t\tif (!cell) {\n\t\t\t\t\t\t\t\t\t\t\tcell = tr.insertCell(j)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcell.innerHTML = cj.innerHTML;\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('width') && cell.setAttribute('width', cj.getAttribute('width'));\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('vAlign') && cell.setAttribute('vAlign', cj.getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('align') && cell.setAttribute('align', cj.getAttribute('align'));\n\t\t\t\t\t\t\t\t\t\tcj.style.cssText && (cell.style.cssText = cj.style.cssText)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = tr.cells[j]; j++) {\n\t\t\t\t\t\t\t\t\t\tif (!ci[j])\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\tcj.innerHTML = ci[j].innerHTML;\n\t\t\t\t\t\t\t\t\t\tci[j].getAttribute('width') && cj.setAttribute('width', ci[j].getAttribute('width'));\n\t\t\t\t\t\t\t\t\t\tci[j].getAttribute('vAlign') && cj.setAttribute('vAlign', ci[j].getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\t\tci[j].getAttribute('align') && cj.setAttribute('align', ci[j].getAttribute('align'));\n\t\t\t\t\t\t\t\t\t\tci[j].style.cssText && (cj.style.cssText = ci[j].style.cssText)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (isFullCol) {\n\t\t\t\t\t\t\t\t\tcellInfo = ut.getCellInfo(td);\n\t\t\t\t\t\t\t\t\tvar maxColNum = 0;\n\t\t\t\t\t\t\t\t\tfor (var j = 0, ci = tableCopyList[0], cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\t\t\tmaxColNum += cj.colSpan || 1;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t\t\t\tfor (i = 0; i < maxColNum; i++) {\n\t\t\t\t\t\t\t\t\t\tme.execCommand('insertcol');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t\t\t\ttd = ut.table.rows[0].cells[cellInfo.cellIndex];\n\t\t\t\t\t\t\t\t\tif (td.tagName == 'TH') {\n\t\t\t\t\t\t\t\t\t\ttd = ut.table.rows[1].cells[cellInfo.cellIndex];\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\t\t\ttmpNode = td;\n\t\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\t\t\tif (td) {\n\t\t\t\t\t\t\t\t\t\t\ttd.innerHTML = cj.innerHTML;\n\t\t\t\t\t\t\t\t\t\t\t//todo 定制处理\n\t\t\t\t\t\t\t\t\t\t\tcj.getAttribute('width') && td.setAttribute('width', cj.getAttribute('width'));\n\t\t\t\t\t\t\t\t\t\t\tcj.getAttribute('vAlign') && td.setAttribute('vAlign', cj.getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\t\t\tcj.getAttribute('align') && td.setAttribute('align', cj.getAttribute('align'));\n\t\t\t\t\t\t\t\t\t\t\tcj.style.cssText && (td.style.cssText = cj.style.cssText);\n\t\t\t\t\t\t\t\t\t\t\tpreNode = td;\n\t\t\t\t\t\t\t\t\t\t\ttd = td.nextSibling;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tvar cloneTd = cj.cloneNode(true);\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(cloneTd, ['class', 'rowSpan', 'colSpan']);\n\t\n\t\t\t\t\t\t\t\t\t\t\tpreNode.parentNode.appendChild(cloneTd)\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttd = ut.getNextCell(tmpNode, true, true);\n\t\t\t\t\t\t\t\t\tif (!tableCopyList[i])\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tif (!td) {\n\t\t\t\t\t\t\t\t\t\tvar cellInfo = ut.getCellInfo(tmpNode);\n\t\t\t\t\t\t\t\t\t\tut.table.insertRow(ut.table.rows.length);\n\t\t\t\t\t\t\t\t\t\tut.update();\n\t\t\t\t\t\t\t\t\t\ttd = ut.getVSideCell(tmpNode, true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tut.update();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttable = me.document.createElement('table');\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\t\tvar tr = table.insertRow(table.rows.length);\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\t\tcloneTd = UT.cloneCell(cj, null, true);\n\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(cloneTd, ['class']);\n\t\t\t\t\t\t\t\t\ttr.appendChild(cloneTd)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (j == 2 && cloneTd.rowSpan > 1) {\n\t\t\t\t\t\t\t\t\tcloneTd.rowSpan = 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tvar defaultValue = getDefaultValue(me),\n\t\t\t\t\t\t\t\twidth = me.body.offsetWidth -\n\t\t\t\t\t\t\t\t(needIEHack ? parseInt(domUtils.getComputedStyle(me.body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (me.options.offsetWidth || 0);\n\t\t\t\t\t\t\tme.execCommand('insertHTML', '<table  ' +\n\t\t\t\t\t\t\t\t(isFullCol && isFullRow ? 'width=\"' + width + '\"' : '') +\n\t\t\t\t\t\t\t\t'>' + table.innerHTML.replace(/>\\s*</g, '><').replace(/\\bth\\b/gi, \"td\") + '</table>')\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\thtml.html = '';\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar div = me.document.createElement(\"div\"),\n\t\t\t\t\t\t\ttables;\n\t\t\t\t\t\tdiv.innerHTML = html.html;\n\t\t\t\t\t\ttables = div.getElementsByTagName(\"table\");\n\t\t\t\t\t\tif (domUtils.findParentByTagName(me.selection.getStart(), 'table')) {\n\t\t\t\t\t\t\tutils.each(tables, function(t) {\n\t\t\t\t\t\t\t\tdomUtils.remove(t)\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (domUtils.findParentByTagName(me.selection.getStart(), 'caption', true)) {\n\t\t\t\t\t\t\t\tdiv.innerHTML = div[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tutils.each(tables, function(table) {\n\t\t\t\t\t\t\t\tremoveStyleSize(table, true);\n\t\t\t\t\t\t\t\tdomUtils.removeAttributes(table, ['style', 'border']);\n\t\t\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(table, \"td\"), function(td) {\n\t\t\t\t\t\t\t\t\tif (isEmptyBlock(td)) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, td);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tremoveStyleSize(td, true);\n\t\t\t\t\t\t\t\t\t//                            domUtils.removeAttributes(td, ['style'])\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\thtml.html = div.innerHTML;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\tme.addListener('afterpaste', function() {\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(me.body, \"table\"), function(table) {\n\t\t\t\t\t\tif (table.offsetWidth > me.body.offsetWidth) {\n\t\t\t\t\t\t\tvar defaultValue = getDefaultValue(me, table);\n\t\t\t\t\t\t\ttable.style.width = me.body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(me.body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (me.options.offsetWidth || 0) + 'px'\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t\tme.addListener('blur', function() {\n\t\t\t\t\ttableCopyList = null;\n\t\t\t\t});\n\t\t\t\tvar timer;\n\t\t\t\tme.addListener('keydown', function() {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\t\tcell = domUtils.findParentByTagName(rng.startContainer, ['th', 'td'], true);\n\t\t\t\t\t\tif (cell) {\n\t\t\t\t\t\t\tvar table = cell.parentNode.parentNode.parentNode;\n\t\t\t\t\t\t\tif (table.offsetWidth > table.getAttribute(\"width\")) {\n\t\t\t\t\t\t\t\tcell.style.wordBreak = \"break-all\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\t\t\t\tme.addListener(\"selectionchange\", function() {\n\t\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t\t});\n\t\n\t\t\t\t//内容变化时触发索引更新\n\t\t\t\t//todo 可否考虑标记检测，如果不涉及表格的变化就不进行索引重建和更新\n\t\t\t\tme.addListener(\"contentchange\", function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\t//尽可能排除一些不需要更新的状况\n\t\t\t\t\thideDragLine(me);\n\t\t\t\t\tif (getUETableBySelected(me)) return;\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tvar start = rng.startContainer;\n\t\t\t\t\tstart = domUtils.findParentByTagName(start, ['td', 'th'], true);\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(me.document, 'table'), function(table) {\n\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\t\ttable.ueTable = new UT(table);\n\t\t\t\t\t\t//trace:3742\n\t\t\t\t\t\t//                utils.each(domUtils.getElementsByTagName(me.document, 'td'), function (td) {\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//                    if (domUtils.isEmptyBlock(td) && td !== start) {\n\t\t\t\t\t\t//                        domUtils.fillNode(me.document, td);\n\t\t\t\t\t\t//                        if (browser.ie && browser.version == 6) {\n\t\t\t\t\t\t//                            td.innerHTML = '&nbsp;'\n\t\t\t\t\t\t//                        }\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t//                });\n\t\t\t\t\t\t//                utils.each(domUtils.getElementsByTagName(me.document, 'th'), function (th) {\n\t\t\t\t\t\t//                    if (domUtils.isEmptyBlock(th) && th !== start) {\n\t\t\t\t\t\t//                        domUtils.fillNode(me.document, th);\n\t\t\t\t\t\t//                        if (browser.ie && browser.version == 6) {\n\t\t\t\t\t\t//                            th.innerHTML = '&nbsp;'\n\t\t\t\t\t\t//                        }\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t//                });\n\t\t\t\t\t\ttable.onmouseover = function() {\n\t\t\t\t\t\t\tme.fireEvent('tablemouseover', table);\n\t\t\t\t\t\t};\n\t\t\t\t\t\ttable.onmousemove = function() {\n\t\t\t\t\t\t\tme.fireEvent('tablemousemove', table);\n\t\t\t\t\t\t\tme.options.tableDragable && toggleDragButton(true, this, me);\n\t\t\t\t\t\t\tutils.defer(function() {\n\t\t\t\t\t\t\t\tme.fireEvent('contentchange', 50)\n\t\t\t\t\t\t\t}, true)\n\t\t\t\t\t\t};\n\t\t\t\t\t\ttable.onmouseout = function() {\n\t\t\t\t\t\t\tme.fireEvent('tablemouseout', table);\n\t\t\t\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t\t\t\t\thideDragLine(me);\n\t\t\t\t\t\t};\n\t\t\t\t\t\ttable.onclick = function(evt) {\n\t\t\t\t\t\t\tevt = me.window.event || evt;\n\t\t\t\t\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement);\n\t\t\t\t\t\t\tif (!target) return;\n\t\t\t\t\t\t\tvar ut = getUETable(target),\n\t\t\t\t\t\t\t\ttable = ut.table,\n\t\t\t\t\t\t\t\tcellInfo = ut.getCellInfo(target),\n\t\t\t\t\t\t\t\tcellsRange,\n\t\t\t\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\t\t\t//                    if (\"topLeft\" == inPosition(table, mouseCoords(evt))) {\n\t\t\t\t\t\t\t//                        cellsRange = ut.getCellsRange(ut.table.rows[0].cells[0], ut.getLastCell());\n\t\t\t\t\t\t\t//                        ut.setSelected(cellsRange);\n\t\t\t\t\t\t\t//                        return;\n\t\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t\t//                    if (\"bottomRight\" == inPosition(table, mouseCoords(evt))) {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t//                        return;\n\t\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t\tif (inTableSide(table, target, evt, true)) {\n\t\t\t\t\t\t\t\tvar endTdCol = ut.getCell(ut.indexTable[ut.rowsNum - 1][cellInfo.colIndex].rowIndex, ut.indexTable[ut.rowsNum - 1][cellInfo.colIndex].cellIndex);\n\t\t\t\t\t\t\t\tif (evt.shiftKey && ut.selectedTds.length) {\n\t\t\t\t\t\t\t\t\tif (ut.selectedTds[0] !== endTdCol) {\n\t\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(ut.selectedTds[0], endTdCol);\n\t\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdCol).select();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (target !== endTdCol) {\n\t\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(target, endTdCol);\n\t\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdCol).select();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (inTableSide(table, target, evt)) {\n\t\t\t\t\t\t\t\tvar endTdRow = ut.getCell(ut.indexTable[cellInfo.rowIndex][ut.colsNum - 1].rowIndex, ut.indexTable[cellInfo.rowIndex][ut.colsNum - 1].cellIndex);\n\t\t\t\t\t\t\t\tif (evt.shiftKey && ut.selectedTds.length) {\n\t\t\t\t\t\t\t\t\tif (ut.selectedTds[0] !== endTdRow) {\n\t\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(ut.selectedTds[0], endTdRow);\n\t\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdRow).select();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (target !== endTdRow) {\n\t\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(target, endTdRow);\n\t\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdRow).select();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\n\t\t\t\t\tswitchBorderColor(me, true);\n\t\t\t\t});\n\t\n\t\t\t\tdomUtils.on(me.document, \"mousemove\", mouseMoveEvent);\n\t\n\t\t\t\tdomUtils.on(me.document, \"mouseout\", function(evt) {\n\t\t\t\t\tvar target = evt.target || evt.srcElement;\n\t\t\t\t\tif (target.tagName == \"TABLE\") {\n\t\t\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t/**\n\t\t\t\t * 表格隔行变色\n\t\t\t\t */\n\t\t\t\tme.addListener(\"interlacetable\", function(type, table, classList) {\n\t\t\t\t\tif (!table) return;\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trows = table.rows,\n\t\t\t\t\t\tlen = rows.length,\n\t\t\t\t\t\tgetClass = function(list, index, repeat) {\n\t\t\t\t\t\t\treturn list[index] ? list[index] : repeat ? list[index % list.length] : \"\";\n\t\t\t\t\t\t};\n\t\t\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t\t\trows[i].className = getClass(classList || me.options.classList, i, true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tme.addListener(\"uninterlacetable\", function(type, table) {\n\t\t\t\t\tif (!table) return;\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trows = table.rows,\n\t\t\t\t\t\tclassList = me.options.classList,\n\t\t\t\t\t\tlen = rows.length;\n\t\t\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t\t\tdomUtils.removeClasses(rows[i], classList);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\tme.addListener(\"mousedown\", mouseDownEvent);\n\t\t\t\tme.addListener(\"mouseup\", mouseUpEvent);\n\t\t\t\t//拖动的时候触发mouseup\n\t\t\t\tdomUtils.on(me.body, 'dragstart', function(evt) {\n\t\t\t\t\tmouseUpEvent.call(me, 'dragstart', evt);\n\t\t\t\t});\n\t\t\t\tme.addOutputRule(function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('div'), function(n) {\n\t\t\t\t\t\tif (n.getAttr('id') == 'ue_tableDragLine') {\n\t\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\n\t\t\t\tvar currentRowIndex = 0;\n\t\t\t\tme.addListener(\"mousedown\", function() {\n\t\t\t\t\tcurrentRowIndex = 0;\n\t\t\t\t});\n\t\t\t\tme.addListener('tabkeydown', function() {\n\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\tcommon = range.getCommonAncestor(true, true),\n\t\t\t\t\t\ttable = domUtils.findParentByTagName(common, 'table');\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tif (domUtils.findParentByTagName(common, 'caption', true)) {\n\t\t\t\t\t\t\tvar cell = domUtils.getElementsByTagName(table, 'th td');\n\t\t\t\t\t\t\tif (cell && cell.length) {\n\t\t\t\t\t\t\t\trange.setStart(cell[0], 0).setCursor(false, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar cell = domUtils.findParentByTagName(common, ['td', 'th'], true),\n\t\t\t\t\t\t\t\tua = getUETable(cell);\n\t\t\t\t\t\t\tcurrentRowIndex = cell.rowSpan > 1 ? currentRowIndex : ua.getCellInfo(cell).rowIndex;\n\t\t\t\t\t\t\tvar nextCell = ua.getTabNextCell(cell, currentRowIndex);\n\t\t\t\t\t\t\tif (nextCell) {\n\t\t\t\t\t\t\t\tif (isEmptyBlock(nextCell)) {\n\t\t\t\t\t\t\t\t\trange.setStart(nextCell, 0).setCursor(false, true)\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.selectNodeContents(nextCell).select()\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t\t\tthis.execCommand('insertrownext');\n\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\t\t\t\t\trange.setStart(table.rows[table.rows.length - 1].cells[0], 0).setCursor();\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t\tbrowser.ie && me.addListener('selectionchange', function() {\n\t\t\t\t\ttoggleDraggableState(this, false, \"\", null);\n\t\t\t\t});\n\t\t\t\tme.addListener(\"keydown\", function(type, evt) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\t//处理在表格的最后一个输入tab产生新的表格\n\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\t\tif (keyCode == 8 || keyCode == 46) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar notCtrlKey = !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey;\n\t\t\t\t\tnotCtrlKey && removeSelectedClass(domUtils.getElementsByTagName(me.body, \"td\"));\n\t\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\t\tif (!ut) return;\n\t\t\t\t\tnotCtrlKey && ut.clearSelected();\n\t\t\t\t});\n\t\n\t\t\t\tme.addListener(\"beforegetcontent\", function() {\n\t\t\t\t\tswitchBorderColor(this, false);\n\t\t\t\t\tbrowser.ie && utils.each(this.document.getElementsByTagName('caption'), function(ci) {\n\t\t\t\t\t\tif (domUtils.isEmptyNode(ci)) {\n\t\t\t\t\t\t\tci.innerHTML = '&nbsp;'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tme.addListener(\"aftergetcontent\", function() {\n\t\t\t\t\tswitchBorderColor(this, true);\n\t\t\t\t});\n\t\t\t\tme.addListener(\"getAllHtml\", function() {\n\t\t\t\t\tremoveSelectedClass(me.document.getElementsByTagName(\"td\"));\n\t\t\t\t});\n\t\t\t\t//修正全屏状态下插入的表格宽度在非全屏状态下撑开编辑器的情况\n\t\t\t\tme.addListener(\"fullscreenchanged\", function(type, fullscreen) {\n\t\t\t\t\tif (!fullscreen) {\n\t\t\t\t\t\tvar ratio = this.body.offsetWidth / document.body.offsetWidth,\n\t\t\t\t\t\t\ttables = domUtils.getElementsByTagName(this.body, \"table\");\n\t\t\t\t\t\tutils.each(tables, function(table) {\n\t\t\t\t\t\t\tif (table.offsetWidth < me.body.offsetWidth) return false;\n\t\t\t\t\t\t\tvar tds = domUtils.getElementsByTagName(table, \"td\"),\n\t\t\t\t\t\t\t\tbackWidths = [];\n\t\t\t\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t\t\t\tbackWidths.push(td.offsetWidth);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfor (var i = 0, td; td = tds[i]; i++) {\n\t\t\t\t\t\t\t\ttd.setAttribute(\"width\", Math.floor(backWidths[i] * ratio));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttable.setAttribute(\"width\", Math.floor(getTableWidth(me, needIEHack, getDefaultValue(me))))\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\t//重写execCommand命令，用于处理框选时的处理\n\t\t\t\tvar oldExecCommand = me.execCommand;\n\t\t\t\tme.execCommand = function(cmd, datatat) {\n\t\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\targs = arguments;\n\t\n\t\t\t\t\tcmd = cmd.toLowerCase();\n\t\t\t\t\tvar ut = getUETableBySelected(me),\n\t\t\t\t\t\ttds,\n\t\t\t\t\t\trange = new dom.Range(me.document),\n\t\t\t\t\t\tcmdFun = me.commands[cmd] || UE.commands[cmd],\n\t\t\t\t\t\tresult;\n\t\t\t\t\tif (!cmdFun) return;\n\t\t\t\t\tif (ut && !commands[cmd] && !cmdFun.notNeedUndo && !me.__hasEnterExecCommand) {\n\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\tme.fireEvent(\"beforeexeccommand\", cmd);\n\t\t\t\t\t\ttds = ut.selectedTds;\n\t\t\t\t\t\tvar lastState = -2,\n\t\t\t\t\t\t\tlastValue = -2,\n\t\t\t\t\t\t\tvalue, state;\n\t\t\t\t\t\tfor (var i = 0, td; td = tds[i]; i++) {\n\t\t\t\t\t\t\tif (isEmptyBlock(td)) {\n\t\t\t\t\t\t\t\trange.setStart(td, 0).setCursor(false, true)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.selectNode(td).select(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstate = me.queryCommandState(cmd);\n\t\t\t\t\t\t\tvalue = me.queryCommandValue(cmd);\n\t\t\t\t\t\t\tif (state != -1) {\n\t\t\t\t\t\t\t\tif (lastState !== state || lastValue !== value) {\n\t\t\t\t\t\t\t\t\tme._ignoreContentChange = true;\n\t\t\t\t\t\t\t\t\tresult = oldExecCommand.apply(me, arguments);\n\t\t\t\t\t\t\t\t\tme._ignoreContentChange = false;\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tlastState = me.queryCommandState(cmd);\n\t\t\t\t\t\t\t\tlastValue = me.queryCommandValue(cmd);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(td)) {\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, td)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setStart(tds[0], 0).shrinkBoundary(true).setCursor(false, true);\n\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\tme.fireEvent(\"afterexeccommand\", cmd);\n\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\tme._selectionChange();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = oldExecCommand.apply(me, arguments);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\t\n\t\t\t});\n\t\t\t/**\n\t\t\t * 删除obj的宽高style，改成属性宽高\n\t\t\t * @param obj\n\t\t\t * @param replaceToProperty\n\t\t\t */\n\t\t\tfunction removeStyleSize(obj, replaceToProperty) {\n\t\t\t\tremoveStyle(obj, \"width\", true);\n\t\t\t\tremoveStyle(obj, \"height\", true);\n\t\t\t}\n\t\n\t\t\tfunction removeStyle(obj, styleName, replaceToProperty) {\n\t\t\t\tif (obj.style[styleName]) {\n\t\t\t\t\treplaceToProperty && obj.setAttribute(styleName, parseInt(obj.style[styleName], 10));\n\t\t\t\t\tobj.style[styleName] = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction getParentTdOrTh(ele) {\n\t\t\t\tif (ele.tagName == \"TD\" || ele.tagName == \"TH\") return ele;\n\t\t\t\tvar td;\n\t\t\t\tif (td = domUtils.findParentByTagName(ele, \"td\", true) || domUtils.findParentByTagName(ele, \"th\", true)) return td;\n\t\t\t\treturn null;\n\t\t\t}\n\t\n\t\t\tfunction isEmptyBlock(node) {\n\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(/^\\s*$/, '').replace(reg, '').length > 0) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tfor (var n in dtd.$isNotEmpty) {\n\t\t\t\t\tif (node.getElementsByTagName(n).length) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn 1;\n\t\t\t}\n\t\n\t\t\tfunction mouseCoords(evt) {\n\t\t\t\tif (evt.pageX || evt.pageY) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tx: evt.pageX,\n\t\t\t\t\t\ty: evt.pageY\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tx: evt.clientX + me.document.body.scrollLeft - me.document.body.clientLeft,\n\t\t\t\t\ty: evt.clientY + me.document.body.scrollTop - me.document.body.clientTop\n\t\t\t\t};\n\t\t\t}\n\t\n\t\t\tfunction mouseMoveEvent(evt) {\n\t\n\t\t\t\tif (isEditorDisabled()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\ttry {\n\t\n\t\t\t\t\t//普通状态下鼠标移动\n\t\t\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement),\n\t\t\t\t\t\tpos;\n\t\n\t\t\t\t\t//区分用户的行为是拖动还是双击\n\t\t\t\t\tif (isInResizeBuffer) {\n\t\n\t\t\t\t\t\tme.body.style.webkitUserSelect = 'none';\n\t\n\t\t\t\t\t\tif (Math.abs(userActionStatus.x - evt.clientX) > offsetOfTableCell || Math.abs(userActionStatus.y - evt.clientY) > offsetOfTableCell) {\n\t\t\t\t\t\t\tclearTableDragTimer();\n\t\t\t\t\t\t\tisInResizeBuffer = false;\n\t\t\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\t\t\t//drag action\n\t\t\t\t\t\t\ttableBorderDrag(evt);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//修改单元格大小时的鼠标移动\n\t\t\t\t\tif (onDrag && dragTd) {\n\t\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\t\tme.body.style.webkitUserSelect = 'none';\n\t\t\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t\t\t\tpos = mouseCoords(evt);\n\t\t\t\t\t\ttoggleDraggableState(me, true, onDrag, pos, target);\n\t\t\t\t\t\tif (onDrag == \"h\") {\n\t\t\t\t\t\t\tdragLine.style.left = getPermissionX(dragTd, evt) + \"px\";\n\t\t\t\t\t\t} else if (onDrag == \"v\") {\n\t\t\t\t\t\t\tdragLine.style.top = getPermissionY(dragTd, evt) + \"px\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//当鼠标处于table上时，修改移动过程中的光标状态\n\t\t\t\t\tif (target) {\n\t\t\t\t\t\t//针对使用table作为容器的组件不触发拖拽效果\n\t\t\t\t\t\tif (me.fireEvent('excludetable', target) === true)\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\tpos = mouseCoords(evt);\n\t\t\t\t\t\tvar state = getRelation(target, pos),\n\t\t\t\t\t\t\ttable = domUtils.findParentByTagName(target, \"table\", true);\n\t\n\t\t\t\t\t\tif (inTableSide(table, target, evt, true)) {\n\t\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\t\t\tme.body.style.cursor = \"url(\" + me.options.cursorpath + \"h.png),pointer\";\n\t\t\t\t\t\t} else if (inTableSide(table, target, evt)) {\n\t\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\t\t\tme.body.style.cursor = \"url(\" + me.options.cursorpath + \"v.png),pointer\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.body.style.cursor = \"text\";\n\t\t\t\t\t\t\tvar curCell = target;\n\t\t\t\t\t\t\tif (/\\d/.test(state)) {\n\t\t\t\t\t\t\t\tstate = state.replace(/\\d/, '');\n\t\t\t\t\t\t\t\ttarget = getUETable(target).getPreviewCell(target, state == \"v\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//位于第一行的顶部或者第一列的左边时不可拖动\n\t\t\t\t\t\t\ttoggleDraggableState(me, target ? !!state : false, target ? state : '', pos, target);\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoggleDragButton(false, table, me);\n\t\t\t\t\t}\n\t\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tvar dragButtonTimer;\n\t\n\t\t\tfunction toggleDragButton(show, table, editor) {\n\t\t\t\tif (!show) {\n\t\t\t\t\tif (dragOver) return;\n\t\t\t\t\tdragButtonTimer = setTimeout(function() {\n\t\t\t\t\t\t!dragOver && dragButton && dragButton.parentNode && dragButton.parentNode.removeChild(dragButton);\n\t\t\t\t\t}, 2000);\n\t\t\t\t} else {\n\t\t\t\t\tcreateDragButton(table, editor);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction createDragButton(table, editor) {\n\t\t\t\tvar pos = domUtils.getXY(table),\n\t\t\t\t\tdoc = table.ownerDocument;\n\t\t\t\tif (dragButton && dragButton.parentNode) return dragButton;\n\t\t\t\tdragButton = doc.createElement(\"div\");\n\t\t\t\tdragButton.contentEditable = false;\n\t\t\t\tdragButton.innerHTML = \"\";\n\t\t\t\tdragButton.style.cssText = \"width:15px;height:15px;background-image:url(\" + editor.options.UEDITOR_HOME_URL + \"dialogs/table/dragicon.png);position: absolute;cursor:move;top:\" + (pos.y - 15) + \"px;left:\" + (pos.x) + \"px;\";\n\t\t\t\tdomUtils.unSelectable(dragButton);\n\t\t\t\tdragButton.onmouseover = function(evt) {\n\t\t\t\t\tdragOver = true;\n\t\t\t\t};\n\t\t\t\tdragButton.onmouseout = function(evt) {\n\t\t\t\t\tdragOver = false;\n\t\t\t\t};\n\t\t\t\tdomUtils.on(dragButton, 'click', function(type, evt) {\n\t\t\t\t\tdoClick(evt, this);\n\t\t\t\t});\n\t\t\t\tdomUtils.on(dragButton, 'dblclick', function(type, evt) {\n\t\t\t\t\tdoDblClick(evt);\n\t\t\t\t});\n\t\t\t\tdomUtils.on(dragButton, 'dragstart', function(type, evt) {\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t});\n\t\t\t\tvar timer;\n\t\n\t\t\t\tfunction doClick(evt, button) {\n\t\t\t\t\t// 部分浏览器下需要清理\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\teditor.fireEvent(\"tableClicked\", table, button);\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\n\t\t\t\tfunction doDblClick(evt) {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\tvar ut = getUETable(table),\n\t\t\t\t\t\tstart = table.rows[0].cells[0],\n\t\t\t\t\t\tend = ut.getLastCell(),\n\t\t\t\t\t\trange = ut.getCellsRange(start, end);\n\t\t\t\t\teditor.selection.getRange().setStart(start, 0).setCursor(false, true);\n\t\t\t\t\tut.setSelected(range);\n\t\t\t\t}\n\t\n\t\t\t\tdoc.body.appendChild(dragButton);\n\t\t\t}\n\t\n\t\t\t//    function inPosition(table, pos) {\n\t\t\t//        var tablePos = domUtils.getXY(table),\n\t\t\t//            width = table.offsetWidth,\n\t\t\t//            height = table.offsetHeight;\n\t\t\t//        if (pos.x - tablePos.x < 5 && pos.y - tablePos.y < 5) {\n\t\t\t//            return \"topLeft\";\n\t\t\t//        } else if (tablePos.x + width - pos.x < 5 && tablePos.y + height - pos.y < 5) {\n\t\t\t//            return \"bottomRight\";\n\t\t\t//        }\n\t\t\t//    }\n\t\n\t\t\tfunction inTableSide(table, cell, evt, top) {\n\t\t\t\tvar pos = mouseCoords(evt),\n\t\t\t\t\tstate = getRelation(cell, pos);\n\t\n\t\t\t\tif (top) {\n\t\t\t\t\tvar caption = table.getElementsByTagName(\"caption\")[0],\n\t\t\t\t\t\tcapHeight = caption ? caption.offsetHeight : 0;\n\t\t\t\t\treturn (state == \"v1\") && ((pos.y - domUtils.getXY(table).y - capHeight) < 8);\n\t\t\t\t} else {\n\t\t\t\t\treturn (state == \"h1\") && ((pos.x - domUtils.getXY(table).x) < 8);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获取拖动时允许的X轴坐标\n\t\t\t * @param dragTd\n\t\t\t * @param evt\n\t\t\t */\n\t\t\tfunction getPermissionX(dragTd, evt) {\n\t\t\t\tvar ut = getUETable(dragTd);\n\t\t\t\tif (ut) {\n\t\t\t\t\tvar preTd = ut.getSameEndPosCells(dragTd, \"x\")[0],\n\t\t\t\t\t\tnextTd = ut.getSameStartPosXCells(dragTd)[0],\n\t\t\t\t\t\tmouseX = mouseCoords(evt).x,\n\t\t\t\t\t\tleft = (preTd ? domUtils.getXY(preTd).x : domUtils.getXY(ut.table).x) + 20,\n\t\t\t\t\t\tright = nextTd ? domUtils.getXY(nextTd).x + nextTd.offsetWidth - 20 : (me.body.offsetWidth + 5 || parseInt(domUtils.getComputedStyle(me.body, \"width\"), 10));\n\t\n\t\t\t\t\tleft += cellMinWidth;\n\t\t\t\t\tright -= cellMinWidth;\n\t\n\t\t\t\t\treturn mouseX < left ? left : mouseX > right ? right : mouseX;\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获取拖动时允许的Y轴坐标\n\t\t\t */\n\t\t\tfunction getPermissionY(dragTd, evt) {\n\t\t\t\ttry {\n\t\t\t\t\tvar top = domUtils.getXY(dragTd).y,\n\t\t\t\t\t\tmousePosY = mouseCoords(evt).y;\n\t\t\t\t\treturn mousePosY < top ? top : mousePosY;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 移动状态切换\n\t\t\t */\n\t\t\tfunction toggleDraggableState(editor, draggable, dir, mousePos, cell) {\n\t\t\t\ttry {\n\t\t\t\t\teditor.body.style.cursor = dir == \"h\" ? \"col-resize\" : dir == \"v\" ? \"row-resize\" : \"text\";\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\tif (dir && !mousedown && !getUETableBySelected(editor)) {\n\t\t\t\t\t\t\tgetDragLine(editor, editor.document);\n\t\t\t\t\t\t\tshowDragLineAt(dir, cell);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thideDragLine(editor)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tonBorder = draggable;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获取与UETable相关的resize line\n\t\t\t * @param uetable UETable对象\n\t\t\t */\n\t\t\tfunction getResizeLineByUETable() {\n\t\n\t\t\t\tvar lineId = '_UETableResizeLine',\n\t\t\t\t\tline = this.document.getElementById(lineId);\n\t\n\t\t\t\tif (!line) {\n\t\t\t\t\tline = this.document.createElement(\"div\");\n\t\t\t\t\tline.id = lineId;\n\t\t\t\t\tline.contnetEditable = false;\n\t\t\t\t\tline.setAttribute(\"unselectable\", \"on\");\n\t\n\t\t\t\t\tvar styles = {\n\t\t\t\t\t\twidth: 2 * cellBorderWidth + 1 + 'px',\n\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t'z-index': 100000,\n\t\t\t\t\t\tcursor: 'col-resize',\n\t\t\t\t\t\tbackground: 'red',\n\t\t\t\t\t\tdisplay: 'none'\n\t\t\t\t\t};\n\t\n\t\t\t\t\t//切换状态\n\t\t\t\t\tline.onmouseout = function() {\n\t\t\t\t\t\tthis.style.display = 'none';\n\t\t\t\t\t};\n\t\n\t\t\t\t\tutils.extend(line.style, styles);\n\t\n\t\t\t\t\tthis.document.body.appendChild(line);\n\t\n\t\t\t\t}\n\t\n\t\t\t\treturn line;\n\t\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 更新resize-line\n\t\t\t */\n\t\t\tfunction updateResizeLine(cell, uetable) {\n\t\n\t\t\t\tvar line = getResizeLineByUETable.call(this),\n\t\t\t\t\ttable = uetable.table,\n\t\t\t\t\tstyles = {\n\t\t\t\t\t\ttop: domUtils.getXY(table).y + 'px',\n\t\t\t\t\t\tleft: domUtils.getXY(cell).x + cell.offsetWidth - cellBorderWidth + 'px',\n\t\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\t\theight: table.offsetHeight + 'px'\n\t\t\t\t\t};\n\t\n\t\t\t\tutils.extend(line.style, styles);\n\t\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 显示resize-line\n\t\t\t */\n\t\t\tfunction showResizeLine(cell) {\n\t\n\t\t\t\tvar uetable = getUETable(cell);\n\t\n\t\t\t\tupdateResizeLine.call(this, cell, uetable);\n\t\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获取鼠标与当前单元格的相对位置\n\t\t\t * @param ele\n\t\t\t * @param mousePos\n\t\t\t */\n\t\t\tfunction getRelation(ele, mousePos) {\n\t\t\t\tvar elePos = domUtils.getXY(ele);\n\t\n\t\t\t\tif (!elePos) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\n\t\t\t\tif (elePos.x + ele.offsetWidth - mousePos.x < cellBorderWidth) {\n\t\t\t\t\treturn \"h\";\n\t\t\t\t}\n\t\t\t\tif (mousePos.x - elePos.x < cellBorderWidth) {\n\t\t\t\t\treturn 'h1'\n\t\t\t\t}\n\t\t\t\tif (elePos.y + ele.offsetHeight - mousePos.y < cellBorderWidth) {\n\t\t\t\t\treturn \"v\";\n\t\t\t\t}\n\t\t\t\tif (mousePos.y - elePos.y < cellBorderWidth) {\n\t\t\t\t\treturn 'v1'\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t}\n\t\n\t\t\tfunction mouseDownEvent(type, evt) {\n\t\n\t\t\t\tif (isEditorDisabled()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tuserActionStatus = {\n\t\t\t\t\tx: evt.clientX,\n\t\t\t\t\ty: evt.clientY\n\t\t\t\t};\n\t\n\t\t\t\t//右键菜单单独处理\n\t\t\t\tif (evt.button == 2) {\n\t\t\t\t\tvar ut = getUETableBySelected(me),\n\t\t\t\t\t\tflag = false;\n\t\n\t\t\t\t\tif (ut) {\n\t\t\t\t\t\tvar td = getTargetTd(me, evt);\n\t\t\t\t\t\tutils.each(ut.selectedTds, function(ti) {\n\t\t\t\t\t\t\tif (ti === td) {\n\t\t\t\t\t\t\t\tflag = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (!flag) {\n\t\t\t\t\t\t\tremoveSelectedClass(domUtils.getElementsByTagName(me.body, \"th td\"));\n\t\t\t\t\t\t\tut.clearSelected()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttd = ut.selectedTds[0];\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tme.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t\t\t\t\t}, 0);\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttableClickHander(evt);\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\t//清除表格的计时器\n\t\t\tfunction clearTableTimer() {\n\t\t\t\ttabTimer && clearTimeout(tabTimer);\n\t\t\t\ttabTimer = null;\n\t\t\t}\n\t\n\t\t\t//双击收缩\n\t\t\tfunction tableDbclickHandler(evt) {\n\t\t\t\tsingleClickState = 0;\n\t\t\t\tevt = evt || me.window.event;\n\t\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement);\n\t\t\t\tif (target) {\n\t\t\t\t\tvar h;\n\t\t\t\t\tif (h = getRelation(target, mouseCoords(evt))) {\n\t\n\t\t\t\t\t\thideDragLine(me);\n\t\n\t\t\t\t\t\tif (h == 'h1') {\n\t\t\t\t\t\t\th = 'h';\n\t\t\t\t\t\t\tif (inTableSide(domUtils.findParentByTagName(target, \"table\"), target, evt)) {\n\t\t\t\t\t\t\t\tme.execCommand('adaptbywindow');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttarget = getUETable(target).getPreviewCell(target);\n\t\t\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\t\t\t\t\trng.selectNodeContents(target).setCursor(true, true)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (h == 'h') {\n\t\t\t\t\t\t\tvar ut = getUETable(target),\n\t\t\t\t\t\t\t\ttable = ut.table,\n\t\t\t\t\t\t\t\tcells = getCellsByMoveBorder(target, table, true);\n\t\n\t\t\t\t\t\t\tcells = extractArray(cells, 'left');\n\t\n\t\t\t\t\t\t\tut.width = ut.offsetWidth;\n\t\n\t\t\t\t\t\t\tvar oldWidth = [],\n\t\t\t\t\t\t\t\tnewWidth = [];\n\t\n\t\t\t\t\t\t\tutils.each(cells, function(cell) {\n\t\n\t\t\t\t\t\t\t\toldWidth.push(cell.offsetWidth);\n\t\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\tutils.each(cells, function(cell) {\n\t\n\t\t\t\t\t\t\t\tcell.removeAttribute(\"width\");\n\t\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\twindow.setTimeout(function() {\n\t\n\t\t\t\t\t\t\t\t//是否允许改变\n\t\t\t\t\t\t\t\tvar changeable = true;\n\t\n\t\t\t\t\t\t\t\tutils.each(cells, function(cell, index) {\n\t\n\t\t\t\t\t\t\t\t\tvar width = cell.offsetWidth;\n\t\n\t\t\t\t\t\t\t\t\tif (width > oldWidth[index]) {\n\t\t\t\t\t\t\t\t\t\tchangeable = false;\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\tnewWidth.push(width);\n\t\n\t\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\t\tvar change = changeable ? newWidth : oldWidth;\n\t\n\t\t\t\t\t\t\t\tutils.each(cells, function(cell, index) {\n\t\n\t\t\t\t\t\t\t\t\tcell.width = change[index] - getTabcellSpace();\n\t\n\t\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\t}, 0);\n\t\n\t\t\t\t\t\t\t//                    minWidth -= cellMinWidth;\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t//                    table.removeAttribute(\"width\");\n\t\t\t\t\t\t\t//                    utils.each(cells, function (cell) {\n\t\t\t\t\t\t\t//                        cell.style.width = \"\";\n\t\t\t\t\t\t\t//                        cell.width -= minWidth;\n\t\t\t\t\t\t\t//                    });\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction tableClickHander(evt) {\n\t\n\t\t\t\tremoveSelectedClass(domUtils.getElementsByTagName(me.body, \"td th\"));\n\t\t\t\t//trace:3113\n\t\t\t\t//选中单元格，点击table外部，不会清掉table上挂的ueTable,会引起getUETableBySelected方法返回值\n\t\t\t\tutils.each(me.document.getElementsByTagName('table'), function(t) {\n\t\t\t\t\tt.ueTable = null;\n\t\t\t\t});\n\t\t\t\tstartTd = getTargetTd(me, evt);\n\t\t\t\tif (!startTd) return;\n\t\t\t\tvar table = domUtils.findParentByTagName(startTd, \"table\", true);\n\t\t\t\tut = getUETable(table);\n\t\t\t\tut && ut.clearSelected();\n\t\n\t\t\t\t//判断当前鼠标状态\n\t\t\t\tif (!onBorder) {\n\t\t\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t\t\tmousedown = true;\n\t\t\t\t\tme.addListener('mouseover', mouseOverEvent);\n\t\t\t\t} else {\n\t\t\t\t\t//边框上的动作处理\n\t\t\t\t\tborderActionHandler(evt);\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\t//处理表格边框上的动作, 这里做延时处理，避免两种动作互相影响\n\t\t\tfunction borderActionHandler(evt) {\n\t\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tevt = reconstruct(evt);\n\t\t\t\t}\n\t\n\t\t\t\tclearTableDragTimer();\n\t\n\t\t\t\t//是否正在等待resize的缓冲中\n\t\t\t\tisInResizeBuffer = true;\n\t\n\t\t\t\ttableDragTimer = setTimeout(function() {\n\t\t\t\t\ttableBorderDrag(evt);\n\t\t\t\t}, dblclickTime);\n\t\n\t\t\t}\n\t\n\t\t\tfunction extractArray(originArr, key) {\n\t\n\t\t\t\tvar result = [],\n\t\t\t\t\ttmp = null;\n\t\n\t\t\t\tfor (var i = 0, len = originArr.length; i < len; i++) {\n\t\n\t\t\t\t\ttmp = originArr[i][key];\n\t\n\t\t\t\t\tif (tmp) {\n\t\t\t\t\t\tresult.push(tmp);\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\treturn result;\n\t\n\t\t\t}\n\t\n\t\t\tfunction clearTableDragTimer() {\n\t\t\t\ttableDragTimer && clearTimeout(tableDragTimer);\n\t\t\t\ttableDragTimer = null;\n\t\t\t}\n\t\n\t\t\tfunction reconstruct(obj) {\n\t\n\t\t\t\tvar attrs = ['pageX', 'pageY', 'clientX', 'clientY', 'srcElement', 'target'],\n\t\t\t\t\tnewObj = {};\n\t\n\t\t\t\tif (obj) {\n\t\n\t\t\t\t\tfor (var i = 0, key, val; key = attrs[i]; i++) {\n\t\t\t\t\t\tval = obj[key];\n\t\t\t\t\t\tval && (newObj[key] = val);\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\treturn newObj;\n\t\n\t\t\t}\n\t\n\t\t\t//边框拖动\n\t\t\tfunction tableBorderDrag(evt) {\n\t\n\t\t\t\tisInResizeBuffer = false;\n\t\n\t\t\t\tstartTd = evt.target || evt.srcElement;\n\t\t\t\tif (!startTd) return;\n\t\t\t\tvar state = getRelation(startTd, mouseCoords(evt));\n\t\t\t\tif (/\\d/.test(state)) {\n\t\t\t\t\tstate = state.replace(/\\d/, '');\n\t\t\t\t\tstartTd = getUETable(startTd).getPreviewCell(startTd, state == 'v');\n\t\t\t\t}\n\t\t\t\thideDragLine(me);\n\t\t\t\tgetDragLine(me, me.document);\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\tshowDragLineAt(state, startTd);\n\t\t\t\tmousedown = true;\n\t\t\t\t//拖动开始\n\t\t\t\tonDrag = state;\n\t\t\t\tdragTd = startTd;\n\t\t\t}\n\t\n\t\t\tfunction mouseUpEvent(type, evt) {\n\t\n\t\t\t\tif (isEditorDisabled()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tclearTableDragTimer();\n\t\n\t\t\t\tisInResizeBuffer = false;\n\t\n\t\t\t\tif (onBorder) {\n\t\t\t\t\tsingleClickState = ++singleClickState % 3;\n\t\n\t\t\t\t\tuserActionStatus = {\n\t\t\t\t\t\tx: evt.clientX,\n\t\t\t\t\t\ty: evt.clientY\n\t\t\t\t\t};\n\t\n\t\t\t\t\ttableResizeTimer = setTimeout(function() {\n\t\t\t\t\t\tsingleClickState > 0 && singleClickState--;\n\t\t\t\t\t}, dblclickTime);\n\t\n\t\t\t\t\tif (singleClickState === 2) {\n\t\n\t\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\t\ttableDbclickHandler(evt);\n\t\t\t\t\t\treturn;\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\tif (evt.button == 2) return;\n\t\t\t\tvar me = this;\n\t\t\t\t//清除表格上原生跨选问题\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'table', true),\n\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, 'table', true);\n\t\n\t\t\t\tif (start || end) {\n\t\t\t\t\tif (start === end) {\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, ['td', 'th', 'caption'], true);\n\t\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, ['td', 'th', 'caption'], true);\n\t\t\t\t\t\tif (start !== end) {\n\t\t\t\t\t\t\tme.selection.clearRange()\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.selection.clearRange()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmousedown = false;\n\t\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t\t//拖拽状态下的mouseUP\n\t\t\t\tif (onDrag && dragTd) {\n\t\n\t\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\n\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\tdragLine = me.document.getElementById('ue_tableDragLine');\n\t\n\t\t\t\t\t// trace 3973\n\t\t\t\t\tif (dragLine) {\n\t\t\t\t\t\tvar dragTdPos = domUtils.getXY(dragTd),\n\t\t\t\t\t\t\tdragLinePos = domUtils.getXY(dragLine);\n\t\n\t\t\t\t\t\tswitch (onDrag) {\n\t\t\t\t\t\t\tcase \"h\":\n\t\t\t\t\t\t\t\tchangeColWidth(dragTd, dragLinePos.x - dragTdPos.x);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"v\":\n\t\t\t\t\t\t\t\tchangeRowHeight(dragTd, dragLinePos.y - dragTdPos.y - dragTd.offsetHeight);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t}\n\t\t\t\t\t\tonDrag = \"\";\n\t\t\t\t\t\tdragTd = null;\n\t\n\t\t\t\t\t\thideDragLine(me);\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//正常状态下的mouseup\n\t\t\t\tif (!startTd) {\n\t\t\t\t\tvar target = domUtils.findParentByTagName(evt.target || evt.srcElement, \"td\", true);\n\t\t\t\t\tif (!target) target = domUtils.findParentByTagName(evt.target || evt.srcElement, \"th\", true);\n\t\t\t\t\tif (target && (target.tagName == \"TD\" || target.tagName == \"TH\")) {\n\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", target) === true) return;\n\t\t\t\t\t\trange = new dom.Range(me.document);\n\t\t\t\t\t\trange.setStart(target, 0).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar ut = getUETable(startTd),\n\t\t\t\t\t\tcell = ut ? ut.selectedTds[0] : null;\n\t\t\t\t\tif (cell) {\n\t\t\t\t\t\trange = new dom.Range(me.document);\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(cell)) {\n\t\t\t\t\t\t\trange.setStart(cell, 0).setCursor(false, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.selectNodeContents(cell).shrinkBoundary().setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\trange = me.selection.getRange().shrinkBoundary();\n\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\tvar start = domUtils.findParentByTagName(range.startContainer, ['td', 'th'], true),\n\t\t\t\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, ['td', 'th'], true);\n\t\t\t\t\t\t\t//在table里边的不能清除\n\t\t\t\t\t\t\tif (start && !end || !start && end || start && end && start !== end) {\n\t\t\t\t\t\t\t\trange.setCursor(false, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstartTd = null;\n\t\t\t\t\tme.removeListener('mouseover', mouseOverEvent);\n\t\t\t\t}\n\t\t\t\tme._selectionChange(250, evt);\n\t\t\t}\n\t\n\t\t\tfunction mouseOverEvent(type, evt) {\n\t\n\t\t\t\tif (isEditorDisabled()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tvar me = this,\n\t\t\t\t\ttar = evt.target || evt.srcElement;\n\t\t\t\tcurrentTd = domUtils.findParentByTagName(tar, \"td\", true) || domUtils.findParentByTagName(tar, \"th\", true);\n\t\t\t\t//需要判断两个TD是否位于同一个表格内\n\t\t\t\tif (startTd && currentTd &&\n\t\t\t\t\t((startTd.tagName == \"TD\" && currentTd.tagName == \"TD\") || (startTd.tagName == \"TH\" && currentTd.tagName == \"TH\")) &&\n\t\t\t\t\tdomUtils.findParentByTagName(startTd, 'table') == domUtils.findParentByTagName(currentTd, 'table')) {\n\t\t\t\t\tvar ut = getUETable(currentTd);\n\t\t\t\t\tif (startTd != currentTd) {\n\t\t\t\t\t\tme.document.body.style.webkitUserSelect = 'none';\n\t\t\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t\t\t\tvar range = ut.getCellsRange(startTd, currentTd);\n\t\t\t\t\t\tut.setSelected(range);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t\t\t\tut.clearSelected();\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t}\n\t\n\t\t\tfunction setCellHeight(cell, height, backHeight) {\n\t\t\t\tvar lineHight = parseInt(domUtils.getComputedStyle(cell, \"line-height\"), 10),\n\t\t\t\t\ttmpHeight = backHeight + height;\n\t\t\t\theight = tmpHeight < lineHight ? lineHight : tmpHeight;\n\t\t\t\tif (cell.style.height) cell.style.height = \"\";\n\t\t\t\tcell.rowSpan == 1 ? cell.setAttribute(\"height\", height) : (cell.removeAttribute && cell.removeAttribute(\"height\"));\n\t\t\t}\n\t\n\t\t\tfunction getWidth(cell) {\n\t\t\t\tif (!cell) return 0;\n\t\t\t\treturn parseInt(domUtils.getComputedStyle(cell, \"width\"), 10);\n\t\t\t}\n\t\n\t\t\tfunction changeColWidth(cell, changeValue) {\n\t\n\t\t\t\tvar ut = getUETable(cell);\n\t\t\t\tif (ut) {\n\t\n\t\t\t\t\t//根据当前移动的边框获取相关的单元格\n\t\t\t\t\tvar table = ut.table,\n\t\t\t\t\t\tcells = getCellsByMoveBorder(cell, table);\n\t\n\t\t\t\t\ttable.style.width = \"\";\n\t\t\t\t\ttable.removeAttribute(\"width\");\n\t\n\t\t\t\t\t//修正改变量\n\t\t\t\t\tchangeValue = correctChangeValue(changeValue, cell, cells);\n\t\n\t\t\t\t\tif (cell.nextSibling) {\n\t\n\t\t\t\t\t\tvar i = 0;\n\t\n\t\t\t\t\t\tutils.each(cells, function(cellGroup) {\n\t\n\t\t\t\t\t\t\tcellGroup.left.width = (+cellGroup.left.width) + changeValue;\n\t\t\t\t\t\t\tcellGroup.right && (cellGroup.right.width = (+cellGroup.right.width) - changeValue);\n\t\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\tutils.each(cells, function(cellGroup) {\n\t\t\t\t\t\t\tcellGroup.left.width -= -changeValue;\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tfunction isEditorDisabled() {\n\t\t\t\treturn me.body.contentEditable === \"false\";\n\t\t\t}\n\t\n\t\t\tfunction changeRowHeight(td, changeValue) {\n\t\t\t\tif (Math.abs(changeValue) < 10) return;\n\t\t\t\tvar ut = getUETable(td);\n\t\t\t\tif (ut) {\n\t\t\t\t\tvar cells = ut.getSameEndPosCells(td, \"y\"),\n\t\t\t\t\t\t//备份需要连带变化的td的原始高度，否则后期无法获取正确的值\n\t\t\t\t\t\tbackHeight = cells[0] ? cells[0].offsetHeight : 0;\n\t\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\t\tsetCellHeight(cell, changeValue, backHeight);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获取调整单元格大小的相关单元格\n\t\t\t * @isContainMergeCell 返回的结果中是否包含发生合并后的单元格\n\t\t\t */\n\t\t\tfunction getCellsByMoveBorder(cell, table, isContainMergeCell) {\n\t\n\t\t\t\tif (!table) {\n\t\t\t\t\ttable = domUtils.findParentByTagName(cell, 'table');\n\t\t\t\t}\n\t\n\t\t\t\tif (!table) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\n\t\t\t\t//获取到该单元格所在行的序列号\n\t\t\t\tvar index = domUtils.getNodeIndex(cell),\n\t\t\t\t\ttemp = cell,\n\t\t\t\t\trows = table.rows,\n\t\t\t\t\tcolIndex = 0;\n\t\n\t\t\t\twhile (temp) {\n\t\t\t\t\t//获取到当前单元格在未发生单元格合并时的序列\n\t\t\t\t\tif (temp.nodeType === 1) {\n\t\t\t\t\t\tcolIndex += (temp.colSpan || 1);\n\t\t\t\t\t}\n\t\t\t\t\ttemp = temp.previousSibling;\n\t\t\t\t}\n\t\n\t\t\t\ttemp = null;\n\t\n\t\t\t\t//记录想关的单元格\n\t\t\t\tvar borderCells = [];\n\t\n\t\t\t\tutils.each(rows, function(tabRow) {\n\t\n\t\t\t\t\tvar cells = tabRow.cells,\n\t\t\t\t\t\tcurrIndex = 0;\n\t\n\t\t\t\t\tutils.each(cells, function(tabCell) {\n\t\n\t\t\t\t\t\tcurrIndex += (tabCell.colSpan || 1);\n\t\n\t\t\t\t\t\tif (currIndex === colIndex) {\n\t\n\t\t\t\t\t\t\tborderCells.push({\n\t\t\t\t\t\t\t\tleft: tabCell,\n\t\t\t\t\t\t\t\tright: tabCell.nextSibling || null\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\treturn false;\n\t\n\t\t\t\t\t\t} else if (currIndex > colIndex) {\n\t\n\t\t\t\t\t\t\tif (isContainMergeCell) {\n\t\t\t\t\t\t\t\tborderCells.push({\n\t\t\t\t\t\t\t\t\tleft: tabCell\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t});\n\t\n\t\t\t\t});\n\t\n\t\t\t\treturn borderCells;\n\t\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 通过给定的单元格集合获取最小的单元格width\n\t\t\t */\n\t\t\tfunction getMinWidthByTableCells(cells) {\n\t\n\t\t\t\tvar minWidth = Number.MAX_VALUE;\n\t\n\t\t\t\tfor (var i = 0, curCell; curCell = cells[i]; i++) {\n\t\n\t\t\t\t\tminWidth = Math.min(minWidth, curCell.width || getTableCellWidth(curCell));\n\t\n\t\t\t\t}\n\t\n\t\t\t\treturn minWidth;\n\t\n\t\t\t}\n\t\n\t\t\tfunction correctChangeValue(changeValue, relatedCell, cells) {\n\t\n\t\t\t\t//为单元格的paading预留空间\n\t\t\t\tchangeValue -= getTabcellSpace();\n\t\n\t\t\t\tif (changeValue < 0) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\n\t\t\t\tchangeValue -= getTableCellWidth(relatedCell);\n\t\n\t\t\t\t//确定方向\n\t\t\t\tvar direction = changeValue < 0 ? 'left' : 'right';\n\t\n\t\t\t\tchangeValue = Math.abs(changeValue);\n\t\n\t\t\t\t//只关心非最后一个单元格就可以\n\t\t\t\tutils.each(cells, function(cellGroup) {\n\t\n\t\t\t\t\tvar curCell = cellGroup[direction];\n\t\n\t\t\t\t\t//为单元格保留最小空间\n\t\t\t\t\tif (curCell) {\n\t\t\t\t\t\tchangeValue = Math.min(changeValue, getTableCellWidth(curCell) - cellMinWidth);\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\n\t\t\t\t//修正越界\n\t\t\t\tchangeValue = changeValue < 0 ? 0 : changeValue;\n\t\n\t\t\t\treturn direction === 'left' ? -changeValue : changeValue;\n\t\n\t\t\t}\n\t\n\t\t\tfunction getTableCellWidth(cell) {\n\t\n\t\t\t\tvar width = 0,\n\t\t\t\t\t//偏移纠正量\n\t\t\t\t\toffset = 0,\n\t\t\t\t\twidth = cell.offsetWidth - getTabcellSpace();\n\t\n\t\t\t\t//最后一个节点纠正一下\n\t\t\t\tif (!cell.nextSibling) {\n\t\n\t\t\t\t\twidth -= getTableCellOffset(cell);\n\t\n\t\t\t\t}\n\t\n\t\t\t\twidth = width < 0 ? 0 : width;\n\t\n\t\t\t\ttry {\n\t\t\t\t\tcell.width = width;\n\t\t\t\t} catch (e) {}\n\t\n\t\t\t\treturn width;\n\t\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获取单元格所在表格的最末单元格的偏移量\n\t\t\t */\n\t\t\tfunction getTableCellOffset(cell) {\n\t\n\t\t\t\ttab = domUtils.findParentByTagName(cell, \"table\", false);\n\t\n\t\t\t\tif (tab.offsetVal === undefined) {\n\t\n\t\t\t\t\tvar prev = cell.previousSibling;\n\t\n\t\t\t\t\tif (prev) {\n\t\n\t\t\t\t\t\t//最后一个单元格和前一个单元格的width diff结果 如果恰好为一个border width， 则条件成立\n\t\t\t\t\t\ttab.offsetVal = cell.offsetWidth - prev.offsetWidth === UT.borderWidth ? UT.borderWidth : 0;\n\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttab.offsetVal = 0;\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\treturn tab.offsetVal;\n\t\n\t\t\t}\n\t\n\t\t\tfunction getTabcellSpace() {\n\t\n\t\t\t\tif (UT.tabcellSpace === undefined) {\n\t\n\t\t\t\t\tvar cell = null,\n\t\t\t\t\t\ttab = me.document.createElement(\"table\"),\n\t\t\t\t\t\ttbody = me.document.createElement(\"tbody\"),\n\t\t\t\t\t\ttrow = me.document.createElement(\"tr\"),\n\t\t\t\t\t\ttabcell = me.document.createElement(\"td\"),\n\t\t\t\t\t\tmirror = null;\n\t\n\t\t\t\t\ttabcell.style.cssText = 'border: 0;';\n\t\t\t\t\ttabcell.width = 1;\n\t\n\t\t\t\t\ttrow.appendChild(tabcell);\n\t\t\t\t\ttrow.appendChild(mirror = tabcell.cloneNode(false));\n\t\n\t\t\t\t\ttbody.appendChild(trow);\n\t\n\t\t\t\t\ttab.appendChild(tbody);\n\t\n\t\t\t\t\ttab.style.cssText = \"visibility: hidden;\";\n\t\n\t\t\t\t\tme.body.appendChild(tab);\n\t\n\t\t\t\t\tUT.paddingSpace = tabcell.offsetWidth - 1;\n\t\n\t\t\t\t\tvar tmpTabWidth = tab.offsetWidth;\n\t\n\t\t\t\t\ttabcell.style.cssText = '';\n\t\t\t\t\tmirror.style.cssText = '';\n\t\n\t\t\t\t\tUT.borderWidth = (tab.offsetWidth - tmpTabWidth) / 3;\n\t\n\t\t\t\t\tUT.tabcellSpace = UT.paddingSpace + UT.borderWidth;\n\t\n\t\t\t\t\tme.body.removeChild(tab);\n\t\n\t\t\t\t}\n\t\n\t\t\t\tgetTabcellSpace = function() {\n\t\t\t\t\treturn UT.tabcellSpace;\n\t\t\t\t};\n\t\n\t\t\t\treturn UT.tabcellSpace;\n\t\n\t\t\t}\n\t\n\t\t\tfunction getDragLine(editor, doc) {\n\t\t\t\tif (mousedown) return;\n\t\t\t\tdragLine = editor.document.createElement(\"div\");\n\t\t\t\tdomUtils.setAttributes(dragLine, {\n\t\t\t\t\tid: \"ue_tableDragLine\",\n\t\t\t\t\tunselectable: 'on',\n\t\t\t\t\tcontenteditable: false,\n\t\t\t\t\t'onresizestart': 'return false',\n\t\t\t\t\t'ondragstart': 'return false',\n\t\t\t\t\t'onselectstart': 'return false',\n\t\t\t\t\tstyle: \"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)\"\n\t\t\t\t});\n\t\t\t\teditor.body.appendChild(dragLine);\n\t\t\t}\n\t\n\t\t\tfunction hideDragLine(editor) {\n\t\t\t\tif (mousedown) return;\n\t\t\t\tvar line;\n\t\t\t\twhile (line = editor.document.getElementById('ue_tableDragLine')) {\n\t\t\t\t\tdomUtils.remove(line)\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 依据state（v|h）在cell位置显示横线\n\t\t\t * @param state\n\t\t\t * @param cell\n\t\t\t */\n\t\t\tfunction showDragLineAt(state, cell) {\n\t\t\t\tif (!cell) return;\n\t\t\t\tvar table = domUtils.findParentByTagName(cell, \"table\"),\n\t\t\t\t\tcaption = table.getElementsByTagName('caption'),\n\t\t\t\t\twidth = table.offsetWidth,\n\t\t\t\t\theight = table.offsetHeight - (caption.length > 0 ? caption[0].offsetHeight : 0),\n\t\t\t\t\ttablePos = domUtils.getXY(table),\n\t\t\t\t\tcellPos = domUtils.getXY(cell),\n\t\t\t\t\tcss;\n\t\t\t\tswitch (state) {\n\t\t\t\t\tcase \"h\":\n\t\t\t\t\t\tcss = 'height:' + height + 'px;top:' + (tablePos.y + (caption.length > 0 ? caption[0].offsetHeight : 0)) + 'px;left:' + (cellPos.x + cell.offsetWidth);\n\t\t\t\t\t\tdragLine.style.cssText = css + 'px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"v\":\n\t\t\t\t\t\tcss = 'width:' + width + 'px;left:' + tablePos.x + 'px;top:' + (cellPos.y + cell.offsetHeight);\n\t\t\t\t\t\t//必须加上border:0和color:blue，否则低版ie不支持背景色显示\n\t\t\t\t\t\tdragLine.style.cssText = css + 'px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 当表格边框颜色为白色时设置为虚线,true为添加虚线\n\t\t\t * @param editor\n\t\t\t * @param flag\n\t\t\t */\n\t\t\tfunction switchBorderColor(editor, flag) {\n\t\t\t\tvar tableArr = domUtils.getElementsByTagName(editor.body, \"table\"),\n\t\t\t\t\tcolor;\n\t\t\t\tfor (var i = 0, node; node = tableArr[i++];) {\n\t\t\t\t\tvar td = domUtils.getElementsByTagName(node, \"td\");\n\t\t\t\t\tif (td[0]) {\n\t\t\t\t\t\tif (flag) {\n\t\t\t\t\t\t\tcolor = (td[0].style.borderColor).replace(/\\s/g, \"\");\n\t\t\t\t\t\t\tif (/(#ffffff)|(rgb\\(255,255,255\\))/ig.test(color))\n\t\t\t\t\t\t\t\tdomUtils.addClass(node, \"noBorderTable\")\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.removeClasses(node, \"noBorderTable\")\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction getTableWidth(editor, needIEHack, defaultValue) {\n\t\t\t\tvar body = editor.body;\n\t\t\t\treturn body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (editor.options.offsetWidth || 0);\n\t\t\t}\n\t\n\t\t\t/**\n\t\t\t * 获取当前拖动的单元格\n\t\t\t */\n\t\t\tfunction getTargetTd(editor, evt) {\n\t\n\t\t\t\tvar target = domUtils.findParentByTagName(evt.target || evt.srcElement, [\"td\", \"th\"], true),\n\t\t\t\t\tdir = null;\n\t\n\t\t\t\tif (!target) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\n\t\t\t\tdir = getRelation(target, mouseCoords(evt));\n\t\n\t\t\t\t//如果有前一个节点， 需要做一个修正， 否则可能会得到一个错误的td\n\t\n\t\t\t\tif (!target) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\n\t\t\t\tif (dir === 'h1' && target.previousSibling) {\n\t\n\t\t\t\t\tvar position = domUtils.getXY(target),\n\t\t\t\t\t\tcellWidth = target.offsetWidth;\n\t\n\t\t\t\t\tif (Math.abs(position.x + cellWidth - evt.clientX) > cellWidth / 3) {\n\t\t\t\t\t\ttarget = target.previousSibling;\n\t\t\t\t\t}\n\t\n\t\t\t\t} else if (dir === 'v1' && target.parentNode.previousSibling) {\n\t\n\t\t\t\t\tvar position = domUtils.getXY(target),\n\t\t\t\t\t\tcellHeight = target.offsetHeight;\n\t\n\t\t\t\t\tif (Math.abs(position.y + cellHeight - evt.clientY) > cellHeight / 3) {\n\t\t\t\t\t\ttarget = target.parentNode.previousSibling.firstChild;\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\t//排除了非td内部以及用于代码高亮部分的td\n\t\t\t\treturn target && !(editor.fireEvent(\"excludetable\", target) === true) ? target : null;\n\t\t\t}\n\t\n\t\t};\n\t\n\t\t// plugins/table.sort.js\n\t\t/**\n\t\t * Created with JetBrains PhpStorm.\n\t\t * User: Jinqn\n\t\t * Date: 13-10-12\n\t\t * Time: 上午10:20\n\t\t * To change this template use File | Settings | File Templates.\n\t\t */\n\t\n\t\tUE.UETable.prototype.sortTable = function(sortByCellIndex, compareFn) {\n\t\t\tvar table = this.table,\n\t\t\t\trows = table.rows,\n\t\t\t\ttrArray = [],\n\t\t\t\tflag = rows[0].cells[0].tagName === \"TH\",\n\t\t\t\tlastRowIndex = 0;\n\t\t\tif (this.selectedTds.length) {\n\t\t\t\tvar range = this.cellsRange,\n\t\t\t\t\tlen = range.endRowIndex + 1;\n\t\t\t\tfor (var i = range.beginRowIndex; i < len; i++) {\n\t\t\t\t\ttrArray[i] = rows[i];\n\t\t\t\t}\n\t\t\t\ttrArray.splice(0, range.beginRowIndex);\n\t\t\t\tlastRowIndex = (range.endRowIndex + 1) === this.rowsNum ? 0 : range.endRowIndex + 1;\n\t\t\t} else {\n\t\t\t\tfor (var i = 0, len = rows.length; i < len; i++) {\n\t\t\t\t\ttrArray[i] = rows[i];\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tvar Fn = {\n\t\t\t\t'reversecurrent': function(td1, td2) {\n\t\t\t\t\treturn 1;\n\t\t\t\t},\n\t\t\t\t'orderbyasc': function(td1, td2) {\n\t\t\t\t\tvar value1 = td1.innerText || td1.textContent,\n\t\t\t\t\t\tvalue2 = td2.innerText || td2.textContent;\n\t\t\t\t\treturn value1.localeCompare(value2);\n\t\t\t\t},\n\t\t\t\t'reversebyasc': function(td1, td2) {\n\t\t\t\t\tvar value1 = td1.innerHTML,\n\t\t\t\t\t\tvalue2 = td2.innerHTML;\n\t\t\t\t\treturn value2.localeCompare(value1);\n\t\t\t\t},\n\t\t\t\t'orderbynum': function(td1, td2) {\n\t\t\t\t\tvar value1 = td1[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/),\n\t\t\t\t\t\tvalue2 = td2[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/);\n\t\t\t\t\tif (value1) value1 = +value1[0];\n\t\t\t\t\tif (value2) value2 = +value2[0];\n\t\t\t\t\treturn (value1 || 0) - (value2 || 0);\n\t\t\t\t},\n\t\t\t\t'reversebynum': function(td1, td2) {\n\t\t\t\t\tvar value1 = td1[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/),\n\t\t\t\t\t\tvalue2 = td2[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/);\n\t\t\t\t\tif (value1) value1 = +value1[0];\n\t\t\t\t\tif (value2) value2 = +value2[0];\n\t\t\t\t\treturn (value2 || 0) - (value1 || 0);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\t//对表格设置排序的标记data-sort-type\n\t\t\ttable.setAttribute('data-sort-type', compareFn && typeof compareFn === \"string\" && Fn[compareFn] ? compareFn : '');\n\t\n\t\t\t//th不参与排序\n\t\t\tflag && trArray.splice(0, 1);\n\t\t\ttrArray = utils.sort(trArray, function(tr1, tr2) {\n\t\t\t\tvar result;\n\t\t\t\tif (compareFn && typeof compareFn === \"function\") {\n\t\t\t\t\tresult = compareFn.call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t\t} else if (compareFn && typeof compareFn === \"number\") {\n\t\t\t\t\tresult = 1;\n\t\t\t\t} else if (compareFn && typeof compareFn === \"string\" && Fn[compareFn]) {\n\t\t\t\t\tresult = Fn[compareFn].call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t\t} else {\n\t\t\t\t\tresult = Fn['orderbyasc'].call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t});\n\t\t\tvar fragment = table.ownerDocument.createDocumentFragment();\n\t\t\tfor (var j = 0, len = trArray.length; j < len; j++) {\n\t\t\t\tfragment.appendChild(trArray[j]);\n\t\t\t}\n\t\t\tvar tbody = table.getElementsByTagName(\"tbody\")[0];\n\t\t\tif (!lastRowIndex) {\n\t\t\t\ttbody.appendChild(fragment);\n\t\t\t} else {\n\t\t\t\ttbody.insertBefore(fragment, rows[lastRowIndex - range.endRowIndex + range.beginRowIndex - 1])\n\t\t\t}\n\t\t};\n\t\n\t\tUE.plugins['tablesort'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tUT = UE.UETable,\n\t\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t\t},\n\t\t\t\tgetTableItemsByRange = function(editor) {\n\t\t\t\t\treturn UT.getTableItemsByRange(editor);\n\t\t\t\t};\n\t\n\t\t\tme.ready(function() {\n\t\t\t\t//添加表格可排序的样式\n\t\t\t\tutils.cssRule('tablesort',\n\t\t\t\t\t'table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;' +\n\t\t\t\t\t'   background-image:url(' + me.options.themePath + me.options.theme + '/images/sortable.png);}',\n\t\t\t\t\tme.document);\n\t\n\t\t\t\t//做单元格合并操作时,清除可排序标识\n\t\t\t\tme.addListener(\"afterexeccommand\", function(type, cmd) {\n\t\t\t\t\tif (cmd == 'mergeright' || cmd == 'mergedown' || cmd == 'mergecells') {\n\t\t\t\t\t\tthis.execCommand('disablesort');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\n\t\t\t//表格排序\n\t\t\tUE.commands['sorttable'] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\ttableItems = getTableItemsByRange(me);\n\t\t\t\t\tif (!tableItems.cell) return -1;\n\t\t\t\t\tvar table = tableItems.table,\n\t\t\t\t\t\tcells = table.getElementsByTagName(\"td\");\n\t\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\t\tif (cell.rowSpan != 1 || cell.colSpan != 1) return -1;\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd, fn) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\t\tbk = range.createBookmark(true),\n\t\t\t\t\t\ttableItems = getTableItemsByRange(me),\n\t\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\t\tut = getUETable(tableItems.table),\n\t\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t\tut.sortTable(cellInfo.cellIndex, fn);\n\t\t\t\t\trange.moveToBookmark(bk);\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.select();\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\t//设置表格可排序,清除表格可排序\n\t\t\tUE.commands[\"enablesort\"] = UE.commands[\"disablesort\"] = {\n\t\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\tif (table && cmd == 'enablesort') {\n\t\t\t\t\t\tvar cells = domUtils.getElementsByTagName(table, 'th td');\n\t\t\t\t\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\t\t\t\t\tif (cells[i].getAttribute('colspan') > 1 || cells[i].getAttribute('rowspan') > 1) return -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn !table ? -1 : cmd == 'enablesort' ^ table.getAttribute('data-sort') != 'sortEnabled' ? -1 : 0;\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\t\ttable.setAttribute(\"data-sort\", cmd == \"enablesort\" ? \"sortEnabled\" : \"sortDisabled\");\n\t\t\t\t\tcmd == \"enablesort\" ? domUtils.addClass(table, \"sortEnabled\") : domUtils.removeClasses(table, \"sortEnabled\");\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/contextmenu.js\n\t\t///import core\n\t\t///commands 右键菜单\n\t\t///commandsName  ContextMenu\n\t\t///commandsTitle  右键菜单\n\t\t/**\n\t\t * 右键菜单\n\t\t * @function\n\t\t * @name baidu.editor.plugins.contextmenu\n\t\t * @author zhanyi\n\t\t */\n\t\n\t\tUE.plugins['contextmenu'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt('enableContextMenu', true);\n\t\t\tif (me.getOpt('enableContextMenu') === false) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar lang = me.getLang(\"contextMenu\"),\n\t\t\t\tmenu,\n\t\t\t\titems = me.options.contextMenu || [{\n\t\t\t\t\t\tlabel: lang['selectall'],\n\t\t\t\t\t\tcmdName: 'selectall'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.cleardoc,\n\t\t\t\t\t\tcmdName: 'cleardoc',\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tif (confirm(lang.confirmclear)) {\n\t\t\t\t\t\t\t\tthis.execCommand('cleardoc');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t'-', {\n\t\t\t\t\t\tlabel: lang.unlink,\n\t\t\t\t\t\tcmdName: 'unlink'\n\t\t\t\t\t},\n\t\t\t\t\t'-', {\n\t\t\t\t\t\tgroup: lang.paragraph,\n\t\t\t\t\t\ticon: 'justifyjustify',\n\t\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tlabel: lang.justifyleft,\n\t\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\t\tvalue: 'left'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.justifyright,\n\t\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\t\tvalue: 'right'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.justifycenter,\n\t\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\t\tvalue: 'center'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.justifyjustify,\n\t\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\t\tvalue: 'justify'\n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\t'-', {\n\t\t\t\t\t\tgroup: lang.table,\n\t\t\t\t\t\ticon: 'table',\n\t\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\t\tlabel: lang.inserttable,\n\t\t\t\t\t\t\t\tcmdName: 'inserttable'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.deletetable,\n\t\t\t\t\t\t\t\tcmdName: 'deletetable'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\t\tlabel: lang.deleterow,\n\t\t\t\t\t\t\t\tcmdName: 'deleterow'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.deletecol,\n\t\t\t\t\t\t\t\tcmdName: 'deletecol'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.insertcol,\n\t\t\t\t\t\t\t\tcmdName: 'insertcol'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.insertcolnext,\n\t\t\t\t\t\t\t\tcmdName: 'insertcolnext'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.insertrow,\n\t\t\t\t\t\t\t\tcmdName: 'insertrow'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.insertrownext,\n\t\t\t\t\t\t\t\tcmdName: 'insertrownext'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\t\tlabel: lang.insertcaption,\n\t\t\t\t\t\t\t\tcmdName: 'insertcaption'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.deletecaption,\n\t\t\t\t\t\t\t\tcmdName: 'deletecaption'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.inserttitle,\n\t\t\t\t\t\t\t\tcmdName: 'inserttitle'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.deletetitle,\n\t\t\t\t\t\t\t\tcmdName: 'deletetitle'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.inserttitlecol,\n\t\t\t\t\t\t\t\tcmdName: 'inserttitlecol'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.deletetitlecol,\n\t\t\t\t\t\t\t\tcmdName: 'deletetitlecol'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\t\tlabel: lang.mergecells,\n\t\t\t\t\t\t\t\tcmdName: 'mergecells'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.mergeright,\n\t\t\t\t\t\t\t\tcmdName: 'mergeright'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.mergedown,\n\t\t\t\t\t\t\t\tcmdName: 'mergedown'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\t\tlabel: lang.splittorows,\n\t\t\t\t\t\t\t\tcmdName: 'splittorows'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.splittocols,\n\t\t\t\t\t\t\t\tcmdName: 'splittocols'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.splittocells,\n\t\t\t\t\t\t\t\tcmdName: 'splittocells'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\t\tlabel: lang.averageDiseRow,\n\t\t\t\t\t\t\t\tcmdName: 'averagedistributerow'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.averageDisCol,\n\t\t\t\t\t\t\t\tcmdName: 'averagedistributecol'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\t\tlabel: lang.edittd,\n\t\t\t\t\t\t\t\tcmdName: 'edittd',\n\t\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\t\tif (UE.ui['edittd']) {\n\t\t\t\t\t\t\t\t\t\tnew UE.ui['edittd'](this);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthis.getDialog('edittd').open();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.edittable,\n\t\t\t\t\t\t\t\tcmdName: 'edittable',\n\t\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\t\tif (UE.ui['edittable']) {\n\t\t\t\t\t\t\t\t\t\tnew UE.ui['edittable'](this);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tthis.getDialog('edittable').open();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.setbordervisible,\n\t\t\t\t\t\t\t\tcmdName: 'setbordervisible'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}, {\n\t\t\t\t\t\tgroup: lang.tablesort,\n\t\t\t\t\t\ticon: 'tablesort',\n\t\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\t\tlabel: lang.enablesort,\n\t\t\t\t\t\t\t\tcmdName: 'enablesort'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.disablesort,\n\t\t\t\t\t\t\t\tcmdName: 'disablesort'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\t\tlabel: lang.reversecurrent,\n\t\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\t\tvalue: 'reversecurrent'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.orderbyasc,\n\t\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\t\tvalue: 'orderbyasc'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.reversebyasc,\n\t\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\t\tvalue: 'reversebyasc'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.orderbynum,\n\t\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\t\tvalue: 'orderbynum'\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: lang.reversebynum,\n\t\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\t\tvalue: 'reversebynum'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}, {\n\t\t\t\t\t\tgroup: lang.borderbk,\n\t\t\t\t\t\ticon: 'borderBack',\n\t\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tlabel: lang.setcolor,\n\t\t\t\t\t\t\tcmdName: \"interlacetable\",\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tthis.execCommand(\"interlacetable\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.unsetcolor,\n\t\t\t\t\t\t\tcmdName: \"uninterlacetable\",\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tthis.execCommand(\"uninterlacetable\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.setbackground,\n\t\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\t\tcolorList: [\"#bbb\", \"#ccc\"]\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.unsetbackground,\n\t\t\t\t\t\t\tcmdName: \"cleartablebackground\",\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tthis.execCommand(\"cleartablebackground\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.redandblue,\n\t\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\t\tcolorList: [\"red\", \"blue\"]\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.threecolorgradient,\n\t\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\t\tcolorList: [\"#aaa\", \"#bbb\", \"#ccc\"]\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}]\n\t\t\t\t\t}, {\n\t\t\t\t\t\tgroup: lang.aligntd,\n\t\t\t\t\t\ticon: 'aligntd',\n\t\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}]\n\t\t\t\t\t}, {\n\t\t\t\t\t\tgroup: lang.aligntable,\n\t\t\t\t\t\ticon: 'aligntable',\n\t\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\t\tclassName: 'left',\n\t\t\t\t\t\t\tlabel: lang.tableleft,\n\t\t\t\t\t\t\tvalue: \"left\"\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\t\tclassName: 'center',\n\t\t\t\t\t\t\tlabel: lang.tablecenter,\n\t\t\t\t\t\t\tvalue: \"center\"\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\t\tclassName: 'right',\n\t\t\t\t\t\t\tlabel: lang.tableright,\n\t\t\t\t\t\t\tvalue: \"right\"\n\t\t\t\t\t\t}]\n\t\t\t\t\t},\n\t\t\t\t\t'-', {\n\t\t\t\t\t\tlabel: lang.insertparagraphbefore,\n\t\t\t\t\t\tcmdName: 'insertparagraph',\n\t\t\t\t\t\tvalue: true\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.insertparagraphafter,\n\t\t\t\t\t\tcmdName: 'insertparagraph'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang['copy'],\n\t\t\t\t\t\tcmdName: 'copy'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang['paste'],\n\t\t\t\t\t\tcmdName: 'paste'\n\t\t\t\t\t}\n\t\t\t\t];\n\t\t\tif (!items.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar uiUtils = UE.ui.uiUtils;\n\t\n\t\t\tme.addListener('contextmenu', function(type, evt) {\n\t\n\t\t\t\tvar offset = uiUtils.getViewportOffsetByEvent(evt);\n\t\t\t\tme.fireEvent('beforeselectionchange');\n\t\t\t\tif (menu) {\n\t\t\t\t\tmenu.destroy();\n\t\t\t\t}\n\t\t\t\tfor (var i = 0, ti, contextItems = []; ti = items[i]; i++) {\n\t\t\t\t\tvar last;\n\t\t\t\t\t(function(item) {\n\t\t\t\t\t\tif (item == '-') {\n\t\t\t\t\t\t\tif ((last = contextItems[contextItems.length - 1]) && last !== '-') {\n\t\t\t\t\t\t\t\tcontextItems.push('-');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (item.hasOwnProperty(\"group\")) {\n\t\t\t\t\t\t\tfor (var j = 0, cj, subMenu = []; cj = item.subMenu[j]; j++) {\n\t\t\t\t\t\t\t\t(function(subItem) {\n\t\t\t\t\t\t\t\t\tif (subItem == '-') {\n\t\t\t\t\t\t\t\t\t\tif ((last = subMenu[subMenu.length - 1]) && last !== '-') {\n\t\t\t\t\t\t\t\t\t\t\tsubMenu.push('-');\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tsubMenu.splice(subMenu.length - 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tif ((me.commands[subItem.cmdName] || UE.commands[subItem.cmdName] || subItem.query) &&\n\t\t\t\t\t\t\t\t\t\t\t(subItem.query ? subItem.query() : me.queryCommandState(subItem.cmdName)) > -1) {\n\t\t\t\t\t\t\t\t\t\t\tsubMenu.push({\n\t\t\t\t\t\t\t\t\t\t\t\t'label': subItem.label || me.getLang(\"contextMenu.\" + subItem.cmdName + (subItem.value || '')) || \"\",\n\t\t\t\t\t\t\t\t\t\t\t\t'className': 'edui-for-' + subItem.cmdName + (subItem.className ? (' edui-for-' + subItem.cmdName + '-' + subItem.className) : ''),\n\t\t\t\t\t\t\t\t\t\t\t\tonclick: subItem.exec ? function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\tsubItem.exec.call(me);\n\t\t\t\t\t\t\t\t\t\t\t\t} : function() {\n\t\t\t\t\t\t\t\t\t\t\t\t\tme.execCommand(subItem.cmdName, subItem.value);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})(cj);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (subMenu.length) {\n\t\t\t\t\t\t\t\tfunction getLabel() {\n\t\t\t\t\t\t\t\t\tswitch (item.icon) {\n\t\t\t\t\t\t\t\t\t\tcase \"table\":\n\t\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.table\");\n\t\t\t\t\t\t\t\t\t\tcase \"justifyjustify\":\n\t\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.paragraph\");\n\t\t\t\t\t\t\t\t\t\tcase \"aligntd\":\n\t\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.aligntd\");\n\t\t\t\t\t\t\t\t\t\tcase \"aligntable\":\n\t\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.aligntable\");\n\t\t\t\t\t\t\t\t\t\tcase \"tablesort\":\n\t\t\t\t\t\t\t\t\t\t\treturn lang.tablesort;\n\t\t\t\t\t\t\t\t\t\tcase \"borderBack\":\n\t\t\t\t\t\t\t\t\t\t\treturn lang.borderbk;\n\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcontextItems.push({\n\t\t\t\t\t\t\t\t\t//todo 修正成自动获取方式\n\t\t\t\t\t\t\t\t\t'label': getLabel(),\n\t\t\t\t\t\t\t\t\tclassName: 'edui-for-' + item.icon,\n\t\t\t\t\t\t\t\t\t'subMenu': {\n\t\t\t\t\t\t\t\t\t\titems: subMenu,\n\t\t\t\t\t\t\t\t\t\teditor: me\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//有可能commmand没有加载右键不能出来，或者没有command也想能展示出来添加query方法\n\t\t\t\t\t\t\tif ((me.commands[item.cmdName] || UE.commands[item.cmdName] || item.query) &&\n\t\t\t\t\t\t\t\t(item.query ? item.query.call(me) : me.queryCommandState(item.cmdName)) > -1) {\n\t\n\t\t\t\t\t\t\t\tcontextItems.push({\n\t\t\t\t\t\t\t\t\t'label': item.label || me.getLang(\"contextMenu.\" + item.cmdName),\n\t\t\t\t\t\t\t\t\tclassName: 'edui-for-' + (item.icon ? item.icon : item.cmdName + (item.value || '')),\n\t\t\t\t\t\t\t\t\tonclick: item.exec ? function() {\n\t\t\t\t\t\t\t\t\t\titem.exec.call(me);\n\t\t\t\t\t\t\t\t\t} : function() {\n\t\t\t\t\t\t\t\t\t\tme.execCommand(item.cmdName, item.value);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t})(ti);\n\t\t\t\t}\n\t\t\t\tif (contextItems[contextItems.length - 1] == '-') {\n\t\t\t\t\tcontextItems.pop();\n\t\t\t\t}\n\t\n\t\t\t\tmenu = new UE.ui.Menu({\n\t\t\t\t\titems: contextItems,\n\t\t\t\t\tclassName: \"edui-contextmenu\",\n\t\t\t\t\teditor: me\n\t\t\t\t});\n\t\t\t\tmenu.render();\n\t\t\t\tmenu.showAt(offset);\n\t\n\t\t\t\tme.fireEvent(\"aftershowcontextmenu\", menu);\n\t\n\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tvar ieRange;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tieRange = me.selection.getNative().createRange();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (ieRange.item) {\n\t\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\t\trange.selectNode(ieRange.item(0)).select(true, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\t// 添加复制的flash按钮\n\t\t\tme.addListener('aftershowcontextmenu', function(type, menu) {\n\t\t\t\tif (me.zeroclipboard) {\n\t\t\t\t\tvar items = menu.items;\n\t\t\t\t\tfor (var key in items) {\n\t\t\t\t\t\tif (items[key].className == 'edui-for-copy') {\n\t\t\t\t\t\t\tme.zeroclipboard.clip(items[key].getDom());\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t};\n\t\n\t\t// plugins/shortcutmenu.js\n\t\t///import core\n\t\t///commands       弹出菜单\n\t\t// commandsName  popupmenu\n\t\t///commandsTitle  弹出菜单\n\t\t/**\n\t\t * 弹出菜单\n\t\t * @function\n\t\t * @name baidu.editor.plugins.popupmenu\n\t\t * @author xuheng\n\t\t */\n\t\n\t\tUE.plugins['shortcutmenu'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tmenu,\n\t\t\t\titems = me.options.shortcutMenu || [];\n\t\n\t\t\tif (!items.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tme.addListener('contextmenu mouseup', function(type, e) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tcustomEvt = {\n\t\t\t\t\t\ttype: type,\n\t\t\t\t\t\ttarget: e.target || e.srcElement,\n\t\t\t\t\t\tscreenX: e.screenX,\n\t\t\t\t\t\tscreenY: e.screenY,\n\t\t\t\t\t\tclientX: e.clientX,\n\t\t\t\t\t\tclientY: e.clientY\n\t\t\t\t\t};\n\t\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tif (rng.collapsed === false || type == \"contextmenu\") {\n\t\n\t\t\t\t\t\tif (!menu) {\n\t\t\t\t\t\t\tmenu = new baidu.editor.ui.ShortCutMenu({\n\t\t\t\t\t\t\t\teditor: me,\n\t\t\t\t\t\t\t\titems: items,\n\t\t\t\t\t\t\t\ttheme: me.options.theme,\n\t\t\t\t\t\t\t\tclassName: 'edui-shortcutmenu'\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\tmenu.render();\n\t\t\t\t\t\t\tme.fireEvent(\"afterrendershortcutmenu\", menu);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tmenu.show(customEvt, !!UE.plugins['contextmenu']);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t\tif (type == 'contextmenu') {\n\t\t\t\t\tdomUtils.preventDefault(e);\n\t\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\t\tvar ieRange;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tieRange = me.selection.getNative().createRange();\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ieRange.item) {\n\t\t\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\t\t\trange.selectNode(ieRange.item(0)).select(true, true);\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\n\t\t\tme.addListener('keydown', function(type) {\n\t\t\t\tif (type == \"keydown\") {\n\t\t\t\t\tmenu && !menu.isHidden && menu.hide();\n\t\t\t\t}\n\t\n\t\t\t});\n\t\n\t\t};\n\t\n\t\t// plugins/basestyle.js\n\t\t/**\n\t\t * B、I、sub、super命令支持\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\tUE.plugins['basestyle'] = function() {\n\t\n\t\t\t/**\n\t\t\t * 字体加粗\n\t\t\t * @command bold\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @remind 对已加粗的文本内容执行该命令， 将取消加粗\n\t\t\t * @method execCommand\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //editor是编辑器实例\n\t\t\t * //对当前选中的文本内容执行加粗操作\n\t\t\t * //第一次执行， 文本内容加粗\n\t\t\t * editor.execCommand( 'bold' );\n\t\t\t *\n\t\t\t * //第二次执行， 文本内容取消加粗\n\t\t\t * editor.execCommand( 'bold' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 字体倾斜\n\t\t\t * @command italic\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @remind 对已倾斜的文本内容执行该命令， 将取消倾斜\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //editor是编辑器实例\n\t\t\t * //对当前选中的文本内容执行斜体操作\n\t\t\t * //第一次操作， 文本内容将变成斜体\n\t\t\t * editor.execCommand( 'italic' );\n\t\t\t *\n\t\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t\t * editor.execCommand( 'italic' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 下标文本，与“superscript”命令互斥\n\t\t\t * @command subscript\n\t\t\t * @method execCommand\n\t\t\t * @remind  把选中的文本内容切换成下标文本， 如果当前选中的文本已经是下标， 则该操作会把文本内容还原成正常文本\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //editor是编辑器实例\n\t\t\t * //对当前选中的文本内容执行下标操作\n\t\t\t * //第一次操作， 文本内容将变成下标文本\n\t\t\t * editor.execCommand( 'subscript' );\n\t\t\t *\n\t\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t\t * editor.execCommand( 'subscript' );\n\t\t\t * ```\n\t\t\t */\n\t\n\t\t\t/**\n\t\t\t * 上标文本，与“subscript”命令互斥\n\t\t\t * @command superscript\n\t\t\t * @method execCommand\n\t\t\t * @remind 把选中的文本内容切换成上标文本， 如果当前选中的文本已经是上标， 则该操作会把文本内容还原成正常文本\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //editor是编辑器实例\n\t\t\t * //对当前选中的文本内容执行上标操作\n\t\t\t * //第一次操作， 文本内容将变成上标文本\n\t\t\t * editor.execCommand( 'superscript' );\n\t\t\t *\n\t\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t\t * editor.execCommand( 'superscript' );\n\t\t\t * ```\n\t\t\t */\n\t\t\tvar basestyles = {\n\t\t\t\t\t'bold': ['strong', 'b'],\n\t\t\t\t\t'italic': ['em', 'i'],\n\t\t\t\t\t'subscript': ['sub'],\n\t\t\t\t\t'superscript': ['sup'],\n\t\t\t\t\t'underline':['u']\n\t\t\t\t},\n\t\t\t\tgetObj = function(editor, tagNames) {\n\t\t\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), tagNames);\n\t\t\t\t},\n\t\t\t\tme = this;\n\t\t\t//添加快捷键\n\t\t\tme.addshortcutkey({\n\t\t\t\t\"Bold\": \"ctrl+66\", //^B\n\t\t\t\t\"Italic\": \"ctrl+73\", //^I\n\t\t\t\t\"Underline\": \"ctrl+85\" //^U\n\t\t\t});\n\t\t\tme.addInputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('b i'), function(node) {\n\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\t\tnode.tagName = 'strong';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\tnode.tagName = 'em';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tfor (var style in basestyles) {\n\t\t\t\t(function(cmd, tagNames) {\n\t\t\t\t\tme.commands[cmd] = {\n\t\t\t\t\t\texecCommand: function(cmdName) {\n\t\t\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\t\t\tobj = getObj(this, tagNames);\n\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\tif (obj) {\n\t\t\t\t\t\t\t\t\tvar tmpText = me.document.createTextNode('');\n\t\t\t\t\t\t\t\t\trange.insertNode(tmpText).removeInlineStyle(tagNames);\n\t\t\t\t\t\t\t\t\trange.setStartBefore(tmpText);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpText);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar tmpNode = range.document.createElement(tagNames[0]);\n\t\t\t\t\t\t\t\t\tif (cmdName == 'superscript' || cmdName == 'subscript') {\n\t\t\t\t\t\t\t\t\t\ttmpText = me.document.createTextNode('');\n\t\t\t\t\t\t\t\t\t\trange.insertNode(tmpText)\n\t\t\t\t\t\t\t\t\t\t\t.removeInlineStyle(['sub', 'sup'])\n\t\t\t\t\t\t\t\t\t\t\t.setStartBefore(tmpText)\n\t\t\t\t\t\t\t\t\t\t\t.collapse(true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trange.insertNode(tmpNode).setStart(tmpNode, 0);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (cmdName == 'superscript' || cmdName == 'subscript') {\n\t\t\t\t\t\t\t\t\tif (!obj || obj.tagName.toLowerCase() != cmdName) {\n\t\t\t\t\t\t\t\t\t\trange.removeInlineStyle(['sub', 'sup']);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tobj ? range.removeInlineStyle(tagNames) : range.applyInlineStyle(tagNames[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\t\treturn getObj(this, tagNames) ? 1 : 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t})(style, basestyles[style]);\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/elementpath.js\n\t\t/**\n\t\t * 选取路径命令\n\t\t * @file\n\t\t */\n\t\tUE.plugins['elementpath'] = function() {\n\t\t\tvar currentLevel,\n\t\t\t\ttagNames,\n\t\t\t\tme = this;\n\t\t\tme.setOpt('elementPathEnabled', true);\n\t\t\tif (!me.options.elementPathEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tme.commands['elementpath'] = {\n\t\t\t\texecCommand: function(cmdName, level) {\n\t\t\t\t\tvar start = tagNames[level],\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tcurrentLevel = level * 1;\n\t\t\t\t\trange.selectNode(start).select();\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\t//产生一个副本，不能修改原来的startElementPath;\n\t\t\t\t\tvar parents = [].concat(this.selection.getStartElementPath()).reverse(),\n\t\t\t\t\t\tnames = [];\n\t\t\t\t\ttagNames = parents;\n\t\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\t\tif (ci.nodeType == 3) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar name = ci.tagName.toLowerCase();\n\t\t\t\t\t\tif (name == 'img' && ci.getAttribute('anchorname')) {\n\t\t\t\t\t\t\tname = 'anchor';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnames[i] = name;\n\t\t\t\t\t\tif (currentLevel == i) {\n\t\t\t\t\t\t\tcurrentLevel = -1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn names;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/formatmatch.js\n\t\t/**\n\t\t * 格式刷，只格式inline的\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 格式刷\n\t\t * @command formatmatch\n\t\t * @method execCommand\n\t\t * @remind 该操作不能复制段落格式\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //获取格式刷\n\t\t * editor.execCommand( 'formatmatch' );\n\t\t * ```\n\t\t */\n\t\tUE.plugins['formatmatch'] = function() {\n\t\n\t\t\tvar me = this,\n\t\t\t\tlist = [],\n\t\t\t\timg,\n\t\t\t\tflag = 0;\n\t\n\t\t\tme.addListener('reset', function() {\n\t\t\t\tlist = [];\n\t\t\t\tflag = 0;\n\t\t\t});\n\t\n\t\t\tfunction addList(type, evt) {\n\t\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\tvar target = evt.target.tagName == 'IMG' ? evt.target : null;\n\t\t\t\t}\n\t\n\t\t\t\tfunction addFormat(range) {\n\t\n\t\t\t\t\tif (text) {\n\t\t\t\t\t\trange.selectNode(text);\n\t\t\t\t\t}\n\t\t\t\t\treturn range.applyInlineStyle(list[list.length - 1].tagName, null, list);\n\t\n\t\t\t\t}\n\t\n\t\t\t\tme.undoManger && me.undoManger.save();\n\t\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\timgT = target || range.getClosedNode();\n\t\t\t\tif (img && imgT && imgT.tagName == 'IMG') {\n\t\t\t\t\t//trace:964\n\t\n\t\t\t\t\timgT.style.cssText += ';float:' + (img.style.cssFloat || img.style.styleFloat || 'none') + ';display:' + (img.style.display || 'inline');\n\t\n\t\t\t\t\timg = null;\n\t\t\t\t} else {\n\t\t\t\t\tif (!img) {\n\t\t\t\t\t\tvar collapsed = range.collapsed;\n\t\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\t\tvar text = me.document.createTextNode('match');\n\t\t\t\t\t\t\trange.insertNode(text).select();\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t//不能把block上的属性干掉\n\t\t\t\t\t\t//trace:1553\n\t\t\t\t\t\tvar removeFormatAttributes = me.options.removeFormatAttributes;\n\t\t\t\t\t\tme.options.removeFormatAttributes = '';\n\t\t\t\t\t\tme.execCommand('removeformat');\n\t\t\t\t\t\tme.options.removeFormatAttributes = removeFormatAttributes;\n\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t//trace:969\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\tif (list.length) {\n\t\t\t\t\t\t\taddFormat(range);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (text) {\n\t\t\t\t\t\t\trange.setStartBefore(text).collapse(true);\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.select();\n\t\t\t\t\t\ttext && domUtils.remove(text);\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\tme.removeListener('mouseup', addList);\n\t\t\t\tflag = 0;\n\t\t\t}\n\t\n\t\t\tme.commands['formatmatch'] = {\n\t\t\t\texecCommand: function(cmdName) {\n\t\n\t\t\t\t\tif (flag) {\n\t\t\t\t\t\tflag = 0;\n\t\t\t\t\t\tlist = [];\n\t\t\t\t\t\tme.removeListener('mouseup', addList);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\timg = range.getClosedNode();\n\t\t\t\t\tif (!img || img.tagName != 'IMG') {\n\t\t\t\t\t\trange.collapse(true).shrinkBoundary();\n\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\tlist = domUtils.findParents(start, true, function(node) {\n\t\t\t\t\t\t\treturn !domUtils.isBlockElm(node) && node.nodeType == 1;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//a不能加入格式刷, 并且克隆节点\n\t\t\t\t\t\tfor (var i = 0, ci; ci = list[i]; i++) {\n\t\t\t\t\t\t\tif (ci.tagName == 'A') {\n\t\t\t\t\t\t\t\tlist.splice(i, 1);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\tme.addListener('mouseup', addList);\n\t\t\t\t\tflag = 1;\n\t\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn flag;\n\t\t\t\t},\n\t\t\t\tnotNeedUndo: 1\n\t\t\t};\n\t\t};\n\t\n\t\t// plugins/searchreplace.js\n\t\t///import core\n\t\t///commands 查找替换\n\t\t///commandsName  SearchReplace\n\t\t///commandsTitle  查询替换\n\t\t///commandsDialog  dialogs\\searchreplace\n\t\t/**\n\t\t * @description 查找替换\n\t\t * @author zhanyi\n\t\t */\n\t\n\t\tUE.plugin.register('searchreplace', function() {\n\t\t\tvar me = this;\n\t\n\t\t\tvar _blockElm = {\n\t\t\t\t'table': 1,\n\t\t\t\t'tbody': 1,\n\t\t\t\t'tr': 1,\n\t\t\t\t'ol': 1,\n\t\t\t\t'ul': 1\n\t\t\t};\n\t\n\t\t\tfunction findTextInString(textContent, opt, currentIndex) {\n\t\t\t\tvar str = opt.searchStr;\n\t\t\t\tif (opt.dir == -1) {\n\t\t\t\t\ttextContent = textContent.split('').reverse().join('');\n\t\t\t\t\tstr = str.split('').reverse().join('');\n\t\t\t\t\tcurrentIndex = textContent.length - currentIndex;\n\t\n\t\t\t\t}\n\t\t\t\tvar reg = new RegExp(str, 'g' + (opt.casesensitive ? '' : 'i')),\n\t\t\t\t\tmatch;\n\t\n\t\t\t\twhile (match = reg.exec(textContent)) {\n\t\t\t\t\tif (match.index >= currentIndex) {\n\t\t\t\t\t\treturn opt.dir == -1 ? textContent.length - match.index - opt.searchStr.length : match.index;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn -1\n\t\t\t}\n\t\n\t\t\tfunction findTextBlockElm(node, currentIndex, opt) {\n\t\t\t\tvar textContent, index, methodName = opt.all || opt.dir == 1 ? 'getNextDomNode' : 'getPreDomNode';\n\t\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\t\tnode = node.firstChild;\n\t\t\t\t}\n\t\t\t\tvar first = 1;\n\t\t\t\twhile (node) {\n\t\t\t\t\ttextContent = node.nodeType == 3 ? node.nodeValue : node[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\t\tindex = findTextInString(textContent, opt, currentIndex);\n\t\t\t\t\tfirst = 0;\n\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t'node': node,\n\t\t\t\t\t\t\t'index': index\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnode = domUtils[methodName](node);\n\t\t\t\t\twhile (node && _blockElm[node.nodeName.toLowerCase()]) {\n\t\t\t\t\t\tnode = domUtils[methodName](node, true);\n\t\t\t\t\t}\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tcurrentIndex = opt.dir == -1 ? (node.nodeType == 3 ? node.nodeValue : node[browser.ie ? 'innerText' : 'textContent']).length : 0;\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction findNTextInBlockElm(node, index, str) {\n\t\t\t\tvar currentIndex = 0,\n\t\t\t\t\tcurrentNode = node.firstChild,\n\t\t\t\t\tcurrentNodeLength = 0,\n\t\t\t\t\tresult;\n\t\t\t\twhile (currentNode) {\n\t\t\t\t\tif (currentNode.nodeType == 3) {\n\t\t\t\t\t\tcurrentNodeLength = currentNode.nodeValue.replace(/(^[\\t\\r\\n]+)|([\\t\\r\\n]+$)/, '').length;\n\t\t\t\t\t\tcurrentIndex += currentNodeLength;\n\t\t\t\t\t\tif (currentIndex >= index) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t'node': currentNode,\n\t\t\t\t\t\t\t\t'index': currentNodeLength - (currentIndex - index)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (!dtd.$empty[currentNode.tagName]) {\n\t\t\t\t\t\tcurrentNodeLength = currentNode[browser.ie ? 'innerText' : 'textContent'].replace(/(^[\\t\\r\\n]+)|([\\t\\r\\n]+$)/, '').length\n\t\t\t\t\t\tcurrentIndex += currentNodeLength;\n\t\t\t\t\t\tif (currentIndex >= index) {\n\t\t\t\t\t\t\tresult = findNTextInBlockElm(currentNode, currentNodeLength - (currentIndex - index), str);\n\t\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrentNode = domUtils.getNextDomNode(currentNode);\n\t\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction searchReplace(me, opt) {\n\t\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tstartBlockNode,\n\t\t\t\t\tsearchStr = opt.searchStr,\n\t\t\t\t\tspan = me.document.createElement('span');\n\t\t\t\tspan.innerHTML = '$$ueditor_searchreplace_key$$';\n\t\n\t\t\t\trng.shrinkBoundary(true);\n\t\n\t\t\t\t//判断是不是第一次选中\n\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\trng.select();\n\t\t\t\t\tvar rngText = me.selection.getText();\n\t\t\t\t\tif (new RegExp('^' + opt.searchStr + '$', (opt.casesensitive ? '' : 'i')).test(rngText)) {\n\t\t\t\t\t\tif (opt.replaceStr != undefined) {\n\t\t\t\t\t\t\treplaceText(rng, opt.replaceStr);\n\t\t\t\t\t\t\trng.select();\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.collapse(opt.dir == -1)\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\trng.insertNode(span);\n\t\t\t\trng.enlargeToBlockElm(true);\n\t\t\t\tstartBlockNode = rng.startContainer;\n\t\t\t\tvar currentIndex = startBlockNode[browser.ie ? 'innerText' : 'textContent'].indexOf('$$ueditor_searchreplace_key$$');\n\t\t\t\trng.setStartBefore(span);\n\t\t\t\tdomUtils.remove(span);\n\t\t\t\tvar result = findTextBlockElm(startBlockNode, currentIndex, opt);\n\t\t\t\tif (result) {\n\t\t\t\t\tvar rngStart = findNTextInBlockElm(result.node, result.index, searchStr);\n\t\t\t\t\tvar rngEnd = findNTextInBlockElm(result.node, result.index + searchStr.length, searchStr);\n\t\t\t\t\trng.setStart(rngStart.node, rngStart.index).setEnd(rngEnd.node, rngEnd.index);\n\t\n\t\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\t\treplaceText(rng, opt.replaceStr)\n\t\t\t\t\t}\n\t\t\t\t\trng.select();\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\trng.setCursor()\n\t\t\t\t}\n\t\n\t\t\t}\n\t\n\t\t\tfunction replaceText(rng, str) {\n\t\n\t\t\t\tstr = me.document.createTextNode(str);\n\t\t\t\trng.deleteContents().insertNode(str);\n\t\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcommands: {\n\t\t\t\t\t'searchreplace': {\n\t\t\t\t\t\texecCommand: function(cmdName, opt) {\n\t\t\t\t\t\t\tutils.extend(opt, {\n\t\t\t\t\t\t\t\tall: false,\n\t\t\t\t\t\t\t\tcasesensitive: false,\n\t\t\t\t\t\t\t\tdir: 1\n\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\tvar num = 0;\n\t\t\t\t\t\t\tif (opt.all) {\n\t\n\t\t\t\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\t\t\t\tfirst = me.body.firstChild;\n\t\t\t\t\t\t\t\tif (first && first.nodeType == 1) {\n\t\t\t\t\t\t\t\t\trng.setStart(first, 0);\n\t\t\t\t\t\t\t\t\trng.shrinkBoundary(true);\n\t\t\t\t\t\t\t\t} else if (first.nodeType == 3) {\n\t\t\t\t\t\t\t\t\trng.setStartBefore(first)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trng.collapse(true).select(true);\n\t\t\t\t\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twhile (searchReplace(this, opt)) {\n\t\t\t\t\t\t\t\t\tnum++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (num) {\n\t\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (searchReplace(this, opt)) {\n\t\t\t\t\t\t\t\t\tnum++\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (num) {\n\t\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\treturn num;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: 1\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/customstyle.js\n\t\t/**\n\t\t * 自定义样式\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 根据config配置文件里“customstyle”选项的值对匹配的标签执行样式替换。\n\t\t * @command customstyle\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'customstyle' );\n\t\t * ```\n\t\t */\n\t\tUE.plugins['customstyle'] = function() {\n\t\t\tvar me = this;\n\t\t\tme.setOpt({\n\t\t\t\t'customstyle': [{\n\t\t\t\t\ttag: 'h1',\n\t\t\t\t\tname: 'tc',\n\t\t\t\t\tstyle: 'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;'\n\t\t\t\t}, {\n\t\t\t\t\ttag: 'h1',\n\t\t\t\t\tname: 'tl',\n\t\t\t\t\tstyle: 'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;'\n\t\t\t\t}, {\n\t\t\t\t\ttag: 'span',\n\t\t\t\t\tname: 'im',\n\t\t\t\t\tstyle: 'font-size:16px;font-style:italic;font-weight:bold;line-height:18px;'\n\t\t\t\t}, {\n\t\t\t\t\ttag: 'span',\n\t\t\t\t\tname: 'hi',\n\t\t\t\t\tstyle: 'font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;'\n\t\t\t\t}]\n\t\t\t});\n\t\t\tme.commands['customstyle'] = {\n\t\t\t\texecCommand: function(cmdName, obj) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\ttagName = obj.tag,\n\t\t\t\t\t\tnode = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\t\treturn node.getAttribute('label');\n\t\t\t\t\t\t}, true),\n\t\t\t\t\t\trange, bk, tmpObj = {};\n\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\tif (obj[p] !== undefined)\n\t\t\t\t\t\t\ttmpObj[p] = obj[p];\n\t\t\t\t\t}\n\t\t\t\t\tdelete tmpObj.tag;\n\t\t\t\t\tif (node && node.getAttribute('label') == obj.label) {\n\t\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t//trace:1732 删掉自定义标签，要有p来回填站位\n\t\t\t\t\t\t\tif (dtd.$block[node.tagName]) {\n\t\t\t\t\t\t\t\tvar fillNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\tdomUtils.moveChild(node, fillNode);\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(fillNode, node);\n\t\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\tvar common = domUtils.getCommonAncestor(bk.start, bk.end),\n\t\t\t\t\t\t\t\tnodes = domUtils.getElementsByTagName(common, tagName);\n\t\t\t\t\t\t\tif (new RegExp(tagName, 'i').test(common.tagName)) {\n\t\t\t\t\t\t\t\tnodes.push(common);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0, ni; ni = nodes[i++];) {\n\t\t\t\t\t\t\t\tif (ni.getAttribute('label') == obj.label) {\n\t\t\t\t\t\t\t\t\tvar ps = domUtils.getPosition(ni, bk.start),\n\t\t\t\t\t\t\t\t\t\tpe = domUtils.getPosition(ni, bk.end);\n\t\t\t\t\t\t\t\t\tif ((ps & domUtils.POSITION_FOLLOWING || ps & domUtils.POSITION_CONTAINS) &&\n\t\t\t\t\t\t\t\t\t\t(pe & domUtils.POSITION_PRECEDING || pe & domUtils.POSITION_CONTAINS)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\tif (dtd.$block[tagName]) {\n\t\t\t\t\t\t\t\t\t\t\tvar fillNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.moveChild(ni, fillNode);\n\t\t\t\t\t\t\t\t\t\t\tni.parentNode.insertBefore(fillNode, ni);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(ni, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode = domUtils.findParent(common, function(node) {\n\t\t\t\t\t\t\t\treturn node.getAttribute('label') == obj.label;\n\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\tif (node) {\n\t\n\t\t\t\t\t\t\t\tdomUtils.remove(node, true);\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.moveToBookmark(bk).select();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (dtd.$block[tagName]) {\n\t\t\t\t\t\t\tthis.execCommand('paragraph', tagName, tmpObj, 'customstyle');\n\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\t\trange.collapse();\n\t\t\t\t\t\t\t\tnode = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\t\t\t\treturn node.getAttribute('label') == obj.label;\n\t\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\t\tvar pNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(node, pNode);\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, pNode);\n\t\t\t\t\t\t\t\trange.setStart(pNode, 0).setCursor();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\tnode = me.document.createElement(tagName);\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(node, tmpObj);\n\t\t\t\t\t\t\t\trange.insertNode(node).setStart(node, 0).setCursor();\n\t\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\t\trange.applyInlineStyle(tagName, tmpObj).moveToBookmark(bk).select();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\tvar parent = domUtils.filterNodeList(\n\t\t\t\t\t\tthis.selection.getStartElementPath(),\n\t\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\t\treturn node.getAttribute('label')\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\treturn parent ? parent.getAttribute('label') : '';\n\t\t\t\t}\n\t\t\t};\n\t\t\t//当去掉customstyle是，如果是块元素，用p代替\n\t\t\tme.addListener('keyup', function(type, evt) {\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\n\t\t\t\tif (keyCode == 32 || keyCode == 13) {\n\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\tvar node = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\t\treturn node.getAttribute('label');\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tif (node && dtd.$block[node.tagName] && domUtils.isEmptyNode(node)) {\n\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\tdomUtils.insertAfter(node, p);\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/catchremoteimage.js\n\t\t///import core\n\t\t///commands 远程图片抓取\n\t\t///commandsName  catchRemoteImage,catchremoteimageenable\n\t\t///commandsTitle  远程图片抓取\n\t\t/**\n\t\t * 远程图片抓取,当开启本插件时所有不符合本地域名的图片都将被抓取成为本地服务器上的图片\n\t\t */\n\t\tUE.plugins['catchremoteimage'] = function() {\n\t\t\tvar me = this,\n\t\t\t\tajax = UE.ajax;\n\t\n\t\t\t/* 设置默认值 */\n\t\t\tif (me.options.catchRemoteImageEnable === false) return;\n\t\t\tme.setOpt({\n\t\t\t\tcatchRemoteImageEnable: false\n\t\t\t});\n\t\n\t\t\tme.addListener(\"afterpaste\", function() {\n\t\t\t\tme.fireEvent(\"catchRemoteImage\");\n\t\t\t});\n\t\n\t\t\tme.addListener(\"catchRemoteImage\", function() {\n\t\t\t\treturn;\n\t\t\t\tvar catcherLocalDomain = me.getOpt('catcherLocalDomain'),\n\t\t\t\t\tcatcherActionUrl = me.getActionUrl(me.getOpt('catcherActionName')),\n\t\t\t\t\tcatcherUrlPrefix = me.getOpt('catcherUrlPrefix'),\n\t\t\t\t\tcatcherFieldName = me.getOpt('catcherFieldName');\n\t\n\t\t\t\tvar remoteImages = [],\n\t\t\t\t\timgs = domUtils.getElementsByTagName(me.document, \"img\"),\n\t\t\t\t\ttest = function(src, urls) {\n\t\t\t\t\t\tif (src.indexOf(location.host) != -1 || /(^\\.)|(^\\/)/.test(src)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (urls) {\n\t\t\t\t\t\t\tfor (var j = 0, url; url = urls[j++];) {\n\t\t\t\t\t\t\t\tif (src.indexOf(url) !== -1) {\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t};\n\t\n\t\t\t\tfor (var i = 0, ci; ci = imgs[i++];) {\n\t\t\t\t\tif (ci.getAttribute(\"word_img\")) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar src = ci.getAttribute(\"_src\") || ci.src || \"\";\n\t\t\t\t\tif (/^(https?|ftp):/i.test(src) && !test(src, catcherLocalDomain)) {\n\t\t\t\t\t\tremoteImages.push(src);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (remoteImages.length) {\n\t\t\t\t\tcatchremoteimage(remoteImages, {\n\t\t\t\t\t\t//成功抓取\n\t\t\t\t\t\tsuccess: function(r) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tvar info = r.state !== undefined ? r : eval(\"(\" + r.responseText + \")\");\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t/* 获取源路径和新路径 */\n\t\t\t\t\t\t\tvar i, j, ci, cj, oldSrc, newSrc, list = info.list;\n\t\n\t\t\t\t\t\t\tfor (i = 0; ci = imgs[i++];) {\n\t\t\t\t\t\t\t\toldSrc = ci.getAttribute(\"_src\") || ci.src || \"\";\n\t\t\t\t\t\t\t\tfor (j = 0; cj = list[j++];) {\n\t\t\t\t\t\t\t\t\tif (oldSrc == cj.source && cj.state == \"SUCCESS\") { //抓取失败时不做替换处理\n\t\t\t\t\t\t\t\t\t\tnewSrc = catcherUrlPrefix + cj.url;\n\t\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(ci, {\n\t\t\t\t\t\t\t\t\t\t\t\"src\": newSrc,\n\t\t\t\t\t\t\t\t\t\t\t\"_src\": newSrc\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.fireEvent('catchremotesuccess')\n\t\t\t\t\t\t},\n\t\t\t\t\t\t//回调失败，本次请求超时\n\t\t\t\t\t\terror: function() {\n\t\t\t\t\t\t\tme.fireEvent(\"catchremoteerror\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t\tfunction catchremoteimage(imgs, callbacks) {\n\t\t\t\t\tvar params = utils.serializeParam(me.queryCommandValue('serverparam')) || '',\n\t\t\t\t\t\turl = utils.formatUrl(catcherActionUrl + (catcherActionUrl.indexOf('?') == -1 ? '?' : '&') + params),\n\t\t\t\t\t\tisJsonp = utils.isCrossDomainUrl(url),\n\t\t\t\t\t\topt = {\n\t\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t\t'dataType': isJsonp ? 'jsonp' : '',\n\t\t\t\t\t\t\t'timeout': 60000, //单位：毫秒，回调请求超时设置。目标用户如果网速不是很快的话此处建议设置一个较大的数值\n\t\t\t\t\t\t\t'onsuccess': callbacks[\"success\"],\n\t\t\t\t\t\t\t'onerror': callbacks[\"error\"]\n\t\t\t\t\t\t};\n\t\t\t\t\topt[catcherFieldName] = imgs;\n\t\t\t\t\tajax.request(url, opt);\n\t\t\t\t}\n\t\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/snapscreen.js\n\t\t/**\n\t\t * 截屏插件，为UEditor提供插入支持\n\t\t * @file\n\t\t * @since 1.4.2\n\t\t */\n\t\tUE.plugin.register('snapscreen', function() {\n\t\n\t\t\tvar me = this;\n\t\t\tvar snapplugin;\n\t\n\t\t\tfunction getLocation(url) {\n\t\t\t\tvar search,\n\t\t\t\t\ta = document.createElement('a'),\n\t\t\t\t\tparams = utils.serializeParam(me.queryCommandValue('serverparam')) || '';\n\t\n\t\t\t\ta.href = url;\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\ta.href = a.href;\n\t\t\t\t}\n\t\n\t\t\t\tsearch = a.search;\n\t\t\t\tif (params) {\n\t\t\t\t\tsearch = search + (search.indexOf('?') == -1 ? '?' : '&') + params;\n\t\t\t\t\tsearch = search.replace(/[&]+/ig, '&');\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t'port': a.port,\n\t\t\t\t\t'hostname': a.hostname,\n\t\t\t\t\t'path': a.pathname + search || +a.hash\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\tcommands: {\n\t\t\t\t\t/**\n\t\t\t\t\t * 字体背景颜色\n\t\t\t\t\t * @command snapscreen\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * editor.execCommand('snapscreen');\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t'snapscreen': {\n\t\t\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\t\t\tvar url, local, res;\n\t\t\t\t\t\t\tvar lang = me.getLang(\"snapScreen_plugin\");\n\t\n\t\t\t\t\t\t\tif (!snapplugin) {\n\t\t\t\t\t\t\t\tvar container = me.container;\n\t\t\t\t\t\t\t\tvar doc = me.container.ownerDocument || me.container.document;\n\t\t\t\t\t\t\t\tsnapplugin = doc.createElement(\"object\");\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tsnapplugin.type = \"application/x-pluginbaidusnap\";\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tsnapplugin.style.cssText = \"position:absolute;left:-9999px;width:0;height:0;\";\n\t\t\t\t\t\t\t\tsnapplugin.setAttribute(\"width\", \"0\");\n\t\t\t\t\t\t\t\tsnapplugin.setAttribute(\"height\", \"0\");\n\t\t\t\t\t\t\t\tcontainer.appendChild(snapplugin);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tfunction onSuccess(rs) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\trs = eval(\"(\" + rs + \")\");\n\t\t\t\t\t\t\t\t\tif (rs.state == 'SUCCESS') {\n\t\t\t\t\t\t\t\t\t\tvar opt = me.options;\n\t\t\t\t\t\t\t\t\t\tme.execCommand('insertimage', {\n\t\t\t\t\t\t\t\t\t\t\tsrc: opt.snapscreenUrlPrefix + rs.url,\n\t\t\t\t\t\t\t\t\t\t\t_src: opt.snapscreenUrlPrefix + rs.url,\n\t\t\t\t\t\t\t\t\t\t\talt: rs.title || '',\n\t\t\t\t\t\t\t\t\t\t\tfloatStyle: opt.snapscreenImgAlign\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\talert(rs.state);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\talert(lang.callBackErrorMsg);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdebugger;\n\t\t\t\t\t\t\turl = me.getActionUrl(me.getOpt('snapscreenActionName'));\n\t\t\t\t\t\t\tlocal = getLocation(url);\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tres = snapplugin.saveSnapshot(local.hostname, local.path, local.port);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tme.ui._dialogs['snapscreenDialog'].open();\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tonSuccess(res);\n\t\t\t\t\t\t\t}, 50);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\t\treturn (navigator.userAgent.indexOf(\"Windows\", 0) != -1) ? 0 : -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/insertparagraph.js\n\t\t/**\n\t\t * 插入段落\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 插入段落\n\t\t * @command insertparagraph\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * editor.execCommand( 'insertparagraph' );\n\t\t * ```\n\t\t */\n\t\n\t\tUE.commands['insertparagraph'] = {\n\t\t\texecCommand: function(cmdName, front) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\tstart = range.startContainer,\n\t\t\t\t\ttmpNode;\n\t\t\t\twhile (start) {\n\t\t\t\t\tif (domUtils.isBody(start)) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttmpNode = start;\n\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t}\n\t\t\t\tif (tmpNode) {\n\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\tif (front) {\n\t\t\t\t\t\ttmpNode.parentNode.insertBefore(p, tmpNode)\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttmpNode.parentNode.insertBefore(p, tmpNode.nextSibling)\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\trange.setStart(p, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\n\t\t// plugins/webapp.js\n\t\t/**\n\t\t * 百度应用\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\n\t\t/**\n\t\t * 插入百度应用\n\t\t * @command webapp\n\t\t * @method execCommand\n\t\t * @remind 需要百度APPKey\n\t\t * @remind 百度应用主页： <a href=\"http://app.baidu.com/\" target=\"_blank\">http://app.baidu.com/</a>\n\t\t * @param { Object } appOptions 应用所需的参数项， 支持的key有： title=>应用标题， width=>应用容器宽度，\n\t\t * height=>应用容器高度，logo=>应用logo，url=>应用地址\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t\t * editor.execCommand( 'webapp' , {\n\t\t *     title: '植物大战僵尸',\n\t\t *     width: 560,\n\t\t *     height: 465,\n\t\t *     logo: '应用展示的图片',\n\t\t *     url: '百度应用的地址'\n\t\t * } );\n\t\t * ```\n\t\t */\n\t\n\t\t//UE.plugins['webapp'] = function () {\n\t\t//    var me = this;\n\t\t//    function createInsertStr( obj, toIframe, addParagraph ) {\n\t\t//        return !toIframe ?\n\t\t//                (addParagraph ? '<p>' : '') + '<img title=\"'+obj.title+'\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"' +\n\t\t//                        ' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" style=\"background:url(' + obj.logo+') no-repeat center center; border:1px solid gray;\" class=\"edui-faked-webapp\" _url=\"' + obj.url + '\" />' +\n\t\t//                        (addParagraph ? '</p>' : '')\n\t\t//                :\n\t\t//                '<iframe class=\"edui-faked-webapp\" title=\"'+obj.title+'\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"  scrolling=\"no\" frameborder=\"0\" src=\"' + obj.url + '\" logo_url = '+obj.logo+'></iframe>';\n\t\t//    }\n\t\t//\n\t\t//    function switchImgAndIframe( img2frame ) {\n\t\t//        var tmpdiv,\n\t\t//                nodes = domUtils.getElementsByTagName( me.document, !img2frame ? \"iframe\" : \"img\" );\n\t\t//        for ( var i = 0, node; node = nodes[i++]; ) {\n\t\t//            if ( node.className != \"edui-faked-webapp\" ){\n\t\t//                continue;\n\t\t//            }\n\t\t//            tmpdiv = me.document.createElement( \"div\" );\n\t\t//            tmpdiv.innerHTML = createInsertStr( img2frame ? {url:node.getAttribute( \"_url\" ), width:node.width, height:node.height,title:node.title,logo:node.style.backgroundImage.replace(\"url(\",\"\").replace(\")\",\"\")} : {url:node.getAttribute( \"src\", 2 ),title:node.title, width:node.width, height:node.height,logo:node.getAttribute(\"logo_url\")}, img2frame ? true : false,false );\n\t\t//            node.parentNode.replaceChild( tmpdiv.firstChild, node );\n\t\t//        }\n\t\t//    }\n\t\t//\n\t\t//    me.addListener( \"beforegetcontent\", function () {\n\t\t//        switchImgAndIframe( true );\n\t\t//    } );\n\t\t//    me.addListener( 'aftersetcontent', function () {\n\t\t//        switchImgAndIframe( false );\n\t\t//    } );\n\t\t//    me.addListener( 'aftergetcontent', function ( cmdName ) {\n\t\t//        if ( cmdName == 'aftergetcontent' && me.queryCommandState( 'source' ) ){\n\t\t//            return;\n\t\t//        }\n\t\t//        switchImgAndIframe( false );\n\t\t//    } );\n\t\t//\n\t\t//    me.commands['webapp'] = {\n\t\t//        execCommand:function ( cmd, obj ) {\n\t\t//            me.execCommand( \"inserthtml\", createInsertStr( obj, false,true ) );\n\t\t//        }\n\t\t//    };\n\t\t//};\n\t\n\t\tUE.plugin.register('webapp', function() {\n\t\t\tvar me = this;\n\t\n\t\t\tfunction createInsertStr(obj, toEmbed) {\n\t\t\t\treturn !toEmbed ?\n\t\t\t\t\t'<img title=\"' + obj.title + '\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"' +\n\t\t\t\t\t' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" _logo_url=\"' + obj.logo + '\" style=\"background:url(' + obj.logo + ') no-repeat center center; border:1px solid gray;\" class=\"edui-faked-webapp\" _url=\"' + obj.url + '\" ' +\n\t\t\t\t\t(obj.align && !obj.cssfloat ? 'align=\"' + obj.align + '\"' : '') +\n\t\t\t\t\t(obj.cssfloat ? 'style=\"float:' + obj.cssfloat + '\"' : '') +\n\t\t\t\t\t'/>' :\n\t\t\t\t\t'<iframe class=\"edui-faked-webapp\" title=\"' + obj.title + '\" ' +\n\t\t\t\t\t(obj.align && !obj.cssfloat ? 'align=\"' + obj.align + '\"' : '') +\n\t\t\t\t\t(obj.cssfloat ? 'style=\"float:' + obj.cssfloat + '\"' : '') +\n\t\t\t\t\t'width=\"' + obj.width + '\" height=\"' + obj.height + '\"  scrolling=\"no\" frameborder=\"0\" src=\"' + obj.url + '\" logo_url = \"' + obj.logo + '\"></iframe>'\n\t\n\t\t\t}\n\t\t\treturn {\n\t\t\t\toutputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('img'), function(node) {\n\t\t\t\t\t\tvar html;\n\t\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-webapp') {\n\t\t\t\t\t\t\thtml = createInsertStr({\n\t\t\t\t\t\t\t\ttitle: node.getAttr('title'),\n\t\t\t\t\t\t\t\t'width': node.getAttr('width'),\n\t\t\t\t\t\t\t\t'height': node.getAttr('height'),\n\t\t\t\t\t\t\t\t'align': node.getAttr('align'),\n\t\t\t\t\t\t\t\t'cssfloat': node.getStyle('float'),\n\t\t\t\t\t\t\t\t'url': node.getAttr(\"_url\"),\n\t\t\t\t\t\t\t\t'logo': node.getAttr('_logo_url')\n\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\tvar embed = UE.uNode.createElement(html);\n\t\t\t\t\t\t\tnode.parentNode.replaceChild(embed, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tinputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('iframe'), function(node) {\n\t\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-webapp') {\n\t\t\t\t\t\t\tvar img = UE.uNode.createElement(createInsertStr({\n\t\t\t\t\t\t\t\ttitle: node.getAttr('title'),\n\t\t\t\t\t\t\t\t'width': node.getAttr('width'),\n\t\t\t\t\t\t\t\t'height': node.getAttr('height'),\n\t\t\t\t\t\t\t\t'align': node.getAttr('align'),\n\t\t\t\t\t\t\t\t'cssfloat': node.getStyle('float'),\n\t\t\t\t\t\t\t\t'url': node.getAttr(\"src\"),\n\t\t\t\t\t\t\t\t'logo': node.getAttr('logo_url')\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\tnode.parentNode.replaceChild(img, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t/**\n\t\t\t\t\t * 插入百度应用\n\t\t\t\t\t * @command webapp\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @remind 需要百度APPKey\n\t\t\t\t\t * @remind 百度应用主页： <a href=\"http://app.baidu.com/\" target=\"_blank\">http://app.baidu.com/</a>\n\t\t\t\t\t * @param { Object } appOptions 应用所需的参数项， 支持的key有： title=>应用标题， width=>应用容器宽度，\n\t\t\t\t\t * height=>应用容器高度，logo=>应用logo，url=>应用地址\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * //editor是编辑器实例\n\t\t\t\t\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t\t\t\t\t * editor.execCommand( 'webapp' , {\n\t\t\t\t\t *     title: '植物大战僵尸',\n\t\t\t\t\t *     width: 560,\n\t\t\t\t\t *     height: 465,\n\t\t\t\t\t *     logo: '应用展示的图片',\n\t\t\t\t\t *     url: '百度应用的地址'\n\t\t\t\t\t * } );\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t'webapp': {\n\t\t\t\t\t\texecCommand: function(cmd, obj) {\n\t\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\tstr = createInsertStr(utils.extend(obj, {\n\t\t\t\t\t\t\t\t\talign: 'none'\n\t\t\t\t\t\t\t\t}), false);\n\t\t\t\t\t\t\tme.execCommand(\"inserthtml\", str);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\timg = me.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-webapp\");\n\t\t\t\t\t\t\treturn flag ? 1 : 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/template.js\n\t\t///import core\n\t\t///import plugins\\inserthtml.js\n\t\t///import plugins\\cleardoc.js\n\t\t///commands 模板\n\t\t///commandsName  template\n\t\t///commandsTitle  模板\n\t\t///commandsDialog  dialogs\\template\n\t\tUE.plugins['template'] = function() {\n\t\t\tUE.commands['template'] = {\n\t\t\t\texecCommand: function(cmd, obj) {\n\t\t\t\t\tobj.html && this.execCommand(\"inserthtml\", obj.html);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.addListener(\"click\", function(type, evt) {\n\t\t\t\tvar el = evt.target || evt.srcElement,\n\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\tvar tnode = domUtils.findParent(el, function(node) {\n\t\t\t\t\tif (node.className && domUtils.hasClass(node, \"ue_t\")) {\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t}, true);\n\t\t\t\ttnode && range.selectNode(tnode).shrinkBoundary().select();\n\t\t\t});\n\t\t\tthis.addListener(\"keydown\", function(type, evt) {\n\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\tif (!evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\t\t\tvar tnode = domUtils.findParent(range.startContainer, function(node) {\n\t\t\t\t\t\t\tif (node.className && domUtils.hasClass(node, \"ue_t\")) {\n\t\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tif (tnode) {\n\t\t\t\t\t\t\tdomUtils.removeClasses(tnode, [\"ue_t\"]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\n\t\t// plugins/music.js\n\t\t/**\n\t\t * 插入音乐命令\n\t\t * @file\n\t\t */\n\t\tUE.plugin.register('music', function() {\n\t\t\tvar me = this;\n\t\n\t\t\tfunction creatInsertStr(url, width, height, align, cssfloat, toEmbed) {\n\t\t\t\treturn !toEmbed ?\n\t\t\t\t\t'<img ' +\n\t\t\t\t\t(align && !cssfloat ? 'align=\"' + align + '\"' : '') +\n\t\t\t\t\t(cssfloat ? 'style=\"float:' + cssfloat + '\"' : '') +\n\t\t\t\t\t' width=\"' + width + '\" height=\"' + height + '\" _url=\"' + url + '\" class=\"edui-faked-music\"' +\n\t\t\t\t\t' src=\"' + me.options.langPath + me.options.lang + '/images/music.png\" />' :\n\t\t\t\t\t'<embed type=\"application/x-shockwave-flash\" class=\"edui-faked-music\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"' +\n\t\t\t\t\t' src=\"' + url + '\" width=\"' + width + '\" height=\"' + height + '\" ' + (align && !cssfloat ? 'align=\"' + align + '\"' : '') +\n\t\t\t\t\t(cssfloat ? 'style=\"float:' + cssfloat + '\"' : '') +\n\t\t\t\t\t' wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" allowscriptaccess=\"never\" allowfullscreen=\"true\" >';\n\t\t\t}\n\t\t\treturn {\n\t\t\t\toutputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('img'), function(node) {\n\t\t\t\t\t\tvar html;\n\t\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-music') {\n\t\t\t\t\t\t\tvar cssfloat = node.getStyle('float');\n\t\t\t\t\t\t\tvar align = node.getAttr('align');\n\t\t\t\t\t\t\thtml = creatInsertStr(node.getAttr(\"_url\"), node.getAttr('width'), node.getAttr('height'), align, cssfloat, true);\n\t\t\t\t\t\t\tvar embed = UE.uNode.createElement(html);\n\t\t\t\t\t\t\tnode.parentNode.replaceChild(embed, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tinputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('embed'), function(node) {\n\t\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-music') {\n\t\t\t\t\t\t\tvar cssfloat = node.getStyle('float');\n\t\t\t\t\t\t\tvar align = node.getAttr('align');\n\t\t\t\t\t\t\thtml = creatInsertStr(node.getAttr(\"src\"), node.getAttr('width'), node.getAttr('height'), align, cssfloat, false);\n\t\t\t\t\t\t\tvar img = UE.uNode.createElement(html);\n\t\t\t\t\t\t\tnode.parentNode.replaceChild(img, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t/**\n\t\t\t\t\t * 插入音乐\n\t\t\t\t\t * @command music\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { Object } musicOptions 插入音乐的参数项， 支持的key有： url=>音乐地址；\n\t\t\t\t\t * width=>音乐容器宽度；height=>音乐容器高度；align=>音乐文件的对齐方式， 可选值有: left, center, right, none\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * //editor是编辑器实例\n\t\t\t\t\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t\t\t\t\t * editor.execCommand( 'music' , {\n\t\t\t\t\t *     width: 400,\n\t\t\t\t\t *     height: 95,\n\t\t\t\t\t *     align: \"center\",\n\t\t\t\t\t *     url: \"音乐地址\"\n\t\t\t\t\t * } );\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t'music': {\n\t\t\t\t\t\texecCommand: function(cmd, musicObj) {\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\tstr = creatInsertStr(musicObj.url, musicObj.width || 400, musicObj.height || 95, \"none\", false);\n\t\t\t\t\t\t\tme.execCommand(\"inserthtml\", str);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\timg = me.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-music\");\n\t\t\t\t\t\t\treturn flag ? 1 : 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/autoupload.js\n\t\t/**\n\t\t * @description\n\t\t * 1.拖放文件到编辑区域，自动上传并插入到选区\n\t\t * 2.插入粘贴板的图片，自动上传并插入到选区\n\t\t * @author Jinqn\n\t\t * @date 2013-10-14\n\t\t */\n\t\tUE.plugin.register('autoupload', function() {\n\t\n\t\t\tfunction sendAndInsertFile(file, editor) {\n\t\t\t\tvar me = editor;\n\t\t\t\t//模拟数据\n\t\t\t\tvar fieldName, urlPrefix, maxSize, allowFiles, actionUrl,\n\t\t\t\t\tloadingHtml, errorHandler, successHandler,\n\t\t\t\t\tfiletype = /image\\/\\w+/i.test(file.type) ? 'image' : 'file',\n\t\t\t\t\tloadingId = 'loading_' + (+new Date()).toString(36);\n\t\n\t\t\t\tfieldName = me.getOpt(filetype + 'FieldName');\n\t\t\t\turlPrefix = me.getOpt(filetype + 'UrlPrefix');\n\t\t\t\tmaxSize = me.getOpt(filetype + 'MaxSize');\n\t\t\t\tallowFiles = me.getOpt(filetype + 'AllowFiles');\n\t\t\t\tactionUrl = me.getActionUrl(me.getOpt(filetype + 'ActionName'));\n\t\t\t\terrorHandler = function(title) {\n\t\t\t\t\tvar loader = me.document.getElementById(loadingId);\n\t\t\t\t\tloader && domUtils.remove(loader);\n\t\t\t\t\tme.fireEvent('showmessage', {\n\t\t\t\t\t\t'id': loadingId,\n\t\t\t\t\t\t'content': title,\n\t\t\t\t\t\t'type': 'error',\n\t\t\t\t\t\t'timeout': 4000\n\t\t\t\t\t});\n\t\t\t\t};\n\t\n\t\t\t\tif (filetype == 'image') {\n\t\t\t\t\tloadingHtml = '<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' +\n\t\t\t\t\t\tme.options.themePath + me.options.theme +\n\t\t\t\t\t\t'/images/spacer.gif\" title=\"' + (me.getLang('autoupload.loading') || '') + '\" >';\n\t\t\t\t\tsuccessHandler = function(data) {\n\t\t\t\t\t\tvar link = urlPrefix + data.url,\n\t\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\t\t\t\t\t\tif (loader) {\n\t\t\t\t\t\t\tloader.setAttribute('src', link);\n\t\t\t\t\t\t\tloader.setAttribute('_src', link);\n\t\t\t\t\t\t\tloader.setAttribute('title', data.title || '');\n\t\t\t\t\t\t\tloader.setAttribute('alt', data.original || '');\n\t\t\t\t\t\t\tloader.removeAttribute('id');\n\t\t\t\t\t\t\tdomUtils.removeClasses(loader, 'loadingclass');\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tloadingHtml = '<p>' +\n\t\t\t\t\t\t'<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' +\n\t\t\t\t\t\tme.options.themePath + me.options.theme +\n\t\t\t\t\t\t'/images/spacer.gif\" title=\"' + (me.getLang('autoupload.loading') || '') + '\" >' +\n\t\t\t\t\t\t'</p>';\n\t\t\t\t\tsuccessHandler = function(data) {\n\t\t\t\t\t\tvar link = urlPrefix + data.url,\n\t\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\t\n\t\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\t\tbk = rng.createBookmark();\n\t\t\t\t\t\trng.selectNode(loader).select();\n\t\t\t\t\t\tme.execCommand('insertfile', {\n\t\t\t\t\t\t\t'url': link\n\t\t\t\t\t\t});\n\t\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t\t};\n\t\t\t\t}\n\t\n\t\t\t\t/* 插入loading的占位符 */\n\t\t\t\tme.execCommand('inserthtml', loadingHtml);\n\t\n\t\t\t\t/* 判断后端配置是否没有加载成功 */\n\t\t\t\tif (!me.getOpt(filetype + 'ActionName')) {\n\t\t\t\t\terrorHandler(me.getLang('autoupload.errorLoadConfig'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t/* 判断文件大小是否超出限制 */\n\t\t\t\tif (file.size > maxSize) {\n\t\t\t\t\terrorHandler(me.getLang('autoupload.exceedSizeError'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t/* 判断文件格式是否超出允许 */\n\t\t\t\tvar fileext = file.name ? file.name.substr(file.name.lastIndexOf('.')) : '';\n\t\t\t\tif ((fileext && filetype != 'image') || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {\n\t\t\t\t\terrorHandler(me.getLang('autoupload.exceedTypeError'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\t/* 创建Ajax并提交 */\n\t\t\t\tvar xhr = new XMLHttpRequest(),\n\t\t\t\t\tfd = new FormData(),\n\t\t\t\t\tparams = utils.serializeParam(me.queryCommandValue('serverparam')) || '',\n\t\t\t\t\turl = utils.formatUrl(actionUrl + (actionUrl.indexOf('?') == -1 ? '?' : '&') + params);\n\t\n\t\t\t\tfd.append(fieldName, file, file.name || ('blob.' + file.type.substr('image/'.length)));\n\t\t\t\tfd.append('type', 'ajax');\n\t\t\t\txhr.open(\"post\", url, true);\n\t\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\t\txhr.addEventListener('load', function(e) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar json = (new Function(\"return \" + utils.trim(e.target.response)))();\n\t\t\t\t\t\tif (json.state == 'SUCCESS' && json.url) {\n\t\t\t\t\t\t\tsuccessHandler(json);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\terrorHandler(json.state);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (er) {\n\t\t\t\t\t\terrorHandler(me.getLang('autoupload.loadError'));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\txhr.send(fd);\n\t\t\t}\n\t\n\t\t\tfunction getPasteImage(e) {\n\t\t\t\tconsole.log(e.clipboardData)\n\t\t\t\tconsole.log( e.clipboardData.items)\n\t\t\t\tconsole.log(e.clipboardData.items[0])\n\t\t\t\tconsole.log(e.clipboardData.items[0].type)\n\t\t\t\t//return e.clipboardData && e.clipboardData.items && e.clipboardData.items.length == 1 && /^image\\//.test(e.clipboardData.items[0].type) ? e.clipboardData.items : null;\n\t\t\t}\n\t\n\t\t\tfunction getDropImage(e) {\n\t\t\t\treturn e.dataTransfer && e.dataTransfer.files ? e.dataTransfer.files : null;\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\toutputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('img'), function(n) {\n\t\t\t\t\t\tif (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tutils.each(root.getNodesByTagName('p'), function(n) {\n\t\t\t\t\t\tif (/\\bloadpara\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tbindEvents: {\n\t\t\t\t\t//插入粘贴板的图片，拖放插入图片\n\t\t\t\t\t'ready': function(e) {\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tif (window.FormData && window.FileReader) {\n\t\t\t\t\t\t\tdomUtils.on(me.body, 'paste drop', function(e) {\n\t\t\t\t\t\t\t\tvar hasImg = false,\n\t\t\t\t\t\t\t\t\titems;\n\t\t\t\t\t\t\t\t//获取粘贴板文件列表或者拖放文件列表\n\t\t\t\t\t\t\t\titems = e.type == 'paste' ? getPasteImage(e) : getDropImage(e);\n\t\t\t\t\t\t\t\tif (items) {\n\t\t\t\t\t\t\t\t\tconsole.log(items,items.length);\n\t\t\t\t\t\t\t\t\tvar len = items.length,\n\t\t\t\t\t\t\t\t\t\tfile;\n\t\t\t\t\t\t\t\t\t\tconsole.log(len,24329)\n\t\t\t\t\t\t\t\t\twhile (len--) {\n\t\t\t\t\t\t\t\t\t\tfile = items[len];\n\t\t\t\t\t\t\t\t\t\tif (file.getAsFile) file = file.getAsFile();\n\t\t\t\t\t\t\t\t\t\tif (file && file.size > 0) {\n\t\t\t\t\t\t\t\t\t\t\tsendAndInsertFile(file, me);\n\t\t\t\t\t\t\t\t\t\t\thasImg = true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\thasImg && e.preventDefault();\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t//取消拖放图片时出现的文字光标位置提示\n\t\t\t\t\t\t\tdomUtils.on(me.body, 'dragover', function(e) {\n\t\t\t\t\t\t\t\tif (e.dataTransfer.types[0] == 'Files') {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\t//设置loading的样式\n\t\t\t\t\t\t\tutils.cssRule('loading',\n\t\t\t\t\t\t\t\t'.loadingclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loading.gif\\') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\\n' +\n\t\t\t\t\t\t\t\t'.loaderrorclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loaderror.png\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +\n\t\t\t\t\t\t\t\t'}',\n\t\t\t\t\t\t\t\tthis.document);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/autosave.js\n\t\tUE.plugin.register('autosave', function() {\n\t\n\t\t\tvar me = this,\n\t\t\t\t//无限循环保护\n\t\t\t\tlastSaveTime = new Date(),\n\t\t\t\t//最小保存间隔时间\n\t\t\t\tMIN_TIME = 20,\n\t\t\t\t//auto save key\n\t\t\t\tsaveKey = null;\n\t\n\t\t\tif (!me.getOpt('enableAutoSave')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\n\t\t\tfunction save(editor) {\n\t\n\t\t\t\tvar saveData;\n\t\n\t\t\t\tif (new Date() - lastSaveTime < MIN_TIME) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tif (!editor.hasContents()) {\n\t\t\t\t\t//这里不能调用命令来删除， 会造成事件死循环\n\t\t\t\t\tsaveKey && me.removePreferences(saveKey);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tlastSaveTime = new Date();\n\t\n\t\t\t\teditor._saveFlag = null;\n\t\n\t\t\t\tsaveData = me.body.innerHTML;\n\t\n\t\t\t\tif (editor.fireEvent(\"beforeautosave\", {\n\t\t\t\t\t\tcontent: saveData\n\t\t\t\t\t}) === false) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\tme.setPreferences(saveKey, saveData);\n\t\n\t\t\t\teditor.fireEvent(\"afterautosave\", {\n\t\t\t\t\tcontent: saveData\n\t\t\t\t});\n\t\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\tdefaultOptions: {\n\t\t\t\t\t//默认间隔时间\n\t\t\t\t\tsaveInterval: 500\n\t\t\t\t},\n\t\t\t\tbindEvents: {\n\t\t\t\t\t'ready': function() {\n\t\n\t\t\t\t\t\tvar _suffix = \"-drafts-data\",\n\t\t\t\t\t\t\tkey = null;\n\t\n\t\t\t\t\t\tif (me.key) {\n\t\t\t\t\t\t\tkey = me.key + _suffix;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tkey = (me.container.parentNode.id || 'ue-common') + _suffix;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t//页面地址+编辑器ID 保持唯一\n\t\t\t\t\t\tsaveKey = (location.protocol + location.host + location.pathname).replace(/[.:\\/]/g, '_') + key;\n\t\n\t\t\t\t\t},\n\t\n\t\t\t\t\t'contentchange': function() {\n\t\n\t\t\t\t\t\tif (!saveKey) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (me._saveFlag) {\n\t\t\t\t\t\t\twindow.clearTimeout(me._saveFlag);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (me.options.saveInterval > 0) {\n\t\n\t\t\t\t\t\t\tme._saveFlag = window.setTimeout(function() {\n\t\n\t\t\t\t\t\t\t\tsave(me);\n\t\n\t\t\t\t\t\t\t}, me.options.saveInterval);\n\t\n\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\tsave(me);\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t'clearlocaldata': {\n\t\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\t\tif (saveKey && me.getPreferences(saveKey)) {\n\t\t\t\t\t\t\t\tme.removePreferences(saveKey)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\t\tignoreContentChange: true\n\t\t\t\t\t},\n\t\n\t\t\t\t\t'getlocaldata': {\n\t\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\t\treturn saveKey ? me.getPreferences(saveKey) || '' : '';\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\t\tignoreContentChange: true\n\t\t\t\t\t},\n\t\n\t\t\t\t\t'drafts': {\n\t\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\t\tif (saveKey) {\n\t\t\t\t\t\t\t\tme.body.innerHTML = me.getPreferences(saveKey) || '<p>' + domUtils.fillHtml + '</p>';\n\t\t\t\t\t\t\t\tme.focus(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\t\treturn saveKey ? (me.getPreferences(saveKey) === null ? -1 : 0) : -1;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\t\tignoreContentChange: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t});\n\t\n\t\t// plugins/charts.js\n\t\tUE.plugin.register('charts', function() {\n\t\n\t\t\tvar me = this;\n\t\n\t\t\treturn {\n\t\t\t\tbindEvents: {\n\t\t\t\t\t'chartserror': function() {}\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t'charts': {\n\t\t\t\t\t\texecCommand: function(cmd, data) {\n\t\n\t\t\t\t\t\t\tvar tableNode = domUtils.findParentByTagName(this.selection.getRange().startContainer, 'table', true),\n\t\t\t\t\t\t\t\tflagText = [],\n\t\t\t\t\t\t\t\tconfig = {};\n\t\n\t\t\t\t\t\t\tif (!tableNode) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (!validData(tableNode)) {\n\t\t\t\t\t\t\t\tme.fireEvent(\"chartserror\");\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tconfig.title = data.title || '';\n\t\t\t\t\t\t\tconfig.subTitle = data.subTitle || '';\n\t\t\t\t\t\t\tconfig.xTitle = data.xTitle || '';\n\t\t\t\t\t\t\tconfig.yTitle = data.yTitle || '';\n\t\t\t\t\t\t\tconfig.suffix = data.suffix || '';\n\t\t\t\t\t\t\tconfig.tip = data.tip || '';\n\t\t\t\t\t\t\t//数据对齐方式\n\t\t\t\t\t\t\tconfig.dataFormat = data.tableDataFormat || '';\n\t\t\t\t\t\t\t//图表类型\n\t\t\t\t\t\t\tconfig.chartType = data.chartType || 0;\n\t\n\t\t\t\t\t\t\tfor (var key in config) {\n\t\n\t\t\t\t\t\t\t\tif (!config.hasOwnProperty(key)) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tflagText.push(key + \":\" + config[key]);\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\ttableNode.setAttribute(\"data-chart\", flagText.join(\";\"));\n\t\t\t\t\t\t\tdomUtils.addClass(tableNode, \"edui-charts-table\");\n\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandState: function(cmd, name) {\n\t\n\t\t\t\t\t\t\tvar tableNode = domUtils.findParentByTagName(this.selection.getRange().startContainer, 'table', true);\n\t\t\t\t\t\t\treturn tableNode && validData(tableNode) ? 0 : -1;\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('table'), function(tableNode) {\n\t\n\t\t\t\t\t\tif (tableNode.getAttr(\"data-chart\") !== undefined) {\n\t\t\t\t\t\t\ttableNode.setAttr(\"style\");\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t})\n\t\n\t\t\t\t},\n\t\t\t\toutputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('table'), function(tableNode) {\n\t\n\t\t\t\t\t\tif (tableNode.getAttr(\"data-chart\") !== undefined) {\n\t\t\t\t\t\t\ttableNode.setAttr(\"style\", \"display: none;\");\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t})\n\t\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tfunction validData(table) {\n\t\n\t\t\t\tvar firstRows = null,\n\t\t\t\t\tcellCount = 0;\n\t\n\t\t\t\t//行数不够\n\t\t\t\tif (table.rows.length < 2) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t//列数不够\n\t\t\t\tif (table.rows[0].cells.length < 2) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t//第一行所有cell必须是th\n\t\t\t\tfirstRows = table.rows[0].cells;\n\t\t\t\tcellCount = firstRows.length;\n\t\n\t\t\t\tfor (var i = 0, cell; cell = firstRows[i]; i++) {\n\t\n\t\t\t\t\tif (cell.tagName.toLowerCase() !== 'th') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\tfor (var i = 1, row; row = table.rows[i]; i++) {\n\t\n\t\t\t\t\t//每行单元格数不匹配， 返回false\n\t\t\t\t\tif (row.cells.length != cellCount) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//第一列不是th也返回false\n\t\t\t\t\tif (row.cells[0].tagName.toLowerCase() !== 'th') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfor (var j = 1, cell; cell = row.cells[j]; j++) {\n\t\n\t\t\t\t\t\tvar value = utils.trim((cell.innerText || cell.textContent || ''));\n\t\n\t\t\t\t\t\tvalue = value.replace(new RegExp(UE.dom.domUtils.fillChar, 'g'), '').replace(/^\\s+|\\s+$/g, '');\n\t\n\t\t\t\t\t\t//必须是数字\n\t\t\t\t\t\tif (!/^\\d*\\.?\\d+$/.test(value)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\treturn true;\n\t\n\t\t\t}\n\t\n\t\t});\n\t\n\t\t// plugins/section.js\n\t\t/**\n\t\t * 目录大纲支持插件\n\t\t * @file\n\t\t * @since 1.3.0\n\t\t */\n\t\tUE.plugin.register('section', function() {\n\t\t\t/* 目录节点对象 */\n\t\t\tfunction Section(option) {\n\t\t\t\tthis.tag = '';\n\t\t\t\tthis.level = -1,\n\t\t\t\t\tthis.dom = null;\n\t\t\t\tthis.nextSection = null;\n\t\t\t\tthis.previousSection = null;\n\t\t\t\tthis.parentSection = null;\n\t\t\t\tthis.startAddress = [];\n\t\t\t\tthis.endAddress = [];\n\t\t\t\tthis.children = [];\n\t\t\t}\n\t\n\t\t\tfunction getSection(option) {\n\t\t\t\tvar section = new Section();\n\t\t\t\treturn utils.extend(section, option);\n\t\t\t}\n\t\n\t\t\tfunction getNodeFromAddress(startAddress, root) {\n\t\t\t\tvar current = root;\n\t\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\t\tif (!current.childNodes) return null;\n\t\t\t\t\tcurrent = current.childNodes[startAddress[i]];\n\t\t\t\t}\n\t\t\t\treturn current;\n\t\t\t}\n\t\n\t\t\tvar me = this;\n\t\n\t\t\treturn {\n\t\t\t\tbindMultiEvents: {\n\t\t\t\t\ttype: 'aftersetcontent afterscencerestore',\n\t\t\t\t\thandler: function() {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tbindEvents: {\n\t\t\t\t\t/* 初始化、拖拽、粘贴、执行setcontent之后 */\n\t\t\t\t\t'ready': function() {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\tdomUtils.on(me.body, 'drop paste', function() {\n\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t/* 执行paragraph命令之后 */\n\t\t\t\t\t'afterexeccommand': function(type, cmd) {\n\t\t\t\t\t\tif (cmd == 'paragraph') {\n\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t/* 部分键盘操作，触发updateSections事件 */\n\t\t\t\t\t'keyup': function(type, e) {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\tif (range.collapsed != true) {\n\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar keyCode = e.keyCode || e.which;\n\t\t\t\t\t\t\tif (keyCode == 13 || keyCode == 8 || keyCode == 46) {\n\t\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t'getsections': {\n\t\t\t\t\t\texecCommand: function(cmd, levels) {\n\t\t\t\t\t\t\tvar levelFn = levels || ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\t\n\t\t\t\t\t\t\tfor (var i = 0; i < levelFn.length; i++) {\n\t\t\t\t\t\t\t\tif (typeof levelFn[i] == 'string') {\n\t\t\t\t\t\t\t\t\tlevelFn[i] = function(fn) {\n\t\t\t\t\t\t\t\t\t\treturn function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn node.tagName == fn.toUpperCase()\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t}(levelFn[i]);\n\t\t\t\t\t\t\t\t} else if (typeof levelFn[i] != 'function') {\n\t\t\t\t\t\t\t\t\tlevelFn[i] = function(node) {\n\t\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tfunction getSectionLevel(node) {\n\t\t\t\t\t\t\t\tfor (var i = 0; i < levelFn.length; i++) {\n\t\t\t\t\t\t\t\t\tif (levelFn[i](node)) return i;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\tDirectory = getSection({\n\t\t\t\t\t\t\t\t\t'level': -1,\n\t\t\t\t\t\t\t\t\t'title': 'root'\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tprevious = Directory;\n\t\n\t\t\t\t\t\t\tfunction traversal(node, Directory) {\n\t\t\t\t\t\t\t\tvar level,\n\t\t\t\t\t\t\t\t\ttmpSection = null,\n\t\t\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\t\t\tchild,\n\t\t\t\t\t\t\t\t\tchildren = node.childNodes;\n\t\t\t\t\t\t\t\tfor (var i = 0, len = children.length; i < len; i++) {\n\t\t\t\t\t\t\t\t\tchild = children[i];\n\t\t\t\t\t\t\t\t\tlevel = getSectionLevel(child);\n\t\t\t\t\t\t\t\t\tif (level >= 0) {\n\t\t\t\t\t\t\t\t\t\tvar address = me.selection.getRange().selectNode(child).createAddress(true).startAddress,\n\t\t\t\t\t\t\t\t\t\t\tcurrent = getSection({\n\t\t\t\t\t\t\t\t\t\t\t\t'tag': child.tagName,\n\t\t\t\t\t\t\t\t\t\t\t\t'title': child.innerText || child.textContent || '',\n\t\t\t\t\t\t\t\t\t\t\t\t'level': level,\n\t\t\t\t\t\t\t\t\t\t\t\t'dom': child,\n\t\t\t\t\t\t\t\t\t\t\t\t'startAddress': utils.clone(address, []),\n\t\t\t\t\t\t\t\t\t\t\t\t'endAddress': utils.clone(address, []),\n\t\t\t\t\t\t\t\t\t\t\t\t'children': []\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tprevious.nextSection = current;\n\t\t\t\t\t\t\t\t\t\tcurrent.previousSection = previous;\n\t\t\t\t\t\t\t\t\t\tparent = previous;\n\t\t\t\t\t\t\t\t\t\twhile (level <= parent.level) {\n\t\t\t\t\t\t\t\t\t\t\tparent = parent.parentSection;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tcurrent.parentSection = parent;\n\t\t\t\t\t\t\t\t\t\tparent.children.push(current);\n\t\t\t\t\t\t\t\t\t\ttmpSection = previous = current;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tchild.nodeType === 1 && traversal(child, Directory);\n\t\t\t\t\t\t\t\t\t\ttmpSection && tmpSection.endAddress[tmpSection.endAddress.length - 1]++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttraversal(me.body, Directory);\n\t\t\t\t\t\t\treturn Directory;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t\t},\n\t\t\t\t\t'movesection': {\n\t\t\t\t\t\texecCommand: function(cmd, sourceSection, targetSection, isAfter) {\n\t\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\ttargetAddress,\n\t\t\t\t\t\t\t\ttarget;\n\t\n\t\t\t\t\t\t\tif (!sourceSection || !targetSection || targetSection.level == -1) return;\n\t\n\t\t\t\t\t\t\ttargetAddress = isAfter ? targetSection.endAddress : targetSection.startAddress;\n\t\t\t\t\t\t\ttarget = getNodeFromAddress(targetAddress, me.body);\n\t\n\t\t\t\t\t\t\t/* 判断目标地址是否被源章节包含 */\n\t\t\t\t\t\t\tif (!targetAddress || !target || isContainsAddress(sourceSection.startAddress, sourceSection.endAddress, targetAddress)) return;\n\t\n\t\t\t\t\t\t\tvar startNode = getNodeFromAddress(sourceSection.startAddress, me.body),\n\t\t\t\t\t\t\t\tendNode = getNodeFromAddress(sourceSection.endAddress, me.body),\n\t\t\t\t\t\t\t\tcurrent,\n\t\t\t\t\t\t\t\tnextNode;\n\t\n\t\t\t\t\t\t\tif (isAfter) {\n\t\t\t\t\t\t\t\tcurrent = endNode;\n\t\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(startNode, current) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\t\tnextNode = current.previousSibling;\n\t\t\t\t\t\t\t\t\tdomUtils.insertAfter(target, current);\n\t\t\t\t\t\t\t\t\tif (current == startNode) break;\n\t\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcurrent = startNode;\n\t\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, endNode) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\t\tnextNode = current.nextSibling;\n\t\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(current, target);\n\t\t\t\t\t\t\t\t\tif (current == endNode) break;\n\t\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\n\t\t\t\t\t\t\t/* 获取地址的包含关系 */\n\t\t\t\t\t\t\tfunction isContainsAddress(startAddress, endAddress, addressTarget) {\n\t\t\t\t\t\t\t\tvar isAfterStartAddress = false,\n\t\t\t\t\t\t\t\t\tisBeforeEndAddress = false;\n\t\t\t\t\t\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\t\t\t\t\t\tif (i >= addressTarget.length) break;\n\t\t\t\t\t\t\t\t\tif (addressTarget[i] > startAddress[i]) {\n\t\t\t\t\t\t\t\t\t\tisAfterStartAddress = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else if (addressTarget[i] < startAddress[i]) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (var i = 0; i < endAddress.length; i++) {\n\t\t\t\t\t\t\t\t\tif (i >= addressTarget.length) break;\n\t\t\t\t\t\t\t\t\tif (addressTarget[i] < startAddress[i]) {\n\t\t\t\t\t\t\t\t\t\tisBeforeEndAddress = true;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t} else if (addressTarget[i] > startAddress[i]) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn isAfterStartAddress && isBeforeEndAddress;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t'deletesection': {\n\t\t\t\t\t\texecCommand: function(cmd, section, keepChildren) {\n\t\t\t\t\t\t\tvar me = this;\n\t\n\t\t\t\t\t\t\tif (!section) return;\n\t\n\t\t\t\t\t\t\tfunction getNodeFromAddress(startAddress) {\n\t\t\t\t\t\t\t\tvar current = me.body;\n\t\t\t\t\t\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\t\t\t\t\t\tif (!current.childNodes) return null;\n\t\t\t\t\t\t\t\t\tcurrent = current.childNodes[startAddress[i]];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn current;\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tvar startNode = getNodeFromAddress(section.startAddress),\n\t\t\t\t\t\t\t\tendNode = getNodeFromAddress(section.endAddress),\n\t\t\t\t\t\t\t\tcurrent = startNode,\n\t\t\t\t\t\t\t\tnextNode;\n\t\n\t\t\t\t\t\t\tif (!keepChildren) {\n\t\t\t\t\t\t\t\twhile (current && domUtils.inDoc(endNode, me.document) && !(domUtils.getPosition(current, endNode) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\t\tnextNode = current.nextSibling;\n\t\t\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t'selectsection': {\n\t\t\t\t\t\texecCommand: function(cmd, section) {\n\t\t\t\t\t\t\tif (!section && !section.dom) return false;\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\t\t\t\taddress = {\n\t\t\t\t\t\t\t\t\t'startAddress': utils.clone(section.startAddress, []),\n\t\t\t\t\t\t\t\t\t'endAddress': utils.clone(section.endAddress, [])\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\taddress.endAddress[address.endAddress.length - 1]++;\n\t\t\t\t\t\t\trange.moveToAddress(address).select().scrollToView();\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t\t},\n\t\t\t\t\t'scrolltosection': {\n\t\t\t\t\t\texecCommand: function(cmd, section) {\n\t\t\t\t\t\t\tif (!section && !section.dom) return false;\n\t\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\t\t\t\taddress = {\n\t\t\t\t\t\t\t\t\t'startAddress': section.startAddress,\n\t\t\t\t\t\t\t\t\t'endAddress': section.endAddress\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\taddress.endAddress[address.endAddress.length - 1]++;\n\t\t\t\t\t\t\trange.moveToAddress(address).scrollToView();\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/simpleupload.js\n\t\t/**\n\t\t * @description\n\t\t * 简单上传:点击按钮,直接选择文件上传\n\t\t * @author Jinqn\n\t\t * @date 2014-03-31\n\t\t */\n\t\tUE.plugin.register('simpleupload', function() {\n\t\t\tvar me = this,\n\t\t\t\tisLoaded = false,\n\t\t\t\tcontainerBtn;\n\t\n\t\t\tfunction initUploadBtn() {\n\t\t\t\tvar w = containerBtn.offsetWidth || 20,\n\t\t\t\t\th = containerBtn.offsetHeight || 20,\n\t\t\t\t\tbtnIframe = document.createElement('iframe'),\n\t\t\t\t\tbtnStyle = 'display:block;width:' + w + 'px;height:' + h + 'px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;';\n\t\n\t\t\t\tdomUtils.on(btnIframe, 'load', function() {\n\t\n\t\t\t\t\tvar timestrap = (+new Date()).toString(36),\n\t\t\t\t\t\twrapper,\n\t\t\t\t\t\tbtnIframeDoc,\n\t\t\t\t\t\tbtnIframeBody;\n\t\n\t\t\t\t\tbtnIframeDoc = (btnIframe.contentDocument || btnIframe.contentWindow.document);\n\t\t\t\t\tbtnIframeBody = btnIframeDoc.body;\n\t\t\t\t\twrapper = btnIframeDoc.createElement('div');\n\t\n\t\t\t\t\twrapper.innerHTML = '<form id=\"edui_form_' + timestrap + '\" target=\"edui_iframe_' + timestrap + '\" method=\"POST\" enctype=\"multipart/form-data\" action=\"' + me.getOpt('serverUrl') + '\" ' +\n\t\t\t\t\t\t'style=\"' + btnStyle + '\">' +\n\t\t\t\t\t\t'<input id=\"edui_input_' + timestrap + '\" type=\"file\" accept=\"image/*\" name=\"' + me.options.imageFieldName + '\" ' +\n\t\t\t\t\t\t'style=\"' + btnStyle + '\">' +\n\t\t\t\t\t\t'</form>' +\n\t\t\t\t\t\t'<iframe id=\"edui_iframe_' + timestrap + '\" name=\"edui_iframe_' + timestrap + '\" style=\"display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;\"></iframe>';\n\t\n\t\t\t\t\twrapper.className = 'edui-' + me.options.theme;\n\t\t\t\t\twrapper.id = me.ui.id + '_iframeupload';\n\t\t\t\t\tbtnIframeBody.style.cssText = btnStyle;\n\t\t\t\t\tbtnIframeBody.style.width = w + 'px';\n\t\t\t\t\tbtnIframeBody.style.height = h + 'px';\n\t\t\t\t\tbtnIframeBody.appendChild(wrapper);\n\t\n\t\t\t\t\tif (btnIframeBody.parentNode) {\n\t\t\t\t\t\tbtnIframeBody.parentNode.style.width = w + 'px';\n\t\t\t\t\t\tbtnIframeBody.parentNode.style.height = w + 'px';\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar form = btnIframeDoc.getElementById('edui_form_' + timestrap);\n\t\t\t\t\tvar input = btnIframeDoc.getElementById('edui_input_' + timestrap);\n\t\t\t\t\tvar iframe = btnIframeDoc.getElementById('edui_iframe_' + timestrap);\n\t\n\t\t\t\t\tdomUtils.on(input, 'change', function() {\n\t\t\t\t\t\tif (!input.value) return;\n\t\t\t\t\t\tvar loadingId = 'loading_' + (+new Date()).toString(36);\n\t\t\t\t\t\tvar params = utils.serializeParam(me.queryCommandValue('serverparam')) || '';\n\t\n\t\t\t\t\t\tvar imageActionUrl = me.getActionUrl(me.getOpt('imageActionName'));\n\t\t\t\t\t\tvar allowFiles = me.getOpt('imageAllowFiles');\n\t\n\t\t\t\t\t\tme.focus();\n\t\t\t\t\t\tme.execCommand('inserthtml', '<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' + me.options.themePath + me.options.theme + '/images/spacer.gif\" title=\"' + (me.getLang('simpleupload.loading') || '') + '\" >');\n\t\n\t\t\t\t\t\tfunction callback() {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tvar link, json, loader,\n\t\t\t\t\t\t\t\t\tbody = (iframe.contentDocument || iframe.contentWindow.document).body,\n\t\t\t\t\t\t\t\t\tresult = body.innerText || body.textContent || '';\n\t\t\t\t\t\t\t\tjson = (new Function(\"return \" + result))();\n\t\t\t\t\t\t\t\tlink = me.options.imageUrlPrefix + json.url;\n\t\t\t\t\t\t\t\tif (json.state == 'SUCCESS' && json.url) {\n\t\t\t\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\t\t\t\t\t\t\t\t\tloader.setAttribute('src', link);\n\t\t\t\t\t\t\t\t\tloader.setAttribute('_src', link);\n\t\t\t\t\t\t\t\t\tloader.setAttribute('title', json.title || '');\n\t\t\t\t\t\t\t\t\tloader.setAttribute('alt', json.original || '');\n\t\t\t\t\t\t\t\t\tloader.removeAttribute('id');\n\t\t\t\t\t\t\t\t\tdomUtils.removeClasses(loader, 'loadingclass');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tshowErrorLoader && showErrorLoader(json.state);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch (er) {\n\t\t\t\t\t\t\t\tshowErrorLoader && showErrorLoader(me.getLang('simpleupload.loadError'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tform.reset();\n\t\t\t\t\t\t\tdomUtils.un(iframe, 'load', callback);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tfunction showErrorLoader(title) {\n\t\t\t\t\t\t\tif (loadingId) {\n\t\t\t\t\t\t\t\tvar loader = me.document.getElementById(loadingId);\n\t\t\t\t\t\t\t\tloader && domUtils.remove(loader);\n\t\t\t\t\t\t\t\tme.fireEvent('showmessage', {\n\t\t\t\t\t\t\t\t\t'id': loadingId,\n\t\t\t\t\t\t\t\t\t'content': title,\n\t\t\t\t\t\t\t\t\t'type': 'error',\n\t\t\t\t\t\t\t\t\t'timeout': 4000\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t/* 判断后端配置是否没有加载成功 */\n\t\t\t\t\t\tif (!me.getOpt('imageActionName')) {\n\t\t\t\t\t\t\terrorHandler(me.getLang('autoupload.errorLoadConfig'));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// 判断文件格式是否错误\n\t\t\t\t\t\tvar filename = input.value,\n\t\t\t\t\t\t\tfileext = filename ? filename.substr(filename.lastIndexOf('.')) : '';\n\t\t\t\t\t\tif (!fileext || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {\n\t\t\t\t\t\t\tshowErrorLoader(me.getLang('simpleupload.exceedTypeError'));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tdomUtils.on(iframe, 'load', callback);\n\t\t\t\t\t\tform.action = utils.formatUrl(imageActionUrl + (imageActionUrl.indexOf('?') == -1 ? '?' : '&') + params);\n\t\t\t\t\t\tform.submit();\n\t\t\t\t\t});\n\t\n\t\t\t\t\tvar stateTimer;\n\t\t\t\t\tme.addListener('selectionchange', function() {\n\t\t\t\t\t\tclearTimeout(stateTimer);\n\t\t\t\t\t\tstateTimer = setTimeout(function() {\n\t\t\t\t\t\t\tvar state = me.queryCommandState('simpleupload');\n\t\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\t\tinput.disabled = 'disabled';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tinput.disabled = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 400);\n\t\t\t\t\t});\n\t\t\t\t\tisLoaded = true;\n\t\t\t\t});\n\t\n\t\t\t\tbtnIframe.style.cssText = btnStyle;\n\t\t\t\tcontainerBtn.appendChild(btnIframe);\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\tbindEvents: {\n\t\t\t\t\t'ready': function() {\n\t\t\t\t\t\t//设置loading的样式\n\t\t\t\t\t\tutils.cssRule('loading',\n\t\t\t\t\t\t\t'.loadingclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loading.gif\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\\n' +\n\t\t\t\t\t\t\t'.loaderrorclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loaderror.png\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +\n\t\t\t\t\t\t\t'}',\n\t\t\t\t\t\t\tthis.document);\n\t\t\t\t\t},\n\t\t\t\t\t/* 初始化简单上传按钮 */\n\t\t\t\t\t'simpleuploadbtnready': function(type, container) {\n\t\t\t\t\t\tcontainerBtn = container;\n\t\t\t\t\t\tme.afterConfigReady(initUploadBtn);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\toutputRule: function(root) {\n\t\t\t\t\tutils.each(root.getNodesByTagName('img'), function(n) {\n\t\t\t\t\t\tif (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tcommands: {\n\t\t\t\t\t'simpleupload': {\n\t\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\t\treturn isLoaded ? 0 : -1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/serverparam.js\n\t\t/**\n\t\t * 服务器提交的额外参数列表设置插件\n\t\t * @file\n\t\t * @since 1.2.6.1\n\t\t */\n\t\tUE.plugin.register('serverparam', function() {\n\t\n\t\t\tvar me = this,\n\t\t\t\tserverParam = {};\n\t\n\t\t\treturn {\n\t\t\t\tcommands: {\n\t\t\t\t\t/**\n\t\t\t\t\t * 修改服务器提交的额外参数列表,清除所有项\n\t\t\t\t\t * @command serverparam\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * editor.execCommand('serverparam');\n\t\t\t\t\t * editor.queryCommandValue('serverparam'); //返回空\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t/**\n\t\t\t\t\t * 修改服务器提交的额外参数列表,删除指定项\n\t\t\t\t\t * @command serverparam\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @param { String } key 要清除的属性\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * editor.execCommand('serverparam', 'name'); //删除属性name\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t/**\n\t\t\t\t\t * 修改服务器提交的额外参数列表,使用键值添加项\n\t\t\t\t\t * @command serverparam\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @param { String } key 要添加的属性\n\t\t\t\t\t * @param { String } value 要添加属性的值\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * editor.execCommand('serverparam', 'name', 'hello');\n\t\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'name': 'hello'}\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t/**\n\t\t\t\t\t * 修改服务器提交的额外参数列表,传入键值对对象添加多项\n\t\t\t\t\t * @command serverparam\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @param { Object } key 传入的键值对对象\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * editor.execCommand('serverparam', {'name': 'hello'});\n\t\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'name': 'hello'}\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t/**\n\t\t\t\t\t * 修改服务器提交的额外参数列表,使用自定义函数添加多项\n\t\t\t\t\t * @command serverparam\n\t\t\t\t\t * @method execCommand\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @param { Function } key 自定义获取参数的函数\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * editor.execCommand('serverparam', function(editor){\n\t\t\t\t\t *     return {'key': 'value'};\n\t\t\t\t\t * });\n\t\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'key': 'value'}\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\n\t\t\t\t\t/**\n\t\t\t\t\t * 获取服务器提交的额外参数列表\n\t\t\t\t\t * @command serverparam\n\t\t\t\t\t * @method queryCommandValue\n\t\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t\t * @example\n\t\t\t\t\t * ```javascript\n\t\t\t\t\t * editor.queryCommandValue( 'serverparam' ); //返回对象 {'key': 'value'}\n\t\t\t\t\t * ```\n\t\t\t\t\t */\n\t\t\t\t\t'serverparam': {\n\t\t\t\t\t\texecCommand: function(cmd, key, value) {\n\t\t\t\t\t\t\tif (key === undefined || key === null) { //不传参数,清空列表\n\t\t\t\t\t\t\t\tserverParam = {};\n\t\t\t\t\t\t\t} else if (utils.isString(key)) { //传入键值\n\t\t\t\t\t\t\t\tif (value === undefined || value === null) {\n\t\t\t\t\t\t\t\t\tdelete serverParam[key];\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tserverParam[key] = value;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (utils.isObject(key)) { //传入对象,覆盖列表项\n\t\t\t\t\t\t\t\tutils.extend(serverParam, key, true);\n\t\t\t\t\t\t\t} else if (utils.isFunction(key)) { //传入函数,添加列表项\n\t\t\t\t\t\t\t\tutils.extend(serverParam, key(), true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\t\t\treturn serverParam || {};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/insertfile.js\n\t\t/**\n\t\t * 插入附件\n\t\t */\n\t\tUE.plugin.register('insertfile', function() {\n\t\n\t\t\tvar me = this;\n\t\n\t\t\tfunction getFileIcon(url) {\n\t\t\t\tvar ext = url.substr(url.lastIndexOf('.') + 1).toLowerCase(),\n\t\t\t\t\tmaps = {\n\t\t\t\t\t\t\"rar\": \"icon_rar.gif\",\n\t\t\t\t\t\t\"zip\": \"icon_rar.gif\",\n\t\t\t\t\t\t\"tar\": \"icon_rar.gif\",\n\t\t\t\t\t\t\"gz\": \"icon_rar.gif\",\n\t\t\t\t\t\t\"bz2\": \"icon_rar.gif\",\n\t\t\t\t\t\t\"doc\": \"icon_doc.gif\",\n\t\t\t\t\t\t\"docx\": \"icon_doc.gif\",\n\t\t\t\t\t\t\"pdf\": \"icon_pdf.gif\",\n\t\t\t\t\t\t\"mp3\": \"icon_mp3.gif\",\n\t\t\t\t\t\t\"xls\": \"icon_xls.gif\",\n\t\t\t\t\t\t\"chm\": \"icon_chm.gif\",\n\t\t\t\t\t\t\"ppt\": \"icon_ppt.gif\",\n\t\t\t\t\t\t\"pptx\": \"icon_ppt.gif\",\n\t\t\t\t\t\t\"avi\": \"icon_mv.gif\",\n\t\t\t\t\t\t\"rmvb\": \"icon_mv.gif\",\n\t\t\t\t\t\t\"wmv\": \"icon_mv.gif\",\n\t\t\t\t\t\t\"flv\": \"icon_mv.gif\",\n\t\t\t\t\t\t\"swf\": \"icon_mv.gif\",\n\t\t\t\t\t\t\"rm\": \"icon_mv.gif\",\n\t\t\t\t\t\t\"exe\": \"icon_exe.gif\",\n\t\t\t\t\t\t\"psd\": \"icon_psd.gif\",\n\t\t\t\t\t\t\"txt\": \"icon_txt.gif\",\n\t\t\t\t\t\t\"jpg\": \"icon_jpg.gif\",\n\t\t\t\t\t\t\"png\": \"icon_jpg.gif\",\n\t\t\t\t\t\t\"jpeg\": \"icon_jpg.gif\",\n\t\t\t\t\t\t\"gif\": \"icon_jpg.gif\",\n\t\t\t\t\t\t\"ico\": \"icon_jpg.gif\",\n\t\t\t\t\t\t\"bmp\": \"icon_jpg.gif\"\n\t\t\t\t\t};\n\t\t\t\treturn maps[ext] ? maps[ext] : maps['txt'];\n\t\t\t}\n\t\n\t\t\treturn {\n\t\t\t\tcommands: {\n\t\t\t\t\t'insertfile': {\n\t\t\t\t\t\texecCommand: function(command, filelist) {\n\t\t\t\t\t\t\tfilelist = utils.isArray(filelist) ? filelist : [filelist];\n\t\n\t\t\t\t\t\t\tvar i, item, icon, title,\n\t\t\t\t\t\t\t\thtml = '',\n\t\t\t\t\t\t\t\tURL = me.getOpt('UEDITOR_HOME_URL'),\n\t\t\t\t\t\t\t\ticonDir = URL + (URL.substr(URL.length - 1) == '/' ? '' : '/') + 'dialogs/attachment/fileTypeImages/';\n\t\t\t\t\t\t\tfor (i = 0; i < filelist.length; i++) {\n\t\t\t\t\t\t\t\titem = filelist[i];\n\t\t\t\t\t\t\t\ticon = iconDir + getFileIcon(item.url);\n\t\t\t\t\t\t\t\ttitle = item.title || item.url.substr(item.url.lastIndexOf('/') + 1);\n\t\t\t\t\t\t\t\thtml += '<p style=\"line-height: 16px;\">' +\n\t\t\t\t\t\t\t\t\t'<img style=\"vertical-align: middle; margin-right: 2px;\" src=\"' + icon + '\" _src=\"' + icon + '\" />' +\n\t\t\t\t\t\t\t\t\t'<a style=\"font-size:12px; color:#0066cc;\" href=\"' + item.url + '\" title=\"' + title + '\">' + title + '</a>' +\n\t\t\t\t\t\t\t\t\t'</p>';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.execCommand('insertHtml', html);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\n\t\t// plugins/xssFilter.js\n\t\t/**\n\t\t * @file xssFilter.js\n\t\t * @desc xss过滤器\n\t\t * @author robbenmu\n\t\t */\n\t\n\t\tUE.plugins.xssFilter = function() {\n\t\n\t\t\tvar config = UEDITOR_CONFIG;\n\t\t\tvar whitList = config.whitList;\n\t\n\t\t\tfunction filter(node) {\n\t\n\t\t\t\tvar tagName = node.tagName;\n\t\t\t\tvar attrs = node.attrs;\n\t\n\t\t\t\tif (!whitList.hasOwnProperty(tagName)) {\n\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\tUE.utils.each(attrs, function(val, key) {\n\t\n\t\t\t\t\tif (whitList[tagName].indexOf(key) === -1) {\n\t\t\t\t\t\tnode.setAttr(key);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t\t// 添加inserthtml\\paste等操作用的过滤规则\n\t\t\tif (whitList && config.xssFilterRules) {\n\t\t\t\tthis.options.filterRules = function() {\n\t\n\t\t\t\t\tvar result = {};\n\t\n\t\t\t\t\tUE.utils.each(whitList, function(val, key) {\n\t\t\t\t\t\tresult[key] = function(node) {\n\t\t\t\t\t\t\treturn filter(node);\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\n\t\t\t\t\treturn result;\n\t\t\t\t}();\n\t\t\t}\n\t\n\t\t\tvar tagList = [];\n\t\n\t\t\tUE.utils.each(whitList, function(val, key) {\n\t\t\t\ttagList.push(key);\n\t\t\t});\n\t\n\t\t\t// 添加input过滤规则\n\t\t\t//\n\t\t\tif (whitList && config.inputXssFilter) {\n\t\t\t\tthis.addInputRule(function(root) {\n\t\n\t\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\t\tif (node.type !== 'element') {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfilter(node);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t\t// 添加output过滤规则\n\t\t\t//\n\t\t\tif (whitList && config.outputXssFilter) {\n\t\t\t\tthis.addOutputRule(function(root) {\n\t\n\t\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\t\tif (node.type !== 'element') {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfilter(node);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t};\n\t\n\t\t// ui/ui.js\n\t\tvar baidu = baidu || {};\n\t\tbaidu.editor = baidu.editor || {};\n\t\tUE.ui = baidu.editor.ui = {};\n\t\n\t\t// ui/uiutils.js\n\t\t(function() {\n\t\t\tvar browser = baidu.editor.browser,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\t\n\t\t\tvar magic = '$EDITORUI';\n\t\t\tvar root = window[magic] = {};\n\t\t\tvar uidMagic = 'ID' + magic;\n\t\t\tvar uidCount = 0;\n\t\n\t\t\tvar uiUtils = baidu.editor.ui.uiUtils = {\n\t\t\t\tuid: function(obj) {\n\t\t\t\t\treturn (obj ? obj[uidMagic] || (obj[uidMagic] = ++uidCount) : ++uidCount);\n\t\t\t\t},\n\t\t\t\thook: function(fn, callback) {\n\t\t\t\t\tvar dg;\n\t\t\t\t\tif (fn && fn._callbacks) {\n\t\t\t\t\t\tdg = fn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdg = function() {\n\t\t\t\t\t\t\tvar q;\n\t\t\t\t\t\t\tif (fn) {\n\t\t\t\t\t\t\t\tq = fn.apply(this, arguments);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar callbacks = dg._callbacks;\n\t\t\t\t\t\t\tvar k = callbacks.length;\n\t\t\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\t\t\tvar r = callbacks[k].apply(this, arguments);\n\t\t\t\t\t\t\t\tif (q === undefined) {\n\t\t\t\t\t\t\t\t\tq = r;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn q;\n\t\t\t\t\t\t};\n\t\t\t\t\t\tdg._callbacks = [];\n\t\t\t\t\t}\n\t\t\t\t\tdg._callbacks.push(callback);\n\t\t\t\t\treturn dg;\n\t\t\t\t},\n\t\t\t\tcreateElementByHtml: function(html) {\n\t\t\t\t\tvar el = document.createElement('div');\n\t\t\t\t\tel.innerHTML = html;\n\t\t\t\t\tel = el.firstChild;\n\t\t\t\t\tel.parentNode.removeChild(el);\n\t\t\t\t\treturn el;\n\t\t\t\t},\n\t\t\t\tgetViewportElement: function() {\n\t\t\t\t\treturn (browser.ie && browser.quirks) ?\n\t\t\t\t\t\tdocument.body : document.documentElement;\n\t\t\t\t},\n\t\t\t\tgetClientRect: function(element) {\n\t\t\t\t\tvar bcr;\n\t\t\t\t\t//trace  IE6下在控制编辑器显隐时可能会报错，catch一下\n\t\t\t\t\ttry {\n\t\t\t\t\t\tbcr = element.getBoundingClientRect();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tbcr = {\n\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\t\twidth: 0\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar rect = {\n\t\t\t\t\t\tleft: Math.round(bcr.left),\n\t\t\t\t\t\ttop: Math.round(bcr.top),\n\t\t\t\t\t\theight: Math.round(bcr.bottom - bcr.top),\n\t\t\t\t\t\twidth: Math.round(bcr.right - bcr.left)\n\t\t\t\t\t};\n\t\t\t\t\tvar doc;\n\t\t\t\t\twhile ((doc = element.ownerDocument) !== document &&\n\t\t\t\t\t\t(element = domUtils.getWindow(doc).frameElement)) {\n\t\t\t\t\t\tbcr = element.getBoundingClientRect();\n\t\t\t\t\t\trect.left += bcr.left;\n\t\t\t\t\t\trect.top += bcr.top;\n\t\t\t\t\t}\n\t\t\t\t\trect.bottom = rect.top + rect.height;\n\t\t\t\t\trect.right = rect.left + rect.width;\n\t\t\t\t\treturn rect;\n\t\t\t\t},\n\t\t\t\tgetViewportRect: function() {\n\t\t\t\t\tvar viewportEl = uiUtils.getViewportElement();\n\t\t\t\t\tvar width = (window.innerWidth || viewportEl.clientWidth) | 0;\n\t\t\t\t\tvar height = (window.innerHeight || viewportEl.clientHeight) | 0;\n\t\t\t\t\treturn {\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\theight: height,\n\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\tbottom: height,\n\t\t\t\t\t\tright: width\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tsetViewportOffset: function(element, offset) {\n\t\t\t\t\tvar rect;\n\t\t\t\t\tvar fixedLayer = uiUtils.getFixedLayer();\n\t\t\t\t\tif (element.parentNode === fixedLayer) {\n\t\t\t\t\t\telement.style.left = offset.left + 'px';\n\t\t\t\t\t\telement.style.top = offset.top + 'px';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomUtils.setViewportOffset(element, offset);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetEventOffset: function(evt) {\n\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\tvar rect = uiUtils.getClientRect(el);\n\t\t\t\t\tvar offset = uiUtils.getViewportOffsetByEvent(evt);\n\t\t\t\t\treturn {\n\t\t\t\t\t\tleft: offset.left - rect.left,\n\t\t\t\t\t\ttop: offset.top - rect.top\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tgetViewportOffsetByEvent: function(evt) {\n\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\tvar frameEl = domUtils.getWindow(el).frameElement;\n\t\t\t\t\tvar offset = {\n\t\t\t\t\t\tleft: evt.clientX,\n\t\t\t\t\t\ttop: evt.clientY\n\t\t\t\t\t};\n\t\t\t\t\tif (frameEl && el.ownerDocument !== document) {\n\t\t\t\t\t\tvar rect = uiUtils.getClientRect(frameEl);\n\t\t\t\t\t\toffset.left += rect.left;\n\t\t\t\t\t\toffset.top += rect.top;\n\t\t\t\t\t}\n\t\t\t\t\treturn offset;\n\t\t\t\t},\n\t\t\t\tsetGlobal: function(id, obj) {\n\t\t\t\t\troot[id] = obj;\n\t\t\t\t\treturn magic + '[\"' + id + '\"]';\n\t\t\t\t},\n\t\t\t\tunsetGlobal: function(id) {\n\t\t\t\t\tdelete root[id];\n\t\t\t\t},\n\t\t\t\tcopyAttributes: function(tgt, src) {\n\t\t\t\t\tvar attributes = src.attributes;\n\t\t\t\t\tvar k = attributes.length;\n\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\tvar attrNode = attributes[k];\n\t\t\t\t\t\tif (attrNode.nodeName != 'style' && attrNode.nodeName != 'class' && (!browser.ie || attrNode.specified)) {\n\t\t\t\t\t\t\ttgt.setAttribute(attrNode.nodeName, attrNode.nodeValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (src.className) {\n\t\t\t\t\t\tdomUtils.addClass(tgt, src.className);\n\t\t\t\t\t}\n\t\t\t\t\tif (src.style.cssText) {\n\t\t\t\t\t\ttgt.style.cssText += ';' + src.style.cssText;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveStyle: function(el, styleName) {\n\t\t\t\t\tif (el.style.removeProperty) {\n\t\t\t\t\t\tel.style.removeProperty(styleName);\n\t\t\t\t\t} else if (el.style.removeAttribute) {\n\t\t\t\t\t\tel.style.removeAttribute(styleName);\n\t\t\t\t\t} else throw '';\n\t\t\t\t},\n\t\t\t\tcontains: function(elA, elB) {\n\t\t\t\t\treturn elA && elB && (elA === elB ? false : (\n\t\t\t\t\t\telA.contains ? elA.contains(elB) :\n\t\t\t\t\t\telA.compareDocumentPosition(elB) & 16\n\t\t\t\t\t));\n\t\t\t\t},\n\t\t\t\tstartDrag: function(evt, callbacks, doc) {\n\t\t\t\t\tvar doc = doc || document;\n\t\t\t\t\tvar startX = evt.clientX;\n\t\t\t\t\tvar startY = evt.clientY;\n\t\n\t\t\t\t\tfunction handleMouseMove(evt) {\n\t\t\t\t\t\tvar x = evt.clientX - startX;\n\t\t\t\t\t\tvar y = evt.clientY - startY;\n\t\t\t\t\t\tcallbacks.ondragmove(x, y, evt);\n\t\t\t\t\t\tif (evt.stopPropagation) {\n\t\t\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tevt.cancelBubble = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (doc.addEventListener) {\n\t\t\t\t\t\tfunction handleMouseUp(evt) {\n\t\t\t\t\t\t\tdoc.removeEventListener('mousemove', handleMouseMove, true);\n\t\t\t\t\t\t\tdoc.removeEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\t\t\twindow.removeEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\t\t\tcallbacks.ondragstop();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdoc.addEventListener('mousemove', handleMouseMove, true);\n\t\t\t\t\t\tdoc.addEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\t\twindow.addEventListener('mouseup', handleMouseUp, true);\n\t\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar elm = evt.srcElement;\n\t\t\t\t\t\telm.setCapture();\n\t\n\t\t\t\t\t\tfunction releaseCaptrue() {\n\t\t\t\t\t\t\telm.releaseCapture();\n\t\t\t\t\t\t\telm.detachEvent('onmousemove', handleMouseMove);\n\t\t\t\t\t\t\telm.detachEvent('onmouseup', releaseCaptrue);\n\t\t\t\t\t\t\telm.detachEvent('onlosecaptrue', releaseCaptrue);\n\t\t\t\t\t\t\tcallbacks.ondragstop();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telm.attachEvent('onmousemove', handleMouseMove);\n\t\t\t\t\t\telm.attachEvent('onmouseup', releaseCaptrue);\n\t\t\t\t\t\telm.attachEvent('onlosecaptrue', releaseCaptrue);\n\t\t\t\t\t\tevt.returnValue = false;\n\t\t\t\t\t}\n\t\t\t\t\tcallbacks.ondragstart();\n\t\t\t\t},\n\t\t\t\tgetFixedLayer: function() {\n\t\t\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\t\t\tif (layer == null) {\n\t\t\t\t\t\tlayer = document.createElement('div');\n\t\t\t\t\t\tlayer.id = 'edui_fixedlayer';\n\t\t\t\t\t\tdocument.body.appendChild(layer);\n\t\t\t\t\t\tif (browser.ie && browser.version <= 8) {\n\t\t\t\t\t\t\tlayer.style.position = 'absolute';\n\t\t\t\t\t\t\tbindFixedLayer();\n\t\t\t\t\t\t\tsetTimeout(updateFixedOffset);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlayer.style.position = 'fixed';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlayer.style.left = '0';\n\t\t\t\t\t\tlayer.style.top = '0';\n\t\t\t\t\t\tlayer.style.width = '0';\n\t\t\t\t\t\tlayer.style.height = '0';\n\t\t\t\t\t}\n\t\t\t\t\treturn layer;\n\t\t\t\t},\n\t\t\t\tmakeUnselectable: function(element) {\n\t\t\t\t\tif (browser.opera || (browser.ie && browser.version < 9)) {\n\t\t\t\t\t\telement.unselectable = 'on';\n\t\t\t\t\t\tif (element.hasChildNodes()) {\n\t\t\t\t\t\t\tfor (var i = 0; i < element.childNodes.length; i++) {\n\t\t\t\t\t\t\t\tif (element.childNodes[i].nodeType == 1) {\n\t\t\t\t\t\t\t\t\tuiUtils.makeUnselectable(element.childNodes[i]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (element.style.MozUserSelect !== undefined) {\n\t\t\t\t\t\t\telement.style.MozUserSelect = 'none';\n\t\t\t\t\t\t} else if (element.style.WebkitUserSelect !== undefined) {\n\t\t\t\t\t\t\telement.style.WebkitUserSelect = 'none';\n\t\t\t\t\t\t} else if (element.style.KhtmlUserSelect !== undefined) {\n\t\t\t\t\t\t\telement.style.KhtmlUserSelect = 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tfunction updateFixedOffset() {\n\t\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\t\tuiUtils.setViewportOffset(layer, {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0\n\t\t\t\t});\n\t\t\t\t//        layer.style.display = 'none';\n\t\t\t\t//        layer.style.display = 'block';\n\t\n\t\t\t\t//#trace: 1354\n\t\t\t\t//        setTimeout(updateFixedOffset);\n\t\t\t}\n\t\n\t\t\tfunction bindFixedLayer(adjOffset) {\n\t\t\t\tdomUtils.on(window, 'scroll', updateFixedOffset);\n\t\t\t\tdomUtils.on(window, 'resize', baidu.editor.utils.defer(updateFixedOffset, 0, true));\n\t\t\t}\n\t\t})();\n\t\n\t\t// ui/uibase.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tEventBase = baidu.editor.EventBase,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase = function() {};\n\t\n\t\t\tUIBase.prototype = {\n\t\t\t\tclassName: '',\n\t\t\t\tuiName: '',\n\t\t\t\tinitOptions: function(options) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tfor (var k in options) {\n\t\t\t\t\t\tme[k] = options[k];\n\t\t\t\t\t}\n\t\t\t\t\tthis.id = this.id || 'edui' + uiUtils.uid();\n\t\t\t\t},\n\t\t\t\tinitUIBase: function() {\n\t\t\t\t\tthis._globalKey = utils.unhtml(uiUtils.setGlobal(this.id, this));\n\t\t\t\t},\n\t\t\t\trender: function(holder) {\n\t\t\t\t\tvar html = this.renderHtml();\n\t\t\t\t\tvar el = uiUtils.createElementByHtml(html);\n\t\n\t\t\t\t\t//by xuheng 给每个node添加class\n\t\t\t\t\tvar list = domUtils.getElementsByTagName(el, \"*\");\n\t\t\t\t\tvar theme = \"edui-\" + (this.theme || this.editor.options.theme);\n\t\t\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\t\t\tfor (var i = 0, node; node = list[i++];) {\n\t\t\t\t\t\tdomUtils.addClass(node, theme);\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.addClass(el, theme);\n\t\t\t\t\tif (layer) {\n\t\t\t\t\t\tlayer.className = \"\";\n\t\t\t\t\t\tdomUtils.addClass(layer, theme);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar seatEl = this.getDom();\n\t\t\t\t\tif (seatEl != null) {\n\t\t\t\t\t\tseatEl.parentNode.replaceChild(el, seatEl);\n\t\t\t\t\t\tuiUtils.copyAttributes(el, seatEl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (typeof holder == 'string') {\n\t\t\t\t\t\t\tholder = document.getElementById(holder);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tholder = holder || uiUtils.getFixedLayer();\n\t\t\t\t\t\tdomUtils.addClass(holder, theme);\n\t\t\t\t\t\tholder.appendChild(el);\n\t\t\t\t\t}\n\t\t\t\t\tthis.postRender();\n\t\t\t\t},\n\t\t\t\tgetDom: function(name) {\n\t\t\t\t\tif (!name) {\n\t\t\t\t\t\treturn document.getElementById(this.id);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn document.getElementById(this.id + '_' + name);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tthis.fireEvent('postrender');\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '';\n\t\t\t\t},\n\t\t\t\tformatHtml: function(tpl) {\n\t\n\t\t\t\t\tvar prefix = 'edui-' + this.uiName;\n\t\t\t\t\treturn (tpl\n\t\t\t\t\t\t.replace(/##/g, this.id)\n\t\t\t\t\t\t.replace(/%%-/g, this.uiName ? prefix + '-' : '')\n\t\t\t\t\t\t.replace(/%%/g, (this.uiName ? prefix : '') + ' ' + this.className)\n\t\t\t\t\t\t.replace(/\\$\\$/g, this._globalKey));\n\t\t\t\t},\n\t\t\t\trenderHtml: function() {\n\t\t\t\t\treturn this.formatHtml(this.getHtmlTpl());\n\t\t\t\t},\n\t\t\t\tdispose: function() {\n\t\t\t\t\tvar box = this.getDom();\n\t\t\t\t\tif (box) baidu.editor.dom.domUtils.remove(box);\n\t\t\t\t\tuiUtils.unsetGlobal(this.id);\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(UIBase, EventBase);\n\t\t})();\n\t\n\t\t// ui/separator.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tSeparator = baidu.editor.ui.Separator = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initSeparator();\n\t\t\t\t};\n\t\t\tSeparator.prototype = {\n\t\t\t\tuiName: 'separator',\n\t\t\t\tinitSeparator: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\"></div>';\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Separator, UIBase);\n\t\n\t\t})();\n\t\n\t\t// ui/mask.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils;\n\t\n\t\t\tvar Mask = baidu.editor.ui.Mask = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initUIBase();\n\t\t\t};\n\t\t\tMask.prototype = {\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-mask %%\" onclick=\"return $$._onClick(event, this);\" onmousedown=\"return $$._onMouseDown(event, this);\"></div>';\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tdomUtils.on(window, 'resize', function() {\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tif (!me.isHidden()) {\n\t\t\t\t\t\t\t\tme._fill();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tshow: function(zIndex) {\n\t\t\t\t\tthis._fill();\n\t\t\t\t\tthis.getDom().style.display = '';\n\t\t\t\t\tthis.getDom().style.zIndex = zIndex;\n\t\t\t\t},\n\t\t\t\thide: function() {\n\t\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\t\tthis.getDom().style.zIndex = '';\n\t\t\t\t},\n\t\t\t\tisHidden: function() {\n\t\t\t\t\treturn this.getDom().style.display == 'none';\n\t\t\t\t},\n\t\t\t\t_onMouseDown: function() {\n\t\t\t\t\treturn false;\n\t\t\t\t},\n\t\t\t\t_onClick: function(e, target) {\n\t\t\t\t\tthis.fireEvent('click', e, target);\n\t\t\t\t},\n\t\t\t\t_fill: function() {\n\t\t\t\t\tvar el = this.getDom();\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\tel.style.width = vpRect.width + 'px';\n\t\t\t\t\tel.style.height = vpRect.height + 'px';\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Mask, UIBase);\n\t\t})();\n\t\n\t\t// ui/popup.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tPopup = baidu.editor.ui.Popup = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initPopup();\n\t\t\t\t};\n\t\n\t\t\tvar allPopups = [];\n\t\n\t\t\tfunction closeAllPopup(evt, el) {\n\t\t\t\tfor (var i = 0; i < allPopups.length; i++) {\n\t\t\t\t\tvar pop = allPopups[i];\n\t\t\t\t\tif (!pop.isHidden()) {\n\t\t\t\t\t\tif (pop.queryAutoHide(el) !== false) {\n\t\t\t\t\t\t\tif (evt && /scroll/ig.test(evt.type) && pop.className == \"edui-wordpastepop\") return;\n\t\t\t\t\t\t\tpop.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (allPopups.length)\n\t\t\t\t\tpop.editor.fireEvent(\"afterhidepop\");\n\t\t\t}\n\t\n\t\t\tPopup.postHide = closeAllPopup;\n\t\n\t\t\tvar ANCHOR_CLASSES = ['edui-anchor-topleft', 'edui-anchor-topright',\n\t\t\t\t'edui-anchor-bottomleft', 'edui-anchor-bottomright'\n\t\t\t];\n\t\t\tPopup.prototype = {\n\t\t\t\tSHADOW_RADIUS: 5,\n\t\t\t\tcontent: null,\n\t\t\t\t_hidden: false,\n\t\t\t\tautoRender: true,\n\t\t\t\tcanSideLeft: true,\n\t\t\t\tcanSideUp: true,\n\t\t\t\tinitPopup: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tallPopups.push(this);\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-popup %%\" onmousedown=\"return false;\">' +\n\t\t\t\t\t\t' <div id=\"##_body\" class=\"edui-popup-body\">' +\n\t\t\t\t\t\t' <iframe style=\"position:absolute;z-index:-1;left:0;top:0;background-color: transparent;\" frameborder=\"0\" width=\"100%\" height=\"100%\" src=\"about:blank\"></iframe>' +\n\t\t\t\t\t\t' <div class=\"edui-shadow\"></div>' +\n\t\t\t\t\t\t' <div id=\"##_content\" class=\"edui-popup-content\">' +\n\t\t\t\t\t\tthis.getContentHtmlTpl() +\n\t\t\t\t\t\t'  </div>' +\n\t\t\t\t\t\t' </div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t},\n\t\t\t\tgetContentHtmlTpl: function() {\n\t\t\t\t\tif (this.content) {\n\t\t\t\t\t\tif (typeof this.content == 'string') {\n\t\t\t\t\t\t\treturn this.content;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this.content.renderHtml();\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn ''\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\t_UIBase_postRender: UIBase.prototype.postRender,\n\t\t\t\tpostRender: function() {\n\t\n\t\t\t\t\tif (this.content instanceof UIBase) {\n\t\t\t\t\t\tthis.content.postRender();\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//捕获鼠标滚轮\n\t\t\t\t\tif (this.captureWheel && !this.captured) {\n\t\n\t\t\t\t\t\tthis.captured = true;\n\t\n\t\t\t\t\t\tvar winHeight = (document.documentElement.clientHeight || document.body.clientHeight) - 80,\n\t\t\t\t\t\t\t_height = this.getDom().offsetHeight,\n\t\t\t\t\t\t\t_top = uiUtils.getClientRect(this.combox.getDom()).top,\n\t\t\t\t\t\t\tcontent = this.getDom('content'),\n\t\t\t\t\t\t\tifr = this.getDom('body').getElementsByTagName('iframe'),\n\t\t\t\t\t\t\tme = this;\n\t\n\t\t\t\t\t\tifr.length && (ifr = ifr[0]);\n\t\n\t\t\t\t\t\twhile (_top + _height > winHeight) {\n\t\t\t\t\t\t\t_height -= 30;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontent.style.height = _height + 'px';\n\t\t\t\t\t\t//同步更改iframe高度\n\t\t\t\t\t\tifr && (ifr.style.height = _height + 'px');\n\t\n\t\t\t\t\t\t//阻止在combox上的鼠标滚轮事件, 防止用户的正常操作被误解\n\t\t\t\t\t\tif (window.XMLHttpRequest) {\n\t\n\t\t\t\t\t\t\tdomUtils.on(content, ('onmousewheel' in document.body) ? 'mousewheel' : 'DOMMouseScroll', function(e) {\n\t\n\t\t\t\t\t\t\t\tif (e.preventDefault) {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\te.returnValue = false;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tif (e.wheelDelta) {\n\t\n\t\t\t\t\t\t\t\t\tcontent.scrollTop -= (e.wheelDelta / 120) * 60;\n\t\n\t\t\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\t\t\tcontent.scrollTop -= (e.detail / -3) * 60;\n\t\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t} else {\n\t\n\t\t\t\t\t\t\t//ie6\n\t\t\t\t\t\t\tdomUtils.on(this.getDom(), 'mousewheel', function(e) {\n\t\n\t\t\t\t\t\t\t\te.returnValue = false;\n\t\n\t\t\t\t\t\t\t\tme.getDom('content').scrollTop -= (e.wheelDelta / 120) * 60;\n\t\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t\tthis.fireEvent('postRenderAfter');\n\t\t\t\t\tthis.hide(true);\n\t\t\t\t\tthis._UIBase_postRender();\n\t\t\t\t},\n\t\t\t\t_doAutoRender: function() {\n\t\t\t\t\tif (!this.getDom() && this.autoRender) {\n\t\t\t\t\t\tthis.render();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmesureSize: function() {\n\t\t\t\t\tvar box = this.getDom('content');\n\t\t\t\t\treturn uiUtils.getClientRect(box);\n\t\t\t\t},\n\t\t\t\tfitSize: function() {\n\t\t\t\t\tif (this.captureWheel && this.sized) {\n\t\t\t\t\t\treturn this.__size;\n\t\t\t\t\t}\n\t\t\t\t\tthis.sized = true;\n\t\t\t\t\tvar popBodyEl = this.getDom('body');\n\t\t\t\t\tpopBodyEl.style.width = '';\n\t\t\t\t\tpopBodyEl.style.height = '';\n\t\t\t\t\tvar size = this.mesureSize();\n\t\t\t\t\tif (this.captureWheel) {\n\t\t\t\t\t\tpopBodyEl.style.width = -(-20 - size.width) + 'px';\n\t\t\t\t\t\tvar height = parseInt(this.getDom('content').style.height, 10);\n\t\t\t\t\t\t!window.isNaN(height) && (size.height = height);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpopBodyEl.style.width = size.width + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tpopBodyEl.style.height = size.height + 'px';\n\t\t\t\t\tthis.__size = size;\n\t\t\t\t\tthis.captureWheel && (this.getDom('content').style.overflow = 'auto');\n\t\t\t\t\treturn size;\n\t\t\t\t},\n\t\t\t\tshowAnchor: function(element, hoz) {\n\t\t\t\t\tthis.showAnchorRect(uiUtils.getClientRect(element), hoz);\n\t\t\t\t},\n\t\t\t\tshowAnchorRect: function(rect, hoz, adj) {\n\t\t\t\t\tthis._doAutoRender();\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\tthis.getDom().style.visibility = 'hidden';\n\t\t\t\t\tthis._show();\n\t\t\t\t\tvar popSize = this.fitSize();\n\t\n\t\t\t\t\tvar sideLeft, sideUp, left, top;\n\t\t\t\t\tif (hoz) {\n\t\t\t\t\t\tsideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n\t\t\t\t\t\tsideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n\t\t\t\t\t\tleft = (sideLeft ? rect.left - popSize.width : rect.right);\n\t\t\t\t\t\ttop = (sideUp ? rect.bottom - popSize.height : rect.top);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n\t\t\t\t\t\tsideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n\t\t\t\t\t\tleft = (sideLeft ? rect.right - popSize.width : rect.left);\n\t\t\t\t\t\ttop = (sideUp ? rect.top - popSize.height : rect.bottom);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar popEl = this.getDom();\n\t\t\t\t\tuiUtils.setViewportOffset(popEl, {\n\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\ttop: top\n\t\t\t\t\t});\n\t\t\t\t\tdomUtils.removeClasses(popEl, ANCHOR_CLASSES);\n\t\t\t\t\tpopEl.className += ' ' + ANCHOR_CLASSES[(sideUp ? 1 : 0) * 2 + (sideLeft ? 1 : 0)];\n\t\t\t\t\tif (this.editor) {\n\t\t\t\t\t\tpopEl.style.zIndex = this.editor.container.style.zIndex * 1 + 10;\n\t\t\t\t\t\tbaidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = popEl.style.zIndex - 1;\n\t\t\t\t\t}\n\t\t\t\t\tthis.getDom().style.visibility = 'visible';\n\t\n\t\t\t\t},\n\t\t\t\tshowAt: function(offset) {\n\t\t\t\t\tvar left = offset.left;\n\t\t\t\t\tvar top = offset.top;\n\t\t\t\t\tvar rect = {\n\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\ttop: top,\n\t\t\t\t\t\tright: left,\n\t\t\t\t\t\tbottom: top,\n\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\twidth: 0\n\t\t\t\t\t};\n\t\t\t\t\tthis.showAnchorRect(rect, false, true);\n\t\t\t\t},\n\t\t\t\t_show: function() {\n\t\t\t\t\tif (this._hidden) {\n\t\t\t\t\t\tvar box = this.getDom();\n\t\t\t\t\t\tbox.style.display = '';\n\t\t\t\t\t\tthis._hidden = false;\n\t\t\t\t\t\t//                if (box.setActive) {\n\t\t\t\t\t\t//                    box.setActive();\n\t\t\t\t\t\t//                }\n\t\t\t\t\t\tthis.fireEvent('show');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisHidden: function() {\n\t\t\t\t\treturn this._hidden;\n\t\t\t\t},\n\t\t\t\tshow: function() {\n\t\t\t\t\tthis._doAutoRender();\n\t\t\t\t\tthis._show();\n\t\t\t\t},\n\t\t\t\thide: function(notNofity) {\n\t\t\t\t\tif (!this._hidden && this.getDom()) {\n\t\t\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\t\tif (!notNofity) {\n\t\t\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tqueryAutoHide: function(el) {\n\t\t\t\t\treturn !el || !uiUtils.contains(this.getDom(), el);\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Popup, UIBase);\n\t\n\t\t\tdomUtils.on(document, 'mousedown', function(evt) {\n\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\tcloseAllPopup(evt, el);\n\t\t\t});\n\t\t\tdomUtils.on(window, 'scroll', function(evt, el) {\n\t\t\t\tcloseAllPopup(evt, el);\n\t\t\t});\n\t\n\t\t})();\n\t\n\t\t// ui/colorpicker.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tColorPicker = baidu.editor.ui.ColorPicker = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.noColorText = this.noColorText || this.editor.getLang(\"clearColor\");\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t};\n\t\n\t\t\tColorPicker.prototype = {\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn genColorPicker(this.noColorText, this.editor);\n\t\t\t\t},\n\t\t\t\t_onTableClick: function(evt) {\n\t\t\t\t\tvar tgt = evt.target || evt.srcElement;\n\t\t\t\t\tvar color = tgt.getAttribute('data-color');\n\t\t\t\t\tif (color) {\n\t\t\t\t\t\tthis.fireEvent('pickcolor', color);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onTableOver: function(evt) {\n\t\t\t\t\tvar tgt = evt.target || evt.srcElement;\n\t\t\t\t\tvar color = tgt.getAttribute('data-color');\n\t\t\t\t\tif (color) {\n\t\t\t\t\t\tthis.getDom('preview').style.backgroundColor = color;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onTableOut: function() {\n\t\t\t\t\tthis.getDom('preview').style.backgroundColor = '';\n\t\t\t\t},\n\t\t\t\t_onPickNoColor: function() {\n\t\t\t\t\tthis.fireEvent('picknocolor');\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(ColorPicker, UIBase);\n\t\n\t\t\tvar COLORS = (\n\t\t\t\t'ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,' +\n\t\t\t\t'f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,' +\n\t\t\t\t'd8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,' +\n\t\t\t\t'bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,' +\n\t\t\t\t'a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,' +\n\t\t\t\t'7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,' +\n\t\t\t\t'c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,').split(',');\n\t\n\t\t\tfunction genColorPicker(noColorText, editor) {\n\t\t\t\tvar html = '<div id=\"##\" class=\"edui-colorpicker %%\">' +\n\t\t\t\t\t'<div class=\"edui-colorpicker-topbar edui-clearfix\">' +\n\t\t\t\t\t'<div unselectable=\"on\" id=\"##_preview\" class=\"edui-colorpicker-preview\"></div>' +\n\t\t\t\t\t'<div unselectable=\"on\" class=\"edui-colorpicker-nocolor\" onclick=\"$$._onPickNoColor(event, this);\">' + noColorText + '</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<table  class=\"edui-box\" style=\"border-collapse: collapse;\" onmouseover=\"$$._onTableOver(event, this);\" onmouseout=\"$$._onTableOut(event, this);\" onclick=\"return $$._onTableClick(event, this);\" cellspacing=\"0\" cellpadding=\"0\">' +\n\t\t\t\t\t'<tr style=\"border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px\"><td colspan=\"10\">' + editor.getLang(\"themeColor\") + '</td> </tr>' +\n\t\t\t\t\t'<tr class=\"edui-colorpicker-tablefirstrow\" >';\n\t\t\t\tfor (var i = 0; i < COLORS.length; i++) {\n\t\t\t\t\tif (i && i % 10 === 0) {\n\t\t\t\t\t\thtml += '</tr>' + (i == 60 ? '<tr style=\"border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;\"><td colspan=\"10\">' + editor.getLang(\"standardColor\") + '</td></tr>' : '') + '<tr' + (i == 60 ? ' class=\"edui-colorpicker-tablefirstrow\"' : '') + '>';\n\t\t\t\t\t}\n\t\t\t\t\thtml += i < 70 ? '<td style=\"padding: 0 2px;\"><a hidefocus title=\"' + COLORS[i] + '\" onclick=\"return false;\" href=\"javascript:\" unselectable=\"on\" class=\"edui-box edui-colorpicker-colorcell\"' +\n\t\t\t\t\t\t' data-color=\"#' + COLORS[i] + '\"' +\n\t\t\t\t\t\t' style=\"background-color:#' + COLORS[i] + ';border:solid #ccc;' +\n\t\t\t\t\t\t(i < 10 || i >= 60 ? 'border-width:1px;' :\n\t\t\t\t\t\t\ti >= 10 && i < 20 ? 'border-width:1px 1px 0 1px;' :\n\t\n\t\t\t\t\t\t\t'border-width:0 1px 0 1px;') +\n\t\t\t\t\t\t'\"' +\n\t\t\t\t\t\t'></a></td>' : '';\n\t\t\t\t}\n\t\t\t\thtml += '</tr></table></div>';\n\t\t\t\treturn html;\n\t\t\t}\n\t\t})();\n\t\n\t\t// ui/tablepicker.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase;\n\t\n\t\t\tvar TablePicker = baidu.editor.ui.TablePicker = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initTablePicker();\n\t\t\t};\n\t\t\tTablePicker.prototype = {\n\t\t\t\tdefaultNumRows: 10,\n\t\t\t\tdefaultNumCols: 10,\n\t\t\t\tmaxNumRows: 20,\n\t\t\t\tmaxNumCols: 20,\n\t\t\t\tnumRows: 10,\n\t\t\t\tnumCols: 10,\n\t\t\t\tlengthOfCellSide: 22,\n\t\t\t\tinitTablePicker: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-tablepicker %%\">' +\n\t\t\t\t\t\t'<div class=\"edui-tablepicker-body\">' +\n\t\t\t\t\t\t'<div class=\"edui-infoarea\">' +\n\t\t\t\t\t\t'<span id=\"##_label\" class=\"edui-label\"></span>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div class=\"edui-pickarea\"' +\n\t\t\t\t\t\t' onmousemove=\"$$._onMouseMove(event, this);\"' +\n\t\t\t\t\t\t' onmouseover=\"$$._onMouseOver(event, this);\"' +\n\t\t\t\t\t\t' onmouseout=\"$$._onMouseOut(event, this);\"' +\n\t\t\t\t\t\t' onclick=\"$$._onClick(event, this);\"' +\n\t\t\t\t\t\t'>' +\n\t\t\t\t\t\t'<div id=\"##_overlay\" class=\"edui-overlay\"></div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t},\n\t\t\t\t_UIBase_render: UIBase.prototype.render,\n\t\t\t\trender: function(holder) {\n\t\t\t\t\tthis._UIBase_render(holder);\n\t\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_row\") + ' x 0' + this.editor.getLang(\"t_col\");\n\t\t\t\t},\n\t\t\t\t_track: function(numCols, numRows) {\n\t\t\t\t\tvar style = this.getDom('overlay').style;\n\t\t\t\t\tvar sideLen = this.lengthOfCellSide;\n\t\t\t\t\tstyle.width = numCols * sideLen + 'px';\n\t\t\t\t\tstyle.height = numRows * sideLen + 'px';\n\t\t\t\t\tvar label = this.getDom('label');\n\t\t\t\t\tlabel.innerHTML = numCols + this.editor.getLang(\"t_col\") + ' x ' + numRows + this.editor.getLang(\"t_row\");\n\t\t\t\t\tthis.numCols = numCols;\n\t\t\t\t\tthis.numRows = numRows;\n\t\t\t\t},\n\t\t\t\t_onMouseOver: function(evt, el) {\n\t\t\t\t\tvar rel = evt.relatedTarget || evt.fromElement;\n\t\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_col\") + ' x 0' + this.editor.getLang(\"t_row\");\n\t\t\t\t\t\tthis.getDom('overlay').style.visibility = '';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onMouseOut: function(evt, el) {\n\t\t\t\t\tvar rel = evt.relatedTarget || evt.toElement;\n\t\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_col\") + ' x 0' + this.editor.getLang(\"t_row\");\n\t\t\t\t\t\tthis.getDom('overlay').style.visibility = 'hidden';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onMouseMove: function(evt, el) {\n\t\t\t\t\tvar style = this.getDom('overlay').style;\n\t\t\t\t\tvar offset = uiUtils.getEventOffset(evt);\n\t\t\t\t\tvar sideLen = this.lengthOfCellSide;\n\t\t\t\t\tvar numCols = Math.ceil(offset.left / sideLen);\n\t\t\t\t\tvar numRows = Math.ceil(offset.top / sideLen);\n\t\t\t\t\tthis._track(numCols, numRows);\n\t\t\t\t},\n\t\t\t\t_onClick: function() {\n\t\t\t\t\tthis.fireEvent('picktable', this.numCols, this.numRows);\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(TablePicker, UIBase);\n\t\t})();\n\t\n\t\t// ui/stateful.js\n\t\t(function() {\n\t\t\tvar browser = baidu.editor.browser,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils;\n\t\n\t\t\tvar TPL_STATEFUL = 'onmousedown=\"$$.Stateful_onMouseDown(event, this);\"' +\n\t\t\t\t' onmouseup=\"$$.Stateful_onMouseUp(event, this);\"' +\n\t\t\t\t(browser.ie ? (\n\t\t\t\t\t' onmouseenter=\"$$.Stateful_onMouseEnter(event, this);\"' +\n\t\t\t\t\t' onmouseleave=\"$$.Stateful_onMouseLeave(event, this);\"') : (\n\t\t\t\t\t' onmouseover=\"$$.Stateful_onMouseOver(event, this);\"' +\n\t\t\t\t\t' onmouseout=\"$$.Stateful_onMouseOut(event, this);\"'));\n\t\n\t\t\tbaidu.editor.ui.Stateful = {\n\t\t\t\talwalysHoverable: false,\n\t\t\t\ttarget: null, //目标元素和this指向dom不一样\n\t\t\t\tStateful_init: function() {\n\t\t\t\t\tthis._Stateful_dGetHtmlTpl = this.getHtmlTpl;\n\t\t\t\t\tthis.getHtmlTpl = this.Stateful_getHtmlTpl;\n\t\t\t\t},\n\t\t\t\tStateful_getHtmlTpl: function() {\n\t\t\t\t\tvar tpl = this._Stateful_dGetHtmlTpl();\n\t\t\t\t\t// 使用function避免$转义\n\t\t\t\t\treturn tpl.replace(/stateful/g, function() {\n\t\t\t\t\t\treturn TPL_STATEFUL;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tStateful_onMouseEnter: function(evt, el) {\n\t\t\t\t\tthis.target = el;\n\t\t\t\t\tif (!this.isDisabled() || this.alwalysHoverable) {\n\t\t\t\t\t\tthis.addState('hover');\n\t\t\t\t\t\tthis.fireEvent('over');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tStateful_onMouseLeave: function(evt, el) {\n\t\t\t\t\tif (!this.isDisabled() || this.alwalysHoverable) {\n\t\t\t\t\t\tthis.removeState('hover');\n\t\t\t\t\t\tthis.removeState('active');\n\t\t\t\t\t\tthis.fireEvent('out');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tStateful_onMouseOver: function(evt, el) {\n\t\t\t\t\tvar rel = evt.relatedTarget;\n\t\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\t\tthis.Stateful_onMouseEnter(evt, el);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tStateful_onMouseOut: function(evt, el) {\n\t\t\t\t\tvar rel = evt.relatedTarget;\n\t\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\t\tthis.Stateful_onMouseLeave(evt, el);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tStateful_onMouseDown: function(evt, el) {\n\t\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\t\tthis.addState('active');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tStateful_onMouseUp: function(evt, el) {\n\t\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\t\tthis.removeState('active');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tStateful_postRender: function() {\n\t\t\t\t\tif (this.disabled && !this.hasState('disabled')) {\n\t\t\t\t\t\tthis.addState('disabled');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\thasState: function(state) {\n\t\t\t\t\treturn domUtils.hasClass(this.getStateDom(), 'edui-state-' + state);\n\t\t\t\t},\n\t\t\t\taddState: function(state) {\n\t\t\t\t\tif (!this.hasState(state)) {\n\t\t\t\t\t\tthis.getStateDom().className += ' edui-state-' + state;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tremoveState: function(state) {\n\t\t\t\t\tif (this.hasState(state)) {\n\t\t\t\t\t\tdomUtils.removeClasses(this.getStateDom(), ['edui-state-' + state]);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetStateDom: function() {\n\t\t\t\t\treturn this.getDom('state');\n\t\t\t\t},\n\t\t\t\tisChecked: function() {\n\t\t\t\t\treturn this.hasState('checked');\n\t\t\t\t},\n\t\t\t\tsetChecked: function(checked) {\n\t\t\t\t\tif (!this.isDisabled() && checked) {\n\t\t\t\t\t\tthis.addState('checked');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.removeState('checked');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisDisabled: function() {\n\t\t\t\t\treturn this.hasState('disabled');\n\t\t\t\t},\n\t\t\t\tsetDisabled: function(disabled) {\n\t\t\t\t\tif (disabled) {\n\t\t\t\t\t\tthis.removeState('hover');\n\t\t\t\t\t\tthis.removeState('checked');\n\t\t\t\t\t\tthis.removeState('active');\n\t\t\t\t\t\tthis.addState('disabled');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.removeState('disabled');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t})();\n\t\n\t\t// ui/button.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/stateful.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\t\tButton = baidu.editor.ui.Button = function(options) {\n\t\t\t\t\tif (options.name) {\n\t\t\t\t\t\tvar btnName = options.name;\n\t\t\t\t\t\tvar cssRules = options.cssRules;\n\t\t\t\t\t\tif (!options.className) {\n\t\t\t\t\t\t\toptions.className = 'edui-for-' + btnName;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions.cssRules = '.edui-default  .edui-for-' + btnName + ' .edui-icon {' + cssRules + '}'\n\t\t\t\t\t}\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initButton();\n\t\t\t\t};\n\t\t\tButton.prototype = {\n\t\t\t\tuiName: 'button',\n\t\t\t\tlabel: '',\n\t\t\t\ttitle: '',\n\t\t\t\tshowIcon: true,\n\t\t\t\tshowText: true,\n\t\t\t\tcssRules: '',\n\t\t\t\tinitButton: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tthis.Stateful_init();\n\t\t\t\t\tif (this.cssRules) {\n\t\t\t\t\t\tutils.cssRule('edui-customize-' + this.name + '-style', this.cssRules);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\">' +\n\t\t\t\t\t\t'<div id=\"##_state\" stateful>' +\n\t\t\t\t\t\t'<div class=\"%%-wrap\"><div id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n\t\t\t\t\t\t' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\">' +\n\t\t\t\t\t\t(this.showIcon ? '<div class=\"edui-box edui-icon\"></div>' : '') +\n\t\t\t\t\t\t(this.showText ? '<div class=\"edui-box edui-label\">' + this.label + '</div>' : '') +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div></div>';\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tthis.Stateful_postRender();\n\t\t\t\t\tthis.setDisabled(this.disabled)\n\t\t\t\t},\n\t\t\t\t_onMouseDown: function(e) {\n\t\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\t\ttagName = target && target.tagName && target.tagName.toLowerCase();\n\t\t\t\t\tif (tagName == 'input' || tagName == 'object' || tagName == 'object') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onClick: function() {\n\t\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\t\tthis.fireEvent('click');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetTitle: function(text) {\n\t\t\t\t\tvar label = this.getDom('label');\n\t\t\t\t\tlabel.innerHTML = text;\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Button, UIBase);\n\t\t\tutils.extend(Button.prototype, Stateful);\n\t\n\t\t})();\n\t\n\t\t// ui/splitbutton.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/stateful.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\t\tSplitButton = baidu.editor.ui.SplitButton = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initSplitButton();\n\t\t\t\t};\n\t\t\tSplitButton.prototype = {\n\t\t\t\tpopup: null,\n\t\t\t\tuiName: 'splitbutton',\n\t\t\t\ttitle: '',\n\t\t\t\tinitSplitButton: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tthis.Stateful_init();\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (this.popup != null) {\n\t\t\t\t\t\tvar popup = this.popup;\n\t\t\t\t\t\tthis.popup = null;\n\t\t\t\t\t\tthis.setPopup(popup);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_UIBase_postRender: UIBase.prototype.postRender,\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tthis.Stateful_postRender();\n\t\t\t\t\tthis._UIBase_postRender();\n\t\t\t\t},\n\t\t\t\tsetPopup: function(popup) {\n\t\t\t\t\tif (this.popup === popup) return;\n\t\t\t\t\tif (this.popup != null) {\n\t\t\t\t\t\tthis.popup.dispose();\n\t\t\t\t\t}\n\t\t\t\t\tpopup.addListener('show', utils.bind(this._onPopupShow, this));\n\t\t\t\t\tpopup.addListener('hide', utils.bind(this._onPopupHide, this));\n\t\t\t\t\tpopup.addListener('postrender', utils.bind(function() {\n\t\t\t\t\t\tpopup.getDom('body').appendChild(\n\t\t\t\t\t\t\tuiUtils.createElementByHtml('<div id=\"' +\n\t\t\t\t\t\t\t\tthis.popup.id + '_bordereraser\" class=\"edui-bordereraser edui-background\" style=\"width:' +\n\t\t\t\t\t\t\t\t(uiUtils.getClientRect(this.getDom()).width + 20) + 'px\"></div>')\n\t\t\t\t\t\t);\n\t\t\t\t\t\tpopup.getDom().className += ' ' + this.className;\n\t\t\t\t\t}, this));\n\t\t\t\t\tthis.popup = popup;\n\t\t\t\t},\n\t\t\t\t_onPopupShow: function() {\n\t\t\t\t\tthis.addState('opened');\n\t\t\t\t},\n\t\t\t\t_onPopupHide: function() {\n\t\t\t\t\tthis.removeState('opened');\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\">' +\n\t\t\t\t\t\t'<div ' + (this.title ? 'title=\"' + this.title + '\"' : '') + ' id=\"##_state\" stateful><div class=\"%%-body\">' +\n\t\t\t\t\t\t'<div id=\"##_button_body\" class=\"edui-box edui-button-body\" onclick=\"$$._onButtonClick(event, this);\">' +\n\t\t\t\t\t\t'<div class=\"edui-box edui-icon\"></div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div class=\"edui-box edui-splitborder\"></div>' +\n\t\t\t\t\t\t'<div class=\"edui-box edui-arrow\" onclick=\"$$._onArrowClick();\"></div>' +\n\t\t\t\t\t\t'</div></div></div>';\n\t\t\t\t},\n\t\t\t\tshowPopup: function() {\n\t\t\t\t\t// 当popup往上弹出的时候，做特殊处理\n\t\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\t\trect.top -= this.popup.SHADOW_RADIUS;\n\t\t\t\t\trect.height += this.popup.SHADOW_RADIUS;\n\t\t\t\t\tthis.popup.showAnchorRect(rect);\n\t\t\t\t},\n\t\t\t\t_onArrowClick: function(event, el) {\n\t\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onButtonClick: function() {\n\t\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\t\tthis.fireEvent('buttonclick');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(SplitButton, UIBase);\n\t\t\tutils.extend(SplitButton.prototype, Stateful, true);\n\t\n\t\t})();\n\t\n\t\t// ui/colorbutton.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/colorpicker.js\n\t\t///import ui/popup.js\n\t\t///import ui/splitbutton.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tColorPicker = baidu.editor.ui.ColorPicker,\n\t\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\t\tColorButton = baidu.editor.ui.ColorButton = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initColorButton();\n\t\t\t\t};\n\t\t\tColorButton.prototype = {\n\t\t\t\tinitColorButton: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t\tcontent: new ColorPicker({\n\t\t\t\t\t\t\tnoColorText: me.editor.getLang(\"clearColor\"),\n\t\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\t\tonpickcolor: function(t, color) {\n\t\t\t\t\t\t\t\tme._onPickColor(color);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonpicknocolor: function(t, color) {\n\t\t\t\t\t\t\t\tme._onPickNoColor(color);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\teditor: me.editor\n\t\t\t\t\t});\n\t\t\t\t\tthis.initSplitButton();\n\t\t\t\t},\n\t\t\t\t_SplitButton_postRender: SplitButton.prototype.postRender,\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tthis._SplitButton_postRender();\n\t\t\t\t\tthis.getDom('button_body').appendChild(\n\t\t\t\t\t\tuiUtils.createElementByHtml('<div id=\"' + this.id + '_colorlump\" class=\"edui-colorlump\"></div>')\n\t\t\t\t\t);\n\t\t\t\t\tthis.getDom().className += ' edui-colorbutton';\n\t\t\t\t},\n\t\t\t\tsetColor: function(color) {\n\t\t\t\t\tthis.getDom('colorlump').style.backgroundColor = color;\n\t\t\t\t\tthis.color = color;\n\t\t\t\t},\n\t\t\t\t_onPickColor: function(color) {\n\t\t\t\t\tif (this.fireEvent('pickcolor', color) !== false) {\n\t\t\t\t\t\tthis.setColor(color);\n\t\t\t\t\t\tthis.popup.hide();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onPickNoColor: function(color) {\n\t\t\t\t\tif (this.fireEvent('picknocolor') !== false) {\n\t\t\t\t\t\tthis.popup.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(ColorButton, SplitButton);\n\t\n\t\t})();\n\t\n\t\t// ui/tablebutton.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/popup.js\n\t\t///import ui/tablepicker.js\n\t\t///import ui/splitbutton.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\t\tTablePicker = baidu.editor.ui.TablePicker,\n\t\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\t\tTableButton = baidu.editor.ui.TableButton = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initTableButton();\n\t\t\t\t};\n\t\t\tTableButton.prototype = {\n\t\t\t\tinitTableButton: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t\tcontent: new TablePicker({\n\t\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\t\tonpicktable: function(t, numCols, numRows) {\n\t\t\t\t\t\t\t\tme._onPickTable(numCols, numRows);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t'editor': me.editor\n\t\t\t\t\t});\n\t\t\t\t\tthis.initSplitButton();\n\t\t\t\t},\n\t\t\t\t_onPickTable: function(numCols, numRows) {\n\t\t\t\t\tif (this.fireEvent('picktable', numCols, numRows) !== false) {\n\t\t\t\t\t\tthis.popup.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(TableButton, SplitButton);\n\t\n\t\t})();\n\t\n\t\t// ui/autotypesetpicker.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase;\n\t\n\t\t\tvar AutoTypeSetPicker = baidu.editor.ui.AutoTypeSetPicker = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initAutoTypeSetPicker();\n\t\t\t};\n\t\t\tAutoTypeSetPicker.prototype = {\n\t\t\t\tinitAutoTypeSetPicker: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\tvar me = this.editor,\n\t\t\t\t\t\topt = me.options.autotypeset,\n\t\t\t\t\t\tlang = me.getLang(\"autoTypeSet\");\n\t\n\t\t\t\t\tvar textAlignInputName = 'textAlignValue' + me.uid,\n\t\t\t\t\t\timageBlockInputName = 'imageBlockLineValue' + me.uid,\n\t\t\t\t\t\tsymbolConverInputName = 'symbolConverValue' + me.uid;\n\t\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-autotypesetpicker %%\">' +\n\t\t\t\t\t\t'<div class=\"edui-autotypesetpicker-body\">' +\n\t\t\t\t\t\t'<table >' +\n\t\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"mergeEmptyline\" ' + (opt[\"mergeEmptyline\"] ? \"checked\" : \"\") + '>' + lang.mergeLine + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"removeEmptyline\" ' + (opt[\"removeEmptyline\"] ? \"checked\" : \"\") + '>' + lang.delLine + '</td></tr>' +\n\t\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"removeClass\" ' + (opt[\"removeClass\"] ? \"checked\" : \"\") + '>' + lang.removeFormat + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"indent\" ' + (opt[\"indent\"] ? \"checked\" : \"\") + '>' + lang.indent + '</td></tr>' +\n\t\t\t\t\t\t'<tr>' +\n\t\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"textAlign\" ' + (opt[\"textAlign\"] ? \"checked\" : \"\") + '>' + lang.alignment + '</td>' +\n\t\t\t\t\t\t'<td colspan=\"2\" id=\"' + textAlignInputName + '\">' +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"left\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"left\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyleft\") +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"center\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"center\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifycenter\") +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"right\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"right\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyright\") +\n\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'<tr>' +\n\t\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"imageBlockLine\" ' + (opt[\"imageBlockLine\"] ? \"checked\" : \"\") + '>' + lang.imageFloat + '</td>' +\n\t\t\t\t\t\t'<td nowrap id=\"' + imageBlockInputName + '\">' +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"none\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"none\") ? \"checked\" : \"\") + '>' + me.getLang(\"default\") +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"left\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"left\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyleft\") +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"center\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"center\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifycenter\") +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"right\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"right\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyright\") +\n\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"clearFontSize\" ' + (opt[\"clearFontSize\"] ? \"checked\" : \"\") + '>' + lang.removeFontsize + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"clearFontFamily\" ' + (opt[\"clearFontFamily\"] ? \"checked\" : \"\") + '>' + lang.removeFontFamily + '</td></tr>' +\n\t\t\t\t\t\t'<tr><td nowrap colspan=\"3\"><input type=\"checkbox\" name=\"removeEmptyNode\" ' + (opt[\"removeEmptyNode\"] ? \"checked\" : \"\") + '>' + lang.removeHtml + '</td></tr>' +\n\t\t\t\t\t\t'<tr><td nowrap colspan=\"3\"><input type=\"checkbox\" name=\"pasteFilter\" ' + (opt[\"pasteFilter\"] ? \"checked\" : \"\") + '>' + lang.pasteFilter + '</td></tr>' +\n\t\t\t\t\t\t'<tr>' +\n\t\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"symbolConver\" ' + (opt[\"bdc2sb\"] || opt[\"tobdc\"] ? \"checked\" : \"\") + '>' + lang.symbol + '</td>' +\n\t\t\t\t\t\t'<td id=\"' + symbolConverInputName + '\">' +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"bdc\" value=\"bdc2sb\" ' + (opt[\"bdc2sb\"] ? \"checked\" : \"\") + '>' + lang.bdc2sb +\n\t\t\t\t\t\t'<input type=\"radio\" name=\"bdc\" value=\"tobdc\" ' + (opt[\"tobdc\"] ? \"checked\" : \"\") + '>' + lang.tobdc + '' +\n\t\t\t\t\t\t'</td>' +\n\t\t\t\t\t\t'<td nowrap align=\"right\"><button >' + lang.run + '</button></td>' +\n\t\t\t\t\t\t'</tr>' +\n\t\t\t\t\t\t'</table>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>';\n\t\n\t\t\t\t},\n\t\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t\t};\n\t\t\tutils.inherits(AutoTypeSetPicker, UIBase);\n\t\t})();\n\t\n\t\t// ui/autotypesetbutton.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/popup.js\n\t\t///import ui/autotypesetpicker.js\n\t\t///import ui/splitbutton.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\t\tAutoTypeSetPicker = baidu.editor.ui.AutoTypeSetPicker,\n\t\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\t\tAutoTypeSetButton = baidu.editor.ui.AutoTypeSetButton = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initAutoTypeSetButton();\n\t\t\t\t};\n\t\n\t\t\tfunction getPara(me) {\n\t\n\t\t\t\tvar opt = {},\n\t\t\t\t\tcont = me.getDom(),\n\t\t\t\t\teditorId = me.editor.uid,\n\t\t\t\t\tinputType = null,\n\t\t\t\t\tattrName = null,\n\t\t\t\t\tipts = domUtils.getElementsByTagName(cont, \"input\");\n\t\t\t\tfor (var i = ipts.length - 1, ipt; ipt = ipts[i--];) {\n\t\t\t\t\tinputType = ipt.getAttribute(\"type\");\n\t\t\t\t\tif (inputType == \"checkbox\") {\n\t\t\t\t\t\tattrName = ipt.getAttribute(\"name\");\n\t\t\t\t\t\topt[attrName] && delete opt[attrName];\n\t\t\t\t\t\tif (ipt.checked) {\n\t\t\t\t\t\t\tvar attrValue = document.getElementById(attrName + \"Value\" + editorId);\n\t\t\t\t\t\t\tif (attrValue) {\n\t\t\t\t\t\t\t\tif (/input/ig.test(attrValue.tagName)) {\n\t\t\t\t\t\t\t\t\topt[attrName] = attrValue.value;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar iptChilds = attrValue.getElementsByTagName(\"input\");\n\t\t\t\t\t\t\t\t\tfor (var j = iptChilds.length - 1, iptchild; iptchild = iptChilds[j--];) {\n\t\t\t\t\t\t\t\t\t\tif (iptchild.checked) {\n\t\t\t\t\t\t\t\t\t\t\topt[attrName] = iptchild.value;\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\topt[attrName] = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\topt[attrName] = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\topt[ipt.getAttribute(\"value\")] = ipt.checked;\n\t\t\t\t\t}\n\t\n\t\t\t\t}\n\t\n\t\t\t\tvar selects = domUtils.getElementsByTagName(cont, \"select\");\n\t\t\t\tfor (var i = 0, si; si = selects[i++];) {\n\t\t\t\t\tvar attr = si.getAttribute('name');\n\t\t\t\t\topt[attr] = opt[attr] ? si.value : '';\n\t\t\t\t}\n\t\n\t\t\t\tutils.extend(me.editor.options.autotypeset, opt);\n\t\n\t\t\t\tme.editor.setPreferences('autotypeset', opt);\n\t\t\t}\n\t\n\t\t\tAutoTypeSetButton.prototype = {\n\t\t\t\tinitAutoTypeSetButton: function() {\n\t\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t\t//传入配置参数\n\t\t\t\t\t\tcontent: new AutoTypeSetPicker({\n\t\t\t\t\t\t\teditor: me.editor\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t'editor': me.editor,\n\t\t\t\t\t\thide: function() {\n\t\t\t\t\t\t\tif (!this._hidden && this.getDom()) {\n\t\t\t\t\t\t\t\tgetPara(this);\n\t\t\t\t\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tvar flag = 0;\n\t\t\t\t\tthis.popup.addListener('postRenderAfter', function() {\n\t\t\t\t\t\tvar popupUI = this;\n\t\t\t\t\t\tif (flag) return;\n\t\t\t\t\t\tvar cont = this.getDom(),\n\t\t\t\t\t\t\tbtn = cont.getElementsByTagName('button')[0];\n\t\n\t\t\t\t\t\tbtn.onclick = function() {\n\t\t\t\t\t\t\tgetPara(popupUI);\n\t\t\t\t\t\t\tme.editor.execCommand('autotypeset');\n\t\t\t\t\t\t\tpopupUI.hide()\n\t\t\t\t\t\t};\n\t\n\t\t\t\t\t\tdomUtils.on(cont, 'click', function(e) {\n\t\t\t\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\t\t\t\teditorId = me.editor.uid;\n\t\t\t\t\t\t\tif (target && target.tagName == 'INPUT') {\n\t\n\t\t\t\t\t\t\t\t// 点击图片浮动的checkbox,去除对应的radio\n\t\t\t\t\t\t\t\tif (target.name == 'imageBlockLine' || target.name == 'textAlign' || target.name == 'symbolConver') {\n\t\t\t\t\t\t\t\t\tvar checked = target.checked,\n\t\t\t\t\t\t\t\t\t\tradioTd = document.getElementById(target.name + 'Value' + editorId),\n\t\t\t\t\t\t\t\t\t\tradios = radioTd.getElementsByTagName('input'),\n\t\t\t\t\t\t\t\t\t\tdefalutSelect = {\n\t\t\t\t\t\t\t\t\t\t\t'imageBlockLine': 'none',\n\t\t\t\t\t\t\t\t\t\t\t'textAlign': 'left',\n\t\t\t\t\t\t\t\t\t\t\t'symbolConver': 'tobdc'\n\t\t\t\t\t\t\t\t\t\t};\n\t\n\t\t\t\t\t\t\t\t\tfor (var i = 0; i < radios.length; i++) {\n\t\t\t\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\t\t\t\tif (radios[i].value == defalutSelect[target.name]) {\n\t\t\t\t\t\t\t\t\t\t\t\tradios[i].checked = 'checked';\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tradios[i].checked = false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// 点击radio,选中对应的checkbox\n\t\t\t\t\t\t\t\tif (target.name == ('imageBlockLineValue' + editorId) || target.name == ('textAlignValue' + editorId) || target.name == 'bdc') {\n\t\t\t\t\t\t\t\t\tvar checkboxs = target.parentNode.previousSibling.getElementsByTagName('input');\n\t\t\t\t\t\t\t\t\tcheckboxs && (checkboxs[0].checked = true);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tgetPara(popupUI);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\tflag = 1;\n\t\t\t\t\t});\n\t\t\t\t\tthis.initSplitButton();\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(AutoTypeSetButton, SplitButton);\n\t\n\t\t})();\n\t\n\t\t// ui/cellalignpicker.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase;\n\t\n\t\t\t/**\n\t\t\t * 该参数将新增一个参数： selected， 参数类型为一个Object， 形如{ 'align': 'center', 'valign': 'top' }， 表示单元格的初始\n\t\t\t * 对齐状态为： 竖直居上，水平居中; 其中 align的取值为：'center', 'left', 'right'; valign的取值为: 'top', 'middle', 'bottom'\n\t\t\t * @update 2013/4/2 hancong03@baidu.com\n\t\t\t */\n\t\t\tvar CellAlignPicker = baidu.editor.ui.CellAlignPicker = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initSelected();\n\t\t\t\tthis.initCellAlignPicker();\n\t\t\t};\n\t\t\tCellAlignPicker.prototype = {\n\t\t\t\t//初始化选中状态， 该方法将根据传递进来的参数获取到应该选中的对齐方式图标的索引\n\t\t\t\tinitSelected: function() {\n\t\n\t\t\t\t\tvar status = {\n\t\n\t\t\t\t\t\t\tvalign: {\n\t\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\t\tmiddle: 1,\n\t\t\t\t\t\t\t\tbottom: 2\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\talign: {\n\t\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\t\tcenter: 1,\n\t\t\t\t\t\t\t\tright: 2\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tcount: 3\n\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\tresult = -1;\n\t\n\t\t\t\t\tif (this.selected) {\n\t\t\t\t\t\tthis.selectedIndex = status.valign[this.selected.valign] * status.count + status.align[this.selected.align];\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\tinitCellAlignPicker: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tthis.Stateful_init();\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\n\t\t\t\t\tvar alignType = ['left', 'center', 'right'],\n\t\t\t\t\t\tCOUNT = 9,\n\t\t\t\t\t\ttempClassName = null,\n\t\t\t\t\t\ttempIndex = -1,\n\t\t\t\t\t\ttmpl = [];\n\t\n\t\t\t\t\tfor (var i = 0; i < COUNT; i++) {\n\t\n\t\t\t\t\t\ttempClassName = this.selectedIndex === i ? ' class=\"edui-cellalign-selected\" ' : '';\n\t\t\t\t\t\ttempIndex = i % 3;\n\t\n\t\t\t\t\t\ttempIndex === 0 && tmpl.push('<tr>');\n\t\n\t\t\t\t\t\ttmpl.push('<td index=\"' + i + '\" ' + tempClassName + ' stateful><div class=\"edui-icon edui-' + alignType[tempIndex] + '\"></div></td>');\n\t\n\t\t\t\t\t\ttempIndex === 2 && tmpl.push('</tr>');\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-cellalignpicker %%\">' +\n\t\t\t\t\t\t'<div class=\"edui-cellalignpicker-body\">' +\n\t\t\t\t\t\t'<table onclick=\"$$._onClick(event);\">' +\n\t\t\t\t\t\ttmpl.join('') +\n\t\t\t\t\t\t'</table>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t},\n\t\t\t\tgetStateDom: function() {\n\t\t\t\t\treturn this.target;\n\t\t\t\t},\n\t\t\t\t_onClick: function(evt) {\n\t\t\t\t\tvar target = evt.target || evt.srcElement;\n\t\t\t\t\tif (/icon/.test(target.className)) {\n\t\t\t\t\t\tthis.items[target.parentNode.getAttribute(\"index\")].onclick();\n\t\t\t\t\t\tPopup.postHide(evt);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t\t};\n\t\t\tutils.inherits(CellAlignPicker, UIBase);\n\t\t\tutils.extend(CellAlignPicker.prototype, Stateful, true);\n\t\t})();\n\t\n\t\t// ui/pastepicker.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase;\n\t\n\t\t\tvar PastePicker = baidu.editor.ui.PastePicker = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initPastePicker();\n\t\t\t};\n\t\t\tPastePicker.prototype = {\n\t\t\t\tinitPastePicker: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tthis.Stateful_init();\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div class=\"edui-pasteicon\" onclick=\"$$._onClick(this)\"></div>' +\n\t\t\t\t\t\t'<div class=\"edui-pastecontainer\">' +\n\t\t\t\t\t\t'<div class=\"edui-title\">' + this.editor.getLang(\"pasteOpt\") + '</div>' +\n\t\t\t\t\t\t'<div class=\"edui-button\">' +\n\t\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"pasteSourceFormat\") + '\" onclick=\"$$.format(false)\" stateful>' +\n\t\t\t\t\t\t'<div class=\"edui-richtxticon\"></div></div>' +\n\t\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"tagFormat\") + '\" onclick=\"$$.format(2)\" stateful>' +\n\t\t\t\t\t\t'<div class=\"edui-tagicon\"></div></div>' +\n\t\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"pasteTextFormat\") + '\" onclick=\"$$.format(true)\" stateful>' +\n\t\t\t\t\t\t'<div class=\"edui-plaintxticon\"></div></div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>'\n\t\t\t\t},\n\t\t\t\tgetStateDom: function() {\n\t\t\t\t\treturn this.target;\n\t\t\t\t},\n\t\t\t\tformat: function(param) {\n\t\t\t\t\tthis.editor.ui._isTransfer = true;\n\t\t\t\t\tthis.editor.fireEvent('pasteTransfer', param);\n\t\t\t\t},\n\t\t\t\t_onClick: function(cur) {\n\t\t\t\t\tvar node = domUtils.getNextDomNode(cur),\n\t\t\t\t\t\tscreenHt = uiUtils.getViewportRect().height,\n\t\t\t\t\t\tsubPop = uiUtils.getClientRect(node);\n\t\n\t\t\t\t\tif ((subPop.top + subPop.height) > screenHt)\n\t\t\t\t\t\tnode.style.top = (-subPop.height - cur.offsetHeight) + \"px\";\n\t\t\t\t\telse\n\t\t\t\t\t\tnode.style.top = \"\";\n\t\n\t\t\t\t\tif (/hidden/ig.test(domUtils.getComputedStyle(node, \"visibility\"))) {\n\t\t\t\t\t\tnode.style.visibility = \"visible\";\n\t\t\t\t\t\tdomUtils.addClass(cur, \"edui-state-opened\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnode.style.visibility = \"hidden\";\n\t\t\t\t\t\tdomUtils.removeClasses(cur, \"edui-state-opened\")\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t\t};\n\t\t\tutils.inherits(PastePicker, UIBase);\n\t\t\tutils.extend(PastePicker.prototype, Stateful, true);\n\t\t})();\n\t\n\t\t// ui/toolbar.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tToolbar = baidu.editor.ui.Toolbar = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initToolbar();\n\t\t\t\t};\n\t\t\tToolbar.prototype = {\n\t\t\t\titems: null,\n\t\t\t\tinitToolbar: function() {\n\t\t\t\t\tthis.items = this.items || [];\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t},\n\t\t\t\tadd: function(item, index) {\n\t\t\t\t\tif (index === undefined) {\n\t\t\t\t\t\tthis.items.push(item);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.items.splice(index, 0, item)\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\tvar buff = [];\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tbuff[i] = this.items[i].renderHtml();\n\t\t\t\t\t}\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-toolbar %%\" onselectstart=\"return false;\" onmousedown=\"return $$._onMouseDown(event, this);\">' +\n\t\t\t\t\t\tbuff.join('') +\n\t\t\t\t\t\t'</div>'\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tvar box = this.getDom();\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tthis.items[i].postRender();\n\t\t\t\t\t}\n\t\t\t\t\tuiUtils.makeUnselectable(box);\n\t\t\t\t},\n\t\t\t\t_onMouseDown: function(e) {\n\t\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\t\ttagName = target && target.tagName && target.tagName.toLowerCase();\n\t\t\t\t\tif (tagName == 'input' || tagName == 'object' || tagName == 'object') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Toolbar, UIBase);\n\t\n\t\t})();\n\t\n\t\t// ui/menu.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui\\popup.js\n\t\t///import ui\\stateful.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\t\tCellAlignPicker = baidu.editor.ui.CellAlignPicker,\n\t\n\t\t\t\tMenu = baidu.editor.ui.Menu = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initMenu();\n\t\t\t\t};\n\t\n\t\t\tvar menuSeparator = {\n\t\t\t\trenderHtml: function() {\n\t\t\t\t\treturn '<div class=\"edui-menuitem edui-menuseparator\"><div class=\"edui-menuseparator-inner\"></div></div>';\n\t\t\t\t},\n\t\t\t\tpostRender: function() {},\n\t\t\t\tqueryAutoHide: function() {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t};\n\t\t\tMenu.prototype = {\n\t\t\t\titems: null,\n\t\t\t\tuiName: 'menu',\n\t\t\t\tinitMenu: function() {\n\t\t\t\t\tthis.items = this.items || [];\n\t\t\t\t\tthis.initPopup();\n\t\t\t\t\tthis.initItems();\n\t\t\t\t},\n\t\t\t\tinitItems: function() {\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\tif (item == '-') {\n\t\t\t\t\t\t\tthis.items[i] = this.getSeparator();\n\t\t\t\t\t\t} else if (!(item instanceof MenuItem)) {\n\t\t\t\t\t\t\titem.editor = this.editor;\n\t\t\t\t\t\t\titem.theme = this.editor.options.theme;\n\t\t\t\t\t\t\tthis.items[i] = this.createItem(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetSeparator: function() {\n\t\t\t\t\treturn menuSeparator;\n\t\t\t\t},\n\t\t\t\tcreateItem: function(item) {\n\t\t\t\t\t//新增一个参数menu, 该参数存储了menuItem所对应的menu引用\n\t\t\t\t\titem.menu = this;\n\t\t\t\t\treturn new MenuItem(item);\n\t\t\t\t},\n\t\t\t\t_Popup_getContentHtmlTpl: Popup.prototype.getContentHtmlTpl,\n\t\t\t\tgetContentHtmlTpl: function() {\n\t\t\t\t\tif (this.items.length == 0) {\n\t\t\t\t\t\treturn this._Popup_getContentHtmlTpl();\n\t\t\t\t\t}\n\t\t\t\t\tvar buff = [];\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\tbuff[i] = item.renderHtml();\n\t\t\t\t\t}\n\t\t\t\t\treturn ('<div class=\"%%-body\">' + buff.join('') + '</div>');\n\t\t\t\t},\n\t\t\t\t_Popup_postRender: Popup.prototype.postRender,\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\titem.ownerMenu = this;\n\t\t\t\t\t\titem.postRender();\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.on(this.getDom(), 'mouseover', function(evt) {\n\t\t\t\t\t\tevt = evt || event;\n\t\t\t\t\t\tvar rel = evt.relatedTarget || evt.fromElement;\n\t\t\t\t\t\tvar el = me.getDom();\n\t\t\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\t\t\tme.fireEvent('over');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis._Popup_postRender();\n\t\t\t\t},\n\t\t\t\tqueryAutoHide: function(el) {\n\t\t\t\t\tif (el) {\n\t\t\t\t\t\tif (uiUtils.contains(this.getDom(), el)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\t\tif (item.queryAutoHide(el) === false) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tclearItems: function() {\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\tclearTimeout(item._showingTimer);\n\t\t\t\t\t\tclearTimeout(item._closingTimer);\n\t\t\t\t\t\tif (item.subMenu) {\n\t\t\t\t\t\t\titem.subMenu.destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.items = [];\n\t\t\t\t},\n\t\t\t\tdestroy: function() {\n\t\t\t\t\tif (this.getDom()) {\n\t\t\t\t\t\tdomUtils.remove(this.getDom());\n\t\t\t\t\t}\n\t\t\t\t\tthis.clearItems();\n\t\t\t\t},\n\t\t\t\tdispose: function() {\n\t\t\t\t\tthis.destroy();\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Menu, Popup);\n\t\n\t\t\t/**\n\t\t\t * @update 2013/04/03 hancong03 新增一个参数menu, 该参数存储了menuItem所对应的menu引用\n\t\t\t * @type {Function}\n\t\t\t */\n\t\t\tvar MenuItem = baidu.editor.ui.MenuItem = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t\tif (this.subMenu && !(this.subMenu instanceof Menu)) {\n\t\t\t\t\tif (options.className && options.className.indexOf(\"aligntd\") != -1) {\n\t\t\t\t\t\tvar me = this;\n\t\n\t\t\t\t\t\t//获取单元格对齐初始状态\n\t\t\t\t\t\tthis.subMenu.selected = this.editor.queryCommandValue('cellalignment');\n\t\n\t\t\t\t\t\tthis.subMenu = new Popup({\n\t\t\t\t\t\t\tcontent: new CellAlignPicker(this.subMenu),\n\t\t\t\t\t\t\tparentMenu: me,\n\t\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\t\tdestroy: function() {\n\t\t\t\t\t\t\t\tif (this.getDom()) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(this.getDom());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.subMenu.addListener(\"postRenderAfter\", function() {\n\t\t\t\t\t\t\tdomUtils.on(this.getDom(), \"mouseover\", function() {\n\t\t\t\t\t\t\t\tme.addState('opened');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.subMenu = new Menu(this.subMenu);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tMenuItem.prototype = {\n\t\t\t\tlabel: '',\n\t\t\t\tsubMenu: null,\n\t\t\t\townerMenu: null,\n\t\t\t\tuiName: 'menuitem',\n\t\t\t\talwalysHoverable: true,\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"%%\" stateful onclick=\"$$._onClick(event, this);\">' +\n\t\t\t\t\t\t'<div class=\"%%-body\">' +\n\t\t\t\t\t\tthis.renderLabelHtml() +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.addListener('over', function() {\n\t\t\t\t\t\tme.ownerMenu.fireEvent('submenuover', me);\n\t\t\t\t\t\tif (me.subMenu) {\n\t\t\t\t\t\t\tme.delayShowSubMenu();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (this.subMenu) {\n\t\t\t\t\t\tthis.getDom().className += ' edui-hassubmenu';\n\t\t\t\t\t\tthis.subMenu.render();\n\t\t\t\t\t\tthis.addListener('out', function() {\n\t\t\t\t\t\t\tme.delayHideSubMenu();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.subMenu.addListener('over', function() {\n\t\t\t\t\t\t\tclearTimeout(me._closingTimer);\n\t\t\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\t\t\tme.addState('opened');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.ownerMenu.addListener('hide', function() {\n\t\t\t\t\t\t\tme.hideSubMenu();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.ownerMenu.addListener('submenuover', function(t, subMenu) {\n\t\t\t\t\t\t\tif (subMenu !== me) {\n\t\t\t\t\t\t\t\tme.delayHideSubMenu();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.subMenu._bakQueryAutoHide = this.subMenu.queryAutoHide;\n\t\t\t\t\t\tthis.subMenu.queryAutoHide = function(el) {\n\t\t\t\t\t\t\tif (el && uiUtils.contains(me.getDom(), el)) {\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn this._bakQueryAutoHide(el);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tthis.getDom().style.tabIndex = '-1';\n\t\t\t\t\tuiUtils.makeUnselectable(this.getDom());\n\t\t\t\t\tthis.Stateful_postRender();\n\t\t\t\t},\n\t\t\t\tdelayShowSubMenu: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (!me.isDisabled()) {\n\t\t\t\t\t\tme.addState('opened');\n\t\t\t\t\t\tclearTimeout(me._showingTimer);\n\t\t\t\t\t\tclearTimeout(me._closingTimer);\n\t\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\t\tme._showingTimer = setTimeout(function() {\n\t\t\t\t\t\t\tme.showSubMenu();\n\t\t\t\t\t\t}, 250);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdelayHideSubMenu: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (!me.isDisabled()) {\n\t\t\t\t\t\tme.removeState('opened');\n\t\t\t\t\t\tclearTimeout(me._showingTimer);\n\t\t\t\t\t\tif (!me._closingTimer) {\n\t\t\t\t\t\t\tme._closingTimer = setTimeout(function() {\n\t\t\t\t\t\t\t\tif (!me.hasState('opened')) {\n\t\t\t\t\t\t\t\t\tme.hideSubMenu();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\t\t\t}, 400);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\treturn '<div class=\"edui-arrow\"></div>' +\n\t\t\t\t\t\t'<div class=\"edui-box edui-icon\"></div>' +\n\t\t\t\t\t\t'<div class=\"edui-box edui-label %%-label\">' + (this.label || '') + '</div>';\n\t\t\t\t},\n\t\t\t\tgetStateDom: function() {\n\t\t\t\t\treturn this.getDom();\n\t\t\t\t},\n\t\t\t\tqueryAutoHide: function(el) {\n\t\t\t\t\tif (this.subMenu && this.hasState('opened')) {\n\t\t\t\t\t\treturn this.subMenu.queryAutoHide(el);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_onClick: function(event, this_) {\n\t\t\t\t\tif (this.hasState('disabled')) return;\n\t\t\t\t\tif (this.fireEvent('click', event, this_) !== false) {\n\t\t\t\t\t\tif (this.subMenu) {\n\t\t\t\t\t\t\tthis.showSubMenu();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tPopup.postHide(event);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tshowSubMenu: function() {\n\t\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\t\trect.right -= 5;\n\t\t\t\t\trect.left += 2;\n\t\t\t\t\trect.width -= 7;\n\t\t\t\t\trect.top -= 4;\n\t\t\t\t\trect.bottom += 4;\n\t\t\t\t\trect.height += 8;\n\t\t\t\t\tthis.subMenu.showAnchorRect(rect, true, true);\n\t\t\t\t},\n\t\t\t\thideSubMenu: function() {\n\t\t\t\t\tthis.subMenu.hide();\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(MenuItem, UIBase);\n\t\t\tutils.extend(MenuItem.prototype, Stateful, true);\n\t\t})();\n\t\n\t\t// ui/combox.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/menu.js\n\t\t///import ui/splitbutton.js\n\t\t(function() {\n\t\t\t// todo: menu和item提成通用list\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tMenu = baidu.editor.ui.Menu,\n\t\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\t\tCombox = baidu.editor.ui.Combox = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initCombox();\n\t\t\t\t};\n\t\t\tCombox.prototype = {\n\t\t\t\tuiName: 'combox',\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\tinitCombox: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.items = this.items || [];\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\titem.uiName = 'listitem';\n\t\t\t\t\t\titem.index = i;\n\t\t\t\t\t\titem.onclick = function() {\n\t\t\t\t\t\t\tme.selectByIndex(this.index);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tthis.popup = new Menu({\n\t\t\t\t\t\titems: this.items,\n\t\t\t\t\t\tuiName: 'list',\n\t\t\t\t\t\teditor: this.editor,\n\t\t\t\t\t\tcaptureWheel: true,\n\t\t\t\t\t\tcombox: this\n\t\t\t\t\t});\n\t\n\t\t\t\t\tthis.initSplitButton();\n\t\t\t\t},\n\t\t\t\t_SplitButton_postRender: SplitButton.prototype.postRender,\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tthis._SplitButton_postRender();\n\t\t\t\t\tthis.setLabel(this.label || '');\n\t\t\t\t\tthis.setValue(this.initValue || '');\n\t\t\t\t},\n\t\t\t\tshowPopup: function() {\n\t\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\t\trect.top += 1;\n\t\t\t\t\trect.bottom -= 1;\n\t\t\t\t\trect.height -= 2;\n\t\t\t\t\tthis.popup.showAnchorRect(rect);\n\t\t\t\t},\n\t\t\t\tgetValue: function() {\n\t\t\t\t\treturn this.value;\n\t\t\t\t},\n\t\t\t\tsetValue: function(value) {\n\t\t\t\t\tvar index = this.indexByValue(value);\n\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\tthis.selectedIndex = index;\n\t\t\t\t\t\tthis.setLabel(this.items[index].label);\n\t\t\t\t\t\tthis.value = this.items[index].value;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.selectedIndex = -1;\n\t\t\t\t\t\tthis.setLabel(this.getLabelForUnknowValue(value));\n\t\t\t\t\t\tthis.value = value;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetLabel: function(label) {\n\t\t\t\t\tthis.getDom('button_body').innerHTML = label;\n\t\t\t\t\tthis.label = label;\n\t\t\t\t},\n\t\t\t\tgetLabelForUnknowValue: function(value) {\n\t\t\t\t\treturn value;\n\t\t\t\t},\n\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tif (value == this.items[i].value) {\n\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t},\n\t\t\t\tgetItem: function(index) {\n\t\t\t\t\treturn this.items[index];\n\t\t\t\t},\n\t\t\t\tselectByIndex: function(index) {\n\t\t\t\t\tif (index < this.items.length && this.fireEvent('select', index) !== false) {\n\t\t\t\t\t\tthis.selectedIndex = index;\n\t\t\t\t\t\tthis.value = this.items[index].value;\n\t\t\t\t\t\tthis.setLabel(this.items[index].label);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Combox, SplitButton);\n\t\t})();\n\t\n\t\t// ui/dialog.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/mask.js\n\t\t///import ui/button.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tMask = baidu.editor.ui.Mask,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tButton = baidu.editor.ui.Button,\n\t\t\t\tDialog = baidu.editor.ui.Dialog = function(options) {\n\t\t\t\t\tif (options.name) {\n\t\t\t\t\t\tvar name = options.name;\n\t\t\t\t\t\tvar cssRules = options.cssRules;\n\t\t\t\t\t\tif (!options.className) {\n\t\t\t\t\t\t\toptions.className = 'edui-for-' + name;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (cssRules) {\n\t\t\t\t\t\t\toptions.cssRules = '.edui-default .edui-for-' + name + ' .edui-dialog-content  {' + cssRules + '}'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.initOptions(utils.extend({\n\t\t\t\t\t\tautoReset: true,\n\t\t\t\t\t\tdraggable: true,\n\t\t\t\t\t\tonok: function() {},\n\t\t\t\t\t\toncancel: function() {},\n\t\t\t\t\t\tonclose: function(t, ok) {\n\t\t\t\t\t\t\treturn ok ? this.onok() : this.oncancel();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t//是否控制dialog中的scroll事件， 默认为不阻止\n\t\t\t\t\t\tholdScroll: false\n\t\t\t\t\t}, options));\n\t\t\t\t\tthis.initDialog();\n\t\t\t\t};\n\t\t\tvar modalMask;\n\t\t\tvar dragMask;\n\t\t\tvar activeDialog;\n\t\t\tDialog.prototype = {\n\t\t\t\tdraggable: false,\n\t\t\t\tuiName: 'dialog',\n\t\t\t\tinitDialog: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\ttheme = this.editor.options.theme;\n\t\t\t\t\tif (this.cssRules) {\n\t\t\t\t\t\tutils.cssRule('edui-customize-' + this.name + '-style', this.cssRules);\n\t\t\t\t\t}\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tthis.modalMask = (modalMask || (modalMask = new Mask({\n\t\t\t\t\t\tclassName: 'edui-dialog-modalmask',\n\t\t\t\t\t\ttheme: theme,\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tactiveDialog && activeDialog.close(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t})));\n\t\t\t\t\tthis.dragMask = (dragMask || (dragMask = new Mask({\n\t\t\t\t\t\tclassName: 'edui-dialog-dragmask',\n\t\t\t\t\t\ttheme: theme\n\t\t\t\t\t})));\n\t\t\t\t\tthis.closeButton = new Button({\n\t\t\t\t\t\tclassName: 'edui-dialog-closebutton',\n\t\t\t\t\t\ttitle: me.closeDialog,\n\t\t\t\t\t\ttheme: theme,\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tme.close(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\tthis.fullscreen && this.initResizeEvent();\n\t\n\t\t\t\t\tif (this.buttons) {\n\t\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\t\tif (!(this.buttons[i] instanceof Button)) {\n\t\t\t\t\t\t\t\tthis.buttons[i] = new Button(utils.extend(this.buttons[i], {\n\t\t\t\t\t\t\t\t\teditor: this.editor\n\t\t\t\t\t\t\t\t}, true));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tinitResizeEvent: function() {\n\t\n\t\t\t\t\tvar me = this;\n\t\n\t\t\t\t\tdomUtils.on(window, \"resize\", function() {\n\t\n\t\t\t\t\t\tif (me._hidden || me._hidden === undefined) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (me.__resizeTimer) {\n\t\t\t\t\t\t\twindow.clearTimeout(me.__resizeTimer);\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tme.__resizeTimer = window.setTimeout(function() {\n\t\n\t\t\t\t\t\t\tme.__resizeTimer = null;\n\t\n\t\t\t\t\t\t\tvar dialogWrapNode = me.getDom(),\n\t\t\t\t\t\t\t\tcontentNode = me.getDom('content'),\n\t\t\t\t\t\t\t\twrapRect = UE.ui.uiUtils.getClientRect(dialogWrapNode),\n\t\t\t\t\t\t\t\tcontentRect = UE.ui.uiUtils.getClientRect(contentNode),\n\t\t\t\t\t\t\t\tvpRect = uiUtils.getViewportRect();\n\t\n\t\t\t\t\t\t\tcontentNode.style.width = (vpRect.width - wrapRect.width + contentRect.width) + \"px\";\n\t\t\t\t\t\t\tcontentNode.style.height = (vpRect.height - wrapRect.height + contentRect.height) + \"px\";\n\t\n\t\t\t\t\t\t\tdialogWrapNode.style.width = vpRect.width + \"px\";\n\t\t\t\t\t\t\tdialogWrapNode.style.height = vpRect.height + \"px\";\n\t\n\t\t\t\t\t\t\tme.fireEvent(\"resize\");\n\t\n\t\t\t\t\t\t}, 100);\n\t\n\t\t\t\t\t});\n\t\n\t\t\t\t},\n\t\t\t\tfitSize: function() {\n\t\t\t\t\tvar popBodyEl = this.getDom('body');\n\t\t\t\t\t//            if (!(baidu.editor.browser.ie && baidu.editor.browser.version == 7)) {\n\t\t\t\t\t//                uiUtils.removeStyle(popBodyEl, 'width');\n\t\t\t\t\t//                uiUtils.removeStyle(popBodyEl, 'height');\n\t\t\t\t\t//            }\n\t\t\t\t\tvar size = this.mesureSize();\n\t\t\t\t\tpopBodyEl.style.width = size.width + 'px';\n\t\t\t\t\tpopBodyEl.style.height = size.height + 'px';\n\t\t\t\t\treturn size;\n\t\t\t\t},\n\t\t\t\tsafeSetOffset: function(offset) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar el = me.getDom();\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\tvar rect = uiUtils.getClientRect(el);\n\t\t\t\t\tvar left = offset.left;\n\t\t\t\t\tif (left + rect.width > vpRect.right) {\n\t\t\t\t\t\tleft = vpRect.right - rect.width;\n\t\t\t\t\t}\n\t\t\t\t\tvar top = offset.top;\n\t\t\t\t\tif (top + rect.height > vpRect.bottom) {\n\t\t\t\t\t\ttop = vpRect.bottom - rect.height;\n\t\t\t\t\t}\n\t\t\t\t\tel.style.left = Math.max(left, 0) + 'px';\n\t\t\t\t\tel.style.top = Math.max(top, 0) + 'px';\n\t\t\t\t},\n\t\t\t\tshowAtCenter: function() {\n\t\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\n\t\t\t\t\tif (!this.fullscreen) {\n\t\t\t\t\t\tthis.getDom().style.display = '';\n\t\t\t\t\t\tvar popSize = this.fitSize();\n\t\t\t\t\t\tvar titleHeight = this.getDom('titlebar').offsetHeight | 0;\n\t\t\t\t\t\tvar left = vpRect.width / 2 - popSize.width / 2;\n\t\t\t\t\t\tvar top = vpRect.height / 2 - (popSize.height - titleHeight) / 2 - titleHeight;\n\t\t\t\t\t\tvar popEl = this.getDom();\n\t\t\t\t\t\tthis.safeSetOffset({\n\t\t\t\t\t\t\tleft: Math.max(left | 0, 0),\n\t\t\t\t\t\t\ttop: Math.max(top | 0, 0)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (!domUtils.hasClass(popEl, 'edui-state-centered')) {\n\t\t\t\t\t\t\tpopEl.className += ' edui-state-centered';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar dialogWrapNode = this.getDom(),\n\t\t\t\t\t\t\tcontentNode = this.getDom('content');\n\t\n\t\t\t\t\t\tdialogWrapNode.style.display = \"block\";\n\t\n\t\t\t\t\t\tvar wrapRect = UE.ui.uiUtils.getClientRect(dialogWrapNode),\n\t\t\t\t\t\t\tcontentRect = UE.ui.uiUtils.getClientRect(contentNode);\n\t\t\t\t\t\tdialogWrapNode.style.left = \"-100000px\";\n\t\n\t\t\t\t\t\tcontentNode.style.width = (vpRect.width - wrapRect.width + contentRect.width) + \"px\";\n\t\t\t\t\t\tcontentNode.style.height = (vpRect.height - wrapRect.height + contentRect.height) + \"px\";\n\t\n\t\t\t\t\t\tdialogWrapNode.style.width = vpRect.width + \"px\";\n\t\t\t\t\t\tdialogWrapNode.style.height = vpRect.height + \"px\";\n\t\t\t\t\t\tdialogWrapNode.style.left = 0;\n\t\n\t\t\t\t\t\t//保存环境的overflow值\n\t\t\t\t\t\tthis._originalContext = {\n\t\t\t\t\t\t\thtml: {\n\t\t\t\t\t\t\t\toverflowX: document.documentElement.style.overflowX,\n\t\t\t\t\t\t\t\toverflowY: document.documentElement.style.overflowY\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\toverflowX: document.body.style.overflowX,\n\t\t\t\t\t\t\t\toverflowY: document.body.style.overflowY\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\n\t\t\t\t\t\tdocument.documentElement.style.overflowX = 'hidden';\n\t\t\t\t\t\tdocument.documentElement.style.overflowY = 'hidden';\n\t\t\t\t\t\tdocument.body.style.overflowX = 'hidden';\n\t\t\t\t\t\tdocument.body.style.overflowY = 'hidden';\n\t\n\t\t\t\t\t}\n\t\n\t\t\t\t\tthis._show();\n\t\t\t\t},\n\t\t\t\tgetContentHtml: function() {\n\t\t\t\t\tvar contentHtml = '';\n\t\t\t\t\tif (typeof this.content == 'string') {\n\t\t\t\t\t\tcontentHtml = this.content;\n\t\t\t\t\t} else if (this.iframeUrl) {\n\t\t\t\t\t\tcontentHtml = '<span id=\"' + this.id + '_contmask\" class=\"dialogcontmask\"></span><iframe id=\"' + this.id +\n\t\t\t\t\t\t\t'_iframe\" class=\"%%-iframe\" height=\"100%\" width=\"100%\" frameborder=\"0\" src=\"' + this.iframeUrl + '\"></iframe>';\n\t\t\t\t\t}\n\t\t\t\t\treturn contentHtml;\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\tvar footHtml = '';\n\t\n\t\t\t\t\tif (this.buttons) {\n\t\t\t\t\t\tvar buff = [];\n\t\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\t\tbuff[i] = this.buttons[i].renderHtml();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfootHtml = '<div class=\"%%-foot\">' +\n\t\t\t\t\t\t\t'<div id=\"##_buttons\" class=\"%%-buttons\">' + buff.join('') + '</div>' +\n\t\t\t\t\t\t\t'</div>';\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn '<div id=\"##\" class=\"%%\"><div ' + (!this.fullscreen ? 'class=\"%%\"' : 'class=\"%%-wrap edui-dialog-fullscreen-flag\"') + '><div id=\"##_body\" class=\"%%-body\">' +\n\t\t\t\t\t\t'<div class=\"%%-shadow\"></div>' +\n\t\t\t\t\t\t'<div id=\"##_titlebar\" class=\"%%-titlebar\">' +\n\t\t\t\t\t\t'<div class=\"%%-draghandle\" onmousedown=\"$$._onTitlebarMouseDown(event, this);\">' +\n\t\t\t\t\t\t'<span class=\"%%-caption\">' + (this.title || '') + '</span>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\tthis.closeButton.renderHtml() +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div id=\"##_content\" class=\"%%-content\">' + (this.autoReset ? '' : this.getContentHtml()) + '</div>' +\n\t\t\t\t\t\tfootHtml +\n\t\t\t\t\t\t'</div></div></div>';\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\t// todo: 保持居中/记住上次关闭位置选项\n\t\t\t\t\tif (!this.modalMask.getDom()) {\n\t\t\t\t\t\tthis.modalMask.render();\n\t\t\t\t\t\tthis.modalMask.hide();\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.dragMask.getDom()) {\n\t\t\t\t\t\tthis.dragMask.render();\n\t\t\t\t\t\tthis.dragMask.hide();\n\t\t\t\t\t}\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.addListener('show', function() {\n\t\t\t\t\t\tme.modalMask.show(this.getDom().style.zIndex - 2);\n\t\t\t\t\t});\n\t\t\t\t\tthis.addListener('hide', function() {\n\t\t\t\t\t\tme.modalMask.hide();\n\t\t\t\t\t});\n\t\t\t\t\tif (this.buttons) {\n\t\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\t\tthis.buttons[i].postRender();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.on(window, 'resize', function() {\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tif (!me.isHidden()) {\n\t\t\t\t\t\t\t\tme.safeSetOffset(uiUtils.getClientRect(me.getDom()));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\n\t\t\t\t\t//hold住scroll事件，防止dialog的滚动影响页面\n\t\t\t\t\t//            if( this.holdScroll ) {\n\t\t\t\t\t//\n\t\t\t\t\t//                if( !me.iframeUrl ) {\n\t\t\t\t\t//                    domUtils.on( document.getElementById( me.id + \"_iframe\"), !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t\t//                        domUtils.preventDefault(e);\n\t\t\t\t\t//                    } );\n\t\t\t\t\t//                } else {\n\t\t\t\t\t//                    me.addListener('dialogafterreset', function(){\n\t\t\t\t\t//                        window.setTimeout(function(){\n\t\t\t\t\t//                            var iframeWindow = document.getElementById( me.id + \"_iframe\").contentWindow;\n\t\t\t\t\t//\n\t\t\t\t\t//                            if( browser.ie ) {\n\t\t\t\t\t//\n\t\t\t\t\t//                                var timer = window.setInterval(function(){\n\t\t\t\t\t//\n\t\t\t\t\t//                                    if( iframeWindow.document && iframeWindow.document.body ) {\n\t\t\t\t\t//                                        window.clearInterval( timer );\n\t\t\t\t\t//                                        timer = null;\n\t\t\t\t\t//                                        domUtils.on( iframeWindow.document.body, !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t\t//                                            domUtils.preventDefault(e);\n\t\t\t\t\t//                                        } );\n\t\t\t\t\t//                                    }\n\t\t\t\t\t//\n\t\t\t\t\t//                                }, 100);\n\t\t\t\t\t//\n\t\t\t\t\t//                            } else {\n\t\t\t\t\t//                                domUtils.on( iframeWindow, !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t\t//                                    domUtils.preventDefault(e);\n\t\t\t\t\t//                                } );\n\t\t\t\t\t//                            }\n\t\t\t\t\t//\n\t\t\t\t\t//                        }, 1);\n\t\t\t\t\t//                    });\n\t\t\t\t\t//                }\n\t\t\t\t\t//\n\t\t\t\t\t//            }\n\t\t\t\t\tthis._hide();\n\t\t\t\t},\n\t\t\t\tmesureSize: function() {\n\t\t\t\t\tvar body = this.getDom('body');\n\t\t\t\t\tvar width = uiUtils.getClientRect(this.getDom('content')).width;\n\t\t\t\t\tvar dialogBodyStyle = body.style;\n\t\t\t\t\tdialogBodyStyle.width = width;\n\t\t\t\t\treturn uiUtils.getClientRect(body);\n\t\t\t\t},\n\t\t\t\t_onTitlebarMouseDown: function(evt, el) {\n\t\t\t\t\tif (this.draggable) {\n\t\t\t\t\t\tvar rect;\n\t\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\t\tvar me = this;\n\t\t\t\t\t\tuiUtils.startDrag(evt, {\n\t\t\t\t\t\t\tondragstart: function() {\n\t\t\t\t\t\t\t\trect = uiUtils.getClientRect(me.getDom());\n\t\t\t\t\t\t\t\tme.getDom('contmask').style.visibility = 'visible';\n\t\t\t\t\t\t\t\tme.dragMask.show(me.getDom().style.zIndex - 1);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tondragmove: function(x, y) {\n\t\t\t\t\t\t\t\tvar left = rect.left + x;\n\t\t\t\t\t\t\t\tvar top = rect.top + y;\n\t\t\t\t\t\t\t\tme.safeSetOffset({\n\t\t\t\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\t\t\t\ttop: top\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tondragstop: function() {\n\t\t\t\t\t\t\t\tme.getDom('contmask').style.visibility = 'hidden';\n\t\t\t\t\t\t\t\tdomUtils.removeClasses(me.getDom(), ['edui-state-centered']);\n\t\t\t\t\t\t\t\tme.dragMask.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\treset: function() {\n\t\t\t\t\tthis.getDom('content').innerHTML = this.getContentHtml();\n\t\t\t\t\tthis.fireEvent('dialogafterreset');\n\t\t\t\t},\n\t\t\t\t_show: function() {\n\t\t\t\t\tif (this._hidden) {\n\t\t\t\t\t\tthis.getDom().style.display = '';\n\t\n\t\t\t\t\t\t//要高过编辑器的zindxe\n\t\t\t\t\t\tthis.editor.container.style.zIndex && (this.getDom().style.zIndex = this.editor.container.style.zIndex * 1 + 10);\n\t\t\t\t\t\tthis._hidden = false;\n\t\t\t\t\t\tthis.fireEvent('show');\n\t\t\t\t\t\tbaidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = this.getDom().style.zIndex - 4;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tisHidden: function() {\n\t\t\t\t\treturn this._hidden;\n\t\t\t\t},\n\t\t\t\t_hide: function() {\n\t\t\t\t\tif (!this._hidden) {\n\t\t\t\t\t\tvar wrapNode = this.getDom();\n\t\t\t\t\t\twrapNode.style.display = 'none';\n\t\t\t\t\t\twrapNode.style.zIndex = '';\n\t\t\t\t\t\twrapNode.style.width = '';\n\t\t\t\t\t\twrapNode.style.height = '';\n\t\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\topen: function() {\n\t\t\t\t\tif (this.autoReset) {\n\t\t\t\t\t\t//有可能还没有渲染\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tthis.render();\n\t\t\t\t\t\t\tthis.open()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.showAtCenter();\n\t\t\t\t\tif (this.iframeUrl) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tthis.getDom('iframe').focus();\n\t\t\t\t\t\t} catch (ex) {}\n\t\t\t\t\t}\n\t\t\t\t\tactiveDialog = this;\n\t\t\t\t},\n\t\t\t\t_onCloseButtonClick: function(evt, el) {\n\t\t\t\t\tthis.close(false);\n\t\t\t\t},\n\t\t\t\tclose: function(ok) {\n\t\t\t\t\tif (this.fireEvent('close', ok) !== false) {\n\t\t\t\t\t\t//还原环境\n\t\t\t\t\t\tif (this.fullscreen) {\n\t\n\t\t\t\t\t\t\tdocument.documentElement.style.overflowX = this._originalContext.html.overflowX;\n\t\t\t\t\t\t\tdocument.documentElement.style.overflowY = this._originalContext.html.overflowY;\n\t\t\t\t\t\t\tdocument.body.style.overflowX = this._originalContext.body.overflowX;\n\t\t\t\t\t\t\tdocument.body.style.overflowY = this._originalContext.body.overflowY;\n\t\t\t\t\t\t\tdelete this._originalContext;\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._hide();\n\t\n\t\t\t\t\t\t//销毁content\n\t\t\t\t\t\tvar content = this.getDom('content');\n\t\t\t\t\t\tvar iframe = this.getDom('iframe');\n\t\t\t\t\t\tif (content && iframe) {\n\t\t\t\t\t\t\tvar doc = iframe.contentDocument || iframe.contentWindow.document;\n\t\t\t\t\t\t\tdoc && (doc.body.innerHTML = '');\n\t\t\t\t\t\t\tdomUtils.remove(content);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Dialog, UIBase);\n\t\t})();\n\t\n\t\t// ui/menubutton.js\n\t\t///import core\n\t\t///import uicore\n\t\t///import ui/menu.js\n\t\t///import ui/splitbutton.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tMenu = baidu.editor.ui.Menu,\n\t\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\t\tMenuButton = baidu.editor.ui.MenuButton = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initMenuButton();\n\t\t\t\t};\n\t\t\tMenuButton.prototype = {\n\t\t\t\tinitMenuButton: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.uiName = \"menubutton\";\n\t\t\t\t\tthis.popup = new Menu({\n\t\t\t\t\t\titems: me.items,\n\t\t\t\t\t\tclassName: me.className,\n\t\t\t\t\t\teditor: me.editor\n\t\t\t\t\t});\n\t\t\t\t\tthis.popup.addListener('show', function() {\n\t\t\t\t\t\tvar list = this;\n\t\t\t\t\t\tfor (var i = 0; i < list.items.length; i++) {\n\t\t\t\t\t\t\tlist.items[i].removeState('checked');\n\t\t\t\t\t\t\tif (list.items[i].value == me._value) {\n\t\t\t\t\t\t\t\tlist.items[i].addState('checked');\n\t\t\t\t\t\t\t\tthis.value = me._value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.initSplitButton();\n\t\t\t\t},\n\t\t\t\tsetValue: function(value) {\n\t\t\t\t\tthis._value = value;\n\t\t\t\t}\n\t\n\t\t\t};\n\t\t\tutils.inherits(MenuButton, SplitButton);\n\t\t})();\n\t\n\t\t// ui/multiMenu.js\n\t\t///import core\n\t\t///import uicore\n\t\t///commands 表情\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\t\tMultiMenuPop = baidu.editor.ui.MultiMenuPop = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initMultiMenu();\n\t\t\t\t};\n\t\n\t\t\tMultiMenuPop.prototype = {\n\t\t\t\tinitMultiMenu: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t\tcontent: '',\n\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\tiframe_rendered: false,\n\t\t\t\t\t\tonshow: function() {\n\t\t\t\t\t\t\t\tif (!this.iframe_rendered) {\n\t\t\t\t\t\t\t\t\tthis.iframe_rendered = true;\n\t\t\t\t\t\t\t\t\tthis.getDom('content').innerHTML = '<iframe id=\"' + me.id + '_iframe\" src=\"' + me.iframeUrl + '\" frameborder=\"0\"></iframe>';\n\t\t\t\t\t\t\t\t\tme.editor.container.style.zIndex && (this.getDom().style.zIndex = me.editor.container.style.zIndex * 1 + 1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// canSideUp:false,\n\t\t\t\t\t\t\t// canSideLeft:false\n\t\t\t\t\t});\n\t\t\t\t\tthis.onbuttonclick = function() {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t};\n\t\t\t\t\tthis.initSplitButton();\n\t\t\t\t}\n\t\n\t\t\t};\n\t\n\t\t\tutils.inherits(MultiMenuPop, SplitButton);\n\t\t})();\n\t\n\t\t// ui/shortcutmenu.js\n\t\t(function() {\n\t\t\tvar UI = baidu.editor.ui,\n\t\t\t\tUIBase = UI.UIBase,\n\t\t\t\tuiUtils = UI.uiUtils,\n\t\t\t\tutils = baidu.editor.utils,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\t\n\t\t\tvar allMenus = [], //存储所有快捷菜单\n\t\t\t\ttimeID,\n\t\t\t\tisSubMenuShow = false; //是否有子pop显示\n\t\n\t\t\tvar ShortCutMenu = UI.ShortCutMenu = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initShortCutMenu();\n\t\t\t};\n\t\n\t\t\tShortCutMenu.postHide = hideAllMenu;\n\t\n\t\t\tShortCutMenu.prototype = {\n\t\t\t\tisHidden: true,\n\t\t\t\tSPACE: 5,\n\t\t\t\tinitShortCutMenu: function() {\n\t\t\t\t\tthis.items = this.items || [];\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tthis.initItems();\n\t\t\t\t\tthis.initEvent();\n\t\t\t\t\tallMenus.push(this);\n\t\t\t\t},\n\t\t\t\tinitEvent: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tdoc = me.editor.document;\n\t\n\t\t\t\t\tdomUtils.on(doc, \"mousemove\", function(e) {\n\t\t\t\t\t\tif (me.isHidden === false) {\n\t\t\t\t\t\t\t//有pop显示就不隐藏快捷菜单\n\t\t\t\t\t\t\tif (me.getSubMenuMark() || me.eventType == \"contextmenu\") return;\n\t\n\t\t\t\t\t\t\tvar flag = true,\n\t\t\t\t\t\t\t\tel = me.getDom(),\n\t\t\t\t\t\t\t\twt = el.offsetWidth,\n\t\t\t\t\t\t\t\tht = el.offsetHeight,\n\t\t\t\t\t\t\t\tdistanceX = wt / 2 + me.SPACE, //距离中心X标准\n\t\t\t\t\t\t\t\tdistanceY = ht / 2, //距离中心Y标准\n\t\t\t\t\t\t\t\tx = Math.abs(e.screenX - me.left), //离中心距离横坐标\n\t\t\t\t\t\t\t\ty = Math.abs(e.screenY - me.top); //离中心距离纵坐标\n\t\n\t\t\t\t\t\t\tclearTimeout(timeID);\n\t\t\t\t\t\t\ttimeID = setTimeout(function() {\n\t\t\t\t\t\t\t\tif (y > 0 && y < distanceY) {\n\t\t\t\t\t\t\t\t\tme.setOpacity(el, \"1\");\n\t\t\t\t\t\t\t\t} else if (y > distanceY && y < distanceY + 70) {\n\t\t\t\t\t\t\t\t\tme.setOpacity(el, \"0.5\");\n\t\t\t\t\t\t\t\t\tflag = false;\n\t\t\t\t\t\t\t\t} else if (y > distanceY + 70 && y < distanceY + 140) {\n\t\t\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tif (flag && x > 0 && x < distanceX) {\n\t\t\t\t\t\t\t\t\tme.setOpacity(el, \"1\")\n\t\t\t\t\t\t\t\t} else if (x > distanceX && x < distanceX + 70) {\n\t\t\t\t\t\t\t\t\tme.setOpacity(el, \"0.5\")\n\t\t\t\t\t\t\t\t} else if (x > distanceX + 70 && x < distanceX + 140) {\n\t\t\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\t//ie\\ff下 mouseout不准\n\t\t\t\t\tif (browser.chrome) {\n\t\t\t\t\t\tdomUtils.on(doc, \"mouseout\", function(e) {\n\t\t\t\t\t\t\tvar relatedTgt = e.relatedTarget || e.toElement;\n\t\n\t\t\t\t\t\t\tif (relatedTgt == null || relatedTgt.tagName == \"HTML\") {\n\t\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\n\t\t\t\t\tme.editor.addListener(\"afterhidepop\", function() {\n\t\t\t\t\t\tif (!me.isHidden) {\n\t\t\t\t\t\t\tisSubMenuShow = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t},\n\t\t\t\tinitItems: function() {\n\t\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\t\tfor (var i = 0, len = this.items.length; i < len; i++) {\n\t\t\t\t\t\t\tvar item = this.items[i].toLowerCase();\n\t\n\t\t\t\t\t\t\tif (UI[item]) {\n\t\t\t\t\t\t\t\tthis.items[i] = new UI[item](this.editor);\n\t\t\t\t\t\t\t\tthis.items[i].className += \" edui-shortcutsubmenu \";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsetOpacity: function(el, value) {\n\t\t\t\t\tif (browser.ie && browser.version < 9) {\n\t\t\t\t\t\tel.style.filter = \"alpha(opacity = \" + parseFloat(value) * 100 + \");\"\n\t\t\t\t\t} else {\n\t\t\t\t\t\tel.style.opacity = value;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetSubMenuMark: function() {\n\t\t\t\t\tisSubMenuShow = false;\n\t\t\t\t\tvar layerEle = uiUtils.getFixedLayer();\n\t\t\t\t\tvar list = domUtils.getElementsByTagName(layerEle, \"div\", function(node) {\n\t\t\t\t\t\treturn domUtils.hasClass(node, \"edui-shortcutsubmenu edui-popup\")\n\t\t\t\t\t});\n\t\n\t\t\t\t\tfor (var i = 0, node; node = list[i++];) {\n\t\t\t\t\t\tif (node.style.display != \"none\") {\n\t\t\t\t\t\t\tisSubMenuShow = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn isSubMenuShow;\n\t\t\t\t},\n\t\t\t\tshow: function(e, hasContextmenu) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\toffset = {},\n\t\t\t\t\t\tel = this.getDom(),\n\t\t\t\t\t\tfixedlayer = uiUtils.getFixedLayer();\n\t\n\t\t\t\t\tfunction setPos(offset) {\n\t\t\t\t\t\tif (offset.left < 0) {\n\t\t\t\t\t\t\toffset.left = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (offset.top < 0) {\n\t\t\t\t\t\t\toffset.top = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tel.style.cssText = \"position:absolute;left:\" + offset.left + \"px;top:\" + offset.top + \"px;\";\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction setPosByCxtMenu(menu) {\n\t\t\t\t\t\tif (!menu.tagName) {\n\t\t\t\t\t\t\tmenu = menu.getDom();\n\t\t\t\t\t\t}\n\t\t\t\t\t\toffset.left = parseInt(menu.style.left);\n\t\t\t\t\t\toffset.top = parseInt(menu.style.top);\n\t\t\t\t\t\toffset.top -= el.offsetHeight + 15;\n\t\t\t\t\t\tsetPos(offset);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tme.eventType = e.type;\n\t\t\t\t\tel.style.cssText = \"display:block;left:-9999px\";\n\t\n\t\t\t\t\tif (e.type == \"contextmenu\" && hasContextmenu) {\n\t\t\t\t\t\tvar menu = domUtils.getElementsByTagName(fixedlayer, \"div\", \"edui-contextmenu\")[0];\n\t\t\t\t\t\tif (menu) {\n\t\t\t\t\t\t\tsetPosByCxtMenu(menu)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.editor.addListener(\"aftershowcontextmenu\", function(type, menu) {\n\t\t\t\t\t\t\t\tsetPosByCxtMenu(menu);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\toffset = uiUtils.getViewportOffsetByEvent(e);\n\t\t\t\t\t\toffset.top -= el.offsetHeight + me.SPACE;\n\t\t\t\t\t\toffset.left += me.SPACE + 20;\n\t\t\t\t\t\tsetPos(offset);\n\t\t\t\t\t\tme.setOpacity(el, 0.2);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tme.isHidden = false;\n\t\t\t\t\tme.left = e.screenX + el.offsetWidth / 2 - me.SPACE;\n\t\t\t\t\tme.top = e.screenY - (el.offsetHeight / 2) - me.SPACE;\n\t\n\t\t\t\t\tif (me.editor) {\n\t\t\t\t\t\tel.style.zIndex = me.editor.container.style.zIndex * 1 + 10;\n\t\t\t\t\t\tfixedlayer.style.zIndex = el.style.zIndex - 1;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\thide: function() {\n\t\t\t\t\tif (this.getDom()) {\n\t\t\t\t\t\tthis.getDom().style.display = \"none\";\n\t\t\t\t\t}\n\t\t\t\t\tthis.isHidden = true;\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\t\tfor (var i = 0, item; item = this.items[i++];) {\n\t\t\t\t\t\t\titem.postRender();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\tvar buff;\n\t\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\t\tbuff = [];\n\t\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\t\tbuff[i] = this.items[i].renderHtml();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbuff = buff.join(\"\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuff = this.items;\n\t\t\t\t\t}\n\t\n\t\t\t\t\treturn '<div id=\"##\" class=\"%% edui-toolbar\" data-src=\"shortcutmenu\" onmousedown=\"return false;\" onselectstart=\"return false;\" >' +\n\t\t\t\t\t\tbuff +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tutils.inherits(ShortCutMenu, UIBase);\n\t\n\t\t\tfunction hideAllMenu(e) {\n\t\t\t\tvar tgt = e.target || e.srcElement,\n\t\t\t\t\tcur = domUtils.findParent(tgt, function(node) {\n\t\t\t\t\t\treturn domUtils.hasClass(node, \"edui-shortcutmenu\") || domUtils.hasClass(node, \"edui-popup\");\n\t\t\t\t\t}, true);\n\t\n\t\t\t\tif (!cur) {\n\t\t\t\t\tfor (var i = 0, menu; menu = allMenus[i++];) {\n\t\t\t\t\t\tmenu.hide()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\n\t\t\tdomUtils.on(document, 'mousedown', function(e) {\n\t\t\t\thideAllMenu(e);\n\t\t\t});\n\t\n\t\t\tdomUtils.on(window, 'scroll', function(e) {\n\t\t\t\thideAllMenu(e);\n\t\t\t});\n\t\n\t\t})();\n\t\n\t\t// ui/breakline.js\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tBreakline = baidu.editor.ui.Breakline = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initSeparator();\n\t\t\t\t};\n\t\t\tBreakline.prototype = {\n\t\t\t\tuiName: 'Breakline',\n\t\t\t\tinitSeparator: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<br/>';\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(Breakline, UIBase);\n\t\n\t\t})();\n\t\n\t\t// ui/message.js\n\t\t///import core\n\t\t///import uicore\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tMessage = baidu.editor.ui.Message = function(options) {\n\t\t\t\t\tthis.initOptions(options);\n\t\t\t\t\tthis.initMessage();\n\t\t\t\t};\n\t\n\t\t\tMessage.prototype = {\n\t\t\t\tinitMessage: function() {\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"edui-message %%\">' +\n\t\t\t\t\t\t' <div id=\"##_closer\" class=\"edui-message-closer\">×</div>' +\n\t\t\t\t\t\t' <div id=\"##_body\" class=\"edui-message-body edui-message-type-info\">' +\n\t\t\t\t\t\t' <iframe style=\"position:absolute;z-index:-1;left:0;top:0;background-color: transparent;\" frameborder=\"0\" width=\"100%\" height=\"100%\" src=\"about:blank\"></iframe>' +\n\t\t\t\t\t\t' <div class=\"edui-shadow\"></div>' +\n\t\t\t\t\t\t' <div id=\"##_content\" class=\"edui-message-content\">' +\n\t\t\t\t\t\t'  </div>' +\n\t\t\t\t\t\t' </div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t},\n\t\t\t\treset: function(opt) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (!opt.keepshow) {\n\t\t\t\t\t\tclearTimeout(this.timer);\n\t\t\t\t\t\tme.timer = setTimeout(function() {\n\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t}, opt.timeout || 4000);\n\t\t\t\t\t}\n\t\n\t\t\t\t\topt.content !== undefined && me.setContent(opt.content);\n\t\t\t\t\topt.type !== undefined && me.setType(opt.type);\n\t\n\t\t\t\t\tme.show();\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tcloser = this.getDom('closer');\n\t\t\t\t\tcloser && domUtils.on(closer, 'click', function() {\n\t\t\t\t\t\tme.hide();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetContent: function(content) {\n\t\t\t\t\tthis.getDom('content').innerHTML = content;\n\t\t\t\t},\n\t\t\t\tsetType: function(type) {\n\t\t\t\t\ttype = type || 'info';\n\t\t\t\t\tvar body = this.getDom('body');\n\t\t\t\t\tbody.className = body.className.replace(/edui-message-type-[\\w-]+/, 'edui-message-type-' + type);\n\t\t\t\t},\n\t\t\t\tgetContent: function() {\n\t\t\t\t\treturn this.getDom('content').innerHTML;\n\t\t\t\t},\n\t\t\t\tgetType: function() {\n\t\t\t\t\tvar arr = this.getDom('body').match(/edui-message-type-([\\w-]+)/);\n\t\t\t\t\treturn arr ? arr[1] : '';\n\t\t\t\t},\n\t\t\t\tshow: function() {\n\t\t\t\t\tthis.getDom().style.display = 'block';\n\t\t\t\t},\n\t\t\t\thide: function() {\n\t\t\t\t\tvar dom = this.getDom();\n\t\t\t\t\tif (dom) {\n\t\t\t\t\t\tdom.style.display = 'none';\n\t\t\t\t\t\tdom.parentNode && dom.parentNode.removeChild(dom);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tutils.inherits(Message, UIBase);\n\t\n\t\t})();\n\t\n\t\t// adapter/editorui.js\n\t\t//ui跟编辑器的适配層\n\t\t//那个按钮弹出是dialog，是下拉筐等都是在这个js中配置\n\t\t//自己写的ui也要在这里配置，放到baidu.editor.ui下边，当编辑器实例化的时候会根据ueditor.config中的toolbars找到相应的进行实例化\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils;\n\t\t\tvar editorui = baidu.editor.ui;\n\t\t\tvar _Dialog = editorui.Dialog;\n\t\t\teditorui.buttons = {};\n\t\n\t\t\teditorui.Dialog = function(options) {\n\t\t\t\tvar dialog = new _Dialog(options);\n\t\t\t\tdialog.addListener('hide', function() {\n\t\n\t\t\t\t\tif (dialog.editor) {\n\t\t\t\t\t\tvar editor = dialog.editor;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\t\tvar y = editor.window.scrollY,\n\t\t\t\t\t\t\t\t\tx = editor.window.scrollX;\n\t\t\t\t\t\t\t\teditor.body.focus();\n\t\t\t\t\t\t\t\teditor.window.scrollTo(x, y);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t} catch (ex) {}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn dialog;\n\t\t\t};\n\t\n\t\t\tvar iframeUrlMap = {\n\t\t\t\t'anchor': '~/dialogs/anchor/anchor.html',\n\t\t\t\t'insertimage': '~/dialogs/image/image.html',\n\t\t\t\t'link': '~/dialogs/link/link.html',\n\t\t\t\t'spechars': '~/dialogs/spechars/spechars.html',\n\t\t\t\t'searchreplace': '~/dialogs/searchreplace/searchreplace.html',\n\t\t\t\t'map': '~/dialogs/map/map.html',\n\t\t\t\t'gmap': '~/dialogs/gmap/gmap.html',\n\t\t\t\t'insertvideo': '~/dialogs/video/video.html',\n\t\t\t\t'help': '~/dialogs/help/help.html',\n\t\t\t\t'preview': '~/dialogs/preview/preview.html',\n\t\t\t\t'emotion': '~/dialogs/emotion/emotion.html',\n\t\t\t\t'wordimage': '~/dialogs/wordimage/wordimage.html',\n\t\t\t\t'attachment': '~/dialogs/attachment/attachment.html',\n\t\t\t\t'insertframe': '~/dialogs/insertframe/insertframe.html',\n\t\t\t\t'edittip': '~/dialogs/table/edittip.html',\n\t\t\t\t'edittable': '~/dialogs/table/edittable.html',\n\t\t\t\t'edittd': '~/dialogs/table/edittd.html',\n\t\t\t\t'webapp': '~/dialogs/webapp/webapp.html',\n\t\t\t\t'snapscreen': '~/dialogs/snapscreen/snapscreen.html',\n\t\t\t\t'scrawl': '~/dialogs/scrawl/scrawl.html',\n\t\t\t\t'music': '~/dialogs/music/music.html',\n\t\t\t\t'template': '~/dialogs/template/template.html',\n\t\t\t\t'background': '~/dialogs/background/background.html',\n\t\t\t\t'charts': '~/dialogs/charts/charts.html'\n\t\t\t};\n\t\t\t//为工具栏添加按钮，以下都是统一的按钮触发命令，所以写在一起\n\t\t\tvar btnCmds = ['undo', 'redo', 'formatmatch',\n\t\t\t\t'bold', 'italic', 'underline', 'fontborder', 'touppercase', 'tolowercase',\n\t\t\t\t'strikethrough', 'subscript', 'superscript', 'source', 'indent', 'outdent',\n\t\t\t\t'blockquote', 'pasteplain', 'pagebreak',\n\t\t\t\t'selectall', 'print', 'horizontal', 'removeformat', 'time', 'date', 'unlink',\n\t\t\t\t'insertparagraphbeforetable', 'insertrow', 'insertcol', 'mergeright', 'mergedown', 'deleterow',\n\t\t\t\t'deletecol', 'splittorows', 'splittocols', 'splittocells', 'mergecells', 'deletetable', 'drafts'\n\t\t\t];\n\t\n\t\t\tfor (var i = 0, ci; ci = btnCmds[i++];) {\n\t\t\t\tci = ci.toLowerCase();\n\t\t\t\teditorui[ci] = function(cmd) {\n\t\t\t\t\treturn function(editor) {\n\t\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\teditor.execCommand(cmd);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\tshowText: false\n\t\t\t\t\t\t});\n\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t\t\tui.setChecked(false);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn ui;\n\t\t\t\t\t};\n\t\t\t\t}(ci);\n\t\t\t}\n\t\n\t\t\t//清除文档\n\t\t\teditorui.cleardoc = function(editor) {\n\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\tclassName: 'edui-for-cleardoc',\n\t\t\t\t\ttitle: editor.options.labelMap.cleardoc || editor.getLang(\"labelMap.cleardoc\") || '',\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\tif (confirm(editor.getLang(\"confirmClear\"))) {\n\t\t\t\t\t\t\teditor.execCommand('cleardoc');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons[\"cleardoc\"] = ui;\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tui.setDisabled(editor.queryCommandState('cleardoc') == -1);\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\t//排版，图片排版，文字方向\n\t\t\tvar typeset = {\n\t\t\t\t'justify': ['left', 'right', 'center', 'justify'],\n\t\t\t\t'imagefloat': ['none', 'left', 'center', 'right'],\n\t\t\t\t'directionality': ['ltr', 'rtl']\n\t\t\t};\n\t\n\t\t\tfor (var p in typeset) {\n\t\n\t\t\t\t(function(cmd, val) {\n\t\t\t\t\tfor (var i = 0, ci; ci = val[i++];) {\n\t\t\t\t\t\t(function(cmd2) {\n\t\t\t\t\t\t\teditorui[cmd.replace('float', '') + cmd2] = function(editor) {\n\t\t\t\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd.replace('float', '') + cmd2,\n\t\t\t\t\t\t\t\t\ttitle: editor.options.labelMap[cmd.replace('float', '') + cmd2] || editor.getLang(\"labelMap.\" + cmd.replace('float', '') + cmd2) || '',\n\t\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\teditor.execCommand(cmd, cmd2);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\t\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1);\n\t\t\t\t\t\t\t\t\tui.setChecked(editor.queryCommandValue(cmd) == cmd2 && !uiReady);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn ui;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})(ci)\n\t\t\t\t\t}\n\t\t\t\t})(p, typeset[p])\n\t\t\t}\n\t\n\t\t\t//字体颜色和背景颜色\n\t\t\tfor (var i = 0, ci; ci = ['backcolor', 'forecolor'][i++];) {\n\t\t\t\teditorui[ci] = function(cmd) {\n\t\t\t\t\treturn function(editor) {\n\t\t\t\t\t\tvar ui = new editorui.ColorButton({\n\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\tcolor: 'default',\n\t\t\t\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\tonpickcolor: function(t, color) {\n\t\t\t\t\t\t\t\teditor.execCommand(cmd, color);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonpicknocolor: function() {\n\t\t\t\t\t\t\t\teditor.execCommand(cmd, 'default');\n\t\t\t\t\t\t\t\tthis.setColor('transparent');\n\t\t\t\t\t\t\t\tthis.color = 'default';\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\t\teditor.execCommand(cmd, this.color);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1);\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn ui;\n\t\t\t\t\t};\n\t\t\t\t}(ci);\n\t\t\t}\n\t\n\t\t\tvar dialogBtns = {\n\t\t\t\tnoOk: ['searchreplace', 'help', 'spechars', 'webapp', 'preview'],\n\t\t\t\tok: ['attachment', 'anchor', 'link', 'insertimage', 'map', 'gmap', 'insertframe', 'wordimage',\n\t\t\t\t\t'insertvideo', 'insertframe', 'edittip', 'edittable', 'edittd', 'scrawl', 'template', 'music', 'background', 'charts'\n\t\t\t\t]\n\t\t\t};\n\t\n\t\t\tfor (var p in dialogBtns) {\n\t\t\t\t(function(type, vals) {\n\t\t\t\t\tfor (var i = 0, ci; ci = vals[i++];) {\n\t\t\t\t\t\t//todo opera下存在问题\n\t\t\t\t\t\tif (browser.opera && ci === \"searchreplace\") {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t(function(cmd) {\n\t\t\t\t\t\t\teditorui[cmd] = function(editor, iframeUrl, title) {\n\t\t\t\t\t\t\t\tiframeUrl = iframeUrl || (editor.options.iframeUrlMap || {})[cmd] || iframeUrlMap[cmd];\n\t\t\t\t\t\t\t\ttitle = editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '';\n\t\n\t\t\t\t\t\t\t\tvar dialog;\n\t\t\t\t\t\t\t\t//没有iframeUrl不创建dialog\n\t\t\t\t\t\t\t\tif (iframeUrl) {\n\t\t\t\t\t\t\t\t\tdialog = new editorui.Dialog(utils.extend({\n\t\t\t\t\t\t\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl),\n\t\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\t\t\tholdScroll: cmd === 'insertimage',\n\t\t\t\t\t\t\t\t\t\tfullscreen: /charts|preview/.test(cmd),\n\t\t\t\t\t\t\t\t\t\tcloseDialog: editor.getLang(\"closeDialog\")\n\t\t\t\t\t\t\t\t\t}, type == 'ok' ? {\n\t\t\t\t\t\t\t\t\t\tbuttons: [{\n\t\t\t\t\t\t\t\t\t\t\tclassName: 'edui-okbutton',\n\t\t\t\t\t\t\t\t\t\t\tlabel: editor.getLang(\"ok\"),\n\t\t\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\t\t\tdialog.close(true);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\t\t\t\tclassName: 'edui-cancelbutton',\n\t\t\t\t\t\t\t\t\t\t\tlabel: editor.getLang(\"cancel\"),\n\t\t\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\t\t\tdialog.close(false);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t\t\t\t} : {}));\n\t\n\t\t\t\t\t\t\t\t\teditor.ui._dialogs[cmd + \"Dialog\"] = dialog;\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\tif (dialog) {\n\t\t\t\t\t\t\t\t\t\t\tswitch (cmd) {\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"wordimage\":\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar images = editor.execCommand(\"wordimage\");\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (images && images.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\tcase \"scrawl\":\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (editor.queryCommandState(\"scrawl\") != -1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\t\tdisabled: (cmd == 'scrawl' && editor.queryCommandState(\"scrawl\") == -1) || (cmd == 'charts')\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\t\t\t\t//只存在于右键菜单而无工具栏按钮的ui不需要检测状态\n\t\t\t\t\t\t\t\t\tvar unNeedCheckState = {\n\t\t\t\t\t\t\t\t\t\t'edittable': 1\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\tif (cmd in unNeedCheckState) return;\n\t\n\t\t\t\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\t\t\t\tif (ui.getDom()) {\n\t\t\t\t\t\t\t\t\t\tui.setDisabled(state == -1);\n\t\t\t\t\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\t\treturn ui;\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})(ci.toLowerCase())\n\t\t\t\t\t}\n\t\t\t\t})(p, dialogBtns[p]);\n\t\t\t}\n\t\n\t\t\teditorui.snapscreen = function(editor, iframeUrl, title) {\n\t\t\t\ttitle = editor.options.labelMap['snapscreen'] || editor.getLang(\"labelMap.snapscreen\") || '';\n\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\tclassName: 'edui-for-snapscreen',\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\teditor.execCommand(\"snapscreen\");\n\t\t\t\t\t},\n\t\t\t\t\ttheme: editor.options.theme\n\t\n\t\t\t\t});\n\t\t\t\teditorui.buttons['snapscreen'] = ui;\n\t\t\t\tiframeUrl = iframeUrl || (editor.options.iframeUrlMap || {})[\"snapscreen\"] || iframeUrlMap[\"snapscreen\"];\n\t\t\t\tif (iframeUrl) {\n\t\t\t\t\tvar dialog = new editorui.Dialog({\n\t\t\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl),\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tclassName: 'edui-for-snapscreen',\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\tbuttons: [{\n\t\t\t\t\t\t\tclassName: 'edui-okbutton',\n\t\t\t\t\t\t\tlabel: editor.getLang(\"ok\"),\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\tdialog.close(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tclassName: 'edui-cancelbutton',\n\t\t\t\t\t\t\tlabel: editor.getLang(\"cancel\"),\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\tdialog.close(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}]\n\t\n\t\t\t\t\t});\n\t\t\t\t\tdialog.render();\n\t\t\t\t\teditor.ui._dialogs[\"snapscreenDialog\"] = dialog;\n\t\t\t\t}\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tui.setDisabled(editor.queryCommandState('snapscreen') == -1);\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\teditorui.insertcode = function(editor, list, title) {\n\t\t\t\tlist = editor.options['insertcode'] || [];\n\t\t\t\ttitle = editor.options.labelMap['insertcode'] || editor.getLang(\"labelMap.insertcode\") || '';\n\t\t\t\t// if (!list.length) return;\n\t\t\t\tvar items = [];\n\t\t\t\tutils.each(list, function(key, val) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: key,\n\t\t\t\t\t\tvalue: val,\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" >' + (this.label || '') + '</div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\n\t\t\t\tvar ui = new editorui.Combox({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\titems: items,\n\t\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\t\teditor.execCommand('insertcode', this.items[index].value);\n\t\t\t\t\t},\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t},\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tinitValue: title,\n\t\t\t\t\tclassName: 'edui-for-insertcode',\n\t\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = this.items[i]; i++) {\n\t\t\t\t\t\t\t\tif (ci.value.indexOf(value) != -1)\n\t\t\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['insertcode'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\tvar state = editor.queryCommandState('insertcode');\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('insertcode');\n\t\t\t\t\t\t\tif (!value) {\n\t\t\t\t\t\t\t\tui.setValue(title);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//trace:1871 ie下从源码模式切换回来时，字体会带单引号，而且会有逗号\n\t\t\t\t\t\t\tvalue && (value = value.replace(/['\"]/g, '').split(',')[0]);\n\t\t\t\t\t\t\tui.setValue(value);\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\t\teditorui.fontfamily = function(editor, list, title) {\n\t\n\t\t\t\tlist = editor.options['fontfamily'] || [];\n\t\t\t\ttitle = editor.options.labelMap['fontfamily'] || editor.getLang(\"labelMap.fontfamily\") || '';\n\t\t\t\tif (!list.length) return;\n\t\t\t\tfor (var i = 0, ci, items = []; ci = list[i]; i++) {\n\t\t\t\t\tvar langLabel = editor.getLang('fontfamily')[ci.name] || \"\";\n\t\t\t\t\t(function(key, val) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tlabel: key,\n\t\t\t\t\t\t\tvalue: val,\n\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" style=\"font-family:' +\n\t\t\t\t\t\t\t\t\tutils.unhtml(this.value) + '\">' + (this.label || '') + '</div>';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})(ci.label || langLabel, ci.val)\n\t\t\t\t}\n\t\t\t\tvar ui = new editorui.Combox({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\titems: items,\n\t\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\t\teditor.execCommand('FontFamily', this.items[index].value);\n\t\t\t\t\t},\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t},\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tinitValue: title,\n\t\t\t\t\tclassName: 'edui-for-fontfamily',\n\t\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\t\tif (value) {\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = this.items[i]; i++) {\n\t\t\t\t\t\t\t\tif (ci.value.indexOf(value) != -1)\n\t\t\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['fontfamily'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\tvar state = editor.queryCommandState('FontFamily');\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('FontFamily');\n\t\t\t\t\t\t\t//trace:1871 ie下从源码模式切换回来时，字体会带单引号，而且会有逗号\n\t\t\t\t\t\t\tvalue && (value = value.replace(/['\"]/g, '').split(',')[0]);\n\t\t\t\t\t\t\tui.setValue(value);\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\teditorui.fontsize = function(editor, list, title) {\n\t\t\t\ttitle = editor.options.labelMap['fontsize'] || editor.getLang(\"labelMap.fontsize\") || '';\n\t\t\t\tlist = list || editor.options['fontsize'] || [];\n\t\t\t\tif (!list.length) return;\n\t\t\t\tvar items = [];\n\t\t\t\tfor (var i = 0; i < list.length; i++) {\n\t\t\t\t\tvar size = list[i] + 'px';\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: size,\n\t\t\t\t\t\tvalue: size,\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" style=\"line-height:1;font-size:' +\n\t\t\t\t\t\t\t\tthis.value + '\">' + (this.label || '') + '</div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tvar ui = new editorui.Combox({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\titems: items,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tinitValue: title,\n\t\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\t\teditor.execCommand('FontSize', this.items[index].value);\n\t\t\t\t\t},\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t},\n\t\t\t\t\tclassName: 'edui-for-fontsize'\n\t\t\t\t});\n\t\t\t\teditorui.buttons['fontsize'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\tvar state = editor.queryCommandState('FontSize');\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tui.setValue(editor.queryCommandValue('FontSize'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\teditorui.paragraph = function(editor, list, title) {\n\t\t\t\ttitle = editor.options.labelMap['paragraph'] || editor.getLang(\"labelMap.paragraph\") || '';\n\t\t\t\tlist = editor.options['paragraph'] || [];\n\t\t\t\tif (utils.isEmptyObject(list)) return;\n\t\t\t\tvar items = [];\n\t\t\t\tfor (var i in list) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tvalue: i,\n\t\t\t\t\t\tlabel: list[i] || editor.getLang(\"paragraph\")[i],\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\"><span class=\"edui-for-' + this.value + '\">' + (this.label || '') + '</span></div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tvar ui = new editorui.Combox({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\titems: items,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tinitValue: title,\n\t\t\t\t\tclassName: 'edui-for-paragraph',\n\t\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\t\teditor.execCommand('Paragraph', this.items[index].value);\n\t\t\t\t\t},\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['paragraph'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\tvar state = editor.queryCommandState('Paragraph');\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('Paragraph');\n\t\t\t\t\t\t\tvar index = ui.indexByValue(value);\n\t\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tui.setValue(ui.initValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\t//自定义标题\n\t\t\teditorui.customstyle = function(editor) {\n\t\t\t\tvar list = editor.options['customstyle'] || [],\n\t\t\t\t\ttitle = editor.options.labelMap['customstyle'] || editor.getLang(\"labelMap.customstyle\") || '';\n\t\t\t\tif (!list.length) return;\n\t\t\t\tvar langCs = editor.getLang('customstyle');\n\t\t\t\tfor (var i = 0, items = [], t; t = list[i++];) {\n\t\t\t\t\t(function(t) {\n\t\t\t\t\t\tvar ck = {};\n\t\t\t\t\t\tck.label = t.label ? t.label : langCs[t.name];\n\t\t\t\t\t\tck.style = t.style;\n\t\t\t\t\t\tck.className = t.className;\n\t\t\t\t\t\tck.tag = t.tag;\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tlabel: ck.label,\n\t\t\t\t\t\t\tvalue: ck,\n\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\">' + '<' + ck.tag + ' ' + (ck.className ? ' class=\"' + ck.className + '\"' : \"\") + (ck.style ? ' style=\"' + ck.style + '\"' : \"\") + '>' + ck.label + \"<\\/\" + ck.tag + \">\" + '</div>';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})(t);\n\t\t\t\t}\n\t\n\t\t\t\tvar ui = new editorui.Combox({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\titems: items,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tinitValue: title,\n\t\t\t\t\tclassName: 'edui-for-customstyle',\n\t\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\t\teditor.execCommand('customstyle', this.items[index].value);\n\t\t\t\t\t},\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t},\n\t\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\t\tfor (var i = 0, ti; ti = this.items[i++];) {\n\t\t\t\t\t\t\tif (ti.label == value) {\n\t\t\t\t\t\t\t\treturn i - 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['customstyle'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\tvar state = editor.queryCommandState('customstyle');\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('customstyle');\n\t\t\t\t\t\t\tvar index = ui.indexByValue(value);\n\t\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tui.setValue(ui.initValue);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\t\teditorui.inserttable = function(editor, iframeUrl, title) {\n\t\t\t\ttitle = editor.options.labelMap['inserttable'] || editor.getLang(\"labelMap.inserttable\") || '';\n\t\t\t\tvar ui = new editorui.TableButton({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tclassName: 'edui-for-inserttable',\n\t\t\t\t\tonpicktable: function(t, numCols, numRows) {\n\t\t\t\t\t\teditor.execCommand('InsertTable', {\n\t\t\t\t\t\t\tnumRows: numRows,\n\t\t\t\t\t\t\tnumCols: numCols,\n\t\t\t\t\t\t\tborder: 1\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\tthis.showPopup();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['inserttable'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tui.setDisabled(editor.queryCommandState('inserttable') == -1);\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\teditorui.lineheight = function(editor) {\n\t\t\t\tvar val = editor.options.lineheight || [];\n\t\t\t\tif (!val.length) return;\n\t\t\t\tfor (var i = 0, ci, items = []; ci = val[i++];) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\t//todo:写死了\n\t\t\t\t\t\tlabel: ci,\n\t\t\t\t\t\tvalue: ci,\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\teditor.execCommand(\"lineheight\", this.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\tclassName: 'edui-for-lineheight',\n\t\t\t\t\ttitle: editor.options.labelMap['lineheight'] || editor.getLang(\"labelMap.lineheight\") || '',\n\t\t\t\t\titems: items,\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\tvar value = editor.queryCommandValue('LineHeight') || this.value;\n\t\t\t\t\t\teditor.execCommand(\"LineHeight\", value);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['lineheight'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tvar state = editor.queryCommandState('LineHeight');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('LineHeight');\n\t\t\t\t\t\tvalue && ui.setValue((value + '').replace(/cm/, ''));\n\t\t\t\t\t\tui.setChecked(state)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\tvar rowspacings = ['top', 'bottom'];\n\t\t\tfor (var r = 0, ri; ri = rowspacings[r++];) {\n\t\t\t\t(function(cmd) {\n\t\t\t\t\teditorui['rowspacing' + cmd] = function(editor) {\n\t\t\t\t\t\tvar val = editor.options['rowspacing' + cmd] || [];\n\t\t\t\t\t\tif (!val.length) return null;\n\t\t\t\t\t\tfor (var i = 0, ci, items = []; ci = val[i++];) {\n\t\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\tlabel: ci,\n\t\t\t\t\t\t\t\tvalue: ci,\n\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\teditor.execCommand(\"rowspacing\", this.value, cmd);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\tclassName: 'edui-for-rowspacing' + cmd,\n\t\t\t\t\t\t\ttitle: editor.options.labelMap['rowspacing' + cmd] || editor.getLang(\"labelMap.rowspacing\" + cmd) || '',\n\t\t\t\t\t\t\titems: items,\n\t\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\t\tvar value = editor.queryCommandValue('rowspacing', cmd) || this.value;\n\t\t\t\t\t\t\t\teditor.execCommand(\"rowspacing\", value, cmd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\t\tvar state = editor.queryCommandState('rowspacing', cmd);\n\t\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\t\tvar value = editor.queryCommandValue('rowspacing', cmd);\n\t\t\t\t\t\t\t\tvalue && ui.setValue((value + '').replace(/%/, ''));\n\t\t\t\t\t\t\t\tui.setChecked(state)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn ui;\n\t\t\t\t\t}\n\t\t\t\t})(ri)\n\t\t\t}\n\t\t\t//有序，无序列表\n\t\t\tvar lists = ['insertorderedlist', 'insertunorderedlist'];\n\t\t\tfor (var l = 0, cl; cl = lists[l++];) {\n\t\t\t\t(function(cmd) {\n\t\t\t\t\teditorui[cmd] = function(editor) {\n\t\t\t\t\t\tvar vals = editor.options[cmd],\n\t\t\t\t\t\t\t_onMenuClick = function() {\n\t\t\t\t\t\t\t\teditor.execCommand(cmd, this.value);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\titems = [];\n\t\t\t\t\t\tfor (var i in vals) {\n\t\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\t\tlabel: vals[i] || editor.getLang()[cmd][i] || \"\",\n\t\t\t\t\t\t\t\tvalue: i,\n\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\tonclick: _onMenuClick\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\ttitle: editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\t\t'items': items,\n\t\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\t\tvar value = editor.queryCommandValue(cmd) || this.value;\n\t\t\t\t\t\t\t\teditor.execCommand(cmd, value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\t\tvar value = editor.queryCommandValue(cmd);\n\t\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t\t\tui.setChecked(state)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn ui;\n\t\t\t\t\t};\n\t\t\t\t})(cl)\n\t\t\t}\n\t\n\t\t\teditorui.fullscreen = function(editor, title) {\n\t\t\t\ttitle = editor.options.labelMap['fullscreen'] || editor.getLang(\"labelMap.fullscreen\") || '';\n\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\tclassName: 'edui-for-fullscreen',\n\t\t\t\t\ttitle: title,\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\tif (editor.ui) {\n\t\t\t\t\t\t\teditor.ui.setFullScreen(!editor.ui.isFullScreen());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setChecked(editor.ui.isFullScreen());\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['fullscreen'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tvar state = editor.queryCommandState('fullscreen');\n\t\t\t\t\tui.setDisabled(state == -1);\n\t\t\t\t\tui.setChecked(editor.ui.isFullScreen());\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\t// 表情\n\t\t\teditorui[\"emotion\"] = function(editor, iframeUrl) {\n\t\t\t\tvar cmd = \"emotion\";\n\t\t\t\tvar ui = new editorui.MultiMenuPop({\n\t\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd + \"\") || '',\n\t\t\t\t\teditor: editor,\n\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl || (editor.options.iframeUrlMap || {})[cmd] || iframeUrlMap[cmd])\n\t\t\t\t});\n\t\t\t\teditorui.buttons[cmd] = ui;\n\t\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1)\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\teditorui.autotypeset = function(editor) {\n\t\t\t\tvar ui = new editorui.AutoTypeSetButton({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\ttitle: editor.options.labelMap['autotypeset'] || editor.getLang(\"labelMap.autotypeset\") || '',\n\t\t\t\t\tclassName: 'edui-for-autotypeset',\n\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\teditor.execCommand('autotypeset')\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditorui.buttons['autotypeset'] = ui;\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tui.setDisabled(editor.queryCommandState('autotypeset') == -1);\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t\t/* 简单上传插件 */\n\t\t\teditorui[\"simpleupload\"] = function(editor) {\n\t\t\t\tvar name = 'simpleupload',\n\t\t\t\t\tui = new editorui.Button({\n\t\t\t\t\t\tclassName: 'edui-for-' + name,\n\t\t\t\t\t\ttitle: editor.options.labelMap[name] || editor.getLang(\"labelMap.\" + name) || '',\n\t\t\t\t\t\tonclick: function() {},\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\tshowText: false\n\t\t\t\t\t});\n\t\t\t\teditorui.buttons[name] = ui;\n\t\t\t\teditor.addListener('ready', function() {\n\t\t\t\t\tvar b = ui.getDom('body'),\n\t\t\t\t\t\ticonSpan = b.children[0];\n\t\t\t\t\teditor.fireEvent('simpleuploadbtnready', iconSpan);\n\t\t\t\t});\n\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState(name);\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\tui.setChecked(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn ui;\n\t\t\t};\n\t\n\t\t})();\n\t\n\t\t// adapter/editor.js\n\t\t///import core\n\t\t///commands 全屏\n\t\t///commandsName FullScreen\n\t\t///commandsTitle  全屏\n\t\t(function() {\n\t\t\tvar utils = baidu.editor.utils,\n\t\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\t\t\tvar nodeStack = [];\n\t\n\t\t\tfunction EditorUI(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initEditorUI();\n\t\t\t}\n\t\n\t\t\tEditorUI.prototype = {\n\t\t\t\tuiName: 'editor',\n\t\t\t\tinitEditorUI: function() {\n\t\t\t\t\tthis.editor.ui = this;\n\t\t\t\t\tthis._dialogs = {};\n\t\t\t\t\tthis.initUIBase();\n\t\t\t\t\tthis._initToolbars();\n\t\t\t\t\tvar editor = this.editor,\n\t\t\t\t\t\tme = this;\n\t\n\t\t\t\t\teditor.addListener('ready', function() {\n\t\t\t\t\t\t//提供getDialog方法\n\t\t\t\t\t\teditor.getDialog = function(name) {\n\t\t\t\t\t\t\treturn editor.ui._dialogs[name + \"Dialog\"];\n\t\t\t\t\t\t};\n\t\t\t\t\t\tdomUtils.on(editor.window, 'scroll', function(evt) {\n\t\t\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt);\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//提供编辑器实时宽高(全屏时宽高不变化)\n\t\t\t\t\t\teditor.ui._actualFrameWidth = editor.options.initialFrameWidth;\n\t\n\t\t\t\t\t\tUE.browser.ie && UE.browser.version === 6 && editor.container.ownerDocument.execCommand(\"BackgroundImageCache\", false, true);\n\t\n\t\t\t\t\t\t//display bottom-bar label based on config\n\t\t\t\t\t\tif (editor.options.elementPathEnabled) {\n\t\t\t\t\t\t\teditor.ui.getDom('elementpath').innerHTML = '<div class=\"edui-editor-breadcrumb\">' + editor.getLang(\"elementPathTip\") + ':</div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (editor.options.wordCount) {\n\t\t\t\t\t\t\tfunction countFn() {\n\t\t\t\t\t\t\t\tsetCount(editor, me);\n\t\t\t\t\t\t\t\tdomUtils.un(editor.document, \"click\", arguments.callee);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.on(editor.document, \"click\", countFn);\n\t\t\t\t\t\t\teditor.ui.getDom('wordcount').innerHTML = editor.getLang(\"wordCountTip\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\teditor.ui._scale();\n\t\t\t\t\t\tif (editor.options.scaleEnabled) {\n\t\t\t\t\t\t\tif (editor.autoHeightEnabled) {\n\t\t\t\t\t\t\t\teditor.disableAutoHeight();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.enableScale();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.disableScale();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!editor.options.elementPathEnabled && !editor.options.wordCount && !editor.options.scaleEnabled) {\n\t\t\t\t\t\t\teditor.ui.getDom('elementpath').style.display = \"none\";\n\t\t\t\t\t\t\teditor.ui.getDom('wordcount').style.display = \"none\";\n\t\t\t\t\t\t\teditor.ui.getDom('scale').style.display = \"none\";\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (!editor.selection.isFocus()) return;\n\t\t\t\t\t\teditor.fireEvent('selectionchange', false, true);\n\t\n\t\t\t\t\t});\n\t\n\t\t\t\t\teditor.addListener('mousedown', function(t, evt) {\n\t\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt, el);\n\t\t\t\t\t\tbaidu.editor.ui.ShortCutMenu.postHide(evt);\n\t\n\t\t\t\t\t});\n\t\t\t\t\teditor.addListener(\"delcells\", function() {\n\t\t\t\t\t\tif (UE.ui['edittip']) {\n\t\t\t\t\t\t\tnew UE.ui['edittip'](editor);\n\t\t\t\t\t\t}\n\t\t\t\t\t\teditor.getDialog('edittip').open();\n\t\t\t\t\t});\n\t\n\t\t\t\t\tvar pastePop, isPaste = false,\n\t\t\t\t\t\ttimer;\n\t\t\t\t\teditor.addListener(\"afterpaste\", function() {\n\t\t\t\t\t\tif (editor.queryCommandState('pasteplain'))\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\tif (baidu.editor.ui.PastePicker) {\n\t\t\t\t\t\t\tpastePop = new baidu.editor.ui.Popup({\n\t\t\t\t\t\t\t\tcontent: new baidu.editor.ui.PastePicker({\n\t\t\t\t\t\t\t\t\teditor: editor\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\tclassName: 'edui-wordpastepop'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tpastePop.render();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tisPaste = true;\n\t\t\t\t\t});\n\t\n\t\t\t\t\teditor.addListener(\"afterinserthtml\", function() {\n\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\t\tif (pastePop && (isPaste || editor.ui._isTransfer)) {\n\t\t\t\t\t\t\t\tif (pastePop.isHidden()) {\n\t\t\t\t\t\t\t\t\tvar span = domUtils.createElement(editor.document, 'span', {\n\t\t\t\t\t\t\t\t\t\t\t'style': \"line-height:0px;\",\n\t\t\t\t\t\t\t\t\t\t\t'innerHTML': '\\ufeff'\n\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\trange = editor.selection.getRange();\n\t\t\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\t\t\tvar tmp = getDomNode(span, 'firstChild', 'previousSibling');\n\t\t\t\t\t\t\t\t\ttmp && pastePop.showAnchor(tmp.nodeType == 3 ? tmp.parentNode : tmp);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(span);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tpastePop.show();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdelete editor.ui._isTransfer;\n\t\t\t\t\t\t\t\tisPaste = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 200)\n\t\t\t\t\t});\n\t\t\t\t\teditor.addListener('contextmenu', function(t, evt) {\n\t\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt);\n\t\t\t\t\t});\n\t\t\t\t\teditor.addListener('keydown', function(t, evt) {\n\t\t\t\t\t\tif (pastePop) pastePop.dispose(evt);\n\t\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\t\t\tif (evt.altKey && keyCode == 90) {\n\t\t\t\t\t\t\tUE.ui.buttons['fullscreen'].onclick();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditor.addListener('wordcount', function(type) {\n\t\t\t\t\t\tsetCount(this, me);\n\t\t\t\t\t});\n\t\n\t\t\t\t\tfunction setCount(editor, ui) {\n\t\t\t\t\t\teditor.setOpt({\n\t\t\t\t\t\t\twordCount: true,\n\t\t\t\t\t\t\tmaximumWords: 10000,\n\t\t\t\t\t\t\twordCountMsg: editor.options.wordCountMsg || editor.getLang(\"wordCountMsg\"),\n\t\t\t\t\t\t\twordOverFlowMsg: editor.options.wordOverFlowMsg || editor.getLang(\"wordOverFlowMsg\")\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar opt = editor.options,\n\t\t\t\t\t\t\tmax = opt.maximumWords,\n\t\t\t\t\t\t\tmsg = opt.wordCountMsg,\n\t\t\t\t\t\t\terrMsg = opt.wordOverFlowMsg,\n\t\t\t\t\t\t\tcountDom = ui.getDom('wordcount');\n\t\t\t\t\t\tif (!opt.wordCount) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar count = editor.getContentLength(true);\n\t\t\t\t\t\tif (count > max) {\n\t\t\t\t\t\t\tcountDom.innerHTML = errMsg;\n\t\t\t\t\t\t\teditor.fireEvent(\"wordcountoverflow\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcountDom.innerHTML = msg.replace(\"{#leave}\", max - count).replace(\"{#count}\", count);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\tif (editor.options.elementPathEnabled) {\n\t\t\t\t\t\t\tme[(editor.queryCommandState('elementpath') == -1 ? 'dis' : 'en') + 'ableElementPath']()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (editor.options.scaleEnabled) {\n\t\t\t\t\t\t\tme[(editor.queryCommandState('scale') == -1 ? 'dis' : 'en') + 'ableScale']();\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tvar popup = new baidu.editor.ui.Popup({\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tcontent: '',\n\t\t\t\t\t\tclassName: 'edui-bubble',\n\t\t\t\t\t\t_onEditButtonClick: function() {\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\teditor.ui._dialogs.linkDialog.open();\n\t\t\t\t\t\t},\n\t\t\t\t\t\t_onImgEditButtonClick: function(name) {\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\teditor.ui._dialogs[name] && editor.ui._dialogs[name].open();\n\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\t_onImgSetFloat: function(value) {\n\t\t\t\t\t\t\tconsole.log(this)\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\teditor.execCommand(\"imagefloat\", value);\n\t\n\t\t\t\t\t\t},\n\t\t\t\t\t\t_setIframeAlign: function(value) {\n\t\t\t\t\t\t\tvar frame = popup.anchorEl;\n\t\t\t\t\t\t\tvar newFrame = frame.cloneNode(true);\n\t\t\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\t\t\tcase -2:\n\t\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"\");\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase -1:\n\t\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"left\");\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"right\");\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tframe.parentNode.insertBefore(newFrame, frame);\n\t\t\t\t\t\t\tdomUtils.remove(frame);\n\t\t\t\t\t\t\tpopup.anchorEl = newFrame;\n\t\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t_updateIframe: function() {\n\t\t\t\t\t\t\tvar frame = editor._iframe = popup.anchorEl;\n\t\t\t\t\t\t\tif (domUtils.hasClass(frame, 'ueditor_baidumap')) {\n\t\t\t\t\t\t\t\teditor.selection.getRange().selectNode(frame).select();\n\t\t\t\t\t\t\t\teditor.ui._dialogs.mapDialog.open();\n\t\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\teditor.ui._dialogs.insertframeDialog.open();\n\t\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t_onRemoveButtonClick: function(cmdName) {\n\t\t\t\t\t\t\teditor.execCommand(cmdName);\n\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tqueryAutoHide: function(el) {\n\t\t\t\t\t\t\tif (el && el.ownerDocument == editor.document) {\n\t\t\t\t\t\t\t\tif (el.tagName.toLowerCase() == 'img' || domUtils.findParentByTagName(el, 'a', true)) {\n\t\t\t\t\t\t\t\t\treturn el !== popup.anchorEl;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn baidu.editor.ui.Popup.prototype.queryAutoHide.call(this, el);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tpopup.render();\n\t\t\t\t\tif (editor.options.imagePopup) {\n\t\t\t\t\t\teditor.addListener('mouseover', function(t, evt) {\n\t\t\t\t\t\t\tevt = evt || window.event;\n\t\t\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\t\t\tif (editor.ui._dialogs.insertframeDialog && /iframe/ig.test(el.tagName)) {\n\t\t\t\t\t\t\t\tvar html = popup.formatHtml(\n\t\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"property\") + ': <span onclick=$$._setIframeAlign(-2) class=\"edui-clickable\">' + editor.getLang(\"default\") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class=\"edui-clickable\">' + editor.getLang(\"justifyleft\") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class=\"edui-clickable\">' + editor.getLang(\"justifyright\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t' <span onclick=\"$$._updateIframe( this);\" class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span></nobr>');\n\t\t\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\t\t\tpopup.getDom('content').innerHTML = html;\n\t\t\t\t\t\t\t\t\tpopup.anchorEl = el;\n\t\t\t\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\teditor.addListener('selectionchange', function(t, causeByUi) {\n\t\t\t\t\t\t\tif (!causeByUi) return;\n\t\t\t\t\t\t\tvar html = '',\n\t\t\t\t\t\t\t\tstr = \"\",\n\t\t\t\t\t\t\t\timg = editor.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\t\tdialogs = editor.ui._dialogs;\n\t\t\t\t\t\t\tif (img && img.tagName == 'IMG') {\n\t\t\t\t\t\t\t\tvar dialogName = 'insertimageDialog';\n\t\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-video\") != -1 || img.className.indexOf(\"edui-upload-video\") != -1) {\n\t\t\t\t\t\t\t\t\tdialogName = \"insertvideoDialog\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-webapp\") != -1) {\n\t\t\t\t\t\t\t\t\tdialogName = \"webappDialog\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (img.src.indexOf(\"http://api.map.baidu.com\") != -1) {\n\t\t\t\t\t\t\t\t\tdialogName = \"mapDialog\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-music\") != -1) {\n\t\t\t\t\t\t\t\t\tdialogName = \"musicDialog\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (img.src.indexOf(\"http://maps.google.com/maps/api/staticmap\") != -1) {\n\t\t\t\t\t\t\t\t\tdialogName = \"gmapDialog\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (img.getAttribute(\"anchorname\")) {\n\t\t\t\t\t\t\t\t\tdialogName = \"anchorDialog\";\n\t\t\t\t\t\t\t\t\thtml = popup.formatHtml(\n\t\t\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"property\") + ': <span onclick=$$._onImgEditButtonClick(\"anchorDialog\") class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t\t'<span onclick=$$._onRemoveButtonClick(\\'anchor\\') class=\"edui-clickable\">' + editor.getLang(\"delete\") + '</span></nobr>');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (img.getAttribute(\"word_img\")) {\n\t\t\t\t\t\t\t\t\t//todo 放到dialog去做查询\n\t\t\t\t\t\t\t\t\teditor.word_img = [img.getAttribute(\"word_img\")];\n\t\t\t\t\t\t\t\t\tdialogName = \"wordimageDialog\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (domUtils.hasClass(img, 'loadingclass') || domUtils.hasClass(img, 'loaderrorclass')) {\n\t\t\t\t\t\t\t\t\tdialogName = \"\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!dialogs[dialogName]) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstr = '<nobr>' + editor.getLang(\"property\") + ': ' +\n\t\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"none\") class=\"edui-clickable ssss\">' + editor.getLang(\"default\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"left\") class=\"edui-clickable\">' + editor.getLang(\"justifyleft\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"right\") class=\"edui-clickable\">' + editor.getLang(\"justifyright\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"center\") class=\"edui-clickable\">' + editor.getLang(\"justifycenter\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t'<span onclick=\"$$._onImgEditButtonClick(\\'' + dialogName + '\\');\" class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span></nobr>';\n\t\n\t\t\t\t\t\t\t\t!html && (html = popup.formatHtml(str))\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (editor.ui._dialogs.linkDialog) {\n\t\t\t\t\t\t\t\tvar link = editor.queryCommandValue('link');\n\t\t\t\t\t\t\t\tvar url;\n\t\t\t\t\t\t\t\tif (link && (url = (link.getAttribute('_href') || link.getAttribute('href', 2)))) {\n\t\t\t\t\t\t\t\t\tvar txt = url;\n\t\t\t\t\t\t\t\t\tif (url.length > 30) {\n\t\t\t\t\t\t\t\t\t\ttxt = url.substring(0, 20) + \"...\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\t\t\t\thtml += '<div style=\"height:5px;\"></div>'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\thtml += popup.formatHtml(\n\t\t\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"anthorMsg\") + ': <a target=\"_blank\" href=\"' + url + '\" title=\"' + url + '\" >' + txt + '</a>' +\n\t\t\t\t\t\t\t\t\t\t' <span class=\"edui-clickable\" onclick=\"$$._onEditButtonClick();\">' + editor.getLang(\"modify\") + '</span>' +\n\t\t\t\t\t\t\t\t\t\t' <span class=\"edui-clickable\" onclick=\"$$._onRemoveButtonClick(\\'unlink\\');\"> ' + editor.getLang(\"clear\") + '</span></nobr>');\n\t\t\t\t\t\t\t\t\tpopup.showAnchor(link);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\t\tpopup.getDom('content').innerHTML = html;\n\t\t\t\t\t\t\t\tpopup.anchorEl = img || link;\n\t\t\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\n\t\t\t\t},\n\t\t\t\t_initToolbars: function() {\n\t\t\t\t\tvar editor = this.editor;\n\t\t\t\t\tvar toolbars = this.toolbars || [];\n\t\t\t\t\tvar toolbarUis = [];\n\t\t\t\t\tfor (var i = 0; i < toolbars.length; i++) {\n\t\t\t\t\t\tvar toolbar = toolbars[i];\n\t\t\t\t\t\tvar toolbarUi = new baidu.editor.ui.Toolbar({\n\t\t\t\t\t\t\ttheme: editor.options.theme\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfor (var j = 0; j < toolbar.length; j++) {\n\t\t\t\t\t\t\tvar toolbarItem = toolbar[j];\n\t\t\t\t\t\t\tvar toolbarItemUi = null;\n\t\t\t\t\t\t\tif (typeof toolbarItem == 'string') {\n\t\t\t\t\t\t\t\ttoolbarItem = toolbarItem.toLowerCase();\n\t\t\t\t\t\t\t\tif (toolbarItem == '|') {\n\t\t\t\t\t\t\t\t\ttoolbarItem = 'Separator';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (toolbarItem == '||') {\n\t\t\t\t\t\t\t\t\ttoolbarItem = 'Breakline';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (baidu.editor.ui[toolbarItem]) {\n\t\t\t\t\t\t\t\t\ttoolbarItemUi = new baidu.editor.ui[toolbarItem](editor);\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t//fullscreen这里单独处理一下，放到首行去\n\t\t\t\t\t\t\t\tif (toolbarItem == 'fullscreen') {\n\t\t\t\t\t\t\t\t\tif (toolbarUis && toolbarUis[0]) {\n\t\t\t\t\t\t\t\t\t\ttoolbarUis[0].items.splice(0, 0, toolbarItemUi);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\ttoolbarItemUi && toolbarUi.items.splice(0, 0, toolbarItemUi);\n\t\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttoolbarItemUi = toolbarItem;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (toolbarItemUi && toolbarItemUi.id) {\n\t\n\t\t\t\t\t\t\t\ttoolbarUi.add(toolbarItemUi);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttoolbarUis[i] = toolbarUi;\n\t\t\t\t\t}\n\t\n\t\t\t\t\t//接受外部定制的UI\n\t\n\t\t\t\t\tutils.each(UE._customizeUI, function(obj, key) {\n\t\t\t\t\t\tvar itemUI, index;\n\t\t\t\t\t\tif (obj.id && obj.id != editor.key) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\titemUI = obj.execFn.call(editor, editor, key);\n\t\t\t\t\t\tif (itemUI) {\n\t\t\t\t\t\t\tindex = obj.index;\n\t\t\t\t\t\t\tif (index === undefined) {\n\t\t\t\t\t\t\t\tindex = toolbarUi.items.length;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttoolbarUi.add(itemUI, index)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\tthis.toolbars = toolbarUis;\n\t\t\t\t},\n\t\t\t\tgetHtmlTpl: function() {\n\t\t\t\t\treturn '<div id=\"##\" class=\"%%\">' +\n\t\t\t\t\t\t'<div id=\"##_toolbarbox\" class=\"%%-toolbarbox\">' +\n\t\t\t\t\t\t(this.toolbars.length ?\n\t\t\t\t\t\t\t'<div id=\"##_toolbarboxouter\" class=\"%%-toolbarboxouter\"><div class=\"%%-toolbarboxinner\">' +\n\t\t\t\t\t\t\tthis.renderToolbarBoxHtml() +\n\t\t\t\t\t\t\t'</div></div>' : '') +\n\t\t\t\t\t\t'<div id=\"##_toolbarmsg\" class=\"%%-toolbarmsg\" style=\"display:none;\">' +\n\t\t\t\t\t\t'<div id = \"##_upload_dialog\" class=\"%%-toolbarmsg-upload\" onclick=\"$$.showWordImageDialog();\">' + this.editor.getLang(\"clickToUpload\") + '</div>' +\n\t\t\t\t\t\t'<div class=\"%%-toolbarmsg-close\" onclick=\"$$.hideToolbarMsg();\">x</div>' +\n\t\t\t\t\t\t'<div id=\"##_toolbarmsg_label\" class=\"%%-toolbarmsg-label\"></div>' +\n\t\t\t\t\t\t'<div style=\"height:0;overflow:hidden;clear:both;\"></div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div id=\"##_message_holder\" class=\"%%-messageholder\"></div>' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t'<div id=\"##_iframeholder\" class=\"%%-iframeholder\">' +\n\t\t\t\t\t\t'</div>' +\n\t\t\t\t\t\t//modify wdcount by matao\n\t\t\t\t\t\t'<div id=\"##_bottombar\" class=\"%%-bottomContainer\"><table><tr>' +\n\t\t\t\t\t\t'<td id=\"##_elementpath\" class=\"%%-bottombar\"></td>' +\n\t\t\t\t\t\t'<td id=\"##_wordcount\" class=\"%%-wordcount\"></td>' +\n\t\t\t\t\t\t'<td id=\"##_scale\" class=\"%%-scale\"><div class=\"%%-icon\"></div></td>' +\n\t\t\t\t\t\t'</tr></table></div>' +\n\t\t\t\t\t\t'<div id=\"##_scalelayer\"></div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t},\n\t\t\t\tshowWordImageDialog: function() {\n\t\t\t\t\tthis._dialogs['wordimageDialog'].open();\n\t\t\t\t},\n\t\t\t\trenderToolbarBoxHtml: function() {\n\t\t\t\t\tvar buff = [];\n\t\t\t\t\tfor (var i = 0; i < this.toolbars.length; i++) {\n\t\t\t\t\t\tbuff.push(this.toolbars[i].renderHtml());\n\t\t\t\t\t}\n\t\t\t\t\treturn buff.join('');\n\t\t\t\t},\n\t\t\t\tsetFullScreen: function(fullscreen) {\n\t\n\t\t\t\t\tvar editor = this.editor,\n\t\t\t\t\t\tcontainer = editor.container.parentNode.parentNode;\n\t\t\t\t\tif (this._fullscreen != fullscreen) {\n\t\t\t\t\t\tthis._fullscreen = fullscreen;\n\t\t\t\t\t\tthis.editor.fireEvent('beforefullscreenchange', fullscreen);\n\t\t\t\t\t\tif (baidu.editor.browser.gecko) {\n\t\t\t\t\t\t\tvar bk = editor.selection.getRange().createBookmark();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (fullscreen) {\n\t\t\t\t\t\t\twhile (container.tagName != \"BODY\") {\n\t\t\t\t\t\t\t\tvar position = baidu.editor.dom.domUtils.getComputedStyle(container, \"position\");\n\t\t\t\t\t\t\t\tnodeStack.push(position);\n\t\t\t\t\t\t\t\tcontainer.style.position = \"static\";\n\t\t\t\t\t\t\t\tcontainer = container.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._bakHtmlOverflow = document.documentElement.style.overflow;\n\t\t\t\t\t\t\tthis._bakBodyOverflow = document.body.style.overflow;\n\t\t\t\t\t\t\tthis._bakAutoHeight = this.editor.autoHeightEnabled;\n\t\t\t\t\t\t\tthis._bakScrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);\n\t\n\t\t\t\t\t\t\tthis._bakEditorContaninerWidth = editor.iframe.parentNode.offsetWidth;\n\t\t\t\t\t\t\tif (this._bakAutoHeight) {\n\t\t\t\t\t\t\t\t//当全屏时不能执行自动长高\n\t\t\t\t\t\t\t\teditor.autoHeightEnabled = false;\n\t\t\t\t\t\t\t\tthis.editor.disableAutoHeight();\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tdocument.documentElement.style.overflow = 'hidden';\n\t\t\t\t\t\t\t//修复，滚动条不收起的问题\n\t\n\t\t\t\t\t\t\twindow.scrollTo(0, window.scrollY);\n\t\t\t\t\t\t\tthis._bakCssText = this.getDom().style.cssText;\n\t\t\t\t\t\t\tthis._bakCssText1 = this.getDom('iframeholder').style.cssText;\n\t\t\t\t\t\t\teditor.iframe.parentNode.style.width = '';\n\t\t\t\t\t\t\tthis._updateFullScreen();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twhile (container.tagName != \"BODY\") {\n\t\t\t\t\t\t\t\tcontainer.style.position = nodeStack.shift();\n\t\t\t\t\t\t\t\tcontainer = container.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.getDom().style.cssText = this._bakCssText;\n\t\t\t\t\t\t\tthis.getDom('iframeholder').style.cssText = this._bakCssText1;\n\t\t\t\t\t\t\tif (this._bakAutoHeight) {\n\t\t\t\t\t\t\t\teditor.autoHeightEnabled = true;\n\t\t\t\t\t\t\t\tthis.editor.enableAutoHeight();\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\tdocument.documentElement.style.overflow = this._bakHtmlOverflow;\n\t\t\t\t\t\t\tdocument.body.style.overflow = this._bakBodyOverflow;\n\t\t\t\t\t\t\teditor.iframe.parentNode.style.width = this._bakEditorContaninerWidth + 'px';\n\t\t\t\t\t\t\twindow.scrollTo(0, this._bakScrollTop);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (browser.gecko && editor.body.contentEditable === 'true') {\n\t\t\t\t\t\t\tvar input = document.createElement('input');\n\t\t\t\t\t\t\tdocument.body.appendChild(input);\n\t\t\t\t\t\t\teditor.body.contentEditable = false;\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\teditor.body.contentEditable = true;\n\t\t\t\t\t\t\t\t\teditor.fireEvent('fullscreenchanged', fullscreen);\n\t\t\t\t\t\t\t\t\teditor.selection.getRange().moveToBookmark(bk).select(true);\n\t\t\t\t\t\t\t\t\tbaidu.editor.dom.domUtils.remove(input);\n\t\t\t\t\t\t\t\t\tfullscreen && window.scroll(0, 0);\n\t\t\t\t\t\t\t\t}, 0)\n\t\t\t\t\t\t\t}, 0)\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tif (editor.body.contentEditable === 'true') {\n\t\t\t\t\t\t\tthis.editor.fireEvent('fullscreenchanged', fullscreen);\n\t\t\t\t\t\t\tthis.triggerLayout();\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_updateFullScreen: function() {\n\t\t\t\t\tif (this._fullscreen) {\n\t\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\t\tthis.getDom().style.cssText = 'border:0;position:absolute;left:0;top:' + (this.editor.options.topOffset || 0) + 'px;width:' + vpRect.width + 'px;height:' + vpRect.height + 'px;z-index:' + (this.getDom().style.zIndex * 1 + 100);\n\t\t\t\t\t\tuiUtils.setViewportOffset(this.getDom(), {\n\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\ttop: this.editor.options.topOffset || 0\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.editor.setHeight(vpRect.height - this.getDom('toolbarbox').offsetHeight - this.getDom('bottombar').offsetHeight - (this.editor.options.topOffset || 0), true);\n\t\t\t\t\t\t//不手动调一下，会导致全屏失效\n\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\twindow.onresize();\n\t\t\t\t\t\t\t} catch (e) {\n\t\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_updateElementPath: function() {\n\t\t\t\t\tvar bottom = this.getDom('elementpath'),\n\t\t\t\t\t\tlist;\n\t\t\t\t\tif (this.elementPathEnabled && (list = this.editor.queryCommandValue('elementpath'))) {\n\t\n\t\t\t\t\t\tvar buff = [];\n\t\t\t\t\t\tfor (var i = 0, ci; ci = list[i]; i++) {\n\t\t\t\t\t\t\tbuff[i] = this.formatHtml('<span unselectable=\"on\" onclick=\"$$.editor.execCommand(&quot;elementpath&quot;, &quot;' + i + '&quot;);\">' + ci + '</span>');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbottom.innerHTML = '<div class=\"edui-editor-breadcrumb\" onmousedown=\"return false;\">' + this.editor.getLang(\"elementPathTip\") + ': ' + buff.join(' &gt; ') + '</div>';\n\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbottom.style.display = 'none'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdisableElementPath: function() {\n\t\t\t\t\tvar bottom = this.getDom('elementpath');\n\t\t\t\t\tbottom.innerHTML = '';\n\t\t\t\t\tbottom.style.display = 'none';\n\t\t\t\t\tthis.elementPathEnabled = false;\n\t\n\t\t\t\t},\n\t\t\t\tenableElementPath: function() {\n\t\t\t\t\tvar bottom = this.getDom('elementpath');\n\t\t\t\t\tbottom.style.display = '';\n\t\t\t\t\tthis.elementPathEnabled = true;\n\t\t\t\t\tthis._updateElementPath();\n\t\t\t\t},\n\t\t\t\t_scale: function() {\n\t\t\t\t\tvar doc = document,\n\t\t\t\t\t\teditor = this.editor,\n\t\t\t\t\t\teditorHolder = editor.container,\n\t\t\t\t\t\teditorDocument = editor.document,\n\t\t\t\t\t\ttoolbarBox = this.getDom(\"toolbarbox\"),\n\t\t\t\t\t\tbottombar = this.getDom(\"bottombar\"),\n\t\t\t\t\t\tscale = this.getDom(\"scale\"),\n\t\t\t\t\t\tscalelayer = this.getDom(\"scalelayer\");\n\t\n\t\t\t\t\tvar isMouseMove = false,\n\t\t\t\t\t\tposition = null,\n\t\t\t\t\t\tminEditorHeight = 0,\n\t\t\t\t\t\tminEditorWidth = editor.options.minFrameWidth,\n\t\t\t\t\t\tpageX = 0,\n\t\t\t\t\t\tpageY = 0,\n\t\t\t\t\t\tscaleWidth = 0,\n\t\t\t\t\t\tscaleHeight = 0;\n\t\n\t\t\t\t\tfunction down() {\n\t\t\t\t\t\tposition = domUtils.getXY(editorHolder);\n\t\n\t\t\t\t\t\tif (!minEditorHeight) {\n\t\t\t\t\t\t\tminEditorHeight = editor.options.minFrameHeight + toolbarBox.offsetHeight + bottombar.offsetHeight;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\tscalelayer.style.cssText = \"position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:\" + editorHolder.offsetWidth + \"px;height:\" + editorHolder.offsetHeight + \"px;z-index:\" + (editor.options.zIndex + 1);\n\t\n\t\t\t\t\t\tdomUtils.on(doc, \"mousemove\", move);\n\t\t\t\t\t\tdomUtils.on(editorDocument, \"mouseup\", up);\n\t\t\t\t\t\tdomUtils.on(doc, \"mouseup\", up);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tvar me = this;\n\t\t\t\t\t//by xuheng 全屏时关掉缩放\n\t\t\t\t\tthis.editor.addListener('fullscreenchanged', function(e, fullScreen) {\n\t\t\t\t\t\tif (fullScreen) {\n\t\t\t\t\t\t\tme.disableScale();\n\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (me.editor.options.scaleEnabled) {\n\t\t\t\t\t\t\t\tme.enableScale();\n\t\t\t\t\t\t\t\tvar tmpNode = me.editor.document.createElement('span');\n\t\t\t\t\t\t\t\tme.editor.body.appendChild(tmpNode);\n\t\t\t\t\t\t\t\tme.editor.body.style.height = Math.max(domUtils.getXY(tmpNode).y, me.editor.iframe.offsetHeight - 20) + 'px';\n\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\tfunction move(event) {\n\t\t\t\t\t\tclearSelection();\n\t\t\t\t\t\tvar e = event || window.event;\n\t\t\t\t\t\tpageX = e.pageX || (doc.documentElement.scrollLeft + e.clientX);\n\t\t\t\t\t\tpageY = e.pageY || (doc.documentElement.scrollTop + e.clientY);\n\t\t\t\t\t\tscaleWidth = pageX - position.x;\n\t\t\t\t\t\tscaleHeight = pageY - position.y;\n\t\n\t\t\t\t\t\tif (scaleWidth >= minEditorWidth) {\n\t\t\t\t\t\t\tisMouseMove = true;\n\t\t\t\t\t\t\tscalelayer.style.width = scaleWidth + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (scaleHeight >= minEditorHeight) {\n\t\t\t\t\t\t\tisMouseMove = true;\n\t\t\t\t\t\t\tscalelayer.style.height = scaleHeight + \"px\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction up() {\n\t\t\t\t\t\tif (isMouseMove) {\n\t\t\t\t\t\t\tisMouseMove = false;\n\t\t\t\t\t\t\teditor.ui._actualFrameWidth = scalelayer.offsetWidth - 2;\n\t\t\t\t\t\t\teditorHolder.style.width = editor.ui._actualFrameWidth + 'px';\n\t\n\t\t\t\t\t\t\teditor.setHeight(scalelayer.offsetHeight - bottombar.offsetHeight - toolbarBox.offsetHeight - 2, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (scalelayer) {\n\t\t\t\t\t\t\tscalelayer.style.display = \"none\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tclearSelection();\n\t\t\t\t\t\tdomUtils.un(doc, \"mousemove\", move);\n\t\t\t\t\t\tdomUtils.un(editorDocument, \"mouseup\", up);\n\t\t\t\t\t\tdomUtils.un(doc, \"mouseup\", up);\n\t\t\t\t\t}\n\t\n\t\t\t\t\tfunction clearSelection() {\n\t\t\t\t\t\tif (browser.ie)\n\t\t\t\t\t\t\tdoc.selection.clear();\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t\t}\n\t\n\t\t\t\t\tthis.enableScale = function() {\n\t\t\t\t\t\t//trace:2868\n\t\t\t\t\t\tif (editor.queryCommandState(\"source\") == 1) return;\n\t\t\t\t\t\tscale.style.display = \"\";\n\t\t\t\t\t\tthis.scaleEnabled = true;\n\t\t\t\t\t\tdomUtils.on(scale, \"mousedown\", down);\n\t\t\t\t\t};\n\t\t\t\t\tthis.disableScale = function() {\n\t\t\t\t\t\tscale.style.display = \"none\";\n\t\t\t\t\t\tthis.scaleEnabled = false;\n\t\t\t\t\t\tdomUtils.un(scale, \"mousedown\", down);\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tisFullScreen: function() {\n\t\t\t\t\treturn this._fullscreen;\n\t\t\t\t},\n\t\t\t\tpostRender: function() {\n\t\t\t\t\tUIBase.prototype.postRender.call(this);\n\t\t\t\t\tfor (var i = 0; i < this.toolbars.length; i++) {\n\t\t\t\t\t\tthis.toolbars[i].postRender();\n\t\t\t\t\t}\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar timerId,\n\t\t\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\t\t\tupdateFullScreenTime = function() {\n\t\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t\t\ttimerId = setTimeout(function() {\n\t\t\t\t\t\t\t\tme._updateFullScreen();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t};\n\t\t\t\t\tdomUtils.on(window, 'resize', updateFullScreenTime);\n\t\n\t\t\t\t\tme.addListener('destroy', function() {\n\t\t\t\t\t\tdomUtils.un(window, 'resize', updateFullScreenTime);\n\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tshowToolbarMsg: function(msg, flag) {\n\t\t\t\t\tthis.getDom('toolbarmsg_label').innerHTML = msg;\n\t\t\t\t\tthis.getDom('toolbarmsg').style.display = '';\n\t\t\t\t\t//\n\t\t\t\t\tif (!flag) {\n\t\t\t\t\t\tvar w = this.getDom('upload_dialog');\n\t\t\t\t\t\tw.style.display = 'none';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\thideToolbarMsg: function() {\n\t\t\t\t\tthis.getDom('toolbarmsg').style.display = 'none';\n\t\t\t\t},\n\t\t\t\tmapUrl: function(url) {\n\t\t\t\t\treturn url ? url.replace('~/', this.editor.options.UEDITOR_HOME_URL || '') : ''\n\t\t\t\t},\n\t\t\t\ttriggerLayout: function() {\n\t\t\t\t\tvar dom = this.getDom();\n\t\t\t\t\tif (dom.style.zoom == '1') {\n\t\t\t\t\t\tdom.style.zoom = '100%';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdom.style.zoom = '1';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tutils.inherits(EditorUI, baidu.editor.ui.UIBase);\n\t\n\t\t\tvar instances = {};\n\t\n\t\t\tUE.ui.Editor = function(options) {\n\t\t\t\tvar editor = new UE.Editor(options);\n\t\t\t\teditor.options.editor = editor;\n\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\thref: editor.options.themePath + \"ueditor.css?v=\"+$GLOBAL_CONFIG['versionData'],\n\t\t\t\t\ttag: \"link\",\n\t\t\t\t\ttype: \"text/css\",\n\t\t\t\t\trel: \"stylesheet\"\n\t\t\t\t});\n\t\n\t\t\t\tvar oldRender = editor.render;\n\t\t\t\teditor.render = function(holder) {\n\t\t\t\t\tif (holder.constructor === String) {\n\t\t\t\t\t\teditor.key = holder;\n\t\t\t\t\t\tinstances[holder] = editor;\n\t\t\t\t\t}\n\t\t\t\t\tutils.domReady(function() {\n\t\t\t\t\t\teditor.langIsReady ? renderUI() : editor.addListener(\"langReady\", renderUI);\n\t\n\t\t\t\t\t\tfunction renderUI() {\n\t\t\t\t\t\t\teditor.setOpt({\n\t\t\t\t\t\t\t\tlabelMap: editor.options.labelMap || editor.getLang('labelMap')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnew EditorUI(editor.options);\n\t\t\t\t\t\t\tif (holder) {\n\t\t\t\t\t\t\t\tif (holder.constructor === String) {\n\t\t\t\t\t\t\t\t\tholder = document.getElementById(holder);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tholder && holder.getAttribute('name') && (editor.options.textarea = holder.getAttribute('name'));\n\t\t\t\t\t\t\t\tif (holder && /script|textarea/ig.test(holder.tagName)) {\n\t\t\t\t\t\t\t\t\tvar newDiv = document.createElement('div');\n\t\t\t\t\t\t\t\t\tholder.parentNode.insertBefore(newDiv, holder);\n\t\t\t\t\t\t\t\t\tvar cont = holder.value || holder.innerHTML;\n\t\t\t\t\t\t\t\t\teditor.options.initialContent = /^[\\t\\r\\n ]*$/.test(cont) ? editor.options.initialContent :\n\t\t\t\t\t\t\t\t\t\tcont.replace(/>[\\n\\r\\t]+([ ]{4})+/g, '>')\n\t\t\t\t\t\t\t\t\t\t.replace(/[\\n\\r\\t]+([ ]{4})+</g, '<')\n\t\t\t\t\t\t\t\t\t\t.replace(/>[\\n\\r\\t]+</g, '><');\n\t\t\t\t\t\t\t\t\tholder.className && (newDiv.className = holder.className);\n\t\t\t\t\t\t\t\t\tholder.style.cssText && (newDiv.style.cssText = holder.style.cssText);\n\t\t\t\t\t\t\t\t\tif (/textarea/i.test(holder.tagName)) {\n\t\t\t\t\t\t\t\t\t\teditor.textarea = holder;\n\t\t\t\t\t\t\t\t\t\teditor.textarea.style.display = 'none';\n\t\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tholder.parentNode.removeChild(holder);\n\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (holder.id) {\n\t\t\t\t\t\t\t\t\t\tnewDiv.id = holder.id;\n\t\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(holder, 'id');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tholder = newDiv;\n\t\t\t\t\t\t\t\t\tholder.innerHTML = '';\n\t\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.addClass(holder, \"edui-\" + editor.options.theme);\n\t\t\t\t\t\t\teditor.ui.render(holder);\n\t\t\t\t\t\t\tvar opt = editor.options;\n\t\t\t\t\t\t\t//给实例添加一个编辑器的容器引用\n\t\t\t\t\t\t\teditor.container = editor.ui.getDom();\n\t\t\t\t\t\t\tvar parents = domUtils.findParents(holder, true);\n\t\t\t\t\t\t\tvar displays = [];\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\t\t\t\tdisplays[i] = ci.style.display;\n\t\t\t\t\t\t\t\tci.style.display = 'block'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (opt.initialFrameWidth) {\n\t\t\t\t\t\t\t\topt.minFrameWidth = opt.initialFrameWidth;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\topt.minFrameWidth = opt.initialFrameWidth = holder.offsetWidth;\n\t\t\t\t\t\t\t\tvar styleWidth = holder.style.width;\n\t\t\t\t\t\t\t\tif (/%$/.test(styleWidth)) {\n\t\t\t\t\t\t\t\t\topt.initialFrameWidth = styleWidth;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (opt.initialFrameHeight) {\n\t\t\t\t\t\t\t\topt.minFrameHeight = opt.initialFrameHeight;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\topt.initialFrameHeight = opt.minFrameHeight = holder.offsetHeight;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\t\t\t\tci.style.display = displays[i]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//编辑器最外容器设置了高度，会导致，编辑器不占位\n\t\t\t\t\t\t\t//todo 先去掉，没有找到原因\n\t\t\t\t\t\t\tif (holder.style.height) {\n\t\t\t\t\t\t\t\tholder.style.height = ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\teditor.container.style.width = opt.initialFrameWidth + (/%$/.test(opt.initialFrameWidth) ? '' : 'px');\n\t\t\t\t\t\t\teditor.container.style.zIndex = opt.zIndex;\n\t\t\t\t\t\t\toldRender.call(editor, editor.ui.getDom('iframeholder'));\n\t\t\t\t\t\t\teditor.fireEvent(\"afteruiready\");\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t};\n\t\t\t\treturn editor;\n\t\t\t};\n\t\n\t\t\t/**\n\t\t\t * @file\n\t\t\t * @name UE\n\t\t\t * @short UE\n\t\t\t * @desc UEditor的顶部命名空间\n\t\t\t */\n\t\t\t/**\n\t\t\t * @name getEditor\n\t\t\t * @since 1.2.4+\n\t\t\t * @grammar UE.getEditor(id,[opt])  =>  Editor实例\n\t\t\t * @desc 提供一个全局的方法得到编辑器实例\n\t\t\t *\n\t\t\t * * ''id''  放置编辑器的容器id, 如果容器下的编辑器已经存在，就直接返回\n\t\t\t * * ''opt'' 编辑器的可选参数\n\t\t\t * @example\n\t\t\t *  UE.getEditor('containerId',{onready:function(){//创建一个编辑器实例\n\t\t\t *      this.setContent('hello')\n\t\t\t *  }});\n\t\t\t *  UE.getEditor('containerId'); //返回刚创建的实例\n\t\t\t *\n\t\t\t */\n\t\t\tUE.getEditor = function(id, opt) {\n\t\t\t\tvar editor = instances[id];\n\t\t\t\tif (!editor) {\n\t\t\t\t\teditor = instances[id] = new UE.ui.Editor(opt);\n\t\t\t\t\teditor.render(id);\n\t\t\t\t}\n\t\t\t\treturn editor;\n\t\t\t};\n\t\n\t\t\tUE.delEditor = function(id) {\n\t\t\t\tvar editor;\n\t\t\t\tif (editor = instances[id]) {\n\t\t\t\t\teditor.key && editor.destroy();\n\t\t\t\t\tdelete instances[id]\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\tUE.registerUI = function(uiName, fn, index, editorId) {\n\t\t\t\tutils.each(uiName.split(/\\s+/), function(name) {\n\t\t\t\t\tUE._customizeUI[name] = {\n\t\t\t\t\t\tid: editorId,\n\t\t\t\t\t\texecFn: fn,\n\t\t\t\t\t\tindex: index\n\t\t\t\t\t};\n\t\t\t\t})\n\t\n\t\t\t}\n\t\n\t\t})();\n\t\n\t\t// adapter/message.js\n\t\tUE.registerUI('message', function(editor) {\n\t\n\t\t\tvar editorui = baidu.editor.ui;\n\t\t\tvar Message = editorui.Message;\n\t\t\tvar holder;\n\t\t\tvar _messageItems = [];\n\t\t\tvar me = editor;\n\t\n\t\t\tme.addListener('ready', function() {\n\t\t\t\tholder = document.getElementById(me.ui.id + '_message_holder');\n\t\t\t\tupdateHolderPos();\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tupdateHolderPos();\n\t\t\t\t}, 500);\n\t\t\t});\n\t\n\t\t\tme.addListener('showmessage', function(type, opt) {\n\t\t\t\topt = utils.isString(opt) ? {\n\t\t\t\t\t'content': opt\n\t\t\t\t} : opt;\n\t\t\t\tvar message = new Message({\n\t\t\t\t\t\t'timeout': opt.timeout,\n\t\t\t\t\t\t'type': opt.type,\n\t\t\t\t\t\t'content': opt.content,\n\t\t\t\t\t\t'keepshow': opt.keepshow,\n\t\t\t\t\t\t'editor': me\n\t\t\t\t\t}),\n\t\t\t\t\tmid = opt.id || ('msg_' + (+new Date()).toString(36));\n\t\t\t\tmessage.render(holder);\n\t\t\t\t_messageItems[mid] = message;\n\t\t\t\tmessage.reset(opt);\n\t\t\t\tupdateHolderPos();\n\t\t\t\treturn mid;\n\t\t\t});\n\t\n\t\t\tme.addListener('updatemessage', function(type, id, opt) {\n\t\t\t\topt = utils.isString(opt) ? {\n\t\t\t\t\t'content': opt\n\t\t\t\t} : opt;\n\t\t\t\tvar message = _messageItems[id];\n\t\t\t\tmessage.render(holder);\n\t\t\t\tmessage && message.reset(opt);\n\t\t\t});\n\t\n\t\t\tme.addListener('hidemessage', function(type, id) {\n\t\t\t\tvar message = _messageItems[id];\n\t\t\t\tmessage && message.hide();\n\t\t\t});\n\t\n\t\t\tfunction updateHolderPos() {\n\t\t\t\tvar toolbarbox = me.ui.getDom('toolbarbox');\n\t\t\t\tif (toolbarbox) {\n\t\t\t\t\tholder.style.top = toolbarbox.offsetHeight + 3 + 'px';\n\t\t\t\t}\n\t\t\t\tholder.style.zIndex = Math.max(me.options.zIndex, me.iframe.style.zIndex) + 1;\n\t\t\t}\n\t\n\t\t});\n\t\n\t\t// adapter/autosave.js\n\t\tUE.registerUI('autosave', function(editor) {\n\t\t\tvar timer = null,\n\t\t\t\tuid = null;\n\t\t\teditor.on('afterautosave', function() {\n\t\t\t\tclearTimeout(timer);\n\t\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\tif (uid) {\n\t\t\t\t\t\teditor.trigger('hidemessage', uid);\n\t\t\t\t\t}\n\t\t\t\t\tuid = editor.trigger('showmessage', {\n\t\t\t\t\t\tcontent: editor.getLang('autosave.success'),\n\t\t\t\t\t\ttimeout: 2000\n\t\t\t\t\t});\n\t\n\t\t\t\t}, 2000)\n\t\t\t})\n\t\n\t\t});\n\t\n\t})();\n\n\n/***/ }),\n/* 109 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: taoqili\n\t * Date: 12-6-12\n\t * Time: 下午5:02\n\t * To change this template use File | Settings | File Templates.\n\t */\n\tUE.I18N['zh-cn'] = {\n\t    'labelMap': {\n\t        'anchor': '锚点',\n\t        'undo': '撤销',\n\t        'redo': '重做',\n\t        'bold': '加粗',\n\t        'indent': '首行缩进',\n\t        'snapscreen': '截图',\n\t        'italic': '斜体',\n\t        'underline': '下划线',\n\t        'strikethrough': '删除线',\n\t        'subscript': '下标',\n\t        'fontborder': '字符边框',\n\t        'superscript': '上标',\n\t        'formatmatch': '格式刷',\n\t        'source': '源代码',\n\t        'blockquote': '引用',\n\t        'pasteplain': '纯文本粘贴模式',\n\t        'selectall': '全选',\n\t        'print': '打印',\n\t        'preview': '预览',\n\t        'horizontal': '分隔线',\n\t        'removeformat': '清除格式',\n\t        'time': '时间',\n\t        'date': '日期',\n\t        'unlink': '取消链接',\n\t        'insertrow': '前插入行',\n\t        'insertcol': '前插入列',\n\t        'mergeright': '右合并单元格',\n\t        'mergedown': '下合并单元格',\n\t        'deleterow': '删除行',\n\t        'deletecol': '删除列',\n\t        'splittorows': '拆分成行',\n\t        'splittocols': '拆分成列',\n\t        'splittocells': '完全拆分单元格',\n\t        'deletecaption': '删除表格标题',\n\t        'inserttitle': '插入标题',\n\t        'mergecells': '合并多个单元格',\n\t        'deletetable': '删除表格',\n\t        'cleardoc': '清空文档',\n\t        'insertparagraphbeforetable': \"表格前插入行\",\n\t        'insertcode': '代码语言',\n\t        'fontfamily': '字体',\n\t        'fontsize': '字号',\n\t        'paragraph': '段落格式',\n\t        'simpleupload': '单图上传',\n\t        'insertimage': '多图上传',\n\t        'edittable': '表格属性',\n\t        'edittd': '单元格属性',\n\t        'link': '超链接',\n\t        'emotion': '表情',\n\t        'spechars': '特殊字符',\n\t        'searchreplace': '查询替换',\n\t        'map': 'Baidu地图',\n\t        'gmap': 'Google地图',\n\t        'insertvideo': '视频',\n\t        'help': '帮助',\n\t        'justifyleft': '居左对齐',\n\t        'justifyright': '居右对齐',\n\t        'justifycenter': '居中对齐',\n\t        'justifyjustify': '两端对齐',\n\t        'forecolor': '字体颜色',\n\t        'backcolor': '背景色',\n\t        'insertorderedlist': '编号',\n\t        'insertunorderedlist': '项目符号',\n\t        'fullscreen': '全屏',\n\t        'directionalityltr': '从左向右输入',\n\t        'directionalityrtl': '从右向左输入',\n\t        'rowspacingtop': '段前距',\n\t        'rowspacingbottom': '段后距',\n\t        'pagebreak': '分页',\n\t        'insertframe': '插入Iframe',\n\t        'imagenone': '默认',\n\t        'imageleft': '左浮动',\n\t        'imageright': '右浮动',\n\t        'attachment': '附件',\n\t        'imagecenter': '居中',\n\t        'wordimage': '图片转存',\n\t        'lineheight': '行间距',\n\t        'edittip': '编辑提示',\n\t        'customstyle': '自定义标题',\n\t        'autotypeset': '自动排版',\n\t        'webapp': '百度应用',\n\t        'touppercase': '字母大写',\n\t        'tolowercase': '字母小写',\n\t        'background': '背景',\n\t        'template': '模板',\n\t        'scrawl': '涂鸦',\n\t        'music': '音乐',\n\t        'inserttable': '插入表格',\n\t        'drafts': '从草稿箱加载',\n\t        'charts': '图表'\n\t    },\n\t    'insertorderedlist': {\n\t        'num': '1,2,3...',\n\t        'num1': '1),2),3)...',\n\t        'num2': '(1),(2),(3)...',\n\t        'cn': '一,二,三....',\n\t        'cn1': '一),二),三)....',\n\t        'cn2': '(一),(二),(三)....',\n\t        'decimal': '1,2,3...',\n\t        'lower-alpha': 'a,b,c...',\n\t        'lower-roman': 'i,ii,iii...',\n\t        'upper-alpha': 'A,B,C...',\n\t        'upper-roman': 'I,II,III...'\n\t    },\n\t    'insertunorderedlist': {\n\t        'circle': '○ 大圆圈',\n\t        'disc': '● 小黑点',\n\t        'square': '■ 小方块 ',\n\t        'dash': '— 破折号',\n\t        'dot': ' 。 小圆圈'\n\t    },\n\t    'paragraph': {\n\t        'p': '段落',\n\t        'h1': '标题 1',\n\t        'h2': '标题 2',\n\t        'h3': '标题 3',\n\t        'h4': '标题 4',\n\t        'h5': '标题 5',\n\t        'h6': '标题 6'\n\t    },\n\t    'fontfamily': {\n\t        'songti': '宋体',\n\t        'kaiti': '楷体',\n\t        'heiti': '黑体',\n\t        'lishu': '隶书',\n\t        'yahei': '微软雅黑',\n\t        'andaleMono': 'andale mono',\n\t        'arial': 'arial',\n\t        'arialBlack': 'arial black',\n\t        'comicSansMs': 'comic sans ms',\n\t        'impact': 'impact',\n\t        'timesNewRoman': 'times new roman'\n\t    },\n\t    'customstyle': {\n\t        'tc': '标题居中',\n\t        'tl': '标题居左',\n\t        'im': '强调',\n\t        'hi': '明显强调'\n\t    },\n\t    'autoupload': {\n\t        'exceedSizeError': '文件大小超出限制',\n\t        'exceedTypeError': '文件格式不允许',\n\t        'jsonEncodeError': '服务器返回格式错误',\n\t        'loading': \"正在上传...\",\n\t        'loadError': \"上传错误\",\n\t        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'\n\t    },\n\t    'simpleupload': {\n\t        'exceedSizeError': '文件大小超出限制',\n\t        'exceedTypeError': '文件格式不允许',\n\t        'jsonEncodeError': '服务器返回格式错误',\n\t        'loading': \"正在上传...\",\n\t        'loadError': \"上传错误\",\n\t        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'\n\t    },\n\t    'elementPathTip': \"元素路径\",\n\t    'wordCountTip': \"字数统计\",\n\t    'wordCountMsg': '当前已输入{#count}个字符, 您还可以输入{#leave}个字符。 ',\n\t    'wordOverFlowMsg': '<span style=\"color:red;\">字数超出最大允许值，服务器可能拒绝保存！</span>',\n\t    'ok': \"确认\",\n\t    'cancel': \"取消\",\n\t    'closeDialog': \"关闭对话框\",\n\t    'tableDrag': \"表格拖动必须引入uiUtils.js文件！\",\n\t    'autofloatMsg': \"工具栏浮动依赖编辑器UI，您首先需要引入UI文件!\",\n\t    'loadconfigError': '获取后台配置项请求出错，上传功能将不能正常使用！',\n\t    'loadconfigFormatError': '后台配置项返回格式出错，上传功能将不能正常使用！',\n\t    'loadconfigHttpError': '请求后台配置项http错误，上传功能将不能正常使用！',\n\t    'snapScreen_plugin': {\n\t        'browserMsg': \"仅支持IE浏览器！\",\n\t        'callBackErrorMsg': \"服务器返回数据有误，请检查配置项之后重试。\",\n\t        'uploadErrorMsg': \"截图上传失败，请检查服务器端环境! \"\n\t    },\n\t    'insertcode': {\n\t        'as3': 'ActionScript 3',\n\t        'bash': 'Bash/Shell',\n\t        'cpp': 'C/C++',\n\t        'css': 'CSS',\n\t        'cf': 'ColdFusion',\n\t        'c#': 'C#',\n\t        'delphi': 'Delphi',\n\t        'diff': 'Diff',\n\t        'erlang': 'Erlang',\n\t        'groovy': 'Groovy',\n\t        'html': 'HTML',\n\t        'java': 'Java',\n\t        'jfx': 'JavaFX',\n\t        'js': 'JavaScript',\n\t        'pl': 'Perl',\n\t        'php': 'PHP',\n\t        'plain': 'Plain Text',\n\t        'ps': 'PowerShell',\n\t        'python': 'Python',\n\t        'ruby': 'Ruby',\n\t        'scala': 'Scala',\n\t        'sql': 'SQL',\n\t        'vb': 'Visual Basic',\n\t        'xml': 'XML'\n\t    },\n\t    'confirmClear': \"确定清空当前文档么？\",\n\t    'contextMenu': {\n\t        'delete': \"删除\",\n\t        'selectall': \"全选\",\n\t        'deletecode': \"删除代码\",\n\t        'cleardoc': \"清空文档\",\n\t        'confirmclear': \"确定清空当前文档么？\",\n\t        'unlink': \"删除超链接\",\n\t        'paragraph': \"段落格式\",\n\t        'edittable': \"表格属性\",\n\t        'aligntd': \"单元格对齐方式\",\n\t        'aligntable': '表格对齐方式',\n\t        'tableleft': '左浮动',\n\t        'tablecenter': '居中显示',\n\t        'tableright': '右浮动',\n\t        'edittd': \"单元格属性\",\n\t        'setbordervisible': '设置表格边线可见',\n\t        'justifyleft': '左对齐',\n\t        'justifyright': '右对齐',\n\t        'justifycenter': '居中对齐',\n\t        'justifyjustify': '两端对齐',\n\t        'table': \"表格\",\n\t        'inserttable': '插入表格',\n\t        'deletetable': \"删除表格\",\n\t        'insertparagraphbefore': \"前插入段落\",\n\t        'insertparagraphafter': '后插入段落',\n\t        'deleterow': \"删除当前行\",\n\t        'deletecol': \"删除当前列\",\n\t        'insertrow': \"前插入行\",\n\t        'insertcol': \"左插入列\",\n\t        'insertrownext': '后插入行',\n\t        'insertcolnext': '右插入列',\n\t        'insertcaption': '插入表格名称',\n\t        'deletecaption': '删除表格名称',\n\t        'inserttitle': '插入表格标题行',\n\t        'deletetitle': '删除表格标题行',\n\t        'inserttitlecol': '插入表格标题列',\n\t        'deletetitlecol': '删除表格标题列',\n\t        'averageDiseRow': '平均分布各行',\n\t        'averageDisCol': '平均分布各列',\n\t        'mergeright': \"向右合并\",\n\t        'mergeleft': \"向左合并\",\n\t        'mergedown': \"向下合并\",\n\t        'mergecells': \"合并单元格\",\n\t        'splittocells': \"完全拆分单元格\",\n\t        'splittocols': \"拆分成列\",\n\t        'splittorows': \"拆分成行\",\n\t        'tablesort': '表格排序',\n\t        'enablesort': '设置表格可排序',\n\t        'disablesort': '取消表格可排序',\n\t        'reversecurrent': '逆序当前',\n\t        'orderbyasc': '按ASCII字符升序',\n\t        'reversebyasc': '按ASCII字符降序',\n\t        'orderbynum': '按数值大小升序',\n\t        'reversebynum': '按数值大小降序',\n\t        'borderbk': '边框底纹',\n\t        'setcolor': '表格隔行变色',\n\t        'unsetcolor': '取消表格隔行变色',\n\t        'setbackground': '选区背景隔行',\n\t        'unsetbackground': '取消选区背景',\n\t        'redandblue': '红蓝相间',\n\t        'threecolorgradient': '三色渐变',\n\t        'copy': \"复制(Ctrl + c)\",\n\t        'copymsg': \"浏览器不支持,请使用 'Ctrl + c'\",\n\t        'paste': \"粘贴(Ctrl + v)\",\n\t        'pastemsg': \"浏览器不支持,请使用 'Ctrl + v'\"\n\t    },\n\t    'copymsg': \"浏览器不支持,请使用 'Ctrl + c'\",\n\t    'pastemsg': \"浏览器不支持,请使用 'Ctrl + v'\",\n\t    'anthorMsg': \"链接\",\n\t    'clearColor': '清空颜色',\n\t    'standardColor': '标准颜色',\n\t    'themeColor': '主题颜色',\n\t    'property': '属性',\n\t    'default': '默认',\n\t    'modify': '修改',\n\t    'justifyleft': '左对齐',\n\t    'justifyright': '右对齐',\n\t    'justifycenter': '居中',\n\t    'justify': '默认',\n\t    'clear': '清除',\n\t    'anchorMsg': '锚点',\n\t    'delete': '删除',\n\t    'clickToUpload': \"点击上传\",\n\t    'unset': '尚未设置语言文件',\n\t    't_row': '行',\n\t    't_col': '列',\n\t    'more': '更多',\n\t    'pasteOpt': '粘贴选项',\n\t    'pasteSourceFormat': \"保留源格式\",\n\t    'tagFormat': '只保留标签',\n\t    'pasteTextFormat': '只保留文本',\n\t    'autoTypeSet': {\n\t        'mergeLine': \"合并空行\",\n\t        'delLine': \"清除空行\",\n\t        'removeFormat': \"清除格式\",\n\t        'indent': \"首行缩进\",\n\t        'alignment': \"对齐方式\",\n\t        'imageFloat': \"图片浮动\",\n\t        'removeFontsize': \"清除字号\",\n\t        'removeFontFamily': \"清除字体\",\n\t        'removeHtml': \"清除冗余HTML代码\",\n\t        'pasteFilter': \"粘贴过滤\",\n\t        'run': \"执行\",\n\t        'symbol': '符号转换',\n\t        'bdc2sb': '全角转半角',\n\t        'tobdc': '半角转全角'\n\t    },\n\t\n\t    'background': {\n\t        'static': {\n\t            'lang_background_normal': '背景设置',\n\t            'lang_background_local': '在线图片',\n\t            'lang_background_set': '选项',\n\t            'lang_background_none': '无背景色',\n\t            'lang_background_colored': '有背景色',\n\t            'lang_background_color': '颜色设置',\n\t            'lang_background_netimg': '网络图片',\n\t            'lang_background_align': '对齐方式',\n\t            'lang_background_position': '精确定位',\n\t            'repeatType': {\n\t                'options': [\"居中\", \"横向重复\", \"纵向重复\", \"平铺\", \"自定义\"]\n\t            }\n\t\n\t        },\n\t        'noUploadImage': \"当前未上传过任何图片！\",\n\t        'toggleSelect': \"单击可切换选中状态\\n原图尺寸: \"\n\t    },\n\t    //===============dialog i18N=======================\n\t    'insertimage': {\n\t        'static': {\n\t            'lang_tab_remote': \"插入图片\", //节点\n\t            'lang_tab_upload': \"本地上传\",\n\t            'lang_tab_online': \"在线管理\",\n\t            'lang_tab_search': \"图片搜索\",\n\t            'lang_input_url': \"地 址：\",\n\t            'lang_input_size': \"大 小：\",\n\t            'lang_input_width': \"宽度\",\n\t            'lang_input_height': \"高度\",\n\t            'lang_input_border': \"边 框：\",\n\t            'lang_input_vhspace': \"边 距：\",\n\t            'lang_input_title': \"描 述：\",\n\t            'lang_input_align': '图片浮动方式：',\n\t            'lang_imgLoading': \"　图片加载中……\",\n\t            'lang_start_upload': \"开始上传\",\n\t            'lock': {\n\t                'title': \"锁定宽高比例\"\n\t            }, //属性\n\t            'searchType': {\n\t                'title': \"图片类型\",\n\t                'options': [\"新闻\", \"壁纸\", \"表情\", \"头像\"]\n\t            }, //select的option\n\t            'searchTxt': {\n\t                'value': \"请输入搜索关键词\"\n\t            },\n\t            'searchBtn': {\n\t                'value': \"百度一下\"\n\t            },\n\t            'searchReset': {\n\t                'value': \"清空搜索\"\n\t            },\n\t            'noneAlign': {\n\t                'title': '无浮动'\n\t            },\n\t            'leftAlign': {\n\t                'title': '左浮动'\n\t            },\n\t            'rightAlign': {\n\t                'title': '右浮动'\n\t            },\n\t            'centerAlign': {\n\t                'title': '居中独占一行'\n\t            }\n\t        },\n\t        'uploadSelectFile': '点击选择图片',\n\t        'uploadAddFile': '继续添加',\n\t        'uploadStart': '开始上传',\n\t        'uploadPause': '暂停上传',\n\t        'uploadContinue': '继续上传',\n\t        'uploadRetry': '重试上传',\n\t        'uploadDelete': '删除',\n\t        'uploadTurnLeft': '向左旋转',\n\t        'uploadTurnRight': '向右旋转',\n\t        'uploadPreview': '预览中',\n\t        'uploadNoPreview': '不能预览',\n\t        'updateStatusReady': '选中_张图片，共_KB。',\n\t        'updateStatusConfirm': '已成功上传_张照片，_张照片上传失败',\n\t        'updateStatusFinish': '共_张（_KB），_张上传成功',\n\t        'updateStatusError': '，_张上传失败。',\n\t        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n\t        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n\t        'errorExceedSize': '文件大小超出',\n\t        'errorFileType': '文件格式不允许',\n\t        'errorInterrupt': '文件传输中断',\n\t        'errorUploadRetry': '上传失败，请重试',\n\t        'errorHttp': 'http请求错误',\n\t        'errorServerUpload': '服务器返回出错',\n\t        'remoteLockError': \"宽高不正确,不能所定比例\",\n\t        'numError': \"请输入正确的长度或者宽度值！例如：123，400\",\n\t        'imageUrlError': \"不允许的图片格式或者图片域！\",\n\t        'imageLoadError': \"图片加载失败！请检查链接地址或网络状态！\",\n\t        'searchRemind': \"请输入搜索关键词\",\n\t        'searchLoading': \"图片加载中，请稍后……\",\n\t        'searchRetry': \" :( ，抱歉，没有找到图片！请重试一次！\"\n\t    },\n\t    'attachment': {\n\t        'static': {\n\t            'lang_tab_upload': '上传附件',\n\t            'lang_tab_online': '在线附件',\n\t            'lang_start_upload': \"开始上传\",\n\t            'lang_drop_remind': \"可以将文件拖到这里，单次最多可选100个文件\"\n\t        },\n\t        'uploadSelectFile': '点击选择文件',\n\t        'uploadAddFile': '继续添加',\n\t        'uploadStart': '开始上传',\n\t        'uploadPause': '暂停上传',\n\t        'uploadContinue': '继续上传',\n\t        'uploadRetry': '重试上传',\n\t        'uploadDelete': '删除',\n\t        'uploadTurnLeft': '向左旋转',\n\t        'uploadTurnRight': '向右旋转',\n\t        'uploadPreview': '预览中',\n\t        'updateStatusReady': '选中_个文件，共_KB。',\n\t        'updateStatusConfirm': '已成功上传_个文件，_个文件上传失败',\n\t        'updateStatusFinish': '共_个（_KB），_个上传成功',\n\t        'updateStatusError': '，_张上传失败。',\n\t        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n\t        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n\t        'errorExceedSize': '文件大小超出',\n\t        'errorFileType': '文件格式不允许',\n\t        'errorInterrupt': '文件传输中断',\n\t        'errorUploadRetry': '上传失败，请重试',\n\t        'errorHttp': 'http请求错误',\n\t        'errorServerUpload': '服务器返回出错'\n\t    },\n\t    'insertvideo': {\n\t        'static': {\n\t            'lang_tab_insertV': \"插入视频\",\n\t            'lang_tab_searchV': \"搜索视频\",\n\t            'lang_tab_uploadV': \"上传视频\",\n\t            'lang_video_url': \"视频网址\",\n\t            'lang_video_size': \"视频尺寸\",\n\t            'lang_videoW': \"宽度\",\n\t            'lang_videoH': \"高度\",\n\t            'lang_alignment': \"对齐方式\",\n\t            'videoSearchTxt': {\n\t                'value': \"请输入搜索关键字！\"\n\t            },\n\t            'videoType': {\n\t                'options': [\"全部\", \"热门\", \"娱乐\", \"搞笑\", \"体育\", \"科技\", \"综艺\"]\n\t            },\n\t            'videoSearchBtn': {\n\t                'value': \"百度一下\"\n\t            },\n\t            'videoSearchReset': {\n\t                'value': \"清空结果\"\n\t            },\n\t\n\t            'lang_input_fileStatus': ' 当前未上传文件',\n\t            'startUpload': {\n\t                'style': \"background:url(upload.png) no-repeat;\"\n\t            },\n\t\n\t            'lang_upload_size': \"视频尺寸\",\n\t            'lang_upload_width': \"宽度\",\n\t            'lang_upload_height': \"高度\",\n\t            'lang_upload_alignment': \"对齐方式\",\n\t            'lang_format_advice': \"建议使用mp4格式.\"\n\t\n\t        },\n\t        'numError': \"请输入正确的数值，如123,400\",\n\t        'floatLeft': \"左浮动\",\n\t        'floatRight': \"右浮动\",\n\t        '\"default\"': \"默认\",\n\t        'block': \"独占一行\",\n\t        'urlError': \"输入的视频地址有误，请检查后再试！\",\n\t        'loading': \" &nbsp;视频加载中，请等待……\",\n\t        'clickToSelect': \"点击选中\",\n\t        'goToSource': '访问源视频',\n\t        'noVideo': \" &nbsp; &nbsp;抱歉，找不到对应的视频，请重试！\",\n\t\n\t        'browseFiles': '浏览文件',\n\t        'uploadSuccess': '上传成功!',\n\t        'delSuccessFile': '从成功队列中移除',\n\t        'delFailSaveFile': '移除保存失败文件',\n\t        'statusPrompt': ' 个文件已上传！ ',\n\t        'flashVersionError': '当前Flash版本过低，请更新FlashPlayer后重试！',\n\t        'flashLoadingError': 'Flash加载失败!请检查路径或网络状态',\n\t        'fileUploadReady': '等待上传……',\n\t        'delUploadQueue': '从上传队列中移除',\n\t        'limitPrompt1': '单次不能选择超过',\n\t        'limitPrompt2': '个文件！请重新选择！',\n\t        'delFailFile': '移除失败文件',\n\t        'fileSizeLimit': '文件大小超出限制！',\n\t        'emptyFile': '空文件无法上传！',\n\t        'fileTypeError': '文件类型不允许！',\n\t        'unknownError': '未知错误！',\n\t        'fileUploading': '上传中，请等待……',\n\t        'cancelUpload': '取消上传',\n\t        'netError': '网络错误',\n\t        'failUpload': '上传失败!',\n\t        'serverIOError': '服务器IO错误！',\n\t        'noAuthority': '无权限！',\n\t        'fileNumLimit': '上传个数限制',\n\t        'failCheck': '验证失败，本次上传被跳过！',\n\t        'fileCanceling': '取消中，请等待……',\n\t        'stopUploading': '上传已停止……',\n\t\n\t        'uploadSelectFile': '点击选择文件',\n\t        'uploadAddFile': '继续添加',\n\t        'uploadStart': '开始上传',\n\t        'uploadPause': '暂停上传',\n\t        'uploadContinue': '继续上传',\n\t        'uploadRetry': '重试上传',\n\t        'uploadDelete': '删除',\n\t        'uploadTurnLeft': '向左旋转',\n\t        'uploadTurnRight': '向右旋转',\n\t        'uploadPreview': '预览中',\n\t        'updateStatusReady': '选中_个文件，共_KB。',\n\t        'updateStatusConfirm': '成功上传_个，_个失败',\n\t        'updateStatusFinish': '共_个(_KB)，_个成功上传',\n\t        'updateStatusError': '，_张上传失败。',\n\t        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n\t        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n\t        'errorExceedSize': '文件大小超出',\n\t        'errorFileType': '文件格式不允许',\n\t        'errorInterrupt': '文件传输中断',\n\t        'errorUploadRetry': '上传失败，请重试',\n\t        'errorHttp': 'http请求错误',\n\t        'errorServerUpload': '服务器返回出错'\n\t    },\n\t    'webapp': {\n\t        'tip1': \"本功能由百度APP提供，如看到此页面，请各位站长首先申请百度APPKey!\",\n\t        'tip2': \"申请完成之后请至ueditor.config.js中配置获得的appkey! \",\n\t        'applyFor': \"点此申请\",\n\t        'anthorApi': \"百度API\"\n\t    },\n\t    'template': {\n\t        'static': {\n\t            'lang_template_bkcolor': '背景颜色',\n\t            'lang_template_clear': '保留原有内容',\n\t            'lang_template_select': '选择模板'\n\t        },\n\t        'blank': \"空白文档\",\n\t        'blog': \"博客文章\",\n\t        'resume': \"个人简历\",\n\t        'richText': \"图文混排\",\n\t        'sciPapers': \"科技论文\"\n\t\n\t    },\n\t    'scrawl': {\n\t        'static': {\n\t            'lang_input_previousStep': \"上一步\",\n\t            'lang_input_nextsStep': \"下一步\",\n\t            'lang_input_clear': '清空',\n\t            'lang_input_addPic': '添加背景',\n\t            'lang_input_ScalePic': '缩放背景',\n\t            'lang_input_removePic': '删除背景',\n\t            'J_imgTxt': {\n\t                title: '添加背景图片'\n\t            }\n\t        },\n\t        'noScarwl': \"尚未作画，白纸一张~\",\n\t        'scrawlUpLoading': \"涂鸦上传中,别急哦~\",\n\t        'continueBtn': \"继续\",\n\t        'imageError': \"糟糕，图片读取失败了！\",\n\t        'backgroundUploading': '背景图片上传中,别急哦~'\n\t    },\n\t    'music': {\n\t        'static': {\n\t            'lang_input_tips': \"输入歌手/歌曲/专辑，搜索您感兴趣的音乐！\",\n\t            'J_searchBtn': {\n\t                value: '搜索歌曲'\n\t            }\n\t        },\n\t        'emptyTxt': '未搜索到相关音乐结果，请换一个关键词试试。',\n\t        'chapter': '歌曲',\n\t        'singer': '歌手',\n\t        'special': '专辑',\n\t        'listenTest': '试听'\n\t    },\n\t    'anchor': {\n\t        'static': {\n\t            'lang_input_anchorName': '锚点名字：'\n\t        }\n\t    },\n\t    'charts': {\n\t        'static': {\n\t            'lang_data_source': '数据源：',\n\t            'lang_chart_format': '图表格式：',\n\t            'lang_data_align': '数据对齐方式',\n\t            'lang_chart_align_same': '数据源与图表X轴Y轴一致',\n\t            'lang_chart_align_reverse': '数据源与图表X轴Y轴相反',\n\t            'lang_chart_title': '图表标题',\n\t            'lang_chart_main_title': '主标题：',\n\t            'lang_chart_sub_title': '子标题：',\n\t            'lang_chart_x_title': 'X轴标题：',\n\t            'lang_chart_y_title': 'Y轴标题：',\n\t            'lang_chart_tip': '提示文字',\n\t            'lang_cahrt_tip_prefix': '提示文字前缀：',\n\t            'lang_cahrt_tip_description': '仅饼图有效， 当鼠标移动到饼图中相应的块上时，提示框内的文字的前缀',\n\t            'lang_chart_data_unit': '数据单位',\n\t            'lang_chart_data_unit_title': '单位：',\n\t            'lang_chart_data_unit_description': '显示在每个数据点上的数据的单位， 比如： 温度的单位 ℃',\n\t            'lang_chart_type': '图表类型：',\n\t            'lang_prev_btn': '上一个',\n\t            'lang_next_btn': '下一个'\n\t        }\n\t    },\n\t    'emotion': {\n\t        'static': {\n\t            'lang_input_choice': '精选',\n\t            'lang_input_Tuzki': '兔斯基',\n\t            'lang_input_BOBO': 'BOBO',\n\t            'lang_input_lvdouwa': '绿豆蛙',\n\t            'lang_input_babyCat': 'baby猫',\n\t            'lang_input_bubble': '泡泡',\n\t            'lang_input_youa': '有啊'\n\t        }\n\t    },\n\t    'gmap': {\n\t        'static': {\n\t            'lang_input_address': '地址',\n\t            'lang_input_search': '搜索',\n\t            'address': {\n\t                value: \"北京\"\n\t            }\n\t        },\n\t        searchError: '无法定位到该地址!'\n\t    },\n\t    'help': {\n\t        'static': {\n\t            'lang_input_about': '关于UEditor',\n\t            'lang_input_shortcuts': '快捷键',\n\t            'lang_input_introduction': 'UEditor是由百度web前端研发部开发的所见即所得富文本web编辑器，具有轻量，可定制，注重用户体验等特点。开源基于BSD协议，允许自由使用和修改代码。',\n\t            'lang_Txt_shortcuts': '快捷键',\n\t            'lang_Txt_func': '功能',\n\t            'lang_Txt_bold': '给选中字设置为加粗',\n\t            'lang_Txt_copy': '复制选中内容',\n\t            'lang_Txt_cut': '剪切选中内容',\n\t            'lang_Txt_Paste': '粘贴',\n\t            'lang_Txt_undo': '重新执行上次操作',\n\t            'lang_Txt_redo': '撤销上一次操作',\n\t            'lang_Txt_italic': '给选中字设置为斜体',\n\t            'lang_Txt_underline': '给选中字加下划线',\n\t            'lang_Txt_selectAll': '全部选中',\n\t            'lang_Txt_visualEnter': '软回车',\n\t            'lang_Txt_fullscreen': '全屏'\n\t        }\n\t    },\n\t    'insertframe': {\n\t        'static': {\n\t            'lang_input_address': '地址：',\n\t            'lang_input_width': '宽度：',\n\t            'lang_input_height': '高度：',\n\t            'lang_input_isScroll': '允许滚动条：',\n\t            'lang_input_frameborder': '显示框架边框：',\n\t            'lang_input_alignMode': '对齐方式：',\n\t            'align': {\n\t                title: \"对齐方式\",\n\t                options: [\"默认\", \"左对齐\", \"右对齐\", \"居中\"]\n\t            }\n\t        },\n\t        'enterAddress': '请输入地址!'\n\t    },\n\t    'link': {\n\t        'static': {\n\t            'lang_input_text': '文本内容：',\n\t            'lang_input_url': '链接地址：',\n\t            'lang_input_title': '标题：',\n\t            'lang_input_target': '是否在新窗口打开：'\n\t        },\n\t        'validLink': '只支持选中一个链接时生效',\n\t        'httpPrompt': '您输入的超链接中不包含http等协议名称，默认将为您添加http://前缀'\n\t    },\n\t    'map': {\n\t        'static': {\n\t            lang_city: \"城市\",\n\t            lang_address: \"地址\",\n\t            city: {\n\t                value: \"北京\"\n\t            },\n\t            lang_search: \"搜索\",\n\t            lang_dynamicmap: \"插入动态地图\"\n\t        },\n\t        cityMsg: \"请选择城市\",\n\t        errorMsg: \"抱歉，找不到该位置！\"\n\t    },\n\t    'searchreplace': {\n\t        'static': {\n\t            lang_tab_search: \"查找\",\n\t            lang_tab_replace: \"替换\",\n\t            lang_search1: \"查找\",\n\t            lang_search2: \"查找\",\n\t            lang_replace: \"替换\",\n\t            lang_searchReg: '支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”',\n\t            lang_searchReg1: '支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”',\n\t            lang_case_sensitive1: \"区分大小写\",\n\t            lang_case_sensitive2: \"区分大小写\",\n\t            nextFindBtn: {\n\t                value: \"下一个\"\n\t            },\n\t            preFindBtn: {\n\t                value: \"上一个\"\n\t            },\n\t            nextReplaceBtn: {\n\t                value: \"下一个\"\n\t            },\n\t            preReplaceBtn: {\n\t                value: \"上一个\"\n\t            },\n\t            repalceBtn: {\n\t                value: \"替换\"\n\t            },\n\t            repalceAllBtn: {\n\t                value: \"全部替换\"\n\t            }\n\t        },\n\t        getEnd: \"已经搜索到文章末尾！\",\n\t        getStart: \"已经搜索到文章头部\",\n\t        countMsg: \"总共替换了{#count}处！\"\n\t    },\n\t    'snapscreen': {\n\t        'static': {\n\t            lang_showMsg: \"截图功能需要首先安装UEditor截图插件！ \",\n\t            lang_download: \"点此下载\",\n\t            lang_step1: \"第一步，下载UEditor截图插件并运行安装。\",\n\t            lang_step2: \"第二步，插件安装完成后即可使用，如不生效，请重启浏览器后再试！\"\n\t        }\n\t    },\n\t    'spechars': {\n\t        'static': {},\n\t        tsfh: \"特殊字符\",\n\t        lmsz: \"罗马字符\",\n\t        szfh: \"数学字符\",\n\t        rwfh: \"日文字符\",\n\t        xlzm: \"希腊字母\",\n\t        ewzm: \"俄文字符\",\n\t        pyzm: \"拼音字母\",\n\t        yyyb: \"英语音标\",\n\t        zyzf: \"其他\"\n\t    },\n\t    'edittable': {\n\t        'static': {\n\t            'lang_tableStyle': '表格样式',\n\t            'lang_insertCaption': '添加表格名称行',\n\t            'lang_insertTitle': '添加表格标题行',\n\t            'lang_insertTitleCol': '添加表格标题列',\n\t            'lang_orderbycontent': \"使表格内容可排序\",\n\t            'lang_tableSize': '自动调整表格尺寸',\n\t            'lang_autoSizeContent': '按表格文字自适应',\n\t            'lang_autoSizePage': '按页面宽度自适应',\n\t            'lang_example': '示例',\n\t            'lang_borderStyle': '表格边框',\n\t            'lang_color': '颜色:'\n\t        },\n\t        captionName: '表格名称',\n\t        titleName: '标题',\n\t        cellsName: '内容',\n\t        errorMsg: '有合并单元格，不可排序'\n\t    },\n\t    'edittip': {\n\t        'static': {\n\t            lang_delRow: '删除整行',\n\t            lang_delCol: '删除整列'\n\t        }\n\t    },\n\t    'edittd': {\n\t        'static': {\n\t            lang_tdBkColor: '背景颜色:'\n\t        }\n\t    },\n\t    'formula': {\n\t        'static': {}\n\t    },\n\t    'wordimage': {\n\t        'static': {\n\t            lang_resave: \"转存步骤\",\n\t            uploadBtn: {\n\t                src: \"upload.png\",\n\t                alt: \"上传\"\n\t            },\n\t            clipboard: {\n\t                style: \"background: url(copy.png) -153px -1px no-repeat;\"\n\t            },\n\t            lang_step: \"1、点击顶部复制按钮，将地址复制到剪贴板；2、点击添加照片按钮，在弹出的对话框中使用Ctrl+V粘贴地址；3、点击打开后选择图片上传流程。\"\n\t        },\n\t        'fileType': \"图片\",\n\t        'flashError': \"FLASH初始化失败，请检查FLASH插件是否正确安装！\",\n\t        'netError': \"网络连接错误，请重试！\",\n\t        'copySuccess': \"图片地址已经复制！\",\n\t        'flashI18n': {} //留空默认中文\n\t    },\n\t    'autosave': {\n\t        'saving': '保存中...',\n\t        'success': '本地保存成功'\n\t    }\n\t};\n\n/***/ }),\n/* 110 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(111);\n\t__webpack_require__(114);\n\t__webpack_require__(115);\n\t__webpack_require__(129);\n\t__webpack_require__(137);\n\t//屏蔽快捷键\n\t//require('./metakey');\n\t//删除图片\n\t__webpack_require__(138);\n\t//过滤粘贴\n\t__webpack_require__(139);\n\t//过滤拖拽\n\t__webpack_require__(142);\n\t//修复选中图片\n\t__webpack_require__(143);\n\t//插入后重新计算高度\n\t__webpack_require__(144);\n\t//粘贴上传\n\t__webpack_require__(145);\n\t//\n\t__webpack_require__(146);\n\t//离开页面提示\n\t//require(\"./beforeUnload\");\n\n/***/ }),\n/* 111 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(112);\n\n/***/ }),\n/* 112 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar domUtils = UE.dom.domUtils;\n\t\n\tvar utils = UE.utils;\n\t\n\tvar getContent = __webpack_require__(113);\n\t\n\tvar changeTagName = function changeTagName(editor, tagName, key, value) {\n\t    if (tagName == value) {\n\t        editor.execCommand(key, 'p');\n\t    } else {\n\t        editor.execCommand(key, value);\n\t    }\n\t};\n\t\n\tUE.registerUI('h2 h1', function (editor, uiName) {\n\t    //console.log(uiName)\n\t    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n\t    /*  editor.registerCommand(uiName, {\n\t         execCommand: function() {\n\t             alert('execCommand:' + uiName)\n\t         }\n\t     }); */\n\t    //创建一个button\n\t    var aliasName;\n\t    var args = 0; //参数个数\n\t    var key = \"\";\n\t    var value = \"\";\n\t\n\t    switch (uiName) {\n\t        case 'h1':\n\t            aliasName = \"h1\";\n\t            args = 1;\n\t            key = \"Paragraph\";\n\t            value = \"h1\";\n\t            break;\n\t        case 'h2':\n\t            aliasName = \"h2\";\n\t            args = 1;\n\t            key = 'Paragraph';\n\t            value = 'h2';\n\t            break;\n\t    }\n\t\n\t    var btn = new UE.ui.Button({\n\t        //按钮的名字\n\t        name: aliasName,\n\t        //提示\n\t        title: aliasName,\n\t        //添加额外样式,指定icon图标,这里默认使用一个重复的icon\n\t        //cssRules: 'background-position: -500px 0;',\n\t        //iconEle: '<em class=\"insert-imoj iconn-27\">' + aliasName + '</em>',\n\t        //点击时执行的命令\n\t        onclick: function onclick(e) {\n\t            var range = editor.selection.getRange();\n\t            if (getContent(range).indexOf('gmp-ebox') != -1) {\n\t                return false;\n\t            }\n\t            //这里可以不用执行命令,做你自己的操作也可\n\t            var startDom = range.startContainer;\n\t            var tag = domUtils.findParentByTagName(startDom, ['h1', 'h2', 'h3', 'p'], true);\n\t            if (!tag) return false;\n\t            var tagName = tag.tagName.toLowerCase();\n\t\n\t            switch (tagName) {\n\t                case 'p':\n\t                    editor.execCommand(key, value);\n\t                    break;\n\t                case 'h1':\n\t                    changeTagName(editor, tagName, key, value);\n\t                    break;\n\t                case 'h2':\n\t                    changeTagName(editor, tagName, key, value);\n\t                    break;\n\t                case 'h3':\n\t                    changeTagName(editor, tagName, key, value);\n\t                    break;\n\t                default:\n\t                    break;\n\t\n\t            }\n\t            return;\n\t        }\n\t    });\n\t    //当点到编辑内容上时，按钮要做的状态反射\n\t    editor.addListener('selectionchange', function (e) {\n\t        var range = editor.selection.getRange();\n\t        var startDom = range.startContainer;\n\t        var tag = domUtils.findParentByTagName(startDom, ['h1', 'h2', 'p'], true);\n\t        if (!tag) return false;\n\t        var tagName = tag.tagName.toLowerCase();\n\t\n\t        if (tagName == uiName) {\n\t            btn.setChecked(1);\n\t        } else {\n\t            btn.setChecked(0);\n\t        }\n\t\n\t        /*var state = editor.queryCommandState(uiName);\n\t        console.log(state)\n\t        if (state == -1) {\n\t            btn.setDisabled(true);\n\t            btn.setChecked(false);\n\t        } else {\n\t            btn.setDisabled(false);\n\t            btn.setChecked(state);\n\t        }\n\t        btn.setChecked(1);*/\n\t    });\n\t    //因为你是添加button,所以需要返回这个button\n\t    return btn;\n\t}, 0);\n\n/***/ }),\n/* 113 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar getContent = function getContent(range) {\n\t\n\t    range.select();\n\t\n\t    var fragment = range.cloneContents();\n\t\n\t    var node = document.createElement(\"div\");\n\t\n\t    if (fragment) {\n\t        node.appendChild(fragment);\n\t    } else {\n\t        return '';\n\t    }\n\t\n\t    return node.innerHTML;\n\t};\n\t\n\tmodule.exports = getContent;\n\n/***/ }),\n/* 114 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * 插入表情\n\t * @author Fu Xiaochun\n\t */\n\t\n\tUE.registerUI('insertemoji', function (editor, uiName) {\n\t\n\t    var face = editor.face;\n\t\n\t    // 当点击编辑区获得焦点后，表情弹层隐藏。\n\t    /*editor.addListener('focus', function(editor) {\n\t    \tface.hide();\n\t    });*/\n\t\n\t    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n\t    editor.registerCommand(uiName, {\n\t        execCommand: function execCommand() {\n\t            editor.focus();\n\t            var $btn = $(btn.target);\n\t            var offset = $btn.offset();\n\t            var x = offset.left;\n\t            var y = offset.top / 1 + 30;\n\t\n\t            if (!face.isShow) {\n\t                face.show(x, y);\n\t            } else {\n\t                face.hide();\n\t            }\n\t        }\n\t    });\n\t\n\t    // 激活光标\n\t    editor.addListener('afterinserthtml', function () {\n\t        editor.focus();\n\t    });\n\t\n\t    //创建一个button\n\t    var btn = new UE.ui.Button({\n\t        name: 'insertemoji',\n\t        title: '插入表情',\n\t        label: '',\n\t        iconEle: '<em class=\"insert-imoj iconn-27\"></em>',\n\t        cssRules: '',\n\t        onclick: function onclick() {\n\t            editor.execCommand(uiName);\n\t        }\n\t    });\n\t\n\t    //当点到编辑内容上时，按钮要做的状态反射\n\t    editor.addListener('selectionchange', function () {\n\t        var state = editor.queryCommandState(uiName);\n\t        if (state == -1) {\n\t            btn.setDisabled(true);\n\t            btn.setChecked(false);\n\t        } else {\n\t            btn.setDisabled(false);\n\t            btn.setChecked(state);\n\t        }\n\t    });\n\t\n\t    //因为你是添加button,所以需要返回这个button\n\t    return btn;\n\t}, 0);\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 115 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * 插入图片\n\t * @author Fu Xiaochun\n\t */\n\tvar alert = __webpack_require__(36);\n\tvar upload = __webpack_require__(116);\n\tvar Pubsub = __webpack_require__(45);\n\tvar channel = __webpack_require__(100);\n\tvar pictureTpl = __webpack_require__(119);\n\tvar detectQr = __webpack_require__(120);\n\tvar config = __webpack_require__(122);\n\tvar imgReplace = __webpack_require__(118);\n\t__webpack_require__(123);\n\t\n\tvar imgMaxLen = config.imgLimitNUm;\n\tvar maxLen = imgMaxLen;\n\tvar imgTimes = 0;\n\tvar $content = null;\n\t\n\tvar $picPopBox = $('[data-node=picPopBox]');\n\tvar $upLocal = $('[data-node=upLocal]');\n\tvar $cover = $('[data-node=cover]');\n\tUE.registerUI('insertpicture', function (editor, uiName) {\n\t    editor.newPop = \"\";\n\t    var obj = {\n\t        time: 2000,\n\t        $showBox: $('[data-node=picPopBox]'),\n\t        customCb: \"\",\n\t        $insertDom: \"\",\n\t        editor: editor\n\t        //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n\t    };editor.registerCommand(uiName, {\n\t        execCommand: function execCommand() {\n\t\n\t            $content = $(editor.getContent());\n\t\n\t            var insertedImgLen = $content.find('img').not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n\t            maxLen = imgMaxLen - insertedImgLen;\n\t            if (maxLen <= 0) {\n\t                alert('您最多能添加' + imgMaxLen + '张图片哦！');\n\t                return;\n\t            }\n\t\n\t            if (!window.topicQrId) {\n\t\n\t                window.topicQrId = [];\n\t            }\n\t\n\t            if (!window.topicQrId['single']) {\n\t\n\t                editor.focus();\n\t\n\t                window.topicQrId['single'] = {};\n\t                $.extend(obj, {\n\t                    $parent: editor,\n\t                    $target: $(btn.target)\n\t                });\n\t                editor.newPop = new detectQr(obj);\n\t\n\t                editor.newPop.init();\n\t            } else {\n\t                var newPop = editor.newPop;\n\t                if (!newPop.useNewCode) {\n\t                    newPop.getCode();\n\t                } else {\n\t                    if (!newPop.checkShow()) {\n\t\n\t                        newPop.show();\n\t                        newPop.sendNum();\n\t                    } else {\n\t                        newPop.hide();\n\t                    }\n\t                }\n\t            }\n\t\n\t            $('div[tabindex]').remove();\n\t            if ($picPopBox.css('display') == 'block') {\n\t                setTimeout(function () {\n\t                    upload(maxLen, 20);\n\t                }, 200);\n\t            } else {}\n\t        }\n\t    });\n\t\n\t    // 激活光标\n\t    editor.addListener('afterinserthtml', function () {\n\t        editor.focus();\n\t    });\n\t\n\t    // 接收图片\n\t    Pubsub(channel.setPubliser.changeImage).sub(function (data) {\n\t        var $lastNode = null;\n\t        var pictureHTML = '';\n\t\n\t        data.times = ++imgTimes;\n\t        var images = data.images;\n\t        var len = images.length;\n\t        for (var i = 0; i < len; i++) {\n\t            var temp = imgReplace.imgReplace(images[i]);\n\t            var proto = imgReplace.imgProto(images[i]);\n\t            pictureHTML += pictureTpl({\n\t                times: data.times,\n\t                src: temp,\n\t                _src: temp,\n\t                imgProto: proto\n\t            });\n\t        }\n\t        //pictureHTML = pictureTpl(data)\n\t\n\t        /*.replace(/p> <img/gi,'p><img')\n\t        .replace(/(<img .*?)(> <)(\\/p>)/,function(i,j,k,l){\n\t        \treturn j + \"><\" + l;\n\t        });*/\n\t        editor.focus();\n\t\n\t        editor.execCommand('inserthtml', pictureHTML);\n\t\n\t        setTimeout(function () {\n\t            var $editor = $(editor.body);\n\t\n\t            $lastNode = $editor.find('[data-t=t-' + imgTimes + ']').last();\n\t            var lastOffsetTop = $lastNode.offset().top;\n\t            var lastPosition = lastOffsetTop + $lastNode.height();\n\t            if (lastPosition > $(window).height()) {\n\t                $('html,body').scrollTop(lastPosition);\n\t            }\n\t\n\t            imgReplace.changeSrc($editor);\n\t        }, 300);\n\t    });\n\t\n\t    //创建一个button\n\t    var btn = new UE.ui.Button({\n\t        name: 'insertpicture',\n\t        title: '插入图片',\n\t        label: '',\n\t        iconEle: '<em class=\"insert-pic icon\">&#xe931;</em>',\n\t        cssRules: '',\n\t        onclick: function onclick(e) {\n\t            editor.execCommand(uiName);\n\t        }\n\t    });\n\t\n\t    //当点到编辑内容上时，按钮要做的状态反射\n\t    editor.addListener('selectionchange', function () {\n\t        var state = editor.queryCommandState(uiName);\n\t        if (state == -1) {\n\t            btn.setDisabled(true);\n\t            btn.setChecked(false);\n\t        } else {\n\t            btn.setDisabled(false);\n\t            btn.setChecked(state);\n\t        }\n\t    });\n\t\n\t    //因为你是添加button,所以需要返回这个button\n\t    return btn;\n\t}, 0);\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 116 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar uploadPop = __webpack_require__(97),\n\t    Pubsub = __webpack_require__(45),\n\t    pubName = __webpack_require__(100);\n\tvar upload = __webpack_require__(117);\n\tvar alert = __webpack_require__(36);\n\tvar imgReplace = __webpack_require__(118);\n\t\n\tvar init = function init(maxLen, total) {\n\t    var dialogUploader,\n\t        $webUpLoader,\n\t        maxlength = maxLen;\n\t    if (maxlength > 0) {\n\t\n\t        dialogUploader = uploadPop.create({\n\t            maxlength: maxlength,\n\t            total: total\n\t        }, {\n\t            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n\t            ok: function ok() {\n\t                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n\t                    return false;\n\t                }\n\t                $('[data-node=\"uploadList\"]').off();\n\t                $webUpLoader.destroy();\n\t                var $imgList = $('[data-node=\"uploadList\"] img'),\n\t                    images = [];\n\t                for (var i = 0, len = $imgList.length; i < len; i++) {\n\t                    images.push($imgList.eq(i).attr('src'));\n\t                }\n\t                //maxLen -= images.length;\n\t                Pubsub(pubName.setPubliser.changeImage).pub({\n\t                    images: images\n\t                });\n\t                $('[data-node=picPopBox]').hide();\n\t            },\n\t            cancel: function cancel() {\n\t                $('[data-node=\"uploadList\"]').off();\n\t                $webUpLoader.destroy();\n\t                $('[data-node=picPopBox]').hide();\n\t            }\n\t        });\n\t\n\t        $webUpLoader = upload.init({\n\t            maxlength: maxlength,\n\t            callbacks: {\n\t                onFileQueued: function onFileQueued(file, numList, number) {\n\t                    var $uploadBox = $('[data-node=\"uploadBox\"]');\n\t                    var picker = '[data-defaultaddfile=\"picker\"]';\n\t                    $('[data-node=picPopBox]').addClass('webuploader-element-invisible');\n\t                    dialogUploader.show();\n\t                    $uploadBox.find(picker).children().eq(0).html('<em class=\"icon-add\"></em>');\n\t                    var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n\t                    $uploadBox.find(picker).before(html);\n\t                    $uploadBox.find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\t                    if (numList[file.source.ruid] === ~~number) {\n\t                        $uploadBox.find(picker).hide();\n\t                    }\n\t                    $uploadBox.find(picker).children().eq(1).css({\n\t                        'width': '78px',\n\t                        'height': '78px'\n\t                    });\n\t                },\n\t\n\t                onUploadSuccess: function onUploadSuccess(file, response) {\n\t                    if (response.code === 200 && response.success) {\n\t                        $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t                        // 激活提交按钮\n\t                        $('[i-id=ok]').removeClass('btn-default');\n\t                    } else {\n\t                        $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t                    }\n\t                }\n\t            }\n\t        });\n\t    } else {\n\t        alert('您最多能添加' + maxLen + '张图片哦！');\n\t    }\n\t    return $webUpLoader;\n\t};\n\t\n\tmodule.exports = init;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 117 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG, $) {'use strict';\n\t\n\t/***\n\t * upload.js\n\t * @author zhaodonghong\n\t * @params                      object      上传图片参数\n\t *     maxlength               number      可上传图片最大张数\n\t *     selector                object      jq选择器\n\t *         parents             string      每个图片上传外层jq选择器\n\t *         delSelector         string      删除按钮jq选择器\n\t *         selector            string      实例化上传插件的pick.id的值\n\t *     defaultApi              object      实例化webuploader参数\n\t *     callbacks               object      实例化webuploader方法回调集合\n\t *         onBeforeFileQueued  function    上传图片添加到上传队列之前\n\t *         onFileQueued        function    上传图片添加到上传队列后\n\t *         onUploadSuccess     function    上传成功\n\t *         onUploadError       function    上传失败\n\t *         onUploadProgress    function    上传中\n\t *         onErrored           function    报错\n\t *         retry               function    重新上传\n\t *         delImage            function    删除上传图片\n\t */\n\t\n\tvar WebUploader = __webpack_require__(86);\n\tvar hint = __webpack_require__(44);\n\tvar notice = __webpack_require__(84);\n\tvar imgReplace = __webpack_require__(118);\n\tvar init = function init(options) {\n\t\n\t    //var number = maxlength;\n\t    var numList = {};\n\t    var $webUpLoader;\n\t    var files = {};\n\t    var defaultOptions = {\n\t        //最大上传张数\n\t        maxlength: options.maxlength || 9,\n\t        //选择器\n\t        selector: {\n\t            parents: '[data-node=\"uploadBox\"]', //每个图片上传外层jq选择器\n\t            delSelector: '[data-action=\"delImage\"]', //删除按钮jq选择器\n\t            selector: '[data-defaultAddFile=picker]' //初始化时options.defaultApi.pick 的值，也就是 选择器的值\n\t        }\n\t    };\n\t    //初始化参数\n\t    defaultOptions.defaultApi = {\n\t        pick: {\n\t            id: '[data-defaultAddFile=picker]',\n\t            innerHTML: '本地上传图片'\n\t        },\n\t        accept: {\n\t            title: 'Images',\n\t            extensions: 'jpg,jpeg,png,gif',\n\t            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\n\t        },\n\t        method: 'post',\n\t        // swf文件路径\n\t        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\n\t        auto: true,\n\t        disableGlobalDnd: true,\n\t        duplicate: true,\n\t        prepareNextFile: true,\n\t        chunked: true,\n\t        fileVal: 'avatar_file',\n\t        server: '/ajax/crop/crop_img',\n\t        fileNumLimit: defaultOptions.maxlength * $(defaultOptions.selector).length,\n\t        fileSizeLimit: defaultOptions.maxlength * $(defaultOptions.selector).length * 4 * 1024 * 1024, // 50 M\n\t        fileSingleSizeLimit: 4 * 1024 * 1024\n\t    };\n\t    defaultOptions.callbacks = {\n\t        /***\n\t         * name: 图片加入队列之前\n\t         * file: 图片信息对象\n\t         * numList: 以 file.source.ruid 为key的计数json对象\n\t         * number: 最多可上传数\n\t         */\n\t        onBeforeFileQueued: function onBeforeFileQueued() /*file, numList, number*/{\n\t            hint.init(notice.upload.excess);\n\t        },\n\t\n\t        /***\n\t         * name: 图片添加入队列后\n\t         * file: 图片信息对象\n\t         * numList: 以 file.source.ruid 为key的计数json对象\n\t         * maxlength: 最多可上传数\n\t         */\n\t        onFileQueued: function onFileQueued(file, numList, number) {\n\t            var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n\t            $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').before(html);\n\t\n\t            $('#rt_' + file.source.ruid).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\t\n\t            if (numList[file.source.ruid] === ~~number) {\n\t                $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').hide();\n\t            }\n\t        },\n\t\n\t        /***\n\t         * name: 上传成功（此成功指ajax有返回结果，故需要判断返回的状态码）\n\t         * file: 图片信息对象\n\t         * response: 上传图片ajax返回数据\n\t         */\n\t        onUploadSuccess: function onUploadSuccess(file, response) {\n\t            if (response.code === 200 && response.success) {\n\t                $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t                //$('#' + file.id).html('<img src=\"' + imgReplace(response.data[0]) + '\" _src = \"' + response.data[0] + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t            } else {\n\t                $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t            }\n\t        },\n\t\n\t        /***\n\t         * name: 上传失败\n\t         * file: 图片信息对象\n\t         * reason: 出错的code\n\t         */\n\t        onUploadError: function onUploadError(file /*, reason*/) {\n\t            $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t        },\n\t\n\t        /***\n\t         * name: 上传时，包含进度条\n\t         * file: 图片信息对象\n\t         * percentage: 上传进度\n\t         */\n\t        onUploadProgress: function onUploadProgress(file, percentage) {\n\t            $('#' + file.id).find('[data-node=\"progress\"]').css('width', percentage * 100 + '%');\n\t        },\n\t\n\t        /***\n\t         * name: 报错\n\t         * type: 报错类型\n\t         */\n\t        onErrored: function onErrored() /*type*/{\n\t            hint.init(notice.upload.uploadError);\n\t        },\n\t\n\t        //重新上传\n\t        retry: function retry() {\n\t            var _this = this;\n\t            $('[data-node=\"uploadList\"]').on('click', '[data-action=\"retry\"]', function () {\n\t                _this.retry(files[$(this).parents('li').attr('id')]);\n\t            });\n\t        },\n\t\n\t        /***\n\t         * name: 删除图片\n\t         * webuploader: webuploader实例化对象\n\t         * numList: 自定义json对象，用来存储每个实例化对象已上传的图片个数\n\t         * id: 每个webuploader实例化时，上传按钮所生成的唯一id\n\t         */\n\t        delImage: function delImage(webuploader, numList, id, number) {\n\t            $webUpLoader.removeFile(files[$(this).parents('li').attr('id')]);\n\t            $(this).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[id]);\n\t            $(this).parents('ul').find('[data-defaultAddFile=\"picker\"]').show();\n\t            $(this).parents('li').eq(0).remove();\n\t            if (numList[id] === 0) {\n\t                $('[i-id=ok]').addClass('btn-default');\n\t            };\n\t        }\n\t    };\n\t    options.callbacks = $.extend({}, defaultOptions.callbacks, options.callbacks);\n\t    /*var */\n\t    options = $.extend({}, defaultOptions, options);\n\t    $webUpLoader = WebUploader.create(options.defaultApi);\n\t\n\t    $webUpLoader.onFileQueued = function (file) {\n\t        var ruid = $('[data-node=\"uploadBox\"]').find('[data-defaultaddfile=\"picker\"]').children().eq(1).attr('id');\n\t        file.source.ruid = ruid;\n\t        numList[file.source.ruid] = numList[file.source.ruid] !== undefined ? numList[file.source.ruid] : 0;\n\t        numList[file.source.ruid]++;\n\t        files[file.id] = file;\n\t        options.callbacks.onFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\t    };\n\t\n\t    //上传成功\n\t    $webUpLoader.on('uploadSuccess', function (file, response) {\n\t        options.callbacks.onUploadSuccess.call($webUpLoader, file, response);\n\t    });\n\t\n\t    //加入队列前\n\t    $webUpLoader.on('beforeFileQueued', function (file) {\n\t        if (numList[file.source.ruid] >= options.maxlength) {\n\t            options.callbacks.onBeforeFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\t            return false;\n\t        }\n\t    });\n\t    //上传失败\n\t    $webUpLoader.on('uploadError', function (file, reason) {\n\t        options.callbacks.onUploadError.call($webUpLoader, file, reason);\n\t    });\n\t\n\t    //上传时\n\t    $webUpLoader.on('uploadProgress', function (file, percentage) {\n\t        options.callbacks.onUploadProgress.call($webUpLoader, file, percentage);\n\t    });\n\t\n\t    //报错\n\t    $webUpLoader.on('error', function (type) {\n\t        options.callbacks.onErrored.call($webUpLoader, type);\n\t    });\n\t    options.callbacks.retry.call($webUpLoader);\n\t\n\t    //删除图片\n\t    $(options.selector.parents).on('click', options.selector.delSelector, function () {\n\t        var id = $(this).parents(options.selector.parents).find(options.defaultApi.pick.id).children().eq(1).attr('id');\n\t        numList[id]--;\n\t        options.callbacks.delImage.call(this, $webUpLoader, numList, id, options.maxlength);\n\t    });\n\t\n\t    return $webUpLoader;\n\t};\n\t\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3), __webpack_require__(2)))\n\n/***/ }),\n/* 118 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar rules = /^https?:/i;\n\tvar https = 'https';\n\tvar imgRule = /^http/i;\n\t/* var grepStr = /-600!80\\./g;\n\t var grepOldStr = /\\.600q80\\.jpg/gi;*/\n\tvar shotCut = \"-600!80\";\n\tvar imgType = /\\.(jpg|jpeg|png)$/;\n\t\n\tvar grepStr1 = /(.+?)-[^\\.]+\\.(jp(e)?g|png|gif).*/;\n\tvar grepStr2 = /(.+?\\.(jp(e)?g|png|gif)).*/;\n\t\n\tvar imgReplace = function imgReplace(src) {\n\t    return src.replace(rules, '');\n\t};\n\t\n\tvar orignalImgReplace = function orignalImgReplace(src) {\n\t    if (grepStr1.test(src)) {\n\t        return src.replace(grepStr1, \"$1.$2\");\n\t    } else {\n\t        return src.replace(grepStr2, \"$1\");\n\t    }\n\t};\n\t\n\tvar addShortCut = function addShortCut(src) {\n\t    return src.replace(imgType, function ($1) {\n\t        return shotCut + $1;\n\t    });\n\t};\n\tvar imgProto = function imgProto(src) {\n\t    if (src.indexOf(https) != -1) {\n\t        return 'https:';\n\t    } else {\n\t        return 'http:';\n\t    }\n\t};\n\t\n\tvar changeSrc = function changeSrc(container) {\n\t    var $imgs = container.find('img').not('[data-node=\"goodsPic\"]');\n\t    var len = $imgs.length;\n\t    for (var i = 0; i < len; i++) {\n\t        var _this = $($imgs[i]);\n\t        var _src = _this.attr(\"_src\");\n\t        var _orignal = _this.attr(\"data-original\");\n\t        if (_orignal) {\n\t            _this.attr({\n\t                'src': imgReplace(_orignal),\n\t                '_src': imgReplace(_orignal),\n\t                'proto': imgProto(_orignal)\n\t            });\n\t        } else if (!imgRule.test(_src)) {\n\t            var proto = _this.attr(\"proto\");\n\t            _this.attr(\"_src\", _src);\n\t        }\n\t    }\n\t};\n\t\n\tmodule.exports = {\n\t    imgReplace: imgReplace,\n\t    addShortCut: addShortCut,\n\t    imgProto: imgProto,\n\t    changeSrc: changeSrc,\n\t    orignalImgReplace: orignalImgReplace\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 119 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/editor/plugin/picture/pictures',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,images=$data.images,v=$data.v,$index=$data.$index,$escape=$utils.$escape,times=$data.times,src=$data.src,_src=$data._src,imgProto=$data.imgProto,$out='';$out+='<!-- ';\n\t$each(images,function(v,$index){\n\t$out+=' <p> <img data-t=\"t-';\n\t$out+=$escape(times);\n\t$out+='\" angle=\"0\" data-type=\"insertImg\" src=\"';\n\t$out+=$escape(v);\n\t$out+='\"> </p> ';\n\t});\n\t$out+=' --> <p> <img data-t=\"t-';\n\t$out+=$escape(times);\n\t$out+='\" angle=\"0\" data-type=\"insertImg\" src=\"';\n\t$out+=$escape(src);\n\t$out+='\" _src=\"';\n\t$out+=$escape(_src);\n\t$out+='\" proto=\"';\n\t$out+=$escape(imgProto);\n\t$out+='\"> </p> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 120 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar codeTpl = __webpack_require__(121);\n\tvar imgPath = $GLOBAL_CONFIG['pcimgpath'];\n\t\n\t$('body').append(codeTpl({\n\t    imgPath: imgPath\n\t}));\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar qrTips = __webpack_require__(84);\n\tvar alert = __webpack_require__(36);\n\tvar config = __webpack_require__(122);\n\tvar imgReplace = __webpack_require__(118);\n\tvar domain = $_CONFIG['group_domain'];\n\t\n\tvar pageId = window.pageId;\n\tvar maxLen = config.imgLimitNUm;\n\tvar pageId = window.pageId;\n\tfunction Scans(o) {\n\t    this.qid = o.qid || 'single'; //是否创建实例的唯一标示\n\t    this.topicQrId = \"\";\n\t    this.$parent = o.$parent; //用于寻找插入图片的节点\n\t    this.uploadMaxNum = o.maxNum || 20; //上传图片限制\n\t    //this.currentMaxNum = 0; //当前能够上传图片\n\t    this.useNewCode = 0; //二维码是否过期的判断\n\t    this.interval = 0;\n\t    this.type = o.type || 'pubsliser'; //扫码来源  评论页？发布话题页？等\n\t    this.$showBox = o.$showBox; //二维码弹层\n\t    this.time = o.time || 2000; //轮询请求间隔\n\t    this.customInit = o.customInit || \"\";\n\t    this.customCb = o.customCb; //用户自定义回调函数\n\t    this.isLoad = 0;\n\t    // this.$insertDom = o.$insertDom; //插入图片的节点\n\t    this.imgArr = []; //存储二维码未过期时，获得的的图片总数\n\t    this.editor = o.editor || \"\"; //用于编辑器\n\t    this.$cover = o.$showBox.find('[data-node=\"cover\"]'); //是否上传中\n\t    this.$localBtn = o.$showBox.find('[data-node=\"upLocal\"]'); //是否上传中\n\t    this.$target = o.$target;\n\t    this.code = \"\";\n\t    this.btn = o.btn;\n\t}\n\t\n\tScans.prototype = {\n\t    constructor: Scans,\n\t    init: function init() {\n\t        var _this = this;\n\t        if (_this.editor) {\n\t            //\n\t            /*_this.editor.document.body.addEventListener('DOMNodeRemoved', function(evt) {\n\t                var code = evt.keyCode || evt.which\n\t                if (code == 8) {\n\t                    var target = evt.target\n\t                    debugger;\n\t                    console.log(target.nodeName, target.previousSibling, target.previousSibling.nodeName)\n\t                    if (target.nodeName == \"#text\") {\n\t                        if (target.previousSibling && target.previousSibling.nodeName == \"IMG\") {\n\t            console.log(333)\n\t                        }\n\t                    }\n\t                }\n\t            })*/\n\t\n\t            /*$(_this.editor.document).on('DOMNodeRemoved DOMNodeInserted', 'img', function(e) {\n\t                if (_this.interval) {\n\t                    //console.log(666)\n\t                    setTimeout(function() {\n\t                        _this.sendNum();\n\t                    }, 100)\n\t                 }\n\t            })*/\n\t\n\t            $(_this.editor.body).on('click', function (e) {\n\t                //$webUpLoader.destroy();\n\t                _this.hide();\n\t                e.preventDefault();\n\t            });\n\t        }\n\t\n\t        if (typeof _this.customInit == 'function') {\n\t            this.customInit(this);\n\t        }\n\t        $('body').on('click', /* _this.$showBox*/'[data-node=\"picPopBox\"]', function (e) {\n\t            var tagName = e.target.tagName;\n\t            tagName = tagName == 'INPUT' || tagName == 'LABEL';\n\t            if (!tagName) {\n\t                e.stopPropagation();\n\t            } else {\n\t                _this.hide();\n\t            }\n\t        });\n\t\n\t        this.start();\n\t    },\n\t    start: function start() {\n\t        if (!this.useNewCode) {\n\t            this.getCode();\n\t        } else {\n\t\n\t            if (this.checkShow()) {\n\t                this.hide();\n\t            } else {\n\t                this.show();\n\t            }\n\t        }\n\t    },\n\t    //获取图片数量\n\t    imgLength: function imgLength() {\n\t        if (this.editor) {\n\t            return $(this.$parent.getContent()).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n\t        } else {\n\t            return this.$parent.find(\"img\").length;\n\t        }\n\t    },\n\t    //获取二维码\n\t    getCode: function getCode() {\n\t        var _this = this;\n\t        var len = this.imgLength();\n\t        var datas = {\n\t            pageId: pageId,\n\t            maxNum: this.uploadMaxNum - len\n\t        };\n\t        var qid = _this.qid;\n\t        var qidArr = window.topicQrId; //检测window变量是否有此变量 格式为：\n\t        _this.show();\n\t        //topicQrId:{\n\t        //  qid1:s1111,\n\t        //  qid2:s2222\n\t        // }\n\t        if (qidArr[qid].qrcodeId) {\n\t            datas.qrcodeId = _this.topicQrId;\n\t        }\n\t        fetch.get(url.get('getUploadQrCode'), {\n\t            data: datas\n\t        }).done(function (data) {\n\t            if (data.success == true) {\n\t\n\t                if (data.code == 200) {\n\t\n\t                    _this.useNewCode = 1;\n\t\n\t                    var _data = data.data;\n\t\n\t                    var str = domain + 'qrupload/index?pageId=' + _data.pageId + '&qrcodeId=' + _data.qrcodeId + '&type=' + _this.type;;\n\t                    str = domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(str);\n\t\n\t                    window.topicQrId[qid].qrcodeId = _this.topicQrId = _data.qrcodeId; //把data的值赋予 window [qid].qrcodeId\n\t\n\t                    _this.code = str; //把二维码的值放入\n\t                    _this.getCodeCb();\n\t\n\t                    _this.interval = setInterval(function () {\n\t                        _this.monitor();\n\t                    }, _this.time);\n\t                }\n\t            } else {\n\t                alert(data.message);\n\t            }\n\t        }).fail(function (e, s) {});\n\t    },\n\t    //扫码轮询\n\t    monitor: function monitor() {\n\t        var _this = this;\n\t        fetch.post(url.get('topListenImg'), {\n\t            data: {\n\t                code: pageId,\n\t                groupkey: window.topicQrId[_this.qid].qrcodeId\n\t            }\n\t\n\t        }).done(function (data) {\n\t\n\t            if (data.success == true) {\n\t                //ok\n\t                _this.scanCb(data);\n\t            } else {\n\t                _this.hide();\n\t            }\n\t        }).fail(function (e, m) {\n\t            clearInterval(_this.interval);\n\t            _this.interval = 0;\n\t            _this.hide();\n\t            // alert(e);\n\t        });\n\t    },\n\t    sendNum: function sendNum() {\n\t        var _this = this;\n\t        var len = this.imgLength();\n\t        var maxNum = this.uploadMaxNum - len;\n\t        fetch.get(url.get('topicuploadMax'), {\n\t            data: {\n\t                qrcodeId: _this.topicQrId,\n\t                maxNum: maxNum\n\t            }\n\t        });\n\t    },\n\t    //插入图片\n\t    insertPic: function insertPic(data) {\n\t        for (var i = 0, len = data.length; i < len; i++) {\n\t            var _data = data[i];\n\t            var _img = imgReplace.imgReplace(_data);\n\t            var _proto = imgReplace.imgProto(_data);\n\t            var str = '<p><img src=\"' + _img + '\" _src=\"' + _img + '\" data-type=\"insertImg\" proto=\"' + _proto + '\"/></p>';\n\t            this.editor.execCommand('inserthtml', str);\n\t        }\n\t    },\n\t    //用户正在上传中\n\t    loading: function loading() {\n\t        this.isLoad = 1;\n\t        this.$showBox.show();\n\t        this.$cover.show();\n\t        this.$localBtn.addClass('upload-unable');\n\t        if (this.editor) {\n\t            this.editor.setDisabled();\n\t        }\n\t    },\n\t    //用户不在上传中\n\t    unLoading: function unLoading() {\n\t        this.isLoad = 0;\n\t        this.$cover.hide();\n\t        this.$cover.css(\"display\", \"none\");\n\t        this.$localBtn.removeClass('upload-unable');\n\t        if (this.editor) {\n\t            this.editor.setEnabled();\n\t        }\n\t    },\n\t    //检查弹层状态\n\t    checkShow: function checkShow() {\n\t        if (this.$showBox.is(\":visible\")) {\n\t            return true;\n\t        }\n\t        return false;\n\t    },\n\t    //调整弹窗位置\n\t    fixPop: function fixPop() {\n\t        var $btn = this.$target;\n\t        var offset = $btn.offset();\n\t        var x = offset.left;\n\t        var y = offset.top / 1 + 30;\n\t\n\t        return this.$showBox.css({\n\t            'top': y + 'px',\n\t            'left': x + 'px'\n\t        });\n\t    },\n\t    //显示弹层\n\t    show: function show() {\n\t        this.$showBox.removeClass('webuploader-element-invisible');\n\t        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n\t        this.fixPop().show();\n\t    },\n\t    //隐藏弹层\n\t    hide: function hide() {\n\t        if (this.isLoad != 1) {\n\t            this.$showBox.hide();\n\t        }\n\t    },\n\t    //获得二维码回调\n\t    getCodeCb: function getCodeCb() {\n\t        this.sendNum(); //发送二维码数量\n\t        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n\t        //this.show();\n\t    },\n\t    //扫码回调\n\t    scanCb: function scanCb(data) {\n\t\n\t        switch (data.isload) {\n\t            case 1:\n\t                this.unLoading();\n\t                break;\n\t            case 2:\n\t                //上传中\n\t                this.loading();\n\t\n\t                break;\n\t            case 3:\n\t                //上传完成\n\t                var dataArr = data.data;\n\t                var tempArr = [];\n\t\n\t                var diffLen = dataArr.length - this.imgArr.length;\n\t\n\t                if (diffLen) {\n\t                    this.loading();\n\t                    this.imgArr = dataArr;\n\t                    tempArr = dataArr.slice(-diffLen);\n\t                    var _this = this;\n\t                    setTimeout(function () {\n\t                        _this.unLoading();\n\t                        _this.hide();\n\t                        if (typeof _this.customCb == 'function') {\n\t                            _this.customCb(tempArr, _this);\n\t                        } else {\n\t                            _this.insertPic(tempArr);\n\t                        }\n\t                    }, 500);\n\t                }\n\t                break;\n\t            case 10000:\n\t                this.imgArr = [];\n\t                this.isload = 0;\n\t                this.useNewCode = 0; //useNewCode 为0 意味着二维码过期\n\t                clearInterval(this.interval);\n\t                this.interval = 0;\n\t                this.hide();\n\t                break;\n\t        }\n\t    }\n\t    //prototype end\n\t};\n\t\n\tmodule.exports = Scans;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 121 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/uploadfileQR/upload',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgPath=$data.imgPath,$out='';$out+='<div data-node=\"picPopBox\" class=\"picPopBox\" data-node=\"picPopBox\"> <em class=\"sanjiao\"></em> <div class=\"container clearfix\"> <div class=\"left\"> <div class=\"qr\"> <img src=\\'\\'/> <div class=\"cover\" data-node=\"cover\">上传中...</div> </div> <p>扫描二维码,上传手机图片</p> </div> <div class=\"right\" data-node=\"uploadList\"> <div class=\"pc-btn pc-btnh35\" data-defaultAddFile=\\'picker\\'></div> </div> </div> </div> <div data-node=\"picLoading\" class=\"picLoading hide\"> <img src=\"';\n\t$out+=$escape(imgPath);\n\t$out+='/images/public/loading.gif\"/> <div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 122 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\t//白名单\n\tvar whiteList = {\n\t    a: ['target', 'href', 'title', 'class', 'data-node'],\n\t    div: ['class', 'style', 'data-node', 'unselectable', 'onselectstart', 'data-type', 'data-skuid'],\n\t    dl: ['class', 'style', 'data-node'],\n\t    dt: ['class', 'style'],\n\t    em: ['class', 'style', 'data-node'],\n\t    h1: ['data-node'],\n\t    h2: ['data-node'],\n\t    h3: ['data-node'],\n\t    h4: ['data-node'],\n\t    h5: ['data-node'],\n\t    h6: ['data-node'],\n\t    img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-index', 'data-type', 'data-node', 'data-original', 'onerror', 'proto'],\n\t    p: ['class', 'style', 'data-node'],\n\t    span: ['class', 'style', 'data-node'],\n\t    ul: ['class', 'style', 'data-node'],\n\t    ol: ['class', 'style', 'data-node'],\n\t    li: ['class', 'style', 'data-node']\n\t};\n\t\n\tvar defaults = {\n\t    //图片张数限制\n\t    imgLimitNUm: 20,\n\t    //商品个数限制\n\t    goodsLimitNUm: 9,\n\t    initialFrameWidth: 788,\n\t    initialFrameHeight: 400,\n\t    zIndex: 9,\n\t    autoClearinitialContent: true,\n\t    //服务器根目录\n\t    UEDITOR_HOME_URL: $_CONFIG['js_domain'],\n\t    //后台地址\n\t    //serverUrl:'php/1.php',\n\t    //serverUrl: $_CONFIG['group_domain'],\n\t    serverUrl: '',\n\t    //css 路径\n\t    themePath: $_CONFIG.csspath + '/css/module/',\n\t    //白名单\n\t    whitList: whiteList,\n\t    //工具栏\n\t    toolbars: [['bold', 'italic', 'underline', 'insertunorderedlist', 'insertorderedlist', 'justifyleft', 'justifycenter', 'justifyright']\n\t    //['insertunorderedlist', 'insertorderedlist']\n\t    ],\n\t    //iframe 内置样式\n\t    iframeCssUrl: $_CONFIG.csspath + '/css/module/iframestyle.css?v=' + $GLOBAL_CONFIG['versionData'],\n\t    //'//localhost:8017/src/js/editor/themes/iframestyle.css',\n\t    //纯文本粘贴\n\t    pasteplain: true,\n\t    //禁止div转换成p标签\n\t    allowDivTransToP: false,\n\t    //禁止缩放图片\n\t    imageScaleEnabled: false,\n\t    elementPathEnabled: false, // 关闭元素路径,调试时暂时开启\n\t    wordCount: false, // 字数统计\n\t    //禁止非同域上传图片\n\t    catchRemoteImageEnable: true,\n\t    //匹配快捷按键回调\n\t    // callbackKey: shortcutKey.callbackKey,\n\t    //右键菜单功能\n\t    enableContextMenu: false,\n\t    // 因为是用的自定义的弹窗,所以,关闭了编辑器自带的图片弹窗\n\t    imagePopup: false,\n\t    // 禁止自动保存\n\t    enableAutoSave: false\n\t    // 自定义过滤规则\n\t    // filterTxtRules:filterTxtRules()\n\t};\n\tmodule.exports = defaults;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 123 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * @description\n\t * 图片角度转化\n\t *\n\t * @author 林飞\n\t */\n\tvar alert = __webpack_require__(36);\n\tvar transform = __webpack_require__(124);\n\tvar showText = __webpack_require__(125);\n\tUE.plugin.register('tansformImg', function (elm) {\n\t    var me = this;\n\t    var domUtils = UE.dom.domUtils;\n\t    //禁止连续请求\n\t\n\t    // img旋转弹层 鼠标离开，键盘事件都需要隐藏\n\t    var imageTransformPopup = window.imageTransformPopup = new baidu.editor.ui.Popup({\n\t        editor: me,\n\t        theme: 'default',\n\t        cutstomPosition: 'top-right',\n\t        _filterType: function _filterType(el) {\n\t            var src = $(el).attr(\"src\");\n\t            if (src.indexOf(\".gif\") != -1) {\n\t                alert(\"gif图不支持旋转\");\n\t                return false;\n\t            } else {\n\t                return true;\n\t            }\n\t        },\n\t        _link: function _link() {\n\t            var range = me.selection.getRange();\n\t            range.selectNode(this.anchorEl).select();\n\t            showText(me, this.anchorEl);\n\t        },\n\t        _left: function _left() {\n\t            var el = this.anchorEl;\n\t            if (this._filterType(el)) {\n\t                transform(this.anchorEl, 1);\n\t            }\n\t            me.focus();\n\t        },\n\t        _right: function _right() {\n\t            var el = this.anchorEl;\n\t            if (this._filterType(el)) {\n\t                transform(this.anchorEl, 2);\n\t            }\n\t            me.focus();\n\t        },\n\t        _delete: function _delete() {\n\t            UE.dom.domUtils.remove(this.anchorEl, true);\n\t            //$(this.anchorEl).remove();\n\t            imageTransformPopup.hide();\n\t            me.focus();\n\t        }\n\t    });\n\t\n\t    imageTransformPopup.render();\n\t\n\t    me.addListener('mouseover', function (evtName, evt) {\n\t        if (me.loading) return;\n\t\n\t        var target = evt.target;\n\t        if ($(target).attr('data-node') == 'goodsPic') return;\n\t        //console.log(evt.target.tagName === 'IMG')\n\t        //var img = me.selection.getRange().getClosedNode();\n\t        //if (img && img.tagName == \"IMG\" && img.parentNode.tagName != \"A\") {\n\t        // if (target && target.tagName == \"IMG\" && target.parentNode.tagName != \"A\") {\n\t        if (target && target.tagName == \"IMG\") {\n\t            var html = '',\n\t                str = \"\",\n\t                img = target;\n\t\n\t            str = '<nobr class=\"edui_angle_box edui-clearfix\">' + '<span onclick=$$._link() class=\"edui-clickable\"></span>' + '<span onclick=$$._left() class=\"edui-clickable\"></span>' + '<span onclick=$$._right() class=\"edui-clickable\"></span>' + '<span onclick=$$._delete() class=\"edui-clickable\"></span>' + '</nobr>';\n\t\n\t            !html && (html = imageTransformPopup.formatHtml(str));\n\t            if (html) {\n\t                imageTransformPopup.getDom('content').innerHTML = html;\n\t                imageTransformPopup.anchorEl = img || link;\n\t                imageTransformPopup.showAnchor(imageTransformPopup.anchorEl);\n\t            } else {\n\t                imageTransformPopup.hide();\n\t            }\n\t        }\n\t    });\n\t\n\t    me.addListener('mouseover', function () {\n\t        imageTransformPopup.hide();\n\t    });\n\t});\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 124 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\t\n\tvar imgReplace = __webpack_require__(118);\n\tvar firing = 0;\n\tvar imgArr = [];\n\tvar $picLoading;\n\t//var transformUrl = '1.json';\n\t\n\tvar transformAngle = function transformAngle($obj, direction) {\n\t    //img对象  角度\n\t    if (firing == 1) {\n\t        return false;\n\t    }\n\t    var def = $.Deferred();\n\t    var angle = parseInt($obj.attr(\"angle\")) || 0;\n\t    switch (direction) {\n\t        case 2:\n\t            if (angle == 0) {\n\t                angle = 270;\n\t            } else {\n\t                angle -= 90;\n\t            }\n\t            break;\n\t        case 1:\n\t            if (angle == 270) {\n\t                angle = 0;\n\t            } else {\n\t                angle += 90;\n\t            }\n\t            break;\n\t        case \"reset\":\n\t            angle = 0;\n\t            break;\n\t    }\n\t    def.resolve($obj, angle);\n\t    return def.promise();\n\t};\n\t\n\tvar detectImg = function detectImg($obj, angle) {\n\t    if (firing == 1) {\n\t        return false;\n\t    }\n\t    var def = $.Deferred();\n\t    var _src = $obj.attr(\"_src\");\n\t    var src = imgReplace.imgReplace(_src);\n\t\n\t    //数组是否包含 下标为_src的元素\n\t    var hasImg = imgArr[_src];\n\t    var angleStr = 'angle' + angle;\n\t    //是否包含已有角度的元素，\n\t    var tempObj = {\n\t        \"$obj\": $obj,\n\t        \"src\": src,\n\t        \"_src\": _src,\n\t        \"angle\": angle\n\t    };\n\t\n\t    var extendObj = {};\n\t\n\t    if (hasImg) {\n\t        if (hasImg[angleStr]) {\n\t            extendObj = {\n\t                \"status\": 1,\n\t                \"cache\": 1\n\t            };\n\t        } else {\n\t            extendObj = {\n\t                \"status\": 0,\n\t                \"cache\": 1\n\t            };\n\t        }\n\t    } else {\n\t        extendObj = {\n\t            \"status\": 0,\n\t            \"cache\": 0\n\t        };\n\t    }\n\t\n\t    $.extend(tempObj, extendObj);\n\t\n\t    def.resolve(tempObj);\n\t    return def.promise();\n\t};\n\t\n\tvar renderImg = function renderImg(obj) {\n\t\n\t    if (firing == 1) {\n\t        return false;\n\t    }\n\t    firing = 1;\n\t    var $obj = obj.$obj;\n\t    var src = obj.src;\n\t    var _src = obj._src;\n\t    var angle = obj.angle;\n\t    var status = obj.status;\n\t    var cache = obj.cache;\n\t\n\t    var angleStr = \"angle\" + angle;\n\t\n\t    var renderExist = function renderExist() {\n\t        $obj.attr({\n\t            'src': imgReplace.imgReplace(imgArr[_src][angleStr]),\n\t            'angle': angle,\n\t            \"proto\": imgReplace.imgProto(imgArr[_src][angleStr])\n\t        });\n\t        firing = 0;\n\t    };\n\t\n\t    if (obj.status) {\n\t        renderExist();\n\t        //直接渲染\n\t        return false;\n\t    }\n\t\n\t    if (obj.angle == 0) {\n\t\n\t        if (!imgArr[_src]) {\n\t            imgArr[_src] = [];\n\t        }\n\t\n\t        imgArr[_src][angleStr] = imgReplace.imgReplace($obj.attr(\"_src\"));\n\t        renderExist();\n\t        return false;\n\t    }\n\t\n\t    // fetch.get(transformUrl, {\n\t    fetch.post(url.get('topicRotateImg'), {\n\t        data: {\n\t            imgPath: _src,\n\t            angle: angle\n\t        },\n\t        beforeSend: function beforeSend() {\n\t            if (!$picLoading) {\n\t                $picLoading = $('[data-node=\"picLoading\"]');\n\t            }\n\t            $picLoading.removeClass('hide');\n\t        }\n\t    }).done(function (data) {\n\t        var dataSrc = data.data[0];\n\t        if (data.success == true) {\n\t            $obj.attr({\n\t                'src': imgReplace.imgReplace(dataSrc),\n\t                'angle': angle,\n\t                'proto': imgReplace.imgProto(dataSrc)\n\t            });\n\t            if (!obj.cache) {\n\t\n\t                imgArr[_src] = [];\n\t            }\n\t            imgArr[_src][angleStr] = imgReplace.imgReplace(dataSrc);\n\t        } else {\n\t            alert(data.message);\n\t        }\n\t    }).always(function (data) {\n\t        firing = 0;\n\t        $picLoading.addClass('hide');\n\t    });\n\t};\n\t\n\tvar transform = function transform(obj, direction) {\n\t    var def = $.Deferred();\n\t    def.resolve($(obj), direction);\n\t\n\t    def.then(transformAngle) //转化角度\n\t    .then(detectImg) //判断图片是否命中\n\t    .then(renderImg); //渲染图片\n\t};\n\tmodule.exports = transform;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 125 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar domUtils = UE.dom.domUtils;\n\tvar utils = UE.utils;\n\t\n\tvar pop = __webpack_require__(126);\n\tvar getContent = __webpack_require__(113);\n\t\n\tfunction showText(editor, el) {\n\t    var range = editor.selection.getRange(),\n\t\n\t    //是否存在选区collapsed   startContainer === endContainer && startOffset === endOffset \n\t    link = range.collapsed ? editor.queryCommandValue(\"link\") : editor.selection.getStart(),\n\t        url,\n\t        rangeLink = domUtils.findParentByTagName(range.getCommonAncestor(), 'a', true),\n\t        orgText;\n\t    link = domUtils.findParentByTagName(link, \"a\", true);\n\t\n\t    if (getContent(range).indexOf('gmp-ebox') != -1) {\n\t        return false;\n\t    }\n\t\n\t    editor.hoverEl = el;\n\t\n\t    //是否有href\n\t    if (link) {\n\t        url = utils.html(link.getAttribute('_href') || link.getAttribute('href', 2));\n\t        pop(editor, url, 1);\n\t    } else {\n\t        url = '';\n\t        pop(editor, url, 0);\n\t    }\n\t}\n\t\n\tmodule.exports = showText;\n\n/***/ }),\n/* 126 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar Dialog = __webpack_require__(37);\n\tvar inputTpl = __webpack_require__(127);\n\tvar dealLink = __webpack_require__(128);\n\t//var grepLocal = /( src=[\"'])https?:(\\/\\/.*?((meixincdn\\.com)|(((atguat)|(gomein))\\.net\\.cn)))/gi;\n\t\n\tvar domainReg = /((\\w+):\\/\\/)?([^/]+)/;\n\tvar grepLocal = /((\\.gome\\.com\\.cn)|(meixincdn\\.com)|(atguat.com.cn)|(((atguat)|(gomein))\\.net\\.cn))$/i;\n\t\n\tfunction pop(editor, url, num) {\n\t    var d = Dialog({\n\t        fixed: true,\n\t        title: '插入超链接',\n\t        modal: true,\n\t        width: 500,\n\t        content: inputTpl({ 'url': url }),\n\t        className: 'pop-box pop-links',\n\t        okValue: '插入',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        btnWrapCls: 'insert-cancel',\n\t        ok: function ok() {\n\t            var value = $('[data-node=\"link-value\"]').val();\n\t            if (value == '') {\n\t                $('[data-node=\"link-msg\"]').text('链接地址不能为空');\n\t                return false;\n\t            } else {\n\t                var arr = value.match(domainReg)[0];\n\t                if (grepLocal.test(arr)) {\n\t                    //if( true ){\n\t                    dealLink(editor, value, num);\n\t                } else {\n\t                    $('[data-node=\"link-msg\"]').text('不支持非gome站内链接地址，请重新输入');\n\t                    return false;\n\t                }\n\t            }\n\t        },\n\t        cancel: function cancel() {}\n\t    });\n\t\n\t    var $btn = $(d.node).find('.circle-pop-btn');\n\t\n\t    if (url == \"\") {\n\t        $btn.addClass('btn-default');\n\t    }\n\t\n\t    $('[data-node=\"link-value\"]').on(\"keyup\", function () {\n\t        var $this = $(this);\n\t        var value = $this.val();\n\t        if (value.length) {\n\t            var arr = value.match(domainReg)[0];\n\t            if (grepLocal.test(arr)) {\n\t                $btn.removeClass('btn-default');\n\t            } else {\n\t                $btn.addClass('btn-default');\n\t            }\n\t        }\n\t    });\n\t\n\t    d.show();\n\t}\n\t\n\tmodule.exports = pop;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 127 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/editor/plugin/link/input',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,url=$data.url,$out='';$out+='<div data-node=\"link-addr\" class=\"link-addr\"> <p class=\"pop-links clearfix\" data-node=\"pop-links\"> <span>链接地址:</span> <input type=\"text\" data-node=\"link-value\" placeholder=\"仅支持gome站内链接地址\" value=\"';\n\t$out+=$escape(url);\n\t$out+='\"/> </p> <p class=\"link-msg\" data-node=\"link-msg\"></p> </div>';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 128 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar domUtils = UE.dom.domUtils;\n\tvar utils = UE.utils;\n\t\n\tvar imgReplace = __webpack_require__(118);\n\t\n\tvar $linkValue = $('[data-node=linkValue]');\n\t\n\tfunction dealLink(editor, value, num) {\n\t\n\t    var range = editor.selection.getRange();\n\t    var collapsed = range.collapsed;\n\t    var reg = /^http/i;\n\t\n\t    //单独滑过图片要处理的js\n\t    if (editor.hoverEl) {\n\t        range.selectNode(editor.hoverEl);\n\t        editor.hoverEl = null;\n\t        collapsed = false;\n\t    }\n\t\n\t    if (!reg.test(value)) {\n\t        value = 'http://' + value;\n\t    }\n\t    if (num == 1) {\n\t        //有href\n\t\n\t        editor.execCommand('link', { href: value, target: '_blank' });\n\t    } else {\n\t        //无href\n\t\n\t        if (!collapsed) {\n\t            editor.execCommand('link', { href: value, target: '_blank' });\n\t        } else {\n\t            editor.execCommand('inserthtml', '<a href=\"' + value + '\" target=\"_blank\">' + value + '</a>');\n\t        }\n\t    }\n\t}\n\t\n\tmodule.exports = dealLink;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 129 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * 插入商品\n\t * @author Fu Xiaochun\n\t */\n\t\n\tvar Pubsub = __webpack_require__(45);\n\tvar channel = __webpack_require__(100);\n\tvar empty = __webpack_require__(130);\n\tvar toast = __webpack_require__(44).init;\n\t\n\tvar dialog = __webpack_require__(131);\n\tvar goodsTpl = __webpack_require__(136);\n\t\n\tvar imgReplace = __webpack_require__(118);\n\t//var detectQr = require('../detectQr');\n\t//var maxLen = 9;\n\t\n\tvar from = $GLOBAL_CONFIG['from'];\n\tvar insertedGoods = {};\n\t\n\t//插入草稿 延迟2s执行\n\tif (from) {\n\t    setTimeout(function () {\n\t        insertedGoods = window.insertedGoods;\n\t    }, 2000);\n\t}\n\t\n\tUE.registerUI('insertgoods', function (editor, uiName) {\n\t\n\t    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n\t    editor.registerCommand(uiName, {\n\t        execCommand: function execCommand() {\n\t            var $content = $(editor.body);\n\t            var $goodsDoms = $content.find('[data-type=insertGoods]');\n\t            var goodsLen = $goodsDoms.length;\n\t            var goodsData = {};\n\t\n\t            if (goodsLen) {\n\t                if (empty(insertedGoods)) {\n\t                    goodsData = $goodsDoms.data('goodsinfo');\n\t                    insertedGoods[goodsData.skuId] = goodsData;\n\t                } else {\n\t                    $.each(insertedGoods, function (k) {\n\t                        var len = $content.find('[data-skuId=' + k + ']').length;\n\t                        if (!len) {\n\t                            delete insertedGoods[k];\n\t                        }\n\t                    });\n\t                }\n\t            } else {\n\t                insertedGoods = {};\n\t            }\n\t            dialog(insertedGoods, 9);\n\t        }\n\t    });\n\t\n\t    // 插入后激活光标\n\t    editor.addListener('afterinserthtml', function () {\n\t        editor.focus();\n\t    });\n\t\n\t    // 接收商品\n\t    Pubsub(channel.setPubliser.changedItem).sub(function (data) {\n\t        var range = editor.selection.getRange();\n\t        var DomArr = editor.selection.getStartElementPath();\n\t        var startDom = DomArr[DomArr.length - 2];\n\t        var creatNewP = 0;\n\t        var nextNode = startDom.nextElementSibling;\n\t        if (startDom.nodeName == \"OL\" || startDom.nodeName == \"UL\") {\n\t            toast('列表状态下不能插入商品', {\n\t                duration: 2000\n\t            });\n\t            return false;\n\t        }\n\t\n\t        if (nextNode && nextNode.nodeName == 'DIV') {\n\t            creatNewP = 1;\n\t        }\n\t\n\t        insertedGoods = $.extend(true, {}, data);\n\t        var $content = $(editor.body);\n\t        var $goodsCards = $content.find('[data-type=insertGoods]');\n\t        $.each($goodsCards, function (i, e) {\n\t            var skuId = $(e).data('skuid');\n\t            var $eParent = $(e).parent('div');\n\t            var $preDom = $eParent.prev('p');\n\t            var preDomTxt = $.trim($preDom.text());\n\t            if (typeof data[skuId] === 'undefined') {\n\t                $content.find('[data-skuId=' + skuId + ']').parent().remove();\n\t            }\n\t        });\n\t        $.each(data, function (k) {\n\t            var $goodsCard = $content.find('[data-skuId=' + k + ']');\n\t            if ($goodsCard.length) {\n\t                delete data[k];\n\t            }\n\t        });\n\t\n\t        var goodsHTML = goodsTpl({\n\t            list: data\n\t        });\n\t        editor.focus();\n\t\n\t        if (creatNewP) {\n\t            goodsHTML = $.trim(goodsHTML) + '<p>&#8203<br/></p>'; //编辑器bug 必须用trim\n\t        }\n\t        goodsHTML = imgReplace.imgReplace(goodsHTML);\n\t        editor.execCommand('insertgoodshtml', goodsHTML, true);\n\t\n\t        setTimeout(function () {\n\t            var $body = $(editor.body); //节点已经变化，重新获取\n\t            var $el = $body.find('[data-node=\"gmp-ebox\"]').last();\n\t            var $li = $el.parent('li');\n\t            var $parent = $li.parent();\n\t            var $next = $parent.next();\n\t            if (!$next.length) {\n\t                $parent.append(\"<li><p>&#8203<p></li>\");\n\t                editor.focus();\n\t            }\n\t        }, 200);\n\t    });\n\t\n\t    //创建一个button\n\t    var btn = new UE.ui.Button({\n\t        name: 'insertgoods',\n\t        title: '插入商品',\n\t        label: '',\n\t        iconEle: '<em class=\"insert-merchant iconn-29\"></em>',\n\t        cssRules: '',\n\t        onclick: function onclick() {\n\t            editor.execCommand(uiName);\n\t        }\n\t    });\n\t\n\t    //因为你是添加button,所以需要返回这个button\n\t    return btn;\n\t}, 0);\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 130 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\t/**\n\t * [判断Object是否为空]\n\t * @Author: Fu Xiaochun\n\t * @Email: \tfuzhengchun@gomeplus.com\n\t */\n\tmodule.exports = function (o) {\n\t  for (var k in o) {\n\t    return false;\n\t  }\n\t  return true;\n\t};\n\n/***/ }),\n/* 131 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar dialog = __webpack_require__(132);\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar Pubsub = __webpack_require__(45);\n\tvar tpl = __webpack_require__(133);\n\tvar itemlist = __webpack_require__(134);\n\tvar defaultItemlist = __webpack_require__(135);\n\tvar pubName = __webpack_require__(100);\n\tvar indexof = __webpack_require__(4);\n\tvar alert = __webpack_require__(36);\n\t\n\tvar pageNum = 1;\n\tvar maxlength = 9;\n\tvar isDefault = true;\n\tvar keyWord = '';\n\tvar changedList = [];\n\tvar isGetMore = false;\n\tvar options = {};\n\tvar degree = 1;\n\t// var delChanged = [];\n\tvar addDialog;\n\t\n\tvar $searchTop = null,\n\t    $searchInput = null,\n\t    $searchBtn = null,\n\t    $searchNormal = null,\n\t    $searchLoading = null,\n\t    $searchFail = null,\n\t    $searchResult = null,\n\t    $searchList = null,\n\t\n\t// $searchPage = null,\n\t$changeNum = null,\n\t    $listBox = null,\n\t    $changeList = null,\n\t    $title = null,\n\t    $getMore = null,\n\t    $searchListBox = null;\n\t\n\tvar selectedGoods = {};\n\t\n\tvar init = function init(changedGoods, max /* 最多可选 */) {\n\t    var returnList = [];\n\t    selectedGoods = {};\n\t    // var selectedGoodsBak = {};\n\t    for (var i in changedGoods) {\n\t        changedList.push(i);\n\t        returnList.push(changedGoods[i]);\n\t    }\n\t\n\t    maxlength = max || 9;\n\t    selectedGoods = $.extend(true, selectedGoods, changedGoods);\n\t    if (maxlength - returnList.length !== 0) {\n\t        options = {\n\t            title: ' ',\n\t            modal: true,\n\t            fixed: true,\n\t            width: 712,\n\t            content: tpl({\n\t                imgSrc: $_CONFIG.imgpath,\n\t                returnList: returnList,\n\t                maxlength: maxlength,\n\t                changeNum: maxlength - returnList.length\n\t            }),\n\t            className: 'pop-box',\n\t            okValue: '插入商品',\n\t            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n\t            btnWrapCls: 'insert-cancel',\n\t            ok: function ok() {\n\t                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n\t                    return false;\n\t                }\n\t                Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n\t                dialogClosed();\n\t            },\n\t            cancel: function cancel() {\n\t                dialogClosed();\n\t            },\n\t            onshow: function onshow() {\n\t\n\t                $('[i=\"title\"]').hide();\n\t                getNode(); //获取节点\n\t                defaultItem(pageNum); //默认输出内容\n\t                searchItem(); //搜索商品\n\t                reGet(); //重新获取\n\t                changeItem(); //选择添加的商品\n\t                getMoreItem(); //加载 更多\n\t                $('body').css({\n\t                    height: '100%',\n\t                    overflowY: 'hidden'\n\t                });\n\t            }\n\t        };\n\t    } else {\n\t        options = {};\n\t    }\n\t\n\t    addDialog = dialog.create(options);\n\t    setTimeout(function () {\n\t        addDialog.show();\n\t    }, 100);\n\t};\n\t//获取节点\n\tvar getNode = function getNode() {\n\t    $searchTop = $('[data-node=\"addTopBox\"]');\n\t    $searchInput = $searchTop.find('[data-action=\"addSearchInput\"]');\n\t    $searchBtn = $searchTop.find('[data-action=\"addSearchBtn\"]');\n\t    $searchNormal = $('[data-node=\"searchNormal\"]');\n\t    $searchLoading = $('[data-node=\"searchLoading\"]');\n\t    $searchFail = $('[data-node=\"searchFail\"]');\n\t    $searchResult = $('[data-node=\"searchResultBox\"]');\n\t    $searchList = $searchResult.find('[data-node=\"searchResultList\"]');\n\t    $listBox = $searchResult.find('[data-node=\"changedBox\"]');\n\t    $changeList = $listBox.find('[data-node=\"searchChangeList\"]');\n\t    $changeNum = $searchResult.find('[data-node=\"searchChangeNum\"]');\n\t    $title = $('[data-node=\"title\"]'), $getMore = $searchResult.find('[data-action=\"moreItem\"]');\n\t    $searchListBox = $searchList.parent();\n\t};\n\t\n\t//初始化进弹窗获取数据\n\tvar defaultItem = function defaultItem(pageNum) {\n\t    getItems(url.get('getCollectItem'), {\n\t        data: {\n\t            page: pageNum,\n\t            pagesize: 10\n\t        },\n\t        done: function done(result) {\n\t            var html = defaultItemlist({\n\t                itemlist: result.data.items,\n\t                changedList: changedList,\n\t                indexof: indexof\n\t            });\n\t            if (pageNum === 1) {\n\t                $searchList.html(html);\n\t            } else {\n\t                $searchList.append(html);\n\t            }\n\t        }\n\t    });\n\t};\n\t\n\t//搜索 商品\n\tvar searchItem = function searchItem() {\n\t    $searchInput.on('keyup', function (e) {\n\t        var keycode = e.which;\n\t        isDefault = false;\n\t        isGetMore = false;\n\t        keyWord = $.trim($(this).val());\n\t        //处理回车的情况\n\t        if (keycode === 13) {\n\t            if (keyWord !== '') {\n\t                if (keyWord.length < 2) {\n\t                    alert('请输入两个字符以上关键词');\n\t                } else {\n\t                    pageNum = 1;\n\t                    $title.hide();\n\t                    $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n\t                    moreItem(pageNum, keyWord);\n\t                }\n\t            } else {\n\t                alert('请输入关键词');\n\t            }\n\t        }\n\t        //返回我收藏的商品列表\n\t        if (keyWord === '') {\n\t            $searchResult.children().eq(0).hide();\n\t            isDefault = true;\n\t            pageNum = 1;\n\t            $title.show();\n\t            defaultItem(pageNum); //默认输出内容\n\t        }\n\t    });\n\t    $searchBtn.on('click', function () {\n\t        isDefault = false;\n\t        isGetMore = false;\n\t        keyWord = $.trim($(this).prev().val());\n\t\n\t        if (keyWord !== '') {\n\t            if (keyWord.length < 2) {\n\t                alert('请输入两个字符以上关键词');\n\t            } else {\n\t                $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n\t                pageNum = 1;\n\t                $title.hide();\n\t                moreItem(pageNum, keyWord);\n\t            }\n\t        } else {\n\t            alert('请输入关键词');\n\t        }\n\t    });\n\t};\n\t\n\t//获取更多商品\n\t\n\tvar moreItem = function moreItem(pageNum, txt) {\n\t    getItems(url.get('getMoreItem'), {\n\t        data: {\n\t            pagenum: pageNum,\n\t            pagesize: 10,\n\t            word: txt\n\t        },\n\t        done: function done(result) {\n\t            var html = itemlist({\n\t                itemlist: result.data.items,\n\t                changedList: changedList,\n\t                indexof: indexof\n\t            });\n\t            if (result.pageCount != \"1\") {\n\t                $getMore.hide();\n\t            }\n\t            if (pageNum === 1) {\n\t                $searchList.html(html);\n\t            } else {\n\t                $searchList.append(html);\n\t            }\n\t        }\n\t    });\n\t};\n\t\n\t//ajax\n\tvar getItems = function getItems(link, options) {\n\t    if (pageNum === 1) {\n\t        $searchList.hide();\n\t        $searchFail.hide();\n\t        $searchLoading.show();\n\t        $searchNormal.hide();\n\t    } else {\n\t        $getMore.show();\n\t    }\n\t    fetch.get(link, {\n\t        data: options.data\n\t    }).done(function (result) {\n\t\n\t        if (result.code === 200) {\n\t            var resultItem = result.data.collections === undefined ? result.data.items : result.data.collections;\n\t            if ((!resultItem || resultItem.length === 0) && isDefault) {\n\t                if (pageNum === 1) {\n\t                    $searchNormal.show().text('暂无收藏的商品，可以搜索查找！');\n\t                } else {\n\t                    $getMore.show().find('span').text('没有可加载内容');\n\t                }\n\t            } else if (!resultItem || resultItem.length === 0) {\n\t                if (pageNum === 1) {\n\t                    $searchNormal.show().text('没有找到相关产品');\n\t                    $searchResult.children().eq(0).hide();\n\t                } else {\n\t                    $getMore.show().find('span').text('没有可加载内容');\n\t                }\n\t            } else {\n\t                $searchResult.show().children().eq(0).show();\n\t                $searchList.show();\n\t                options.done.call(this, result);\n\t                $getMore.hide();\n\t                isGetMore = false;\n\t\n\t                if (resultItem.length < 10 && pageNum !== 1) {\n\t\n\t                    isGetMore = true;\n\t                    $getMore.show().find('span').text('没有可加载内容');\n\t                }\n\t            }\n\t\n\t            // 重新定位弹窗位置\n\t            // addDialog.reset();\n\t        } else if (result.code === 881001) {\n\t            if (pageNum === 1) {\n\t                $searchNormal.show().text('没有找到相关产品');\n\t                $searchResult.children().eq(0).hide();\n\t            } else {\n\t                $getMore.show().find('span').text('没有可加载内容');\n\t            }\n\t        } else {\n\t            if (pageNum === 1) {\n\t                $searchFail.show();\n\t            } else {\n\t                $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n\t            }\n\t        }\n\t    }).fail(function () {\n\t        if (pageNum === 1) {\n\t            $searchFail.show();\n\t        } else {\n\t            $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n\t        }\n\t    }).always(function () {\n\t        $searchLoading.hide();\n\t    });\n\t};\n\t\n\t//重新获取\n\tvar reGet = function reGet() {\n\t    $searchFail.on('click', function () {\n\t        if (pageNum === 1) {\n\t            $searchLoading.show();\n\t            $searchFail.hide();\n\t            if (isDefault) {\n\t                defaultItem(pageNum);\n\t            } else {\n\t                moreItem(pageNum, keyWord);\n\t            }\n\t        }\n\t    });\n\t    $getMore.on('click', '[node-action=\"reget\"]', function () {\n\t        $(this).parent().html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n\t        if (isDefault) {\n\t            defaultItem(pageNum);\n\t        } else {\n\t            moreItem(pageNum, keyWord);\n\t        }\n\t    });\n\t};\n\t\n\tvar changeItem = function changeItem() {\n\t    if ($changeList.children().length) {\n\t        $('[i-id=ok]').removeClass('btn-default');\n\t    }\n\t    $searchResult.on('click', '[data-action=\"item\"]', function () {\n\t        var $this = $(this);\n\t        var imgSrc = $this.find('img').attr('src'),\n\t            pId = $this.attr('data-pId'),\n\t            shopId = $this.attr('data-shopid'),\n\t            itemLink = $this.attr('data-link'),\n\t            skuId = $this.attr('data-skuId'),\n\t            html = '';\n\t        if (maxlength == 1) {\n\t            if ($changeList.children().length) {\n\t                $changeList.empty();\n\t                $searchList.children(\"dl\").removeClass(\"chosed-mer-true\");\n\t            }\n\t            $this.addClass(\"chosed-mer-true\");\n\t\n\t            if ($changeList.children().length === 0) {\n\t                $listBox.show();\n\t            }\n\t            selectedGoods = {};\n\t            selectedGoods[skuId] = {\n\t                shopId: shopId,\n\t                skuId: skuId,\n\t                PId: pId,\n\t                title: $(this).find('[node-data=\"itemTitle\"]').text(),\n\t                img: imgSrc,\n\t                price: $(this).find('[node-data=\"itemPrice\"]').text(),\n\t                // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n\t                // 融合后的新商品链接\n\t                link: itemLink\n\t                //rebate: $(this).attr('data-rebate')\n\t            };\n\t            html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\t\n\t            $changeList.append(html);\n\t            $changeNum.text(maxlength - $changeList.children().length);\n\t        } else {\n\t\n\t            if (!$(this).hasClass('chosed-mer-true')) {\n\t                if ($changeList.children().length >= maxlength) {\n\t                    alert('最多可选取' + maxlength + '个商品');\n\t                    return false;\n\t                }\n\t\n\t                changedList.push(skuId);\n\t                selectedGoods[skuId] = {\n\t                    shopId: shopId,\n\t                    skuId: skuId,\n\t                    PId: pId,\n\t                    title: $(this).find('[node-data=\"itemTitle\"]').text(),\n\t                    img: imgSrc,\n\t                    price: $(this).find('[node-data=\"itemPrice\"]').text(),\n\t                    // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n\t                    // 融合后的新商品链接\n\t                    link: $(this).attr('data-link')\n\t                    //rebate: $(this).attr('data-rebate')\n\t                };\n\t                $(this).addClass('chosed-mer-true');\n\t                html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\t                if ($changeList.children().length === 0) {\n\t                    $listBox.show();\n\t                }\n\t                $changeList.append(html);\n\t                $changeNum.text(maxlength - $changeList.children().length);\n\t            } else {\n\t                var del = $changeList.find('[data-skuId=\"' + skuId + '\"]');\n\t                $(this).removeClass('chosed-mer-true');\n\t                del.remove();\n\t\n\t                var id = $(this).attr('data-skuId');\n\t                var index = changedList.indexOf(id);\n\t                if (index !== -1) {\n\t                    changedList.splice(index, 1);\n\t                }\n\t                delete selectedGoods[id];\n\t                if ($changeList.children().length === 0) {\n\t                    $listBox.hide();\n\t                }\n\t                $changeNum.text(maxlength - $changeList.children().length);\n\t            }\n\t        }\n\t\n\t        if ($changeList.children().length) {\n\t            $('[i-id=ok]').removeClass('btn-default');\n\t        } else {\n\t            $('[i-id=ok]').addClass('btn-default');\n\t        }\n\t\n\t        addDialog.reset();\n\t    }).on('click', '[data-action=\"delChanged\"]', function () {\n\t        var id = $(this).closest('li').attr('data-skuId');\n\t        var index = changedList.indexOf(id);\n\t        if (index !== -1) {\n\t            changedList.splice(index, 1);\n\t        }\n\t        var _this = this;\n\t        $searchList.find('[data-skuId=\"' + $(_this).parent().attr('data-skuId') + '\"]').removeClass('chosed-mer-true');\n\t\n\t        $(_this).parents('li').remove();\n\t        delete selectedGoods[id];\n\t        if ($changeList.children().length === 0) {\n\t            $listBox.hide();\n\t        }\n\t        $changeNum.text(maxlength - $changeList.children().length);\n\t        if (!$changeList.children().length) {\n\t            $('[i-id=ok]').addClass('btn-default');\n\t        }\n\t    });\n\t};\n\t\n\t//加载更多\n\tvar getMoreItem = function getMoreItem() {\n\t    $searchListBox.on('scroll', function () {\n\t        if (!isGetMore && $searchListBox.scrollTop() >= $searchList.height() - $searchListBox.height()) {\n\t            isGetMore = true;\n\t            pageNum++;\n\t            if (isDefault) {\n\t                defaultItem(pageNum);\n\t            } else {\n\t                moreItem(pageNum, keyWord);\n\t            }\n\t        }\n\t    });\n\t};\n\t\n\t//弹窗关闭\n\tvar dialogClosed = function dialogClosed() {\n\t    degree++;\n\t    $('body').css({\n\t        height: 'auto',\n\t        overflowY: 'auto'\n\t    });\n\t\n\t    $searchListBox.off('scroll');\n\t    $searchResult.off('click');\n\t    $searchFail.off('click');\n\t    $searchInput.off('keyup');\n\t    $searchBtn.off('click');\n\t    pageNum = 1;\n\t    // delChanged = [];\n\t    isDefault = true;\n\t    keyWord = '';\n\t    isGetMore = false;\n\t    changedList = [];\n\t};\n\t\n\tmodule.exports = init;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 132 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar Dialog = __webpack_require__(37);\n\t\n\tvar create = function create(options) {\n\t    options = options || {};\n\t    var defaults = {\n\t        title: ' ',\n\t        modal: true,\n\t        fixed: true,\n\t        width: 350,\n\t        content: '<p class=\"del-pop-p\">您最多能添加9个商品哦！</p>',\n\t        className: 'pop-box',\n\t        okValue: '确定',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        ok: function ok() {},\n\t        onshow: function onshow() {\n\t            $('[i=\"title\"]').hide();\n\t        }\n\t    };\n\t    $.extend(true, defaults, options);\n\t    return Dialog(defaults);\n\t};\n\t\n\tmodule.exports = {\n\t    create: create\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 133 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/addGoods/content',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgSrc=$data.imgSrc,returnList=$data.returnList,$each=$utils.$each,$value=$data.$value,$index=$data.$index,changeNum=$data.changeNum,maxlength=$data.maxlength,$out='';$out+=' <div class=\"search-box\" data-node=\"addTopBox\"> <input type=\"text\" placeholder=\"搜索商品\" data-action=\"addSearchInput\"> <em class=\"icon-search-sw\" data-action=\"addSearchBtn\"></em> </div> <div class=\"ui-dialog-title\" data-node=\"title\">我收藏的商品</div> <p class=\"no-saving-txt\" style=\"display:none;\" data-node=\"searchNormal\">暂无收藏的商品，可以搜索查找！</p> <div class=\"loading\" data-node=\"searchLoading\"><img src=\"';\n\t$out+=$escape(imgSrc);\n\t$out+='/images/public/loading.gif\" alt=\"\"></div> <p class=\"failed-txt\" style=\"display:none;\" data-node=\"searchFail\">数据获取失败，点击重新加载！</p> <div style=\"display:';\n\t$out+=$escape((returnList.length === 0 ? 'none':''));\n\t$out+=';\" data-node=\"searchResultBox\"> <div class=\"merchant-list clearfix\" > <div class=\"clearfix\" data-node=\"searchResultList\"></div> <div class=\"more-comments pop-more-com\" data-action=\"moreItem\" style=\"display:none;\"> <span><img src=\"';\n\t$out+=$escape(imgSrc);\n\t$out+='/images/public/loading.gif\">正在加载...</span> </div> </div> <div class=\"chosed-merchants\" data-node=\"changedBox\" style=\"display:';\n\t$out+=$escape((returnList.length>0?'':'none'));\n\t$out+='\"> <ul class=\"merchants-list clearfix\" data-node=\"searchChangeList\"> ';\n\t$each(returnList,function($value,$index){\n\t$out+=' <li data-skuId=\"';\n\t$out+=$escape($value.skuId);\n\t$out+='\" data-pid=\"';\n\t$out+=$escape($value.PId);\n\t$out+='\"> <img src=\"';\n\t$out+=$escape($value.img);\n\t$out+='\" alt=\"\" onerror=\"imgError(this)\"> <a href=\"javascript:;\" data-action=\"delChanged\"> <em class=\"icon-del-pic\"></em> </a> </li> ';\n\t});\n\t$out+=' </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"searchChangeNum\">';\n\t$out+=$escape(changeNum);\n\t$out+='</span>/<span class=\"deep-gray\">';\n\t$out+=$escape(maxlength);\n\t$out+='</span>个商品</div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 134 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/addGoods/itemContent',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$string=$utils.$string,$out='';$each(itemlist,function($value,$index){\n\t$out+=' <dl class=\"merchant-item clearfix ';\n\t$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n\t$out+='\" data-action=\"item\" data-pId=\"';\n\t$out+=$escape($value.pId);\n\t$out+='\" data-link=\"';\n\t$out+=$escape($value.sUrl);\n\t$out+='\" data-skuId=\"';\n\t$out+=$escape($value.skuId);\n\t$out+='\" > <dt><img src=';\n\t$out+=$escape($value.mainImage);\n\t$out+=' alt=\"11111\" onerror=\"imgError(this)\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n\t$out+=$string($value.name);\n\t$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n\t$out+=$escape($value.salePrice !== null?$value.salePrice:'暂无售价');\n\t$out+='</span></span> <!-- ';\n\tif($value.rebateMoney > 0){\n\t$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n\t$out+=$escape($value.rebateMoney);\n\t$out+='国美币</span> </div> ';\n\t}\n\t$out+=' --> </dd> </dl> ';\n\t});\n\t$out+=' ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 135 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/addGoods/defaultItemContent',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$out='';$each(itemlist,function($value,$index){\n\t$out+=' <dl class=\"merchant-item clearfix ';\n\t$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n\t$out+='\" data-action=\"item\" data-pId=\"';\n\t$out+=$escape($value.pId);\n\t$out+='\" data-shopId=\"';\n\t$out+=$escape($value.shopId);\n\t$out+='\" data-link=\"';\n\t$out+=$escape($value.sUrl);\n\t$out+='\" data-skuId=\"';\n\t$out+=$escape($value.skuId);\n\t$out+='\" > <dt><img src=';\n\t$out+=$escape($value.mainImage);\n\t$out+=' alt=\"\" onerror=\"imgError(this,\\'m\\')\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n\t$out+=$escape($value.name);\n\t$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n\t$out+=$escape($value.skuPrice);\n\t$out+='</span></span> <!-- ';\n\tif($value.rebate > 0){\n\t$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n\t$out+=$escape($value.rebate);\n\t$out+='国美币</span> </div> ';\n\t}\n\t$out+=' --> </dd> </dl> ';\n\t});\n\t$out+=' ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 136 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/editor/plugin/goods/goods',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,$escape=$utils.$escape,$out='';$each(list,function(v,i){\n\t$out+='<p>&#8203<br></p><div data-node=\"gmp-ebox\" class=\"card-box\" contenteditable=\"false\"> <div data-type=\"insertGoods\" data-skuId=\"';\n\t$out+=$escape(v.skuId);\n\t$out+='\" data-pid=\"';\n\t$out+=$escape(v.PId);\n\t$out+='\" data-info=\\'{\"type\":\"item\",\"text\":\"\",\"id\":\"';\n\t$out+=$escape(v.PId);\n\t$out+='\",\"kid\":\"\", \"shopId\": \"';\n\t$out+=$escape(v.shopId);\n\t$out+='\",\"skuId\":\"';\n\t$out+=$escape(v.skuId);\n\t$out+='\"}\\' class=\"publish-item\"> <a href=\"';\n\t$out+=$escape(v.link);\n\t$out+='\" class=\"img-out\"> <img src=\"';\n\t$out+=$escape(v.img);\n\t$out+='\" data-node=\"goodsPic\"> </a> <div class=\"publish-cont\"> <h3 class=\"pub-tl\"> <a href=\"';\n\t$out+=$escape(v.link);\n\t$out+='\">';\n\t$out+=$escape(v.title);\n\t$out+='</a> </h3> <div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">';\n\t$out+=$escape(v.price);\n\t$out+='</strong> </div> <!-- ';\n\tif(v.rebate){\n\t$out+=' <div class=\"pub-row\"> <div class=\"fan\"> <em class=\"icon-fan\"></em> <span>最高返';\n\t$out+=$escape(v.rebate);\n\t$out+='国美币</span> </div> </div> ';\n\t}\n\t$out+=' --> <a href=\"';\n\t$out+=$escape(v.link);\n\t$out+='\" target=\"_blank\" class=\"scan-more\">查看详情</a> </div></div><div class=\"cover\">&nbsp;</div></div>';\n\t});\n\t$out+=' ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 137 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/**\n\t * 插入链接\n\t * @author Lin Fei\n\t */\n\t\n\tvar showText = __webpack_require__(125);\n\t\n\tUE.registerUI('insertlink', function (editor, uiName) {\n\t\n\t    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n\t    editor.registerCommand(uiName, {\n\t        execCommand: function execCommand() {\n\t            showText(editor);\n\t        }\n\t    });\n\t\n\t    //创建一个button\n\t    var btn = new UE.ui.Button({\n\t        name: 'insertlink',\n\t        title: '插入链接',\n\t        label: '',\n\t        iconEle: '<em class=\"insert-merchant iconn-29\"></em>',\n\t        cssRules: '',\n\t        onclick: function onclick() {\n\t            editor.execCommand(uiName);\n\t        }\n\t    });\n\t\n\t    //因为你是添加button,所以需要返回这个button\n\t    return btn;\n\t}, 13);\n\n/***/ }),\n/* 138 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * @description\n\t * 处理不能正常删除图片\n\t *\n\t * @author 林飞\n\t */\n\t\n\tvar browser = baidu.editor.browser;\n\tvar gecko = browser.gecko ? browser.version : 0;\n\t\n\tUE.plugin.register('delImg', function () {\n\t    var me = this;\n\t    var domUtils = UE.dom.domUtils;\n\t    if (browser.version > 10 && !gecko) return; //ie10 以及chrome 不用处理\n\t    //设置光标位置\n\t    var setCursor = function setCursor(range, newNode, position) {\n\t\n\t        range.setStart(newNode);\n\t        if (position) {\n\t            range.setEnd(newNode, position);\n\t        } else {\n\t            range.setEnd(newNode, 0);\n\t        }\n\t\n\t        range.setCursor(true);\n\t    };\n\t    //删除节点\n\t    var deleteNode = function deleteNode(node, evt) {\n\t        node.remove();\n\t        domUtils.preventDefault(evt);\n\t    };\n\t\n\t    //创建新行\n\t    var creatNewP = function creatNewP(range, parent) {\n\t        var node = node;\n\t        var doc = me.document;\n\t\n\t        var newNode = doc.createElement('p');\n\t        var textNode = doc.createTextNode(\"\");\n\t        newNode.appendChild(textNode);\n\t\n\t        //插入当前节点前还是后\n\t        if (range.startOffset == 0) {\n\t            me.body.insertBefore(newNode, parent);\n\t        } else {\n\t            domUtils.insertAfter(parent, newNode);\n\t        }\n\t\n\t        setCursor(range, newNode);\n\t    };\n\t\n\t    me.addListener('keydown', function (evtName, evt) {\n\t        var keyCode = evt.keyCode || evt.which;\n\t        var range = me.selection.getRange();\n\t        var startContainer = range.startContainer;\n\t\n\t        var nodeName = startContainer.nodeName.toUpperCase();\n\t        var startOffset = range.startOffset;\n\t        var endOffset = range.endOffset;\n\t        var closedNode = range.getClosedNode();\n\t\n\t        var detectKey = function detectKey() {\n\t            switch (keyCode) {\n\t                case 8:\n\t                    backspaceKey();\n\t                    break;\n\t                case 46:\n\t                    deleteKey();\n\t                    break;\n\t                default:\n\t                    defaultKey();\n\t                    break;\n\t            }\n\t        };\n\t\n\t        //删除键\n\t        var backspaceKey = function backspaceKey() {\n\t            if (startOffset == 0) {\n\t                //P的情况有以下几种：包括了 标题 h1,h2,h3\n\t                //1.1 当前为<p>|</p>或(<p><img></p>), 上一级为<p><img></p> 要删除上一级，否则会和下一级合并\n\t                //1.2 当前为<p><img></p>,上级为div 或者文本\n\t                //1.3 当前为<p>|</p> 上一级为div 或者文本\n\t                if (nodeName == \"#TEXT\") {\n\t                    var parentNode = startContainer.parentNode;\n\t\n\t                    var prev = parentNode.previousSibling;\n\t                    var $prev = $(prev);\n\t                    // console.log($prev.find(\"img\").length)\n\t                    if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n\t                        deleteNode($prev, evt);\n\t                    }\n\t                } else {\n\t                    var prev = startContainer.previousSibling;\n\t                    var $prev = $(prev);\n\t                    if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n\t                        deleteNode($prev, evt);\n\t                    }\n\t                }\n\t                /*\n\t                                    if (nodeName == \"P\") {\n\t                                        var prev = startContainer.previousSibling;\n\t                                        var $prev = $(prev);\n\t                                        //第一种情况\n\t                                        if ($(startContainer).find(\"img\").length) {\n\t                                            //1.1\n\t                                            if ($prev.find(\"img\").length) {\n\t                                                 deleteNode($prev, evt);\n\t                                            } else {\n\t                                                //1.2\n\t                                                //前一个节点不是光标或者空节点\n\t                                                if ($prev.text().replace(/[\\u200b]/gi, \"\") != \"\") {\n\t                                                    var last = prev.lastChild;\n\t                                                    //光标插入文本末端\n\t                                                    if (last.nodeName.toUpperCase() == \"#TEXT\") {\n\t                                                        var length = last.nodeValue.length;\n\t                                                        setCursor(range, last, length);\n\t                                                    } else if (last.nodeName.toUpperCase() == \"BR\") {\n\t                                                        //UE.dom.domUtils.remove( last, false );\n\t                                                        deleteNode($(last), false)\n\t                                                        domUtils.preventDefault(evt);\n\t                                                    }\n\t                                                }\n\t                                            }\n\t                                            //第二种情况\n\t                                        } else if ($prev.find(\"img\").length) {\n\t                                            deleteNode($prev, evt);\n\t                                        }\n\t                                    }*/\n\t\n\t                /* if (nodeName == \"#TEXT\") {\n\t                     var parentNode = startContainer.parentNode;\n\t                     var prev = parentNode.previousSibling;\n\t                     var $prev = $(prev);\n\t                     console.log($prev.find(\"img\").length)\n\t                     if ($prev.find(\"img\").length) {\n\t                         deleteNode($prev, evt);\n\t                     }\n\t                 }*/\n\t            }\n\t        };\n\t        // 往后删除键 恶心的玩意 害死人啊。。。\n\t        var deleteKey = function deleteKey() {\n\t            if (startOffset != 0) return false;\n\t\n\t            if (nodeName == \"#TEXT\") {\n\t                var parentNode = startContainer.parentNode;\n\t\n\t                var prev = parentNode.previousSibling;\n\t                var $prev = $(prev);\n\t                // console.log($prev.find(\"img\").length)\n\t                console.log($prev && $prev.attr('data-node'));\n\t                if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n\t                    if ($prev.find('.cover').hasClass('show')) {\n\t                        deleteNode($prev, evt);\n\t                    }\n\t                }\n\t            } else {\n\t                var prev = startContainer.previousSibling;\n\t                var $prev = $(prev);\n\t                if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n\t                    if ($prev.find('.cover').hasClass('show')) {\n\t                        deleteNode($prev, evt);\n\t                    }\n\t                }\n\t            }\n\t            /* switch (nodeName) {\n\t                 //在<p><img>|</p>\n\t                 case \"P\":\n\t                     if ($(startContainer).find(\"img\").length && startOffset != 0) {\n\t                         if (startContainer.nextSibling) {\n\t                             setCursor(range, startContainer.nextSibling)\n\t                         }\n\t                     }\n\t                     break;\n\t                     //<p><img>光标|</p> 或者<p>xxxx<p>\n\t                 case \"#TEXT\":\n\t                     var parent = startContainer.parentNode;\n\t                     var $parent = $(parent);\n\t                     if ($parent.find(\"img\").length) {\n\t                         deleteNode($parent, evt)\n\t                     } else if (parent.lastChild == startContainer) {\n\t                         if (startOffset == startContainer.nodeValue.length) {\n\t                             var $nextNode = $(parent).next();\n\t                             if ($nextNode.find(\"img\").length) {\n\t                                 deleteNode($nextNode, evt)\n\t                             }\n\t                         }\n\t                     }\n\t                     break;\n\t             }*/\n\t        };\n\t\n\t        var defaultKey = function defaultKey() {\n\t            if (closedNode && closedNode.tagName == \"IMG\") {\n\t                if (gecko) {\n\t                    //禁止火狐选中图片 用键盘字符替换造成标签溢出\n\t                    domUtils.preventDefault(evt);\n\t                } else {\n\t                    domUtils.remove(closedNode.parentNode, false);\n\t                }\n\t            } else if (nodeName == \"P\") {\n\t                if ($(startContainer).find(\"img\").length != 0) {\n\t                    creatNewP(range, startContainer);\n\t                }\n\t            } else if ($(startContainer).parent().find(\"img\").length != 0) {\n\t                var prentsNode = startContainer.parentNode;\n\t                creatNewP(range, prentsNode);\n\t            }\n\t        };\n\t\n\t        if (evt.ctrlKey || keyCode == 37 || keyCode == 38 || keyCode == 39 || keyCode == 40) {} else {\n\t            detectKey();\n\t        }\n\t\n\t        window.imageTransformPopup.hide();\n\t    });\n\t});\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 139 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar grepHtml = __webpack_require__(140);\n\tvar pastedCheckImg = __webpack_require__(141);\n\t/**\n\t * @description\n\t * 过滤粘贴进来的文本\n\t *\n\t * @author linfei\n\t */\n\tUE.plugin.register('grepPaste', function (e) {\n\t\n\t    var me = this;\n\t    var domUtils = UE.dom.domUtils;\n\t    me.addListener('beforepaste', function (type, html) {\n\t        html.html = grepHtml(me, html.html);\n\t        if (html.html.indexOf('src') !== -1) {\n\t            pastedCheckImg(me);\n\t        }\n\t    });\n\t});\n\n/***/ }),\n/* 140 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar alert = __webpack_require__(36);\n\tvar config = __webpack_require__(122);\n\t//过滤回车特殊字符\n\tvar grepFormat = /[\\n]/gi;\n\t//匹配商品\n\tvar grepDiv = /<div (data-node=[\"']gmp-ebox.*?|class=[\"']publish-item.*?)<\\/div><\\/div>/gi;\n\t//匹配img\n\tvar grepImg = /<img.*?>/gi;\n\t//匹配src\n\tvar grepLocal = /( src=[\"'])https?:(\\/\\/.*?((meixincdn\\.com)|(((atguat)|(gomein))\\.net\\.cn)))/gi;\n\t//匹配表情\n\tvar grepFace = /data-face=['\"](.*?)['\"]/;\n\t\n\tfunction getHtml(html, num) {\n\t    var i = 0;\n\t    var overload = 0;\n\t\n\t    html = html.replace(grepImg, function (j) {\n\t        if (i < num) {\n\t            i++;\n\t            return j;\n\t        } else {\n\t            overload = 1;\n\t            return '';\n\t        }\n\t    });\n\t    return {\n\t        html: html,\n\t        overload: overload\n\t    };\n\t}\n\t\n\tfunction selectGetHtml(html, obj) {\n\t\n\t    var len = obj.len;\n\t\n\t    var innerImgLen = obj.innerImgLen; //粘贴板数量\n\t    var outerImgLen = obj.outerImgLen; //浏览器内数量\n\t    var limitNum = obj.limitNum; //限制数量\n\t    var maybe = innerImgLen + outerImgLen - limitNum;\n\t\n\t    return getHtml(html, limitNum - outerImgLen - len);\n\t}\n\t\n\tfunction grepHtml(editor, html) {\n\t    var me = editor;\n\t    var limitNum = config.imgLimitNUm;\n\t    var tempHtml = html;\n\t    //检测图片数量\n\t    function checkNum(str) {\n\t        var innerImg = str.match(grepImg),\n\t            innerImgLen = innerImg ? innerImg.length : 0; //粘贴板 图片数量\n\t\n\t        var outerImg = me.getContent().replace(grepDiv, '').match(grepImg),\n\t            outerImgLen = outerImg ? outerImg.length : 0; //编辑器区域 图片数量\n\t\n\t        var range = me.selection.getRange(),\n\t            startContainer = range.startContainer,\n\t            endContainer = range.endContainer,\n\t            startOffset = range.startOffset,\n\t            endOffset = range.endOffset;\n\t\n\t        var useAlert = innerImgLen + outerImgLen - limitNum;\n\t        if (useAlert >= 0) {\n\t            var case_1 = startContainer == endContainer && startOffset != endOffset;\n\t            var case_2 = startContainer != endContainer;\n\t            if (case_1 || case_2) {\n\t                var fragment = range.cloneContents(),\n\t                    node = document.createElement(\"div\");\n\t\n\t                node.appendChild(fragment);\n\t\n\t                var html = node.innerHTML;\n\t\n\t                var len = html.match(grepImg).length;\n\t                return selectGetHtml(tempHtml, {\n\t                    limitNum: limitNum,\n\t                    outerImgLen: outerImgLen,\n\t                    innerImgLen: innerImgLen,\n\t                    len: len\n\t                });\n\t            }\n\t            return getHtml(tempHtml, limitNum - outerImgLen);\n\t        }\n\t        return false;\n\t    }\n\t\n\t    var h = checkNum(tempHtml);\n\t\n\t    if (h) {\n\t        if (h.overload) {\n\t            if (!$(\".pop-box-backdrop\").length) {\n\t                alert('您最多能添加' + limitNum + '张图片哦！');\n\t                return h.html;\n\t            }\n\t        }\n\t    }\n\t    return tempHtml;\n\t}\n\t\n\tmodule.exports = grepHtml;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 141 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar imgPath = $GLOBAL_CONFIG['pcimgpath'];\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\t\n\tvar imgReplace = __webpack_require__(118);\n\t\n\t//var grepLocal = /^https?\\:\\/\\/(i|js).*?meixincdn\\.com/;\n\tvar grepLocal = /\\/\\/(((i|js).*?meixincdn\\.com)|.*?((atguat)|(gomein))\\.net\\.cn)/i;\n\tvar defaultImg = imgReplace.imgReplace(imgPath) + '/images/editor/spacer.jpg';\n\t\n\tvar setImgPath = function setImgPath(o, src, useDefault) {\n\t    if (useDefault) {\n\t        o.src = defaultImg;\n\t        o.setAttribute('_src', defaultImg);\n\t    } else {\n\t        if ((typeof src === 'undefined' ? 'undefined' : _typeof(src)) == 'object') {\n\t            src = src[0];\n\t        }\n\t        o.src = imgReplace.imgReplace(src);\n\t        o.setAttribute('_src', imgReplace.imgReplace(src));\n\t        o.setAttribute('proto', imgReplace.imgProto(src));\n\t    }\n\t};\n\tvar pastedCheckImg = function pastedCheckImg(ue) {\n\t    setTimeout(function () {\n\t        var $imgs = $(ue.body).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]');\n\t\n\t        var _loop = function _loop(i, len) {\n\t            var _img = $imgs[i];\n\t            var src = _img.src;\n\t            var _src = $(_img).attr('_src');\n\t            var test_src = grepLocal.test(_src) || grepLocal.test(src);\n\t\n\t            if (!test_src) {\n\t                fetch.post(url.get('topicUrlUpload2'), {\n\t                    data: {\n\t                        src: src\n\t                    }\n\t                }).done(function (data) {\n\t                    if (data.success == true) {\n\t                        var src = data.data;\n\t\n\t                        if (src.length) {\n\t                            setImgPath(_img, src);\n\t                        } else {\n\t                            setImgPath(_img, defaultImg, true);\n\t                        }\n\t                    } else {\n\t\n\t                        setImgPath(_img, defaultImg, true);\n\t                    }\n\t                }).fail(function () {\n\t                    setImgPath(_img, defaultImg, true);\n\t                }).always(function (data) {\n\t                    //firing = 0;\n\t                });\n\t            } else {\n\t                proto = $(_img).attr(\"proto\");\n\t                thisSrc = imgReplace.imgReplace(src);\n\t\n\t                if (!proto) {\n\t                    proto = imgReplace.imgProto(src);\n\t                    $(_img).attr({\n\t                        'src': thisSrc,\n\t                        '_src': thisSrc,\n\t                        'proto': proto\n\t                    });\n\t                    //.attr('_src', proto + thisSrc);\n\t                } else {\n\t                    $(_img).attr({\n\t                        'src': thisSrc,\n\t                        '_src': thisSrc\n\t                    });\n\t                }\n\t            }\n\t        };\n\t\n\t        for (var i = 0, len = $imgs.length; i < len; i++) {\n\t            var proto;\n\t            var thisSrc;\n\t\n\t            _loop(i, len);\n\t        }\n\t    }, 500);\n\t};\n\tmodule.exports = pastedCheckImg;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 142 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {\"use strict\";\n\t\n\t//var grepHtml = require('editor/rewrite/grepRule');\n\t/**\n\t * @description \n\t * 过滤拖拽进来的文本\n\t * \n\t * @author linfei\n\t */\n\t\n\tUE.plugin.register('grepDrop', function () {\n\t    var me = this;\n\t    var body = me.body;\n\t    var domUtils = UE.dom.domUtils;\n\t    var target = 0; //判断是否是当前页面做拖拽\n\t    var browser = baidu.editor.browser;\n\t    var ieVersion = browser.ie ? browser.version : 0;\n\t    var dropStr = \"\"; //专门用于ie 【drop】inserthtml 使用到\n\t    var tempRange = \"\"; //存放拽入的选区 \n\t    var dropToP = 0; //是否拖拽进入P标签\n\t\n\t    var grepRule = {\n\t\n\t        grepFormat: /[\\n]/gi,\n\t\n\t        grepCursor: /[\\u200b]/gi, //光标\n\t\n\t        grepImg: /(<img.*?>)/gi,\n\t\n\t        grepDiv: /<div class=[\"']card-box.*?i<\\/div><\\/div>/gi\n\t\n\t        //过滤html\n\t    };var grepHtml = function grepHtml(obj, isIe) {\n\t        return obj.replace(grepRule.grepFormat, '').replace(grepRule.grepDiv, '').replace(grepRule.grepCursor, '').replace(grepRule.grepImg, function (i, j, k, l) {\n\t\n\t            if (isIe) {\n\t                return '<p>' + i + '</p>';\n\t            } else {\n\t                return '<p>' + i.replace('>', 'class=\"block\">') + '</p>';\n\t            }\n\t        });\n\t    };\n\t\n\t    //创建新行\n\t    var creatNewP = function creatNewP(parent, node, position) {\n\t        var node = node;\n\t        var text = node.nodeValue;\n\t        var doc = me.document;\n\t\n\t        var newNode = doc.createElement('p');\n\t        var textNode = doc.createTextNode(text);\n\t        newNode.appendChild(textNode);\n\t        UE.dom.domUtils.remove(node, false);\n\t\n\t        //插入当前节点前还是后\n\t        if (position == 'before') {\n\t            me.body.insertBefore(newNode, parent);\n\t        } else {\n\t            domUtils.insertAfter(parent, newNode);\n\t        }\n\t    };\n\t    //渲染P标签\n\t    var renderP = function renderP(node) {\n\t        var childNodes = node.childNodes;\n\t        var len = childNodes.length;\n\t\n\t        var textOffset = -1;\n\t        var imgOffset = 0;\n\t\n\t        for (var j = 0; j < len; j++) {\n\t            var _node = childNodes[j];\n\t            if (_node.nodeName.toUpperCase() == \"#TEXT\") {\n\t                var value = _node.nodeValue.replace(grepRule.grepCursor, '').replace(\" \", '');\n\t                if (value) {\n\t                    textOffset = j;\n\t                }\n\t            }\n\t            if (_node.nodeName.toUpperCase() == \"IMG\") {\n\t                imgOffset = j;\n\t            }\n\t        }\n\t\n\t        //判断文本节点的位置\n\t        if (textOffset != -1) {\n\t            var oldTextNode = childNodes[textOffset];\n\t            var position = textOffset < imgOffset ? 'before' : 'after';\n\t\n\t            creatNewP(node, oldTextNode, position);\n\t        }\n\t    };\n\t\n\t    var renderBody = function renderBody() {\n\t\n\t        if (dropToP == 1) {\n\t            dropToP = 0;\n\t            return;\n\t        }\n\t\n\t        $body = $(me.body);\n\t        $body.find(\"img\").removeAttr(\"class\");\n\t        // 不能在P标签上加任何属性，会被过滤掉\n\t        var $imgs = $body.find(\"[data-type='insertImg']\");\n\t        var len = $imgs.length;\n\t        if (len) {\n\t            for (var i = 0; i < len; i++) {\n\t                var img = $imgs[i];\n\t                var imgPrent = img.parentNode;\n\t                renderP(imgPrent);\n\t            }\n\t        }\n\t        dropToP = 0;\n\t    };\n\t\n\t    return {\n\t        bindEvents: {\n\t            'ready': function ready() {\n\t\n\t                var _body = me.body;\n\t\n\t                //禁止商品拖拽\n\t                $(_body).delegate(\"div\", 'dragstart', function (e) {\n\t                    target = 0;\n\t                    domUtils.preventDefault(e);\n\t                });\n\t\n\t                $(_body).delegate(\"p\", 'drop', function (e) {\n\t\n\t                    var $this = $(this);\n\t                    var _this = this;\n\t                    setTimeout(function () {\n\t                        $(_body).find(\"img\").removeAttr(\"class\");\n\t                        if ($this.find(\"img\").length != 0) {\n\t                            renderP(_this);\n\t                        }\n\t                    }, 100);\n\t                    dropToP = 1;\n\t                });\n\t\n\t                domUtils.on(document, 'dragstart', function (evt) {\n\t                    target = 0;\n\t                });\n\t\n\t                domUtils.on(_body, 'dragstart', function (evt) {\n\t                    target = 1;\n\t\n\t                    //ie是插入内容，其他浏览器是修改drag的内容\n\t                    if (ieVersion > 7) {\n\t                        var range = me.selection.getRange();\n\t                        var fragment = range.cloneContents();\n\t                        var _node = document.createElement(\"div\");\n\t\n\t                        tempRange = range;\n\t\n\t                        _node.appendChild(fragment);\n\t                        dropStr = _node.innerHTML;\n\t                        dropStr = grepHtml(dropStr);\n\t                    } else {\n\t                        var dataTransfer = evt.dataTransfer;\n\t                        var data = dataTransfer.getData(\"text/html\");\n\t                        data = grepHtml(data, false);\n\t                        dataTransfer.setData(\"text/html\", data);\n\t                    }\n\t                });\n\t\n\t                domUtils.on(_body, 'drop', function (evt) {\n\t                    var range = me.selection.getRange();\n\t                    if (!target) {\n\t                        domUtils.preventDefault(evt);\n\t                    }\n\t\n\t                    if (ieVersion > 7) {\n\t                        //要清空选区  并且 阻止默认触发事件，\n\t                        //否则会变成复制内容，两者缺一不可，很奇葩。。\n\t                        if (tempRange) {\n\t                            tempRange.deleteContents();\n\t                        }\n\t                        me.execCommand(\"insertHtml\", dropStr);\n\t                        domUtils.preventDefault(evt);\n\t                    }\n\t\n\t                    setTimeout(function () {\n\t                        renderBody();\n\t                    }, 200);\n\t\n\t                    tempRange = \"\";\n\t                    target = 0;\n\t                    dropStr = \"\";\n\t                });\n\t            }\n\t        }\n\t    };\n\t});\n\t\n\t/*,备用\n\t commands:{\n\t    'haha': {\n\t        execCommand: function (cmd, str) {\n\t            //var range = me.selection.getRange();\n\t            //range.select();\n\t            //me.focus();\n\t            me.execCommand(\"insertHtml\",str,true);                   \n\t            //me.execCommand('anchor', 'anchor1')\n\t        }\n\t    }\n\t    \n\t}*/\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 143 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\n\t * @description \n\t * 处理firefox不能正常选中图片的bug\n\t * \n\t * @author 林飞\n\t */\n\t\n\tvar browser = baidu.editor.browser;\n\tvar gecko = browser.gecko ? browser.version : 0;\n\tvar ieversion = browser.ie ? browser.version : 0;\n\t\n\tvar setCursor = function setCursor(range, newNode) {\n\t    range.setStart(newNode);\n\t    range.setEnd(newNode, 0);\n\t    range.setCursor(true);\n\t};\n\t\n\tif (gecko) {\n\t\n\t    UE.plugin.register('selectImg', function () {\n\t        var me = this;\n\t        me.addListener('click', function (type, html) {\n\t            var range = me.selection.getRange(),\n\t                startContainer = range.startContainer,\n\t                nodeName = startContainer.nodeName;\n\t\n\t            if (nodeName == \"P\" && startContainer.innerHTML.indexOf('<img') != -1) {\n\t                range.selectNode(startContainer).select();\n\t            }\n\t        });\n\t    });\n\t}\n\n/***/ }),\n/* 144 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\n\t * 处理IE渲染延迟导致高度计算失误\n\t * \n\t * @林飞\n\t */\n\tUE.plugin.register('fixHeight', function () {\n\t  var me = this;\n\t  var browser = baidu.editor.browser;\n\t  var ieVersion = browser.ie ? browser.version : 0;\n\t\n\t  if (ieVersion > 7) {\n\t    me.addListener('afterinserthtml', function () {\n\t      setTimeout(function () {\n\t        me.body.style.height = \"auto\";\n\t      }, 500);\n\t    });\n\t  }\n\t});\n\n/***/ }),\n/* 145 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar alert = __webpack_require__(36);\n\tvar i18n = __webpack_require__(84);\n\tvar domUtils = UE.dom.domUtils;\n\tvar utils = UE.utils;\n\tvar $picLoading;\n\tvar firing = 0;\n\t\n\tvar config = __webpack_require__(122);\n\tvar imgReplace = __webpack_require__(118);\n\t\n\tvar limitNum = config.imgLimitNUm;\n\tvar maxSize = 4 * 1024 * 1024;\n\tvar fetchData = function fetchData(src, editor) {\n\t    fetch\n\t    //.get('img.json', {})\n\t    .post(url.get('topicBase64Upload'), {\n\t        data: {\n\t            src: src\n\t        },\n\t        beforeSend: function beforeSend() {\n\t            if (!$picLoading) {\n\t                $picLoading = $('[data-node=\"picLoading\"]');\n\t            }\n\t            $picLoading.removeClass('hide');\n\t        }\n\t    }).done(function (data) {\n\t        if (data.success == true) {\n\t            var datas = data.data;\n\t            for (var i = 0, len = datas.length; i < len; i++) {\n\t                var _datas = datas[i];\n\t                var str = \"<p><img src='\" + imgReplace.imgReplace(_datas) + \"' _src='\" + _datas + \"' data-type='insertImg' proto = '\" + imgReplace.imgProto(_datas) + \"'></p>\";\n\t                editor.execCommand(\"insertHtml\", str);\n\t            }\n\t        } else {\n\t            alert('上传失败,请重新上传');\n\t            firing = 0;\n\t            $picLoading.addClass('hide');\n\t        }\n\t    }).always(function (data) {\n\t        firing = 0;\n\t        $picLoading.addClass('hide');\n\t    });\n\t};\n\t\n\tvar imgReader = function imgReader(file, editor) {\n\t    if (firing == 1) {\n\t        return false;\n\t    }\n\t    firing = 1;\n\t    var reader = new FileReader();\n\t\n\t    // 读取文件后将其显示在网页中\n\t    reader.onload = function (e) {\n\t        var img = new Image();\n\t        var data = e.target.result;\n\t\n\t        //图片压缩优化\n\t        var canvas = document.createElement(\"canvas\");\n\t        var context = canvas.getContext(\"2d\");\n\t        var imageBase64;\n\t\n\t        img.onload = function () {\n\t            var _w = img.width;\n\t            var _h = img.height;\n\t\n\t            canvas.width = _w;\n\t            canvas.height = _h;\n\t            context.drawImage(img, 0, 0);\n\t            imageBase64 = canvas.toDataURL(\"image/jpeg\");\n\t            fetchData(imageBase64, editor);\n\t        };\n\t\n\t        img.src = data;\n\t\n\t        domUtils.preventDefault(e);\n\t    };\n\t    // 读取文件\n\t    reader.readAsDataURL(file);\n\t};\n\t\n\tUE.plugin.register('autoupload', function () {\n\t    function getPasteImage(e) {\n\t        return e.clipboardData && e.clipboardData.items && e.clipboardData.items.length == 1 && /^image\\//.test(e.clipboardData.items[0].type) ? e.clipboardData.items : null;\n\t    }\n\t\n\t    function getDropImage(e) {\n\t        return e.dataTransfer && e.dataTransfer.files ? e.dataTransfer.files : null;\n\t    }\n\t\n\t    return {\n\t        outputRule: function outputRule(root) {\n\t            utils.each(root.getNodesByTagName('img'), function (n) {\n\t                if (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n\t                    n.parentNode.removeChild(n);\n\t                }\n\t            });\n\t            utils.each(root.getNodesByTagName('p'), function (n) {\n\t                if (/\\bloadpara\\b/.test(n.getAttr('class'))) {\n\t                    n.parentNode.removeChild(n);\n\t                }\n\t            });\n\t        },\n\t        bindEvents: {\n\t            //插入粘贴板的图片，拖放插入图片\n\t            'ready': function ready(e) {\n\t                var me = this;\n\t\n\t                if (window.FormData && window.FileReader) {\n\t\n\t                    domUtils.on(me.body, 'paste', function (e) {\n\t                        var hasImg = false,\n\t                            items;\n\t                        //获取粘贴板文件列表\n\t                        items = e.type == 'paste' ? getPasteImage(e) : getDropImage(e);\n\t                        if (items) {\n\t                            var len = items.length,\n\t                                file;\n\t\n\t                            while (len--) {\n\t                                file = items[len];\n\t                                if (file.getAsFile) file = file.getAsFile();\n\t                                if (file && file.size > 0) {\n\t                                    if (/image\\/\\w+/i.test(file.type)) {\n\t                                        //判断为图片文件\n\t                                        if (firing) {\n\t                                            hasImg = true;\n\t                                            e.preventDefault();\n\t                                            return;\n\t                                        }\n\t                                        if (file.size > maxSize) {\n\t                                            hasImg = true;\n\t                                            e.preventDefault();\n\t                                            alert(i18n.upload.uploadError);\n\t                                            return;\n\t                                        } else {\n\t                                            var $content = $(me.getContent());\n\t                                            var insertedImgLen = $content.find('[data-type=insertImg]').length;\n\t\n\t                                            if (insertedImgLen < limitNum) {\n\t                                                imgReader(file, me);\n\t                                            } else {\n\t\n\t                                                var range = me.selection.getRange(),\n\t                                                    startContainer = range.startContainer,\n\t                                                    nodeName = startContainer.nodeName;\n\t\n\t                                                if (insertedImgLen == limitNum) {\n\t                                                    if (e.target.tagName == \"IMG\") {\n\t                                                        imgReader(file, me);\n\t                                                    }\n\t                                                } else {\n\t                                                    if (!$(\".pop-box-backdrop\").length) {\n\t                                                        alert('您最多能添加' + limitNum + '张图片哦！');\n\t                                                    }\n\t                                                }\n\t                                            }\n\t                                            hasImg = true;\n\t                                        }\n\t                                    }\n\t                                }\n\t                            }\n\t\n\t                            setTimeout(function () {\n\t                                imgReplace.changeSrc($(me.body));\n\t                            }, 2000);\n\t                            hasImg && e.preventDefault();\n\t                        }\n\t                    });\n\t                }\n\t            }\n\t        }\n\t    };\n\t});\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 146 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * @description\n\t * 增加超链接对话框转化\n\t *\n\t * @author 林飞\n\t */\n\t\n\tvar showText = __webpack_require__(125);\n\t\n\tUE.plugin.register('showLink', function (elm) {\n\t    var me = this;\n\t    var domUtils = UE.dom.domUtils;\n\t    //禁止连续请求\n\t\n\t    // img旋转弹层 鼠标离开，键盘事件都需要隐藏\n\t    var linkTransformPopup = window.linkTransformPopup = new baidu.editor.ui.Popup({\n\t        editor: me,\n\t        theme: 'default',\n\t        cutstomPosition: 'bottom-left',\n\t        _editLink: function _editLink(el) {\n\t            showText(me);\n\t            linkTransformPopup.hide();\n\t        },\n\t        _delLink: function _delLink() {\n\t            me.execCommand('unlink');\n\t            linkTransformPopup.hide();\n\t        }\n\t    });\n\t\n\t    linkTransformPopup.render();\n\t\n\t    me.addListener('click', function (evtName, evt) {\n\t\n\t        if (me.loading) return;\n\t\n\t        var target = evt.target;\n\t\n\t        if (target && (target.tagName == \"A\" || $(target).parents('a').length != 0)) {\n\t            var html = '',\n\t                str = \"\",\n\t                img = target;\n\t            var link = $(target).attr('href') || $(target).parents('a').attr('href');\n\t\n\t            str = '<nobr class=\"edui-link-container edui-clearfix\">' + '<p class=\"edui-link-box edui-clearfix clearfix\">' + '<a onclick=$$._editLink() class=\"editLink\">' + link + '</a>' + '<a onclick=$$._delLink() class=\"delLink\">&nbsp;&nbsp;</a>' + '</p>' + '</nobr>';\n\t\n\t            !html && (html = linkTransformPopup.formatHtml(str));\n\t            if (html) {\n\t                linkTransformPopup.getDom('content').innerHTML = html;\n\t                linkTransformPopup.anchorEl = img || link;\n\t                linkTransformPopup.showAnchor(linkTransformPopup.anchorEl);\n\t            } else {\n\t                linkTransformPopup.hide();\n\t            }\n\t        }\n\t    });\n\t});\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 147 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t//toolbar\n\t__webpack_require__(148);\n\t//按钮规则\n\t__webpack_require__(152);\n\t//商品插入数量限制\n\t__webpack_require__(153);\n\t//浮层位置\n\t__webpack_require__(154);\n\n/***/ }),\n/* 148 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t__webpack_require__(149);\n\t__webpack_require__(150);\n\t__webpack_require__(151);\n\n/***/ }),\n/* 149 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar domUtils = UE.dom.domUtils;\n\tvar utils = UE.utils;\n\t//var domUtils = baidu.editor.dom.domUtils\n\t\n\tvar getContent = __webpack_require__(113);\n\t\n\tUE.plugins['basestyle'] = function () {\n\t\n\t    var basestyles = {\n\t        'bold': ['strong', 'b'],\n\t        'italic': ['em', 'i'],\n\t        'subscript': ['sub'],\n\t        'superscript': ['sup'],\n\t        'underline': ['u']\n\t    },\n\t        getObj = function getObj(editor, tagNames) {\n\t        return domUtils.filterNodeList(editor.selection.getStartElementPath(), tagNames);\n\t    },\n\t        me = this;\n\t    //添加快捷键\n\t    me.addshortcutkey({\n\t        \"Bold\": \"ctrl+66\", //^B\n\t        \"Italic\": \"ctrl+73\", //^I\n\t        \"Underline\": \"ctrl+85\" //^U\n\t    });\n\t    me.addInputRule(function (root) {\n\t        utils.each(root.getNodesByTagName('b i'), function (node) {\n\t            switch (node.tagName) {\n\t                case 'b':\n\t                    node.tagName = 'strong';\n\t                    break;\n\t                case 'i':\n\t                    node.tagName = 'em';\n\t            }\n\t        });\n\t    });\n\t    for (var style in basestyles) {\n\t        (function (cmd, tagNames) {\n\t            me.commands[cmd] = {\n\t                execCommand: function execCommand(cmdName) {\n\t                    var range = me.selection.getRange(),\n\t                        obj = getObj(this, tagNames);\n\t\n\t                    /* range.select();\n\t                      var fragment = range.cloneContents(),\n\t                         node = document.createElement(\"div\");\n\t                      node.appendChild(fragment);\n\t                     */\n\t\n\t                    if (getContent(range).indexOf('gmp-ebox') != -1) {\n\t                        return false;\n\t                    }\n\t                    if (range.collapsed) {\n\t\n\t                        if (obj) {\n\t                            var tmpText = me.document.createTextNode('');\n\t                            range.insertNode(tmpText).removeInlineStyle(tagNames);\n\t                            range.setStartBefore(tmpText);\n\t                            domUtils.remove(tmpText);\n\t                        } else {\n\t                            var tmpNode = range.document.createElement(tagNames[0]);\n\t                            if (cmdName == 'superscript' || cmdName == 'subscript') {\n\t                                tmpText = me.document.createTextNode('');\n\t                                range.insertNode(tmpText).removeInlineStyle(['sub', 'sup']).setStartBefore(tmpText).collapse(true);\n\t                            }\n\t                            range.insertNode(tmpNode).setStart(tmpNode, 0);\n\t                        }\n\t                        range.collapse(true);\n\t                    } else {\n\t                        if (cmdName == 'superscript' || cmdName == 'subscript') {\n\t                            if (!obj || obj.tagName.toLowerCase() != cmdName) {\n\t                                range.removeInlineStyle(['sub', 'sup']);\n\t                            }\n\t                        }\n\t                        obj ? range.removeInlineStyle(tagNames) : range.applyInlineStyle(tagNames[0]);\n\t                    }\n\t                    range.select();\n\t                },\n\t                queryCommandState: function queryCommandState() {\n\t                    return getObj(this, tagNames) ? 1 : 0;\n\t                }\n\t            };\n\t        })(style, basestyles[style]);\n\t    }\n\t};\n\n/***/ }),\n/* 150 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar domUtils = UE.dom.domUtils;\n\tvar utils = UE.utils;\n\t\n\tvar getContent = __webpack_require__(113);\n\t\n\tUE.plugins['justify'] = function () {\n\t    var me = this,\n\t        block = domUtils.isBlockElm,\n\t        defaultValue = {\n\t        left: 1,\n\t        right: 1,\n\t        center: 1,\n\t        justify: 1\n\t    },\n\t        doJustify = function doJustify(range, style) {\n\t        var bookmark = range.createBookmark(),\n\t            filterFn = function filterFn(node) {\n\t            return node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t        };\n\t\n\t        range.enlarge(true);\n\t        var bookmark2 = range.createBookmark(),\n\t            current = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t            tmpRange = range.cloneRange(),\n\t            tmpNode;\n\t        while (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t            if (current.nodeType == 3 || !block(current)) {\n\t                tmpRange.setStartBefore(current);\n\t                while (current && current !== bookmark2.end && !block(current)) {\n\t                    tmpNode = current;\n\t                    current = domUtils.getNextDomNode(current, false, null, function (node) {\n\t                        return !block(node);\n\t                    });\n\t                }\n\t                tmpRange.setEndAfter(tmpNode);\n\t                var common = tmpRange.getCommonAncestor();\n\t                if (!domUtils.isBody(common) && block(common)) {\n\t                    domUtils.setStyles(common, utils.isString(style) ? {\n\t                        'text-align': style\n\t                    } : style);\n\t                    current = common;\n\t                } else {\n\t                    var p = range.document.createElement('p');\n\t                    domUtils.setStyles(p, utils.isString(style) ? {\n\t                        'text-align': style\n\t                    } : style);\n\t                    var frag = tmpRange.extractContents();\n\t                    p.appendChild(frag);\n\t                    tmpRange.insertNode(p);\n\t                    current = p;\n\t                }\n\t                current = domUtils.getNextDomNode(current, false, filterFn);\n\t            } else {\n\t                current = domUtils.getNextDomNode(current, true, filterFn);\n\t            }\n\t        }\n\t        return range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t    };\n\t\n\t    UE.commands['justify'] = {\n\t        execCommand: function execCommand(cmdName, align) {\n\t            var range = this.selection.getRange(),\n\t                txt;\n\t\n\t            if (getContent(range).indexOf('gmp-ebox') != -1) {\n\t                return false;\n\t            }\n\t\n\t            //闭合时单独处理\n\t            if (range.collapsed) {\n\t                txt = this.document.createTextNode('p');\n\t                range.insertNode(txt);\n\t            }\n\t            doJustify(range, align);\n\t            if (txt) {\n\t                range.setStartBefore(txt).collapse(true);\n\t                domUtils.remove(txt);\n\t            }\n\t\n\t            range.select();\n\t\n\t            return true;\n\t        },\n\t        queryCommandValue: function queryCommandValue() {\n\t            var startNode = this.selection.getStart(),\n\t                value = domUtils.getComputedStyle(startNode, 'text-align');\n\t            return defaultValue[value] ? value : 'left';\n\t        },\n\t        queryCommandState: function queryCommandState() {\n\t            var start = this.selection.getStart(),\n\t                cell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\n\t            return cell ? -1 : 0;\n\t        }\n\t\n\t    };\n\t};\n\n/***/ }),\n/* 151 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar domUtils = UE.dom.domUtils;\n\tvar utils = UE.utils;\n\tvar browser = UE.browser;\n\tvar dtd = UE.dom.dtd;\n\tvar getContent = __webpack_require__(113);\n\tvar grepDom = 'gmp-ebox';\n\t\n\tUE.plugins['list'] = function () {\n\t    var me = this,\n\t        notExchange = {\n\t        'TD': 1,\n\t        'PRE': 1,\n\t        'BLOCKQUOTE': 1\n\t    };\n\t    var customStyle = {\n\t        'cn': 'cn-1-',\n\t        'cn1': 'cn-2-',\n\t        'cn2': 'cn-3-',\n\t        'num': 'num-1-',\n\t        'num1': 'num-2-',\n\t        'num2': 'num-3-',\n\t        'dash': 'dash',\n\t        'dot': 'dot'\n\t    };\n\t\n\t    me.setOpt({\n\t        'autoTransWordToList': false,\n\t        'insertorderedlist': {\n\t            'num': '',\n\t            'num1': '',\n\t            'num2': '',\n\t            'cn': '',\n\t            'cn1': '',\n\t            'cn2': '',\n\t            'decimal': '',\n\t            'lower-alpha': '',\n\t            'lower-roman': '',\n\t            'upper-alpha': '',\n\t            'upper-roman': ''\n\t        },\n\t        'insertunorderedlist': {\n\t            'circle': '',\n\t            'disc': '',\n\t            'square': '',\n\t            'dash': '',\n\t            'dot': ''\n\t        },\n\t        listDefaultPaddingLeft: '30',\n\t        listiconpath: 'http://bs.baidu.com/listicon/',\n\t        maxListLevel: -1, //-1不限制\n\t        disablePInList: false\n\t    });\n\t\n\t    function listToArray(list) {\n\t        var arr = [];\n\t        for (var p in list) {\n\t            arr.push(p);\n\t        }\n\t        return arr;\n\t    }\n\t    var listStyle = {\n\t        'OL': listToArray(me.options.insertorderedlist),\n\t        'UL': listToArray(me.options.insertunorderedlist)\n\t    };\n\t    var liiconpath = me.options.listiconpath;\n\t\n\t    //根据用户配置，调整customStyle\n\t    for (var s in customStyle) {\n\t        if (!me.options.insertorderedlist.hasOwnProperty(s) && !me.options.insertunorderedlist.hasOwnProperty(s)) {\n\t            delete customStyle[s];\n\t        }\n\t    }\n\t\n\t    me.ready(function () {\n\t        var customCss = [];\n\t        for (var p in customStyle) {\n\t            if (p == 'dash' || p == 'dot') {\n\t                customCss.push('li.list-' + customStyle[p] + '{background-image:url(' + liiconpath + customStyle[p] + '.gif)}');\n\t                customCss.push('ul.custom_' + p + '{list-style:none;}ul.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t            } else {\n\t                for (var i = 0; i < 99; i++) {\n\t                    customCss.push('li.list-' + customStyle[p] + i + '{background-image:url(' + liiconpath + 'list-' + customStyle[p] + i + '.gif)}');\n\t                }\n\t                customCss.push('ol.custom_' + p + '{list-style:none;}ol.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t            }\n\t            switch (p) {\n\t                case 'cn':\n\t                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t                    break;\n\t                case 'cn1':\n\t                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:30px}');\n\t                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t                    break;\n\t                case 'cn2':\n\t                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:40px}');\n\t                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:55px}');\n\t                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:68px}');\n\t                    break;\n\t                case 'num':\n\t                case 'num1':\n\t                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t                    break;\n\t                case 'num2':\n\t                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:35px}');\n\t                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t                    break;\n\t                case 'dash':\n\t                    customCss.push('li.list-' + p + '-paddingleft{padding-left:35px}');\n\t                    break;\n\t                case 'dot':\n\t                    customCss.push('li.list-' + p + '-paddingleft{padding-left:20px}');\n\t            }\n\t        }\n\t        customCss.push('.list-paddingleft-1{padding-left:0}');\n\t        customCss.push('.list-paddingleft-2{padding-left:' + me.options.listDefaultPaddingLeft + 'px}');\n\t        customCss.push('.list-paddingleft-3{padding-left:' + me.options.listDefaultPaddingLeft * 2 + 'px}');\n\t        //如果不给宽度会在自定应样式里出现滚动条\n\t        utils.cssRule('list', 'ol,ul{margin:0;pading:0;' + (browser.ie ? '' : 'width:95%') + '}li{clear:both;}' + customCss.join('\\n'), me.document);\n\t    });\n\t    //单独处理剪切的问题\n\t    me.ready(function () {\n\t        domUtils.on(me.body, 'cut', function () {\n\t            setTimeout(function () {\n\t                var rng = me.selection.getRange(),\n\t                    li;\n\t                //trace:3416\n\t                if (!rng.collapsed) {\n\t                    if (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t                        if (!li.nextSibling && domUtils.isEmptyBlock(li)) {\n\t                            var pn = li.parentNode,\n\t                                node;\n\t                            if (node = pn.previousSibling) {\n\t                                domUtils.remove(pn);\n\t                                rng.setStartAtLast(node).collapse(true);\n\t                                rng.select(true);\n\t                            } else if (node = pn.nextSibling) {\n\t                                domUtils.remove(pn);\n\t                                rng.setStartAtFirst(node).collapse(true);\n\t                                rng.select(true);\n\t                            } else {\n\t                                var tmpNode = me.document.createElement('p');\n\t                                domUtils.fillNode(me.document, tmpNode);\n\t                                pn.parentNode.insertBefore(tmpNode, pn);\n\t                                domUtils.remove(pn);\n\t                                rng.setStart(tmpNode, 0).collapse(true);\n\t                                rng.select(true);\n\t                            }\n\t                        }\n\t                    }\n\t                }\n\t            });\n\t        });\n\t    });\n\t\n\t    function getStyle(node) {\n\t        var cls = node.className;\n\t        if (domUtils.hasClass(node, /custom_/)) {\n\t            return cls.match(/custom_(\\w+)/)[1];\n\t        }\n\t        return domUtils.getStyle(node, 'list-style-type');\n\t    }\n\t\n\t    me.addListener('beforepaste', function (type, html) {\n\t        var me = this,\n\t            rng = me.selection.getRange(),\n\t            li;\n\t        var root = UE.htmlparser(html.html, true);\n\t        if (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t            var list = li.parentNode,\n\t                tagName = list.tagName == 'OL' ? 'ul' : 'ol';\n\t            utils.each(root.getNodesByTagName(tagName), function (n) {\n\t                n.tagName = list.tagName;\n\t                n.setAttr();\n\t                if (n.parentNode === root) {\n\t                    type = getStyle(list) || (list.tagName == 'OL' ? 'decimal' : 'disc');\n\t                } else {\n\t                    var className = n.parentNode.getAttr('class');\n\t                    if (className && /custom_/.test(className)) {\n\t                        type = className.match(/custom_(\\w+)/)[1];\n\t                    } else {\n\t                        type = n.parentNode.getStyle('list-style-type');\n\t                    }\n\t                    if (!type) {\n\t                        type = list.tagName == 'OL' ? 'decimal' : 'disc';\n\t                    }\n\t                }\n\t                var index = utils.indexOf(listStyle[list.tagName], type);\n\t                if (n.parentNode !== root) index = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t                var currentStyle = listStyle[list.tagName][index];\n\t                if (customStyle[currentStyle]) {\n\t                    n.setAttr('class', 'custom_' + currentStyle);\n\t                } else {\n\t                    n.setStyle('list-style-type', currentStyle);\n\t                }\n\t            });\n\t        }\n\t\n\t        html.html = root.toHtml();\n\t    });\n\t    //导出时，去掉p标签\n\t    me.getOpt('disablePInList') === true && me.addOutputRule(function (root) {\n\t        utils.each(root.getNodesByTagName('li'), function (li) {\n\t            var newChildrens = [],\n\t                index = 0;\n\t            utils.each(li.children, function (n) {\n\t                if (n.tagName == 'p') {\n\t                    var tmpNode;\n\t                    while (tmpNode = n.children.pop()) {\n\t                        newChildrens.splice(index, 0, tmpNode);\n\t                        tmpNode.parentNode = li;\n\t                        lastNode = tmpNode;\n\t                    }\n\t                    tmpNode = newChildrens[newChildrens.length - 1];\n\t                    if (!tmpNode || tmpNode.type != 'element' || tmpNode.tagName != 'br') {\n\t                        var br = UE.uNode.createElement('br');\n\t                        br.parentNode = li;\n\t                        newChildrens.push(br);\n\t                    }\n\t\n\t                    index = newChildrens.length;\n\t                }\n\t            });\n\t            if (newChildrens.length) {\n\t                li.children = newChildrens;\n\t            }\n\t        });\n\t    });\n\t    //进入编辑器的li要套p标签\n\t    me.addInputRule(function (root) {\n\t        utils.each(root.getNodesByTagName('li'), function (li) {\n\t            var tmpP = UE.uNode.createElement('p');\n\t            for (var i = 0, ci; ci = li.children[i];) {\n\t                if (ci.type == 'text' || dtd.p[ci.tagName]) {\n\t                    tmpP.appendChild(ci);\n\t                } else {\n\t                    if (tmpP.firstChild()) {\n\t                        li.insertBefore(tmpP, ci);\n\t                        tmpP = UE.uNode.createElement('p');\n\t                        i = i + 2;\n\t                    } else {\n\t                        i++;\n\t                    }\n\t                }\n\t            }\n\t            if (tmpP.firstChild() && !tmpP.parentNode || !li.firstChild()) {\n\t                li.appendChild(tmpP);\n\t            }\n\t            //trace:3357\n\t            //p不能为空\n\t            if (!tmpP.firstChild()) {\n\t                tmpP.innerHTML(browser.ie ? '&nbsp;' : '<br/>');\n\t            }\n\t            //去掉末尾的空白\n\t            var p = li.firstChild();\n\t            var lastChild = p.lastChild();\n\t            if (lastChild && lastChild.type == 'text' && /^\\s*$/.test(lastChild.data)) {\n\t                p.removeChild(lastChild);\n\t            }\n\t        });\n\t        if (me.options.autoTransWordToList) {\n\t            var checkListType = function checkListType(content, container) {\n\t                var span = container.firstChild();\n\t                if (span && span.type == 'element' && span.tagName == 'span' && /Wingdings|Symbol/.test(span.getStyle('font-family'))) {\n\t                    for (var p in unorderlisttype) {\n\t                        if (unorderlisttype[p] == span.data) {\n\t                            return p;\n\t                        }\n\t                    }\n\t                    return 'disc';\n\t                }\n\t                for (var p in orderlisttype) {\n\t                    if (orderlisttype[p].test(content)) {\n\t                        return p;\n\t                    }\n\t                }\n\t            };\n\t\n\t            var orderlisttype = {\n\t                'num1': /^\\d+\\)/,\n\t                'decimal': /^\\d+\\./,\n\t                'lower-alpha': /^[a-z]+\\)/,\n\t                'upper-alpha': /^[A-Z]+\\./,\n\t                'cn': /^[\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+[\\u3001]/,\n\t                'cn2': /^\\([\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+\\)/\n\t            },\n\t                unorderlisttype = {\n\t                'square': 'n'\n\t            };\n\t\n\t            utils.each(root.getNodesByTagName('p'), function (node) {\n\t                if (node.getAttr('class') != 'MsoListParagraph') {\n\t                    return;\n\t                }\n\t\n\t                //word粘贴过来的会带有margin要去掉,但这样也可能会误命中一些央视\n\t                node.setStyle('margin', '');\n\t                node.setStyle('margin-left', '');\n\t                node.setAttr('class', '');\n\t\n\t                function appendLi(list, p, type) {\n\t                    if (list.tagName == 'ol') {\n\t                        if (browser.ie) {\n\t                            var first = p.firstChild();\n\t                            if (first.type == 'element' && first.tagName == 'span' && orderlisttype[type].test(first.innerText())) {\n\t                                p.removeChild(first);\n\t                            }\n\t                        } else {\n\t                            p.innerHTML(p.innerHTML().replace(orderlisttype[type], ''));\n\t                        }\n\t                    } else {\n\t                        p.removeChild(p.firstChild());\n\t                    }\n\t\n\t                    var li = UE.uNode.createElement('li');\n\t                    li.appendChild(p);\n\t                    list.appendChild(li);\n\t                }\n\t                var tmp = node,\n\t                    type,\n\t                    cacheNode = node;\n\t\n\t                if (node.parentNode.tagName != 'li' && (type = checkListType(node.innerText(), node))) {\n\t\n\t                    var list = UE.uNode.createElement(me.options.insertorderedlist.hasOwnProperty(type) ? 'ol' : 'ul');\n\t                    if (customStyle[type]) {\n\t                        list.setAttr('class', 'custom_' + type);\n\t                    } else {\n\t                        list.setStyle('list-style-type', type);\n\t                    }\n\t                    while (node && node.parentNode.tagName != 'li' && checkListType(node.innerText(), node)) {\n\t                        tmp = node.nextSibling();\n\t                        if (!tmp) {\n\t                            node.parentNode.insertBefore(list, node);\n\t                        }\n\t                        appendLi(list, node, type);\n\t                        node = tmp;\n\t                    }\n\t                    if (!list.parentNode && node && node.parentNode) {\n\t                        node.parentNode.insertBefore(list, node);\n\t                    }\n\t                }\n\t                var span = cacheNode.firstChild();\n\t                if (span && span.type == 'element' && span.tagName == 'span' && /^\\s*(&nbsp;)+\\s*$/.test(span.innerText())) {\n\t                    span.parentNode.removeChild(span);\n\t                }\n\t            });\n\t        }\n\t    });\n\t\n\t    //调整索引标签\n\t    me.addListener('contentchange', function () {\n\t        adjustListStyle(me.document);\n\t    });\n\t\n\t    function adjustListStyle(doc, ignore) {\n\t        utils.each(domUtils.getElementsByTagName(doc, 'ol ul'), function (node) {\n\t\n\t            if (!domUtils.inDoc(node, doc)) return;\n\t\n\t            var parent = node.parentNode;\n\t            if (parent.tagName == node.tagName) {\n\t                var nodeStyleType = getStyle(node) || (node.tagName == 'OL' ? 'decimal' : 'disc'),\n\t                    parentStyleType = getStyle(parent) || (parent.tagName == 'OL' ? 'decimal' : 'disc');\n\t                if (nodeStyleType == parentStyleType) {\n\t                    var styleIndex = utils.indexOf(listStyle[node.tagName], nodeStyleType);\n\t                    styleIndex = styleIndex + 1 == listStyle[node.tagName].length ? 0 : styleIndex + 1;\n\t                    setListStyle(node, listStyle[node.tagName][styleIndex]);\n\t                }\n\t            }\n\t            var index = 0,\n\t                type = 2;\n\t            if (domUtils.hasClass(node, /custom_/)) {\n\t                if (!(/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/))) {\n\t                    type = 1;\n\t                }\n\t            } else {\n\t                if (/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/)) {\n\t                    type = 3;\n\t                }\n\t            }\n\t\n\t            var style = domUtils.getStyle(node, 'list-style-type');\n\t            style && (node.style.cssText = 'list-style-type:' + style);\n\t            node.className = utils.trim(node.className.replace(/list-paddingleft-\\w+/, '')) + ' list-paddingleft-' + type;\n\t            utils.each(domUtils.getElementsByTagName(node, 'li'), function (li) {\n\t                li.style.cssText && (li.style.cssText = '');\n\t                if (!li.firstChild) {\n\t                    domUtils.remove(li);\n\t                    return;\n\t                }\n\t                if (li.parentNode !== node) {\n\t                    return;\n\t                }\n\t                index++;\n\t                if (domUtils.hasClass(node, /custom_/)) {\n\t                    var paddingLeft = 1,\n\t                        currentStyle = getStyle(node);\n\t                    if (node.tagName == 'OL') {\n\t                        if (currentStyle) {\n\t                            switch (currentStyle) {\n\t                                case 'cn':\n\t                                case 'cn1':\n\t                                case 'cn2':\n\t                                    if (index > 10 && (index % 10 == 0 || index > 10 && index < 20)) {\n\t                                        paddingLeft = 2;\n\t                                    } else if (index > 20) {\n\t                                        paddingLeft = 3;\n\t                                    }\n\t                                    break;\n\t                                case 'num2':\n\t                                    if (index > 9) {\n\t                                        paddingLeft = 2;\n\t                                    }\n\t                            }\n\t                        }\n\t                        li.className = 'list-' + customStyle[currentStyle] + index + ' ' + 'list-' + currentStyle + '-paddingleft-' + paddingLeft;\n\t                    } else {\n\t                        li.className = 'list-' + customStyle[currentStyle] + ' ' + 'list-' + currentStyle + '-paddingleft';\n\t                    }\n\t                } else {\n\t                    li.className = li.className.replace(/list-[\\w\\-]+/gi, '');\n\t                }\n\t                var className = li.getAttribute('class');\n\t                if (className !== null && !className.replace(/\\s/g, '')) {\n\t                    domUtils.removeAttributes(li, 'class');\n\t                }\n\t            });\n\t            !ignore && adjustList(node, node.tagName.toLowerCase(), getStyle(node) || domUtils.getStyle(node, 'list-style-type'), true);\n\t        });\n\t    }\n\t\n\t    function adjustList(list, tag, style, ignoreEmpty) {\n\t        var nextList = list.nextSibling;\n\t        if (nextList && nextList.nodeType == 1 && nextList.tagName.toLowerCase() == tag && (getStyle(nextList) || domUtils.getStyle(nextList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t            domUtils.moveChild(nextList, list);\n\t            if (nextList.childNodes.length == 0) {\n\t                domUtils.remove(nextList);\n\t            }\n\t        }\n\t        if (nextList && domUtils.isFillChar(nextList)) {\n\t            domUtils.remove(nextList);\n\t        }\n\t        var preList = list.previousSibling;\n\t        if (preList && preList.nodeType == 1 && preList.tagName.toLowerCase() == tag && (getStyle(preList) || domUtils.getStyle(preList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t            domUtils.moveChild(list, preList);\n\t        }\n\t        if (preList && domUtils.isFillChar(preList)) {\n\t            domUtils.remove(preList);\n\t        }!ignoreEmpty && domUtils.isEmptyBlock(list) && domUtils.remove(list);\n\t        if (getStyle(list)) {\n\t            adjustListStyle(list.ownerDocument, true);\n\t        }\n\t    }\n\t\n\t    function setListStyle(list, style) {\n\t        if (customStyle[style]) {\n\t            list.className = 'custom_' + style;\n\t        }\n\t        try {\n\t            domUtils.setStyle(list, 'list-style-type', style);\n\t        } catch (e) {}\n\t    }\n\t\n\t    function clearEmptySibling(node) {\n\t        var tmpNode = node.previousSibling;\n\t        if (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t            domUtils.remove(tmpNode);\n\t        }\n\t        tmpNode = node.nextSibling;\n\t        if (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t            domUtils.remove(tmpNode);\n\t        }\n\t    }\n\t\n\t    me.addListener('keydown', function (type, evt) {\n\t        function preventAndSave() {\n\t            evt.preventDefault ? evt.preventDefault() : evt.returnValue = false;\n\t            me.fireEvent('contentchange');\n\t            me.undoManger && me.undoManger.save();\n\t        }\n\t\n\t        function findList(node, filterFn) {\n\t            while (node && !domUtils.isBody(node)) {\n\t                if (filterFn(node)) {\n\t                    return null;\n\t                }\n\t                if (node.nodeType == 1 && /[ou]l/i.test(node.tagName)) {\n\t                    return node;\n\t                }\n\t                node = node.parentNode;\n\t            }\n\t            return null;\n\t        }\n\t        var keyCode = evt.keyCode || evt.which;\n\t        if (keyCode == 13 && !evt.shiftKey) {\n\t            //回车\n\t            var rng = me.selection.getRange(),\n\t                parent = domUtils.findParent(rng.startContainer, function (node) {\n\t                return domUtils.isBlockElm(node);\n\t            }, true),\n\t                li = domUtils.findParentByTagName(rng.startContainer, 'li', true);\n\t            if (parent && parent.tagName != 'PRE' && !li) {\n\t                var html = parent.innerHTML.replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t                if (/^\\s*1\\s*\\.[^\\d]/.test(html)) {\n\t                    parent.innerHTML = html.replace(/^\\s*1\\s*\\./, '');\n\t                    rng.setStartAtLast(parent).collapse(true).select();\n\t                    me.__hasEnterExecCommand = true;\n\t                    me.execCommand('insertorderedlist');\n\t                    me.__hasEnterExecCommand = false;\n\t                }\n\t            }\n\t            var range = me.selection.getRange(),\n\t                start = findList(range.startContainer, function (node) {\n\t                return node.tagName == 'TABLE';\n\t            }),\n\t                end = range.collapsed ? start : findList(range.endContainer, function (node) {\n\t                return node.tagName == 'TABLE';\n\t            });\n\t\n\t            if (start && end && start === end) {\n\t\n\t                if (!range.collapsed) {\n\t                    start = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t                    end = domUtils.findParentByTagName(range.endContainer, 'li', true);\n\t                    if (start && end && start === end) {\n\t                        range.deleteContents();\n\t                        li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t                        if (li && domUtils.isEmptyBlock(li)) {\n\t\n\t                            pre = li.previousSibling;\n\t                            next = li.nextSibling;\n\t                            p = me.document.createElement('p');\n\t\n\t                            domUtils.fillNode(me.document, p);\n\t                            parentList = li.parentNode;\n\t                            if (pre && next) {\n\t                                range.setStart(next, 0).collapse(true).select(true);\n\t                                domUtils.remove(li);\n\t                            } else {\n\t                                if (!pre && !next || !pre) {\n\t\n\t                                    parentList.parentNode.insertBefore(p, parentList);\n\t                                } else {\n\t                                    li.parentNode.parentNode.insertBefore(p, parentList.nextSibling);\n\t                                }\n\t                                domUtils.remove(li);\n\t                                if (!parentList.firstChild) {\n\t                                    domUtils.remove(parentList);\n\t                                }\n\t                                range.setStart(p, 0).setCursor();\n\t                            }\n\t                            preventAndSave();\n\t                            return;\n\t                        }\n\t                    } else {\n\t                        var tmpRange = range.cloneRange(),\n\t                            bk = tmpRange.collapse(false).createBookmark();\n\t\n\t                        range.deleteContents();\n\t                        tmpRange.moveToBookmark(bk);\n\t                        var li = domUtils.findParentByTagName(tmpRange.startContainer, 'li', true);\n\t\n\t                        clearEmptySibling(li);\n\t                        tmpRange.select();\n\t                        preventAndSave();\n\t                        return;\n\t                    }\n\t                }\n\t\n\t                li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\n\t                if (li) {\n\t                    if (domUtils.isEmptyBlock(li)) {\n\t                        bk = range.createBookmark();\n\t                        var parentList = li.parentNode;\n\t                        if (li !== parentList.lastChild) {\n\t                            domUtils.breakParent(li, parentList);\n\t                            clearEmptySibling(li);\n\t                        } else {\n\t\n\t                            parentList.parentNode.insertBefore(li, parentList.nextSibling);\n\t                            if (domUtils.isEmptyNode(parentList)) {\n\t                                domUtils.remove(parentList);\n\t                            }\n\t                        }\n\t                        //嵌套不处理\n\t                        if (!dtd.$list[li.parentNode.tagName]) {\n\t\n\t                            if (!domUtils.isBlockElm(li.firstChild)) {\n\t                                p = me.document.createElement('p');\n\t                                li.parentNode.insertBefore(p, li);\n\t                                while (li.firstChild) {\n\t                                    p.appendChild(li.firstChild);\n\t                                }\n\t                                domUtils.remove(li);\n\t                            } else {\n\t                                domUtils.remove(li, true);\n\t                            }\n\t                        }\n\t                        range.moveToBookmark(bk).select();\n\t                    } else {\n\t                        var first = li.firstChild;\n\t                        if (!first || !domUtils.isBlockElm(first)) {\n\t                            var p = me.document.createElement('p');\n\t\n\t                            !li.firstChild && domUtils.fillNode(me.document, p);\n\t                            while (li.firstChild) {\n\t\n\t                                p.appendChild(li.firstChild);\n\t                            }\n\t                            li.appendChild(p);\n\t                            first = p;\n\t                        }\n\t\n\t                        var span = me.document.createElement('span');\n\t\n\t                        range.insertNode(span);\n\t                        domUtils.breakParent(span, li);\n\t\n\t                        var nextLi = span.nextSibling;\n\t                        first = nextLi.firstChild;\n\t\n\t                        if (!first) {\n\t                            p = me.document.createElement('p');\n\t\n\t                            domUtils.fillNode(me.document, p);\n\t                            nextLi.appendChild(p);\n\t                            first = p;\n\t                        }\n\t                        if (domUtils.isEmptyNode(first)) {\n\t                            first.innerHTML = '';\n\t                            domUtils.fillNode(me.document, first);\n\t                        }\n\t\n\t                        range.setStart(first, 0).collapse(true).shrinkBoundary().select();\n\t                        domUtils.remove(span);\n\t                        var pre = nextLi.previousSibling;\n\t                        if (pre && domUtils.isEmptyBlock(pre)) {\n\t                            pre.innerHTML = '<p></p>';\n\t                            domUtils.fillNode(me.document, pre.firstChild);\n\t                        }\n\t                    }\n\t                    //                        }\n\t                    preventAndSave();\n\t                }\n\t            }\n\t        }\n\t        if (keyCode == 8) {\n\t            //修中ie中li下的问题\n\t            range = me.selection.getRange();\n\t            if (range.collapsed && domUtils.isStartInblock(range)) {\n\t                tmpRange = range.cloneRange().trimBoundary();\n\t                li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t                //要在li的最左边，才能处理\n\t                if (li && domUtils.isStartInblock(tmpRange)) {\n\t                    start = domUtils.findParentByTagName(range.startContainer, 'p', true);\n\t                    if (start && start !== li.firstChild) {\n\t                        var parentList = domUtils.findParentByTagName(start, ['ol', 'ul']);\n\t                        domUtils.breakParent(start, parentList);\n\t                        clearEmptySibling(start);\n\t                        me.fireEvent('contentchange');\n\t                        range.setStart(start, 0).setCursor(false, true);\n\t                        me.fireEvent('saveScene');\n\t                        domUtils.preventDefault(evt);\n\t                        return;\n\t                    }\n\t\n\t                    if (li && (pre = li.previousSibling)) {\n\t                        if (keyCode == 46 && li.childNodes.length) {\n\t                            return;\n\t                        }\n\t                        //有可能上边的兄弟节点是个2级菜单，要追加到2级菜单的最后的li\n\t                        if (dtd.$list[pre.tagName]) {\n\t                            pre = pre.lastChild;\n\t                        }\n\t                        me.undoManger && me.undoManger.save();\n\t                        first = li.firstChild;\n\t                        if (domUtils.isBlockElm(first)) {\n\t                            if (domUtils.isEmptyNode(first)) {\n\t                                //                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t                                pre.appendChild(first);\n\t                                range.setStart(first, 0).setCursor(false, true);\n\t                                //first不是唯一的节点\n\t                                while (li.firstChild) {\n\t                                    pre.appendChild(li.firstChild);\n\t                                }\n\t                            } else {\n\t\n\t                                span = me.document.createElement('span');\n\t                                range.insertNode(span);\n\t                                //判断pre是否是空的节点,如果是<p><br/></p>类型的空节点，干掉p标签防止它占位\n\t                                if (domUtils.isEmptyBlock(pre)) {\n\t                                    pre.innerHTML = '';\n\t                                }\n\t                                domUtils.moveChild(li, pre);\n\t                                range.setStartBefore(span).collapse(true).select(true);\n\t\n\t                                domUtils.remove(span);\n\t                            }\n\t                        } else {\n\t                            if (domUtils.isEmptyNode(li)) {\n\t                                var p = me.document.createElement('p');\n\t                                pre.appendChild(p);\n\t                                range.setStart(p, 0).setCursor();\n\t                                //                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t                            } else {\n\t                                range.setEnd(pre, pre.childNodes.length).collapse().select(true);\n\t                                while (li.firstChild) {\n\t                                    pre.appendChild(li.firstChild);\n\t                                }\n\t                            }\n\t                        }\n\t                        domUtils.remove(li);\n\t                        me.fireEvent('contentchange');\n\t                        me.fireEvent('saveScene');\n\t                        domUtils.preventDefault(evt);\n\t                        return;\n\t                    }\n\t                    //trace:980\n\t\n\t                    if (li && !li.previousSibling) {\n\t                        var parentList = li.parentNode;\n\t                        var bk = range.createBookmark();\n\t                        if (domUtils.isTagNode(parentList.parentNode, 'ol ul')) {\n\t                            parentList.parentNode.insertBefore(li, parentList);\n\t                            if (domUtils.isEmptyNode(parentList)) {\n\t                                domUtils.remove(parentList);\n\t                            }\n\t                        } else {\n\t\n\t                            while (li.firstChild) {\n\t                                parentList.parentNode.insertBefore(li.firstChild, parentList);\n\t                            }\n\t\n\t                            domUtils.remove(li);\n\t                            if (domUtils.isEmptyNode(parentList)) {\n\t                                domUtils.remove(parentList);\n\t                            }\n\t                        }\n\t                        range.moveToBookmark(bk).setCursor(false, true);\n\t                        me.fireEvent('contentchange');\n\t                        me.fireEvent('saveScene');\n\t                        domUtils.preventDefault(evt);\n\t                        return;\n\t                    }\n\t                }\n\t            }\n\t        }\n\t    });\n\t\n\t    me.addListener('keyup', function (type, evt) {\n\t        var keyCode = evt.keyCode || evt.which;\n\t        if (keyCode == 8) {\n\t            var rng = me.selection.getRange(),\n\t                list;\n\t            if (list = domUtils.findParentByTagName(rng.startContainer, ['ol', 'ul'], true)) {\n\t                adjustList(list, list.tagName.toLowerCase(), getStyle(list) || domUtils.getComputedStyle(list, 'list-style-type'), true);\n\t            }\n\t        }\n\t    });\n\t    //处理tab键\n\t    me.addListener('tabkeydown', function () {\n\t\n\t        var range = me.selection.getRange();\n\t\n\t        //控制级数\n\t        function checkLevel(li) {\n\t            if (me.options.maxListLevel != -1) {\n\t                var level = li.parentNode,\n\t                    levelNum = 0;\n\t                while (/[ou]l/i.test(level.tagName)) {\n\t                    levelNum++;\n\t                    level = level.parentNode;\n\t                }\n\t                if (levelNum >= me.options.maxListLevel) {\n\t                    return true;\n\t                }\n\t            }\n\t        }\n\t        //只以开始为准\n\t        //todo 后续改进\n\t        var li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t        if (li) {\n\t\n\t            var bk;\n\t            if (range.collapsed) {\n\t                if (checkLevel(li)) return true;\n\t                var parentLi = li.parentNode,\n\t                    list = me.document.createElement(parentLi.tagName),\n\t                    index = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t                index = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t                var currentStyle = listStyle[list.tagName][index];\n\t                setListStyle(list, currentStyle);\n\t                if (domUtils.isStartInblock(range)) {\n\t                    me.fireEvent('saveScene');\n\t                    bk = range.createBookmark();\n\t                    parentLi.insertBefore(list, li);\n\t                    list.appendChild(li);\n\t                    adjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t                    me.fireEvent('contentchange');\n\t                    range.moveToBookmark(bk).select(true);\n\t                    return true;\n\t                }\n\t            } else {\n\t                me.fireEvent('saveScene');\n\t                bk = range.createBookmark();\n\t                for (var i = 0, closeList, parents = domUtils.findParents(li), ci; ci = parents[i++];) {\n\t                    if (domUtils.isTagNode(ci, 'ol ul')) {\n\t                        closeList = ci;\n\t                        break;\n\t                    }\n\t                }\n\t                var current = li;\n\t                if (bk.end) {\n\t                    while (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t                        if (checkLevel(current)) {\n\t                            current = domUtils.getNextDomNode(current, false, null, function (node) {\n\t                                return node !== closeList;\n\t                            });\n\t                            continue;\n\t                        }\n\t                        var parentLi = current.parentNode,\n\t                            list = me.document.createElement(parentLi.tagName),\n\t                            index = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t                        var currentIndex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t                        var currentStyle = listStyle[list.tagName][currentIndex];\n\t                        setListStyle(list, currentStyle);\n\t                        parentLi.insertBefore(list, current);\n\t                        while (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t                            li = current.nextSibling;\n\t                            list.appendChild(current);\n\t                            if (!li || domUtils.isTagNode(li, 'ol ul')) {\n\t                                if (li) {\n\t                                    while (li = li.firstChild) {\n\t                                        if (li.tagName == 'LI') {\n\t                                            break;\n\t                                        }\n\t                                    }\n\t                                } else {\n\t                                    li = domUtils.getNextDomNode(current, false, null, function (node) {\n\t                                        return node !== closeList;\n\t                                    });\n\t                                }\n\t                                break;\n\t                            }\n\t                            current = li;\n\t                        }\n\t                        adjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t                        current = li;\n\t                    }\n\t                }\n\t                me.fireEvent('contentchange');\n\t                range.moveToBookmark(bk).select();\n\t                return true;\n\t            }\n\t        }\n\t    });\n\t\n\t    function getLi(start) {\n\t        while (start && !domUtils.isBody(start)) {\n\t            if (start.nodeName == 'TABLE') {\n\t                return null;\n\t            }\n\t            if (start.nodeName == 'LI') {\n\t                return start;\n\t            }\n\t            start = start.parentNode;\n\t        }\n\t    }\n\t\n\t    /**\n\t     * 有序列表，与“insertunorderedlist”命令互斥\n\t     * @command insertorderedlist\n\t     * @method execCommand\n\t     * @param { String } command 命令字符串\n\t     * @param { String } style 插入的有序列表类型，值为：decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t     * @example\n\t     * ```javascript\n\t     * editor.execCommand( 'insertorderedlist','decimal');\n\t     * ```\n\t     */\n\t    /**\n\t     * 查询当前选区内容是否有序列表\n\t     * @command insertorderedlist\n\t     * @method queryCommandState\n\t     * @param { String } cmd 命令字符串\n\t     * @return { int } 如果当前选区是有序列表返回1，否则返回0\n\t     * @example\n\t     * ```javascript\n\t     * editor.queryCommandState( 'insertorderedlist' );\n\t     * ```\n\t     */\n\t    /**\n\t     * 查询当前选区内容是否有序列表\n\t     * @command insertorderedlist\n\t     * @method queryCommandValue\n\t     * @param { String } cmd 命令字符串\n\t     * @return { String } 返回当前有序列表的类型，值为null或decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t     * @example\n\t     * ```javascript\n\t     * editor.queryCommandValue( 'insertorderedlist' );\n\t     * ```\n\t     */\n\t\n\t    /**\n\t     * 无序列表，与“insertorderedlist”命令互斥\n\t     * @command insertunorderedlist\n\t     * @method execCommand\n\t     * @param { String } command 命令字符串\n\t     * @param { String } style 插入的无序列表类型，值为：circle,disc,square,dash,dot\n\t     * @example\n\t     * ```javascript\n\t     * editor.execCommand( 'insertunorderedlist','circle');\n\t     * ```\n\t     */\n\t    /**\n\t     * 查询当前是否有word文档粘贴进来的图片\n\t     * @command insertunorderedlist\n\t     * @method insertunorderedlist\n\t     * @param { String } command 命令字符串\n\t     * @return { int } 如果当前选区是无序列表返回1，否则返回0\n\t     * @example\n\t     * ```javascript\n\t     * editor.queryCommandState( 'insertunorderedlist' );\n\t     * ```\n\t     */\n\t    /**\n\t     * 查询当前选区内容是否有序列表\n\t     * @command insertunorderedlist\n\t     * @method queryCommandValue\n\t     * @param { String } command 命令字符串\n\t     * @return { String } 返回当前无序列表的类型，值为null或circle,disc,square,dash,dot\n\t     * @example\n\t     * ```javascript\n\t     * editor.queryCommandValue( 'insertunorderedlist' );\n\t     * ```\n\t     */\n\t\n\t    me.commands['insertorderedlist'] = me.commands['insertunorderedlist'] = {\n\t        execCommand: function execCommand(command, style) {\n\t\n\t            if (!style) {\n\t                style = command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc';\n\t            }\n\t            var me = this,\n\t                range = this.selection.getRange(),\n\t                filterFn = function filterFn(node) {\n\t                return node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n\t            },\n\t                tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul',\n\t                frag = me.document.createDocumentFragment();\n\t            //去掉是因为会出现选到末尾，导致adjustmentBoundary缩到ol/ul的位置\n\t            //range.shrinkBoundary();//.adjustmentBoundary();\n\t\n\t            if (getContent(range).indexOf(grepDom) != -1) {\n\t                return false;\n\t            }\n\t            range.adjustmentBoundary().shrinkBoundary();\n\t            var bko = range.createBookmark(true),\n\t                start = getLi(me.document.getElementById(bko.start)),\n\t                modifyStart = 0,\n\t                end = getLi(me.document.getElementById(bko.end)),\n\t                modifyEnd = 0,\n\t                startParent,\n\t                endParent,\n\t                list,\n\t                tmp;\n\t\n\t            if (start || end) {\n\t                start && (startParent = start.parentNode);\n\t                if (!bko.end) {\n\t                    end = start;\n\t                }\n\t                end && (endParent = end.parentNode);\n\t\n\t                if (startParent === endParent) {\n\t                    while (start !== end) {\n\t                        tmp = start;\n\t                        start = start.nextSibling;\n\t                        if (!domUtils.isBlockElm(tmp.firstChild)) {\n\t                            var p = me.document.createElement('p');\n\t                            while (tmp.firstChild) {\n\t                                p.appendChild(tmp.firstChild);\n\t                            }\n\t                            tmp.appendChild(p);\n\t                        }\n\t                        frag.appendChild(tmp);\n\t                    }\n\t                    tmp = me.document.createElement('span');\n\t                    startParent.insertBefore(tmp, end);\n\t                    if (!domUtils.isBlockElm(end.firstChild)) {\n\t                        p = me.document.createElement('p');\n\t                        while (end.firstChild) {\n\t                            p.appendChild(end.firstChild);\n\t                        }\n\t                        end.appendChild(p);\n\t                    }\n\t                    frag.appendChild(end);\n\t                    domUtils.breakParent(tmp, startParent);\n\t                    if (domUtils.isEmptyNode(tmp.previousSibling)) {\n\t                        domUtils.remove(tmp.previousSibling);\n\t                    }\n\t                    if (domUtils.isEmptyNode(tmp.nextSibling)) {\n\t                        domUtils.remove(tmp.nextSibling);\n\t                    }\n\t                    var nodeStyle = getStyle(startParent) || domUtils.getComputedStyle(startParent, 'list-style-type') || (command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc');\n\t                    if (startParent.tagName.toLowerCase() == tag && nodeStyle == style) {\n\t                        for (var i = 0, ci, tmpFrag = me.document.createDocumentFragment(); ci = frag.firstChild;) {\n\t                            if (domUtils.isTagNode(ci, 'ol ul')) {\n\t                                //                                  删除时，子列表不处理\n\t                                //                                  utils.each(domUtils.getElementsByTagName(ci,'li'),function(li){\n\t                                //                                        while(li.firstChild){\n\t                                //                                            tmpFrag.appendChild(li.firstChild);\n\t                                //                                        }\n\t                                //\n\t                                //                                    });\n\t                                tmpFrag.appendChild(ci);\n\t                            } else {\n\t                                while (ci.firstChild) {\n\t\n\t                                    tmpFrag.appendChild(ci.firstChild);\n\t                                    domUtils.remove(ci);\n\t                                }\n\t                            }\n\t                        }\n\t                        tmp.parentNode.insertBefore(tmpFrag, tmp);\n\t                    } else {\n\t                        list = me.document.createElement(tag);\n\t                        setListStyle(list, style);\n\t                        list.appendChild(frag);\n\t                        tmp.parentNode.insertBefore(list, tmp);\n\t                    }\n\t\n\t                    domUtils.remove(tmp);\n\t                    list && adjustList(list, tag, style);\n\t                    range.moveToBookmark(bko).select();\n\t                    return;\n\t                }\n\t                //开始\n\t                if (start) {\n\t                    while (start) {\n\t                        tmp = start.nextSibling;\n\t                        if (domUtils.isTagNode(start, 'ol ul')) {\n\t                            frag.appendChild(start);\n\t                        } else {\n\t                            var tmpfrag = me.document.createDocumentFragment(),\n\t                                hasBlock = 0;\n\t                            while (start.firstChild) {\n\t                                if (domUtils.isBlockElm(start.firstChild)) {\n\t                                    hasBlock = 1;\n\t                                }\n\t                                tmpfrag.appendChild(start.firstChild);\n\t                            }\n\t                            if (!hasBlock) {\n\t                                var tmpP = me.document.createElement('p');\n\t                                tmpP.appendChild(tmpfrag);\n\t                                frag.appendChild(tmpP);\n\t                            } else {\n\t                                frag.appendChild(tmpfrag);\n\t                            }\n\t                            domUtils.remove(start);\n\t                        }\n\t\n\t                        start = tmp;\n\t                    }\n\t                    startParent.parentNode.insertBefore(frag, startParent.nextSibling);\n\t                    if (domUtils.isEmptyNode(startParent)) {\n\t                        range.setStartBefore(startParent);\n\t                        domUtils.remove(startParent);\n\t                    } else {\n\t                        range.setStartAfter(startParent);\n\t                    }\n\t                    modifyStart = 1;\n\t                }\n\t\n\t                if (end && domUtils.inDoc(endParent, me.document)) {\n\t                    //结束\n\t                    start = endParent.firstChild;\n\t                    while (start && start !== end) {\n\t                        tmp = start.nextSibling;\n\t                        if (domUtils.isTagNode(start, 'ol ul')) {\n\t                            frag.appendChild(start);\n\t                        } else {\n\t                            tmpfrag = me.document.createDocumentFragment();\n\t                            hasBlock = 0;\n\t                            while (start.firstChild) {\n\t                                if (domUtils.isBlockElm(start.firstChild)) {\n\t                                    hasBlock = 1;\n\t                                }\n\t                                tmpfrag.appendChild(start.firstChild);\n\t                            }\n\t                            if (!hasBlock) {\n\t                                tmpP = me.document.createElement('p');\n\t                                tmpP.appendChild(tmpfrag);\n\t                                frag.appendChild(tmpP);\n\t                            } else {\n\t                                frag.appendChild(tmpfrag);\n\t                            }\n\t                            domUtils.remove(start);\n\t                        }\n\t                        start = tmp;\n\t                    }\n\t                    var tmpDiv = domUtils.createElement(me.document, 'div', {\n\t                        'tmpDiv': 1\n\t                    });\n\t                    domUtils.moveChild(end, tmpDiv);\n\t\n\t                    frag.appendChild(tmpDiv);\n\t                    domUtils.remove(end);\n\t                    endParent.parentNode.insertBefore(frag, endParent);\n\t                    range.setEndBefore(endParent);\n\t                    if (domUtils.isEmptyNode(endParent)) {\n\t                        domUtils.remove(endParent);\n\t                    }\n\t\n\t                    modifyEnd = 1;\n\t                }\n\t            }\n\t\n\t            if (!modifyStart) {\n\t                range.setStartBefore(me.document.getElementById(bko.start));\n\t            }\n\t            if (bko.end && !modifyEnd) {\n\t                range.setEndAfter(me.document.getElementById(bko.end));\n\t            }\n\t            range.enlarge(true, function (node) {\n\t                return notExchange[node.tagName];\n\t            });\n\t\n\t            frag = me.document.createDocumentFragment();\n\t\n\t            var bk = range.createBookmark(),\n\t                current = domUtils.getNextDomNode(bk.start, false, filterFn),\n\t                tmpRange = range.cloneRange(),\n\t                tmpNode,\n\t                block = domUtils.isBlockElm;\n\t\n\t            while (current && current !== bk.end && domUtils.getPosition(current, bk.end) & domUtils.POSITION_PRECEDING) {\n\t\n\t                if (current.nodeType == 3 || dtd.li[current.tagName]) {\n\t                    if (current.nodeType == 1 && dtd.$list[current.tagName]) {\n\t                        while (current.firstChild) {\n\t                            frag.appendChild(current.firstChild);\n\t                        }\n\t                        tmpNode = domUtils.getNextDomNode(current, false, filterFn);\n\t                        domUtils.remove(current);\n\t                        current = tmpNode;\n\t                        continue;\n\t                    }\n\t                    tmpNode = current;\n\t                    tmpRange.setStartBefore(current);\n\t\n\t                    while (current && current !== bk.end && (!block(current) || domUtils.isBookmarkNode(current))) {\n\t                        tmpNode = current;\n\t                        current = domUtils.getNextDomNode(current, false, null, function (node) {\n\t                            return !notExchange[node.tagName];\n\t                        });\n\t                    }\n\t\n\t                    if (current && block(current)) {\n\t                        tmp = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\t                        if (tmp && domUtils.isBookmarkNode(tmp)) {\n\t                            current = domUtils.getNextDomNode(tmp, false, filterFn);\n\t                            tmpNode = tmp;\n\t                        }\n\t                    }\n\t                    tmpRange.setEndAfter(tmpNode);\n\t\n\t                    current = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\t\n\t                    var li = range.document.createElement('li');\n\t\n\t                    li.appendChild(tmpRange.extractContents());\n\t                    if (domUtils.isEmptyNode(li)) {\n\t                        var tmpNode = range.document.createElement('p');\n\t                        while (li.firstChild) {\n\t                            tmpNode.appendChild(li.firstChild);\n\t                        }\n\t                        li.appendChild(tmpNode);\n\t                    }\n\t                    frag.appendChild(li);\n\t                } else {\n\t                    current = domUtils.getNextDomNode(current, true, filterFn);\n\t                }\n\t            }\n\t            range.moveToBookmark(bk).collapse(true);\n\t            list = me.document.createElement(tag);\n\t            setListStyle(list, style);\n\t            list.appendChild(frag);\n\t            range.insertNode(list);\n\t            //当前list上下看能否合并\n\t            adjustList(list, tag, style);\n\t            //去掉冗余的tmpDiv\n\t            for (var i = 0, ci, tmpDivs = domUtils.getElementsByTagName(list, 'div'); ci = tmpDivs[i++];) {\n\t                if (ci.getAttribute('tmpDiv')) {\n\t                    domUtils.remove(ci, true);\n\t                }\n\t            }\n\t            range.moveToBookmark(bko).select();\n\t        },\n\t        queryCommandState: function queryCommandState(command) {\n\t            var tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t            var path = this.selection.getStartElementPath();\n\t            for (var i = 0, ci; ci = path[i++];) {\n\t                if (ci.nodeName == 'TABLE') {\n\t                    return 0;\n\t                }\n\t                if (tag == ci.nodeName.toLowerCase()) {\n\t                    return 1;\n\t                };\n\t            }\n\t            return 0;\n\t        },\n\t        queryCommandValue: function queryCommandValue(command) {\n\t            var tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t            var path = this.selection.getStartElementPath(),\n\t                node;\n\t            for (var i = 0, ci; ci = path[i++];) {\n\t                if (ci.nodeName == 'TABLE') {\n\t                    node = null;\n\t                    break;\n\t                }\n\t                if (tag == ci.nodeName.toLowerCase()) {\n\t                    node = ci;\n\t                    break;\n\t                };\n\t            }\n\t            return node ? getStyle(node) || domUtils.getComputedStyle(node, 'list-style-type') : null;\n\t        }\n\t    };\n\t};\n\n/***/ }),\n/* 152 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tbaidu.editor.ui.Button.prototype.getHtmlTpl = function () {\n\t\n\t    /* if (!this.iconEle) {\n\t          var str;\n\t         switch (this.title) {\n\t             case \"加粗\":\n\t                 str = \"B\";\n\t                 break;\n\t             case \"斜体\":\n\t                 str = \"I\"\n\t                 break;\n\t             case \"下划线\":\n\t                 str = \"U\"\n\t                 break;\n\t             case \"有序列表\":\n\t                 str = \"有\"\n\t                 break;\n\t             case \"无序列表\":\n\t                 str = \"无\";\n\t                 break;\n\t             case \"居左对齐\":\n\t                 str = \"左\"\n\t                 break;\n\t             case \"居中对齐\":\n\t                 str = \"中\"\n\t                 break;\n\t             case \"居右对齐\":\n\t                 str = \"右\"\n\t                 break;\n\t             default:\n\t                 str = \"测试\";\n\t         }\n\t         this.iconEle = \"<em>\" + str + \"</em>\";\n\t     }\n\t     return '<div id=\"##\" class=\"edui-box %%\">' +\n\t         '<div id=\"##_state\" stateful>' +\n\t         '<div class=\"%%-wrap\">' +\n\t         '<a id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n\t         ' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\" href=\"javascript:;\" data-node=\"toolbarBtn\">' +\n\t         (this.showIcon ? this.iconEle : '') +\n\t         (this.showText ? '<span>' + this.label + '</span>' : '') +\n\t         '</a>' +\n\t         '</div>' +\n\t         '</div></div>';*/\n\t\n\t    return '<div id=\"##\" class=\"edui-box %%\">' + '<div id=\"##_state\" stateful>' + '<div class=\"%%-wrap\">' + '<div id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') + ' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\">' + (this.showIcon ? '<div class=\"edui-box edui-icon\"></div>' : '') +\n\t    /* (this.showText ? '<div class=\"edui-box edui-label\">' + this.label + '</div>' : '') +*/\n\t    '</div>' + '</div>' + '</div></div>';\n\t};\n\n/***/ }),\n/* 153 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar alert = __webpack_require__(36);\n\tvar config = __webpack_require__(122);\n\t\n\tUE.commands['insertgoodshtml'] = {\n\t    execCommand: function execCommand(command, html, notNeedFilter) {\n\t        var me = this;\n\t        //限制商品数量\n\t        var limitNum = config.goodsLimitNUm;\n\t        var reg = /<div.*?gmp-ebox.*?>/gi;\n\t        //获取html的商品数\n\t        var innerGoods = html.match(reg),\n\t            innerGoodsLen = innerGoods ? innerGoods.length : 0;\n\t        //获取editor商品数\n\t        var ueGoods = me.getContent().match(reg),\n\t            outerGoodsLen = ueGoods ? ueGoods.length : 0;\n\t\n\t        if (innerGoodsLen + outerGoodsLen > limitNum) {\n\t            html = '';\n\t            alert('您最多能添加' + limitNum + '张图片哦！');\n\t            return;\n\t        }\n\t\n\t        me.execCommand('inserthtml', html, true);\n\t        return false;\n\t    }\n\t};\n\n/***/ }),\n/* 154 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar utils = baidu.editor.utils,\n\t    uiUtils = baidu.editor.ui.uiUtils,\n\t    domUtils = baidu.editor.dom.domUtils,\n\t    UIBase = baidu.editor.ui.UIBase;\n\tvar ANCHOR_CLASSES = ['edui-anchor-topright', 'edui-anchor-topright', 'edui-anchor-bottomleft', 'edui-anchor-bottomright'];\n\tbaidu.editor.ui.Popup.prototype.showAnchorRect = function (rect, hoz, adj) {\n\t    var width = this.anchorEl.width;\n\t    var height = this.anchorEl.height;\n\t    this._doAutoRender();\n\t    var vpRect = uiUtils.getViewportRect();\n\t    baidu.editor.ui.Button.prototype;\n\t    this.getDom().style.visibility = 'hidden';\n\t    this._show();\n\t    var popSize = this.fitSize();\n\t    var sideLeft, sideUp, left, top;\n\t    if (hoz) {\n\t        sideLeft = this.canSideLeft && rect.right + popSize.width > vpRect.right && rect.left > popSize.width;\n\t        sideUp = this.canSideUp && rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height;\n\t        left = sideLeft ? rect.left - popSize.width : rect.right;\n\t        //top = (sideUp ? rect.bottom - popSize.height : rect.top);\n\t    } else {\n\t        sideLeft = this.canSideLeft && rect.right + popSize.width > vpRect.right && rect.left > popSize.width;\n\t        sideUp = this.canSideUp && rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height;\n\t        left = sideLeft ? rect.right - popSize.width : rect.left;\n\t        //top = (sideUp ? rect.top - popSize.height : rect.bottom);\n\t    }\n\t\n\t    var popEl = this.getDom();\n\t    var objs = {\n\t        left: left,\n\t        top: top\n\t    };\n\t    if (this.cutstomPosition) {\n\t        if (this.cutstomPosition == 'top-right') {\n\t            var popWidth = $(popEl).width();\n\t            objs = {\n\t                left: rect.right - popWidth,\n\t                top: rect.top\n\t            };\n\t        } else {\n\t            objs = {\n\t                left: left,\n\t                top: rect.bottom\n\t            };\n\t        }\n\t    }\n\t\n\t    uiUtils.setViewportOffset(popEl, objs);\n\t    domUtils.removeClasses(popEl, ANCHOR_CLASSES);\n\t    popEl.className += ' ' + ANCHOR_CLASSES[(sideUp ? 1 : 0) * 2 + (sideLeft ? 1 : 0)];\n\t    if (this.editor) {\n\t        popEl.style.zIndex = this.editor.container.style.zIndex * 1 + 10;\n\t        baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = popEl.style.zIndex - 1;\n\t    }\n\t    this.getDom().style.visibility = 'visible';\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 155 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t//require('./copy');\n\t__webpack_require__(156);\n\n/***/ }),\n/* 156 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tUE.plugins['source'] = function () {};\n\n/***/ }),\n/* 157 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tif (!Array.prototype.indexOf) {\n\t  Array.prototype.indexOf = function (elt /*, from*/) {\n\t    var len = this.length >>> 0;\n\t\n\t    var from = Number(arguments[1]) || 0;\n\t    from = from < 0 ? Math.ceil(from) : Math.floor(from);\n\t    if (from < 0) from += len;\n\t\n\t    for (; from < len; from++) {\n\t      if (from in this && this[from] === elt) return from;\n\t    }\n\t    return -1;\n\t  };\n\t}\n\n/***/ }),\n/* 158 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * [表情]\n\t * @Author: Fu Xiaochun\n\t * @Email: \tfuzhengchun@gomeplus.com\n\t */\n\tvar emojis = __webpack_require__(55);\n\tvar backward = __webpack_require__(76);\n\tvar faceTpl = __webpack_require__(77);\n\t\n\tvar emojiData = null;\n\t\n\t// 将表情转换成map\n\tvar emojiMap = {};\n\t\n\t// 数据适配转换\n\tvar makeData = function makeData(data) {\n\t    var total = data.length;\n\t    var offset = 24;\n\t    var page = Math.ceil(total / offset);\n\t    var list = [];\n\t\n\t    for (var i = 0; i < page; i++) {\n\t        list[i] = [];\n\t        var end = offset * (i + 1);\n\t        end = end > total ? total : end;\n\t        for (var j = i * offset; j < end; j++) {\n\t            var emoji = data[j];\n\t            list[i].push(emoji);\n\t            emojiMap[emoji.name] = emoji.url;\n\t        }\n\t    }\n\t    emojiData = {\n\t        page: new Array(page),\n\t        list: list\n\t    };\n\t    return emojiData;\n\t};\n\t\n\tvar Face = function Face(opts) {\n\t    var foo = function foo() {};\n\t    this.$dom = null;\n\t    this.isShow = false;\n\t    this.onSelected = opts.onSelected || foo;\n\t};\n\t\n\tFace.prototype = {\n\t    constructor: Face,\n\t    _bindHtml: function _bindHtml() {\n\t        var data = emojiData || makeData(emojis);\n\t        var faceHTML = faceTpl(data);\n\t        this.$dom = $(faceHTML);\n\t    },\n\t    _bindEvent: function _bindEvent() {\n\t        var _this = this;\n\t\n\t        // tab方式显示所选页\n\t        var setShowIndex = function setShowIndex(index) {\n\t            var activeCls = 'active';\n\t            var hideCls = 'hide';\n\t            index = index || 0;\n\t\n\t            $('[data-action=facePage] > li').eq(index).addClass(activeCls).siblings('li').removeClass(activeCls);\n\t            $('[data-node=faceList] > div').eq(index).removeClass(hideCls).siblings('div').addClass(hideCls);\n\t        };\n\t\n\t        this.$dom.on('click.face', function (e) {\n\t            e.stopPropagation();\n\t        });\n\t        $(document).on('click.face', function () {\n\t            _this.hide();\n\t        });\n\t        // 分页切换显示\n\t        this.$dom.on('mouseenter', '[data-action=facePage] > li', function () {\n\t            var index = $(this).index();\n\t            setShowIndex(index);\n\t        });\n\t\n\t        this.$dom.on('click.face', '[data-face]', function () {\n\t            var $this = $(this);\n\t            var faceReg = $this.data('face');\n\t            var faceUrl = $this.attr('src');\n\t            _this.onSelected({\n\t                reg: faceReg,\n\t                url: faceUrl\n\t            });\n\t            _this.isShow !== false && _this.hide();\n\t            return false;\n\t        });\n\t    },\n\t    show: function show(x, y) {\n\t        if (this.isShow) {\n\t            return;\n\t        }\n\t        this.$dom || this._bindHtml();\n\t        $('body').append(this.$dom);\n\t        this.$dom.css({\n\t            left: x + 'px',\n\t            top: y + 'px'\n\t        }).show();\n\t        this.isShow = true;\n\t        this._bindEvent();\n\t    },\n\t    hide: function hide() {\n\t        if (!this.isShow) {\n\t            return;\n\t        }\n\t        this.$dom.off('.face');\n\t        $(document).off('.face');\n\t        this.$dom.hide().remove();\n\t        this.isShow = false;\n\t    }\n\t};\n\t\n\t// 把表情占位符替换成img\n\tvar parseEmoji = function parseEmoji(str) {\n\t    var r = /(\\[([\\s\\S]+?)\\])/g;\n\t    if ($.isEmptyObject(emojiMap)) {\n\t        makeData(emojis);\n\t    }\n\t\n\t    return str.replace(r, function (s, $1, name) {\n\t        var img = emojiMap[name];\n\t        if (img) {\n\t            return '<img width=\"22\" height=\"22\" src=\"' + img + '\" />';\n\t        } else {\n\t            // 兼容旧版表情\n\t            var old = backward[name];\n\t            if (old) {\n\t                return '<img width=\"22\" height=\"22\" src=\"' + old.url + '\" />';\n\t            }\n\t            return s;\n\t        }\n\t    });\n\t};\n\t\n\tvar faceInstance = null;\n\tvar init = function init(opts) {\n\t    if (!faceInstance) {\n\t        faceInstance = new Face(opts);\n\t    }\n\t    return faceInstance;\n\t};\n\tmodule.exports = {\n\t    init: init,\n\t    parseEmoji: parseEmoji\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 159 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {\"use strict\";\n\t\n\tfunction goodsdMask(ue) {\n\t    var close = 0;\n\t\n\t    ue.addListener('selectionchange', function (editor) {\n\t        function hideMask() {\n\t            //var b = ue.body.getElementsByTagName('b');\n\t            $(ue.body).find(\".cover\").removeClass(\"show\");\n\t        }\n\t\n\t        //查找选区范围\n\t        var range = ue.selection.getRange();\n\t        //range.select();\n\t        var s = [].concat(ue.selection.getStartElementPath());\n\t\n\t        var len = s.length - 2;\n\t\n\t        if (len < 0) return;\n\t\n\t        s = s[len];\n\t\n\t        var tagName = s.tagName;\n\t        switch (tagName) {\n\t            case \"DIV\":\n\t                hideMask();\n\t                var $s = $(s);\n\t                var $el = $s.find(\".cover\");\n\t                var lenth = $el.length;\n\t\n\t                if (!lenth) {\n\t                    $s.append('<div class=\"cover show\">iii</div>');\n\t                    $s.attr('contenteditable', 'false');\n\t                } else {\n\t                    $el.addClass(\"show\");\n\t                }\n\t\n\t                close = 1;\n\t                var nextNode = s.nextSibling;\n\t                if (!nextNode) {\n\t                    var newNode = ue.createElement('p');\n\t                    var textNode = ue.createTextNode(text);\n\t                    newNode.appendChild(textNode);\n\t                    domUtils.insertAfter(s, newNode);\n\t                }\n\t                range.setStart(nextNode, 0).collapse(true).setCursor();\n\t\n\t                break;\n\t            case \"P\":\n\t                if (close == 0) return;\n\t                hideMask();\n\t                close = 0;\n\t                break;\n\t            default:\n\t                if (close == 0) return;\n\t                hideMask();\n\t                close = 0;\n\t                break;\n\t        }\n\t    });\n\t}\n\t\n\tmodule.exports = goodsdMask;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 160 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tvar rewriteTxtRules = function rewriteTxtRules(ue, fn) {\n\t    var txtRules = fn(ue);\n\t    var newRules = ue.options.filterTxtRules;\n\t    UE.utils.extend(newRules, txtRules);\n\t    ue.setOpt(\"filterTxtRules\", newRules);\n\t};\n\t\n\tvar rules = function rules(ue) {\n\t\n\t    return {\n\t        'img': {\n\t            $: {\n\t                'src': 1,\n\t                'data-type': 1,\n\t                '_src': 1,\n\t                'angle': 1,\n\t                'width': 1,\n\t                'height': 1,\n\t                'data-original': 1,\n\t                'proto': 1\n\t            }\n\t        }\n\t    };\n\t};\n\t\n\tvar init = function init(ue) {\n\t    //过滤图片和替换表情\n\t    rewriteTxtRules(ue, rules);\n\t};\n\t\n\tmodule.exports = init;\n\n/***/ }),\n/* 161 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\t\n\tvar restoreContent = __webpack_require__(162);\n\t\n\tvar editPath = $GLOBAL_CONFIG['from']; //0 新页面  1 编辑话题  2  草稿\n\tvar editKey = $GLOBAL_CONFIG['tid'];\n\tvar unsuccessful = __webpack_require__(166);\n\tvar imgReplace = __webpack_require__(118);\n\t\n\tfunction restoreData(editor) {\n\t    //加载草稿箱\n\t    if (editPath == undefined) return;\n\t\n\t    switch (editPath) {\n\t        case '0':\n\t            return;\n\t        case '1':\n\t            $(\"[data-action=save]\").remove();\n\t    }\n\t\n\t    var datas;\n\t    var _url;\n\t    switch (editPath) {\n\t        case '1':\n\t            datas = {\n\t                tid: editKey\n\t            };\n\t            _url = url.get('readTopicData');\n\t            break;\n\t        case '2':\n\t            datas = {\n\t                tid: editKey\n\t            };\n\t            _url = url.get('readTopicDraftsData');\n\t    }\n\t\n\t    fetch.get(_url, {\n\t        data: datas\n\t    }).done(function (data) {\n\t        if (data.success === true) {\n\t            var strs = restoreContent(data);\n\t            editor.execCommand('inserthtml', strs);\n\t            setTimeout(function () {\n\t                imgReplace.changeSrc($(editor.body));\n\t            }, 2000);\n\t        } else {\n\t            unsuccessful.init(data);\n\t        }\n\t    }).fail(function (data) {\n\t        console.log(data, \"err\");\n\t    });\n\t}\n\t\n\tmodule.exports = restoreData;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 162 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar $title = $('[data-node=topicTitle]');\n\tvar $topicTitleTips = $('[data-node=topicTitleTips]');\n\tvar $titleCharLen = $('[data-node=titleCharLen]');\n\tvar $crtLists = $('[data-node=crt-lists]');\n\tvar $selectGroup = $('[data-action=selectGroup]');\n\tvar empty = __webpack_require__(130);\n\tvar decode = __webpack_require__(163);\n\t\n\tvar labelTpl = __webpack_require__(164);\n\tvar itemTpl = __webpack_require__(165);\n\t\n\tvar imgReplace = __webpack_require__(118);\n\t\n\tvar isMeihao = $GLOBAL_CONFIG.channel;\n\t\n\tvar originRule1 = /\\.600q80\\.jpg/gi;\n\tvar originRule2 = /-600!80\\./g;\n\t\n\tfunction orignText(str) {\n\t    str = str.replace(originRule1, '');\n\t    return str.replace(originRule2, '.');\n\t}\n\t\n\tfunction restore(data) {\n\t    if (data.success == true) {\n\t        var num = 0;\n\t        var strs = \"\";\n\t        var datas = data.data;\n\t        var components = datas.components;\n\t\n\t        restoreTitle(datas);\n\t        restoreLabel(datas);\n\t        restoreGroup(datas);\n\t\n\t        for (var i = 0; i < components.length; i++) {\n\t\n\t            var arrs = components[i];\n\t            var type = arrs.type;\n\t            switch (type) {\n\t                case 'text':\n\t                    strs += restoreText(arrs);\n\t                    break;\n\t                case 'image':\n\t                    strs += restoreImg(arrs, num);\n\t                    break;\n\t                case 'item':\n\t                    strs += restoreItem(arrs);\n\t                    break;\n\t            }\n\t        }\n\t        return strs;\n\t    }\n\t}\n\t\n\tfunction formatText(text) {\n\t    var strs = \"\";\n\t    var temp = \"\";\n\t    temp = text.replace(/[\\n|\\r]/gi, function (i) {\n\t        return ',';\n\t    });\n\t\n\t    temp = temp.split(',');\n\t\n\t    for (var i = 0; i < temp.length; i++) {\n\t        var content = $.trim(temp[i]);\n\t        if (content != '') {\n\t            strs += '<p>' + content + '</p>';\n\t        }\n\t    }\n\t    return strs;\n\t}\n\t\n\t//恢复标题\n\tfunction restoreTitle(data) {\n\t    var name = data.name;\n\t\n\t    if (name) {\n\t        name = decode(name);\n\t        $title.val(name);\n\t        $topicTitleTips.hide();\n\t        $titleCharLen.html(name.length);\n\t    }\n\t}\n\t\n\t//恢复文字\n\t// 有richText键，有值   渲染 richtext\n\t\n\t// 有richText键，值为空  不渲染text\n\t\n\t// 没有richText键  ，text有值  渲染 text\n\t\n\t\n\tfunction restoreText(data) {\n\t    var r = data.richText;\n\t    // 有键\n\t    if (r != 'undefined') {\n\t        //有值\n\t        if (r != '') {\n\t\n\t            var isVideo = /video-id=\"[\\d]+\"/.test(r);\n\t            //r = imgReplace.orignalImgReplace(r);\n\t            r = orignText(r);\n\t            if (isVideo && isMeihao) {\n\t                r = r.replace('</div>', \"\");\n\t                r = r.replace('<div', \"<img\");\n\t            }\n\t            return r;\n\t            //无值\n\t        } else {\n\t            return '';\n\t        }\n\t    } else {\n\t        if (data.text != '') {\n\t            //return '<p>' + data.text + '</p>';\n\t            return formatText(data.text);\n\t        } else {\n\t            return '';\n\t        }\n\t    }\n\t}\n\t//恢复图片\n\t//图片渲染需要渲染的情况：\n\t// 1、type=image 且 richText有值，用richText渲染\n\t// 2、type=image 且 没有richText字段，用url渲染\n\t\n\t// 不需要渲染的情况：\n\t// type=image 且 有richText字段但值为空\n\tfunction restoreImg(data, num) {\n\t\n\t    if (data.richText == \"\") {\n\t        return '';\n\t    }\n\t    if (data.richText == undefined) {\n\t        var tempSrc = imgReplace.imgReplace(data.url);\n\t        var tempProto = imgReplace.imgProto(data.url);\n\t        tempSrc = imgReplace.orignalImgReplace(tempSrc);\n\t        var img = '<img data-t =\"t-' + num + '\" data-type=\"insertImg\" src=\"' + tempSrc + '\" _src=\"' + tempSrc + '\" proto=\"' + tempProto + '\">';\n\t        num++;\n\t\n\t        var text = data.text;\n\t\n\t        //处理回车换行符号\n\t        if (text) {\n\t            img += formatText(text);\n\t        }\n\t\n\t        return img;\n\t    } else {\n\t        return data.richText;\n\t    }\n\t}\n\t\n\t//恢复商品\n\tfunction restoreItem(data) {\n\t\n\t    var item = data.item;\n\t    var json = {\n\t        skuId: item.skuId,\n\t        PId: item.id,\n\t        shopId: data.shopId,\n\t        link: item.itemDetailUrl,\n\t        img: imgReplace.imgReplace(item.mainImage),\n\t        price: item.salePrice,\n\t        title: item.name\n\t    };\n\t    var tpl = itemTpl(json);\n\t\n\t    if (empty(window.insertedGoods)) {\n\t        window.insertedGoods = {};\n\t    }\n\t\n\t    window.insertedGoods[item.skuId] = json;\n\t    //Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n\t    if (data.richText == '') {\n\t        return '';\n\t    } else {\n\t        return tpl;\n\t    }\n\t}\n\t\n\t//恢复标签\n\tfunction restoreLabel(data) {\n\t    var labels = data.labels || [];\n\t    var len = labels.length;\n\t    if (len) {\n\t        var str = \"\";\n\t        for (var i = 0; i < len; i++) {\n\t            var label = labels[i];\n\t            str += labelTpl({\n\t                id: label.id,\n\t                name: decode(label.name)\n\t            });\n\t        }\n\t        $crtLists.html(str);\n\t    }\n\t}\n\t\n\t//恢复圈子\n\tfunction restoreGroup(data) {\n\t\n\t    var gid = data.groupId;\n\t    if (gid) {\n\t        $selectGroup.attr(\"data-groupid\", gid).text(data.group.name);\n\t    }\n\t}\n\t\n\tmodule.exports = restore;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 163 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tvar unhtml = function unhtml(str) {\n\t    return str ? str.replace(/&((g|l|quo|ldquo|rdquo)t|amp|#39|nbsp);/g, function (m) {\n\t        return {\n\t            '&lt;': '<',\n\t            '&amp;': '&',\n\t            '&quot;': '\"',\n\t            '&ldquo;': '“',\n\t            '&rdquo;': '”',\n\t            '&gt;': '>',\n\t            '&#39;': \"'\",\n\t            '&nbsp;': ' '\n\t        }[m];\n\t    }) : '';\n\t};\n\t\n\tmodule.exports = unhtml;\n\n/***/ }),\n/* 164 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/editor/plugin/restore/lenovoLabel',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,name=$data.name,$out='';$out+='<li class=\"label-crt-items\" data-id=\"';\n\t$out+=$escape(id);\n\t$out+='\" title=\"';\n\t$out+=$escape(name);\n\t$out+='\"> <span class=\"crt-items-md\">';\n\t$out+=$escape(name);\n\t$out+='</span> <i class=\"crt-items-close\" data-node=\"crt-close\">×</i> </li> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 165 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/editor/plugin/goods/restoreGoods',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,skuId=$data.skuId,PId=$data.PId,shopId=$data.shopId,link=$data.link,img=$data.img,title=$data.title,price=$data.price,$out='';$out+='<p><br/></p><div data-node=\"gmp-ebox\" class=\"card-box\" contenteditable=\"false\"> <div data-type=\"insertGoods\" data-skuId=\"';\n\t$out+=$escape(skuId);\n\t$out+='\" data-pid=\"';\n\t$out+=$escape(PId);\n\t$out+='\" data-info=\\'{\"type\":\"item\",\"text\":\"\",\"id\":\"';\n\t$out+=$escape(PId);\n\t$out+='\",\"kid\":\"\", \"shopId\": \"';\n\t$out+=$escape(shopId);\n\t$out+='\",\"skuId\":\"';\n\t$out+=$escape(skuId);\n\t$out+='\"}\\' class=\"publish-item\"> <a href=\"';\n\t$out+=$escape(link);\n\t$out+='\" class=\"img-out\"> <img src=\"';\n\t$out+=$escape(img);\n\t$out+='\" data-node=\"goodsPic\"> </a> <div class=\"publish-cont\"> <h3 class=\"pub-tl\"> <a href=\"';\n\t$out+=$escape(link);\n\t$out+='\">';\n\t$out+=$escape(title);\n\t$out+='</a> </h3> <div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">';\n\t$out+=$escape(price);\n\t$out+='</strong> </div> <a href=\"';\n\t$out+=$escape(link);\n\t$out+='\" target=\"_blank\" class=\"scan-more\">查看详情</a> </div> </div> <div class=\"cover\">&nbsp;</div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 166 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar alert = __webpack_require__(36);\n\t\n\tvar unsuccessful = function unsuccessful(msg, relativePath) {\n\t    /*alert(msg, {\n\t        ok: function() {\n\t            window.location.href = $_CONFIG.group_domain + relativePath;\n\t        }\n\t    });*/\n\t    //页面强制跳转会对用户不友好，填写的数据可能会丢失！\n\t    alert(msg);\n\t};\n\t\n\tvar init = function init(data) {\n\t    var code;\n\t    var msg = data.message;\n\t    console.log(_typeof(data.code));\n\t    switch (data.code) {\n\t        case 101:\n\t            code = 'group';\n\t            msg = \"图片超出限定数量\";\n\t            break;\n\t        case 102:\n\t            code = 'group';\n\t            msg = \"上传图片存在非法提交\";\n\t            break;\n\t        case 103:\n\t            code = 'group';\n\t            msg = \"商品超出限定数量\";\n\t            break;\n\t        case 410:\n\t            code = 'group_dissolve';\n\t            break;\n\t        case 403:\n\t            code = 'group';\n\t            msg = \"抱歉，该圈子审核不通过！\";\n\t            break;\n\t        case 404:\n\t        case 422:\n\t        case '911918':\n\t            window.location.href = $_CONFIG.i_domain + 'expert/error_' + data.code + '.html';\n\t            return;\n\t        default:\n\t            alert(data.message);\n\t            return;\n\t    }\n\t    var relUrl = 'index/get_error?code=' + code;\n\t    unsuccessful(msg, relUrl);\n\t};\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 167 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t/* eslint-disable */\n\t\n\tvar str = '<div class=\"test\"  contenteditable=\"false\" data-node=\"gmp-ebox\" data-info= {\"id\":\"123\",\"shopId\":\"456\",\"kid\":\"789\"}>' + '<div data-node=\"goodsItem\" class=\"publish-item hover-dele\">' + '<a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\" class=\"img-out\"> <img src=\"https://i-pre.meixincdn.com/T1haCTBvJT1RXrhCrK.230x230cTzq80.jpg\" data-node=\"999\"> </a>' + '<div class=\"publish-cont\">' + '<h3 class=\"pub-tl\"> <a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\">情人节必备</a> </h3>' + '<div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">0.01</strong> </div>' + '<a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\" class=\"scan-more\">查看详情</a> ' + '</div>' + ' </div>' + '<b data-node=\"ifs\" style=\"position:absolute;top:0;left:0;width:1008px;background:#f00;height:230px;display:none;opacity:0.3;z-index:99999\">122</b>' + '</div>';\n\t\n\t//require('editor/rewrite/insertGoods')\n\t\n\tvar init = function init(ue) {\n\t    //test\n\t    $(function () {\n\t\n\t        ue.addListener('ready', function () {\n\t            var $body = $(\"iframe\").contents().find(\"body\");\n\t            //console.log($body)\n\t            $body.click(function () {\n\t                //console.log($body.find(\"[data-node='gmp-ebox']\"))\n\t            });\n\t            $body.on(\"[data-node='gmp-ebox']\", \"click\", function () {\n\t                //console.log($(this))\n\t                var range = ue.selection.getRange();\n\t                range.select();\n\t                var s = [].concat(ue.selection.getStartElementPath());\n\t                //console.log(s,1122)\n\t            });\n\t        });\n\t\n\t        var str2 = '123<b>000<em>111</em>0</b>321';\n\t\n\t        $(\"#insert\").on(\"click\", function () {\n\t            ue.execCommand('insertHtml', str, true);\n\t            ue.focus();\n\t        });\n\t        /*\n\t        \t\t$(\"#insert2\").on(\"click\",function(){\n\t        \t\t\tue.execCommand('insertHtml', '1234567890',true);\n\t        \t\t})\n\t        */\n\t\n\t        //var tempstr = '<p><video src=\"http://js.dev.meixincdn.com:1314/dist/images/video.mp4\" controls=\"controls\">您的浏览器不支持 video 标签。</video></p>'\n\t        var tempstr = '3321321<img src=\"http://js.dev.meixincdn.com:1314/dist/images/circle/index/act-box-img.png\">321321';\n\t        $(\"#insert2\").on(\"click\", function () {\n\t            ue.execCommand('insertHtml', tempstr, true);\n\t            // console.log(UE.htmlparser('<p><b>htmlparser</b></p>', true));\n\t            //ue.execCommand('haha', tempstr, true);\n\t        });\n\t\n\t        $(\"#viewCode\").on(\"click\", function () {\n\t            var nodes = ue.document.body.children;\n\t            var arr = [];\n\t            for (var i = 0; i < nodes.length; i++) {\n\t                var tagNode = nodes[i];\n\t                if (tagNode.tagName = \"P\") {\n\t                    //var txt = thisNode.innerHTML;\n\t                    var childNodes = tagNode.childNodes;\n\t\n\t                    for (var j = 0; j < childNodes.length; j++) {\n\t                        var _thisNode = childNodes[j];\n\t                        if (_thisNode.nodeType == 3) {\n\t                            var _thisValue = _thisNode.nodeValue;\n\t                            if (_thisValue !== \"\" || _thisValue !== \"&#8203\") {\n\t                                arr.push({\n\t                                    \"type\": \"text\",\n\t                                    \"text\": _thisValue\n\t                                });\n\t                                console.log(_thisValue, typeof _thisValue === 'undefined' ? 'undefined' : _typeof(_thisValue));\n\t                            }\n\t                        } else {\n\t                            if (_thisNode.tagName == \"IMG\") arr.push({\n\t                                \"type\": \"image\",\n\t                                \"text\": \"美图\",\n\t                                \"url\": _thisNode.src\n\t                            });\n\t                            if (_thisNode.tagName == \"BR\") {\n\t                                arr.push({\n\t                                    \"type\": \"text\",\n\t                                    \"text\": '<br/>'\n\t                                });\n\t                            }\n\t                        }\n\t                    }\n\t\n\t                    /*\n\t                    var reg = /<img.*?>/gi;\n\t                    var j = txt.split(reg)\n\t                    console.log(j)\n\t                    var newStr = '<p>';\n\t                    var j = txt.match(reg) ;\n\t                    */\n\t                    //var j =txt.replace(/<img.*?>/g,'hahaha');\n\t                    //console.log(j,12)\n\t                }\n\t                if (tagNode.tagName == \"DIV\") {\n\t                    var data = tagNode.attributes.data.value;\n\t                    data = JSON.parse(data);\n\t                    arr.push({\n\t                        \"type\": \"item\",\n\t                        \"text\": \"sg\",\n\t                        \"id\": data.id,\n\t                        \"shopId\": data.shopId,\n\t                        \"kid\": data.kid\n\t                    });\n\t                }\n\t            }\n\t            console.log(arr);\n\t        });\n\t\n\t        $(\"#submitCode\").on(\"click\", function () {\n\t            //ue.execCommand('insertHtml', '1234567890',true);\n\t            var t = ue.getContent();\n\t\n\t            function htmlNull(str) {\n\t                var re = str.replace(/\\n|\\r\\n/g, \"</br>\");\n\t                return re; //去掉所有的html标记\n\t            }\n\t            console.log(htmlNull(t));\n\t        });\n\t\n\t        $(\"#del\").on(\"click\", function () {\n\t            var range = ue.selection.getRange();\n\t            range.select();\n\t            var s = [].concat(ue.selection.getStartElementPath());\n\t\n\t            var parents = $(s[0]).parents('[data-node=listItemBox]');\n\t            if (parents.length > 0) {\n\t                console.log(parents.get(0));\n\t                //parents.find('[data-node=mask]').show();\n\t                range.setStart(parents.prev().get(0), 0);\n\t                range.setEnd(parents.next().get(0), 0);\n\t                range.select();\n\t            }\n\t        });\n\t    });\n\t};\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ })\n]);\n\n\n// WEBPACK FOOTER //\n// editor.js","/*   使用示例  初始化已经集成至init.js\nvar ue = UE.getEditor('editor',{\n\t\ttoolbars:[[]]\n\t});\n*/\nvar ueditor = require(\"editor/index\");\n//var editorOpt = require(\"editor/pcInit\");\n\nvar test = require(\"./test\");\n\nvar ue = ueditor();\n\ntest.init(ue);\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/editor/index.js","/*TMODJS:{}*/\r\n!function () {\r\n\tfunction a(a, b) {\r\n\t\treturn (/string|function/.test(typeof b) ? h : g)(a, b)\r\n\t}\r\n\r\n\tfunction b(a, c) {\r\n\t\treturn \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a\r\n\t}\r\n\r\n\tfunction c(a) {\r\n\t\treturn l[a]\r\n\t}\r\n\r\n\tfunction d(a) {\r\n\t\treturn b(a).replace(/&(?![\\w#]+;)|[<>\"']/g, c)\r\n\t}\r\n\r\n\tfunction e(a, b) {\r\n\t\tif (m(a))for (var c = 0, d = a.length; d > c; c++)b.call(a, a[c], c, a); else for (c in a)b.call(a, a[c], c)\r\n\t}\r\n\r\n\tfunction f(a, b) {\r\n\t\tvar c = /(\\/)[^\\/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^\\/]+$/, \"\"), e = d + b;\r\n\t\tfor (e = e.replace(/\\/\\.\\//g, \"/\"); e.match(c);)e = e.replace(c, \"/\");\r\n\t\treturn e\r\n\t}\r\n\r\n\tfunction g(b, c) {\r\n\t\tvar d = a.get(b) || i({filename: b, name: \"Render Error\", message: \"Template not found\"});\r\n\t\treturn c ? d(c) : d\r\n\t}\r\n\r\n\tfunction h(a, b) {\r\n\t\tif (\"string\" == typeof b) {\r\n\t\t\tvar c = b;\r\n\t\t\tb = function () {\r\n\t\t\t\treturn new k(c)\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar d = j[a] = function (c) {\r\n\t\t\ttry {\r\n\t\t\t\treturn new b(c, a) + \"\"\r\n\t\t\t} catch (d) {\r\n\t\t\t\treturn i(d)()\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn d.prototype = b.prototype = n, d.toString = function () {\r\n\t\t\treturn b + \"\"\r\n\t\t}, d\r\n\t}\r\n\r\n\tfunction i(a) {\r\n\t\tvar b = \"{Template Error}\", c = a.stack || \"\";\r\n\t\tif (c)c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); else for (var d in a)c += \"<\" + d + \">\\n\" + a[d] + \"\\n\\n\";\r\n\t\treturn function () {\r\n\t\t\treturn \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b\r\n\t\t}\r\n\t}\r\n\r\n\tvar j = a.cache = {}, k = this.String, l = {\r\n\t\t\"<\": \"&#60;\",\r\n\t\t\">\": \"&#62;\",\r\n\t\t'\"': \"&#34;\",\r\n\t\t\"'\": \"&#39;\",\r\n\t\t\"&\": \"&#38;\"\r\n\t}, m = Array.isArray || function (a) {\r\n\t\t\treturn \"[object Array]\" === {}.toString.call(a)\r\n\t\t}, n = a.utils = {\r\n\t\t$helpers: {}, $include: function (a, b, c) {\r\n\t\t\treturn a = f(c, a), g(a, b)\r\n\t\t}, $string: b, $escape: d, $each: e\r\n\t}, o = a.helpers = n.$helpers;\r\n\ta.get = function (a) {\r\n\t\treturn j[a.replace(/^\\.\\//, \"\")]\r\n\t}, a.helper = function (a, b) {\r\n\t\to[a] = b\r\n\t}, module.exports = a\r\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js\n// module id = 34\n// module chunks = 0 2 3 4 5 6 8 10 14 16 17 21 22 23 27 28 30 31 33 35 36 39 44 45 46","var Dialog = require('dialog');\nvar noop = function() {};\n\nvar create = function(content, options) {\n    content = content || '';\n    options = options || {};\n    var defaults = {\n        fixed: true,\n        modal: true,\n        autofocus: false,\n        content: '<p class=\"del-pop-p\">' + content + '</p>',\n        className: 'pop-box',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        ok: noop\n    };\n    $.extend(true, defaults, options);\n    var d = Dialog(defaults);\n\n    var header = d._$('header');\n    var title = d._$('title');\n    if(!options.title){\n        title.css('borderBottom', 'none');\n    }\n    header.show();\n    d.show();\n    return d;\n};\n\nmodule.exports = create;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/alert.js","/*\r\n * 弹层提示弹窗\r\n * zhaodonghong\r\n */\r\n\r\n\r\n\r\nvar $publicMask;\r\nvar $publicTips;\r\nvar timer;\r\n\r\n\r\nvar events = function() {\r\n\r\n    $publicMask.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n\r\n    $publicTips.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * msg string 提示信息\r\n * options object \r\n * options.duration settimout消失时间\r\n * options.callback 提示消失的回调\r\n*/\r\nvar init = function(msg, options) {\r\n    var defaults = {\r\n        duration: 2000,\r\n        callback: function() {}\r\n    };\r\n\r\n    $.extend(defaults, options || {});\r\n\r\n    clearTimeout(timer);\r\n    $publicMask = $('[data-action=\"publicMask\"]');\r\n    $publicTips = $('[data-action=\"publicTips\"]');\r\n\r\n    if ($publicMask.length > 0) {\r\n\r\n        $publicMask.show();\r\n        $publicTips.show().text(msg);\r\n\r\n    } else {\r\n\r\n        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\r\n        $publicMask = $('[data-action=\"publicMask\"]');\r\n        $publicTips = $('[data-action=\"publicTips\"]');\r\n        events();\r\n    }\r\n\r\n    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\r\n\r\n    timer = setTimeout(function() {\r\n\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n\r\n        defaults.callback();\r\n\r\n    }, defaults.duration);\r\n};\r\n\r\n\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    events: events\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/hint.js","var imgPath = $_CONFIG.imgpath + '/images/emoji/';\n\nvar ext = '.png';\n\nvar groupOne = [{\n    name: '微笑',\n    url: 'weixiao'\n}, {\n    name: '色',\n    url: 'se'\n}, {\n    name: '亲亲',\n    url: 'qinqin'\n}, {\n    name: '得意',\n    url: 'deyi'\n}, {\n    name: '流泪',\n    url: 'liulei'\n}, {\n    name: '害羞',\n    url: 'haixiu'\n}, {\n    name: '闭嘴',\n    url: 'bizui'\n}, {\n    name: '鼓掌',\n    url: 'guzhang'\n}, {\n    name: '大哭',\n    url: 'daku'\n}, {\n    name: '尴尬',\n    url: 'ganga'\n}, {\n    name: '生气',\n    url: 'shengqi'\n}, {\n    name: '调皮',\n    url: 'tiaopi'\n}, {\n    name: '呲牙',\n    url: 'ciya'\n}, {\n    name: '惊讶',\n    url: 'jingya'\n}, {\n    name: '委屈',\n    url: 'weiqu'\n}, {\n    name: '吐血',\n    url: 'tuxue'\n}, {\n    name: '冷汗',\n    url: 'lenghan'\n}, {\n    name: '抓狂',\n    url: 'zhuakuang'\n}, {\n    name: '难过',\n    url: 'nanguo'\n}, {\n    name: '偷笑',\n    url: 'touxiao'\n}, {\n    name: '白眼',\n    url: 'baiyan'\n}, {\n    name: '不屑',\n    url: 'buxie'\n}, {\n    name: '快哭了',\n    url: 'kuaikule'\n}];\n\nvar groupTwo = [{\n    name: '困',\n    url: 'kun'\n}, {\n    name: '装酷',\n    url: 'zhuangku'\n}, {\n    name: '大笑',\n    url: 'daxiao'\n}, {\n    name: '偷瞄',\n    url: 'toumiao'\n}, {\n    name: '奋斗',\n    url: 'fendou'\n}, {\n    name: '咒骂',\n    url: 'zhouma'\n}, {\n    name: '疑问',\n    url: 'yiwen'\n}, {\n    name: '晕',\n    url: 'yun'\n}, {\n    name: '捶打',\n    url: 'chuida'\n}, {\n    name: '再见',\n    url: 'zaijian'\n}, {\n    name: '抠鼻',\n    url: 'koubi'\n}, {\n    name: '发呆',\n    url: 'fadai'\n}, {\n    name: '坏笑',\n    url: 'huaixiao'\n}, {\n    name: '哈欠',\n    url: 'haqian'\n}, {\n    name: '鄙视',\n    url: 'bishi'\n}, {\n    name: '睡觉',\n    url: 'shuijiao'\n}, {\n    name: '饿',\n    url: 'e'\n}, {\n    name: '阴险',\n    url: 'yinxian'\n}, {\n    name: '难受',\n    url: 'nanshou'\n}, {\n    name: '可怜',\n    url: 'kelian'\n}, {\n    name: '撇嘴',\n    url: 'piezui'\n}, {\n    name: '石化',\n    url: 'shihua'\n}, {\n    name: '泪眼',\n    url: 'leiyan'\n}];\n\nvar groupThree = [{\n    name: '嘘',\n    url: 'xu'\n}, {\n    name: '哼哼',\n    url: 'hengheng'\n}, {\n    name: '爱慕',\n    url: 'aimu'\n}, {\n    name: '财迷',\n    url: 'caimi'\n}, {\n    name: '耶',\n    url: 'ye'\n}, {\n    name: '思考',\n    url: 'sikao'\n}, {\n    name: '骷髅',\n    url: 'kulou'\n}, {\n    name: '痛哭',\n    url: 'tongku'\n}, {\n    name: '恭喜',\n    url: 'gongxi'\n}, {\n    name: '捂脸',\n    url: 'wulian'\n}, {\n    name: '嘿哈',\n    url: 'heiha'\n}, {\n    name: '机智',\n    url: 'jizhi'\n}, {\n    name: '皱眉',\n    url: 'zhoumei'\n}, {\n    name: '安慰',\n    url: 'anwei'\n}, {\n    name: '飞吻',\n    url: 'feiwen'\n}, {\n    name: '奸笑',\n    url: 'jianxiao'\n}, {\n    name: '猪头',\n    url: 'zhutou'\n}, {\n    name: '玫瑰',\n    url: 'meigui'\n}, {\n    name: '凋谢',\n    url: 'diaoxie'\n}, {\n    name: '爱心',\n    url: 'aixin'\n}, {\n    name: '心碎',\n    url: 'xinsui'\n}, {\n    name: '蛋糕',\n    url: 'dangao'\n}, {\n    name: '喝水',\n    url: 'heshui'\n}];\n\nvar groupFour = [{\n    name: '西瓜',\n    url: 'xigua'\n}, {\n    name: '咖啡',\n    url: 'kafei'\n}, {\n    name: '啤酒',\n    url: 'pijiu'\n}, {\n    name: '包包',\n    url: 'baobao'\n}, {\n    name: '高跟鞋',\n    url: 'gaogenxie'\n}, {\n    name: '帽子',\n    url: 'maozi'\n}, {\n    name: '口红',\n    url: 'kouhong'\n}, {\n    name: '裙子',\n    url: 'qunzi'\n}, {\n    name: 'T恤',\n    url: 'txu'\n}, {\n    name: '裤子',\n    url: 'kuzi'\n}, {\n    name: '眼镜',\n    url: 'yanjing'\n}, {\n    name: '太阳镜',\n    url: 'taiyangjing'\n}, {\n    name: '蜡烛',\n    url: 'lazhu'\n}, {\n    name: '礼物',\n    url: 'liwu'\n}, {\n    name: '红包',\n    url: 'hongbao'\n}, {\n    name: '拥抱',\n    url: 'yongbao'\n}, {\n    name: '太阳',\n    url: 'taiyang'\n}, {\n    name: '月亮',\n    url: 'yueliang'\n}, {\n    name: '便便',\n    url: 'bianbian'\n}, {\n    name: '炸弹',\n    url: 'zhadan'\n}, {\n    name: '菜刀',\n    url: 'caidao'\n}, {\n    name: '握手',\n    url: 'woshou'\n}, {\n    name: '胜利',\n    url: 'shengli'\n}];\n\nvar groupFive = [{\n    name: '赞',\n    url: 'zan'\n}, {\n    name: 'OK',\n    url: 'ok'\n}, {\n    name: '勾引',\n    url: 'gouyin'\n}, {\n    name: 'NO',\n    url: 'no'\n}, {\n    name: '打脸',\n    url: 'dalian'\n}, {\n    name: '抱拳',\n    url: 'baoquan'\n}, {\n    name: '乒乓球',\n    url: 'pingpangqiu'\n}, {\n    name: '足球',\n    url: 'zuqiu'\n}, {\n    name: '篮球',\n    url: 'lanqiu'\n}];\n\nvar format = function(arr) {\n    for (var i = 0, len = arr.length; i < len; i++) {\n        var emoji = arr[i];\n        emoji.url = imgPath + emoji.url + ext;\n    }\n    return arr;\n};\n\nmodule.exports = format(groupOne.concat(groupTwo, groupThree, groupFour, groupFive));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/emoji.js","var path = $_CONFIG.imgpath + '/images/emoji/';\nvar ext = '.png';\n\nvar backward = {\n    '亲': {\n        name: '亲亲',\n        url: path + 'qinqin' + ext\n    },\n    '愤怒': {\n        name: '生气',\n        url: path + 'shengqi' + ext\n    },\n    '惊恐': {\n        name: '惊讶',\n        url: path + 'jingya' + ext\n    },\n    '迷茫': {\n        name: '委屈',\n        url: path + 'weiqu' + ext\n    },\n    '伤心': {\n        name: '难过',\n        url: path + 'nanguo' + ext\n    },\n    '努力': {\n        name: '奋斗',\n        url: path + 'fendou' + ext\n    },\n    'YY': {\n        name: ' 坏笑',\n        url: path + 'huaixiao' + ext\n    },\n    '恶心': {\n        name: '难受',\n        url: path + 'nanshou' + ext\n    }\n};\n\nmodule.exports = backward;\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/backward.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/face/face',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,face=$data.face,$index=$data.$index,$escape=$utils.$escape,page=$data.page,$out='';$out+='<div data-node=\"faceBox\" class=\"imoj-box\" style=\"position: absolute;z-index: 9999;display:none\"> <em class=\"sanjiao\"></em> <div data-node=\"faceList\" class=\"imoj-list\"> ';\n$each(list,function(v,i){\n$out+=' <div class=\"imoj-content clearfix ';\nif(i){\n$out+='hide';\n}\n$out+='\"> ';\n$each(v,function(face,$index){\n$out+=' <a href=\"javascript:;\"> <img width=\"22\" height=\"22\" data-face=\"[';\n$out+=$escape(face.name);\n$out+=']\" src=\"';\n$out+=$escape(face.url);\n$out+='\" alt=\"';\n$out+=$escape(face.name);\n$out+='\" title=\"';\n$out+=$escape(face.name);\n$out+='\"> </a> ';\n});\n$out+=' </div> ';\n});\n$out+=' </div> <ul data-action=\"facePage\" class=\"pagination\"> ';\n$each(page,function(v,i){\n$out+=' <li ';\nif(i==0){\n$out+='class=\"active\"';\n}\n$out+='>';\n$out+=$escape(i+1);\n$out+='</li> ';\n});\n$out+=' </ul> </div>';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/face/face.tpl\n// module id = 77\n// module chunks = 3 6 16 21 22 30 31 33 45","/**\n * Created by dongyukuan on 2016/7/4.\n */\nvar inputTip = {\n    tel: {\n        ept: '请填写11位手机号',\n        err: '手机号格式错误',\n        errBack: '该手机号已被注册'\n    },\n    msgCode: {\n        tipGet: '请获取短信验证码',\n        tipEpt: '请输入短信验证码',\n        tipErr: '验证码是6位数字,请重新输入',\n        tipErrEdit: '验证码错误',\n        tipWrong: '验证码有误,请重新输入',\n        checkCodeWrong: '验证码输入错误,请重新输入',\n        send: '验证码已发送，请注意查收',\n        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n        tipDisabled: \"验证码再次获取需间隔60s\",\n        tipLimitEdit: '获取验证码超限，请稍后再试',\n        btnAfterSend: \"秒后重新获取\",\n        btnDefault: \"获取验证码\"\n    },\n    pwd: {\n        commonTip: '请输入6-20位英文字母,数字或符号'\n    },\n    pwdV: {\n        ept: '请再次输入密码',\n        err: '两次输入的密码不一致'\n    },\n    nickName: {\n        eptName: '请输入昵称！',\n        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n        existName: '此昵称太受欢迎了，已经有人抢了~',\n        sucSub: '资料修改成功！',\n        errLine: \"网络超时!\",\n        wrongName: '此昵称含有敏感词,请重新输入'\n    },\n    birthTip: {\n        tip: '生日不能重复设置'\n    },\n    refCode: {\n        err: '推荐码错误'\n    },\n    imgCode: {\n        ept: '请输入验证码',\n        err: '验证码输入错误，请重新输入'\n    },\n    login: {\n        errCode: '请输入验证码',\n        errNum: '请输入账号',\n        errPwd: '请输入密码',\n        agreement: '请同意协议并勾选'\n    },\n    createCircle: {\n        typeEmpty: '请选择圈子分类',\n        nameEmpty: '圈子名称不能为空',\n        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n    },\n    circle: {\n    \tlogin: '登录成功！',\n        unJoin: '需要先加入该圈子才能发布话题',\n        cannotJoin: '抱歉！该圈子不允许发布话题!',\n        review: '加入圈子审核中，请耐心等待!',\n        joinSuccess: '恭喜您已经加入圈子！',\n        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n        exit: '您已经退出该圈子！',\n        dissolved: '抱歉！该圈子已被解散'\n    },\n    qrCodeTip: {\n        loseEffTip: '二维码已失效',\n        loseEffBtn: '点击刷新',\n        failGetTip: '二维码生成失败',\n        failGetBtn: '重新生成'\n    },\n    masterApply: {\n        nameLength: '姓名要2-20个字符',\n        nameType: '姓名仅限汉字和字母',\n        isIdCard: '请填写18位有效身份证号',\n        type: '请选择达人类别',\n        summary: '请输入自我介绍，2-100个字符'\n    },\n    upload: {\n        noUpload: '请上传图片',\n        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        uploadFaild: '上传失败,请重新上传',\n        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n        Q_TYPE_DENIED: '文件类型错误',\n        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n        excess: '文件个数超出限制'\n    },\n    errLine: {\n        tip: '网络错误,请稍后再试！'\n    }\n};\nmodule.exports = inputTip;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/i18n.js","/*! WebUploader 0.1.5 */\n\n\n/**\n * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n *\n * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n */\n(function( root, factory ) {\n    var modules = {},\n\n        // 内部require, 简单不完全实现。\n        // https://github.com/amdjs/amdjs-api/wiki/require\n        _require = function( deps, callback ) {\n            var args, len, i;\n\n            // 如果deps不是数组，则直接返回指定module\n            if ( typeof deps === 'string' ) {\n                return getModule( deps );\n            } else {\n                args = [];\n                for( len = deps.length, i = 0; i < len; i++ ) {\n                    args.push( getModule( deps[ i ] ) );\n                }\n\n                return callback.apply( null, args );\n            }\n        },\n\n        // 内部define，暂时不支持不指定id.\n        _define = function( id, deps, factory ) {\n            if ( arguments.length === 2 ) {\n                factory = deps;\n                deps = null;\n            }\n\n            _require( deps || [], function() {\n                setModule( id, factory, arguments );\n            });\n        },\n\n        // 设置module, 兼容CommonJs写法。\n        setModule = function( id, factory, args ) {\n            var module = {\n                    exports: factory\n                },\n                returned;\n\n            if ( typeof factory === 'function' ) {\n                args.length || (args = [ _require, module.exports, module ,window.jQuery]);\n                returned = factory.apply( null, args );\n                returned !== undefined && (module.exports = returned);\n            }\n\n            modules[ id ] = module.exports;\n        },\n\n        // 根据id获取module\n        getModule = function( id ) {\n            var module = modules[ id ] || root[ id ];\n\n            if ( !module ) {\n                throw new Error( '`' + id + '` is undefined' );\n            }\n\n            return module;\n        },\n\n        // 将所有modules，将路径ids装换成对象。\n        exportsTo = function( obj ) {\n            var key, host, parts, part, last, ucFirst;\n\n            // make the first character upper case.\n            ucFirst = function( str ) {\n                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n            };\n\n            for ( key in modules ) {\n                host = obj;\n\n                if ( !modules.hasOwnProperty( key ) ) {\n                    continue;\n                }\n\n                parts = key.split('/');\n                last = ucFirst( parts.pop() );\n\n                while( (part = ucFirst( parts.shift() )) ) {\n                    host[ part ] = host[ part ] || {};\n                    host = host[ part ];\n                }\n\n                host[ last ] = modules[ key ];\n            }\n\n            return obj;\n        },\n\n        makeExport = function( dollar ) {\n            root.__dollar = dollar;\n\n            // exports every module.\n            return exportsTo( factory( root, _define, _require,window.jQuery ) );\n        },\n\n        origin;\n\n    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\n        // For CommonJS and CommonJS-like environments where a proper window is present,\n        module.exports = makeExport();\n    } else if ( typeof define === 'function' && define.amd ) {\n\n        // Allow using this built library as an AMD module\n        // in another project. That other project will only\n        // see this AMD call, not the internal modules in\n        // the closure below.\n        define([ 'jquery' ], makeExport );\n    } else {\n\n        // Browser globals case. Just assign the\n        // result to a property on the global.\n        origin = root.WebUploader;\n        root.WebUploader = makeExport();\n        root.WebUploader.noConflict = function() {\n            root.WebUploader = origin;\n        };\n    }\n})( window, function( window, define, require ,jQuery ) {\n\n\n    /**\n     * @fileOverview jQuery or Zepto\n     */\n    define('dollar-third',[],function() {\n        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n\n        if ( !$ ) {\n            throw new Error('jQuery or Zepto not found!');\n        }\n\n        return $;\n    });\n    /**\n     * @fileOverview Dom 操作相关\n     */\n    define('dollar',[\n        'dollar-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 使用jQuery的Promise\n     */\n    define('promise-third',[\n        'dollar'\n    ], function( $ ) {\n        return {\n            Deferred: $.Deferred,\n            when: $.when,\n\n            isPromise: function( anything ) {\n                return anything && typeof anything.then === 'function';\n            }\n        };\n    });\n    /**\n     * @fileOverview Promise/A+\n     */\n    define('promise',[\n        'promise-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 基础类方法。\n     */\n\n    /**\n     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n     *\n     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n     *\n     * * module `base`：WebUploader.Base\n     * * module `file`: WebUploader.File\n     * * module `lib/dnd`: WebUploader.Lib.Dnd\n     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n     *\n     *\n     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n     * @module WebUploader\n     * @title WebUploader API文档\n     */\n    define('base',[\n        'dollar',\n        'promise'\n    ], function( $, promise ) {\n\n        var noop = function() {},\n            call = Function.call;\n\n        // http://jsperf.com/uncurrythis\n        // 反科里化\n        function uncurryThis( fn ) {\n            return function() {\n                return call.apply( fn, arguments );\n            };\n        }\n\n        function bindFn( fn, context ) {\n            return function() {\n                return fn.apply( context, arguments );\n            };\n        }\n\n        function createObject( proto ) {\n            var f;\n\n            if ( Object.create ) {\n                return Object.create( proto );\n            } else {\n                f = function() {};\n                f.prototype = proto;\n                return new f();\n            }\n        }\n\n\n        /**\n         * 基础类，提供一些简单常用的方法。\n         * @class Base\n         */\n        return {\n\n            /**\n             * @property {String} version 当前版本号。\n             */\n            version: '0.1.5',\n\n            /**\n             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n             */\n            $: $,\n\n            Deferred: promise.Deferred,\n\n            isPromise: promise.isPromise,\n\n            when: promise.when,\n\n            /**\n             * @description  简单的浏览器检查结果。\n             *\n             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n             *\n             * @property {Object} [browser]\n             */\n            browser: (function( ua ) {\n                var ret = {},\n                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n                        ua.match( /CriOS\\/([\\d.]+)/ ),\n\n                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n\n                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n\n                return ret;\n            })( navigator.userAgent ),\n\n            /**\n             * @description  操作系统检查结果。\n             *\n             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n             * @property {Object} [os]\n             */\n            os: (function( ua ) {\n                var ret = {},\n\n                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n\n                // osx && (ret.osx = true);\n                android && (ret.android = parseFloat( android[ 1 ] ));\n                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n\n                return ret;\n            })( navigator.userAgent ),\n\n            /**\n             * 实现类与类之间的继承。\n             * @method inherits\n             * @grammar Base.inherits( super ) => child\n             * @grammar Base.inherits( super, protos ) => child\n             * @grammar Base.inherits( super, protos, statics ) => child\n             * @param  {Class} super 父类\n             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n             * @param  {Object} [statics] 静态属性或方法。\n             * @return {Class} 返回子类。\n             * @example\n             * function Person() {\n             *     console.log( 'Super' );\n             * }\n             * Person.prototype.hello = function() {\n             *     console.log( 'hello' );\n             * };\n             *\n             * var Manager = Base.inherits( Person, {\n             *     world: function() {\n             *         console.log( 'World' );\n             *     }\n             * });\n             *\n             * // 因为没有指定构造器，父类的构造器将会执行。\n             * var instance = new Manager();    // => Super\n             *\n             * // 继承子父类的方法\n             * instance.hello();    // => hello\n             * instance.world();    // => World\n             *\n             * // 子类的__super__属性指向父类\n             * console.log( Manager.__super__ === Person );    // => true\n             */\n            inherits: function( Super, protos, staticProtos ) {\n                var child;\n\n                if ( typeof protos === 'function' ) {\n                    child = protos;\n                    protos = null;\n                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n                    child = protos.constructor;\n                } else {\n                    child = function() {\n                        return Super.apply( this, arguments );\n                    };\n                }\n\n                // 复制静态方法\n                $.extend( true, child, Super, staticProtos || {} );\n\n                /* jshint camelcase: false */\n\n                // 让子类的__super__属性指向父类。\n                child.__super__ = Super.prototype;\n\n                // 构建原型，添加原型方法或属性。\n                // 暂时用Object.create实现。\n                child.prototype = createObject( Super.prototype );\n                protos && $.extend( true, child.prototype, protos );\n\n                return child;\n            },\n\n            /**\n             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n             * @method noop\n             */\n            noop: noop,\n\n            /**\n             * 返回一个新的方法，此方法将已指定的`context`来执行。\n             * @grammar Base.bindFn( fn, context ) => Function\n             * @method bindFn\n             * @example\n             * var doSomething = function() {\n             *         console.log( this.name );\n             *     },\n             *     obj = {\n             *         name: 'Object Name'\n             *     },\n             *     aliasFn = Base.bind( doSomething, obj );\n             *\n             *  aliasFn();    // => Object Name\n             *\n             */\n            bindFn: bindFn,\n\n            /**\n             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n             * @grammar Base.log( args... ) => undefined\n             * @method log\n             */\n            log: (function() {\n                if ( window.console ) {\n                    return bindFn( console.log, console );\n                }\n                return noop;\n            })(),\n\n            nextTick: (function() {\n\n                return function( cb ) {\n                    setTimeout( cb, 1 );\n                };\n\n                // @bug 当浏览器不在当前窗口时就停了。\n                // var next = window.requestAnimationFrame ||\n                //     window.webkitRequestAnimationFrame ||\n                //     window.mozRequestAnimationFrame ||\n                //     function( cb ) {\n                //         window.setTimeout( cb, 1000 / 60 );\n                //     };\n\n                // // fix: Uncaught TypeError: Illegal invocation\n                // return bindFn( next, window );\n            })(),\n\n            /**\n             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n             * 将用来将非数组对象转化成数组对象。\n             * @grammar Base.slice( target, start[, end] ) => Array\n             * @method slice\n             * @example\n             * function doSomthing() {\n             *     var args = Base.slice( arguments, 1 );\n             *     console.log( args );\n             * }\n             *\n             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n             */\n            slice: uncurryThis( [].slice ),\n\n            /**\n             * 生成唯一的ID\n             * @method guid\n             * @grammar Base.guid() => String\n             * @grammar Base.guid( prefx ) => String\n             */\n            guid: (function() {\n                var counter = 0;\n\n                return function( prefix ) {\n                    var guid = (+new Date()).toString( 32 ),\n                        i = 0;\n\n                    for ( ; i < 5; i++ ) {\n                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n                    }\n\n                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n                };\n            })(),\n\n            /**\n             * 格式化文件大小, 输出成带单位的字符串\n             * @method formatSize\n             * @grammar Base.formatSize( size ) => String\n             * @grammar Base.formatSize( size, pointLength ) => String\n             * @grammar Base.formatSize( size, pointLength, units ) => String\n             * @param {Number} size 文件大小\n             * @param {Number} [pointLength=2] 精确到的小数点数。\n             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n             * @example\n             * console.log( Base.formatSize( 100 ) );    // => 100B\n             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n             */\n            formatSize: function( size, pointLength, units ) {\n                var unit;\n\n                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n\n                while ( (unit = units.shift()) && size > 1024 ) {\n                    size = size / 1024;\n                }\n\n                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n                        unit;\n            }\n        };\n    });\n    /**\n     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n     * @fileOverview Mediator\n     */\n    define('mediator',[\n        'base'\n    ], function( Base ) {\n        var $ = Base.$,\n            slice = [].slice,\n            separator = /\\s+/,\n            protos;\n\n        // 根据条件过滤出事件handlers.\n        function findHandlers( arr, name, callback, context ) {\n            return $.grep( arr, function( handler ) {\n                return handler &&\n                        (!name || handler.e === name) &&\n                        (!callback || handler.cb === callback ||\n                        handler.cb._cb === callback) &&\n                        (!context || handler.ctx === context);\n            });\n        }\n\n        function eachEvent( events, callback, iterator ) {\n            // 不支持对象，只支持多个event用空格隔开\n            $.each( (events || '').split( separator ), function( _, key ) {\n                iterator( key, callback );\n            });\n        }\n\n        function triggerHanders( events, args ) {\n            var stoped = false,\n                i = -1,\n                len = events.length,\n                handler;\n\n            while ( ++i < len ) {\n                handler = events[ i ];\n\n                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n                    stoped = true;\n                    break;\n                }\n            }\n\n            return !stoped;\n        }\n\n        protos = {\n\n            /**\n             * 绑定事件。\n             *\n             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n             * ```javascript\n             * var obj = {};\n             *\n             * // 使得obj有事件行为\n             * Mediator.installTo( obj );\n             *\n             * obj.on( 'testa', function( arg1, arg2 ) {\n             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n             * });\n             *\n             * obj.trigger( 'testa', 'arg1', 'arg2' );\n             * ```\n             *\n             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n             * 切会影响到`trigger`方法的返回值，为`false`。\n             *\n             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n             * ```javascript\n             * obj.on( 'all', function( type, arg1, arg2 ) {\n             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n             * });\n             * ```\n             *\n             * @method on\n             * @grammar on( name, callback[, context] ) => self\n             * @param  {String}   name     事件名，支持多个事件用空格隔开\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             * @class Mediator\n             */\n            on: function( name, callback, context ) {\n                var me = this,\n                    set;\n\n                if ( !callback ) {\n                    return this;\n                }\n\n                set = this._events || (this._events = []);\n\n                eachEvent( name, callback, function( name, callback ) {\n                    var handler = { e: name };\n\n                    handler.cb = callback;\n                    handler.ctx = context;\n                    handler.ctx2 = context || me;\n                    handler.id = set.length;\n\n                    set.push( handler );\n                });\n\n                return this;\n            },\n\n            /**\n             * 绑定事件，且当handler执行完后，自动解除绑定。\n             * @method once\n             * @grammar once( name, callback[, context] ) => self\n             * @param  {String}   name     事件名\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            once: function( name, callback, context ) {\n                var me = this;\n\n                if ( !callback ) {\n                    return me;\n                }\n\n                eachEvent( name, callback, function( name, callback ) {\n                    var once = function() {\n                            me.off( name, once );\n                            return callback.apply( context || me, arguments );\n                        };\n\n                    once._cb = callback;\n                    me.on( name, once, context );\n                });\n\n                return me;\n            },\n\n            /**\n             * 解除事件绑定\n             * @method off\n             * @grammar off( [name[, callback[, context] ] ] ) => self\n             * @param  {String}   [name]     事件名\n             * @param  {Function} [callback] 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            off: function( name, cb, ctx ) {\n                var events = this._events;\n\n                if ( !events ) {\n                    return this;\n                }\n\n                if ( !name && !cb && !ctx ) {\n                    this._events = [];\n                    return this;\n                }\n\n                eachEvent( name, cb, function( name, cb ) {\n                    $.each( findHandlers( events, name, cb, ctx ), function() {\n                        delete events[ this.id ];\n                    });\n                });\n\n                return this;\n            },\n\n            /**\n             * 触发事件\n             * @method trigger\n             * @grammar trigger( name[, args...] ) => self\n             * @param  {String}   type     事件名\n             * @param  {*} [...] 任意参数\n             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n             */\n            trigger: function( type ) {\n                var args, events, allEvents;\n\n                if ( !this._events || !type ) {\n                    return this;\n                }\n\n                args = slice.call( arguments, 1 );\n                events = findHandlers( this._events, type );\n                allEvents = findHandlers( this._events, 'all' );\n\n                return triggerHanders( events, args ) &&\n                        triggerHanders( allEvents, arguments );\n            }\n        };\n\n        /**\n         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n         *\n         * @class Mediator\n         */\n        return $.extend({\n\n            /**\n             * 可以通过这个接口，使任何对象具备事件功能。\n             * @method installTo\n             * @param  {Object} obj 需要具备事件行为的对象。\n             * @return {Object} 返回obj.\n             */\n            installTo: function( obj ) {\n                return $.extend( obj, protos );\n            }\n\n        }, protos );\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('uploader',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$;\n\n        /**\n         * 上传入口类。\n         * @class Uploader\n         * @constructor\n         * @grammar new Uploader( opts ) => Uploader\n         * @example\n         * var uploader = WebUploader.Uploader({\n         *     swf: 'path_of_swf/Uploader.swf',\n         *\n         *     // 开起分片上传。\n         *     chunked: true\n         * });\n         */\n        function Uploader( opts ) {\n            this.options = $.extend( true, {}, Uploader.options, opts );\n            this._init( this.options );\n        }\n\n        // default Options\n        // widgets中有相应扩展\n        Uploader.options = {};\n        Mediator.installTo( Uploader.prototype );\n\n        // 批量添加纯命令式方法。\n        $.each({\n            upload: 'start-upload',\n            stop: 'stop-upload',\n            getFile: 'get-file',\n            getFiles: 'get-files',\n            addFile: 'add-file',\n            addFiles: 'add-file',\n            sort: 'sort-files',\n            removeFile: 'remove-file',\n            cancelFile: 'cancel-file',\n            skipFile: 'skip-file',\n            retry: 'retry',\n            isInProgress: 'is-in-progress',\n            makeThumb: 'make-thumb',\n            md5File: 'md5-file',\n            getDimension: 'get-dimension',\n            addButton: 'add-btn',\n            predictRuntimeType: 'predict-runtime-type',\n            refresh: 'refresh',\n            disable: 'disable',\n            enable: 'enable',\n            reset: 'reset'\n        }, function( fn, command ) {\n            Uploader.prototype[ fn ] = function() {\n                return this.request( command, arguments );\n            };\n        });\n\n        $.extend( Uploader.prototype, {\n            state: 'pending',\n\n            _init: function( opts ) {\n                var me = this;\n\n                me.request( 'init', opts, function() {\n                    me.state = 'ready';\n                    me.trigger('ready');\n                });\n            },\n\n            /**\n             * 获取或者设置Uploader配置项。\n             * @method option\n             * @grammar option( key ) => *\n             * @grammar option( key, val ) => self\n             * @example\n             *\n             * // 初始状态图片上传前不会压缩\n             * var uploader = new WebUploader.Uploader({\n             *     compress: null;\n             * });\n             *\n             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n             * uploader.option( 'compress', {\n             *     width: 1600,\n             *     height: 1600\n             * });\n             */\n            option: function( key, val ) {\n                var opts = this.options;\n\n                // setter\n                if ( arguments.length > 1 ) {\n\n                    if ( $.isPlainObject( val ) &&\n                            $.isPlainObject( opts[ key ] ) ) {\n                        $.extend( opts[ key ], val );\n                    } else {\n                        opts[ key ] = val;\n                    }\n\n                } else {    // getter\n                    return key ? opts[ key ] : opts;\n                }\n            },\n\n            /**\n             * 获取文件统计信息。返回一个包含一下信息的对象。\n             * * `successNum` 上传成功的文件数\n             * * `progressNum` 上传中的文件数\n             * * `cancelNum` 被删除的文件数\n             * * `invalidNum` 无效的文件数\n             * * `uploadFailNum` 上传失败的文件数\n             * * `queueNum` 还在队列中的文件数\n             * * `interruptNum` 被暂停的文件数\n             * @method getStats\n             * @grammar getStats() => Object\n             */\n            getStats: function() {\n                // return this._mgr.getStats.apply( this._mgr, arguments );\n                var stats = this.request('get-stats');\n\n                return stats ? {\n                    successNum: stats.numOfSuccess,\n                    progressNum: stats.numOfProgress,\n\n                    // who care?\n                    // queueFailNum: 0,\n                    cancelNum: stats.numOfCancel,\n                    invalidNum: stats.numOfInvalid,\n                    uploadFailNum: stats.numOfUploadFailed,\n                    queueNum: stats.numOfQueue,\n                    interruptNum: stats.numofInterrupt\n                } : {};\n            },\n\n            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n            trigger: function( type/*, args...*/ ) {\n                var args = [].slice.call( arguments, 1 ),\n                    opts = this.options,\n                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n                        type.substring( 1 );\n\n                if (\n                        // 调用通过on方法注册的handler.\n                        Mediator.trigger.apply( this, arguments ) === false ||\n\n                        // 调用opts.onEvent\n                        $.isFunction( opts[ name ] ) &&\n                        opts[ name ].apply( this, args ) === false ||\n\n                        // 调用this.onEvent\n                        $.isFunction( this[ name ] ) &&\n                        this[ name ].apply( this, args ) === false ||\n\n                        // 广播所有uploader的事件。\n                        Mediator.trigger.apply( Mediator,\n                        [ this, type ].concat( args ) ) === false ) {\n\n                    return false;\n                }\n\n                return true;\n            },\n\n            /**\n             * 销毁 webuploader 实例\n             * @method destroy\n             * @grammar destroy() => undefined\n             */\n            destroy: function() {\n                this.request( 'destroy', arguments );\n                this.off();\n            },\n\n            // widgets/widget.js将补充此方法的详细文档。\n            request: Base.noop\n        });\n\n        /**\n         * 创建Uploader实例，等同于new Uploader( opts );\n         * @method create\n         * @class Base\n         * @static\n         * @grammar Base.create( opts ) => Uploader\n         */\n        Base.create = Uploader.create = function( opts ) {\n            return new Uploader( opts );\n        };\n\n        // 暴露Uploader，可以通过它来扩展业务逻辑。\n        Base.Uploader = Uploader;\n\n        return Uploader;\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/runtime',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$,\n            factories = {},\n\n            // 获取对象的第一个key\n            getFirstKey = function( obj ) {\n                for ( var key in obj ) {\n                    if ( obj.hasOwnProperty( key ) ) {\n                        return key;\n                    }\n                }\n                return null;\n            };\n\n        // 接口类。\n        function Runtime( options ) {\n            this.options = $.extend({\n                container: document.body\n            }, options );\n            this.uid = Base.guid('rt_');\n        }\n\n        $.extend( Runtime.prototype, {\n\n            getContainer: function() {\n                var opts = this.options,\n                    parent, container;\n\n                if ( this._container ) {\n                    return this._container;\n                }\n\n                parent = $( opts.container || document.body );\n                container = $( document.createElement('div') );\n\n                container.attr( 'id', 'rt_' + this.uid );\n                container.css({\n                    position: 'absolute',\n                    top: '0px',\n                    left: '0px',\n                    width: '1px',\n                    height: '1px',\n                    overflow: 'hidden'\n                });\n\n                parent.append( container );\n                parent.addClass('webuploader-container');\n                this._container = container;\n                this._parent = parent;\n                return container;\n            },\n\n            init: Base.noop,\n            exec: Base.noop,\n\n            destroy: function() {\n                this._container && this._container.remove();\n                this._parent && this._parent.removeClass('webuploader-container');\n                this.off();\n            }\n        });\n\n        Runtime.orders = 'html5,flash';\n\n\n        /**\n         * 添加Runtime实现。\n         * @param {String} type    类型\n         * @param {Runtime} factory 具体Runtime实现。\n         */\n        Runtime.addRuntime = function( type, factory ) {\n            factories[ type ] = factory;\n        };\n\n        Runtime.hasRuntime = function( type ) {\n            return !!(type ? factories[ type ] : getFirstKey( factories ));\n        };\n\n        Runtime.create = function( opts, orders ) {\n            var type, runtime;\n\n            orders = orders || Runtime.orders;\n            $.each( orders.split( /\\s*,\\s*/g ), function() {\n                if ( factories[ this ] ) {\n                    type = this;\n                    return false;\n                }\n            });\n\n            type = type || getFirstKey( factories );\n            if ( !type ) {\n                throw new Error('Runtime Error');\n            }\n\n            runtime = new factories[ type ]( opts );\n            return runtime;\n        };\n\n        Mediator.installTo( Runtime.prototype );\n        return Runtime;\n    });\n\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/client',[\n        'base',\n        'mediator',\n        'runtime/runtime'\n    ], function( Base, Mediator, Runtime ) {\n\n        var cache;\n\n        cache = (function() {\n            var obj = {};\n\n            return {\n                add: function( runtime ) {\n                    obj[ runtime.uid ] = runtime;\n                },\n\n                get: function( ruid, standalone ) {\n                    var i;\n\n                    if ( ruid ) {\n                        return obj[ ruid ];\n                    }\n\n                    for ( i in obj ) {\n                        // 有些类型不能重用，比如filepicker.\n                        if ( standalone && obj[ i ].__standalone ) {\n                            continue;\n                        }\n\n                        return obj[ i ];\n                    }\n\n                    return null;\n                },\n\n                remove: function( runtime ) {\n                    delete obj[ runtime.uid ];\n                }\n            };\n        })();\n\n        function RuntimeClient( component, standalone ) {\n            var deferred = Base.Deferred(),\n                runtime;\n\n            this.uid = Base.guid('client_');\n\n            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n            this.runtimeReady = function( cb ) {\n                return deferred.done( cb );\n            };\n\n            this.connectRuntime = function( opts, cb ) {\n\n                // already connected.\n                if ( runtime ) {\n                    throw new Error('already connected!');\n                }\n\n                deferred.done( cb );\n\n                if ( typeof opts === 'string' && cache.get( opts ) ) {\n                    runtime = cache.get( opts );\n                }\n\n                // 像filePicker只能独立存在，不能公用。\n                runtime = runtime || cache.get( null, standalone );\n\n                // 需要创建\n                if ( !runtime ) {\n                    runtime = Runtime.create( opts, opts.runtimeOrder );\n                    runtime.__promise = deferred.promise();\n                    runtime.once( 'ready', deferred.resolve );\n                    runtime.init();\n                    cache.add( runtime );\n                    runtime.__client = 1;\n                } else {\n                    // 来自cache\n                    Base.$.extend( runtime.options, opts );\n                    runtime.__promise.then( deferred.resolve );\n                    runtime.__client++;\n                }\n\n                standalone && (runtime.__standalone = standalone);\n                return runtime;\n            };\n\n            this.getRuntime = function() {\n                return runtime;\n            };\n\n            this.disconnectRuntime = function() {\n                if ( !runtime ) {\n                    return;\n                }\n\n                runtime.__client--;\n\n                if ( runtime.__client <= 0 ) {\n                    cache.remove( runtime );\n                    delete runtime.__promise;\n                    runtime.destroy();\n                }\n\n                runtime = null;\n            };\n\n            this.exec = function() {\n                if ( !runtime ) {\n                    return;\n                }\n\n                var args = Base.slice( arguments );\n                component && args.unshift( component );\n\n                return runtime.exec.apply( this, args );\n            };\n\n            this.getRuid = function() {\n                return runtime && runtime.uid;\n            };\n\n            this.destroy = (function( destroy ) {\n                return function() {\n                    destroy && destroy.apply( this, arguments );\n                    this.trigger('destroy');\n                    this.off();\n                    this.exec('destroy');\n                    this.disconnectRuntime();\n                };\n            })( this.destroy );\n        }\n\n        Mediator.installTo( RuntimeClient.prototype );\n        return RuntimeClient;\n    });\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/dnd',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n\n        var $ = Base.$;\n\n        function DragAndDrop( opts ) {\n            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n\n            opts.container = $( opts.container );\n\n            if ( !opts.container.length ) {\n                return;\n            }\n\n            RuntimeClent.call( this, 'DragAndDrop' );\n        }\n\n        DragAndDrop.options = {\n            accept: null,\n            disableGlobalDnd: false\n        };\n\n        Base.inherits( RuntimeClent, {\n            constructor: DragAndDrop,\n\n            init: function() {\n                var me = this;\n\n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n\n        Mediator.installTo( DragAndDrop.prototype );\n\n        return DragAndDrop;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/widget',[\n        'base',\n        'uploader'\n    ], function( Base, Uploader ) {\n\n        var $ = Base.$,\n            _init = Uploader.prototype._init,\n            _destroy = Uploader.prototype.destroy,\n            IGNORE = {},\n            widgetClass = [];\n\n        function isArrayLike( obj ) {\n            if ( !obj ) {\n                return false;\n            }\n\n            var length = obj.length,\n                type = $.type( obj );\n\n            if ( obj.nodeType === 1 && length ) {\n                return true;\n            }\n\n            return type === 'array' || type !== 'function' && type !== 'string' &&\n                    (length === 0 || typeof length === 'number' && length > 0 &&\n                    (length - 1) in obj);\n        }\n\n        function Widget( uploader ) {\n            this.owner = uploader;\n            this.options = uploader.options;\n        }\n\n        $.extend( Widget.prototype, {\n\n            init: Base.noop,\n\n            // 类Backbone的事件监听声明，监听uploader实例上的事件\n            // widget直接无法监听事件，事件只能通过uploader来传递\n            invoke: function( apiName, args ) {\n\n                /*\n                    {\n                        'make-thumb': 'makeThumb'\n                    }\n                 */\n                var map = this.responseMap;\n\n                // 如果无API响应声明则忽略\n                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n\n                    return IGNORE;\n                }\n\n                return this[ map[ apiName ] ].apply( this, args );\n\n            },\n\n            /**\n             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n             * @method request\n             * @grammar request( command, args ) => * | Promise\n             * @grammar request( command, args, callback ) => Promise\n             * @for  Uploader\n             */\n            request: function() {\n                return this.owner.request.apply( this.owner, arguments );\n            }\n        });\n\n        // 扩展Uploader.\n        $.extend( Uploader.prototype, {\n\n            /**\n             * @property {String | Array} [disableWidgets=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n             */\n\n            // 覆写_init用来初始化widgets\n            _init: function() {\n                var me = this,\n                    widgets = me._widgets = [],\n                    deactives = me.options.disableWidgets || '';\n\n                $.each( widgetClass, function( _, klass ) {\n                    (!deactives || !~deactives.indexOf( klass._name )) &&\n                        widgets.push( new klass( me ) );\n                });\n\n                return _init.apply( me, arguments );\n            },\n\n            request: function( apiName, args, callback ) {\n                var i = 0,\n                    widgets = this._widgets,\n                    len = widgets && widgets.length,\n                    rlts = [],\n                    dfds = [],\n                    widget, rlt, promise, key;\n\n                args = isArrayLike( args ) ? args : [ args ];\n\n                for ( ; i < len; i++ ) {\n                    widget = widgets[ i ];\n                    rlt = widget.invoke( apiName, args );\n\n                    if ( rlt !== IGNORE ) {\n\n                        // Deferred对象\n                        if ( Base.isPromise( rlt ) ) {\n                            dfds.push( rlt );\n                        } else {\n                            rlts.push( rlt );\n                        }\n                    }\n                }\n\n                // 如果有callback，则用异步方式。\n                if ( callback || dfds.length ) {\n                    promise = Base.when.apply( Base, dfds );\n                    key = promise.pipe ? 'pipe' : 'then';\n\n                    // 很重要不能删除。删除了会死循环。\n                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n                    return promise[ key ](function() {\n                                var deferred = Base.Deferred(),\n                                    args = arguments;\n\n                                if ( args.length === 1 ) {\n                                    args = args[ 0 ];\n                                }\n\n                                setTimeout(function() {\n                                    deferred.resolve( args );\n                                }, 1 );\n\n                                return deferred.promise();\n                            })[ callback ? key : 'done' ]( callback || Base.noop );\n                } else {\n                    return rlts[ 0 ];\n                }\n            },\n\n            destroy: function() {\n                _destroy.apply( this, arguments );\n                this._widgets = null;\n            }\n        });\n\n        /**\n         * 添加组件\n         * @grammar Uploader.register(proto);\n         * @grammar Uploader.register(map, proto);\n         * @param  {object} responseMap API 名称与函数实现的映射\n         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n         * @method Uploader.register\n         * @for Uploader\n         * @example\n         * Uploader.register({\n         *     'make-thumb': 'makeThumb'\n         * }, {\n         *     init: function( options ) {},\n         *     makeThumb: function() {}\n         * });\n         *\n         * Uploader.register({\n         *     'make-thumb': function() {\n         *\n         *     }\n         * });\n         */\n        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n                klass;\n\n            if ( arguments.length === 1 ) {\n                widgetProto = responseMap;\n\n                // 自动生成 map 表。\n                $.each(widgetProto, function(key) {\n                    if ( key[0] === '_' || key === 'name' ) {\n                        key === 'name' && (map.name = widgetProto.name);\n                        return;\n                    }\n\n                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n                });\n\n            } else {\n                map = $.extend( map, responseMap );\n            }\n\n            widgetProto.responseMap = map;\n            klass = Base.inherits( Widget, widgetProto );\n            klass._name = map.name;\n            widgetClass.push( klass );\n\n            return klass;\n        };\n\n        /**\n         * 删除插件，只有在注册时指定了名字的才能被删除。\n         * @grammar Uploader.unRegister(name);\n         * @param  {string} name 组件名字\n         * @method Uploader.unRegister\n         * @for Uploader\n         * @example\n         *\n         * Uploader.register({\n         *     name: 'custom',\n         *\n         *     'make-thumb': function() {\n         *\n         *     }\n         * });\n         *\n         * Uploader.unRegister('custom');\n         */\n        Uploader.unRegister = Widget.unRegister = function( name ) {\n            if ( !name || name === 'anonymous' ) {\n                return;\n            }\n\n            // 删除指定的插件。\n            for ( var i = widgetClass.length; i--; ) {\n                if ( widgetClass[i]._name === name ) {\n                    widgetClass.splice(i, 1)\n                }\n            }\n        };\n\n        return Widget;\n    });\n    /**\n     * @fileOverview DragAndDrop Widget。\n     */\n    define('widgets/filednd',[\n        'base',\n        'uploader',\n        'lib/dnd',\n        'widgets/widget'\n    ], function( Base, Uploader, Dnd ) {\n        var $ = Base.$;\n\n        Uploader.options.dnd = '';\n\n        /**\n         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n         * @namespace options\n         * @for Uploader\n         */\n\n        /**\n         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n         * @namespace options\n         * @for Uploader\n         */\n\n        /**\n         * @event dndAccept\n         * @param {DataTransferItemList} items DataTransferItem\n         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n         * @for  Uploader\n         */\n        return Uploader.register({\n            name: 'dnd',\n\n            init: function( opts ) {\n\n                if ( !opts.dnd ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        disableGlobalDnd: opts.disableGlobalDnd,\n                        container: opts.dnd,\n                        accept: opts.accept\n                    }),\n                    dnd;\n\n                this.dnd = dnd = new Dnd( options );\n\n                dnd.once( 'ready', deferred.resolve );\n                dnd.on( 'drop', function( files ) {\n                    me.request( 'add-file', [ files ]);\n                });\n\n                // 检测文件是否全部允许添加。\n                dnd.on( 'accept', function( items ) {\n                    return me.owner.trigger( 'dndAccept', items );\n                });\n\n                dnd.init();\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                this.dnd && this.dnd.destroy();\n            }\n        });\n    });\n\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepaste',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n\n        var $ = Base.$;\n\n        function FilePaste( opts ) {\n            opts = this.options = $.extend({}, opts );\n            opts.container = $( opts.container || document.body );\n            RuntimeClent.call( this, 'FilePaste' );\n        }\n\n        Base.inherits( RuntimeClent, {\n            constructor: FilePaste,\n\n            init: function() {\n                var me = this;\n\n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n\n        Mediator.installTo( FilePaste.prototype );\n\n        return FilePaste;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/filepaste',[\n        'base',\n        'uploader',\n        'lib/filepaste',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePaste ) {\n        var $ = Base.$;\n\n        /**\n         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n         * @namespace options\n         * @for Uploader\n         */\n        return Uploader.register({\n            name: 'paste',\n\n            init: function( opts ) {\n\n                if ( !opts.paste ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        container: opts.paste,\n                        accept: opts.accept\n                    }),\n                    paste;\n\n                this.paste = paste = new FilePaste( options );\n\n                paste.once( 'ready', deferred.resolve );\n                paste.on( 'paste', function( files ) {\n                    me.owner.request( 'add-file', [ files ]);\n                });\n                paste.init();\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                this.paste && this.paste.destroy();\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob\n     */\n    define('lib/blob',[\n        'base',\n        'runtime/client'\n    ], function( Base, RuntimeClient ) {\n\n        function Blob( ruid, source ) {\n            var me = this;\n\n            me.source = source;\n            me.ruid = ruid;\n            this.size = source.size || 0;\n\n            // 如果没有指定 mimetype, 但是知道文件后缀。\n            if ( !source.type && this.ext &&\n                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n            } else {\n                this.type = source.type || 'application/octet-stream';\n            }\n\n            RuntimeClient.call( me, 'Blob' );\n            this.uid = source.uid || this.uid;\n\n            if ( ruid ) {\n                me.connectRuntime( ruid );\n            }\n        }\n\n        Base.inherits( RuntimeClient, {\n            constructor: Blob,\n\n            slice: function( start, end ) {\n                return this.exec( 'slice', start, end );\n            },\n\n            getSource: function() {\n                return this.source;\n            }\n        });\n\n        return Blob;\n    });\n    /**\n     * 为了统一化Flash的File和HTML5的File而存在。\n     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n     * @fileOverview File\n     */\n    define('lib/file',[\n        'base',\n        'lib/blob'\n    ], function( Base, Blob ) {\n\n        var uid = 1,\n            rExt = /\\.([^.]+)$/;\n\n        function File( ruid, file ) {\n            var ext;\n\n            this.name = file.name || ('untitled' + uid++);\n            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n\n            // todo 支持其他类型文件的转换。\n            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n            if ( !ext && file.type ) {\n                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n                        RegExp.$1.toLowerCase() : '';\n                this.name += '.' + ext;\n            }\n\n            this.ext = ext;\n            this.lastModifiedDate = file.lastModifiedDate ||\n                    (new Date()).toLocaleString();\n\n            Blob.apply( this, arguments );\n        }\n\n        return Base.inherits( Blob, File );\n    });\n\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepicker',[\n        'base',\n        'runtime/client',\n        'lib/file'\n    ], function( Base, RuntimeClent, File ) {\n\n        var $ = Base.$;\n\n        function FilePicker( opts ) {\n            opts = this.options = $.extend({}, FilePicker.options, opts );\n\n            opts.container = $( opts.id );\n\n            if ( !opts.container.length ) {\n                throw new Error('按钮指定错误');\n            }\n\n            opts.innerHTML = opts.innerHTML || opts.label ||\n                    opts.container.html() || '';\n\n            opts.button = $( opts.button || document.createElement('div') );\n            opts.button.html( opts.innerHTML );\n            opts.container.html( opts.button );\n\n            RuntimeClent.call( this, 'FilePicker', true );\n        }\n\n        FilePicker.options = {\n            button: null,\n            container: null,\n            label: null,\n            innerHTML: null,\n            multiple: true,\n            accept: null,\n            name: 'file'\n        };\n\n        Base.inherits( RuntimeClent, {\n            constructor: FilePicker,\n\n            init: function() {\n                var me = this,\n                    opts = me.options,\n                    button = opts.button;\n\n                button.addClass('webuploader-pick');\n\n                me.on( 'all', function( type ) {\n                    var files;\n\n                    switch ( type ) {\n                        case 'mouseenter':\n                            button.addClass('webuploader-pick-hover');\n                            break;\n\n                        case 'mouseleave':\n                            button.removeClass('webuploader-pick-hover');\n                            break;\n\n                        case 'change':\n                            files = me.exec('getFiles');\n                            me.trigger( 'select', $.map( files, function( file ) {\n                                file = new File( me.getRuid(), file );\n\n                                // 记录来源。\n                                file._refer = opts.container;\n                                return file;\n                            }), opts.container );\n                            break;\n                    }\n                });\n\n                me.connectRuntime( opts, function() {\n                    me.refresh();\n                    me.exec( 'init', opts );\n                    me.trigger('ready');\n                });\n\n                this._resizeHandler = Base.bindFn( this.refresh, this );\n                $( window ).on( 'resize', this._resizeHandler );\n            },\n\n            refresh: function() {\n                var shimContainer = this.getRuntime().getContainer(),\n                    button = this.options.button,\n                    width = button.outerWidth ?\n                            button.outerWidth() : button.width(),\n\n                    height = button.outerHeight ?\n                            button.outerHeight() : button.height(),\n\n                    pos = button.offset();\n\n                width && height && shimContainer.css({\n                    bottom: 'auto',\n                    right: 'auto',\n                    width: width + 'px',\n                    height: height + 'px'\n                }).offset( pos );\n            },\n\n            enable: function() {\n                var btn = this.options.button;\n\n                btn.removeClass('webuploader-pick-disable');\n                this.refresh();\n            },\n\n            disable: function() {\n                var btn = this.options.button;\n\n                this.getRuntime().getContainer().css({\n                    top: '-99999px'\n                });\n\n                btn.addClass('webuploader-pick-disable');\n            },\n\n            destroy: function() {\n                var btn = this.options.button;\n                $( window ).off( 'resize', this._resizeHandler );\n                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n                    'webuploader-pick');\n            }\n        });\n\n        return FilePicker;\n    });\n\n    /**\n     * @fileOverview 文件选择相关\n     */\n    define('widgets/filepicker',[\n        'base',\n        'uploader',\n        'lib/filepicker',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePicker ) {\n        var $ = Base.$;\n\n        $.extend( Uploader.options, {\n\n            /**\n             * @property {Selector | Object} [pick=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n             *\n             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n             * * `label` {String} 请采用 `innerHTML` 代替\n             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n             */\n            pick: null,\n\n            /**\n             * @property {Arroy} [accept=null]\n             * @namespace options\n             * @for Uploader\n             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n             *\n             * * `title` {String} 文字描述\n             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n             * * `mimeTypes` {String} 多个用逗号分割。\n             *\n             * 如：\n             *\n             * ```\n             * {\n             *     title: 'Images',\n             *     extensions: 'gif,jpg,jpeg,bmp,png',\n             *     mimeTypes: 'image/*'\n             * }\n             * ```\n             */\n            accept: null/*{\n                title: 'Images',\n                extensions: 'gif,jpg,jpeg,bmp,png',\n                mimeTypes: 'image/*'\n            }*/\n        });\n\n        return Uploader.register({\n            name: 'picker',\n\n            init: function( opts ) {\n                this.pickers = [];\n                return opts.pick && this.addBtn( opts.pick );\n            },\n\n            refresh: function() {\n                $.each( this.pickers, function() {\n                    this.refresh();\n                });\n            },\n\n            /**\n             * @method addButton\n             * @for Uploader\n             * @grammar addButton( pick ) => Promise\n             * @description\n             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n             * @example\n             * uploader.addButton({\n             *     id: '#btnContainer',\n             *     innerHTML: '选择文件'\n             * });\n             */\n            addBtn: function( pick ) {\n                var me = this,\n                    opts = me.options,\n                    accept = opts.accept,\n                    promises = [];\n\n                if ( !pick ) {\n                    return;\n                }\n\n                $.isPlainObject( pick ) || (pick = {\n                    id: pick\n                });\n\n                $( pick.id ).each(function() {\n                    var options, picker, deferred;\n\n                    deferred = Base.Deferred();\n\n                    options = $.extend({}, pick, {\n                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n                        swf: opts.swf,\n                        runtimeOrder: opts.runtimeOrder,\n                        id: this\n                    });\n\n                    picker = new FilePicker( options );\n\n                    picker.once( 'ready', deferred.resolve );\n                    picker.on( 'select', function( files ) {\n                        me.owner.request( 'add-file', [ files ]);\n                    });\n                    picker.init();\n\n                    me.pickers.push( picker );\n\n                    promises.push( deferred.promise() );\n                });\n\n                return Base.when.apply( Base, promises );\n            },\n\n            disable: function() {\n                $.each( this.pickers, function() {\n                    this.disable();\n                });\n            },\n\n            enable: function() {\n                $.each( this.pickers, function() {\n                    this.enable();\n                });\n            },\n\n            destroy: function() {\n                $.each( this.pickers, function() {\n                    this.destroy();\n                });\n                this.pickers = null;\n            }\n        });\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('lib/image',[\n        'base',\n        'runtime/client',\n        'lib/blob'\n    ], function( Base, RuntimeClient, Blob ) {\n        var $ = Base.$;\n\n        // 构造器。\n        function Image( opts ) {\n            this.options = $.extend({}, Image.options, opts );\n            RuntimeClient.call( this, 'Image' );\n\n            this.on( 'load', function() {\n                this._info = this.exec('info');\n                this._meta = this.exec('meta');\n            });\n        }\n\n        // 默认选项。\n        Image.options = {\n\n            // 默认的图片处理质量\n            quality: 90,\n\n            // 是否裁剪\n            crop: false,\n\n            // 是否保留头部信息\n            preserveHeaders: false,\n\n            // 是否允许放大。\n            allowMagnify: false\n        };\n\n        // 继承RuntimeClient.\n        Base.inherits( RuntimeClient, {\n            constructor: Image,\n\n            info: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n\n                // getter\n                return this._info;\n            },\n\n            meta: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n\n                // getter\n                return this._meta;\n            },\n\n            loadFromBlob: function( blob ) {\n                var me = this,\n                    ruid = blob.getRuid();\n\n                this.connectRuntime( ruid, function() {\n                    me.exec( 'init', me.options );\n                    me.exec( 'loadFromBlob', blob );\n                });\n            },\n\n            resize: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n            },\n\n            crop: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n            },\n\n            getAsDataUrl: function( type ) {\n                return this.exec( 'getAsDataUrl', type );\n            },\n\n            getAsBlob: function( type ) {\n                var blob = this.exec( 'getAsBlob', type );\n\n                return new Blob( this.getRuid(), blob );\n            }\n        });\n\n        return Image;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/image',[\n        'base',\n        'uploader',\n        'lib/image',\n        'widgets/widget'\n    ], function( Base, Uploader, Image ) {\n\n        var $ = Base.$,\n            throttle;\n\n        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n        throttle = (function( max ) {\n            var occupied = 0,\n                waiting = [],\n                tick = function() {\n                    var item;\n\n                    while ( waiting.length && occupied < max ) {\n                        item = waiting.shift();\n                        occupied += item[ 0 ];\n                        item[ 1 ]();\n                    }\n                };\n\n            return function( emiter, size, cb ) {\n                waiting.push([ size, cb ]);\n                emiter.once( 'destroy', function() {\n                    occupied -= size;\n                    setTimeout( tick, 1 );\n                });\n                setTimeout( tick, 1 );\n            };\n        })( 5 * 1024 * 1024 );\n\n        $.extend( Uploader.options, {\n\n            /**\n             * @property {Object} [thumb]\n             * @namespace options\n             * @for Uploader\n             * @description 配置生成缩略图的选项。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 110,\n             *     height: 110,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 70,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: true,\n             *\n             *     // 是否允许裁剪。\n             *     crop: true,\n             *\n             *     // 为空的话则保留原有图片格式。\n             *     // 否则强制转换成指定的类型。\n             *     type: 'image/jpeg'\n             * }\n             * ```\n             */\n            thumb: {\n                width: 110,\n                height: 110,\n                quality: 70,\n                allowMagnify: true,\n                crop: true,\n                preserveHeaders: false,\n\n                // 为空的话则保留原有图片格式。\n                // 否则强制转换成指定的类型。\n                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n                type: 'image/jpeg'\n            },\n\n            /**\n             * @property {Object} [compress]\n             * @namespace options\n             * @for Uploader\n             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 1600,\n             *     height: 1600,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 90,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: false,\n             *\n             *     // 是否允许裁剪。\n             *     crop: false,\n             *\n             *     // 是否保留头部meta信息。\n             *     preserveHeaders: true,\n             *\n             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n             *     // 此属性可能会影响图片自动纠正功能\n             *     noCompressIfLarger: false,\n             *\n             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n             *     compressSize: 0\n             * }\n             * ```\n             */\n            compress: {\n                width: 1600,\n                height: 1600,\n                quality: 90,\n                allowMagnify: false,\n                crop: false,\n                preserveHeaders: true\n            }\n        });\n\n        return Uploader.register({\n\n            name: 'image',\n\n\n            /**\n             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n             *\n             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n             *\n             * `callback`中可以接收到两个参数。\n             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n             * * 第二个为ret, 缩略图的Data URL值。\n             *\n             * **注意**\n             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n             *\n             * @method makeThumb\n             * @grammar makeThumb( file, callback ) => undefined\n             * @grammar makeThumb( file, callback, width, height ) => undefined\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.makeThumb( file, function( error, ret ) {\n             *         if ( error ) {\n             *             $li.text('预览错误');\n             *         } else {\n             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n             *         }\n             *     });\n             *\n             * });\n             */\n            makeThumb: function( file, cb, width, height ) {\n                var opts, image;\n                var isArtwork = false;\n                file = this.request( 'get-file', file );\n\n                // 只预览图片格式。\n                if ( !file.type.match( /^image/ ) ) {\n                    cb( true );\n                    return;\n                }\n\n                opts = $.extend({}, this.options.thumb );\n                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n                // 如果传入的是object.\n                if ( $.isPlainObject( width ) ) {\n                    opts = $.extend( opts, width );\n                    width = null;\n                }\n\n                width = width || opts.width;\n                height = height || opts.height;\n\n                image = new Image( opts );\n\n                image.once( 'load', function() {\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n\n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n\n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n                    if( isArtwork ){\n                        image.resize( file._info.width, file._info.height );\n\n                    }else{\n                        image.resize( width, height );\n\n\n                    }\n\n                });\n\n                // 当 resize 完后\n                image.once( 'complete', function() {\n                    cb( false, image.getAsDataUrl( opts.type ) );\n                    image.destroy();\n                });\n\n                image.once( 'error', function( reason ) {\n                    cb( reason || true );\n                    image.destroy();\n                });\n\n                throttle( image, file.source.size, function() {\n                    file._info && image.info( file._info );\n                    file._meta && image.meta( file._meta );\n                    image.loadFromBlob( file.source );\n                });\n            },\n\n            beforeSendFile: function( file ) {\n                var opts = this.options.compress || this.options.resize,\n                    compressSize = opts && opts.compressSize || 0,\n                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n                    image, deferred;\n\n                file = this.request( 'get-file', file );\n\n                // 只压缩 jpeg 图片格式。\n                // gif 可能会丢失针\n                // bmp png 基本上尺寸都不大，且压缩比比较小。\n                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n                        file.size < compressSize ||\n                        file._compressed ) {\n                    return;\n                }\n\n                opts = $.extend({}, opts );\n                deferred = Base.Deferred();\n\n                image = new Image( opts );\n\n                deferred.always(function() {\n                    image.destroy();\n                    image = null;\n                });\n                image.once( 'error', deferred.reject );\n                image.once( 'load', function() {\n                    var width = opts.width,\n                        height = opts.height;\n\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n\n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n\n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n\n                    image.resize( width, height );\n                });\n\n                image.once( 'complete', function() {\n                    var blob, size;\n\n                    // 移动端 UC / qq 浏览器的无图模式下\n                    // ctx.getImageData 处理大图的时候会报 Exception\n                    // INDEX_SIZE_ERR: DOM Exception 1\n                    try {\n                        blob = image.getAsBlob( opts.type );\n\n                        size = file.size;\n\n                        // 如果压缩后，比原来还大则不用压缩后的。\n                        if ( !noCompressIfLarger || blob.size < size ) {\n                            // file.source.destroy && file.source.destroy();\n                            file.source = blob;\n                            file.size = blob.size;\n\n                            file.trigger( 'resize', blob.size, size );\n                        }\n\n                        // 标记，避免重复压缩。\n                        file._compressed = true;\n                        deferred.resolve();\n                    } catch ( e ) {\n                        // 出错了直接继续，让其上传原始图片\n                        deferred.resolve();\n                    }\n                });\n\n                file._info && image.info( file._info );\n                file._meta && image.meta( file._meta );\n\n                image.loadFromBlob( file.source );\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview 文件属性封装\n     */\n    define('file',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$,\n            idPrefix = 'WU_FILE_',\n            idSuffix = 0,\n            rExt = /\\.([^.]+)$/,\n            statusMap = {};\n\n        function gid() {\n            return idPrefix + idSuffix++;\n        }\n\n        /**\n         * 文件类\n         * @class File\n         * @constructor 构造函数\n         * @grammar new File( source ) => File\n         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n         */\n        function WUFile( source ) {\n\n            /**\n             * 文件名，包括扩展名（后缀）\n             * @property name\n             * @type {string}\n             */\n            this.name = source.name || 'Untitled';\n\n            /**\n             * 文件体积（字节）\n             * @property size\n             * @type {uint}\n             * @default 0\n             */\n            this.size = source.size || 0;\n\n            /**\n             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n             * @property type\n             * @type {string}\n             * @default 'application/octet-stream'\n             */\n            this.type = source.type || 'application/octet-stream';\n\n            /**\n             * 文件最后修改日期\n             * @property lastModifiedDate\n             * @type {int}\n             * @default 当前时间戳\n             */\n            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n\n            /**\n             * 文件ID，每个对象具有唯一ID，与文件名无关\n             * @property id\n             * @type {string}\n             */\n            this.id = gid();\n\n            /**\n             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n             * @property ext\n             * @type {string}\n             */\n            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n\n\n            /**\n             * 状态文字说明。在不同的status语境下有不同的用途。\n             * @property statusText\n             * @type {string}\n             */\n            this.statusText = '';\n\n            // 存储文件状态，防止通过属性直接修改\n            statusMap[ this.id ] = WUFile.Status.INITED;\n\n            this.source = source;\n            this.loaded = 0;\n\n            this.on( 'error', function( msg ) {\n                this.setStatus( WUFile.Status.ERROR, msg );\n            });\n        }\n\n        $.extend( WUFile.prototype, {\n\n            /**\n             * 设置状态，状态变化时会触发`change`事件。\n             * @method setStatus\n             * @grammar setStatus( status[, statusText] );\n             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n             */\n            setStatus: function( status, text ) {\n\n                var prevStatus = statusMap[ this.id ];\n\n                typeof text !== 'undefined' && (this.statusText = text);\n\n                if ( status !== prevStatus ) {\n                    statusMap[ this.id ] = status;\n                    /**\n                     * 文件状态变化\n                     * @event statuschange\n                     */\n                    this.trigger( 'statuschange', status, prevStatus );\n                }\n\n            },\n\n            /**\n             * 获取文件状态\n             * @return {File.Status}\n             * @example\n                     文件状态具体包括以下几种类型：\n                     {\n                         // 初始化\n                        INITED:     0,\n                        // 已入队列\n                        QUEUED:     1,\n                        // 正在上传\n                        PROGRESS:     2,\n                        // 上传出错\n                        ERROR:         3,\n                        // 上传成功\n                        COMPLETE:     4,\n                        // 上传取消\n                        CANCELLED:     5\n                    }\n             */\n            getStatus: function() {\n                return statusMap[ this.id ];\n            },\n\n            /**\n             * 获取文件原始信息。\n             * @return {*}\n             */\n            getSource: function() {\n                return this.source;\n            },\n\n            destroy: function() {\n                this.off();\n                delete statusMap[ this.id ];\n            }\n        });\n\n        Mediator.installTo( WUFile.prototype );\n\n        /**\n         * 文件状态值，具体包括以下几种类型：\n         * * `inited` 初始状态\n         * * `queued` 已经进入队列, 等待上传\n         * * `progress` 上传中\n         * * `complete` 上传完成。\n         * * `error` 上传出错，可重试\n         * * `interrupt` 上传中断，可续传。\n         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n         * * `cancelled` 文件被移除。\n         * @property {Object} Status\n         * @namespace File\n         * @class File\n         * @static\n         */\n        WUFile.Status = {\n            INITED:     'inited',    // 初始状态\n            QUEUED:     'queued',    // 已经进入队列, 等待上传\n            PROGRESS:   'progress',    // 上传中\n            ERROR:      'error',    // 上传出错，可重试\n            COMPLETE:   'complete',    // 上传完成。\n            CANCELLED:  'cancelled',    // 上传取消。\n            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n        };\n\n        return WUFile;\n    });\n\n    /**\n     * @fileOverview 文件队列\n     */\n    define('queue',[\n        'base',\n        'mediator',\n        'file'\n    ], function( Base, Mediator, WUFile ) {\n\n        var $ = Base.$,\n            STATUS = WUFile.Status;\n\n        /**\n         * 文件队列, 用来存储各个状态中的文件。\n         * @class Queue\n         * @extends Mediator\n         */\n        function Queue() {\n\n            /**\n             * 统计文件数。\n             * * `numOfQueue` 队列中的文件数。\n             * * `numOfSuccess` 上传成功的文件数\n             * * `numOfCancel` 被取消的文件数\n             * * `numOfProgress` 正在上传中的文件数\n             * * `numOfUploadFailed` 上传错误的文件数。\n             * * `numOfInvalid` 无效的文件数。\n             * * `numofDeleted` 被移除的文件数。\n             * @property {Object} stats\n             */\n            this.stats = {\n                numOfQueue: 0,\n                numOfSuccess: 0,\n                numOfCancel: 0,\n                numOfProgress: 0,\n                numOfUploadFailed: 0,\n                numOfInvalid: 0,\n                numofDeleted: 0,\n                numofInterrupt: 0\n            };\n\n            // 上传队列，仅包括等待上传的文件\n            this._queue = [];\n\n            // 存储所有文件\n            this._map = {};\n        }\n\n        $.extend( Queue.prototype, {\n\n            /**\n             * 将新文件加入对队列尾部\n             *\n             * @method append\n             * @param  {File} file   文件对象\n             */\n            append: function( file ) {\n                this._queue.push( file );\n                this._fileAdded( file );\n                return this;\n            },\n\n            /**\n             * 将新文件加入对队列头部\n             *\n             * @method prepend\n             * @param  {File} file   文件对象\n             */\n            prepend: function( file ) {\n                this._queue.unshift( file );\n                this._fileAdded( file );\n                return this;\n            },\n\n            /**\n             * 获取文件对象\n             *\n             * @method getFile\n             * @param  {String} fileId   文件ID\n             * @return {File}\n             */\n            getFile: function( fileId ) {\n                if ( typeof fileId !== 'string' ) {\n                    return fileId;\n                }\n                return this._map[ fileId ];\n            },\n\n            /**\n             * 从队列中取出一个指定状态的文件。\n             * @grammar fetch( status ) => File\n             * @method fetch\n             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n             * @return {File} [File](#WebUploader:File)\n             */\n            fetch: function( status ) {\n                var len = this._queue.length,\n                    i, file;\n\n                status = status || STATUS.QUEUED;\n\n                for ( i = 0; i < len; i++ ) {\n                    file = this._queue[ i ];\n\n                    if ( status === file.getStatus() ) {\n                        return file;\n                    }\n                }\n\n                return null;\n            },\n\n            /**\n             * 对队列进行排序，能够控制文件上传顺序。\n             * @grammar sort( fn ) => undefined\n             * @method sort\n             * @param {Function} fn 排序方法\n             */\n            sort: function( fn ) {\n                if ( typeof fn === 'function' ) {\n                    this._queue.sort( fn );\n                }\n            },\n\n            /**\n             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n             * @method getFiles\n             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n             */\n            getFiles: function() {\n                var sts = [].slice.call( arguments, 0 ),\n                    ret = [],\n                    i = 0,\n                    len = this._queue.length,\n                    file;\n\n                for ( ; i < len; i++ ) {\n                    file = this._queue[ i ];\n\n                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n                        continue;\n                    }\n\n                    ret.push( file );\n                }\n\n                return ret;\n            },\n\n            /**\n             * 在队列中删除文件。\n             * @grammar removeFile( file ) => Array\n             * @method removeFile\n             * @param {File} 文件对象。\n             */\n            removeFile: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n\n                if ( existing ) {\n                    delete this._map[ file.id ];\n                    file.destroy();\n                    this.stats.numofDeleted++;\n                }\n            },\n\n            _fileAdded: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n\n                if ( !existing ) {\n                    this._map[ file.id ] = file;\n\n                    file.on( 'statuschange', function( cur, pre ) {\n                        me._onFileStatusChange( cur, pre );\n                    });\n                }\n            },\n\n            _onFileStatusChange: function( curStatus, preStatus ) {\n                var stats = this.stats;\n\n                switch ( preStatus ) {\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress--;\n                        break;\n\n                    case STATUS.QUEUED:\n                        stats.numOfQueue --;\n                        break;\n\n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed--;\n                        break;\n\n                    case STATUS.INVALID:\n                        stats.numOfInvalid--;\n                        break;\n\n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt--;\n                        break;\n                }\n\n                switch ( curStatus ) {\n                    case STATUS.QUEUED:\n                        stats.numOfQueue++;\n                        break;\n\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress++;\n                        break;\n\n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed++;\n                        break;\n\n                    case STATUS.COMPLETE:\n                        stats.numOfSuccess++;\n                        break;\n\n                    case STATUS.CANCELLED:\n                        stats.numOfCancel++;\n                        break;\n\n\n                    case STATUS.INVALID:\n                        stats.numOfInvalid++;\n                        break;\n\n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt++;\n                        break;\n                }\n            }\n\n        });\n\n        Mediator.installTo( Queue.prototype );\n\n        return Queue;\n    });\n    /**\n     * @fileOverview 队列\n     */\n    define('widgets/queue',[\n        'base',\n        'uploader',\n        'queue',\n        'file',\n        'lib/file',\n        'runtime/client',\n        'widgets/widget'\n    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n\n        var $ = Base.$,\n            rExt = /\\.\\w+$/,\n            Status = WUFile.Status;\n\n        return Uploader.register({\n            name: 'queue',\n\n            init: function( opts ) {\n                var me = this,\n                    deferred, len, i, item, arr, accept, runtime;\n\n                if ( $.isPlainObject( opts.accept ) ) {\n                    opts.accept = [ opts.accept ];\n                }\n\n                // accept中的中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].extensions;\n                        item && arr.push( item );\n                    }\n\n                    if ( arr.length ) {\n                        accept = '\\\\.' + arr.join(',')\n                                .replace( /,/g, '$|\\\\.' )\n                                .replace( /\\*/g, '.*' ) + '$';\n                    }\n\n                    me.accept = new RegExp( accept, 'i' );\n                }\n\n                me.queue = new Queue();\n                me.stats = me.queue.stats;\n\n                // 如果当前不是html5运行时，那就算了。\n                // 不执行后续操作\n                if ( this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                // 创建一个 html5 运行时的 placeholder\n                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n                deferred = Base.Deferred();\n                this.placeholder = runtime = new RuntimeClient('Placeholder');\n                runtime.connectRuntime({\n                    runtimeOrder: 'html5'\n                }, function() {\n                    me._ruid = runtime.getRuid();\n                    deferred.resolve();\n                });\n                return deferred.promise();\n            },\n\n\n            // 为了支持外部直接添加一个原生File对象。\n            _wrapFile: function( file ) {\n                if ( !(file instanceof WUFile) ) {\n\n                    if ( !(file instanceof File) ) {\n                        if ( !this._ruid ) {\n                            throw new Error('Can\\'t add external files.');\n                        }\n                        file = new File( this._ruid, file );\n                    }\n\n                    file = new WUFile( file );\n                }\n\n                return file;\n            },\n\n            // 判断文件是否可以被加入队列\n            acceptFile: function( file ) {\n                 var invalid = !file || !file.size || this.accept &&\n\n                        // 如果名字中有后缀，才做后缀白名单处理。\n                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n                return !invalid;\n            },\n\n\n            /**\n             * @event beforeFileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n             * @for  Uploader\n             */\n\n            /**\n             * @event fileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列以后触发。\n             * @for  Uploader\n             */\n\n            _addFile: function( file ) {\n                var me = this;\n\n                file = me._wrapFile( file );\n\n                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n                    return;\n                }\n\n                // 类型不匹配，则派送错误事件，并返回。\n                if ( !me.acceptFile( file ) ) {\n                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n                    return;\n                }\n\n                me.queue.append( file );\n                me.owner.trigger( 'fileQueued', file );\n                return file;\n            },\n\n            getFile: function( fileId ) {\n                return this.queue.getFile( fileId );\n            },\n\n            /**\n             * @event filesQueued\n             * @param {File} files 数组，内容为原始File(lib/File）对象。\n             * @description 当一批文件添加进队列以后触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @property {Boolean} [auto=false]\n             * @namespace options\n             * @for Uploader\n             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n             *\n             */\n\n            /**\n             * @method addFiles\n             * @grammar addFiles( file ) => undefined\n             * @grammar addFiles( [file1, file2 ...] ) => undefined\n             * @param {Array of File or File} [files] Files 对象 数组\n             * @description 添加文件到队列\n             * @for  Uploader\n             */\n            addFile: function( files ) {\n                var me = this;\n\n                if ( !files.length ) {\n                    files = [ files ];\n                }\n\n                files = $.map( files, function( file ) {\n                    return me._addFile( file );\n                });\n\n                me.owner.trigger( 'filesQueued', files );\n\n                if ( me.options.auto ) {\n                    setTimeout(function() {\n                        me.request('start-upload');\n                    }, 20 );\n                }\n            },\n\n            getStats: function() {\n                return this.stats;\n            },\n\n            /**\n             * @event fileDequeued\n             * @param {File} file File对象\n             * @description 当文件被移除队列后触发。\n             * @for  Uploader\n             */\n\n             /**\n             * @method removeFile\n             * @grammar removeFile( file ) => undefined\n             * @grammar removeFile( id ) => undefined\n             * @grammar removeFile( file, true ) => undefined\n             * @grammar removeFile( id, true ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.removeFile( file );\n             * })\n             */\n            removeFile: function( file, remove ) {\n                var me = this;\n\n                file = file.id ? file : me.queue.getFile( file );\n\n                this.request( 'cancel-file', file );\n\n                if ( remove ) {\n                    this.queue.removeFile( file );\n                }\n            },\n\n            /**\n             * @method getFiles\n             * @grammar getFiles() => Array\n             * @grammar getFiles( status1, status2, status... ) => Array\n             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n             * @for  Uploader\n             * @example\n             * console.log( uploader.getFiles() );    // => all files\n             * console.log( uploader.getFiles('error') )    // => all error files.\n             */\n            getFiles: function() {\n                return this.queue.getFiles.apply( this.queue, arguments );\n            },\n\n            fetchFile: function() {\n                return this.queue.fetch.apply( this.queue, arguments );\n            },\n\n            /**\n             * @method retry\n             * @grammar retry() => undefined\n             * @grammar retry( file ) => undefined\n             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n             * @for  Uploader\n             * @example\n             * function retry() {\n             *     uploader.retry();\n             * }\n             */\n            retry: function( file, noForceStart ) {\n                var me = this,\n                    files, i, len;\n\n                if ( file ) {\n                    file = file.id ? file : me.queue.getFile( file );\n                    file.setStatus( Status.QUEUED );\n                    noForceStart || me.request('start-upload');\n                    return;\n                }\n\n                files = me.queue.getFiles( Status.ERROR );\n                i = 0;\n                len = files.length;\n\n                for ( ; i < len; i++ ) {\n                    file = files[ i ];\n                    file.setStatus( Status.QUEUED );\n                }\n\n                me.request('start-upload');\n            },\n\n            /**\n             * @method sort\n             * @grammar sort( fn ) => undefined\n             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n             * @for  Uploader\n             */\n            sortFiles: function() {\n                return this.queue.sort.apply( this.queue, arguments );\n            },\n\n            /**\n             * @event reset\n             * @description 当 uploader 被重置的时候触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @method reset\n             * @grammar reset() => undefined\n             * @description 重置uploader。目前只重置了队列。\n             * @for  Uploader\n             * @example\n             * uploader.reset();\n             */\n            reset: function() {\n                this.owner.trigger('reset');\n                this.queue = new Queue();\n                this.stats = this.queue.stats;\n            },\n\n            destroy: function() {\n                this.reset();\n                this.placeholder && this.placeholder.destroy();\n            }\n        });\n\n    });\n    /**\n     * @fileOverview 添加获取Runtime相关信息的方法。\n     */\n    define('widgets/runtime',[\n        'uploader',\n        'runtime/runtime',\n        'widgets/widget'\n    ], function( Uploader, Runtime ) {\n\n        Uploader.support = function() {\n            return Runtime.hasRuntime.apply( Runtime, arguments );\n        };\n\n        /**\n         * @property {Object} [runtimeOrder=html5,flash]\n         * @namespace options\n         * @for Uploader\n         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n         *\n         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n         */\n\n        return Uploader.register({\n            name: 'runtime',\n\n            init: function() {\n                if ( !this.predictRuntimeType() ) {\n                    throw Error('Runtime Error');\n                }\n            },\n\n            /**\n             * 预测Uploader将采用哪个`Runtime`\n             * @grammar predictRuntimeType() => String\n             * @method predictRuntimeType\n             * @for  Uploader\n             */\n            predictRuntimeType: function() {\n                var orders = this.options.runtimeOrder || Runtime.orders,\n                    type = this.type,\n                    i, len;\n\n                if ( !type ) {\n                    orders = orders.split( /\\s*,\\s*/g );\n\n                    for ( i = 0, len = orders.length; i < len; i++ ) {\n                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n                            this.type = type = orders[ i ];\n                            break;\n                        }\n                    }\n                }\n\n                return type;\n            }\n        });\n    });\n    /**\n     * @fileOverview Transport\n     */\n    define('lib/transport',[\n        'base',\n        'runtime/client',\n        'mediator'\n    ], function( Base, RuntimeClient, Mediator ) {\n\n        var $ = Base.$;\n\n        function Transport( opts ) {\n            var me = this;\n\n            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n            RuntimeClient.call( this, 'Transport' );\n\n            this._blob = null;\n            this._formData = opts.formData || {};\n            this._headers = opts.headers || {};\n\n            this.on( 'progress', this._timeout );\n            this.on( 'load error', function() {\n                me.trigger( 'progress', 1 );\n                clearTimeout( me._timer );\n            });\n        }\n\n        Transport.options = {\n            server: '',\n            method: 'POST',\n\n            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n            withCredentials: false,\n            fileVal: 'file',\n            timeout: 2 * 60 * 1000,    // 2分钟\n            formData: {},\n            headers: {},\n            sendAsBinary: false\n        };\n\n        $.extend( Transport.prototype, {\n\n            // 添加Blob, 只能添加一次，最后一次有效。\n            appendBlob: function( key, blob, filename ) {\n                var me = this,\n                    opts = me.options;\n\n                if ( me.getRuid() ) {\n                    me.disconnectRuntime();\n                }\n\n                // 连接到blob归属的同一个runtime.\n                me.connectRuntime( blob.ruid, function() {\n                    me.exec('init');\n                });\n\n                me._blob = blob;\n                opts.fileVal = key || opts.fileVal;\n                opts.filename = filename || opts.filename;\n\n            },\n\n            // 添加其他字段\n            append: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._formData, key );\n                } else {\n                    this._formData[ key ] = value;\n                }\n            },\n\n            setRequestHeader: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._headers, key );\n                } else {\n                    this._headers[ key ] = value;\n                }\n            },\n\n            send: function( method ) {\n                this.exec( 'send', method );\n                this._timeout();\n            },\n\n            abort: function() {\n                clearTimeout( this._timer );\n                return this.exec('abort');\n            },\n\n            destroy: function() {\n                this.trigger('destroy');\n                this.off();\n                this.exec('destroy');\n                this.disconnectRuntime();\n            },\n\n            getResponse: function() {\n                return this.exec('getResponse');\n            },\n\n            getResponseAsJson: function() {\n                return this.exec('getResponseAsJson');\n            },\n\n            getStatus: function() {\n                return this.exec('getStatus');\n            },\n\n            _timeout: function() {\n                var me = this,\n                    duration = me.options.timeout;\n\n                if ( !duration ) {\n                    return;\n                }\n\n                clearTimeout( me._timer );\n                me._timer = setTimeout(function() {\n                    me.abort();\n                    me.trigger( 'error', 'timeout' );\n                }, duration );\n            }\n\n        });\n\n        // 让Transport具备事件功能。\n        Mediator.installTo( Transport.prototype );\n\n        return Transport;\n    });\n    /**\n     * @fileOverview 负责文件上传相关。\n     */\n    define('widgets/upload',[\n        'base',\n        'uploader',\n        'file',\n        'lib/transport',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile, Transport ) {\n\n        var $ = Base.$,\n            isPromise = Base.isPromise,\n            Status = WUFile.Status;\n\n        // 添加默认配置项\n        $.extend( Uploader.options, {\n\n\n            /**\n             * @property {Boolean} [prepareNextFile=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否允许在文件传输时提前把下一个文件准备好。\n             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n             */\n            prepareNextFile: false,\n\n            /**\n             * @property {Boolean} [chunked=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否要分片处理大文件上传。\n             */\n            chunked: false,\n\n            /**\n             * @property {Boolean} [chunkSize=5242880]\n             * @namespace options\n             * @for Uploader\n             * @description 如果要分片，分多大一片？ 默认大小为5M.\n             */\n            chunkSize: 5 * 1024 * 1024,\n\n            /**\n             * @property {Boolean} [chunkRetry=2]\n             * @namespace options\n             * @for Uploader\n             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n             */\n            chunkRetry: 2,\n\n            /**\n             * @property {Boolean} [threads=3]\n             * @namespace options\n             * @for Uploader\n             * @description 上传并发数。允许同时最大上传进程数。\n             */\n            threads: 3,\n\n\n            /**\n             * @property {Object} [formData={}]\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n             */\n            formData: {}\n\n            /**\n             * @property {Object} [fileVal='file']\n             * @namespace options\n             * @for Uploader\n             * @description 设置文件上传域的name。\n             */\n\n            /**\n             * @property {Object} [method='POST']\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传方式，`POST`或者`GET`。\n             */\n\n            /**\n             * @property {Object} [sendAsBinary=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n             * 其他参数在$_GET数组中。\n             */\n        });\n\n        // 负责将文件切片。\n        function CuteFile( file, chunkSize ) {\n            var pending = [],\n                blob = file.source,\n                total = blob.size,\n                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n                start = 0,\n                index = 0,\n                len, api;\n\n            api = {\n                file: file,\n\n                has: function() {\n                    return !!pending.length;\n                },\n\n                shift: function() {\n                    return pending.shift();\n                },\n\n                unshift: function( block ) {\n                    pending.unshift( block );\n                }\n            };\n\n            while ( index < chunks ) {\n                len = Math.min( chunkSize, total - start );\n\n                pending.push({\n                    file: file,\n                    start: start,\n                    end: chunkSize ? (start + len) : total,\n                    total: total,\n                    chunks: chunks,\n                    chunk: index++,\n                    cuted: api\n                });\n                start += len;\n            }\n\n            file.blocks = pending.concat();\n            file.remaning = pending.length;\n\n            return api;\n        }\n\n        Uploader.register({\n            name: 'upload',\n\n            init: function() {\n                var owner = this.owner,\n                    me = this;\n\n                this.runing = false;\n                this.progress = false;\n\n                owner\n                    .on( 'startUpload', function() {\n                        me.progress = true;\n                    })\n                    .on( 'uploadFinished', function() {\n                        me.progress = false;\n                    });\n\n                // 记录当前正在传的数据，跟threads相关\n                this.pool = [];\n\n                // 缓存分好片的文件。\n                this.stack = [];\n\n                // 缓存即将上传的文件。\n                this.pending = [];\n\n                // 跟踪还有多少分片在上传中但是没有完成上传。\n                this.remaning = 0;\n                this.__tick = Base.bindFn( this._tick, this );\n\n                owner.on( 'uploadComplete', function( file ) {\n\n                    // 把其他块取消了。\n                    file.blocks && $.each( file.blocks, function( _, v ) {\n                        v.transport && (v.transport.abort(), v.transport.destroy());\n                        delete v.transport;\n                    });\n\n                    delete file.blocks;\n                    delete file.remaning;\n                });\n            },\n\n            reset: function() {\n                this.request( 'stop-upload', true );\n                this.runing = false;\n                this.pool = [];\n                this.stack = [];\n                this.pending = [];\n                this.remaning = 0;\n                this._trigged = false;\n                this._promise = null;\n            },\n\n            /**\n             * @event startUpload\n             * @description 当开始上传流程时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n             *\n             * 可以指定开始某一个文件。\n             * @grammar upload() => undefined\n             * @grammar upload( file | fileId) => undefined\n             * @method upload\n             * @for  Uploader\n             */\n            startUpload: function(file) {\n                var me = this;\n\n                // 移出invalid的文件\n                $.each( me.request( 'get-files', Status.INVALID ), function() {\n                    me.request( 'remove-file', this );\n                });\n\n                // 如果指定了开始某个文件，则只开始指定文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        $.each( me.pool, function( _, v ) {\n\n                            // 之前暂停过。\n                            if (v.file !== file) {\n                                return;\n                            }\n\n                            v.transport && v.transport.send();\n                        });\n\n                        file.setStatus( Status.QUEUED );\n                    } else if (file.getStatus() === Status.PROGRESS) {\n                        return;\n                    } else {\n                        file.setStatus( Status.QUEUED );\n                    }\n                } else {\n                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n                        this.setStatus( Status.QUEUED );\n                    });\n                }\n\n                if ( me.runing ) {\n                    return;\n                }\n\n                me.runing = true;\n\n                var files = [];\n\n                // 如果有暂停的，则续传\n                $.each( me.pool, function( _, v ) {\n                    var file = v.file;\n\n                    if ( file.getStatus() === Status.INTERRUPT ) {\n                        files.push(file);\n                        me._trigged = false;\n                        v.transport && v.transport.send();\n                    }\n                });\n\n                var file;\n                while ( (file = files.shift()) ) {\n                    file.setStatus( Status.PROGRESS );\n                }\n\n                file || $.each( me.request( 'get-files',\n                        Status.INTERRUPT ), function() {\n                    this.setStatus( Status.PROGRESS );\n                });\n\n                me._trigged = false;\n                Base.nextTick( me.__tick );\n                me.owner.trigger('startUpload');\n            },\n\n            /**\n             * @event stopUpload\n             * @description 当开始上传流程暂停时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n             *\n             * 如果第一个参数是文件，则只暂停指定文件。\n             * @grammar stop() => undefined\n             * @grammar stop( true ) => undefined\n             * @grammar stop( file ) => undefined\n             * @method stop\n             * @for  Uploader\n             */\n            stopUpload: function( file, interrupt ) {\n                var me = this;\n\n                if (file === true) {\n                    interrupt = file;\n                    file = null;\n                }\n\n                if ( me.runing === false ) {\n                    return;\n                }\n\n                // 如果只是暂停某个文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n\n                    if ( file.getStatus() !== Status.PROGRESS &&\n                            file.getStatus() !== Status.QUEUED ) {\n                        return;\n                    }\n\n                    file.setStatus( Status.INTERRUPT );\n                    $.each( me.pool, function( _, v ) {\n\n                        // 只 abort 指定的文件。\n                        if (v.file !== file) {\n                            return;\n                        }\n\n                        v.transport && v.transport.abort();\n                        me._putback(v);\n                        me._popBlock(v);\n                    });\n\n                    return Base.nextTick( me.__tick );\n                }\n\n                me.runing = false;\n\n                if (this._promise && this._promise.file) {\n                    this._promise.file.setStatus( Status.INTERRUPT );\n                }\n\n                interrupt && $.each( me.pool, function( _, v ) {\n                    v.transport && v.transport.abort();\n                    v.file.setStatus( Status.INTERRUPT );\n                });\n\n                me.owner.trigger('stopUpload');\n            },\n\n            /**\n             * @method cancelFile\n             * @grammar cancelFile( file ) => undefined\n             * @grammar cancelFile( id ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 标记文件状态为已取消, 同时将中断文件传输。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.cancelFile( file );\n             * })\n             */\n            cancelFile: function( file ) {\n                file = file.id ? file : this.request( 'get-file', file );\n\n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n\n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n\n                file.setStatus( Status.CANCELLED );\n                this.owner.trigger( 'fileDequeued', file );\n            },\n\n            /**\n             * 判断`Uplaode`r是否正在上传中。\n             * @grammar isInProgress() => Boolean\n             * @method isInProgress\n             * @for  Uploader\n             */\n            isInProgress: function() {\n                return !!this.progress;\n            },\n\n            _getStats: function() {\n                return this.request('get-stats');\n            },\n\n            /**\n             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n             * @grammar skipFile( file ) => undefined\n             * @method skipFile\n             * @for  Uploader\n             */\n            skipFile: function( file, status ) {\n                file = file.id ? file : this.request( 'get-file', file );\n\n                file.setStatus( status || Status.COMPLETE );\n                file.skipped = true;\n\n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n\n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n\n                this.owner.trigger( 'uploadSkip', file );\n            },\n\n            /**\n             * @event uploadFinished\n             * @description 当所有文件上传结束时触发。\n             * @for  Uploader\n             */\n            _tick: function() {\n                var me = this,\n                    opts = me.options,\n                    fn, val;\n\n                // 上一个promise还没有结束，则等待完成后再执行。\n                if ( me._promise ) {\n                    return me._promise.always( me.__tick );\n                }\n\n                // 还有位置，且还有文件要处理的话。\n                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n                    me._trigged = false;\n\n                    fn = function( val ) {\n                        me._promise = null;\n\n                        // 有可能是reject过来的，所以要检测val的类型。\n                        val && val.file && me._startSend( val );\n                        Base.nextTick( me.__tick );\n                    };\n\n                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n\n                // 没有要上传的了，且没有正在传输的了。\n                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n                    !me._getStats().numofInterrupt ) {\n                    me.runing = false;\n\n                    me._trigged || Base.nextTick(function() {\n                        me.owner.trigger('uploadFinished');\n                    });\n                    me._trigged = true;\n                }\n            },\n\n            _putback: function(block) {\n                var idx;\n\n                block.cuted.unshift(block);\n                idx = this.stack.indexOf(block.cuted);\n\n                if (!~idx) {\n                    this.stack.unshift(block.cuted);\n                }\n            },\n\n            _getStack: function() {\n                var i = 0,\n                    act;\n\n                while ( (act = this.stack[ i++ ]) ) {\n                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n                        return act;\n                    } else if (!act.has() ||\n                            act.file.getStatus() !== Status.PROGRESS &&\n                            act.file.getStatus() !== Status.INTERRUPT ) {\n\n                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n                        // interupt（暂停中） 的移除。\n                        this.stack.splice( --i, 1 );\n                    }\n                }\n\n                return null;\n            },\n\n            _nextBlock: function() {\n                var me = this,\n                    opts = me.options,\n                    act, next, done, preparing;\n\n                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n                if ( (act = this._getStack()) ) {\n\n                    // 是否提前准备下一个文件\n                    if ( opts.prepareNextFile && !me.pending.length ) {\n                        me._prepareNextFile();\n                    }\n\n                    return act.shift();\n\n                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n                } else if ( me.runing ) {\n\n                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n                        me._prepareNextFile();\n                    }\n\n                    next = me.pending.shift();\n                    done = function( file ) {\n                        if ( !file ) {\n                            return null;\n                        }\n\n                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n                        me.stack.push(act);\n                        return act.shift();\n                    };\n\n                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n                    if ( isPromise( next) ) {\n                        preparing = next.file;\n                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n                        next.file = preparing;\n                        return next;\n                    }\n\n                    return done( next );\n                }\n            },\n\n\n            /**\n             * @event uploadStart\n             * @param {File} file File对象\n             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n             * @for  Uploader\n             */\n            _prepareNextFile: function() {\n                var me = this,\n                    file = me.request('fetch-file'),\n                    pending = me.pending,\n                    promise;\n\n                if ( file ) {\n                    promise = me.request( 'before-send-file', file, function() {\n\n                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n                        if ( file.getStatus() === Status.PROGRESS ||\n                            file.getStatus() === Status.INTERRUPT ) {\n                            return file;\n                        }\n\n                        return me._finishFile( file );\n                    });\n\n                    me.owner.trigger( 'uploadStart', file );\n                    file.setStatus( Status.PROGRESS );\n\n                    promise.file = file;\n\n                    // 如果还在pending中，则替换成文件本身。\n                    promise.done(function() {\n                        var idx = $.inArray( promise, pending );\n\n                        ~idx && pending.splice( idx, 1, file );\n                    });\n\n                    // befeore-send-file的钩子就有错误发生。\n                    promise.fail(function( reason ) {\n                        file.setStatus( Status.ERROR, reason );\n                        me.owner.trigger( 'uploadError', file, reason );\n                        me.owner.trigger( 'uploadComplete', file );\n                    });\n\n                    pending.push( promise );\n                }\n            },\n\n            // 让出位置了，可以让其他分片开始上传\n            _popBlock: function( block ) {\n                var idx = $.inArray( block, this.pool );\n\n                this.pool.splice( idx, 1 );\n                block.file.remaning--;\n                this.remaning--;\n            },\n\n            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n            _startSend: function( block ) {\n                var me = this,\n                    file = block.file,\n                    promise;\n\n                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n                // 如：暂停，取消\n                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n                if ( file.getStatus() !== Status.PROGRESS ) {\n\n                    // 如果是中断，则还需要放回去。\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        me._putback(block);\n                    }\n\n                    return;\n                }\n\n                me.pool.push( block );\n                me.remaning++;\n\n                // 如果没有分片，则直接使用原始的。\n                // 不会丢失content-type信息。\n                block.blob = block.chunks === 1 ? file.source :\n                        file.source.slice( block.start, block.end );\n\n                // hook, 每个分片发送之前可能要做些异步的事情。\n                promise = me.request( 'before-send', block, function() {\n\n                    // 有可能文件已经上传出错了，所以不需要再传输了。\n                    if ( file.getStatus() === Status.PROGRESS ) {\n                        me._doSend( block );\n                    } else {\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n\n                // 如果为fail了，则跳过此分片。\n                promise.fail(function() {\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file ).always(function() {\n                            block.percentage = 1;\n                            me._popBlock( block );\n                            me.owner.trigger( 'uploadComplete', file );\n                            Base.nextTick( me.__tick );\n                        });\n                    } else {\n                        block.percentage = 1;\n                        me.updateFileProgress( file );\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n            },\n\n\n            /**\n             * @event uploadBeforeSend\n             * @param {Object} object\n             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n             * @param {Object} headers 可以扩展此对象来控制上传头部。\n             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadAccept\n             * @param {Object} object\n             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadProgress\n             * @param {File} file File对象\n             * @param {Number} percentage 上传进度\n             * @description 上传过程中触发，携带上传进度。\n             * @for  Uploader\n             */\n\n\n            /**\n             * @event uploadError\n             * @param {File} file File对象\n             * @param {String} reason 出错的code\n             * @description 当文件上传出错时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadSuccess\n             * @param {File} file File对象\n             * @param {Object} response 服务端返回的数据\n             * @description 当文件上传成功时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadComplete\n             * @param {File} [file] File对象\n             * @description 不管成功或者失败，文件上传完成时触发。\n             * @for  Uploader\n             */\n\n            // 做上传操作。\n            _doSend: function( block ) {\n                var me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    file = block.file,\n                    tr = new Transport( opts ),\n                    data = $.extend({}, opts.formData ),\n                    headers = $.extend({}, opts.headers ),\n                    requestAccept, ret;\n\n                block.transport = tr;\n\n                tr.on( 'destroy', function() {\n                    delete block.transport;\n                    me._popBlock( block );\n                    Base.nextTick( me.__tick );\n                });\n\n                // 广播上传进度。以文件为单位。\n                tr.on( 'progress', function( percentage ) {\n                    block.percentage = percentage;\n                    me.updateFileProgress( file );\n                });\n\n                // 用来询问，是否返回的结果是有错误的。\n                requestAccept = function( reject ) {\n                    var fn;\n\n                    ret = tr.getResponseAsJson() || {};\n                    ret._raw = tr.getResponse();\n                    fn = function( value ) {\n                        reject = value;\n                    };\n\n                    // 服务端响应了，不代表成功了，询问是否响应正确。\n                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n                        reject = reject || 'server';\n                    }\n\n                    return reject;\n                };\n\n                // 尝试重试，然后广播文件上传出错。\n                tr.on( 'error', function( type, flag ) {\n                    block.retried = block.retried || 0;\n\n                    // 自动重试\n                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n                            block.retried < opts.chunkRetry ) {\n\n                        block.retried++;\n                        tr.send();\n\n                    } else {\n\n                        // http status 500 ~ 600\n                        if ( !flag && type === 'server' ) {\n                            type = requestAccept( type );\n                        }\n\n                        file.setStatus( Status.ERROR, type );\n                        owner.trigger( 'uploadError', file, type );\n                        owner.trigger( 'uploadComplete', file );\n                    }\n                });\n\n                // 上传成功\n                tr.on( 'load', function() {\n                    var reason;\n\n                    // 如果非预期，转向上传出错。\n                    if ( (reason = requestAccept()) ) {\n                        tr.trigger( 'error', reason, true );\n                        return;\n                    }\n\n                    // 全部上传完成。\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file, ret );\n                    } else {\n                        tr.destroy();\n                    }\n                });\n\n                // 配置默认的上传字段。\n                data = $.extend( data, {\n                    id: file.id,\n                    name: file.name,\n                    type: file.type,\n                    lastModifiedDate: file.lastModifiedDate,\n                    size: file.size\n                });\n\n                block.chunks > 1 && $.extend( data, {\n                    chunks: block.chunks,\n                    chunk: block.chunk\n                });\n\n                // 在发送之间可以添加字段什么的。。。\n                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n                owner.trigger( 'uploadBeforeSend', block, data, headers );\n\n                // 开始发送。\n                tr.appendBlob( opts.fileVal, block.blob, file.name );\n                tr.append( data );\n                tr.setRequestHeader( headers );\n                tr.send();\n            },\n\n            // 完成上传。\n            _finishFile: function( file, ret, hds ) {\n                var owner = this.owner;\n\n                return owner\n                        .request( 'after-send-file', arguments, function() {\n                            file.setStatus( Status.COMPLETE );\n                            owner.trigger( 'uploadSuccess', file, ret, hds );\n                        })\n                        .fail(function( reason ) {\n\n                            // 如果外部已经标记为invalid什么的，不再改状态。\n                            if ( file.getStatus() === Status.PROGRESS ) {\n                                file.setStatus( Status.ERROR, reason );\n                            }\n\n                            owner.trigger( 'uploadError', file, reason );\n                        })\n                        .always(function() {\n                            owner.trigger( 'uploadComplete', file );\n                        });\n            },\n\n            updateFileProgress: function(file) {\n                var totalPercent = 0,\n                    uploaded = 0;\n\n                if (!file.blocks) {\n                    return;\n                }\n\n                $.each( file.blocks, function( _, v ) {\n                    uploaded += (v.percentage || 0) * (v.end - v.start);\n                });\n\n                totalPercent = uploaded / file.size;\n                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n            }\n\n        });\n    });\n    /**\n     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n     */\n\n    define('widgets/validator',[\n        'base',\n        'uploader',\n        'file',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile ) {\n\n        var $ = Base.$,\n            validators = {},\n            api;\n\n        /**\n         * @event error\n         * @param {String} type 错误类型。\n         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n         *\n         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n         * @for  Uploader\n         */\n\n        // 暴露给外面的api\n        api = {\n\n            // 添加验证器\n            addValidator: function( type, cb ) {\n                validators[ type ] = cb;\n            },\n\n            // 移除验证器\n            removeValidator: function( type ) {\n                delete validators[ type ];\n            }\n        };\n\n        // 在Uploader初始化的时候启动Validators的初始化\n        Uploader.register({\n            name: 'validator',\n\n            init: function() {\n                var me = this;\n                Base.nextTick(function() {\n                    $.each( validators, function() {\n                        this.call( me.owner );\n                    });\n                });\n            }\n        });\n\n        /**\n         * @property {int} [fileNumLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总数量, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileNumLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileNumLimit, 10 ),\n                flag = true;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n\n                if ( count >= max && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n\n                return count >= max ? false : true;\n            });\n\n            uploader.on( 'fileQueued', function() {\n                count++;\n            });\n\n            uploader.on( 'fileDequeued', function() {\n                count--;\n            });\n\n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n\n\n        /**\n         * @property {int} [fileSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileSizeLimit, 10 ),\n                flag = true;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n                var invalid = count + file.size > max;\n\n                if ( invalid && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n\n                return invalid ? false : true;\n            });\n\n            uploader.on( 'fileQueued', function( file ) {\n                count += file.size;\n            });\n\n            uploader.on( 'fileDequeued', function( file ) {\n                count -= file.size;\n            });\n\n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n\n        /**\n         * @property {int} [fileSingleSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSingleSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                max = opts.fileSingleSizeLimit;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n\n                if ( file.size > max ) {\n                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n                    return false;\n                }\n\n            });\n\n        });\n\n        /**\n         * @property {Boolean} [duplicate=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n         */\n        api.addValidator( 'duplicate', function() {\n            var uploader = this,\n                opts = uploader.options,\n                mapping = {};\n\n            if ( opts.duplicate ) {\n                return;\n            }\n\n            function hashString( str ) {\n                var hash = 0,\n                    i = 0,\n                    len = str.length,\n                    _char;\n\n                for ( ; i < len; i++ ) {\n                    _char = str.charCodeAt( i );\n                    hash = _char + (hash << 6) + (hash << 16) - hash;\n                }\n\n                return hash;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n                var hash = file.__hash || (file.__hash = hashString( file.name +\n                        file.size + file.lastModifiedDate ));\n\n                // 已经重复了\n                if ( mapping[ hash ] ) {\n                    this.trigger( 'error', 'F_DUPLICATE', file );\n                    return false;\n                }\n            });\n\n            uploader.on( 'fileQueued', function( file ) {\n                var hash = file.__hash;\n\n                hash && (mapping[ hash ] = true);\n            });\n\n            uploader.on( 'fileDequeued', function( file ) {\n                var hash = file.__hash;\n\n                hash && (delete mapping[ hash ]);\n            });\n\n            uploader.on( 'reset', function() {\n                mapping = {};\n            });\n        });\n\n        return api;\n    });\n\n    /**\n     * @fileOverview Md5\n     */\n    define('lib/md5',[\n        'runtime/client',\n        'mediator'\n    ], function( RuntimeClient, Mediator ) {\n\n        function Md5() {\n            RuntimeClient.call( this, 'Md5' );\n        }\n\n        // 让 Md5 具备事件功能。\n        Mediator.installTo( Md5.prototype );\n\n        Md5.prototype.loadFromBlob = function( blob ) {\n            var me = this;\n\n            if ( me.getRuid() ) {\n                me.disconnectRuntime();\n            }\n\n            // 连接到blob归属的同一个runtime.\n            me.connectRuntime( blob.ruid, function() {\n                me.exec('init');\n                me.exec( 'loadFromBlob', blob );\n            });\n        };\n\n        Md5.prototype.getResult = function() {\n            return this.exec('getResult');\n        };\n\n        return Md5;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/md5',[\n        'base',\n        'uploader',\n        'lib/md5',\n        'lib/blob',\n        'widgets/widget'\n    ], function( Base, Uploader, Md5, Blob ) {\n\n        return Uploader.register({\n            name: 'md5',\n\n\n            /**\n             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n             *\n             *\n             * @method md5File\n             * @grammar md5File( file[, start[, end]] ) => promise\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.md5File( file )\n             *\n             *         // 及时显示进度\n             *         .progress(function(percentage) {\n             *             console.log('Percentage:', percentage);\n             *         })\n             *\n             *         // 完成\n             *         .then(function(val) {\n             *             console.log('md5 result:', val);\n             *         });\n             *\n             * });\n             */\n            md5File: function( file, start, end ) {\n                var md5 = new Md5(),\n                    deferred = Base.Deferred(),\n                    blob = (file instanceof Blob) ? file :\n                        this.request( 'get-file', file ).source;\n\n                md5.on( 'progress load', function( e ) {\n                    e = e || {};\n                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n                });\n\n                md5.on( 'complete', function() {\n                    deferred.resolve( md5.getResult() );\n                });\n\n                md5.on( 'error', function( reason ) {\n                    deferred.reject( reason );\n                });\n\n                if ( arguments.length > 1 ) {\n                    start = start || 0;\n                    end = end || 0;\n                    start < 0 && (start = blob.size + start);\n                    end < 0 && (end = blob.size + end);\n                    end = Math.min( end, blob.size );\n                    blob = blob.slice( start, end );\n                }\n\n                md5.loadFromBlob( blob );\n\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/compbase',[],function() {\n\n        function CompBase( owner, runtime ) {\n\n            this.owner = owner;\n            this.options = owner.options;\n\n            this.getRuntime = function() {\n                return runtime;\n            };\n\n            this.getRuid = function() {\n                return runtime.uid;\n            };\n\n            this.trigger = function() {\n                return owner.trigger.apply( owner, arguments );\n            };\n        }\n\n        return CompBase;\n    });\n    /**\n     * @fileOverview Html5Runtime\n     */\n    define('runtime/html5/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n\n        var type = 'html5',\n            components = {};\n\n        function Html5Runtime() {\n            var pool = {},\n                me = this,\n                destroy = this.destroy;\n\n            Runtime.apply( me, arguments );\n            me.type = type;\n\n\n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n\n                if ( components[ comp ] ) {\n                    instance = pool[ uid ] = pool[ uid ] ||\n                            new components[ comp ]( client, me );\n\n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n            };\n\n            me.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n        }\n\n        Base.inherits( Runtime, {\n            constructor: Html5Runtime,\n\n            // 不需要连接其他程序，直接执行callback\n            init: function() {\n                var me = this;\n                setTimeout(function() {\n                    me.trigger('ready');\n                }, 1 );\n            }\n\n        });\n\n        // 注册Components\n        Html5Runtime.register = function( name, component ) {\n            var klass = components[ name ] = Base.inherits( CompBase, component );\n            return klass;\n        };\n\n        // 注册html5运行时。\n        // 只有在支持的前提下注册。\n        if ( window.Blob && window.FileReader && window.DataView ) {\n            Runtime.addRuntime( type, Html5Runtime );\n        }\n\n        return Html5Runtime;\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/html5/blob',[\n        'runtime/html5/runtime',\n        'lib/blob'\n    ], function( Html5Runtime, Blob ) {\n\n        return Html5Runtime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.owner.source,\n                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n\n                blob = slice.call( blob, start, end );\n\n                return new Blob( this.getRuid(), blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/dnd',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n\n        var $ = Base.$,\n            prefix = 'webuploader-dnd-';\n\n        return Html5Runtime.register( 'DragAndDrop', {\n            init: function() {\n                var elem = this.elem = this.options.container;\n\n                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n                this.dropHandler = Base.bindFn( this._dropHandler, this );\n                this.dndOver = false;\n\n                elem.on( 'dragenter', this.dragEnterHandler );\n                elem.on( 'dragover', this.dragOverHandler );\n                elem.on( 'dragleave', this.dragLeaveHandler );\n                elem.on( 'drop', this.dropHandler );\n\n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).on( 'dragover', this.dragOverHandler );\n                    $( document ).on( 'drop', this.dropHandler );\n                }\n            },\n\n            _dragEnterHandler: function( e ) {\n                var me = this,\n                    denied = me._denied || false,\n                    items;\n\n                e = e.originalEvent || e;\n\n                if ( !me.dndOver ) {\n                    me.dndOver = true;\n\n                    // 注意只有 chrome 支持。\n                    items = e.dataTransfer.items;\n\n                    if ( items && items.length ) {\n                        me._denied = denied = !me.trigger( 'accept', items );\n                    }\n\n                    me.elem.addClass( prefix + 'over' );\n                    me.elem[ denied ? 'addClass' :\n                            'removeClass' ]( prefix + 'denied' );\n                }\n\n                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n\n                return false;\n            },\n\n            _dragOverHandler: function( e ) {\n                // 只处理框内的。\n                var parentElem = this.elem.parent().get( 0 );\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n\n                clearTimeout( this._leaveTimer );\n                this._dragEnterHandler.call( this, e );\n\n                return false;\n            },\n\n            _dragLeaveHandler: function() {\n                var me = this,\n                    handler;\n\n                handler = function() {\n                    me.dndOver = false;\n                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n                };\n\n                clearTimeout( me._leaveTimer );\n                me._leaveTimer = setTimeout( handler, 100 );\n                return false;\n            },\n\n            _dropHandler: function( e ) {\n                var me = this,\n                    ruid = me.getRuid(),\n                    parentElem = me.elem.parent().get( 0 ),\n                    dataTransfer, data;\n\n                // 只处理框内的。\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n\n                e = e.originalEvent || e;\n                dataTransfer = e.dataTransfer;\n\n                // 如果是页面内拖拽，还不能处理，不阻止事件。\n                // 此处 ie11 下会报参数错误，\n                try {\n                    data = dataTransfer.getData('text/html');\n                } catch( err ) {\n                }\n\n                if ( data ) {\n                    return;\n                }\n\n                me._getTansferFiles( dataTransfer, function( results ) {\n                    me.trigger( 'drop', $.map( results, function( file ) {\n                        return new File( ruid, file );\n                    }) );\n                });\n\n                me.dndOver = false;\n                me.elem.removeClass( prefix + 'over' );\n                return false;\n            },\n\n            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n            _getTansferFiles: function( dataTransfer, callback ) {\n                var results  = [],\n                    promises = [],\n                    items, files, file, item, i, len, canAccessFolder;\n\n                items = dataTransfer.items;\n                files = dataTransfer.files;\n\n                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n\n                for ( i = 0, len = files.length; i < len; i++ ) {\n                    file = files[ i ];\n                    item = items && items[ i ];\n\n                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n\n                        promises.push( this._traverseDirectoryTree(\n                                item.webkitGetAsEntry(), results ) );\n                    } else {\n                        results.push( file );\n                    }\n                }\n\n                Base.when.apply( Base, promises ).done(function() {\n\n                    if ( !results.length ) {\n                        return;\n                    }\n\n                    callback( results );\n                });\n            },\n\n            _traverseDirectoryTree: function( entry, results ) {\n                var deferred = Base.Deferred(),\n                    me = this;\n\n                if ( entry.isFile ) {\n                    entry.file(function( file ) {\n                        results.push( file );\n                        deferred.resolve();\n                    });\n                } else if ( entry.isDirectory ) {\n                    entry.createReader().readEntries(function( entries ) {\n                        var len = entries.length,\n                            promises = [],\n                            arr = [],    // 为了保证顺序。\n                            i;\n\n                        for ( i = 0; i < len; i++ ) {\n                            promises.push( me._traverseDirectoryTree(\n                                    entries[ i ], arr ) );\n                        }\n\n                        Base.when.apply( Base, promises ).then(function() {\n                            results.push.apply( results, arr );\n                            deferred.resolve();\n                        }, deferred.reject );\n                    });\n                }\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                var elem = this.elem;\n\n                // 还没 init 就调用 destroy\n                if (!elem) {\n                    return;\n                }\n\n                elem.off( 'dragenter', this.dragEnterHandler );\n                elem.off( 'dragover', this.dragOverHandler );\n                elem.off( 'dragleave', this.dragLeaveHandler );\n                elem.off( 'drop', this.dropHandler );\n\n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).off( 'dragover', this.dragOverHandler );\n                    $( document ).off( 'drop', this.dropHandler );\n                }\n            }\n        });\n    });\n\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/filepaste',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n\n        return Html5Runtime.register( 'FilePaste', {\n            init: function() {\n                var opts = this.options,\n                    elem = this.elem = opts.container,\n                    accept = '.*',\n                    arr, i, len, item;\n\n                // accetp的mimeTypes中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].mimeTypes;\n                        item && arr.push( item );\n                    }\n\n                    if ( arr.length ) {\n                        accept = arr.join(',');\n                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n                    }\n                }\n                this.accept = accept = new RegExp( accept, 'i' );\n                this.hander = Base.bindFn( this._pasteHander, this );\n                elem.on( 'paste', this.hander );\n            },\n\n            _pasteHander: function( e ) {\n                var allowed = [],\n                    ruid = this.getRuid(),\n                    items, item, blob, i, len;\n\n                e = e.originalEvent || e;\n                items = e.clipboardData.items;\n\n                for ( i = 0, len = items.length; i < len; i++ ) {\n                    item = items[ i ];\n\n                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n                        continue;\n                    }\n\n                    allowed.push( new File( ruid, blob ) );\n                }\n\n                if ( allowed.length ) {\n                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.trigger( 'paste', allowed );\n                }\n            },\n\n            destroy: function() {\n                this.elem.off( 'paste', this.hander );\n            }\n        });\n    });\n\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/html5/filepicker',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n\n        var $ = Base.$;\n\n        return Html5Runtime.register( 'FilePicker', {\n            init: function() {\n                var container = this.getRuntime().getContainer(),\n                    me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    label = this.label = $( document.createElement('label') ),\n                    input =  this.input = $( document.createElement('input') ),\n                    arr, i, len, mouseHandler;\n\n                input.attr( 'type', 'file' );\n                //console.log(opts.name)\n                input.attr( 'name', 'file' );\n                input.addClass('webuploader-element-invisible');\n\n                label.on( 'click', function() {\n                    input.trigger('click');\n                });\n\n                label.css({\n                    opacity: 0,\n                    width: '100%',\n                    height: '100%',\n                    display: 'block',\n                    cursor: 'pointer',\n                    background: '#ffffff'\n                });\n\n                if ( opts.multiple ) {\n                    input.attr( 'multiple', 'multiple' );\n                }\n\n                // @todo Firefox不支持单独指定后缀\n                if ( opts.accept && opts.accept.length > 0 ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        arr.push( opts.accept[ i ].mimeTypes );\n                    }\n\n                    input.attr( 'accept', arr.join(',') );\n                }\n\n                container.append( input );\n                container.append( label );\n\n                mouseHandler = function( e ) {\n                    owner.trigger( e.type );\n                };\n\n                input.on( 'change', function( e ) {\n                    var fn = arguments.callee,\n                        clone;\n\n                    me.files = e.target.files;\n\n                    // reset input\n                    clone = this.cloneNode( true );\n                    clone.value = null;\n                    this.parentNode.replaceChild( clone, this );\n\n                    input.off();\n                    input = $( clone ).on( 'change', fn )\n                            .on( 'mouseenter mouseleave', mouseHandler );\n\n                    owner.trigger('change');\n                });\n\n                label.on( 'mouseenter mouseleave', mouseHandler );\n\n            },\n\n\n            getFiles: function() {\n                return this.files;\n            },\n\n            destroy: function() {\n                this.input.off();\n                this.label.off();\n            }\n        });\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/util',[\n        'base'\n    ], function( Base ) {\n\n        var urlAPI = window.createObjectURL && window ||\n                window.URL && URL.revokeObjectURL && URL ||\n                window.webkitURL,\n            createObjectURL = Base.noop,\n            revokeObjectURL = createObjectURL;\n\n        if ( urlAPI ) {\n\n            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n            createObjectURL = function() {\n                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n            };\n\n            revokeObjectURL = function() {\n                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n            };\n        }\n\n        return {\n            createObjectURL: createObjectURL,\n            revokeObjectURL: revokeObjectURL,\n\n            dataURL2Blob: function( dataURI ) {\n                var byteStr, intArray, ab, i, mimetype, parts;\n\n                parts = dataURI.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n\n                ab = new ArrayBuffer( byteStr.length );\n                intArray = new Uint8Array( ab );\n\n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n\n                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n\n                return this.arrayBufferToBlob( ab, mimetype );\n            },\n\n            dataURL2ArrayBuffer: function( dataURI ) {\n                var byteStr, intArray, i, parts;\n\n                parts = dataURI.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n\n                intArray = new Uint8Array( byteStr.length );\n\n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n\n                return intArray.buffer;\n            },\n\n            arrayBufferToBlob: function( buffer, type ) {\n                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n                    bb;\n\n                // android不支持直接new Blob, 只能借助blobbuilder.\n                if ( builder ) {\n                    bb = new builder();\n                    bb.append( buffer );\n                    return bb.getBlob( type );\n                }\n\n                return new Blob([ buffer ], type ? { type: type } : {} );\n            },\n\n            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n            // 你得到的结果是png.\n            canvasToDataUrl: function( canvas, type, quality ) {\n                return canvas.toDataURL( type, quality / 100 );\n            },\n\n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            parseMeta: function( blob, callback ) {\n                callback( false, {});\n            },\n\n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            updateImageHead: function( data ) {\n                return data;\n            }\n        };\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/imagemeta',[\n        'runtime/html5/util'\n    ], function( Util ) {\n\n        var api;\n\n        api = {\n            parsers: {\n                0xffe1: []\n            },\n\n            maxMetaDataSize: 262144,\n\n            parse: function( blob, cb ) {\n                var me = this,\n                    fr = new FileReader();\n\n                fr.onload = function() {\n                    cb( false, me._parse( this.result ) );\n                    fr = fr.onload = fr.onerror = null;\n                };\n\n                fr.onerror = function( e ) {\n                    cb( e.message );\n                    fr = fr.onload = fr.onerror = null;\n                };\n\n                blob = blob.slice( 0, me.maxMetaDataSize );\n                fr.readAsArrayBuffer( blob.getSource() );\n            },\n\n            _parse: function( buffer, noParse ) {\n                if ( buffer.byteLength < 6 ) {\n                    return;\n                }\n\n                var dataview = new DataView( buffer ),\n                    offset = 2,\n                    maxOffset = dataview.byteLength - 4,\n                    headLength = offset,\n                    ret = {},\n                    markerBytes, markerLength, parsers, i;\n\n                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n\n                    while ( offset < maxOffset ) {\n                        markerBytes = dataview.getUint16( offset );\n\n                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n                                markerBytes === 0xfffe ) {\n\n                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n\n                            if ( offset + markerLength > dataview.byteLength ) {\n                                break;\n                            }\n\n                            parsers = api.parsers[ markerBytes ];\n\n                            if ( !noParse && parsers ) {\n                                for ( i = 0; i < parsers.length; i += 1 ) {\n                                    parsers[ i ].call( api, dataview, offset,\n                                            markerLength, ret );\n                                }\n                            }\n\n                            offset += markerLength;\n                            headLength = offset;\n                        } else {\n                            break;\n                        }\n                    }\n\n                    if ( headLength > 6 ) {\n                        if ( buffer.slice ) {\n                            ret.imageHead = buffer.slice( 2, headLength );\n                        } else {\n                            // Workaround for IE10, which does not yet\n                            // support ArrayBuffer.slice:\n                            ret.imageHead = new Uint8Array( buffer )\n                                    .subarray( 2, headLength );\n                        }\n                    }\n                }\n\n                return ret;\n            },\n\n            updateImageHead: function( buffer, head ) {\n                var data = this._parse( buffer, true ),\n                    buf1, buf2, bodyoffset;\n\n\n                bodyoffset = 2;\n                if ( data.imageHead ) {\n                    bodyoffset = 2 + data.imageHead.byteLength;\n                }\n\n                if ( buffer.slice ) {\n                    buf2 = buffer.slice( bodyoffset );\n                } else {\n                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n                }\n\n                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n\n                buf1[ 0 ] = 0xFF;\n                buf1[ 1 ] = 0xD8;\n                buf1.set( new Uint8Array( head ), 2 );\n                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n\n                return buf1.buffer;\n            }\n        };\n\n        Util.parseMeta = function() {\n            return api.parse.apply( api, arguments );\n        };\n\n        Util.updateImageHead = function() {\n            return api.updateImageHead.apply( api, arguments );\n        };\n\n        return api;\n    });\n    /**\n     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n     * 暂时项目中只用了orientation.\n     *\n     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n     * @fileOverview EXIF解析\n     */\n\n    // Sample\n    // ====================================\n    // Make : Apple\n    // Model : iPhone 4S\n    // Orientation : 1\n    // XResolution : 72 [72/1]\n    // YResolution : 72 [72/1]\n    // ResolutionUnit : 2\n    // Software : QuickTime 7.7.1\n    // DateTime : 2013:09:01 22:53:55\n    // ExifIFDPointer : 190\n    // ExposureTime : 0.058823529411764705 [1/17]\n    // FNumber : 2.4 [12/5]\n    // ExposureProgram : Normal program\n    // ISOSpeedRatings : 800\n    // ExifVersion : 0220\n    // DateTimeOriginal : 2013:09:01 22:52:51\n    // DateTimeDigitized : 2013:09:01 22:52:51\n    // ComponentsConfiguration : YCbCr\n    // ShutterSpeedValue : 4.058893515764426\n    // ApertureValue : 2.5260688216892597 [4845/1918]\n    // BrightnessValue : -0.3126686601998395\n    // MeteringMode : Pattern\n    // Flash : Flash did not fire, compulsory flash mode\n    // FocalLength : 4.28 [107/25]\n    // SubjectArea : [4 values]\n    // FlashpixVersion : 0100\n    // ColorSpace : 1\n    // PixelXDimension : 2448\n    // PixelYDimension : 3264\n    // SensingMethod : One-chip color area sensor\n    // ExposureMode : 0\n    // WhiteBalance : Auto white balance\n    // FocalLengthIn35mmFilm : 35\n    // SceneCaptureType : Standard\n    define('runtime/html5/imagemeta/exif',[\n        'base',\n        'runtime/html5/imagemeta'\n    ], function( Base, ImageMeta ) {\n\n        var EXIF = {};\n\n        EXIF.ExifMap = function() {\n            return this;\n        };\n\n        EXIF.ExifMap.prototype.map = {\n            'Orientation': 0x0112\n        };\n\n        EXIF.ExifMap.prototype.get = function( id ) {\n            return this[ id ] || this[ this.map[ id ] ];\n        };\n\n        EXIF.exifTagTypes = {\n            // byte, 8-bit unsigned int:\n            1: {\n                getValue: function( dataView, dataOffset ) {\n                    return dataView.getUint8( dataOffset );\n                },\n                size: 1\n            },\n\n            // ascii, 8-bit byte:\n            2: {\n                getValue: function( dataView, dataOffset ) {\n                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n                },\n                size: 1,\n                ascii: true\n            },\n\n            // short, 16 bit int:\n            3: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint16( dataOffset, littleEndian );\n                },\n                size: 2\n            },\n\n            // long, 32 bit int:\n            4: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n\n            // rational = two long values,\n            // first is numerator, second is denominator:\n            5: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian ) /\n                        dataView.getUint32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            },\n\n            // slong, 32 bit signed int:\n            9: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n\n            // srational, two slongs, first is numerator, second is denominator:\n            10: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian ) /\n                        dataView.getInt32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            }\n        };\n\n        // undefined, 8-bit byte, value depending on field:\n        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n\n        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n                littleEndian ) {\n\n            var tagType = EXIF.exifTagTypes[ type ],\n                tagSize, dataOffset, values, i, str, c;\n\n            if ( !tagType ) {\n                Base.log('Invalid Exif data: Invalid tag type.');\n                return;\n            }\n\n            tagSize = tagType.size * length;\n\n            // Determine if the value is contained in the dataOffset bytes,\n            // or if the value at the dataOffset is a pointer to the actual data:\n            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n                    littleEndian ) : (offset + 8);\n\n            if ( dataOffset + tagSize > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid data offset.');\n                return;\n            }\n\n            if ( length === 1 ) {\n                return tagType.getValue( dataView, dataOffset, littleEndian );\n            }\n\n            values = [];\n\n            for ( i = 0; i < length; i += 1 ) {\n                values[ i ] = tagType.getValue( dataView,\n                        dataOffset + i * tagType.size, littleEndian );\n            }\n\n            if ( tagType.ascii ) {\n                str = '';\n\n                // Concatenate the chars:\n                for ( i = 0; i < values.length; i += 1 ) {\n                    c = values[ i ];\n\n                    // Ignore the terminating NULL byte(s):\n                    if ( c === '\\u0000' ) {\n                        break;\n                    }\n                    str += c;\n                }\n\n                return str;\n            }\n            return values;\n        };\n\n        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n                data ) {\n\n            var tag = dataView.getUint16( offset, littleEndian );\n            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n                    littleEndian );\n        };\n\n        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n                littleEndian, data ) {\n\n            var tagsNumber, dirEndOffset, i;\n\n            if ( dirOffset + 6 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory offset.');\n                return;\n            }\n\n            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n\n            if ( dirEndOffset + 4 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory size.');\n                return;\n            }\n\n            for ( i = 0; i < tagsNumber; i += 1 ) {\n                this.parseExifTag( dataView, tiffOffset,\n                        dirOffset + 2 + 12 * i,    // tag offset\n                        littleEndian, data );\n            }\n\n            // Return the offset to the next directory:\n            return dataView.getUint32( dirEndOffset, littleEndian );\n        };\n\n        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n        //     var hexData,\n        //         i,\n        //         b;\n        //     if (!length || offset + length > dataView.byteLength) {\n        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n        //         return;\n        //     }\n        //     hexData = [];\n        //     for (i = 0; i < length; i += 1) {\n        //         b = dataView.getUint8(offset + i);\n        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n        //     }\n        //     return 'data:image/jpeg,%' + hexData.join('%');\n        // };\n\n        EXIF.parseExifData = function( dataView, offset, length, data ) {\n\n            var tiffOffset = offset + 10,\n                littleEndian, dirOffset;\n\n            // Check for the ASCII code for \"Exif\" (0x45786966):\n            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n                // No Exif data, might be XMP data instead\n                return;\n            }\n            if ( tiffOffset + 8 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid segment size.');\n                return;\n            }\n\n            // Check for the two null bytes:\n            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n                Base.log('Invalid Exif data: Missing byte alignment offset.');\n                return;\n            }\n\n            // Check the byte alignment:\n            switch ( dataView.getUint16( tiffOffset ) ) {\n                case 0x4949:\n                    littleEndian = true;\n                    break;\n\n                case 0x4D4D:\n                    littleEndian = false;\n                    break;\n\n                default:\n                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n                    return;\n            }\n\n            // Check for the TIFF tag marker (0x002A):\n            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n                Base.log('Invalid Exif data: Missing TIFF marker.');\n                return;\n            }\n\n            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n            // Create the exif object to store the tags:\n            data.exif = new EXIF.ExifMap();\n            // Parse the tags of the main image directory and retrieve the\n            // offset to the next directory, usually the thumbnail directory:\n            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n                    tiffOffset + dirOffset, littleEndian, data );\n\n            // 尝试读取缩略图\n            // if ( dirOffset ) {\n            //     thumbnailData = {exif: {}};\n            //     dirOffset = EXIF.parseExifTags(\n            //         dataView,\n            //         tiffOffset,\n            //         tiffOffset + dirOffset,\n            //         littleEndian,\n            //         thumbnailData\n            //     );\n\n            //     // Check for JPEG Thumbnail offset:\n            //     if (thumbnailData.exif[0x0201]) {\n            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n            //             dataView,\n            //             tiffOffset + thumbnailData.exif[0x0201],\n            //             thumbnailData.exif[0x0202] // Thumbnail data length\n            //         );\n            //     }\n            // }\n        };\n\n        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n        return EXIF;\n    });\n    /**\n     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n     * android里面toDataUrl('image/jpege')得到的结果却是png.\n     *\n     * 所以这里没辙，只能借助这个工具\n     * @fileOverview jpeg encoder\n     */\n    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n\n        /*\n          Copyright (c) 2008, Adobe Systems Incorporated\n          All rights reserved.\n\n          Redistribution and use in source and binary forms, with or without\n          modification, are permitted provided that the following conditions are\n          met:\n\n          * Redistributions of source code must retain the above copyright notice,\n            this list of conditions and the following disclaimer.\n\n          * Redistributions in binary form must reproduce the above copyright\n            notice, this list of conditions and the following disclaimer in the\n            documentation and/or other materials provided with the distribution.\n\n          * Neither the name of Adobe Systems Incorporated nor the names of its\n            contributors may be used to endorse or promote products derived from\n            this software without specific prior written permission.\n\n          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n        */\n        /*\n        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n\n        Basic GUI blocking jpeg encoder\n        */\n\n        function JPEGEncoder(quality) {\n          var self = this;\n            var fround = Math.round;\n            var ffloor = Math.floor;\n            var YTable = new Array(64);\n            var UVTable = new Array(64);\n            var fdtbl_Y = new Array(64);\n            var fdtbl_UV = new Array(64);\n            var YDC_HT;\n            var UVDC_HT;\n            var YAC_HT;\n            var UVAC_HT;\n\n            var bitcode = new Array(65535);\n            var category = new Array(65535);\n            var outputfDCTQuant = new Array(64);\n            var DU = new Array(64);\n            var byteout = [];\n            var bytenew = 0;\n            var bytepos = 7;\n\n            var YDU = new Array(64);\n            var UDU = new Array(64);\n            var VDU = new Array(64);\n            var clt = new Array(256);\n            var RGB_YUV_TABLE = new Array(2048);\n            var currentQuality;\n\n            var ZigZag = [\n                     0, 1, 5, 6,14,15,27,28,\n                     2, 4, 7,13,16,26,29,42,\n                     3, 8,12,17,25,30,41,43,\n                     9,11,18,24,31,40,44,53,\n                    10,19,23,32,39,45,52,54,\n                    20,22,33,38,46,51,55,60,\n                    21,34,37,47,50,56,59,61,\n                    35,36,48,49,57,58,62,63\n                ];\n\n            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n            var std_ac_luminance_values = [\n                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n\n            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n            var std_ac_chrominance_values = [\n                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n\n            function initQuantTables(sf){\n                    var YQT = [\n                        16, 11, 10, 16, 24, 40, 51, 61,\n                        12, 12, 14, 19, 26, 58, 60, 55,\n                        14, 13, 16, 24, 40, 57, 69, 56,\n                        14, 17, 22, 29, 51, 87, 80, 62,\n                        18, 22, 37, 56, 68,109,103, 77,\n                        24, 35, 55, 64, 81,104,113, 92,\n                        49, 64, 78, 87,103,121,120,101,\n                        72, 92, 95, 98,112,100,103, 99\n                    ];\n\n                    for (var i = 0; i < 64; i++) {\n                        var t = ffloor((YQT[i]*sf+50)/100);\n                        if (t < 1) {\n                            t = 1;\n                        } else if (t > 255) {\n                            t = 255;\n                        }\n                        YTable[ZigZag[i]] = t;\n                    }\n                    var UVQT = [\n                        17, 18, 24, 47, 99, 99, 99, 99,\n                        18, 21, 26, 66, 99, 99, 99, 99,\n                        24, 26, 56, 99, 99, 99, 99, 99,\n                        47, 66, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99\n                    ];\n                    for (var j = 0; j < 64; j++) {\n                        var u = ffloor((UVQT[j]*sf+50)/100);\n                        if (u < 1) {\n                            u = 1;\n                        } else if (u > 255) {\n                            u = 255;\n                        }\n                        UVTable[ZigZag[j]] = u;\n                    }\n                    var aasf = [\n                        1.0, 1.387039845, 1.306562965, 1.175875602,\n                        1.0, 0.785694958, 0.541196100, 0.275899379\n                    ];\n                    var k = 0;\n                    for (var row = 0; row < 8; row++)\n                    {\n                        for (var col = 0; col < 8; col++)\n                        {\n                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            k++;\n                        }\n                    }\n                }\n\n                function computeHuffmanTbl(nrcodes, std_table){\n                    var codevalue = 0;\n                    var pos_in_table = 0;\n                    var HT = new Array();\n                    for (var k = 1; k <= 16; k++) {\n                        for (var j = 1; j <= nrcodes[k]; j++) {\n                            HT[std_table[pos_in_table]] = [];\n                            HT[std_table[pos_in_table]][0] = codevalue;\n                            HT[std_table[pos_in_table]][1] = k;\n                            pos_in_table++;\n                            codevalue++;\n                        }\n                        codevalue*=2;\n                    }\n                    return HT;\n                }\n\n                function initHuffmanTbl()\n                {\n                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n                }\n\n                function initCategoryNumber()\n                {\n                    var nrlower = 1;\n                    var nrupper = 2;\n                    for (var cat = 1; cat <= 15; cat++) {\n                        //Positive numbers\n                        for (var nr = nrlower; nr<nrupper; nr++) {\n                            category[32767+nr] = cat;\n                            bitcode[32767+nr] = [];\n                            bitcode[32767+nr][1] = cat;\n                            bitcode[32767+nr][0] = nr;\n                        }\n                        //Negative numbers\n                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n                            category[32767+nrneg] = cat;\n                            bitcode[32767+nrneg] = [];\n                            bitcode[32767+nrneg][1] = cat;\n                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n                        }\n                        nrlower <<= 1;\n                        nrupper <<= 1;\n                    }\n                }\n\n                function initRGBYUVTable() {\n                    for(var i = 0; i < 256;i++) {\n                        RGB_YUV_TABLE[i]            =  19595 * i;\n                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n                    }\n                }\n\n                // IO functions\n                function writeBits(bs)\n                {\n                    var value = bs[0];\n                    var posval = bs[1]-1;\n                    while ( posval >= 0 ) {\n                        if (value & (1 << posval) ) {\n                            bytenew |= (1 << bytepos);\n                        }\n                        posval--;\n                        bytepos--;\n                        if (bytepos < 0) {\n                            if (bytenew == 0xFF) {\n                                writeByte(0xFF);\n                                writeByte(0);\n                            }\n                            else {\n                                writeByte(bytenew);\n                            }\n                            bytepos=7;\n                            bytenew=0;\n                        }\n                    }\n                }\n\n                function writeByte(value)\n                {\n                    byteout.push(clt[value]); // write char directly instead of converting later\n                }\n\n                function writeWord(value)\n                {\n                    writeByte((value>>8)&0xFF);\n                    writeByte((value   )&0xFF);\n                }\n\n                // DCT & quantization core\n                function fDCTQuant(data, fdtbl)\n                {\n                    var d0, d1, d2, d3, d4, d5, d6, d7;\n                    /* Pass 1: process rows. */\n                    var dataOff=0;\n                    var i;\n                    var I8 = 8;\n                    var I64 = 64;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff+1];\n                        d2 = data[dataOff+2];\n                        d3 = data[dataOff+3];\n                        d4 = data[dataOff+4];\n                        d5 = data[dataOff+5];\n                        d6 = data[dataOff+6];\n                        d7 = data[dataOff+7];\n\n                        var tmp0 = d0 + d7;\n                        var tmp7 = d0 - d7;\n                        var tmp1 = d1 + d6;\n                        var tmp6 = d1 - d6;\n                        var tmp2 = d2 + d5;\n                        var tmp5 = d2 - d5;\n                        var tmp3 = d3 + d4;\n                        var tmp4 = d3 - d4;\n\n                        /* Even part */\n                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n                        var tmp13 = tmp0 - tmp3;\n                        var tmp11 = tmp1 + tmp2;\n                        var tmp12 = tmp1 - tmp2;\n\n                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n                        data[dataOff+4] = tmp10 - tmp11;\n\n                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n                        data[dataOff+6] = tmp13 - z1;\n\n                        /* Odd part */\n                        tmp10 = tmp4 + tmp5; /* phase 2 */\n                        tmp11 = tmp5 + tmp6;\n                        tmp12 = tmp6 + tmp7;\n\n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n                        var z3 = tmp11 * 0.707106781; /* c4 */\n\n                        var z11 = tmp7 + z3;    /* phase 5 */\n                        var z13 = tmp7 - z3;\n\n                        data[dataOff+5] = z13 + z2; /* phase 6 */\n                        data[dataOff+3] = z13 - z2;\n                        data[dataOff+1] = z11 + z4;\n                        data[dataOff+7] = z11 - z4;\n\n                        dataOff += 8; /* advance pointer to next row */\n                    }\n\n                    /* Pass 2: process columns. */\n                    dataOff = 0;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff + 8];\n                        d2 = data[dataOff + 16];\n                        d3 = data[dataOff + 24];\n                        d4 = data[dataOff + 32];\n                        d5 = data[dataOff + 40];\n                        d6 = data[dataOff + 48];\n                        d7 = data[dataOff + 56];\n\n                        var tmp0p2 = d0 + d7;\n                        var tmp7p2 = d0 - d7;\n                        var tmp1p2 = d1 + d6;\n                        var tmp6p2 = d1 - d6;\n                        var tmp2p2 = d2 + d5;\n                        var tmp5p2 = d2 - d5;\n                        var tmp3p2 = d3 + d4;\n                        var tmp4p2 = d3 - d4;\n\n                        /* Even part */\n                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n                        var tmp13p2 = tmp0p2 - tmp3p2;\n                        var tmp11p2 = tmp1p2 + tmp2p2;\n                        var tmp12p2 = tmp1p2 - tmp2p2;\n\n                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n                        data[dataOff+32] = tmp10p2 - tmp11p2;\n\n                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n                        data[dataOff+48] = tmp13p2 - z1p2;\n\n                        /* Odd part */\n                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n                        tmp11p2 = tmp5p2 + tmp6p2;\n                        tmp12p2 = tmp6p2 + tmp7p2;\n\n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n\n                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n                        var z13p2 = tmp7p2 - z3p2;\n\n                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n                        data[dataOff+24] = z13p2 - z2p2;\n                        data[dataOff+ 8] = z11p2 + z4p2;\n                        data[dataOff+56] = z11p2 - z4p2;\n\n                        dataOff++; /* advance pointer to next column */\n                    }\n\n                    // Quantize/descale the coefficients\n                    var fDCTQuant;\n                    for (i=0; i<I64; ++i)\n                    {\n                        // Apply the quantization and scaling factor & Round to nearest integer\n                        fDCTQuant = data[i]*fdtbl[i];\n                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n                        //outputfDCTQuant[i] = fround(fDCTQuant);\n\n                    }\n                    return outputfDCTQuant;\n                }\n\n                function writeAPP0()\n                {\n                    writeWord(0xFFE0); // marker\n                    writeWord(16); // length\n                    writeByte(0x4A); // J\n                    writeByte(0x46); // F\n                    writeByte(0x49); // I\n                    writeByte(0x46); // F\n                    writeByte(0); // = \"JFIF\",'\\0'\n                    writeByte(1); // versionhi\n                    writeByte(1); // versionlo\n                    writeByte(0); // xyunits\n                    writeWord(1); // xdensity\n                    writeWord(1); // ydensity\n                    writeByte(0); // thumbnwidth\n                    writeByte(0); // thumbnheight\n                }\n\n                function writeSOF0(width, height)\n                {\n                    writeWord(0xFFC0); // marker\n                    writeWord(17);   // length, truecolor YUV JPG\n                    writeByte(8);    // precision\n                    writeWord(height);\n                    writeWord(width);\n                    writeByte(3);    // nrofcomponents\n                    writeByte(1);    // IdY\n                    writeByte(0x11); // HVY\n                    writeByte(0);    // QTY\n                    writeByte(2);    // IdU\n                    writeByte(0x11); // HVU\n                    writeByte(1);    // QTU\n                    writeByte(3);    // IdV\n                    writeByte(0x11); // HVV\n                    writeByte(1);    // QTV\n                }\n\n                function writeDQT()\n                {\n                    writeWord(0xFFDB); // marker\n                    writeWord(132);    // length\n                    writeByte(0);\n                    for (var i=0; i<64; i++) {\n                        writeByte(YTable[i]);\n                    }\n                    writeByte(1);\n                    for (var j=0; j<64; j++) {\n                        writeByte(UVTable[j]);\n                    }\n                }\n\n                function writeDHT()\n                {\n                    writeWord(0xFFC4); // marker\n                    writeWord(0x01A2); // length\n\n                    writeByte(0); // HTYDCinfo\n                    for (var i=0; i<16; i++) {\n                        writeByte(std_dc_luminance_nrcodes[i+1]);\n                    }\n                    for (var j=0; j<=11; j++) {\n                        writeByte(std_dc_luminance_values[j]);\n                    }\n\n                    writeByte(0x10); // HTYACinfo\n                    for (var k=0; k<16; k++) {\n                        writeByte(std_ac_luminance_nrcodes[k+1]);\n                    }\n                    for (var l=0; l<=161; l++) {\n                        writeByte(std_ac_luminance_values[l]);\n                    }\n\n                    writeByte(1); // HTUDCinfo\n                    for (var m=0; m<16; m++) {\n                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n                    }\n                    for (var n=0; n<=11; n++) {\n                        writeByte(std_dc_chrominance_values[n]);\n                    }\n\n                    writeByte(0x11); // HTUACinfo\n                    for (var o=0; o<16; o++) {\n                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n                    }\n                    for (var p=0; p<=161; p++) {\n                        writeByte(std_ac_chrominance_values[p]);\n                    }\n                }\n\n                function writeSOS()\n                {\n                    writeWord(0xFFDA); // marker\n                    writeWord(12); // length\n                    writeByte(3); // nrofcomponents\n                    writeByte(1); // IdY\n                    writeByte(0); // HTY\n                    writeByte(2); // IdU\n                    writeByte(0x11); // HTU\n                    writeByte(3); // IdV\n                    writeByte(0x11); // HTV\n                    writeByte(0); // Ss\n                    writeByte(0x3f); // Se\n                    writeByte(0); // Bf\n                }\n\n                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n                    var EOB = HTAC[0x00];\n                    var M16zeroes = HTAC[0xF0];\n                    var pos;\n                    var I16 = 16;\n                    var I63 = 63;\n                    var I64 = 64;\n                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n                    //ZigZag reorder\n                    for (var j=0;j<I64;++j) {\n                        DU[ZigZag[j]]=DU_DCT[j];\n                    }\n                    var Diff = DU[0] - DC; DC = DU[0];\n                    //Encode DC\n                    if (Diff==0) {\n                        writeBits(HTDC[0]); // Diff might be 0\n                    } else {\n                        pos = 32767+Diff;\n                        writeBits(HTDC[category[pos]]);\n                        writeBits(bitcode[pos]);\n                    }\n                    //Encode ACs\n                    var end0pos = 63; // was const... which is crazy\n                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n                    //end0pos = first element in reverse order !=0\n                    if ( end0pos == 0) {\n                        writeBits(EOB);\n                        return DC;\n                    }\n                    var i = 1;\n                    var lng;\n                    while ( i <= end0pos ) {\n                        var startpos = i;\n                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n                        var nrzeroes = i-startpos;\n                        if ( nrzeroes >= I16 ) {\n                            lng = nrzeroes>>4;\n                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n                                writeBits(M16zeroes);\n                            nrzeroes = nrzeroes&0xF;\n                        }\n                        pos = 32767+DU[i];\n                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n                        writeBits(bitcode[pos]);\n                        i++;\n                    }\n                    if ( end0pos != I63 ) {\n                        writeBits(EOB);\n                    }\n                    return DC;\n                }\n\n                function initCharLookupTable(){\n                    var sfcc = String.fromCharCode;\n                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n                        clt[i] = sfcc(i);\n                    }\n                }\n\n                this.encode = function(image,quality) // image data object\n                {\n                    // var time_start = new Date().getTime();\n\n                    if(quality) setQuality(quality);\n\n                    // Initialize bit writer\n                    byteout = new Array();\n                    bytenew=0;\n                    bytepos=7;\n\n                    // Add JPEG headers\n                    writeWord(0xFFD8); // SOI\n                    writeAPP0();\n                    writeDQT();\n                    writeSOF0(image.width,image.height);\n                    writeDHT();\n                    writeSOS();\n\n\n                    // Encode 8x8 macroblocks\n                    var DCY=0;\n                    var DCU=0;\n                    var DCV=0;\n\n                    bytenew=0;\n                    bytepos=7;\n\n\n                    this.encode.displayName = \"_encode_\";\n\n                    var imageData = image.data;\n                    var width = image.width;\n                    var height = image.height;\n\n                    var quadWidth = width*4;\n                    var tripleWidth = width*3;\n\n                    var x, y = 0;\n                    var r, g, b;\n                    var start,p, col,row,pos;\n                    while(y < height){\n                        x = 0;\n                        while(x < quadWidth){\n                        start = quadWidth * y + x;\n                        p = start;\n                        col = -1;\n                        row = 0;\n\n                        for(pos=0; pos < 64; pos++){\n                            row = pos >> 3;// /8\n                            col = ( pos & 7 ) * 4; // %8\n                            p = start + ( row * quadWidth ) + col;\n\n                            if(y+row >= height){ // padding bottom\n                                p-= (quadWidth*(y+1+row-height));\n                            }\n\n                            if(x+col >= quadWidth){ // padding right\n                                p-= ((x+col) - quadWidth +4)\n                            }\n\n                            r = imageData[ p++ ];\n                            g = imageData[ p++ ];\n                            b = imageData[ p++ ];\n\n\n                            /* // calculate YUV values dynamically\n                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n                            */\n\n                            // use lookup table (slightly faster)\n                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n\n                        }\n\n                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n                        x+=32;\n                        }\n                        y+=8;\n                    }\n\n\n                    ////////////////////////////////////////////////////////////////\n\n                    // Do the bit alignment of the EOI marker\n                    if ( bytepos >= 0 ) {\n                        var fillbits = [];\n                        fillbits[1] = bytepos+1;\n                        fillbits[0] = (1<<(bytepos+1))-1;\n                        writeBits(fillbits);\n                    }\n\n                    writeWord(0xFFD9); //EOI\n\n                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n\n                    byteout = [];\n\n                    // benchmarking\n                    // var duration = new Date().getTime() - time_start;\n                    // console.log('Encoding time: '+ currentQuality + 'ms');\n                    //\n\n                    return jpegDataUri\n            }\n\n            function setQuality(quality){\n                if (quality <= 0) {\n                    quality = 1;\n                }\n                if (quality > 100) {\n                    quality = 100;\n                }\n\n                if(currentQuality == quality) return // don't recalc if unchanged\n\n                var sf = 0;\n                if (quality < 50) {\n                    sf = Math.floor(5000 / quality);\n                } else {\n                    sf = Math.floor(200 - quality*2);\n                }\n\n                initQuantTables(sf);\n                currentQuality = quality;\n                // console.log('Quality set to: '+quality +'%');\n            }\n\n            function init(){\n                // var time_start = new Date().getTime();\n                if(!quality) quality = 50;\n                // Create tables\n                initCharLookupTable()\n                initHuffmanTbl();\n                initCategoryNumber();\n                initRGBYUVTable();\n\n                setQuality(quality);\n                // var duration = new Date().getTime() - time_start;\n                // console.log('Initialization '+ duration + 'ms');\n            }\n\n            init();\n\n        }\n\n        JPEGEncoder.encode = function( data, quality ) {\n            var encoder = new JPEGEncoder( quality );\n\n            return encoder.encode( data );\n        }\n\n        return JPEGEncoder;\n    });\n    /**\n     * @fileOverview Fix android canvas.toDataUrl bug.\n     */\n    define('runtime/html5/androidpatch',[\n        'runtime/html5/util',\n        'runtime/html5/jpegencoder',\n        'base'\n    ], function( Util, encoder, Base ) {\n        var origin = Util.canvasToDataUrl,\n            supportJpeg;\n\n        Util.canvasToDataUrl = function( canvas, type, quality ) {\n            var ctx, w, h, fragement, parts;\n\n            // 非android手机直接跳过。\n            if ( !Base.os.android ) {\n                return origin.apply( null, arguments );\n            }\n\n            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n            // JPEG 前两位分别是：255, 216\n            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n                fragement = origin.apply( null, arguments );\n\n                parts = fragement.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    fragement = atob( parts[ 1 ] );\n                } else {\n                    fragement = decodeURIComponent( parts[ 1 ] );\n                }\n\n                fragement = fragement.substring( 0, 2 );\n\n                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n                        fragement.charCodeAt( 1 ) === 216;\n            }\n\n            // 只有在android环境下才修复\n            if ( type === 'image/jpeg' && !supportJpeg ) {\n                w = canvas.width;\n                h = canvas.height;\n                ctx = canvas.getContext('2d');\n\n                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n            }\n\n            return origin.apply( null, arguments );\n        };\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('runtime/html5/image',[\n        'base',\n        'runtime/html5/runtime',\n        'runtime/html5/util'\n    ], function( Base, Html5Runtime, Util ) {\n\n        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n\n        return Html5Runtime.register( 'Image', {\n\n            // flag: 标记是否被修改过。\n            modified: false,\n\n            init: function() {\n                var me = this,\n                    img = new Image();\n\n                img.onload = function() {\n\n                    me._info = {\n                        type: me.type,\n                        width: this.width,\n                        height: this.height\n                    };\n\n                    // 读取meta信息。\n                    if ( !me._metas && 'image/jpeg' === me.type ) {\n                        Util.parseMeta( me._blob, function( error, ret ) {\n                            me._metas = ret;\n                            me.owner.trigger('load');\n                        });\n                    } else {\n                        me.owner.trigger('load');\n                    }\n                };\n\n                img.onerror = function() {\n                    me.owner.trigger('error');\n                };\n\n                me._img = img;\n            },\n\n            loadFromBlob: function( blob ) {\n                var me = this,\n                    img = me._img;\n\n                me._blob = blob;\n                me.type = blob.type;\n                img.src = Util.createObjectURL( blob.getSource() );\n                me.owner.once( 'load', function() {\n                    Util.revokeObjectURL( img.src );\n                });\n            },\n\n            resize: function( width, height ) {\n                var canvas = this._canvas ||\n                        (this._canvas = document.createElement('canvas'));\n\n                this._resize( this._img, canvas, width, height );\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'resize' );\n            },\n\n            crop: function( x, y, w, h, s ) {\n                var cvs = this._canvas ||\n                        (this._canvas = document.createElement('canvas')),\n                    opts = this.options,\n                    img = this._img,\n                    iw = img.naturalWidth,\n                    ih = img.naturalHeight,\n                    orientation = this.getOrientation();\n\n                s = s || 1;\n\n                // todo 解决 orientation 的问题。\n                // values that require 90 degree rotation\n                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\n                //     switch ( orientation ) {\n                //         case 6:\n                //             tmp = x;\n                //             x = y;\n                //             y = iw * s - tmp - w;\n                //             console.log(ih * s, tmp, w)\n                //             break;\n                //     }\n\n                //     (w ^= h, h ^= w, w ^= h);\n                // }\n\n                cvs.width = w;\n                cvs.height = h;\n\n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'crop' );\n            },\n\n            getAsBlob: function( type ) {\n                var blob = this._blob,\n                    opts = this.options,\n                    canvas;\n\n                type = type || this.type;\n\n                // blob需要重新生成。\n                if ( this.modified || this.type !== type ) {\n                    canvas = this._canvas;\n\n                    if ( type === 'image/jpeg' ) {\n\n                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n\n                        if ( opts.preserveHeaders && this._metas &&\n                                this._metas.imageHead ) {\n\n                            blob = Util.dataURL2ArrayBuffer( blob );\n                            blob = Util.updateImageHead( blob,\n                                    this._metas.imageHead );\n                            blob = Util.arrayBufferToBlob( blob, type );\n                            return blob;\n                        }\n                    } else {\n                        blob = Util.canvasToDataUrl( canvas, type );\n                    }\n\n                    blob = Util.dataURL2Blob( blob );\n                }\n\n                return blob;\n            },\n\n            getAsDataUrl: function( type ) {\n                var opts = this.options;\n\n                type = type || this.type;\n\n                if ( type === 'image/jpeg' ) {\n                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n                } else {\n                    return this._canvas.toDataURL( type );\n                }\n            },\n\n            getOrientation: function() {\n                return this._metas && this._metas.exif &&\n                        this._metas.exif.get('Orientation') || 1;\n            },\n\n            info: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n\n                // getter\n                return this._info;\n            },\n\n            meta: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n\n                // getter\n                return this._meta;\n            },\n\n            destroy: function() {\n                var canvas = this._canvas;\n                this._img.onload = null;\n\n                if ( canvas ) {\n                    canvas.getContext('2d')\n                            .clearRect( 0, 0, canvas.width, canvas.height );\n                    canvas.width = canvas.height = 0;\n                    this._canvas = null;\n                }\n\n                // 释放内存。非常重要，否则释放不了image的内存。\n                this._img.src = BLANK;\n                this._img = this._blob = null;\n            },\n\n            _resize: function( img, cvs, width, height ) {\n                var opts = this.options,\n                    naturalWidth = img.width,\n                    naturalHeight = img.height,\n                    orientation = this.getOrientation(),\n                    scale, w, h, x, y;\n\n                // values that require 90 degree rotation\n                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\n                    // 交换width, height的值。\n                    width ^= height;\n                    height ^= width;\n                    width ^= height;\n                }\n\n                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n                        height / naturalHeight );\n\n                // 不允许放大。\n                opts.allowMagnify || (scale = Math.min( 1, scale ));\n\n                w = naturalWidth * scale;\n                h = naturalHeight * scale;\n\n                if ( opts.crop ) {\n                    cvs.width = width;\n                    cvs.height = height;\n                } else {\n                    cvs.width = w;\n                    cvs.height = h;\n                }\n\n                x = (cvs.width - w) / 2;\n                y = (cvs.height - h) / 2;\n\n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\n                this._renderImageToCanvas( cvs, img, x, y, w, h );\n            },\n\n            _rotate2Orientaion: function( canvas, orientation ) {\n                var width = canvas.width,\n                    height = canvas.height,\n                    ctx = canvas.getContext('2d');\n\n                switch ( orientation ) {\n                    case 5:\n                    case 6:\n                    case 7:\n                    case 8:\n                        canvas.width = height;\n                        canvas.height = width;\n                        break;\n                }\n\n                switch ( orientation ) {\n                    case 2:    // horizontal flip\n                        ctx.translate( width, 0 );\n                        ctx.scale( -1, 1 );\n                        break;\n\n                    case 3:    // 180 rotate left\n                        ctx.translate( width, height );\n                        ctx.rotate( Math.PI );\n                        break;\n\n                    case 4:    // vertical flip\n                        ctx.translate( 0, height );\n                        ctx.scale( 1, -1 );\n                        break;\n\n                    case 5:    // vertical flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.scale( 1, -1 );\n                        break;\n\n                    case 6:    // 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( 0, -height );\n                        break;\n\n                    case 7:    // horizontal flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( width, -height );\n                        ctx.scale( -1, 1 );\n                        break;\n\n                    case 8:    // 90 rotate left\n                        ctx.rotate( -0.5 * Math.PI );\n                        ctx.translate( -width, 0 );\n                        break;\n                }\n            },\n\n            // https://github.com/stomita/ios-imagefile-megapixel/\n            // blob/master/src/megapix-image.js\n            _renderImageToCanvas: (function() {\n\n                // 如果不是ios, 不需要这么复杂！\n                if ( !Base.os.ios ) {\n                    return function( canvas ) {\n                        var args = Base.slice( arguments, 1 ),\n                            ctx = canvas.getContext('2d');\n\n                        ctx.drawImage.apply( ctx, args );\n                    };\n                }\n\n                /**\n                 * Detecting vertical squash in loaded image.\n                 * Fixes a bug which squash image vertically while drawing into\n                 * canvas for some images.\n                 */\n                function detectVerticalSquash( img, iw, ih ) {\n                    var canvas = document.createElement('canvas'),\n                        ctx = canvas.getContext('2d'),\n                        sy = 0,\n                        ey = ih,\n                        py = ih,\n                        data, alpha, ratio;\n\n\n                    canvas.width = 1;\n                    canvas.height = ih;\n                    ctx.drawImage( img, 0, 0 );\n                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n\n                    // search image edge pixel position in case\n                    // it is squashed vertically.\n                    while ( py > sy ) {\n                        alpha = data[ (py - 1) * 4 + 3 ];\n\n                        if ( alpha === 0 ) {\n                            ey = py;\n                        } else {\n                            sy = py;\n                        }\n\n                        py = (ey + sy) >> 1;\n                    }\n\n                    ratio = (py / ih);\n                    return (ratio === 0) ? 1 : ratio;\n                }\n\n                // fix ie7 bug\n                // http://stackoverflow.com/questions/11929099/\n                // html5-canvas-drawimage-ratio-bug-ios\n                if ( Base.os.ios >= 7 ) {\n                    return function( canvas, img, x, y, w, h ) {\n                        var iw = img.naturalWidth,\n                            ih = img.naturalHeight,\n                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n\n                        return canvas.getContext('2d').drawImage( img, 0, 0,\n                                iw * vertSquashRatio, ih * vertSquashRatio,\n                                x, y, w, h );\n                    };\n                }\n\n                /**\n                 * Detect subsampling in loaded image.\n                 * In iOS, larger images than 2M pixels may be\n                 * subsampled in rendering.\n                 */\n                function detectSubsampling( img ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        canvas, ctx;\n\n                    // subsampling may happen overmegapixel image\n                    if ( iw * ih > 1024 * 1024 ) {\n                        canvas = document.createElement('canvas');\n                        canvas.width = canvas.height = 1;\n                        ctx = canvas.getContext('2d');\n                        ctx.drawImage( img, -iw + 1, 0 );\n\n                        // subsampled image becomes half smaller in rendering size.\n                        // check alpha channel value to confirm image is covering\n                        // edge pixel or not. if alpha value is 0\n                        // image is not covering, hence subsampled.\n                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n                    } else {\n                        return false;\n                    }\n                }\n\n\n                return function( canvas, img, x, y, width, height ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        ctx = canvas.getContext('2d'),\n                        subsampled = detectSubsampling( img ),\n                        doSquash = this.type === 'image/jpeg',\n                        d = 1024,\n                        sy = 0,\n                        dy = 0,\n                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n\n                    if ( subsampled ) {\n                        iw /= 2;\n                        ih /= 2;\n                    }\n\n                    ctx.save();\n                    tmpCanvas = document.createElement('canvas');\n                    tmpCanvas.width = tmpCanvas.height = d;\n\n                    tmpCtx = tmpCanvas.getContext('2d');\n                    vertSquashRatio = doSquash ?\n                            detectVerticalSquash( img, iw, ih ) : 1;\n\n                    dw = Math.ceil( d * width / iw );\n                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n\n                    while ( sy < ih ) {\n                        sx = 0;\n                        dx = 0;\n                        while ( sx < iw ) {\n                            tmpCtx.clearRect( 0, 0, d, d );\n                            tmpCtx.drawImage( img, -sx, -sy );\n                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n                                    x + dx, y + dy, dw, dh );\n                            sx += d;\n                            dx += dw;\n                        }\n                        sy += d;\n                        dy += dh;\n                    }\n                    ctx.restore();\n                    tmpCanvas = tmpCtx = null;\n                };\n            })()\n        });\n    });\n    /**\n     * @fileOverview Transport\n     * @todo 支持chunked传输，优势：\n     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n     */\n    define('runtime/html5/transport',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n\n        var noop = Base.noop,\n            $ = Base.$;\n\n        return Html5Runtime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n            },\n\n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    formData, binary, fr;\n\n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n\n                    binary = blob.getSource();\n                } else {\n                    formData = new FormData();\n                    $.each( owner._formData, function( k, v ) {\n                        formData.append( k, v );\n                    });\n\n                    formData.append( opts.fileVal, blob.getSource(),\n                            opts.filename || owner._formData.name || '' );\n                }\n\n                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n                    xhr.open( opts.method, server, true );\n                    xhr.withCredentials = true;\n                } else {\n                    xhr.open( opts.method, server );\n                }\n\n                this._setRequestHeader( xhr, opts.headers );\n\n                if ( binary ) {\n                    // 强制设置成 content-type 为文件流。\n                    xhr.overrideMimeType &&\n                            xhr.overrideMimeType('application/octet-stream');\n\n                    // android直接发送blob会导致服务端接收到的是空文件。\n                    // bug详情。\n                    // https://code.google.com/p/android/issues/detail?id=39882\n                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n                    if ( Base.os.android ) {\n                        fr = new FileReader();\n\n                        fr.onload = function() {\n                            xhr.send( this.result );\n                            fr = fr.onload = null;\n                        };\n\n                        fr.readAsArrayBuffer( binary );\n                    } else {\n                        xhr.send( binary );\n                    }\n                } else {\n                    xhr.send( formData );\n                }\n            },\n\n            getResponse: function() {\n                return this._response;\n            },\n\n            getResponseAsJson: function() {\n                return this._parseJson( this._response );\n            },\n\n            getStatus: function() {\n                return this._status;\n            },\n\n            abort: function() {\n                var xhr = this._xhr;\n\n                if ( xhr ) {\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    xhr.abort();\n\n                    this._xhr = xhr = null;\n                }\n            },\n\n            destroy: function() {\n                this.abort();\n            },\n\n            _initAjax: function() {\n                var me = this,\n                    xhr = new XMLHttpRequest(),\n                    opts = this.options;\n\n                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n                        typeof XDomainRequest !== 'undefined' ) {\n                    xhr = new XDomainRequest();\n                }\n\n                xhr.upload.onprogress = function( e ) {\n                    var percentage = 0;\n\n                    if ( e.lengthComputable ) {\n                        percentage = e.loaded / e.total;\n                    }\n\n                    return me.trigger( 'progress', percentage );\n                };\n\n                xhr.onreadystatechange = function() {\n\n                    if ( xhr.readyState !== 4 ) {\n                        return;\n                    }\n\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    me._xhr = null;\n                    me._status = xhr.status;\n\n                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger('load');\n                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger( 'error', 'server' );\n                    }\n\n\n                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n                };\n\n                me._xhr = xhr;\n                return xhr;\n            },\n\n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.setRequestHeader( key, val );\n                });\n            },\n\n            _parseJson: function( str ) {\n                var json;\n\n                try {\n                    json = JSON.parse( str );\n                } catch ( ex ) {\n                    json = {};\n                }\n\n                return json;\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/html5/md5',[\n        'runtime/html5/runtime'\n    ], function( FlashRuntime ) {\n\n        /*\n         * Fastest md5 implementation around (JKM md5)\n         * Credits: Joseph Myers\n         *\n         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n         * @see http://jsperf.com/md5-shootout/7\n         */\n\n        /* this function is much faster,\n          so if possible we use it. Some IEs\n          are the only ones I know of that\n          need the idiotic second function,\n          generated by an if clause.  */\n        var add32 = function (a, b) {\n            return (a + b) & 0xFFFFFFFF;\n        },\n\n        cmn = function (q, a, b, x, s, t) {\n            a = add32(add32(a, q), add32(x, t));\n            return add32((a << s) | (a >>> (32 - s)), b);\n        },\n\n        ff = function (a, b, c, d, x, s, t) {\n            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n        },\n\n        gg = function (a, b, c, d, x, s, t) {\n            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n        },\n\n        hh = function (a, b, c, d, x, s, t) {\n            return cmn(b ^ c ^ d, a, b, x, s, t);\n        },\n\n        ii = function (a, b, c, d, x, s, t) {\n            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n        },\n\n        md5cycle = function (x, k) {\n            var a = x[0],\n                b = x[1],\n                c = x[2],\n                d = x[3];\n\n            a = ff(a, b, c, d, k[0], 7, -680876936);\n            d = ff(d, a, b, c, k[1], 12, -389564586);\n            c = ff(c, d, a, b, k[2], 17, 606105819);\n            b = ff(b, c, d, a, k[3], 22, -1044525330);\n            a = ff(a, b, c, d, k[4], 7, -176418897);\n            d = ff(d, a, b, c, k[5], 12, 1200080426);\n            c = ff(c, d, a, b, k[6], 17, -1473231341);\n            b = ff(b, c, d, a, k[7], 22, -45705983);\n            a = ff(a, b, c, d, k[8], 7, 1770035416);\n            d = ff(d, a, b, c, k[9], 12, -1958414417);\n            c = ff(c, d, a, b, k[10], 17, -42063);\n            b = ff(b, c, d, a, k[11], 22, -1990404162);\n            a = ff(a, b, c, d, k[12], 7, 1804603682);\n            d = ff(d, a, b, c, k[13], 12, -40341101);\n            c = ff(c, d, a, b, k[14], 17, -1502002290);\n            b = ff(b, c, d, a, k[15], 22, 1236535329);\n\n            a = gg(a, b, c, d, k[1], 5, -165796510);\n            d = gg(d, a, b, c, k[6], 9, -1069501632);\n            c = gg(c, d, a, b, k[11], 14, 643717713);\n            b = gg(b, c, d, a, k[0], 20, -373897302);\n            a = gg(a, b, c, d, k[5], 5, -701558691);\n            d = gg(d, a, b, c, k[10], 9, 38016083);\n            c = gg(c, d, a, b, k[15], 14, -660478335);\n            b = gg(b, c, d, a, k[4], 20, -405537848);\n            a = gg(a, b, c, d, k[9], 5, 568446438);\n            d = gg(d, a, b, c, k[14], 9, -1019803690);\n            c = gg(c, d, a, b, k[3], 14, -187363961);\n            b = gg(b, c, d, a, k[8], 20, 1163531501);\n            a = gg(a, b, c, d, k[13], 5, -1444681467);\n            d = gg(d, a, b, c, k[2], 9, -51403784);\n            c = gg(c, d, a, b, k[7], 14, 1735328473);\n            b = gg(b, c, d, a, k[12], 20, -1926607734);\n\n            a = hh(a, b, c, d, k[5], 4, -378558);\n            d = hh(d, a, b, c, k[8], 11, -2022574463);\n            c = hh(c, d, a, b, k[11], 16, 1839030562);\n            b = hh(b, c, d, a, k[14], 23, -35309556);\n            a = hh(a, b, c, d, k[1], 4, -1530992060);\n            d = hh(d, a, b, c, k[4], 11, 1272893353);\n            c = hh(c, d, a, b, k[7], 16, -155497632);\n            b = hh(b, c, d, a, k[10], 23, -1094730640);\n            a = hh(a, b, c, d, k[13], 4, 681279174);\n            d = hh(d, a, b, c, k[0], 11, -358537222);\n            c = hh(c, d, a, b, k[3], 16, -722521979);\n            b = hh(b, c, d, a, k[6], 23, 76029189);\n            a = hh(a, b, c, d, k[9], 4, -640364487);\n            d = hh(d, a, b, c, k[12], 11, -421815835);\n            c = hh(c, d, a, b, k[15], 16, 530742520);\n            b = hh(b, c, d, a, k[2], 23, -995338651);\n\n            a = ii(a, b, c, d, k[0], 6, -198630844);\n            d = ii(d, a, b, c, k[7], 10, 1126891415);\n            c = ii(c, d, a, b, k[14], 15, -1416354905);\n            b = ii(b, c, d, a, k[5], 21, -57434055);\n            a = ii(a, b, c, d, k[12], 6, 1700485571);\n            d = ii(d, a, b, c, k[3], 10, -1894986606);\n            c = ii(c, d, a, b, k[10], 15, -1051523);\n            b = ii(b, c, d, a, k[1], 21, -2054922799);\n            a = ii(a, b, c, d, k[8], 6, 1873313359);\n            d = ii(d, a, b, c, k[15], 10, -30611744);\n            c = ii(c, d, a, b, k[6], 15, -1560198380);\n            b = ii(b, c, d, a, k[13], 21, 1309151649);\n            a = ii(a, b, c, d, k[4], 6, -145523070);\n            d = ii(d, a, b, c, k[11], 10, -1120210379);\n            c = ii(c, d, a, b, k[2], 15, 718787259);\n            b = ii(b, c, d, a, k[9], 21, -343485551);\n\n            x[0] = add32(a, x[0]);\n            x[1] = add32(b, x[1]);\n            x[2] = add32(c, x[2]);\n            x[3] = add32(d, x[3]);\n        },\n\n        /* there needs to be support for Unicode here,\n           * unless we pretend that we can redefine the MD-5\n           * algorithm for multi-byte characters (perhaps\n           * by adding every four 16-bit characters and\n           * shortening the sum to 32 bits). Otherwise\n           * I suggest performing MD-5 as if every character\n           * was two bytes--e.g., 0040 0025 = @%--but then\n           * how will an ordinary MD-5 sum be matched?\n           * There is no way to standardize text to something\n           * like UTF-8 before transformation; speed cost is\n           * utterly prohibitive. The JavaScript standard\n           * itself needs to look at this: it should start\n           * providing access to strings as preformed UTF-8\n           * 8-bit unsigned value arrays.\n           */\n        md5blk = function (s) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n\n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n            }\n            return md5blks;\n        },\n\n        md5blk_array = function (a) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n\n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n            }\n            return md5blks;\n        },\n\n        md51 = function (s) {\n            var n = s.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n\n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk(s.substring(i - 64, i)));\n            }\n            s = s.substring(i - 64);\n            length = s.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n            }\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n\n            md5cycle(state, tail);\n            return state;\n        },\n\n        md51_array = function (a) {\n            var n = a.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n\n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n            }\n\n            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n            // containing the last element of the parent array if the sub array specified starts\n            // beyond the length of the parent array - weird.\n            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\n            length = a.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n            }\n\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n\n            md5cycle(state, tail);\n\n            return state;\n        },\n\n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n\n        rhex = function (n) {\n            var s = '',\n                j;\n            for (j = 0; j < 4; j += 1) {\n                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n            }\n            return s;\n        },\n\n        hex = function (x) {\n            var i;\n            for (i = 0; i < x.length; i += 1) {\n                x[i] = rhex(x[i]);\n            }\n            return x.join('');\n        },\n\n        md5 = function (s) {\n            return hex(md51(s));\n        },\n\n\n\n        ////////////////////////////////////////////////////////////////////////////\n\n        /**\n         * SparkMD5 OOP implementation.\n         *\n         * Use this class to perform an incremental md5, otherwise use the\n         * static methods instead.\n         */\n        SparkMD5 = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n\n\n        // In some cases the fast add32 function cannot be used..\n        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n            add32 = function (x, y) {\n                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n                return (msw << 16) | (lsw & 0xFFFF);\n            };\n        }\n\n\n        /**\n         * Appends a string.\n         * A conversion will be applied if an utf8 string is detected.\n         *\n         * @param {String} str The string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.append = function (str) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n\n            // then append as binary\n            this.appendBinary(str);\n\n            return this;\n        };\n\n        /**\n         * Appends a binary string.\n         *\n         * @param {String} contents The binary string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.appendBinary = function (contents) {\n            this._buff += contents;\n            this._length += contents.length;\n\n            var length = this._buff.length,\n                i;\n\n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n            }\n\n            this._buff = this._buff.substr(i - 64);\n\n            return this;\n        };\n\n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                i,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                ret;\n\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n            }\n\n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n\n            this.reset();\n\n            return ret;\n        };\n\n        /**\n         * Finish the final calculation based on the tail.\n         *\n         * @param {Array}  tail   The tail (will be modified)\n         * @param {Number} length The length of the remaining buffer\n         */\n        SparkMD5.prototype._finish = function (tail, length) {\n            var i = length,\n                tmp,\n                lo,\n                hi;\n\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(this._state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Do the final computation based on the tail and length\n            // Beware that the final length may not fit in 32 bits so we take care of that\n            tmp = this._length * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n            md5cycle(this._state, tail);\n        };\n\n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.reset = function () {\n            this._buff = \"\";\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\n            return this;\n        };\n\n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.prototype.destroy = function () {\n            delete this._state;\n            delete this._buff;\n            delete this._length;\n        };\n\n\n        /**\n         * Performs the md5 hash on a string.\n         * A conversion will be applied if utf8 string is detected.\n         *\n         * @param {String}  str The string\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hash = function (str, raw) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n\n            var hash = md51(str);\n\n            return raw ? hash : hex(hash);\n        };\n\n        /**\n         * Performs the md5 hash on a binary string.\n         *\n         * @param {String}  content The binary string\n         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hashBinary = function (content, raw) {\n            var hash = md51(content);\n\n            return raw ? hash : hex(hash);\n        };\n\n        /**\n         * SparkMD5 OOP implementation for array buffers.\n         *\n         * Use this class to perform an incremental md5 ONLY for array buffers.\n         */\n        SparkMD5.ArrayBuffer = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n\n        ////////////////////////////////////////////////////////////////////////////\n\n        /**\n         * Appends an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array to be appended\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n            //       if you find yourself needing extra performance, please make a PR.\n            var buff = this._concatArrayBuffer(this._buff, arr),\n                length = buff.length,\n                i;\n\n            this._length += arr.byteLength;\n\n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n            }\n\n            // Avoids IE10 weirdness (documented above)\n            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n\n            return this;\n        };\n\n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                i,\n                ret;\n\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n            }\n\n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n\n            this.reset();\n\n            return ret;\n        };\n\n        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.reset = function () {\n            this._buff = new Uint8Array(0);\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\n            return this;\n        };\n\n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\n        /**\n         * Concats two array buffers, returning a new one.\n         *\n         * @param  {ArrayBuffer} first  The first array buffer\n         * @param  {ArrayBuffer} second The second array buffer\n         *\n         * @return {ArrayBuffer} The new array buffer\n         */\n        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n            var firstLength = first.length,\n                result = new Uint8Array(firstLength + second.byteLength);\n\n            result.set(first);\n            result.set(new Uint8Array(second), firstLength);\n\n            return result;\n        };\n\n        /**\n         * Performs the md5 hash on an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array buffer\n         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n            var hash = md51_array(new Uint8Array(arr));\n\n            return raw ? hash : hex(hash);\n        };\n\n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n\n            loadFromBlob: function( file ) {\n                var blob = file.getSource(),\n                    chunkSize = 2 * 1024 * 1024,\n                    chunks = Math.ceil( blob.size / chunkSize ),\n                    chunk = 0,\n                    owner = this.owner,\n                    spark = new SparkMD5.ArrayBuffer(),\n                    me = this,\n                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n                    loadNext, fr;\n\n                fr = new FileReader();\n\n                loadNext = function() {\n                    var start, end;\n\n                    start = chunk * chunkSize;\n                    end = Math.min( start + chunkSize, blob.size );\n\n                    fr.onload = function( e ) {\n                        spark.append( e.target.result );\n                        owner.trigger( 'progress', {\n                            total: file.size,\n                            loaded: end\n                        });\n                    };\n\n                    fr.onloadend = function() {\n                        fr.onloadend = fr.onload = null;\n\n                        if ( ++chunk < chunks ) {\n                            setTimeout( loadNext, 1 );\n                        } else {\n                            setTimeout(function(){\n                                owner.trigger('load');\n                                me.result = spark.end();\n                                loadNext = file = blob = spark = null;\n                                owner.trigger('complete');\n                            }, 50 );\n                        }\n                    };\n\n                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n                };\n\n                loadNext();\n            },\n\n            getResult: function() {\n                return this.result;\n            }\n        });\n    });\n    /**\n     * @fileOverview FlashRuntime\n     */\n    define('runtime/flash/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n\n        var $ = Base.$,\n            type = 'flash',\n            components = {};\n\n\n        function getFlashVersion() {\n            var version;\n\n            try {\n                version = navigator.plugins[ 'Shockwave Flash' ];\n                version = version.description;\n            } catch ( ex ) {\n                try {\n                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n                            .GetVariable('$version');\n                } catch ( ex2 ) {\n                    version = '0.0';\n                }\n            }\n            version = version.match( /\\d+/g );\n            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n        }\n\n        function FlashRuntime() {\n            var pool = {},\n                clients = {},\n                destroy = this.destroy,\n                me = this,\n                jsreciver = Base.guid('webuploader_');\n\n            Runtime.apply( me, arguments );\n            me.type = type;\n\n\n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/ ) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n\n                clients[ uid ] = client;\n\n                if ( components[ comp ] ) {\n                    if ( !pool[ uid ] ) {\n                        pool[ uid ] = new components[ comp ]( client, me );\n                    }\n\n                    instance = pool[ uid ];\n\n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n\n                return me.flashExec.apply( client, arguments );\n            };\n\n            function handler( evt, obj ) {\n                var type = evt.type || evt,\n                    parts, uid;\n\n                parts = type.split('::');\n                uid = parts[ 0 ];\n                type = parts[ 1 ];\n\n                // console.log.apply( console, arguments );\n\n                if ( type === 'Ready' && uid === me.uid ) {\n                    me.trigger('ready');\n                } else if ( clients[ uid ] ) {\n                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n                }\n\n                // Base.log( evt, obj );\n            }\n\n            // flash的接受器。\n            window[ jsreciver ] = function() {\n                var args = arguments;\n\n                // 为了能捕获得到。\n                setTimeout(function() {\n                    handler.apply( null, args );\n                }, 1 );\n            };\n\n            this.jsreciver = jsreciver;\n\n            this.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n\n            this.flashExec = function( comp, fn ) {\n                var flash = me.getFlash(),\n                    args = Base.slice( arguments, 2 );\n\n                return flash.exec( this.uid, comp, fn, args );\n            };\n\n            // @todo\n        }\n\n        Base.inherits( Runtime, {\n            constructor: FlashRuntime,\n\n            init: function() {\n                var container = this.getContainer(),\n                    opts = this.options,\n                    html;\n\n                // if not the minimal height, shims are not initialized\n                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n                container.css({\n                    position: 'absolute',\n                    top: '-8px',\n                    left: '-8px',\n                    width: '9px',\n                    height: '9px',\n                    overflow: 'hidden'\n                });\n\n                // insert flash object\n                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n\n                if ( Base.browser.ie ) {\n                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n                }\n\n                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n                    '&jsreciver=' + this.jsreciver + '\" />' +\n                    '<param name=\"wmode\" value=\"transparent\" />' +\n                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n                '</object>';\n\n                container.html( html );\n            },\n\n            getFlash: function() {\n                if ( this._flash ) {\n                    return this._flash;\n                }\n\n                this._flash = $( '#' + this.uid ).get( 0 );\n                return this._flash;\n            }\n\n        });\n\n        FlashRuntime.register = function( name, component ) {\n            component = components[ name ] = Base.inherits( CompBase, $.extend({\n\n                // @todo fix this later\n                flashExec: function() {\n                    var owner = this.owner,\n                        runtime = this.getRuntime();\n\n                    return runtime.flashExec.apply( owner, arguments );\n                }\n            }, component ) );\n\n            return component;\n        };\n\n        if ( getFlashVersion() >= 11.4 ) {\n            Runtime.addRuntime( type, FlashRuntime );\n        }\n\n        return FlashRuntime;\n    });\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/flash/filepicker',[\n        'base',\n        'runtime/flash/runtime'\n    ], function( Base, FlashRuntime ) {\n        var $ = Base.$;\n\n        return FlashRuntime.register( 'FilePicker', {\n            init: function( opts ) {\n                var copy = $.extend({}, opts ),\n                    len, i;\n\n                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n                len = copy.accept && copy.accept.length;\n                for (  i = 0; i < len; i++ ) {\n                    if ( !copy.accept[ i ].title ) {\n                        copy.accept[ i ].title = 'Files';\n                    }\n                }\n\n                delete copy.button;\n                delete copy.id;\n                delete copy.container;\n\n                this.flashExec( 'FilePicker', 'init', copy );\n            },\n\n            destroy: function() {\n                this.flashExec( 'FilePicker', 'destroy' );\n            }\n        });\n    });\n    /**\n     * @fileOverview 图片压缩\n     */\n    define('runtime/flash/image',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n\n        return FlashRuntime.register( 'Image', {\n            // init: function( options ) {\n            //     var owner = this.owner;\n\n            //     this.flashExec( 'Image', 'init', options );\n            //     owner.on( 'load', function() {\n            //         debugger;\n            //     });\n            // },\n\n            loadFromBlob: function( blob ) {\n                var owner = this.owner;\n\n                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n\n                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/flash/transport',[\n        'base',\n        'runtime/flash/runtime',\n        'runtime/client'\n    ], function( Base, FlashRuntime, RuntimeClient ) {\n        var $ = Base.$;\n\n        return FlashRuntime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n                this._responseJson = null;\n            },\n\n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    binary;\n\n                xhr.connectRuntime( blob.ruid );\n\n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n\n                    binary = blob.uid;\n                } else {\n                    $.each( owner._formData, function( k, v ) {\n                        xhr.exec( 'append', k, v );\n                    });\n\n                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n                            opts.filename || owner._formData.name || '' );\n                }\n\n                this._setRequestHeader( xhr, opts.headers );\n                xhr.exec( 'send', {\n                    method: opts.method,\n                    url: server,\n                    forceURLStream: opts.forceURLStream,\n                    mimeType: 'application/octet-stream',\n                }, binary );\n            },\n\n            getStatus: function() {\n                return this._status;\n            },\n\n            getResponse: function() {\n                return this._response || '';\n            },\n\n            getResponseAsJson: function() {\n                return this._responseJson;\n            },\n\n            abort: function() {\n                var xhr = this._xhr;\n\n                if ( xhr ) {\n                    xhr.exec('abort');\n                    xhr.destroy();\n                    this._xhr = xhr = null;\n                }\n            },\n\n            destroy: function() {\n                this.abort();\n            },\n\n            _initAjax: function() {\n                var me = this,\n                    xhr = new RuntimeClient('XMLHttpRequest');\n\n                xhr.on( 'uploadprogress progress', function( e ) {\n                    var percent = e.loaded / e.total;\n                    percent = Math.min( 1, Math.max( 0, percent ) );\n                    return me.trigger( 'progress', percent );\n                });\n\n                xhr.on( 'load', function() {\n                    var status = xhr.exec('getStatus'),\n                        readBody = false,\n                        err = '',\n                        p;\n\n                    xhr.off();\n                    me._xhr = null;\n\n                    if ( status >= 200 && status < 300 ) {\n                        readBody = true;\n                    } else if ( status >= 500 && status < 600 ) {\n                        readBody = true;\n                        err = 'server';\n                    } else {\n                        err = 'http';\n                    }\n\n                    if ( readBody ) {\n                        me._response = xhr.exec('getResponse');\n                        me._response = decodeURIComponent( me._response );\n\n                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n                        // try {\n                        //     me._responseJson = xhr.exec('getResponseAsJson');\n                        // } catch ( error ) {\n\n                        p = window.JSON && window.JSON.parse || function( s ) {\n                            try {\n                                return new Function('return ' + s).call();\n                            } catch ( err ) {\n                                return {};\n                            }\n                        };\n                        me._responseJson  = me._response ? p(me._response) : {};\n\n                        // }\n                    }\n\n                    xhr.destroy();\n                    xhr = null;\n\n                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n                });\n\n                xhr.on( 'error', function() {\n                    xhr.off();\n                    me._xhr = null;\n                    me.trigger( 'error', 'http' );\n                });\n\n                me._xhr = xhr;\n                return xhr;\n            },\n\n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.exec( 'setRequestHeader', key, val );\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/flash/blob',[\n        'runtime/flash/runtime',\n        'lib/blob'\n    ], function( FlashRuntime, Blob ) {\n\n        return FlashRuntime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.flashExec( 'Blob', 'slice', start, end );\n\n                return new Blob( blob.uid, blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Md5 flash实现\n     */\n    define('runtime/flash/md5',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n\n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n\n            loadFromBlob: function( blob ) {\n                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview 完全版本。\n     */\n    define('preset/all',[\n        'base',\n\n        // widgets\n        'widgets/filednd',\n        'widgets/filepaste',\n        'widgets/filepicker',\n        'widgets/image',\n        'widgets/queue',\n        'widgets/runtime',\n        'widgets/upload',\n        'widgets/validator',\n        'widgets/md5',\n\n        // runtimes\n        // html5\n        'runtime/html5/blob',\n        'runtime/html5/dnd',\n        'runtime/html5/filepaste',\n        'runtime/html5/filepicker',\n        'runtime/html5/imagemeta/exif',\n        'runtime/html5/androidpatch',\n        'runtime/html5/image',\n        'runtime/html5/transport',\n        'runtime/html5/md5',\n\n        // flash\n        'runtime/flash/filepicker',\n        'runtime/flash/image',\n        'runtime/flash/transport',\n        'runtime/flash/blob',\n        'runtime/flash/md5'\n    ], function( Base ) {\n        return Base;\n    });\n    /**\n     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n     *\n     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n     *\n     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n     *\n     * 如：\n     * WebUploader.create({\n     *     ...\n     *\n     *     disableWidgets: 'log',\n     *\n     *     ...\n     * })\n     */\n    define('widgets/log',[\n        'base',\n        'uploader',\n        'widgets/widget'\n    ], function( Base, Uploader ) {\n        var $ = Base.$,\n            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n            product = (location.hostname || location.host || 'protected').toLowerCase(),\n\n            // 只针对 baidu 内部产品用户做统计功能。\n            enable = product && /baidu/i.exec(product),\n            base;\n\n        if (!enable) {\n            return;\n        }\n\n        base = {\n            dv: 3,\n            master: 'webuploader',\n            online: /test/.exec(product) ? 0 : 1,\n            module: '',\n            product: product,\n            type: 0\n        };\n\n        function send(data) {\n            var obj = $.extend({}, base, data),\n                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n                image = new Image();\n\n            image.src = url;\n        }\n\n        return Uploader.register({\n            name: 'log',\n\n            init: function() {\n                var owner = this.owner,\n                    count = 0,\n                    size = 0;\n\n                owner\n                    .on('error', function(code) {\n                        send({\n                            type: 2,\n                            c_error_code: code\n                        });\n                    })\n                    .on('uploadError', function(file, reason) {\n                        send({\n                            type: 2,\n                            c_error_code: 'UPLOAD_ERROR',\n                            c_reason: '' + reason\n                        });\n                    })\n                    .on('uploadComplete', function(file) {\n                        count++;\n                        size += file.size;\n                    }).\n                    on('uploadFinished', function() {\n                        send({\n                            c_count: count,\n                            c_size: size\n                        });\n                        count = size = 0;\n                    });\n\n                send({\n                    c_usage: 1\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('webuploader',[\n        'preset/all',\n        'widgets/log'\n    ], function( preset ) {\n        return preset;\n    });\n    return require('webuploader');\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/plugin/webuploader/webuploader.js\n// module id = 86\n// module chunks = 4 6 7 12 16 30 34","var tpl = require('./content.tpl');\nvar Dialog = require('dialog');\n\nvar create = function(data, options){\n    var content = tpl(data || {}); // 显示编辑弹窗之前,需要自己拼装数据\n    options = options || {};\n\n    var defaults = {\n        title: '选择图片',\n        modal: true,\n        fixed: true,\n        content: content,\n        className: 'pop-box',\n        okValue: '插入图片',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        cancalValue : '取消',\n        btnWrapCls: 'insert-cancel'\n        /*function () {\n            // var value = $('#property-returnValue-demo').val();\n            // this.close(value);\n            // this.remove();\n        }*/\n    };\n    $.extend(true, defaults, options);\n    return Dialog(defaults);\n};\n\nmodule.exports = {\n    create: create\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/upload/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,maxlength=$data.maxlength,total=$data.total,$out='';$out+='<div data-node=\"uploadBox\"> <div class=\"pics-list-wrap clearfix\"> <ul class=\"pics-list clearfix\" data-node=\"uploadList\"> <li data-defaultAddFile=\\'picker\\'></li> </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"addNum\">';\n$out+=$escape(maxlength);\n$out+='</span><span class=\"deep-gray\">/';\n$out+=$escape(total);\n$out+='</span>张图片</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/upload/content.tpl\n// module id = 98\n// module chunks = 5 6 16 30","require('./ueditor/ueditor.config');\nrequire('./ueditor/ueditor.all');\nrequire('./ueditor/lang/zh-cn/zh-cn.js');\n\nrequire('./plugin');\nrequire('./rewrite');\nrequire('./ban');\nrequire('utils/indexOf');\nvar alert = require('module/popup/alert');\n//var detectQr = require('./plugin/detectQr');\n\nvar faceModule = require('module/popup/face/index');\nvar opts = require('./config');\n\n//商品选中增加遮罩\nvar goodsMask = require(\"./plugin/goodsMask\");\n//新增的文本过滤规则\nvar filterTxtRules = require(\"./rewrite/filterTxtRules\");\n//草稿箱\nvar restoreData = require('./plugin/restore');\nvar init = function(id) {\n    id = id || 'editor';\n    var editor = UE.getEditor(id, opts);\n\n    // 实例化表情，传入插入表情的回调方法。\n    var face = faceModule.init({\n        onSelected: function(data) {\n            var str = data.reg;\n            //var str = '<img src= \"' + data.url + '\" data-node=\"emoji\" width=\"22\" height=\"22\"/>'\n            editor.execCommand('inserthtml', str);\n        }\n    });\n    editor.face = face;\n\n    editor.addListener('ready', function() {\n\n        var defaultContent = editor.getContent();\n        var $editorBody = $(editor.body);\n        var placeholderCls = 'placeholder';\n        var $container = $(editor.container);\n        $editorBody.addClass(placeholderCls);\n        $editorBody.delegate('.publish-item a', 'click', function(e) {\n            e.stopPropagation();\n            e.preventDefault();\n        })\n        editor.addListener('focus', function() {\n            $editorBody.removeClass(placeholderCls);\n            $container.addClass('edui-nobg');\n        });\n        editor.addListener('blur', function() {\n            var hasDiv = !!$editorBody.find('div').length;\n            var isEqDefault = editor.getContent() == defaultContent;\n            var isContentEmpty = $.trim(editor.getContent()) == '';\n\n            if ((isEqDefault && hasDiv) || isContentEmpty) {\n                $editorBody.addClass(placeholderCls);\n                $container.removeClass('edui-nobg');\n            } else {\n                $editorBody.removeClass(placeholderCls);\n                $container.addClass('edui-nobg');\n            }\n        });\n        //加载草稿箱\n        restoreData(editor);\n        //文字过滤规则\n        filterTxtRules(editor);\n        //点击商品显示遮罩\n        goodsMask(editor);\n\n        var $emojiBtn = $(editor.container.firstChild).find('.edui-for-insertemoji');\n        var $pictorBtn = $(editor.container.firstChild).find('.edui-for-insertpicture');\n        var $picPopBox = $('[data-node=picPopBox]');\n        // 让表情包随着editorBar的fixed一起fixed\n        $(window).on('scroll', function() {\n            var flagY = $emojiBtn.offset().top;\n            var scrollTop = $(window).scrollTop();\n            var top;\n\n            if (scrollTop > flagY) {\n                top = 0;\n            } else {\n                top = flagY;\n            }\n            top = top / 1 + 30;\n\n            $picPopBox.css({\n                'top': top + 'px'\n            });\n\n            if (!face.isShow) {\n                return;\n            }\n            face.$dom.css({\n                top: top + 'px'\n            });\n\n        });\n\n        // 阻止表情按钮事件冒泡\n        $emojiBtn.on('click', function(e) {\n            $picPopBox.hide();\n            e.stopPropagation();            \n            e.preventDefault();\n        });\n\n        $pictorBtn.on('click', function(e) {\n            face.hide();\n            e.stopPropagation();\n            e.preventDefault();\n        });\n\n        $(\"body\").on('click', function() {\n            $picPopBox.hide();\n            face.hide();\n        })\n\n        $(editor.body).on('focus', function() {\n            if (editor.sensitiveWord) {\n                $.each($(editor.body).find('span[class=bg-warning]'), function(i, v) {\n                    $(v).on('mouseup', function() {\n                        $(v).removeClass('bg-warning');\n                    })\n                })\n                editor.sensitiveWord = false;\n            }\n            face.hide();\n        });\n        $(editor.body).on('click', function() {\n            face.hide();\n        });\n\n    });\n\n    return editor;\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/index.js","/**\n * ueditor完整配置项\n * 可以在这里配置整个编辑器的特性\n */\n/**************************提示********************************\n * 所有被注释的配置项均为UEditor默认值。\n * 修改默认配置请首先确保已经完全明确该参数的真实用途。\n * 主要有两种修改方案，一种是取消此处注释，然后修改成对应参数；另一种是在实例化编辑器时传入对应参数。\n * 当升级编辑器时，可直接使用旧版配置文件替换新版配置文件,不用担心旧版配置文件中因缺少新功能所需的参数而导致脚本报错。\n **************************提示********************************/\n\n(function() {\n\n    /**\n     * 编辑器资源文件根路径。它所表示的含义是：以编辑器实例化页面为当前路径，指向编辑器资源文件（即dialog等文件夹）的路径。\n     * 鉴于很多同学在使用编辑器的时候出现的种种路径问题，此处强烈建议大家使用\"相对于网站根目录的相对路径\"进行配置。\n     * \"相对于网站根目录的相对路径\"也就是以斜杠开头的形如\"/myProject/ueditor/\"这样的路径。\n     * 如果站点中有多个不在同一层级的页面需要实例化编辑器，且引用了同一UEditor的时候，此处的URL可能不适用于每个页面的编辑器。\n     * 因此，UEditor提供了针对不同页面的编辑器可单独配置的根路径，具体来说，在需要实例化编辑器的页面最顶部写上如下代码即可。当然，需要令此处的URL等于对应的配置。\n     * window.UEDITOR_HOME_URL = \"/xxxx/xxxx/\";\n     */\n\n    //window.UEDITOR_HOME_URL = \"http://js.dev.meixincdn.com:8017/src/js/module/editor/\"\n    var URL = window.UEDITOR_HOME_URL || getUEBasePath();\n\n    /**\n     * 配置项主体。注意，此处所有涉及到路径的配置别遗漏URL变量。\n     */\n    window.UEDITOR_CONFIG = {\n\n        //为编辑器实例添加一个路径，这个不能被注释\n        UEDITOR_HOME_URL: URL\n            // 服务器统一请求接口路径\n            // , serverUrl: URL + \"php/controller.php\"\n            ,\n        serverUrl: \"http://127.0.0.1/utf8-php/php/controller.php\"\n            //工具栏上的所有的功能按钮和下拉框，可以在new编辑器的实例时选择自己需要的重新定义\n            ,\n        /*toolbars: [[\n            'fullscreen', 'source', '|', 'undo', 'redo', '|',\n            'bold', 'italic', 'underline', 'fontborder', 'strikethrough', 'superscript', 'subscript', 'removeformat', 'formatmatch', 'autotypeset', 'blockquote', 'pasteplain', '|', 'forecolor', 'backcolor', 'insertorderedlist', 'insertunorderedlist', 'selectall', 'cleardoc', '|',\n            'rowspacingtop', 'rowspacingbottom', 'lineheight', '|',\n            'customstyle', 'paragraph', 'fontfamily', 'fontsize', '|',\n            'directionalityltr', 'directionalityrtl', 'indent', '|',\n            'justifyleft', 'justifycenter', 'justifyright', 'justifyjustify', '|', 'touppercase', 'tolowercase', '|',\n            'link', 'unlink', 'anchor', '|', 'imagenone', 'imageleft', 'imageright', 'imagecenter', '|',\n            'simpleupload', 'insertimage', 'emotion', 'scrawl', 'insertvideo', 'music', 'attachment', 'map', 'gmap', 'insertframe', 'insertcode', 'webapp', 'pagebreak', 'template', 'background', '|',\n            'horizontal', 'date', 'time', 'spechars', 'snapscreen', 'wordimage', '|',\n            'inserttable', 'deletetable', 'insertparagraphbeforetable', 'insertrow', 'deleterow', 'insertcol', 'deletecol', 'mergecells', 'mergeright', 'mergedown', 'splittocells', 'splittorows', 'splittocols', 'charts', '|',\n            'print', 'preview', 'searchreplace', 'drafts', 'help'\n        ]]*/\n        toolbars: [\n                []\n            ]\n            //当鼠标放在工具栏上时显示的tooltip提示,留空支持自动多语言配置，否则以配置值为准\n            //,labelMap:{\n            //    'anchor':'', 'undo':''\n            //}\n\n        //语言配置项,默认是zh-cn。有需要的话也可以使用如下这样的方式来自动多语言切换，当然，前提条件是lang文件夹下存在对应的语言文件：\n        //lang值也可以通过自动获取 (navigator.language||navigator.browserLanguage ||navigator.userLanguage).toLowerCase()\n        //,lang:\"zh-cn\"\n        //,langPath:URL +\"lang/\"\n\n        //主题配置项,默认是default。有需要的话也可以使用如下这样的方式来自动多主题切换，当然，前提条件是themes文件夹下存在对应的主题文件：\n        //现有如下皮肤:default\n        //,theme:'default'\n        //,themePath:URL +\"themes/\"\n\n        //,zIndex : 900     //编辑器层级的基数,默认是900\n\n        //针对getAllHtml方法，会在对应的head标签中增加该编码设置。\n        //,charset:\"utf-8\"\n\n        //若实例化编辑器的页面手动修改的domain，此处需要设置为true\n        //,customDomain:false\n\n        //常用配置项目\n        //,isShow : true    //默认显示编辑器\n\n        //,textarea:'editorValue' // 提交表单时，服务器获取编辑器提交内容的所用的参数，多实例时可以给容器name属性，会将name给定的值最为每个实例的键值，不用每次实例化的时候都设置这个值\n\n        //,initialContent:'欢迎使用ueditor!'    //初始化编辑器的内容,也可以通过textarea/script给值，看官网例子\n\n        //,autoClearinitialContent:true //是否自动清除编辑器初始内容，注意：如果focus属性设置为true,这个也为真，那么编辑器一上来就会触发导致初始化的内容看不到了\n\n        //,focus:false //初始化时，是否让编辑器获得焦点true或false\n\n        //如果自定义，最好给p标签如下的行高，要不输入中文时，会有跳动感\n        //,initialStyle:'p{line-height:1em}'//编辑器层级的基数,可以用来改变字体等\n\n        //,iframeCssUrl: URL + '/themes/iframe.css' //给编辑区域的iframe引入一个css文件\n\n        //indentValue\n        //首行缩进距离,默认是2em\n        //,indentValue:'2em'\n\n        //,initialFrameWidth:1000  //初始化编辑器宽度,默认1000\n        //,initialFrameHeight:320  //初始化编辑器高度,默认320\n\n        //,readonly : false //编辑器初始化结束后,编辑区域是否是只读的，默认是false\n\n        //,autoClearEmptyNode : true //getContent时，是否删除空的inlineElement节点（包括嵌套的情况）\n\n        //启用自动保存\n        //,enableAutoSave: true\n        //自动保存间隔时间， 单位ms\n        //,saveInterval: 500\n\n        //,fullscreen : false //是否开启初始化时即全屏，默认关闭\n\n        //,imagePopup:true      //图片操作的浮层开关，默认打开\n\n        //,autoSyncData:true //自动同步编辑器要提交的数据\n        //,emotionLocalization:false //是否开启表情本地化，默认关闭。若要开启请确保emotion文件夹下包含官网提供的images表情文件夹\n\n        //粘贴只保留标签，去除标签所有属性\n        //,retainOnlyLabelPasted: false\n\n        //,pasteplain:false  //是否默认为纯文本粘贴。false为不使用纯文本粘贴，true为使用纯文本粘贴\n        //纯文本粘贴模式下的过滤规则\n        //'filterTxtRules' : function(){\n        //    function transP(node){\n        //        node.tagName = 'p';\n        //        node.setStyle();\n        //    }\n        //    return {\n        //        //直接删除及其字节点内容\n        //        '-' : 'script style object iframe embed input select',\n        //        'p': {$:{}},\n        //        'br':{$:{}},\n        //        'div':{'$':{}},\n        //        'li':{'$':{}},\n        //        'caption':transP,\n        //        'th':transP,\n        //        'tr':transP,\n        //        'h1':transP,'h2':transP,'h3':transP,'h4':transP,'h5':transP,'h6':transP,\n        //        'td':function(node){\n        //            //没有内容的td直接删掉\n        //            var txt = !!node.innerText();\n        //            if(txt){\n        //                node.parentNode.insertAfter(UE.uNode.createText(' &nbsp; &nbsp;'),node);\n        //            }\n        //            node.parentNode.removeChild(node,node.innerText())\n        //        }\n        //    }\n        //}()\n\n        //,allHtmlEnabled:false //提交到后台的数据是否包含整个html字符串\n\n        //insertorderedlist\n        //有序列表的下拉配置,值留空时支持多语言自动识别，若配置值，则以此值为准\n        //,'insertorderedlist':{\n        //      //自定的样式\n        //        'num':'1,2,3...',\n        //        'num1':'1),2),3)...',\n        //        'num2':'(1),(2),(3)...',\n        //        'cn':'一,二,三....',\n        //        'cn1':'一),二),三)....',\n        //        'cn2':'(一),(二),(三)....',\n        //     //系统自带\n        //     'decimal' : '' ,         //'1,2,3...'\n        //     'lower-alpha' : '' ,    // 'a,b,c...'\n        //     'lower-roman' : '' ,    //'i,ii,iii...'\n        //     'upper-alpha' : '' , lang   //'A,B,C'\n        //     'upper-roman' : ''      //'I,II,III...'\n        //}\n\n        //insertunorderedlist\n        //无序列表的下拉配置，值留空时支持多语言自动识别，若配置值，则以此值为准\n        //,insertunorderedlist : { //自定的样式\n        //    'dash' :'— 破折号', //-破折号\n        //    'dot':' 。 小圆圈', //系统自带\n        //    'circle' : '',  // '○ 小圆圈'\n        //    'disc' : '',    // '● 小圆点'\n        //    'square' : ''   //'■ 小方块'\n        //}\n        //,listDefaultPaddingLeft : '30'//默认的左边缩进的基数倍\n        //,listiconpath : 'http://bs.baidu.com/listicon/'//自定义标号的路径\n        //,maxListLevel : 3 //限制可以tab的级数, 设置-1为不限制\n\n        //,autoTransWordToList:false  //禁止word中粘贴进来的列表自动变成列表标签\n\n        //fontfamily\n        //字体设置 label留空支持多语言自动切换，若配置，则以配置值为准\n        //,'fontfamily':[\n        //    { label:'',name:'songti',val:'宋体,SimSun'},\n        //    { label:'',name:'kaiti',val:'楷体,楷体_GB2312, SimKai'},\n        //    { label:'',name:'yahei',val:'微软雅黑,Microsoft YaHei'},\n        //    { label:'',name:'heiti',val:'黑体, SimHei'},\n        //    { label:'',name:'lishu',val:'隶书, SimLi'},\n        //    { label:'',name:'andaleMono',val:'andale mono'},\n        //    { label:'',name:'arial',val:'arial, helvetica,sans-serif'},\n        //    { label:'',name:'arialBlack',val:'arial black,avant garde'},\n        //    { label:'',name:'comicSansMs',val:'comic sans ms'},\n        //    { label:'',name:'impact',val:'impact,chicago'},\n        //    { label:'',name:'timesNewRoman',val:'times new roman'}\n        //]\n\n        //fontsize\n        //字号\n        //,'fontsize':[10, 11, 12, 14, 16, 18, 20, 24, 36]\n\n        //paragraph\n        //段落格式 值留空时支持多语言自动识别，若配置，则以配置值为准\n        //,'paragraph':{'p':'', 'h1':'', 'h2':'', 'h3':'', 'h4':'', 'h5':'', 'h6':''}\n\n        //rowspacingtop\n        //段间距 值和显示的名字相同\n        //,'rowspacingtop':['5', '10', '15', '20', '25']\n\n        //rowspacingBottom\n        //段间距 值和显示的名字相同\n        //,'rowspacingbottom':['5', '10', '15', '20', '25']\n\n        //lineheight\n        //行内间距 值和显示的名字相同\n        //,'lineheight':['1', '1.5','1.75','2', '3', '4', '5']\n\n        //customstyle\n        //自定义样式，不支持国际化，此处配置值即可最后显示值\n        //block的元素是依据设置段落的逻辑设置的，inline的元素依据BIU的逻辑设置\n        //尽量使用一些常用的标签\n        //参数说明\n        //tag 使用的标签名字\n        //label 显示的名字也是用来标识不同类型的标识符，注意这个值每个要不同，\n        //style 添加的样式\n        //每一个对象就是一个自定义的样式\n        //,'customstyle':[\n        //    {tag:'h1', name:'tc', label:'', style:'border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;'},\n        //    {tag:'h1', name:'tl',label:'', style:'border-bottom:#ccc 2px solid;padding:0 4px 0 0;margin:0 0 10px 0;'},\n        //    {tag:'span',name:'im', label:'', style:'font-style:italic;font-weight:bold'},\n        //    {tag:'span',name:'hi', label:'', style:'font-style:italic;font-weight:bold;color:rgb(51, 153, 204)'}\n        //]\n\n        //打开右键菜单功能\n        //,enableContextMenu: true\n        //右键菜单的内容，可以参考plugins/contextmenu.js里边的默认菜单的例子，label留空支持国际化，否则以此配置为准\n        //,contextMenu:[\n        //    {\n        //        label:'',       //显示的名称\n        //        cmdName:'selectall',//执行的command命令，当点击这个右键菜单时\n        //        //exec可选，有了exec就会在点击时执行这个function，优先级高于cmdName\n        //        exec:function () {\n        //            //this是当前编辑器的实例\n        //            //this.ui._dialogs['inserttableDialog'].open();\n        //        }\n        //    }\n        //]\n\n        //快捷菜单\n        //,shortcutMenu:[\"fontfamily\", \"fontsize\", \"bold\", \"italic\", \"underline\", \"forecolor\", \"backcolor\", \"insertorderedlist\", \"insertunorderedlist\"]\n\n        //elementPathEnabled\n        //是否启用元素路径，默认是显示\n        //,elementPathEnabled : true\n\n        //wordCount\n        //,wordCount:true          //是否开启字数统计\n        //,maximumWords:10000       //允许的最大字符数\n        //字数统计提示，{#count}代表当前字数，{#leave}代表还可以输入多少字符数,留空支持多语言自动切换，否则按此配置显示\n        //,wordCountMsg:''   //当前已输入 {#count} 个字符，您还可以输入{#leave} 个字符\n        //超出字数限制提示  留空支持多语言自动切换，否则按此配置显示\n        //,wordOverFlowMsg:''    //<span style=\"color:red;\">你输入的字符个数已经超出最大允许值，服务器可能会拒绝保存！</span>\n\n        //tab\n        //点击tab键时移动的距离,tabSize倍数，tabNode什么字符做为单位\n        //,tabSize:4\n        //,tabNode:'&nbsp;'\n\n        //removeFormat\n        //清除格式时可以删除的标签和属性\n        //removeForamtTags标签\n        //,removeFormatTags:'b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var'\n        //removeFormatAttributes属性\n        //,removeFormatAttributes:'class,style,lang,width,height,align,hspace,valign'\n\n        //undo\n        //可以最多回退的次数,默认20\n        //,maxUndoCount:20\n        //当输入的字符数超过该值时，保存一次现场\n        //,maxInputCount:1\n\n        //autoHeightEnabled\n        // 是否自动长高,默认true\n        //,autoHeightEnabled:true\n\n        //scaleEnabled\n        //是否可以拉伸长高,默认true(当开启时，自动长高失效)\n        //,scaleEnabled:false\n        //,minFrameWidth:800    //编辑器拖动时最小宽度,默认800\n        //,minFrameHeight:220  //编辑器拖动时最小高度,默认220\n\n        //autoFloatEnabled\n        //是否保持toolbar的位置不动,默认true\n        //,autoFloatEnabled:true\n        //浮动时工具栏距离浏览器顶部的高度，用于某些具有固定头部的页面\n        //,topOffset:30\n        //编辑器底部距离工具栏高度(如果参数大于等于编辑器高度，则设置无效)\n        //,toolbarTopOffset:400\n\n        //设置远程图片是否抓取到本地保存\n        //,catchRemoteImageEnable: true //设置是否抓取远程图片\n\n        //pageBreakTag\n        //分页标识符,默认是_ueditor_page_break_tag_\n        //,pageBreakTag:'_ueditor_page_break_tag_'\n\n        //autotypeset\n        //自动排版参数\n        //,autotypeset: {\n        //    mergeEmptyline: true,           //合并空行\n        //    removeClass: true,              //去掉冗余的class\n        //    removeEmptyline: false,         //去掉空行\n        //    textAlign:\"left\",               //段落的排版方式，可以是 left,right,center,justify 去掉这个属性表示不执行排版\n        //    imageBlockLine: 'center',       //图片的浮动方式，独占一行剧中,左右浮动，默认: center,left,right,none 去掉这个属性表示不执行排版\n        //    pasteFilter: false,             //根据规则过滤没事粘贴进来的内容\n        //    clearFontSize: false,           //去掉所有的内嵌字号，使用编辑器默认的字号\n        //    clearFontFamily: false,         //去掉所有的内嵌字体，使用编辑器默认的字体\n        //    removeEmptyNode: false,         // 去掉空节点\n        //    //可以去掉的标签\n        //    removeTagNames: {标签名字:1},\n        //    indent: false,                  // 行首缩进\n        //    indentValue : '2em',            //行首缩进的大小\n        //    bdc2sb: false,\n        //    tobdc: false\n        //}\n\n        //tableDragable\n        //表格是否可以拖拽\n        //,tableDragable: true\n\n        //sourceEditor\n        //源码的查看方式,codemirror 是代码高亮，textarea是文本框,默认是codemirror\n        //注意默认codemirror只能在ie8+和非ie中使用\n        //,sourceEditor:\"codemirror\"\n        //如果sourceEditor是codemirror，还用配置一下两个参数\n        //codeMirrorJsUrl js加载的路径，默认是 URL + \"third-party/codemirror/codemirror.js\"\n        //,codeMirrorJsUrl:URL + \"third-party/codemirror/codemirror.js\"\n        //codeMirrorCssUrl css加载的路径，默认是 URL + \"third-party/codemirror/codemirror.css\"\n        //,codeMirrorCssUrl:URL + \"third-party/codemirror/codemirror.css\"\n        //编辑器初始化完成后是否进入源码模式，默认为否。\n        //,sourceEditorFirst:false\n\n        //iframeUrlMap\n        //dialog内容的路径 ～会被替换成URL,垓属性一旦打开，将覆盖所有的dialog的默认路径\n        //,iframeUrlMap:{\n        //    'anchor':'~/dialogs/anchor/anchor.html',\n        //}\n\n        //allowLinkProtocol 允许的链接地址，有这些前缀的链接地址不会自动添加http\n        //, allowLinkProtocols: ['http:', 'https:', '#', '/', 'ftp:', 'mailto:', 'tel:', 'git:', 'svn:']\n\n        //webAppKey 百度应用的APIkey，每个站长必须首先去百度官网注册一个key后方能正常使用app功能，注册介绍，http://app.baidu.com/static/cms/getapikey.html\n        //, webAppKey: \"\"\n\n        //默认过滤规则相关配置项目\n        //,disabledTableInTable:true  //禁止表格嵌套\n        //,allowDivTransToP:true      //允许进入编辑器的div标签自动变成p标签\n        //,rgb2Hex:true               //默认产出的数据中的color自动从rgb格式变成16进制格式\n\n        // xss 过滤是否开启,inserthtml等操作\n        ,\n        xssFilterRules: true\n            //input xss过滤\n            ,\n        inputXssFilter: true\n            //output xss过滤\n            ,\n        outputXssFilter: true\n            // xss过滤白名单 名单来源: https://raw.githubusercontent.com/leizongmin/js-xss/master/lib/default.js\n            ,\n        whitList: {\n            a: ['target', 'style', 'href', 'title', 'class'],\n            abbr: ['title', 'class', 'style'],\n            address: ['class', 'style'],\n            area: ['shape', 'coords', 'href', 'alt'],\n            article: [],\n            aside: [],\n            audio: ['autoplay', 'controls', 'loop', 'preload', 'src', 'class', 'style'],\n            b: ['class', 'style'],\n            bdi: ['dir'],\n            bdo: ['dir'],\n            big: [],\n            blockquote: ['cite', 'class', 'style'],\n            br: [],\n            caption: ['class', 'style'],\n            center: [],\n            cite: [],\n            code: ['class', 'style'],\n            col: ['align', 'valign', 'span', 'width', 'class', 'style'],\n            colgroup: ['align', 'valign', 'span', 'width', 'class', 'style'],\n            dd: ['class', 'style'],\n            del: ['datetime'],\n            details: ['open'],\n            div: ['class', 'style', 'data-node', 'data-type', 'contenteditable', 'data-pid', 'data-info', 'data-goodsinfo', 'data-skuid'],\n            dl: ['class', 'style'],\n            dt: ['class', 'style'],\n            em: ['class', 'style'],\n            font: ['color', 'size', 'face'],\n            footer: [],\n            h1: ['data-node'],\n            h2: ['data-node'],\n            h3: ['class', 'data-node'],\n            h4: ['data-node'],\n            h5: ['data-node'],\n            h6: ['data-node'],\n            header: [],\n            hr: [],\n            i: ['class', 'style'],\n            img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-type', 'data-face', 'data-t', 'data-original', 'onerror', 'proto'],\n            ins: ['datetime'],\n            li: ['class', 'style'],\n            mark: [],\n            nav: [],\n            ol: ['class', 'style'],\n            p: ['class', 'style'],\n            pre: ['class', 'style'],\n            s: [],\n            section: [],\n            small: [],\n            span: ['class', 'style'],\n            sub: ['class', 'style'],\n            sup: ['class', 'style'],\n            strong: ['class', 'style'],\n            table: ['width', 'border', 'align', 'valign', 'class', 'style'],\n            tbody: ['align', 'valign', 'class', 'style'],\n            td: ['width', 'rowspan', 'colspan', 'align', 'valign', 'class', 'style'],\n            tfoot: ['align', 'valign', 'class', 'style'],\n            th: ['width', 'rowspan', 'colspan', 'align', 'valign', 'class', 'style'],\n            thead: ['align', 'valign', 'class', 'style'],\n            tr: ['rowspan', 'align', 'valign', 'class', 'style'],\n            tt: [],\n            u: [],\n            ul: ['class', 'style'],\n            video: ['autoplay', 'controls', 'loop', 'preload', 'src', 'height', 'width', 'class', 'style']\n        }\n    };\n\n    function getUEBasePath(docUrl, confUrl) {\n\n        return getBasePath(docUrl || self.document.URL || self.location.href, confUrl || getConfigFilePath());\n\n    }\n\n    function getConfigFilePath() {\n\n        var configPath = document.getElementsByTagName('script');\n\n        return configPath[configPath.length - 1].src;\n\n    }\n\n    function getBasePath(docUrl, confUrl) {\n\n        var basePath = confUrl;\n\n        if (/^(\\/|\\\\\\\\)/.test(confUrl)) {\n\n            basePath = /^.+?\\w(\\/|\\\\\\\\)/.exec(docUrl)[0] + confUrl.replace(/^(\\/|\\\\\\\\)/, '');\n\n        } else if (!/^[a-z]+:/i.test(confUrl)) {\n\n            docUrl = docUrl.split(\"#\")[0].split(\"?\")[0].replace(/[^\\\\\\/]+$/, '');\n\n            basePath = docUrl + \"\" + confUrl;\n\n        }\n\n        return optimizationPath(basePath);\n\n    }\n\n    function optimizationPath(path) {\n\n        var protocol = /^[a-z]+:\\/\\//.exec(path)[0],\n            tmp = null,\n            res = [];\n\n        path = path.replace(protocol, \"\").split(\"?\")[0].split(\"#\")[0];\n\n        path = path.replace(/\\\\/g, '/').split(/\\//);\n\n        path[path.length - 1] = \"\";\n\n        while (path.length) {\n\n            if ((tmp = path.shift()) === \"..\") {\n                res.pop();\n            } else if (tmp !== \".\") {\n                res.push(tmp);\n            }\n\n        }\n\n        return protocol + res.join(\"/\");\n\n    }\n\n    window.UE = {\n        getUEBasePath: getUEBasePath\n    };\n\n})();\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ueditor/ueditor.config.js","/*!\n * UEditor\n * version: ueditor\n * build: Wed Aug 10 2016 11:06:02 GMT+0800 (CST)\n */\n\n(function() {\n\t// editor.js\n\tUEDITOR_CONFIG = window.UEDITOR_CONFIG || {};\n\n\tvar baidu = window.baidu || {};\n\n\twindow.baidu = baidu;\n\n\twindow.UE = baidu.editor = window.UE || {};\n\n\tUE.plugins = {};\n\n\tUE.commands = {};\n\n\tUE.instants = {};\n\n\tUE.I18N = {};\n\n\tUE._customizeUI = {};\n\n\tUE.version = \"1.4.3\";\n\n\tvar dom = UE.dom = {};\n\n\t// core/browser.js\n\t/**\n\t * 浏览器判断模块\n\t * @file\n\t * @module UE.browser\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 提供浏览器检测的模块\n\t * @unfile\n\t * @module UE.browser\n\t */\n\tvar browser = UE.browser = function() {\n\t\tvar agent = navigator.userAgent.toLowerCase(),\n\t\t\topera = window.opera,\n\t\t\tbrowser = {\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} ie 检测当前浏览器是否为IE\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.ie ) {\n\t\t\t\t *     console.log( '当前浏览器是IE' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tie: /(msie\\s|trident.*rv:)([\\w.]+)/.test(agent),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} opera 检测当前浏览器是否为Opera\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.opera ) {\n\t\t\t\t *     console.log( '当前浏览器是Opera' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\topera: (!!opera && opera.version),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} webkit 检测当前浏览器是否是webkit内核的浏览器\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.webkit ) {\n\t\t\t\t *     console.log( '当前浏览器是webkit内核浏览器' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\twebkit: (agent.indexOf(' applewebkit/') > -1),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} mac 检测当前浏览器是否是运行在mac平台下\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.mac ) {\n\t\t\t\t *     console.log( '当前浏览器运行在mac平台下' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tmac: (agent.indexOf('macintosh') > -1),\n\n\t\t\t\t/**\n\t\t\t\t * @property {boolean} quirks 检测当前浏览器是否处于“怪异模式”下\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * if ( UE.browser.quirks ) {\n\t\t\t\t *     console.log( '当前浏览器运行处于“怪异模式”' );\n\t\t\t\t * }\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\tquirks: (document.compatMode == 'BackCompat')\n\t\t\t};\n\n\t\t/**\n\t\t * @property {boolean} gecko 检测当前浏览器内核是否是gecko内核\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.gecko ) {\n\t\t *     console.log( '当前浏览器内核是gecko内核' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tbrowser.gecko = (navigator.product == 'Gecko' && !browser.webkit && !browser.opera && !browser.ie);\n\n\t\tvar version = 0;\n\n\t\t// Internet Explorer 6.0+\n\t\tif (browser.ie) {\n\n\t\t\tvar v1 = agent.match(/(?:msie\\s([\\w.]+))/);\n\t\t\tvar v2 = agent.match(/(?:trident.*rv:([\\w.]+))/);\n\t\t\tif (v1 && v2 && v1[1] && v2[1]) {\n\t\t\t\tversion = Math.max(v1[1] * 1, v2[1] * 1);\n\t\t\t} else if (v1 && v1[1]) {\n\t\t\t\tversion = v1[1] * 1;\n\t\t\t} else if (v2 && v2[1]) {\n\t\t\t\tversion = v2[1] * 1;\n\t\t\t} else {\n\t\t\t\tversion = 0;\n\t\t\t}\n\n\t\t\tbrowser.ie11Compat = document.documentMode == 11;\n\t\t\t/**\n\t\t\t * @property { boolean } ie9Compat 检测浏览器模式是否为 IE9 兼容模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie9Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE9兼容模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie9Compat = document.documentMode == 9;\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie8 检测浏览器是否是IE8浏览器\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie8 ) {\n\t\t\t *     console.log( '当前浏览器是IE8浏览器' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie8 = !!document.documentMode;\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie8Compat 检测浏览器模式是否为 IE8 兼容模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie8Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE8兼容模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie8Compat = document.documentMode == 8;\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie7Compat 检测浏览器模式是否为 IE7 兼容模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie7Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE7兼容模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie7Compat = ((version == 7 && !document.documentMode) || document.documentMode == 7);\n\n\t\t\t/**\n\t\t\t * @property { boolean } ie6Compat 检测浏览器模式是否为 IE6 模式 或者怪异模式\n\t\t\t * @warning 如果浏览器不是IE， 则该值为undefined\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * if ( UE.browser.ie6Compat ) {\n\t\t\t *     console.log( '当前浏览器运行在IE6模式或者怪异模式下' );\n\t\t\t * }\n\t\t\t * ```\n\t\t\t */\n\t\t\tbrowser.ie6Compat = (version < 7 || browser.quirks);\n\n\t\t\tbrowser.ie9above = version > 8;\n\n\t\t\tbrowser.ie9below = version < 9;\n\n\t\t\tbrowser.ie11above = version > 10;\n\n\t\t\tbrowser.ie11below = version < 11;\n\n\t\t}\n\n\t\t// Gecko.\n\t\tif (browser.gecko) {\n\t\t\tvar geckoRelease = agent.match(/rv:([\\d\\.]+)/);\n\t\t\tif (geckoRelease) {\n\t\t\t\tgeckoRelease = geckoRelease[1].split('.');\n\t\t\t\tversion = geckoRelease[0] * 10000 + (geckoRelease[1] || 0) * 100 + (geckoRelease[2] || 0) * 1;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @property { Number } chrome 检测当前浏览器是否为Chrome, 如果是，则返回Chrome的大版本号\n\t\t * @warning 如果浏览器不是chrome， 则该值为undefined\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.chrome ) {\n\t\t *     console.log( '当前浏览器是Chrome' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tif (/chrome\\/(\\d+\\.\\d)/i.test(agent)) {\n\t\t\tbrowser.chrome = +RegExp['\\x241'];\n\t\t}\n\n\t\t/**\n\t\t * @property { Number } safari 检测当前浏览器是否为Safari, 如果是，则返回Safari的大版本号\n\t\t * @warning 如果浏览器不是safari， 则该值为undefined\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.safari ) {\n\t\t *     console.log( '当前浏览器是Safari' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tif (/(\\d+\\.\\d)?(?:\\.\\d)?\\s+safari\\/?(\\d+\\.\\d+)?/i.test(agent) && !/chrome/i.test(agent)) {\n\t\t\tbrowser.safari = +(RegExp['\\x241'] || RegExp['\\x242']);\n\t\t}\n\n\t\t// Opera 9.50+\n\t\tif (browser.opera)\n\t\t\tversion = parseFloat(opera.version());\n\n\t\t// WebKit 522+ (Safari 3+)\n\t\tif (browser.webkit)\n\t\t\tversion = parseFloat(agent.match(/ applewebkit\\/(\\d+)/)[1]);\n\n\t\t/**\n\t\t * @property { Number } version 检测当前浏览器版本号\n\t\t * @remind\n\t\t * <ul>\n\t\t *     <li>IE系列返回值为5,6,7,8,9,10等</li>\n\t\t *     <li>gecko系列会返回10900，158900等</li>\n\t\t *     <li>webkit系列会返回其build号 (如 522等)</li>\n\t\t * </ul>\n\t\t * @example\n\t\t * ```javascript\n\t\t * console.log( '当前浏览器版本号是： ' + UE.browser.version );\n\t\t * ```\n\t\t */\n\t\tbrowser.version = version;\n\n\t\t/**\n\t\t * @property { boolean } isCompatible 检测当前浏览器是否能够与UEditor良好兼容\n\t\t * @example\n\t\t * ```javascript\n\t\t * if ( UE.browser.isCompatible ) {\n\t\t *     console.log( '浏览器与UEditor能够良好兼容' );\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tbrowser.isCompatible = !browser.mobile && (\n\t\t\t(browser.ie && version >= 6) ||\n\t\t\t(browser.gecko && version >= 10801) ||\n\t\t\t(browser.opera && version >= 9.5) ||\n\t\t\t(browser.air && version >= 1) ||\n\t\t\t(browser.webkit && version >= 522) ||\n\t\t\tfalse);\n\t\treturn browser;\n\t}();\n\t//快捷方式\n\tvar ie = browser.ie,\n\t\twebkit = browser.webkit,\n\t\tgecko = browser.gecko,\n\t\topera = browser.opera;\n\n\t// core/utils.js\n\t/**\n\t * 工具函数包\n\t * @file\n\t * @module UE.utils\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor封装使用的静态工具函数\n\t * @module UE.utils\n\t * @unfile\n\t */\n\n\tvar utils = UE.utils = {\n\n\t\t/**\n\t\t * 用给定的迭代器遍历对象\n\t\t * @method each\n\t\t * @param { Object } obj 需要遍历的对象\n\t\t * @param { Function } iterator 迭代器， 该方法接受两个参数， 第一个参数是当前所处理的value， 第二个参数是当前遍历对象的key\n\t\t * @example\n\t\t * ```javascript\n\t\t * var demoObj = {\n\t\t *     key1: 1,\n\t\t *     key2: 2\n\t\t * };\n\t\t *\n\t\t * //output: key1: 1, key2: 2\n\t\t * UE.utils.each( demoObj, funciton ( value, key ) {\n\t\t *\n\t\t *     console.log( key + \":\" + value );\n\t\t *\n\t\t * } );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 用给定的迭代器遍历数组或类数组对象\n\t\t * @method each\n\t\t * @param { Array } array 需要遍历的数组或者类数组\n\t\t * @param { Function } iterator 迭代器， 该方法接受两个参数， 第一个参数是当前所处理的value， 第二个参数是当前遍历对象的key\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divs = document.getElmentByTagNames( \"div\" );\n\t\t *\n\t\t * //output: 0: DIV, 1: DIV ...\n\t\t * UE.utils.each( divs, funciton ( value, key ) {\n\t\t *\n\t\t *     console.log( key + \":\" + value.tagName );\n\t\t *\n\t\t * } );\n\t\t * ```\n\t\t */\n\t\teach: function(obj, iterator, context) {\n\t\t\tif (obj == null) return;\n\t\t\tif (obj.length === +obj.length) {\n\t\t\t\tfor (var i = 0, l = obj.length; i < l; i++) {\n\t\t\t\t\tif (iterator.call(context, obj[i], i, obj) === false)\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor (var key in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\t\tif (iterator.call(context, obj[key], key, obj) === false)\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 以给定对象作为原型创建一个新对象\n\t\t * @method makeInstance\n\t\t * @param { Object } protoObject 该对象将作为新创建对象的原型\n\t\t * @return { Object } 新的对象， 该对象的原型是给定的protoObject对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var protoObject = { sayHello: function () { console.log('Hello UEditor!'); } };\n\t\t *\n\t\t * var newObject = UE.utils.makeInstance( protoObject );\n\t\t * //output: Hello UEditor!\n\t\t * newObject.sayHello();\n\t\t * ```\n\t\t */\n\t\tmakeInstance: function(obj) {\n\t\t\tvar noop = new Function();\n\t\t\tnoop.prototype = obj;\n\t\t\tobj = new noop;\n\t\t\tnoop.prototype = null;\n\t\t\treturn obj;\n\t\t},\n\n\t\t/**\n\t\t * 将source对象中的属性扩展到target对象上\n\t\t * @method extend\n\t\t * @remind 该方法将强制把source对象上的属性复制到target对象上\n\t\t * @see UE.utils.extend(Object,Object,Boolean)\n\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t * @param { Object } source 源对象， 该对象的属性会被附加到target对象上\n\t\t * @return { Object } 返回target对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var target = { name: 'target', sex: 1 },\n\t\t *      source = { name: 'source', age: 17 };\n\t\t *\n\t\t * UE.utils.extend( target, source );\n\t\t *\n\t\t * //output: { name: 'source', sex: 1, age: 17 }\n\t\t * console.log( target );\n\t\t *\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 将source对象中的属性扩展到target对象上， 根据指定的isKeepTarget值决定是否保留目标对象中与\n\t\t * 源对象属性名相同的属性值。\n\t\t * @method extend\n\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t * @param { Object } source 源对象， 该对象的属性会被附加到target对象上\n\t\t * @param { Boolean } isKeepTarget 是否保留目标对象中与源对象中属性名相同的属性\n\t\t * @return { Object } 返回target对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var target = { name: 'target', sex: 1 },\n\t\t *      source = { name: 'source', age: 17 };\n\t\t *\n\t\t * UE.utils.extend( target, source, true );\n\t\t *\n\t\t * //output: { name: 'target', sex: 1, age: 17 }\n\t\t * console.log( target );\n\t\t *\n\t\t * ```\n\t\t */\n\t\textend: function(t, s, b) {\n\t\t\tif (s) {\n\t\t\t\tfor (var k in s) {\n\t\t\t\t\tif (!b || !t.hasOwnProperty(k)) {\n\t\t\t\t\t\tt[k] = s[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn t;\n\t\t},\n\n\t\t/**\n\t\t * 将给定的多个对象的属性复制到目标对象target上\n\t\t * @method extend2\n\t\t * @remind 该方法将强制把源对象上的属性复制到target对象上\n\t\t * @remind 该方法支持两个及以上的参数， 从第二个参数开始， 其属性都会被复制到第一个参数上。 如果遇到同名的属性，\n\t\t *          将会覆盖掉之前的值。\n\t\t * @param { Object } target 目标对象， 新的属性将附加到该对象上\n\t\t * @param { Object... } source 源对象， 支持多个对象， 该对象的属性会被附加到target对象上\n\t\t * @return { Object } 返回target对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var target = {},\n\t\t *     source1 = { name: 'source', age: 17 },\n\t\t *     source2 = { title: 'dev' };\n\t\t *\n\t\t * UE.utils.extend2( target, source1, source2 );\n\t\t *\n\t\t * //output: { name: 'source', age: 17, title: 'dev' }\n\t\t * console.log( target );\n\t\t *\n\t\t * ```\n\t\t */\n\t\textend2: function(t) {\n\t\t\tvar a = arguments;\n\t\t\tfor (var i = 1; i < a.length; i++) {\n\t\t\t\tvar x = a[i];\n\t\t\t\tfor (var k in x) {\n\t\t\t\t\tif (!t.hasOwnProperty(k)) {\n\t\t\t\t\t\tt[k] = x[k];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn t;\n\t\t},\n\n\t\t/**\n\t\t * 模拟继承机制， 使得subClass继承自superClass\n\t\t * @method inherits\n\t\t * @param { Object } subClass 子类对象\n\t\t * @param { Object } superClass 超类对象\n\t\t * @warning 该方法只能让subClass继承超类的原型， subClass对象自身的属性和方法不会被继承\n\t\t * @return { Object } 继承superClass后的子类对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * function SuperClass(){\n\t\t *     this.name = \"小李\";\n\t\t * }\n\t\t *\n\t\t * SuperClass.prototype = {\n\t\t *     hello:function(str){\n\t\t *         console.log(this.name + str);\n\t\t *     }\n\t\t * }\n\t\t *\n\t\t * function SubClass(){\n\t\t *     this.name = \"小张\";\n\t\t * }\n\t\t *\n\t\t * UE.utils.inherits(SubClass,SuperClass);\n\t\t *\n\t\t * var sub = new SubClass();\n\t\t * //output: '小张早上好!\n\t\t * sub.hello(\"早上好!\");\n\t\t * ```\n\t\t */\n\t\tinherits: function(subClass, superClass) {\n\t\t\tvar oldP = subClass.prototype,\n\t\t\t\tnewP = utils.makeInstance(superClass.prototype);\n\t\t\tutils.extend(newP, oldP, true);\n\t\t\tsubClass.prototype = newP;\n\t\t\treturn (newP.constructor = subClass);\n\t\t},\n\n\t\t/**\n\t\t * 用指定的context对象作为函数fn的上下文\n\t\t * @method bind\n\t\t * @param { Function } fn 需要绑定上下文的函数对象\n\t\t * @param { Object } content 函数fn新的上下文对象\n\t\t * @return { Function } 一个新的函数， 该函数作为原始函数fn的代理， 将完成fn的上下文调换工作。\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var name = 'window',\n\t\t *     newTest = null;\n\t\t *\n\t\t * function test () {\n\t\t *     console.log( this.name );\n\t\t * }\n\t\t *\n\t\t * newTest = UE.utils.bind( test, { name: 'object' } );\n\t\t *\n\t\t * //output: object\n\t\t * newTest();\n\t\t *\n\t\t * //output: window\n\t\t * test();\n\t\t *\n\t\t * ```\n\t\t */\n\t\tbind: function(fn, context) {\n\t\t\treturn function() {\n\t\t\t\treturn fn.apply(context, arguments);\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * 创建延迟指定时间后执行的函数fn\n\t\t * @method defer\n\t\t * @param { Function } fn 需要延迟执行的函数对象\n\t\t * @param { int } delay 延迟的时间， 单位是毫秒\n\t\t * @warning 该方法的时间控制是不精确的，仅仅只能保证函数的执行是在给定的时间之后，\n\t\t *           而不能保证刚好到达延迟时间时执行。\n\t\t * @return { Function } 目标函数fn的代理函数， 只有执行该函数才能起到延时效果\n\t\t * @example\n\t\t * ```javascript\n\t\t * var start = 0;\n\t\t *\n\t\t * function test(){\n\t\t *     console.log( new Date() - start );\n\t\t * }\n\t\t *\n\t\t * var testDefer = UE.utils.defer( test, 1000 );\n\t\t * //\n\t\t * start = new Date();\n\t\t * //output: (大约在1000毫秒之后输出) 1000\n\t\t * testDefer();\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 创建延迟指定时间后执行的函数fn, 如果在延迟时间内再次执行该方法， 将会根据指定的exclusion的值，\n\t\t * 决定是否取消前一次函数的执行， 如果exclusion的值为true， 则取消执行，反之，将继续执行前一个方法。\n\t\t * @method defer\n\t\t * @param { Function } fn 需要延迟执行的函数对象\n\t\t * @param { int } delay 延迟的时间， 单位是毫秒\n\t\t * @param { Boolean } exclusion 如果在延迟时间内再次执行该函数，该值将决定是否取消执行前一次函数的执行，\n\t\t *                     值为true表示取消执行， 反之则将在执行前一次函数之后才执行本次函数调用。\n\t\t * @warning 该方法的时间控制是不精确的，仅仅只能保证函数的执行是在给定的时间之后，\n\t\t *           而不能保证刚好到达延迟时间时执行。\n\t\t * @return { Function } 目标函数fn的代理函数， 只有执行该函数才能起到延时效果\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * function test(){\n\t\t *     console.log(1);\n\t\t * }\n\t\t *\n\t\t * var testDefer = UE.utils.defer( test, 1000, true );\n\t\t *\n\t\t * //output: (两次调用仅有一次输出) 1\n\t\t * testDefer();\n\t\t * testDefer();\n\t\t * ```\n\t\t */\n\t\tdefer: function(fn, delay, exclusion) {\n\t\t\tvar timerID;\n\t\t\treturn function() {\n\t\t\t\tif (exclusion) {\n\t\t\t\t\tclearTimeout(timerID);\n\t\t\t\t}\n\t\t\t\ttimerID = setTimeout(fn, delay);\n\t\t\t};\n\t\t},\n\n\t\t/**\n\t\t * 获取元素item在数组array中首次出现的位置, 如果未找到item， 则返回-1\n\t\t * @method indexOf\n\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t * @param { Array } array 需要查找的数组对象\n\t\t * @param { * } item 需要在目标数组中查找的值\n\t\t * @return { int } 返回item在目标数组array中首次出现的位置， 如果在数组中未找到item， 则返回-1\n\t\t * @example\n\t\t * ```javascript\n\t\t * var item = 1,\n\t\t *     arr = [ 3, 4, 6, 8, 1, 1, 2 ];\n\t\t *\n\t\t * //output: 4\n\t\t * console.log( UE.utils.indexOf( arr, item ) );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 获取元素item数组array中首次出现的位置, 如果未找到item， 则返回-1。通过start的值可以指定搜索的起始位置。\n\t\t * @method indexOf\n\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t * @param { Array } array 需要查找的数组对象\n\t\t * @param { * } item 需要在目标数组中查找的值\n\t\t * @param { int } start 搜索的起始位置\n\t\t * @return { int } 返回item在目标数组array中的start位置之后首次出现的位置， 如果在数组中未找到item， 则返回-1\n\t\t * @example\n\t\t * ```javascript\n\t\t * var item = 1,\n\t\t *     arr = [ 3, 4, 6, 8, 1, 2, 8, 3, 2, 1, 1, 4 ];\n\t\t *\n\t\t * //output: 9\n\t\t * console.log( UE.utils.indexOf( arr, item, 5 ) );\n\t\t * ```\n\t\t */\n\t\tindexOf: function(array, item, start) {\n\t\t\tvar index = -1;\n\t\t\tstart = this.isNumber(start) ? start : 0;\n\t\t\tthis.each(array, function(v, i) {\n\t\t\t\tif (i >= start && v === item) {\n\t\t\t\t\tindex = i;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn index;\n\t\t},\n\n\t\t/**\n\t\t * 移除数组array中所有的元素item\n\t\t * @method removeItem\n\t\t * @param { Array } array 要移除元素的目标数组\n\t\t * @param { * } item 将要被移除的元素\n\t\t * @remind 该方法的匹配过程使用的是恒等“===”\n\t\t * @example\n\t\t * ```javascript\n\t\t * var arr = [ 4, 5, 7, 1, 3, 4, 6 ];\n\t\t *\n\t\t * UE.utils.removeItem( arr, 4 );\n\t\t * //output: [ 5, 7, 1, 3, 6 ]\n\t\t * console.log( arr );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tremoveItem: function(array, item) {\n\t\t\tfor (var i = 0, l = array.length; i < l; i++) {\n\t\t\t\tif (array[i] === item) {\n\t\t\t\t\tarray.splice(i, 1);\n\t\t\t\t\ti--;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 删除字符串str的首尾空格\n\t\t * @method trim\n\t\t * @param { String } str 需要删除首尾空格的字符串\n\t\t * @return { String } 删除了首尾的空格后的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var str = \" UEdtior \";\n\t\t *\n\t\t * //output: 9\n\t\t * console.log( str.length );\n\t\t *\n\t\t * //output: 7\n\t\t * console.log( UE.utils.trim( \" UEdtior \" ).length );\n\t\t *\n\t\t * //output: 9\n\t\t * console.log( str.length );\n\t\t *\n\t\t *  ```\n\t\t */\n\t\ttrim: function(str) {\n\t\t\treturn str.replace(/(^[ \\t\\n\\r]+)|([ \\t\\n\\r]+$)/g, '');\n\t\t},\n\n\t\t/**\n\t\t * 将字符串str以','分隔成数组后，将该数组转换成哈希对象， 其生成的hash对象的key为数组中的元素， value为1\n\t\t * @method listToMap\n\t\t * @warning 该方法在生成的hash对象中，会为每一个key同时生成一个另一个全大写的key。\n\t\t * @param { String } str 该字符串将被以','分割为数组， 然后进行转化\n\t\t * @return { Object } 转化之后的hash对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: Object {UEdtior: 1, UEDTIOR: 1, Hello: 1, HELLO: 1}\n\t\t * console.log( UE.utils.listToMap( 'UEdtior,Hello' ) );\n\t\t *\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 将字符串数组转换成哈希对象， 其生成的hash对象的key为数组中的元素， value为1\n\t\t * @method listToMap\n\t\t * @warning 该方法在生成的hash对象中，会为每一个key同时生成一个另一个全大写的key。\n\t\t * @param { Array } arr 字符串数组\n\t\t * @return { Object } 转化之后的hash对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: Object {UEdtior: 1, UEDTIOR: 1, Hello: 1, HELLO: 1}\n\t\t * console.log( UE.utils.listToMap( [ 'UEdtior', 'Hello' ] ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tlistToMap: function(list) {\n\t\t\tif (!list) return {};\n\t\t\tlist = utils.isArray(list) ? list : list.split(',');\n\t\t\tfor (var i = 0, ci, obj = {}; ci = list[i++];) {\n\t\t\t\tobj[ci.toUpperCase()] = obj[ci] = 1;\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\n\t\t/**\n\t\t * 将str中的html符号转义,将转义“'，&，<，\"，>”五个字符\n\t\t * @method unhtml\n\t\t * @param { String } str 需要转义的字符串\n\t\t * @return { String } 转义后的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * var html = '<body>&</body>';\n\t\t *\n\t\t * //output: &lt;body&gt;&amp;&lt;/body&gt;\n\t\t * console.log( UE.utils.unhtml( html ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tunhtml: function(str, reg) {\n\t\t\treturn str ? str.replace(reg || /[&<\">'](?:(amp|lt|quot|gt|#39|nbsp|#\\d+);)?/g, function(a, b) {\n\t\t\t\tif (b) {\n\t\t\t\t\treturn a;\n\t\t\t\t} else {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'<': '&lt;',\n\t\t\t\t\t\t'&': '&amp;',\n\t\t\t\t\t\t'\"': '&quot;',\n\t\t\t\t\t\t'>': '&gt;',\n\t\t\t\t\t\t\"'\": '&#39;'\n\t\t\t\t\t}[a]\n\t\t\t\t}\n\n\t\t\t}) : '';\n\t\t},\n\t\t/**\n\t\t * 将url中的html字符转义， 仅转义  ', \", <, > 四个字符\n\t\t * @param  { String } str 需要转义的字符串\n\t\t * @param  { RegExp } reg 自定义的正则\n\t\t * @return { String }     转义后的字符串\n\t\t */\n\t\tunhtmlForUrl: function(str, reg) {\n\t\t\treturn str ? str.replace(reg || /[<\">']/g, function(a) {\n\t\t\t\treturn {\n\t\t\t\t\t'<': '&lt;',\n\t\t\t\t\t'&': '&amp;',\n\t\t\t\t\t'\"': '&quot;',\n\t\t\t\t\t'>': '&gt;',\n\t\t\t\t\t\"'\": '&#39;'\n\t\t\t\t}[a]\n\n\t\t\t}) : '';\n\t\t},\n\n\t\t/**\n\t\t * 将str中的转义字符还原成html字符\n\t\t * @see UE.utils.unhtml(String);\n\t\t * @method html\n\t\t * @param { String } str 需要逆转义的字符串\n\t\t * @return { String } 逆转义后的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var str = '&lt;body&gt;&amp;&lt;/body&gt;';\n\t\t *\n\t\t * //output: <body>&</body>\n\t\t * console.log( UE.utils.html( str ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\thtml: function(str) {\n\t\t\treturn str ? str.replace(/&((g|l|quo)t|amp|#39|nbsp);/g, function(m) {\n\t\t\t\treturn {\n\t\t\t\t\t'&lt;': '<',\n\t\t\t\t\t'&amp;': '&',\n\t\t\t\t\t'&quot;': '\"',\n\t\t\t\t\t'&gt;': '>',\n\t\t\t\t\t'&#39;': \"'\",\n\t\t\t\t\t'&nbsp;': ' '\n\t\t\t\t}[m]\n\t\t\t}) : '';\n\t\t},\n\n\t\t/**\n\t\t * 将css样式转换为驼峰的形式\n\t\t * @method cssStyleToDomStyle\n\t\t * @param { String } cssName 需要转换的css样式名\n\t\t * @return { String } 转换成驼峰形式后的css样式名\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var str = 'border-top';\n\t\t *\n\t\t * //output: borderTop\n\t\t * console.log( UE.utils.cssStyleToDomStyle( str ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tcssStyleToDomStyle: function() {\n\t\t\tvar test = document.createElement('div').style,\n\t\t\t\tcache = {\n\t\t\t\t\t'float': test.cssFloat != undefined ? 'cssFloat' : test.styleFloat != undefined ? 'styleFloat' : 'float'\n\t\t\t\t};\n\n\t\t\treturn function(cssName) {\n\t\t\t\treturn cache[cssName] || (cache[cssName] = cssName.toLowerCase().replace(/-./g, function(match) {\n\t\t\t\t\treturn match.charAt(1).toUpperCase();\n\t\t\t\t}));\n\t\t\t};\n\t\t}(),\n\n\t\t/**\n\t\t * 动态加载文件到doc中\n\t\t * @method loadFile\n\t\t * @param { DomDocument } document 需要加载资源文件的文档对象\n\t\t * @param { Object } options 加载资源文件的属性集合， 取值请参考代码示例\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * UE.utils.loadFile( document, {\n\t\t *     src:\"test.js\",\n\t\t *     tag:\"script\",\n\t\t *     type:\"text/javascript\",\n\t\t *     defer:\"defer\"\n\t\t * } );\n\t\t *\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 动态加载文件到doc中，加载成功后执行的回调函数fn\n\t\t * @method loadFile\n\t\t * @param { DomDocument } document 需要加载资源文件的文档对象\n\t\t * @param { Object } options 加载资源文件的属性集合， 该集合支持的值是script标签和style标签支持的所有属性。\n\t\t * @param { Function } fn 资源文件加载成功之后执行的回调\n\t\t * @warning 对于在同一个文档中多次加载同一URL的文件， 该方法会在第一次加载之后缓存该请求，\n\t\t *           在此之后的所有同一URL的请求， 将会直接触发回调。\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * UE.utils.loadFile( document, {\n\t\t *     src:\"test.js\",\n\t\t *     tag:\"script\",\n\t\t *     type:\"text/javascript\",\n\t\t *     defer:\"defer\"\n\t\t * }, function () {\n\t\t *     console.log('加载成功');\n\t\t * } );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tloadFile: function() {\n\t\t\tvar tmpList = [];\n\n\t\t\tfunction getItem(doc, obj) {\n\t\t\t\ttry {\n\t\t\t\t\tfor (var i = 0, ci; ci = tmpList[i++];) {\n\t\t\t\t\t\tif (ci.doc === doc && ci.url == (obj.src || obj.href)) {\n\t\t\t\t\t\t\treturn ci;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn function(doc, obj, fn) {\n\t\t\t\tvar item = getItem(doc, obj);\n\t\t\t\tif (item) {\n\t\t\t\t\tif (item.ready) {\n\t\t\t\t\t\tfn && fn();\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.funs.push(fn)\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttmpList.push({\n\t\t\t\t\tdoc: doc,\n\t\t\t\t\turl: obj.src || obj.href,\n\t\t\t\t\tfuns: [fn]\n\t\t\t\t});\n\t\t\t\tif (!doc.body) {\n\t\t\t\t\tvar html = [];\n\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\tif (p == 'tag') continue;\n\t\t\t\t\t\thtml.push(p + '=\"' + obj[p] + '\"')\n\t\t\t\t\t}\n\t\t\t\t\tdoc.write('<' + obj.tag + ' ' + html.join(' ') + ' ></' + obj.tag + '>');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (obj.id && doc.getElementById(obj.id)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar element = doc.createElement(obj.tag);\n\t\t\t\tdelete obj.tag;\n\t\t\t\tfor (var p in obj) {\n\t\t\t\t\telement.setAttribute(p, obj[p]);\n\t\t\t\t}\n\t\t\t\telement.onload = element.onreadystatechange = function() {\n\t\t\t\t\tif (!this.readyState || /loaded|complete/.test(this.readyState)) {\n\t\t\t\t\t\titem = getItem(doc, obj);\n\t\t\t\t\t\tif (item.funs.length > 0) {\n\t\t\t\t\t\t\titem.ready = 1;\n\t\t\t\t\t\t\tfor (var fi; fi = item.funs.pop();) {\n\t\t\t\t\t\t\t\tfi();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telement.onload = element.onreadystatechange = null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\telement.onerror = function() {\n\t\t\t\t\tthrow Error('The load ' + (obj.href || obj.src) + ' fails,check the url settings of file ueditor.config.js ')\n\t\t\t\t};\n\t\t\t\tdoc.getElementsByTagName(\"head\")[0].appendChild(element);\n\t\t\t}\n\t\t}(),\n\n\t\t/**\n\t\t * 判断obj对象是否为空\n\t\t * @method isEmptyObject\n\t\t * @param { * } obj 需要判断的对象\n\t\t * @remind 如果判断的对象是NULL， 将直接返回true， 如果是数组且为空， 返回true， 如果是字符串， 且字符串为空，\n\t\t *          返回true， 如果是普通对象， 且该对象没有任何实例属性， 返回true\n\t\t * @return { Boolean } 对象是否为空\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.utils.isEmptyObject( {} ) );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.utils.isEmptyObject( [] ) );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.utils.isEmptyObject( \"\" ) );\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.utils.isEmptyObject( { key: 1 } ) );\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.utils.isEmptyObject( [1] ) );\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.utils.isEmptyObject( \"1\" ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tisEmptyObject: function(obj) {\n\t\t\tif (obj == null) return true;\n\t\t\tif (this.isArray(obj) || this.isString(obj)) return obj.length === 0;\n\t\t\tfor (var key in obj)\n\t\t\t\tif (obj.hasOwnProperty(key)) return false;\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * 把rgb格式的颜色值转换成16进制格式\n\t\t * @method fixColor\n\t\t * @param { String } rgb格式的颜色值\n\t\t * @param { String }\n\t\t * @example\n\t\t * rgb(255,255,255)  => \"#ffffff\"\n\t\t */\n\t\tfixColor: function(name, value) {\n\t\t\tif (/color/i.test(name) && /rgba?/.test(value)) {\n\t\t\t\tvar array = value.split(\",\");\n\t\t\t\tif (array.length > 3)\n\t\t\t\t\treturn \"\";\n\t\t\t\tvalue = \"#\";\n\t\t\t\tfor (var i = 0, color; color = array[i++];) {\n\t\t\t\t\tcolor = parseInt(color.replace(/[^\\d]/gi, ''), 10).toString(16);\n\t\t\t\t\tvalue += color.length == 1 ? \"0\" + color : color;\n\t\t\t\t}\n\t\t\t\tvalue = value.toUpperCase();\n\t\t\t}\n\t\t\treturn value;\n\t\t},\n\t\t/**\n\t\t * 只针对border,padding,margin做了处理，因为性能问题\n\t\t * @public\n\t\t * @function\n\t\t * @param {String}    val style字符串\n\t\t */\n\t\toptCss: function(val) {\n\t\t\tvar padding, margin, border;\n\t\t\tval = val.replace(/(padding|margin|border)\\-([^:]+):([^;]+);?/gi, function(str, key, name, val) {\n\t\t\t\tif (val.split(' ').length == 1) {\n\t\t\t\t\tswitch (key) {\n\t\t\t\t\t\tcase 'padding':\n\t\t\t\t\t\t\t!padding && (padding = {});\n\t\t\t\t\t\t\tpadding[name] = val;\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\tcase 'margin':\n\t\t\t\t\t\t\t!margin && (margin = {});\n\t\t\t\t\t\t\tmargin[name] = val;\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\tcase 'border':\n\t\t\t\t\t\t\treturn val == 'initial' ? '' : str;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn str;\n\t\t\t});\n\n\t\t\tfunction opt(obj, name) {\n\t\t\t\tif (!obj) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tvar t = obj.top,\n\t\t\t\t\tb = obj.bottom,\n\t\t\t\t\tl = obj.left,\n\t\t\t\t\tr = obj.right,\n\t\t\t\t\tval = '';\n\t\t\t\tif (!t || !l || !b || !r) {\n\t\t\t\t\tfor (var p in obj) {\n\t\t\t\t\t\tval += ';' + name + '-' + p + ':' + obj[p] + ';';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tval += ';' + name + ':' +\n\t\t\t\t\t\t(t == b && b == l && l == r ? t :\n\t\t\t\t\t\t\tt == b && l == r ? (t + ' ' + l) :\n\t\t\t\t\t\t\tl == r ? (t + ' ' + l + ' ' + b) : (t + ' ' + r + ' ' + b + ' ' + l)) + ';'\n\t\t\t\t}\n\t\t\t\treturn val;\n\t\t\t}\n\n\t\t\tval += opt(padding, 'padding') + opt(margin, 'margin');\n\t\t\treturn val.replace(/^[ \\n\\r\\t;]*|[ \\n\\r\\t]*$/, '').replace(/;([ \\n\\r\\t]+)|\\1;/g, ';')\n\t\t\t\t.replace(/(&((l|g)t|quot|#39))?;{2,}/g, function(a, b) {\n\t\t\t\t\treturn b ? b + \";;\" : ';'\n\t\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * 克隆对象\n\t\t * @method clone\n\t\t * @param { Object } source 源对象\n\t\t * @return { Object } source的一个副本\n\t\t */\n\n\t\t/**\n\t\t * 深度克隆对象，将source的属性克隆到target对象， 会覆盖target重名的属性。\n\t\t * @method clone\n\t\t * @param { Object } source 源对象\n\t\t * @param { Object } target 目标对象\n\t\t * @return { Object } 附加了source对象所有属性的target对象\n\t\t */\n\t\tclone: function(source, target) {\n\t\t\tvar tmp;\n\t\t\ttarget = target || {};\n\t\t\tfor (var i in source) {\n\t\t\t\tif (source.hasOwnProperty(i)) {\n\t\t\t\t\ttmp = source[i];\n\t\t\t\t\tif (typeof tmp == 'object') {\n\t\t\t\t\t\ttarget[i] = utils.isArray(tmp) ? [] : {};\n\t\t\t\t\t\tutils.clone(source[i], target[i])\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttarget[i] = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn target;\n\t\t},\n\n\t\t/**\n\t\t * 把cm／pt为单位的值转换为px为单位的值\n\t\t * @method transUnitToPx\n\t\t * @param { String } 待转换的带单位的字符串\n\t\t * @return { String } 转换为px为计量单位的值的字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //output: 500px\n\t\t * console.log( UE.utils.transUnitToPx( '20cm' ) );\n\t\t *\n\t\t * //output: 27px\n\t\t * console.log( UE.utils.transUnitToPx( '20pt' ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\ttransUnitToPx: function(val) {\n\t\t\tif (!/(pt|cm)/.test(val)) {\n\t\t\t\treturn val\n\t\t\t}\n\t\t\tvar unit;\n\t\t\tval.replace(/([\\d.]+)(\\w+)/, function(str, v, u) {\n\t\t\t\tval = v;\n\t\t\t\tunit = u;\n\t\t\t});\n\t\t\tswitch (unit) {\n\t\t\t\tcase 'cm':\n\t\t\t\t\tval = parseFloat(val) * 25;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pt':\n\t\t\t\t\tval = Math.round(parseFloat(val) * 96 / 72);\n\t\t\t}\n\t\t\treturn val + (val ? 'px' : '');\n\t\t},\n\n\t\t/**\n\t\t * 在dom树ready之后执行给定的回调函数\n\t\t * @method domReady\n\t\t * @remind 如果在执行该方法的时候， dom树已经ready， 那么回调函数将立刻执行\n\t\t * @param { Function } fn dom树ready之后的回调函数\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * UE.utils.domReady( function () {\n\t\t *\n\t\t *     console.log('123');\n\t\t *\n\t\t * } );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tdomReady: function() {\n\n\t\t\tvar fnArr = [];\n\n\t\t\tfunction doReady(doc) {\n\t\t\t\t//确保onready只执行一次\n\t\t\t\tdoc.isReady = true;\n\t\t\t\tfor (var ci; ci = fnArr.pop(); ci()) {}\n\t\t\t}\n\n\t\t\treturn function(onready, win) {\n\t\t\t\twin = win || window;\n\t\t\t\tvar doc = win.document;\n\t\t\t\tonready && fnArr.push(onready);\n\t\t\t\tif (doc.readyState === \"complete\") {\n\t\t\t\t\tdoReady(doc);\n\t\t\t\t} else {\n\t\t\t\t\tdoc.isReady && doReady(doc);\n\t\t\t\t\tif (browser.ie && browser.version != 11) {\n\t\t\t\t\t\t(function() {\n\t\t\t\t\t\t\tif (doc.isReady) return;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tdoc.documentElement.doScroll(\"left\");\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\tsetTimeout(arguments.callee, 0);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdoReady(doc);\n\t\t\t\t\t\t})();\n\t\t\t\t\t\twin.attachEvent('onload', function() {\n\t\t\t\t\t\t\tdoReady(doc)\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdoc.addEventListener(\"DOMContentLoaded\", function() {\n\t\t\t\t\t\t\tdoc.removeEventListener(\"DOMContentLoaded\", arguments.callee, false);\n\t\t\t\t\t\t\tdoReady(doc);\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t\twin.addEventListener('load', function() {\n\t\t\t\t\t\t\tdoReady(doc)\n\t\t\t\t\t\t}, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}(),\n\n\t\t/**\n\t\t * 动态添加css样式\n\t\t * @method cssRule\n\t\t * @param { String } 节点名称\n\t\t * @grammar UE.utils.cssRule('添加的样式的节点名称',['样式'，'放到哪个document上'])\n\t\t * @grammar UE.utils.cssRule('body','body{background:#ccc}') => null  //给body添加背景颜色\n\t\t * @grammar UE.utils.cssRule('body') =>样式的字符串  //取得key值为body的样式的内容,如果没有找到key值先关的样式将返回空，例如刚才那个背景颜色，将返回 body{background:#ccc}\n\t\t * @grammar UE.utils.cssRule('body',document) => 返回指定key的样式，并且指定是哪个document\n\t\t * @grammar UE.utils.cssRule('body','') =>null //清空给定的key值的背景颜色\n\t\t */\n\t\tcssRule: browser.ie && browser.version != 11 ? function(key, style, doc) {\n\t\t\tvar indexList, index;\n\t\t\tif (style === undefined || style && style.nodeType && style.nodeType == 9) {\n\t\t\t\t//获取样式\n\t\t\t\tdoc = style && style.nodeType && style.nodeType == 9 ? style : (doc || document);\n\t\t\t\tindexList = doc.indexList || (doc.indexList = {});\n\t\t\t\tindex = indexList[key];\n\t\t\t\tif (index !== undefined) {\n\t\t\t\t\treturn doc.styleSheets[index].cssText\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tdoc = doc || document;\n\t\t\tindexList = doc.indexList || (doc.indexList = {});\n\t\t\tindex = indexList[key];\n\t\t\t//清除样式\n\t\t\tif (style === '') {\n\t\t\t\tif (index !== undefined) {\n\t\t\t\t\tdoc.styleSheets[index].cssText = '';\n\t\t\t\t\tdelete indexList[key];\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//添加样式\n\t\t\tif (index !== undefined) {\n\t\t\t\tsheetStyle = doc.styleSheets[index];\n\t\t\t} else {\n\t\t\t\tsheetStyle = doc.createStyleSheet('', index = doc.styleSheets.length);\n\t\t\t\tindexList[key] = index;\n\t\t\t}\n\t\t\tsheetStyle.cssText = style;\n\t\t} : function(key, style, doc) {\n\t\t\tvar head, node;\n\t\t\tif (style === undefined || style && style.nodeType && style.nodeType == 9) {\n\t\t\t\t//获取样式\n\t\t\t\tdoc = style && style.nodeType && style.nodeType == 9 ? style : (doc || document);\n\t\t\t\tnode = doc.getElementById(key);\n\t\t\t\treturn node ? node.innerHTML : undefined;\n\t\t\t}\n\t\t\tdoc = doc || document;\n\t\t\tnode = doc.getElementById(key);\n\n\t\t\t//清除样式\n\t\t\tif (style === '') {\n\t\t\t\tif (node) {\n\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//添加样式\n\t\t\tif (node) {\n\t\t\t\tnode.innerHTML = style;\n\t\t\t} else {\n\t\t\t\tnode = doc.createElement('style');\n\t\t\t\tnode.id = key;\n\t\t\t\tnode.innerHTML = style;\n\t\t\t\tdoc.getElementsByTagName('head')[0].appendChild(node);\n\t\t\t}\n\t\t},\n\t\tsort: function(array, compareFn) {\n\t\t\tcompareFn = compareFn || function(item1, item2) {\n\t\t\t\treturn item1.localeCompare(item2);\n\t\t\t};\n\t\t\tfor (var i = 0, len = array.length; i < len; i++) {\n\t\t\t\tfor (var j = i, length = array.length; j < length; j++) {\n\t\t\t\t\tif (compareFn(array[i], array[j]) > 0) {\n\t\t\t\t\t\tvar t = array[i];\n\t\t\t\t\t\tarray[i] = array[j];\n\t\t\t\t\t\tarray[j] = t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn array;\n\t\t},\n\t\tserializeParam: function(json) {\n\t\t\tvar strArr = [];\n\t\t\tfor (var i in json) {\n\t\t\t\t//忽略默认的几个参数\n\t\t\t\tif (i == \"method\" || i == \"timeout\" || i == \"async\") continue;\n\t\t\t\t//传递过来的对象和函数不在提交之列\n\t\t\t\tif (!((typeof json[i]).toLowerCase() == \"function\" || (typeof json[i]).toLowerCase() == \"object\")) {\n\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"=\" + encodeURIComponent(json[i]));\n\t\t\t\t} else if (utils.isArray(json[i])) {\n\t\t\t\t\t//支持传数组内容\n\t\t\t\t\tfor (var j = 0; j < json[i].length; j++) {\n\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"[]=\" + encodeURIComponent(json[i][j]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn strArr.join(\"&\");\n\t\t},\n\t\tformatUrl: function(url) {\n\t\t\tvar u = url.replace(/&&/g, '&');\n\t\t\tu = u.replace(/\\?&/g, '?');\n\t\t\tu = u.replace(/&$/g, '');\n\t\t\tu = u.replace(/&#/g, '#');\n\t\t\tu = u.replace(/&+/g, '&');\n\t\t\treturn u;\n\t\t},\n\t\tisCrossDomainUrl: function(url) {\n\t\t\tvar a = document.createElement('a');\n\t\t\ta.href = url;\n\t\t\tif (browser.ie) {\n\t\t\t\ta.href = a.href;\n\t\t\t}\n\t\t\treturn !(a.protocol == location.protocol && a.hostname == location.hostname &&\n\t\t\t\t(a.port == location.port || (a.port == '80' && location.port == '') || (a.port == '' && location.port == '80')));\n\t\t},\n\t\tclearEmptyAttrs: function(obj) {\n\t\t\tfor (var p in obj) {\n\t\t\t\tif (obj[p] === '') {\n\t\t\t\t\tdelete obj[p]\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn obj;\n\t\t},\n\t\tstr2json: function(s) {\n\n\t\t\tif (!utils.isString(s)) return null;\n\t\t\tif (window.JSON) {\n\t\t\t\treturn JSON.parse(s);\n\t\t\t} else {\n\t\t\t\treturn (new Function(\"return \" + utils.trim(s || '')))();\n\t\t\t}\n\n\t\t},\n\t\tjson2str: (function() {\n\n\t\t\tif (window.JSON) {\n\n\t\t\t\treturn JSON.stringify;\n\n\t\t\t} else {\n\n\t\t\t\tvar escapeMap = {\n\t\t\t\t\t\"\\b\": '\\\\b',\n\t\t\t\t\t\"\\t\": '\\\\t',\n\t\t\t\t\t\"\\n\": '\\\\n',\n\t\t\t\t\t\"\\f\": '\\\\f',\n\t\t\t\t\t\"\\r\": '\\\\r',\n\t\t\t\t\t'\"': '\\\\\"',\n\t\t\t\t\t\"\\\\\": '\\\\\\\\'\n\t\t\t\t};\n\n\t\t\t\tfunction encodeString(source) {\n\t\t\t\t\tif (/[\"\\\\\\x00-\\x1f]/.test(source)) {\n\t\t\t\t\t\tsource = source.replace(\n\t\t\t\t\t\t\t/[\"\\\\\\x00-\\x1f]/g,\n\t\t\t\t\t\t\tfunction(match) {\n\t\t\t\t\t\t\t\tvar c = escapeMap[match];\n\t\t\t\t\t\t\t\tif (c) {\n\t\t\t\t\t\t\t\t\treturn c;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tc = match.charCodeAt();\n\t\t\t\t\t\t\t\treturn \"\\\\u00\" + Math.floor(c / 16).toString(16) + (c % 16).toString(16);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn '\"' + source + '\"';\n\t\t\t\t}\n\n\t\t\t\tfunction encodeArray(source) {\n\t\t\t\t\tvar result = [\"[\"],\n\t\t\t\t\t\tl = source.length,\n\t\t\t\t\t\tpreComma, i, item;\n\n\t\t\t\t\tfor (i = 0; i < l; i++) {\n\t\t\t\t\t\titem = source[i];\n\n\t\t\t\t\t\tswitch (typeof item) {\n\t\t\t\t\t\t\tcase \"undefined\":\n\t\t\t\t\t\t\tcase \"function\":\n\t\t\t\t\t\t\tcase \"unknown\":\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tif (preComma) {\n\t\t\t\t\t\t\t\t\tresult.push(',');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresult.push(utils.json2str(item));\n\t\t\t\t\t\t\t\tpreComma = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresult.push(\"]\");\n\t\t\t\t\treturn result.join(\"\");\n\t\t\t\t}\n\n\t\t\t\tfunction pad(source) {\n\t\t\t\t\treturn source < 10 ? '0' + source : source;\n\t\t\t\t}\n\n\t\t\t\tfunction encodeDate(source) {\n\t\t\t\t\treturn '\"' + source.getFullYear() + \"-\" + pad(source.getMonth() + 1) + \"-\" + pad(source.getDate()) + \"T\" + pad(source.getHours()) + \":\" + pad(source.getMinutes()) + \":\" + pad(source.getSeconds()) + '\"';\n\t\t\t\t}\n\n\t\t\t\treturn function(value) {\n\t\t\t\t\tswitch (typeof value) {\n\t\t\t\t\t\tcase 'undefined':\n\t\t\t\t\t\t\treturn 'undefined';\n\n\t\t\t\t\t\tcase 'number':\n\t\t\t\t\t\t\treturn isFinite(value) ? String(value) : \"null\";\n\n\t\t\t\t\t\tcase 'string':\n\t\t\t\t\t\t\treturn encodeString(value);\n\n\t\t\t\t\t\tcase 'boolean':\n\t\t\t\t\t\t\treturn String(value);\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif (value === null) {\n\t\t\t\t\t\t\t\treturn 'null';\n\t\t\t\t\t\t\t} else if (utils.isArray(value)) {\n\t\t\t\t\t\t\t\treturn encodeArray(value);\n\t\t\t\t\t\t\t} else if (utils.isDate(value)) {\n\t\t\t\t\t\t\t\treturn encodeDate(value);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar result = ['{'],\n\t\t\t\t\t\t\t\t\tencode = utils.json2str,\n\t\t\t\t\t\t\t\t\tpreComma,\n\t\t\t\t\t\t\t\t\titem;\n\n\t\t\t\t\t\t\t\tfor (var key in value) {\n\t\t\t\t\t\t\t\t\tif (Object.prototype.hasOwnProperty.call(value, key)) {\n\t\t\t\t\t\t\t\t\t\titem = value[key];\n\t\t\t\t\t\t\t\t\t\tswitch (typeof item) {\n\t\t\t\t\t\t\t\t\t\t\tcase 'undefined':\n\t\t\t\t\t\t\t\t\t\t\tcase 'unknown':\n\t\t\t\t\t\t\t\t\t\t\tcase 'function':\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\tif (preComma) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tresult.push(',');\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tpreComma = 1;\n\t\t\t\t\t\t\t\t\t\t\t\tresult.push(encode(key) + ':' + encode(item));\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresult.push('}');\n\t\t\t\t\t\t\t\treturn result.join('');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t})()\n\n\t};\n\t/**\n\t * 判断给定的对象是否是字符串\n\t * @method isString\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是字符串\n\t */\n\n\t/**\n\t * 判断给定的对象是否是数组\n\t * @method isArray\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是数组\n\t */\n\n\t/**\n\t * 判断给定的对象是否是一个Function\n\t * @method isFunction\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是Function\n\t */\n\n\t/**\n\t * 判断给定的对象是否是Number\n\t * @method isNumber\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是Number\n\t */\n\n\t/**\n\t * 判断给定的对象是否是一个正则表达式\n\t * @method isRegExp\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是正则表达式\n\t */\n\n\t/**\n\t * 判断给定的对象是否是一个普通对象\n\t * @method isObject\n\t * @param { * } object 需要判断的对象\n\t * @return { Boolean } 给定的对象是否是普通对象\n\t */\n\tutils.each(['String', 'Function', 'Array', 'Number', 'RegExp', 'Object', 'Date'], function(v) {\n\t\tUE.utils['is' + v] = function(obj) {\n\t\t\treturn Object.prototype.toString.apply(obj) == '[object ' + v + ']';\n\t\t}\n\t});\n\n\t// core/EventBase.js\n\t/**\n\t * UE采用的事件基类\n\t * @file\n\t * @module UE\n\t * @class EventBase\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t/**\n\t * UE采用的事件基类，继承此类的对应类将获取addListener,removeListener,fireEvent方法。\n\t * 在UE中，Editor以及所有ui实例都继承了该类，故可以在对应的ui对象以及editor对象上使用上述方法。\n\t * @unfile\n\t * @module UE\n\t * @class EventBase\n\t */\n\n\t/**\n\t * 通过此构造器，子类可以继承EventBase获取事件监听的方法\n\t * @constructor\n\t * @example\n\t * ```javascript\n\t * UE.EventBase.call(editor);\n\t * ```\n\t */\n\tvar EventBase = UE.EventBase = function() {};\n\n\tEventBase.prototype = {\n\n\t\t/**\n\t\t * 注册事件监听器\n\t\t * @method addListener\n\t\t * @param { String } types 监听的事件名称，同时监听多个事件使用空格分隔\n\t\t * @param { Function } fn 监听的事件被触发时，会执行该回调函数\n\t\t * @waining 事件被触发时，监听的函数假如返回的值恒等于true，回调函数的队列中后面的函数将不执行\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.addListener('selectionchange',function(){\n\t\t *      console.log(\"选区已经变化！\");\n\t\t * })\n\t\t * editor.addListener('beforegetcontent aftergetcontent',function(type){\n\t\t *         if(type == 'beforegetcontent'){\n\t\t *             //do something\n\t\t *         }else{\n\t\t *             //do something\n\t\t *         }\n\t\t *         console.log(this.getContent) // this是注册的事件的编辑器实例\n\t\t * })\n\t\t * ```\n\t\t * @see UE.EventBase:fireEvent(String)\n\t\t */\n\t\taddListener: function(types, listener) {\n\t\t\ttypes = utils.trim(types).split(/\\s+/);\n\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\tgetListener(this, ti, true).push(listener);\n\t\t\t}\n\t\t},\n\n\t\ton: function(types, listener) {\n\t\t\treturn this.addListener(types, listener);\n\t\t},\n\t\toff: function(types, listener) {\n\t\t\treturn this.removeListener(types, listener)\n\t\t},\n\t\ttrigger: function() {\n\t\t\treturn this.fireEvent.apply(this, arguments);\n\t\t},\n\t\t/**\n\t\t * 移除事件监听器\n\t\t * @method removeListener\n\t\t * @param { String } types 移除的事件名称，同时移除多个事件使用空格分隔\n\t\t * @param { Function } fn 移除监听事件的函数引用\n\t\t * @example\n\t\t * ```javascript\n\t\t * //changeCallback为方法体\n\t\t * editor.removeListener(\"selectionchange\",changeCallback);\n\t\t * ```\n\t\t */\n\t\tremoveListener: function(types, listener) {\n\t\t\ttypes = utils.trim(types).split(/\\s+/);\n\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\tutils.removeItem(getListener(this, ti) || [], listener);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 触发事件\n\t\t * @method fireEvent\n\t\t * @param { String } types 触发的事件名称，同时触发多个事件使用空格分隔\n\t\t * @remind 该方法会触发addListener\n\t\t * @return { * } 返回触发事件的队列中，最后执行的回调函数的返回值\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.fireEvent(\"selectionchange\");\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 触发事件\n\t\t * @method fireEvent\n\t\t * @param { String } types 触发的事件名称，同时触发多个事件使用空格分隔\n\t\t * @param { *... } options 可选参数，可以传入一个或多个参数，会传给事件触发的回调函数\n\t\t * @return { * } 返回触发事件的队列中，最后执行的回调函数的返回值\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * editor.addListener( \"selectionchange\", function ( type, arg1, arg2 ) {\n\t\t *\n\t\t *     console.log( arg1 + \" \" + arg2 );\n\t\t *\n\t\t * } );\n\t\t *\n\t\t * //触发selectionchange事件， 会执行上面的事件监听器\n\t\t * //output: Hello World\n\t\t * editor.fireEvent(\"selectionchange\", \"Hello\", \"World\");\n\t\t * ```\n\t\t */\n\t\tfireEvent: function() {\n\t\t\tvar types = arguments[0];\n\t\t\ttypes = utils.trim(types).split(' ');\n\t\t\tfor (var i = 0, ti; ti = types[i++];) {\n\t\t\t\tvar listeners = getListener(this, ti),\n\t\t\t\t\tr, t, k;\n\t\t\t\tif (listeners) {\n\t\t\t\t\tk = listeners.length;\n\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\tif (!listeners[k]) continue;\n\t\t\t\t\t\tt = listeners[k].apply(this, arguments);\n\t\t\t\t\t\tif (t === true) {\n\t\t\t\t\t\t\treturn t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (t !== undefined) {\n\t\t\t\t\t\t\tr = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (t = this['on' + ti.toLowerCase()]) {\n\t\t\t\t\tr = t.apply(this, arguments);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\t};\n\t/**\n\t * 获得对象所拥有监听类型的所有监听器\n\t * @unfile\n\t * @module UE\n\t * @since 1.2.6.1\n\t * @method getListener\n\t * @public\n\t * @param { Object } obj  查询监听器的对象\n\t * @param { String } type 事件类型\n\t * @param { Boolean } force  为true且当前所有type类型的侦听器不存在时，创建一个空监听器数组\n\t * @return { Array } 监听器数组\n\t */\n\tfunction getListener(obj, type, force) {\n\t\tvar allListeners;\n\t\ttype = type.toLowerCase();\n\t\treturn ((allListeners = (obj.__allListeners || force && (obj.__allListeners = {}))) && (allListeners[type] || force && (allListeners[type] = [])));\n\t}\n\n\t// core/dtd.js\n\t///import editor.js\n\t///import core/dom/dom.js\n\t///import core/utils.js\n\t/**\n\t * dtd html语义化的体现类\n\t * @constructor\n\t * @namespace dtd\n\t */\n\tvar dtd = dom.dtd = (function() {\n\t\tfunction _(s) {\n\t\t\tfor (var k in s) {\n\t\t\t\ts[k.toUpperCase()] = s[k];\n\t\t\t}\n\t\t\treturn s;\n\t\t}\n\t\tvar X = utils.extend2;\n\t\tvar A = _({\n\t\t\t\tisindex: 1,\n\t\t\t\tfieldset: 1\n\t\t\t}),\n\t\t\tB = _({\n\t\t\t\tinput: 1,\n\t\t\t\tbutton: 1,\n\t\t\t\tselect: 1,\n\t\t\t\ttextarea: 1,\n\t\t\t\tlabel: 1\n\t\t\t}),\n\t\t\tC = X(_({\n\t\t\t\ta: 1\n\t\t\t}), B),\n\t\t\tD = X({\n\t\t\t\tiframe: 1\n\t\t\t}, C),\n\t\t\tE = _({\n\t\t\t\thr: 1,\n\t\t\t\tul: 1,\n\t\t\t\tmenu: 1,\n\t\t\t\tdiv: 1,\n\t\t\t\tblockquote: 1,\n\t\t\t\tnoscript: 1,\n\t\t\t\ttable: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\taddress: 1,\n\t\t\t\tdir: 1,\n\t\t\t\tpre: 1,\n\t\t\t\th5: 1,\n\t\t\t\tdl: 1,\n\t\t\t\th4: 1,\n\t\t\t\tnoframes: 1,\n\t\t\t\th6: 1,\n\t\t\t\tol: 1,\n\t\t\t\th1: 1,\n\t\t\t\th3: 1,\n\t\t\t\th2: 1\n\t\t\t}),\n\t\t\tF = _({\n\t\t\t\tins: 1,\n\t\t\t\tdel: 1,\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1\n\t\t\t}),\n\t\t\tG = X(_({\n\t\t\t\tb: 1,\n\t\t\t\tacronym: 1,\n\t\t\t\tbdo: 1,\n\t\t\t\t'var': 1,\n\t\t\t\t'#': 1,\n\t\t\t\tabbr: 1,\n\t\t\t\tcode: 1,\n\t\t\t\tbr: 1,\n\t\t\t\ti: 1,\n\t\t\t\tcite: 1,\n\t\t\t\tkbd: 1,\n\t\t\t\tu: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\ts: 1,\n\t\t\t\ttt: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\tq: 1,\n\t\t\t\tsamp: 1,\n\t\t\t\tem: 1,\n\t\t\t\tdfn: 1,\n\t\t\t\tspan: 1\n\t\t\t}), F),\n\t\t\tH = X(_({\n\t\t\t\tsub: 1,\n\t\t\t\timg: 1,\n\t\t\t\tembed: 1,\n\t\t\t\tobject: 1,\n\t\t\t\tsup: 1,\n\t\t\t\tbasefont: 1,\n\t\t\t\tmap: 1,\n\t\t\t\tapplet: 1,\n\t\t\t\tfont: 1,\n\t\t\t\tbig: 1,\n\t\t\t\tsmall: 1\n\t\t\t}), G),\n\t\t\tI = X(_({\n\t\t\t\tp: 1\n\t\t\t}), H),\n\t\t\tJ = X(_({\n\t\t\t\tiframe: 1\n\t\t\t}), H, B),\n\t\t\tK = _({\n\t\t\t\timg: 1,\n\t\t\t\tembed: 1,\n\t\t\t\tnoscript: 1,\n\t\t\t\tbr: 1,\n\t\t\t\tkbd: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\tbutton: 1,\n\t\t\t\tbasefont: 1,\n\t\t\t\th5: 1,\n\t\t\t\th4: 1,\n\t\t\t\tsamp: 1,\n\t\t\t\th6: 1,\n\t\t\t\tol: 1,\n\t\t\t\th1: 1,\n\t\t\t\th3: 1,\n\t\t\t\th2: 1,\n\t\t\t\tform: 1,\n\t\t\t\tfont: 1,\n\t\t\t\t'#': 1,\n\t\t\t\tselect: 1,\n\t\t\t\tmenu: 1,\n\t\t\t\tins: 1,\n\t\t\t\tabbr: 1,\n\t\t\t\tlabel: 1,\n\t\t\t\tcode: 1,\n\t\t\t\ttable: 1,\n\t\t\t\tscript: 1,\n\t\t\t\tcite: 1,\n\t\t\t\tinput: 1,\n\t\t\t\tiframe: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\ttextarea: 1,\n\t\t\t\tnoframes: 1,\n\t\t\t\tbig: 1,\n\t\t\t\tsmall: 1,\n\t\t\t\tspan: 1,\n\t\t\t\thr: 1,\n\t\t\t\tsub: 1,\n\t\t\t\tbdo: 1,\n\t\t\t\t'var': 1,\n\t\t\t\tdiv: 1,\n\t\t\t\tobject: 1,\n\t\t\t\tsup: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\tdir: 1,\n\t\t\t\tmap: 1,\n\t\t\t\tdl: 1,\n\t\t\t\tapplet: 1,\n\t\t\t\tdel: 1,\n\t\t\t\tisindex: 1,\n\t\t\t\tfieldset: 1,\n\t\t\t\tul: 1,\n\t\t\t\tb: 1,\n\t\t\t\tacronym: 1,\n\t\t\t\ta: 1,\n\t\t\t\tblockquote: 1,\n\t\t\t\ti: 1,\n\t\t\t\tu: 1,\n\t\t\t\ts: 1,\n\t\t\t\ttt: 1,\n\t\t\t\taddress: 1,\n\t\t\t\tq: 1,\n\t\t\t\tpre: 1,\n\t\t\t\tp: 1,\n\t\t\t\tem: 1,\n\t\t\t\tdfn: 1\n\t\t\t}),\n\n\t\t\tL = X(_({\n\t\t\t\ta: 0\n\t\t\t}), J), //a不能被切开，所以把他\n\t\t\tM = _({\n\t\t\t\ttr: 1\n\t\t\t}),\n\t\t\tN = _({\n\t\t\t\t'#': 1\n\t\t\t}),\n\t\t\tO = X(_({\n\t\t\t\tparam: 1\n\t\t\t}), K),\n\t\t\tP = X(_({\n\t\t\t\tform: 1\n\t\t\t}), A, D, E, I),\n\t\t\tQ = _({\n\t\t\t\tli: 1,\n\t\t\t\tol: 1,\n\t\t\t\tul: 1\n\t\t\t}),\n\t\t\tR = _({\n\t\t\t\tstyle: 1,\n\t\t\t\tscript: 1\n\t\t\t}),\n\t\t\tS = _({\n\t\t\t\tbase: 1,\n\t\t\t\tlink: 1,\n\t\t\t\tmeta: 1,\n\t\t\t\ttitle: 1\n\t\t\t}),\n\t\t\tT = X(S, R),\n\t\t\tU = _({\n\t\t\t\thead: 1,\n\t\t\t\tbody: 1\n\t\t\t}),\n\t\t\tV = _({\n\t\t\t\thtml: 1\n\t\t\t});\n\n\t\tvar block = _({\n\t\t\t\taddress: 1,\n\t\t\t\tblockquote: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\tdir: 1,\n\t\t\t\tdiv: 1,\n\t\t\t\tdl: 1,\n\t\t\t\tfieldset: 1,\n\t\t\t\tform: 1,\n\t\t\t\th1: 1,\n\t\t\t\th2: 1,\n\t\t\t\th3: 1,\n\t\t\t\th4: 1,\n\t\t\t\th5: 1,\n\t\t\t\th6: 1,\n\t\t\t\thr: 1,\n\t\t\t\tisindex: 1,\n\t\t\t\tmenu: 1,\n\t\t\t\tnoframes: 1,\n\t\t\t\tol: 1,\n\t\t\t\tp: 1,\n\t\t\t\tpre: 1,\n\t\t\t\ttable: 1,\n\t\t\t\tul: 1\n\t\t\t}),\n\n\t\t\tempty = _({\n\t\t\t\tarea: 1,\n\t\t\t\tbase: 1,\n\t\t\t\tbasefont: 1,\n\t\t\t\tbr: 1,\n\t\t\t\tcol: 1,\n\t\t\t\tcommand: 1,\n\t\t\t\tdialog: 1,\n\t\t\t\tembed: 1,\n\t\t\t\thr: 1,\n\t\t\t\timg: 1,\n\t\t\t\tinput: 1,\n\t\t\t\tisindex: 1,\n\t\t\t\tkeygen: 1,\n\t\t\t\tlink: 1,\n\t\t\t\tmeta: 1,\n\t\t\t\tparam: 1,\n\t\t\t\tsource: 1,\n\t\t\t\ttrack: 1,\n\t\t\t\twbr: 1\n\t\t\t});\n\n\t\treturn _({\n\n\t\t\t// $ 表示自定的属性\n\n\t\t\t// body外的元素列表.\n\t\t\t$nonBodyContent: X(V, U, S),\n\n\t\t\t//块结构元素列表\n\t\t\t$block: block,\n\n\t\t\t//内联元素列表\n\t\t\t$inline: L,\n\n\t\t\t$inlineWithA: X(_({\n\t\t\t\ta: 1\n\t\t\t}), L),\n\n\t\t\t$body: X(_({\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1\n\t\t\t}), block),\n\n\t\t\t$cdata: _({\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1\n\t\t\t}),\n\n\t\t\t//自闭和元素\n\t\t\t$empty: empty,\n\n\t\t\t//不是自闭合，但不能让range选中里边\n\t\t\t$nonChild: _({\n\t\t\t\tiframe: 1,\n\t\t\t\ttextarea: 1\n\t\t\t}),\n\t\t\t//列表元素列表\n\t\t\t$listItem: _({\n\t\t\t\tdd: 1,\n\t\t\t\tdt: 1,\n\t\t\t\tli: 1\n\t\t\t}),\n\n\t\t\t//列表根元素列表\n\t\t\t$list: _({\n\t\t\t\tul: 1,\n\t\t\t\tol: 1,\n\t\t\t\tdl: 1\n\t\t\t}),\n\n\t\t\t//不能认为是空的元素\n\t\t\t$isNotEmpty: _({\n\t\t\t\ttable: 1,\n\t\t\t\tul: 1,\n\t\t\t\tol: 1,\n\t\t\t\tdl: 1,\n\t\t\t\tiframe: 1,\n\t\t\t\tarea: 1,\n\t\t\t\tbase: 1,\n\t\t\t\tcol: 1,\n\t\t\t\thr: 1,\n\t\t\t\timg: 1,\n\t\t\t\tembed: 1,\n\t\t\t\tinput: 1,\n\t\t\t\tlink: 1,\n\t\t\t\tmeta: 1,\n\t\t\t\tparam: 1,\n\t\t\t\th1: 1,\n\t\t\t\th2: 1,\n\t\t\t\th3: 1,\n\t\t\t\th4: 1,\n\t\t\t\th5: 1,\n\t\t\t\th6: 1\n\t\t\t}),\n\n\t\t\t//如果没有子节点就可以删除的元素列表，像span,a\n\t\t\t$removeEmpty: _({\n\t\t\t\ta: 1,\n\t\t\t\tabbr: 1,\n\t\t\t\tacronym: 1,\n\t\t\t\taddress: 1,\n\t\t\t\tb: 1,\n\t\t\t\tbdo: 1,\n\t\t\t\tbig: 1,\n\t\t\t\tcite: 1,\n\t\t\t\tcode: 1,\n\t\t\t\tdel: 1,\n\t\t\t\tdfn: 1,\n\t\t\t\tem: 1,\n\t\t\t\tfont: 1,\n\t\t\t\ti: 1,\n\t\t\t\tins: 1,\n\t\t\t\tlabel: 1,\n\t\t\t\tkbd: 1,\n\t\t\t\tq: 1,\n\t\t\t\ts: 1,\n\t\t\t\tsamp: 1,\n\t\t\t\tsmall: 1,\n\t\t\t\tspan: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\tsub: 1,\n\t\t\t\tsup: 1,\n\t\t\t\ttt: 1,\n\t\t\t\tu: 1,\n\t\t\t\t'var': 1\n\t\t\t}),\n\n\t\t\t$removeEmptyBlock: _({\n\t\t\t\t'p': 1,\n\t\t\t\t'div': 1\n\t\t\t}),\n\n\t\t\t//在table元素里的元素列表\n\t\t\t$tableContent: _({\n\t\t\t\tcaption: 1,\n\t\t\t\tcol: 1,\n\t\t\t\tcolgroup: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\ttd: 1,\n\t\t\t\ttfoot: 1,\n\t\t\t\tth: 1,\n\t\t\t\tthead: 1,\n\t\t\t\ttr: 1,\n\t\t\t\ttable: 1\n\t\t\t}),\n\t\t\t//不转换的标签\n\t\t\t$notTransContent: _({\n\t\t\t\tpre: 1,\n\t\t\t\tscript: 1,\n\t\t\t\tstyle: 1,\n\t\t\t\ttextarea: 1\n\t\t\t}),\n\t\t\thtml: U,\n\t\t\thead: T,\n\t\t\tstyle: N,\n\t\t\tscript: N,\n\t\t\tbody: P,\n\t\t\tbase: {},\n\t\t\tlink: {},\n\t\t\tmeta: {},\n\t\t\ttitle: N,\n\t\t\tcol: {},\n\t\t\ttr: _({\n\t\t\t\ttd: 1,\n\t\t\t\tth: 1\n\t\t\t}),\n\t\t\timg: {},\n\t\t\tembed: {},\n\t\t\tcolgroup: _({\n\t\t\t\tthead: 1,\n\t\t\t\tcol: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\ttr: 1,\n\t\t\t\ttfoot: 1\n\t\t\t}),\n\t\t\tnoscript: P,\n\t\t\ttd: P,\n\t\t\tbr: {},\n\t\t\tth: P,\n\t\t\tcenter: P,\n\t\t\tkbd: L,\n\t\t\tbutton: X(I, E),\n\t\t\tbasefont: {},\n\t\t\th5: L,\n\t\t\th4: L,\n\t\t\tsamp: L,\n\t\t\th6: L,\n\t\t\tol: Q,\n\t\t\th1: L,\n\t\t\th3: L,\n\t\t\toption: N,\n\t\t\th2: L,\n\t\t\tform: X(A, D, E, I),\n\t\t\tselect: _({\n\t\t\t\toptgroup: 1,\n\t\t\t\toption: 1\n\t\t\t}),\n\t\t\tfont: L,\n\t\t\tins: L,\n\t\t\tmenu: Q,\n\t\t\tabbr: L,\n\t\t\tlabel: L,\n\t\t\ttable: _({\n\t\t\t\tthead: 1,\n\t\t\t\tcol: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\ttr: 1,\n\t\t\t\tcolgroup: 1,\n\t\t\t\tcaption: 1,\n\t\t\t\ttfoot: 1\n\t\t\t}),\n\t\t\tcode: L,\n\t\t\ttfoot: M,\n\t\t\tcite: L,\n\t\t\tli: P,\n\t\t\tinput: {},\n\t\t\tiframe: P,\n\t\t\tstrong: L,\n\t\t\ttextarea: N,\n\t\t\tnoframes: P,\n\t\t\tbig: L,\n\t\t\tsmall: L,\n\t\t\t//trace:\n\t\t\tspan: _({\n\t\t\t\t'#': 1,\n\t\t\t\tbr: 1,\n\t\t\t\tb: 1,\n\t\t\t\tstrong: 1,\n\t\t\t\tu: 1,\n\t\t\t\ti: 1,\n\t\t\t\tem: 1,\n\t\t\t\tsub: 1,\n\t\t\t\tsup: 1,\n\t\t\t\tstrike: 1,\n\t\t\t\tspan: 1\n\t\t\t}),\n\t\t\thr: L,\n\t\t\tdt: L,\n\t\t\tsub: L,\n\t\t\toptgroup: _({\n\t\t\t\toption: 1\n\t\t\t}),\n\t\t\tparam: {},\n\t\t\tbdo: L,\n\t\t\t'var': L,\n\t\t\tdiv: P,\n\t\t\tobject: O,\n\t\t\tsup: L,\n\t\t\tdd: P,\n\t\t\tstrike: L,\n\t\t\tarea: {},\n\t\t\tdir: Q,\n\t\t\tmap: X(_({\n\t\t\t\tarea: 1,\n\t\t\t\tform: 1,\n\t\t\t\tp: 1\n\t\t\t}), A, F, E),\n\t\t\tapplet: O,\n\t\t\tdl: _({\n\t\t\t\tdt: 1,\n\t\t\t\tdd: 1\n\t\t\t}),\n\t\t\tdel: L,\n\t\t\tisindex: {},\n\t\t\tfieldset: X(_({\n\t\t\t\tlegend: 1\n\t\t\t}), K),\n\t\t\tthead: M,\n\t\t\tul: Q,\n\t\t\tacronym: L,\n\t\t\tb: L,\n\t\t\ta: X(_({\n\t\t\t\ta: 1\n\t\t\t}), J),\n\t\t\tblockquote: X(_({\n\t\t\t\ttd: 1,\n\t\t\t\ttr: 1,\n\t\t\t\ttbody: 1,\n\t\t\t\tli: 1\n\t\t\t}), P),\n\t\t\tcaption: L,\n\t\t\ti: L,\n\t\t\tu: L,\n\t\t\ttbody: M,\n\t\t\ts: L,\n\t\t\taddress: X(D, I),\n\t\t\ttt: L,\n\t\t\tlegend: L,\n\t\t\tq: L,\n\t\t\tpre: X(G, C),\n\t\t\tp: X(_({\n\t\t\t\t'a': 1\n\t\t\t}), L),\n\t\t\tem: L,\n\t\t\tdfn: L\n\t\t});\n\t})();\n\n\t// core/domUtils.js\n\t/**\n\t * Dom操作工具包\n\t * @file\n\t * @module UE.dom.domUtils\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * Dom操作工具包\n\t * @unfile\n\t * @module UE.dom.domUtils\n\t */\n\tfunction getDomNode(node, start, ltr, startFromChild, fn, guard) {\n\t\tvar tmpNode = startFromChild && node[start],\n\t\t\tparent;\n\t\t!tmpNode && (tmpNode = node[ltr]);\n\t\twhile (!tmpNode && (parent = (parent || node).parentNode)) {\n\t\t\tif (parent.tagName == 'BODY' || guard && !guard(parent)) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\ttmpNode = parent[ltr];\n\t\t}\n\t\tif (tmpNode && fn && !fn(tmpNode)) {\n\t\t\treturn getDomNode(tmpNode, start, ltr, false, fn);\n\t\t}\n\t\treturn tmpNode;\n\t}\n\tvar attrFix = ie && browser.version < 9 ? {\n\t\t\ttabindex: \"tabIndex\",\n\t\t\treadonly: \"readOnly\",\n\t\t\t\"for\": \"htmlFor\",\n\t\t\t\"class\": \"className\",\n\t\t\tmaxlength: \"maxLength\",\n\t\t\tcellspacing: \"cellSpacing\",\n\t\t\tcellpadding: \"cellPadding\",\n\t\t\trowspan: \"rowSpan\",\n\t\t\tcolspan: \"colSpan\",\n\t\t\tusemap: \"useMap\",\n\t\t\tframeborder: \"frameBorder\"\n\t\t} : {\n\t\t\ttabindex: \"tabIndex\",\n\t\t\treadonly: \"readOnly\"\n\t\t},\n\t\tstyleBlock = utils.listToMap([\n\t\t\t'-webkit-box', '-moz-box', 'block',\n\t\t\t'list-item', 'table', 'table-row-group',\n\t\t\t'table-header-group', 'table-footer-group',\n\t\t\t'table-row', 'table-column-group', 'table-column',\n\t\t\t'table-cell', 'table-caption'\n\t\t]);\n\tvar domUtils = dom.domUtils = {\n\t\t//节点常量\n\t\tNODE_ELEMENT: 1,\n\t\tNODE_DOCUMENT: 9,\n\t\tNODE_TEXT: 3,\n\t\tNODE_COMMENT: 8,\n\t\tNODE_DOCUMENT_FRAGMENT: 11,\n\n\t\t//位置关系\n\t\tPOSITION_IDENTICAL: 0,\n\t\tPOSITION_DISCONNECTED: 1,\n\t\tPOSITION_FOLLOWING: 2,\n\t\tPOSITION_PRECEDING: 4,\n\t\tPOSITION_IS_CONTAINED: 8,\n\t\tPOSITION_CONTAINS: 16,\n\t\t//ie6使用其他的会有一段空白出现\n\t\tfillChar: ie && browser.version == '6' ? '\\ufeff' : '\\u200B',\n\t\t//-------------------------Node部分--------------------------------\n\t\tkeys: {\n\t\t\t/*Backspace*/\n\t\t\t8: 1,\n\t\t\t/*Delete*/ 46: 1,\n\t\t\t/*Shift*/\n\t\t\t16: 1,\n\t\t\t/*Ctrl*/ 17: 1,\n\t\t\t/*Alt*/ 18: 1,\n\t\t\t37: 1,\n\t\t\t38: 1,\n\t\t\t39: 1,\n\t\t\t40: 1,\n\t\t\t13: 1 /*enter*/\n\t\t},\n\t\t/**\n\t\t * 获取节点A相对于节点B的位置关系\n\t\t * @method getPosition\n\t\t * @param { Node } nodeA 需要查询位置关系的节点A\n\t\t * @param { Node } nodeB 需要查询位置关系的节点B\n\t\t * @return { Number } 节点A与节点B的关系\n\t\t * @example\n\t\t * ```javascript\n\t\t * //output: 20\n\t\t * var position = UE.dom.domUtils.getPosition( document.documentElement, document.body );\n\t\t *\n\t\t * switch ( position ) {\n\t\t *\n\t\t *      //0\n\t\t *      case UE.dom.domUtils.POSITION_IDENTICAL:\n\t\t *          console.log('元素相同');\n\t\t *          break;\n\t\t *      //1\n\t\t *      case UE.dom.domUtils.POSITION_DISCONNECTED:\n\t\t *          console.log('两个节点在不同的文档中');\n\t\t *          break;\n\t\t *      //2\n\t\t *      case UE.dom.domUtils.POSITION_FOLLOWING:\n\t\t *          console.log('节点A在节点B之后');\n\t\t *          break;\n\t\t *      //4\n\t\t *      case UE.dom.domUtils.POSITION_PRECEDING;\n\t\t *          console.log('节点A在节点B之前');\n\t\t *          break;\n\t\t *      //8\n\t\t *      case UE.dom.domUtils.POSITION_IS_CONTAINED:\n\t\t *          console.log('节点A被节点B包含');\n\t\t *          break;\n\t\t *      case 10:\n\t\t *          console.log('节点A被节点B包含且节点A在节点B之后');\n\t\t *          break;\n\t\t *      //16\n\t\t *      case UE.dom.domUtils.POSITION_CONTAINS:\n\t\t *          console.log('节点A包含节点B');\n\t\t *          break;\n\t\t *      case 20:\n\t\t *          console.log('节点A包含节点B且节点A在节点B之前');\n\t\t *          break;\n\t\t *\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tgetPosition: function(nodeA, nodeB) {\n\t\t\t// 如果两个节点是同一个节点\n\t\t\tif (nodeA === nodeB) {\n\t\t\t\t// domUtils.POSITION_IDENTICAL\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tvar node,\n\t\t\t\tparentsA = [nodeA],\n\t\t\t\tparentsB = [nodeB];\n\t\t\tnode = nodeA;\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\t// 如果nodeB是nodeA的祖先节点\n\t\t\t\tif (node === nodeB) {\n\t\t\t\t\t// domUtils.POSITION_IS_CONTAINED + domUtils.POSITION_FOLLOWING\n\t\t\t\t\treturn 10;\n\t\t\t\t}\n\t\t\t\tparentsA.push(node);\n\t\t\t}\n\t\t\tnode = nodeB;\n\t\t\twhile (node = node.parentNode) {\n\t\t\t\t// 如果nodeA是nodeB的祖先节点\n\t\t\t\tif (node === nodeA) {\n\t\t\t\t\t// domUtils.POSITION_CONTAINS + domUtils.POSITION_PRECEDING\n\t\t\t\t\treturn 20;\n\t\t\t\t}\n\t\t\t\tparentsB.push(node);\n\t\t\t}\n\t\t\tparentsA.reverse();\n\t\t\tparentsB.reverse();\n\t\t\tif (parentsA[0] !== parentsB[0]) {\n\t\t\t\t// domUtils.POSITION_DISCONNECTED\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\tvar i = -1;\n\t\t\twhile (i++, parentsA[i] === parentsB[i]) {}\n\t\t\tnodeA = parentsA[i];\n\t\t\tnodeB = parentsB[i];\n\t\t\twhile (nodeA = nodeA.nextSibling) {\n\t\t\t\tif (nodeA === nodeB) {\n\t\t\t\t\t// domUtils.POSITION_PRECEDING\n\t\t\t\t\treturn 4\n\t\t\t\t}\n\t\t\t}\n\t\t\t// domUtils.POSITION_FOLLOWING\n\t\t\treturn 2;\n\t\t},\n\n\t\t/**\n\t\t * 检测节点node在父节点中的索引位置\n\t\t * @method getNodeIndex\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Number } 该节点在父节点中的位置\n\t\t * @see UE.dom.domUtils.getNodeIndex(Node,Boolean)\n\t\t */\n\n\t\t/**\n\t\t * 检测节点node在父节点中的索引位置， 根据给定的mergeTextNode参数决定是否要合并多个连续的文本节点为一个节点\n\t\t * @method getNodeIndex\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @param { Boolean } mergeTextNode 是否合并多个连续的文本节点为一个节点\n\t\t * @return { Number } 该节点在父节点中的位置\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t *      var node = document.createElement(\"div\");\n\t\t *\n\t\t *      node.appendChild( document.createTextNode( \"hello\" ) );\n\t\t *      node.appendChild( document.createTextNode( \"world\" ) );\n\t\t *      node.appendChild( node = document.createElement( \"div\" ) );\n\t\t *\n\t\t *      //output: 2\n\t\t *      console.log( UE.dom.domUtils.getNodeIndex( node ) );\n\t\t *\n\t\t *      //output: 1\n\t\t *      console.log( UE.dom.domUtils.getNodeIndex( node, true ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tgetNodeIndex: function(node, ignoreTextNode) {\n\t\t\tvar preNode = node,\n\t\t\t\ti = 0;\n\t\t\twhile (preNode = preNode.previousSibling) {\n\t\t\t\tif (ignoreTextNode && preNode.nodeType == 3) {\n\t\t\t\t\tif (preNode.nodeType != preNode.nextSibling.nodeType) {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t}\n\t\t\treturn i;\n\t\t},\n\n\t\t/**\n\t\t * 检测节点node是否在给定的document对象上\n\t\t * @method inDoc\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @param { DomDocument } doc 需要检测的document对象\n\t\t * @return { Boolean } 该节点node是否在给定的document的dom树上\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var node = document.createElement(\"div\");\n\t\t *\n\t\t * //output: false\n\t\t * console.log( UE.do.domUtils.inDoc( node, document ) );\n\t\t *\n\t\t * document.body.appendChild( node );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( UE.do.domUtils.inDoc( node, document ) );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tinDoc: function(node, doc) {\n\t\t\treturn domUtils.getPosition(node, doc) == 10;\n\t\t},\n\t\t/**\n\t\t * 根据给定的过滤规则filterFn， 查找符合该过滤规则的node节点的第一个祖先节点，\n\t\t * 查找的起点是给定node节点的父节点。\n\t\t * @method findParent\n\t\t * @param { Node } node 需要查找的节点\n\t\t * @param { Function } filterFn 自定义的过滤方法。\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @remind 自定义的过滤方法filterFn接受一个Node对象作为参数， 该对象代表当前执行检测的祖先节点。 如果该\n\t\t *          节点满足过滤条件， 则要求返回true， 这时将直接返回该节点作为findParent()的结果， 否则， 请返回false。\n\t\t * @return { Node | Null } 如果找到符合过滤条件的节点， 就返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var filterNode = UE.dom.domUtils.findParent( document.body.firstChild, function ( node ) {\n\t\t *\n\t\t *     //由于查找的终点是body节点， 所以永远也不会匹配当前过滤器的条件， 即这里永远会返回false\n\t\t *     return node.tagName === \"HTML\";\n\t\t *\n\t\t * } );\n\t\t *\n\t\t * //output: true\n\t\t * console.log( filterNode === null );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 根据给定的过滤规则filterFn， 查找符合该过滤规则的node节点的第一个祖先节点，\n\t\t * 如果includeSelf的值为true，则查找的起点是给定的节点node， 否则， 起点是node的父节点\n\t\t * @method findParent\n\t\t * @param { Node } node 需要查找的节点\n\t\t * @param { Function } filterFn 自定义的过滤方法。\n\t\t * @param { Boolean } includeSelf 查找过程是否包含自身\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @remind 自定义的过滤方法filterFn接受一个Node对象作为参数， 该对象代表当前执行检测的祖先节点。 如果该\n\t\t *          节点满足过滤条件， 则要求返回true， 这时将直接返回该节点作为findParent()的结果， 否则， 请返回false。\n\t\t * @remind 如果includeSelf为true， 则过滤器第一次执行时的参数会是节点本身。\n\t\t *          反之， 过滤器第一次执行时的参数将是该节点的父节点。\n\t\t * @return { Node | Null } 如果找到符合过滤条件的节点， 就返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```html\n\t\t * <body>\n\t\t *\n\t\t *      <div id=\"test\">\n\t\t *      </div>\n\t\t *\n\t\t *      <script type=\"text/javascript\">\n\t\t *\n\t\t *          //output: DIV, BODY\n\t\t *          var filterNode = UE.dom.domUtils.findParent( document.getElementById( \"test\" ), function ( node ) {\n\t\t *\n\t\t *              console.log( node.tagName );\n\t\t *              return false;\n\t\t *\n\t\t *          }, true );\n\t\t *\n\t\t *      </script>\n\t\t * </body>\n\t\t * ```\n\t\t */\n\t\tfindParent: function(node, filterFn, includeSelf) {\n\t\t\tif (node && !domUtils.isBody(node)) {\n\t\t\t\tnode = includeSelf ? node : node.parentNode;\n\t\t\t\twhile (node) {\n\t\t\t\t\tif (!filterFn || filterFn(node) || domUtils.isBody(node)) {\n\t\t\t\t\t\treturn filterFn && !filterFn(node) && domUtils.isBody(node) ? null : node;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\t/**\n\t\t * 查找node的节点名为tagName的第一个祖先节点， 查找的起点是node节点的父节点。\n\t\t * @method findParentByTagName\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @param { Array } tagNames 需要查找的父节点的名称数组\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @return { Node | NULL } 如果找到符合条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var node = UE.dom.domUtils.findParentByTagName( document.getElementsByTagName(\"div\")[0], [ \"BODY\" ] );\n\t\t * //output: BODY\n\t\t * console.log( node.tagName );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查找node的节点名为tagName的祖先节点， 如果includeSelf的值为true，则查找的起点是给定的节点node，\n\t\t * 否则， 起点是node的父节点。\n\t\t * @method findParentByTagName\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @param { Array } tagNames 需要查找的父节点的名称数组\n\t\t * @param { Boolean } includeSelf 查找过程是否包含node节点自身\n\t\t * @warning 查找的终点是到body节点为止\n\t\t * @return { Node | NULL } 如果找到符合条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var queryTarget = document.getElementsByTagName(\"div\")[0];\n\t\t * var node = UE.dom.domUtils.findParentByTagName( queryTarget, [ \"DIV\" ], true );\n\t\t * //output: true\n\t\t * console.log( queryTarget === node );\n\t\t * ```\n\t\t */\n\t\tfindParentByTagName: function(node, tagNames, includeSelf, excludeFn) {\n\t\t\ttagNames = utils.listToMap(utils.isArray(tagNames) ? tagNames : [tagNames]);\n\t\t\treturn domUtils.findParent(node, function(node) {\n\t\t\t\treturn tagNames[node.tagName] && !(excludeFn && excludeFn(node));\n\t\t\t}, includeSelf);\n\t\t},\n\t\t/**\n\t\t * 查找节点node的祖先节点集合， 查找的起点是给定节点的父节点，结果集中不包含给定的节点。\n\t\t * @method findParents\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @return { Array } 给定节点的祖先节点数组\n\t\t * @grammar UE.dom.domUtils.findParents(node)  => Array  //返回一个祖先节点数组集合，不包含自身\n\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf)  => Array  //返回一个祖先节点数组集合，includeSelf指定是否包含自身\n\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf,filterFn)  => Array  //返回一个祖先节点数组集合，filterFn指定过滤条件，返回true的node将被选取\n\t\t * @grammar UE.dom.domUtils.findParents(node,includeSelf,filterFn,closerFirst)  => Array  //返回一个祖先节点数组集合，closerFirst为true的话，node的直接父亲节点是数组的第0个\n\t\t */\n\n\t\t/**\n\t\t * 查找节点node的祖先节点集合， 如果includeSelf的值为true，\n\t\t * 则返回的结果集中允许出现当前给定的节点， 否则， 该节点不会出现在其结果集中。\n\t\t * @method findParents\n\t\t * @param { Node } node 需要查找的节点对象\n\t\t * @param { Boolean } includeSelf 查找的结果中是否允许包含当前查找的节点对象\n\t\t * @return { Array } 给定节点的祖先节点数组\n\t\t */\n\t\tfindParents: function(node, includeSelf, filterFn, closerFirst) {\n\t\t\tvar parents = includeSelf && (filterFn && filterFn(node) || !filterFn) ? [node] : [];\n\t\t\twhile (node = domUtils.findParent(node, filterFn)) {\n\t\t\t\tparents.push(node);\n\t\t\t}\n\t\t\treturn closerFirst ? parents : parents.reverse();\n\t\t},\n\n\t\t/**\n\t\t * 在节点node后面插入新节点newNode\n\t\t * @method insertAfter\n\t\t * @param { Node } node 目标节点\n\t\t * @param { Node } newNode 新插入的节点， 该节点将置于目标节点之后\n\t\t * @return { Node } 新插入的节点\n\t\t */\n\t\tinsertAfter: function(node, newNode) {\n\t\t\treturn node.nextSibling ? node.parentNode.insertBefore(newNode, node.nextSibling) :\n\t\t\t\tnode.parentNode.appendChild(newNode);\n\t\t},\n\n\t\t/**\n\t\t * 删除节点node及其下属的所有节点\n\t\t * @method remove\n\t\t * @param { Node } node 需要删除的节点对象\n\t\t * @return { Node } 返回刚删除的节点对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *     <div id=\"child\">你好</div>\n\t\t * </div>\n\t\t * <script>\n\t\t *     UE.dom.domUtils.remove( document.body, false );\n\t\t *     //output: false\n\t\t *     console.log( document.getElementById( \"child\" ) !== null );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 删除节点node，并根据keepChildren的值决定是否保留子节点\n\t\t * @method remove\n\t\t * @param { Node } node 需要删除的节点对象\n\t\t * @param { Boolean } keepChildren 是否需要保留子节点\n\t\t * @return { Node } 返回刚删除的节点对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *     <div id=\"child\">你好</div>\n\t\t * </div>\n\t\t * <script>\n\t\t *     UE.dom.domUtils.remove( document.body, true );\n\t\t *     //output: true\n\t\t *     console.log( document.getElementById( \"child\" ) !== null );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremove: function(node, keepChildren) {\n\t\t\tvar parent = node.parentNode,\n\t\t\t\tchild;\n\t\t\tif (parent) {\n\t\t\t\tif (keepChildren && node.hasChildNodes()) {\n\t\t\t\t\twhile (child = node.firstChild) {\n\t\t\t\t\t\tparent.insertBefore(child, node);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent.removeChild(node);\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\t/**\n\t\t * 取得node节点的下一个兄弟节点， 如果该节点其后没有兄弟节点， 则递归查找其父节点之后的第一个兄弟节点，\n\t\t * 直到找到满足条件的节点或者递归到BODY节点之后才会结束。\n\t\t * @method getNextDomNode\n\t\t * @param { Node } node 需要获取其后的兄弟节点的节点对象\n\t\t * @return { Node | NULL } 如果找满足条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```html\n\t\t *     <body>\n\t\t *      <div id=\"test\">\n\t\t *          <span></span>\n\t\t *      </div>\n\t\t *      <i>xxx</i>\n\t\t * </body>\n\t\t * <script>\n\t\t *\n\t\t *     //output: i节点\n\t\t *     console.log( UE.dom.domUtils.getNextDomNode( document.getElementById( \"test\" ) ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t * @example\n\t\t * ```html\n\t\t * <body>\n\t\t *      <div>\n\t\t *          <span></span>\n\t\t *          <i id=\"test\">xxx</i>\n\t\t *      </div>\n\t\t *      <b>xxx</b>\n\t\t * </body>\n\t\t * <script>\n\t\t *\n\t\t *     //由于id为test的i节点之后没有兄弟节点， 则查找其父节点（div）后面的兄弟节点\n\t\t *     //output: b节点\n\t\t *     console.log( UE.dom.domUtils.getNextDomNode( document.getElementById( \"test\" ) ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 取得node节点的下一个兄弟节点， 如果startFromChild的值为ture，则先获取其子节点，\n\t\t * 如果有子节点则直接返回第一个子节点；如果没有子节点或者startFromChild的值为false，\n\t\t * 则执行<a href=\"#UE.dom.domUtils.getNextDomNode(Node)\">getNextDomNode(Node node)</a>的查找过程。\n\t\t * @method getNextDomNode\n\t\t * @param { Node } node 需要获取其后的兄弟节点的节点对象\n\t\t * @param { Boolean } startFromChild 查找过程是否从其子节点开始\n\t\t * @return { Node | NULL } 如果找满足条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @see UE.dom.domUtils.getNextDomNode(Node)\n\t\t */\n\t\tgetNextDomNode: function(node, startFromChild, filterFn, guard) {\n\t\t\treturn getDomNode(node, 'firstChild', 'nextSibling', startFromChild, filterFn, guard);\n\t\t},\n\t\tgetPreDomNode: function(node, startFromChild, filterFn, guard) {\n\t\t\treturn getDomNode(node, 'lastChild', 'previousSibling', startFromChild, filterFn, guard);\n\t\t},\n\t\t/**\n\t\t * 检测节点node是否属是UEditor定义的bookmark节点\n\t\t * @method isBookmarkNode\n\t\t * @private\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 是否是bookmark节点\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"_baidu_bookmark_1\"></span>\n\t\t * <script>\n\t\t *      var bookmarkNode = document.getElementById(\"_baidu_bookmark_1\");\n\t\t *      //output: true\n\t\t *      console.log( UE.dom.domUtils.isBookmarkNode( bookmarkNode ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisBookmarkNode: function(node) {\n\t\t\treturn node.nodeType == 1 && node.id && /^_baidu_bookmark_/i.test(node.id);\n\t\t},\n\t\t/**\n\t\t * 获取节点node所属的window对象\n\t\t * @method  getWindow\n\t\t * @param { Node } node 节点对象\n\t\t * @return { Window } 当前节点所属的window对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * //output: true\n\t\t * console.log( UE.dom.domUtils.getWindow( document.body ) === window );\n\t\t * ```\n\t\t */\n\t\tgetWindow: function(node) {\n\t\t\tvar doc = node.ownerDocument || node;\n\t\t\treturn doc.defaultView || doc.parentWindow;\n\t\t},\n\t\t/**\n\t\t * 获取离nodeA与nodeB最近的公共的祖先节点\n\t\t * @method  getCommonAncestor\n\t\t * @param { Node } nodeA 第一个节点\n\t\t * @param { Node } nodeB 第二个节点\n\t\t * @remind 如果给定的两个节点是同一个节点， 将直接返回该节点。\n\t\t * @return { Node | NULL } 如果未找到公共节点， 返回NULL， 否则返回最近的公共祖先节点。\n\t\t * @example\n\t\t * ```javascript\n\t\t * var commonAncestor = UE.dom.domUtils.getCommonAncestor( document.body, document.body.firstChild );\n\t\t * //output: true\n\t\t * console.log( commonAncestor.tagName.toLowerCase() === 'body' );\n\t\t * ```\n\t\t */\n\t\tgetCommonAncestor: function(nodeA, nodeB) {\n\t\t\tif (nodeA === nodeB)\n\t\t\t\treturn nodeA;\n\t\t\tvar parentsA = [nodeA],\n\t\t\t\tparentsB = [nodeB],\n\t\t\t\tparent = nodeA,\n\t\t\t\ti = -1;\n\t\t\twhile (parent = parent.parentNode) {\n\t\t\t\tif (parent === nodeB) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparentsA.push(parent);\n\t\t\t}\n\t\t\tparent = nodeB;\n\t\t\twhile (parent = parent.parentNode) {\n\t\t\t\tif (parent === nodeA)\n\t\t\t\t\treturn parent;\n\t\t\t\tparentsB.push(parent);\n\t\t\t}\n\t\t\tparentsA.reverse();\n\t\t\tparentsB.reverse();\n\t\t\twhile (i++, parentsA[i] === parentsB[i]) {}\n\t\t\treturn i == 0 ? null : parentsA[i - 1];\n\n\t\t},\n\t\t/**\n\t\t * 清除node节点左右连续为空的兄弟inline节点\n\t\t * @method clearEmptySibling\n\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t * 则这些兄弟节点将被删除\n\t\t * @grammar UE.dom.domUtils.clearEmptySibling(node,ignoreNext)  //ignoreNext指定是否忽略右边空节点\n\t\t * @grammar UE.dom.domUtils.clearEmptySibling(node,ignoreNext,ignorePre)  //ignorePre指定是否忽略左边空节点\n\t\t * @example\n\t\t * ```html\n\t\t * <body>\n\t\t *     <div></div>\n\t\t *     <span id=\"test\"></span>\n\t\t *     <i></i>\n\t\t *     <b></b>\n\t\t *     <em>xxx</em>\n\t\t *     <span></span>\n\t\t * </body>\n\t\t * <script>\n\t\t *\n\t\t *      UE.dom.domUtils.clearEmptySibling( document.getElementById( \"test\" ) );\n\t\t *\n\t\t *      //output: <div></div><span id=\"test\"></span><em>xxx</em><span></span>\n\t\t *      console.log( document.body.innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 清除node节点左右连续为空的兄弟inline节点， 如果ignoreNext的值为true，\n\t\t * 则忽略对右边兄弟节点的操作。\n\t\t * @method clearEmptySibling\n\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t * @param { Boolean } ignoreNext 是否忽略忽略对右边的兄弟节点的操作\n\t\t * 则这些兄弟节点将被删除\n\t\t * @see UE.dom.domUtils.clearEmptySibling(Node)\n\t\t */\n\n\t\t/**\n\t\t * 清除node节点左右连续为空的兄弟inline节点， 如果ignoreNext的值为true，\n\t\t * 则忽略对右边兄弟节点的操作， 如果ignorePre的值为true，则忽略对左边兄弟节点的操作。\n\t\t * @method clearEmptySibling\n\t\t * @param { Node } node 执行的节点对象， 如果该节点的左右连续的兄弟节点是空的inline节点，\n\t\t * @param { Boolean } ignoreNext 是否忽略忽略对右边的兄弟节点的操作\n\t\t * @param { Boolean } ignorePre 是否忽略忽略对左边的兄弟节点的操作\n\t\t * 则这些兄弟节点将被删除\n\t\t * @see UE.dom.domUtils.clearEmptySibling(Node)\n\t\t */\n\t\tclearEmptySibling: function(node, ignoreNext, ignorePre) {\n\t\t\tfunction clear(next, dir) {\n\t\t\t\tvar tmpNode;\n\t\t\t\twhile (next && !domUtils.isBookmarkNode(next) && (domUtils.isEmptyInlineElement(next)\n\t\t\t\t\t\t//这里不能把空格算进来会吧空格干掉，出现文字间的空格丢掉了\n\t\t\t\t\t\t|| !new RegExp('[^\\t\\n\\r' + domUtils.fillChar + ']').test(next.nodeValue))) {\n\t\t\t\t\ttmpNode = next[dir];\n\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\tnext = tmpNode;\n\t\t\t\t}\n\t\t\t}!ignoreNext && clear(node.nextSibling, 'nextSibling');\n\t\t\t!ignorePre && clear(node.previousSibling, 'previousSibling');\n\t\t},\n\t\t/**\n\t\t * 将一个文本节点textNode拆分成两个文本节点，offset指定拆分位置\n\t\t * @method split\n\t\t * @param { Node } textNode 需要拆分的文本节点对象\n\t\t * @param { int } offset 需要拆分的位置， 位置计算从0开始\n\t\t * @return { Node } 拆分后形成的新节点\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">abcdef</div>\n\t\t * <script>\n\t\t *      var newNode = UE.dom.domUtils.split( document.getElementById( \"test\" ).firstChild, 3 );\n\t\t *      //output: def\n\t\t *      console.log( newNode.nodeValue );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsplit: function(node, offset) {\n\t\t\tvar doc = node.ownerDocument;\n\t\t\tif (browser.ie && offset == node.nodeValue.length) {\n\t\t\t\tvar next = doc.createTextNode('');\n\t\t\t\treturn domUtils.insertAfter(node, next);\n\t\t\t}\n\t\t\tvar retval = node.splitText(offset);\n\t\t\t//ie8下splitText不会跟新childNodes,我们手动触发他的更新\n\t\t\tif (browser.ie8) {\n\t\t\t\tvar tmpNode = doc.createTextNode('');\n\t\t\t\tdomUtils.insertAfter(retval, tmpNode);\n\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t}\n\t\t\treturn retval;\n\t\t},\n\n\t\t/**\n\t\t * 检测文本节点textNode是否为空节点（包括空格、换行、占位符等字符）\n\t\t * @method  isWhitespace\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 检测的节点是否为空\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *\n\t\t * </div>\n\t\t * <script>\n\t\t *      //output: true\n\t\t *      console.log( UE.dom.domUtils.isWhitespace( document.getElementById(\"test\").firstChild ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisWhitespace: function(node) {\n\t\t\treturn !new RegExp('[^ \\t\\n\\r' + domUtils.fillChar + ']').test(node.nodeValue);\n\t\t},\n\t\t/**\n\t\t * 获取元素element相对于viewport的位置坐标\n\t\t * @method getXY\n\t\t * @param { Node } element 需要计算位置的节点对象\n\t\t * @return { Object } 返回形如{x:left,y:top}的一个key-value映射对象， 其中键x代表水平偏移距离，\n\t\t *                          y代表垂直偏移距离。\n\t\t *\n\t\t * @example\n\t\t * ```javascript\n\t\t * var location = UE.dom.domUtils.getXY( document.getElementById(\"test\") );\n\t\t * //output: test的坐标为: 12, 24\n\t\t * console.log( 'test的坐标为： ', location.x, ',', location.y );\n\t\t * ```\n\t\t */\n\t\tgetXY: function(element) {\n\t\t\tvar x = 0,\n\t\t\t\ty = 0;\n\t\t\twhile (element.offsetParent) {\n\t\t\t\ty += element.offsetTop;\n\t\t\t\tx += element.offsetLeft;\n\t\t\t\telement = element.offsetParent;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t'x': x,\n\t\t\t\t'y': y\n\t\t\t};\n\t\t},\n\t\t/**\n\t\t * 为元素element绑定原生DOM事件，type为事件类型，handler为处理函数\n\t\t * @method on\n\t\t * @param { Node } element 需要绑定事件的节点对象\n\t\t * @param { String } type 绑定的事件类型\n\t\t * @param { Function } handler 事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.on(document.body,\"click\",function(e){\n\t\t *     //e为事件对象，this为被点击元素对戏那个\n\t\t * });\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 为元素element绑定原生DOM事件，type为事件类型，handler为处理函数\n\t\t * @method on\n\t\t * @param { Node } element 需要绑定事件的节点对象\n\t\t * @param { Array } type 绑定的事件类型数组\n\t\t * @param { Function } handler 事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.on(document.body,[\"click\",\"mousedown\"],function(evt){\n\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t * });\n\t\t * ```\n\t\t */\n\t\ton: function(element, type, handler) {\n\n\t\t\tvar types = utils.isArray(type) ? type : utils.trim(type).split(/\\s+/),\n\t\t\t\tk = types.length;\n\t\t\tif (k)\n\t\t\t\twhile (k--) {\n\t\t\t\t\ttype = types[k];\n\t\t\t\t\tif (element.addEventListener) {\n\t\t\t\t\t\telement.addEventListener(type, handler, false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!handler._d) {\n\t\t\t\t\t\t\thandler._d = {\n\t\t\t\t\t\t\t\tels: []\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar key = type + handler.toString(),\n\t\t\t\t\t\t\tindex = utils.indexOf(handler._d.els, element);\n\t\t\t\t\t\tif (!handler._d[key] || index == -1) {\n\t\t\t\t\t\t\tif (index == -1) {\n\t\t\t\t\t\t\t\thandler._d.els.push(element);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!handler._d[key]) {\n\t\t\t\t\t\t\t\thandler._d[key] = function(evt) {\n\t\t\t\t\t\t\t\t\treturn handler.call(evt.srcElement, evt || window.event);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\telement.attachEvent('on' + type, handler._d[key]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\telement = null;\n\t\t},\n\t\t/**\n\t\t * 解除DOM事件绑定\n\t\t * @method un\n\t\t * @param { Node } element 需要解除事件绑定的节点对象\n\t\t * @param { String } type 需要接触绑定的事件类型\n\t\t * @param { Function } handler 对应的事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.un(document.body,\"click\",function(evt){\n\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t * });\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 解除DOM事件绑定\n\t\t * @method un\n\t\t * @param { Node } element 需要解除事件绑定的节点对象\n\t\t * @param { Array } type 需要接触绑定的事件类型数组\n\t\t * @param { Function } handler 对应的事件处理器\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.un(document.body, [\"click\",\"mousedown\"],function(evt){\n\t\t *     //evt为事件对象，this为被点击元素对象\n\t\t * });\n\t\t * ```\n\t\t */\n\t\tun: function(element, type, handler) {\n\t\t\tvar types = utils.isArray(type) ? type : utils.trim(type).split(/\\s+/),\n\t\t\t\tk = types.length;\n\t\t\tif (k)\n\t\t\t\twhile (k--) {\n\t\t\t\t\ttype = types[k];\n\t\t\t\t\tif (element.removeEventListener) {\n\t\t\t\t\t\telement.removeEventListener(type, handler, false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar key = type + handler.toString();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\telement.detachEvent('on' + type, handler._d ? handler._d[key] : handler);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\tif (handler._d && handler._d[key]) {\n\t\t\t\t\t\t\tvar index = utils.indexOf(handler._d.els, element);\n\t\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\t\thandler._d.els.splice(index, 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thandler._d.els.length == 0 && delete handler._d[key];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 比较节点nodeA与节点nodeB是否具有相同的标签名、属性名以及属性值\n\t\t * @method  isSameElement\n\t\t * @param { Node } nodeA 需要比较的节点\n\t\t * @param { Node } nodeB 需要比较的节点\n\t\t * @return { Boolean } 两个节点是否具有相同的标签名、属性名以及属性值\n\t\t * @example\n\t\t * ```html\n\t\t * <span style=\"font-size:12px\">ssss</span>\n\t\t * <span style=\"font-size:12px\">bbbbb</span>\n\t\t * <span style=\"font-size:13px\">ssss</span>\n\t\t * <span style=\"font-size:14px\">bbbbb</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var nodes = document.getElementsByTagName( \"span\" );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isSameElement( nodes[0], nodes[1] ) );\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.isSameElement( nodes[2], nodes[3] ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisSameElement: function(nodeA, nodeB) {\n\t\t\tif (nodeA.tagName != nodeB.tagName) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar thisAttrs = nodeA.attributes,\n\t\t\t\totherAttrs = nodeB.attributes;\n\t\t\tif (!ie && thisAttrs.length != otherAttrs.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar attrA, attrB, al = 0,\n\t\t\t\tbl = 0;\n\t\t\tfor (var i = 0; attrA = thisAttrs[i++];) {\n\t\t\t\tif (attrA.nodeName == 'style') {\n\t\t\t\t\tif (attrA.specified) {\n\t\t\t\t\t\tal++;\n\t\t\t\t\t}\n\t\t\t\t\tif (domUtils.isSameStyle(nodeA, nodeB)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (ie) {\n\t\t\t\t\tif (attrA.specified) {\n\t\t\t\t\t\tal++;\n\t\t\t\t\t\tattrB = otherAttrs.getNamedItem(attrA.nodeName);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tattrB = nodeB.attributes[attrA.nodeName];\n\t\t\t\t}\n\t\t\t\tif (!attrB.specified || attrA.nodeValue != attrB.nodeValue) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// 有可能attrB的属性包含了attrA的属性之外还有自己的属性\n\t\t\tif (ie) {\n\t\t\t\tfor (i = 0; attrB = otherAttrs[i++];) {\n\t\t\t\t\tif (attrB.specified) {\n\t\t\t\t\t\tbl++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (al != bl) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t/**\n\t\t * 判断节点nodeA与节点nodeB的元素的style属性是否一致\n\t\t * @method isSameStyle\n\t\t * @param { Node } nodeA 需要比较的节点\n\t\t * @param { Node } nodeB 需要比较的节点\n\t\t * @return { Boolean } 两个节点是否具有相同的style属性值\n\t\t * @example\n\t\t * ```html\n\t\t * <span style=\"font-size:12px\">ssss</span>\n\t\t * <span style=\"font-size:12px\">bbbbb</span>\n\t\t * <span style=\"font-size:13px\">ssss</span>\n\t\t * <span style=\"font-size:14px\">bbbbb</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var nodes = document.getElementsByTagName( \"span\" );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isSameStyle( nodes[0], nodes[1] ) );\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.isSameStyle( nodes[2], nodes[3] ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisSameStyle: function(nodeA, nodeB) {\n\t\t\tvar styleA = nodeA.style.cssText.replace(/( ?; ?)/g, ';').replace(/( ?: ?)/g, ':'),\n\t\t\t\tstyleB = nodeB.style.cssText.replace(/( ?; ?)/g, ';').replace(/( ?: ?)/g, ':');\n\t\t\tif (browser.opera) {\n\t\t\t\tstyleA = nodeA.style;\n\t\t\t\tstyleB = nodeB.style;\n\t\t\t\tif (styleA.length != styleB.length)\n\t\t\t\t\treturn false;\n\t\t\t\tfor (var p in styleA) {\n\t\t\t\t\tif (/^(\\d+|csstext)$/i.test(p)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (styleA[p] != styleB[p]) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (!styleA || !styleB) {\n\t\t\t\treturn styleA == styleB;\n\t\t\t}\n\t\t\tstyleA = styleA.split(';');\n\t\t\tstyleB = styleB.split(';');\n\t\t\tif (styleA.length != styleB.length) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tfor (var i = 0, ci; ci = styleA[i++];) {\n\t\t\t\tif (utils.indexOf(styleB, ci) == -1) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\t/**\n\t\t * 检查节点node是否为block元素\n\t\t * @method isBlockElm\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 是否是block元素节点\n\t\t * @warning 该方法的判断规则如下： 如果该元素原本是block元素， 则不论该元素当前的css样式是什么都会返回true；\n\t\t *          否则，检测该元素的css样式， 如果该元素当前是block元素， 则返回true。 其余情况下都返回false。\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test1\" style=\"display: block\"></span>\n\t\t * <span id=\"test2\"></span>\n\t\t * <div id=\"test3\" style=\"display: inline\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test1\") ) );\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test2\") ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isBlockElm( document.getElementById(\"test3\") ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisBlockElm: function(node) {\n\t\t\treturn node.nodeType == 1 && (dtd.$block[node.tagName] || styleBlock[domUtils.getComputedStyle(node, 'display')]) && !dtd.$nonChild[node.tagName];\n\t\t},\n\t\t/**\n\t\t * 检测node节点是否为body节点\n\t\t * @method isBody\n\t\t * @param { Element } node 需要检测的dom元素\n\t\t * @return { Boolean } 给定的元素是否是body元素\n\t\t * @example\n\t\t * ```javascript\n\t\t * //output: true\n\t\t * console.log( UE.dom.domUtils.isBody( document.body ) );\n\t\t * ```\n\t\t */\n\t\tisBody: function(node) {\n\t\t\treturn node && node.nodeType == 1 && node.tagName.toLowerCase() == 'body';\n\t\t},\n\t\t/**\n\t\t * 以node节点为分界，将该节点的指定祖先节点parent拆分成两个独立的节点，\n\t\t * 拆分形成的两个节点之间是node节点\n\t\t * @method breakParent\n\t\t * @param { Node } node 作为分界的节点对象\n\t\t * @param { Node } parent 该节点必须是node节点的祖先节点， 且是block节点。\n\t\t * @return { Node } 给定的node分界节点\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t *      var node = document.createElement(\"span\"),\n\t\t *          wrapNode = document.createElement( \"div\" ),\n\t\t *          parent = document.createElement(\"p\");\n\t\t *\n\t\t *      parent.appendChild( node );\n\t\t *      wrapNode.appendChild( parent );\n\t\t *\n\t\t *      //拆分前\n\t\t *      //output: <p><span></span></p>\n\t\t *      console.log( wrapNode.innerHTML );\n\t\t *\n\t\t *\n\t\t *      UE.dom.domUtils.breakParent( node, parent );\n\t\t *      //拆分后\n\t\t *      //output: <p></p><span></span><p></p>\n\t\t *      console.log( wrapNode.innerHTML );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tbreakParent: function(node, parent) {\n\t\t\tvar tmpNode,\n\t\t\t\tparentClone = node,\n\t\t\t\tclone = node,\n\t\t\t\tleftNodes,\n\t\t\t\trightNodes;\n\t\t\tdo {\n\t\t\t\tparentClone = parentClone.parentNode;\n\t\t\t\tif (leftNodes) {\n\t\t\t\t\ttmpNode = parentClone.cloneNode(false);\n\t\t\t\t\ttmpNode.appendChild(leftNodes);\n\t\t\t\t\tleftNodes = tmpNode;\n\t\t\t\t\ttmpNode = parentClone.cloneNode(false);\n\t\t\t\t\ttmpNode.appendChild(rightNodes);\n\t\t\t\t\trightNodes = tmpNode;\n\t\t\t\t} else {\n\t\t\t\t\tleftNodes = parentClone.cloneNode(false);\n\t\t\t\t\trightNodes = leftNodes.cloneNode(false);\n\t\t\t\t}\n\t\t\t\twhile (tmpNode = clone.previousSibling) {\n\t\t\t\t\tleftNodes.insertBefore(tmpNode, leftNodes.firstChild);\n\t\t\t\t}\n\t\t\t\twhile (tmpNode = clone.nextSibling) {\n\t\t\t\t\trightNodes.appendChild(tmpNode);\n\t\t\t\t}\n\t\t\t\tclone = parentClone;\n\t\t\t} while (parent !== parentClone);\n\t\t\ttmpNode = parent.parentNode;\n\t\t\ttmpNode.insertBefore(leftNodes, parent);\n\t\t\ttmpNode.insertBefore(rightNodes, parent);\n\t\t\ttmpNode.insertBefore(node, rightNodes);\n\t\t\tdomUtils.remove(parent);\n\t\t\treturn node;\n\t\t},\n\t\t/**\n\t\t * 检查节点node是否是空inline节点\n\t\t * @method  isEmptyInlineElement\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Number }  如果给定的节点是空的inline节点， 则返回1, 否则返回0。\n\t\t * @example\n\t\t * ```html\n\t\t * <b><i></i></b> => 1\n\t\t * <b><i></i><u></u></b> => 1\n\t\t * <b></b> => 1\n\t\t * <b>xx<i></i></b> => 0\n\t\t * ```\n\t\t */\n\t\tisEmptyInlineElement: function(node) {\n\t\t\tif (node.nodeType != 1 || !dtd.$removeEmpty[node.tagName]) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tnode = node.firstChild;\n\t\t\twhile (node) {\n\t\t\t\t//如果是创建的bookmark就跳过\n\t\t\t\tif (domUtils.isBookmarkNode(node)) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tif (node.nodeType == 1 && !domUtils.isEmptyInlineElement(node) ||\n\t\t\t\t\tnode.nodeType == 3 && !domUtils.isWhitespace(node)\n\t\t\t\t) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tnode = node.nextSibling;\n\t\t\t}\n\t\t\treturn 1;\n\n\t\t},\n\n\t\t/**\n\t\t * 删除node节点下首尾两端的空白文本子节点\n\t\t * @method trimWhiteTextNode\n\t\t * @param { Element } node 需要执行删除操作的元素对象\n\t\t * @example\n\t\t * ```javascript\n\t\t *      var node = document.createElement(\"div\");\n\t\t *\n\t\t *      node.appendChild( document.createTextNode( \"\" ) );\n\t\t *\n\t\t *      node.appendChild( document.createElement(\"div\") );\n\t\t *\n\t\t *      node.appendChild( document.createTextNode( \"\" ) );\n\t\t *\n\t\t *      //3\n\t\t *      console.log( node.childNodes.length );\n\t\t *\n\t\t *      UE.dom.domUtils.trimWhiteTextNode( node );\n\t\t *\n\t\t *      //1\n\t\t *      console.log( node.childNodes.length );\n\t\t * ```\n\t\t */\n\t\ttrimWhiteTextNode: function(node) {\n\t\t\tfunction remove(dir) {\n\t\t\t\tvar child;\n\t\t\t\twhile ((child = node[dir]) && child.nodeType == 3 && domUtils.isWhitespace(child)) {\n\t\t\t\t\tnode.removeChild(child);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove('firstChild');\n\t\t\tremove('lastChild');\n\t\t},\n\n\t\t/**\n\t\t * 合并node节点下相同的子节点\n\t\t * @name mergeChild\n\t\t * @desc\n\t\t * UE.dom.domUtils.mergeChild(node,tagName) //tagName要合并的子节点的标签\n\t\t * @example\n\t\t * <p><span style=\"font-size:12px;\">xx<span style=\"font-size:12px;\">aa</span>xx</span></p>\n\t\t * ==> UE.dom.domUtils.mergeChild(node,'span')\n\t\t * <p><span style=\"font-size:12px;\">xxaaxx</span></p>\n\t\t */\n\t\tmergeChild: function(node, tagName, attrs) {\n\t\t\tvar list = domUtils.getElementsByTagName(node, node.tagName.toLowerCase());\n\t\t\tfor (var i = 0, ci; ci = list[i++];) {\n\t\t\t\tif (!ci.parentNode || domUtils.isBookmarkNode(ci)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//span单独处理\n\t\t\t\tif (ci.tagName.toLowerCase() == 'span') {\n\t\t\t\t\tif (node === ci.parentNode) {\n\t\t\t\t\t\tdomUtils.trimWhiteTextNode(node);\n\t\t\t\t\t\tif (node.childNodes.length == 1) {\n\t\t\t\t\t\t\tnode.style.cssText = ci.style.cssText + \";\" + node.style.cssText;\n\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tci.style.cssText = node.style.cssText + ';' + ci.style.cssText;\n\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\tvar style = attrs.style;\n\t\t\t\t\t\tif (style) {\n\t\t\t\t\t\t\tstyle = style.split(';');\n\t\t\t\t\t\t\tfor (var j = 0, s; s = style[j++];) {\n\t\t\t\t\t\t\t\tci.style[utils.cssStyleToDomStyle(s.split(':')[0])] = s.split(':')[1];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (domUtils.isSameStyle(ci, node)) {\n\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (domUtils.isSameElement(node, ci)) {\n\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 原生方法getElementsByTagName的封装\n\t\t * @method getElementsByTagName\n\t\t * @param { Node } node 目标节点对象\n\t\t * @param { String } tagName 需要查找的节点的tagName， 多个tagName以空格分割\n\t\t * @return { Array } 符合条件的节点集合\n\t\t */\n\t\tgetElementsByTagName: function(node, name, filter) {\n\t\t\tif (filter && utils.isString(filter)) {\n\t\t\t\tvar className = filter;\n\t\t\t\tfilter = function(node) {\n\t\t\t\t\treturn domUtils.hasClass(node, className)\n\t\t\t\t}\n\t\t\t}\n\t\t\tname = utils.trim(name).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tvar arr = [];\n\t\t\tfor (var n = 0, ni; ni = name[n++];) {\n\t\t\t\tvar list = node.getElementsByTagName(ni);\n\t\t\t\tfor (var i = 0, ci; ci = list[i++];) {\n\t\t\t\t\tif (!filter || filter(ci))\n\t\t\t\t\t\tarr.push(ci);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn arr;\n\t\t},\n\t\t/**\n\t\t * 将节点node提取到父节点上\n\t\t * @method mergeToParent\n\t\t * @param { Element } node 需要提取的元素对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"parent\">\n\t\t *     <div id=\"sub\">\n\t\t *         <span id=\"child\"></span>\n\t\t *     </div>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var child = document.getElementById( \"child\" );\n\t\t *\n\t\t *     //output: sub\n\t\t *     console.log( child.parentNode.id );\n\t\t *\n\t\t *     UE.dom.domUtils.mergeToParent( child );\n\t\t *\n\t\t *     //output: parent\n\t\t *     console.log( child.parentNode.id );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tmergeToParent: function(node) {\n\t\t\tvar parent = node.parentNode;\n\t\t\twhile (parent && dtd.$removeEmpty[parent.tagName]) {\n\t\t\t\tif (parent.tagName == node.tagName || parent.tagName == 'A') { //针对a标签单独处理\n\t\t\t\t\tdomUtils.trimWhiteTextNode(parent);\n\t\t\t\t\t//span需要特殊处理  不处理这样的情况 <span stlye=\"color:#fff\">xxx<span style=\"color:#ccc\">xxx</span>xxx</span>\n\t\t\t\t\tif (parent.tagName == 'SPAN' && !domUtils.isSameStyle(parent, node) || (parent.tagName == 'A' && node.tagName == 'SPAN')) {\n\t\t\t\t\t\tif (parent.childNodes.length > 1 || parent !== node.parentNode) {\n\t\t\t\t\t\t\tnode.style.cssText = parent.style.cssText + \";\" + node.style.cssText;\n\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tparent.style.cssText += \";\" + node.style.cssText;\n\t\t\t\t\t\t\t//trace:952 a标签要保持下划线\n\t\t\t\t\t\t\tif (parent.tagName == 'A') {\n\t\t\t\t\t\t\t\tparent.style.textDecoration = 'underline';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (parent.tagName != 'A') {\n\t\t\t\t\t\tparent === node.parentNode && domUtils.remove(node, true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tparent = parent.parentNode;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 合并节点node的左右兄弟节点\n\t\t * @method mergeSibling\n\t\t * @param { Element } node 需要合并的目标节点\n\t\t * @example\n\t\t * ```html\n\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t *\n\t\t * <script>\n\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t *     UE.dom.domUtils.mergeSibling( demoNode );\n\t\t *     //output: xxxxoooxxxx\n\t\t *     console.log( demoNode.innerHTML );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 合并节点node的左右兄弟节点， 可以根据给定的条件选择是否忽略合并左节点。\n\t\t * @method mergeSibling\n\t\t * @param { Element } node 需要合并的目标节点\n\t\t * @param { Boolean } ignorePre 是否忽略合并左节点\n\t\t * @example\n\t\t * ```html\n\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t *\n\t\t * <script>\n\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t *     UE.dom.domUtils.mergeSibling( demoNode, true );\n\t\t *     //output: oooxxxx\n\t\t *     console.log( demoNode.innerHTML );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 合并节点node的左右兄弟节点，可以根据给定的条件选择是否忽略合并左右节点。\n\t\t * @method mergeSibling\n\t\t * @param { Element } node 需要合并的目标节点\n\t\t * @param { Boolean } ignorePre 是否忽略合并左节点\n\t\t * @param { Boolean } ignoreNext 是否忽略合并右节点\n\t\t * @remind 如果同时忽略左右节点， 则该操作什么也不会做\n\t\t * @example\n\t\t * ```html\n\t\t * <b>xxxx</b><b id=\"test\">ooo</b><b>xxxx</b>\n\t\t *\n\t\t * <script>\n\t\t *     var demoNode = document.getElementById(\"test\");\n\t\t *     UE.dom.domUtils.mergeSibling( demoNode, false, true );\n\t\t *     //output: xxxxooo\n\t\t *     console.log( demoNode.innerHTML );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tmergeSibling: function(node, ignorePre, ignoreNext) {\n\t\t\tfunction merge(rtl, start, node) {\n\t\t\t\tvar next;\n\t\t\t\tif ((next = node[rtl]) && !domUtils.isBookmarkNode(next) && next.nodeType == 1 && domUtils.isSameElement(node, next)) {\n\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\tif (start == 'firstChild') {\n\t\t\t\t\t\t\tnode.insertBefore(next.lastChild, node.firstChild);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.appendChild(next.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t}\n\t\t\t}!ignorePre && merge('previousSibling', 'firstChild', node);\n\t\t\t!ignoreNext && merge('nextSibling', 'lastChild', node);\n\t\t},\n\n\t\t/**\n\t\t * 设置节点node及其子节点不会被选中\n\t\t * @method unSelectable\n\t\t * @param { Element } node 需要执行操作的dom元素\n\t\t * @remind 执行该操作后的节点， 将不能被鼠标选中\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.unSelectable( document.body );\n\t\t * ```\n\t\t */\n\t\tunSelectable: ie && browser.ie9below || browser.opera ? function(node) {\n\t\t\t//for ie9\n\t\t\tnode.onselectstart = function() {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tnode.onclick = node.onkeyup = node.onkeydown = function() {\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tnode.unselectable = 'on';\n\t\t\tnode.setAttribute(\"unselectable\", \"on\");\n\t\t\tfor (var i = 0, ci; ci = node.all[i++];) {\n\t\t\t\tswitch (ci.tagName.toLowerCase()) {\n\t\t\t\t\tcase 'iframe':\n\t\t\t\t\tcase 'textarea':\n\t\t\t\t\tcase 'input':\n\t\t\t\t\tcase 'select':\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tci.unselectable = 'on';\n\t\t\t\t\t\tnode.setAttribute(\"unselectable\", \"on\");\n\t\t\t\t}\n\t\t\t}\n\t\t} : function(node) {\n\t\t\tnode.style.MozUserSelect =\n\t\t\t\tnode.style.webkitUserSelect =\n\t\t\t\tnode.style.msUserSelect =\n\t\t\t\tnode.style.KhtmlUserSelect = 'none';\n\t\t},\n\t\t/**\n\t\t * 删除节点node上的指定属性名称的属性\n\t\t * @method  removeAttributes\n\t\t * @param { Node } node 需要删除属性的节点对象\n\t\t * @param { String } attrNames 可以是空格隔开的多个属性名称，该操作将会依次删除相应的属性\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"wrap\">\n\t\t *      <span style=\"font-size:14px;\" id=\"test\" name=\"followMe\">xxxxx</span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     UE.dom.domUtils.removeAttributes( document.getElementById( \"test\" ), \"id name\" );\n\t\t *\n\t\t *     //output: <span style=\"font-size:14px;\">xxxxx</span>\n\t\t *     console.log( document.getElementById(\"wrap\").innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 删除节点node上的指定属性名称的属性\n\t\t * @method  removeAttributes\n\t\t * @param { Node } node 需要删除属性的节点对象\n\t\t * @param { Array } attrNames 需要删除的属性名数组\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"wrap\">\n\t\t *      <span style=\"font-size:14px;\" id=\"test\" name=\"followMe\">xxxxx</span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     UE.dom.domUtils.removeAttributes( document.getElementById( \"test\" ), [\"id\", \"name\"] );\n\t\t *\n\t\t *     //output: <span style=\"font-size:14px;\">xxxxx</span>\n\t\t *     console.log( document.getElementById(\"wrap\").innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremoveAttributes: function(node, attrNames) {\n\t\t\tattrNames = utils.isArray(attrNames) ? attrNames : utils.trim(attrNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci; ci = attrNames[i++];) {\n\t\t\t\tci = attrFix[ci] || ci;\n\t\t\t\tswitch (ci) {\n\t\t\t\t\tcase 'className':\n\t\t\t\t\t\tnode[ci] = '';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'style':\n\t\t\t\t\t\tnode.style.cssText = '';\n\t\t\t\t\t\tvar val = node.getAttributeNode('style');\n\t\t\t\t\t\t!browser.ie && val && node.removeAttributeNode(val);\n\t\t\t\t}\n\t\t\t\tnode.removeAttribute(ci);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 在doc下创建一个标签名为tag，属性为attrs的元素\n\t\t * @method createElement\n\t\t * @param { DomDocument } doc 新创建的元素属于该document节点创建\n\t\t * @param { String } tagName 需要创建的元素的标签名\n\t\t * @param { Object } attrs 新创建的元素的属性key-value集合\n\t\t * @return { Element } 新创建的元素对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * var ele = UE.dom.domUtils.createElement( document, 'div', {\n\t\t *     id: 'test'\n\t\t * } );\n\t\t *\n\t\t * //output: DIV\n\t\t * console.log( ele.tagName );\n\t\t *\n\t\t * //output: test\n\t\t * console.log( ele.id );\n\t\t *\n\t\t * ```\n\t\t */\n\t\tcreateElement: function(doc, tag, attrs) {\n\t\t\treturn domUtils.setAttributes(doc.createElement(tag), attrs)\n\t\t},\n\t\t/**\n\t\t * 为节点node添加属性attrs，attrs为属性键值对\n\t\t * @method setAttributes\n\t\t * @param { Element } node 需要设置属性的元素对象\n\t\t * @param { Object } attrs 需要设置的属性名-值对\n\t\t * @return { Element } 设置属性的元素对象\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\"></span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = UE.dom.domUtils.setAttributes( document.getElementById( \"test\" ), {\n\t\t *         id: 'demo'\n\t\t *     } );\n\t\t *\n\t\t *     //output: demo\n\t\t *     console.log( testNode.id );\n\t\t *\n\t\t * </script>\n\t\t *\n\t\t */\n\t\tsetAttributes: function(node, attrs) {\n\t\t\tfor (var attr in attrs) {\n\t\t\t\tif (attrs.hasOwnProperty(attr)) {\n\t\t\t\t\tvar value = attrs[attr];\n\t\t\t\t\tswitch (attr) {\n\t\t\t\t\t\tcase 'class':\n\t\t\t\t\t\t\t//ie下要这样赋值，setAttribute不起作用\n\t\t\t\t\t\t\tnode.className = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\tnode.style.cssText = node.style.cssText + \";\" + value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'innerHTML':\n\t\t\t\t\t\t\tnode[attr] = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'value':\n\t\t\t\t\t\t\tnode.value = value;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tnode.setAttribute(attrFix[attr] || attr, value);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn node;\n\t\t},\n\n\t\t/**\n\t\t * 获取元素element经过计算后的样式值\n\t\t * @method getComputedStyle\n\t\t * @param { Element } element 需要获取样式的元素对象\n\t\t * @param { String } styleName 需要获取的样式名\n\t\t * @return { String } 获取到的样式值\n\t\t * @example\n\t\t * ```html\n\t\t * <style type=\"text/css\">\n\t\t *      #test {\n\t\t *          font-size: 15px;\n\t\t *      }\n\t\t * </style>\n\t\t *\n\t\t * <span id=\"test\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     //output: 15px\n\t\t *     console.log( UE.dom.domUtils.getComputedStyle( document.getElementById( \"test\" ), 'font-size' ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tgetComputedStyle: function(element, styleName) {\n\t\t\t//一下的属性单独处理\n\t\t\tvar pros = 'width height top left';\n\n\t\t\tif (pros.indexOf(styleName) > -1) {\n\t\t\t\treturn element['offset' + styleName.replace(/^\\w/, function(s) {\n\t\t\t\t\treturn s.toUpperCase()\n\t\t\t\t})] + 'px';\n\t\t\t}\n\t\t\t//忽略文本节点\n\t\t\tif (element.nodeType == 3) {\n\t\t\t\telement = element.parentNode;\n\t\t\t}\n\t\t\t//ie下font-size若body下定义了font-size，则从currentStyle里会取到这个font-size. 取不到实际值，故此修改.\n\t\t\tif (browser.ie && browser.version < 9 && styleName == 'font-size' && !element.style.fontSize &&\n\t\t\t\t!dtd.$empty[element.tagName] && !dtd.$nonChild[element.tagName]) {\n\t\t\t\tvar span = element.ownerDocument.createElement('span');\n\t\t\t\tspan.style.cssText = 'padding:0;border:0;font-family:simsun;';\n\t\t\t\tspan.innerHTML = '.';\n\t\t\t\telement.appendChild(span);\n\t\t\t\tvar result = span.offsetHeight;\n\t\t\t\telement.removeChild(span);\n\t\t\t\tspan = null;\n\t\t\t\treturn result + 'px';\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tvar value = domUtils.getStyle(element, styleName) ||\n\t\t\t\t\t(window.getComputedStyle ? domUtils.getWindow(element).getComputedStyle(element, '').getPropertyValue(styleName) :\n\t\t\t\t\t\t(element.currentStyle || element.style)[utils.cssStyleToDomStyle(styleName)]);\n\n\t\t\t} catch (e) {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t\treturn utils.transUnitToPx(utils.fixColor(styleName, value));\n\t\t},\n\t\t/**\n\t\t * 删除元素element指定的className\n\t\t * @method removeClasses\n\t\t * @param { Element } ele 需要删除class的元素节点\n\t\t * @param { String } classNames 需要删除的className， 多个className之间以空格分开\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"test1 test2 test3\">xxx</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById( \"test\" );\n\t\t *     UE.dom.domUtils.removeClasses( testNode, \"test1 test2\" );\n\t\t *\n\t\t *     //output: test3\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 删除元素element指定的className\n\t\t * @method removeClasses\n\t\t * @param { Element } ele 需要删除class的元素节点\n\t\t * @param { Array } classNames 需要删除的className数组\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"test1 test2 test3\">xxx</span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById( \"test\" );\n\t\t *     UE.dom.domUtils.removeClasses( testNode, [\"test1\", \"test2\"] );\n\t\t *\n\t\t *     //output: test3\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremoveClasses: function(elm, classNames) {\n\t\t\tclassNames = utils.isArray(classNames) ? classNames :\n\t\t\t\tutils.trim(classNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci, cls = elm.className; ci = classNames[i++];) {\n\t\t\t\tcls = cls.replace(new RegExp('\\\\b' + ci + '\\\\b'), '')\n\t\t\t}\n\t\t\tcls = utils.trim(cls).replace(/[ ]{2,}/g, ' ');\n\t\t\tif (cls) {\n\t\t\t\telm.className = cls;\n\t\t\t} else {\n\t\t\t\tdomUtils.removeAttributes(elm, ['class']);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 给元素element添加className\n\t\t * @method addClass\n\t\t * @param { Node } ele 需要增加className的元素\n\t\t * @param { String } classNames 需要添加的className， 多个className之间以空格分割\n\t\t * @remind 相同的类名不会被重复添加\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.addClass( testNode, \"cls2 cls3 cls4\" );\n\t\t *\n\t\t *     //output: cl1 cls2 cls3 cls4\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * <script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 给元素element添加className\n\t\t * @method addClass\n\t\t * @param { Node } ele 需要增加className的元素\n\t\t * @param { Array } classNames 需要添加的className的数组\n\t\t * @remind 相同的类名不会被重复添加\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.addClass( testNode, [\"cls2\", \"cls3\", \"cls4\"] );\n\t\t *\n\t\t *     //output: cl1 cls2 cls3 cls4\n\t\t *     console.log( testNode.className );\n\t\t *\n\t\t * <script>\n\t\t * ```\n\t\t */\n\t\taddClass: function(elm, classNames) {\n\t\t\tif (!elm) return;\n\t\t\tclassNames = utils.trim(classNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci, cls = elm.className; ci = classNames[i++];) {\n\t\t\t\tif (!new RegExp('\\\\b' + ci + '\\\\b').test(cls)) {\n\t\t\t\t\tcls += ' ' + ci;\n\t\t\t\t}\n\t\t\t}\n\t\t\telm.className = utils.trim(cls);\n\t\t},\n\t\t/**\n\t\t * 判断元素element是否包含给定的样式类名className\n\t\t * @method hasClass\n\t\t * @param { Node } ele 需要检测的元素\n\t\t * @param { String } classNames 需要检测的className， 多个className之间用空格分割\n\t\t * @return { Boolean } 元素是否包含所有给定的className\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test1\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var test1 = document.getElementById(\"test1\");\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, \"cls2 cls1 cls3\" ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, \"cls2 cls1\" ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 判断元素element是否包含给定的样式类名className\n\t\t * @method hasClass\n\t\t * @param { Node } ele 需要检测的元素\n\t\t * @param { Array } classNames 需要检测的className数组\n\t\t * @return { Boolean } 元素是否包含所有给定的className\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test1\" class=\"cls1 cls2\"></span>\n\t\t *\n\t\t * <script>\n\t\t *     var test1 = document.getElementById(\"test1\");\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, [ \"cls2\", \"cls1\", \"cls3\" ] ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.hasClass( test1, [ \"cls2\", \"cls1\" ]) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\thasClass: function(element, className) {\n\t\t\tif (utils.isRegExp(className)) {\n\t\t\t\treturn className.test(element.className)\n\t\t\t}\n\t\t\tclassName = utils.trim(className).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\tfor (var i = 0, ci, cls = element.className; ci = className[i++];) {\n\t\t\t\tif (!new RegExp('\\\\b' + ci + '\\\\b', 'i').test(cls)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn i - 1 == className.length;\n\t\t},\n\n\t\t/**\n\t\t * 阻止事件默认行为\n\t\t * @method preventDefault\n\t\t * @param { Event } evt 需要阻止默认行为的事件对象\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.preventDefault( evt );\n\t\t * ```\n\t\t */\n\t\tpreventDefault: function(evt) {\n\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t},\n\t\t/**\n\t\t * 删除元素element指定的样式\n\t\t * @method removeStyle\n\t\t * @param { Element } element 需要删除样式的元素\n\t\t * @param { String } styleName 需要删除的样式名\n\t\t * @example\n\t\t * ```html\n\t\t * <span id=\"test\" style=\"color: red; background: blue;\"></span>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.removeStyle( testNode, 'color' );\n\t\t *\n\t\t *     //output: background: blue;\n\t\t *     console.log( testNode.style.cssText );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tremoveStyle: function(element, name) {\n\t\t\tif (browser.ie) {\n\t\t\t\t//针对color先单独处理一下\n\t\t\t\tif (name == 'color') {\n\t\t\t\t\tname = '(^|;)' + name;\n\t\t\t\t}\n\t\t\t\telement.style.cssText = element.style.cssText.replace(new RegExp(name + '[^:]*:[^;]+;?', 'ig'), '')\n\t\t\t} else {\n\t\t\t\tif (element.style.removeProperty) {\n\t\t\t\t\telement.style.removeProperty(name);\n\t\t\t\t} else {\n\t\t\t\t\telement.style.removeAttribute(utils.cssStyleToDomStyle(name));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!element.style.cssText) {\n\t\t\t\tdomUtils.removeAttributes(element, ['style']);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 获取元素element的style属性的指定值\n\t\t * @method getStyle\n\t\t * @param { Element } element 需要获取属性值的元素\n\t\t * @param { String } styleName 需要获取的style的名称\n\t\t * @warning 该方法仅获取元素style属性中所标明的值\n\t\t * @return { String } 该元素包含指定的style属性值\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\" style=\"color: red;\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t *\n\t\t *      //output: red\n\t\t *      console.log( UE.dom.domUtils.getStyle( testNode, \"color\" ) );\n\t\t *\n\t\t *      //output: \"\"\n\t\t *      console.log( UE.dom.domUtils.getStyle( testNode, \"background\" ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tgetStyle: function(element, name) {\n\t\t\tvar value = element.style[utils.cssStyleToDomStyle(name)];\n\t\t\treturn utils.fixColor(name, value);\n\t\t},\n\t\t/**\n\t\t * 为元素element设置样式属性值\n\t\t * @method setStyle\n\t\t * @param { Element } element 需要设置样式的元素\n\t\t * @param { String } styleName 样式名\n\t\t * @param { String } styleValue 样式值\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t *\n\t\t *      //output: \"\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t *      UE.dom.domUtils.setStyle( testNode, 'color', 'red' );\n\t\t *      //output: \"red\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsetStyle: function(element, name, value) {\n\t\t\telement.style[utils.cssStyleToDomStyle(name)] = value;\n\t\t\tif (!utils.trim(element.style.cssText)) {\n\t\t\t\tthis.removeAttributes(element, 'style')\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 为元素element设置多个样式属性值\n\t\t * @method setStyles\n\t\t * @param { Element } element 需要设置样式的元素\n\t\t * @param { Object } styles 样式名值对\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *      var testNode = document.getElementById( \"test\" );\n\t\t *\n\t\t *      //output: \"\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t *      UE.dom.domUtils.setStyles( testNode, {\n\t\t *          'color': 'red'\n\t\t *      } );\n\t\t *      //output: \"red\"\n\t\t *      console.log( testNode.style.color );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsetStyles: function(element, styles) {\n\t\t\tfor (var name in styles) {\n\t\t\t\tif (styles.hasOwnProperty(name)) {\n\t\t\t\t\tdomUtils.setStyle(element, name, styles[name]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 删除_moz_dirty属性\n\t\t * @private\n\t\t * @method removeDirtyAttr\n\t\t */\n\t\tremoveDirtyAttr: function(node) {\n\t\t\tfor (var i = 0, ci, nodes = node.getElementsByTagName('*'); ci = nodes[i++];) {\n\t\t\t\tci.removeAttribute('_moz_dirty');\n\t\t\t}\n\t\t\tnode.removeAttribute('_moz_dirty');\n\t\t},\n\t\t/**\n\t\t * 获取子节点的数量\n\t\t * @method getChildCount\n\t\t * @param { Element } node 需要检测的元素\n\t\t * @return { Number } 给定的node元素的子节点数量\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: 3\n\t\t *     console.log( UE.dom.domUtils.getChildCount( document.getElementById(\"test\") ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 根据给定的过滤规则， 获取符合条件的子节点的数量\n\t\t * @method getChildCount\n\t\t * @param { Element } node 需要检测的元素\n\t\t * @param { Function } fn 过滤器， 要求对符合条件的子节点返回true， 反之则要求返回false\n\t\t * @return { Number } 符合过滤条件的node元素的子节点数量\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: 1\n\t\t *     console.log( UE.dom.domUtils.getChildCount( document.getElementById(\"test\"), function ( node ) {\n\t\t *\n\t\t *         return node.nodeType === 1;\n\t\t *\n\t\t *     } ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tgetChildCount: function(node, fn) {\n\t\t\tvar count = 0,\n\t\t\t\tfirst = node.firstChild;\n\t\t\tfn = fn || function() {\n\t\t\t\treturn 1;\n\t\t\t};\n\t\t\twhile (first) {\n\t\t\t\tif (fn(first)) {\n\t\t\t\t\tcount++;\n\t\t\t\t}\n\t\t\t\tfirst = first.nextSibling;\n\t\t\t}\n\t\t\treturn count;\n\t\t},\n\n\t\t/**\n\t\t * 判断给定节点是否为空节点\n\t\t * @method isEmptyNode\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 节点是否为空\n\t\t * @example\n\t\t * ```javascript\n\t\t * UE.dom.domUtils.isEmptyNode( document.body );\n\t\t * ```\n\t\t */\n\t\tisEmptyNode: function(node) {\n\t\t\treturn !node.firstChild || domUtils.getChildCount(node, function(node) {\n\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isBookmarkNode(node) && !domUtils.isWhitespace(node)\n\t\t\t}) == 0\n\t\t},\n\t\tclearSelectedArr: function(nodes) {\n\t\t\tvar node;\n\t\t\twhile (node = nodes.pop()) {\n\t\t\t\tdomUtils.removeAttributes(node, ['class']);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 将显示区域滚动到指定节点的位置\n\t\t * @method scrollToView\n\t\t * @param    {Node}   node    节点\n\t\t * @param    {window}   win      window对象\n\t\t * @param    {Number}    offsetTop    距离上方的偏移量\n\t\t */\n\t\tscrollToView: function(node, win, offsetTop) {\n\t\t\tvar getViewPaneSize = function() {\n\t\t\t\t\tvar doc = win.document,\n\t\t\t\t\t\tmode = doc.compatMode == 'CSS1Compat';\n\t\t\t\t\treturn {\n\t\t\t\t\t\twidth: (mode ? doc.documentElement.clientWidth : doc.body.clientWidth) || 0,\n\t\t\t\t\t\theight: (mode ? doc.documentElement.clientHeight : doc.body.clientHeight) || 0\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tgetScrollPosition = function(win) {\n\t\t\t\t\tif ('pageXOffset' in win) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tx: win.pageXOffset || 0,\n\t\t\t\t\t\t\ty: win.pageYOffset || 0\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar doc = win.document;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tx: doc.documentElement.scrollLeft || doc.body.scrollLeft || 0,\n\t\t\t\t\t\t\ty: doc.documentElement.scrollTop || doc.body.scrollTop || 0\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\tvar winHeight = getViewPaneSize().height,\n\t\t\t\toffset = winHeight * -1 + offsetTop;\n\t\t\toffset += (node.offsetHeight || 0);\n\t\t\tvar elementPosition = domUtils.getXY(node);\n\t\t\toffset += elementPosition.y;\n\t\t\tvar currentScroll = getScrollPosition(win).y;\n\t\t\t// offset += 50;\n\t\t\tif (offset > currentScroll || offset < currentScroll - winHeight) {\n\t\t\t\twin.scrollTo(0, offset + (offset < 0 ? -20 : 20));\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 判断给定节点是否为br\n\t\t * @method isBr\n\t\t * @param { Node } node 需要判断的节点对象\n\t\t * @return { Boolean } 给定的节点是否是br节点\n\t\t */\n\t\tisBr: function(node) {\n\t\t\treturn node.nodeType == 1 && node.tagName == 'BR';\n\t\t},\n\t\t/**\n\t\t * 判断给定的节点是否是一个“填充”节点\n\t\t * @private\n\t\t * @method isFillChar\n\t\t * @param { Node } node 需要判断的节点\n\t\t * @param { Boolean } isInStart 是否从节点内容的开始位置匹配\n\t\t * @returns { Boolean } 节点是否是填充节点\n\t\t */\n\t\tisFillChar: function(node, isInStart) {\n\t\t\tif (node.nodeType != 3)\n\t\t\t\treturn false;\n\t\t\tvar text = node.nodeValue;\n\t\t\tif (isInStart) {\n\t\t\t\treturn new RegExp('^' + domUtils.fillChar).test(text)\n\t\t\t}\n\t\t\treturn !text.replace(new RegExp(domUtils.fillChar, 'g'), '').length\n\t\t},\n\t\tisStartInblock: function(range) {\n\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\tflag = 0,\n\t\t\t\tstart = tmpRange.startContainer,\n\t\t\t\ttmp;\n\t\t\tif (start.nodeType == 1 && start.childNodes[tmpRange.startOffset]) {\n\t\t\t\tstart = start.childNodes[tmpRange.startOffset];\n\t\t\t\tvar pre = start.previousSibling;\n\t\t\t\twhile (pre && domUtils.isFillChar(pre)) {\n\t\t\t\t\tstart = pre;\n\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.isFillChar(start, true) && tmpRange.startOffset == 1) {\n\t\t\t\ttmpRange.setStartBefore(start);\n\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t}\n\n\t\t\twhile (start && domUtils.isFillChar(start)) {\n\t\t\t\ttmp = start;\n\t\t\t\tstart = start.previousSibling\n\t\t\t}\n\t\t\tif (tmp) {\n\t\t\t\ttmpRange.setStartBefore(tmp);\n\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t}\n\t\t\tif (start.nodeType == 1 && domUtils.isEmptyNode(start) && tmpRange.startOffset == 1) {\n\t\t\t\ttmpRange.setStart(start, 0).collapse(true);\n\t\t\t}\n\t\t\twhile (!tmpRange.startOffset) {\n\t\t\t\tstart = tmpRange.startContainer;\n\t\t\t\tif (domUtils.isBlockElm(start) || domUtils.isBody(start)) {\n\t\t\t\t\tflag = 1;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tvar pre = tmpRange.startContainer.previousSibling,\n\t\t\t\t\ttmpNode;\n\t\t\t\tif (!pre) {\n\t\t\t\t\ttmpRange.setStartBefore(tmpRange.startContainer);\n\t\t\t\t} else {\n\t\t\t\t\twhile (pre && domUtils.isFillChar(pre)) {\n\t\t\t\t\t\ttmpNode = pre;\n\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\ttmpRange.setStartBefore(tmpNode);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttmpRange.setStartBefore(tmpRange.startContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn flag && !domUtils.isBody(tmpRange.startContainer) ? 1 : 0;\n\t\t},\n\n\t\t/**\n\t\t * 判断给定的元素是否是一个空元素\n\t\t * @method isEmptyBlock\n\t\t * @param { Element } node 需要判断的元素\n\t\t * @return { Boolean } 是否是空元素\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isEmptyBlock( document.getElementById(\"test\") ) );\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 根据指定的判断规则判断给定的元素是否是一个空元素\n\t\t * @method isEmptyBlock\n\t\t * @param { Element } node 需要判断的元素\n\t\t * @param { RegExp } reg 对内容执行判断的正则表达式对象\n\t\t * @return { Boolean } 是否是空元素\n\t\t */\n\t\tisEmptyBlock: function(node, reg) {\n\t\t\tif (node.nodeType != 1)\n\t\t\t\treturn 0;\n\t\t\treg = reg || new RegExp('[ \\xa0\\t\\r\\n' + domUtils.fillChar + ']', 'g');\n\n\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(reg, '').length > 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor (var n in dtd.$isNotEmpty) {\n\t\t\t\tif (node.getElementsByTagName(n).length) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 1;\n\t\t},\n\n\t\t/**\n\t\t * 移动元素使得该元素的位置移动指定的偏移量的距离\n\t\t * @method setViewportOffset\n\t\t * @param { Element } element 需要设置偏移量的元素\n\t\t * @param { Object } offset 偏移量， 形如{ left: 100, top: 50 }的一个键值对， 表示该元素将在\n\t\t *                                  现有的位置上向水平方向偏移offset.left的距离， 在竖直方向上偏移\n\t\t *                                  offset.top的距离\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\" style=\"top: 100px; left: 50px; position: absolute;\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     UE.dom.domUtils.setViewportOffset( testNode, {\n\t\t *         left: 200,\n\t\t *         top: 50\n\t\t *     } );\n\t\t *\n\t\t *     //output: top: 300px; left: 100px; position: absolute;\n\t\t *     console.log( testNode.style.cssText );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tsetViewportOffset: function(element, offset) {\n\t\t\tvar left = parseInt(element.style.left) | 0;\n\t\t\tvar top = parseInt(element.style.top) | 0;\n\t\t\tvar rect = element.getBoundingClientRect();\n\t\t\tvar offsetLeft = offset.left - rect.left;\n\t\t\tvar offsetTop = offset.top - rect.top;\n\t\t\tif (offsetLeft) {\n\t\t\t\telement.style.left = left + offsetLeft + 'px';\n\t\t\t}\n\t\t\tif (offsetTop) {\n\t\t\t\telement.style.top = top + offsetTop + 'px';\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 用“填充字符”填充节点\n\t\t * @method fillNode\n\t\t * @private\n\t\t * @param { DomDocument } doc 填充的节点所在的docment对象\n\t\t * @param { Node } node 需要填充的节点对象\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *     var testNode = document.getElementById(\"test\");\n\t\t *\n\t\t *     //output: 0\n\t\t *     console.log( testNode.childNodes.length );\n\t\t *\n\t\t *     UE.dom.domUtils.fillNode( document, testNode );\n\t\t *\n\t\t *     //output: 1\n\t\t *     console.log( testNode.childNodes.length );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tfillNode: function(doc, node) {\n\t\t\tvar tmpNode = browser.ie ? doc.createTextNode(domUtils.fillChar) : doc.createElement('br');\n\t\t\tnode.innerHTML = '';\n\t\t\tnode.appendChild(tmpNode);\n\t\t},\n\n\t\t/**\n\t\t * 把节点src的所有子节点追加到另一个节点tag上去\n\t\t * @method moveChild\n\t\t * @param { Node } src 源节点， 该节点下的所有子节点将被移除\n\t\t * @param { Node } tag 目标节点， 从源节点移除的子节点将被追加到该节点下\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test1\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t * <div id=\"test2\">\n\t\t *     <div></div>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var test1 = document.getElementById(\"test1\"),\n\t\t *         test2 = document.getElementById(\"test2\");\n\t\t *\n\t\t *     UE.dom.domUtils.moveChild( test1, test2 );\n\t\t *\n\t\t *     //output: \"\"（空字符串）\n\t\t *     console.log( test1.innerHTML );\n\t\t *\n\t\t *     //output: \"<div></div><span></span>\"\n\t\t *     console.log( test2.innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 把节点src的所有子节点移动到另一个节点tag上去, 可以通过dir参数控制附加的行为是“追加”还是“插入顶部”\n\t\t * @method moveChild\n\t\t * @param { Node } src 源节点， 该节点下的所有子节点将被移除\n\t\t * @param { Node } tag 目标节点， 从源节点移除的子节点将被附加到该节点下\n\t\t * @param { Boolean } dir 附加方式， 如果为true， 则附加进去的节点将被放到目标节点的顶部， 反之，则放到末尾\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test1\">\n\t\t *      <span></span>\n\t\t * </div>\n\t\t * <div id=\"test2\">\n\t\t *     <div></div>\n\t\t * </div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     var test1 = document.getElementById(\"test1\"),\n\t\t *         test2 = document.getElementById(\"test2\");\n\t\t *\n\t\t *     UE.dom.domUtils.moveChild( test1, test2, true );\n\t\t *\n\t\t *     //output: \"\"（空字符串）\n\t\t *     console.log( test1.innerHTML );\n\t\t *\n\t\t *     //output: \"<span></span><div></div>\"\n\t\t *     console.log( test2.innerHTML );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tmoveChild: function(src, tag, dir) {\n\t\t\twhile (src.firstChild) {\n\t\t\t\tif (dir && tag.firstChild) {\n\t\t\t\t\ttag.insertBefore(src.lastChild, tag.firstChild);\n\t\t\t\t} else {\n\t\t\t\t\ttag.appendChild(src.firstChild);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 判断节点的标签上是否不存在任何属性\n\t\t * @method hasNoAttributes\n\t\t * @private\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @return { Boolean } 节点是否不包含任何属性\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"><span>xxxx</span></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: false\n\t\t *     console.log( UE.dom.domUtils.hasNoAttributes( document.getElementById(\"test\") ) );\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.hasNoAttributes( document.getElementById(\"test\").firstChild ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\thasNoAttributes: function(node) {\n\t\t\treturn browser.ie ? /^<\\w+\\s*?>/.test(node.outerHTML) : node.attributes.length == 0;\n\t\t},\n\n\t\t/**\n\t\t * 检测节点是否是UEditor所使用的辅助节点\n\t\t * @method isCustomeNode\n\t\t * @private\n\t\t * @param { Node } node 需要检测的节点\n\t\t * @remind 辅助节点是指编辑器要完成工作临时添加的节点， 在输出的时候将会从编辑器内移除， 不会影响最终的结果。\n\t\t * @return { Boolean } 给定的节点是否是一个辅助节点\n\t\t */\n\t\tisCustomeNode: function(node) {\n\t\t\treturn node.nodeType == 1 && node.getAttribute('_ue_custom_node_');\n\t\t},\n\n\t\t/**\n\t\t * 检测节点的标签是否是给定的标签\n\t\t * @method isTagNode\n\t\t * @param { Node } node 需要检测的节点对象\n\t\t * @param { String } tagName 标签\n\t\t * @return { Boolean } 节点的标签是否是给定的标签\n\t\t * @example\n\t\t * ```html\n\t\t * <div id=\"test\"></div>\n\t\t *\n\t\t * <script>\n\t\t *\n\t\t *     //output: true\n\t\t *     console.log( UE.dom.domUtils.isTagNode( document.getElementById(\"test\"), \"div\" ) );\n\t\t *\n\t\t * </script>\n\t\t * ```\n\t\t */\n\t\tisTagNode: function(node, tagNames) {\n\t\t\treturn node.nodeType == 1 && new RegExp('\\\\b' + node.tagName + '\\\\b', 'i').test(tagNames)\n\t\t},\n\n\t\t/**\n\t\t * 给定一个节点数组，在通过指定的过滤器过滤后， 获取其中满足过滤条件的第一个节点\n\t\t * @method filterNodeList\n\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t * @param { Function } fn 过滤器， 对符合条件的节点， 执行结果返回true， 反之则返回false\n\t\t * @return { Node | NULL } 如果找到符合过滤条件的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t *\n\t\t * //output: null\n\t\t * console.log( UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t *     return node.tagName.toLowerCase() !== 'div';\n\t\t * } ) );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 给定一个节点数组nodeList和一组标签名tagNames， 获取其中能够匹配标签名的节点集合中的第一个节点\n\t\t * @method filterNodeList\n\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t * @param { String } tagNames 需要匹配的标签名， 多个标签名之间用空格分割\n\t\t * @return { Node | NULL } 如果找到标签名匹配的节点， 则返回该节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t *\n\t\t * //output: null\n\t\t * console.log( UE.dom.domUtils.filterNodeList( divNodes, 'a span' ) );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 给定一个节点数组，在通过指定的过滤器过滤后， 如果参数forAll为true， 则会返回所有满足过滤\n\t\t * 条件的节点集合， 否则， 返回满足条件的节点集合中的第一个节点\n\t\t * @method filterNodeList\n\t\t * @param { Array } nodeList 需要过滤的节点数组\n\t\t * @param { Function } fn 过滤器， 对符合条件的节点， 执行结果返回true， 反之则返回false\n\t\t * @param { Boolean } forAll 是否返回整个节点数组, 如果该参数为false， 则返回节点集合中的第一个节点\n\t\t * @return { Array | Node | NULL } 如果找到符合过滤条件的节点， 则根据参数forAll的值决定返回满足\n\t\t *                                      过滤条件的节点数组或第一个节点， 否则返回NULL\n\t\t * @example\n\t\t * ```javascript\n\t\t * var divNodes = document.getElementsByTagName(\"div\");\n\t\t * divNodes = [].slice.call( divNodes, 0 );\n\t\t *\n\t\t * //output: 3（假定有3个div）\n\t\t * console.log( divNodes.length );\n\t\t *\n\t\t * var nodes = UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t *     return node.tagName.toLowerCase() === 'div';\n\t\t * }, true );\n\t\t *\n\t\t * //output: 3\n\t\t * console.log( nodes.length );\n\t\t *\n\t\t * var node = UE.dom.domUtils.filterNodeList( divNodes, function ( node ) {\n\t\t *     return node.tagName.toLowerCase() === 'div';\n\t\t * }, false );\n\t\t *\n\t\t * //output: div\n\t\t * console.log( node.nodeName );\n\t\t * ```\n\t\t */\n\t\tfilterNodeList: function(nodelist, filter, forAll) {\n\t\t\tvar results = [];\n\t\t\tif (!utils.isFunction(filter)) {\n\t\t\t\tvar str = filter;\n\t\t\t\tfilter = function(n) {\n\t\t\t\t\treturn utils.indexOf(utils.isArray(str) ? str : str.split(' '), n.tagName.toLowerCase()) != -1\n\t\t\t\t};\n\t\t\t}\n\t\t\tutils.each(nodelist, function(n) {\n\t\t\t\tfilter(n) && results.push(n)\n\t\t\t});\n\t\t\treturn results.length == 0 ? null : results.length == 1 || !forAll ? results[0] : results\n\t\t},\n\n\t\t/**\n\t\t * 查询给定的range选区是否在给定的node节点内，且在该节点的最末尾\n\t\t * @method isInNodeEndBoundary\n\t\t * @param { UE.dom.Range } rng 需要判断的range对象， 该对象的startContainer不能为NULL\n\t\t * @param node 需要检测的节点对象\n\t\t * @return { Number } 如果给定的选取range对象是在node内部的最末端， 则返回1, 否则返回0\n\t\t */\n\t\tisInNodeEndBoundary: function(rng, node) {\n\t\t\tvar start = rng.startContainer;\n\t\t\tif (start.nodeType == 3 && rng.startOffset != start.nodeValue.length) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (start.nodeType == 1 && rng.startOffset != start.childNodes.length) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\twhile (start !== node) {\n\t\t\t\tif (start.nextSibling) {\n\t\t\t\t\treturn 0\n\t\t\t\t};\n\t\t\t\tstart = start.parentNode;\n\t\t\t}\n\t\t\treturn 1;\n\t\t},\n\t\tisBoundaryNode: function(node, dir) {\n\t\t\tvar tmp;\n\t\t\twhile (!domUtils.isBody(node)) {\n\t\t\t\ttmp = node;\n\t\t\t\tnode = node.parentNode;\n\t\t\t\tif (tmp !== node[dir]) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tfillHtml: browser.ie11below ? '&nbsp;' : '<br/>'\n\t};\n\tvar fillCharReg = new RegExp(domUtils.fillChar, 'g');\n\n\t// core/Range.js\n\t/**\n\t * Range封装\n\t * @file\n\t * @module UE.dom\n\t * @class Range\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * dom操作封装\n\t * @unfile\n\t * @module UE.dom\n\t */\n\n\t/**\n\t * Range实现类，本类是UEditor底层核心类，封装不同浏览器之间的Range操作。\n\t * @unfile\n\t * @module UE.dom\n\t * @class Range\n\t */\n\n\t(function() {\n\t\tvar guid = 0,\n\t\t\tfillChar = domUtils.fillChar,\n\t\t\tfillData;\n\n\t\t/**\n\t\t * 更新range的collapse状态\n\t\t * @param  {Range}   range    range对象\n\t\t */\n\t\tfunction updateCollapse(range) {\n\t\t\trange.collapsed =\n\t\t\t\trange.startContainer && range.endContainer &&\n\t\t\t\trange.startContainer === range.endContainer &&\n\t\t\t\trange.startOffset == range.endOffset;\n\t\t}\n\n\t\tfunction selectOneNode(rng) {\n\t\t\treturn !rng.collapsed && rng.startContainer.nodeType == 1 && rng.startContainer === rng.endContainer && rng.endOffset - rng.startOffset == 1\n\t\t}\n\n\t\tfunction setEndPoint(toStart, node, offset, range) {\n\t\t\t//如果node是自闭合标签要处理\n\t\t\tif (node.nodeType == 1 && (dtd.$empty[node.tagName] || dtd.$nonChild[node.tagName])) {\n\t\t\t\toffset = domUtils.getNodeIndex(node) + (toStart ? 0 : 1);\n\t\t\t\tnode = node.parentNode;\n\t\t\t}\n\t\t\tif (toStart) {\n\t\t\t\trange.startContainer = node;\n\t\t\t\trange.startOffset = offset;\n\t\t\t\tif (!range.endContainer) {\n\t\t\t\t\trange.collapse(true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trange.endContainer = node;\n\t\t\t\trange.endOffset = offset;\n\t\t\t\tif (!range.startContainer) {\n\t\t\t\t\trange.collapse(false);\n\t\t\t\t}\n\t\t\t}\n\t\t\tupdateCollapse(range);\n\t\t\treturn range;\n\t\t}\n\n\t\tfunction execContentsAction(range, action) {\n\t\t\t//调整边界\n\t\t\t//range.includeBookmark();\n\t\t\tvar start = range.startContainer,\n\t\t\t\tend = range.endContainer,\n\t\t\t\tstartOffset = range.startOffset,\n\t\t\t\tendOffset = range.endOffset,\n\t\t\t\tdoc = range.document,\n\t\t\t\tfrag = doc.createDocumentFragment(),\n\t\t\t\ttmpStart, tmpEnd;\n\t\t\tif (start.nodeType == 1) {\n\t\t\t\tstart = start.childNodes[startOffset] || (tmpStart = start.appendChild(doc.createTextNode('')));\n\t\t\t}\n\t\t\tif (end.nodeType == 1) {\n\t\t\t\tend = end.childNodes[endOffset] || (tmpEnd = end.appendChild(doc.createTextNode('')));\n\t\t\t}\n\t\t\tif (start === end && start.nodeType == 3) {\n\t\t\t\tfrag.appendChild(doc.createTextNode(start.substringData(startOffset, endOffset - startOffset)));\n\t\t\t\t//is not clone\n\t\t\t\tif (action) {\n\t\t\t\t\tstart.deleteData(startOffset, endOffset - startOffset);\n\t\t\t\t\trange.collapse(true);\n\t\t\t\t}\n\t\t\t\treturn frag;\n\t\t\t}\n\t\t\tvar current, currentLevel, clone = frag,\n\t\t\t\tstartParents = domUtils.findParents(start, true),\n\t\t\t\tendParents = domUtils.findParents(end, true);\n\t\t\tfor (var i = 0; startParents[i] == endParents[i];) {\n\t\t\t\ti++;\n\t\t\t}\n\t\t\tfor (var j = i, si; si = startParents[j]; j++) {\n\t\t\t\tcurrent = si.nextSibling;\n\t\t\t\tif (si == start) {\n\t\t\t\t\tif (!tmpStart) {\n\t\t\t\t\t\tif (range.startContainer.nodeType == 3) {\n\t\t\t\t\t\t\tclone.appendChild(doc.createTextNode(start.nodeValue.slice(startOffset)));\n\t\t\t\t\t\t\t//is not clone\n\t\t\t\t\t\t\tif (action) {\n\t\t\t\t\t\t\t\tstart.deleteData(startOffset, start.nodeValue.length - startOffset);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tclone.appendChild(!action ? start.cloneNode(true) : start);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcurrentLevel = si.cloneNode(false);\n\t\t\t\t\tclone.appendChild(currentLevel);\n\t\t\t\t}\n\t\t\t\twhile (current) {\n\t\t\t\t\tif (current === end || current === endParents[j]) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tsi = current.nextSibling;\n\t\t\t\t\tclone.appendChild(!action ? current.cloneNode(true) : current);\n\t\t\t\t\tcurrent = si;\n\t\t\t\t}\n\t\t\t\tclone = currentLevel;\n\t\t\t}\n\t\t\tclone = frag;\n\t\t\tif (!startParents[i]) {\n\t\t\t\tclone.appendChild(startParents[i - 1].cloneNode(false));\n\t\t\t\tclone = clone.firstChild;\n\t\t\t}\n\t\t\tfor (var j = i, ei; ei = endParents[j]; j++) {\n\t\t\t\tcurrent = ei.previousSibling;\n\t\t\t\tif (ei == end) {\n\t\t\t\t\tif (!tmpEnd && range.endContainer.nodeType == 3) {\n\t\t\t\t\t\tclone.appendChild(doc.createTextNode(end.substringData(0, endOffset)));\n\t\t\t\t\t\t//is not clone\n\t\t\t\t\t\tif (action) {\n\t\t\t\t\t\t\tend.deleteData(0, endOffset);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcurrentLevel = ei.cloneNode(false);\n\t\t\t\t\tclone.appendChild(currentLevel);\n\t\t\t\t}\n\t\t\t\t//如果两端同级，右边第一次已经被开始做了\n\t\t\t\tif (j != i || !startParents[i]) {\n\t\t\t\t\twhile (current) {\n\t\t\t\t\t\tif (current === start) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tei = current.previousSibling;\n\t\t\t\t\t\tclone.insertBefore(!action ? current.cloneNode(true) : current, clone.firstChild);\n\t\t\t\t\t\tcurrent = ei;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclone = currentLevel;\n\t\t\t}\n\t\t\tif (action) {\n\t\t\t\trange.setStartBefore(!endParents[i] ? endParents[i - 1] : !startParents[i] ? startParents[i - 1] : endParents[i]).collapse(true);\n\t\t\t}\n\t\t\ttmpStart && domUtils.remove(tmpStart);\n\t\t\ttmpEnd && domUtils.remove(tmpEnd);\n\t\t\treturn frag;\n\t\t}\n\n\t\t/**\n\t\t * 创建一个跟document绑定的空的Range实例\n\t\t * @constructor\n\t\t * @param { Document } document 新建的选区所属的文档对象\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } startContainer 当前Range的开始边界的容器节点, 可以是一个元素节点或者是文本节点\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } startOffset 当前Range的开始边界容器节点的偏移量, 如果是元素节点，\n\t\t *                              该值就是childNodes中的第几个节点， 如果是文本节点就是文本内容的第几个字符\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } endContainer 当前Range的结束边界的容器节点, 可以是一个元素节点或者是文本节点\n\t\t */\n\n\t\t/**\n\t\t * @property { Node } endOffset 当前Range的结束边界容器节点的偏移量, 如果是元素节点，\n\t\t *                              该值就是childNodes中的第几个节点， 如果是文本节点就是文本内容的第几个字符\n\t\t */\n\n\t\t/**\n\t\t * @property { Boolean } collapsed 当前Range是否闭合\n\t\t * @default true\n\t\t * @remind Range是闭合的时候， startContainer === endContainer && startOffset === endOffset\n\t\t */\n\n\t\t/**\n\t\t * @property { Document } document 当前Range所属的Document对象\n\t\t * @remind 不同range的的document属性可以是不同的\n\t\t */\n\t\tvar Range = dom.Range = function(document) {\n\t\t\tvar me = this;\n\t\t\tme.startContainer =\n\t\t\t\tme.startOffset =\n\t\t\t\tme.endContainer =\n\t\t\t\tme.endOffset = null;\n\t\t\tme.document = document;\n\t\t\tme.collapsed = true;\n\t\t};\n\n\t\t/**\n\t\t * 删除fillData\n\t\t * @param doc\n\t\t * @param excludeNode\n\t\t */\n\t\tfunction removeFillData(doc, excludeNode) {\n\t\t\ttry {\n\t\t\t\tif (fillData && domUtils.inDoc(fillData, doc)) {\n\t\t\t\t\tif (!fillData.nodeValue.replace(fillCharReg, '').length) {\n\t\t\t\t\t\tvar tmpNode = fillData.parentNode;\n\t\t\t\t\t\tdomUtils.remove(fillData);\n\t\t\t\t\t\twhile (tmpNode && domUtils.isEmptyInlineElement(tmpNode) &&\n\t\t\t\t\t\t\t//safari的contains有bug\n\t\t\t\t\t\t\t(browser.safari ? !(domUtils.getPosition(tmpNode, excludeNode) & domUtils.POSITION_CONTAINS) : !tmpNode.contains(excludeNode))\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tfillData = tmpNode.parentNode;\n\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\ttmpNode = fillData;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfillData.nodeValue = fillData.nodeValue.replace(fillCharReg, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\t/**\n\t\t * @param node\n\t\t * @param dir\n\t\t */\n\t\tfunction mergeSibling(node, dir) {\n\t\t\tvar tmpNode;\n\t\t\tnode = node[dir];\n\t\t\twhile (node && domUtils.isFillChar(node)) {\n\t\t\t\ttmpNode = node[dir];\n\t\t\t\tdomUtils.remove(node);\n\t\t\t\tnode = tmpNode;\n\t\t\t}\n\t\t}\n\n\t\tRange.prototype = {\n\n\t\t\t/**\n\t\t\t * 克隆选区的内容到一个DocumentFragment里\n\t\t\t * @method cloneContents\n\t\t\t * @return { DocumentFragment | NULL } 如果选区是闭合的将返回null， 否则， 返回包含所clone内容的DocumentFragment元素\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t *\n\t\t\t *      <script>\n\t\t\t *          //range是已选中的选区\n\t\t\t *          var fragment = range.cloneContents(),\n\t\t\t *              node = document.createElement(\"div\");\n\t\t\t *\n\t\t\t *          node.appendChild( fragment );\n\t\t\t *\n\t\t\t *          //output: <i>x</i>xx\n\t\t\t *          console.log( node.innerHTML );\n\t\t\t *\n\t\t\t *      </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tcloneContents: function() {\n\t\t\t\treturn this.collapsed ? null : execContentsAction(this, 0);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 删除当前选区范围中的所有内容\n\t\t\t * @method deleteContents\n\t\t\t * @remind 执行完该操作后， 当前Range对象变成了闭合状态\n\t\t\t * @return { UE.dom.Range } 当前操作的Range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t *\n\t\t\t *      <script>\n\t\t\t *          //range是已选中的选区\n\t\t\t *          range.deleteContents();\n\t\t\t *\n\t\t\t *          //竖线表示闭合后的选区位置\n\t\t\t *          //output: <b>x<i>x</i>|x</b>\n\t\t\t *          console.log( document.body.innerHTML );\n\t\t\t *\n\t\t\t *          //此时， range的各项属性为\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.startContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.startOffset );\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.endContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.endOffset );\n\t\t\t *          //output: true\n\t\t\t *          console.log( range.collapsed );\n\t\t\t *\n\t\t\t *      </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tdeleteContents: function() {\n\t\t\t\tvar txt;\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\texecContentsAction(this, 1);\n\t\t\t\t}\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\ttxt = this.startContainer;\n\t\t\t\t\tif (txt.nodeType == 3 && !txt.nodeValue.length) {\n\t\t\t\t\t\tthis.setStartBefore(txt).collapse(true);\n\t\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将当前选区的内容提取到一个DocumentFragment里\n\t\t\t * @method extractContents\n\t\t\t * @remind 执行该操作后， 选区将变成闭合状态\n\t\t\t * @warning 执行该操作后， 原来选区所选中的内容将从dom树上剥离出来\n\t\t\t * @return { DocumentFragment } 返回包含所提取内容的DocumentFragment对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *      <!-- 中括号表示选区 -->\n\t\t\t *      <b>x<i>x[x</i>xx]x</b>\n\t\t\t *\n\t\t\t *      <script>\n\t\t\t *          //range是已选中的选区\n\t\t\t *          var fragment = range.extractContents(),\n\t\t\t *              node = document.createElement( \"div\" );\n\t\t\t *\n\t\t\t *          node.appendChild( fragment );\n\t\t\t *\n\t\t\t *          //竖线表示闭合后的选区位置\n\t\t\t *\n\t\t\t *          //output: <b>x<i>x</i>|x</b>\n\t\t\t *          console.log( document.body.innerHTML );\n\t\t\t *          //output: <i>x</i>xx\n\t\t\t *          console.log( node.innerHTML );\n\t\t\t *\n\t\t\t *          //此时， range的各项属性为\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.startContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.startOffset );\n\t\t\t *          //output: B\n\t\t\t *          console.log( range.endContainer.tagName );\n\t\t\t *          //output: 2\n\t\t\t *          console.log( range.endOffset );\n\t\t\t *          //output: true\n\t\t\t *          console.log( range.collapsed );\n\t\t\t *\n\t\t\t *      </script>\n\t\t\t * </body>\n\t\t\t */\n\t\t\textractContents: function() {\n\t\t\t\treturn this.collapsed ? null : execContentsAction(this, 2);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的开始容器节点和偏移量\n\t\t\t * @method  setStart\n\t\t\t * @remind 如果给定的节点是元素节点，那么offset指的是其子元素中索引为offset的元素，\n\t\t\t *          如果是文本节点，那么offset指的是其文本内容的第offset个字符\n\t\t\t * @remind 如果提供的容器节点是一个不能包含子元素的节点， 则该选区的开始容器将被设置\n\t\t\t *          为该节点的父节点， 此时， 其距离开始容器的偏移量也变成了该节点在其父节点\n\t\t\t *          中的索引\n\t\t\t * @param { Node } node 将被设为当前选区开始边界容器的节点对象\n\t\t\t * @param { int } offset 选区的开始位置偏移量\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区 -->\n\t\t\t * <b>xxx<i>x<span>xx</span>xx<em>xx</em>xxx</i>[xxx]</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStart( document.getElementsByTagName(\"i\")[0], 1 );\n\t\t\t *\n\t\t\t *     //此时， 选区变成了\n\t\t\t *     //<b>xxx<i>x[<span>xx</span>xx<em>xx</em>xxx</i>xxx]</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区 -->\n\t\t\t * <b>xxx<img>[xx]x</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStart( document.getElementsByTagName(\"img\")[0], 3 );\n\t\t\t *\n\t\t\t *     //此时， 选区变成了\n\t\t\t *     //<b>xxx[<img>xx]x</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStart: function(node, offset) {\n\t\t\t\treturn setEndPoint(true, node, offset, this);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的结束容器和偏移量\n\t\t\t * @method  setEnd\n\t\t\t * @param { Node } node 作为当前选区结束边界容器的节点对象\n\t\t\t * @param { int } offset 结束边界的偏移量\n\t\t\t * @see UE.dom.Range:setStart(Node,int)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEnd: function(node, offset) {\n\t\t\t\treturn setEndPoint(false, node, offset, this);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range开始位置设置到node节点之后\n\t\t\t * @method  setStartAfter\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的开始容器， 且偏移量是该节点在其父节点中的位置索引+1\n\t\t\t * @param { Node } node 选区的开始边界将紧接着该节点之后\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>xx[x</span>xxx]</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStartAfter( document.getElementsByTagName(\"i\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>xx<i>xxx</i>[<span>xxx</span>xxx]</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStartAfter: function(node) {\n\t\t\t\treturn this.setStart(node.parentNode, domUtils.getNodeIndex(node) + 1);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range开始位置设置到node节点之前\n\t\t\t * @method  setStartBefore\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的开始容器， 且偏移量是该节点在其父节点中的位置索引\n\t\t\t * @param { Node } node 新的选区开始位置在该节点之前\n\t\t\t * @see UE.dom.Range:setStartAfter(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetStartBefore: function(node) {\n\t\t\t\treturn this.setStart(node.parentNode, domUtils.getNodeIndex(node));\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range结束位置设置到node节点之后\n\t\t\t * @method  setEndAfter\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的结束容器， 且偏移量是该节点在其父节点中的位置索引+1\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setStartAfter(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>[xx<i>xxx</i><span>xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStartAfter( document.getElementsByTagName(\"span\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>[xx<i>xxx</i><span>xxx</span>]xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetEndAfter: function(node) {\n\t\t\t\treturn this.setEnd(node.parentNode, domUtils.getNodeIndex(node) + 1);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 将Range结束位置设置到node节点之前\n\t\t\t * @method  setEndBefore\n\t\t\t * @remind 该操作将会把给定节点的父节点作为range的结束容器， 且偏移量是该节点在其父节点中的位置索引\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setEndAfter(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEndBefore: function(node) {\n\t\t\t\treturn this.setEnd(node.parentNode, domUtils.getNodeIndex(node));\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的开始位置到node节点内的第一个子节点之前\n\t\t\t * @method  setStartAtFirst\n\t\t\t * @remind 选区的开始容器将变成给定的节点， 且偏移量为0\n\t\t\t * @remind 如果给定的节点是元素节点， 则该节点必须是允许包含子节点的元素。\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setStartBefore(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.setStartAtFirst( document.getElementsByTagName(\"i\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>xx<i>[xxx</i><span>xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStartAtFirst: function(node) {\n\t\t\t\treturn this.setStart(node, 0);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的开始位置到node节点内的最后一个节点之后\n\t\t\t * @method setStartAtLast\n\t\t\t * @remind 选区的开始容器将变成给定的节点， 且偏移量为该节点的子节点数\n\t\t\t * @remind 如果给定的节点是元素节点， 则该节点必须是允许包含子节点的元素。\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetStartAtLast: function(node) {\n\t\t\t\treturn this.setStart(node, node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的结束位置到node节点内的第一个节点之前\n\t\t\t * @method  setEndAtFirst\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @remind 选区的结束容器将变成给定的节点， 且偏移量为0\n\t\t\t * @remind node必须是一个元素节点， 且必须是允许包含子节点的元素。\n\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEndAtFirst: function(node) {\n\t\t\t\treturn this.setEnd(node, 0);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置Range的结束位置到node节点内的最后一个节点之后\n\t\t\t * @method  setEndAtLast\n\t\t\t * @param { Node } node 目标节点\n\t\t\t * @remind 选区的结束容器将变成给定的节点， 且偏移量为该节点的子节点数量\n\t\t\t * @remind node必须是一个元素节点， 且必须是允许包含子节点的元素。\n\t\t\t * @see UE.dom.Range:setStartAtFirst(Node)\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tsetEndAtLast: function(node) {\n\t\t\t\treturn this.setEnd(node, node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 选中给定节点\n\t\t\t * @method  selectNode\n\t\t\t * @remind 此时， 选区的开始容器和结束容器都是该节点的父节点， 其startOffset是该节点在父节点中的位置索引，\n\t\t\t *          而endOffset为startOffset+1\n\t\t\t * @param { Node } node 需要选中的节点\n\t\t\t * @return { UE.dom.Range } 当前range对象，此时的range仅包含当前给定的节点对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.selectNode( document.getElementsByTagName(\"i\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>xx[<i>xxx</i>]<span>xxx</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tselectNode: function(node) {\n\t\t\t\treturn this.setStartBefore(node).setEndAfter(node);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 选中给定节点内部的所有节点\n\t\t\t * @method  selectNodeContents\n\t\t\t * @remind 此时， 选区的开始容器和结束容器都是该节点， 其startOffset为0，\n\t\t\t *          而endOffset是该节点的子节点数。\n\t\t\t * @param { Node } node 目标节点， 当前range将包含该节点内的所有节点\n\t\t\t * @return { UE.dom.Range } 当前range对象， 此时range仅包含给定节点的所有子节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.selectNode( document.getElementsByTagName(\"b\")[0] );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>[xx<i>xxx</i><span>xxx</span>xxx]</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tselectNodeContents: function(node) {\n\t\t\t\treturn this.setStart(node, 0).setEndAtLast(node);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * clone当前Range对象\n\t\t\t * @method  cloneRange\n\t\t\t * @remind 返回的range是一个全新的range对象， 其内部所有属性与当前被clone的range相同。\n\t\t\t * @return { UE.dom.Range } 当前range对象的一个副本\n\t\t\t */\n\t\t\tcloneRange: function() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn new Range(me.document).setStart(me.startContainer, me.startOffset).setEnd(me.endContainer, me.endOffset);\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 向当前选区的结束处闭合选区\n\t\t\t * @method  collapse\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.collapse();\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //“|”表示选区已闭合\n\t\t\t *     //<b>xx<i>xxx</i><span>xx|x</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 闭合当前选区，根据给定的toStart参数项决定是向当前选区开始处闭合还是向结束处闭合，\n\t\t\t * 如果toStart的值为true，则向开始位置闭合， 反之，向结束位置闭合。\n\t\t\t * @method  collapse\n\t\t\t * @param { Boolean } toStart 是否向选区开始处闭合\n\t\t\t * @return { UE.dom.Range } 当前range对象，此时range对象处于闭合状态\n\t\t\t * @see UE.dom.Range:collapse()\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>xx<i>xxx</i><span>[xx]x</span>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行操作\n\t\t\t *     range.collapse( true );\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //“|”表示选区已闭合\n\t\t\t *     //<b>xx<i>xxx</i><span>|xxx</span>xxx</b>\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\tcollapse: function(toStart) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (toStart) {\n\t\t\t\t\tme.endContainer = me.startContainer;\n\t\t\t\t\tme.endOffset = me.startOffset;\n\t\t\t\t} else {\n\t\t\t\t\tme.startContainer = me.endContainer;\n\t\t\t\t\tme.startOffset = me.endOffset;\n\t\t\t\t}\n\t\t\t\tme.collapsed = true;\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 调整range的开始位置和结束位置，使其\"收缩\"到最小的位置\n\t\t\t * @method  shrinkBoundary\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <span>xx<b>xx[</b>xxxxx]</span> => <span>xx<b>xx</b>[xxxxx]</span>\n\t\t\t * ```\n\t\t\t *\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <!-- 选区示例 -->\n\t\t\t * <b>x[xx</b><i>]xxx</i>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //执行收缩\n\t\t\t *     range.shrinkBoundary();\n\t\t\t *\n\t\t\t *     //结果选区\n\t\t\t *     //<b>x[xx]</b><i>xxx</i>\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t *\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * [<b><i>xxxx</i>xxxxxxx</b>] => <b><i>[xxxx</i>xxxxxxx]</b>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 调整range的开始位置和结束位置，使其\"收缩\"到最小的位置，\n\t\t\t * 如果ignoreEnd的值为true，则忽略对结束位置的调整\n\t\t\t * @method  shrinkBoundary\n\t\t\t * @param { Boolean } ignoreEnd 是否忽略对结束位置的调整\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.domUtils.Range:shrinkBoundary()\n\t\t\t */\n\t\t\tshrinkBoundary: function(ignoreEnd) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tchild,\n\t\t\t\t\tcollapsed = me.collapsed;\n\n\t\t\t\tfunction check(node) {\n\t\t\t\t\treturn node.nodeType == 1 && !domUtils.isBookmarkNode(node) && !dtd.$empty[node.tagName] && !dtd.$nonChild[node.tagName]\n\t\t\t\t}\n\t\t\t\twhile (me.startContainer.nodeType == 1 //是element\n\t\t\t\t\t&& (child = me.startContainer.childNodes[me.startOffset]) //子节点也是element\n\t\t\t\t\t&& check(child)) {\n\t\t\t\t\tme.setStart(child, 0);\n\t\t\t\t}\n\t\t\t\tif (collapsed) {\n\t\t\t\t\treturn me.collapse(true);\n\t\t\t\t}\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\twhile (me.endContainer.nodeType == 1 //是element\n\t\t\t\t\t\t&& me.endOffset > 0 //如果是空元素就退出 endOffset=0那么endOffst-1为负值，childNodes[endOffset]报错\n\t\t\t\t\t\t&& (child = me.endContainer.childNodes[me.endOffset - 1]) //子节点也是element\n\t\t\t\t\t\t&& check(child)) {\n\t\t\t\t\t\tme.setEnd(child, child.childNodes.length);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取离当前选区内包含的所有节点最近的公共祖先节点，\n\t\t\t * @method  getCommonAncestor\n\t\t\t * @remind 返回的公共祖先节点一定不是range自身的容器节点， 但有可能是一个文本节点\n\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * //选区示例\n\t\t\t * <span>xxx<b>x[x<em>xx]x</em>xxx</b>xx</span>\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     var node = range.getCommonAncestor();\n\t\t\t *\n\t\t\t *     //公共祖先节点是： b节点\n\t\t\t *     //输出： B\n\t\t\t *     console.log(node.tagName);\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 获取当前选区所包含的所有节点的公共祖先节点， 可以根据给定的参数 includeSelf 决定获取到\n\t\t\t * 的公共祖先节点是否可以是当前选区的startContainer或endContainer节点， 如果 includeSelf\n\t\t\t * 的取值为true， 则返回的节点可以是自身的容器节点， 否则， 则不能是容器节点\n\t\t\t * @method  getCommonAncestor\n\t\t\t * @param { Boolean } includeSelf 是否允许获取到的公共祖先节点是当前range对象的容器节点\n\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t * @see UE.dom.Range:getCommonAncestor()\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区示例 -->\n\t\t\t *     <b>xxx<i>xxxx<span>xx[x</span>xx]x</i>xxxxxxx</b>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *\n\t\t\t *         var node = range.getCommonAncestor( false );\n\t\t\t *\n\t\t\t *         //这里的公共祖先节点是B而不是I， 是因为参数限制了获取到的节点不能是容器节点\n\t\t\t *         //output: B\n\t\t\t *         console.log( node.tagName );\n\t\t\t *\n\t\t\t *     </script>\n\t\t\t *\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 获取当前选区所包含的所有节点的公共祖先节点， 可以根据给定的参数 includeSelf 决定获取到\n\t\t\t * 的公共祖先节点是否可以是当前选区的startContainer或endContainer节点， 如果 includeSelf\n\t\t\t * 的取值为true， 则返回的节点可以是自身的容器节点， 否则， 则不能是容器节点； 同时可以根据\n\t\t\t * ignoreTextNode 参数的取值决定是否忽略类型为文本节点的祖先节点。\n\t\t\t * @method  getCommonAncestor\n\t\t\t * @param { Boolean } includeSelf 是否允许获取到的公共祖先节点是当前range对象的容器节点\n\t\t\t * @param { Boolean } ignoreTextNode 获取祖先节点的过程中是否忽略类型为文本节点的祖先节点\n\t\t\t * @return { Node } 当前range对象内所有节点的公共祖先节点\n\t\t\t * @see UE.dom.Range:getCommonAncestor()\n\t\t\t * @see UE.dom.Range:getCommonAncestor(Boolean)\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区示例 -->\n\t\t\t *     <b>xxx<i>xxxx<span>x[x]x</span>xxx</i>xxxxxxx</b>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *\n\t\t\t *         var node = range.getCommonAncestor( true, false );\n\t\t\t *\n\t\t\t *         //output: SPAN\n\t\t\t *         console.log( node.tagName );\n\t\t\t *\n\t\t\t *     </script>\n\t\t\t *\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetCommonAncestor: function(includeSelf, ignoreTextNode) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tstart = me.startContainer,\n\t\t\t\t\tend = me.endContainer;\n\t\t\t\tif (start === end) {\n\t\t\t\t\tif (includeSelf && selectOneNode(this)) {\n\t\t\t\t\t\tstart = start.childNodes[me.startOffset];\n\t\t\t\t\t\tif (start.nodeType == 1)\n\t\t\t\t\t\t\treturn start;\n\t\t\t\t\t}\n\t\t\t\t\t//只有在上来就相等的情况下才会出现是文本的情况\n\t\t\t\t\treturn ignoreTextNode && start.nodeType == 3 ? start.parentNode : start;\n\t\t\t\t}\n\t\t\t\treturn domUtils.getCommonAncestor(start, end);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 调整当前Range的开始和结束边界容器，如果是容器节点是文本节点,就调整到包含该文本节点的父节点上\n\t\t\t * @method trimBoundary\n\t\t\t * @remind 该操作有可能会引起文本节点被切开\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * //选区示例\n\t\t\t * <b>xxx<i>[xxxxx]</i>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     //未调整前， 选区的开始容器和结束都是文本节点\n\t\t\t *     //执行调整\n\t\t\t *     range.trimBoundary();\n\t\t\t *\n\t\t\t *     //调整之后， 容器节点变成了i节点\n\t\t\t *     //<b>xxx[<i>xxxxx</i>]xxx</b>\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 调整当前Range的开始和结束边界容器，如果是容器节点是文本节点,就调整到包含该文本节点的父节点上，\n\t\t\t * 可以根据 ignoreEnd 参数的值决定是否调整对结束边界的调整\n\t\t\t * @method trimBoundary\n\t\t\t * @param { Boolean } ignoreEnd 是否忽略对结束边界的调整\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * //选区示例\n\t\t\t * <b>xxx<i>[xxxxx]</i>xxx</b>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *     //未调整前， 选区的开始容器和结束都是文本节点\n\t\t\t *     //执行调整\n\t\t\t *     range.trimBoundary( true );\n\t\t\t *\n\t\t\t *     //调整之后， 开始容器节点变成了i节点\n\t\t\t *     //但是， 结束容器没有发生变化\n\t\t\t *     //<b>xxx[<i>xxxxx]</i>xxx</b>\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\ttrimBoundary: function(ignoreEnd) {\n\t\t\t\tthis.txtToElmBoundary();\n\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\toffset = this.startOffset,\n\t\t\t\t\tcollapsed = this.collapsed,\n\t\t\t\t\tend = this.endContainer;\n\t\t\t\tif (start.nodeType == 3) {\n\t\t\t\t\tif (offset == 0) {\n\t\t\t\t\t\tthis.setStartBefore(start);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (offset >= start.nodeValue.length) {\n\t\t\t\t\t\t\tthis.setStartAfter(start);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar textNode = domUtils.split(start, offset);\n\t\t\t\t\t\t\t//跟新结束边界\n\t\t\t\t\t\t\tif (start === end) {\n\t\t\t\t\t\t\t\tthis.setEnd(textNode, this.endOffset - offset);\n\t\t\t\t\t\t\t} else if (start.parentNode === end) {\n\t\t\t\t\t\t\t\tthis.endOffset += 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setStartBefore(textNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\treturn this.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\toffset = this.endOffset;\n\t\t\t\t\tend = this.endContainer;\n\t\t\t\t\tif (end.nodeType == 3) {\n\t\t\t\t\t\tif (offset == 0) {\n\t\t\t\t\t\t\tthis.setEndBefore(end);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toffset < end.nodeValue.length && domUtils.split(end, offset);\n\t\t\t\t\t\t\tthis.setEndAfter(end);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 如果选区在文本的边界上，就扩展选区到文本的父节点上, 如果当前选区是闭合的， 则什么也不做\n\t\t\t * @method txtToElmBoundary\n\t\t\t * @remind 该操作不会修改dom节点\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 如果选区在文本的边界上，就扩展选区到文本的父节点上, 如果当前选区是闭合的， 则根据参数项\n\t\t\t * ignoreCollapsed 的值决定是否执行该调整\n\t\t\t * @method txtToElmBoundary\n\t\t\t * @param { Boolean } ignoreCollapsed 是否忽略选区的闭合状态， 如果该参数取值为true， 则\n\t\t\t *                      不论选区是否闭合， 都会执行该操作， 反之， 则不会对闭合的选区执行该操作\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\ttxtToElmBoundary: function(ignoreCollapsed) {\n\t\t\t\tfunction adjust(r, c) {\n\t\t\t\t\tvar container = r[c + 'Container'],\n\t\t\t\t\t\toffset = r[c + 'Offset'];\n\t\t\t\t\tif (container.nodeType == 3) {\n\t\t\t\t\t\tif (!offset) {\n\t\t\t\t\t\t\tr['set' + c.replace(/(\\w)/, function(a) {\n\t\t\t\t\t\t\t\treturn a.toUpperCase();\n\t\t\t\t\t\t\t}) + 'Before'](container);\n\t\t\t\t\t\t} else if (offset >= container.nodeValue.length) {\n\t\t\t\t\t\t\tr['set' + c.replace(/(\\w)/, function(a) {\n\t\t\t\t\t\t\t\treturn a.toUpperCase();\n\t\t\t\t\t\t\t}) + 'After'](container);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (ignoreCollapsed || !this.collapsed) {\n\t\t\t\t\tadjust(this, 'start');\n\t\t\t\t\tadjust(this, 'end');\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在当前选区的开始位置前插入节点，新插入的节点会被该range包含\n\t\t\t * @method  insertNode\n\t\t\t * @param { Node } node 需要插入的节点\n\t\t\t * @remind 插入的节点可以是一个DocumentFragment依次插入多个节点\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tinsertNode: function(node) {\n\t\t\t\tvar first = node,\n\t\t\t\t\tlength = 1;\n\t\t\t\tif (node.nodeType == 11) {\n\t\t\t\t\tfirst = node.firstChild;\n\t\t\t\t\tlength = node.childNodes.length;\n\t\t\t\t}\n\t\t\t\tthis.trimBoundary(true);\n\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\toffset = this.startOffset;\n\t\t\t\tvar nextNode = start.childNodes[offset];\n\t\t\t\tif (nextNode) {\n\t\t\t\t\tstart.insertBefore(node, nextNode);\n\t\t\t\t} else {\n\t\t\t\t\tstart.appendChild(node);\n\t\t\t\t}\n\t\t\t\tif (first.parentNode === this.endContainer) {\n\t\t\t\t\tthis.endOffset = this.endOffset + length;\n\t\t\t\t}\n\t\t\t\treturn this.setStartBefore(first);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 闭合选区到当前选区的开始位置， 并且定位光标到闭合后的位置\n\t\t\t * @method  setCursor\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:collapse()\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 闭合选区，可以根据参数toEnd的值控制选区是向前闭合还是向后闭合， 并且定位光标到闭合后的位置。\n\t\t\t * @method  setCursor\n\t\t\t * @param { Boolean } toEnd 是否向后闭合， 如果为true， 则闭合选区时， 将向结束容器方向闭合，\n\t\t\t *                      反之，则向开始容器方向闭合\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:collapse(Boolean)\n\t\t\t */\n\t\t\tsetCursor: function(toEnd, noFillData) {\n\t\t\t\treturn this.collapse(!toEnd).select(noFillData);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 创建当前range的一个书签，记录下当前range的位置，方便当dom树改变时，还能找回原来的选区位置\n\t\t\t * @method createBookmark\n\t\t\t * @param { Boolean } serialize 控制返回的标记位置是对当前位置的引用还是ID，如果该值为true，则\n\t\t\t *                              返回标记位置的ID， 反之则返回标记位置节点的引用\n\t\t\t * @return { Object } 返回一个书签记录键值对， 其包含的key有： start => 开始标记的ID或者引用，\n\t\t\t *                          end => 结束标记的ID或引用， id => 当前标记的类型， 如果为true，则表示\n\t\t\t *                          返回的记录的类型为ID， 反之则为引用\n\t\t\t */\n\t\t\tcreateBookmark: function(serialize, same) {\n\t\t\t\tvar endNode,\n\t\t\t\t\tstartNode = this.document.createElement('span');\n\t\t\t\tstartNode.style.cssText = 'display:none;line-height:0px;';\n\t\t\t\tstartNode.appendChild(this.document.createTextNode('\\u200D'));\n\t\t\t\tstartNode.id = '_baidu_bookmark_start_' + (same ? '' : guid++);\n\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\tendNode = startNode.cloneNode(true);\n\t\t\t\t\tendNode.id = '_baidu_bookmark_end_' + (same ? '' : guid++);\n\t\t\t\t}\n\t\t\t\tthis.insertNode(startNode);\n\t\t\t\tif (endNode) {\n\t\t\t\t\tthis.collapse().insertNode(endNode).setEndBefore(endNode);\n\t\t\t\t}\n\t\t\t\tthis.setStartAfter(startNode);\n\t\t\t\treturn {\n\t\t\t\t\tstart: serialize ? startNode.id : startNode,\n\t\t\t\t\tend: endNode ? serialize ? endNode.id : endNode : null,\n\t\t\t\t\tid: serialize\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t *  调整当前range的边界到书签位置，并删除该书签对象所标记的位置内的节点\n\t\t\t *  @method  moveToBookmark\n\t\t\t *  @param { BookMark } bookmark createBookmark所创建的标签对象\n\t\t\t *  @return { UE.dom.Range } 当前range对象\n\t\t\t *  @see UE.dom.Range:createBookmark(Boolean)\n\t\t\t */\n\t\t\tmoveToBookmark: function(bookmark) {\n\t\t\t\tvar start = bookmark.id ? this.document.getElementById(bookmark.start) : bookmark.start,\n\t\t\t\t\tend = bookmark.end && bookmark.id ? this.document.getElementById(bookmark.end) : bookmark.end;\n\t\t\t\tthis.setStartBefore(start);\n\t\t\t\tdomUtils.remove(start);\n\t\t\t\tif (end) {\n\t\t\t\t\tthis.setEndBefore(end);\n\t\t\t\t\tdomUtils.remove(end);\n\t\t\t\t} else {\n\t\t\t\t\tthis.collapse(true);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 调整range的边界，使其\"放大\"到最近的父节点\n\t\t\t * @method  enlarge\n\t\t\t * @remind 会引起选区的变化\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 调整range的边界，使其\"放大\"到最近的父节点，根据参数 toBlock 的取值， 可以\n\t\t\t * 要求扩大之后的父节点是block节点\n\t\t\t * @method  enlarge\n\t\t\t * @param { Boolean } toBlock 是否要求扩大之后的父节点必须是block节点\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t */\n\t\t\tenlarge: function(toBlock, stopFn) {\n\t\t\t\tvar isBody = domUtils.isBody,\n\t\t\t\t\tpre, node, tmp = this.document.createTextNode('');\n\t\t\t\tif (toBlock) {\n\t\t\t\t\tnode = this.startContainer;\n\t\t\t\t\tif (node.nodeType == 1) {\n\t\t\t\t\t\tif (node.childNodes[this.startOffset]) {\n\t\t\t\t\t\t\tpre = node = node.childNodes[this.startOffset]\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.appendChild(tmp);\n\t\t\t\t\t\t\tpre = node = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t}\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (domUtils.isBlockElm(node)) {\n\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\twhile ((pre = node.previousSibling) && !domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setStartBefore(node);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tnode = this.endContainer;\n\t\t\t\t\tif (node.nodeType == 1) {\n\t\t\t\t\t\tif (pre = node.childNodes[this.endOffset]) {\n\t\t\t\t\t\t\tnode.insertBefore(tmp, pre);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode.appendChild(tmp);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre = node = tmp;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t}\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (domUtils.isBlockElm(node)) {\n\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\twhile ((pre = node.nextSibling) && !domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\tnode = pre;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.setEndAfter(node);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (tmp.parentNode === this.endContainer) {\n\t\t\t\t\t\tthis.endOffset--;\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.remove(tmp);\n\t\t\t\t}\n\n\t\t\t\t// 扩展边界到最大\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\twhile (this.startOffset == 0) {\n\t\t\t\t\t\tif (stopFn && stopFn(this.startContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isBody(this.startContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setStartBefore(this.startContainer);\n\t\t\t\t\t}\n\t\t\t\t\twhile (this.endOffset == (this.endContainer.nodeType == 1 ? this.endContainer.childNodes.length : this.endContainer.nodeValue.length)) {\n\t\t\t\t\t\tif (stopFn && stopFn(this.endContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isBody(this.endContainer)) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.setEndAfter(this.endContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tenlargeToBlockElm: function(ignoreEnd) {\n\t\t\t\twhile (!domUtils.isBlockElm(this.startContainer)) {\n\t\t\t\t\tthis.setStartBefore(this.startContainer);\n\t\t\t\t}\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\twhile (!domUtils.isBlockElm(this.endContainer)) {\n\t\t\t\t\t\tthis.setEndAfter(this.endContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 调整Range的边界，使其\"缩小\"到最合适的位置\n\t\t\t * @method adjustmentBoundary\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:shrinkBoundary()\n\t\t\t */\n\t\t\tadjustmentBoundary: function() {\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\twhile (!domUtils.isBody(this.startContainer) &&\n\t\t\t\t\t\tthis.startOffset == this.startContainer[this.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length &&\n\t\t\t\t\t\tthis.startContainer[this.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t\t) {\n\n\t\t\t\t\t\tthis.setStartAfter(this.startContainer);\n\t\t\t\t\t}\n\t\t\t\t\twhile (!domUtils.isBody(this.endContainer) && !this.endOffset &&\n\t\t\t\t\t\tthis.endContainer[this.endContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.setEndBefore(this.endContainer);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 给range选区中的内容添加给定的inline标签\n\t\t\t * @method applyInlineStyle\n\t\t\t * @param { String } tagName 需要添加的标签名\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <p>xxxx[xxxx]x</p>  ==>  range.applyInlineStyle(\"strong\")  ==>  <p>xxxx[<strong>xxxx</strong>]x</p>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 给range选区中的内容添加给定的inline标签， 并且为标签附加上一些初始化属性。\n\t\t\t * @method applyInlineStyle\n\t\t\t * @param { String } tagName 需要添加的标签名\n\t\t\t * @param { Object } attrs 跟随新添加的标签的属性\n\t\t\t * @return { UE.dom.Range } 当前选区\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <p>xxxx[xxxx]x</p>\n\t\t\t *\n\t\t\t * ==>\n\t\t\t *\n\t\t\t * <!-- 执行操作 -->\n\t\t\t * range.applyInlineStyle(\"strong\",{\"style\":\"font-size:12px\"})\n\t\t\t *\n\t\t\t * ==>\n\t\t\t *\n\t\t\t * <p>xxxx[<strong style=\"font-size:12px\">xxxx</strong>]x</p>\n\t\t\t * ```\n\t\t\t */\n\t\t\tapplyInlineStyle: function(tagName, attrs, list) {\n\t\t\t\tif (this.collapsed) return this;\n\t\t\t\tthis.trimBoundary().enlarge(false,\n\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 && domUtils.isBlockElm(node)\n\t\t\t\t\t}).adjustmentBoundary();\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tend = bookmark.end,\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark.start, false, filterFn),\n\t\t\t\t\tnode,\n\t\t\t\t\tpre,\n\t\t\t\t\trange = this.cloneRange();\n\t\t\t\twhile (current && (domUtils.getPosition(current, end) & domUtils.POSITION_PRECEDING)) {\n\t\t\t\t\tif (current.nodeType == 3 || dtd[tagName][current.tagName]) {\n\t\t\t\t\t\trange.setStartBefore(current);\n\t\t\t\t\t\tnode = current;\n\t\t\t\t\t\twhile (node && (node.nodeType == 3 || dtd[tagName][node.tagName]) && node !== end) {\n\t\t\t\t\t\t\tpre = node;\n\t\t\t\t\t\t\tnode = domUtils.getNextDomNode(node, node.nodeType == 1, null, function(parent) {\n\t\t\t\t\t\t\t\treturn dtd[tagName][parent.tagName];\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar frag = range.setEndAfter(pre).extractContents(),\n\t\t\t\t\t\t\telm;\n\t\t\t\t\t\tif (list && list.length > 0) {\n\t\t\t\t\t\t\tvar level, top;\n\t\t\t\t\t\t\ttop = level = list[0].cloneNode(false);\n\t\t\t\t\t\t\tfor (var i = 1, ci; ci = list[i++];) {\n\t\t\t\t\t\t\t\tlevel.appendChild(ci.cloneNode(false));\n\t\t\t\t\t\t\t\tlevel = level.firstChild;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telm = level;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telm = range.document.createElement(tagName);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(elm, attrs);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telm.appendChild(frag);\n\t\t\t\t\t\trange.insertNode(list ? top : elm);\n\t\t\t\t\t\t//处理下滑线在a上的情况\n\t\t\t\t\t\tvar aNode;\n\t\t\t\t\t\tif (tagName == 'span' && attrs.style && /text\\-decoration/.test(attrs.style) && (aNode = domUtils.findParentByTagName(elm, 'a', true))) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(aNode, attrs);\n\t\t\t\t\t\t\tdomUtils.remove(elm, true);\n\t\t\t\t\t\t\telm = aNode;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.mergeSibling(elm);\n\t\t\t\t\t\t\tdomUtils.clearEmptySibling(elm);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//去除子节点相同的\n\t\t\t\t\t\tdomUtils.mergeChild(elm, attrs);\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(elm, false, filterFn);\n\t\t\t\t\t\tdomUtils.mergeToParent(elm);\n\t\t\t\t\t\tif (node === end) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 移除当前选区内指定的inline标签，但保留其中的内容\n\t\t\t * @method removeInlineStyle\n\t\t\t * @param { String } tagName 需要移除的标签名\n\t\t\t * @return { UE.dom.Range } 当前的range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * xx[x<span>xxx<em>yyy</em>zz]z</span>  => range.removeInlineStyle([\"em\"])  => xx[x<span>xxxyyyzz]z</span>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 移除当前选区内指定的一组inline标签，但保留其中的内容\n\t\t\t * @method removeInlineStyle\n\t\t\t * @param { Array } tagNameArr 需要移除的标签名的数组\n\t\t\t * @return { UE.dom.Range } 当前的range对象\n\t\t\t * @see UE.dom.Range:removeInlineStyle(String)\n\t\t\t */\n\t\t\tremoveInlineStyle: function(tagNames) {\n\t\t\t\tif (this.collapsed) return this;\n\t\t\t\ttagNames = utils.isArray(tagNames) ? tagNames : [tagNames];\n\t\t\t\tthis.shrinkBoundary().adjustmentBoundary();\n\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\tend = this.endContainer;\n\t\t\t\twhile (1) {\n\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\tif (utils.indexOf(tagNames, start.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (start.tagName.toLowerCase() == 'body') {\n\t\t\t\t\t\t\tstart = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t}\n\t\t\t\twhile (1) {\n\t\t\t\t\tif (end.nodeType == 1) {\n\t\t\t\t\t\tif (utils.indexOf(tagNames, end.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (end.tagName.toLowerCase() == 'body') {\n\t\t\t\t\t\t\tend = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tend = end.parentNode;\n\t\t\t\t}\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tfrag,\n\t\t\t\t\ttmpRange;\n\t\t\t\tif (start) {\n\t\t\t\t\ttmpRange = this.cloneRange().setEndBefore(bookmark.start).setStartBefore(start);\n\t\t\t\t\tfrag = tmpRange.extractContents();\n\t\t\t\t\ttmpRange.insertNode(frag);\n\t\t\t\t\tdomUtils.clearEmptySibling(start, true);\n\t\t\t\t\tstart.parentNode.insertBefore(bookmark.start, start);\n\t\t\t\t}\n\t\t\t\tif (end) {\n\t\t\t\t\ttmpRange = this.cloneRange().setStartAfter(bookmark.end).setEndAfter(end);\n\t\t\t\t\tfrag = tmpRange.extractContents();\n\t\t\t\t\ttmpRange.insertNode(frag);\n\t\t\t\t\tdomUtils.clearEmptySibling(end, false, true);\n\t\t\t\t\tend.parentNode.insertBefore(bookmark.end, end.nextSibling);\n\t\t\t\t}\n\t\t\t\tvar current = domUtils.getNextDomNode(bookmark.start, false, function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t}),\n\t\t\t\t\tnext;\n\t\t\t\twhile (current && current !== bookmark.end) {\n\t\t\t\t\tnext = domUtils.getNextDomNode(current, true, function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t});\n\t\t\t\t\tif (utils.indexOf(tagNames, current.tagName.toLowerCase()) > -1) {\n\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = next;\n\t\t\t\t}\n\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前选中的自闭合的节点\n\t\t\t * @method  getClosedNode\n\t\t\t * @return { Node | NULL } 如果当前选中的是自闭合节点， 则返回该节点， 否则返回NULL\n\t\t\t */\n\t\t\tgetClosedNode: function() {\n\t\t\t\tvar node;\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\tvar range = this.cloneRange().adjustmentBoundary().shrinkBoundary();\n\t\t\t\t\tif (selectOneNode(range)) {\n\t\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset];\n\t\t\t\t\t\tif (child && child.nodeType == 1 && (dtd.$empty[child.tagName] || dtd.$nonChild[child.tagName])) {\n\t\t\t\t\t\t\tnode = child;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在页面上高亮range所表示的选区\n\t\t\t * @method select\n\t\t\t * @return { UE.dom.Range } 返回当前Range对象\n\t\t\t */\n\t\t\t//这里不区分ie9以上，trace:3824\n\t\t\tselect: browser.ie ? function(noFillData, textRange) {\n\t\t\t\tvar nativeRange;\n\t\t\t\tif (!this.collapsed)\n\t\t\t\t\tthis.shrinkBoundary();\n\t\t\t\tvar node = this.getClosedNode();\n\t\t\t\tif (node && !textRange) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tnativeRange = this.document.body.createControlRange();\n\t\t\t\t\t\tnativeRange.addElement(node);\n\t\t\t\t\t\tnativeRange.select();\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tstart = bookmark.start,\n\t\t\t\t\tend;\n\t\t\t\tnativeRange = this.document.body.createTextRange();\n\t\t\t\tnativeRange.moveToElementText(start);\n\t\t\t\tnativeRange.moveStart('character', 1);\n\t\t\t\tif (!this.collapsed) {\n\t\t\t\t\tvar nativeRangeEnd = this.document.body.createTextRange();\n\t\t\t\t\tend = bookmark.end;\n\t\t\t\t\tnativeRangeEnd.moveToElementText(end);\n\t\t\t\t\tnativeRange.setEndPoint('EndToEnd', nativeRangeEnd);\n\t\t\t\t} else {\n\t\t\t\t\tif (!noFillData && this.startContainer.nodeType != 3) {\n\t\t\t\t\t\t//使用<span>|x<span>固定住光标\n\t\t\t\t\t\tvar tmpText = this.document.createTextNode(fillChar),\n\t\t\t\t\t\t\ttmp = this.document.createElement('span');\n\t\t\t\t\t\ttmp.appendChild(this.document.createTextNode(fillChar));\n\t\t\t\t\t\tstart.parentNode.insertBefore(tmp, start);\n\t\t\t\t\t\tstart.parentNode.insertBefore(tmpText, start);\n\t\t\t\t\t\t//当点b,i,u时，不能清除i上边的b\n\t\t\t\t\t\tremoveFillData(this.document, tmpText);\n\t\t\t\t\t\tfillData = tmpText;\n\t\t\t\t\t\tmergeSibling(tmp, 'previousSibling');\n\t\t\t\t\t\tmergeSibling(start, 'nextSibling');\n\t\t\t\t\t\tnativeRange.moveStart('character', -1);\n\t\t\t\t\t\tnativeRange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.moveToBookmark(bookmark);\n\t\t\t\ttmp && domUtils.remove(tmp);\n\t\t\t\t//IE在隐藏状态下不支持range操作，catch一下\n\t\t\t\ttry {\n\t\t\t\t\tnativeRange.select();\n\t\t\t\t} catch (e) {}\n\t\t\t\treturn this;\n\t\t\t} : function(notInsertFillData) {\n\t\t\t\tfunction checkOffset(rng) {\n\n\t\t\t\t\tfunction check(node, offset, dir) {\n\t\t\t\t\t\tif (node.nodeType == 3 && node.nodeValue.length < offset) {\n\t\t\t\t\t\t\trng[dir + 'Offset'] = node.nodeValue.length\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcheck(rng.startContainer, rng.startOffset, 'start');\n\t\t\t\t\tcheck(rng.endContainer, rng.endOffset, 'end');\n\t\t\t\t}\n\t\t\t\tvar win = domUtils.getWindow(this.document),\n\t\t\t\t\tsel = win.getSelection(),\n\t\t\t\t\ttxtNode;\n\t\t\t\t//FF下关闭自动长高时滚动条在关闭dialog时会跳\n\t\t\t\t//ff下如果不body.focus将不能定位闭合光标到编辑器内\n\t\t\t\tbrowser.gecko ? this.document.body.focus() : win.focus();\n\t\t\t\tif (sel) {\n\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t// trace:870 chrome/safari后边是br对于闭合得range不能定位 所以去掉了判断\n\t\t\t\t\t// this.startContainer.nodeType != 3 &&! ((child = this.startContainer.childNodes[this.startOffset]) && child.nodeType == 1 && child.tagName == 'BR'\n\t\t\t\t\tif (this.collapsed && !notInsertFillData) {\n\t\t\t\t\t\t//                    //opear如果没有节点接着，原生的不能够定位,不能在body的第一级插入空白节点\n\t\t\t\t\t\t//                    if (notInsertFillData && browser.opera && !domUtils.isBody(this.startContainer) && this.startContainer.nodeType == 1) {\n\t\t\t\t\t\t//                        var tmp = this.document.createTextNode('');\n\t\t\t\t\t\t//                        this.insertNode(tmp).setStart(tmp, 0).collapse(true);\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//处理光标落在文本节点的情况\n\t\t\t\t\t\t//处理以下的情况\n\t\t\t\t\t\t//<b>|xxxx</b>\n\t\t\t\t\t\t//<b>xxxx</b>|xxxx\n\t\t\t\t\t\t//xxxx<b>|</b>\n\t\t\t\t\t\tvar start = this.startContainer,\n\t\t\t\t\t\t\tchild = start;\n\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\tchild = start.childNodes[this.startOffset];\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!(start.nodeType == 3 && this.startOffset) &&\n\t\t\t\t\t\t\t(child ?\n\t\t\t\t\t\t\t\t(!child.previousSibling || child.previousSibling.nodeType != 3) :\n\t\t\t\t\t\t\t\t(!start.lastChild || start.lastChild.nodeType != 3)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\ttxtNode = this.document.createTextNode(fillChar);\n\t\t\t\t\t\t\t//跟着前边走\n\t\t\t\t\t\t\tthis.insertNode(txtNode);\n\t\t\t\t\t\t\tremoveFillData(this.document, txtNode);\n\t\t\t\t\t\t\tmergeSibling(txtNode, 'previousSibling');\n\t\t\t\t\t\t\tmergeSibling(txtNode, 'nextSibling');\n\t\t\t\t\t\t\tfillData = txtNode;\n\t\t\t\t\t\t\tthis.setStart(txtNode, browser.webkit ? 1 : 0).collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar nativeRange = this.document.createRange();\n\t\t\t\t\tif (this.collapsed && browser.opera && this.startContainer.nodeType == 1) {\n\t\t\t\t\t\tvar child = this.startContainer.childNodes[this.startOffset];\n\t\t\t\t\t\tif (!child) {\n\t\t\t\t\t\t\t//往前靠拢\n\t\t\t\t\t\t\tchild = this.startContainer.lastChild;\n\t\t\t\t\t\t\tif (child && domUtils.isBr(child)) {\n\t\t\t\t\t\t\t\tthis.setStartBefore(child).collapse(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//向后靠拢\n\t\t\t\t\t\t\twhile (child && domUtils.isBlockElm(child)) {\n\t\t\t\t\t\t\t\tif (child.nodeType == 1 && child.childNodes[0]) {\n\t\t\t\t\t\t\t\t\tchild = child.childNodes[0]\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchild && this.setStartBefore(child).collapse(true)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\t//是createAddress最后一位算的不准，现在这里进行微调\n\t\t\t\t\tcheckOffset(this);\n\t\t\t\t\tnativeRange.setStart(this.startContainer, this.startOffset);\n\t\t\t\t\tnativeRange.setEnd(this.endContainer, this.endOffset);\n\t\t\t\t\tsel.addRange(nativeRange);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 滚动到当前range开始的位置\n\t\t\t * @method scrollToView\n\t\t\t * @param { Window } win 当前range对象所属的window对象\n\t\t\t * @return { UE.dom.Range } 当前Range对象\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 滚动到距离当前range开始位置 offset 的位置处\n\t\t\t * @method scrollToView\n\t\t\t * @param { Window } win 当前range对象所属的window对象\n\t\t\t * @param { Number } offset 距离range开始位置处的偏移量， 如果为正数， 则向下偏移， 反之， 则向上偏移\n\t\t\t * @return { UE.dom.Range } 当前Range对象\n\t\t\t */\n\t\t\tscrollToView: function(win, offset) {\n\t\t\t\twin = win ? window : domUtils.getWindow(this.document);\n\t\t\t\tvar me = this,\n\t\t\t\t\tspan = me.document.createElement('span');\n\t\t\t\t//trace:717\n\t\t\t\tspan.innerHTML = '&nbsp;';\n\t\t\t\tme.cloneRange().insertNode(span);\n\t\t\t\tdomUtils.scrollToView(span, win, offset);\n\t\t\t\tdomUtils.remove(span);\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 判断当前选区内容是否占位符\n\t\t\t * @private\n\t\t\t * @method inFillChar\n\t\t\t * @return { Boolean } 如果是占位符返回true，否则返回false\n\t\t\t */\n\t\t\tinFillChar: function() {\n\t\t\t\tvar start = this.startContainer;\n\t\t\t\tif (this.collapsed && start.nodeType == 3 && start.nodeValue.replace(new RegExp('^' + domUtils.fillChar), '').length + 1 == start.nodeValue.length) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 保存\n\t\t\t * @method createAddress\n\t\t\t * @private\n\t\t\t * @return { Boolean } 返回开始和结束的位置\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *     <p>\n\t\t\t *         aaaa\n\t\t\t *         <em>\n\t\t\t *             <!-- 选区开始 -->\n\t\t\t *             bbbb\n\t\t\t *             <!-- 选区结束 -->\n\t\t\t *         </em>\n\t\t\t *     </p>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *         //output: {startAddress:[0,1,0,0],endAddress:[0,1,0,4]}\n\t\t\t *         console.log( range.createAddress() );\n\t\t\t *     </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tcreateAddress: function(ignoreEnd, ignoreTxt) {\n\t\t\t\tvar addr = {},\n\t\t\t\t\tme = this;\n\n\t\t\t\tfunction getAddress(isStart) {\n\t\t\t\t\tvar node = isStart ? me.startContainer : me.endContainer;\n\t\t\t\t\tvar parents = domUtils.findParents(node, true, function(node) {\n\t\t\t\t\t\t\treturn !domUtils.isBody(node)\n\t\t\t\t\t\t}),\n\t\t\t\t\t\taddrs = [];\n\t\t\t\t\tfor (var i = 0, ci; ci = parents[i++];) {\n\t\t\t\t\t\taddrs.push(domUtils.getNodeIndex(ci, ignoreTxt));\n\t\t\t\t\t}\n\t\t\t\t\tvar firstIndex = 0;\n\n\t\t\t\t\tif (ignoreTxt) {\n\t\t\t\t\t\tif (node.nodeType == 3) {\n\t\t\t\t\t\t\tvar tmpNode = node.previousSibling;\n\t\t\t\t\t\t\twhile (tmpNode && tmpNode.nodeType == 3) {\n\t\t\t\t\t\t\t\tfirstIndex += tmpNode.nodeValue.replace(fillCharReg, '').length;\n\t\t\t\t\t\t\t\ttmpNode = tmpNode.previousSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfirstIndex += (isStart ? me.startOffset : me.endOffset) // - (fillCharReg.test(node.nodeValue) ? 1 : 0 )\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnode = node.childNodes[isStart ? me.startOffset : me.endOffset];\n\t\t\t\t\t\t\tif (node) {\n\t\t\t\t\t\t\t\tfirstIndex = domUtils.getNodeIndex(node, ignoreTxt);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tnode = isStart ? me.startContainer : me.endContainer;\n\t\t\t\t\t\t\t\tvar first = node.firstChild;\n\t\t\t\t\t\t\t\twhile (first) {\n\t\t\t\t\t\t\t\t\tif (domUtils.isFillChar(first)) {\n\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tfirstIndex++;\n\t\t\t\t\t\t\t\t\tif (first.nodeType == 3) {\n\t\t\t\t\t\t\t\t\t\twhile (first && first.nodeType == 3) {\n\t\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfirst = first.nextSibling;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfirstIndex = isStart ? domUtils.isFillChar(node) ? 0 : me.startOffset : me.endOffset\n\t\t\t\t\t}\n\t\t\t\t\tif (firstIndex < 0) {\n\t\t\t\t\t\tfirstIndex = 0;\n\t\t\t\t\t}\n\t\t\t\t\taddrs.push(firstIndex);\n\t\t\t\t\treturn addrs;\n\t\t\t\t}\n\t\t\t\taddr.startAddress = getAddress(true);\n\t\t\t\tif (!ignoreEnd) {\n\t\t\t\t\taddr.endAddress = me.collapsed ? [].concat(addr.startAddress) : getAddress();\n\t\t\t\t}\n\t\t\t\treturn addr;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 保存\n\t\t\t * @method createAddress\n\t\t\t * @private\n\t\t\t * @return { Boolean } 返回开始和结束的位置\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t * <body>\n\t\t\t *     <p>\n\t\t\t *         aaaa\n\t\t\t *         <em>\n\t\t\t *             <!-- 选区开始 -->\n\t\t\t *             bbbb\n\t\t\t *             <!-- 选区结束 -->\n\t\t\t *         </em>\n\t\t\t *     </p>\n\t\t\t *\n\t\t\t *     <script>\n\t\t\t *         var range = editor.selection.getRange();\n\t\t\t *         range.moveToAddress({startAddress:[0,1,0,0],endAddress:[0,1,0,4]});\n\t\t\t *         range.select();\n\t\t\t *         //output: 'bbbb'\n\t\t\t *         console.log(editor.selection.getText());\n\t\t\t *     </script>\n\t\t\t * </body>\n\t\t\t * ```\n\t\t\t */\n\t\t\tmoveToAddress: function(addr, ignoreEnd) {\n\t\t\t\tvar me = this;\n\n\t\t\t\tfunction getNode(address, isStart) {\n\t\t\t\t\tvar tmpNode = me.document.body,\n\t\t\t\t\t\tparentNode, offset;\n\t\t\t\t\tfor (var i = 0, ci, l = address.length; i < l; i++) {\n\t\t\t\t\t\tci = address[i];\n\t\t\t\t\t\tparentNode = tmpNode;\n\t\t\t\t\t\ttmpNode = tmpNode.childNodes[ci];\n\t\t\t\t\t\tif (!tmpNode) {\n\t\t\t\t\t\t\toffset = ci;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (isStart) {\n\t\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\t\tme.setStartBefore(tmpNode)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.setStart(parentNode, offset)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tmpNode) {\n\t\t\t\t\t\t\tme.setEndBefore(tmpNode)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.setEnd(parentNode, offset)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tgetNode(addr.startAddress, true);\n\t\t\t\t!ignoreEnd && addr.endAddress && getNode(addr.endAddress);\n\t\t\t\treturn me;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 判断给定的Range对象是否和当前Range对象表示的是同一个选区\n\t\t\t * @method equals\n\t\t\t * @param { UE.dom.Range } 需要判断的Range对象\n\t\t\t * @return { Boolean } 如果给定的Range对象与当前Range对象表示的是同一个选区， 则返回true， 否则返回false\n\t\t\t */\n\t\t\tequals: function(rng) {\n\t\t\t\tfor (var p in this) {\n\t\t\t\t\tif (this.hasOwnProperty(p)) {\n\t\t\t\t\t\tif (this[p] !== rng[p])\n\t\t\t\t\t\t\treturn false\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 遍历range内的节点。每当遍历一个节点时， 都会执行参数项 doFn 指定的函数， 该函数的接受当前遍历的节点\n\t\t\t * 作为其参数。\n\t\t\t * @method traversal\n\t\t\t * @param { Function }  doFn 对每个遍历的节点要执行的方法， 该方法接受当前遍历的节点作为其参数\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区开始 -->\n\t\t\t *     <span></span>\n\t\t\t *     <a></a>\n\t\t\t *     <!-- 选区结束 -->\n\t\t\t * </body>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: <span></span><a></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t *     range.traversal( function ( node ) {\n\t\t\t *\n\t\t\t *         if ( node.nodeType === 1 ) {\n\t\t\t *             node.className = \"test\";\n\t\t\t *         }\n\t\t\t *\n\t\t\t *     } );\n\t\t\t *\n\t\t\t *     //output: <span class=\"test\"></span><a class=\"test\"></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 遍历range内的节点。\n\t\t\t * 每当遍历一个节点时， 都会执行参数项 doFn 指定的函数， 该函数的接受当前遍历的节点\n\t\t\t * 作为其参数。\n\t\t\t * 可以通过参数项 filterFn 来指定一个过滤器， 只有符合该过滤器过滤规则的节点才会触\n\t\t\t * 发doFn函数的执行\n\t\t\t * @method traversal\n\t\t\t * @param { Function } doFn 对每个遍历的节点要执行的方法， 该方法接受当前遍历的节点作为其参数\n\t\t\t * @param { Function } filterFn 过滤器， 该函数接受当前遍历的节点作为参数， 如果该节点满足过滤\n\t\t\t *                      规则， 请返回true， 该节点会触发doFn， 否则， 请返回false， 则该节点不\n\t\t\t *                      会触发doFn。\n\t\t\t * @return { UE.dom.Range } 当前range对象\n\t\t\t * @see UE.dom.Range:traversal(Function)\n\t\t\t * @example\n\t\t\t * ```html\n\t\t\t *\n\t\t\t * <body>\n\t\t\t *\n\t\t\t *     <!-- 选区开始 -->\n\t\t\t *     <span></span>\n\t\t\t *     <a></a>\n\t\t\t *     <!-- 选区结束 -->\n\t\t\t * </body>\n\t\t\t *\n\t\t\t * <script>\n\t\t\t *\n\t\t\t *     //output: <span></span><a></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t *     range.traversal( function ( node ) {\n\t\t\t *\n\t\t\t *         node.className = \"test\";\n\t\t\t *\n\t\t\t *     }, function ( node ) {\n\t\t\t *          return node.nodeType === 1;\n\t\t\t *     } );\n\t\t\t *\n\t\t\t *     //output: <span class=\"test\"></span><a class=\"test\"></a>\n\t\t\t *     console.log( range.cloneContents() );\n\t\t\t *\n\t\t\t * </script>\n\t\t\t * ```\n\t\t\t */\n\t\t\ttraversal: function(doFn, filterFn) {\n\t\t\t\tif (this.collapsed)\n\t\t\t\t\treturn this;\n\t\t\t\tvar bookmark = this.createBookmark(),\n\t\t\t\t\tend = bookmark.end,\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark.start, false, filterFn);\n\t\t\t\twhile (current && current !== end && (domUtils.getPosition(current, end) & domUtils.POSITION_PRECEDING)) {\n\t\t\t\t\tvar tmpNode = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\tdoFn(current);\n\t\t\t\t\tcurrent = tmpNode;\n\t\t\t\t}\n\t\t\t\treturn this.moveToBookmark(bookmark);\n\t\t\t}\n\t\t};\n\t})();\n\n\t// core/Selection.js\n\t/**\n\t * 选集\n\t * @file\n\t * @module UE.dom\n\t * @class Selection\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 选区集合\n\t * @unfile\n\t * @module UE.dom\n\t * @class Selection\n\t */\n\t(function() {\n\n\t\tfunction getBoundaryInformation(range, start) {\n\t\t\tvar getIndex = domUtils.getNodeIndex;\n\t\t\trange = range.duplicate();\n\t\t\trange.collapse(start);\n\t\t\tvar parent = range.parentElement();\n\t\t\t//如果节点里没有子节点，直接退出\n\t\t\tif (!parent.hasChildNodes()) {\n\t\t\t\treturn {\n\t\t\t\t\tcontainer: parent,\n\t\t\t\t\toffset: 0\n\t\t\t\t};\n\t\t\t}\n\t\t\tvar siblings = parent.children,\n\t\t\t\tchild,\n\t\t\t\ttestRange = range.duplicate(),\n\t\t\t\tstartIndex = 0,\n\t\t\t\tendIndex = siblings.length - 1,\n\t\t\t\tindex = -1,\n\t\t\t\tdistance;\n\t\t\twhile (startIndex <= endIndex) {\n\t\t\t\tindex = Math.floor((startIndex + endIndex) / 2);\n\t\t\t\tchild = siblings[index];\n\t\t\t\ttestRange.moveToElementText(child);\n\t\t\t\tvar position = testRange.compareEndPoints('StartToStart', range);\n\t\t\t\tif (position > 0) {\n\t\t\t\t\tendIndex = index - 1;\n\t\t\t\t} else if (position < 0) {\n\t\t\t\t\tstartIndex = index + 1;\n\t\t\t\t} else {\n\t\t\t\t\t//trace:1043\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\toffset: getIndex(child)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (index == -1) {\n\t\t\t\ttestRange.moveToElementText(parent);\n\t\t\t\ttestRange.setEndPoint('StartToStart', range);\n\t\t\t\tdistance = testRange.text.replace(/(\\r\\n|\\r)/g, '\\n').length;\n\t\t\t\tsiblings = parent.childNodes;\n\t\t\t\tif (!distance) {\n\t\t\t\t\tchild = siblings[siblings.length - 1];\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: child,\n\t\t\t\t\t\toffset: child.nodeValue.length\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tvar i = siblings.length;\n\t\t\t\twhile (distance > 0) {\n\t\t\t\t\tdistance -= siblings[--i].nodeValue.length;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tcontainer: siblings[i],\n\t\t\t\t\toffset: -distance\n\t\t\t\t};\n\t\t\t}\n\t\t\ttestRange.collapse(position > 0);\n\t\t\ttestRange.setEndPoint(position > 0 ? 'StartToStart' : 'EndToStart', range);\n\t\t\tdistance = testRange.text.replace(/(\\r\\n|\\r)/g, '\\n').length;\n\t\t\tif (!distance) {\n\t\t\t\treturn dtd.$empty[child.tagName] || dtd.$nonChild[child.tagName] ? {\n\t\t\t\t\tcontainer: parent,\n\t\t\t\t\toffset: getIndex(child) + (position > 0 ? 0 : 1)\n\t\t\t\t} : {\n\t\t\t\t\tcontainer: child,\n\t\t\t\t\toffset: position > 0 ? 0 : child.childNodes.length\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile (distance > 0) {\n\t\t\t\ttry {\n\t\t\t\t\tvar pre = child;\n\t\t\t\t\tchild = child[position > 0 ? 'previousSibling' : 'nextSibling'];\n\t\t\t\t\tdistance -= child.nodeValue.length;\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tcontainer: parent,\n\t\t\t\t\t\toffset: getIndex(pre)\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tcontainer: child,\n\t\t\t\toffset: position > 0 ? -distance : child.nodeValue.length + distance\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 将ieRange转换为Range对象\n\t\t * @param {Range}   ieRange    ieRange对象\n\t\t * @param {Range}   range      Range对象\n\t\t * @return  {Range}  range       返回转换后的Range对象\n\t\t */\n\t\tfunction transformIERangeToRange(ieRange, range) {\n\t\t\tif (ieRange.item) {\n\t\t\t\trange.selectNode(ieRange.item(0));\n\t\t\t} else {\n\t\t\t\tvar bi = getBoundaryInformation(ieRange, true);\n\t\t\t\trange.setStart(bi.container, bi.offset);\n\t\t\t\tif (ieRange.compareEndPoints('StartToEnd', ieRange) != 0) {\n\t\t\t\t\tbi = getBoundaryInformation(ieRange, false);\n\t\t\t\t\trange.setEnd(bi.container, bi.offset);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn range;\n\t\t}\n\n\t\t/**\n\t\t * 获得ieRange\n\t\t * @param {Selection} sel    Selection对象\n\t\t * @return {ieRange}    得到ieRange\n\t\t */\n\t\tfunction _getIERange(sel) {\n\t\t\tvar ieRange;\n\t\t\t//ie下有可能报错\n\t\t\ttry {\n\t\t\t\tieRange = sel.getNative().createRange();\n\t\t\t} catch (e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar el = ieRange.item ? ieRange.item(0) : ieRange.parentElement();\n\t\t\tif ((el.ownerDocument || el) === sel.document) {\n\t\t\t\treturn ieRange;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tvar Selection = dom.Selection = function(doc) {\n\t\t\tvar me = this,\n\t\t\t\tiframe;\n\t\t\tme.document = doc;\n\t\t\tif (browser.ie9below) {\n\t\t\t\tiframe = domUtils.getWindow(doc).frameElement;\n\t\t\t\tdomUtils.on(iframe, 'beforedeactivate', function() {\n\t\t\t\t\tme._bakIERange = me.getIERange();\n\t\t\t\t});\n\t\t\t\tdomUtils.on(iframe, 'activate', function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (!_getIERange(me) && me._bakIERange) {\n\t\t\t\t\t\t\tme._bakIERange.select();\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (ex) {}\n\t\t\t\t\tme._bakIERange = null;\n\t\t\t\t});\n\t\t\t}\n\t\t\tiframe = doc = null;\n\t\t};\n\n\t\tSelection.prototype = {\n\n\t\t\trangeInBody: function(rng, txtRange) {\n\t\t\t\tvar node = browser.ie9below || txtRange ? rng.item ? rng.item() : rng.parentElement() : rng.startContainer;\n\n\t\t\t\treturn node === this.document.body || domUtils.inDoc(node, this.document);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取原生seleciton对象\n\t\t\t * @method getNative\n\t\t\t * @return { Object } 获得selection对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getNative();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetNative: function() {\n\t\t\t\tvar doc = this.document;\n\t\t\t\ttry {\n\t\t\t\t\treturn !doc ? null : browser.ie9below ? doc.selection : domUtils.getWindow(doc).getSelection();\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获得ieRange\n\t\t\t * @method getIERange\n\t\t\t * @return { Object } 返回ie原生的Range\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getIERange();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetIERange: function() {\n\t\t\t\tvar ieRange = _getIERange(this);\n\t\t\t\tif (!ieRange) {\n\t\t\t\t\tif (this._bakIERange) {\n\t\t\t\t\t\treturn this._bakIERange;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn ieRange;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 缓存当前选区的range和选区的开始节点\n\t\t\t * @method cache\n\t\t\t */\n\t\t\tcache: function() {\n\t\t\t\tthis.clear();\n\t\t\t\tthis._cachedRange = this.getRange();\n\t\t\t\tthis._cachedStartElement = this.getStart();\n\t\t\t\tthis._cachedStartElementPath = this.getStartElementPath();\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取选区开始位置的父节点到body\n\t\t\t * @method getStartElementPath\n\t\t\t * @return { Array } 返回父节点集合\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getStartElementPath();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetStartElementPath: function() {\n\t\t\t\tif (this._cachedStartElementPath) {\n\t\t\t\t\treturn this._cachedStartElementPath;\n\t\t\t\t}\n\t\t\t\tvar start = this.getStart();\n\t\t\t\tif (start) {\n\t\t\t\t\treturn domUtils.findParents(start, true, null, true)\n\t\t\t\t}\n\t\t\t\treturn [];\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 清空缓存\n\t\t\t * @method clear\n\t\t\t */\n\t\t\tclear: function() {\n\t\t\t\tthis._cachedStartElementPath = this._cachedRange = this._cachedStartElement = null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 编辑器是否得到了选区\n\t\t\t * @method isFocus\n\t\t\t */\n\t\t\tisFocus: function() {\n\t\t\t\ttry {\n\t\t\t\t\tif (browser.ie9below) {\n\n\t\t\t\t\t\tvar nativeRange = _getIERange(this);\n\t\t\t\t\t\treturn !!(nativeRange && this.rangeInBody(nativeRange));\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn !!this.getNative().rangeCount;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取选区对应的Range\n\t\t\t * @method getRange\n\t\t\t * @return { Object } 得到Range对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getRange();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetRange: function() {\n\t\t\t\tvar me = this;\n\n\t\t\t\tfunction optimze(range) {\n\t\t\t\t\tvar child = me.document.body.firstChild,\n\t\t\t\t\t\tcollapsed = range.collapsed;\n\t\t\t\t\twhile (child && child.firstChild) {\n\t\t\t\t\t\trange.setStart(child, 0);\n\t\t\t\t\t\tchild = child.firstChild;\n\t\t\t\t\t}\n\t\t\t\t\tif (!range.startContainer) {\n\t\t\t\t\t\trange.setStart(me.document.body, 0)\n\t\t\t\t\t}\n\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (me._cachedRange != null) {\n\t\t\t\t\treturn this._cachedRange;\n\t\t\t\t}\n\t\t\t\tvar range = new baidu.editor.dom.Range(me.document);\n\n\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\tvar nativeRange = me.getIERange();\n\t\t\t\t\tif (nativeRange) {\n\t\t\t\t\t\t//备份的_bakIERange可能已经实效了，dom树发生了变化比如从源码模式切回来，所以try一下，实效就放到body开始位置\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\ttransformIERangeToRange(nativeRange, range);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar sel = me.getNative();\n\t\t\t\t\tif (sel && sel.rangeCount) {\n\t\t\t\t\t\tvar firstRange = sel.getRangeAt(0);\n\t\t\t\t\t\tvar lastRange = sel.getRangeAt(sel.rangeCount - 1);\n\t\t\t\t\t\trange.setStart(firstRange.startContainer, firstRange.startOffset).setEnd(lastRange.endContainer, lastRange.endOffset);\n\t\t\t\t\t\tif (range.collapsed && domUtils.isBody(range.startContainer) && !range.startOffset) {\n\t\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//trace:1734 有可能已经不在dom树上了，标识的节点\n\t\t\t\t\t\tif (this._bakRange && domUtils.inDoc(this._bakRange.startContainer, this.document)) {\n\t\t\t\t\t\t\treturn this._bakRange;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptimze(range);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this._bakRange = range;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取开始元素，用于状态反射\n\t\t\t * @method getStart\n\t\t\t * @return { Element } 获得开始元素\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getStart();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetStart: function() {\n\t\t\t\tif (this._cachedStartElement) {\n\t\t\t\t\treturn this._cachedStartElement;\n\t\t\t\t}\n\t\t\t\tvar range = browser.ie9below ? this.getIERange() : this.getRange(),\n\t\t\t\t\ttmpRange,\n\t\t\t\t\tstart, tmp, parent;\n\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\tif (!range) {\n\t\t\t\t\t\t//todo 给第一个值可能会有问题\n\t\t\t\t\t\treturn this.document.body.firstChild;\n\t\t\t\t\t}\n\t\t\t\t\t//control元素\n\t\t\t\t\tif (range.item) {\n\t\t\t\t\t\treturn range.item(0);\n\t\t\t\t\t}\n\t\t\t\t\ttmpRange = range.duplicate();\n\t\t\t\t\t//修正ie下<b>x</b>[xx] 闭合后 <b>x|</b>xx\n\t\t\t\t\ttmpRange.text.length > 0 && tmpRange.moveStart('character', 1);\n\t\t\t\t\ttmpRange.collapse(1);\n\t\t\t\t\tstart = tmpRange.parentElement();\n\t\t\t\t\tparent = tmp = range.parentElement();\n\t\t\t\t\twhile (tmp = tmp.parentNode) {\n\t\t\t\t\t\tif (tmp == start) {\n\t\t\t\t\t\t\tstart = parent;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trange.shrinkBoundary();\n\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\tif (start.nodeType == 1 && start.hasChildNodes()) {\n\t\t\t\t\t\tstart = start.childNodes[Math.min(start.childNodes.length - 1, range.startOffset)];\n\t\t\t\t\t}\n\t\t\t\t\tif (start.nodeType == 3) {\n\t\t\t\t\t\treturn start.parentNode;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn start;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 得到选区中的文本\n\t\t\t * @method getText\n\t\t\t * @return { String } 选区中包含的文本\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.getText();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetText: function() {\n\t\t\t\tvar nativeSel, nativeRange;\n\t\t\t\tif (this.isFocus() && (nativeSel = this.getNative())) {\n\t\t\t\t\tnativeRange = browser.ie9below ? nativeSel.createRange() : nativeSel.getRangeAt(0);\n\t\t\t\t\treturn browser.ie9below ? nativeRange.text : nativeRange.toString();\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 清除选区\n\t\t\t * @method clearRange\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.selection.clearRange();\n\t\t\t * ```\n\t\t\t */\n\t\t\tclearRange: function() {\n\t\t\t\tthis.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t}\n\t\t};\n\t})();\n\n\t// core/Editor.js\n\t/**\n\t * 编辑器主类，包含编辑器提供的大部分公用接口\n\t * @file\n\t * @module UE\n\t * @class Editor\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t/**\n\t * UEditor的核心类，为用户提供与编辑器交互的接口。\n\t * @unfile\n\t * @module UE\n\t * @class Editor\n\t */\n\n\t(function() {\n\t\tvar uid = 0,\n\t\t\t_selectionChangeTimer;\n\n\t\t/**\n\t\t * 获取编辑器的html内容，赋值到编辑器所在表单的textarea文本域里面\n\t\t * @private\n\t\t * @method setValue\n\t\t * @param { UE.Editor } editor 编辑器事例\n\t\t */\n\t\tfunction setValue(form, editor) {\n\t\t\tvar textarea;\n\t\t\tif (editor.textarea) {\n\t\t\t\tif (utils.isString(editor.textarea)) {\n\t\t\t\t\tfor (var i = 0, ti, tis = domUtils.getElementsByTagName(form, 'textarea'); ti = tis[i++];) {\n\t\t\t\t\t\tif (ti.id == 'ueditor_textarea_' + editor.options.textarea) {\n\t\t\t\t\t\t\ttextarea = ti;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttextarea = editor.textarea;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!textarea) {\n\t\t\t\tform.appendChild(textarea = domUtils.createElement(document, 'textarea', {\n\t\t\t\t\t'name': editor.options.textarea,\n\t\t\t\t\t'id': 'ueditor_textarea_' + editor.options.textarea,\n\t\t\t\t\t'style': \"display:none\"\n\t\t\t\t}));\n\t\t\t\t//不要产生多个textarea\n\t\t\t\teditor.textarea = textarea;\n\t\t\t}!textarea.getAttribute('name') && textarea.setAttribute('name', editor.options.textarea);\n\t\t\ttextarea.value = editor.hasContents() ?\n\t\t\t\t(editor.options.allHtmlEnabled ? editor.getAllHtml() : editor.getContent(null, null, true)) :\n\t\t\t\t''\n\t\t}\n\n\t\tfunction loadPlugins(me) {\n\t\t\t//初始化插件\n\t\t\tfor (var pi in UE.plugins) {\n\t\t\t\tUE.plugins[pi].call(me);\n\t\t\t}\n\n\t\t}\n\n\t\tfunction checkCurLang(I18N) {\n\t\t\tfor (var lang in I18N) {\n\t\t\t\treturn lang\n\t\t\t}\n\t\t}\n\n\t\tfunction langReadied(me) {\n\t\t\tme.langIsReady = true;\n\n\t\t\tme.fireEvent(\"langReady\");\n\t\t}\n\n\t\t/**\n\t\t * 编辑器准备就绪后会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event ready\n\t\t * @remind render方法执行完成之后,会触发该事件\n\t\t * @remind\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.addListener( 'ready', function( editor ) {\n\t\t *     editor.execCommand( 'focus' ); //编辑器家在完成后，让编辑器拿到焦点\n\t\t * } );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 执行destroy方法,会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event destroy\n\t\t * @see UE.Editor:destroy()\n\t\t */\n\t\t/**\n\t\t * 执行reset方法,会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event reset\n\t\t * @see UE.Editor:reset()\n\t\t */\n\t\t/**\n\t\t * 执行focus方法,会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event focus\n\t\t * @see UE.Editor:focus(Boolean)\n\t\t */\n\t\t/**\n\t\t * 语言加载完成会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event langReady\n\t\t */\n\t\t/**\n\t\t * 运行命令之后会触发该命令\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeExecCommand\n\t\t */\n\t\t/**\n\t\t * 运行命令之后会触发该命令\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterExecCommand\n\t\t */\n\t\t/**\n\t\t * 运行命令之前会触发该命令\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event firstBeforeExecCommand\n\t\t */\n\t\t/**\n\t\t * 在getContent方法执行之前会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeGetContent\n\t\t * @see UE.Editor:getContent()\n\t\t */\n\t\t/**\n\t\t * 在getContent方法执行之后会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterGetContent\n\t\t * @see UE.Editor:getContent()\n\t\t */\n\t\t/**\n\t\t * 在getAllHtml方法执行时会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event getAllHtml\n\t\t * @see UE.Editor:getAllHtml()\n\t\t */\n\t\t/**\n\t\t * 在setContent方法执行之前会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeSetContent\n\t\t * @see UE.Editor:setContent(String)\n\t\t */\n\t\t/**\n\t\t * 在setContent方法执行之后会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterSetContent\n\t\t * @see UE.Editor:setContent(String)\n\t\t */\n\t\t/**\n\t\t * 每当编辑器内部选区发生改变时，将触发该事件\n\t\t * @event selectionchange\n\t\t * @warning 该事件的触发非常频繁，不建议在该事件的处理过程中做重量级的处理\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.addListener( 'selectionchange', function( editor ) {\n\t\t *     console.log('选区发生改变');\n\t\t * }\n\t\t */\n\t\t/**\n\t\t * 在所有selectionchange的监听函数执行之前，会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event beforeSelectionChange\n\t\t * @see UE.Editor:selectionchange\n\t\t */\n\t\t/**\n\t\t * 在所有selectionchange的监听函数执行完之后，会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event afterSelectionChange\n\t\t * @see UE.Editor:selectionchange\n\t\t */\n\t\t/**\n\t\t * 编辑器内容发生改变时会触发该事件\n\t\t * @module UE\n\t\t * @class Editor\n\t\t * @event contentChange\n\t\t */\n\n\t\t/**\n\t\t * 以默认参数构建一个编辑器实例\n\t\t * @constructor\n\t\t * @remind 通过 改构造方法实例化的编辑器,不带ui层.需要render到一个容器,编辑器实例才能正常渲染到页面\n\t\t * @example\n\t\t * ```javascript\n\t\t * var editor = new UE.Editor();\n\t\t * editor.execCommand('blod');\n\t\t * ```\n\t\t * @see UE.Config\n\t\t */\n\n\t\t/**\n\t\t * 以给定的参数集合创建一个编辑器实例，对于未指定的参数，将应用默认参数。\n\t\t * @constructor\n\t\t * @remind 通过 改构造方法实例化的编辑器,不带ui层.需要render到一个容器,编辑器实例才能正常渲染到页面\n\t\t * @param { Object } setting 创建编辑器的参数\n\t\t * @example\n\t\t * ```javascript\n\t\t * var editor = new UE.Editor();\n\t\t * editor.execCommand('blod');\n\t\t * ```\n\t\t * @see UE.Config\n\t\t */\n\t\tvar Editor = UE.Editor = function(options) {\n\t\t\tvar me = this;\n\t\t\tme.uid = uid++;\n\t\t\tEventBase.call(me);\n\t\t\tme.commands = {};\n\t\t\tme.options = utils.extend(utils.clone(options || {}), UEDITOR_CONFIG, true);\n\t\t\tme.shortcutkeys = {};\n\t\t\tme.inputRules = [];\n\t\t\tme.outputRules = [];\n\t\t\t//设置默认的常用属性\n\t\t\tme.setOpt(Editor.defaultOptions(me));\n\n\t\t\t/* 尝试异步加载后台配置 */\n\t\t\tme.loadServerConfig();\n\n\t\t\tif (!utils.isEmptyObject(UE.I18N)) {\n\t\t\t\t//修改默认的语言类型\n\t\t\t\tme.options.lang = checkCurLang(UE.I18N);\n\t\t\t\tUE.plugin.load(me);\n\t\t\t\tlangReadied(me);\n\n\t\t\t} else {\n\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\tsrc: me.options.langPath + me.options.lang + \"/\" + me.options.lang + \".js\",\n\t\t\t\t\ttag: \"script\",\n\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t}, function() {\n\t\t\t\t\tUE.plugin.load(me);\n\t\t\t\t\tlangReadied(me);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tUE.instants['ueditorInstant' + me.uid] = me;\n\t\t};\n\t\tEditor.prototype = {\n\t\t\tregisterCommand: function(name, obj) {\n\t\t\t\tthis.commands[name] = obj;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 编辑器对外提供的监听ready事件的接口， 通过调用该方法，达到的效果与监听ready事件是一致的\n\t\t\t * @method ready\n\t\t\t * @param { Function } fn 编辑器ready之后所执行的回调, 如果在注册事件之前编辑器已经ready，将会\n\t\t\t * 立即触发该回调。\n\t\t\t * @remind 需要等待编辑器加载完成后才能执行的代码,可以使用该方法传入\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.ready( function( editor ) {\n\t\t\t *     editor.setContent('初始化完毕');\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t * @see UE.Editor.event:ready\n\t\t\t */\n\t\t\tready: function(fn) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (fn) {\n\t\t\t\t\tme.isReady ? fn.apply(me) : me.addListener('ready', fn);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 该方法是提供给插件里面使用，设置配置项默认值\n\t\t\t * @method setOpt\n\t\t\t * @warning 三处设置配置项的优先级: 实例化时传入参数 > setOpt()设置 > config文件里设置\n\t\t\t * @warning 该方法仅供编辑器插件内部和编辑器初始化时调用，其他地方不能调用。\n\t\t\t * @param { String } key 编辑器的可接受的选项名称\n\t\t\t * @param { * } val  该选项可接受的值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setOpt( 'initContent', '欢迎使用编辑器' );\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 该方法是提供给插件里面使用，以{key:value}集合的方式设置插件内用到的配置项默认值\n\t\t\t * @method setOpt\n\t\t\t * @warning 三处设置配置项的优先级: 实例化时传入参数 > setOpt()设置 > config文件里设置\n\t\t\t * @warning 该方法仅供编辑器插件内部和编辑器初始化时调用，其他地方不能调用。\n\t\t\t * @param { Object } options 将要设置的选项的键值对对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setOpt( {\n\t\t\t *     'initContent': '欢迎使用编辑器'\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetOpt: function(key, val) {\n\t\t\t\tvar obj = {};\n\t\t\t\tif (utils.isString(key)) {\n\t\t\t\t\tobj[key] = val\n\t\t\t\t} else {\n\t\t\t\t\tobj = key;\n\t\t\t\t}\n\t\t\t\tutils.extend(this.options, obj, true);\n\t\t\t},\n\t\t\tgetOpt: function(key) {\n\t\t\t\treturn this.options[key]\n\t\t\t},\n\t\t\t/**\n\t\t\t * 销毁编辑器实例，使用textarea代替\n\t\t\t * @method destroy\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.destroy();\n\t\t\t * ```\n\t\t\t */\n\t\t\tdestroy: function() {\n\n\t\t\t\tvar me = this;\n\t\t\t\tme.fireEvent('destroy');\n\t\t\t\tvar container = me.container.parentNode;\n\t\t\t\tvar textarea = me.textarea;\n\t\t\t\tif (!textarea) {\n\t\t\t\t\ttextarea = document.createElement('textarea');\n\t\t\t\t\tcontainer.parentNode.insertBefore(textarea, container);\n\t\t\t\t} else {\n\t\t\t\t\ttextarea.style.display = ''\n\t\t\t\t}\n\n\t\t\t\ttextarea.style.width = me.iframe.offsetWidth + 'px';\n\t\t\t\ttextarea.style.height = me.iframe.offsetHeight + 'px';\n\t\t\t\ttextarea.value = me.getContent();\n\t\t\t\ttextarea.id = me.key;\n\t\t\t\tcontainer.innerHTML = '';\n\t\t\t\tdomUtils.remove(container);\n\t\t\t\tvar key = me.key;\n\t\t\t\t//trace:2004\n\t\t\t\tfor (var p in me) {\n\t\t\t\t\tif (me.hasOwnProperty(p)) {\n\t\t\t\t\t\tdelete this[p];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tUE.delEditor(key);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 渲染编辑器的DOM到指定容器\n\t\t\t * @method render\n\t\t\t * @param { String } containerId 指定一个容器ID\n\t\t\t * @remind 执行该方法,会触发ready事件\n\t\t\t * @warning 必须且只能调用一次\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 渲染编辑器的DOM到指定容器\n\t\t\t * @method render\n\t\t\t * @param { Element } containerDom 直接指定容器对象\n\t\t\t * @remind 执行该方法,会触发ready事件\n\t\t\t * @warning 必须且只能调用一次\n\t\t\t */\n\t\t\trender: function(container) {\n\t\t\t\tvar me = this,\n\t\t\t\t\toptions = me.options,\n\t\t\t\t\tgetStyleValue = function(attr) {\n\t\t\t\t\t\treturn parseInt(domUtils.getComputedStyle(container, attr));\n\t\t\t\t\t};\n\t\t\t\tif (utils.isString(container)) {\n\t\t\t\t\tcontainer = document.getElementById(container);\n\t\t\t\t}\n\t\t\t\tif (container) {\n\t\t\t\t\tif (options.initialFrameWidth) {\n\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth = container.offsetWidth;\n\t\t\t\t\t}\n\t\t\t\t\tif (options.initialFrameHeight) {\n\t\t\t\t\t\toptions.minFrameHeight = options.initialFrameHeight\n\t\t\t\t\t} else {\n\t\t\t\t\t\toptions.initialFrameHeight = options.minFrameHeight = container.offsetHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontainer.style.width = /%$/.test(options.initialFrameWidth) ? '100%' : options.initialFrameWidth -\n\t\t\t\t\t\tgetStyleValue(\"padding-left\") - getStyleValue(\"padding-right\") + 'px';\n\t\t\t\t\tcontainer.style.height = /%$/.test(options.initialFrameHeight) ? '100%' : options.initialFrameHeight -\n\t\t\t\t\t\tgetStyleValue(\"padding-top\") - getStyleValue(\"padding-bottom\") + 'px';\n\n\t\t\t\t\tcontainer.style.zIndex = options.zIndex;\n\n\t\t\t\t\tvar html = (ie && browser.version < 9 ? '' : '<!DOCTYPE html>') +\n\t\t\t\t\t\t'<html xmlns=\\'http://www.w3.org/1999/xhtml\\' class=\\'view\\' ><head>' +\n\t\t\t\t\t\t'<style type=\\'text/css\\'>' +\n\t\t\t\t\t\t//设置四周的留边\n\t\t\t\t\t\t'.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\\n' +\n\t\t\t\t\t\t//设置默认字体和字号\n\t\t\t\t\t\t//font-family不能呢随便改，在safari下fillchar会有解析问题\n\t\t\t\t\t\t'body{margin:8px;font-family:sans-serif;font-size:16px;}' +\n\t\t\t\t\t\t//设置段落间距\n\t\t\t\t\t\t'p{margin:5px 0;}</style>' +\n\t\t\t\t\t\t(options.iframeCssUrl ? '<link rel=\\'stylesheet\\' type=\\'text/css\\' href=\\'' + utils.unhtml(options.iframeCssUrl) + '\\'/>' : '') +\n\t\t\t\t\t\t(options.initialStyle ? '<style>' + options.initialStyle + '</style>' : '') +\n\t\t\t\t\t\t'</head><body class=\\'view\\' ></body>' +\n\t\t\t\t\t\t'<script type=\\'text/javascript\\' ' + (ie ? 'defer=\\'defer\\'' : '') + ' id=\\'_initialScript\\'>' +\n\t\t\t\t\t\t'setTimeout(function(){editor = window.parent.UE.instants[\\'ueditorInstant' + me.uid + '\\'];editor._setup(document);},0);' +\n\t\t\t\t\t\t'var _tmpScript = document.getElementById(\\'_initialScript\\');_tmpScript.parentNode.removeChild(_tmpScript);</script></html>';\n\t\t\t\t\tcontainer.appendChild(domUtils.createElement(document, 'iframe', {\n\t\t\t\t\t\tid: 'ueditor_' + me.uid,\n\t\t\t\t\t\twidth: \"100%\",\n\t\t\t\t\t\theight: \"100%\",\n\t\t\t\t\t\tframeborder: \"0\",\n\t\t\t\t\t\t//先注释掉了，加的原因忘记了，但开启会直接导致全屏模式下内容多时不会出现滚动条\n\t\t\t\t\t\t//                    scrolling :'no',\n\t\t\t\t\t\tsrc: 'javascript:void(function(){document.open();' + (options.customDomain && document.domain != location.hostname ? 'document.domain=\"' + document.domain + '\";' : '') +\n\t\t\t\t\t\t\t'document.write(\"' + html + '\");document.close();}())'\n\t\t\t\t\t}));\n\t\t\t\t\tcontainer.style.overflow = 'hidden';\n\t\t\t\t\t//解决如果是给定的百分比，会导致高度算不对的问题\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tif (/%$/.test(options.initialFrameWidth)) {\n\t\t\t\t\t\t\toptions.minFrameWidth = options.initialFrameWidth = container.offsetWidth;\n\t\t\t\t\t\t\t//如果这里给定宽度，会导致ie在拖动窗口大小时，编辑区域不随着变化\n\t\t\t\t\t\t\t//                        container.style.width = options.initialFrameWidth + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (/%$/.test(options.initialFrameHeight)) {\n\t\t\t\t\t\t\toptions.minFrameHeight = options.initialFrameHeight = container.offsetHeight;\n\t\t\t\t\t\t\tcontainer.style.height = options.initialFrameHeight + 'px';\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 编辑器初始化\n\t\t\t * @method _setup\n\t\t\t * @private\n\t\t\t * @param { Element } doc 编辑器Iframe中的文档对象\n\t\t\t */\n\t\t\t_setup: function(doc) {\n\n\t\t\t\tvar me = this,\n\t\t\t\t\toptions = me.options;\n\t\t\t\tif (ie) {\n\t\t\t\t\tdoc.body.disabled = true;\n\t\t\t\t\tdoc.body.contentEditable = true;\n\t\t\t\t\tdoc.body.disabled = false;\n\t\t\t\t} else {\n\t\t\t\t\tdoc.body.contentEditable = true;\n\t\t\t\t}\n\t\t\t\tdoc.body.spellcheck = false;\n\t\t\t\tme.document = doc;\n\t\t\t\tme.window = doc.defaultView || doc.parentWindow;\n\t\t\t\tme.iframe = me.window.frameElement;\n\t\t\t\tme.body = doc.body;\n\t\t\t\tme.selection = new dom.Selection(doc);\n\t\t\t\t//gecko初始化就能得到range,无法判断isFocus了\n\t\t\t\tvar geckoSel;\n\t\t\t\tif (browser.gecko && (geckoSel = this.selection.getNative())) {\n\t\t\t\t\tgeckoSel.removeAllRanges();\n\t\t\t\t}\n\t\t\t\tthis._initEvents();\n\t\t\t\t//为form提交提供一个隐藏的textarea\n\t\t\t\tfor (var form = this.iframe.parentNode; !domUtils.isBody(form); form = form.parentNode) {\n\t\t\t\t\tif (form.tagName == 'FORM') {\n\t\t\t\t\t\tme.form = form;\n\t\t\t\t\t\tif (me.options.autoSyncData) {\n\t\t\t\t\t\t\tdomUtils.on(me.window, 'blur', function() {\n\t\t\t\t\t\t\t\tsetValue(form, me);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.on(form, 'submit', function() {\n\t\t\t\t\t\t\t\tsetValue(this, me);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (options.initialContent) {\n\t\t\t\t\tif (options.autoClearinitialContent) {\n\t\t\t\t\t\tvar oldExecCommand = me.execCommand;\n\t\t\t\t\t\tme.execCommand = function() {\n\t\t\t\t\t\t\tme.fireEvent('firstBeforeExecCommand');\n\t\t\t\t\t\t\treturn oldExecCommand.apply(me, arguments);\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._setDefaultContent(options.initialContent);\n\t\t\t\t\t} else\n\t\t\t\t\t\tthis.setContent(options.initialContent, false, true);\n\t\t\t\t}\n\n\t\t\t\t//编辑器不能为空内容\n\n\t\t\t\tif (domUtils.isEmptyNode(me.body)) {\n\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t}\n\t\t\t\t//如果要求focus, 就把光标定位到内容开始\n\t\t\t\tif (options.focus) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tme.focus(me.options.focusInEnd);\n\t\t\t\t\t\t//如果自动清除开着，就不需要做selectionchange;\n\t\t\t\t\t\t!me.options.autoClearinitialContent && me._selectionChange();\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t\tif (!me.container) {\n\t\t\t\t\tme.container = this.iframe.parentNode;\n\t\t\t\t}\n\t\t\t\tif (options.fullscreen && me.ui) {\n\t\t\t\t\tme.ui.setFullScreen(true);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tme.document.execCommand('2D-position', false, false);\n\t\t\t\t} catch (e) {}\n\t\t\t\ttry {\n\t\t\t\t\tme.document.execCommand('enableInlineTableEditing', false, false);\n\t\t\t\t} catch (e) {}\n\t\t\t\ttry {\n\t\t\t\t\tme.document.execCommand('enableObjectResizing', false, false);\n\t\t\t\t} catch (e) {}\n\n\t\t\t\t//挂接快捷键\n\t\t\t\tme._bindshortcutKeys();\n\t\t\t\tme.isReady = 1;\n\t\t\t\tme.fireEvent('ready');\n\t\t\t\toptions.onready && options.onready.call(me);\n\t\t\t\tif (!browser.ie9below) {\n\t\t\t\t\tdomUtils.on(me.window, ['blur', 'focus'], function(e) {\n\t\t\t\t\t\t//chrome下会出现alt+tab切换时，导致选区位置不对\n\t\t\t\t\t\tif (e.type == 'blur') {\n\t\t\t\t\t\t\tme._bakRange = me.selection.getRange();\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tme._bakNativeRange = me.selection.getNative().getRangeAt(0);\n\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tme._bakNativeRange = null;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tme._bakRange && me._bakRange.select();\n\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\t//trace:1518 ff3.6body不够寛，会导致点击空白处无法获得焦点\n\t\t\t\tif (browser.gecko && browser.version <= 10902) {\n\t\t\t\t\t//修复ff3.6初始化进来，不能点击获得焦点\n\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\t}, 100);\n\t\t\t\t\tsetInterval(function() {\n\t\t\t\t\t\tme.body.style.height = me.iframe.offsetHeight - 20 + 'px'\n\t\t\t\t\t}, 100)\n\t\t\t\t}\n\n\t\t\t\t!options.isShow && me.setHide();\n\t\t\t\toptions.readonly && me.setDisabled();\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 同步数据到编辑器所在的form\n\t\t\t * 从编辑器的容器节点向上查找form元素，若找到，就同步编辑内容到找到的form里，为提交数据做准备，主要用于是手动提交的情况\n\t\t\t * 后台取得数据的键值，使用你容器上的name属性，如果没有就使用参数里的textarea项\n\t\t\t * @method sync\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.sync();\n\t\t\t * form.sumbit(); //form变量已经指向了form元素\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 根据传入的formId，在页面上查找要同步数据的表单，若找到，就同步编辑内容到找到的form里，为提交数据做准备\n\t\t\t * 后台取得数据的键值，该键值默认使用给定的编辑器容器的name属性，如果没有name属性则使用参数项里给定的“textarea”项\n\t\t\t * @method sync\n\t\t\t * @param { String } formID 指定一个要同步数据的form的id,编辑器的数据会同步到你指定form下\n\t\t\t */\n\t\t\tsync: function(formId) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tform = formId ? document.getElementById(formId) :\n\t\t\t\t\tdomUtils.findParent(me.iframe.parentNode, function(node) {\n\t\t\t\t\t\treturn node.tagName == 'FORM'\n\t\t\t\t\t}, true);\n\t\t\t\tform && setValue(form, me);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置编辑器高度\n\t\t\t * @method setHeight\n\t\t\t * @remind 当配置项autoHeightEnabled为真时,该方法无效\n\t\t\t * @param { Number } number 设置的高度值，纯数值，不带单位\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setHeight(number);\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetHeight: function(height, notSetHeight) {\n\t\t\t\tif (height !== parseInt(this.iframe.parentNode.style.height)) {\n\t\t\t\t\tthis.iframe.parentNode.style.height = height + 'px';\n\t\t\t\t}!notSetHeight && (this.options.minFrameHeight = this.options.initialFrameHeight = height);\n\t\t\t\tthis.body.style.height = height + 'px';\n\t\t\t\t!notSetHeight && this.trigger('setHeight')\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 为编辑器的编辑命令提供快捷键\n\t\t\t * 这个接口是为插件扩展提供的接口,主要是为新添加的插件，如果需要添加快捷键，所提供的接口\n\t\t\t * @method addshortcutkey\n\t\t\t * @param { Object } keyset 命令名和快捷键键值对对象，多个按钮的快捷键用“＋”分隔\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addshortcutkey({\n\t\t\t *     \"Bold\" : \"ctrl+66\",//^B\n\t\t\t *     \"Italic\" : \"ctrl+73\", //^I\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 这个接口是为插件扩展提供的接口,主要是为新添加的插件，如果需要添加快捷键，所提供的接口\n\t\t\t * @method addshortcutkey\n\t\t\t * @param { String } cmd 触发快捷键时，响应的命令\n\t\t\t * @param { String } keys 快捷键的字符串，多个按钮用“＋”分隔\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addshortcutkey(\"Underline\", \"ctrl+85\"); //^U\n\t\t\t * ```\n\t\t\t */\n\t\t\taddshortcutkey: function(cmd, keys) {\n\t\t\t\tvar obj = {};\n\t\t\t\tif (keys) {\n\t\t\t\t\tobj[cmd] = keys\n\t\t\t\t} else {\n\t\t\t\t\tobj = cmd;\n\t\t\t\t}\n\t\t\t\tutils.extend(this.shortcutkeys, obj)\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 对编辑器设置keydown事件监听，绑定快捷键和命令，当快捷键组合触发成功，会响应对应的命令\n\t\t\t * @method _bindshortcutKeys\n\t\t\t * @private\n\t\t\t */\n\t\t\t_bindshortcutKeys: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tshortcutkeys = this.shortcutkeys;\n\t\t\t\tme.addListener('keydown', function(type, e) {\n\t\t\t\t\tvar keyCode = e.keyCode || e.which;\n\t\t\t\t\tfor (var i in shortcutkeys) {\n\t\t\t\t\t\tvar tmp = shortcutkeys[i].split(',');\n\t\t\t\t\t\tfor (var t = 0, ti; ti = tmp[t++];) {\n\t\t\t\t\t\t\tti = ti.split(':');\n\t\t\t\t\t\t\tvar key = ti[0],\n\t\t\t\t\t\t\t\tparam = ti[1];\n\t\t\t\t\t\t\tif (/^(ctrl)(\\+shift)?\\+(\\d+)$/.test(key.toLowerCase()) || /^(\\d+)$/.test(key)) {\n\t\t\t\t\t\t\t\tif (((RegExp.$1 == 'ctrl' ? (e.ctrlKey || e.metaKey) : 0) && (RegExp.$2 != \"\" ? e[RegExp.$2.slice(1) + \"Key\"] : 1) && keyCode == RegExp.$3) ||\n\t\t\t\t\t\t\t\t\tkeyCode == RegExp.$1\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tif (me.queryCommandState(i, param) != -1)\n\t\t\t\t\t\t\t\t\t\tme.execCommand(i, param);\n\t\t\t\t\t\t\t\t\tdomUtils.preventDefault(e);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取编辑器的内容\n\t\t\t * @method getContent\n\t\t\t * @warning 该方法获取到的是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @return { String } 编辑器的内容字符串, 如果编辑器的内容为空，或者是空的标签内容（如:”&lt;p&gt;&lt;br/&gt;&lt;/p&gt;“）， 则返回空字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容:<p>1<strong>2<em>34</em>5</strong>6</p>\n\t\t\t * var content = editor.getContent(); //返回值:<p>1<strong>2<em>34</em>5</strong>6</p>\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 获取编辑器的内容。 可以通过参数定义编辑器内置的判空规则\n\t\t\t * @method getContent\n\t\t\t * @param { Function } fn 自定的判空规则， 要求该方法返回一个boolean类型的值，\n\t\t\t *                      代表当前编辑器的内容是否空，\n\t\t\t *                      如果返回true， 则该方法将直接返回空字符串；如果返回false，则编辑器将返回\n\t\t\t *                      经过内置过滤规则处理后的内容。\n\t\t\t * @remind 该方法在处理包含有初始化内容的时候能起到很好的作用。\n\t\t\t * @warning 该方法获取到的是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @return { String } 编辑器的内容字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * // editor 是一个编辑器的实例\n\t\t\t * var content = editor.getContent( function ( editor ) {\n\t\t\t *      return editor.body.innerHTML === '欢迎使用UEditor'; //返回空字符串\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetContent: function(cmd, fn, notSetCursor, ignoreBlank, formatter) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (cmd && utils.isFunction(cmd)) {\n\t\t\t\t\tfn = cmd;\n\t\t\t\t\tcmd = '';\n\t\t\t\t}\n\t\t\t\tif (fn ? !fn() : !this.hasContents()) {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t\tme.fireEvent('beforegetcontent');\n\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML, ignoreBlank);\n\t\t\t\tme.filterOutputRule(root);\n\t\t\t\tme.fireEvent('aftergetcontent', cmd, root);\n\t\t\t\treturn root.toHtml(formatter);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 取得完整的html代码，可以直接显示成完整的html文档\n\t\t\t * @method getAllHtml\n\t\t\t * @return { String } 编辑器的内容html文档字符串\n\t\t\t * @eaxmple\n\t\t\t * ```javascript\n\t\t\t * editor.getAllHtml(); //返回格式大致是: <html><head>...</head><body>...</body></html>\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetAllHtml: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\theadHtml = [],\n\t\t\t\t\thtml = '';\n\t\t\t\tme.fireEvent('getAllHtml', headHtml);\n\t\t\t\tif (browser.ie && browser.version > 8) {\n\t\t\t\t\tvar headHtmlForIE9 = '';\n\t\t\t\t\tutils.each(me.document.styleSheets, function(si) {\n\t\t\t\t\t\theadHtmlForIE9 += (si.href ? '<link rel=\"stylesheet\" type=\"text/css\" href=\"' + si.href + '\" />' : '<style>' + si.cssText + '</style>');\n\t\t\t\t\t});\n\t\t\t\t\tutils.each(me.document.getElementsByTagName('script'), function(si) {\n\t\t\t\t\t\theadHtmlForIE9 += si.outerHTML;\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t\treturn '<html><head>' + (me.options.charset ? '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=' + me.options.charset + '\"/>' : '') + (headHtmlForIE9 || me.document.getElementsByTagName('head')[0].innerHTML) + headHtml.join('\\n') + '</head>' + '<body ' + (ie && browser.version < 9 ? 'class=\"view\"' : '') + '>' + me.getContent(null, null, true) + '</body></html>';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 得到编辑器的纯文本内容，但会保留段落格式\n\t\t\t * @method getPlainTxt\n\t\t\t * @return { String } 编辑器带段落格式的纯文本内容字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容:<p><strong>1</strong></p><p><strong>2</strong></p>\n\t\t\t * console.log(editor.getPlainTxt()); //输出:\"1\\n2\\n\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetPlainTxt: function() {\n\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g'),\n\t\t\t\t\thtml = this.body.innerHTML.replace(/[\\n\\r]/g, ''); //ie要先去了\\n在处理\n\t\t\t\thtml = html.replace(/<(p|div)[^>]*>(<br\\/?>|&nbsp;)<\\/\\1>/gi, '\\n')\n\t\t\t\t\t.replace(/<br\\/?>/gi, '\\n')\n\t\t\t\t\t.replace(/<[^>/]+>/g, '')\n\t\t\t\t\t.replace(/(\\n)?<\\/([^>]+)>/g, function(a, b, c) {\n\t\t\t\t\t\treturn dtd.$block[c] ? '\\n' : b ? b : '';\n\t\t\t\t\t});\n\t\t\t\t//取出来的空格会有c2a0会变成乱码，处理这种情况\\u00a0\n\t\t\t\treturn html.replace(reg, '').replace(/\\u00a0/g, ' ').replace(/&nbsp;/g, ' ');\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取编辑器中的纯文本内容,没有段落格式\n\t\t\t * @method getContentTxt\n\t\t\t * @return { String } 编辑器不带段落格式的纯文本内容字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容:<p><strong>1</strong></p><p><strong>2</strong></p>\n\t\t\t * console.log(editor.getPlainTxt()); //输出:\"12\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetContentTxt: function() {\n\t\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\t\t//取出来的空格会有c2a0会变成乱码，处理这种情况\\u00a0\n\t\t\t\treturn this.body[browser.ie ? 'innerText' : 'textContent'].replace(reg, '').replace(/\\u00a0/g, ' ');\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置编辑器的内容，可修改编辑器当前的html内容\n\t\t\t * @method setContent\n\t\t\t * @warning 通过该方法插入的内容，是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @warning 该方法会触发selectionchange事件\n\t\t\t * @param { String } html 要插入的html内容\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.getContent('<p>test</p>');\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 设置编辑器的内容，可修改编辑器当前的html内容\n\t\t\t * @method setContent\n\t\t\t * @warning 通过该方法插入的内容，是经过编辑器内置的过滤规则进行过滤后得到的内容\n\t\t\t * @warning 该方法会触发selectionchange事件\n\t\t\t * @param { String } html 要插入的html内容\n\t\t\t * @param { Boolean } isAppendTo 若传入true，不清空原来的内容，在最后插入内容，否则，清空内容再插入\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //假设设置前的编辑器内容是 <p>old text</p>\n\t\t\t * editor.setContent('<p>new text</p>', true); //插入的结果是<p>old text</p><p>new text</p>\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetContent: function(html, isAppendTo, notFireSelectionchange) {\n\t\t\t\tvar me = this;\n\n\t\t\t\tme.fireEvent('beforesetcontent', html);\n\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\thtml = root.toHtml();\n\n\t\t\t\tme.body.innerHTML = (isAppendTo ? me.body.innerHTML : '') + html;\n\n\t\t\t\tfunction isCdataDiv(node) {\n\t\t\t\t\treturn node.tagName == 'DIV' && node.getAttribute('cdata_tag');\n\t\t\t\t}\n\t\t\t\t//给文本或者inline节点套p标签\n\t\t\t\tif (me.options.enterTag == 'p') {\n\n\t\t\t\t\tvar child = this.body.firstChild,\n\t\t\t\t\t\ttmpNode;\n\t\t\t\t\tif (!child || child.nodeType == 1 &&\n\t\t\t\t\t\t(dtd.$cdata[child.tagName] || isCdataDiv(child) ||\n\t\t\t\t\t\t\tdomUtils.isCustomeNode(child)\n\t\t\t\t\t\t) && child === this.body.lastChild) {\n\t\t\t\t\t\tthis.body.innerHTML = '<p>' + (browser.ie ? '&nbsp;' : '<br/>') + '</p>' + this.body.innerHTML;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\twhile (child) {\n\t\t\t\t\t\t\twhile (child && (child.nodeType == 3 || child.nodeType == 1 && dtd.p[child.tagName] && !dtd.$cdata[child.tagName])) {\n\t\t\t\t\t\t\t\ttmpNode = child.nextSibling;\n\t\t\t\t\t\t\t\tp.appendChild(child);\n\t\t\t\t\t\t\t\tchild = tmpNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (p.firstChild) {\n\t\t\t\t\t\t\t\tif (!child) {\n\t\t\t\t\t\t\t\t\tme.body.appendChild(p);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchild.parentNode.insertBefore(p, child);\n\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tchild = child.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tme.fireEvent('aftersetcontent');\n\t\t\t\tme.fireEvent('contentchange');\n\n\t\t\t\t!notFireSelectionchange && me._selectionChange();\n\t\t\t\t//清除保存的选区\n\t\t\t\tme._bakRange = me._bakIERange = me._bakNativeRange = null;\n\t\t\t\t//trace:1742 setContent后gecko能得到焦点问题\n\t\t\t\tvar geckoSel;\n\t\t\t\tif (browser.gecko && (geckoSel = this.selection.getNative())) {\n\t\t\t\t\tgeckoSel.removeAllRanges();\n\t\t\t\t}\n\t\t\t\tif (me.options.autoSyncData) {\n\t\t\t\t\tme.form && setValue(me.form, me);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 让编辑器获得焦点，默认focus到编辑器头部\n\t\t\t * @method focus\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.focus()\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 让编辑器获得焦点，toEnd确定focus位置\n\t\t\t * @method focus\n\t\t\t * @param { Boolean } toEnd 默认focus到编辑器头部，toEnd为true时focus到内容尾部\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.focus(true)\n\t\t\t * ```\n\t\t\t */\n\t\t\tfocus: function(toEnd) {\n\t\t\t\ttry {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\tif (toEnd) {\n\t\t\t\t\t\tvar node = me.body.lastChild;\n\t\t\t\t\t\tif (node && node.nodeType == 1 && !dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\t\t\t\t\trng.setStartAtFirst(node)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trng.setStartAtLast(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.collapse(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.setCursor(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!rng.collapsed && domUtils.isBody(rng.startContainer) && rng.startOffset == 0) {\n\n\t\t\t\t\t\t\tvar node = me.body.firstChild;\n\t\t\t\t\t\t\tif (node && node.nodeType == 1 && !dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\trng.setStartAtFirst(node).collapse(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trng.select(true);\n\n\t\t\t\t\t}\n\t\t\t\t\tthis.fireEvent('focus selectionchange');\n\t\t\t\t} catch (e) {}\n\n\t\t\t},\n\t\t\tisFocus: function() {\n\t\t\t\treturn this.selection.isFocus();\n\t\t\t},\n\t\t\tblur: function() {\n\t\t\t\tvar sel = this.selection.getNative();\n\t\t\t\tif (sel.empty && browser.ie) {\n\t\t\t\t\tvar nativeRng = document.body.createTextRange();\n\t\t\t\t\tnativeRng.moveToElementText(document.body);\n\t\t\t\t\tnativeRng.collapse(true);\n\t\t\t\t\tnativeRng.select();\n\t\t\t\t\tsel.empty()\n\t\t\t\t} else {\n\t\t\t\t\tsel.removeAllRanges()\n\t\t\t\t}\n\n\t\t\t\t//this.fireEvent('blur selectionchange');\n\t\t\t},\n\t\t\t/**\n\t\t\t * 初始化UE事件及部分事件代理\n\t\t\t * @method _initEvents\n\t\t\t * @private\n\t\t\t */\n\t\t\t_initEvents: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tdoc = me.document,\n\t\t\t\t\twin = me.window;\n\t\t\t\tme._proxyDomEvent = utils.bind(me._proxyDomEvent, me);\n\t\t\t\tdomUtils.on(doc, ['click', 'contextmenu', 'mousedown', 'keydown', 'keyup', 'keypress', 'mouseup', 'mouseover', 'mouseout', 'selectstart'], me._proxyDomEvent);\n\t\t\t\tdomUtils.on(win, ['focus', 'blur'], me._proxyDomEvent);\n\t\t\t\tdomUtils.on(me.body, 'drop', function(e) {\n\t\t\t\t\t//阻止ff下默认的弹出新页面打开图片\n\t\t\t\t\tif (browser.gecko && e.stopPropagation) {\n\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('contentchange')\n\t\t\t\t});\n\t\t\t\tdomUtils.on(doc, ['mouseup', 'keydown'], function(evt) {\n\t\t\t\t\t//特殊键不触发selectionchange\n\t\t\t\t\tif (evt.type == 'keydown' && (evt.ctrlKey || evt.metaKey || evt.shiftKey || evt.altKey)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (evt.button == 2) return;\n\t\t\t\t\tme._selectionChange(250, evt);\n\t\t\t\t});\n\t\t\t},\n\t\t\t/**\n\t\t\t * 触发事件代理\n\t\t\t * @method _proxyDomEvent\n\t\t\t * @private\n\t\t\t * @return { * } fireEvent的返回值\n\t\t\t * @see UE.EventBase:fireEvent(String)\n\t\t\t */\n\t\t\t_proxyDomEvent: function(evt) {\n\t\t\t\tif (this.fireEvent('before' + evt.type.replace(/^on/, '').toLowerCase()) === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (this.fireEvent(evt.type.replace(/^on/, ''), evt) === false) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn this.fireEvent('after' + evt.type.replace(/^on/, '').toLowerCase())\n\t\t\t},\n\t\t\t/**\n\t\t\t * 变化选区\n\t\t\t * @method _selectionChange\n\t\t\t * @private\n\t\t\t */\n\t\t\t_selectionChange: function(delay, evt) {\n\t\t\t\tvar me = this;\n\t\t\t\t//有光标才做selectionchange 为了解决未focus时点击source不能触发更改工具栏状态的问题（source命令notNeedUndo=1）\n\t\t\t\t//            if ( !me.selection.isFocus() ){\n\t\t\t\t//                return;\n\t\t\t\t//            }\n\n\t\t\t\tvar hackForMouseUp = false;\n\t\t\t\tvar mouseX, mouseY;\n\t\t\t\tif (browser.ie && browser.version < 9 && evt && evt.type == 'mouseup') {\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\thackForMouseUp = true;\n\t\t\t\t\t\tmouseX = evt.clientX;\n\t\t\t\t\t\tmouseY = evt.clientY;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tclearTimeout(_selectionChangeTimer);\n\t\t\t\t_selectionChangeTimer = setTimeout(function() {\n\t\t\t\t\tif (!me.selection || !me.selection.getNative()) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//修复一个IE下的bug: 鼠标点击一段已选择的文本中间时，可能在mouseup后的一段时间内取到的range是在selection的type为None下的错误值.\n\t\t\t\t\t//IE下如果用户是拖拽一段已选择文本，则不会触发mouseup事件，所以这里的特殊处理不会对其有影响\n\t\t\t\t\tvar ieRange;\n\t\t\t\t\tif (hackForMouseUp && me.selection.getNative().type == 'None') {\n\t\t\t\t\t\tieRange = me.document.body.createTextRange();\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tieRange.moveToPoint(mouseX, mouseY);\n\t\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\t\tieRange = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar bakGetIERange;\n\t\t\t\t\tif (ieRange) {\n\t\t\t\t\t\tbakGetIERange = me.selection.getIERange;\n\t\t\t\t\t\tme.selection.getIERange = function() {\n\t\t\t\t\t\t\treturn ieRange;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tme.selection.cache();\n\t\t\t\t\tif (bakGetIERange) {\n\t\t\t\t\t\tme.selection.getIERange = bakGetIERange;\n\t\t\t\t\t}\n\t\t\t\t\tif (me.selection._cachedRange && me.selection._cachedStartElement) {\n\t\t\t\t\t\tme.fireEvent('beforeselectionchange');\n\t\t\t\t\t\t// 第二个参数causeByUi为true代表由用户交互造成的selectionchange.\n\t\t\t\t\t\tme.fireEvent('selectionchange', !!evt);\n\t\t\t\t\t\tme.fireEvent('afterselectionchange');\n\t\t\t\t\t\tme.selection.clear();\n\t\t\t\t\t}\n\t\t\t\t}, delay || 50);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 执行编辑命令\n\t\t\t * @method _callCmdFn\n\t\t\t * @private\n\t\t\t * @param { String } fnName 函数名称\n\t\t\t * @param { * } args 传给命令函数的参数\n\t\t\t * @return { * } 返回命令函数运行的返回值\n\t\t\t */\n\t\t\t_callCmdFn: function(fnName, args) {\n\t\t\t\tvar cmdName = args[0].toLowerCase(),\n\t\t\t\t\tcmd, cmdFn;\n\t\t\t\tcmd = this.commands[cmdName] || UE.commands[cmdName];\n\t\t\t\tcmdFn = cmd && cmd[fnName];\n\t\t\t\t//没有querycommandstate或者没有command的都默认返回0\n\t\t\t\tif ((!cmd || !cmdFn) && fnName == 'queryCommandState') {\n\t\t\t\t\treturn 0;\n\t\t\t\t} else if (cmdFn) {\n\t\t\t\t\treturn cmdFn.apply(this, args);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 执行编辑命令cmdName，完成富文本编辑效果\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmdName 需要执行的命令\n\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t * @return { * } 返回命令函数运行的返回值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand(cmdName);\n\t\t\t * ```\n\t\t\t */\n\t\t\texecCommand: function(cmdName) {\n\t\t\t\tcmdName = cmdName.toLowerCase();\n\t\t\t\tvar me = this,\n\t\t\t\t\tresult,\n\t\t\t\t\tcmd = me.commands[cmdName] || UE.commands[cmdName];\n\t\t\t\tif (!cmd || !cmd.execCommand) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tif (!cmd.notNeedUndo && !me.__hasEnterExecCommand) {\n\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\tif (me.queryCommandState.apply(me, arguments) != -1) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tme.fireEvent.apply(me, ['beforeexeccommand', cmdName].concat(arguments));\n\t\t\t\t\t\tresult = this._callCmdFn('execCommand', arguments);\n\t\t\t\t\t\t//保存场景时，做了内容对比，再看是否进行contentchange触发，这里多触发了一次，去掉\n\t\t\t\t\t\t//                    (!cmd.ignoreContentChange && !me._ignoreContentChange) && me.fireEvent('contentchange');\n\t\t\t\t\t\tme.fireEvent.apply(me, ['afterexeccommand', cmdName].concat(arguments));\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t}\n\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t} else {\n\t\t\t\t\tresult = this._callCmdFn('execCommand', arguments);\n\t\t\t\t\t(!me.__hasEnterExecCommand && !cmd.ignoreContentChange && !me._ignoreContentChange) && me.fireEvent('contentchange')\n\t\t\t\t}\n\t\t\t\t(!me.__hasEnterExecCommand && !cmd.ignoreContentChange && !me._ignoreContentChange) && me._selectionChange();\n\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据传入的command命令，查选编辑器当前的选区，返回命令的状态\n\t\t\t * @method  queryCommandState\n\t\t\t * @param { String } cmdName 需要查询的命令名称\n\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t * @return { Number } number 返回放前命令的状态，返回值三种情况：(-1|0|1)\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState(cmdName)  => (-1|0|1)\n\t\t\t * ```\n\t\t\t * @see COMMAND.LIST\n\t\t\t */\n\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\treturn this._callCmdFn('queryCommandState', arguments);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据传入的command命令，查选编辑器当前的选区，根据命令返回相关的值\n\t\t\t * @method queryCommandValue\n\t\t\t * @param { String } cmdName 需要查询的命令名称\n\t\t\t * @remind 具体命令的使用请参考<a href=\"#COMMAND.LIST\">命令列表</a>\n\t\t\t * @remind 只有部分插件有此方法\n\t\t\t * @return { * } 返回每个命令特定的当前状态值\n\t\t\t * @grammar editor.queryCommandValue(cmdName)  =>  {*}\n\t\t\t * @see COMMAND.LIST\n\t\t\t */\n\t\t\tqueryCommandValue: function(cmdName) {\n\t\t\t\treturn this._callCmdFn('queryCommandValue', arguments);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 检查编辑区域中是否有内容\n\t\t\t * @method  hasContents\n\t\t\t * @remind 默认有文本内容，或者有以下节点都不认为是空\n\t\t\t * table,ul,ol,dl,iframe,area,base,col,hr,img,embed,input,link,meta,param\n\t\t\t * @return { Boolean } 检查有内容返回true，否则返回false\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.hasContents()\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 检查编辑区域中是否有内容，若包含参数tags中的节点类型，直接返回true\n\t\t\t * @method  hasContents\n\t\t\t * @param { Array } tags 传入数组判断时用到的节点类型\n\t\t\t * @return { Boolean } 若文档中包含tags数组里对应的tag，返回true，否则返回false\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.hasContents(['span']);\n\t\t\t * ```\n\t\t\t */\n\t\t\thasContents: function(tags) {\n\t\t\t\tif (tags) {\n\t\t\t\t\tfor (var i = 0, ci; ci = tags[i++];) {\n\t\t\t\t\t\tif (this.document.getElementsByTagName(ci).length > 0) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!domUtils.isEmptyBlock(this.body)) {\n\t\t\t\t\treturn true\n\t\t\t\t}\n\t\t\t\t//随时添加,定义的特殊标签如果存在，不能认为是空\n\t\t\t\ttags = ['div'];\n\t\t\t\tfor (i = 0; ci = tags[i++];) {\n\t\t\t\t\tvar nodes = domUtils.getElementsByTagName(this.document, ci);\n\t\t\t\t\tfor (var n = 0, cn; cn = nodes[n++];) {\n\t\t\t\t\t\tif (domUtils.isCustomeNode(cn)) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 重置编辑器，可用来做多个tab使用同一个编辑器实例\n\t\t\t * @method  reset\n\t\t\t * @remind 此方法会清空编辑器内容，清空回退列表，会触发reset事件\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.reset()\n\t\t\t * ```\n\t\t\t */\n\t\t\treset: function() {\n\t\t\t\tthis.fireEvent('reset');\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置当前编辑区域可以编辑\n\t\t\t * @method setEnabled\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setEnabled()\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetEnabled: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange;\n\t\t\t\tif (me.body.contentEditable == 'false') {\n\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t//有可能内容丢失了\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.moveToBookmark(me.lastBk);\n\t\t\t\t\t\tdelete me.lastBk\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\trange.setStartAtFirst(me.body).collapse(true)\n\t\t\t\t\t}\n\t\t\t\t\trange.select(true);\n\t\t\t\t\tif (me.bkqueryCommandState) {\n\t\t\t\t\t\tme.queryCommandState = me.bkqueryCommandState;\n\t\t\t\t\t\tdelete me.bkqueryCommandState;\n\t\t\t\t\t}\n\t\t\t\t\tif (me.bkqueryCommandValue) {\n\t\t\t\t\t\tme.queryCommandValue = me.bkqueryCommandValue;\n\t\t\t\t\t\tdelete me.bkqueryCommandValue;\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('selectionchange');\n\t\t\t\t}\n\t\t\t},\n\t\t\tenable: function() {\n\t\t\t\treturn this.setEnabled();\n\t\t\t},\n\n\t\t\t/** 设置当前编辑区域不可编辑\n\t\t\t * @method setDisabled\n\t\t\t */\n\n\t\t\t/** 设置当前编辑区域不可编辑,except中的命令除外\n\t\t\t * @method setDisabled\n\t\t\t * @param { String } except 例外命令的字符串\n\t\t\t * @remind 即使设置了disable，此处配置的例外命令仍然可以执行\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setDisabled('bold'); //禁用工具栏中除加粗之外的所有功能\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/** 设置当前编辑区域不可编辑,except中的命令除外\n\t\t\t * @method setDisabled\n\t\t\t * @param { Array } except 例外命令的字符串数组，数组中的命令仍然可以执行\n\t\t\t * @remind 即使设置了disable，此处配置的例外命令仍然可以执行\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setDisabled(['bold','insertimage']); //禁用工具栏中除加粗和插入图片之外的所有功能\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetDisabled: function(except) {\n\t\t\t\tvar me = this;\n\t\t\t\texcept = except ? utils.isArray(except) ? except : [except] : [];\n\t\t\t\tif (me.body.contentEditable == 'true') {\n\t\t\t\t\tif (!me.lastBk) {\n\t\t\t\t\t\tme.lastBk = me.selection.getRange().createBookmark(true);\n\t\t\t\t\t}\n\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\tme.bkqueryCommandState = me.queryCommandState;\n\t\t\t\t\tme.bkqueryCommandValue = me.queryCommandValue;\n\t\t\t\t\tme.queryCommandState = function(type) {\n\t\t\t\t\t\tif (utils.indexOf(except, type) != -1) {\n\t\t\t\t\t\t\treturn me.bkqueryCommandState.apply(me, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t};\n\t\t\t\t\tme.queryCommandValue = function(type) {\n\t\t\t\t\t\tif (utils.indexOf(except, type) != -1) {\n\t\t\t\t\t\t\treturn me.bkqueryCommandValue.apply(me, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t};\n\t\t\t\t\tme.fireEvent('selectionchange');\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisable: function(except) {\n\t\t\t\treturn this.setDisabled(except);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置默认内容\n\t\t\t * @method _setDefaultContent\n\t\t\t * @private\n\t\t\t * @param  { String } cont 要存入的内容\n\t\t\t */\n\t\t\t_setDefaultContent: function() {\n\t\t\t\tfunction clear() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (me.document.getElementById('initContent')) {\n\t\t\t\t\t\tme.body.innerHTML = '<p>' + (ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\tme.removeListener('firstBeforeExecCommand focus', clear);\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tme.focus();\n\t\t\t\t\t\t\tme._selectionChange();\n\t\t\t\t\t\t}, 0)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn function(cont) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.body.innerHTML = '<p id=\"initContent\">' + cont + '</p>';\n\n\t\t\t\t\tme.addListener('firstBeforeExecCommand focus', clear);\n\t\t\t\t}\n\t\t\t}(),\n\n\t\t\t/**\n\t\t\t * 显示编辑器\n\t\t\t * @method setShow\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setShow()\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetShow: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (me.container.style.display == 'none') {\n\t\t\t\t\t//有可能内容丢失了\n\t\t\t\t\ttry {\n\t\t\t\t\t\trange.moveToBookmark(me.lastBk);\n\t\t\t\t\t\tdelete me.lastBk\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\trange.setStartAtFirst(me.body).collapse(true)\n\t\t\t\t\t}\n\t\t\t\t\t//ie下focus实效，所以做了个延迟\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\trange.select(true);\n\t\t\t\t\t}, 100);\n\t\t\t\t\tme.container.style.display = '';\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tshow: function() {\n\t\t\t\treturn this.setShow();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 隐藏编辑器\n\t\t\t * @method setHide\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.setHide()\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetHide: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!me.lastBk) {\n\t\t\t\t\tme.lastBk = me.selection.getRange().createBookmark(true);\n\t\t\t\t}\n\t\t\t\tme.container.style.display = 'none'\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\treturn this.setHide();\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据指定的路径，获取对应的语言资源\n\t\t\t * @method getLang\n\t\t\t * @param { String } path 路径根据的是lang目录下的语言文件的路径结构\n\t\t\t * @return { Object | String } 根据路径返回语言资源的Json格式对象或者语言字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.getLang('contextMenu.delete'); //如果当前是中文，那返回是的是'删除'\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetLang: function(path) {\n\t\t\t\tvar lang = UE.I18N[this.options.lang];\n\t\t\t\tif (!lang) {\n\t\t\t\t\tthrow Error(\"not import language file\");\n\t\t\t\t}\n\t\t\t\tpath = (path || \"\").split(\".\");\n\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\tlang = lang[ci];\n\t\t\t\t\tif (!lang) break;\n\t\t\t\t}\n\t\t\t\treturn lang;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 计算编辑器html内容字符串的长度\n\t\t\t * @method  getContentLength\n\t\t\t * @return { Number } 返回计算的长度\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容<p><strong>132</strong></p>\n\t\t\t * editor.getContentLength() //返回27\n\t\t\t * ```\n\t\t\t */\n\t\t\t/**\n\t\t\t * 计算编辑器当前纯文本内容的长度\n\t\t\t * @method  getContentLength\n\t\t\t * @param { Boolean } ingoneHtml 传入true时，只按照纯文本来计算\n\t\t\t * @return { Number } 返回计算的长度，内容中有hr/img/iframe标签，长度加1\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //编辑器html内容<p><strong>132</strong></p>\n\t\t\t * editor.getContentLength() //返回3\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetContentLength: function(ingoneHtml, tagNames) {\n\t\t\t\tvar count = this.getContent(false, false, true).length;\n\t\t\t\tif (ingoneHtml) {\n\t\t\t\t\ttagNames = (tagNames || []).concat(['hr', 'img', 'iframe']);\n\t\t\t\t\tcount = this.getContentTxt().replace(/[\\t\\r\\n]+/g, '').length;\n\t\t\t\t\tfor (var i = 0, ci; ci = tagNames[i++];) {\n\t\t\t\t\t\tcount += this.document.getElementsByTagName(ci).length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn count;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 注册输入过滤规则\n\t\t\t * @method  addInputRule\n\t\t\t * @param { Function } rule 要添加的过滤规则\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addInputRule(function(root){\n\t\t\t *   $.each(root.getNodesByTagName('div'),function(i,node){\n\t\t\t *       node.tagName=\"p\";\n\t\t\t *   });\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\taddInputRule: function(rule) {\n\t\t\t\tthis.inputRules.push(rule);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 执行注册的过滤规则\n\t\t\t * @method  filterInputRule\n\t\t\t * @param { UE.uNode } root 要过滤的uNode节点\n\t\t\t * @remind 执行editor.setContent方法和执行'inserthtml'命令后，会运行该过滤函数\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.filterInputRule(editor.body);\n\t\t\t * ```\n\t\t\t * @see UE.Editor:addInputRule\n\t\t\t */\n\t\t\tfilterInputRule: function(root) {\n\t\t\t\tfor (var i = 0, ci; ci = this.inputRules[i++];) {\n\t\t\t\t\tci.call(this, root)\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 注册输出过滤规则\n\t\t\t * @method  addOutputRule\n\t\t\t * @param { Function } rule 要添加的过滤规则\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.addOutputRule(function(root){\n\t\t\t *   $.each(root.getNodesByTagName('p'),function(i,node){\n\t\t\t *       node.tagName=\"div\";\n\t\t\t *   });\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\taddOutputRule: function(rule) {\n\t\t\t\tthis.outputRules.push(rule)\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据输出过滤规则，过滤编辑器内容\n\t\t\t * @method  filterOutputRule\n\t\t\t * @remind 执行editor.getContent方法的时候，会先运行该过滤函数\n\t\t\t * @param { UE.uNode } root 要过滤的uNode节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.filterOutputRule(editor.body);\n\t\t\t * ```\n\t\t\t * @see UE.Editor:addOutputRule\n\t\t\t */\n\t\t\tfilterOutputRule: function(root) {\n\t\t\t\tfor (var i = 0, ci; ci = this.outputRules[i++];) {\n\t\t\t\t\tci.call(this, root)\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据action名称获取请求的路径\n\t\t\t * @method  getActionUrl\n\t\t\t * @remind 假如没有设置serverUrl,会根据imageUrl设置默认的controller路径\n\t\t\t * @param { String } action action名称\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.getActionUrl('config'); //返回 \"/ueditor/php/controller.php?action=config\"\n\t\t\t * editor.getActionUrl('image'); //返回 \"/ueditor/php/controller.php?action=uplaodimage\"\n\t\t\t * editor.getActionUrl('scrawl'); //返回 \"/ueditor/php/controller.php?action=uplaodscrawl\"\n\t\t\t * editor.getActionUrl('imageManager'); //返回 \"/ueditor/php/controller.php?action=listimage\"\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetActionUrl: function(action) {\n\t\t\t\tvar actionName = this.getOpt(action) || action,\n\t\t\t\t\timageUrl = this.getOpt('imageUrl'),\n\t\t\t\t\tserverUrl = this.getOpt('serverUrl');\n\n\t\t\t\tif (!serverUrl && imageUrl) {\n\t\t\t\t\tserverUrl = imageUrl.replace(/^(.*[\\/]).+([\\.].+)$/, '$1controller$2');\n\t\t\t\t}\n\n\t\t\t\tif (serverUrl) {\n\t\t\t\t\tserverUrl = serverUrl + (serverUrl.indexOf('?') == -1 ? '?' : '&') + 'action=' + (actionName || '');\n\t\t\t\t\treturn utils.formatUrl(serverUrl);\n\t\t\t\t} else {\n\t\t\t\t\treturn '';\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Editor, EventBase);\n\t})();\n\n\t// core/Editor.defaultoptions.js\n\t//维护编辑器一下默认的不在插件中的配置项\n\tUE.Editor.defaultOptions = function(editor) {\n\n\t\tvar _url = editor.options.UEDITOR_HOME_URL;\n\t\treturn {\n\t\t\tisShow: true,\n\t\t\tinitialContent: '',\n\t\t\tinitialStyle: '',\n\t\t\tautoClearinitialContent: false,\n\t\t\tiframeCssUrl: _url + 'themes/iframe.css',\n\t\t\ttextarea: 'editorValue',\n\t\t\tfocus: false,\n\t\t\tfocusInEnd: true,\n\t\t\tautoClearEmptyNode: true,\n\t\t\tfullscreen: false,\n\t\t\treadonly: false,\n\t\t\tzIndex: 999,\n\t\t\timagePopup: true,\n\t\t\tenterTag: 'p',\n\t\t\tcustomDomain: false,\n\t\t\tlang: 'zh-cn',\n\t\t\tlangPath: _url + 'lang/',\n\t\t\ttheme: 'default',\n\t\t\tthemePath: _url + 'themes/',\n\t\t\tallHtmlEnabled: false,\n\t\t\tscaleEnabled: false,\n\t\t\ttableNativeEditInFF: false,\n\t\t\tautoSyncData: true,\n\t\t\tfileNameFormat: '{time}{rand:6}'\n\t\t}\n\t};\n\n\t// core/loadconfig.js\n\t(function() {\n\n\t\tUE.Editor.prototype.loadServerConfig = function() {\n\t\t\tvar me = this;\n\t\t\tsetTimeout(function() {\n\t\t\t\ttry {\n\t\t\t\t\tme.options.imageUrl && me.setOpt('serverUrl', me.options.imageUrl.replace(/^(.*[\\/]).+([\\.].+)$/, '$1controller$2'));\n\n\t\t\t\t\tvar configUrl = me.getActionUrl('config'),\n\t\t\t\t\t\tisJsonp = utils.isCrossDomainUrl(configUrl);\n\t\t\t\t\t/* 发出ajax请求 */\n\t\t\t\t\tme._serverConfigLoaded = false;\n\n\t\t\t\t\tconfigUrl && UE.ajax.request(configUrl, {\n\t\t\t\t\t\t'method': 'GET',\n\t\t\t\t\t\t'dataType': isJsonp ? 'jsonp' : '',\n\t\t\t\t\t\t'onsuccess': function(r) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tvar config = isJsonp ? r : eval(\"(\" + r.responseText + \")\");\n\t\t\t\t\t\t\t\tutils.extend(me.options, config);\n\t\t\t\t\t\t\t\tme.fireEvent('serverConfigLoaded');\n\t\t\t\t\t\t\t\tme._serverConfigLoaded = true;\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigFormatError'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'onerror': function() {\n\t\t\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigHttpError'));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowErrorMsg(me.getLang('loadconfigError'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfunction showErrorMsg(msg) {\n\t\t\t\tconsole && console.error(msg);\n\t\t\t\t//me.fireEvent('showMessage', {\n\t\t\t\t//    'title': msg,\n\t\t\t\t//    'type': 'error'\n\t\t\t\t//});\n\t\t\t}\n\t\t};\n\n\t\tUE.Editor.prototype.isServerConfigLoaded = function() {\n\t\t\tvar me = this;\n\t\t\treturn me._serverConfigLoaded || false;\n\t\t};\n\n\t\tUE.Editor.prototype.afterConfigReady = function(handler) {\n\t\t\tif (!handler || !utils.isFunction(handler)) return;\n\t\t\tvar me = this;\n\t\t\tvar readyHandler = function() {\n\t\t\t\thandler.apply(me, arguments);\n\t\t\t\tme.removeListener('serverConfigLoaded', readyHandler);\n\t\t\t};\n\n\t\t\tif (me.isServerConfigLoaded()) {\n\t\t\t\thandler.call(me, 'serverConfigLoaded');\n\t\t\t} else {\n\t\t\t\tme.addListener('serverConfigLoaded', readyHandler);\n\t\t\t}\n\t\t};\n\n\t})();\n\n\t// core/ajax.js\n\t/**\n\t * @file\n\t * @module UE.ajax\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 提供对ajax请求的支持\n\t * @module UE.ajax\n\t */\n\tUE.ajax = function() {\n\n\t\t//创建一个ajaxRequest对象\n\t\tvar fnStr = 'XMLHttpRequest()';\n\t\ttry {\n\t\t\tnew ActiveXObject(\"Msxml2.XMLHTTP\");\n\t\t\tfnStr = 'ActiveXObject(\\'Msxml2.XMLHTTP\\')';\n\t\t} catch (e) {\n\t\t\ttry {\n\t\t\t\tnew ActiveXObject(\"Microsoft.XMLHTTP\");\n\t\t\t\tfnStr = 'ActiveXObject(\\'Microsoft.XMLHTTP\\')'\n\t\t\t} catch (e) {}\n\t\t}\n\t\tvar creatAjaxRequest = new Function('return new ' + fnStr);\n\n\t\t/**\n\t\t * 将json参数转化成适合ajax提交的参数列表\n\t\t * @param json\n\t\t */\n\t\tfunction json2str(json) {\n\t\t\tvar strArr = [];\n\t\t\tfor (var i in json) {\n\t\t\t\t//忽略默认的几个参数\n\t\t\t\tif (i == \"method\" || i == \"timeout\" || i == \"async\" || i == \"dataType\" || i == \"callback\") continue;\n\t\t\t\t//忽略控制\n\t\t\t\tif (json[i] == undefined || json[i] == null) continue;\n\t\t\t\t//传递过来的对象和函数不在提交之列\n\t\t\t\tif (!((typeof json[i]).toLowerCase() == \"function\" || (typeof json[i]).toLowerCase() == \"object\")) {\n\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"=\" + encodeURIComponent(json[i]));\n\t\t\t\t} else if (utils.isArray(json[i])) {\n\t\t\t\t\t//支持传数组内容\n\t\t\t\t\tfor (var j = 0; j < json[i].length; j++) {\n\t\t\t\t\t\tstrArr.push(encodeURIComponent(i) + \"[]=\" + encodeURIComponent(json[i][j]));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn strArr.join(\"&\");\n\t\t}\n\n\t\tfunction doAjax(url, ajaxOptions) {\n\t\t\tvar xhr = creatAjaxRequest(),\n\t\t\t\t//是否超时\n\t\t\t\ttimeIsOut = false,\n\t\t\t\t//默认参数\n\t\t\t\tdefaultAjaxOptions = {\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\ttimeout: 5000,\n\t\t\t\t\tasync: true,\n\t\t\t\t\tdata: {}, //需要传递对象的话只能覆盖\n\t\t\t\t\tonsuccess: function() {},\n\t\t\t\t\tonerror: function() {}\n\t\t\t\t};\n\n\t\t\tif (typeof url === \"object\") {\n\t\t\t\tajaxOptions = url;\n\t\t\t\turl = ajaxOptions.url;\n\t\t\t}\n\t\t\tif (!xhr || !url) return;\n\t\t\tvar ajaxOpts = ajaxOptions ? utils.extend(defaultAjaxOptions, ajaxOptions) : defaultAjaxOptions;\n\n\t\t\tvar submitStr = json2str(ajaxOpts); // { name:\"Jim\",city:\"Beijing\" } --> \"name=Jim&city=Beijing\"\n\t\t\t//如果用户直接通过data参数传递json对象过来，则也要将此json对象转化为字符串\n\t\t\tif (!utils.isEmptyObject(ajaxOpts.data)) {\n\t\t\t\tsubmitStr += (submitStr ? \"&\" : \"\") + json2str(ajaxOpts.data);\n\t\t\t}\n\t\t\t//超时检测\n\t\t\tvar timerID = setTimeout(function() {\n\t\t\t\tif (xhr.readyState != 4) {\n\t\t\t\t\ttimeIsOut = true;\n\t\t\t\t\txhr.abort();\n\t\t\t\t\tclearTimeout(timerID);\n\t\t\t\t}\n\t\t\t}, ajaxOpts.timeout);\n\n\t\t\tvar method = ajaxOpts.method.toUpperCase();\n\t\t\tvar str = url + (url.indexOf(\"?\") == -1 ? \"?\" : \"&\") + (method == \"POST\" ? \"\" : submitStr + \"&noCache=\" + +new Date);\n\t\t\txhr.open(method, str, ajaxOpts.async);\n\t\t\txhr.onreadystatechange = function() {\n\t\t\t\tif (xhr.readyState == 4) {\n\t\t\t\t\tif (!timeIsOut && xhr.status == 200) {\n\t\t\t\t\t\tajaxOpts.onsuccess(xhr);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tajaxOpts.onerror(xhr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (method == \"POST\") {\n\t\t\t\txhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\t\t\t\txhr.send(submitStr);\n\t\t\t} else {\n\t\t\t\txhr.send(null);\n\t\t\t}\n\t\t}\n\n\t\tfunction doJsonp(url, opts) {\n\n\t\t\tvar successhandler = opts.onsuccess || function() {},\n\t\t\t\tscr = document.createElement('SCRIPT'),\n\t\t\t\toptions = opts || {},\n\t\t\t\tcharset = options['charset'],\n\t\t\t\tcallbackField = options['jsonp'] || 'callback',\n\t\t\t\tcallbackFnName,\n\t\t\t\ttimeOut = options['timeOut'] || 0,\n\t\t\t\ttimer,\n\t\t\t\treg = new RegExp('(\\\\?|&)' + callbackField + '=([^&]*)'),\n\t\t\t\tmatches;\n\n\t\t\tif (utils.isFunction(successhandler)) {\n\t\t\t\tcallbackFnName = 'bd__editor__' + Math.floor(Math.random() * 2147483648).toString(36);\n\t\t\t\twindow[callbackFnName] = getCallBack(0);\n\t\t\t} else if (utils.isString(successhandler)) {\n\t\t\t\tcallbackFnName = successhandler;\n\t\t\t} else {\n\t\t\t\tif (matches = reg.exec(url)) {\n\t\t\t\t\tcallbackFnName = matches[2];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\turl = url.replace(reg, '\\x241' + callbackField + '=' + callbackFnName);\n\n\t\t\tif (url.search(reg) < 0) {\n\t\t\t\turl += (url.indexOf('?') < 0 ? '?' : '&') + callbackField + '=' + callbackFnName;\n\t\t\t}\n\n\t\t\tvar queryStr = json2str(opts); // { name:\"Jim\",city:\"Beijing\" } --> \"name=Jim&city=Beijing\"\n\t\t\t//如果用户直接通过data参数传递json对象过来，则也要将此json对象转化为字符串\n\t\t\tif (!utils.isEmptyObject(opts.data)) {\n\t\t\t\tqueryStr += (queryStr ? \"&\" : \"\") + json2str(opts.data);\n\t\t\t}\n\t\t\tif (queryStr) {\n\t\t\t\turl = url.replace(/\\?/, '?' + queryStr + '&');\n\t\t\t}\n\n\t\t\tscr.onerror = getCallBack(1);\n\t\t\tif (timeOut) {\n\t\t\t\ttimer = setTimeout(getCallBack(1), timeOut);\n\t\t\t}\n\t\t\tcreateScriptTag(scr, url, charset);\n\n\t\t\tfunction createScriptTag(scr, url, charset) {\n\t\t\t\tscr.setAttribute('type', 'text/javascript');\n\t\t\t\tscr.setAttribute('defer', 'defer');\n\t\t\t\tcharset && scr.setAttribute('charset', charset);\n\t\t\t\tscr.setAttribute('src', url);\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(scr);\n\t\t\t}\n\n\t\t\tfunction getCallBack(onTimeOut) {\n\t\t\t\treturn function() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (onTimeOut) {\n\t\t\t\t\t\t\toptions.onerror && options.onerror();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t\t\t\tsuccesshandler.apply(window, arguments);\n\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (exception) {\n\t\t\t\t\t\toptions.onerror && options.onerror.call(window, exception);\n\t\t\t\t\t} finally {\n\t\t\t\t\t\toptions.oncomplete && options.oncomplete.apply(window, arguments);\n\t\t\t\t\t\tscr.parentNode && scr.parentNode.removeChild(scr);\n\t\t\t\t\t\twindow[callbackFnName] = null;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tdelete window[callbackFnName];\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\t/**\n\t\t\t * 根据给定的参数项，向指定的url发起一个ajax请求。 ajax请求完成后，会根据请求结果调用相应回调： 如果请求\n\t\t\t * 成功， 则调用onsuccess回调， 失败则调用 onerror 回调\n\t\t\t * @method request\n\t\t\t * @param { URLString } url ajax请求的url地址\n\t\t\t * @param { Object } ajaxOptions ajax请求选项的键值对，支持的选项如下：\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * //向sayhello.php发起一个异步的Ajax GET请求, 请求超时时间为10s， 请求完成后执行相应的回调。\n\t\t\t * UE.ajax.requeset( 'sayhello.php', {\n\t\t\t *\n\t\t\t *     //请求方法。可选值： 'GET', 'POST'，默认值是'POST'\n\t\t\t *     method: 'GET',\n\t\t\t *\n\t\t\t *     //超时时间。 默认为5000， 单位是ms\n\t\t\t *     timeout: 10000,\n\t\t\t *\n\t\t\t *     //是否是异步请求。 true为异步请求， false为同步请求\n\t\t\t *     async: true,\n\t\t\t *\n\t\t\t *     //请求携带的数据。如果请求为GET请求， data会经过stringify后附加到请求url之后。\n\t\t\t *     data: {\n\t\t\t *         name: 'ueditor'\n\t\t\t *     },\n\t\t\t *\n\t\t\t *     //请求成功后的回调， 该回调接受当前的XMLHttpRequest对象作为参数。\n\t\t\t *     onsuccess: function ( xhr ) {\n\t\t\t *         console.log( xhr.responseText );\n\t\t\t *     },\n\t\t\t *\n\t\t\t *     //请求失败或者超时后的回调。\n\t\t\t *     onerror: function ( xhr ) {\n\t\t\t *          alert( 'Ajax请求失败' );\n\t\t\t *     }\n\t\t\t *\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 根据给定的参数项发起一个ajax请求， 参数项里必须包含一个url地址。 ajax请求完成后，会根据请求结果调用相应回调： 如果请求\n\t\t\t * 成功， 则调用onsuccess回调， 失败则调用 onerror 回调。\n\t\t\t * @method request\n\t\t\t * @warning 如果在参数项里未提供一个key为“url”的地址值，则该请求将直接退出。\n\t\t\t * @param { Object } ajaxOptions ajax请求选项的键值对，支持的选项如下：\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t *\n\t\t\t * //向sayhello.php发起一个异步的Ajax POST请求, 请求超时时间为5s， 请求完成后不执行任何回调。\n\t\t\t * UE.ajax.requeset( 'sayhello.php', {\n\t\t\t *\n\t\t\t *     //请求的地址， 该项是必须的。\n\t\t\t *     url: 'sayhello.php'\n\t\t\t *\n\t\t\t * } );\n\t\t\t * ```\n\t\t\t */\n\t\t\trequest: function(url, opts) {\n\t\t\t\tif (opts && opts.dataType == 'jsonp') {\n\t\t\t\t\tdoJsonp(url, opts);\n\t\t\t\t} else {\n\t\t\t\t\tdoAjax(url, opts);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetJSONP: function(url, data, fn) {\n\t\t\t\tvar opts = {\n\t\t\t\t\t'data': data,\n\t\t\t\t\t'oncomplete': fn\n\t\t\t\t};\n\t\t\t\tdoJsonp(url, opts);\n\t\t\t}\n\t\t};\n\n\t}();\n\n\t// core/filterword.js\n\t/**\n\t * UE过滤word的静态方法\n\t * @file\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @module UE\n\t */\n\n\t/**\n\t * 根据传入html字符串过滤word\n\t * @module UE\n\t * @since 1.2.6.1\n\t * @method filterWord\n\t * @param { String } html html字符串\n\t * @return { String } 已过滤后的结果字符串\n\t * @example\n\t * ```javascript\n\t * UE.filterWord(html);\n\t * ```\n\t */\n\tvar filterWord = UE.filterWord = function() {\n\n\t\t//是否是word过来的内容\n\t\tfunction isWordDocument(str) {\n\t\t\treturn /(class=\"?Mso|style=\"[^\"]*\\bmso\\-|w:WordDocument|<(v|o):|lang=)/ig.test(str);\n\t\t}\n\t\t//去掉小数\n\t\tfunction transUnit(v) {\n\t\t\tv = v.replace(/[\\d.]+\\w+/g, function(m) {\n\t\t\t\treturn utils.transUnitToPx(m);\n\t\t\t});\n\t\t\treturn v;\n\t\t}\n\n\t\tfunction filterPasteWord(str) {\n\t\t\treturn str.replace(/[\\t\\r\\n]+/g, ' ')\n\t\t\t\t.replace(/<!--[\\s\\S]*?-->/ig, \"\")\n\t\t\t\t//转换图片\n\t\t\t\t.replace(/<v:shape [^>]*>[\\s\\S]*?.<\\/v:shape>/gi, function(str) {\n\t\t\t\t\t//opera能自己解析出image所这里直接返回空\n\t\t\t\t\tif (browser.opera) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//有可能是bitmap占为图，无用，直接过滤掉，主要体现在粘贴excel表格中\n\t\t\t\t\t\tif (/Bitmap/i.test(str)) {\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar width = str.match(/width:([ \\d.]*p[tx])/i)[1],\n\t\t\t\t\t\t\theight = str.match(/height:([ \\d.]*p[tx])/i)[1],\n\t\t\t\t\t\t\tsrc = str.match(/src=\\s*\"([^\"]*)\"/i)[1];\n\t\t\t\t\t\treturn '<img width=\"' + transUnit(width) + '\" height=\"' + transUnit(height) + '\" src=\"' + src + '\" />';\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t//针对wps添加的多余标签处理\n\t\t\t\t.replace(/<\\/?div[^>]*>/g, '')\n\t\t\t\t//去掉多余的属性\n\t\t\t\t.replace(/v:\\w+=([\"']?)[^'\"]+\\1/g, '')\n\t\t\t\t.replace(/<(!|script[^>]*>.*?<\\/script(?=[>\\s])|\\/?(\\?xml(:\\w+)?|xml|meta|link|style|\\w+:\\w+)(?=[\\s\\/>]))[^>]*>/gi, \"\")\n\t\t\t\t.replace(/<p [^>]*class=\"?MsoHeading\"?[^>]*>(.*?)<\\/p>/gi, \"<p><strong>$1</strong></p>\")\n\t\t\t\t//去掉多余的属性\n\t\t\t\t.replace(/\\s+(class|lang|align)\\s*=\\s*(['\"]?)([\\w-]+)\\2/ig, function(str, name, marks, val) {\n\t\t\t\t\t//保留list的标示\n\t\t\t\t\treturn name == 'class' && val == 'MsoListParagraph' ? str : ''\n\t\t\t\t})\n\t\t\t\t//清除多余的font/span不能匹配&nbsp;有可能是空格\n\t\t\t\t.replace(/<(font|span)[^>]*>(\\s*)<\\/\\1>/gi, function(a, b, c) {\n\t\t\t\t\treturn c.replace(/[\\t\\r\\n ]+/g, ' ')\n\t\t\t\t})\n\t\t\t\t//处理style的问题\n\t\t\t\t.replace(/(<[a-z][^>]*)\\sstyle=([\"'])([^\\2]*?)\\2/gi, function(str, tag, tmp, style) {\n\t\t\t\t\tvar n = [],\n\t\t\t\t\t\ts = style.replace(/^\\s+|\\s+$/, '')\n\t\t\t\t\t\t.replace(/&#39;/g, '\\'')\n\t\t\t\t\t\t.replace(/&quot;/gi, \"'\")\n\t\t\t\t\t\t.replace(/[\\d.]+(cm|pt)/g, function(str) {\n\t\t\t\t\t\t\treturn utils.transUnitToPx(str)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.split(/;\\s*/g);\n\n\t\t\t\t\tfor (var i = 0, v; v = s[i]; i++) {\n\n\t\t\t\t\t\tvar name, value,\n\t\t\t\t\t\t\tparts = v.split(\":\");\n\n\t\t\t\t\t\tif (parts.length == 2) {\n\t\t\t\t\t\t\tname = parts[0].toLowerCase();\n\t\t\t\t\t\t\tvalue = parts[1].toLowerCase();\n\t\t\t\t\t\t\tif (/^(background)\\w*/.test(name) && value.replace(/(initial|\\s)/g, '').length == 0 ||\n\t\t\t\t\t\t\t\t/^(margin)\\w*/.test(name) && /^0\\w+$/.test(value)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tswitch (name) {\n\t\t\t\t\t\t\t\tcase \"mso-padding-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-top-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-right-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-bottom-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-padding-left-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-top-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-right-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-bottom-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-margin-left-alt\":\n\t\t\t\t\t\t\t\t\t//ie下会出现挤到一起的情况\n\t\t\t\t\t\t\t\t\t//case \"mso-table-layout-alt\":\n\t\t\t\t\t\t\t\tcase \"mso-height\":\n\t\t\t\t\t\t\t\tcase \"mso-width\":\n\t\t\t\t\t\t\t\tcase \"mso-vertical-align-alt\":\n\t\t\t\t\t\t\t\t\t//trace:1819 ff下会解析出padding在table上\n\t\t\t\t\t\t\t\t\tif (!/<table/.test(tag))\n\t\t\t\t\t\t\t\t\t\tn[i] = name.replace(/^mso-|-alt$/g, \"\") + \":\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\tcase \"horiz-align\":\n\t\t\t\t\t\t\t\t\tn[i] = \"text-align:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"vert-align\":\n\t\t\t\t\t\t\t\t\tn[i] = \"vertical-align:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"font-color\":\n\t\t\t\t\t\t\t\tcase \"mso-foreground\":\n\t\t\t\t\t\t\t\t\tn[i] = \"color:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-background\":\n\t\t\t\t\t\t\t\tcase \"mso-highlight\":\n\t\t\t\t\t\t\t\t\tn[i] = \"background:\" + value;\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-default-height\":\n\t\t\t\t\t\t\t\t\tn[i] = \"min-height:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-default-width\":\n\t\t\t\t\t\t\t\t\tn[i] = \"min-width:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"mso-padding-between-alt\":\n\t\t\t\t\t\t\t\t\tn[i] = \"border-collapse:separate;border-spacing:\" + transUnit(value);\n\t\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t\tcase \"text-line-through\":\n\t\t\t\t\t\t\t\t\tif ((value == \"single\") || (value == \"double\")) {\n\t\t\t\t\t\t\t\t\t\tn[i] = \"text-decoration:line-through\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\tcase \"mso-zero-height\":\n\t\t\t\t\t\t\t\t\tif (value == \"yes\") {\n\t\t\t\t\t\t\t\t\t\tn[i] = \"display:none\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t//                                case 'background':\n\t\t\t\t\t\t\t\t\t//                                    break;\n\t\t\t\t\t\t\t\tcase 'margin':\n\t\t\t\t\t\t\t\t\tif (!/[1-9]/.test(value)) {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(name) ||\n\t\t\t\t\t\t\t\t/text\\-indent|padding|margin/.test(name) && /\\-[\\d.]+/.test(value)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tn[i] = name + \":\" + parts[1];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn tag + (n.length ? ' style=\"' + n.join(';').replace(/;{2,}/g, ';') + '\"' : '');\n\t\t\t\t})\n\n\t\t}\n\n\t\treturn function(html) {\n\t\t\treturn (isWordDocument(html) ? filterPasteWord(html) : html);\n\t\t};\n\t}();\n\n\t// core/node.js\n\t/**\n\t * 编辑器模拟的节点类\n\t * @file\n\t * @module UE\n\t * @class uNode\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t(function() {\n\n\t\t/**\n\t\t * 编辑器模拟的节点类\n\t\t * @unfile\n\t\t * @module UE\n\t\t * @class uNode\n\t\t */\n\n\t\t/**\n\t\t * 通过一个键值对，创建一个uNode对象\n\t\t * @constructor\n\t\t * @param { Object } attr 传入要创建的uNode的初始属性\n\t\t * @example\n\t\t * ```javascript\n\t\t * var node = new uNode({\n\t\t *     type:'element',\n\t\t *     tagName:'span',\n\t\t *     attrs:{style:'font-size:14px;'}\n\t\t * }\n\t\t * ```\n\t\t */\n\t\tvar uNode = UE.uNode = function(obj) {\n\t\t\tthis.type = obj.type;\n\t\t\tthis.data = obj.data;\n\t\t\tthis.tagName = obj.tagName;\n\t\t\tthis.parentNode = obj.parentNode;\n\t\t\tthis.attrs = obj.attrs || {};\n\t\t\tthis.children = obj.children;\n\t\t};\n\n\t\tvar notTransAttrs = {\n\t\t\t'href': 1,\n\t\t\t'src': 1,\n\t\t\t'_src': 1,\n\t\t\t'_href': 1,\n\t\t\t'cdata_data': 1\n\t\t};\n\n\t\tvar notTransTagName = {\n\t\t\tstyle: 1,\n\t\t\tscript: 1\n\t\t};\n\n\t\tvar indentChar = '    ',\n\t\t\tbreakChar = '\\n';\n\n\t\tfunction insertLine(arr, current, begin) {\n\t\t\tarr.push(breakChar);\n\t\t\treturn current + (begin ? 1 : -1);\n\t\t}\n\n\t\tfunction insertIndent(arr, current) {\n\t\t\t//插入缩进\n\t\t\tfor (var i = 0; i < current; i++) {\n\t\t\t\tarr.push(indentChar);\n\t\t\t}\n\t\t}\n\n\t\t//创建uNode的静态方法\n\t\t//支持标签和html\n\t\tuNode.createElement = function(html) {\n\t\t\tif (/[<>]/.test(html)) {\n\t\t\t\treturn UE.htmlparser(html).children[0]\n\t\t\t} else {\n\t\t\t\treturn new uNode({\n\t\t\t\t\ttype: 'element',\n\t\t\t\t\tchildren: [],\n\t\t\t\t\ttagName: html\n\t\t\t\t})\n\t\t\t}\n\t\t};\n\t\tuNode.createText = function(data, noTrans) {\n\t\t\treturn new UE.uNode({\n\t\t\t\ttype: 'text',\n\t\t\t\t'data': noTrans ? data : utils.unhtml(data || '')\n\t\t\t})\n\t\t};\n\n\t\tfunction nodeToHtml(node, arr, formatter, current) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'root':\n\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\t\t//插入新行\n\t\t\t\t\t\tif (formatter && ci.type == 'element' && !dtd.$inlineWithA[ci.tagName] && i > 1) {\n\t\t\t\t\t\t\tinsertLine(arr, current, true);\n\t\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnodeToHtml(ci, arr, formatter, current)\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'text':\n\t\t\t\t\tisText(node, arr);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'element':\n\t\t\t\t\tisElement(node, arr, formatter, current);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'comment':\n\t\t\t\t\tisComment(node, arr, formatter);\n\t\t\t}\n\t\t\treturn arr;\n\t\t}\n\n\t\tfunction isText(node, arr) {\n\t\t\tif (node.parentNode.tagName == 'pre') {\n\t\t\t\t//源码模式下输入html标签，不能做转换处理，直接输出\n\t\t\t\tarr.push(node.data)\n\t\t\t} else {\n\t\t\t\tarr.push(notTransTagName[node.parentNode.tagName] ? utils.html(node.data) : node.data.replace(/[ ]{2}/g, ' &nbsp;'))\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isElement(node, arr, formatter, current) {\n\t\t\tvar attrhtml = '';\n\t\t\tif (node.attrs) {\n\t\t\t\tattrhtml = [];\n\t\t\t\tvar attrs = node.attrs;\n\t\t\t\tfor (var a in attrs) {\n\t\t\t\t\t//这里就针对\n\t\t\t\t\t//<p>'<img src='http://nsclick.baidu.com/u.gif?&asdf=\\\"sdf&asdfasdfs;asdf'></p>\n\t\t\t\t\t//这里边的\\\"做转换，要不用innerHTML直接被截断了，属性src\n\t\t\t\t\t//有可能做的不够\n\t\t\t\t\tattrhtml.push(a + (attrs[a] !== undefined ? '=\"' + (notTransAttrs[a] ? utils.html(attrs[a]).replace(/[\"]/g, function(a) {\n\t\t\t\t\t\treturn '&quot;'\n\t\t\t\t\t}) : utils.unhtml(attrs[a])) + '\"' : ''))\n\t\t\t\t}\n\t\t\t\tattrhtml = attrhtml.join(' ');\n\t\t\t}\n\t\t\tarr.push('<' + node.tagName +\n\t\t\t\t(attrhtml ? ' ' + attrhtml : '') +\n\t\t\t\t(dtd.$empty[node.tagName] ? '\\/' : '') + '>'\n\t\t\t);\n\t\t\t//插入新行\n\t\t\tif (formatter && !dtd.$inlineWithA[node.tagName] && node.tagName != 'pre') {\n\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\tcurrent = insertLine(arr, current, true);\n\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (node.children && node.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\tif (formatter && ci.type == 'element' && !dtd.$inlineWithA[ci.tagName] && i > 1) {\n\t\t\t\t\t\tinsertLine(arr, current);\n\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t}\n\t\t\t\t\tnodeToHtml(ci, arr, formatter, current)\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!dtd.$empty[node.tagName]) {\n\t\t\t\tif (formatter && !dtd.$inlineWithA[node.tagName] && node.tagName != 'pre') {\n\n\t\t\t\t\tif (node.children && node.children.length) {\n\t\t\t\t\t\tcurrent = insertLine(arr, current);\n\t\t\t\t\t\tinsertIndent(arr, current)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tarr.push('<\\/' + node.tagName + '>');\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isComment(node, arr) {\n\t\t\tarr.push('<!--' + node.data + '-->');\n\t\t}\n\n\t\tfunction getNodeById(root, id) {\n\t\t\tvar node;\n\t\t\tif (root.type == 'element' && root.getAttr('id') == id) {\n\t\t\t\treturn root;\n\t\t\t}\n\t\t\tif (root.children && root.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = root.children[i++];) {\n\t\t\t\t\tif (node = getNodeById(ci, id)) {\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction getNodesByTagName(node, tagName, arr) {\n\t\t\tif (node.type == 'element' && node.tagName == tagName) {\n\t\t\t\tarr.push(node);\n\t\t\t}\n\t\t\tif (node.children && node.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = node.children[i++];) {\n\t\t\t\t\tgetNodesByTagName(ci, tagName, arr)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction nodeTraversal(root, fn) {\n\t\t\tif (root.children && root.children.length) {\n\t\t\t\tfor (var i = 0, ci; ci = root.children[i];) {\n\t\t\t\t\tnodeTraversal(ci, fn);\n\t\t\t\t\t//ci被替换的情况，这里就不再走 fn了\n\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\tif (ci.children && ci.children.length) {\n\t\t\t\t\t\t\tfn(ci)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (ci.parentNode) i++\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfn(root)\n\t\t\t}\n\n\t\t}\n\t\tuNode.prototype = {\n\n\t\t\t/**\n\t\t\t * 当前节点对象，转换成html文本\n\t\t\t * @method toHtml\n\t\t\t * @return { String } 返回转换后的html字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.toHtml();\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 当前节点对象，转换成html文本\n\t\t\t * @method toHtml\n\t\t\t * @param { Boolean } formatter 是否格式化返回值\n\t\t\t * @return { String } 返回转换后的html字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.toHtml( true );\n\t\t\t * ```\n\t\t\t */\n\t\t\ttoHtml: function(formatter) {\n\t\t\t\tvar arr = [];\n\t\t\t\tnodeToHtml(this, arr, formatter, 0);\n\t\t\t\treturn arr.join('')\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取节点的html内容\n\t\t\t * @method innerHTML\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @return { String } 返回节点的html内容\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var htmlstr = node.innerHTML();\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 设置节点的html内容\n\t\t\t * @method innerHTML\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @param { String } htmlstr 传入要设置的html内容\n\t\t\t * @return { UE.uNode } 返回节点本身\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.innerHTML('<span>text</span>');\n\t\t\t * ```\n\t\t\t */\n\t\t\tinnerHTML: function(htmlstr) {\n\t\t\t\tif (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tif (utils.isString(htmlstr)) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.children = [];\n\t\t\t\t\tvar tmpRoot = UE.htmlparser(htmlstr);\n\t\t\t\t\tfor (var i = 0, ci; ci = tmpRoot.children[i++];) {\n\t\t\t\t\t\tthis.children.push(ci);\n\t\t\t\t\t\tci.parentNode = this;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t} else {\n\t\t\t\t\tvar tmpRoot = new UE.uNode({\n\t\t\t\t\t\ttype: 'root',\n\t\t\t\t\t\tchildren: this.children\n\t\t\t\t\t});\n\t\t\t\t\treturn tmpRoot.toHtml();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取节点的纯文本内容\n\t\t\t * @method innerText\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @return { String } 返回节点的存文本内容\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * var textStr = node.innerText();\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 设置节点的纯文本内容\n\t\t\t * @method innerText\n\t\t\t * @warning 假如节点的type不是'element'，或节点的标签名称不在dtd列表里，直接返回当前节点\n\t\t\t * @param { String } textStr 传入要设置的文本内容\n\t\t\t * @return { UE.uNode } 返回节点本身\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.innerText('<span>text</span>');\n\t\t\t * ```\n\t\t\t */\n\t\t\tinnerText: function(textStr, noTrans) {\n\t\t\t\tif (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tif (textStr) {\n\t\t\t\t\tif (this.children) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.children = [];\n\t\t\t\t\tthis.appendChild(uNode.createText(textStr, noTrans));\n\t\t\t\t\treturn this;\n\t\t\t\t} else {\n\t\t\t\t\treturn this.toHtml().replace(/<[^>]+>/g, '');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前对象的data属性\n\t\t\t * @method getData\n\t\t\t * @return { Object } 若节点的type值是elemenet，返回空字符串，否则返回节点的data属性\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getData();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetData: function() {\n\t\t\t\tif (this.type == 'element')\n\t\t\t\t\treturn '';\n\t\t\t\treturn this.data\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点下的第一个子节点\n\t\t\t * @method firstChild\n\t\t\t * @return { UE.uNode } 返回第一个子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.firstChild(); //返回第一个子节点\n\t\t\t * ```\n\t\t\t */\n\t\t\tfirstChild: function() {\n\t\t\t\t//            if (this.type != 'element' || dtd.$empty[this.tagName]) {\n\t\t\t\t//                return this;\n\t\t\t\t//            }\n\t\t\t\treturn this.children ? this.children[0] : null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点下的最后一个子节点\n\t\t\t * @method lastChild\n\t\t\t * @return { UE.uNode } 返回最后一个子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.lastChild(); //返回最后一个子节点\n\t\t\t * ```\n\t\t\t */\n\t\t\tlastChild: function() {\n\t\t\t\t//            if (this.type != 'element' || dtd.$empty[this.tagName] ) {\n\t\t\t\t//                return this;\n\t\t\t\t//            }\n\t\t\t\treturn this.children ? this.children[this.children.length - 1] : null;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取和当前节点有相同父亲节点的前一个节点\n\t\t\t * @method previousSibling\n\t\t\t * @return { UE.uNode } 返回前一个节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.children[2].previousSibling(); //返回子节点node.children[1]\n\t\t\t * ```\n\t\t\t */\n\t\t\tpreviousSibling: function() {\n\t\t\t\tvar parent = this.parentNode;\n\t\t\t\tfor (var i = 0, ci; ci = parent.children[i]; i++) {\n\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\treturn i == 0 ? null : parent.children[i - 1];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取和当前节点有相同父亲节点的后一个节点\n\t\t\t * @method nextSibling\n\t\t\t * @return { UE.uNode } 返回后一个节点,找不到返回null\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.children[2].nextSibling(); //如果有，返回子节点node.children[3]\n\t\t\t * ```\n\t\t\t */\n\t\t\tnextSibling: function() {\n\t\t\t\tvar parent = this.parentNode;\n\t\t\t\tfor (var i = 0, ci; ci = parent.children[i++];) {\n\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\treturn parent.children[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 用新的节点替换当前节点\n\t\t\t * @method replaceChild\n\t\t\t * @param { UE.uNode } target 要替换成该节点参数\n\t\t\t * @param { UE.uNode } source 要被替换掉的节点\n\t\t\t * @return { UE.uNode } 返回替换之后的节点对象\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.replaceChild(newNode, childNode); //用newNode替换childNode,childNode是node的子节点\n\t\t\t * ```\n\t\t\t */\n\t\t\treplaceChild: function(target, source) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\tthis.children.splice(i, 1, target);\n\t\t\t\t\t\t\tsource.parentNode = null;\n\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在节点的子节点列表最后位置插入一个节点\n\t\t\t * @method appendChild\n\t\t\t * @param { UE.uNode } node 要插入的节点\n\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.appendChild( newNode ); //在node内插入子节点newNode\n\t\t\t * ```\n\t\t\t */\n\t\t\tappendChild: function(node) {\n\t\t\t\tif (this.type == 'root' || (this.type == 'element' && !dtd.$empty[this.tagName])) {\n\t\t\t\t\tif (!this.children) {\n\t\t\t\t\t\tthis.children = []\n\t\t\t\t\t}\n\t\t\t\t\tif (node.parentNode) {\n\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === node) {\n\t\t\t\t\t\t\tthis.children.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.children.push(node);\n\t\t\t\t\tnode.parentNode = this;\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在传入节点的前面插入一个节点\n\t\t\t * @method insertBefore\n\t\t\t * @param { UE.uNode } target 要插入的节点\n\t\t\t * @param { UE.uNode } source 在该参数节点前面插入\n\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.parentNode.insertBefore(newNode, node); //在node节点后面插入newNode\n\t\t\t * ```\n\t\t\t */\n\t\t\tinsertBefore: function(target, source) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\tthis.children.splice(i, 0, target);\n\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在传入节点的后面插入一个节点\n\t\t\t * @method insertAfter\n\t\t\t * @param { UE.uNode } target 要插入的节点\n\t\t\t * @param { UE.uNode } source 在该参数节点后面插入\n\t\t\t * @return { UE.uNode } 返回刚插入的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.parentNode.insertAfter(newNode, node); //在node节点后面插入newNode\n\t\t\t * ```\n\t\t\t */\n\t\t\tinsertAfter: function(target, source) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\ttarget.parentNode.removeChild(target);\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === source) {\n\t\t\t\t\t\t\tthis.children.splice(i + 1, 0, target);\n\t\t\t\t\t\t\ttarget.parentNode = this;\n\t\t\t\t\t\t\treturn target;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 从当前节点的子节点列表中，移除节点\n\t\t\t * @method removeChild\n\t\t\t * @param { UE.uNode } node 要移除的节点引用\n\t\t\t * @param { Boolean } keepChildren 是否保留移除节点的子节点，若传入true，自动把移除节点的子节点插入到移除的位置\n\t\t\t * @return { * } 返回刚移除的子节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.removeChild(childNode,true); //在node的子节点列表中移除child节点，并且吧child的子节点插入到移除的位置\n\t\t\t * ```\n\t\t\t */\n\t\t\tremoveChild: function(node, keepChildren) {\n\t\t\t\tif (this.children) {\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i]; i++) {\n\t\t\t\t\t\tif (ci === node) {\n\t\t\t\t\t\t\tthis.children.splice(i, 1);\n\t\t\t\t\t\t\tci.parentNode = null;\n\t\t\t\t\t\t\tif (keepChildren && ci.children && ci.children.length) {\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci.children[j]; j++) {\n\t\t\t\t\t\t\t\t\tthis.children.splice(i + j, 0, cj);\n\t\t\t\t\t\t\t\t\tcj.parentNode = this;\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn ci;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点所代表的元素属性，即获取attrs对象下的属性值\n\t\t\t * @method getAttr\n\t\t\t * @param { String } attrName 要获取的属性名称\n\t\t\t * @return { * } 返回attrs对象下的属性值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getAttr('title');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetAttr: function(attrName) {\n\t\t\t\treturn this.attrs && this.attrs[attrName.toLowerCase()]\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 设置当前节点所代表的元素属性，即设置attrs对象下的属性值\n\t\t\t * @method setAttr\n\t\t\t * @param { String } attrName 要设置的属性名称\n\t\t\t * @param { * } attrVal 要设置的属性值，类型视设置的属性而定\n\t\t\t * @return { * } 返回attrs对象下的属性值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.setAttr('title','标题');\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetAttr: function(attrName, attrVal) {\n\t\t\t\tif (!attrName) {\n\t\t\t\t\tdelete this.attrs;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (!this.attrs) {\n\t\t\t\t\tthis.attrs = {};\n\t\t\t\t}\n\t\t\t\tif (utils.isObject(attrName)) {\n\t\t\t\t\tfor (var a in attrName) {\n\t\t\t\t\t\tif (!attrName[a]) {\n\t\t\t\t\t\t\tdelete this.attrs[a]\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.attrs[a.toLowerCase()] = attrName[a];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (!attrVal) {\n\t\t\t\t\t\tdelete this.attrs[attrName]\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.attrs[attrName.toLowerCase()] = attrVal;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 获取当前节点在父节点下的位置索引\n\t\t\t * @method getIndex\n\t\t\t * @return { Number } 返回索引数值，如果没有父节点，返回-1\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getIndex();\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetIndex: function() {\n\t\t\t\tvar parent = this.parentNode;\n\t\t\t\tfor (var i = 0, ci; ci = parent.children[i]; i++) {\n\t\t\t\t\tif (ci === this) {\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在当前节点下，根据id查找节点\n\t\t\t * @method getNodeById\n\t\t\t * @param { String } id 要查找的id\n\t\t\t * @return { UE.uNode } 返回找到的节点\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getNodeById('textId');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetNodeById: function(id) {\n\t\t\t\tvar node;\n\t\t\t\tif (this.children && this.children.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = this.children[i++];) {\n\t\t\t\t\t\tif (node = getNodeById(ci, id)) {\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 在当前节点下，根据元素名称查找节点列表\n\t\t\t * @method getNodesByTagName\n\t\t\t * @param { String } tagNames 要查找的元素名称\n\t\t\t * @return { Array } 返回找到的节点列表\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getNodesByTagName('span');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetNodesByTagName: function(tagNames) {\n\t\t\t\ttagNames = utils.trim(tagNames).replace(/[ ]{2,}/g, ' ').split(' ');\n\t\t\t\tvar arr = [],\n\t\t\t\t\tme = this;\n\t\t\t\tutils.each(tagNames, function(tagName) {\n\t\t\t\t\tif (me.children && me.children.length) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = me.children[i++];) {\n\t\t\t\t\t\t\tgetNodesByTagName(ci, tagName, arr)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn arr;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 根据样式名称，获取节点的样式值\n\t\t\t * @method getStyle\n\t\t\t * @param { String } name 要获取的样式名称\n\t\t\t * @return { String } 返回样式值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.getStyle('font-size');\n\t\t\t * ```\n\t\t\t */\n\t\t\tgetStyle: function(name) {\n\t\t\t\tvar cssStyle = this.getAttr('style');\n\t\t\t\tif (!cssStyle) {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\t\t\t\tvar reg = new RegExp('(^|;)\\\\s*' + name + ':([^;]+)', 'i');\n\t\t\t\tvar match = cssStyle.match(reg);\n\t\t\t\tif (match && match[0]) {\n\t\t\t\t\treturn match[2]\n\t\t\t\t}\n\t\t\t\treturn '';\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 给节点设置样式\n\t\t\t * @method setStyle\n\t\t\t * @param { String } name 要设置的的样式名称\n\t\t\t * @param { String } val 要设置的的样值\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * node.setStyle('font-size', '12px');\n\t\t\t * ```\n\t\t\t */\n\t\t\tsetStyle: function(name, val) {\n\t\t\t\tfunction exec(name, val) {\n\t\t\t\t\tvar reg = new RegExp('(^|;)\\\\s*' + name + ':([^;]+;?)', 'gi');\n\t\t\t\t\tcssStyle = cssStyle.replace(reg, '$1');\n\t\t\t\t\tif (val) {\n\t\t\t\t\t\tcssStyle = name + ':' + utils.unhtml(val) + ';' + cssStyle\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tvar cssStyle = this.getAttr('style');\n\t\t\t\tif (!cssStyle) {\n\t\t\t\t\tcssStyle = '';\n\t\t\t\t}\n\t\t\t\tif (utils.isObject(name)) {\n\t\t\t\t\tfor (var a in name) {\n\t\t\t\t\t\texec(a, name[a])\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\texec(name, val)\n\t\t\t\t}\n\t\t\t\tthis.setAttr('style', utils.trim(cssStyle))\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * 传入一个函数，递归遍历当前节点下的所有节点\n\t\t\t * @method traversal\n\t\t\t * @param { Function } fn 遍历到节点的时，传入节点作为参数，运行此函数\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * traversal(node, function(){\n\t\t\t *     console.log(node.type);\n\t\t\t * });\n\t\t\t * ```\n\t\t\t */\n\t\t\ttraversal: function(fn) {\n\t\t\t\tif (this.children && this.children.length) {\n\t\t\t\t\tnodeTraversal(this, fn);\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t})();\n\n\t// core/htmlparser.js\n\t/**\n\t * html字符串转换成uNode节点\n\t * @file\n\t * @module UE\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @unfile\n\t * @module UE\n\t */\n\n\t/**\n\t * html字符串转换成uNode节点的静态方法\n\t * @method htmlparser\n\t * @param { String } htmlstr 要转换的html代码\n\t * @param { Boolean } ignoreBlank 若设置为true，转换的时候忽略\\n\\r\\t等空白字符\n\t * @return { uNode } 给定的html片段转换形成的uNode对象\n\t * @example\n\t * ```javascript\n\t * var root = UE.htmlparser('<p><b>htmlparser</b></p>', true);\n\t * ```\n\t */\n\n\tvar htmlparser = UE.htmlparser = function(htmlstr, ignoreBlank) {\n\t\t//todo 原来的方式  [^\"'<>\\/] 有\\/就不能配对上 <TD vAlign=top background=../AAA.JPG> 这样的标签了\n\t\t//先去掉了，加上的原因忘了，这里先记录\n\t\tvar re_tag = /<(?:(?:\\/([^>]+)>)|(?:!--([\\S|\\s]*?)-->)|(?:([^\\s\\/<>]+)\\s*((?:(?:\"[^\"]*\")|(?:'[^']*')|[^\"'<>])*)\\/?>))/g,\n\t\t\tre_attr = /([\\w\\-:.]+)(?:(?:\\s*=\\s*(?:(?:\"([^\"]*)\")|(?:'([^']*)')|([^\\s>]+)))|(?=\\s|$))/g;\n\n\t\t//ie下取得的html可能会有\\n存在，要去掉，在处理replace(/[\\t\\r\\n]*/g,'');代码高量的\\n不能去除\n\t\tvar allowEmptyTags = {\n\t\t\tb: 1,\n\t\t\tcode: 1,\n\t\t\ti: 1,\n\t\t\tu: 1,\n\t\t\tstrike: 1,\n\t\t\ts: 1,\n\t\t\ttt: 1,\n\t\t\tstrong: 1,\n\t\t\tq: 1,\n\t\t\tsamp: 1,\n\t\t\tem: 1,\n\t\t\tspan: 1,\n\t\t\tsub: 1,\n\t\t\timg: 1,\n\t\t\tsup: 1,\n\t\t\tfont: 1,\n\t\t\tbig: 1,\n\t\t\tsmall: 1,\n\t\t\tiframe: 1,\n\t\t\ta: 1,\n\t\t\tbr: 1,\n\t\t\tpre: 1\n\t\t};\n\t\thtmlstr = htmlstr.replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\tif (!ignoreBlank) {\n\t\t\thtmlstr = htmlstr.replace(new RegExp('[\\\\r\\\\t\\\\n' + (ignoreBlank ? '' : ' ') + ']*<\\/?(\\\\w+)\\\\s*(?:[^>]*)>[\\\\r\\\\t\\\\n' + (ignoreBlank ? '' : ' ') + ']*', 'g'), function(a, b) {\n\t\t\t\t//br暂时单独处理\n\t\t\t\tif (b && allowEmptyTags[b.toLowerCase()]) {\n\t\t\t\t\treturn a.replace(/(^[\\n\\r]+)|([\\n\\r]+$)/g, '');\n\t\t\t\t}\n\t\t\t\treturn a.replace(new RegExp('^[\\\\r\\\\n' + (ignoreBlank ? '' : ' ') + ']+'), '').replace(new RegExp('[\\\\r\\\\n' + (ignoreBlank ? '' : ' ') + ']+$'), '');\n\t\t\t});\n\t\t}\n\n\t\tvar notTransAttrs = {\n\t\t\t'href': 1,\n\t\t\t'src': 1\n\t\t};\n\n\t\tvar uNode = UE.uNode,\n\t\t\tneedParentNode = {\n\t\t\t\t'td': 'tr',\n\t\t\t\t'tr': ['tbody', 'thead', 'tfoot'],\n\t\t\t\t'tbody': 'table',\n\t\t\t\t'th': 'tr',\n\t\t\t\t'thead': 'table',\n\t\t\t\t'tfoot': 'table',\n\t\t\t\t'caption': 'table',\n\t\t\t\t'li': ['ul', 'ol'],\n\t\t\t\t'dt': 'dl',\n\t\t\t\t'dd': 'dl',\n\t\t\t\t'option': 'select'\n\t\t\t},\n\t\t\tneedChild = {\n\t\t\t\t'ol': 'li',\n\t\t\t\t'ul': 'li'\n\t\t\t};\n\n\t\tfunction text(parent, data) {\n\n\t\t\tif (needChild[parent.tagName]) {\n\t\t\t\tvar tmpNode = uNode.createElement(needChild[parent.tagName]);\n\t\t\t\tparent.appendChild(tmpNode);\n\t\t\t\ttmpNode.appendChild(uNode.createText(data));\n\t\t\t\tparent = tmpNode;\n\t\t\t} else {\n\n\t\t\t\tparent.appendChild(uNode.createText(data));\n\t\t\t}\n\t\t}\n\n\t\tfunction element(parent, tagName, htmlattr) {\n\t\t\tvar needParentTag;\n\t\t\tif (needParentTag = needParentNode[tagName]) {\n\t\t\t\tvar tmpParent = parent,\n\t\t\t\t\thasParent;\n\t\t\t\twhile (tmpParent.type != 'root') {\n\t\t\t\t\tif (utils.isArray(needParentTag) ? utils.indexOf(needParentTag, tmpParent.tagName) != -1 : needParentTag == tmpParent.tagName) {\n\t\t\t\t\t\tparent = tmpParent;\n\t\t\t\t\t\thasParent = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttmpParent = tmpParent.parentNode;\n\t\t\t\t}\n\t\t\t\tif (!hasParent) {\n\t\t\t\t\tparent = element(parent, utils.isArray(needParentTag) ? needParentTag[0] : needParentTag)\n\t\t\t\t}\n\t\t\t}\n\t\t\t//按dtd处理嵌套\n\t\t\t//        if(parent.type != 'root' && !dtd[parent.tagName][tagName])\n\t\t\t//            parent = parent.parentNode;\n\t\t\tvar elm = new uNode({\n\t\t\t\tparentNode: parent,\n\t\t\t\ttype: 'element',\n\t\t\t\ttagName: tagName.toLowerCase(),\n\t\t\t\t//是自闭合的处理一下\n\t\t\t\tchildren: dtd.$empty[tagName] ? null : []\n\t\t\t});\n\t\t\t//如果属性存在，处理属性\n\t\t\tif (htmlattr) {\n\t\t\t\tvar attrs = {},\n\t\t\t\t\tmatch;\n\t\t\t\twhile (match = re_attr.exec(htmlattr)) {\n\t\t\t\t\tattrs[match[1].toLowerCase()] = notTransAttrs[match[1].toLowerCase()] ? (match[2] || match[3] || match[4]) : utils.unhtml(match[2] || match[3] || match[4])\n\t\t\t\t}\n\t\t\t\telm.attrs = attrs;\n\t\t\t}\n\t\t\t//trace:3970\n\t\t\t//        //如果parent下不能放elm\n\t\t\t//        if(dtd.$inline[parent.tagName] && dtd.$block[elm.tagName] && !dtd[parent.tagName][elm.tagName]){\n\t\t\t//            parent = parent.parentNode;\n\t\t\t//            elm.parentNode = parent;\n\t\t\t//        }\n\t\t\tparent.children.push(elm);\n\t\t\t//如果是自闭合节点返回父亲节点\n\t\t\treturn dtd.$empty[tagName] ? parent : elm\n\t\t}\n\n\t\tfunction comment(parent, data) {\n\t\t\tparent.children.push(new uNode({\n\t\t\t\ttype: 'comment',\n\t\t\t\tdata: data,\n\t\t\t\tparentNode: parent\n\t\t\t}));\n\t\t}\n\n\t\tvar match, currentIndex = 0,\n\t\t\tnextIndex = 0;\n\t\t//设置根节点\n\t\tvar root = new uNode({\n\t\t\ttype: 'root',\n\t\t\tchildren: []\n\t\t});\n\t\tvar currentParent = root;\n\n\t\twhile (match = re_tag.exec(htmlstr)) {\n\t\t\tcurrentIndex = match.index;\n\t\t\ttry {\n\t\t\t\tif (currentIndex > nextIndex) {\n\t\t\t\t\t//text node\n\t\t\t\t\ttext(currentParent, htmlstr.slice(nextIndex, currentIndex));\n\t\t\t\t}\n\t\t\t\tif (match[3]) {\n\n\t\t\t\t\tif (dtd.$cdata[currentParent.tagName]) {\n\t\t\t\t\t\ttext(currentParent, match[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//start tag\n\t\t\t\t\t\tcurrentParent = element(currentParent, match[3].toLowerCase(), match[4]);\n\t\t\t\t\t}\n\n\t\t\t\t} else if (match[1]) {\n\t\t\t\t\tif (currentParent.type != 'root') {\n\t\t\t\t\t\tif (dtd.$cdata[currentParent.tagName] && !dtd.$cdata[match[1]]) {\n\t\t\t\t\t\t\ttext(currentParent, match[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpParent = currentParent;\n\t\t\t\t\t\t\twhile (currentParent.type == 'element' && currentParent.tagName != match[1].toLowerCase()) {\n\t\t\t\t\t\t\t\tcurrentParent = currentParent.parentNode;\n\t\t\t\t\t\t\t\tif (currentParent.type == 'root') {\n\t\t\t\t\t\t\t\t\tcurrentParent = tmpParent;\n\t\t\t\t\t\t\t\t\tthrow 'break'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//end tag\n\t\t\t\t\t\t\tcurrentParent = currentParent.parentNode;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if (match[2]) {\n\t\t\t\t\t//comment\n\t\t\t\t\tcomment(currentParent, match[2])\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\n\t\t\tnextIndex = re_tag.lastIndex;\n\n\t\t}\n\t\t//如果结束是文本，就有可能丢掉，所以这里手动判断一下\n\t\t//例如 <li>sdfsdfsdf<li>sdfsdfsdfsdf\n\t\tif (nextIndex < htmlstr.length) {\n\t\t\ttext(currentParent, htmlstr.slice(nextIndex));\n\t\t}\n\t\treturn root;\n\t};\n\n\t// core/filternode.js\n\t/**\n\t * UE过滤节点的静态方法\n\t * @file\n\t */\n\n\t/**\n\t * UEditor公用空间，UEditor所有的功能都挂载在该空间下\n\t * @module UE\n\t */\n\n\t/**\n\t * 根据传入节点和过滤规则过滤相应节点\n\t * @module UE\n\t * @since 1.2.6.1\n\t * @method filterNode\n\t * @param { Object } root 指定root节点\n\t * @param { Object } rules 过滤规则json对象\n\t * @example\n\t * ```javascript\n\t * UE.filterNode(root,editor.options.filterRules);\n\t * ```\n\t */\n\tvar filterNode = UE.filterNode = function() {\n\t\tfunction filterNode(node, rules) {\n\t\t\tswitch (node.type) {\n\t\t\t\tcase 'text':\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'element':\n\t\t\t\t\tvar val;\n\t\t\t\t\tif (val = rules[node.tagName]) {\n\t\t\t\t\t\tif (val === '-') {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t} else if (utils.isFunction(val)) {\n\t\t\t\t\t\t\tvar parentNode = node.parentNode,\n\t\t\t\t\t\t\t\tindex = node.getIndex();\n\t\t\t\t\t\t\tval(node);\n\t\t\t\t\t\t\tif (node.parentNode) {\n\t\t\t\t\t\t\t\tif (node.children) {\n\t\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i];) {\n\t\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfor (var i = index, ci; ci = parentNode.children[i];) {\n\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar attrs = val['$'];\n\t\t\t\t\t\t\tif (attrs && node.attrs) {\n\t\t\t\t\t\t\t\tvar tmpAttrs = {},\n\t\t\t\t\t\t\t\t\ttmpVal;\n\t\t\t\t\t\t\t\tfor (var a in attrs) {\n\t\t\t\t\t\t\t\t\ttmpVal = node.getAttr(a);\n\t\t\t\t\t\t\t\t\t//todo 只先对style单独处理\n\t\t\t\t\t\t\t\t\tif (a == 'style' && utils.isArray(attrs[a])) {\n\t\t\t\t\t\t\t\t\t\tvar tmpCssStyle = [];\n\t\t\t\t\t\t\t\t\t\tutils.each(attrs[a], function(v) {\n\t\t\t\t\t\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\t\t\t\t\t\tif (tmp = node.getStyle(v)) {\n\t\t\t\t\t\t\t\t\t\t\t\ttmpCssStyle.push(v + ':' + tmp);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\ttmpVal = tmpCssStyle.join(';')\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (tmpVal) {\n\t\t\t\t\t\t\t\t\t\ttmpAttrs[a] = tmpVal;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tnode.attrs = tmpAttrs;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (node.children) {\n\t\t\t\t\t\t\t\tfor (var i = 0, ci; ci = node.children[i];) {\n\t\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//如果不在名单里扣出子节点并删除该节点,cdata除外\n\t\t\t\t\t\tif (dtd.$cdata[node.tagName]) {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar parentNode = node.parentNode,\n\t\t\t\t\t\t\t\tindex = node.getIndex();\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true);\n\t\t\t\t\t\t\tfor (var i = index, ci; ci = parentNode.children[i];) {\n\t\t\t\t\t\t\t\tfilterNode(ci, rules);\n\t\t\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'comment':\n\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t}\n\n\t\t}\n\t\treturn function(root, rules) {\n\t\t\tif (utils.isEmptyObject(rules)) {\n\t\t\t\treturn root;\n\t\t\t}\n\t\t\tvar val;\n\t\t\tif (val = rules['-']) {\n\t\t\t\tutils.each(val.split(' '), function(k) {\n\t\t\t\t\trules[k] = '-'\n\t\t\t\t})\n\t\t\t}\n\t\t\tfor (var i = 0, ci; ci = root.children[i];) {\n\t\t\t\tfilterNode(ci, rules);\n\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn root;\n\t\t}\n\t}();\n\n\t// core/plugin.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: campaign\n\t * Date: 10/8/13\n\t * Time: 6:15 PM\n\t * To change this template use File | Settings | File Templates.\n\t */\n\tUE.plugin = function() {\n\t\tvar _plugins = {};\n\t\treturn {\n\t\t\tregister: function(pluginName, fn, oldOptionName, afterDisabled) {\n\t\t\t\tif (oldOptionName && utils.isFunction(oldOptionName)) {\n\t\t\t\t\tafterDisabled = oldOptionName;\n\t\t\t\t\toldOptionName = null\n\t\t\t\t}\n\t\t\t\t_plugins[pluginName] = {\n\t\t\t\t\toptionName: oldOptionName || pluginName,\n\t\t\t\t\texecFn: fn,\n\t\t\t\t\t//当插件被禁用时执行\n\t\t\t\t\tafterDisabled: afterDisabled\n\t\t\t\t}\n\t\t\t},\n\t\t\tload: function(editor) {\n\t\t\t\tutils.each(_plugins, function(plugin) {\n\t\t\t\t\tvar _export = plugin.execFn.call(editor);\n\t\t\t\t\tif (editor.options[plugin.optionName] !== false) {\n\t\t\t\t\t\tif (_export) {\n\t\t\t\t\t\t\t//后边需要再做扩展\n\t\t\t\t\t\t\tutils.each(_export, function(v, k) {\n\t\t\t\t\t\t\t\tswitch (k.toLowerCase()) {\n\t\t\t\t\t\t\t\t\tcase 'shortcutkey':\n\t\t\t\t\t\t\t\t\t\teditor.addshortcutkey(v);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'bindevents':\n\t\t\t\t\t\t\t\t\t\tutils.each(v, function(fn, eventName) {\n\t\t\t\t\t\t\t\t\t\t\teditor.addListener(eventName, fn);\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'bindmultievents':\n\t\t\t\t\t\t\t\t\t\tutils.each(utils.isArray(v) ? v : [v], function(event) {\n\t\t\t\t\t\t\t\t\t\t\tvar types = utils.trim(event.type).split(/\\s+/);\n\t\t\t\t\t\t\t\t\t\t\tutils.each(types, function(eventName) {\n\t\t\t\t\t\t\t\t\t\t\t\teditor.addListener(eventName, event.handler);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'commands':\n\t\t\t\t\t\t\t\t\t\tutils.each(v, function(execFn, execName) {\n\t\t\t\t\t\t\t\t\t\t\teditor.commands[execName] = execFn\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'outputrule':\n\t\t\t\t\t\t\t\t\t\teditor.addOutputRule(v);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'inputrule':\n\t\t\t\t\t\t\t\t\t\teditor.addInputRule(v);\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'defaultoptions':\n\t\t\t\t\t\t\t\t\t\teditor.setOpt(v)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else if (plugin.afterDisabled) {\n\t\t\t\t\t\tplugin.afterDisabled.call(editor)\n\t\t\t\t\t}\n\n\t\t\t\t});\n\t\t\t\t//向下兼容\n\t\t\t\tutils.each(UE.plugins, function(plugin) {\n\t\t\t\t\tplugin.call(editor);\n\t\t\t\t});\n\t\t\t},\n\t\t\trun: function(pluginName, editor) {\n\t\t\t\tvar plugin = _plugins[pluginName];\n\t\t\t\tif (plugin) {\n\t\t\t\t\tplugin.exeFn.call(editor)\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}();\n\n\t// core/keymap.js\n\tvar keymap = UE.keymap = {\n\t\t'Backspace': 8,\n\t\t'Tab': 9,\n\t\t'Enter': 13,\n\n\t\t'Shift': 16,\n\t\t'Control': 17,\n\t\t'Alt': 18,\n\t\t'CapsLock': 20,\n\n\t\t'Esc': 27,\n\n\t\t'Spacebar': 32,\n\n\t\t'PageUp': 33,\n\t\t'PageDown': 34,\n\t\t'End': 35,\n\t\t'Home': 36,\n\n\t\t'Left': 37,\n\t\t'Up': 38,\n\t\t'Right': 39,\n\t\t'Down': 40,\n\n\t\t'Insert': 45,\n\n\t\t'Del': 46,\n\n\t\t'NumLock': 144,\n\n\t\t'Cmd': 91,\n\n\t\t'=': 187,\n\t\t'-': 189,\n\n\t\t\"b\": 66,\n\t\t'i': 73,\n\t\t//回退\n\t\t'z': 90,\n\t\t'y': 89,\n\t\t//粘贴\n\t\t'v': 86,\n\t\t'x': 88,\n\n\t\t's': 83,\n\n\t\t'n': 78\n\t};\n\n\t// core/localstorage.js\n\t//存储媒介封装\n\tvar LocalStorage = UE.LocalStorage = (function() {\n\n\t\tvar storage = window.localStorage || getUserData() || null,\n\t\t\tLOCAL_FILE = 'localStorage';\n\n\t\treturn {\n\n\t\t\tsaveLocalData: function(key, data) {\n\n\t\t\t\tif (storage && data) {\n\t\t\t\t\tstorage.setItem(key, data);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\n\t\t\t},\n\n\t\t\tgetLocalData: function(key) {\n\n\t\t\t\tif (storage) {\n\t\t\t\t\treturn storage.getItem(key);\n\t\t\t\t}\n\n\t\t\t\treturn null;\n\n\t\t\t},\n\n\t\t\tremoveItem: function(key) {\n\n\t\t\t\tstorage && storage.removeItem(key);\n\n\t\t\t}\n\n\t\t};\n\n\t\tfunction getUserData() {\n\n\t\t\tvar container = document.createElement(\"div\");\n\t\t\tcontainer.style.display = \"none\";\n\n\t\t\tif (!container.addBehavior) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tcontainer.addBehavior(\"#default#userdata\");\n\n\t\t\treturn {\n\n\t\t\t\tgetItem: function(key) {\n\n\t\t\t\t\tvar result = null;\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\t\tcontainer.load(LOCAL_FILE);\n\t\t\t\t\t\tresult = container.getAttribute(key);\n\t\t\t\t\t\tdocument.body.removeChild(container);\n\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\treturn result;\n\n\t\t\t\t},\n\n\t\t\t\tsetItem: function(key, value) {\n\n\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\tcontainer.setAttribute(key, value);\n\t\t\t\t\tcontainer.save(LOCAL_FILE);\n\t\t\t\t\tdocument.body.removeChild(container);\n\n\t\t\t\t},\n\n\t\t\t\t//// 暂时没有用到\n\t\t\t\t//clear: function () {\n\t\t\t\t//\n\t\t\t\t//    var expiresTime = new Date();\n\t\t\t\t//    expiresTime.setFullYear(expiresTime.getFullYear() - 1);\n\t\t\t\t//    document.body.appendChild(container);\n\t\t\t\t//    container.expires = expiresTime.toUTCString();\n\t\t\t\t//    container.save(LOCAL_FILE);\n\t\t\t\t//    document.body.removeChild(container);\n\t\t\t\t//\n\t\t\t\t//},\n\n\t\t\t\tremoveItem: function(key) {\n\n\t\t\t\t\tdocument.body.appendChild(container);\n\t\t\t\t\tcontainer.removeAttribute(key);\n\t\t\t\t\tcontainer.save(LOCAL_FILE);\n\t\t\t\t\tdocument.body.removeChild(container);\n\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t}\n\n\t})();\n\n\t(function() {\n\n\t\tvar ROOTKEY = 'ueditor_preference';\n\n\t\tUE.Editor.prototype.setPreferences = function(key, value) {\n\t\t\tvar obj = {};\n\t\t\tif (utils.isString(key)) {\n\t\t\t\tobj[key] = value;\n\t\t\t} else {\n\t\t\t\tobj = key;\n\t\t\t}\n\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\tutils.extend(data, obj);\n\t\t\t} else {\n\t\t\t\tdata = obj;\n\t\t\t}\n\t\t\tdata && LocalStorage.saveLocalData(ROOTKEY, utils.json2str(data));\n\t\t};\n\n\t\tUE.Editor.prototype.getPreferences = function(key) {\n\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\treturn key ? data[key] : data\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tUE.Editor.prototype.removePreferences = function(key) {\n\t\t\tvar data = LocalStorage.getLocalData(ROOTKEY);\n\t\t\tif (data && (data = utils.str2json(data))) {\n\t\t\t\tdata[key] = undefined;\n\t\t\t\tdelete data[key]\n\t\t\t}\n\t\t\tdata && LocalStorage.saveLocalData(ROOTKEY, utils.json2str(data));\n\t\t};\n\n\t})();\n\n\t// plugins/defaultfilter.js\n\t///import core\n\t///plugin 编辑器默认的过滤转换机制\n\n\tUE.plugins['defaultfilter'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'allowDivTransToP': true,\n\t\t\t'disabledTableInTable': true\n\t\t});\n\t\t//默认的过滤处理\n\t\t//进入编辑器的内容处理\n\t\tme.addInputRule(function(root) {\n\t\t\tvar allowDivTransToP = this.options.allowDivTransToP;\n\t\t\tvar val;\n\n\t\t\tfunction tdParent(node) {\n\t\t\t\twhile (node && node.type == 'element') {\n\t\t\t\t\tif (node.tagName == 'td') {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//进行默认的处理\n\t\t\troot.traversal(function(node) {\n\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\tif (!dtd.$cdata[node.tagName] && me.options.autoClearEmptyNode && dtd.$inline[node.tagName] && !dtd.$empty[node.tagName] && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\tif (!node.firstChild()) node.parentNode.removeChild(node);\n\t\t\t\t\t\telse if (node.tagName == 'span' && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\tcase 'script':\n\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\tcdata_tag: node.tagName,\n\t\t\t\t\t\t\t\tcdata_data: (node.innerHTML() || ''),\n\t\t\t\t\t\t\t\t'_ue_custom_node_': 'true'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tnode.tagName = 'div';\n\t\t\t\t\t\t\tnode.innerHTML('');\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'a':\n\t\t\t\t\t\t\tif (val = node.getAttr('href')) {\n\t\t\t\t\t\t\t\tnode.setAttr('_href', val)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\t\t//todo base64暂时去掉，后边做远程图片上传后，干掉这个\n\t\t\t\t\t\t\tif (val = node.getAttr('src')) {\n\t\t\t\t\t\t\t\tif (/^data:/.test(val)) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode.setAttr('_src', node.getAttr('src'));\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'span':\n\t\t\t\t\t\t\tif (browser.webkit && (val = node.getStyle('white-space'))) {\n\t\t\t\t\t\t\t\tif (/nowrap|normal/.test(val)) {\n\t\t\t\t\t\t\t\t\tnode.setStyle('white-space', '');\n\t\t\t\t\t\t\t\t\tif (me.options.autoClearEmptyNode && utils.isEmptyObject(node.attrs)) {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tval = node.getAttr('id');\n\t\t\t\t\t\t\tif (val && /^_baidu_bookmark_/i.test(val)) {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'p':\n\t\t\t\t\t\t\tif (val = node.getAttr('align')) {\n\t\t\t\t\t\t\t\tnode.setAttr('align');\n\t\t\t\t\t\t\t\tnode.setStyle('text-align', val)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//trace:3431\n\t\t\t\t\t\t\t//                        var cssStyle = node.getAttr('style');\n\t\t\t\t\t\t\t//                        if (cssStyle) {\n\t\t\t\t\t\t\t//                            cssStyle = cssStyle.replace(/(margin|padding)[^;]+/g, '');\n\t\t\t\t\t\t\t//                            node.setAttr('style', cssStyle)\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t//                        }\n\t\t\t\t\t\t\t//p标签不允许嵌套\n\t\t\t\t\t\t\tutils.each(node.children, function(n) {\n\t\t\t\t\t\t\t\tif (n.type == 'element' && n.tagName == 'p') {\n\t\t\t\t\t\t\t\t\tvar next = n.nextSibling();\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(n, node);\n\t\t\t\t\t\t\t\t\tvar last = n;\n\t\t\t\t\t\t\t\t\twhile (next) {\n\t\t\t\t\t\t\t\t\t\tvar tmp = next.nextSibling();\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(next, last);\n\t\t\t\t\t\t\t\t\t\tlast = next;\n\t\t\t\t\t\t\t\t\t\tnext = tmp;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tif (!node.firstChild()) {\n\t\t\t\t\t\t\t\tnode.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'div':\n\t\t\t\t\t\t\tif (node.getAttr('cdata_tag')) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//针对代码这里不处理插入代码的div\n\t\t\t\t\t\t\tval = node.getAttr('class');\n\t\t\t\t\t\t\tif (val && /^line number\\d+/.test(val)) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!allowDivTransToP) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tmpNode, p = UE.uNode.createElement('p');\n\t\t\t\t\t\t\twhile (tmpNode = node.firstChild()) {\n\t\t\t\t\t\t\t\tif (tmpNode.type == 'text' || !UE.dom.dtd.$block[tmpNode.tagName]) {\n\t\t\t\t\t\t\t\t\tp.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t\t\t\tp = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(tmpNode, node);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'dl':\n\t\t\t\t\t\t\tnode.tagName = 'ul';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'dt':\n\t\t\t\t\t\tcase 'dd':\n\t\t\t\t\t\t\tnode.tagName = 'li';\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'li':\n\t\t\t\t\t\t\tvar className = node.getAttr('class');\n\t\t\t\t\t\t\tif (!className || !/list\\-/.test(className)) {\n\t\t\t\t\t\t\t\tnode.setAttr()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tmpNodes = node.getNodesByTagName('ol ul');\n\t\t\t\t\t\t\tUE.utils.each(tmpNodes, function(n) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertAfter(n, node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'td':\n\t\t\t\t\t\tcase 'th':\n\t\t\t\t\t\tcase 'caption':\n\t\t\t\t\t\t\tif (!node.children || !node.children.length) {\n\t\t\t\t\t\t\t\tnode.appendChild(browser.ie11below ? UE.uNode.createText(' ') : UE.uNode.createElement('br'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'table':\n\t\t\t\t\t\t\tif (me.options.disabledTableInTable && tdParent(node)) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(UE.uNode.createText(node.innerText()), node);\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t//            if(node.type == 'comment'){\n\t\t\t\t//                node.parentNode.removeChild(node);\n\t\t\t\t//            }\n\t\t\t})\n\n\t\t});\n\n\t\t//从编辑器出去的内容处理\n\t\tme.addOutputRule(function(root) {\n\n\t\t\tvar val;\n\t\t\troot.traversal(function(node) {\n\t\t\t\tif (node.type == 'element') {\n\n\t\t\t\t\tif (me.options.autoClearEmptyNode && dtd.$inline[node.tagName] && !dtd.$empty[node.tagName] && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\n\t\t\t\t\t\tif (!node.firstChild()) node.parentNode.removeChild(node);\n\t\t\t\t\t\telse if (node.tagName == 'span' && (!node.attrs || utils.isEmptyObject(node.attrs))) {\n\t\t\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\tcase 'div':\n\t\t\t\t\t\t\tif (val = node.getAttr('cdata_tag')) {\n\t\t\t\t\t\t\t\tnode.tagName = val;\n\t\t\t\t\t\t\t\tnode.appendChild(UE.uNode.createText(node.getAttr('cdata_data')));\n\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\tcdata_tag: '',\n\t\t\t\t\t\t\t\t\tcdata_data: '',\n\t\t\t\t\t\t\t\t\t'_ue_custom_node_': ''\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'a':\n\t\t\t\t\t\t\tif (val = node.getAttr('_href')) {\n\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\t'href': utils.html(val),\n\t\t\t\t\t\t\t\t\t'_href': ''\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'span':\n\t\t\t\t\t\t\tval = node.getAttr('id');\n\t\t\t\t\t\t\tif (val && /^_baidu_bookmark_/i.test(val)) {\n\t\t\t\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\t\tif (val = node.getAttr('_src')) {\n\t\t\t\t\t\t\t\tnode.setAttr({\n\t\t\t\t\t\t\t\t\t'src': node.getAttr('_src'),\n\t\t\t\t\t\t\t\t\t'_src': ''\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t})\n\n\t\t});\n\t};\n\n\t// plugins/inserthtml.js\n\t/**\n\t * 插入html字符串插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入html代码\n\t * @command inserthtml\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } html 插入的html字符串\n\t * @remaind 插入的标签内容是在当前的选区位置上插入，如果当前是闭合状态，那直接插入内容， 如果当前是选中状态，将先清除当前选中内容后，再做插入\n\t * @warning 注意:该命令会对当前选区的位置，对插入的内容进行过滤转换处理。 过滤的规则遵循html语意化的原则。\n\t * @example\n\t * ```javascript\n\t * //xxx[BB]xxx 当前选区为非闭合选区，选中BB这两个文本\n\t * //执行命令，插入<b>CC</b>\n\t * //插入后的效果 xxx<b>CC</b>xxx\n\t * //<p>xx|xxx</p> 当前选区为闭合状态\n\t * //插入<p>CC</p>\n\t * //结果 <p>xx</p><p>CC</p><p>xxx</p>\n\t * //<p>xxxx</p>|</p>xxx</p> 当前选区在两个p标签之间\n\t * //插入 xxxx\n\t * //结果 <p>xxxx</p><p>xxxx</p></p>xxx</p>\n\t * ```\n\t */\n\n\tUE.commands['inserthtml'] = {\n\t\texecCommand: function(command, html, notNeedFilter) {\n\t\t\tvar me = this,\n\t\t\t\trange,\n\t\t\t\tdiv;\n\t\t\tif (!html) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (me.fireEvent('beforeinserthtml', html) === true) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\trange = me.selection.getRange();\n\t\t\tdiv = range.document.createElement('div');\n\t\t\tdiv.style.display = 'inline';\n\n\t\t\tif (!notNeedFilter) {\n\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t//如果给了过滤规则就先进行过滤\n\t\t\t\tif (me.options.filterRules) {\n\t\t\t\t\tUE.filterNode(root, me.options.filterRules);\n\t\t\t\t}\n\t\t\t\t//执行默认的处理\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\thtml = root.toHtml()\n\t\t\t}\n\t\t\tdiv.innerHTML = utils.trim(html);\n\n\t\t\tif (!range.collapsed) {\n\t\t\t\tvar tmpNode = range.startContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trange.setStartBefore(tmpNode)\n\t\t\t\t}\n\t\t\t\ttmpNode = range.endContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trange.setEndAfter(tmpNode)\n\t\t\t\t}\n\t\t\t\trange.txtToElmBoundary();\n\t\t\t\t//结束边界可能放到了br的前边，要把br包含进来\n\t\t\t\t// x[xxx]<br/>\n\t\t\t\tif (range.endContainer && range.endContainer.nodeType == 1) {\n\t\t\t\t\ttmpNode = range.endContainer.childNodes[range.endOffset];\n\t\t\t\t\tif (tmpNode && domUtils.isBr(tmpNode)) {\n\t\t\t\t\t\trange.setEndAfter(tmpNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\ttmpNode = range.startContainer;\n\t\t\t\t\tif (domUtils.isBoundaryNode(tmpNode, 'firstChild')) {\n\t\t\t\t\t\ttmpNode = range.endContainer;\n\t\t\t\t\t\tif (range.endOffset == (tmpNode.nodeType == 3 ? tmpNode.nodeValue.length : tmpNode.childNodes.length) && domUtils.isBoundaryNode(tmpNode, 'lastChild')) {\n\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\trange.setStart(me.body.firstChild, 0).collapse(true)\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}!range.collapsed && range.deleteContents();\n\t\t\t\tif (range.startContainer.nodeType == 1) {\n\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset],\n\t\t\t\t\t\tpre;\n\t\t\t\t\tif (child && domUtils.isBlockElm(child) && (pre = child.previousSibling) && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\trange.setEnd(pre, pre.childNodes.length).collapse();\n\t\t\t\t\t\twhile (child.firstChild) {\n\t\t\t\t\t\t\tpre.appendChild(child.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar child, parent, pre, tmp, hadBreak = 0,\n\t\t\t\tnextNode;\n\t\t\t//如果当前位置选中了fillchar要干掉，要不会产生空行\n\t\t\tif (range.inFillChar()) {\n\t\t\t\tchild = range.startContainer;\n\t\t\t\tif (domUtils.isFillChar(child)) {\n\t\t\t\t\trange.setStartBefore(child).collapse(true);\n\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t} else if (domUtils.isFillChar(child, true)) {\n\t\t\t\t\tchild.nodeValue = child.nodeValue.replace(fillCharReg, '');\n\t\t\t\t\trange.startOffset--;\n\t\t\t\t\trange.collapsed && range.collapse(true)\n\t\t\t\t}\n\t\t\t}\n\t\t\t//列表单独处理\n\t\t\tvar li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\tif (li) {\n\t\t\t\tvar next, last;\n\t\t\t\twhile (child = div.firstChild) {\n\t\t\t\t\t//针对hr单独处理一下先\n\t\t\t\t\twhile (child && (child.nodeType == 3 || !domUtils.isBlockElm(child) || child.tagName == 'HR')) {\n\t\t\t\t\t\tnext = child.nextSibling;\n\t\t\t\t\t\trange.insertNode(child).collapse();\n\t\t\t\t\t\tlast = child;\n\t\t\t\t\t\tchild = next;\n\n\t\t\t\t\t}\n\t\t\t\t\tif (child) {\n\t\t\t\t\t\tif (/^(ol|ul)$/i.test(child.tagName)) {\n\t\t\t\t\t\t\twhile (child.firstChild) {\n\t\t\t\t\t\t\t\tlast = child.firstChild;\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(li, child.firstChild);\n\t\t\t\t\t\t\t\tli = li.nextSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(child)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpLi;\n\t\t\t\t\t\t\tnext = child.nextSibling;\n\t\t\t\t\t\t\ttmpLi = me.document.createElement('li');\n\t\t\t\t\t\t\tdomUtils.insertAfter(li, tmpLi);\n\t\t\t\t\t\t\ttmpLi.appendChild(child);\n\t\t\t\t\t\t\tlast = child;\n\t\t\t\t\t\t\tchild = next;\n\t\t\t\t\t\t\tli = tmpLi;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\tif (domUtils.isEmptyBlock(li)) {\n\t\t\t\t\tdomUtils.remove(li)\n\t\t\t\t}\n\t\t\t\tif (last) {\n\n\t\t\t\t\trange.setStartAfter(last).collapse(true).select(true)\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile (child = div.firstChild) {\n\t\t\t\t\tif (hadBreak) {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\twhile (child && (child.nodeType == 3 || !dtd.$block[child.tagName])) {\n\t\t\t\t\t\t\tnextNode = child.nextSibling;\n\t\t\t\t\t\t\tp.appendChild(child);\n\t\t\t\t\t\t\tchild = nextNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (p.firstChild) {\n\n\t\t\t\t\t\t\tchild = p\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.insertNode(child);\n\t\t\t\t\tnextNode = child.nextSibling;\n\t\t\t\t\tif (!hadBreak && child.nodeType == domUtils.NODE_ELEMENT && domUtils.isBlockElm(child)) {\n\n\t\t\t\t\t\tparent = domUtils.findParent(child, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (parent && parent.tagName.toLowerCase() != 'body' && !(dtd[parent.tagName][child.nodeName] && child.parentNode === parent)) {\n\t\t\t\t\t\t\tif (!dtd[parent.tagName][child.nodeName]) {\n\t\t\t\t\t\t\t\tpre = parent;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttmp = child.parentNode;\n\t\t\t\t\t\t\t\twhile (tmp !== parent) {\n\t\t\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\t\t\ttmp = tmp.parentNode;\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdomUtils.breakParent(child, pre || tmp);\n\t\t\t\t\t\t\t//去掉break后前一个多余的节点  <p>|<[p> ==> <p></p><div></div><p>|</p>\n\t\t\t\t\t\t\tvar pre = child.previousSibling;\n\t\t\t\t\t\t\tdomUtils.trimWhiteTextNode(pre);\n\t\t\t\t\t\t\tif (!pre.childNodes.length) {\n\t\t\t\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//trace:2012,在非ie的情况，切开后剩下的节点有可能不能点入光标添加br占位\n\n\t\t\t\t\t\t\tif (!browser.ie &&\n\t\t\t\t\t\t\t\t(next = child.nextSibling) &&\n\t\t\t\t\t\t\t\tdomUtils.isBlockElm(next) &&\n\t\t\t\t\t\t\t\tnext.lastChild &&\n\t\t\t\t\t\t\t\t!domUtils.isBr(next.lastChild)) {\n\t\t\t\t\t\t\t\tnext.appendChild(me.document.createElement('br'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\thadBreak = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar next = child.nextSibling;\n\t\t\t\t\tif (!div.firstChild && next && domUtils.isBlockElm(next)) {\n\n\t\t\t\t\t\trange.setStart(next, 0).collapse(true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\trange.setEndAfter(child).collapse();\n\n\t\t\t\t}\n\n\t\t\t\tchild = range.startContainer;\n\n\t\t\t\tif (nextNode && domUtils.isBr(nextNode)) {\n\t\t\t\t\tdomUtils.remove(nextNode)\n\t\t\t\t}\n\t\t\t\t//用chrome可能有空白展位符\n\t\t\t\tif (domUtils.isBlockElm(child) && domUtils.isEmptyNode(child)) {\n\t\t\t\t\tif (nextNode = child.nextSibling) {\n\t\t\t\t\t\tdomUtils.remove(child);\n\t\t\t\t\t\tif (nextNode.nodeType == 1 && dtd.$block[nextNode.tagName]) {\n\n\t\t\t\t\t\t\trange.setStart(nextNode, 0).collapse(true).shrinkBoundary()\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tchild.innerHTML = browser.ie ? domUtils.fillChar : '<br/>';\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\trange.setStartBefore(child);\n\t\t\t\t\t\t\tdomUtils.remove(child)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\t//加上true因为在删除表情等时会删两次，第一次是删的fillData\n\t\t\t\ttry {\n\t\t\t\t\trange.select(true);\n\t\t\t\t} catch (e) {}\n\n\t\t\t}\n\n\t\t\tsetTimeout(function() {\n\t\t\t\trange = me.selection.getRange();\n\t\t\t\trange.scrollToView(me.autoHeightEnabled, me.autoHeightEnabled ? domUtils.getXY(me.iframe).y : 0);\n\t\t\t\tme.fireEvent('afterinserthtml', html);\n\t\t\t}, 200);\n\t\t}\n\t};\n\n\t// plugins/autotypeset.js\n\t/**\n\t * 自动排版\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 对当前编辑器的内容执行自动排版， 排版的行为根据config配置文件里的“autotypeset”选项进行控制。\n\t * @command autotypeset\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'autotypeset' );\n\t * ```\n\t */\n\n\tUE.plugins['autotypeset'] = function() {\n\n\t\tthis.setOpt({\n\t\t\t'autotypeset': {\n\t\t\t\tmergeEmptyline: true, //合并空行\n\t\t\t\tremoveClass: true, //去掉冗余的class\n\t\t\t\tremoveEmptyline: false, //去掉空行\n\t\t\t\ttextAlign: \"left\", //段落的排版方式，可以是 left,right,center,justify 去掉这个属性表示不执行排版\n\t\t\t\timageBlockLine: 'center', //图片的浮动方式，独占一行剧中,左右浮动，默认: center,left,right,none 去掉这个属性表示不执行排版\n\t\t\t\tpasteFilter: false, //根据规则过滤没事粘贴进来的内容\n\t\t\t\tclearFontSize: false, //去掉所有的内嵌字号，使用编辑器默认的字号\n\t\t\t\tclearFontFamily: false, //去掉所有的内嵌字体，使用编辑器默认的字体\n\t\t\t\tremoveEmptyNode: false, // 去掉空节点\n\t\t\t\t//可以去掉的标签\n\t\t\t\tremoveTagNames: utils.extend({\n\t\t\t\t\tdiv: 1\n\t\t\t\t}, dtd.$removeEmpty),\n\t\t\t\tindent: false, // 行首缩进\n\t\t\t\tindentValue: '2em', //行首缩进的大小\n\t\t\t\tbdc2sb: false,\n\t\t\t\ttobdc: false\n\t\t\t}\n\t\t});\n\n\t\tvar me = this,\n\t\t\topt = me.options.autotypeset,\n\t\t\tremainClass = {\n\t\t\t\t'selectTdClass': 1,\n\t\t\t\t'pagebreak': 1,\n\t\t\t\t'anchorclass': 1\n\t\t\t},\n\t\t\tremainTag = {\n\t\t\t\t'li': 1\n\t\t\t},\n\t\t\ttags = {\n\t\t\t\tdiv: 1,\n\t\t\t\tp: 1,\n\t\t\t\t//trace:2183 这些也认为是行\n\t\t\t\tblockquote: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\th1: 1,\n\t\t\t\th2: 1,\n\t\t\t\th3: 1,\n\t\t\t\th4: 1,\n\t\t\t\th5: 1,\n\t\t\t\th6: 1,\n\t\t\t\tspan: 1\n\t\t\t},\n\t\t\thighlightCont;\n\t\t//升级了版本，但配置项目里没有autotypeset\n\t\tif (!opt) {\n\t\t\treturn;\n\t\t}\n\n\t\treadLocalOpts();\n\n\t\tfunction isLine(node, notEmpty) {\n\t\t\tif (!node || node.nodeType == 3)\n\t\t\t\treturn 0;\n\t\t\tif (domUtils.isBr(node))\n\t\t\t\treturn 1;\n\t\t\tif (node && node.parentNode && tags[node.tagName.toLowerCase()]) {\n\t\t\t\tif (highlightCont && highlightCont.contains(node) ||\n\t\t\t\t\tnode.getAttribute('pagebreak')\n\t\t\t\t) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn notEmpty ? !domUtils.isEmptyBlock(node) : domUtils.isEmptyBlock(node, new RegExp('[\\\\s' + domUtils.fillChar + ']', 'g'));\n\t\t\t}\n\t\t}\n\n\t\tfunction removeNotAttributeSpan(node) {\n\t\t\tif (!node.style.cssText) {\n\t\t\t\tdomUtils.removeAttributes(node, ['style']);\n\t\t\t\tif (node.tagName.toLowerCase() == 'span' && domUtils.hasNoAttributes(node)) {\n\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction autotype(type, html) {\n\n\t\t\tvar me = this,\n\t\t\t\tcont;\n\t\t\tif (html) {\n\t\t\t\tif (!opt.pasteFilter) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tcont = me.document.createElement('div');\n\t\t\t\tcont.innerHTML = html.html;\n\t\t\t} else {\n\t\t\t\tcont = me.document.body;\n\t\t\t}\n\t\t\tvar nodes = domUtils.getElementsByTagName(cont, '*');\n\n\t\t\t// 行首缩进，段落方向，段间距，段内间距\n\t\t\tfor (var i = 0, ci; ci = nodes[i++];) {\n\n\t\t\t\tif (me.fireEvent('excludeNodeinautotype', ci) === true) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t//font-size\n\t\t\t\tif (opt.clearFontSize && ci.style.fontSize) {\n\t\t\t\t\tdomUtils.removeStyle(ci, 'font-size');\n\n\t\t\t\t\tremoveNotAttributeSpan(ci);\n\n\t\t\t\t}\n\t\t\t\t//font-family\n\t\t\t\tif (opt.clearFontFamily && ci.style.fontFamily) {\n\t\t\t\t\tdomUtils.removeStyle(ci, 'font-family');\n\t\t\t\t\tremoveNotAttributeSpan(ci);\n\t\t\t\t}\n\n\t\t\t\tif (isLine(ci)) {\n\t\t\t\t\t//合并空行\n\t\t\t\t\tif (opt.mergeEmptyline) {\n\t\t\t\t\t\tvar next = ci.nextSibling,\n\t\t\t\t\t\t\ttmpNode, isBr = domUtils.isBr(ci);\n\t\t\t\t\t\twhile (isLine(next)) {\n\t\t\t\t\t\t\ttmpNode = next;\n\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\tif (isBr && (!next || next && !domUtils.isBr(next))) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\t//去掉空行，保留占位的空行\n\t\t\t\t\tif (opt.removeEmptyline && domUtils.inDoc(ci, cont) && !remainTag[ci.parentNode.tagName.toLowerCase()]) {\n\t\t\t\t\t\tif (domUtils.isBr(ci)) {\n\t\t\t\t\t\t\tnext = ci.nextSibling;\n\t\t\t\t\t\t\tif (next && !domUtils.isBr(next)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif (isLine(ci, true) && ci.tagName != 'SPAN') {\n\t\t\t\t\tif (opt.indent) {\n\t\t\t\t\t\tci.style.textIndent = opt.indentValue;\n\t\t\t\t\t}\n\t\t\t\t\tif (opt.textAlign) {\n\t\t\t\t\t\tci.style.textAlign = opt.textAlign;\n\t\t\t\t\t}\n\t\t\t\t\t// if(opt.lineHeight)\n\t\t\t\t\t//     ci.style.lineHeight = opt.lineHeight + 'cm';\n\n\t\t\t\t}\n\n\t\t\t\t//去掉class,保留的class不去掉\n\t\t\t\tif (opt.removeClass && ci.className && !remainClass[ci.className.toLowerCase()]) {\n\n\t\t\t\t\tif (highlightCont && highlightCont.contains(ci)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.removeAttributes(ci, ['class']);\n\t\t\t\t}\n\n\t\t\t\t//表情不处理\n\t\t\t\tif (opt.imageBlockLine && ci.tagName.toLowerCase() == 'img' && !ci.getAttribute('emotion')) {\n\t\t\t\t\tif (html) {\n\t\t\t\t\t\tvar img = ci;\n\t\t\t\t\t\tswitch (opt.imageBlockLine) {\n\t\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\t\tvar pN = img.parentNode,\n\t\t\t\t\t\t\t\t\ttmpNode, pre, next;\n\t\t\t\t\t\t\t\twhile (dtd.$inline[pN.tagName] || pN.tagName == 'A') {\n\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\tif (tmpNode.tagName == 'P' && domUtils.getStyle(tmpNode, 'text-align') == 'center') {\n\t\t\t\t\t\t\t\t\tif (!domUtils.isBody(tmpNode) && domUtils.getChildCount(tmpNode, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node)\n\t\t\t\t\t\t\t\t\t\t}) == 1) {\n\t\t\t\t\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\t\t\tif (pre && next && pre.nodeType == 1 && next.nodeType == 1 && pre.tagName == next.tagName && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(tmpNode.firstChild);\n\t\t\t\t\t\t\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(next.firstChild);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'text-align', '');\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', opt.imageBlockLine);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\t\tif (me.queryCommandValue('imagefloat') != 'center') {\n\t\t\t\t\t\t\t\t\tpN = img.parentNode;\n\t\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', 'none');\n\t\t\t\t\t\t\t\t\ttmpNode = img;\n\t\t\t\t\t\t\t\t\twhile (pN && domUtils.getChildCount(pN, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node)\n\t\t\t\t\t\t\t\t\t\t}) == 1 && (dtd.$inline[pN.tagName] || pN.tagName == 'A')) {\n\t\t\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tvar pNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(pNode, {\n\n\t\t\t\t\t\t\t\t\t\tstyle: 'text-align:center'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\ttmpNode.parentNode.insertBefore(pNode, tmpNode);\n\t\t\t\t\t\t\t\t\tpNode.appendChild(tmpNode);\n\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'float', '');\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\t\t\trange.selectNode(ci).select();\n\t\t\t\t\t\tme.execCommand('imagefloat', opt.imageBlockLine);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t//去掉冗余的标签\n\t\t\t\tif (opt.removeEmptyNode) {\n\t\t\t\t\tif (opt.removeTagNames[ci.tagName.toLowerCase()] && domUtils.hasNoAttributes(ci) && domUtils.isEmptyBlock(ci)) {\n\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (opt.tobdc) {\n\t\t\t\tvar root = UE.htmlparser(cont.innerHTML);\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type == 'text') {\n\t\t\t\t\t\tnode.data = ToDBC(node.data)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tcont.innerHTML = root.toHtml()\n\t\t\t}\n\t\t\tif (opt.bdc2sb) {\n\t\t\t\tvar root = UE.htmlparser(cont.innerHTML);\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type == 'text') {\n\t\t\t\t\t\tnode.data = DBC2SB(node.data)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tcont.innerHTML = root.toHtml()\n\t\t\t}\n\t\t\tif (html) {\n\t\t\t\thtml.html = cont.innerHTML;\n\t\t\t}\n\t\t}\n\t\tif (opt.pasteFilter) {\n\t\t\tme.addListener('beforepaste', autotype);\n\t\t}\n\n\t\tfunction DBC2SB(str) {\n\t\t\tvar result = '';\n\t\t\tfor (var i = 0; i < str.length; i++) {\n\t\t\t\tvar code = str.charCodeAt(i); //获取当前字符的unicode编码\n\t\t\t\tif (code >= 65281 && code <= 65373) //在这个unicode编码范围中的是所有的英文字母已经各种字符\n\t\t\t\t{\n\t\t\t\t\tresult += String.fromCharCode(str.charCodeAt(i) - 65248); //把全角字符的unicode编码转换为对应半角字符的unicode码\n\t\t\t\t} else if (code == 12288) //空格\n\t\t\t\t{\n\t\t\t\t\tresult += String.fromCharCode(str.charCodeAt(i) - 12288 + 32);\n\t\t\t\t} else {\n\t\t\t\t\tresult += str.charAt(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t\tfunction ToDBC(txtstring) {\n\t\t\ttxtstring = utils.html(txtstring);\n\t\t\tvar tmp = \"\";\n\t\t\tvar mark = \"\"; /*用于判断,如果是html尖括里的标记,则不进行全角的转换*/\n\t\t\tfor (var i = 0; i < txtstring.length; i++) {\n\t\t\t\tif (txtstring.charCodeAt(i) == 32) {\n\t\t\t\t\ttmp = tmp + String.fromCharCode(12288);\n\t\t\t\t} else if (txtstring.charCodeAt(i) < 127) {\n\t\t\t\t\ttmp = tmp + String.fromCharCode(txtstring.charCodeAt(i) + 65248);\n\t\t\t\t} else {\n\t\t\t\t\ttmp += txtstring.charAt(i);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn tmp;\n\t\t}\n\n\t\tfunction readLocalOpts() {\n\t\t\tvar cookieOpt = me.getPreferences('autotypeset');\n\t\t\tutils.extend(me.options.autotypeset, cookieOpt);\n\t\t}\n\n\t\tme.commands['autotypeset'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tme.removeListener('beforepaste', autotype);\n\t\t\t\tif (opt.pasteFilter) {\n\t\t\t\t\tme.addListener('beforepaste', autotype);\n\t\t\t\t}\n\t\t\t\tautotype.call(me)\n\t\t\t}\n\n\t\t};\n\n\t};\n\n\t// plugins/autosubmit.js\n\t/**\n\t * 快捷键提交\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 提交表单\n\t * @command autosubmit\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'autosubmit' );\n\t * ```\n\t */\n\n\tUE.plugin.register('autosubmit', function() {\n\t\treturn {\n\t\t\tshortcutkey: {\n\t\t\t\t\"autosubmit\": \"ctrl+13\" //手动提交\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'autosubmit': {\n\t\t\t\t\texecCommand: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tform = domUtils.findParentByTagName(me.iframe, \"form\", false);\n\t\t\t\t\t\tif (form) {\n\t\t\t\t\t\t\tif (me.fireEvent(\"beforesubmit\") === false) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.sync();\n\t\t\t\t\t\t\tform.submit();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/background.js\n\t/**\n\t * 背景插件，为UEditor提供设置背景功能\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugin.register('background', function() {\n\t\tvar me = this,\n\t\t\tcssRuleId = 'editor_background',\n\t\t\tisSetColored,\n\t\t\treg = new RegExp('body[\\\\s]*\\\\{(.+)\\\\}', 'i');\n\n\t\tfunction stringToObj(str) {\n\t\t\tvar obj = {},\n\t\t\t\tstyles = str.split(';');\n\t\t\tutils.each(styles, function(v) {\n\t\t\t\tvar index = v.indexOf(':'),\n\t\t\t\t\tkey = utils.trim(v.substr(0, index)).toLowerCase();\n\t\t\t\tkey && (obj[key] = utils.trim(v.substr(index + 1) || ''));\n\t\t\t});\n\t\t\treturn obj;\n\t\t}\n\n\t\tfunction setBackground(obj) {\n\t\t\tif (obj) {\n\t\t\t\tvar styles = [];\n\t\t\t\tfor (var name in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(name)) {\n\t\t\t\t\t\tstyles.push(name + \":\" + obj[name] + '; ');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tutils.cssRule(cssRuleId, styles.length ? ('body{' + styles.join(\"\") + '}') : '', me.document);\n\t\t\t} else {\n\t\t\t\tutils.cssRule(cssRuleId, '', me.document)\n\t\t\t}\n\t\t}\n\t\t//重写editor.hasContent方法\n\n\t\tvar orgFn = me.hasContents;\n\t\tme.hasContents = function() {\n\t\t\tif (me.queryCommandValue('background')) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\treturn orgFn.apply(me, arguments);\n\t\t};\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'getAllHtml': function(type, headHtml) {\n\t\t\t\t\tvar body = this.body,\n\t\t\t\t\t\tsu = domUtils.getComputedStyle(body, \"background-image\"),\n\t\t\t\t\t\turl = \"\";\n\t\t\t\t\tif (su.indexOf(me.options.imagePath) > 0) {\n\t\t\t\t\t\turl = su.substring(su.indexOf(me.options.imagePath), su.length - 1).replace(/\"|\\(|\\)/ig, \"\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl = su != \"none\" ? su.replace(/url\\(\"?|\"?\\)/ig, \"\") : \"\";\n\t\t\t\t\t}\n\t\t\t\t\tvar html = '<style type=\"text/css\">body{';\n\t\t\t\t\tvar bgObj = {\n\t\t\t\t\t\t\"background-color\": domUtils.getComputedStyle(body, \"background-color\") || \"#ffffff\",\n\t\t\t\t\t\t'background-image': url ? 'url(' + url + ')' : '',\n\t\t\t\t\t\t'background-repeat': domUtils.getComputedStyle(body, \"background-repeat\") || \"\",\n\t\t\t\t\t\t'background-position': browser.ie ? (domUtils.getComputedStyle(body, \"background-position-x\") + \" \" + domUtils.getComputedStyle(body, \"background-position-y\")) : domUtils.getComputedStyle(body, \"background-position\"),\n\t\t\t\t\t\t'height': domUtils.getComputedStyle(body, \"height\")\n\t\t\t\t\t};\n\t\t\t\t\tfor (var name in bgObj) {\n\t\t\t\t\t\tif (bgObj.hasOwnProperty(name)) {\n\t\t\t\t\t\t\thtml += name + \":\" + bgObj[name] + \"; \";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\thtml += '}</style> ';\n\t\t\t\t\theadHtml.push(html);\n\t\t\t\t},\n\t\t\t\t'aftersetcontent': function() {\n\t\t\t\t\tif (isSetColored == false) setBackground();\n\t\t\t\t}\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tisSetColored = false;\n\t\t\t\tutils.each(root.getNodesByTagName('p'), function(p) {\n\t\t\t\t\tvar styles = p.getAttr('data-background');\n\t\t\t\t\tif (styles) {\n\t\t\t\t\t\tisSetColored = true;\n\t\t\t\t\t\tsetBackground(stringToObj(styles));\n\t\t\t\t\t\tp.parentNode.removeChild(p);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tstyles = (utils.cssRule(cssRuleId, me.document) || '').replace(/[\\n\\r]+/g, '').match(reg);\n\t\t\t\tif (styles) {\n\t\t\t\t\troot.appendChild(UE.uNode.createElement('<p style=\"display:none;\" data-background=\"' + utils.trim(styles[1].replace(/\"/g, '').replace(/[\\s]+/g, ' ')) + '\"><br/></p>'));\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'background': {\n\t\t\t\t\texecCommand: function(cmd, obj) {\n\t\t\t\t\t\tsetBackground(obj);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tstyles = (utils.cssRule(cssRuleId, me.document) || '').replace(/[\\n\\r]+/g, '').match(reg);\n\t\t\t\t\t\treturn styles ? stringToObj(styles[1]) : null;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/image.js\n\t/**\n\t * 图片插入、排版插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 图片对齐方式\n\t * @command imagefloat\n\t * @method execCommand\n\t * @remind 值center为独占一行居中\n\t * @param { String } cmd 命令字符串\n\t * @param { String } align 对齐方式，可传left、right、none、center\n\t * @remaind center表示图片独占一行\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'imagefloat', 'center' );\n\t * ```\n\t */\n\n\t/**\n\t * 如果选区所在位置是图片区域\n\t * @command imagefloat\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回图片对齐方式\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'imagefloat' );\n\t * ```\n\t */\n\n\tUE.commands['imagefloat'] = {\n\t\texecCommand: function(cmd, align) {\n\t\t\tvar me = this,\n\t\t\t\trange = me.selection.getRange();\n\t\t\tif (!range.collapsed) {\n\t\t\t\tvar img = range.getClosedNode();\n\t\t\t\tif (img && img.tagName == 'IMG') {\n\t\t\t\t\tswitch (align) {\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tcase 'none':\n\t\t\t\t\t\t\tvar pN = img.parentNode,\n\t\t\t\t\t\t\t\ttmpNode, pre, next;\n\t\t\t\t\t\t\twhile (dtd.$inline[pN.tagName] || pN.tagName == 'A') {\n\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\tif (tmpNode.tagName == 'P' && domUtils.getStyle(tmpNode, 'text-align') == 'center') {\n\t\t\t\t\t\t\t\tif (!domUtils.isBody(tmpNode) && domUtils.getChildCount(tmpNode, function(node) {\n\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t\t\t\t\t}) == 1) {\n\t\t\t\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\t\t\t\tnext = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\t\tif (pre && next && pre.nodeType == 1 && next.nodeType == 1 && pre.tagName == next.tagName && domUtils.isBlockElm(pre)) {\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(tmpNode.firstChild);\n\t\t\t\t\t\t\t\t\t\twhile (next.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tpre.appendChild(next.firstChild);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'text-align', '');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\trange.selectNode(img).select();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', align == 'none' ? '' : align);\n\t\t\t\t\t\t\tif (align == 'none') {\n\t\t\t\t\t\t\t\tdomUtils.removeAttributes(img, 'align');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'center':\n\t\t\t\t\t\t\tif (me.queryCommandValue('imagefloat') != 'center') {\n\t\t\t\t\t\t\t\tpN = img.parentNode;\n\t\t\t\t\t\t\t\tdomUtils.setStyle(img, 'float', '');\n\t\t\t\t\t\t\t\tdomUtils.removeAttributes(img, 'align');\n\t\t\t\t\t\t\t\ttmpNode = img;\n\t\t\t\t\t\t\t\twhile (pN && domUtils.getChildCount(pN, function(node) {\n\t\t\t\t\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t\t\t\t\t}) == 1 && (dtd.$inline[pN.tagName] || pN.tagName == 'A')) {\n\t\t\t\t\t\t\t\t\ttmpNode = pN;\n\t\t\t\t\t\t\t\t\tpN = pN.parentNode;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.setStartBefore(tmpNode).setCursor(false);\n\t\t\t\t\t\t\t\tpN = me.document.createElement('div');\n\t\t\t\t\t\t\t\tpN.appendChild(tmpNode);\n\t\t\t\t\t\t\t\tdomUtils.setStyle(tmpNode, 'float', '');\n\n\t\t\t\t\t\t\t\tme.execCommand('insertHtml', '<p id=\"_img_parent_tmp\" style=\"text-align:center\">' + pN.innerHTML + '</p>');\n\n\t\t\t\t\t\t\t\ttmpNode = me.document.getElementById('_img_parent_tmp');\n\t\t\t\t\t\t\t\ttmpNode.removeAttribute('id');\n\t\t\t\t\t\t\t\ttmpNode = tmpNode.firstChild;\n\t\t\t\t\t\t\t\trange.selectNode(tmpNode).select();\n\t\t\t\t\t\t\t\t//去掉后边多余的元素\n\t\t\t\t\t\t\t\tnext = tmpNode.parentNode.nextSibling;\n\t\t\t\t\t\t\t\tif (next && domUtils.isEmptyNode(next)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tqueryCommandValue: function() {\n\t\t\tvar range = this.selection.getRange(),\n\t\t\t\tstartNode, floatStyle;\n\t\t\tif (range.collapsed) {\n\t\t\t\treturn 'none';\n\t\t\t}\n\t\t\tstartNode = range.getClosedNode();\n\t\t\tif (startNode && startNode.nodeType == 1 && startNode.tagName == 'IMG') {\n\t\t\t\tfloatStyle = domUtils.getComputedStyle(startNode, 'float') || startNode.getAttribute('align');\n\n\t\t\t\tif (floatStyle == 'none') {\n\t\t\t\t\tfloatStyle = domUtils.getComputedStyle(startNode.parentNode, 'text-align') == 'center' ? 'center' : floatStyle;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tleft: 1,\n\t\t\t\t\tright: 1,\n\t\t\t\t\tcenter: 1\n\t\t\t\t}[floatStyle] ? floatStyle: 'none';\n\t\t\t}\n\t\t\treturn 'none';\n\n\t\t},\n\t\tqueryCommandState: function() {\n\t\t\tvar range = this.selection.getRange(),\n\t\t\t\tstartNode;\n\n\t\t\tif (range.collapsed) return -1;\n\n\t\t\tstartNode = range.getClosedNode();\n\t\t\tif (startNode && startNode.nodeType == 1 && startNode.tagName == 'IMG') {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn -1;\n\t\t}\n\t};\n\n\t/**\n\t * 插入图片\n\t * @command insertimage\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { Object } opt 属性键值对，这些属性都将被复制到当前插入图片\n\t * @remind 该命令第二个参数可接受一个图片配置项对象的数组，可以插入多张图片，\n\t * 此时数组的每一个元素都是一个Object类型的图片属性集合。\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'insertimage', {\n\t *     src:'a/b/c.jpg',\n\t *     width:'100',\n\t *     height:'100'\n\t * } );\n\t * ```\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'insertimage', [{\n\t *     src:'a/b/c.jpg',\n\t *     width:'100',\n\t *     height:'100'\n\t * },{\n\t *     src:'a/b/d.jpg',\n\t *     width:'100',\n\t *     height:'100'\n\t * }] );\n\t * ```\n\t */\n\n\tUE.commands['insertimage'] = {\n\t\texecCommand: function(cmd, opt) {\n\n\t\t\topt = utils.isArray(opt) ? opt : [opt];\n\t\t\tif (!opt.length) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar me = this,\n\t\t\t\trange = me.selection.getRange(),\n\t\t\t\timg = range.getClosedNode();\n\n\t\t\tif (me.fireEvent('beforeinsertimage', opt) === true) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfunction unhtmlData(imgCi) {\n\n\t\t\t\tutils.each('width,height,border,hspace,vspace'.split(','), function(item) {\n\n\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\timgCi[item] = parseInt(imgCi[item], 10) || 0;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tutils.each('src,_src'.split(','), function(item) {\n\n\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\timgCi[item] = utils.unhtmlForUrl(imgCi[item]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tutils.each('title,alt'.split(','), function(item) {\n\n\t\t\t\t\tif (imgCi[item]) {\n\t\t\t\t\t\timgCi[item] = utils.unhtml(imgCi[item]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (img && /img/i.test(img.tagName) && (img.className != \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1) && !img.getAttribute(\"word_img\")) {\n\t\t\t\tvar first = opt.shift();\n\t\t\t\tvar floatStyle = first['floatStyle'];\n\t\t\t\tdelete first['floatStyle'];\n\t\t\t\t////                img.style.border = (first.border||0) +\"px solid #000\";\n\t\t\t\t////                img.style.margin = (first.margin||0) +\"px\";\n\t\t\t\t//                img.style.cssText += ';margin:' + (first.margin||0) +\"px;\" + 'border:' + (first.border||0) +\"px solid #000\";\n\t\t\t\tdomUtils.setAttributes(img, first);\n\t\t\t\tme.execCommand('imagefloat', floatStyle);\n\t\t\t\tif (opt.length > 0) {\n\t\t\t\t\trange.setStartAfter(img).setCursor(false, true);\n\t\t\t\t\tme.execCommand('insertimage', opt);\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tvar html = [],\n\t\t\t\t\tstr = '',\n\t\t\t\t\tci;\n\t\t\t\tci = opt[0];\n\t\t\t\tif (opt.length == 1) {\n\t\t\t\t\tunhtmlData(ci);\n\n\t\t\t\t\tstr = '<img src=\"' + ci.src + '\" ' + (ci._src ? ' _src=\"' + ci._src + '\" ' : '') +\n\t\t\t\t\t\t(ci.width ? 'width=\"' + ci.width + '\" ' : '') +\n\t\t\t\t\t\t(ci.height ? ' height=\"' + ci.height + '\" ' : '') +\n\t\t\t\t\t\t(ci['floatStyle'] == 'left' || ci['floatStyle'] == 'right' ? ' style=\"float:' + ci['floatStyle'] + ';\"' : '') +\n\t\t\t\t\t\t(ci.title && ci.title != \"\" ? ' title=\"' + ci.title + '\"' : '') +\n\t\t\t\t\t\t(ci.border && ci.border != \"0\" ? ' border=\"' + ci.border + '\"' : '') +\n\t\t\t\t\t\t(ci.alt && ci.alt != \"\" ? ' alt=\"' + ci.alt + '\"' : '') +\n\t\t\t\t\t\t(ci.hspace && ci.hspace != \"0\" ? ' hspace = \"' + ci.hspace + '\"' : '') +\n\t\t\t\t\t\t(ci.vspace && ci.vspace != \"0\" ? ' vspace = \"' + ci.vspace + '\"' : '') + '/>';\n\t\t\t\t\tif (ci['floatStyle'] == 'center') {\n\t\t\t\t\t\tstr = '<p style=\"text-align: center\">' + str + '</p>';\n\t\t\t\t\t}\n\t\t\t\t\thtml.push(str);\n\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = 0; ci = opt[i++];) {\n\t\t\t\t\t\tunhtmlData(ci);\n\t\t\t\t\t\tstr = '<p ' + (ci['floatStyle'] == 'center' ? 'style=\"text-align: center\" ' : '') + '><img src=\"' + ci.src + '\" ' +\n\t\t\t\t\t\t\t(ci.width ? 'width=\"' + ci.width + '\" ' : '') + (ci._src ? ' _src=\"' + ci._src + '\" ' : '') +\n\t\t\t\t\t\t\t(ci.height ? ' height=\"' + ci.height + '\" ' : '') +\n\t\t\t\t\t\t\t' style=\"' + (ci['floatStyle'] && ci['floatStyle'] != 'center' ? 'float:' + ci['floatStyle'] + ';' : '') +\n\t\t\t\t\t\t\t(ci.border || '') + '\" ' +\n\t\t\t\t\t\t\t(ci.title ? ' title=\"' + ci.title + '\"' : '') + ' /></p>';\n\t\t\t\t\t\thtml.push(str);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tme.execCommand('insertHtml', html.join(''));\n\t\t\t}\n\n\t\t\tme.fireEvent('afterinsertimage', opt)\n\t\t}\n\t};\n\n\t// plugins/justify.js\n\t/**\n\t * 段落格式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 段落对齐方式\n\t * @command justify\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } align 对齐方式：left => 居左，right => 居右，center => 居中，justify => 两端对齐\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'justify', 'center' );\n\t * ```\n\t */\n\t/**\n\t * 如果选区所在位置是段落区域，返回当前段落对齐方式\n\t * @command justify\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回段落对齐方式\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'justify' );\n\t * ```\n\t */\n\n\tUE.plugins['justify'] = function() {\n\t\tvar me = this,\n\t\t\tblock = domUtils.isBlockElm,\n\t\t\tdefaultValue = {\n\t\t\t\tleft: 1,\n\t\t\t\tright: 1,\n\t\t\t\tcenter: 1,\n\t\t\t\tjustify: 1\n\t\t\t},\n\t\t\tdoJustify = function(range, style) {\n\t\t\t\tvar bookmark = range.createBookmark(),\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t};\n\n\t\t\t\trange.enlarge(true);\n\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\ttmpNode;\n\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\t\t\t\t\tvar common = tmpRange.getCommonAncestor();\n\t\t\t\t\t\tif (!domUtils.isBody(common) && block(common)) {\n\t\t\t\t\t\t\tdomUtils.setStyles(common, utils.isString(style) ? {\n\t\t\t\t\t\t\t\t'text-align': style\n\t\t\t\t\t\t\t} : style);\n\t\t\t\t\t\t\tcurrent = common;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar p = range.document.createElement('p');\n\t\t\t\t\t\t\tdomUtils.setStyles(p, utils.isString(style) ? {\n\t\t\t\t\t\t\t\t'text-align': style\n\t\t\t\t\t\t\t} : style);\n\t\t\t\t\t\t\tvar frag = tmpRange.extractContents();\n\t\t\t\t\t\t\tp.appendChild(frag);\n\t\t\t\t\t\t\ttmpRange.insertNode(p);\n\t\t\t\t\t\t\tcurrent = p;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t};\n\n\t\tUE.commands['justify'] = {\n\t\t\texecCommand: function(cmdName, align) {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\ttxt;\n\n\t\t\t\t//闭合时单独处理\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\ttxt = this.document.createTextNode('p');\n\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t}\n\t\t\t\tdoJustify(range, align);\n\t\t\t\tif (txt) {\n\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t}\n\n\t\t\t\trange.select();\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar startNode = this.selection.getStart(),\n\t\t\t\t\tvalue = domUtils.getComputedStyle(startNode, 'text-align');\n\t\t\t\treturn defaultValue[value] ? value : 'left';\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar start = this.selection.getStart(),\n\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\n\t\t\t\treturn cell ? -1 : 0;\n\t\t\t}\n\n\t\t};\n\t};\n\n\t// plugins/font.js\n\t/**\n\t * 字体颜色,背景色,字号,字体,下划线,删除线\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 字体颜色\n\t * @command forecolor\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 色值(必须十六进制)\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'forecolor', '#000' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体颜色\n\t * @command forecolor\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体颜色\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'forecolor' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体背景颜色\n\t * @command backcolor\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 色值(必须十六进制)\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'backcolor', '#000' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体颜色\n\t * @command backcolor\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体背景颜色\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'backcolor' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体大小\n\t * @command fontsize\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 字体大小\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'fontsize', '14px' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体大小\n\t * @command fontsize\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体大小\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'fontsize' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体样式\n\t * @command fontfamily\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 字体样式\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'fontfamily', '微软雅黑' );\n\t * ```\n\t */\n\t/**\n\t * 返回选区字体样式\n\t * @command fontfamily\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 返回字体样式\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'fontfamily' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体下划线,与删除线互斥\n\t * @command underline\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'underline' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体删除线,与下划线互斥\n\t * @command strikethrough\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'strikethrough' );\n\t * ```\n\t */\n\n\t/**\n\t * 字体边框\n\t * @command fontborder\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'fontborder' );\n\t * ```\n\t */\n\n\tUE.plugins['font'] = function() {\n\t\tvar me = this,\n\t\t\tfonts = {\n\t\t\t\t'forecolor': 'color',\n\t\t\t\t'backcolor': 'background-color',\n\t\t\t\t'fontsize': 'font-size',\n\t\t\t\t'fontfamily': 'font-family',\n\t\t\t\t'underline': 'text-decoration',\n\t\t\t\t'strikethrough': 'text-decoration',\n\t\t\t\t'fontborder': 'border'\n\t\t\t},\n\t\t\tneedCmd = {\n\t\t\t\t'underline': 1,\n\t\t\t\t'strikethrough': 1,\n\t\t\t\t'fontborder': 1\n\t\t\t},\n\t\t\tneedSetChild = {\n\t\t\t\t'forecolor': 'color',\n\t\t\t\t'backcolor': 'background-color',\n\t\t\t\t'fontsize': 'font-size',\n\t\t\t\t'fontfamily': 'font-family'\n\n\t\t\t};\n\t\tme.setOpt({\n\t\t\t'fontfamily': [{\n\t\t\t\tname: 'songti',\n\t\t\t\tval: '宋体,SimSun'\n\t\t\t}, {\n\t\t\t\tname: 'yahei',\n\t\t\t\tval: '微软雅黑,Microsoft YaHei'\n\t\t\t}, {\n\t\t\t\tname: 'kaiti',\n\t\t\t\tval: '楷体,楷体_GB2312, SimKai'\n\t\t\t}, {\n\t\t\t\tname: 'heiti',\n\t\t\t\tval: '黑体, SimHei'\n\t\t\t}, {\n\t\t\t\tname: 'lishu',\n\t\t\t\tval: '隶书, SimLi'\n\t\t\t}, {\n\t\t\t\tname: 'andaleMono',\n\t\t\t\tval: 'andale mono'\n\t\t\t}, {\n\t\t\t\tname: 'arial',\n\t\t\t\tval: 'arial, helvetica,sans-serif'\n\t\t\t}, {\n\t\t\t\tname: 'arialBlack',\n\t\t\t\tval: 'arial black,avant garde'\n\t\t\t}, {\n\t\t\t\tname: 'comicSansMs',\n\t\t\t\tval: 'comic sans ms'\n\t\t\t}, {\n\t\t\t\tname: 'impact',\n\t\t\t\tval: 'impact,chicago'\n\t\t\t}, {\n\t\t\t\tname: 'timesNewRoman',\n\t\t\t\tval: 'times new roman'\n\t\t\t}],\n\t\t\t'fontsize': [10, 11, 12, 14, 16, 18, 20, 24, 36]\n\t\t});\n\n\t\tfunction mergeWithParent(node) {\n\t\t\tvar parent;\n\t\t\twhile (parent = node.parentNode) {\n\t\t\t\tif (parent.tagName == 'SPAN' && domUtils.getChildCount(parent, function(child) {\n\t\t\t\t\t\treturn !domUtils.isBookmarkNode(child) && !domUtils.isBr(child)\n\t\t\t\t\t}) == 1) {\n\t\t\t\t\tparent.style.cssText += node.style.cssText;\n\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t\tnode = parent;\n\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tfunction mergeChild(rng, cmdName, value) {\n\t\t\tif (needSetChild[cmdName]) {\n\t\t\t\trng.adjustmentBoundary();\n\t\t\t\tif (!rng.collapsed && rng.startContainer.nodeType == 1) {\n\t\t\t\t\tvar start = rng.startContainer.childNodes[rng.startOffset];\n\t\t\t\t\tif (start && domUtils.isTagNode(start, 'span')) {\n\t\t\t\t\t\tvar bk = rng.createBookmark();\n\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(start, 'span'), function(span) {\n\t\t\t\t\t\t\tif (!span.parentNode || domUtils.isBookmarkNode(span)) return;\n\t\t\t\t\t\t\tif (cmdName == 'backcolor' && domUtils.getComputedStyle(span, 'background-color').toLowerCase() === value) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.removeStyle(span, needSetChild[cmdName]);\n\t\t\t\t\t\t\tif (span.style.cssText.replace(/^\\s+$/, '').length == 0) {\n\t\t\t\t\t\t\t\tdomUtils.remove(span, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\trng.moveToBookmark(bk)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tfunction mergesibling(rng, cmdName, value) {\n\t\t\tvar collapsed = rng.collapsed,\n\t\t\t\tbk = rng.createBookmark(),\n\t\t\t\tcommon;\n\t\t\tif (collapsed) {\n\t\t\t\tcommon = bk.start.parentNode;\n\t\t\t\twhile (dtd.$inline[common.tagName]) {\n\t\t\t\t\tcommon = common.parentNode;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcommon = domUtils.getCommonAncestor(bk.start, bk.end);\n\t\t\t}\n\t\t\tutils.each(domUtils.getElementsByTagName(common, 'span'), function(span) {\n\t\t\t\tif (!span.parentNode || domUtils.isBookmarkNode(span)) return;\n\t\t\t\tif (/\\s*border\\s*:\\s*none;?\\s*/i.test(span.style.cssText)) {\n\t\t\t\t\tif (/^\\s*border\\s*:\\s*none;?\\s*$/.test(span.style.cssText)) {\n\t\t\t\t\t\tdomUtils.remove(span, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomUtils.removeStyle(span, 'border');\n\t\t\t\t\t}\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tif (/border/i.test(span.style.cssText) && span.parentNode.tagName == 'SPAN' && /border/i.test(span.parentNode.style.cssText)) {\n\t\t\t\t\tspan.style.cssText = span.style.cssText.replace(/border[^:]*:[^;]+;?/gi, '');\n\t\t\t\t}\n\t\t\t\tif (!(cmdName == 'fontborder' && value == 'none')) {\n\t\t\t\t\tvar next = span.nextSibling;\n\t\t\t\t\twhile (next && next.nodeType == 1 && next.tagName == 'SPAN') {\n\t\t\t\t\t\tif (domUtils.isBookmarkNode(next) && cmdName == 'fontborder') {\n\t\t\t\t\t\t\tspan.appendChild(next);\n\t\t\t\t\t\t\tnext = span.nextSibling;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (next.style.cssText == span.style.cssText) {\n\t\t\t\t\t\t\tdomUtils.moveChild(next, span);\n\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (span.nextSibling === next)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tnext = span.nextSibling;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tmergeWithParent(span);\n\t\t\t\tif (browser.ie && browser.version > 8) {\n\t\t\t\t\t//拷贝父亲们的特别的属性,这里只做背景颜色的处理\n\t\t\t\t\tvar parent = domUtils.findParent(span, function(n) {\n\t\t\t\t\t\treturn n.tagName == 'SPAN' && /background-color/.test(n.style.cssText)\n\t\t\t\t\t});\n\t\t\t\t\tif (parent && !/background-color/.test(span.style.cssText)) {\n\t\t\t\t\t\tspan.style.backgroundColor = parent.style.backgroundColor;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\trng.moveToBookmark(bk);\n\t\t\tmergeChild(rng, cmdName, value)\n\t\t}\n\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('u s del font strike'), function(node) {\n\t\t\t\tif (node.tagName == 'font') {\n\t\t\t\t\tvar cssStyle = [];\n\t\t\t\t\tfor (var p in node.attrs) {\n\t\t\t\t\t\tswitch (p) {\n\t\t\t\t\t\t\tcase 'size':\n\t\t\t\t\t\t\t\tcssStyle.push('font-size:' +\n\t\t\t\t\t\t\t\t\t({\n\t\t\t\t\t\t\t\t\t\t'1': '10',\n\t\t\t\t\t\t\t\t\t\t'2': '12',\n\t\t\t\t\t\t\t\t\t\t'3': '16',\n\t\t\t\t\t\t\t\t\t\t'4': '18',\n\t\t\t\t\t\t\t\t\t\t'5': '24',\n\t\t\t\t\t\t\t\t\t\t'6': '32',\n\t\t\t\t\t\t\t\t\t\t'7': '48'\n\t\t\t\t\t\t\t\t\t}[node.attrs[p]] || node.attrs[p]) + 'px');\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'color':\n\t\t\t\t\t\t\t\tcssStyle.push('color:' + node.attrs[p]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'face':\n\t\t\t\t\t\t\t\tcssStyle.push('font-family:' + node.attrs[p]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 'style':\n\t\t\t\t\t\t\t\tcssStyle.push(node.attrs[p]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tnode.attrs = {\n\t\t\t\t\t\t'style': cssStyle.join(';')\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tvar val = node.tagName == 'u' ? 'underline' : 'line-through';\n\t\t\t\t\tnode.attrs = {\n\t\t\t\t\t\t'style': (node.getAttr('style') || '') + 'text-decoration:' + val + ';'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnode.tagName = 'span';\n\t\t\t});\n\t\t\t//        utils.each(root.getNodesByTagName('span'), function (node) {\n\t\t\t//            var val;\n\t\t\t//            if(val = node.getAttr('class')){\n\t\t\t//                if(/fontstrikethrough/.test(val)){\n\t\t\t//                    node.setStyle('text-decoration','line-through');\n\t\t\t//                    if(node.attrs['class']){\n\t\t\t//                        node.attrs['class'] = node.attrs['class'].replace(/fontstrikethrough/,'');\n\t\t\t//                    }else{\n\t\t\t//                        node.setAttr('class')\n\t\t\t//                    }\n\t\t\t//                }\n\t\t\t//                if(/fontborder/.test(val)){\n\t\t\t//                    node.setStyle('border','1px solid #000');\n\t\t\t//                    if(node.attrs['class']){\n\t\t\t//                        node.attrs['class'] = node.attrs['class'].replace(/fontborder/,'');\n\t\t\t//                    }else{\n\t\t\t//                        node.setAttr('class')\n\t\t\t//                    }\n\t\t\t//                }\n\t\t\t//            }\n\t\t\t//        });\n\t\t});\n\t\t//    me.addOutputRule(function(root){\n\t\t//        utils.each(root.getNodesByTagName('span'), function (node) {\n\t\t//            var val;\n\t\t//            if(val = node.getStyle('text-decoration')){\n\t\t//                if(/line-through/.test(val)){\n\t\t//                    if(node.attrs['class']){\n\t\t//                        node.attrs['class'] += ' fontstrikethrough';\n\t\t//                    }else{\n\t\t//                        node.setAttr('class','fontstrikethrough')\n\t\t//                    }\n\t\t//                }\n\t\t//\n\t\t//                node.setStyle('text-decoration')\n\t\t//            }\n\t\t//            if(val = node.getStyle('border')){\n\t\t//                if(/1px/.test(val) && /solid/.test(val)){\n\t\t//                    if(node.attrs['class']){\n\t\t//                        node.attrs['class'] += ' fontborder';\n\t\t//\n\t\t//                    }else{\n\t\t//                        node.setAttr('class','fontborder')\n\t\t//                    }\n\t\t//                }\n\t\t//                node.setStyle('border')\n\t\t//\n\t\t//            }\n\t\t//        });\n\t\t//    });\n\t\tfor (var p in fonts) {\n\t\t\t(function(cmd, style) {\n\t\t\t\tUE.commands[cmd] = {\n\t\t\t\t\texecCommand: function(cmdName, value) {\n\t\t\t\t\t\tvalue = value || (this.queryCommandState(cmdName) ? 'none' : cmdName == 'underline' ? 'underline' :\n\t\t\t\t\t\t\tcmdName == 'fontborder' ? '1px solid #000' :\n\t\t\t\t\t\t\t'line-through');\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = this.selection.getRange(),\n\t\t\t\t\t\t\ttext;\n\n\t\t\t\t\t\tif (value == 'default') {\n\n\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\ttext = me.document.createTextNode('font');\n\t\t\t\t\t\t\t\trange.insertNode(text).select();\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\tif (text) {\n\t\t\t\t\t\t\t\trange.setStartBefore(text).collapse(true);\n\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\trange.select()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\t\tif (needCmd[cmd] && me.queryCommandValue(cmd)) {\n\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange = me.selection.getRange();\n\n\t\t\t\t\t\t\t\trange.applyInlineStyle('span', {\n\t\t\t\t\t\t\t\t\t'style': style + ':' + value\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tvar span = domUtils.findParentByTagName(range.startContainer, 'span', true);\n\t\t\t\t\t\t\t\ttext = me.document.createTextNode('font');\n\t\t\t\t\t\t\t\tif (span && !span.children.length && !span[browser.ie ? 'innerText' : 'textContent'].replace(fillCharReg, '').length) {\n\t\t\t\t\t\t\t\t\t//for ie hack when enter\n\t\t\t\t\t\t\t\t\trange.insertNode(text);\n\t\t\t\t\t\t\t\t\tif (needCmd[cmd]) {\n\t\t\t\t\t\t\t\t\t\trange.selectNode(text).select();\n\t\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style, null);\n\n\t\t\t\t\t\t\t\t\t\tspan = domUtils.findParentByTagName(text, 'span', true);\n\t\t\t\t\t\t\t\t\t\trange.setStartBefore(text);\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tspan && (span.style.cssText += ';' + style + ':' + value);\n\t\t\t\t\t\t\t\t\trange.collapse(true).select();\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.insertNode(text);\n\t\t\t\t\t\t\t\t\trange.selectNode(text).select();\n\t\t\t\t\t\t\t\t\tspan = range.document.createElement('span');\n\n\t\t\t\t\t\t\t\t\tif (needCmd[cmd]) {\n\t\t\t\t\t\t\t\t\t\t//a标签内的不处理跳过\n\t\t\t\t\t\t\t\t\t\tif (domUtils.findParentByTagName(text, 'a', true)) {\n\t\t\t\t\t\t\t\t\t\t\trange.setStartBefore(text).setCursor();\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tme.execCommand('removeFormat', 'span,a', style);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tspan.style.cssText = style + ':' + value;\n\n\t\t\t\t\t\t\t\t\ttext.parentNode.insertBefore(span, text);\n\t\t\t\t\t\t\t\t\t//修复，span套span 但样式不继承的问题\n\t\t\t\t\t\t\t\t\tif (!browser.ie || browser.ie && browser.version == 9) {\n\t\t\t\t\t\t\t\t\t\tvar spanParent = span.parentNode;\n\t\t\t\t\t\t\t\t\t\twhile (!domUtils.isBlockElm(spanParent)) {\n\t\t\t\t\t\t\t\t\t\t\tif (spanParent.tagName == 'SPAN') {\n\t\t\t\t\t\t\t\t\t\t\t\t//opera合并style不会加入\";\"\n\t\t\t\t\t\t\t\t\t\t\t\tspan.style.cssText = spanParent.style.cssText + \";\" + span.style.cssText;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tspanParent = spanParent.parentNode;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (opera) {\n\t\t\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\t\t\trange.setStart(span, 0).collapse(true);\n\t\t\t\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\trange.setStart(span, 0).collapse(true);\n\t\t\t\t\t\t\t\t\t\tmergesibling(range, cmdName, value);\n\t\t\t\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t//trace:981\n\t\t\t\t\t\t\t\t\t//domUtils.mergeToParent(span)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(text);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandValue: function(cmdName) {\n\t\t\t\t\t\tvar startNode = this.selection.getStart();\n\n\t\t\t\t\t\t//trace:946\n\t\t\t\t\t\tif (cmdName == 'underline' || cmdName == 'strikethrough') {\n\t\t\t\t\t\t\tvar tmpNode = startNode,\n\t\t\t\t\t\t\t\tvalue;\n\t\t\t\t\t\t\twhile (tmpNode && !domUtils.isBlockElm(tmpNode) && !domUtils.isBody(tmpNode)) {\n\t\t\t\t\t\t\t\tif (tmpNode.nodeType == 1) {\n\t\t\t\t\t\t\t\t\tvalue = domUtils.getComputedStyle(tmpNode, style);\n\t\t\t\t\t\t\t\t\tif (value != 'none') {\n\t\t\t\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\ttmpNode = tmpNode.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 'none';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (cmdName == 'fontborder') {\n\t\t\t\t\t\t\tvar tmp = startNode,\n\t\t\t\t\t\t\t\tval;\n\t\t\t\t\t\t\twhile (tmp && dtd.$inline[tmp.tagName]) {\n\t\t\t\t\t\t\t\tif (val = domUtils.getComputedStyle(tmp, 'border')) {\n\n\t\t\t\t\t\t\t\t\tif (/1px/.test(val) && /solid/.test(val)) {\n\t\t\t\t\t\t\t\t\t\treturn val;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmp = tmp.parentNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn ''\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (cmdName == 'FontSize') {\n\t\t\t\t\t\t\tvar styleVal = domUtils.getComputedStyle(startNode, style),\n\t\t\t\t\t\t\t\ttmp = /^([\\d\\.]+)(\\w+)$/.exec(styleVal);\n\n\t\t\t\t\t\t\tif (tmp) {\n\n\t\t\t\t\t\t\t\treturn Math.floor(tmp[1]) + tmp[2];\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn styleVal;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn domUtils.getComputedStyle(startNode, style);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\t\t\tif (!needCmd[cmdName])\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\tvar val = this.queryCommandValue(cmdName);\n\t\t\t\t\t\tif (cmdName == 'fontborder') {\n\t\t\t\t\t\t\treturn /1px/.test(val) && /solid/.test(val)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn cmdName == 'underline' ? /underline/.test(val) : /line\\-through/.test(val);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t})(p, fonts[p]);\n\t\t}\n\t};\n\n\t// plugins/link.js\n\t/**\n\t * 超链接\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入超链接\n\t * @command link\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { Object } options   设置自定义属性，例如：url、title、target\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'link', '{\n\t *     url:'ueditor.baidu.com',\n\t *     title:'ueditor',\n\t *     target:'_blank'\n\t * }' );\n\t * ```\n\t */\n\t/**\n\t * 返回当前选中的第一个超链接节点\n\t * @command link\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { Element } 超链接节点\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'link' );\n\t * ```\n\t */\n\n\t/**\n\t * 取消超链接\n\t * @command unlink\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'unlink');\n\t * ```\n\t */\n\n\tUE.plugins['link'] = function() {\n\t\tfunction optimize(range) {\n\t\t\tvar start = range.startContainer,\n\t\t\t\tend = range.endContainer;\n\n\t\t\tif (start = domUtils.findParentByTagName(start, 'a', true)) {\n\t\t\t\trange.setStartBefore(start);\n\t\t\t}\n\t\t\tif (end = domUtils.findParentByTagName(end, 'a', true)) {\n\t\t\t\trange.setEndAfter(end);\n\t\t\t}\n\t\t}\n\n\t\tUE.commands['unlink'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tbookmark;\n\t\t\t\tif (range.collapsed && !domUtils.findParentByTagName(range.startContainer, 'a', true)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tbookmark = range.createBookmark();\n\t\t\t\toptimize(range);\n\t\t\t\trange.removeInlineStyle('a').moveToBookmark(bookmark).select();\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn !this.highlight && this.queryCommandValue('link') ? 0 : -1;\n\t\t\t}\n\n\t\t};\n\n\t\tfunction doLink(range, opt, me) {\n\t\t\tvar rngClone = range.cloneRange(),\n\t\t\t\tlink = me.queryCommandValue('link');\n\t\t\toptimize(range = range.adjustmentBoundary());\n\t\t\tvar start = range.startContainer;\n\t\t\tif (start.nodeType == 1 && link) {\n\t\t\t\tstart = start.childNodes[range.startOffset];\n\t\t\t\tif (start && start.nodeType == 1 && start.tagName == 'A' && /^(?:https?|ftp|file)\\s*:\\s*\\/\\//.test(start[browser.ie ? 'innerText' : 'textContent'])) {\n\t\t\t\t\tstart[browser.ie ? 'innerText' : 'textContent'] = utils.html(opt.textValue || opt.href);\n\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!rngClone.collapsed || link) {\n\t\t\t\trange.removeInlineStyle('a');\n\t\t\t\trngClone = range.cloneRange();\n\t\t\t}\n\n\t\t\tif (rngClone.collapsed) {\n\t\t\t\tvar a = range.document.createElement('a'),\n\t\t\t\t\ttext = '';\n\t\t\t\tif (opt.textValue) {\n\n\t\t\t\t\ttext = utils.html(opt.textValue);\n\t\t\t\t\tdelete opt.textValue;\n\t\t\t\t} else {\n\t\t\t\t\ttext = utils.html(opt.href);\n\n\t\t\t\t}\n\t\t\t\tdomUtils.setAttributes(a, opt);\n\t\t\t\tstart = domUtils.findParentByTagName(rngClone.startContainer, 'a', true);\n\t\t\t\tif (start && domUtils.isInNodeEndBoundary(rngClone, start)) {\n\t\t\t\t\trange.setStartAfter(start).collapse(true);\n\n\t\t\t\t}\n\t\t\t\ta[browser.ie ? 'innerText' : 'textContent'] = text;\n\t\t\t\trange.insertNode(a).selectNode(a);\n\t\t\t} else {\n\t\t\t\trange.applyInlineStyle('a', opt);\n\n\t\t\t}\n\t\t}\n\t\tUE.commands['link'] = {\n\t\t\texecCommand: function(cmdName, opt) {\n\t\t\t\tvar range;\n\t\t\t\topt._href && (opt._href = utils.unhtml(opt._href, /[<\">]/g));\n\t\t\t\topt.href && (opt.href = utils.unhtml(opt.href, /[<\">]/g));\n\t\t\t\topt.textValue && (opt.textValue = utils.unhtml(opt.textValue, /[<\">]/g));\n\t\t\t\tdoLink(range = this.selection.getRange(), opt, this);\n\t\t\t\t//闭合都不加占位符，如果加了会在a后边多个占位符节点，导致a是图片背景组成的列表，出现空白问题\n\t\t\t\trange.collapse().select(true);\n\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tnode;\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t//                    node = this.selection.getStart();\n\t\t\t\t\t//在ie下getstart()取值偏上了\n\t\t\t\t\tnode = range.startContainer;\n\t\t\t\t\tnode = node.nodeType == 1 ? node : node.parentNode;\n\n\t\t\t\t\tif (node && (node = domUtils.findParentByTagName(node, 'a', true)) && !domUtils.isInNodeEndBoundary(range, node)) {\n\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t//trace:1111  如果是<p><a>xx</a></p> startContainer是p就会找不到a\n\t\t\t\t\trange.shrinkBoundary();\n\t\t\t\t\tvar start = range.startContainer.nodeType == 3 || !range.startContainer.childNodes[range.startOffset] ? range.startContainer : range.startContainer.childNodes[range.startOffset],\n\t\t\t\t\t\tend = range.endContainer.nodeType == 3 || range.endOffset == 0 ? range.endContainer : range.endContainer.childNodes[range.endOffset - 1],\n\t\t\t\t\t\tcommon = range.getCommonAncestor();\n\t\t\t\t\tnode = domUtils.findParentByTagName(common, 'a', true);\n\t\t\t\t\tif (!node && common.nodeType == 1) {\n\n\t\t\t\t\t\tvar as = common.getElementsByTagName('a'),\n\t\t\t\t\t\t\tps, pe;\n\n\t\t\t\t\t\tfor (var i = 0, ci; ci = as[i++];) {\n\t\t\t\t\t\t\tps = domUtils.getPosition(ci, start), pe = domUtils.getPosition(ci, end);\n\t\t\t\t\t\t\tif ((ps & domUtils.POSITION_FOLLOWING || ps & domUtils.POSITION_CONTAINS) &&\n\t\t\t\t\t\t\t\t(pe & domUtils.POSITION_PRECEDING || pe & domUtils.POSITION_CONTAINS)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tnode = ci;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\t//判断如果是视频的话连接不可用\n\t\t\t\t//fix 853\n\t\t\t\tvar img = this.selection.getRange().getClosedNode(),\n\t\t\t\t\tflag = img && (img.className == \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1);\n\t\t\t\treturn flag ? -1 : 0;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/iframe.js\n\t///import core\n\t///import plugins\\inserthtml.js\n\t///commands 插入框架\n\t///commandsName  InsertFrame\n\t///commandsTitle  插入Iframe\n\t///commandsDialog  dialogs\\insertframe\n\n\tUE.plugins['insertframe'] = function() {\n\t\tvar me = this;\n\n\t\tfunction deleteIframe() {\n\t\t\tme._iframe && delete me._iframe;\n\t\t}\n\n\t\tme.addListener(\"selectionchange\", function() {\n\t\t\tdeleteIframe();\n\t\t});\n\n\t};\n\n\t// plugins/scrawl.js\n\t///import core\n\t///commands 涂鸦\n\t///commandsName  Scrawl\n\t///commandsTitle  涂鸦\n\t///commandsDialog  dialogs\\scrawl\n\tUE.commands['scrawl'] = {\n\t\tqueryCommandState: function() {\n\t\t\treturn (browser.ie && browser.version <= 8) ? -1 : 0;\n\t\t}\n\t};\n\n\t// plugins/removeformat.js\n\t/**\n\t * 清除格式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 清除文字样式\n\t * @command removeformat\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param   {String}   tags     以逗号隔开的标签。如：strong\n\t * @param   {String}   style    样式如：color\n\t * @param   {String}   attrs    属性如:width\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'removeformat', 'strong','color','width' );\n\t * ```\n\t */\n\n\tUE.plugins['removeformat'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'removeFormatTags': 'b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var',\n\t\t\t'removeFormatAttributes': 'class,style,lang,width,height,align,hspace,valign'\n\t\t});\n\t\tme.commands['removeformat'] = {\n\t\t\texecCommand: function(cmdName, tags, style, attrs, notIncludeA) {\n\n\t\t\t\tvar tagReg = new RegExp('^(?:' + (tags || this.options.removeFormatTags).replace(/,/g, '|') + ')$', 'i'),\n\t\t\t\t\tremoveFormatAttributes = style ? [] : (attrs || this.options.removeFormatAttributes).split(','),\n\t\t\t\t\trange = new dom.Range(this.document),\n\t\t\t\t\tbookmark, node, parent,\n\t\t\t\t\tfilter = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1;\n\t\t\t\t\t};\n\n\t\t\t\tfunction isRedundantSpan(node) {\n\t\t\t\t\tif (node.nodeType == 3 || node.tagName.toLowerCase() != 'span') {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t//ie 下判断实效，所以只能简单用style来判断\n\t\t\t\t\t\t//return node.style.cssText == '' ? 1 : 0;\n\t\t\t\t\t\tvar attrs = node.attributes;\n\t\t\t\t\t\tif (attrs.length) {\n\t\t\t\t\t\t\tfor (var i = 0, l = attrs.length; i < l; i++) {\n\t\t\t\t\t\t\t\tif (attrs[i].specified) {\n\t\t\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn !node.attributes.length;\n\t\t\t\t}\n\n\t\t\t\tfunction doRemove(range) {\n\n\t\t\t\t\tvar bookmark1 = range.createBookmark();\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\t}\n\n\t\t\t\t\t//不能把a标签切了\n\t\t\t\t\tif (!notIncludeA) {\n\t\t\t\t\t\tvar aNode = domUtils.findParentByTagName(range.startContainer, 'a', true);\n\t\t\t\t\t\tif (aNode) {\n\t\t\t\t\t\t\trange.setStartBefore(aNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\taNode = domUtils.findParentByTagName(range.endContainer, 'a', true);\n\t\t\t\t\t\tif (aNode) {\n\t\t\t\t\t\t\trange.setEndAfter(aNode);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbookmark = range.createBookmark();\n\n\t\t\t\t\tnode = bookmark.start;\n\n\t\t\t\t\t//切开始\n\t\t\t\t\twhile ((parent = node.parentNode) && !domUtils.isBlockElm(parent)) {\n\t\t\t\t\t\tdomUtils.breakParent(node, parent);\n\n\t\t\t\t\t\tdomUtils.clearEmptySibling(node);\n\t\t\t\t\t}\n\t\t\t\t\tif (bookmark.end) {\n\t\t\t\t\t\t//切结束\n\t\t\t\t\t\tnode = bookmark.end;\n\t\t\t\t\t\twhile ((parent = node.parentNode) && !domUtils.isBlockElm(parent)) {\n\t\t\t\t\t\t\tdomUtils.breakParent(node, parent);\n\t\t\t\t\t\t\tdomUtils.clearEmptySibling(node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//开始去除样式\n\t\t\t\t\t\tvar current = domUtils.getNextDomNode(bookmark.start, false, filter),\n\t\t\t\t\t\t\tnext;\n\t\t\t\t\t\twhile (current) {\n\t\t\t\t\t\t\tif (current == bookmark.end) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tnext = domUtils.getNextDomNode(current, true, filter);\n\n\t\t\t\t\t\t\tif (!dtd.$empty[current.tagName.toLowerCase()] && !domUtils.isBookmarkNode(current)) {\n\t\t\t\t\t\t\t\tif (tagReg.test(current.tagName)) {\n\t\t\t\t\t\t\t\t\tif (style) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.removeStyle(current, style);\n\t\t\t\t\t\t\t\t\t\tif (isRedundantSpan(current) && style != 'text-decoration') {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t//trace:939  不能把list上的样式去掉\n\t\t\t\t\t\t\t\t\tif (!dtd.$tableContent[current.tagName] && !dtd.$list[current.tagName]) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(current, removeFormatAttributes);\n\t\t\t\t\t\t\t\t\t\tif (isRedundantSpan(current)) {\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(current, true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcurrent = next;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//trace:1035\n\t\t\t\t\t//trace:1096 不能把td上的样式去掉，比如边框\n\t\t\t\t\tvar pN = bookmark.start.parentNode;\n\t\t\t\t\tif (domUtils.isBlockElm(pN) && !dtd.$tableContent[pN.tagName] && !dtd.$list[pN.tagName]) {\n\t\t\t\t\t\tdomUtils.removeAttributes(pN, removeFormatAttributes);\n\t\t\t\t\t}\n\t\t\t\t\tpN = bookmark.end.parentNode;\n\t\t\t\t\tif (bookmark.end && domUtils.isBlockElm(pN) && !dtd.$tableContent[pN.tagName] && !dtd.$list[pN.tagName]) {\n\t\t\t\t\t\tdomUtils.removeAttributes(pN, removeFormatAttributes);\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bookmark).moveToBookmark(bookmark1);\n\t\t\t\t\t//清除冗余的代码 <b><bookmark></b>\n\t\t\t\t\tvar node = range.startContainer,\n\t\t\t\t\t\ttmp,\n\t\t\t\t\t\tcollapsed = range.collapsed;\n\t\t\t\t\twhile (node.nodeType == 1 && domUtils.isEmptyNode(node) && dtd.$removeEmpty[node.tagName]) {\n\t\t\t\t\t\ttmp = node.parentNode;\n\t\t\t\t\t\trange.setStartBefore(node);\n\t\t\t\t\t\t//trace:937\n\t\t\t\t\t\t//更新结束边界\n\t\t\t\t\t\tif (range.startContainer === range.endContainer) {\n\t\t\t\t\t\t\trange.endOffset--;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!collapsed) {\n\t\t\t\t\t\tnode = range.endContainer;\n\t\t\t\t\t\twhile (node.nodeType == 1 && domUtils.isEmptyNode(node) && dtd.$removeEmpty[node.tagName]) {\n\t\t\t\t\t\t\ttmp = node.parentNode;\n\t\t\t\t\t\t\trange.setEndBefore(node);\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\n\t\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trange = this.selection.getRange();\n\t\t\t\tdoRemove(range);\n\t\t\t\trange.select();\n\n\t\t\t}\n\n\t\t};\n\n\t};\n\n\t// plugins/blockquote.js\n\t/**\n\t * 添加引用\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 添加引用\n\t * @command blockquote\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'blockquote' );\n\t * ```\n\t */\n\n\t/**\n\t * 添加引用\n\t * @command blockquote\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { Object } attrs 节点属性\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'blockquote',{\n\t *     style: \"color: red;\"\n\t * } );\n\t * ```\n\t */\n\n\tUE.plugins['blockquote'] = function() {\n\t\tvar me = this;\n\n\t\tfunction getObj(editor) {\n\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), 'blockquote');\n\t\t}\n\t\tme.commands['blockquote'] = {\n\t\t\texecCommand: function(cmdName, attrs) {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tobj = getObj(this),\n\t\t\t\t\tblockquote = dtd.blockquote,\n\t\t\t\t\tbookmark = range.createBookmark();\n\n\t\t\t\tif (obj) {\n\n\t\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\t\tstartBlock = domUtils.isBlockElm(start) ? start : domUtils.findParent(start, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t}),\n\n\t\t\t\t\t\tend = range.endContainer,\n\t\t\t\t\t\tendBlock = domUtils.isBlockElm(end) ? end : domUtils.findParent(end, function(node) {\n\t\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t\t});\n\n\t\t\t\t\t//处理一下li\n\t\t\t\t\tstartBlock = domUtils.findParentByTagName(startBlock, 'li', true) || startBlock;\n\t\t\t\t\tendBlock = domUtils.findParentByTagName(endBlock, 'li', true) || endBlock;\n\n\t\t\t\t\tif (startBlock.tagName == 'LI' || startBlock.tagName == 'TD' || startBlock === obj || domUtils.isBody(startBlock)) {\n\t\t\t\t\t\tdomUtils.remove(obj, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomUtils.breakParent(startBlock, obj);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (startBlock !== endBlock) {\n\t\t\t\t\t\tobj = domUtils.findParentByTagName(endBlock, 'blockquote');\n\t\t\t\t\t\tif (obj) {\n\t\t\t\t\t\t\tif (endBlock.tagName == 'LI' || endBlock.tagName == 'TD' || domUtils.isBody(endBlock)) {\n\t\t\t\t\t\t\t\tobj.parentNode && domUtils.remove(obj, true);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.breakParent(endBlock, obj);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar blockquotes = domUtils.getElementsByTagName(this.document, 'blockquote');\n\t\t\t\t\tfor (var i = 0, bi; bi = blockquotes[i++];) {\n\t\t\t\t\t\tif (!bi.childNodes.length) {\n\t\t\t\t\t\t\tdomUtils.remove(bi);\n\t\t\t\t\t\t} else if (domUtils.getPosition(bi, startBlock) & domUtils.POSITION_FOLLOWING && domUtils.getPosition(bi, endBlock) & domUtils.POSITION_PRECEDING) {\n\t\t\t\t\t\t\tdomUtils.remove(bi, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\t\t\tnode = tmpRange.startContainer.nodeType == 1 ? tmpRange.startContainer : tmpRange.startContainer.parentNode,\n\t\t\t\t\t\tpreNode = node,\n\t\t\t\t\t\tdoEnd = 1;\n\n\t\t\t\t\t//调整开始\n\t\t\t\t\twhile (1) {\n\t\t\t\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\t\t\t\tif (preNode !== node) {\n\t\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\t\ttmpRange.selectNode(preNode);\n\t\t\t\t\t\t\t\t\tdoEnd = 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpRange.setStartBefore(preNode);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttmpRange.setStart(node, 0);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!blockquote[node.tagName]) {\n\t\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\t\ttmpRange.selectNode(preNode);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttmpRange.setStartBefore(preNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tpreNode = node;\n\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t}\n\n\t\t\t\t\t//调整结束\n\t\t\t\t\tif (doEnd) {\n\t\t\t\t\t\tpreNode = node = node = tmpRange.endContainer.nodeType == 1 ? tmpRange.endContainer : tmpRange.endContainer.parentNode;\n\t\t\t\t\t\twhile (1) {\n\n\t\t\t\t\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\t\t\t\t\tif (preNode !== node) {\n\n\t\t\t\t\t\t\t\t\ttmpRange.setEndAfter(preNode);\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpRange.setEnd(node, node.childNodes.length);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!blockquote[node.tagName]) {\n\t\t\t\t\t\t\t\ttmpRange.setEndAfter(preNode);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tpreNode = node;\n\t\t\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tnode = range.document.createElement('blockquote');\n\t\t\t\t\tdomUtils.setAttributes(node, attrs);\n\t\t\t\t\tnode.appendChild(tmpRange.extractContents());\n\t\t\t\t\ttmpRange.insertNode(node);\n\t\t\t\t\t//去除重复的\n\t\t\t\t\tvar childs = domUtils.getElementsByTagName(node, 'blockquote');\n\t\t\t\t\tfor (var i = 0, ci; ci = childs[i++];) {\n\t\t\t\t\t\tif (ci.parentNode) {\n\t\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\trange.moveToBookmark(bookmark).select();\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getObj(this) ? 1 : 0;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/convertcase.js\n\t/**\n\t * 大小写转换\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 把选区内文本变大写，与“tolowercase”命令互斥\n\t * @command touppercase\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'touppercase' );\n\t * ```\n\t */\n\n\t/**\n\t * 把选区内文本变小写，与“touppercase”命令互斥\n\t * @command tolowercase\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'tolowercase' );\n\t * ```\n\t */\n\tUE.commands['touppercase'] =\n\t\tUE.commands['tolowercase'] = {\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\treturn rng;\n\t\t\t\t}\n\t\t\t\tvar bk = rng.createBookmark(),\n\t\t\t\t\tbkEnd = bk.end,\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn !domUtils.isBr(node) && !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\t\t\t\t\tcurNode = domUtils.getNextDomNode(bk.start, false, filterFn);\n\t\t\t\twhile (curNode && (domUtils.getPosition(curNode, bkEnd) & domUtils.POSITION_PRECEDING)) {\n\n\t\t\t\t\tif (curNode.nodeType == 3) {\n\t\t\t\t\t\tcurNode.nodeValue = curNode.nodeValue[cmd == 'touppercase' ? 'toUpperCase' : 'toLowerCase']();\n\t\t\t\t\t}\n\t\t\t\t\tcurNode = domUtils.getNextDomNode(curNode, true, filterFn);\n\t\t\t\t\tif (curNode === bkEnd) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\n\t// plugins/indent.js\n\t/**\n\t * 首行缩进\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 缩进\n\t * @command indent\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'indent' );\n\t * ```\n\t */\n\tUE.commands['indent'] = {\n\t\texecCommand: function() {\n\t\t\tvar me = this,\n\t\t\t\tvalue = me.queryCommandState(\"indent\") ? \"0em\" : (me.options.indentValue || '2em');\n\t\t\tme.execCommand('Paragraph', 'p', {\n\t\t\t\tstyle: 'text-indent:' + value\n\t\t\t});\n\t\t},\n\t\tqueryCommandState: function() {\n\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), 'p h1 h2 h3 h4 h5 h6');\n\t\t\treturn pN && pN.style.textIndent && parseInt(pN.style.textIndent) ? 1 : 0;\n\t\t}\n\n\t};\n\n\t// plugins/print.js\n\t/**\n\t * 打印\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 打印\n\t * @command print\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'print' );\n\t * ```\n\t */\n\tUE.commands['print'] = {\n\t\texecCommand: function() {\n\t\t\tthis.window.print();\n\t\t},\n\t\tnotNeedUndo: 1\n\t};\n\n\t// plugins/preview.js\n\t/**\n\t * 预览\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 预览\n\t * @command preview\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'preview' );\n\t * ```\n\t */\n\tUE.commands['preview'] = {\n\t\texecCommand: function() {\n\t\t\tvar w = window.open('', '_blank', ''),\n\t\t\t\td = w.document;\n\t\t\td.open();\n\t\t\td.write('<!DOCTYPE html><html><head><meta charset=\"utf-8\"/><script src=\"' + this.options.UEDITOR_HOME_URL + 'ueditor.parse.js\"></script><script>' +\n\t\t\t\t\"setTimeout(function(){uParse('div',{rootPath: '\" + this.options.UEDITOR_HOME_URL + \"'})},300)\" +\n\t\t\t\t'</script></head><body><div>' + this.getContent(null, null, true) + '</div></body></html>');\n\t\t\td.close();\n\t\t},\n\t\tnotNeedUndo: 1\n\t};\n\n\t// plugins/selectall.js\n\t/**\n\t * 全选\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 选中所有内容\n\t * @command selectall\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'selectall' );\n\t * ```\n\t */\n\tUE.plugins['selectall'] = function() {\n\t\tvar me = this;\n\t\tme.commands['selectall'] = {\n\t\t\texecCommand: function() {\n\t\t\t\t//去掉了原生的selectAll,因为会出现报错和当内容为空时，不能出现闭合状态的光标\n\t\t\t\tvar me = this,\n\t\t\t\t\tbody = me.body,\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\trange.selectNodeContents(body);\n\t\t\t\tif (domUtils.isEmptyBlock(body)) {\n\t\t\t\t\t//opera不能自动合并到元素的里边，要手动处理一下\n\t\t\t\t\tif (browser.opera && body.firstChild && body.firstChild.nodeType == 1) {\n\t\t\t\t\t\trange.setStartAtFirst(body.firstChild);\n\t\t\t\t\t}\n\t\t\t\t\trange.collapse(true);\n\t\t\t\t}\n\t\t\t\trange.select(true);\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\n\t\t//快捷键\n\t\tme.addshortcutkey({\n\t\t\t\"selectAll\": \"ctrl+65\"\n\t\t});\n\t};\n\n\t// plugins/paragraph.js\n\t/**\n\t * 段落样式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 段落格式\n\t * @command paragraph\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param {String}   style               标签值为：'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'\n\t * @param {Object}   attrs               标签的属性\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'Paragraph','h1','{\n\t *     class:'test'\n\t * }' );\n\t * ```\n\t */\n\n\t/**\n\t * 返回选区内节点标签名\n\t * @command paragraph\n\t * @method queryCommandValue\n\t * @param { String } cmd 命令字符串\n\t * @return { String } 节点标签名\n\t * @example\n\t * ```javascript\n\t * editor.queryCommandValue( 'Paragraph' );\n\t * ```\n\t */\n\n\tUE.plugins['paragraph'] = function() {\n\t\tvar me = this,\n\t\t\tblock = domUtils.isBlockElm,\n\t\t\tnotExchange = ['TD', 'LI', 'PRE'],\n\n\t\t\tdoParagraph = function(range, style, attrs, sourceCmdName) {\n\t\t\t\tvar bookmark = range.createBookmark(),\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\t\t\t\t\tpara;\n\n\t\t\t\trange.enlarge(true);\n\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\ttmpNode;\n\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\n\t\t\t\t\t\tpara = range.document.createElement(style);\n\t\t\t\t\t\tif (attrs) {\n\t\t\t\t\t\t\tdomUtils.setAttributes(para, attrs);\n\t\t\t\t\t\t\tif (sourceCmdName && sourceCmdName == 'customstyle' && attrs.style) {\n\t\t\t\t\t\t\t\tpara.style.cssText = attrs.style;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpara.appendChild(tmpRange.extractContents());\n\t\t\t\t\t\t//需要内容占位\n\t\t\t\t\t\tif (domUtils.isEmptyNode(para)) {\n\t\t\t\t\t\t\tdomUtils.fillChar(range.document, para);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttmpRange.insertNode(para);\n\n\t\t\t\t\t\tvar parent = para.parentNode;\n\t\t\t\t\t\t//如果para上一级是一个block元素且不是body,td就删除它\n\t\t\t\t\t\tif (block(parent) && !domUtils.isBody(para.parentNode) && utils.indexOf(notExchange, parent.tagName) == -1) {\n\t\t\t\t\t\t\t//存储dir,style\n\t\t\t\t\t\t\tif (!(sourceCmdName && sourceCmdName == 'customstyle')) {\n\t\t\t\t\t\t\t\tparent.getAttribute('dir') && para.setAttribute('dir', parent.getAttribute('dir'));\n\t\t\t\t\t\t\t\t//trace:1070\n\t\t\t\t\t\t\t\tparent.style.cssText && (para.style.cssText = parent.style.cssText + ';' + para.style.cssText);\n\t\t\t\t\t\t\t\t//trace:1030\n\t\t\t\t\t\t\t\tparent.style.textAlign && !para.style.textAlign && (para.style.textAlign = parent.style.textAlign);\n\t\t\t\t\t\t\t\tparent.style.textIndent && !para.style.textIndent && (para.style.textIndent = parent.style.textIndent);\n\t\t\t\t\t\t\t\tparent.style.padding && !para.style.padding && (para.style.padding = parent.style.padding);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//trace:1706 选择的就是h1-6要删除\n\t\t\t\t\t\t\tif (attrs && /h\\d/i.test(parent.tagName) && !/h\\d/i.test(para.tagName)) {\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(parent, attrs);\n\t\t\t\t\t\t\t\tif (sourceCmdName && sourceCmdName == 'customstyle' && attrs.style) {\n\t\t\t\t\t\t\t\t\tparent.style.cssText = attrs.style;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(para, true);\n\t\t\t\t\t\t\t\tpara = parent;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdomUtils.remove(para.parentNode, true);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (utils.indexOf(notExchange, parent.tagName) != -1) {\n\t\t\t\t\t\t\tcurrent = parent;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = para;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t};\n\t\tme.setOpt('paragraph', {\n\t\t\t'p': '',\n\t\t\t'h1': '',\n\t\t\t'h2': '',\n\t\t\t'h3': '',\n\t\t\t'h4': '',\n\t\t\t'h5': '',\n\t\t\t'h6': ''\n\t\t});\n\t\tme.commands['paragraph'] = {\n\t\t\texecCommand: function(cmdName, style, attrs, sourceCmdName) {\n\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t//闭合时单独处理\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tvar txt = this.document.createTextNode('p');\n\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t\t//去掉冗余的fillchar\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\tvar node = txt.previousSibling;\n\t\t\t\t\t\tif (node && domUtils.isWhitespace(node)) {\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = txt.nextSibling;\n\t\t\t\t\t\tif (node && domUtils.isWhitespace(node)) {\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\trange = doParagraph(range, style, attrs, sourceCmdName);\n\t\t\t\tif (txt) {\n\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\tpN = txt.parentNode;\n\n\t\t\t\t\tdomUtils.remove(txt);\n\n\t\t\t\t\tif (domUtils.isBlockElm(pN) && domUtils.isEmptyNode(pN)) {\n\t\t\t\t\t\tdomUtils.fillNode(this.document, pN);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (browser.gecko && range.collapsed && range.startContainer.nodeType == 1) {\n\t\t\t\t\tvar child = range.startContainer.childNodes[range.startOffset];\n\t\t\t\t\tif (child && child.nodeType == 1 && child.tagName.toLowerCase() == style) {\n\t\t\t\t\t\trange.setStart(child, 0).collapse(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//trace:1097 原来有true，原因忘了，但去了就不能清除多余的占位符了\n\t\t\t\trange.select();\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar node = domUtils.filterNodeList(this.selection.getStartElementPath(), 'p h1 h2 h3 h4 h5 h6');\n\t\t\t\treturn node ? node.tagName.toLowerCase() : '';\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/directionality.js\n\t/**\n\t * 设置文字输入的方向的插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\t(function() {\n\t\tvar block = domUtils.isBlockElm,\n\t\t\tgetObj = function(editor) {\n\t\t\t\t//            var startNode = editor.selection.getStart(),\n\t\t\t\t//                parents;\n\t\t\t\t//            if ( startNode ) {\n\t\t\t\t//                //查找所有的是block的父亲节点\n\t\t\t\t//                parents = domUtils.findParents( startNode, true, block, true );\n\t\t\t\t//                for ( var i = 0,ci; ci = parents[i++]; ) {\n\t\t\t\t//                    if ( ci.getAttribute( 'dir' ) ) {\n\t\t\t\t//                        return ci;\n\t\t\t\t//                    }\n\t\t\t\t//                }\n\t\t\t\t//            }\n\t\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), function(n) {\n\t\t\t\t\treturn n && n.nodeType == 1 && n.getAttribute('dir')\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tdoDirectionality = function(range, editor, forward) {\n\n\t\t\t\tvar bookmark,\n\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\treturn node.nodeType == 1 ? !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n\t\t\t\t\t},\n\n\t\t\t\t\tobj = getObj(editor);\n\n\t\t\t\tif (obj && range.collapsed) {\n\t\t\t\t\tobj.setAttribute('dir', forward);\n\t\t\t\t\treturn range;\n\t\t\t\t}\n\t\t\t\tbookmark = range.createBookmark();\n\t\t\t\trange.enlarge(true);\n\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\ttmpNode;\n\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\tif (current.nodeType == 3 || !block(current)) {\n\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\t\t\t\t\t\twhile (current && current !== bookmark2.end && !block(current)) {\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\treturn !block(node);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\t\t\t\t\t\tvar common = tmpRange.getCommonAncestor();\n\t\t\t\t\t\tif (!domUtils.isBody(common) && block(common)) {\n\t\t\t\t\t\t\t//遍历到了block节点\n\t\t\t\t\t\t\tcommon.setAttribute('dir', forward);\n\t\t\t\t\t\t\tcurrent = common;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//没有遍历到，添加一个block节点\n\t\t\t\t\t\t\tvar p = range.document.createElement('p');\n\t\t\t\t\t\t\tp.setAttribute('dir', forward);\n\t\t\t\t\t\t\tvar frag = tmpRange.extractContents();\n\t\t\t\t\t\t\tp.appendChild(frag);\n\t\t\t\t\t\t\ttmpRange.insertNode(p);\n\t\t\t\t\t\t\tcurrent = p;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n\t\t\t};\n\n\t\t/**\n\t\t * 文字输入方向\n\t\t * @command directionality\n\t\t * @method execCommand\n\t\t * @param { String } cmdName 命令字符串\n\t\t * @param { String } forward 传入'ltr'表示从左向右输入，传入'rtl'表示从右向左输入\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'directionality', 'ltr');\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查询当前选区的文字输入方向\n\t\t * @command directionality\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmdName 命令字符串\n\t\t * @return { String } 返回'ltr'表示从左向右输入，返回'rtl'表示从右向左输入\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'directionality');\n\t\t * ```\n\t\t */\n\t\tUE.commands['directionality'] = {\n\t\t\texecCommand: function(cmdName, forward) {\n\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t//闭合时单独处理\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tvar txt = this.document.createTextNode('d');\n\t\t\t\t\trange.insertNode(txt);\n\t\t\t\t}\n\t\t\t\tdoDirectionality(range, this, forward);\n\t\t\t\tif (txt) {\n\t\t\t\t\trange.setStartBefore(txt).collapse(true);\n\t\t\t\t\tdomUtils.remove(txt);\n\t\t\t\t}\n\n\t\t\t\trange.select();\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar node = getObj(this);\n\t\t\t\treturn node ? node.getAttribute('dir') : 'ltr';\n\t\t\t}\n\t\t};\n\t})();\n\n\t// plugins/horizontal.js\n\t/**\n\t * 插入分割线插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入分割线\n\t * @command horizontal\n\t * @method execCommand\n\t * @param { String } cmdName 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'horizontal' );\n\t * ```\n\t */\n\tUE.plugins['horizontal'] = function() {\n\t\tvar me = this;\n\t\tme.commands['horizontal'] = {\n\t\t\texecCommand: function(cmdName) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (me.queryCommandState(cmdName) !== -1) {\n\t\t\t\t\tme.execCommand('insertHtml', '<hr>');\n\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\tif (start.nodeType == 1 && !start.childNodes[range.startOffset]) {\n\n\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\tif (tmp = start.childNodes[range.startOffset - 1]) {\n\t\t\t\t\t\t\tif (tmp.nodeType == 1 && tmp.tagName == 'HR') {\n\t\t\t\t\t\t\t\tif (me.options.enterTag == 'p') {\n\t\t\t\t\t\t\t\t\ttmp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\t\trange.setStart(tmp, 0).setCursor();\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmp = me.document.createElement('br');\n\t\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\t\trange.setStartBefore(tmp).setCursor();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t//边界在table里不能加分隔线\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn domUtils.filterNodeList(this.selection.getStartElementPath(), 'table') ? -1 : 0;\n\t\t\t}\n\t\t};\n\t\t//    me.addListener('delkeyup',function(){\n\t\t//        var rng = this.selection.getRange();\n\t\t//        if(browser.ie && browser.version > 8){\n\t\t//            rng.txtToElmBoundary(true);\n\t\t//            if(domUtils.isStartInblock(rng)){\n\t\t//                var tmpNode = rng.startContainer;\n\t\t//                var pre = tmpNode.previousSibling;\n\t\t//                if(pre && domUtils.isTagNode(pre,'hr')){\n\t\t//                    domUtils.remove(pre);\n\t\t//                    rng.select();\n\t\t//                    return;\n\t\t//                }\n\t\t//            }\n\t\t//        }\n\t\t//        if(domUtils.isBody(rng.startContainer)){\n\t\t//            var hr = rng.startContainer.childNodes[rng.startOffset -1];\n\t\t//            if(hr && hr.nodeName == 'HR'){\n\t\t//                var next = hr.nextSibling;\n\t\t//                if(next){\n\t\t//                    rng.setStart(next,0)\n\t\t//                }else if(hr.previousSibling){\n\t\t//                    rng.setStartAtLast(hr.previousSibling)\n\t\t//                }else{\n\t\t//                    var p = this.document.createElement('p');\n\t\t//                    hr.parentNode.insertBefore(p,hr);\n\t\t//                    domUtils.fillNode(this.document,p);\n\t\t//                    rng.setStart(p,0);\n\t\t//                }\n\t\t//                domUtils.remove(hr);\n\t\t//                rng.setCursor(false,true);\n\t\t//            }\n\t\t//        }\n\t\t//    })\n\t\tme.addListener('delkeydown', function(name, evt) {\n\t\t\tvar rng = this.selection.getRange();\n\t\t\trng.txtToElmBoundary(true);\n\t\t\tif (domUtils.isStartInblock(rng)) {\n\t\t\t\tvar tmpNode = rng.startContainer;\n\t\t\t\tvar pre = tmpNode.previousSibling;\n\t\t\t\tif (pre && domUtils.isTagNode(pre, 'hr')) {\n\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\trng.select();\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn true;\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t})\n\t};\n\n\t// plugins/time.js\n\t/**\n\t * 插入时间和日期\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入时间，默认格式：12:59:59\n\t * @command time\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'time');\n\t * ```\n\t */\n\n\t/**\n\t * 插入日期，默认格式：2013-08-30\n\t * @command date\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'date');\n\t * ```\n\t */\n\tUE.commands['time'] = UE.commands[\"date\"] = {\n\t\texecCommand: function(cmd, format) {\n\t\t\tvar date = new Date;\n\n\t\t\tfunction formatTime(date, format) {\n\t\t\t\tvar hh = ('0' + date.getHours()).slice(-2),\n\t\t\t\t\tii = ('0' + date.getMinutes()).slice(-2),\n\t\t\t\t\tss = ('0' + date.getSeconds()).slice(-2);\n\t\t\t\tformat = format || 'hh:ii:ss';\n\t\t\t\treturn format.replace(/hh/ig, hh).replace(/ii/ig, ii).replace(/ss/ig, ss);\n\t\t\t}\n\n\t\t\tfunction formatDate(date, format) {\n\t\t\t\tvar yyyy = ('000' + date.getFullYear()).slice(-4),\n\t\t\t\t\tyy = yyyy.slice(-2),\n\t\t\t\t\tmm = ('0' + (date.getMonth() + 1)).slice(-2),\n\t\t\t\t\tdd = ('0' + date.getDate()).slice(-2);\n\t\t\t\tformat = format || 'yyyy-mm-dd';\n\t\t\t\treturn format.replace(/yyyy/ig, yyyy).replace(/yy/ig, yy).replace(/mm/ig, mm).replace(/dd/ig, dd);\n\t\t\t}\n\n\t\t\tthis.execCommand('insertHtml', cmd == \"time\" ? formatTime(date, format) : formatDate(date, format));\n\t\t}\n\t};\n\n\t// plugins/rowspacing.js\n\t/**\n\t * 段前段后间距插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 设置段间距\n\t * @command rowspacing\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @param { String } value 段间距的值，以px为单位\n\t * @param { String } dir 间距位置，top或bottom，分别表示段前和段后\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'rowspacing', '10', 'top' );\n\t * ```\n\t */\n\n\tUE.plugins['rowspacing'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'rowspacingtop': ['5', '10', '15', '20', '25'],\n\t\t\t'rowspacingbottom': ['5', '10', '15', '20', '25']\n\n\t\t});\n\t\tme.commands['rowspacing'] = {\n\t\t\texecCommand: function(cmdName, value, dir) {\n\t\t\t\tthis.execCommand('paragraph', 'p', {\n\t\t\t\t\tstyle: 'margin-' + dir + ':' + value + 'px'\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function(cmdName, dir) {\n\t\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t}),\n\t\t\t\t\tvalue;\n\t\t\t\t//trace:1026\n\t\t\t\tif (pN) {\n\t\t\t\t\tvalue = domUtils.getComputedStyle(pN, 'margin-' + dir).replace(/[^\\d]/g, '');\n\t\t\t\t\treturn !value ? 0 : value;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/lineheight.js\n\t/**\n\t * 设置行内间距\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugins['lineheight'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'lineheight': ['1', '1.5', '1.75', '2', '3', '4', '5']\n\t\t});\n\n\t\t/**\n\t\t * 行距\n\t\t * @command lineheight\n\t\t * @method execCommand\n\t\t * @param { String } cmdName 命令字符串\n\t\t * @param { String } value 传入的行高值， 该值是当前字体的倍数， 例如： 1.5, 1.75\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'lineheight', 1.5);\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容的行高大小\n\t\t * @command lineheight\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回当前行高大小\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'lineheight' );\n\t\t * ```\n\t\t */\n\n\t\tme.commands['lineheight'] = {\n\t\t\texecCommand: function(cmdName, value) {\n\t\t\t\tthis.execCommand('paragraph', 'p', {\n\t\t\t\t\tstyle: 'line-height:' + (value == \"1\" ? \"normal\" : value + 'em')\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar pN = domUtils.filterNodeList(this.selection.getStartElementPath(), function(node) {\n\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t});\n\t\t\t\tif (pN) {\n\t\t\t\t\tvar value = domUtils.getComputedStyle(pN, 'line-height');\n\t\t\t\t\treturn value == 'normal' ? 1 : value.replace(/[^\\d.]*/ig, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/insertcode.js\n\t/**\n\t * 插入代码插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['insertcode'] = function() {\n\t\tvar me = this;\n\t\tme.ready(function() {\n\t\t\tutils.cssRule('pre', 'pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}',\n\t\t\t\tme.document)\n\t\t});\n\t\tme.setOpt('insertcode', {\n\t\t\t'as3': 'ActionScript3',\n\t\t\t'bash': 'Bash/Shell',\n\t\t\t'cpp': 'C/C++',\n\t\t\t'css': 'Css',\n\t\t\t'cf': 'CodeFunction',\n\t\t\t'c#': 'C#',\n\t\t\t'delphi': 'Delphi',\n\t\t\t'diff': 'Diff',\n\t\t\t'erlang': 'Erlang',\n\t\t\t'groovy': 'Groovy',\n\t\t\t'html': 'Html',\n\t\t\t'java': 'Java',\n\t\t\t'jfx': 'JavaFx',\n\t\t\t'js': 'Javascript',\n\t\t\t'pl': 'Perl',\n\t\t\t'php': 'Php',\n\t\t\t'plain': 'Plain Text',\n\t\t\t'ps': 'PowerShell',\n\t\t\t'python': 'Python',\n\t\t\t'ruby': 'Ruby',\n\t\t\t'scala': 'Scala',\n\t\t\t'sql': 'Sql',\n\t\t\t'vb': 'Vb',\n\t\t\t'xml': 'Xml'\n\t\t});\n\n\t\t/**\n\t\t * 插入代码\n\t\t * @command insertcode\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { String } lang 插入代码的语言\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertcode', 'javascript' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 如果选区所在位置是插入插入代码区域，返回代码的语言\n\t\t * @command insertcode\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回代码的语言\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'insertcode' );\n\t\t * ```\n\t\t */\n\n\t\tme.commands['insertcode'] = {\n\t\t\texecCommand: function(cmd, lang) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\tpre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\t\tif (pre) {\n\t\t\t\t\tpre.className = 'brush:' + lang + ';toolbar:false;';\n\t\t\t\t} else {\n\t\t\t\t\tvar code = '';\n\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\tcode = browser.ie && browser.ie11below ? (browser.version <= 8 ? '&nbsp;' : '') : '<br/>';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar frag = rng.extractContents();\n\t\t\t\t\t\tvar div = me.document.createElement('div');\n\t\t\t\t\t\tdiv.appendChild(frag);\n\n\t\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(div.innerHTML.replace(/[\\r\\t]/g, '')), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\t\tif (browser.ie && browser.ie11below && browser.version > 8) {\n\n\t\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.data\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\tif (!/\\n$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\tcode += '\\n';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcode += node.data + '\\n'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!node.nextSibling() && /\\n$/.test(code)) {\n\t\t\t\t\t\t\t\t\tcode = code.replace(/\\n$/, '');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (browser.ie && browser.ie11below) {\n\n\t\t\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\t\tcode += cn.data\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tif (!/br>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\t\t\tcode += '<br>';\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcode += node.data + '<br>'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!node.nextSibling() && /<br>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\tcode = code.replace(/<br>$/, '');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcode += (node.type == 'element' ? (dtd.$empty[node.tagName] ? '' : node.innerText()) : node.data);\n\t\t\t\t\t\t\t\t\tif (!/br\\/?\\s*>$/.test(code)) {\n\t\t\t\t\t\t\t\t\t\tif (!node.nextSibling())\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\tcode += '<br>'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tme.execCommand('inserthtml', '<pre id=\"coder\"class=\"brush:' + lang + ';toolbar:false\">' + code + '</pre>', true);\n\n\t\t\t\t\tpre = me.document.getElementById('coder');\n\t\t\t\t\tdomUtils.removeAttributes(pre, 'id');\n\t\t\t\t\tvar tmpNode = pre.previousSibling;\n\n\t\t\t\t\tif (tmpNode && (tmpNode.nodeType == 3 && tmpNode.nodeValue.length == 1 && browser.ie && browser.version == 6 || domUtils.isEmptyBlock(tmpNode))) {\n\n\t\t\t\t\t\tdomUtils.remove(tmpNode)\n\t\t\t\t\t}\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tif (domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\trng.setStart(pre, 0).setCursor(false, true)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.selectNodeContents(pre).select()\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar path = this.selection.getStartElementPath();\n\t\t\t\tvar lang = '';\n\t\t\t\tutils.each(path, function(node) {\n\t\t\t\t\tif (node.nodeName == 'PRE') {\n\t\t\t\t\t\tvar match = node.className.match(/brush:([^;]+)/);\n\t\t\t\t\t\tlang = match && match[1] ? match[1] : '';\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn lang;\n\t\t\t}\n\t\t};\n\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('pre'), function(pre) {\n\t\t\t\tvar brs = pre.getNodesByTagName('br');\n\t\t\t\tif (brs.length) {\n\t\t\t\t\tbrowser.ie && browser.ie11below && browser.version > 8 && utils.each(brs, function(br) {\n\t\t\t\t\t\tvar txt = UE.uNode.createText('\\n');\n\t\t\t\t\t\tbr.parentNode.insertBefore(txt, br);\n\t\t\t\t\t\tbr.parentNode.removeChild(br);\n\t\t\t\t\t});\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (browser.ie && browser.ie11below && browser.version > 8)\n\t\t\t\t\treturn;\n\t\t\t\tvar code = pre.innerText().split(/\\n/);\n\t\t\t\tpre.innerHTML('');\n\t\t\t\tutils.each(code, function(c) {\n\t\t\t\t\tif (c.length) {\n\t\t\t\t\t\tpre.appendChild(UE.uNode.createText(c));\n\t\t\t\t\t}\n\t\t\t\t\tpre.appendChild(UE.uNode.createElement('br'))\n\t\t\t\t})\n\t\t\t})\n\t\t});\n\t\tme.addOutputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('pre'), function(pre) {\n\t\t\t\tvar code = '';\n\t\t\t\tutils.each(pre.children, function(n) {\n\t\t\t\t\tif (n.type == 'text') {\n\t\t\t\t\t\t//在ie下文本内容有可能末尾带有\\n要去掉\n\t\t\t\t\t\t//trace:3396\n\t\t\t\t\t\tcode += n.data.replace(/[ ]/g, '&nbsp;').replace(/\\n$/, '');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (n.tagName == 'br') {\n\t\t\t\t\t\t\tcode += '\\n'\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcode += (!dtd.$empty[n.tagName] ? '' : n.innerText());\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\tpre.innerText(code.replace(/(&nbsp;|\\n)+$/, ''))\n\t\t\t})\n\t\t});\n\t\t//不需要判断highlight的command列表\n\t\tme.notNeedCodeQuery = {\n\t\t\thelp: 1,\n\t\t\tundo: 1,\n\t\t\tredo: 1,\n\t\t\tsource: 1,\n\t\t\tprint: 1,\n\t\t\tsearchreplace: 1,\n\t\t\tfullscreen: 1,\n\t\t\tpreview: 1,\n\t\t\tinsertparagraph: 1,\n\t\t\telementpath: 1,\n\t\t\tinsertcode: 1,\n\t\t\tinserthtml: 1,\n\t\t\tselectall: 1\n\t\t};\n\t\t//将queyCommamndState重置\n\t\tvar orgQuery = me.queryCommandState;\n\t\tme.queryCommandState = function(cmd) {\n\t\t\tvar me = this;\n\n\t\t\tif (!me.notNeedCodeQuery[cmd.toLowerCase()] && me.selection && me.queryCommandValue('insertcode')) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\treturn UE.Editor.prototype.queryCommandState.apply(this, arguments)\n\t\t};\n\t\tme.addListener('beforeenterkeydown', function() {\n\t\t\tvar rng = me.selection.getRange();\n\t\t\tvar pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\tif (pre) {\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\trng.deleteContents();\n\t\t\t\t}\n\t\t\t\tif (!browser.ie || browser.ie9above) {\n\t\t\t\t\tvar tmpNode = me.document.createElement('br'),\n\t\t\t\t\t\tpre;\n\t\t\t\t\trng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true);\n\t\t\t\t\tvar next = tmpNode.nextSibling;\n\t\t\t\t\tif (!next && (!browser.ie || browser.version > 10)) {\n\t\t\t\t\t\trng.insertNode(tmpNode.cloneNode(false));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.setStartAfter(tmpNode);\n\t\t\t\t\t}\n\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\tvar tmp;\n\t\t\t\t\twhile (pre) {\n\t\t\t\t\t\ttmp = pre;\n\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t\tif (!pre || pre.nodeName == 'BR') {\n\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (pre) {\n\t\t\t\t\t\tvar str = '';\n\t\t\t\t\t\twhile (pre && pre.nodeName != 'BR' && new RegExp('^[\\\\s' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\tstr += pre.nodeValue;\n\t\t\t\t\t\t\tpre = pre.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pre.nodeName != 'BR') {\n\t\t\t\t\t\t\tvar match = pre.nodeValue.match(new RegExp('^([\\\\s' + domUtils.fillChar + ']+)'));\n\t\t\t\t\t\t\tif (match && match[1]) {\n\t\t\t\t\t\t\t\tstr += match[1]\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (str) {\n\t\t\t\t\t\t\tstr = me.document.createTextNode(str);\n\t\t\t\t\t\t\trng.insertNode(str).setStartAfter(str);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trng.collapse(true).select(true);\n\t\t\t\t} else {\n\t\t\t\t\tif (browser.version > 8) {\n\n\t\t\t\t\t\tvar txt = me.document.createTextNode('\\n');\n\t\t\t\t\t\tvar start = rng.startContainer;\n\t\t\t\t\t\tif (rng.startOffset == 0) {\n\t\t\t\t\t\t\tvar preNode = start.previousSibling;\n\t\t\t\t\t\t\tif (preNode) {\n\t\t\t\t\t\t\t\trng.insertNode(txt);\n\t\t\t\t\t\t\t\tvar fillchar = me.document.createTextNode(' ');\n\t\t\t\t\t\t\t\trng.setStartAfter(txt).insertNode(fillchar).setStart(fillchar, 0).collapse(true).select(true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trng.insertNode(txt).setStartAfter(txt);\n\t\t\t\t\t\t\tvar fillchar = me.document.createTextNode(' ');\n\t\t\t\t\t\t\tstart = rng.startContainer.childNodes[rng.startOffset];\n\t\t\t\t\t\t\tif (start && !/^\\n/.test(start.nodeValue)) {\n\t\t\t\t\t\t\t\trng.setStartBefore(txt)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.insertNode(fillchar).setStart(fillchar, 0).collapse(true).select(true)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar tmpNode = me.document.createElement('br');\n\t\t\t\t\t\trng.insertNode(tmpNode);\n\t\t\t\t\t\trng.insertNode(me.document.createTextNode(domUtils.fillChar));\n\t\t\t\t\t\trng.setStartAfter(tmpNode);\n\t\t\t\t\t\tpre = tmpNode.previousSibling;\n\t\t\t\t\t\tvar tmp;\n\t\t\t\t\t\twhile (pre) {\n\t\t\t\t\t\t\ttmp = pre;\n\t\t\t\t\t\t\tpre = pre.previousSibling;\n\t\t\t\t\t\t\tif (!pre || pre.nodeName == 'BR') {\n\t\t\t\t\t\t\t\tpre = tmp;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pre) {\n\t\t\t\t\t\t\tvar str = '';\n\t\t\t\t\t\t\twhile (pre && pre.nodeName != 'BR' && new RegExp('^[ ' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\t\tstr += pre.nodeValue;\n\t\t\t\t\t\t\t\tpre = pre.nextSibling;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (pre.nodeName != 'BR') {\n\t\t\t\t\t\t\t\tvar match = pre.nodeValue.match(new RegExp('^([ ' + domUtils.fillChar + ']+)'));\n\t\t\t\t\t\t\t\tif (match && match[1]) {\n\t\t\t\t\t\t\t\t\tstr += match[1]\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tstr = me.document.createTextNode(str);\n\t\t\t\t\t\t\trng.insertNode(str).setStartAfter(str);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.collapse(true).select();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\n\t\tme.addListener('tabkeydown', function(cmd, evt) {\n\t\t\tvar rng = me.selection.getRange();\n\t\t\tvar pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\tif (pre) {\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\tif (evt.shiftKey) {\n\n\t\t\t\t} else {\n\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\tvar bk = rng.createBookmark();\n\t\t\t\t\t\tvar start = bk.start.previousSibling;\n\n\t\t\t\t\t\twhile (start) {\n\t\t\t\t\t\t\tif (pre.firstChild === start && !domUtils.isBr(start)) {\n\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start);\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.isBr(start)) {\n\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling);\n\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstart = start.previousSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar end = bk.end;\n\t\t\t\t\t\tstart = bk.start.nextSibling;\n\t\t\t\t\t\tif (pre.firstChild === bk.start) {\n\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling)\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (start && start !== end) {\n\t\t\t\t\t\t\tif (domUtils.isBr(start) && start.nextSibling) {\n\t\t\t\t\t\t\t\tif (start.nextSibling === end) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpre.insertBefore(me.document.createTextNode('    '), start.nextSibling)\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tstart = start.nextSibling;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar tmpNode = me.document.createTextNode('    ');\n\t\t\t\t\t\trng.insertNode(tmpNode).setStartAfter(tmpNode).collapse(true).select(true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t});\n\n\t\tme.addListener('beforeinserthtml', function(evtName, html) {\n\t\t\tvar me = this,\n\t\t\t\trng = me.selection.getRange(),\n\t\t\t\tpre = domUtils.findParentByTagName(rng.startContainer, 'pre', true);\n\t\t\tif (pre) {\n\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\trng.deleteContents()\n\t\t\t\t}\n\t\t\t\tvar htmlstr = '';\n\t\t\t\tif (browser.ie && browser.version > 8) {\n\n\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(html), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\thtmlstr += '\\n'\n\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\thtmlstr += '\\n'\n\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\thtmlstr += cn.innerText();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\thtmlstr += cn.data\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tif (!/\\n$/.test(htmlstr)) {\n\t\t\t\t\t\t\t\t\thtmlstr += '\\n';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thtmlstr += node.data + '\\n'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!node.nextSibling() && /\\n$/.test(htmlstr)) {\n\t\t\t\t\t\t\thtmlstr = htmlstr.replace(/\\n$/, '');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tvar tmpNode = me.document.createTextNode(utils.html(htmlstr.replace(/&nbsp;/g, ' ')));\n\t\t\t\t\trng.insertNode(tmpNode).selectNode(tmpNode).select();\n\t\t\t\t} else {\n\t\t\t\t\tvar frag = me.document.createDocumentFragment();\n\n\t\t\t\t\tutils.each(UE.filterNode(UE.htmlparser(html), me.options.filterTxtRules).children, function(node) {\n\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\tif (node.tagName == 'br') {\n\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\tutils.each(node.children, function(cn) {\n\t\t\t\t\t\t\t\t\tif (cn.type == 'element') {\n\t\t\t\t\t\t\t\t\t\tif (cn.tagName == 'br') {\n\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t\t\t\t} else if (!dtd.$empty[node.tagName]) {\n\t\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(cn.innerText().replace(/&nbsp;/g, ' '))));\n\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(cn.data.replace(/&nbsp;/g, ' '))));\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\tif (frag.lastChild.nodeName != 'BR') {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(me.document.createElement('br'))\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfrag.appendChild(me.document.createTextNode(utils.html(node.data.replace(/&nbsp;/g, ' '))));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!node.nextSibling() && frag.lastChild.nodeName == 'BR') {\n\t\t\t\t\t\t\tfrag.removeChild(frag.lastChild)\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\t\t\t\t\trng.insertNode(frag).select();\n\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\t//方向键的处理\n\t\tme.addListener('keydown', function(cmd, evt) {\n\t\t\tvar me = this,\n\t\t\t\tkeyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 40) {\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tpre, start = rng.startContainer;\n\t\t\t\tif (rng.collapsed && (pre = domUtils.findParentByTagName(rng.startContainer, 'pre', true)) && !pre.nextSibling) {\n\t\t\t\t\tvar last = pre.lastChild\n\t\t\t\t\twhile (last && last.nodeName == 'BR') {\n\t\t\t\t\t\tlast = last.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t\tif (last === start || rng.startContainer === pre && rng.startOffset == pre.childNodes.length) {\n\t\t\t\t\t\tme.execCommand('insertparagraph');\n\t\t\t\t\t\tdomUtils.preventDefault(evt)\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t//trace:3395\n\t\tme.addListener('delkeydown', function(type, evt) {\n\t\t\tvar rng = this.selection.getRange();\n\t\t\trng.txtToElmBoundary(true);\n\t\t\tvar start = rng.startContainer;\n\t\t\tif (domUtils.isTagNode(start, 'pre') && rng.collapsed && domUtils.isStartInblock(rng)) {\n\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\tstart.parentNode.insertBefore(p, start);\n\t\t\t\tdomUtils.remove(start);\n\t\t\t\trng.setStart(p, 0).setCursor(false, true);\n\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t})\n\t};\n\n\t// plugins/cleardoc.js\n\t/**\n\t * 清空文档插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 清空文档\n\t * @command cleardoc\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * //editor 是编辑器实例\n\t * editor.execCommand('cleardoc');\n\t * ```\n\t */\n\n\tUE.commands['cleardoc'] = {\n\t\texecCommand: function(cmdName) {\n\t\t\tvar me = this,\n\t\t\t\tenterTag = me.options.enterTag,\n\t\t\t\trange = me.selection.getRange();\n\t\t\tif (enterTag == \"br\") {\n\t\t\t\tme.body.innerHTML = \"<br/>\";\n\t\t\t\trange.setStart(me.body, 0).setCursor();\n\t\t\t} else {\n\t\t\t\tme.body.innerHTML = \"<p>\" + (ie ? \"\" : \"<br/>\") + \"</p>\";\n\t\t\t\trange.setStart(me.body.firstChild, 0).setCursor(false, true);\n\t\t\t}\n\t\t\tsetTimeout(function() {\n\t\t\t\tme.fireEvent(\"clearDoc\");\n\t\t\t}, 0);\n\n\t\t}\n\t};\n\n\t// plugins/anchor.js\n\t/**\n\t * 锚点插件，为UEditor提供插入锚点支持\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugin.register('anchor', function() {\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\t\t\t\t\tutils.cssRule('anchor',\n\t\t\t\t\t\t'.anchorclass{background: url(\\'' + this.options.themePath + this.options.theme + '/images/anchor.gif\\') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}',\n\t\t\t\t\t\tthis.document);\n\t\t\t\t}\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(a) {\n\t\t\t\t\tvar val;\n\t\t\t\t\tif (val = a.getAttr('anchorname')) {\n\t\t\t\t\t\ta.tagName = 'a';\n\t\t\t\t\t\ta.setAttr({\n\t\t\t\t\t\t\tanchorname: '',\n\t\t\t\t\t\t\tname: val,\n\t\t\t\t\t\t\t'class': ''\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('a'), function(a) {\n\t\t\t\t\tvar val;\n\t\t\t\t\tif ((val = a.getAttr('name')) && !a.getAttr('href')) {\n\t\t\t\t\t\ta.tagName = 'img';\n\t\t\t\t\t\ta.setAttr({\n\t\t\t\t\t\t\tanchorname: a.getAttr('name'),\n\t\t\t\t\t\t\t'class': 'anchorclass'\n\t\t\t\t\t\t});\n\t\t\t\t\t\ta.setAttr('name')\n\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 插入锚点\n\t\t\t\t * @command anchor\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { String } name 锚点名称字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //editor 是编辑器实例\n\t\t\t\t * editor.execCommand('anchor', 'anchor1');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'anchor': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\t\t\timg = range.getClosedNode();\n\t\t\t\t\t\tif (img && img.getAttribute('anchorname')) {\n\t\t\t\t\t\t\tif (name) {\n\t\t\t\t\t\t\t\timg.setAttribute('anchorname', name);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.setStartBefore(img).setCursor();\n\t\t\t\t\t\t\t\tdomUtils.remove(img);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (name) {\n\t\t\t\t\t\t\t\t//只在选区的开始插入\n\t\t\t\t\t\t\t\tvar anchor = this.document.createElement('img');\n\t\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\t\tdomUtils.setAttributes(anchor, {\n\t\t\t\t\t\t\t\t\t'anchorname': name,\n\t\t\t\t\t\t\t\t\t'class': 'anchorclass'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\trange.insertNode(anchor).setStartAfter(anchor).setCursor(false, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/wordcount.js\n\t///import core\n\t///commands 字数统计\n\t///commandsName  WordCount,wordCount\n\t///commandsTitle  字数统计\n\t/*\n\t * Created by JetBrains WebStorm.\n\t * User: taoqili\n\t * Date: 11-9-7\n\t * Time: 下午8:18\n\t * To change this template use File | Settings | File Templates.\n\t */\n\n\tUE.plugins['wordcount'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt('wordCount', true);\n\t\tme.addListener('contentchange', function() {\n\t\t\tme.fireEvent('wordcount');\n\t\t});\n\t\tvar timer;\n\t\tme.addListener('ready', function() {\n\t\t\tvar me = this;\n\t\t\tdomUtils.on(me.body, \"keyup\", function(evt) {\n\t\t\t\tvar code = evt.keyCode || evt.which,\n\t\t\t\t\t//忽略的按键,ctr,alt,shift,方向键\n\t\t\t\t\tignores = {\n\t\t\t\t\t\t\"16\": 1,\n\t\t\t\t\t\t\"18\": 1,\n\t\t\t\t\t\t\"20\": 1,\n\t\t\t\t\t\t\"37\": 1,\n\t\t\t\t\t\t\"38\": 1,\n\t\t\t\t\t\t\"39\": 1,\n\t\t\t\t\t\t\"40\": 1\n\t\t\t\t\t};\n\t\t\t\tif (code in ignores) return;\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\tme.fireEvent('wordcount');\n\t\t\t\t}, 200)\n\t\t\t})\n\t\t});\n\t};\n\n\t// plugins/pagebreak.js\n\t/**\n\t * 分页功能插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugins['pagebreak'] = function() {\n\t\tvar me = this,\n\t\t\tnotBreakTags = ['td'];\n\t\tme.setOpt('pageBreakTag', '_ueditor_page_break_tag_');\n\n\t\tfunction fillNode(node) {\n\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\tvar firstChild = node.firstChild,\n\t\t\t\t\ttmpNode;\n\n\t\t\t\twhile (firstChild && firstChild.nodeType == 1 && domUtils.isEmptyBlock(firstChild)) {\n\t\t\t\t\ttmpNode = firstChild;\n\t\t\t\t\tfirstChild = firstChild.firstChild;\n\t\t\t\t}!tmpNode && (tmpNode = node);\n\t\t\t\tdomUtils.fillNode(me.document, tmpNode);\n\t\t\t}\n\t\t}\n\t\t//分页符样式添加\n\n\t\tme.ready(function() {\n\t\t\tutils.cssRule('pagebreak', '.pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}', me.document);\n\t\t});\n\n\t\tfunction isHr(node) {\n\t\t\treturn node && node.nodeType == 1 && node.tagName == 'HR' && node.className == 'pagebreak';\n\t\t}\n\t\tme.addInputRule(function(root) {\n\t\t\troot.traversal(function(node) {\n\t\t\t\tif (node.type == 'text' && node.data == me.options.pageBreakTag) {\n\t\t\t\t\tvar hr = UE.uNode.createElement('<hr class=\"pagebreak\" noshade=\"noshade\" size=\"5\" style=\"-webkit-user-select: none;\">');\n\t\t\t\t\tnode.parentNode.insertBefore(hr, node);\n\t\t\t\t\tnode.parentNode.removeChild(node)\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t\tme.addOutputRule(function(node) {\n\t\t\tutils.each(node.getNodesByTagName('hr'), function(n) {\n\t\t\t\tif (n.getAttr('class') == 'pagebreak') {\n\t\t\t\t\tvar txt = UE.uNode.createText(me.options.pageBreakTag);\n\t\t\t\t\tn.parentNode.insertBefore(txt, n);\n\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t}\n\t\t\t})\n\n\t\t});\n\n\t\t/**\n\t\t * 插入分页符\n\t\t * @command pagebreak\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @remind 在表格中插入分页符会把表格切分成两部分\n\t\t * @remind 获取编辑器内的数据时， 编辑器会把分页符转换成“_ueditor_page_break_tag_”字符串，\n\t\t *          以便于提交数据到服务器端后处理分页。\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'pagebreak'); //插入一个hr标签，带有样式类名pagebreak\n\t\t * ```\n\t\t */\n\n\t\tme.commands['pagebreak'] = {\n\t\t\texecCommand: function() {\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\thr = me.document.createElement('hr');\n\t\t\t\tdomUtils.setAttributes(hr, {\n\t\t\t\t\t'class': 'pagebreak',\n\t\t\t\t\tnoshade: \"noshade\",\n\t\t\t\t\tsize: \"5\"\n\t\t\t\t});\n\t\t\t\tdomUtils.unSelectable(hr);\n\t\t\t\t//table单独处理\n\t\t\t\tvar node = domUtils.findParentByTagName(range.startContainer, notBreakTags, true),\n\n\t\t\t\t\tparents = [],\n\t\t\t\t\tpN;\n\t\t\t\tif (node) {\n\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\tcase 'TD':\n\t\t\t\t\t\t\tpN = node.parentNode;\n\t\t\t\t\t\t\tif (!pN.previousSibling) {\n\t\t\t\t\t\t\t\tvar table = domUtils.findParentByTagName(pN, 'table');\n\t\t\t\t\t\t\t\t//                            var tableWrapDiv = table.parentNode;\n\t\t\t\t\t\t\t\t//                            if(tableWrapDiv && tableWrapDiv.nodeType == 1\n\t\t\t\t\t\t\t\t//                                && tableWrapDiv.tagName == 'DIV'\n\t\t\t\t\t\t\t\t//                                && tableWrapDiv.getAttribute('dropdrag')\n\t\t\t\t\t\t\t\t//                                ){\n\t\t\t\t\t\t\t\t//                                domUtils.remove(tableWrapDiv,true);\n\t\t\t\t\t\t\t\t//                            }\n\t\t\t\t\t\t\t\ttable.parentNode.insertBefore(hr, table);\n\t\t\t\t\t\t\t\tparents = domUtils.findParents(hr, true);\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpN.parentNode.insertBefore(hr, pN);\n\t\t\t\t\t\t\t\tparents = domUtils.findParents(hr);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpN = parents[1];\n\t\t\t\t\t\t\tif (hr !== pN) {\n\t\t\t\t\t\t\t\tdomUtils.breakParent(hr, pN);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//table要重写绑定一下拖拽\n\t\t\t\t\t\t\tme.fireEvent('afteradjusttable', me.document);\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\twhile (!domUtils.isBody(start) && domUtils.isBlockElm(start) && domUtils.isEmptyNode(start)) {\n\t\t\t\t\t\t\trange.setStartBefore(start).collapse(true);\n\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\trange.insertNode(hr);\n\n\t\t\t\t\tvar pN = hr.parentNode,\n\t\t\t\t\t\tnextNode;\n\t\t\t\t\twhile (!domUtils.isBody(pN)) {\n\t\t\t\t\t\tdomUtils.breakParent(hr, pN);\n\t\t\t\t\t\tnextNode = hr.nextSibling;\n\t\t\t\t\t\tif (nextNode && domUtils.isEmptyBlock(nextNode)) {\n\t\t\t\t\t\t\tdomUtils.remove(nextNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpN = hr.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tnextNode = hr.nextSibling;\n\t\t\t\t\tvar pre = hr.previousSibling;\n\t\t\t\t\tif (isHr(pre)) {\n\t\t\t\t\t\tdomUtils.remove(pre);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpre && fillNode(pre);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!nextNode) {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\n\t\t\t\t\t\thr.parentNode.appendChild(p);\n\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\trange.setStart(p, 0).collapse(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (isHr(nextNode)) {\n\t\t\t\t\t\t\tdomUtils.remove(nextNode);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfillNode(nextNode);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setEndAfter(hr).collapse(false);\n\t\t\t\t\t}\n\n\t\t\t\t\trange.select(true);\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/wordimage.js\n\t///import core\n\t///commands 本地图片引导上传\n\t///commandsName  WordImage\n\t///commandsTitle  本地图片引导上传\n\t///commandsDialog  dialogs\\wordimage\n\n\tUE.plugin.register('wordimage', function() {\n\t\tvar me = this,\n\t\t\timages = [];\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t'wordimage': {\n\t\t\t\t\texecCommand: function() {\n\t\t\t\t\t\tvar images = domUtils.getElementsByTagName(me.body, \"img\");\n\t\t\t\t\t\tvar urlList = [];\n\t\t\t\t\t\tfor (var i = 0, ci; ci = images[i++];) {\n\t\t\t\t\t\t\tvar url = ci.getAttribute(\"word_img\");\n\t\t\t\t\t\t\turl && urlList.push(url);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn urlList;\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\timages = domUtils.getElementsByTagName(me.body, \"img\");\n\t\t\t\t\t\tfor (var i = 0, ci; ci = images[i++];) {\n\t\t\t\t\t\t\tif (ci.getAttribute(\"word_img\")) {\n\t\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn -1;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t}\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(img) {\n\t\t\t\t\tvar attrs = img.attrs,\n\t\t\t\t\t\tflag = parseInt(attrs.width) < 128 || parseInt(attrs.height) < 43,\n\t\t\t\t\t\topt = me.options;\n\t\t\t\t\t\t//src = opt.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif';\n\t\t\t\t\t\tvar src = $GLOBAL_CONFIG['pcimgpath'] + '/images/editor/spacer.jpg';\n\t\t\t\t\tif (attrs['src'] && /^(?:(file:\\/+))/.test(attrs['src'])) {\n\t\t\t\t\t\timg.setAttr({\n\t\t\t\t\t\t\twidth: attrs.width,\n\t\t\t\t\t\t\theight: attrs.height,\n\t\t\t\t\t\t\talt: attrs.alt,\n\t\t\t\t\t\t\tword_img: attrs.src,\n\t\t\t\t\t\t\tsrc: src,\n\t\t\t\t\t\t\t'style': 'background:url(' + (flag ? opt.themePath + opt.theme + '/images/word.gif' : opt.langPath + opt.lang + '/images/localimage.png') + ') no-repeat center center;border:1px solid #ddd'\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/dragdrop.js\n\tUE.plugins['dragdrop'] = function() {\n\n\t\tvar me = this;\n\t\tme.ready(function() {\n\t\t\tdomUtils.on(this.body, 'dragend', function() {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar node = rng.getClosedNode() || me.selection.getStart();\n\n\t\t\t\tif (node && node.tagName == 'IMG') {\n\n\t\t\t\t\tvar pre = node.previousSibling,\n\t\t\t\t\t\tnext;\n\t\t\t\t\twhile (next = node.nextSibling) {\n\t\t\t\t\t\tif (next.nodeType == 1 && next.tagName == 'SPAN' && !next.firstChild) {\n\t\t\t\t\t\t\tdomUtils.remove(next)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((pre && pre.nodeType == 1 && !domUtils.isEmptyBlock(pre) || !pre) && (!next || next && !domUtils.isEmptyBlock(next))) {\n\t\t\t\t\t\tif (pre && pre.tagName == 'P' && !domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\tpre.appendChild(node);\n\t\t\t\t\t\t\tdomUtils.moveChild(next, pre);\n\t\t\t\t\t\t\tdomUtils.remove(next);\n\t\t\t\t\t\t} else if (next && next.tagName == 'P' && !domUtils.isEmptyBlock(next)) {\n\t\t\t\t\t\t\tnext.insertBefore(node, next.firstChild);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (pre && pre.tagName == 'P' && domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\tdomUtils.remove(pre)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (next && next.tagName == 'P' && domUtils.isEmptyBlock(next)) {\n\t\t\t\t\t\t\tdomUtils.remove(next)\n\t\t\t\t\t\t}\n\t\t\t\t\t\trng.selectNode(node).select();\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t})\n\t\t});\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13) {\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tnode;\n\t\t\t\tif (node = domUtils.findParentByTagName(rng.startContainer, 'p', true)) {\n\t\t\t\t\tif (domUtils.getComputedStyle(node, 'text-align') == 'center') {\n\t\t\t\t\t\tdomUtils.removeStyle(node, 'text-align')\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t};\n\n\t// plugins/undo.js\n\t/**\n\t * undo redo\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 撤销上一次执行的命令\n\t * @command undo\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'undo' );\n\t * ```\n\t */\n\n\t/**\n\t * 重做上一次执行的命令\n\t * @command redo\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'redo' );\n\t * ```\n\t */\n\n\tUE.plugins['undo'] = function() {\n\t\tvar saveSceneTimer;\n\t\tvar me = this,\n\t\t\tmaxUndoCount = me.options.maxUndoCount || 20,\n\t\t\tmaxInputCount = me.options.maxInputCount || 20,\n\t\t\tfillchar = new RegExp(domUtils.fillChar + '|<\\/hr>', 'gi'); // ie会产生多余的</hr>\n\t\tvar noNeedFillCharTags = {\n\t\t\tol: 1,\n\t\t\tul: 1,\n\t\t\ttable: 1,\n\t\t\ttbody: 1,\n\t\t\ttr: 1,\n\t\t\tbody: 1\n\t\t};\n\t\tvar orgState = me.options.autoClearEmptyNode;\n\n\t\tfunction compareAddr(indexA, indexB) {\n\t\t\tif (indexA.length != indexB.length)\n\t\t\t\treturn 0;\n\t\t\tfor (var i = 0, l = indexA.length; i < l; i++) {\n\t\t\t\tif (indexA[i] != indexB[i])\n\t\t\t\t\treturn 0\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction compareRangeAddress(rngAddrA, rngAddrB) {\n\t\t\tif (rngAddrA.collapsed != rngAddrB.collapsed) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif (!compareAddr(rngAddrA.startAddress, rngAddrB.startAddress) || !compareAddr(rngAddrA.endAddress, rngAddrB.endAddress)) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction UndoManager() {\n\t\t\tthis.list = [];\n\t\t\tthis.index = 0;\n\t\t\tthis.hasUndo = false;\n\t\t\tthis.hasRedo = false;\n\t\t\tthis.undo = function() {\n\t\t\t\tif (this.hasUndo) {\n\t\t\t\t\tif (!this.list[this.index - 1] && this.list.length == 1) {\n\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\twhile (this.list[this.index].content == this.list[this.index - 1].content) {\n\t\t\t\t\t\tthis.index--;\n\t\t\t\t\t\tif (this.index == 0) {\n\t\t\t\t\t\t\treturn this.restore(0);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.restore(--this.index);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.redo = function() {\n\t\t\t\tif (this.hasRedo) {\n\t\t\t\t\twhile (this.list[this.index].content == this.list[this.index + 1].content) {\n\t\t\t\t\t\tthis.index++;\n\t\t\t\t\t\tif (this.index == this.list.length - 1) {\n\t\t\t\t\t\t\treturn this.restore(this.index);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.restore(++this.index);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tthis.restore = function() {\n\t\t\t\tvar me = this.editor;\n\t\t\t\tvar scene = this.list[this.index];\n\t\t\t\tvar root = UE.htmlparser(scene.content.replace(fillchar, ''));\n\t\t\t\tme.options.autoClearEmptyNode = false;\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\tme.options.autoClearEmptyNode = orgState;\n\t\t\t\t//trace:873\n\t\t\t\t//去掉展位符\n\t\t\t\tme.document.body.innerHTML = root.toHtml();\n\t\t\t\tme.fireEvent('afterscencerestore');\n\t\t\t\t//处理undo后空格不展位的问题\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(me.document, 'td th caption p'), function(node) {\n\t\t\t\t\t\tif (domUtils.isEmptyNode(node)) {\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar rng = new dom.Range(me.document).moveToAddress(scene.address);\n\t\t\t\t\trng.select(noNeedFillCharTags[rng.startContainer.nodeName.toLowerCase()]);\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tthis.update();\n\t\t\t\tthis.clearKey();\n\t\t\t\t//不能把自己reset了\n\t\t\t\tme.fireEvent('reset', true);\n\t\t\t};\n\n\t\t\tthis.getScene = function() {\n\t\t\t\tvar me = this.editor;\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\trngAddress = rng.createAddress(false, true);\n\t\t\t\tme.fireEvent('beforegetscene');\n\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML);\n\t\t\t\tme.options.autoClearEmptyNode = false;\n\t\t\t\tme.filterOutputRule(root);\n\t\t\t\tme.options.autoClearEmptyNode = orgState;\n\t\t\t\tvar cont = root.toHtml();\n\t\t\t\t//trace:3461\n\t\t\t\t//这个会引起回退时导致空格丢失的情况\n\t\t\t\t//            browser.ie && (cont = cont.replace(/>&nbsp;</g, '><').replace(/\\s*</g, '<').replace(/>\\s*/g, '>'));\n\t\t\t\tme.fireEvent('aftergetscene');\n\n\t\t\t\treturn {\n\t\t\t\t\taddress: rngAddress,\n\t\t\t\t\tcontent: cont\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.save = function(notCompareRange, notSetCursor) {\n\t\t\t\tclearTimeout(saveSceneTimer);\n\t\t\t\tvar currentScene = this.getScene(notSetCursor),\n\t\t\t\t\tlastScene = this.list[this.index];\n\n\t\t\t\tif (lastScene && lastScene.content != currentScene.content) {\n\t\t\t\t\tme.trigger('contentchange')\n\t\t\t\t}\n\t\t\t\t//内容相同位置相同不存\n\t\t\t\tif (lastScene && lastScene.content == currentScene.content &&\n\t\t\t\t\t(notCompareRange ? 1 : compareRangeAddress(lastScene.address, currentScene.address))\n\t\t\t\t) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.list = this.list.slice(0, this.index + 1);\n\t\t\t\tthis.list.push(currentScene);\n\t\t\t\t//如果大于最大数量了，就把最前的剔除\n\t\t\t\tif (this.list.length > maxUndoCount) {\n\t\t\t\t\tthis.list.shift();\n\t\t\t\t}\n\t\t\t\tthis.index = this.list.length - 1;\n\t\t\t\tthis.clearKey();\n\t\t\t\t//跟新undo/redo状态\n\t\t\t\tthis.update();\n\n\t\t\t};\n\t\t\tthis.update = function() {\n\t\t\t\tthis.hasRedo = !!this.list[this.index + 1];\n\t\t\t\tthis.hasUndo = !!this.list[this.index - 1];\n\t\t\t};\n\t\t\tthis.reset = function() {\n\t\t\t\tthis.list = [];\n\t\t\t\tthis.index = 0;\n\t\t\t\tthis.hasUndo = false;\n\t\t\t\tthis.hasRedo = false;\n\t\t\t\tthis.clearKey();\n\t\t\t};\n\t\t\tthis.clearKey = function() {\n\t\t\t\tkeycont = 0;\n\t\t\t\tlastKeyCode = null;\n\t\t\t};\n\t\t}\n\n\t\tme.undoManger = new UndoManager();\n\t\tme.undoManger.editor = me;\n\n\t\tfunction saveScene() {\n\t\t\tthis.undoManger.save();\n\t\t}\n\n\t\tme.addListener('saveScene', function() {\n\t\t\tvar args = Array.prototype.splice.call(arguments, 1);\n\t\t\tthis.undoManger.save.apply(this.undoManger, args);\n\t\t});\n\n\t\t//    me.addListener('beforeexeccommand', saveScene);\n\t\t//    me.addListener('afterexeccommand', saveScene);\n\n\t\tme.addListener('reset', function(type, exclude) {\n\t\t\tif (!exclude) {\n\t\t\t\tthis.undoManger.reset();\n\t\t\t}\n\t\t});\n\t\tme.commands['redo'] = me.commands['undo'] = {\n\t\t\texecCommand: function(cmdName) {\n\t\t\t\tthis.undoManger[cmdName]();\n\t\t\t},\n\t\t\tqueryCommandState: function(cmdName) {\n\t\t\t\treturn this.undoManger['has' + (cmdName.toLowerCase() == 'undo' ? 'Undo' : 'Redo')] ? 0 : -1;\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\n\t\tvar keys = {\n\t\t\t\t//  /*Backspace*/ 8:1, /*Delete*/ 46:1,\n\t\t\t\t/*Shift*/\n\t\t\t\t16: 1,\n\t\t\t\t/*Ctrl*/ 17: 1,\n\t\t\t\t/*Alt*/ 18: 1,\n\t\t\t\t37: 1,\n\t\t\t\t38: 1,\n\t\t\t\t39: 1,\n\t\t\t\t40: 1\n\n\t\t\t},\n\t\t\tkeycont = 0,\n\t\t\tlastKeyCode;\n\t\t//输入法状态下不计算字符数\n\t\tvar inputType = false;\n\t\tme.addListener('ready', function() {\n\t\t\tdomUtils.on(this.body, 'compositionstart', function() {\n\t\t\t\tinputType = true;\n\t\t\t});\n\t\t\tdomUtils.on(this.body, 'compositionend', function() {\n\t\t\t\tinputType = false;\n\t\t\t})\n\t\t});\n\t\t//快捷键\n\t\tme.addshortcutkey({\n\t\t\t\"Undo\": \"ctrl+90\", //undo\n\t\t\t\"Redo\": \"ctrl+89\" //redo\n\n\t\t});\n\t\tvar isCollapsed = true;\n\t\tme.addListener('keydown', function(type, evt) {\n\n\t\t\tvar me = this;\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (!keys[keyCode] && !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\tif (inputType)\n\t\t\t\t\treturn;\n\n\t\t\t\tif (!me.selection.getRange().collapsed) {\n\t\t\t\t\tme.undoManger.save(false, true);\n\t\t\t\t\tisCollapsed = false;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (me.undoManger.list.length == 0) {\n\t\t\t\t\tme.undoManger.save(true);\n\t\t\t\t}\n\t\t\t\tclearTimeout(saveSceneTimer);\n\n\t\t\t\tfunction save(cont) {\n\t\t\t\t\tcont.undoManger.save(false, true);\n\t\t\t\t\tcont.fireEvent('selectionchange');\n\t\t\t\t}\n\t\t\t\tsaveSceneTimer = setTimeout(function() {\n\t\t\t\t\tif (inputType) {\n\t\t\t\t\t\tvar interalTimer = setInterval(function() {\n\t\t\t\t\t\t\tif (!inputType) {\n\t\t\t\t\t\t\t\tsave(me);\n\t\t\t\t\t\t\t\tclearInterval(interalTimer)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, 300)\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tsave(me);\n\t\t\t\t}, 200);\n\n\t\t\t\tlastKeyCode = keyCode;\n\t\t\t\tkeycont++;\n\t\t\t\tif (keycont >= maxInputCount) {\n\t\t\t\t\tsave(me)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (!keys[keyCode] && !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\tif (inputType)\n\t\t\t\t\treturn;\n\t\t\t\tif (!isCollapsed) {\n\t\t\t\t\tthis.undoManger.save(false, true);\n\t\t\t\t\tisCollapsed = true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t//扩展实例，添加关闭和开启命令undo\n\t\tme.stopCmdUndo = function() {\n\t\t\tme.__hasEnterExecCommand = true;\n\t\t};\n\t\tme.startCmdUndo = function() {\n\t\t\tme.__hasEnterExecCommand = false;\n\t\t}\n\t};\n\n\t// plugins/copy.js\n\tUE.plugin.register('copy', function() {\n\t\treturn;\n\t\tvar me = this;\n\t\tvar jsPath = $GLOBAL_CONFIG['pcjspath'];\n\t\tfunction initZeroClipboard() {\n\n\t\t\tZeroClipboard.config({\n\t\t\t\tdebug: false,\n\t\t\t\t//swfPath: me.options.UEDITOR_HOME_URL + 'third-party/zeroclipboard/ZeroClipboard.swf'\n\t\t\t\tswfPath:jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.swf'\n\t\t\t});\n\n\t\t\tvar client = me.zeroclipboard = new ZeroClipboard();\n\n\t\t\t// 复制内容\n\t\t\tclient.on('copy', function(e) {\n\t\t\t\tvar client = e.client,\n\t\t\t\t\trng = me.selection.getRange(),\n\t\t\t\t\tdiv = document.createElement('div');\n\n\t\t\t\tdiv.appendChild(rng.cloneContents());\n\t\t\t\tclient.setText(div.innerText || div.textContent);\n\t\t\t\tclient.setHtml(div.innerHTML);\n\t\t\t\trng.select();\n\t\t\t});\n\t\t\t// hover事件传递到target\n\t\t\tclient.on('mouseover mouseout', function(e) {\n\t\t\t\tvar target = e.target;\n\t\t\t\tif (e.type == 'mouseover') {\n\t\t\t\t\tdomUtils.addClass(target, 'edui-state-hover');\n\t\t\t\t} else if (e.type == 'mouseout') {\n\t\t\t\t\tdomUtils.removeClasses(target, 'edui-state-hover');\n\t\t\t\t}\n\t\t\t});\n\t\t\t// flash加载不成功\n\t\t\tclient.on('wrongflash noflash', function() {\n\t\t\t\tZeroClipboard.destroy();\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\t\t\t\t\tif (!browser.ie) {\n\t\t\t\t\t\tif (window.ZeroClipboard) {\n\t\t\t\t\t\t\tinitZeroClipboard();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconsole.log(jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.js')\n\t\t\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\t\t   // src: me.options.UEDITOR_HOME_URL + \"third-party/zeroclipboard/ZeroClipboard.js\",\n\t\t\t\t\t\t\t   src:jsPath+'/js/plugin/zeroclipboard/ZeroClipboard.js',\n\t\t\t\t\t\t\t\ttag: \"script\",\n\t\t\t\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t\t\t\t}, function() {\n\t\t\t\t\t\t\t\tinitZeroClipboard();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'copy': {\n\t\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\t\tif (!me.document.execCommand('copy')) {\n\t\t\t\t\t\t\talert(me.getLang('copymsg'));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/paste.js\n\t///import core\n\t///import plugins/inserthtml.js\n\t///import plugins/undo.js\n\t///import plugins/serialize.js\n\t///commands 粘贴\n\t///commandsName  PastePlain\n\t///commandsTitle  纯文本粘贴模式\n\t/**\n\t * @description 粘贴\n\t * @author zhanyi\n\t */\n\tUE.plugins['paste'] = function() {\n\t\tfunction getClipboardData(callback) {\n\t\t\tvar doc = this.document;\n\t\t\tif (doc.getElementById('baidu_pastebin')) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar range = this.selection.getRange(),\n\t\t\t\tbk = range.createBookmark(),\n\t\t\t\t//创建剪贴的容器div\n\t\t\t\tpastebin = doc.createElement('div');\n\t\t\tpastebin.id = 'baidu_pastebin';\n\t\t\t// Safari 要求div必须有内容，才能粘贴内容进来\n\t\t\tbrowser.webkit && pastebin.appendChild(doc.createTextNode(domUtils.fillChar + domUtils.fillChar));\n\t\t\tdoc.body.appendChild(pastebin);\n\t\t\t//trace:717 隐藏的span不能得到top\n\t\t\t//bk.start.innerHTML = '&nbsp;';\n\t\t\tbk.start.style.display = '';\n\t\t\tpastebin.style.cssText = \"position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:\" +\n\t\t\t\t//要在现在光标平行的位置加入，否则会出现跳动的问题\n\t\t\t\tdomUtils.getXY(bk.start).y + 'px';\n\n\t\t\trange.selectNodeContents(pastebin).select(true);\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\tfor (var i = 0, pastebins = doc.querySelectorAll('#baidu_pastebin'), pi; pi = pastebins[i++];) {\n\t\t\t\t\t\tif (domUtils.isEmptyNode(pi)) {\n\t\t\t\t\t\t\tdomUtils.remove(pi);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpastebin = pi;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tpastebin.parentNode.removeChild(pastebin);\n\t\t\t\t} catch (e) {}\n\t\t\t\trange.moveToBookmark(bk).select(true);\n\t\t\t\tcallback(pastebin);\n\t\t\t}, 0);\n\t\t}\n\n\t\tvar me = this;\n\n\t\tme.setOpt({\n\t\t\tretainOnlyLabelPasted: false\n\t\t});\n\n\t\tvar txtContent, htmlContent, address;\n\n\t\tfunction getPureHtml(html) {\n\t\t\treturn html.replace(/<(\\/?)([\\w\\-]+)([^>]*)>/gi, function(a, b, tagName, attrs) {\n\t\t\t\ttagName = tagName.toLowerCase();\n\t\t\t\tif ({\n\t\t\t\t\t\timg: 1\n\t\t\t\t\t}[tagName]) {\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t\t\tattrs = attrs.replace(/([\\w\\-]*?)\\s*=\\s*((\"([^\"]*)\")|('([^']*)')|([^\\s>]+))/gi, function(str, atr, val) {\n\t\t\t\t\tif ({\n\t\t\t\t\t\t\t'src': 1,\n\t\t\t\t\t\t\t'href': 1,\n\t\t\t\t\t\t\t'name': 1\n\t\t\t\t\t\t}[atr.toLowerCase()]) {\n\t\t\t\t\t\treturn atr + '=' + val + ' '\n\t\t\t\t\t}\n\t\t\t\t\treturn ''\n\t\t\t\t});\n\t\t\t\tif ({\n\t\t\t\t\t\t'span': 1,\n\t\t\t\t\t\t'div': 1\n\t\t\t\t\t}[tagName]) {\n\t\t\t\t\treturn ''\n\t\t\t\t} else {\n\n\t\t\t\t\treturn '<' + b + tagName + ' ' + utils.trim(attrs) + '>'\n\t\t\t\t}\n\n\t\t\t});\n\t\t}\n\n\t\tfunction filter(div) {\n\t\t\tvar html;\n\t\t\tif (div.firstChild) {\n\t\t\t\t//去掉cut中添加的边界值\n\t\t\t\tvar nodes = domUtils.getElementsByTagName(div, 'span');\n\t\t\t\tfor (var i = 0, ni; ni = nodes[i++];) {\n\t\t\t\t\tif (ni.id == '_baidu_cut_start' || ni.id == '_baidu_cut_end') {\n\t\t\t\t\t\tdomUtils.remove(ni);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (browser.webkit) {\n\n\t\t\t\t\tvar brs = div.querySelectorAll('div br');\n\t\t\t\t\tfor (var i = 0, bi; bi = brs[i++];) {\n\t\t\t\t\t\tvar pN = bi.parentNode;\n\t\t\t\t\t\tif (pN.tagName == 'DIV' && pN.childNodes.length == 1) {\n\t\t\t\t\t\t\tpN.innerHTML = '<p><br/></p>';\n\t\t\t\t\t\t\tdomUtils.remove(pN);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar divs = div.querySelectorAll('#baidu_pastebin');\n\t\t\t\t\tfor (var i = 0, di; di = divs[i++];) {\n\t\t\t\t\t\tvar tmpP = me.document.createElement('p');\n\t\t\t\t\t\tdi.parentNode.insertBefore(tmpP, di);\n\t\t\t\t\t\twhile (di.firstChild) {\n\t\t\t\t\t\t\ttmpP.appendChild(di.firstChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.remove(di);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar metas = div.querySelectorAll('meta');\n\t\t\t\t\tfor (var i = 0, ci; ci = metas[i++];) {\n\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar brs = div.querySelectorAll('br');\n\t\t\t\t\tfor (i = 0; ci = brs[i++];) {\n\t\t\t\t\t\tif (/^apple-/i.test(ci.className)) {\n\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (browser.gecko) {\n\t\t\t\t\tvar dirtyNodes = div.querySelectorAll('[_moz_dirty]');\n\t\t\t\t\tfor (i = 0; ci = dirtyNodes[i++];) {\n\t\t\t\t\t\tci.removeAttribute('_moz_dirty');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!browser.ie) {\n\t\t\t\t\tvar spans = div.querySelectorAll('span.Apple-style-span');\n\t\t\t\t\tfor (var i = 0, ci; ci = spans[i++];) {\n\t\t\t\t\t\tdomUtils.remove(ci, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//ie下使用innerHTML会产生多余的\\r\\n字符，也会产生&nbsp;这里过滤掉\n\t\t\t\thtml = div.innerHTML; //.replace(/>(?:(\\s|&nbsp;)*?)</g,'><');\n\n\t\t\t\t//过滤word粘贴过来的冗余属性\n\t\t\t\thtml = UE.filterWord(html);\n\t\t\t\t//取消了忽略空白的第二个参数，粘贴过来的有些是有空白的，会被套上相关的标签\n\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t//如果给了过滤规则就先进行过滤\n\t\t\t\tif (me.options.filterRules) {\n\t\t\t\t\tUE.filterNode(root, me.options.filterRules);\n\t\t\t\t}\n\t\t\t\t//执行默认的处理\n\t\t\t\tme.filterInputRule(root);\n\t\t\t\t//针对chrome的处理\n\t\t\t\tif (browser.webkit) {\n\t\t\t\t\tvar br = root.lastChild();\n\t\t\t\t\tif (br && br.type == 'element' && br.tagName == 'br') {\n\t\t\t\t\t\troot.removeChild(br)\n\t\t\t\t\t}\n\t\t\t\t\tutils.each(me.body.querySelectorAll('div'), function(node) {\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(node)) {\n\t\t\t\t\t\t\tdomUtils.remove(node, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\thtml = {\n\t\t\t\t\t'html': root.toHtml()\n\t\t\t\t};\n\t\t\t\tme.fireEvent('beforepaste', html, root);\n\t\t\t\t//抢了默认的粘贴，那后边的内容就不执行了，比如表格粘贴\n\t\t\t\tif (!html.html) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\troot = UE.htmlparser(html.html, true);\n\t\t\t\t//如果开启了纯文本模式\n\t\t\t\tif (me.queryCommandState('pasteplain') === 1) {\n\t\t\t\t\tme.execCommand('insertHtml', UE.filterNode(root, me.options.filterTxtRules).toHtml(), true);\n\t\t\t\t} else {\n\t\t\t\t\t//文本模式\n\t\t\t\t\tUE.filterNode(root, me.options.filterTxtRules);\n\t\t\t\t\ttxtContent = root.toHtml();\n\t\t\t\t\t//完全模式\n\t\t\t\t\thtmlContent = html.html;\n\n\t\t\t\t\taddress = me.selection.getRange().createAddress(true);\n\t\t\t\t\tme.execCommand('insertHtml', me.getOpt('retainOnlyLabelPasted') === true ? getPureHtml(htmlContent) : htmlContent, true);\n\t\t\t\t}\n\t\t\t\tme.fireEvent(\"afterpaste\", html);\n\t\t\t}\n\t\t}\n\n\t\tme.addListener('pasteTransfer', function(cmd, plainType) {\n\n\t\t\tif (address && txtContent && htmlContent && txtContent != htmlContent) {\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\trange.moveToAddress(address, true);\n\n\t\t\t\tif (!range.collapsed) {\n\n\t\t\t\t\twhile (!domUtils.isBody(range.startContainer)) {\n\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\tstart = start.childNodes[range.startOffset];\n\t\t\t\t\t\t\tif (!start) {\n\t\t\t\t\t\t\t\trange.setStartBefore(range.startContainer);\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar pre = start.previousSibling;\n\n\t\t\t\t\t\t\tif (pre && pre.nodeType == 3 && new RegExp('^[\\n\\r\\t ' + domUtils.fillChar + ']*$').test(pre.nodeValue)) {\n\t\t\t\t\t\t\t\trange.setStartBefore(pre)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\t\t\trange.setStartBefore(range.startContainer);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\twhile (!domUtils.isBody(range.endContainer)) {\n\t\t\t\t\t\tvar end = range.endContainer;\n\t\t\t\t\t\tif (end.nodeType == 1) {\n\t\t\t\t\t\t\tend = end.childNodes[range.endOffset];\n\t\t\t\t\t\t\tif (!end) {\n\t\t\t\t\t\t\t\trange.setEndAfter(range.endContainer);\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar next = end.nextSibling;\n\t\t\t\t\t\t\tif (next && next.nodeType == 3 && new RegExp('^[\\n\\r\\t' + domUtils.fillChar + ']*$').test(next.nodeValue)) {\n\t\t\t\t\t\t\t\trange.setEndAfter(next)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (range.endOffset == range.endContainer[range.endContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length) {\n\t\t\t\t\t\t\trange.setEndAfter(range.endContainer);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\trange.deleteContents();\n\t\t\t\trange.select(true);\n\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\tvar html = htmlContent;\n\t\t\t\tif (plainType === 2) {\n\t\t\t\t\thtml = getPureHtml(html);\n\t\t\t\t} else if (plainType) {\n\t\t\t\t\thtml = txtContent;\n\t\t\t\t}\n\t\t\t\tme.execCommand('inserthtml', html, true);\n\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\twhile (!domUtils.isBody(rng.startContainer) && !rng.startOffset &&\n\t\t\t\t\trng.startContainer[rng.startContainer.nodeType == 3 ? 'nodeValue' : 'childNodes'].length\n\t\t\t\t) {\n\t\t\t\t\trng.setStartBefore(rng.startContainer);\n\t\t\t\t}\n\t\t\t\tvar tmpAddress = rng.createAddress(true);\n\t\t\t\taddress.endAddress = tmpAddress.startAddress;\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('ready', function() {\n\t\t\tdomUtils.on(me.body, 'cut', function() {\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\tif (!range.collapsed && me.undoManger) {\n\t\t\t\t\tme.undoManger.save();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//ie下beforepaste在点击右键时也会触发，所以用监控键盘才处理\n\t\t\tdomUtils.on(me.body, browser.ie || browser.opera ? 'keydown' : 'paste', function(e) {\n\t\t\t\tif ((browser.ie || browser.opera) && ((!e.ctrlKey && !e.metaKey) || e.keyCode != '86')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgetClipboardData.call(me, function(div) {\n\t\t\t\t\tfilter(div);\n\t\t\t\t});\n\t\t\t});\n\n\t\t});\n\n\t\tme.commands['paste'] = {\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tgetClipboardData.call(me, function(div) {\n\t\t\t\t\t\tfilter(div);\n\t\t\t\t\t});\n\t\t\t\t\tme.document.execCommand('paste');\n\t\t\t\t} else {\n\t\t\t\t\talert(me.getLang('pastemsg'));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\t// plugins/puretxtpaste.js\n\t/**\n\t * 纯文本粘贴插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['pasteplain'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'pasteplain': false,\n\t\t\t'filterTxtRules': function() {\n\t\t\t\tfunction transP(node) {\n\t\t\t\t\tnode.tagName = 'p';\n\t\t\t\t\tnode.setStyle();\n\t\t\t\t}\n\n\t\t\t\tfunction removeNode(node) {\n\t\t\t\t\tnode.parentNode.removeChild(node, true)\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\t//直接删除及其字节点内容\n\t\t\t\t\t'-': 'script style object iframe embed input select',\n\t\t\t\t\t'p': {\n\t\t\t\t\t\t$: {}\n\t\t\t\t\t},\n\t\t\t\t\t'br': {\n\t\t\t\t\t\t$: {}\n\t\t\t\t\t},\n\t\t\t\t\tdiv: function(node) {\n\t\t\t\t\t\tvar tmpNode, p = UE.uNode.createElement('p');\n\t\t\t\t\t\twhile (tmpNode = node.firstChild()) {\n\t\t\t\t\t\t\tif (tmpNode.type == 'text' || !UE.dom.dtd.$block[tmpNode.tagName]) {\n\t\t\t\t\t\t\t\tp.appendChild(tmpNode);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t\t\t\tp = UE.uNode.createElement('p');\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(tmpNode, node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (p.firstChild()) {\n\t\t\t\t\t\t\tnode.parentNode.insertBefore(p, node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\t\t},\n\t\t\t\t\tol: removeNode,\n\t\t\t\t\tul: removeNode,\n\t\t\t\t\tdl: removeNode,\n\t\t\t\t\tdt: removeNode,\n\t\t\t\t\tdd: removeNode,\n\t\t\t\t\t'li': removeNode,\n\t\t\t\t\t'caption': transP,\n\t\t\t\t\t'th': transP,\n\t\t\t\t\t'tr': transP,\n\t\t\t\t\t'h1': transP,\n\t\t\t\t\t'h2': transP,\n\t\t\t\t\t'h3': transP,\n\t\t\t\t\t'h4': transP,\n\t\t\t\t\t'h5': transP,\n\t\t\t\t\t'h6': transP,\n\t\t\t\t\t'td': function(node) {\n\t\t\t\t\t\t//没有内容的td直接删掉\n\t\t\t\t\t\tvar txt = !!node.innerText();\n\t\t\t\t\t\tif (txt) {\n\t\t\t\t\t\t\tnode.parentNode.insertAfter(UE.uNode.createText(' &nbsp; &nbsp;'), node);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode.parentNode.removeChild(node, node.innerText())\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}()\n\t\t});\n\t\t//暂时这里支持一下老版本的属性\n\t\tvar pasteplain = me.options.pasteplain;\n\n\t\t/**\n\t\t * 启用或取消纯文本粘贴模式\n\t\t * @command pasteplain\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'pasteplain' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查询当前是否处于纯文本粘贴模式\n\t\t * @command pasteplain\n\t\t * @method queryCommandState\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { int } 如果处于纯文本模式，返回1，否则，返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'pasteplain' );\n\t\t * ```\n\t\t */\n\t\tme.commands['pasteplain'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn pasteplain ? 1 : 0;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tpasteplain = !pasteplain | 0;\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\t};\n\n\t// plugins/list.js\n\t/**\n\t * 有序列表,无序列表插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['list'] = function() {\n\t\tvar me = this,\n\t\t\tnotExchange = {\n\t\t\t\t'TD': 1,\n\t\t\t\t'PRE': 1,\n\t\t\t\t'BLOCKQUOTE': 1\n\t\t\t};\n\t\tvar customStyle = {\n\t\t\t'cn': 'cn-1-',\n\t\t\t'cn1': 'cn-2-',\n\t\t\t'cn2': 'cn-3-',\n\t\t\t'num': 'num-1-',\n\t\t\t'num1': 'num-2-',\n\t\t\t'num2': 'num-3-',\n\t\t\t'dash': 'dash',\n\t\t\t'dot': 'dot'\n\t\t};\n\n\t\tme.setOpt({\n\t\t\t'autoTransWordToList': false,\n\t\t\t'insertorderedlist': {\n\t\t\t\t'num': '',\n\t\t\t\t'num1': '',\n\t\t\t\t'num2': '',\n\t\t\t\t'cn': '',\n\t\t\t\t'cn1': '',\n\t\t\t\t'cn2': '',\n\t\t\t\t'decimal': '',\n\t\t\t\t'lower-alpha': '',\n\t\t\t\t'lower-roman': '',\n\t\t\t\t'upper-alpha': '',\n\t\t\t\t'upper-roman': ''\n\t\t\t},\n\t\t\t'insertunorderedlist': {\n\t\t\t\t'circle': '',\n\t\t\t\t'disc': '',\n\t\t\t\t'square': '',\n\t\t\t\t'dash': '',\n\t\t\t\t'dot': ''\n\t\t\t},\n\t\t\tlistDefaultPaddingLeft: '30',\n\t\t\tlisticonpath: 'http://bs.baidu.com/listicon/',\n\t\t\tmaxListLevel: -1, //-1不限制\n\t\t\tdisablePInList: false\n\t\t});\n\n\t\tfunction listToArray(list) {\n\t\t\tvar arr = [];\n\t\t\tfor (var p in list) {\n\t\t\t\tarr.push(p)\n\t\t\t}\n\t\t\treturn arr;\n\t\t}\n\t\tvar listStyle = {\n\t\t\t'OL': listToArray(me.options.insertorderedlist),\n\t\t\t'UL': listToArray(me.options.insertunorderedlist)\n\t\t};\n\t\tvar liiconpath = me.options.listiconpath;\n\n\t\t//根据用户配置，调整customStyle\n\t\tfor (var s in customStyle) {\n\t\t\tif (!me.options.insertorderedlist.hasOwnProperty(s) && !me.options.insertunorderedlist.hasOwnProperty(s)) {\n\t\t\t\tdelete customStyle[s];\n\t\t\t}\n\t\t}\n\n\t\tme.ready(function() {\n\t\t\tvar customCss = [];\n\t\t\tfor (var p in customStyle) {\n\t\t\t\tif (p == 'dash' || p == 'dot') {\n\t\t\t\t\tcustomCss.push('li.list-' + customStyle[p] + '{background-image:url(' + liiconpath + customStyle[p] + '.gif)}');\n\t\t\t\t\tcustomCss.push('ul.custom_' + p + '{list-style:none;}ul.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = 0; i < 99; i++) {\n\t\t\t\t\t\tcustomCss.push('li.list-' + customStyle[p] + i + '{background-image:url(' + liiconpath + 'list-' + customStyle[p] + i + '.gif)}')\n\t\t\t\t\t}\n\t\t\t\t\tcustomCss.push('ol.custom_' + p + '{list-style:none;}ol.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n\t\t\t\t}\n\t\t\t\tswitch (p) {\n\t\t\t\t\tcase 'cn':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cn1':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:30px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'cn2':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:40px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:55px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-3{padding-left:68px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'num':\n\t\t\t\t\tcase 'num1':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'num2':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-1{padding-left:35px}');\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'dash':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft{padding-left:35px}');\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'dot':\n\t\t\t\t\t\tcustomCss.push('li.list-' + p + '-paddingleft{padding-left:20px}');\n\t\t\t\t}\n\t\t\t}\n\t\t\tcustomCss.push('.list-paddingleft-1{padding-left:0}');\n\t\t\tcustomCss.push('.list-paddingleft-2{padding-left:' + me.options.listDefaultPaddingLeft + 'px}');\n\t\t\tcustomCss.push('.list-paddingleft-3{padding-left:' + me.options.listDefaultPaddingLeft * 2 + 'px}');\n\t\t\t//如果不给宽度会在自定应样式里出现滚动条\n\t\t\tutils.cssRule('list', 'ol,ul{margin:0;pading:0;' + (browser.ie ? '' : 'width:95%') + '}li{clear:both;}' + customCss.join('\\n'), me.document);\n\t\t});\n\t\t//单独处理剪切的问题\n\t\tme.ready(function() {\n\t\t\tdomUtils.on(me.body, 'cut', function() {\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tli;\n\t\t\t\t\t//trace:3416\n\t\t\t\t\tif (!rng.collapsed) {\n\t\t\t\t\t\tif (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t\t\t\t\t\t\tif (!li.nextSibling && domUtils.isEmptyBlock(li)) {\n\t\t\t\t\t\t\t\tvar pn = li.parentNode,\n\t\t\t\t\t\t\t\t\tnode;\n\t\t\t\t\t\t\t\tif (node = pn.previousSibling) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\trng.setStartAtLast(node).collapse(true);\n\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t} else if (node = pn.nextSibling) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\trng.setStartAtFirst(node).collapse(true);\n\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar tmpNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, tmpNode);\n\t\t\t\t\t\t\t\t\tpn.parentNode.insertBefore(tmpNode, pn);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(pn);\n\t\t\t\t\t\t\t\t\trng.setStart(tmpNode, 0).collapse(true);\n\t\t\t\t\t\t\t\t\trng.select(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t})\n\t\t\t})\n\t\t});\n\n\t\tfunction getStyle(node) {\n\t\t\tvar cls = node.className;\n\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\treturn cls.match(/custom_(\\w+)/)[1]\n\t\t\t}\n\t\t\treturn domUtils.getStyle(node, 'list-style-type')\n\n\t\t}\n\n\t\tme.addListener('beforepaste', function(type, html) {\n\t\t\tvar me = this,\n\t\t\t\trng = me.selection.getRange(),\n\t\t\t\tli;\n\t\t\tvar root = UE.htmlparser(html.html, true);\n\t\t\tif (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n\t\t\t\tvar list = li.parentNode,\n\t\t\t\t\ttagName = list.tagName == 'OL' ? 'ul' : 'ol';\n\t\t\t\tutils.each(root.getNodesByTagName(tagName), function(n) {\n\t\t\t\t\tn.tagName = list.tagName;\n\t\t\t\t\tn.setAttr();\n\t\t\t\t\tif (n.parentNode === root) {\n\t\t\t\t\t\ttype = getStyle(list) || (list.tagName == 'OL' ? 'decimal' : 'disc')\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar className = n.parentNode.getAttr('class');\n\t\t\t\t\t\tif (className && /custom_/.test(className)) {\n\t\t\t\t\t\t\ttype = className.match(/custom_(\\w+)/)[1]\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttype = n.parentNode.getStyle('list-style-type');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!type) {\n\t\t\t\t\t\t\ttype = list.tagName == 'OL' ? 'decimal' : 'disc';\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar index = utils.indexOf(listStyle[list.tagName], type);\n\t\t\t\t\tif (n.parentNode !== root)\n\t\t\t\t\t\tindex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\tvar currentStyle = listStyle[list.tagName][index];\n\t\t\t\t\tif (customStyle[currentStyle]) {\n\t\t\t\t\t\tn.setAttr('class', 'custom_' + currentStyle)\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tn.setStyle('list-style-type', currentStyle)\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t}\n\n\t\t\thtml.html = root.toHtml();\n\t\t});\n\t\t//导出时，去掉p标签\n\t\tme.getOpt('disablePInList') === true && me.addOutputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('li'), function(li) {\n\t\t\t\tvar newChildrens = [],\n\t\t\t\t\tindex = 0;\n\t\t\t\tutils.each(li.children, function(n) {\n\t\t\t\t\tif (n.tagName == 'p') {\n\t\t\t\t\t\tvar tmpNode;\n\t\t\t\t\t\twhile (tmpNode = n.children.pop()) {\n\t\t\t\t\t\t\tnewChildrens.splice(index, 0, tmpNode);\n\t\t\t\t\t\t\ttmpNode.parentNode = li;\n\t\t\t\t\t\t\tlastNode = tmpNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttmpNode = newChildrens[newChildrens.length - 1];\n\t\t\t\t\t\tif (!tmpNode || tmpNode.type != 'element' || tmpNode.tagName != 'br') {\n\t\t\t\t\t\t\tvar br = UE.uNode.createElement('br');\n\t\t\t\t\t\t\tbr.parentNode = li;\n\t\t\t\t\t\t\tnewChildrens.push(br);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tindex = newChildrens.length;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (newChildrens.length) {\n\t\t\t\t\tli.children = newChildrens;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\t//进入编辑器的li要套p标签\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('li'), function(li) {\n\t\t\t\tvar tmpP = UE.uNode.createElement('p');\n\t\t\t\tfor (var i = 0, ci; ci = li.children[i];) {\n\t\t\t\t\tif (ci.type == 'text' || dtd.p[ci.tagName]) {\n\t\t\t\t\t\ttmpP.appendChild(ci);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tmpP.firstChild()) {\n\t\t\t\t\t\t\tli.insertBefore(tmpP, ci);\n\t\t\t\t\t\t\ttmpP = UE.uNode.createElement('p');\n\t\t\t\t\t\t\ti = i + 2;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ti++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (tmpP.firstChild() && !tmpP.parentNode || !li.firstChild()) {\n\t\t\t\t\tli.appendChild(tmpP);\n\t\t\t\t}\n\t\t\t\t//trace:3357\n\t\t\t\t//p不能为空\n\t\t\t\tif (!tmpP.firstChild()) {\n\t\t\t\t\ttmpP.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n\t\t\t\t}\n\t\t\t\t//去掉末尾的空白\n\t\t\t\tvar p = li.firstChild();\n\t\t\t\tvar lastChild = p.lastChild();\n\t\t\t\tif (lastChild && lastChild.type == 'text' && /^\\s*$/.test(lastChild.data)) {\n\t\t\t\t\tp.removeChild(lastChild)\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (me.options.autoTransWordToList) {\n\t\t\t\tvar orderlisttype = {\n\t\t\t\t\t\t'num1': /^\\d+\\)/,\n\t\t\t\t\t\t'decimal': /^\\d+\\./,\n\t\t\t\t\t\t'lower-alpha': /^[a-z]+\\)/,\n\t\t\t\t\t\t'upper-alpha': /^[A-Z]+\\./,\n\t\t\t\t\t\t'cn': /^[\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+[\\u3001]/,\n\t\t\t\t\t\t'cn2': /^\\([\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+\\)/\n\t\t\t\t\t},\n\t\t\t\t\tunorderlisttype = {\n\t\t\t\t\t\t'square': 'n'\n\t\t\t\t\t};\n\n\t\t\t\tfunction checkListType(content, container) {\n\t\t\t\t\tvar span = container.firstChild();\n\t\t\t\t\tif (span && span.type == 'element' && span.tagName == 'span' && /Wingdings|Symbol/.test(span.getStyle('font-family'))) {\n\t\t\t\t\t\tfor (var p in unorderlisttype) {\n\t\t\t\t\t\t\tif (unorderlisttype[p] == span.data) {\n\t\t\t\t\t\t\t\treturn p\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn 'disc'\n\t\t\t\t\t}\n\t\t\t\t\tfor (var p in orderlisttype) {\n\t\t\t\t\t\tif (orderlisttype[p].test(content)) {\n\t\t\t\t\t\t\treturn p;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tutils.each(root.getNodesByTagName('p'), function(node) {\n\t\t\t\t\tif (node.getAttr('class') != 'MsoListParagraph') {\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\t//word粘贴过来的会带有margin要去掉,但这样也可能会误命中一些央视\n\t\t\t\t\tnode.setStyle('margin', '');\n\t\t\t\t\tnode.setStyle('margin-left', '');\n\t\t\t\t\tnode.setAttr('class', '');\n\n\t\t\t\t\tfunction appendLi(list, p, type) {\n\t\t\t\t\t\tif (list.tagName == 'ol') {\n\t\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\t\tvar first = p.firstChild();\n\t\t\t\t\t\t\t\tif (first.type == 'element' && first.tagName == 'span' && orderlisttype[type].test(first.innerText())) {\n\t\t\t\t\t\t\t\t\tp.removeChild(first);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tp.innerHTML(p.innerHTML().replace(orderlisttype[type], ''));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tp.removeChild(p.firstChild())\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar li = UE.uNode.createElement('li');\n\t\t\t\t\t\tli.appendChild(p);\n\t\t\t\t\t\tlist.appendChild(li);\n\t\t\t\t\t}\n\t\t\t\t\tvar tmp = node,\n\t\t\t\t\t\ttype, cacheNode = node;\n\n\t\t\t\t\tif (node.parentNode.tagName != 'li' && (type = checkListType(node.innerText(), node))) {\n\n\t\t\t\t\t\tvar list = UE.uNode.createElement(me.options.insertorderedlist.hasOwnProperty(type) ? 'ol' : 'ul');\n\t\t\t\t\t\tif (customStyle[type]) {\n\t\t\t\t\t\t\tlist.setAttr('class', 'custom_' + type)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlist.setStyle('list-style-type', type)\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (node && node.parentNode.tagName != 'li' && checkListType(node.innerText(), node)) {\n\t\t\t\t\t\t\ttmp = node.nextSibling();\n\t\t\t\t\t\t\tif (!tmp) {\n\t\t\t\t\t\t\t\tnode.parentNode.insertBefore(list, node)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tappendLi(list, node, type);\n\t\t\t\t\t\t\tnode = tmp;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!list.parentNode && node && node.parentNode) {\n\t\t\t\t\t\t\tnode.parentNode.insertBefore(list, node)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar span = cacheNode.firstChild();\n\t\t\t\t\tif (span && span.type == 'element' && span.tagName == 'span' && /^\\s*(&nbsp;)+\\s*$/.test(span.innerText())) {\n\t\t\t\t\t\tspan.parentNode.removeChild(span)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t});\n\n\t\t//调整索引标签\n\t\tme.addListener('contentchange', function() {\n\t\t\tadjustListStyle(me.document)\n\t\t});\n\n\t\tfunction adjustListStyle(doc, ignore) {\n\t\t\tutils.each(domUtils.getElementsByTagName(doc, 'ol ul'), function(node) {\n\n\t\t\t\tif (!domUtils.inDoc(node, doc))\n\t\t\t\t\treturn;\n\n\t\t\t\tvar parent = node.parentNode;\n\t\t\t\tif (parent.tagName == node.tagName) {\n\t\t\t\t\tvar nodeStyleType = getStyle(node) || (node.tagName == 'OL' ? 'decimal' : 'disc'),\n\t\t\t\t\t\tparentStyleType = getStyle(parent) || (parent.tagName == 'OL' ? 'decimal' : 'disc');\n\t\t\t\t\tif (nodeStyleType == parentStyleType) {\n\t\t\t\t\t\tvar styleIndex = utils.indexOf(listStyle[node.tagName], nodeStyleType);\n\t\t\t\t\t\tstyleIndex = styleIndex + 1 == listStyle[node.tagName].length ? 0 : styleIndex + 1;\n\t\t\t\t\t\tsetListStyle(node, listStyle[node.tagName][styleIndex])\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tvar index = 0,\n\t\t\t\t\ttype = 2;\n\t\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\t\tif (!(/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/))) {\n\t\t\t\t\t\ttype = 1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/)) {\n\t\t\t\t\t\ttype = 3;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar style = domUtils.getStyle(node, 'list-style-type');\n\t\t\t\tstyle && (node.style.cssText = 'list-style-type:' + style);\n\t\t\t\tnode.className = utils.trim(node.className.replace(/list-paddingleft-\\w+/, '')) + ' list-paddingleft-' + type;\n\t\t\t\tutils.each(domUtils.getElementsByTagName(node, 'li'), function(li) {\n\t\t\t\t\tli.style.cssText && (li.style.cssText = '');\n\t\t\t\t\tif (!li.firstChild) {\n\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (li.parentNode !== node) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tindex++;\n\t\t\t\t\tif (domUtils.hasClass(node, /custom_/)) {\n\t\t\t\t\t\tvar paddingLeft = 1,\n\t\t\t\t\t\t\tcurrentStyle = getStyle(node);\n\t\t\t\t\t\tif (node.tagName == 'OL') {\n\t\t\t\t\t\t\tif (currentStyle) {\n\t\t\t\t\t\t\t\tswitch (currentStyle) {\n\t\t\t\t\t\t\t\t\tcase 'cn':\n\t\t\t\t\t\t\t\t\tcase 'cn1':\n\t\t\t\t\t\t\t\t\tcase 'cn2':\n\t\t\t\t\t\t\t\t\t\tif (index > 10 && (index % 10 == 0 || index > 10 && index < 20)) {\n\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 2\n\t\t\t\t\t\t\t\t\t\t} else if (index > 20) {\n\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 3\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'num2':\n\t\t\t\t\t\t\t\t\t\tif (index > 9) {\n\t\t\t\t\t\t\t\t\t\t\tpaddingLeft = 2\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tli.className = 'list-' + customStyle[currentStyle] + index + ' ' + 'list-' + currentStyle + '-paddingleft-' + paddingLeft;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tli.className = 'list-' + customStyle[currentStyle] + ' ' + 'list-' + currentStyle + '-paddingleft';\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tli.className = li.className.replace(/list-[\\w\\-]+/gi, '');\n\t\t\t\t\t}\n\t\t\t\t\tvar className = li.getAttribute('class');\n\t\t\t\t\tif (className !== null && !className.replace(/\\s/g, '')) {\n\t\t\t\t\t\tdomUtils.removeAttributes(li, 'class')\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t!ignore && adjustList(node, node.tagName.toLowerCase(), getStyle(node) || domUtils.getStyle(node, 'list-style-type'), true);\n\t\t\t})\n\t\t}\n\n\t\tfunction adjustList(list, tag, style, ignoreEmpty) {\n\t\t\tvar nextList = list.nextSibling;\n\t\t\tif (nextList && nextList.nodeType == 1 && nextList.tagName.toLowerCase() == tag && (getStyle(nextList) || domUtils.getStyle(nextList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t\t\t\tdomUtils.moveChild(nextList, list);\n\t\t\t\tif (nextList.childNodes.length == 0) {\n\t\t\t\t\tdomUtils.remove(nextList);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (nextList && domUtils.isFillChar(nextList)) {\n\t\t\t\tdomUtils.remove(nextList);\n\t\t\t}\n\t\t\tvar preList = list.previousSibling;\n\t\t\tif (preList && preList.nodeType == 1 && preList.tagName.toLowerCase() == tag && (getStyle(preList) || domUtils.getStyle(preList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n\t\t\t\tdomUtils.moveChild(list, preList);\n\t\t\t}\n\t\t\tif (preList && domUtils.isFillChar(preList)) {\n\t\t\t\tdomUtils.remove(preList);\n\t\t\t}!ignoreEmpty && domUtils.isEmptyBlock(list) && domUtils.remove(list);\n\t\t\tif (getStyle(list)) {\n\t\t\t\tadjustListStyle(list.ownerDocument, true)\n\t\t\t}\n\t\t}\n\n\t\tfunction setListStyle(list, style) {\n\t\t\tif (customStyle[style]) {\n\t\t\t\tlist.className = 'custom_' + style;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tdomUtils.setStyle(list, 'list-style-type', style);\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\tfunction clearEmptySibling(node) {\n\t\t\tvar tmpNode = node.previousSibling;\n\t\t\tif (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t}\n\t\t\ttmpNode = node.nextSibling;\n\t\t\tif (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t}\n\t\t}\n\n\t\tme.addListener('keydown', function(type, evt) {\n\t\t\tfunction preventAndSave() {\n\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t}\n\n\t\t\tfunction findList(node, filterFn) {\n\t\t\t\twhile (node && !domUtils.isBody(node)) {\n\t\t\t\t\tif (filterFn(node)) {\n\t\t\t\t\t\treturn null\n\t\t\t\t\t}\n\t\t\t\t\tif (node.nodeType == 1 && /[ou]l/i.test(node.tagName)) {\n\t\t\t\t\t\treturn node;\n\t\t\t\t\t}\n\t\t\t\t\tnode = node.parentNode;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13 && !evt.shiftKey) { //回车\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tparent = domUtils.findParent(rng.startContainer, function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node)\n\t\t\t\t\t}, true),\n\t\t\t\t\tli = domUtils.findParentByTagName(rng.startContainer, 'li', true);\n\t\t\t\tif (parent && parent.tagName != 'PRE' && !li) {\n\t\t\t\t\tvar html = parent.innerHTML.replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\t\t\t\tif (/^\\s*1\\s*\\.[^\\d]/.test(html)) {\n\t\t\t\t\t\tparent.innerHTML = html.replace(/^\\s*1\\s*\\./, '');\n\t\t\t\t\t\trng.setStartAtLast(parent).collapse(true).select();\n\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\tme.execCommand('insertorderedlist');\n\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\tstart = findList(range.startContainer, function(node) {\n\t\t\t\t\t\treturn node.tagName == 'TABLE';\n\t\t\t\t\t}),\n\t\t\t\t\tend = range.collapsed ? start : findList(range.endContainer, function(node) {\n\t\t\t\t\t\treturn node.tagName == 'TABLE';\n\t\t\t\t\t});\n\n\t\t\t\tif (start && end && start === end) {\n\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, 'li', true);\n\t\t\t\t\t\tif (start && end && start === end) {\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t\t\tif (li && domUtils.isEmptyBlock(li)) {\n\n\t\t\t\t\t\t\t\tpre = li.previousSibling;\n\t\t\t\t\t\t\t\tnext = li.nextSibling;\n\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\tparentList = li.parentNode;\n\t\t\t\t\t\t\t\tif (pre && next) {\n\t\t\t\t\t\t\t\t\trange.setStart(next, 0).collapse(true).select(true);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif (!pre && !next || !pre) {\n\n\t\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(p, parentList);\n\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tli.parentNode.parentNode.insertBefore(p, parentList.nextSibling);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\t\tif (!parentList.firstChild) {\n\t\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar tmpRange = range.cloneRange(),\n\t\t\t\t\t\t\t\tbk = tmpRange.collapse(false).createBookmark();\n\n\t\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\t\ttmpRange.moveToBookmark(bk);\n\t\t\t\t\t\t\tvar li = domUtils.findParentByTagName(tmpRange.startContainer, 'li', true);\n\n\t\t\t\t\t\t\tclearEmptySibling(li);\n\t\t\t\t\t\t\ttmpRange.select();\n\t\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\n\t\t\t\t\tif (li) {\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(li)) {\n\t\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\t\tvar parentList = li.parentNode;\n\t\t\t\t\t\t\tif (li !== parentList.lastChild) {\n\t\t\t\t\t\t\t\tdomUtils.breakParent(li, parentList);\n\t\t\t\t\t\t\t\tclearEmptySibling(li);\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li, parentList.nextSibling);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//嵌套不处理\n\t\t\t\t\t\t\tif (!dtd.$list[li.parentNode.tagName]) {\n\n\t\t\t\t\t\t\t\tif (!domUtils.isBlockElm(li.firstChild)) {\n\t\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tli.parentNode.insertBefore(p, li);\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(li, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.moveToBookmark(bk).select();\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar first = li.firstChild;\n\t\t\t\t\t\t\tif (!first || !domUtils.isBlockElm(first)) {\n\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\n\t\t\t\t\t\t\t\t!li.firstChild && domUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\n\t\t\t\t\t\t\t\t\tp.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tli.appendChild(p);\n\t\t\t\t\t\t\t\tfirst = p;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar span = me.document.createElement('span');\n\n\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\tdomUtils.breakParent(span, li);\n\n\t\t\t\t\t\t\tvar nextLi = span.nextSibling;\n\t\t\t\t\t\t\tfirst = nextLi.firstChild;\n\n\t\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\t\t\tnextLi.appendChild(p);\n\t\t\t\t\t\t\t\tfirst = p;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(first)) {\n\t\t\t\t\t\t\t\tfirst.innerHTML = '';\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, first);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\trange.setStart(first, 0).collapse(true).shrinkBoundary().select();\n\t\t\t\t\t\t\tdomUtils.remove(span);\n\t\t\t\t\t\t\tvar pre = nextLi.previousSibling;\n\t\t\t\t\t\t\tif (pre && domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\tpre.innerHTML = '<p></p>';\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, pre.firstChild);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//                        }\n\t\t\t\t\t\tpreventAndSave();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tif (keyCode == 8) {\n\t\t\t\t//修中ie中li下的问题\n\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (range.collapsed && domUtils.isStartInblock(range)) {\n\t\t\t\t\ttmpRange = range.cloneRange().trimBoundary();\n\t\t\t\t\tli = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\t\t\t//要在li的最左边，才能处理\n\t\t\t\t\tif (li && domUtils.isStartInblock(tmpRange)) {\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'p', true);\n\t\t\t\t\t\tif (start && start !== li.firstChild) {\n\t\t\t\t\t\t\tvar parentList = domUtils.findParentByTagName(start, ['ol', 'ul']);\n\t\t\t\t\t\t\tdomUtils.breakParent(start, parentList);\n\t\t\t\t\t\t\tclearEmptySibling(start);\n\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\trange.setStart(start, 0).setCursor(false, true);\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (li && (pre = li.previousSibling)) {\n\t\t\t\t\t\t\tif (keyCode == 46 && li.childNodes.length) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//有可能上边的兄弟节点是个2级菜单，要追加到2级菜单的最后的li\n\t\t\t\t\t\t\tif (dtd.$list[pre.tagName]) {\n\t\t\t\t\t\t\t\tpre = pre.lastChild;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t\tfirst = li.firstChild;\n\t\t\t\t\t\t\tif (domUtils.isBlockElm(first)) {\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(first)) {\n\t\t\t\t\t\t\t\t\t//                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t\t\t\t\t\t\t\t\tpre.appendChild(first);\n\t\t\t\t\t\t\t\t\trange.setStart(first, 0).setCursor(false, true);\n\t\t\t\t\t\t\t\t\t//first不是唯一的节点\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\tspan = me.document.createElement('span');\n\t\t\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\t\t\t//判断pre是否是空的节点,如果是<p><br/></p>类型的空节点，干掉p标签防止它占位\n\t\t\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(pre)) {\n\t\t\t\t\t\t\t\t\t\tpre.innerHTML = '';\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.moveChild(li, pre);\n\t\t\t\t\t\t\t\t\trange.setStartBefore(span).collapse(true).select(true);\n\n\t\t\t\t\t\t\t\t\tdomUtils.remove(span);\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(li)) {\n\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\tpre.appendChild(p);\n\t\t\t\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\t\t\t\t\t\t\t\t\t//                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trange.setEnd(pre, pre.childNodes.length).collapse().select(true);\n\t\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\t\tpre.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//trace:980\n\n\t\t\t\t\t\tif (li && !li.previousSibling) {\n\t\t\t\t\t\t\tvar parentList = li.parentNode;\n\t\t\t\t\t\t\tvar bk = range.createBookmark();\n\t\t\t\t\t\t\tif (domUtils.isTagNode(parentList.parentNode, 'ol ul')) {\n\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li, parentList);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\tparentList.parentNode.insertBefore(li.firstChild, parentList);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tdomUtils.remove(li);\n\t\t\t\t\t\t\t\tif (domUtils.isEmptyNode(parentList)) {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(parentList)\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.moveToBookmark(bk).setCursor(false, true);\n\t\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 8) {\n\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\tlist;\n\t\t\t\tif (list = domUtils.findParentByTagName(rng.startContainer, ['ol', 'ul'], true)) {\n\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), getStyle(list) || domUtils.getComputedStyle(list, 'list-style-type'), true)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t//处理tab键\n\t\tme.addListener('tabkeydown', function() {\n\n\t\t\tvar range = me.selection.getRange();\n\n\t\t\t//控制级数\n\t\t\tfunction checkLevel(li) {\n\t\t\t\tif (me.options.maxListLevel != -1) {\n\t\t\t\t\tvar level = li.parentNode,\n\t\t\t\t\t\tlevelNum = 0;\n\t\t\t\t\twhile (/[ou]l/i.test(level.tagName)) {\n\t\t\t\t\t\tlevelNum++;\n\t\t\t\t\t\tlevel = level.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (levelNum >= me.options.maxListLevel) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t//只以开始为准\n\t\t\t//todo 后续改进\n\t\t\tvar li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\t\t\tif (li) {\n\n\t\t\t\tvar bk;\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tif (checkLevel(li))\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tvar parentLi = li.parentNode,\n\t\t\t\t\t\tlist = me.document.createElement(parentLi.tagName),\n\t\t\t\t\t\tindex = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t\t\t\t\tindex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\tvar currentStyle = listStyle[list.tagName][index];\n\t\t\t\t\tsetListStyle(list, currentStyle);\n\t\t\t\t\tif (domUtils.isStartInblock(range)) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\tparentLi.insertBefore(list, li);\n\t\t\t\t\t\tlist.appendChild(li);\n\t\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\t\trange.moveToBookmark(bk).select(true);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\tfor (var i = 0, closeList, parents = domUtils.findParents(li), ci; ci = parents[i++];) {\n\t\t\t\t\t\tif (domUtils.isTagNode(ci, 'ol ul')) {\n\t\t\t\t\t\t\tcloseList = ci;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tvar current = li;\n\t\t\t\t\tif (bk.end) {\n\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\tif (checkLevel(current)) {\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\treturn node !== closeList\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar parentLi = current.parentNode,\n\t\t\t\t\t\t\t\tlist = me.document.createElement(parentLi.tagName),\n\t\t\t\t\t\t\t\tindex = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n\t\t\t\t\t\t\tvar currentIndex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n\t\t\t\t\t\t\tvar currentStyle = listStyle[list.tagName][currentIndex];\n\t\t\t\t\t\t\tsetListStyle(list, currentStyle);\n\t\t\t\t\t\t\tparentLi.insertBefore(list, current);\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tli = current.nextSibling;\n\t\t\t\t\t\t\t\tlist.appendChild(current);\n\t\t\t\t\t\t\t\tif (!li || domUtils.isTagNode(li, 'ol ul')) {\n\t\t\t\t\t\t\t\t\tif (li) {\n\t\t\t\t\t\t\t\t\t\twhile (li = li.firstChild) {\n\t\t\t\t\t\t\t\t\t\t\tif (li.tagName == 'LI') {\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tli = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\t\t\treturn node !== closeList\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tcurrent = li;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tadjustList(list, list.tagName.toLowerCase(), currentStyle);\n\t\t\t\t\t\t\tcurrent = li;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\trange.moveToBookmark(bk).select();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t});\n\n\t\tfunction getLi(start) {\n\t\t\twhile (start && !domUtils.isBody(start)) {\n\t\t\t\tif (start.nodeName == 'TABLE') {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tif (start.nodeName == 'LI') {\n\t\t\t\t\treturn start\n\t\t\t\t}\n\t\t\t\tstart = start.parentNode;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 有序列表，与“insertunorderedlist”命令互斥\n\t\t * @command insertorderedlist\n\t\t * @method execCommand\n\t\t * @param { String } command 命令字符串\n\t\t * @param { String } style 插入的有序列表类型，值为：decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertorderedlist','decimal');\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容是否有序列表\n\t\t * @command insertorderedlist\n\t\t * @method queryCommandState\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { int } 如果当前选区是有序列表返回1，否则返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'insertorderedlist' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容是否有序列表\n\t\t * @command insertorderedlist\n\t\t * @method queryCommandValue\n\t\t * @param { String } cmd 命令字符串\n\t\t * @return { String } 返回当前有序列表的类型，值为null或decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'insertorderedlist' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 无序列表，与“insertorderedlist”命令互斥\n\t\t * @command insertunorderedlist\n\t\t * @method execCommand\n\t\t * @param { String } command 命令字符串\n\t\t * @param { String } style 插入的无序列表类型，值为：circle,disc,square,dash,dot\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.execCommand( 'insertunorderedlist','circle');\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前是否有word文档粘贴进来的图片\n\t\t * @command insertunorderedlist\n\t\t * @method insertunorderedlist\n\t\t * @param { String } command 命令字符串\n\t\t * @return { int } 如果当前选区是无序列表返回1，否则返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandState( 'insertunorderedlist' );\n\t\t * ```\n\t\t */\n\t\t/**\n\t\t * 查询当前选区内容是否有序列表\n\t\t * @command insertunorderedlist\n\t\t * @method queryCommandValue\n\t\t * @param { String } command 命令字符串\n\t\t * @return { String } 返回当前无序列表的类型，值为null或circle,disc,square,dash,dot\n\t\t * @example\n\t\t * ```javascript\n\t\t * editor.queryCommandValue( 'insertunorderedlist' );\n\t\t * ```\n\t\t */\n\n\t\tme.commands['insertorderedlist'] =\n\t\t\tme.commands['insertunorderedlist'] = {\n\t\t\t\texecCommand: function(command, style) {\n\n\t\t\t\t\tif (!style) {\n\t\t\t\t\t\tstyle = command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc';\n\t\t\t\t\t}\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trange = this.selection.getRange(),\n\t\t\t\t\t\tfilterFn = function(node) {\n\t\t\t\t\t\t\treturn node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul',\n\t\t\t\t\t\tfrag = me.document.createDocumentFragment();\n\t\t\t\t\t//去掉是因为会出现选到末尾，导致adjustmentBoundary缩到ol/ul的位置\n\t\t\t\t\t//range.shrinkBoundary();//.adjustmentBoundary();\n\t\t\t\t\trange.adjustmentBoundary().shrinkBoundary();\n\t\t\t\t\tvar bko = range.createBookmark(true),\n\t\t\t\t\t\tstart = getLi(me.document.getElementById(bko.start)),\n\t\t\t\t\t\tmodifyStart = 0,\n\t\t\t\t\t\tend = getLi(me.document.getElementById(bko.end)),\n\t\t\t\t\t\tmodifyEnd = 0,\n\t\t\t\t\t\tstartParent, endParent,\n\t\t\t\t\t\tlist, tmp;\n\n\t\t\t\t\tif (start || end) {\n\t\t\t\t\t\tstart && (startParent = start.parentNode);\n\t\t\t\t\t\tif (!bko.end) {\n\t\t\t\t\t\t\tend = start;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tend && (endParent = end.parentNode);\n\n\t\t\t\t\t\tif (startParent === endParent) {\n\t\t\t\t\t\t\twhile (start !== end) {\n\t\t\t\t\t\t\t\ttmp = start;\n\t\t\t\t\t\t\t\tstart = start.nextSibling;\n\t\t\t\t\t\t\t\tif (!domUtils.isBlockElm(tmp.firstChild)) {\n\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\twhile (tmp.firstChild) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(tmp.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttmp.appendChild(p);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfrag.appendChild(tmp);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmp = me.document.createElement('span');\n\t\t\t\t\t\t\tstartParent.insertBefore(tmp, end);\n\t\t\t\t\t\t\tif (!domUtils.isBlockElm(end.firstChild)) {\n\t\t\t\t\t\t\t\tp = me.document.createElement('p');\n\t\t\t\t\t\t\t\twhile (end.firstChild) {\n\t\t\t\t\t\t\t\t\tp.appendChild(end.firstChild);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tend.appendChild(p);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfrag.appendChild(end);\n\t\t\t\t\t\t\tdomUtils.breakParent(tmp, startParent);\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(tmp.previousSibling)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(tmp.previousSibling);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(tmp.nextSibling)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(tmp.nextSibling)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar nodeStyle = getStyle(startParent) || domUtils.getComputedStyle(startParent, 'list-style-type') || (command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc');\n\t\t\t\t\t\t\tif (startParent.tagName.toLowerCase() == tag && nodeStyle == style) {\n\t\t\t\t\t\t\t\tfor (var i = 0, ci, tmpFrag = me.document.createDocumentFragment(); ci = frag.firstChild;) {\n\t\t\t\t\t\t\t\t\tif (domUtils.isTagNode(ci, 'ol ul')) {\n\t\t\t\t\t\t\t\t\t\t//                                  删除时，子列表不处理\n\t\t\t\t\t\t\t\t\t\t//                                  utils.each(domUtils.getElementsByTagName(ci,'li'),function(li){\n\t\t\t\t\t\t\t\t\t\t//                                        while(li.firstChild){\n\t\t\t\t\t\t\t\t\t\t//                                            tmpFrag.appendChild(li.firstChild);\n\t\t\t\t\t\t\t\t\t\t//                                        }\n\t\t\t\t\t\t\t\t\t\t//\n\t\t\t\t\t\t\t\t\t\t//                                    });\n\t\t\t\t\t\t\t\t\t\ttmpFrag.appendChild(ci);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\twhile (ci.firstChild) {\n\n\t\t\t\t\t\t\t\t\t\t\ttmpFrag.appendChild(ci.firstChild);\n\t\t\t\t\t\t\t\t\t\t\tdomUtils.remove(ci);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmp.parentNode.insertBefore(tmpFrag, tmp);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlist = me.document.createElement(tag);\n\t\t\t\t\t\t\t\tsetListStyle(list, style);\n\t\t\t\t\t\t\t\tlist.appendChild(frag);\n\t\t\t\t\t\t\t\ttmp.parentNode.insertBefore(list, tmp);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tdomUtils.remove(tmp);\n\t\t\t\t\t\t\tlist && adjustList(list, tag, style);\n\t\t\t\t\t\t\trange.moveToBookmark(bko).select();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//开始\n\t\t\t\t\t\tif (start) {\n\t\t\t\t\t\t\twhile (start) {\n\t\t\t\t\t\t\t\ttmp = start.nextSibling;\n\t\t\t\t\t\t\t\tif (domUtils.isTagNode(start, 'ol ul')) {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(start);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tvar tmpfrag = me.document.createDocumentFragment(),\n\t\t\t\t\t\t\t\t\t\thasBlock = 0;\n\t\t\t\t\t\t\t\t\twhile (start.firstChild) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isBlockElm(start.firstChild)) {\n\t\t\t\t\t\t\t\t\t\t\thasBlock = 1;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ttmpfrag.appendChild(start.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!hasBlock) {\n\t\t\t\t\t\t\t\t\t\tvar tmpP = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\ttmpP.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpP);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tstart = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstartParent.parentNode.insertBefore(frag, startParent.nextSibling);\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(startParent)) {\n\t\t\t\t\t\t\t\trange.setStartBefore(startParent);\n\t\t\t\t\t\t\t\tdomUtils.remove(startParent);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.setStartAfter(startParent);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmodifyStart = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (end && domUtils.inDoc(endParent, me.document)) {\n\t\t\t\t\t\t\t//结束\n\t\t\t\t\t\t\tstart = endParent.firstChild;\n\t\t\t\t\t\t\twhile (start && start !== end) {\n\t\t\t\t\t\t\t\ttmp = start.nextSibling;\n\t\t\t\t\t\t\t\tif (domUtils.isTagNode(start, 'ol ul')) {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(start);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttmpfrag = me.document.createDocumentFragment();\n\t\t\t\t\t\t\t\t\thasBlock = 0;\n\t\t\t\t\t\t\t\t\twhile (start.firstChild) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isBlockElm(start.firstChild)) {\n\t\t\t\t\t\t\t\t\t\t\thasBlock = 1;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\ttmpfrag.appendChild(start.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (!hasBlock) {\n\t\t\t\t\t\t\t\t\t\ttmpP = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\ttmpP.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpP);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tfrag.appendChild(tmpfrag);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstart = tmp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar tmpDiv = domUtils.createElement(me.document, 'div', {\n\t\t\t\t\t\t\t\t'tmpDiv': 1\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tdomUtils.moveChild(end, tmpDiv);\n\n\t\t\t\t\t\t\tfrag.appendChild(tmpDiv);\n\t\t\t\t\t\t\tdomUtils.remove(end);\n\t\t\t\t\t\t\tendParent.parentNode.insertBefore(frag, endParent);\n\t\t\t\t\t\t\trange.setEndBefore(endParent);\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(endParent)) {\n\t\t\t\t\t\t\t\tdomUtils.remove(endParent);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmodifyEnd = 1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!modifyStart) {\n\t\t\t\t\t\trange.setStartBefore(me.document.getElementById(bko.start));\n\t\t\t\t\t}\n\t\t\t\t\tif (bko.end && !modifyEnd) {\n\t\t\t\t\t\trange.setEndAfter(me.document.getElementById(bko.end));\n\t\t\t\t\t}\n\t\t\t\t\trange.enlarge(true, function(node) {\n\t\t\t\t\t\treturn notExchange[node.tagName];\n\t\t\t\t\t});\n\n\t\t\t\t\tfrag = me.document.createDocumentFragment();\n\n\t\t\t\t\tvar bk = range.createBookmark(),\n\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bk.start, false, filterFn),\n\t\t\t\t\t\ttmpRange = range.cloneRange(),\n\t\t\t\t\t\ttmpNode,\n\t\t\t\t\t\tblock = domUtils.isBlockElm;\n\n\t\t\t\t\twhile (current && current !== bk.end && (domUtils.getPosition(current, bk.end) & domUtils.POSITION_PRECEDING)) {\n\n\t\t\t\t\t\tif (current.nodeType == 3 || dtd.li[current.tagName]) {\n\t\t\t\t\t\t\tif (current.nodeType == 1 && dtd.$list[current.tagName]) {\n\t\t\t\t\t\t\t\twhile (current.firstChild) {\n\t\t\t\t\t\t\t\t\tfrag.appendChild(current.firstChild);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttmpNode = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t\t\tcurrent = tmpNode;\n\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\ttmpRange.setStartBefore(current);\n\n\t\t\t\t\t\t\twhile (current && current !== bk.end && (!block(current) || domUtils.isBookmarkNode(current))) {\n\t\t\t\t\t\t\t\ttmpNode = current;\n\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, null, function(node) {\n\t\t\t\t\t\t\t\t\treturn !notExchange[node.tagName];\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (current && block(current)) {\n\t\t\t\t\t\t\t\ttmp = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\t\t\t\t\t\t\t\tif (tmp && domUtils.isBookmarkNode(tmp)) {\n\t\t\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(tmp, false, filterFn);\n\t\t\t\t\t\t\t\t\ttmpNode = tmp;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttmpRange.setEndAfter(tmpNode);\n\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\n\t\t\t\t\t\t\tvar li = range.document.createElement('li');\n\n\t\t\t\t\t\t\tli.appendChild(tmpRange.extractContents());\n\t\t\t\t\t\t\tif (domUtils.isEmptyNode(li)) {\n\t\t\t\t\t\t\t\tvar tmpNode = range.document.createElement('p');\n\t\t\t\t\t\t\t\twhile (li.firstChild) {\n\t\t\t\t\t\t\t\t\ttmpNode.appendChild(li.firstChild)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tli.appendChild(tmpNode);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfrag.appendChild(li);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, true, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bk).collapse(true);\n\t\t\t\t\tlist = me.document.createElement(tag);\n\t\t\t\t\tsetListStyle(list, style);\n\t\t\t\t\tlist.appendChild(frag);\n\t\t\t\t\trange.insertNode(list);\n\t\t\t\t\t//当前list上下看能否合并\n\t\t\t\t\tadjustList(list, tag, style);\n\t\t\t\t\t//去掉冗余的tmpDiv\n\t\t\t\t\tfor (var i = 0, ci, tmpDivs = domUtils.getElementsByTagName(list, 'div'); ci = tmpDivs[i++];) {\n\t\t\t\t\t\tif (ci.getAttribute('tmpDiv')) {\n\t\t\t\t\t\t\tdomUtils.remove(ci, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bko).select();\n\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function(command) {\n\t\t\t\t\tvar tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t\t\t\t\tvar path = this.selection.getStartElementPath();\n\t\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\t\tif (ci.nodeName == 'TABLE') {\n\t\t\t\t\t\t\treturn 0\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tag == ci.nodeName.toLowerCase()) {\n\t\t\t\t\t\t\treturn 1\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn 0;\n\n\t\t\t\t},\n\t\t\t\tqueryCommandValue: function(command) {\n\t\t\t\t\tvar tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n\t\t\t\t\tvar path = this.selection.getStartElementPath(),\n\t\t\t\t\t\tnode;\n\t\t\t\t\tfor (var i = 0, ci; ci = path[i++];) {\n\t\t\t\t\t\tif (ci.nodeName == 'TABLE') {\n\t\t\t\t\t\t\tnode = null;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tag == ci.nodeName.toLowerCase()) {\n\t\t\t\t\t\t\tnode = ci;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\treturn node ? getStyle(node) || domUtils.getComputedStyle(node, 'list-style-type') : null;\n\t\t\t\t}\n\t\t\t};\n\t};\n\n\t// plugins/source.js\n\t/**\n\t * 源码编辑插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t(function() {\n\t\tvar sourceEditors = {\n\t\t\ttextarea: function(editor, holder) {\n\t\t\t\tvar textarea = holder.ownerDocument.createElement('textarea');\n\t\t\t\ttextarea.style.cssText = 'position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;';\n\t\t\t\t// todo: IE下只有onresize属性可用... 很纠结\n\t\t\t\tif (browser.ie && browser.version < 8) {\n\t\t\t\t\ttextarea.style.width = holder.offsetWidth + 'px';\n\t\t\t\t\ttextarea.style.height = holder.offsetHeight + 'px';\n\t\t\t\t\tholder.onresize = function() {\n\t\t\t\t\t\ttextarea.style.width = holder.offsetWidth + 'px';\n\t\t\t\t\t\ttextarea.style.height = holder.offsetHeight + 'px';\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tholder.appendChild(textarea);\n\t\t\t\treturn {\n\t\t\t\t\tsetContent: function(content) {\n\t\t\t\t\t\ttextarea.value = content;\n\t\t\t\t\t},\n\t\t\t\t\tgetContent: function() {\n\t\t\t\t\t\treturn textarea.value;\n\t\t\t\t\t},\n\t\t\t\t\tselect: function() {\n\t\t\t\t\t\tvar range;\n\t\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\t\trange = textarea.createTextRange();\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\trange.select();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//todo: chrome下无法设置焦点\n\t\t\t\t\t\t\ttextarea.setSelectionRange(0, 0);\n\t\t\t\t\t\t\ttextarea.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tdispose: function() {\n\t\t\t\t\t\tholder.removeChild(textarea);\n\t\t\t\t\t\t// todo\n\t\t\t\t\t\tholder.onresize = null;\n\t\t\t\t\t\ttextarea = null;\n\t\t\t\t\t\tholder = null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tcodemirror: function(editor, holder) {\n\n\t\t\t\tvar codeEditor = window.CodeMirror(holder, {\n\t\t\t\t\tmode: \"text/html\",\n\t\t\t\t\ttabMode: \"indent\",\n\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\tlineWrapping: true\n\t\t\t\t});\n\t\t\t\tvar dom = codeEditor.getWrapperElement();\n\t\t\t\tdom.style.cssText = 'position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,\"Courier new\",monospace;font-size:13px;';\n\t\t\t\tcodeEditor.getScrollerElement().style.cssText = 'position:absolute;left:0;top:0;width:100%;height:100%;';\n\t\t\t\tcodeEditor.refresh();\n\t\t\t\treturn {\n\t\t\t\t\tgetCodeMirror: function() {\n\t\t\t\t\t\treturn codeEditor;\n\t\t\t\t\t},\n\t\t\t\t\tsetContent: function(content) {\n\t\t\t\t\t\tcodeEditor.setValue(content);\n\t\t\t\t\t},\n\t\t\t\t\tgetContent: function() {\n\t\t\t\t\t\treturn codeEditor.getValue();\n\t\t\t\t\t},\n\t\t\t\t\tselect: function() {\n\t\t\t\t\t\tcodeEditor.focus();\n\t\t\t\t\t},\n\t\t\t\t\tdispose: function() {\n\t\t\t\t\t\tholder.removeChild(dom);\n\t\t\t\t\t\tdom = null;\n\t\t\t\t\t\tcodeEditor = null;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tUE.plugins['source'] = function() {\n\t\t\tvar me = this;\n\t\t\tvar opt = this.options;\n\t\t\tvar sourceMode = false;\n\t\t\tvar sourceEditor;\n\t\t\tvar orgSetContent;\n\t\t\topt.sourceEditor = browser.ie ? 'textarea' : (opt.sourceEditor || 'codemirror');\n\n\t\t\tme.setOpt({\n\t\t\t\tsourceEditorFirst: false\n\t\t\t});\n\n\t\t\tfunction createSourceEditor(holder) {\n\t\t\t\treturn sourceEditors[opt.sourceEditor == 'codemirror' && window.CodeMirror ? 'codemirror' : 'textarea'](me, holder);\n\t\t\t}\n\n\t\t\tvar bakCssText;\n\t\t\t//解决在源码模式下getContent不能得到最新的内容问题\n\t\t\tvar oldGetContent,\n\t\t\t\tbakAddress;\n\n\t\t\t/**\n\t\t\t * 切换源码模式和编辑模式\n\t\t\t * @command source\n\t\t\t * @method execCommand\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.execCommand( 'source');\n\t\t\t * ```\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * 查询当前编辑区域的状态是源码模式还是可视化模式\n\t\t\t * @command source\n\t\t\t * @method queryCommandState\n\t\t\t * @param { String } cmd 命令字符串\n\t\t\t * @return { int } 如果当前是源码编辑模式，返回1，否则返回0\n\t\t\t * @example\n\t\t\t * ```javascript\n\t\t\t * editor.queryCommandState( 'source' );\n\t\t\t * ```\n\t\t\t */\n\n\t\t\tme.commands['source'] = {\n\t\t\t\texecCommand: function() {\n\n\t\t\t\t\tsourceMode = !sourceMode;\n\t\t\t\t\tif (sourceMode) {\n\t\t\t\t\t\tbakAddress = me.selection.getRange().createAddress(false, true);\n\t\t\t\t\t\tme.undoManger && me.undoManger.save(true);\n\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbakCssText = me.iframe.style.cssText;\n\t\t\t\t\t\tme.iframe.style.cssText += 'position:absolute;left:-32768px;top:-32768px;';\n\n\t\t\t\t\t\tme.fireEvent('beforegetcontent');\n\t\t\t\t\t\tvar root = UE.htmlparser(me.body.innerHTML);\n\t\t\t\t\t\tme.filterOutputRule(root);\n\t\t\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\t\t\tif (node.type == 'element') {\n\t\t\t\t\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\t\t\t\t\tcase 'td':\n\t\t\t\t\t\t\t\t\tcase 'th':\n\t\t\t\t\t\t\t\t\tcase 'caption':\n\t\t\t\t\t\t\t\t\t\tif (node.children && node.children.length == 1) {\n\t\t\t\t\t\t\t\t\t\t\tif (node.firstChild().tagName == 'br') {\n\t\t\t\t\t\t\t\t\t\t\t\tnode.removeChild(node.firstChild())\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcase 'pre':\n\t\t\t\t\t\t\t\t\t\tnode.innerText(node.innerText().replace(/&nbsp;/g, ' '))\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tme.fireEvent('aftergetcontent');\n\n\t\t\t\t\t\tvar content = root.toHtml(true);\n\n\t\t\t\t\t\tsourceEditor = createSourceEditor(me.iframe.parentNode);\n\n\t\t\t\t\t\tsourceEditor.setContent(content);\n\n\t\t\t\t\t\torgSetContent = me.setContent;\n\n\t\t\t\t\t\tme.setContent = function(html) {\n\t\t\t\t\t\t\t//这里暂时不触发事件，防止报错\n\t\t\t\t\t\t\tvar root = UE.htmlparser(html);\n\t\t\t\t\t\t\tme.filterInputRule(root);\n\t\t\t\t\t\t\thtml = root.toHtml();\n\t\t\t\t\t\t\tsourceEditor.setContent(html);\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tsourceEditor.select();\n\t\t\t\t\t\t\tme.addListener('fullscreenchanged', function() {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tsourceEditor.getCodeMirror().refresh()\n\t\t\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t//重置getContent，源码模式下取值也能是最新的数据\n\t\t\t\t\t\toldGetContent = me.getContent;\n\t\t\t\t\t\tme.getContent = function() {\n\t\t\t\t\t\t\treturn sourceEditor.getContent() || '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.iframe.style.cssText = bakCssText;\n\t\t\t\t\t\tvar cont = sourceEditor.getContent() || '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t//处理掉block节点前后的空格,有可能会误命中，暂时不考虑\n\t\t\t\t\t\tcont = cont.replace(new RegExp('[\\\\r\\\\t\\\\n ]*<\\/?(\\\\w+)\\\\s*(?:[^>]*)>', 'g'), function(a, b) {\n\t\t\t\t\t\t\tif (b && !dtd.$inlineWithA[b.toLowerCase()]) {\n\t\t\t\t\t\t\t\treturn a.replace(/(^[\\n\\r\\t ]*)|([\\n\\r\\t ]*$)/g, '');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn a.replace(/(^[\\n\\r\\t]*)|([\\n\\r\\t]*$)/g, '')\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tme.setContent = orgSetContent;\n\n\t\t\t\t\t\tme.setContent(cont);\n\t\t\t\t\t\tsourceEditor.dispose();\n\t\t\t\t\t\tsourceEditor = null;\n\t\t\t\t\t\t//还原getContent方法\n\t\t\t\t\t\tme.getContent = oldGetContent;\n\t\t\t\t\t\tvar first = me.body.firstChild;\n\t\t\t\t\t\t//trace:1106 都删除空了，下边会报错，所以补充一个p占位\n\t\t\t\t\t\tif (!first) {\n\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\tfirst = me.body.firstChild;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//要在ifm为显示时ff才能取到selection,否则报错\n\t\t\t\t\t\t//这里不能比较位置了\n\t\t\t\t\t\tme.undoManger && me.undoManger.save(true);\n\n\t\t\t\t\t\tif (browser.gecko) {\n\n\t\t\t\t\t\t\tvar input = document.createElement('input');\n\t\t\t\t\t\t\tinput.style.cssText = 'position:absolute;left:0;top:-32768px';\n\n\t\t\t\t\t\t\tdocument.body.appendChild(input);\n\n\t\t\t\t\t\t\tme.body.contentEditable = false;\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tdomUtils.setViewportOffset(input, {\n\t\t\t\t\t\t\t\t\tleft: -32768,\n\t\t\t\t\t\t\t\t\ttop: 0\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\t\tme.body.contentEditable = true;\n\t\t\t\t\t\t\t\t\tme.selection.getRange().moveToAddress(bakAddress).select(true);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(input);\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//ie下有可能报错，比如在代码顶头的情况\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tme.selection.getRange().moveToAddress(bakAddress).select(true);\n\t\t\t\t\t\t\t} catch (e) {}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.fireEvent('sourcemodechanged', sourceMode);\n\t\t\t\t},\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn sourceMode | 0;\n\t\t\t\t},\n\t\t\t\tnotNeedUndo: 1\n\t\t\t};\n\t\t\tvar oldQueryCommandState = me.queryCommandState;\n\n\t\t\tme.queryCommandState = function(cmdName) {\n\t\t\t\tcmdName = cmdName.toLowerCase();\n\t\t\t\tif (sourceMode) {\n\t\t\t\t\t//源码模式下可以开启的命令\n\t\t\t\t\treturn cmdName in {\n\t\t\t\t\t\t'source': 1,\n\t\t\t\t\t\t'fullscreen': 1\n\t\t\t\t\t} ? 1 : -1\n\t\t\t\t}\n\t\t\t\treturn oldQueryCommandState.apply(this, arguments);\n\t\t\t};\n\n\t\t\tif (opt.sourceEditor == \"codemirror\") {\n\n\t\t\t\tme.addListener(\"ready\", function() {\n\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\tsrc: opt.codeMirrorJsUrl || opt.UEDITOR_HOME_URL + \"third-party/codemirror/codemirror.js\",\n\t\t\t\t\t\ttag: \"script\",\n\t\t\t\t\t\ttype: \"text/javascript\",\n\t\t\t\t\t\tdefer: \"defer\"\n\t\t\t\t\t}, function() {\n\t\t\t\t\t\tif (opt.sourceEditorFirst) {\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\tme.execCommand(\"source\");\n\t\t\t\t\t\t\t}, 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tutils.loadFile(document, {\n\t\t\t\t\t\ttag: \"link\",\n\t\t\t\t\t\trel: \"stylesheet\",\n\t\t\t\t\t\ttype: \"text/css\",\n\t\t\t\t\t\thref: opt.codeMirrorCssUrl || opt.UEDITOR_HOME_URL + \"third-party/codemirror/codemirror.css\"\n\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t}\n\n\t\t};\n\n\t})();\n\n\t// plugins/enterkey.js\n\t///import core\n\t///import plugins/undo.js\n\t///commands 设置回车标签p或br\n\t///commandsName  EnterKey\n\t///commandsTitle  设置回车标签p或br\n\t/**\n\t * @description 处理回车\n\t * @author zhanyi\n\t */\n\tUE.plugins['enterkey'] = function() {\n\t\tvar hTag,\n\t\t\tme = this,\n\t\t\ttag = me.options.enterTag;\n\t\tme.addListener('keyup', function(type, evt) {\n\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13) {\n\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\tstart = range.startContainer,\n\t\t\t\t\tdoSave;\n\n\t\t\t\t//修正在h1-h6里边回车后不能嵌套p的问题\n\t\t\t\tif (!browser.ie) {\n\n\t\t\t\t\tif (/h\\d/i.test(hTag)) {\n\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\tvar h = domUtils.findParentByTagName(start, ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'caption', 'table'], true);\n\t\t\t\t\t\t\tif (!h) {\n\t\t\t\t\t\t\t\tme.document.execCommand('formatBlock', false, '<p>');\n\t\t\t\t\t\t\t\tdoSave = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t//chrome remove div\n\t\t\t\t\t\t\tif (start.nodeType == 1) {\n\t\t\t\t\t\t\t\tvar tmp = me.document.createTextNode(''),\n\t\t\t\t\t\t\t\t\tdiv;\n\t\t\t\t\t\t\t\trange.insertNode(tmp);\n\t\t\t\t\t\t\t\tdiv = domUtils.findParentByTagName(tmp, 'div', true);\n\t\t\t\t\t\t\t\tif (div) {\n\t\t\t\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\twhile (div.firstChild) {\n\t\t\t\t\t\t\t\t\t\tp.appendChild(div.firstChild);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tdiv.parentNode.insertBefore(p, div);\n\t\t\t\t\t\t\t\t\tdomUtils.remove(div);\n\t\t\t\t\t\t\t\t\trange.setStartBefore(tmp).setCursor();\n\t\t\t\t\t\t\t\t\tdoSave = 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(tmp);\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (me.undoManger && doSave) {\n\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//没有站位符，会出现多行的问题\n\t\t\t\t\tbrowser.opera && range.select();\n\t\t\t\t} else {\n\t\t\t\t\tme.fireEvent('saveScene', true, true)\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('keydown', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\tif (keyCode == 13) { //回车\n\t\t\t\tif (me.fireEvent('beforeenterkeydown')) {\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tme.fireEvent('saveScene', true, true);\n\t\t\t\thTag = '';\n\n\t\t\t\tvar range = me.selection.getRange();\n\n\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t//跨td不能删\n\t\t\t\t\tvar start = range.startContainer,\n\t\t\t\t\t\tend = range.endContainer,\n\t\t\t\t\t\tstartTd = domUtils.findParentByTagName(start, 'td', true),\n\t\t\t\t\t\tendTd = domUtils.findParentByTagName(end, 'td', true);\n\t\t\t\t\tif (startTd && endTd && startTd !== endTd || !startTd && endTd || startTd && !endTd) {\n\t\t\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (tag == 'p') {\n\n\t\t\t\t\tif (!browser.ie) {\n\n\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, ['ol', 'ul', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'caption'], true);\n\n\t\t\t\t\t\t//opera下执行formatblock会在table的场景下有问题，回车在opera原生支持很好，所以暂时在opera去掉调用这个原生的command\n\t\t\t\t\t\t//trace:2431\n\t\t\t\t\t\tif (!start && !browser.opera) {\n\n\t\t\t\t\t\t\tme.document.execCommand('formatBlock', false, '<p>');\n\n\t\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'p', true);\n\t\t\t\t\t\t\t\tstart && domUtils.removeDirtyAttr(start);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thTag = start.tagName;\n\t\t\t\t\t\t\tstart.tagName.toLowerCase() == 'p' && browser.gecko && domUtils.removeDirtyAttr(start);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\tif (start.nodeType == 1 && (start = start.childNodes[range.startOffset])) {\n\t\t\t\t\t\t\twhile (start.nodeType == 1) {\n\t\t\t\t\t\t\t\tif (dtd.$empty[start.tagName]) {\n\t\t\t\t\t\t\t\t\trange.setStartBefore(start).setCursor();\n\t\t\t\t\t\t\t\t\tif (me.undoManger) {\n\t\t\t\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!start.firstChild) {\n\t\t\t\t\t\t\t\t\tvar br = range.document.createElement('br');\n\t\t\t\t\t\t\t\t\tstart.appendChild(br);\n\t\t\t\t\t\t\t\t\trange.setStart(start, 0).setCursor();\n\t\t\t\t\t\t\t\t\tif (me.undoManger) {\n\t\t\t\t\t\t\t\t\t\tme.undoManger.save();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstart = start.firstChild;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (start === range.startContainer.childNodes[range.startOffset]) {\n\t\t\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\t\t\trange.insertNode(br).setCursor();\n\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.setStart(start, 0).setCursor();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\t\trange.insertNode(br).setStartAfter(br).setCursor();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbr = range.document.createElement('br');\n\t\t\t\t\t\trange.insertNode(br);\n\t\t\t\t\t\tvar parent = br.parentNode;\n\t\t\t\t\t\tif (parent.lastChild === br) {\n\t\t\t\t\t\t\tbr.parentNode.insertBefore(br.cloneNode(true), br);\n\t\t\t\t\t\t\trange.setStartBefore(br);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.setStartAfter(br);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.setCursor();\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/keystrokes.js\n\t/* 处理特殊键的兼容性问题 */\n\tUE.plugins['keystrokes'] = function() {\n\t\tvar me = this;\n\t\tvar collapsed = true;\n\t\tme.addListener('keydown', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which,\n\t\t\t\trng = me.selection.getRange();\n\n\t\t\t//处理全选的情况\n\t\t\tif (!rng.collapsed && !(evt.ctrlKey || evt.shiftKey || evt.altKey || evt.metaKey) && (keyCode >= 65 && keyCode <= 90 || keyCode >= 48 && keyCode <= 57 ||\n\t\t\t\t\tkeyCode >= 96 && keyCode <= 111 || {\n\t\t\t\t\t\t13: 1,\n\t\t\t\t\t\t8: 1,\n\t\t\t\t\t\t46: 1\n\t\t\t\t\t}[keyCode])) {\n\n\t\t\t\tvar tmpNode = rng.startContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trng.setStartBefore(tmpNode)\n\t\t\t\t}\n\t\t\t\ttmpNode = rng.endContainer;\n\t\t\t\tif (domUtils.isFillChar(tmpNode)) {\n\t\t\t\t\trng.setEndAfter(tmpNode)\n\t\t\t\t}\n\t\t\t\trng.txtToElmBoundary();\n\t\t\t\t//结束边界可能放到了br的前边，要把br包含进来\n\t\t\t\t// x[xxx]<br/>\n\t\t\t\tif (rng.endContainer && rng.endContainer.nodeType == 1) {\n\t\t\t\t\ttmpNode = rng.endContainer.childNodes[rng.endOffset];\n\t\t\t\t\tif (tmpNode && domUtils.isBr(tmpNode)) {\n\t\t\t\t\t\trng.setEndAfter(tmpNode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (rng.startOffset == 0) {\n\t\t\t\t\ttmpNode = rng.startContainer;\n\t\t\t\t\tif (domUtils.isBoundaryNode(tmpNode, 'firstChild')) {\n\t\t\t\t\t\ttmpNode = rng.endContainer;\n\t\t\t\t\t\tif (rng.endOffset == (tmpNode.nodeType == 3 ? tmpNode.nodeValue.length : tmpNode.childNodes.length) && domUtils.isBoundaryNode(tmpNode, 'lastChild')) {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tme.body.innerHTML = '<p>' + (browser.ie ? '' : '<br/>') + '</p>';\n\t\t\t\t\t\t\trng.setStart(me.body.firstChild, 0).setCursor(false, true);\n\t\t\t\t\t\t\tme._selectionChange();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//处理backspace\n\t\t\tif (keyCode == keymap.Backspace) {\n\t\t\t\trng = me.selection.getRange();\n\t\t\t\tcollapsed = rng.collapsed;\n\t\t\t\tif (me.fireEvent('delkeydown', evt)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar start, end;\n\t\t\t\t//避免按两次删除才能生效的问题\n\t\t\t\tif (rng.collapsed && rng.inFillChar()) {\n\t\t\t\t\tstart = rng.startContainer;\n\n\t\t\t\t\tif (domUtils.isFillChar(start)) {\n\t\t\t\t\t\trng.setStartBefore(start).shrinkBoundary(true).collapse(true);\n\t\t\t\t\t\tdomUtils.remove(start)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstart.nodeValue = start.nodeValue.replace(new RegExp('^' + domUtils.fillChar), '');\n\t\t\t\t\t\trng.startOffset--;\n\t\t\t\t\t\trng.collapse(true).select(true)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//解决选中control元素不能删除的问题\n\t\t\t\tif (start = rng.getClosedNode()) {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\trng.setStartBefore(start);\n\t\t\t\t\tdomUtils.remove(start);\n\t\t\t\t\trng.setCursor();\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//阻止在table上的删除\n\t\t\t\tif (!browser.ie) {\n\t\t\t\t\tstart = domUtils.findParentByTagName(rng.startContainer, 'table', true);\n\t\t\t\t\tend = domUtils.findParentByTagName(rng.endContainer, 'table', true);\n\t\t\t\t\tif (start && !end || !start && end || start !== end) {\n\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t\t//处理tab键的逻辑\n\t\t\tif (keyCode == keymap.Tab) {\n\t\t\t\t//不处理以下标签\n\t\t\t\tvar excludeTagNameForTabKey = {\n\t\t\t\t\t'ol': 1,\n\t\t\t\t\t'ul': 1,\n\t\t\t\t\t'table': 1\n\t\t\t\t};\n\t\t\t\t//处理组件里的tab按下事件\n\t\t\t\tif (me.fireEvent('tabkeydown', evt)) {\n\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\tfor (var i = 0, txt = '', tabSize = me.options.tabSize || 4, tabNode = me.options.tabNode || '&nbsp;'; i < tabSize; i++) {\n\t\t\t\t\ttxt += tabNode;\n\t\t\t\t}\n\t\t\t\tvar span = me.document.createElement('span');\n\t\t\t\tspan.innerHTML = txt + domUtils.fillChar;\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\trange.insertNode(span.cloneNode(true).firstChild).setCursor(true);\n\t\t\t\t} else {\n\t\t\t\t\tvar filterFn = function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node) && !excludeTagNameForTabKey[node.tagName.toLowerCase()]\n\n\t\t\t\t\t};\n\t\t\t\t\t//普通的情况\n\t\t\t\t\tstart = domUtils.findParent(range.startContainer, filterFn, true);\n\t\t\t\t\tend = domUtils.findParent(range.endContainer, filterFn, true);\n\t\t\t\t\tif (start && end && start === end) {\n\t\t\t\t\t\trange.deleteContents();\n\t\t\t\t\t\trange.insertNode(span.cloneNode(true).firstChild).setCursor(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar bookmark = range.createBookmark();\n\t\t\t\t\t\trange.enlarge(true);\n\t\t\t\t\t\tvar bookmark2 = range.createBookmark(),\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(bookmark2.start, false, filterFn);\n\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\tcurrent.insertBefore(span.cloneNode(true).firstChild, current.firstChild);\n\t\t\t\t\t\t\tcurrent = domUtils.getNextDomNode(current, false, filterFn);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.moveToBookmark(bookmark2).moveToBookmark(bookmark).select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdomUtils.preventDefault(evt)\n\t\t\t}\n\t\t\t//trace:1634\n\t\t\t//ff的del键在容器空的时候，也会删除\n\t\t\tif (browser.gecko && keyCode == 46) {\n\t\t\t\trange = me.selection.getRange();\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\tif (domUtils.isEmptyBlock(start)) {\n\t\t\t\t\t\tvar parent = start.parentNode;\n\t\t\t\t\t\twhile (domUtils.getChildCount(parent) == 1 && !domUtils.isBody(parent)) {\n\t\t\t\t\t\t\tstart = parent;\n\t\t\t\t\t\t\tparent = parent.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (start === parent.lastChild)\n\t\t\t\t\t\t\tevt.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which,\n\t\t\t\trng, me = this;\n\t\t\tif (keyCode == keymap.Backspace) {\n\t\t\t\tif (me.fireEvent('delkeyup')) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\trng = me.selection.getRange();\n\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\tvar tmpNode,\n\t\t\t\t\t\tautoClearTagName = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\t\t\t\t\tif (tmpNode = domUtils.findParentByTagName(rng.startContainer, autoClearTagName, true)) {\n\t\t\t\t\t\tif (domUtils.isEmptyBlock(tmpNode)) {\n\t\t\t\t\t\t\tvar pre = tmpNode.previousSibling;\n\t\t\t\t\t\t\tif (pre && pre.nodeName != 'TABLE') {\n\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\trng.setStartAtLast(pre).setCursor(false, true);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar next = tmpNode.nextSibling;\n\t\t\t\t\t\t\t\tif (next && next.nodeName != 'TABLE') {\n\t\t\t\t\t\t\t\t\tdomUtils.remove(tmpNode);\n\t\t\t\t\t\t\t\t\trng.setStartAtFirst(next).setCursor(false, true);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//处理当删除到body时，要重新给p标签展位\n\t\t\t\t\tif (domUtils.isBody(rng.startContainer)) {\n\t\t\t\t\t\tvar tmpNode = domUtils.createElement(me.document, 'p', {\n\t\t\t\t\t\t\t'innerHTML': browser.ie ? domUtils.fillChar : '<br/>'\n\t\t\t\t\t\t});\n\t\t\t\t\t\trng.insertNode(tmpNode).setStart(tmpNode, 0).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//chrome下如果删除了inline标签，浏览器会有记忆，在输入文字还是会套上刚才删除的标签，所以这里再选一次就不会了\n\t\t\t\tif (!collapsed && (rng.startContainer.nodeType == 3 || rng.startContainer.nodeType == 1 && domUtils.isEmptyBlock(rng.startContainer))) {\n\t\t\t\t\tif (browser.ie) {\n\t\t\t\t\t\tvar span = rng.document.createElement('span');\n\t\t\t\t\t\trng.insertNode(span).setStartBefore(span).collapse(true);\n\t\t\t\t\t\trng.select();\n\t\t\t\t\t\tdomUtils.remove(span)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.select()\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t})\n\t};\n\n\t// plugins/fiximgclick.js\n\t///import core\n\t///commands 修复chrome下图片不能点击的问题，出现八个角可改变大小\n\t///commandsName  FixImgClick\n\t///commandsTitle  修复chrome下图片不能点击的问题，出现八个角可改变大小\n\t//修复chrome下图片不能点击的问题，出现八个角可改变大小\n\n\tUE.plugins['fiximgclick'] = (function() {\n\n\t\tvar elementUpdated = false;\n\n\t\tfunction Scale() {\n\t\t\tthis.editor = null;\n\t\t\tthis.resizer = null;\n\t\t\tthis.cover = null;\n\t\t\tthis.doc = document;\n\t\t\tthis.prePos = {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t};\n\t\t\tthis.startPos = {\n\t\t\t\tx: 0,\n\t\t\t\ty: 0\n\t\t\t};\n\t\t}\n\n\t\t(function() {\n\t\t\tvar rect = [\n\t\t\t\t//[left, top, width, height]\n\t\t\t\t[0, 0, -1, -1],\n\t\t\t\t[0, 0, 0, -1],\n\t\t\t\t[0, 0, 1, -1],\n\t\t\t\t[0, 0, -1, 0],\n\t\t\t\t[0, 0, 1, 0],\n\t\t\t\t[0, 0, -1, 1],\n\t\t\t\t[0, 0, 0, 1],\n\t\t\t\t[0, 0, 1, 1]\n\t\t\t];\n\n\t\t\tScale.prototype = {\n\t\t\t\tinit: function(editor) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.editor = editor;\n\t\t\t\t\tme.startPos = this.prePos = {\n\t\t\t\t\t\tx: 0,\n\t\t\t\t\t\ty: 0\n\t\t\t\t\t};\n\t\t\t\t\tme.dragId = -1;\n\n\t\t\t\t\tvar hands = [],\n\t\t\t\t\t\tcover = me.cover = document.createElement('div'),\n\t\t\t\t\t\tresizer = me.resizer = document.createElement('div');\n\n\t\t\t\t\tcover.id = me.editor.ui.id + '_imagescale_cover';\n\t\t\t\t\tcover.style.cssText = 'position:absolute;display:none;z-index:' + (me.editor.options.zIndex) + ';filter:alpha(opacity=0); opacity:0;background:#CCC;';\n\t\t\t\t\tdomUtils.on(cover, 'mousedown click', function() {\n\t\t\t\t\t\tme.hide();\n\t\t\t\t\t});\n\n\t\t\t\t\tfor (i = 0; i < 8; i++) {\n\t\t\t\t\t\thands.push('<span class=\"edui-editor-imagescale-hand' + i + '\"></span>');\n\t\t\t\t\t}\n\t\t\t\t\tresizer.id = me.editor.ui.id + '_imagescale';\n\t\t\t\t\tresizer.className = 'edui-editor-imagescale';\n\t\t\t\t\tresizer.innerHTML = hands.join('');\n\t\t\t\t\tresizer.style.cssText += ';display:none;border:1px solid #3b77ff;z-index:' + (me.editor.options.zIndex) + ';';\n\n\t\t\t\t\tme.editor.ui.getDom().appendChild(cover);\n\t\t\t\t\tme.editor.ui.getDom().appendChild(resizer);\n\n\t\t\t\t\tme.initStyle();\n\t\t\t\t\tme.initEvents();\n\t\t\t\t},\n\t\t\t\tinitStyle: function() {\n\t\t\t\t\tutils.cssRule('imagescale', '.edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}' +\n\t\t\t\t\t\t'.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}' + '.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}');\n\t\t\t\t},\n\t\t\t\tinitEvents: function() {\n\t\t\t\t\tvar me = this;\n\n\t\t\t\t\tme.startPos.x = me.startPos.y = 0;\n\t\t\t\t\tme.isDraging = false;\n\t\t\t\t},\n\t\t\t\t_eventHandler: function(e) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tswitch (e.type) {\n\t\t\t\t\t\tcase 'mousedown':\n\t\t\t\t\t\t\tvar hand = e.target || e.srcElement,\n\t\t\t\t\t\t\t\thand;\n\t\t\t\t\t\t\tif (hand.className.indexOf('edui-editor-imagescale-hand') != -1 && me.dragId == -1) {\n\t\t\t\t\t\t\t\tme.dragId = hand.className.slice(-1);\n\t\t\t\t\t\t\t\tme.startPos.x = me.prePos.x = e.clientX;\n\t\t\t\t\t\t\t\tme.startPos.y = me.prePos.y = e.clientY;\n\t\t\t\t\t\t\t\tdomUtils.on(me.doc, 'mousemove', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mousemove':\n\t\t\t\t\t\t\tif (me.dragId != -1) {\n\t\t\t\t\t\t\t\tme.updateContainerStyle(me.dragId, {\n\t\t\t\t\t\t\t\t\tx: e.clientX - me.prePos.x,\n\t\t\t\t\t\t\t\t\ty: e.clientY - me.prePos.y\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tme.prePos.x = e.clientX;\n\t\t\t\t\t\t\t\tme.prePos.y = e.clientY;\n\t\t\t\t\t\t\t\telementUpdated = true;\n\t\t\t\t\t\t\t\tme.updateTargetElement();\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 'mouseup':\n\t\t\t\t\t\t\tif (me.dragId != -1) {\n\t\t\t\t\t\t\t\tme.updateContainerStyle(me.dragId, {\n\t\t\t\t\t\t\t\t\tx: e.clientX - me.prePos.x,\n\t\t\t\t\t\t\t\t\ty: e.clientY - me.prePos.y\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tme.updateTargetElement();\n\t\t\t\t\t\t\t\tif (me.target.parentNode) me.attachTo(me.target);\n\t\t\t\t\t\t\t\tme.dragId = -1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdomUtils.un(me.doc, 'mousemove', me.proxy(me._eventHandler, me));\n\t\t\t\t\t\t\t//修复只是点击挪动点，但没有改变大小，不应该触发contentchange\n\t\t\t\t\t\t\tif (elementUpdated) {\n\t\t\t\t\t\t\t\telementUpdated = false;\n\t\t\t\t\t\t\t\tme.editor.fireEvent('contentchange');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tupdateTargetElement: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tdomUtils.setStyles(me.target, {\n\t\t\t\t\t\t'width': me.resizer.style.width,\n\t\t\t\t\t\t'height': me.resizer.style.height\n\t\t\t\t\t});\n\t\t\t\t\tme.target.width = parseInt(me.resizer.style.width);\n\t\t\t\t\tme.target.height = parseInt(me.resizer.style.height);\n\t\t\t\t\tme.attachTo(me.target);\n\t\t\t\t},\n\t\t\t\tupdateContainerStyle: function(dir, offset) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tdom = me.resizer,\n\t\t\t\t\t\ttmp;\n\n\t\t\t\t\tif (rect[dir][0] != 0) {\n\t\t\t\t\t\ttmp = parseInt(dom.style.left) + offset.x;\n\t\t\t\t\t\tdom.style.left = me._validScaledProp('left', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (rect[dir][1] != 0) {\n\t\t\t\t\t\ttmp = parseInt(dom.style.top) + offset.y;\n\t\t\t\t\t\tdom.style.top = me._validScaledProp('top', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (rect[dir][2] != 0) {\n\t\t\t\t\t\ttmp = dom.clientWidth + rect[dir][2] * offset.x;\n\t\t\t\t\t\tdom.style.width = me._validScaledProp('width', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (rect[dir][3] != 0) {\n\t\t\t\t\t\ttmp = dom.clientHeight + rect[dir][3] * offset.y;\n\t\t\t\t\t\tdom.style.height = me._validScaledProp('height', tmp) + 'px';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t_validScaledProp: function(prop, value) {\n\t\t\t\t\tvar ele = this.resizer,\n\t\t\t\t\t\twrap = document;\n\n\t\t\t\t\tvalue = isNaN(value) ? 0 : value;\n\t\t\t\t\tswitch (prop) {\n\t\t\t\t\t\tcase 'left':\n\t\t\t\t\t\t\treturn value < 0 ? 0 : (value + ele.clientWidth) > wrap.clientWidth ? wrap.clientWidth - ele.clientWidth : value;\n\t\t\t\t\t\tcase 'top':\n\t\t\t\t\t\t\treturn value < 0 ? 0 : (value + ele.clientHeight) > wrap.clientHeight ? wrap.clientHeight - ele.clientHeight : value;\n\t\t\t\t\t\tcase 'width':\n\t\t\t\t\t\t\treturn value <= 0 ? 1 : (value + ele.offsetLeft) > wrap.clientWidth ? wrap.clientWidth - ele.offsetLeft : value;\n\t\t\t\t\t\tcase 'height':\n\t\t\t\t\t\t\treturn value <= 0 ? 1 : (value + ele.offsetTop) > wrap.clientHeight ? wrap.clientHeight - ele.offsetTop : value;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\thideCover: function() {\n\t\t\t\t\tthis.cover.style.display = 'none';\n\t\t\t\t},\n\t\t\t\tshowCover: function() {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\teditorPos = domUtils.getXY(me.editor.ui.getDom()),\n\t\t\t\t\t\tiframePos = domUtils.getXY(me.editor.iframe);\n\n\t\t\t\t\tdomUtils.setStyles(me.cover, {\n\t\t\t\t\t\t'width': me.editor.iframe.offsetWidth + 'px',\n\t\t\t\t\t\t'height': me.editor.iframe.offsetHeight + 'px',\n\t\t\t\t\t\t'top': iframePos.y - editorPos.y + 'px',\n\t\t\t\t\t\t'left': iframePos.x - editorPos.x + 'px',\n\t\t\t\t\t\t'position': 'absolute',\n\t\t\t\t\t\t'display': ''\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tshow: function(targetObj) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.resizer.style.display = 'block';\n\t\t\t\t\tif (targetObj) me.attachTo(targetObj);\n\n\t\t\t\t\tdomUtils.on(this.resizer, 'mousedown', me.proxy(me._eventHandler, me));\n\t\t\t\t\tdomUtils.on(me.doc, 'mouseup', me.proxy(me._eventHandler, me));\n\n\t\t\t\t\tme.showCover();\n\t\t\t\t\tme.editor.fireEvent('afterscaleshow', me);\n\t\t\t\t\tme.editor.fireEvent('saveScene');\n\t\t\t\t},\n\t\t\t\thide: function() {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tme.hideCover();\n\t\t\t\t\tme.resizer.style.display = 'none';\n\n\t\t\t\t\tdomUtils.un(me.resizer, 'mousedown', me.proxy(me._eventHandler, me));\n\t\t\t\t\tdomUtils.un(me.doc, 'mouseup', me.proxy(me._eventHandler, me));\n\t\t\t\t\tme.editor.fireEvent('afterscalehide', me);\n\t\t\t\t},\n\t\t\t\tproxy: function(fn, context) {\n\t\t\t\t\treturn function(e) {\n\t\t\t\t\t\treturn fn.apply(context || this, arguments);\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tattachTo: function(targetObj) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\ttarget = me.target = targetObj,\n\t\t\t\t\t\tresizer = this.resizer,\n\t\t\t\t\t\timgPos = domUtils.getXY(target),\n\t\t\t\t\t\tiframePos = domUtils.getXY(me.editor.iframe),\n\t\t\t\t\t\teditorPos = domUtils.getXY(resizer.parentNode);\n\n\t\t\t\t\tdomUtils.setStyles(resizer, {\n\t\t\t\t\t\t'width': target.width + 'px',\n\t\t\t\t\t\t'height': target.height + 'px',\n\t\t\t\t\t\t'left': iframePos.x + imgPos.x - me.editor.document.body.scrollLeft - editorPos.x - parseInt(resizer.style.borderLeftWidth) + 'px',\n\t\t\t\t\t\t'top': iframePos.y + imgPos.y - me.editor.document.body.scrollTop - editorPos.y - parseInt(resizer.style.borderTopWidth) + 'px'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t})();\n\n\t\treturn function() {\n\t\t\tvar me = this,\n\t\t\t\timageScale;\n\n\t\t\tme.setOpt('imageScaleEnabled', true);\n\n\t\t\tif (!browser.ie && me.options.imageScaleEnabled) {\n\t\t\t\tme.addListener('click', function(type, e) {\n\n\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\timg = range.getClosedNode();\n\n\t\t\t\t\tif (img && img.tagName == 'IMG' && me.body.contentEditable != \"false\") {\n\n\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-music\") != -1 ||\n\t\t\t\t\t\t\timg.getAttribute(\"anchorname\") ||\n\t\t\t\t\t\t\tdomUtils.hasClass(img, 'loadingclass') ||\n\t\t\t\t\t\t\tdomUtils.hasClass(img, 'loaderrorclass')) {\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!imageScale) {\n\t\t\t\t\t\t\timageScale = new Scale();\n\t\t\t\t\t\t\timageScale.init(me);\n\t\t\t\t\t\t\tme.ui.getDom().appendChild(imageScale.resizer);\n\n\t\t\t\t\t\t\tvar _keyDownHandler = function(e) {\n\t\t\t\t\t\t\t\t\timageScale.hide();\n\t\t\t\t\t\t\t\t\tif (imageScale.target) me.selection.getRange().selectNode(imageScale.target).select();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t_mouseDownHandler = function(e) {\n\t\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\t\tif (ele && (ele.className === undefined || ele.className.indexOf('edui-editor-imagescale') == -1)) {\n\t\t\t\t\t\t\t\t\t\t_keyDownHandler(e);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttimer;\n\n\t\t\t\t\t\t\tme.addListener('afterscaleshow', function(e) {\n\t\t\t\t\t\t\t\tme.addListener('beforekeydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tme.addListener('beforemousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.on(document, 'keydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.on(document, 'mousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tme.addListener('afterscalehide', function(e) {\n\t\t\t\t\t\t\t\tme.removeListener('beforekeydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tme.removeListener('beforemousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.un(document, 'keydown', _keyDownHandler);\n\t\t\t\t\t\t\t\tdomUtils.un(document, 'mousedown', _mouseDownHandler);\n\t\t\t\t\t\t\t\tvar target = imageScale.target;\n\t\t\t\t\t\t\t\tif (target.parentNode) {\n\t\t\t\t\t\t\t\t\tme.selection.getRange().selectNode(target).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t//TODO 有iframe的情况，mousedown不能往下传。。\n\t\t\t\t\t\t\tdomUtils.on(imageScale.resizer, 'mousedown', function(e) {\n\t\t\t\t\t\t\t\tme.selection.getNative().removeAllRanges();\n\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\tif (ele && ele.className.indexOf('edui-editor-imagescale-hand') == -1) {\n\t\t\t\t\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\t\t\t\t\timageScale.hide();\n\t\t\t\t\t\t\t\t\t\tif (imageScale.target) me.selection.getRange().selectNode(ele).select();\n\t\t\t\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tdomUtils.on(imageScale.resizer, 'mouseup', function(e) {\n\t\t\t\t\t\t\t\tvar ele = e.target || e.srcElement;\n\t\t\t\t\t\t\t\tif (ele && ele.className.indexOf('edui-editor-imagescale-hand') == -1) {\n\t\t\t\t\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\timageScale.show(img);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (imageScale && imageScale.resizer.style.display != 'none') imageScale.hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (browser.webkit) {\n\t\t\t\tme.addListener('click', function(type, e) {\n\t\t\t\t\tif (e.target.tagName == 'IMG' && me.body.contentEditable != \"false\") {\n\t\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\t\trange.selectNode(e.target).select();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t})();\n\n\t// plugins/autolink.js\n\t///import core\n\t///commands 为非ie浏览器自动添加a标签\n\t///commandsName  AutoLink\n\t///commandsTitle  自动增加链接\n\t/**\n\t * @description 为非ie浏览器自动添加a标签\n\t * @author zhanyi\n\t */\n\n\tUE.plugin.register('autolink', function() {\n\t\tvar cont = 0;\n\n\t\treturn !browser.ie ? {\n\n\t\t\tbindEvents: {\n\t\t\t\t'reset': function() {\n\t\t\t\t\tcont = 0;\n\t\t\t\t},\n\t\t\t\t'keydown': function(type, evt) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\n\t\t\t\t\tif (keyCode == 32 || keyCode == 13) {\n\n\t\t\t\t\t\tvar sel = me.selection.getNative(),\n\t\t\t\t\t\t\trange = sel.getRangeAt(0).cloneRange(),\n\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\tcharCode;\n\n\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\twhile (start.nodeType == 1 && range.startOffset > 0) {\n\t\t\t\t\t\t\tstart = range.startContainer.childNodes[range.startOffset - 1];\n\t\t\t\t\t\t\tif (!start) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.setStart(start, start.nodeType == 1 ? start.childNodes.length : start.nodeValue.length);\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdo {\n\t\t\t\t\t\t\tif (range.startOffset == 0) {\n\t\t\t\t\t\t\t\tstart = range.startContainer.previousSibling;\n\n\t\t\t\t\t\t\t\twhile (start && start.nodeType == 1) {\n\t\t\t\t\t\t\t\t\tstart = start.lastChild;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (!start || domUtils.isFillChar(start)) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\toffset = start.nodeValue.length;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tstart = range.startContainer;\n\t\t\t\t\t\t\t\toffset = range.startOffset;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.setStart(start, offset - 1);\n\t\t\t\t\t\t\tcharCode = range.toString().charCodeAt(0);\n\t\t\t\t\t\t} while (charCode != 160 && charCode != 32);\n\n\t\t\t\t\t\tif (range.toString().replace(new RegExp(domUtils.fillChar, 'g'), '').match(/(?:https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.)/i)) {\n\t\t\t\t\t\t\twhile (range.toString().length) {\n\t\t\t\t\t\t\t\tif (/^(?:https?:\\/\\/|ssh:\\/\\/|ftp:\\/\\/|file:\\/|www\\.)/i.test(range.toString())) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\trange.setStart(range.startContainer, range.startOffset + 1);\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\t//trace:2121\n\t\t\t\t\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\t\t\t\t\twhile (!(next = start.nextSibling)) {\n\t\t\t\t\t\t\t\t\t\tif (domUtils.isBody(start)) {\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tstart = start.parentNode;\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\trange.setStart(next, 0);\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//range的开始边界已经在a标签里的不再处理\n\t\t\t\t\t\t\tif (domUtils.findParentByTagName(range.startContainer, 'a', true)) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tvar a = me.document.createElement('a'),\n\t\t\t\t\t\t\t\ttext = me.document.createTextNode(' '),\n\t\t\t\t\t\t\t\thref;\n\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t\ta.appendChild(range.extractContents());\n\t\t\t\t\t\t\ta.href = a.innerHTML = a.innerHTML.replace(/<[^>]+>/g, '');\n\t\t\t\t\t\t\thref = a.getAttribute(\"href\").replace(new RegExp(domUtils.fillChar, 'g'), '');\n\t\t\t\t\t\t\thref = /^(?:https?:\\/\\/)/ig.test(href) ? href : \"http://\" + href;\n\t\t\t\t\t\t\ta.setAttribute('_src', utils.html(href));\n\t\t\t\t\t\t\ta.href = utils.html(href);\n\n\t\t\t\t\t\t\trange.insertNode(a);\n\t\t\t\t\t\t\ta.parentNode.insertBefore(text, a.nextSibling);\n\t\t\t\t\t\t\trange.setStart(text, 0);\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t\tsel.removeAllRanges();\n\t\t\t\t\t\t\tsel.addRange(range);\n\t\t\t\t\t\t\tme.undoManger && me.undoManger.save();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} : {}\n\t}, function() {\n\t\tvar keyCodes = {\n\t\t\t37: 1,\n\t\t\t38: 1,\n\t\t\t39: 1,\n\t\t\t40: 1,\n\t\t\t13: 1,\n\t\t\t32: 1\n\t\t};\n\n\t\tfunction checkIsCludeLink(node) {\n\t\t\tif (node.nodeType == 3) {\n\t\t\t\treturn null\n\t\t\t}\n\t\t\tif (node.nodeName == 'A') {\n\t\t\t\treturn node;\n\t\t\t}\n\t\t\tvar lastChild = node.lastChild;\n\n\t\t\twhile (lastChild) {\n\t\t\t\tif (lastChild.nodeName == 'A') {\n\t\t\t\t\treturn lastChild;\n\t\t\t\t}\n\t\t\t\tif (lastChild.nodeType == 3) {\n\t\t\t\t\tif (domUtils.isWhitespace(lastChild)) {\n\t\t\t\t\t\tlastChild = lastChild.previousSibling;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\treturn null\n\t\t\t\t}\n\t\t\t\tlastChild = lastChild.lastChild;\n\t\t\t}\n\t\t}\n\t\tbrowser.ie && this.addListener('keyup', function(cmd, evt) {\n\t\t\tvar me = this,\n\t\t\t\tkeyCode = evt.keyCode;\n\t\t\tif (keyCodes[keyCode]) {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar start = rng.startContainer;\n\n\t\t\t\tif (keyCode == 13) {\n\t\t\t\t\twhile (start && !domUtils.isBody(start) && !domUtils.isBlockElm(start)) {\n\t\t\t\t\t\tstart = start.parentNode;\n\t\t\t\t\t}\n\t\t\t\t\tif (start && !domUtils.isBody(start) && start.nodeName == 'P') {\n\t\t\t\t\t\tvar pre = start.previousSibling;\n\t\t\t\t\t\tif (pre && pre.nodeType == 1) {\n\t\t\t\t\t\t\tvar pre = checkIsCludeLink(pre);\n\t\t\t\t\t\t\tif (pre && !pre.getAttribute('_href')) {\n\t\t\t\t\t\t\t\tdomUtils.remove(pre, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (keyCode == 32) {\n\t\t\t\t\tif (start.nodeType == 3 && /^\\s$/.test(start.nodeValue)) {\n\t\t\t\t\t\tstart = start.previousSibling;\n\t\t\t\t\t\tif (start && start.nodeName == 'A' && !start.getAttribute('_href')) {\n\t\t\t\t\t\t\tdomUtils.remove(start, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tstart = domUtils.findParentByTagName(start, 'a', true);\n\t\t\t\t\tif (start && !start.getAttribute('_href')) {\n\t\t\t\t\t\tvar bk = rng.createBookmark();\n\n\t\t\t\t\t\tdomUtils.remove(start, true);\n\t\t\t\t\t\trng.moveToBookmark(bk).select(true)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t});\n\t});\n\n\t// plugins/autoheight.js\n\t///import core\n\t///commands 当输入内容超过编辑器高度时，编辑器自动增高\n\t///commandsName  AutoHeight,autoHeightEnabled\n\t///commandsTitle  自动增高\n\t/**\n\t * @description 自动伸展\n\t * @author zhanyi\n\t */\n\tUE.plugins['autoheight'] = function() {\n\t\tvar me = this;\n\t\t//提供开关，就算加载也可以关闭\n\t\tme.autoHeightEnabled = me.options.autoHeightEnabled !== false;\n\t\tif (!me.autoHeightEnabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar bakOverflow,\n\t\t\tlastHeight = 0,\n\t\t\toptions = me.options,\n\t\t\tcurrentHeight,\n\t\t\ttimer;\n\n\t\tfunction adjustHeight() {\n\t\t\tvar me = this;\n\t\t\tclearTimeout(timer);\n\t\t\tif (isFullscreen) return;\n\t\t\tif (!me.queryCommandState || me.queryCommandState && me.queryCommandState('source') != 1) {\n\t\t\t\ttimer = setTimeout(function() {\n\n\t\t\t\t\tvar node = me.body.lastChild;\n\t\t\t\t\twhile (node && node.nodeType != 1) {\n\t\t\t\t\t\tnode = node.previousSibling;\n\t\t\t\t\t}\n\t\t\t\t\tif (node && node.nodeType == 1) {\n\t\t\t\t\t\tnode.style.clear = 'both';\n\t\t\t\t\t\tcurrentHeight = Math.max(domUtils.getXY(node).y + node.offsetHeight + 25, Math.max(options.minFrameHeight, options.initialFrameHeight));\n\t\t\t\t\t\tif (currentHeight != lastHeight) {\n\t\t\t\t\t\t\tif (currentHeight !== parseInt(me.iframe.parentNode.style.height)) {\n\t\t\t\t\t\t\t\tme.iframe.parentNode.style.height = currentHeight + 'px';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme.body.style.height = currentHeight + 'px';\n\t\t\t\t\t\t\tlastHeight = currentHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.removeStyle(node, 'clear');\n\t\t\t\t\t}\n\n\t\t\t\t}, 50)\n\t\t\t}\n\t\t}\n\t\tvar isFullscreen;\n\t\tme.addListener('fullscreenchanged', function(cmd, f) {\n\t\t\tisFullscreen = f\n\t\t});\n\t\tme.addListener('destroy', function() {\n\t\t\tme.removeListener('contentchange afterinserthtml keyup mouseup', adjustHeight)\n\t\t});\n\t\tme.enableAutoHeight = function() {\n\t\t\tvar me = this;\n\t\t\tif (!me.autoHeightEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar doc = me.document;\n\t\t\tme.autoHeightEnabled = true;\n\t\t\tbakOverflow = doc.body.style.overflowY;\n\t\t\tdoc.body.style.overflowY = 'hidden';\n\t\t\tme.addListener('contentchange afterinserthtml keyup mouseup', adjustHeight);\n\t\t\t//ff不给事件算得不对\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tadjustHeight.call(me);\n\t\t\t}, browser.gecko ? 100 : 0);\n\t\t\tme.fireEvent('autoheightchanged', me.autoHeightEnabled);\n\t\t};\n\t\tme.disableAutoHeight = function() {\n\n\t\t\tme.body.style.overflowY = bakOverflow || '';\n\n\t\t\tme.removeListener('contentchange', adjustHeight);\n\t\t\tme.removeListener('keyup', adjustHeight);\n\t\t\tme.removeListener('mouseup', adjustHeight);\n\t\t\tme.autoHeightEnabled = false;\n\t\t\tme.fireEvent('autoheightchanged', me.autoHeightEnabled);\n\t\t};\n\n\t\tme.on('setHeight', function() {\n\t\t\tme.disableAutoHeight()\n\t\t});\n\t\tme.addListener('ready', function() {\n\t\t\tme.enableAutoHeight();\n\t\t\t//trace:1764\n\t\t\tvar timer;\n\t\t\tdomUtils.on(browser.ie ? me.body : me.document, browser.webkit ? 'dragover' : 'drop', function() {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t//trace:3681\n\t\t\t\t\tadjustHeight.call(me);\n\t\t\t\t}, 100);\n\n\t\t\t});\n\t\t\t//修复内容过多时，回到顶部，顶部内容被工具栏遮挡问题\n\t\t\tvar lastScrollY;\n\t\t\twindow.onscroll = function() {\n\t\t\t\tif (lastScrollY === null) {\n\t\t\t\t\tlastScrollY = this.scrollY\n\t\t\t\t} else if (this.scrollY == 0 && lastScrollY != 0) {\n\t\t\t\t\tme.window.scrollTo(0, 0);\n\t\t\t\t\tlastScrollY = null;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t};\n\n\t// plugins/autofloat.js\n\t///import core\n\t///commands 悬浮工具栏\n\t///commandsName  AutoFloat,autoFloatEnabled\n\t///commandsTitle  悬浮工具栏\n\t/**\n\t *  modified by chengchao01\n\t *  注意： 引入此功能后，在IE6下会将body的背景图片覆盖掉！\n\t */\n\tUE.plugins['autofloat'] = function() {\n\t\tvar me = this,\n\t\t\tlang = me.getLang();\n\t\tme.setOpt({\n\t\t\ttopOffset: 0\n\t\t});\n\t\tvar optsAutoFloatEnabled = me.options.autoFloatEnabled !== false,\n\t\t\ttopOffset = me.options.topOffset;\n\n\t\t//如果不固定toolbar的位置，则直接退出\n\t\tif (!optsAutoFloatEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tvar uiUtils = UE.ui.uiUtils,\n\t\t\tLteIE6 = browser.ie && browser.version <= 6,\n\t\t\tquirks = browser.quirks;\n\n\t\tfunction checkHasUI() {\n\t\t\tif (!UE.ui) {\n\t\t\t\talert(lang.autofloatMsg);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction fixIE6FixedPos() {\n\t\t\tvar docStyle = document.body.style;\n\t\t\tdocStyle.backgroundImage = 'url(\"about:blank\")';\n\t\t\tdocStyle.backgroundAttachment = 'fixed';\n\t\t}\n\t\tvar bakCssText,\n\t\t\tplaceHolder = document.createElement('div'),\n\t\t\ttoolbarBox, orgTop,\n\t\t\tgetPosition,\n\t\t\tflag = true; //ie7模式下需要偏移\n\t\tfunction setFloating() {\n\t\t\tvar toobarBoxPos = domUtils.getXY(toolbarBox),\n\t\t\t\torigalFloat = domUtils.getComputedStyle(toolbarBox, 'position'),\n\t\t\t\torigalLeft = domUtils.getComputedStyle(toolbarBox, 'left');\n\t\t\ttoolbarBox.style.width = toolbarBox.offsetWidth + 'px';\n\t\t\ttoolbarBox.style.zIndex = me.options.zIndex * 1 + 1;\n\t\t\ttoolbarBox.parentNode.insertBefore(placeHolder, toolbarBox);\n\t\t\tif (LteIE6 || (quirks && browser.ie)) {\n\t\t\t\tif (toolbarBox.style.position != 'absolute') {\n\t\t\t\t\ttoolbarBox.style.position = 'absolute';\n\t\t\t\t}\n\t\t\t\ttoolbarBox.style.top = (document.body.scrollTop || document.documentElement.scrollTop) - orgTop + topOffset + 'px';\n\t\t\t} else {\n\t\t\t\tif (browser.ie7Compat && flag) {\n\t\t\t\t\tflag = false;\n\t\t\t\t\ttoolbarBox.style.left = domUtils.getXY(toolbarBox).x - document.documentElement.getBoundingClientRect().left + 2 + 'px';\n\t\t\t\t}\n\t\t\t\tif (toolbarBox.style.position != 'fixed') {\n\t\t\t\t\ttoolbarBox.style.position = 'fixed';\n\t\t\t\t\ttoolbarBox.style.top = topOffset + \"px\";\n\t\t\t\t\t((origalFloat == 'absolute' || origalFloat == 'relative') && parseFloat(origalLeft)) && (toolbarBox.style.left = toobarBoxPos.x + 'px');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction unsetFloating() {\n\t\t\tflag = true;\n\t\t\tif (placeHolder.parentNode) {\n\t\t\t\tplaceHolder.parentNode.removeChild(placeHolder);\n\t\t\t}\n\n\t\t\ttoolbarBox.style.cssText = bakCssText;\n\t\t}\n\n\t\tfunction updateFloating() {\n\t\t\tvar rect3 = getPosition(me.container);\n\t\t\tvar offset = me.options.toolbarTopOffset || 0;\n\t\t\tif (rect3.top < 0 && rect3.bottom - toolbarBox.offsetHeight > offset) {\n\t\t\t\tsetFloating();\n\t\t\t} else {\n\t\t\t\tunsetFloating();\n\t\t\t}\n\t\t}\n\t\tvar defer_updateFloating = utils.defer(function() {\n\t\t\tupdateFloating();\n\t\t}, browser.ie ? 200 : 100, true);\n\n\t\tme.addListener('destroy', function() {\n\t\t\tdomUtils.un(window, ['scroll', 'resize'], updateFloating);\n\t\t\tme.removeListener('keydown', defer_updateFloating);\n\t\t});\n\n\t\tme.addListener('ready', function() {\n\t\t\tif (checkHasUI(me)) {\n\t\t\t\t//加载了ui组件，但在new时，没有加载ui，导致编辑器实例上没有ui类，所以这里做判断\n\t\t\t\tif (!me.ui) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tgetPosition = uiUtils.getClientRect;\n\t\t\t\ttoolbarBox = me.ui.getDom('toolbarbox');\n\t\t\t\torgTop = getPosition(toolbarBox).top;\n\t\t\t\tbakCssText = toolbarBox.style.cssText;\n\t\t\t\tplaceHolder.style.height = toolbarBox.offsetHeight + 'px';\n\t\t\t\tif (LteIE6) {\n\t\t\t\t\tfixIE6FixedPos();\n\t\t\t\t}\n\t\t\t\tdomUtils.on(window, ['scroll', 'resize'], updateFloating);\n\t\t\t\tme.addListener('keydown', defer_updateFloating);\n\n\t\t\t\tme.addListener('beforefullscreenchange', function(t, enabled) {\n\t\t\t\t\tif (enabled) {\n\t\t\t\t\t\tunsetFloating();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tme.addListener('fullscreenchanged', function(t, enabled) {\n\t\t\t\t\tif (!enabled) {\n\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tme.addListener('sourcemodechanged', function(t, enabled) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t}, 0);\n\t\t\t\t});\n\t\t\t\tme.addListener(\"clearDoc\", function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tupdateFloating();\n\t\t\t\t\t}, 0);\n\n\t\t\t\t})\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/video.js\n\t/**\n\t * video插件， 为UEditor提供视频插入支持\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['video'] = function() {\n\t\tvar me = this;\n\n\t\t/**\n\t\t * 创建插入视频字符窜\n\t\t * @param url 视频地址\n\t\t * @param width 视频宽度\n\t\t * @param height 视频高度\n\t\t * @param align 视频对齐\n\t\t * @param toEmbed 是否以flash代替显示\n\t\t * @param addParagraph  是否需要添加P 标签\n\t\t */\n\t\tfunction creatInsertStr(url, width, height, id, align, classname, type) {\n\n\t\t\turl = utils.unhtmlForUrl(url);\n\t\t\talign = utils.unhtml(align);\n\t\t\tclassname = utils.unhtml(classname);\n\n\t\t\twidth = parseInt(width, 10) || 0;\n\t\t\theight = parseInt(height, 10) || 0;\n\n\t\t\tvar str;\n\t\t\tswitch (type) {\n\t\t\t\tcase 'image':\n\t\t\t\t\tstr = '<img ' + (id ? 'id=\"' + id + '\"' : '') + ' width=\"' + width + '\" height=\"' + height + '\" _url=\"' + url + '\" class=\"' + classname.replace(/\\bvideo-js\\b/, '') + '\"' +\n\t\t\t\t\t\t' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" style=\"background:url(' + me.options.UEDITOR_HOME_URL + 'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;' + (align ? 'float:' + align + ';' : '') + '\" />'\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'embed':\n\t\t\t\t\tstr = '<embed type=\"application/x-shockwave-flash\" class=\"' + classname + '\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"' +\n\t\t\t\t\t\t' src=\"' + utils.html(url) + '\" width=\"' + width + '\" height=\"' + height + '\"' + (align ? ' style=\"float:' + align + '\"' : '') +\n\t\t\t\t\t\t' wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" allowscriptaccess=\"never\" allowfullscreen=\"true\" >';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'video':\n\t\t\t\t\tvar ext = url.substr(url.lastIndexOf('.') + 1);\n\t\t\t\t\tif (ext == 'ogv') ext = 'ogg';\n\t\t\t\t\tstr = '<video' + (id ? ' id=\"' + id + '\"' : '') + ' class=\"' + classname + ' video-js\" ' + (align ? ' style=\"float:' + align + '\"' : '') +\n\t\t\t\t\t\t' controls preload=\"none\" width=\"' + width + '\" height=\"' + height + '\" src=\"' + url + '\" data-setup=\"{}\">' +\n\t\t\t\t\t\t'<source src=\"' + url + '\" type=\"video/' + ext + '\" /></video>';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn str;\n\t\t}\n\n\t\tfunction switchImgAndVideo(root, img2video) {\n\t\t\tutils.each(root.getNodesByTagName(img2video ? 'img' : 'embed video'), function(node) {\n\t\t\t\tvar className = node.getAttr('class');\n\t\t\t\tif (className && className.indexOf('edui-faked-video') != -1) {\n\t\t\t\t\tvar html = creatInsertStr(img2video ? node.getAttr('_url') : node.getAttr('src'), node.getAttr('width'), node.getAttr('height'), null, node.getStyle('float') || '', className, img2video ? 'embed' : 'image');\n\t\t\t\t\tnode.parentNode.replaceChild(UE.uNode.createElement(html), node);\n\t\t\t\t}\n\t\t\t\tif (className && className.indexOf('edui-upload-video') != -1) {\n\t\t\t\t\tvar html = creatInsertStr(img2video ? node.getAttr('_url') : node.getAttr('src'), node.getAttr('width'), node.getAttr('height'), null, node.getStyle('float') || '', className, img2video ? 'video' : 'image');\n\t\t\t\t\tnode.parentNode.replaceChild(UE.uNode.createElement(html), node);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tme.addOutputRule(function(root) {\n\t\t\tswitchImgAndVideo(root, true)\n\t\t});\n\t\tme.addInputRule(function(root) {\n\t\t\tswitchImgAndVideo(root)\n\t\t});\n\n\t\t/**\n\t\t * 插入视频\n\t\t * @command insertvideo\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { Object } videoAttr 键值对对象， 描述一个视频的所有属性\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var videoAttr = {\n\t\t *      //视频地址\n\t\t *      url: 'http://www.youku.com/xxx',\n\t\t *      //视频宽高值， 单位px\n\t\t *      width: 200,\n\t\t *      height: 100\n\t\t * };\n\t\t *\n\t\t * //editor 是编辑器实例\n\t\t * //向编辑器插入单个视频\n\t\t * editor.execCommand( 'insertvideo', videoAttr );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 插入视频\n\t\t * @command insertvideo\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @param { Array } videoArr 需要插入的视频的数组， 其中的每一个元素都是一个键值对对象， 描述了一个视频的所有属性\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * var videoAttr1 = {\n\t\t *      //视频地址\n\t\t *      url: 'http://www.youku.com/xxx',\n\t\t *      //视频宽高值， 单位px\n\t\t *      width: 200,\n\t\t *      height: 100\n\t\t * },\n\t\t * videoAttr2 = {\n\t\t *      //视频地址\n\t\t *      url: 'http://www.youku.com/xxx',\n\t\t *      //视频宽高值， 单位px\n\t\t *      width: 200,\n\t\t *      height: 100\n\t\t * }\n\t\t *\n\t\t * //editor 是编辑器实例\n\t\t * //该方法将会向编辑器内插入两个视频\n\t\t * editor.execCommand( 'insertvideo', [ videoAttr1, videoAttr2 ] );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 查询当前光标所在处是否是一个视频\n\t\t * @command insertvideo\n\t\t * @method queryCommandState\n\t\t * @param { String } cmd 需要查询的命令字符串\n\t\t * @return { int } 如果当前光标所在处的元素是一个视频对象， 则返回1，否则返回0\n\t\t * @example\n\t\t * ```javascript\n\t\t *\n\t\t * //editor 是编辑器实例\n\t\t * editor.queryCommandState( 'insertvideo' );\n\t\t * ```\n\t\t */\n\t\tme.commands[\"insertvideo\"] = {\n\t\t\texecCommand: function(cmd, videoObjs, type) {\n\t\t\t\tvideoObjs = utils.isArray(videoObjs) ? videoObjs : [videoObjs];\n\t\t\t\tvar html = [],\n\t\t\t\t\tid = 'tmpVedio',\n\t\t\t\t\tcl;\n\t\t\t\tfor (var i = 0, vi, len = videoObjs.length; i < len; i++) {\n\t\t\t\t\tvi = videoObjs[i];\n\t\t\t\t\tcl = (type == 'upload' ? 'edui-upload-video video-js vjs-default-skin' : 'edui-faked-video');\n\t\t\t\t\thtml.push(creatInsertStr(vi.url, vi.width || 420, vi.height || 280, id + i, null, cl, 'image'));\n\t\t\t\t}\n\t\t\t\tme.execCommand(\"inserthtml\", html.join(\"\"), true);\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\tfor (var i = 0, len = videoObjs.length; i < len; i++) {\n\t\t\t\t\tvar img = this.document.getElementById('tmpVedio' + i);\n\t\t\t\t\tdomUtils.removeAttributes(img, 'id');\n\t\t\t\t\trng.selectNode(img).select();\n\t\t\t\t\tme.execCommand('imagefloat', videoObjs[i].align)\n\t\t\t\t}\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar img = me.selection.getRange().getClosedNode(),\n\t\t\t\t\tflag = img && (img.className == \"edui-faked-video\" || img.className.indexOf(\"edui-upload-video\") != -1);\n\t\t\t\treturn flag ? 1 : 0;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/table.core.js\n\t/**\n\t * Created with JetBrains WebStorm.\n\t * User: taoqili\n\t * Date: 13-1-18\n\t * Time: 上午11:09\n\t * To change this template use File | Settings | File Templates.\n\t */\n\t/**\n\t * UE表格操作类\n\t * @param table\n\t * @constructor\n\t */\n\t(function() {\n\t\tvar UETable = UE.UETable = function(table) {\n\t\t\tthis.table = table;\n\t\t\tthis.indexTable = [];\n\t\t\tthis.selectedTds = [];\n\t\t\tthis.cellsRange = {};\n\t\t\tthis.update(table);\n\t\t};\n\n\t\t//===以下为静态工具方法===\n\t\tUETable.removeSelectedClass = function(cells) {\n\t\t\tutils.each(cells, function(cell) {\n\t\t\t\tdomUtils.removeClasses(cell, \"selectTdClass\");\n\t\t\t})\n\t\t};\n\t\tUETable.addSelectedClass = function(cells) {\n\t\t\tutils.each(cells, function(cell) {\n\t\t\t\tdomUtils.addClass(cell, \"selectTdClass\");\n\t\t\t})\n\t\t};\n\t\tUETable.isEmptyBlock = function(node) {\n\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(/^\\s*$/, '').replace(reg, '').length > 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor (var i in dtd.$isNotEmpty)\n\t\t\t\tif (dtd.$isNotEmpty.hasOwnProperty(i)) {\n\t\t\t\t\tif (node.getElementsByTagName(i).length) {\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\treturn 1;\n\t\t};\n\t\tUETable.getWidth = function(cell) {\n\t\t\tif (!cell) return 0;\n\t\t\treturn parseInt(domUtils.getComputedStyle(cell, \"width\"), 10);\n\t\t};\n\n\t\t/**\n\t\t * 获取单元格或者单元格组的“对齐”状态。 如果当前的检测对象是一个单元格组， 只有在满足所有单元格的 水平和竖直 对齐属性都相同的\n\t\t * 条件时才会返回其状态值，否则将返回null； 如果当前只检测了一个单元格， 则直接返回当前单元格的对齐状态；\n\t\t * @param table cell or table cells , 支持单个单元格dom对象 或者 单元格dom对象数组\n\t\t * @return { align: 'left' || 'right' || 'center', valign: 'top' || 'middle' || 'bottom' } 或者 null\n\t\t */\n\t\tUETable.getTableCellAlignState = function(cells) {\n\n\t\t\t!utils.isArray(cells) && (cells = [cells]);\n\n\t\t\tvar result = {},\n\t\t\t\tstatus = ['align', 'valign'],\n\t\t\t\ttempStatus = null,\n\t\t\t\tisSame = true; //状态是否相同\n\n\t\t\tutils.each(cells, function(cellNode) {\n\n\t\t\t\tutils.each(status, function(currentState) {\n\n\t\t\t\t\ttempStatus = cellNode.getAttribute(currentState);\n\n\t\t\t\t\tif (!result[currentState] && tempStatus) {\n\t\t\t\t\t\tresult[currentState] = tempStatus;\n\t\t\t\t\t} else if (!result[currentState] || (tempStatus !== result[currentState])) {\n\t\t\t\t\t\tisSame = false;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t\treturn isSame;\n\n\t\t\t});\n\n\t\t\treturn isSame ? result : null;\n\n\t\t};\n\n\t\t/**\n\t\t * 根据当前选区获取相关的table信息\n\t\t * @return {Object}\n\t\t */\n\t\tUETable.getTableItemsByRange = function(editor) {\n\t\t\tvar start = editor.selection.getStart();\n\n\t\t\t//ff下会选中bookmark\n\t\t\tif (start && start.id && start.id.indexOf('_baidu_bookmark_start_') === 0 && start.nextSibling) {\n\t\t\t\tstart = start.nextSibling;\n\t\t\t}\n\n\t\t\t//在table或者td边缘有可能存在选中tr的情况\n\t\t\tvar cell = start && domUtils.findParentByTagName(start, [\"td\", \"th\"], true),\n\t\t\t\ttr = cell && cell.parentNode,\n\t\t\t\tcaption = start && domUtils.findParentByTagName(start, 'caption', true),\n\t\t\t\ttable = caption ? caption.parentNode : tr && tr.parentNode.parentNode;\n\n\t\t\treturn {\n\t\t\t\tcell: cell,\n\t\t\t\ttr: tr,\n\t\t\t\ttable: table,\n\t\t\t\tcaption: caption\n\t\t\t}\n\t\t};\n\t\tUETable.getUETableBySelected = function(editor) {\n\t\t\tvar table = UETable.getTableItemsByRange(editor).table;\n\t\t\tif (table && table.ueTable && table.ueTable.selectedTds.length) {\n\t\t\t\treturn table.ueTable;\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\n\t\tUETable.getDefaultValue = function(editor, table) {\n\t\t\tvar borderMap = {\n\t\t\t\t\tthin: '0px',\n\t\t\t\t\tmedium: '1px',\n\t\t\t\t\tthick: '2px'\n\t\t\t\t},\n\t\t\t\ttableBorder, tdPadding, tdBorder, tmpValue;\n\t\t\tif (!table) {\n\t\t\t\ttable = editor.document.createElement('table');\n\t\t\t\ttable.insertRow(0).insertCell(0).innerHTML = 'xxx';\n\t\t\t\teditor.body.appendChild(table);\n\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\ttmpValue = domUtils.getComputedStyle(table, 'border-left-width');\n\t\t\t\ttableBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'padding-left');\n\t\t\t\ttdPadding = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'border-left-width');\n\t\t\t\ttdBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\tdomUtils.remove(table);\n\t\t\t\treturn {\n\t\t\t\t\ttableBorder: tableBorder,\n\t\t\t\t\ttdPadding: tdPadding,\n\t\t\t\t\ttdBorder: tdBorder\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\ttd = table.getElementsByTagName('td')[0];\n\t\t\t\ttmpValue = domUtils.getComputedStyle(table, 'border-left-width');\n\t\t\t\ttableBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'padding-left');\n\t\t\t\ttdPadding = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\ttmpValue = domUtils.getComputedStyle(td, 'border-left-width');\n\t\t\t\ttdBorder = parseInt(borderMap[tmpValue] || tmpValue, 10);\n\t\t\t\treturn {\n\t\t\t\t\ttableBorder: tableBorder,\n\t\t\t\t\ttdPadding: tdPadding,\n\t\t\t\t\ttdBorder: tdBorder\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\t/**\n\t\t * 根据当前点击的td或者table获取索引对象\n\t\t * @param tdOrTable\n\t\t */\n\t\tUETable.getUETable = function(tdOrTable) {\n\t\t\tvar tag = tdOrTable.tagName.toLowerCase();\n\t\t\ttdOrTable = (tag == \"td\" || tag == \"th\" || tag == 'caption') ? domUtils.findParentByTagName(tdOrTable, \"table\", true) : tdOrTable;\n\t\t\tif (!tdOrTable.ueTable) {\n\t\t\t\ttdOrTable.ueTable = new UETable(tdOrTable);\n\t\t\t}\n\t\t\treturn tdOrTable.ueTable;\n\t\t};\n\n\t\tUETable.cloneCell = function(cell, ignoreMerge, keepPro) {\n\t\t\tif (!cell || utils.isString(cell)) {\n\t\t\t\treturn this.table.ownerDocument.createElement(cell || 'td');\n\t\t\t}\n\t\t\tvar flag = domUtils.hasClass(cell, \"selectTdClass\");\n\t\t\tflag && domUtils.removeClasses(cell, \"selectTdClass\");\n\t\t\tvar tmpCell = cell.cloneNode(true);\n\t\t\tif (ignoreMerge) {\n\t\t\t\ttmpCell.rowSpan = tmpCell.colSpan = 1;\n\t\t\t}\n\t\t\t//去掉宽高\n\t\t\t!keepPro && domUtils.removeAttributes(tmpCell, 'width height');\n\t\t\t!keepPro && domUtils.removeAttributes(tmpCell, 'style');\n\n\t\t\ttmpCell.style.borderLeftStyle = \"\";\n\t\t\ttmpCell.style.borderTopStyle = \"\";\n\t\t\ttmpCell.style.borderLeftColor = cell.style.borderRightColor;\n\t\t\ttmpCell.style.borderLeftWidth = cell.style.borderRightWidth;\n\t\t\ttmpCell.style.borderTopColor = cell.style.borderBottomColor;\n\t\t\ttmpCell.style.borderTopWidth = cell.style.borderBottomWidth;\n\t\t\tflag && domUtils.addClass(cell, \"selectTdClass\");\n\t\t\treturn tmpCell;\n\t\t}\n\n\t\tUETable.prototype = {\n\t\t\tgetMaxRows: function() {\n\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\tmaxLen = 1;\n\t\t\t\tfor (var i = 0, row; row = rows[i]; i++) {\n\t\t\t\t\tvar currentMax = 1;\n\t\t\t\t\tfor (var j = 0, cj; cj = row.cells[j++];) {\n\t\t\t\t\t\tcurrentMax = Math.max(cj.rowSpan || 1, currentMax);\n\t\t\t\t\t}\n\t\t\t\t\tmaxLen = Math.max(currentMax + i, maxLen);\n\t\t\t\t}\n\t\t\t\treturn maxLen;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取当前表格的最大列数\n\t\t\t */\n\t\t\tgetMaxCols: function() {\n\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\tmaxLen = 0,\n\t\t\t\t\tcellRows = {};\n\t\t\t\tfor (var i = 0, row; row = rows[i]; i++) {\n\t\t\t\t\tvar cellsNum = 0;\n\t\t\t\t\tfor (var j = 0, cj; cj = row.cells[j++];) {\n\t\t\t\t\t\tcellsNum += (cj.colSpan || 1);\n\t\t\t\t\t\tif (cj.rowSpan && cj.rowSpan > 1) {\n\t\t\t\t\t\t\tfor (var k = 1; k < cj.rowSpan; k++) {\n\t\t\t\t\t\t\t\tif (!cellRows['row_' + (i + k)]) {\n\t\t\t\t\t\t\t\t\tcellRows['row_' + (i + k)] = (cj.colSpan || 1);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcellRows['row_' + (i + k)]++\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcellsNum += cellRows['row_' + i] || 0;\n\t\t\t\t\tmaxLen = Math.max(cellsNum, maxLen);\n\t\t\t\t}\n\t\t\t\treturn maxLen;\n\t\t\t},\n\t\t\tgetCellColIndex: function(cell) {\n\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取当前cell旁边的单元格，\n\t\t\t * @param cell\n\t\t\t * @param right\n\t\t\t */\n\t\t\tgetHSideCell: function(cell, right) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tpreviewRowIndex, previewColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//首行或者首列没有前置单元格\n\t\t\t\t\tif ((!right && (!len ? !cellInfo.colIndex : !range.beginColIndex)) || (right && (!len ? (cellInfo.colIndex == (this.colsNum - 1)) : (range.endColIndex == this.colsNum - 1)))) return null;\n\n\t\t\t\t\tpreviewRowIndex = !len ? cellInfo.rowIndex : range.beginRowIndex;\n\t\t\t\t\tpreviewColIndex = !right ? (!len ? (cellInfo.colIndex < 1 ? 0 : (cellInfo.colIndex - 1)) : range.beginColIndex - 1) : (!len ? cellInfo.colIndex + 1 : range.endColIndex + 1);\n\t\t\t\t\treturn this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex, this.indexTable[previewRowIndex][previewColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetTabNextCell: function(cell, preRowIndex) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\trowIndex = preRowIndex || cellInfo.rowIndex,\n\t\t\t\t\tcolIndex = cellInfo.colIndex + 1 + (cellInfo.colSpan - 1),\n\t\t\t\t\tnextCell;\n\t\t\t\ttry {\n\t\t\t\t\tnextCell = this.getCell(this.indexTable[rowIndex][colIndex].rowIndex, this.indexTable[rowIndex][colIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\trowIndex = rowIndex * 1 + 1;\n\t\t\t\t\t\tcolIndex = 0;\n\t\t\t\t\t\tnextCell = this.getCell(this.indexTable[rowIndex][colIndex].rowIndex, this.indexTable[rowIndex][colIndex].cellIndex);\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\t\t\t\treturn nextCell;\n\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取视觉上的后置单元格\n\t\t\t * @param cell\n\t\t\t * @param bottom\n\t\t\t */\n\t\t\tgetVSideCell: function(cell, bottom, ignoreRange) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tnextRowIndex, nextColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length && !ignoreRange,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//末行或者末列没有后置单元格\n\t\t\t\t\tif ((!bottom && (cellInfo.rowIndex == 0)) || (bottom && (!len ? (cellInfo.rowIndex + cellInfo.rowSpan > this.rowsNum - 1) : (range.endRowIndex == this.rowsNum - 1)))) return null;\n\n\t\t\t\t\tnextRowIndex = !bottom ? (!len ? cellInfo.rowIndex - 1 : range.beginRowIndex - 1) : (!len ? (cellInfo.rowIndex + cellInfo.rowSpan) : range.endRowIndex + 1);\n\t\t\t\t\tnextColIndex = !len ? cellInfo.colIndex : range.beginColIndex;\n\t\t\t\t\treturn this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex, this.indexTable[nextRowIndex][nextColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取相同结束位置的单元格，xOrY指代了是获取x轴相同还是y轴相同\n\t\t\t */\n\t\t\tgetSameEndPosCells: function(cell, xOrY) {\n\t\t\t\ttry {\n\t\t\t\t\tvar flag = (xOrY.toLowerCase() === \"x\"),\n\t\t\t\t\t\tend = domUtils.getXY(cell)[flag ? 'x' : 'y'] + cell[\"offset\" + (flag ? 'Width' : 'Height')],\n\t\t\t\t\t\trows = this.table.rows,\n\t\t\t\t\t\tcells = null,\n\t\t\t\t\t\treturns = [];\n\t\t\t\t\tfor (var i = 0; i < this.rowsNum; i++) {\n\t\t\t\t\t\tcells = rows[i].cells;\n\t\t\t\t\t\tfor (var j = 0, tmpCell; tmpCell = cells[j++];) {\n\t\t\t\t\t\t\tvar tmpEnd = domUtils.getXY(tmpCell)[flag ? 'x' : 'y'] + tmpCell[\"offset\" + (flag ? 'Width' : 'Height')];\n\t\t\t\t\t\t\t//对应行的td已经被上面行rowSpan了\n\t\t\t\t\t\t\tif (tmpEnd > end && flag) break;\n\t\t\t\t\t\t\tif (cell == tmpCell || end == tmpEnd) {\n\t\t\t\t\t\t\t\t//只获取单一的单元格\n\t\t\t\t\t\t\t\t//todo 仅获取单一单元格在特定情况下会造成returns为空，从而影响后续的拖拽实现，修正这个。需考虑性能\n\t\t\t\t\t\t\t\tif (tmpCell[flag ? \"colSpan\" : \"rowSpan\"] == 1) {\n\t\t\t\t\t\t\t\t\treturns.push(tmpCell);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (flag) break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn returns;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetCellContent: function(cell, content) {\n\t\t\t\tcell.innerHTML = content || (browser.ie ? domUtils.fillChar : \"<br />\");\n\t\t\t},\n\t\t\tcloneCell: UETable.cloneCell,\n\t\t\t/**\n\t\t\t * 获取跟当前单元格的右边竖线为左边的所有未合并单元格\n\t\t\t */\n\t\t\tgetSameStartPosXCells: function(cell) {\n\t\t\t\ttry {\n\t\t\t\t\tvar start = domUtils.getXY(cell).x + cell.offsetWidth,\n\t\t\t\t\t\trows = this.table.rows,\n\t\t\t\t\t\tcells, returns = [];\n\t\t\t\t\tfor (var i = 0; i < this.rowsNum; i++) {\n\t\t\t\t\t\tcells = rows[i].cells;\n\t\t\t\t\t\tfor (var j = 0, tmpCell; tmpCell = cells[j++];) {\n\t\t\t\t\t\t\tvar tmpStart = domUtils.getXY(tmpCell).x;\n\t\t\t\t\t\t\tif (tmpStart > start) break;\n\t\t\t\t\t\t\tif (tmpStart == start && tmpCell.colSpan == 1) {\n\t\t\t\t\t\t\t\treturns.push(tmpCell);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn returns;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 更新table对应的索引表\n\t\t\t */\n\t\t\tupdate: function(table) {\n\t\t\t\tthis.table = table || this.table;\n\t\t\t\tthis.selectedTds = [];\n\t\t\t\tthis.cellsRange = {};\n\t\t\t\tthis.indexTable = [];\n\t\t\t\tvar rows = this.table.rows,\n\t\t\t\t\trowsNum = this.getMaxRows(),\n\t\t\t\t\tdNum = rowsNum - rows.length,\n\t\t\t\t\tcolsNum = this.getMaxCols();\n\t\t\t\twhile (dNum--) {\n\t\t\t\t\tthis.table.insertRow(rows.length);\n\t\t\t\t}\n\t\t\t\tthis.rowsNum = rowsNum;\n\t\t\t\tthis.colsNum = colsNum;\n\t\t\t\tfor (var i = 0, len = rows.length; i < len; i++) {\n\t\t\t\t\tthis.indexTable[i] = new Array(colsNum);\n\t\t\t\t}\n\t\t\t\t//填充索引表\n\t\t\t\tfor (var rowIndex = 0, row; row = rows[rowIndex]; rowIndex++) {\n\t\t\t\t\tfor (var cellIndex = 0, cell, cells = row.cells; cell = cells[cellIndex]; cellIndex++) {\n\t\t\t\t\t\t//修正整行被rowSpan时导致的行数计算错误\n\t\t\t\t\t\tif (cell.rowSpan > rowsNum) {\n\t\t\t\t\t\t\tcell.rowSpan = rowsNum;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar colIndex = cellIndex,\n\t\t\t\t\t\t\trowSpan = cell.rowSpan || 1,\n\t\t\t\t\t\t\tcolSpan = cell.colSpan || 1;\n\t\t\t\t\t\t//当已经被上一行rowSpan或者被前一列colSpan了，则跳到下一个单元格进行\n\t\t\t\t\t\twhile (this.indexTable[rowIndex][colIndex]) colIndex++;\n\t\t\t\t\t\tfor (var j = 0; j < rowSpan; j++) {\n\t\t\t\t\t\t\tfor (var k = 0; k < colSpan; k++) {\n\t\t\t\t\t\t\t\tthis.indexTable[rowIndex + j][colIndex + k] = {\n\t\t\t\t\t\t\t\t\trowIndex: rowIndex,\n\t\t\t\t\t\t\t\t\tcellIndex: cellIndex,\n\t\t\t\t\t\t\t\t\tcolIndex: colIndex,\n\t\t\t\t\t\t\t\t\trowSpan: rowSpan,\n\t\t\t\t\t\t\t\t\tcolSpan: colSpan\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//修复残缺td\n\t\t\t\tfor (j = 0; j < rowsNum; j++) {\n\t\t\t\t\tfor (k = 0; k < colsNum; k++) {\n\t\t\t\t\t\tif (this.indexTable[j][k] === undefined) {\n\t\t\t\t\t\t\trow = rows[j];\n\t\t\t\t\t\t\tcell = row.cells[row.cells.length - 1];\n\t\t\t\t\t\t\tcell = cell ? cell.cloneNode(true) : this.table.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\tif (cell.colSpan !== 1) cell.colSpan = 1;\n\t\t\t\t\t\t\tif (cell.rowSpan !== 1) cell.rowSpan = 1;\n\t\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\t\tthis.indexTable[j][k] = {\n\t\t\t\t\t\t\t\trowIndex: j,\n\t\t\t\t\t\t\t\tcellIndex: cell.cellIndex,\n\t\t\t\t\t\t\t\tcolIndex: k,\n\t\t\t\t\t\t\t\trowSpan: 1,\n\t\t\t\t\t\t\t\tcolSpan: 1\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//当框选后删除行或者列后撤销，需要重建选区。\n\t\t\t\tvar tds = domUtils.getElementsByTagName(this.table, \"td\"),\n\t\t\t\t\tselectTds = [];\n\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\tif (domUtils.hasClass(td, \"selectTdClass\")) {\n\t\t\t\t\t\tselectTds.push(td);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (selectTds.length) {\n\t\t\t\t\tvar start = selectTds[0],\n\t\t\t\t\t\tend = selectTds[selectTds.length - 1],\n\t\t\t\t\t\tstartInfo = this.getCellInfo(start),\n\t\t\t\t\t\tendInfo = this.getCellInfo(end);\n\t\t\t\t\tthis.selectedTds = selectTds;\n\t\t\t\t\tthis.cellsRange = {\n\t\t\t\t\t\tbeginRowIndex: startInfo.rowIndex,\n\t\t\t\t\t\tbeginColIndex: startInfo.colIndex,\n\t\t\t\t\t\tendRowIndex: endInfo.rowIndex + endInfo.rowSpan - 1,\n\t\t\t\t\t\tendColIndex: endInfo.colIndex + endInfo.colSpan - 1\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t//给第一行设置firstRow的样式名称,在排序图标的样式上使用到\n\t\t\t\tif (!domUtils.hasClass(this.table.rows[0], \"firstRow\")) {\n\t\t\t\t\tdomUtils.addClass(this.table.rows[0], \"firstRow\");\n\t\t\t\t\tfor (var i = 1; i < this.table.rows.length; i++) {\n\t\t\t\t\t\tdomUtils.removeClasses(this.table.rows[i], \"firstRow\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取单元格的索引信息\n\t\t\t */\n\t\t\tgetCellInfo: function(cell) {\n\t\t\t\tif (!cell) return;\n\t\t\t\tvar cellIndex = cell.cellIndex,\n\t\t\t\t\trowIndex = cell.parentNode.rowIndex,\n\t\t\t\t\trowInfo = this.indexTable[rowIndex],\n\t\t\t\t\tnumCols = this.colsNum;\n\t\t\t\tfor (var colIndex = cellIndex; colIndex < numCols; colIndex++) {\n\t\t\t\t\tvar cellInfo = rowInfo[colIndex];\n\t\t\t\t\tif (cellInfo.rowIndex === rowIndex && cellInfo.cellIndex === cellIndex) {\n\t\t\t\t\t\treturn cellInfo;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 根据行列号获取单元格\n\t\t\t */\n\t\t\tgetCell: function(rowIndex, cellIndex) {\n\t\t\t\treturn rowIndex < this.rowsNum && this.table.rows[rowIndex].cells[cellIndex] || null;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除单元格\n\t\t\t */\n\t\t\tdeleteCell: function(cell, rowIndex) {\n\t\t\t\trowIndex = typeof rowIndex == 'number' ? rowIndex : cell.parentNode.rowIndex;\n\t\t\t\tvar row = this.table.rows[rowIndex];\n\t\t\t\trow.deleteCell(cell.cellIndex);\n\t\t\t},\n\t\t\t/**\n\t\t\t * 根据始末两个单元格获取被框选的所有单元格范围\n\t\t\t */\n\t\t\tgetCellsRange: function(cellA, cellB) {\n\t\t\t\tfunction checkRange(beginRowIndex, beginColIndex, endRowIndex, endColIndex) {\n\t\t\t\t\tvar tmpBeginRowIndex = beginRowIndex,\n\t\t\t\t\t\ttmpBeginColIndex = beginColIndex,\n\t\t\t\t\t\ttmpEndRowIndex = endRowIndex,\n\t\t\t\t\t\ttmpEndColIndex = endColIndex,\n\t\t\t\t\t\tcellInfo, colIndex, rowIndex;\n\t\t\t\t\t// 通过indexTable检查是否存在超出TableRange上边界的情况\n\t\t\t\t\tif (beginRowIndex > 0) {\n\t\t\t\t\t\tfor (colIndex = beginColIndex; colIndex < endColIndex; colIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[beginRowIndex][colIndex];\n\t\t\t\t\t\t\trowIndex = cellInfo.rowIndex;\n\t\t\t\t\t\t\tif (rowIndex < beginRowIndex) {\n\t\t\t\t\t\t\t\ttmpBeginRowIndex = Math.min(rowIndex, tmpBeginRowIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// 通过indexTable检查是否存在超出TableRange右边界的情况\n\t\t\t\t\tif (endColIndex < me.colsNum) {\n\t\t\t\t\t\tfor (rowIndex = beginRowIndex; rowIndex < endRowIndex; rowIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[rowIndex][endColIndex];\n\t\t\t\t\t\t\tcolIndex = cellInfo.colIndex + cellInfo.colSpan - 1;\n\t\t\t\t\t\t\tif (colIndex > endColIndex) {\n\t\t\t\t\t\t\t\ttmpEndColIndex = Math.max(colIndex, tmpEndColIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// 检查是否有超出TableRange下边界的情况\n\t\t\t\t\tif (endRowIndex < me.rowsNum) {\n\t\t\t\t\t\tfor (colIndex = beginColIndex; colIndex < endColIndex; colIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[endRowIndex][colIndex];\n\t\t\t\t\t\t\trowIndex = cellInfo.rowIndex + cellInfo.rowSpan - 1;\n\t\t\t\t\t\t\tif (rowIndex > endRowIndex) {\n\t\t\t\t\t\t\t\ttmpEndRowIndex = Math.max(rowIndex, tmpEndRowIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// 检查是否有超出TableRange左边界的情况\n\t\t\t\t\tif (beginColIndex > 0) {\n\t\t\t\t\t\tfor (rowIndex = beginRowIndex; rowIndex < endRowIndex; rowIndex++) {\n\t\t\t\t\t\t\tcellInfo = me.indexTable[rowIndex][beginColIndex];\n\t\t\t\t\t\t\tcolIndex = cellInfo.colIndex;\n\t\t\t\t\t\t\tif (colIndex < beginColIndex) {\n\t\t\t\t\t\t\t\ttmpBeginColIndex = Math.min(cellInfo.colIndex, tmpBeginColIndex);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t//递归调用直至所有完成所有框选单元格的扩展\n\t\t\t\t\tif (tmpBeginRowIndex != beginRowIndex || tmpBeginColIndex != beginColIndex || tmpEndRowIndex != endRowIndex || tmpEndColIndex != endColIndex) {\n\t\t\t\t\t\treturn checkRange(tmpBeginRowIndex, tmpBeginColIndex, tmpEndRowIndex, tmpEndColIndex);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// 不需要扩展TableRange的情况\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tbeginRowIndex: beginRowIndex,\n\t\t\t\t\t\t\tbeginColIndex: beginColIndex,\n\t\t\t\t\t\t\tendRowIndex: endRowIndex,\n\t\t\t\t\t\t\tendColIndex: endColIndex\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\tcellAInfo = me.getCellInfo(cellA);\n\t\t\t\t\tif (cellA === cellB) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tbeginRowIndex: cellAInfo.rowIndex,\n\t\t\t\t\t\t\tbeginColIndex: cellAInfo.colIndex,\n\t\t\t\t\t\t\tendRowIndex: cellAInfo.rowIndex + cellAInfo.rowSpan - 1,\n\t\t\t\t\t\t\tendColIndex: cellAInfo.colIndex + cellAInfo.colSpan - 1\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tvar cellBInfo = me.getCellInfo(cellB);\n\t\t\t\t\t// 计算TableRange的四个边\n\t\t\t\t\tvar beginRowIndex = Math.min(cellAInfo.rowIndex, cellBInfo.rowIndex),\n\t\t\t\t\t\tbeginColIndex = Math.min(cellAInfo.colIndex, cellBInfo.colIndex),\n\t\t\t\t\t\tendRowIndex = Math.max(cellAInfo.rowIndex + cellAInfo.rowSpan - 1, cellBInfo.rowIndex + cellBInfo.rowSpan - 1),\n\t\t\t\t\t\tendColIndex = Math.max(cellAInfo.colIndex + cellAInfo.colSpan - 1, cellBInfo.colIndex + cellBInfo.colSpan - 1);\n\n\t\t\t\t\treturn checkRange(beginRowIndex, beginColIndex, endRowIndex, endColIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\t//throw e;\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 依据cellsRange获取对应的单元格集合\n\t\t\t */\n\t\t\tgetCells: function(range) {\n\t\t\t\t//每次获取cells之前必须先清除上次的选择，否则会对后续获取操作造成影响\n\t\t\t\tthis.clearSelected();\n\t\t\t\tvar beginRowIndex = range.beginRowIndex,\n\t\t\t\t\tbeginColIndex = range.beginColIndex,\n\t\t\t\t\tendRowIndex = range.endRowIndex,\n\t\t\t\t\tendColIndex = range.endColIndex,\n\t\t\t\t\tcellInfo, rowIndex, colIndex, tdHash = {},\n\t\t\t\t\treturnTds = [];\n\t\t\t\tfor (var i = beginRowIndex; i <= endRowIndex; i++) {\n\t\t\t\t\tfor (var j = beginColIndex; j <= endColIndex; j++) {\n\t\t\t\t\t\tcellInfo = this.indexTable[i][j];\n\t\t\t\t\t\trowIndex = cellInfo.rowIndex;\n\t\t\t\t\t\tcolIndex = cellInfo.colIndex;\n\t\t\t\t\t\t// 如果Cells里已经包含了此Cell则跳过\n\t\t\t\t\t\tvar key = rowIndex + '|' + colIndex;\n\t\t\t\t\t\tif (tdHash[key]) continue;\n\t\t\t\t\t\ttdHash[key] = 1;\n\t\t\t\t\t\tif (rowIndex < i || colIndex < j || rowIndex + cellInfo.rowSpan - 1 > endRowIndex || colIndex + cellInfo.colSpan - 1 > endColIndex) {\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturnTds.push(this.getCell(rowIndex, cellInfo.cellIndex));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn returnTds;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 清理已经选中的单元格\n\t\t\t */\n\t\t\tclearSelected: function() {\n\t\t\t\tUETable.removeSelectedClass(this.selectedTds);\n\t\t\t\tthis.selectedTds = [];\n\t\t\t\tthis.cellsRange = {};\n\t\t\t},\n\t\t\t/**\n\t\t\t * 根据range设置已经选中的单元格\n\t\t\t */\n\t\t\tsetSelected: function(range) {\n\t\t\t\tvar cells = this.getCells(range);\n\t\t\t\tUETable.addSelectedClass(cells);\n\t\t\t\tthis.selectedTds = cells;\n\t\t\t\tthis.cellsRange = range;\n\t\t\t},\n\t\t\tisFullRow: function() {\n\t\t\t\tvar range = this.cellsRange;\n\t\t\t\treturn (range.endColIndex - range.beginColIndex + 1) == this.colsNum;\n\t\t\t},\n\t\t\tisFullCol: function() {\n\t\t\t\tvar range = this.cellsRange,\n\t\t\t\t\ttable = this.table,\n\t\t\t\t\tths = table.getElementsByTagName(\"th\"),\n\t\t\t\t\trows = range.endRowIndex - range.beginRowIndex + 1;\n\t\t\t\treturn !ths.length ? rows == this.rowsNum : rows == this.rowsNum || (rows == this.rowsNum - 1);\n\n\t\t\t},\n\t\t\t/**\n\t\t\t * 获取视觉上的前置单元格，默认是左边，top传入时\n\t\t\t * @param cell\n\t\t\t * @param top\n\t\t\t */\n\t\t\tgetNextCell: function(cell, bottom, ignoreRange) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tnextRowIndex, nextColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length && !ignoreRange,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//末行或者末列没有后置单元格\n\t\t\t\t\tif ((!bottom && (cellInfo.rowIndex == 0)) || (bottom && (!len ? (cellInfo.rowIndex + cellInfo.rowSpan > this.rowsNum - 1) : (range.endRowIndex == this.rowsNum - 1)))) return null;\n\n\t\t\t\t\tnextRowIndex = !bottom ? (!len ? cellInfo.rowIndex - 1 : range.beginRowIndex - 1) : (!len ? (cellInfo.rowIndex + cellInfo.rowSpan) : range.endRowIndex + 1);\n\t\t\t\t\tnextColIndex = !len ? cellInfo.colIndex : range.beginColIndex;\n\t\t\t\t\treturn this.getCell(this.indexTable[nextRowIndex][nextColIndex].rowIndex, this.indexTable[nextRowIndex][nextColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetPreviewCell: function(cell, top) {\n\t\t\t\ttry {\n\t\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\t\tpreviewRowIndex, previewColIndex;\n\t\t\t\t\tvar len = this.selectedTds.length,\n\t\t\t\t\t\trange = this.cellsRange;\n\t\t\t\t\t//首行或者首列没有前置单元格\n\t\t\t\t\tif ((!top && (!len ? !cellInfo.colIndex : !range.beginColIndex)) || (top && (!len ? (cellInfo.rowIndex > (this.colsNum - 1)) : (range.endColIndex == this.colsNum - 1)))) return null;\n\n\t\t\t\t\tpreviewRowIndex = !top ? (!len ? cellInfo.rowIndex : range.beginRowIndex) : (!len ? (cellInfo.rowIndex < 1 ? 0 : (cellInfo.rowIndex - 1)) : range.beginRowIndex);\n\t\t\t\t\tpreviewColIndex = !top ? (!len ? (cellInfo.colIndex < 1 ? 0 : (cellInfo.colIndex - 1)) : range.beginColIndex - 1) : (!len ? cellInfo.colIndex : range.endColIndex + 1);\n\t\t\t\t\treturn this.getCell(this.indexTable[previewRowIndex][previewColIndex].rowIndex, this.indexTable[previewRowIndex][previewColIndex].cellIndex);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tshowError(e);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 移动单元格中的内容\n\t\t\t */\n\t\t\tmoveContent: function(cellTo, cellFrom) {\n\t\t\t\tif (UETable.isEmptyBlock(cellFrom)) return;\n\t\t\t\tif (UETable.isEmptyBlock(cellTo)) {\n\t\t\t\t\tcellTo.innerHTML = cellFrom.innerHTML;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar child = cellTo.lastChild;\n\t\t\t\tif (child.nodeType == 3 || !dtd.$block[child.tagName]) {\n\t\t\t\t\tcellTo.appendChild(cellTo.ownerDocument.createElement('br'))\n\t\t\t\t}\n\t\t\t\twhile (child = cellFrom.firstChild) {\n\t\t\t\t\tcellTo.appendChild(child);\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 向右合并单元格\n\t\t\t */\n\t\t\tmergeRight: function(cell) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\trightColIndex = cellInfo.colIndex + cellInfo.colSpan,\n\t\t\t\t\trightCellInfo = this.indexTable[cellInfo.rowIndex][rightColIndex],\n\t\t\t\t\trightCell = this.getCell(rightCellInfo.rowIndex, rightCellInfo.cellIndex);\n\t\t\t\t//合并\n\t\t\t\tcell.colSpan = cellInfo.colSpan + rightCellInfo.colSpan;\n\t\t\t\t//被合并的单元格不应存在宽度属性\n\t\t\t\tcell.removeAttribute(\"width\");\n\t\t\t\t//移动内容\n\t\t\t\tthis.moveContent(cell, rightCell);\n\t\t\t\t//删掉被合并的Cell\n\t\t\t\tthis.deleteCell(rightCell, rightCellInfo.rowIndex);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 向下合并单元格\n\t\t\t */\n\t\t\tmergeDown: function(cell) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\tdownRowIndex = cellInfo.rowIndex + cellInfo.rowSpan,\n\t\t\t\t\tdownCellInfo = this.indexTable[downRowIndex][cellInfo.colIndex],\n\t\t\t\t\tdownCell = this.getCell(downCellInfo.rowIndex, downCellInfo.cellIndex);\n\t\t\t\tcell.rowSpan = cellInfo.rowSpan + downCellInfo.rowSpan;\n\t\t\t\tcell.removeAttribute(\"height\");\n\t\t\t\tthis.moveContent(cell, downCell);\n\t\t\t\tthis.deleteCell(downCell, downCellInfo.rowIndex);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 合并整个range中的内容\n\t\t\t */\n\t\t\tmergeRange: function() {\n\t\t\t\t//由于合并操作可以在任意时刻进行，所以无法通过鼠标位置等信息实时生成range，只能通过缓存实例中的cellsRange对象来访问\n\t\t\t\tvar range = this.cellsRange,\n\t\t\t\t\tleftTopCell = this.getCell(range.beginRowIndex, this.indexTable[range.beginRowIndex][range.beginColIndex].cellIndex);\n\n\t\t\t\tif (leftTopCell.tagName == \"TH\" && range.endRowIndex !== range.beginRowIndex) {\n\t\t\t\t\tvar index = this.indexTable,\n\t\t\t\t\t\tinfo = this.getCellInfo(leftTopCell);\n\t\t\t\t\tleftTopCell = this.getCell(1, index[1][info.colIndex].cellIndex);\n\t\t\t\t\trange = this.getCellsRange(leftTopCell, this.getCell(index[this.rowsNum - 1][info.colIndex].rowIndex, index[this.rowsNum - 1][info.colIndex].cellIndex));\n\t\t\t\t}\n\n\t\t\t\t// 删除剩余的Cells\n\t\t\t\tvar cells = this.getCells(range);\n\t\t\t\tfor (var i = 0, ci; ci = cells[i++];) {\n\t\t\t\t\tif (ci !== leftTopCell) {\n\t\t\t\t\t\tthis.moveContent(leftTopCell, ci);\n\t\t\t\t\t\tthis.deleteCell(ci);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// 修改左上角Cell的rowSpan和colSpan，并调整宽度属性设置\n\t\t\t\tleftTopCell.rowSpan = range.endRowIndex - range.beginRowIndex + 1;\n\t\t\t\tleftTopCell.rowSpan > 1 && leftTopCell.removeAttribute(\"height\");\n\t\t\t\tleftTopCell.colSpan = range.endColIndex - range.beginColIndex + 1;\n\t\t\t\tleftTopCell.colSpan > 1 && leftTopCell.removeAttribute(\"width\");\n\t\t\t\tif (leftTopCell.rowSpan == this.rowsNum && leftTopCell.colSpan != 1) {\n\t\t\t\t\tleftTopCell.colSpan = 1;\n\t\t\t\t}\n\n\t\t\t\tif (leftTopCell.colSpan == this.colsNum && leftTopCell.rowSpan != 1) {\n\t\t\t\t\tvar rowIndex = leftTopCell.parentNode.rowIndex;\n\t\t\t\t\t//解决IE下的表格操作问题\n\t\t\t\t\tif (this.table.deleteRow) {\n\t\t\t\t\t\tfor (var i = rowIndex + 1, curIndex = rowIndex + 1, len = leftTopCell.rowSpan; i < len; i++) {\n\t\t\t\t\t\t\tthis.table.deleteRow(curIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor (var i = 0, len = leftTopCell.rowSpan - 1; i < len; i++) {\n\t\t\t\t\t\t\tvar row = this.table.rows[rowIndex + 1];\n\t\t\t\t\t\t\trow.parentNode.removeChild(row);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tleftTopCell.rowSpan = 1;\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\t/**\n\t\t\t * 插入一行单元格\n\t\t\t */\n\t\t\tinsertRow: function(rowIndex, sourceCell) {\n\t\t\t\tvar numCols = this.colsNum,\n\t\t\t\t\ttable = this.table,\n\t\t\t\t\trow = table.insertRow(rowIndex),\n\t\t\t\t\tcell,\n\t\t\t\t\tisInsertTitle = typeof sourceCell == 'string' && sourceCell.toUpperCase() == 'TH';\n\n\t\t\t\tfunction replaceTdToTh(colIndex, cell, tableRow) {\n\t\t\t\t\tif (colIndex == 0) {\n\t\t\t\t\t\tvar tr = tableRow.nextSibling || tableRow.previousSibling,\n\t\t\t\t\t\t\tth = tr.cells[colIndex];\n\t\t\t\t\t\tif (th.tagName == 'TH') {\n\t\t\t\t\t\t\tth = cell.ownerDocument.createElement(\"th\");\n\t\t\t\t\t\t\tth.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(th, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\t\tvar td = cell.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\ttd.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(td, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//首行直接插入,无需考虑部分单元格被rowspan的情况\n\t\t\t\tif (rowIndex == 0 || rowIndex == this.rowsNum) {\n\t\t\t\t\tfor (var colIndex = 0; colIndex < numCols; colIndex++) {\n\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true);\n\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\tcell.getAttribute('vAlign') && cell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\tif (!isInsertTitle) replaceTdToTh(colIndex, cell, row);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar infoRow = this.indexTable[rowIndex],\n\t\t\t\t\t\tcellIndex = 0;\n\t\t\t\t\tfor (colIndex = 0; colIndex < numCols; colIndex++) {\n\t\t\t\t\t\tvar cellInfo = infoRow[colIndex];\n\t\t\t\t\t\t//如果存在某个单元格的rowspan穿过待插入行的位置，则修改该单元格的rowspan即可，无需插入单元格\n\t\t\t\t\t\tif (cellInfo.rowIndex < rowIndex) {\n\t\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\t\tcell.rowSpan = cellInfo.rowSpan + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true);\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\trow.appendChild(cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isInsertTitle) replaceTdToTh(colIndex, cell, row);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//框选时插入不触发contentchange，需要手动更新索引。\n\t\t\t\tthis.update();\n\t\t\t\treturn row;\n\t\t\t},\n\t\t\t/**\n\t\t\t * 删除一行单元格\n\t\t\t * @param rowIndex\n\t\t\t */\n\t\t\tdeleteRow: function(rowIndex) {\n\t\t\t\tvar row = this.table.rows[rowIndex],\n\t\t\t\t\tinfoRow = this.indexTable[rowIndex],\n\t\t\t\t\tcolsNum = this.colsNum,\n\t\t\t\t\tcount = 0; //处理计数\n\t\t\t\tfor (var colIndex = 0; colIndex < colsNum;) {\n\t\t\t\t\tvar cellInfo = infoRow[colIndex],\n\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\tif (cell.rowSpan > 1) {\n\t\t\t\t\t\tif (cellInfo.rowIndex == rowIndex) {\n\t\t\t\t\t\t\tvar clone = cell.cloneNode(true);\n\t\t\t\t\t\t\tclone.rowSpan = cell.rowSpan - 1;\n\t\t\t\t\t\t\tclone.innerHTML = \"\";\n\t\t\t\t\t\t\tcell.rowSpan = 1;\n\t\t\t\t\t\t\tvar nextRowIndex = rowIndex + 1,\n\t\t\t\t\t\t\t\tnextRow = this.table.rows[nextRowIndex],\n\t\t\t\t\t\t\t\tinsertCellIndex,\n\t\t\t\t\t\t\t\tpreMerged = this.getPreviewMergedCellsNum(nextRowIndex, colIndex) - count;\n\t\t\t\t\t\t\tif (preMerged < colIndex) {\n\t\t\t\t\t\t\t\tinsertCellIndex = colIndex - preMerged - 1;\n\t\t\t\t\t\t\t\t//nextRow.insertCell(insertCellIndex);\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(nextRow.cells[insertCellIndex], clone);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (nextRow.cells.length) nextRow.insertBefore(clone, nextRow.cells[0])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcount += 1;\n\t\t\t\t\t\t\t//cell.parentNode.removeChild(cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcolIndex += cell.colSpan || 1;\n\t\t\t\t}\n\t\t\t\tvar deleteTds = [],\n\t\t\t\t\tcacheMap = {};\n\t\t\t\tfor (colIndex = 0; colIndex < colsNum; colIndex++) {\n\t\t\t\t\tvar tmpRowIndex = infoRow[colIndex].rowIndex,\n\t\t\t\t\t\ttmpCellIndex = infoRow[colIndex].cellIndex,\n\t\t\t\t\t\tkey = tmpRowIndex + \"_\" + tmpCellIndex;\n\t\t\t\t\tif (cacheMap[key]) continue;\n\t\t\t\t\tcacheMap[key] = 1;\n\t\t\t\t\tcell = this.getCell(tmpRowIndex, tmpCellIndex);\n\t\t\t\t\tdeleteTds.push(cell);\n\t\t\t\t}\n\t\t\t\tvar mergeTds = [];\n\t\t\t\tutils.each(deleteTds, function(td) {\n\t\t\t\t\tif (td.rowSpan == 1) {\n\t\t\t\t\t\ttd.parentNode.removeChild(td);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmergeTds.push(td);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tutils.each(mergeTds, function(td) {\n\t\t\t\t\ttd.rowSpan--;\n\t\t\t\t});\n\t\t\t\trow.parentNode.removeChild(row);\n\t\t\t\t//浏览器方法本身存在bug,采用自定义方法删除\n\t\t\t\t//this.table.deleteRow(rowIndex);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\tinsertCol: function(colIndex, sourceCell, defaultValue) {\n\t\t\t\tvar rowsNum = this.rowsNum,\n\t\t\t\t\trowIndex = 0,\n\t\t\t\t\ttableRow, cell,\n\t\t\t\t\tbackWidth = parseInt((this.table.offsetWidth - (this.colsNum + 1) * 20 - (this.colsNum + 1)) / (this.colsNum + 1), 10),\n\t\t\t\t\tisInsertTitleCol = typeof sourceCell == 'string' && sourceCell.toUpperCase() == 'TH';\n\n\t\t\t\tfunction replaceTdToTh(rowIndex, cell, tableRow) {\n\t\t\t\t\tif (rowIndex == 0) {\n\t\t\t\t\t\tvar th = cell.nextSibling || cell.previousSibling;\n\t\t\t\t\t\tif (th.tagName == 'TH') {\n\t\t\t\t\t\t\tth = cell.ownerDocument.createElement(\"th\");\n\t\t\t\t\t\t\tth.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(th, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\t\tvar td = cell.ownerDocument.createElement(\"td\");\n\t\t\t\t\t\t\ttd.appendChild(cell.firstChild);\n\t\t\t\t\t\t\ttableRow.insertBefore(td, cell);\n\t\t\t\t\t\t\tdomUtils.remove(cell)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar preCell;\n\t\t\t\tif (colIndex == 0 || colIndex == this.colsNum) {\n\t\t\t\t\tfor (; rowIndex < rowsNum; rowIndex++) {\n\t\t\t\t\t\ttableRow = this.table.rows[rowIndex];\n\t\t\t\t\t\tpreCell = tableRow.cells[colIndex == 0 ? colIndex : tableRow.cells.length];\n\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true); //tableRow.insertCell(colIndex == 0 ? colIndex : tableRow.cells.length);\n\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\tcell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\tpreCell && cell.setAttribute('width', preCell.getAttribute('width'));\n\t\t\t\t\t\tif (!colIndex) {\n\t\t\t\t\t\t\ttableRow.insertBefore(cell, tableRow.cells[0]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.insertAfter(tableRow.cells[tableRow.cells.length - 1], cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isInsertTitleCol) replaceTdToTh(rowIndex, cell, tableRow)\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor (; rowIndex < rowsNum; rowIndex++) {\n\t\t\t\t\t\tvar cellInfo = this.indexTable[rowIndex][colIndex];\n\t\t\t\t\t\tif (cellInfo.colIndex < colIndex) {\n\t\t\t\t\t\t\tcell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\t\t\tcell.colSpan = cellInfo.colSpan + 1;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttableRow = this.table.rows[rowIndex];\n\t\t\t\t\t\t\tpreCell = tableRow.cells[cellInfo.cellIndex];\n\n\t\t\t\t\t\t\tcell = this.cloneCell(sourceCell, true); //tableRow.insertCell(cellInfo.cellIndex);\n\t\t\t\t\t\t\tthis.setCellContent(cell);\n\t\t\t\t\t\t\tcell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\t\tpreCell && cell.setAttribute('width', preCell.getAttribute('width'));\n\t\t\t\t\t\t\t//防止IE下报错\n\t\t\t\t\t\t\tpreCell ? tableRow.insertBefore(cell, preCell) : tableRow.appendChild(cell);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!isInsertTitleCol) replaceTdToTh(rowIndex, cell, tableRow);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//框选时插入不触发contentchange，需要手动更新索引\n\t\t\t\tthis.update();\n\t\t\t\tthis.updateWidth(backWidth, defaultValue || {\n\t\t\t\t\ttdPadding: 10,\n\t\t\t\t\ttdBorder: 1\n\t\t\t\t});\n\t\t\t},\n\t\t\tupdateWidth: function(width, defaultValue) {\n\t\t\t\tvar table = this.table,\n\t\t\t\t\ttmpWidth = UETable.getWidth(table) - defaultValue.tdPadding * 2 - defaultValue.tdBorder + width;\n\t\t\t\tif (tmpWidth < table.ownerDocument.body.offsetWidth) {\n\t\t\t\t\ttable.setAttribute(\"width\", tmpWidth);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar tds = domUtils.getElementsByTagName(this.table, \"td th\");\n\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\ttd.setAttribute(\"width\", width);\n\t\t\t\t})\n\t\t\t},\n\t\t\tdeleteCol: function(colIndex) {\n\t\t\t\tvar indexTable = this.indexTable,\n\t\t\t\t\ttableRows = this.table.rows,\n\t\t\t\t\tbackTableWidth = this.table.getAttribute(\"width\"),\n\t\t\t\t\tbackTdWidth = 0,\n\t\t\t\t\trowsNum = this.rowsNum,\n\t\t\t\t\tcacheMap = {};\n\t\t\t\tfor (var rowIndex = 0; rowIndex < rowsNum;) {\n\t\t\t\t\tvar infoRow = indexTable[rowIndex],\n\t\t\t\t\t\tcellInfo = infoRow[colIndex],\n\t\t\t\t\t\tkey = cellInfo.rowIndex + '_' + cellInfo.colIndex;\n\t\t\t\t\t// 跳过已经处理过的Cell\n\t\t\t\t\tif (cacheMap[key]) continue;\n\t\t\t\t\tcacheMap[key] = 1;\n\t\t\t\t\tvar cell = this.getCell(cellInfo.rowIndex, cellInfo.cellIndex);\n\t\t\t\t\tif (!backTdWidth) backTdWidth = cell && parseInt(cell.offsetWidth / cell.colSpan, 10).toFixed(0);\n\t\t\t\t\t// 如果Cell的colSpan大于1, 就修改colSpan, 否则就删掉这个Cell\n\t\t\t\t\tif (cell.colSpan > 1) {\n\t\t\t\t\t\tcell.colSpan--;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttableRows[rowIndex].deleteCell(cellInfo.cellIndex);\n\t\t\t\t\t}\n\t\t\t\t\trowIndex += cellInfo.rowSpan || 1;\n\t\t\t\t}\n\t\t\t\tthis.table.setAttribute(\"width\", backTableWidth - backTdWidth);\n\t\t\t\tthis.update();\n\t\t\t},\n\t\t\tsplitToCells: function(cell) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tcells = this.splitToRows(cell);\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tme.splitToCols(cell);\n\t\t\t\t})\n\t\t\t},\n\t\t\tsplitToRows: function(cell) {\n\t\t\t\tvar cellInfo = this.getCellInfo(cell),\n\t\t\t\t\trowIndex = cellInfo.rowIndex,\n\t\t\t\t\tcolIndex = cellInfo.colIndex,\n\t\t\t\t\tresults = [];\n\t\t\t\t// 修改Cell的rowSpan\n\t\t\t\tcell.rowSpan = 1;\n\t\t\t\tresults.push(cell);\n\t\t\t\t// 补齐单元格\n\t\t\t\tfor (var i = rowIndex, endRow = rowIndex + cellInfo.rowSpan; i < endRow; i++) {\n\t\t\t\t\tif (i == rowIndex) continue;\n\t\t\t\t\tvar tableRow = this.table.rows[i],\n\t\t\t\t\t\ttmpCell = tableRow.insertCell(colIndex - this.getPreviewMergedCellsNum(i, colIndex));\n\t\t\t\t\ttmpCell.colSpan = cellInfo.colSpan;\n\t\t\t\t\tthis.setCellContent(tmpCell);\n\t\t\t\t\ttmpCell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\ttmpCell.setAttribute('align', cell.getAttribute('align'));\n\t\t\t\t\tif (cell.style.cssText) {\n\t\t\t\t\t\ttmpCell.style.cssText = cell.style.cssText;\n\t\t\t\t\t}\n\t\t\t\t\tresults.push(tmpCell);\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t\treturn results;\n\t\t\t},\n\t\t\tgetPreviewMergedCellsNum: function(rowIndex, colIndex) {\n\t\t\t\tvar indexRow = this.indexTable[rowIndex],\n\t\t\t\t\tnum = 0;\n\t\t\t\tfor (var i = 0; i < colIndex;) {\n\t\t\t\t\tvar colSpan = indexRow[i].colSpan,\n\t\t\t\t\t\ttmpRowIndex = indexRow[i].rowIndex;\n\t\t\t\t\tnum += (colSpan - (tmpRowIndex == rowIndex ? 1 : 0));\n\t\t\t\t\ti += colSpan;\n\t\t\t\t}\n\t\t\t\treturn num;\n\t\t\t},\n\t\t\tsplitToCols: function(cell) {\n\t\t\t\tvar backWidth = (cell.offsetWidth / cell.colSpan - 22).toFixed(0),\n\n\t\t\t\t\tcellInfo = this.getCellInfo(cell),\n\t\t\t\t\trowIndex = cellInfo.rowIndex,\n\t\t\t\t\tcolIndex = cellInfo.colIndex,\n\t\t\t\t\tresults = [];\n\t\t\t\t// 修改Cell的rowSpan\n\t\t\t\tcell.colSpan = 1;\n\t\t\t\tcell.setAttribute(\"width\", backWidth);\n\t\t\t\tresults.push(cell);\n\t\t\t\t// 补齐单元格\n\t\t\t\tfor (var j = colIndex, endCol = colIndex + cellInfo.colSpan; j < endCol; j++) {\n\t\t\t\t\tif (j == colIndex) continue;\n\t\t\t\t\tvar tableRow = this.table.rows[rowIndex],\n\t\t\t\t\t\ttmpCell = tableRow.insertCell(this.indexTable[rowIndex][j].cellIndex + 1);\n\t\t\t\t\ttmpCell.rowSpan = cellInfo.rowSpan;\n\t\t\t\t\tthis.setCellContent(tmpCell);\n\t\t\t\t\ttmpCell.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\ttmpCell.setAttribute('align', cell.getAttribute('align'));\n\t\t\t\t\ttmpCell.setAttribute('width', backWidth);\n\t\t\t\t\tif (cell.style.cssText) {\n\t\t\t\t\t\ttmpCell.style.cssText = cell.style.cssText;\n\t\t\t\t\t}\n\t\t\t\t\t//处理th的情况\n\t\t\t\t\tif (cell.tagName == 'TH') {\n\t\t\t\t\t\tvar th = cell.ownerDocument.createElement('th');\n\t\t\t\t\t\tth.appendChild(tmpCell.firstChild);\n\t\t\t\t\t\tth.setAttribute('vAlign', cell.getAttribute('vAlign'));\n\t\t\t\t\t\tth.rowSpan = tmpCell.rowSpan;\n\t\t\t\t\t\ttableRow.insertBefore(th, tmpCell);\n\t\t\t\t\t\tdomUtils.remove(tmpCell);\n\t\t\t\t\t}\n\t\t\t\t\tresults.push(tmpCell);\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t\treturn results;\n\t\t\t},\n\t\t\tisLastCell: function(cell, rowsNum, colsNum) {\n\t\t\t\trowsNum = rowsNum || this.rowsNum;\n\t\t\t\tcolsNum = colsNum || this.colsNum;\n\t\t\t\tvar cellInfo = this.getCellInfo(cell);\n\t\t\t\treturn ((cellInfo.rowIndex + cellInfo.rowSpan) == rowsNum) &&\n\t\t\t\t\t((cellInfo.colIndex + cellInfo.colSpan) == colsNum);\n\t\t\t},\n\t\t\tgetLastCell: function(cells) {\n\t\t\t\tcells = cells || this.table.getElementsByTagName(\"td\");\n\t\t\t\tvar firstInfo = this.getCellInfo(cells[0]);\n\t\t\t\tvar me = this,\n\t\t\t\t\tlast = cells[0],\n\t\t\t\t\ttr = last.parentNode,\n\t\t\t\t\tcellsNum = 0,\n\t\t\t\t\tcols = 0,\n\t\t\t\t\trows;\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tif (cell.parentNode == tr) cols += cell.colSpan || 1;\n\t\t\t\t\tcellsNum += cell.rowSpan * cell.colSpan || 1;\n\t\t\t\t});\n\t\t\t\trows = cellsNum / cols;\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tif (me.isLastCell(cell, rows, cols)) {\n\t\t\t\t\t\tlast = cell;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\treturn last;\n\n\t\t\t},\n\t\t\tselectRow: function(rowIndex) {\n\t\t\t\tvar indexRow = this.indexTable[rowIndex],\n\t\t\t\t\tstart = this.getCell(indexRow[0].rowIndex, indexRow[0].cellIndex),\n\t\t\t\t\tend = this.getCell(indexRow[this.colsNum - 1].rowIndex, indexRow[this.colsNum - 1].cellIndex),\n\t\t\t\t\trange = this.getCellsRange(start, end);\n\t\t\t\tthis.setSelected(range);\n\t\t\t},\n\t\t\tselectTable: function() {\n\t\t\t\tvar tds = this.table.getElementsByTagName(\"td\"),\n\t\t\t\t\trange = this.getCellsRange(tds[0], tds[tds.length - 1]);\n\t\t\t\tthis.setSelected(range);\n\t\t\t},\n\t\t\tsetBackground: function(cells, value) {\n\t\t\t\tif (typeof value === \"string\") {\n\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\tcell.style.backgroundColor = value;\n\t\t\t\t\t})\n\t\t\t\t} else if (typeof value === \"object\") {\n\t\t\t\t\tvalue = utils.extend({\n\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\tcolorList: [\"#ddd\", \"#fff\"]\n\t\t\t\t\t}, value);\n\t\t\t\t\tvar rowIndex = this.getCellInfo(cells[0]).rowIndex,\n\t\t\t\t\t\tcount = 0,\n\t\t\t\t\t\tcolors = value.colorList,\n\t\t\t\t\t\tgetColor = function(list, index, repeat) {\n\t\t\t\t\t\t\treturn list[index] ? list[index] : repeat ? list[index % list.length] : \"\";\n\t\t\t\t\t\t};\n\t\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\t\tvar cellInfo = this.getCellInfo(cell);\n\t\t\t\t\t\tcell.style.backgroundColor = getColor(colors, ((rowIndex + count) == cellInfo.rowIndex) ? count : ++count, value.repeat);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveBackground: function(cells) {\n\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\tcell.style.backgroundColor = \"\";\n\t\t\t\t})\n\t\t\t}\n\n\t\t};\n\n\t\tfunction showError(e) {}\n\t})();\n\n\t// plugins/table.cmds.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: taoqili\n\t * Date: 13-2-20\n\t * Time: 下午6:25\n\t * To change this template use File | Settings | File Templates.\n\t */\n\t;\n\t(function() {\n\t\tvar UT = UE.UETable,\n\t\t\tgetTableItemsByRange = function(editor) {\n\t\t\t\treturn UT.getTableItemsByRange(editor);\n\t\t\t},\n\t\t\tgetUETableBySelected = function(editor) {\n\t\t\t\treturn UT.getUETableBySelected(editor)\n\t\t\t},\n\t\t\tgetDefaultValue = function(editor, table) {\n\t\t\t\treturn UT.getDefaultValue(editor, table);\n\t\t\t},\n\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t};\n\n\t\tUE.commands['inserttable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? -1 : 0;\n\t\t\t},\n\t\t\texecCommand: function(cmd, opt) {\n\t\t\t\tfunction createTable(opt, tdWidth) {\n\t\t\t\t\tvar html = [],\n\t\t\t\t\t\trowsNum = opt.numRows,\n\t\t\t\t\t\tcolsNum = opt.numCols;\n\t\t\t\t\tfor (var r = 0; r < rowsNum; r++) {\n\t\t\t\t\t\thtml.push('<tr' + (r == 0 ? ' class=\"firstRow\"' : '') + '>');\n\t\t\t\t\t\tfor (var c = 0; c < colsNum; c++) {\n\t\t\t\t\t\t\thtml.push('<td width=\"' + tdWidth + '\"  vAlign=\"' + opt.tdvalign + '\" >' + (browser.ie && browser.version < 11 ? domUtils.fillChar : '<br/>') + '</td>')\n\t\t\t\t\t\t}\n\t\t\t\t\t\thtml.push('</tr>')\n\t\t\t\t\t}\n\t\t\t\t\t//禁止指定table-width\n\t\t\t\t\treturn '<table><tbody>' + html.join('') + '</tbody></table>'\n\t\t\t\t}\n\n\t\t\t\tif (!opt) {\n\t\t\t\t\topt = utils.extend({}, {\n\t\t\t\t\t\tnumCols: this.options.defaultCols,\n\t\t\t\t\t\tnumRows: this.options.defaultRows,\n\t\t\t\t\t\ttdvalign: this.options.tdvalign\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tvar me = this;\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tstart = range.startContainer,\n\t\t\t\t\tfirstParentBlock = domUtils.findParent(start, function(node) {\n\t\t\t\t\t\treturn domUtils.isBlockElm(node);\n\t\t\t\t\t}, true) || me.body;\n\n\t\t\t\tvar defaultValue = getDefaultValue(me),\n\t\t\t\t\ttableWidth = firstParentBlock.offsetWidth,\n\t\t\t\t\ttdWidth = Math.floor(tableWidth / opt.numCols - defaultValue.tdPadding * 2 - defaultValue.tdBorder);\n\n\t\t\t\t//todo其他属性\n\t\t\t\t!opt.tdvalign && (opt.tdvalign = me.options.tdvalign);\n\t\t\t\tme.execCommand(\"inserthtml\", createTable(opt, tdWidth));\n\t\t\t}\n\t\t};\n\n\t\tUE.commands['insertparagraphbeforetable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).cell ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar p = this.document.createElement(\"p\");\n\t\t\t\t\tp.innerHTML = browser.ie ? '&nbsp;' : '<br />';\n\t\t\t\t\ttable.parentNode.insertBefore(p, table);\n\t\t\t\t\tthis.selection.getRange().setStart(p, 0).setCursor();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tUE.commands['deletetable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\treturn domUtils.findParentByTagName(rng.startContainer, 'table', true) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd, table) {\n\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\ttable = table || domUtils.findParentByTagName(rng.startContainer, 'table', true);\n\t\t\t\tif (table) {\n\t\t\t\t\tvar next = table.nextSibling;\n\t\t\t\t\tif (!next) {\n\t\t\t\t\t\tnext = domUtils.createElement(this.document, 'p', {\n\t\t\t\t\t\t\t'innerHTML': browser.ie ? domUtils.fillChar : '<br/>'\n\t\t\t\t\t\t});\n\t\t\t\t\t\ttable.parentNode.insertBefore(next, table);\n\t\t\t\t\t}\n\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\trng = this.selection.getRange();\n\t\t\t\t\tif (next.nodeType == 3) {\n\t\t\t\t\t\trng.setStartBefore(next)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.setStart(next, 0)\n\t\t\t\t\t}\n\t\t\t\t\trng.setCursor(false, true)\n\t\t\t\t\tthis.fireEvent(\"tablehasdeleted\")\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands['cellalign'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getSelectedArr(this).length ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, align) {\n\t\t\t\tvar selectedTds = getSelectedArr(this);\n\t\t\t\tif (selectedTds.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = selectedTds[i++];) {\n\t\t\t\t\t\tci.setAttribute('align', align);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands['cellvalign'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getSelectedArr(this).length ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd, valign) {\n\t\t\t\tvar selectedTds = getSelectedArr(this);\n\t\t\t\tif (selectedTds.length) {\n\t\t\t\t\tfor (var i = 0, ci; ci = selectedTds[i++];) {\n\t\t\t\t\t\tci.setAttribute('vAlign', valign);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands['insertcaption'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\treturn table.getElementsByTagName('caption').length == 0 ? 1 : -1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar caption = this.document.createElement('caption');\n\t\t\t\t\tcaption.innerHTML = browser.ie ? domUtils.fillChar : '<br/>';\n\t\t\t\t\ttable.insertBefore(caption, table.firstChild);\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\trange.setStart(caption, 0).setCursor();\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands['deletecaption'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\treturn table.getElementsByTagName('caption').length == 0 ? -1 : 1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\tdomUtils.remove(table.getElementsByTagName('caption')[0]);\n\t\t\t\t\tvar range = this.selection.getRange();\n\t\t\t\t\trange.setStart(table.rows[0].cells[0], 0).setCursor();\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands['inserttitle'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar firstRow = table.rows[0];\n\t\t\t\t\treturn firstRow.cells[firstRow.cells.length - 1].tagName.toLowerCase() != 'th' ? 0 : -1\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tgetUETable(table).insertRow(0, 'th');\n\t\t\t\t}\n\t\t\t\tvar th = table.getElementsByTagName('th')[0];\n\t\t\t\tthis.selection.getRange().setStart(th, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\t\tUE.commands['deletetitle'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar firstRow = table.rows[0];\n\t\t\t\t\treturn firstRow.cells[firstRow.cells.length - 1].tagName.toLowerCase() == 'th' ? 0 : -1\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tdomUtils.remove(table.rows[0])\n\t\t\t\t}\n\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\tthis.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\t\tUE.commands['inserttitlecol'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar lastRow = table.rows[table.rows.length - 1];\n\t\t\t\t\treturn lastRow.getElementsByTagName('th').length ? -1 : 0;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tgetUETable(table).insertCol(0, 'th');\n\t\t\t\t}\n\t\t\t\tresetTdWidth(table, this);\n\t\t\t\tvar th = table.getElementsByTagName('th')[0];\n\t\t\t\tthis.selection.getRange().setStart(th, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\t\tUE.commands['deletetitlecol'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tvar lastRow = table.rows[table.rows.length - 1];\n\t\t\t\t\treturn lastRow.getElementsByTagName('th').length ? 0 : -1;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table) {\n\t\t\t\t\tfor (var i = 0; i < table.rows.length; i++) {\n\t\t\t\t\t\tdomUtils.remove(table.rows[i].children[0])\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tresetTdWidth(table, this);\n\t\t\t\tvar td = table.getElementsByTagName('td')[0];\n\t\t\t\tthis.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"mergeright\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tcell = tableItems.cell;\n\n\t\t\t\tif (!table || !cell) return -1;\n\t\t\t\tvar ut = getUETable(table);\n\t\t\t\tif (ut.selectedTds.length) return -1;\n\n\t\t\t\tvar cellInfo = ut.getCellInfo(cell),\n\t\t\t\t\trightColIndex = cellInfo.colIndex + cellInfo.colSpan;\n\t\t\t\tif (rightColIndex >= ut.colsNum) return -1; // 如果处于最右边则不能向右合并\n\n\t\t\t\tvar rightCellInfo = ut.indexTable[cellInfo.rowIndex][rightColIndex],\n\t\t\t\t\trightCell = table.rows[rightCellInfo.rowIndex].cells[rightCellInfo.cellIndex];\n\t\t\t\tif (!rightCell || cell.tagName != rightCell.tagName) return -1; // TH和TD不能相互合并\n\n\t\t\t\t// 当且仅当两个Cell的开始列号和结束列号一致时能进行合并\n\t\t\t\treturn (rightCellInfo.rowIndex == cellInfo.rowIndex && rightCellInfo.rowSpan == cellInfo.rowSpan) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.mergeRight(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"mergedown\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tcell = tableItems.cell;\n\n\t\t\t\tif (!table || !cell) return -1;\n\t\t\t\tvar ut = getUETable(table);\n\t\t\t\tif (ut.selectedTds.length) return -1;\n\n\t\t\t\tvar cellInfo = ut.getCellInfo(cell),\n\t\t\t\t\tdownRowIndex = cellInfo.rowIndex + cellInfo.rowSpan;\n\t\t\t\tif (downRowIndex >= ut.rowsNum) return -1; // 如果处于最下边则不能向下合并\n\n\t\t\t\tvar downCellInfo = ut.indexTable[downRowIndex][cellInfo.colIndex],\n\t\t\t\t\tdownCell = table.rows[downCellInfo.rowIndex].cells[downCellInfo.cellIndex];\n\t\t\t\tif (!downCell || cell.tagName != downCell.tagName) return -1; // TH和TD不能相互合并\n\n\t\t\t\t// 当且仅当两个Cell的开始列号和结束列号一致时能进行合并\n\t\t\t\treturn (downCellInfo.colIndex == cellInfo.colIndex && downCellInfo.colSpan == cellInfo.colSpan) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.mergeDown(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"mergecells\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getUETableBySelected(this) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\tvar cell = ut.selectedTds[0];\n\t\t\t\t\tut.mergeRange();\n\t\t\t\t\tvar rng = this.selection.getRange();\n\t\t\t\t\tif (domUtils.isEmptyBlock(cell)) {\n\t\t\t\t\t\trng.setStart(cell, 0).collapse(true)\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.selectNodeContents(cell)\n\t\t\t\t\t}\n\t\t\t\t\trng.select();\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"insertrow\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && (cell.tagName == \"TD\" || (cell.tagName == 'TH' && tableItems.tr !== tableItems.table.rows[0])) &&\n\t\t\t\t\tgetUETable(tableItems.table).rowsNum < this.options.maxRowNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tut = getUETable(table),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t//ut.insertRow(!ut.selectedTds.length ? cellInfo.rowIndex:ut.cellsRange.beginRowIndex,'');\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertRow(cellInfo.rowIndex, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endRowIndex - range.beginRowIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertRow(range.beginRowIndex, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t}\n\t\t};\n\t\t//后插入行\n\t\tUE.commands[\"insertrownext\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && (cell.tagName == \"TD\") && getUETable(tableItems.table).rowsNum < this.options.maxRowNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\ttable = tableItems.table,\n\t\t\t\t\tut = getUETable(table),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t//ut.insertRow(!ut.selectedTds.length? cellInfo.rowIndex + cellInfo.rowSpan : ut.cellsRange.endRowIndex + 1,'');\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertRow(cellInfo.rowIndex + cellInfo.rowSpan, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endRowIndex - range.beginRowIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertRow(range.endRowIndex + 1, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"deleterow\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this);\n\t\t\t\treturn tableItems.cell ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\tcellsRange = ut.cellsRange,\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell),\n\t\t\t\t\tpreCell = ut.getVSideCell(cell),\n\t\t\t\t\tnextCell = ut.getVSideCell(cell, true),\n\t\t\t\t\trng = this.selection.getRange();\n\t\t\t\tif (utils.isEmptyObject(cellsRange)) {\n\t\t\t\t\tut.deleteRow(cellInfo.rowIndex);\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = cellsRange.beginRowIndex; i < cellsRange.endRowIndex + 1; i++) {\n\t\t\t\t\t\tut.deleteRow(cellsRange.beginRowIndex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar table = ut.table;\n\t\t\t\tif (!table.getElementsByTagName('td').length) {\n\t\t\t\t\tvar nextSibling = table.nextSibling;\n\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\tif (nextSibling) {\n\t\t\t\t\t\trng.setStart(nextSibling, 0).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (cellInfo.rowSpan == 1 || cellInfo.rowSpan == cellsRange.endRowIndex - cellsRange.beginRowIndex + 1) {\n\t\t\t\t\t\tif (nextCell || preCell) rng.selectNodeContents(nextCell || preCell).setCursor(false, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar newCell = ut.getCell(cellInfo.rowIndex, ut.indexTable[cellInfo.rowIndex][cellInfo.colIndex].cellIndex);\n\t\t\t\t\t\tif (newCell) rng.selectNodeContents(newCell).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (table.getAttribute(\"interlaced\") === \"enabled\") this.fireEvent(\"interlacetable\", table);\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"insertcol\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && (cell.tagName == \"TD\" || (cell.tagName == 'TH' && cell !== tableItems.tr.cells[0])) &&\n\t\t\t\t\tgetUETable(tableItems.table).colsNum < this.options.maxColNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tif (this.queryCommandState(cmd) == -1) return;\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\n\t\t\t\t//ut.insertCol(!ut.selectedTds.length ? cellInfo.colIndex:ut.cellsRange.beginColIndex);\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertCol(cellInfo.colIndex, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endColIndex - range.beginColIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertCol(range.beginColIndex, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select(true);\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"insertcolnext\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\treturn cell && getUETable(tableItems.table).colsNum < this.options.maxColNum ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\t//ut.insertCol(!ut.selectedTds.length ? cellInfo.colIndex + cellInfo.colSpan:ut.cellsRange.endColIndex +1);\n\t\t\t\tif (!ut.selectedTds.length) {\n\t\t\t\t\tut.insertCol(cellInfo.colIndex + cellInfo.colSpan, cell);\n\t\t\t\t} else {\n\t\t\t\t\tvar range = ut.cellsRange;\n\t\t\t\t\tfor (var i = 0, len = range.endColIndex - range.beginColIndex + 1; i < len; i++) {\n\t\t\t\t\t\tut.insertCol(range.endColIndex + 1, cell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"deletecol\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this);\n\t\t\t\treturn tableItems.cell ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell),\n\t\t\t\t\trange = ut.cellsRange,\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell),\n\t\t\t\t\tpreCell = ut.getHSideCell(cell),\n\t\t\t\t\tnextCell = ut.getHSideCell(cell, true);\n\t\t\t\tif (utils.isEmptyObject(range)) {\n\t\t\t\t\tut.deleteCol(cellInfo.colIndex);\n\t\t\t\t} else {\n\t\t\t\t\tfor (var i = range.beginColIndex; i < range.endColIndex + 1; i++) {\n\t\t\t\t\t\tut.deleteCol(range.beginColIndex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar table = ut.table,\n\t\t\t\t\trng = this.selection.getRange();\n\n\t\t\t\tif (!table.getElementsByTagName('td').length) {\n\t\t\t\t\tvar nextSibling = table.nextSibling;\n\t\t\t\t\tdomUtils.remove(table);\n\t\t\t\t\tif (nextSibling) {\n\t\t\t\t\t\trng.setStart(nextSibling, 0).setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (domUtils.inDoc(cell, this.document)) {\n\t\t\t\t\t\trng.setStart(cell, 0).setCursor(false, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (nextCell && domUtils.inDoc(nextCell, this.document)) {\n\t\t\t\t\t\t\trng.selectNodeContents(nextCell).setCursor(false, true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (preCell && domUtils.inDoc(preCell, this.document)) {\n\t\t\t\t\t\t\t\trng.selectNodeContents(preCell).setCursor(true, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"splittocells\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\tif (!cell) return -1;\n\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\treturn cell && (cell.colSpan > 1 || cell.rowSpan > 1) ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.splitToCells(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"splittorows\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\tif (!cell) return -1;\n\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\treturn cell && cell.rowSpan > 1 ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.splitToRows(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"splittocols\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\tcell = tableItems.cell;\n\t\t\t\tif (!cell) return -1;\n\t\t\t\tvar ut = getUETable(tableItems.table);\n\t\t\t\tif (ut.selectedTds.length > 0) return -1;\n\t\t\t\treturn cell && cell.colSpan > 1 ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\tbk = rng.createBookmark(true);\n\t\t\t\tvar cell = getTableItemsByRange(this).cell,\n\t\t\t\t\tut = getUETable(cell);\n\t\t\t\tut.splitToCols(cell);\n\t\t\t\trng.moveToBookmark(bk).select();\n\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"adaptbytext\"] =\n\t\t\tUE.commands[\"adaptbywindow\"] = {\n\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t\t},\n\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\tvar tableItems = getTableItemsByRange(this),\n\t\t\t\t\t\ttable = tableItems.table;\n\t\t\t\t\tif (table) {\n\t\t\t\t\t\tif (cmd == 'adaptbywindow') {\n\t\t\t\t\t\t\tresetTdWidth(table, this);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar cells = domUtils.getElementsByTagName(table, \"td th\");\n\t\t\t\t\t\t\tutils.each(cells, function(cell) {\n\t\t\t\t\t\t\t\tcell.removeAttribute(\"width\");\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\ttable.removeAttribute(\"width\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t//平均分配各列\n\t\tUE.commands['averagedistributecol'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\tif (!ut) return -1;\n\t\t\t\treturn ut.isFullRow() || ut.isFullCol() ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tfunction getAverageWidth() {\n\t\t\t\t\tvar tb = ut.table,\n\t\t\t\t\t\taverageWidth, sumWidth = 0,\n\t\t\t\t\t\tcolsNum = 0,\n\t\t\t\t\t\ttbAttr = getDefaultValue(me, tb);\n\n\t\t\t\t\tif (ut.isFullRow()) {\n\t\t\t\t\t\tsumWidth = tb.offsetWidth;\n\t\t\t\t\t\tcolsNum = ut.colsNum;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar begin = ut.cellsRange.beginColIndex,\n\t\t\t\t\t\t\tend = ut.cellsRange.endColIndex,\n\t\t\t\t\t\t\tnode;\n\t\t\t\t\t\tfor (var i = begin; i <= end;) {\n\t\t\t\t\t\t\tnode = ut.selectedTds[i];\n\t\t\t\t\t\t\tsumWidth += node.offsetWidth;\n\t\t\t\t\t\t\ti += node.colSpan;\n\t\t\t\t\t\t\tcolsNum += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\taverageWidth = Math.ceil(sumWidth / colsNum) - tbAttr.tdBorder * 2 - tbAttr.tdPadding * 2;\n\t\t\t\t\treturn averageWidth;\n\t\t\t\t}\n\n\t\t\t\tfunction setAverageWidth(averageWidth) {\n\t\t\t\t\tutils.each(domUtils.getElementsByTagName(ut.table, \"th\"), function(node) {\n\t\t\t\t\t\tnode.setAttribute(\"width\", \"\");\n\t\t\t\t\t});\n\t\t\t\t\tvar cells = ut.isFullRow() ? domUtils.getElementsByTagName(ut.table, \"td\") : ut.selectedTds;\n\n\t\t\t\t\tutils.each(cells, function(node) {\n\t\t\t\t\t\tif (node.colSpan == 1) {\n\t\t\t\t\t\t\tnode.setAttribute(\"width\", averageWidth);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\tsetAverageWidth(getAverageWidth());\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t//平均分配各行\n\t\tUE.commands['averagedistributerow'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar ut = getUETableBySelected(this);\n\t\t\t\tif (!ut) return -1;\n\t\t\t\tif (ut.selectedTds && /th/ig.test(ut.selectedTds[0].tagName)) return -1;\n\t\t\t\treturn ut.isFullRow() || ut.isFullCol() ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tfunction getAverageHeight() {\n\t\t\t\t\tvar averageHeight, rowNum, sumHeight = 0,\n\t\t\t\t\t\ttb = ut.table,\n\t\t\t\t\t\ttbAttr = getDefaultValue(me, tb),\n\t\t\t\t\t\ttdpadding = parseInt(domUtils.getComputedStyle(tb.getElementsByTagName('td')[0], \"padding-top\"));\n\n\t\t\t\t\tif (ut.isFullCol()) {\n\t\t\t\t\t\tvar captionArr = domUtils.getElementsByTagName(tb, \"caption\"),\n\t\t\t\t\t\t\tthArr = domUtils.getElementsByTagName(tb, \"th\"),\n\t\t\t\t\t\t\tcaptionHeight, thHeight;\n\n\t\t\t\t\t\tif (captionArr.length > 0) {\n\t\t\t\t\t\t\tcaptionHeight = captionArr[0].offsetHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (thArr.length > 0) {\n\t\t\t\t\t\t\tthHeight = thArr[0].offsetHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tsumHeight = tb.offsetHeight - (captionHeight || 0) - (thHeight || 0);\n\t\t\t\t\t\trowNum = thArr.length == 0 ? ut.rowsNum : (ut.rowsNum - 1);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar begin = ut.cellsRange.beginRowIndex,\n\t\t\t\t\t\t\tend = ut.cellsRange.endRowIndex,\n\t\t\t\t\t\t\tcount = 0,\n\t\t\t\t\t\t\ttrs = domUtils.getElementsByTagName(tb, \"tr\");\n\t\t\t\t\t\tfor (var i = begin; i <= end; i++) {\n\t\t\t\t\t\t\tsumHeight += trs[i].offsetHeight;\n\t\t\t\t\t\t\tcount += 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trowNum = count;\n\t\t\t\t\t}\n\t\t\t\t\t//ie8下是混杂模式\n\t\t\t\t\tif (browser.ie && browser.version < 9) {\n\t\t\t\t\t\taverageHeight = Math.ceil(sumHeight / rowNum);\n\t\t\t\t\t} else {\n\t\t\t\t\t\taverageHeight = Math.ceil(sumHeight / rowNum) - tbAttr.tdBorder * 2 - tdpadding * 2;\n\t\t\t\t\t}\n\t\t\t\t\treturn averageHeight;\n\t\t\t\t}\n\n\t\t\t\tfunction setAverageHeight(averageHeight) {\n\t\t\t\t\tvar cells = ut.isFullCol() ? domUtils.getElementsByTagName(ut.table, \"td\") : ut.selectedTds;\n\t\t\t\t\tutils.each(cells, function(node) {\n\t\t\t\t\t\tif (node.rowSpan == 1) {\n\t\t\t\t\t\t\tnode.setAttribute(\"height\", averageHeight);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (ut && ut.selectedTds.length) {\n\t\t\t\t\tsetAverageHeight(getAverageHeight());\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//单元格对齐方式\n\t\tUE.commands['cellalignment'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, data) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tif (!ut) {\n\t\t\t\t\tvar start = me.selection.getStart(),\n\t\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\t\t\t\tif (!/caption/ig.test(cell.tagName)) {\n\t\t\t\t\t\tdomUtils.setAttributes(cell, data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcell.style.textAlign = data.align;\n\t\t\t\t\t\tcell.style.verticalAlign = data.vAlign;\n\t\t\t\t\t}\n\t\t\t\t\tme.selection.getRange().setCursor(true);\n\t\t\t\t} else {\n\t\t\t\t\tutils.each(ut.selectedTds, function(cell) {\n\t\t\t\t\t\tdomUtils.setAttributes(cell, data);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t/**\n\t\t\t * 查询当前点击的单元格的对齐状态， 如果当前已经选择了多个单元格， 则会返回所有单元格经过统一协调过后的状态\n\t\t\t * @see UE.UETable.getTableCellAlignState\n\t\t\t */\n\t\t\tqueryCommandValue: function(cmd) {\n\n\t\t\t\tvar activeMenuCell = getTableItemsByRange(this).cell;\n\n\t\t\t\tif (!activeMenuCell) {\n\t\t\t\t\tactiveMenuCell = getSelectedArr(this)[0];\n\t\t\t\t}\n\n\t\t\t\tif (!activeMenuCell) {\n\n\t\t\t\t\treturn null;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t//获取同时选中的其他单元格\n\t\t\t\t\tvar cells = UE.UETable.getUETable(activeMenuCell).selectedTds;\n\n\t\t\t\t\t!cells.length && (cells = activeMenuCell);\n\n\t\t\t\t\treturn UE.UETable.getTableCellAlignState(cells);\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t\t//表格对齐方式\n\t\tUE.commands['tablealignment'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tif (browser.ie && browser.version < 8) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, value) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tstart = me.selection.getStart(),\n\t\t\t\t\ttable = start && domUtils.findParentByTagName(start, [\"table\"], true);\n\n\t\t\t\tif (table) {\n\t\t\t\t\ttable.setAttribute(\"align\", value);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//表格属性\n\t\tUE.commands['edittable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, color) {\n\t\t\t\tvar rng = this.selection.getRange(),\n\t\t\t\t\ttable = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\tvar arr = domUtils.getElementsByTagName(table, \"td\").concat(\n\t\t\t\t\t\tdomUtils.getElementsByTagName(table, \"th\"),\n\t\t\t\t\t\tdomUtils.getElementsByTagName(table, \"caption\")\n\t\t\t\t\t);\n\t\t\t\t\tutils.each(arr, function(node) {\n\t\t\t\t\t\tnode.style.borderColor = color;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t//单元格属性\n\t\tUE.commands['edittd'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getTableItemsByRange(this).table ? 0 : -1\n\t\t\t},\n\t\t\texecCommand: function(cmd, bkColor) {\n\t\t\t\tvar me = this,\n\t\t\t\t\tut = getUETableBySelected(me);\n\n\t\t\t\tif (!ut) {\n\t\t\t\t\tvar start = me.selection.getStart(),\n\t\t\t\t\t\tcell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\t\t\t\t\tif (cell) {\n\t\t\t\t\t\tcell.style.backgroundColor = bkColor;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tutils.each(ut.selectedTds, function(cell) {\n\t\t\t\t\t\tcell.style.backgroundColor = bkColor;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"settablebackground\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn getSelectedArr(this).length > 1 ? 0 : -1;\n\t\t\t},\n\t\t\texecCommand: function(cmd, value) {\n\t\t\t\tvar cells, ut;\n\t\t\t\tcells = getSelectedArr(this);\n\t\t\t\tut = getUETable(cells[0]);\n\t\t\t\tut.setBackground(cells, value);\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"cleartablebackground\"] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar cells = getSelectedArr(this);\n\t\t\t\tif (!cells.length) return -1;\n\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\tif (cell.style.backgroundColor !== \"\") return 0;\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar cells = getSelectedArr(this),\n\t\t\t\t\tut = getUETable(cells[0]);\n\t\t\t\tut.removeBackground(cells);\n\t\t\t}\n\t\t};\n\n\t\tUE.commands[\"interlacetable\"] = UE.commands[\"uninterlacetable\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (!table) return -1;\n\t\t\t\tvar interlaced = table.getAttribute(\"interlaced\");\n\t\t\t\tif (cmd == \"interlacetable\") {\n\t\t\t\t\t//TODO 待定\n\t\t\t\t\t//是否需要待定，如果设置，则命令只能单次执行成功，但反射具备toggle效果；否则可以覆盖前次命令，但反射将不存在toggle效果\n\t\t\t\t\treturn (interlaced === \"enabled\") ? -1 : 0;\n\t\t\t\t} else {\n\t\t\t\t\treturn (!interlaced || interlaced === \"disabled\") ? -1 : 0;\n\t\t\t\t}\n\t\t\t},\n\t\t\texecCommand: function(cmd, classList) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (cmd == \"interlacetable\") {\n\t\t\t\t\ttable.setAttribute(\"interlaced\", \"enabled\");\n\t\t\t\t\tthis.fireEvent(\"interlacetable\", table, classList);\n\t\t\t\t} else {\n\t\t\t\t\ttable.setAttribute(\"interlaced\", \"disabled\");\n\t\t\t\t\tthis.fireEvent(\"uninterlacetable\", table);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tUE.commands[\"setbordervisible\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (!table) return -1;\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\texecCommand: function() {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tutils.each(domUtils.getElementsByTagName(table, 'td'), function(td) {\n\t\t\t\t\ttd.style.borderWidth = '1px';\n\t\t\t\t\ttd.style.borderStyle = 'solid';\n\t\t\t\t})\n\t\t\t}\n\t\t};\n\n\t\tfunction resetTdWidth(table, editor) {\n\t\t\tvar tds = domUtils.getElementsByTagName(table, 'td th');\n\t\t\tutils.each(tds, function(td) {\n\t\t\t\ttd.removeAttribute(\"width\");\n\t\t\t});\n\t\t\ttable.setAttribute('width', getTableWidth(editor, true, getDefaultValue(editor, table)));\n\t\t\tvar tdsWidths = [];\n\t\t\tsetTimeout(function() {\n\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t(td.colSpan == 1) && tdsWidths.push(td.offsetWidth)\n\t\t\t\t})\n\t\t\t\tutils.each(tds, function(td, i) {\n\t\t\t\t\t(td.colSpan == 1) && td.setAttribute(\"width\", tdsWidths[i] + \"\");\n\t\t\t\t})\n\t\t\t}, 0);\n\t\t}\n\n\t\tfunction getTableWidth(editor, needIEHack, defaultValue) {\n\t\t\tvar body = editor.body;\n\t\t\treturn body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (editor.options.offsetWidth || 0);\n\t\t}\n\n\t\tfunction getSelectedArr(editor) {\n\t\t\tvar cell = getTableItemsByRange(editor).cell;\n\t\t\tif (cell) {\n\t\t\t\tvar ut = getUETable(cell);\n\t\t\t\treturn ut.selectedTds.length ? ut.selectedTds : [cell];\n\t\t\t} else {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t}\n\t})();\n\n\t// plugins/table.action.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: taoqili\n\t * Date: 12-10-12\n\t * Time: 上午10:05\n\t * To change this template use File | Settings | File Templates.\n\t */\n\tUE.plugins['table'] = function() {\n\t\tvar me = this,\n\t\t\ttabTimer = null,\n\t\t\t//拖动计时器\n\t\t\ttableDragTimer = null,\n\t\t\t//双击计时器\n\t\t\ttableResizeTimer = null,\n\t\t\t//单元格最小宽度\n\t\t\tcellMinWidth = 5,\n\t\t\tisInResizeBuffer = false,\n\t\t\t//单元格边框大小\n\t\t\tcellBorderWidth = 5,\n\t\t\t//鼠标偏移距离\n\t\t\toffsetOfTableCell = 10,\n\t\t\t//记录在有限时间内的点击状态， 共有3个取值， 0, 1, 2。 0代表未初始化， 1代表单击了1次，2代表2次\n\t\t\tsingleClickState = 0,\n\t\t\tuserActionStatus = null,\n\t\t\t//双击允许的时间范围\n\t\t\tdblclickTime = 360,\n\t\t\tUT = UE.UETable,\n\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t},\n\t\t\tgetUETableBySelected = function(editor) {\n\t\t\t\treturn UT.getUETableBySelected(editor);\n\t\t\t},\n\t\t\tgetDefaultValue = function(editor, table) {\n\t\t\t\treturn UT.getDefaultValue(editor, table);\n\t\t\t},\n\t\t\tremoveSelectedClass = function(cells) {\n\t\t\t\treturn UT.removeSelectedClass(cells);\n\t\t\t};\n\n\t\tfunction showError(e) {\n\t\t\t//        throw e;\n\t\t}\n\t\tme.ready(function() {\n\t\t\tvar me = this;\n\t\t\tvar orgGetText = me.selection.getText;\n\t\t\tme.selection.getText = function() {\n\t\t\t\tvar table = getUETableBySelected(me);\n\t\t\t\tif (table) {\n\t\t\t\t\tvar str = '';\n\t\t\t\t\tutils.each(table.selectedTds, function(td) {\n\t\t\t\t\t\tstr += td[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\t\t})\n\t\t\t\t\treturn str;\n\t\t\t\t} else {\n\t\t\t\t\treturn orgGetText.call(me.selection)\n\t\t\t\t}\n\n\t\t\t}\n\t\t})\n\n\t\t//处理拖动及框选相关方法\n\t\tvar startTd = null, //鼠标按下时的锚点td\n\t\t\tcurrentTd = null, //当前鼠标经过时的td\n\t\t\tonDrag = \"\", //指示当前拖动状态，其值可为\"\",\"h\",\"v\" ,分别表示未拖动状态，横向拖动状态，纵向拖动状态，用于鼠标移动过程中的判断\n\t\t\tonBorder = false, //检测鼠标按下时是否处在单元格边缘位置\n\t\t\tdragButton = null,\n\t\t\tdragOver = false,\n\t\t\tdragLine = null, //模拟的拖动线\n\t\t\tdragTd = null; //发生拖动的目标td\n\n\t\tvar mousedown = false,\n\t\t\t//todo 判断混乱模式\n\t\t\tneedIEHack = true;\n\n\t\tme.setOpt({\n\t\t\t'maxColNum': 20,\n\t\t\t'maxRowNum': 100,\n\t\t\t'defaultCols': 5,\n\t\t\t'defaultRows': 5,\n\t\t\t'tdvalign': 'top',\n\t\t\t'cursorpath': me.options.UEDITOR_HOME_URL + \"themes/default/images/cursor_\",\n\t\t\t'tableDragable': false,\n\t\t\t'classList': [\"ue-table-interlace-color-single\", \"ue-table-interlace-color-double\"]\n\t\t});\n\t\tme.getUETable = getUETable;\n\t\tvar commands = {\n\t\t\t'deletetable': 1,\n\t\t\t'inserttable': 1,\n\t\t\t'cellvalign': 1,\n\t\t\t'insertcaption': 1,\n\t\t\t'deletecaption': 1,\n\t\t\t'inserttitle': 1,\n\t\t\t'deletetitle': 1,\n\t\t\t\"mergeright\": 1,\n\t\t\t\"mergedown\": 1,\n\t\t\t\"mergecells\": 1,\n\t\t\t\"insertrow\": 1,\n\t\t\t\"insertrownext\": 1,\n\t\t\t\"deleterow\": 1,\n\t\t\t\"insertcol\": 1,\n\t\t\t\"insertcolnext\": 1,\n\t\t\t\"deletecol\": 1,\n\t\t\t\"splittocells\": 1,\n\t\t\t\"splittorows\": 1,\n\t\t\t\"splittocols\": 1,\n\t\t\t\"adaptbytext\": 1,\n\t\t\t\"adaptbywindow\": 1,\n\t\t\t\"adaptbycustomer\": 1,\n\t\t\t\"insertparagraph\": 1,\n\t\t\t\"insertparagraphbeforetable\": 1,\n\t\t\t\"averagedistributecol\": 1,\n\t\t\t\"averagedistributerow\": 1\n\t\t};\n\t\tme.ready(function() {\n\t\t\tutils.cssRule('table',\n\t\t\t\t//选中的td上的样式\n\t\t\t\t'.selectTdClass{background-color:#edf5fa !important}' +\n\t\t\t\t'table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}' +\n\t\t\t\t//插入的表格的默认样式\n\t\t\t\t'table{margin-bottom:10px;border-collapse:collapse;display:table;}' +\n\t\t\t\t'td,th{padding: 5px 10px;border: 1px solid #DDD;}' +\n\t\t\t\t'caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}' +\n\t\t\t\t'th{border-top:1px solid #BBB;background-color:#F7F7F7;}' +\n\t\t\t\t'table tr.firstRow th{border-top-width:2px;}' +\n\t\t\t\t'.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }' +\n\t\t\t\t'td p{margin:0;padding:0;}', me.document);\n\n\t\t\tvar tableCopyList, isFullCol, isFullRow;\n\t\t\t//注册del/backspace事件\n\t\t\tme.addListener('keydown', function(cmd, evt) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\n\t\t\t\tif (keyCode == 8) {\n\n\t\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\t\tif (ut && ut.selectedTds.length) {\n\n\t\t\t\t\t\tif (ut.isFullCol()) {\n\t\t\t\t\t\t\tme.execCommand('deletecol')\n\t\t\t\t\t\t} else if (ut.isFullRow()) {\n\t\t\t\t\t\t\tme.execCommand('deleterow')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.fireEvent('delcells');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar caption = domUtils.findParentByTagName(me.selection.getStart(), 'caption', true),\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (range.collapsed && caption && isEmptyBlock(caption)) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tvar table = caption.parentNode;\n\t\t\t\t\t\tdomUtils.remove(caption);\n\t\t\t\t\t\tif (table) {\n\t\t\t\t\t\t\trange.setStart(table.rows[0].cells[0], 0).setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tif (keyCode == 46) {\n\n\t\t\t\t\tut = getUETableBySelected(me);\n\t\t\t\t\tif (ut) {\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tfor (var i = 0, ci; ci = ut.selectedTds[i++];) {\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, ci)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tif (keyCode == 13) {\n\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tcaption = domUtils.findParentByTagName(rng.startContainer, 'caption', true);\n\t\t\t\t\tif (caption) {\n\t\t\t\t\t\tvar table = domUtils.findParentByTagName(caption, 'table');\n\t\t\t\t\t\tif (!rng.collapsed) {\n\n\t\t\t\t\t\t\trng.deleteContents();\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (caption) {\n\t\t\t\t\t\t\t\trng.setStart(table.rows[0].cells[0], 0).setCursor(false, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (rng.collapsed) {\n\t\t\t\t\t\tvar table = domUtils.findParentByTagName(rng.startContainer, 'table');\n\t\t\t\t\t\tif (table) {\n\t\t\t\t\t\t\tvar cell = table.rows[0].cells[0],\n\t\t\t\t\t\t\t\tstart = domUtils.findParentByTagName(me.selection.getStart(), ['td', 'th'], true),\n\t\t\t\t\t\t\t\tpreNode = table.previousSibling;\n\t\t\t\t\t\t\tif (cell === start && (!preNode || preNode.nodeType == 1 && preNode.tagName == 'TABLE') && domUtils.isStartInblock(rng)) {\n\t\t\t\t\t\t\t\tvar first = domUtils.findParent(me.selection.getStart(), function(n) {\n\t\t\t\t\t\t\t\t\treturn domUtils.isBlockElm(n)\n\t\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\t\tif (first && (/t(h|d)/i.test(first.tagName) || first === start.firstChild)) {\n\t\t\t\t\t\t\t\t\tme.execCommand('insertparagraphbeforetable');\n\t\t\t\t\t\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ((evt.ctrlKey || evt.metaKey) && evt.keyCode == '67') {\n\t\t\t\t\ttableCopyList = null;\n\t\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\t\tif (ut) {\n\t\t\t\t\t\tvar tds = ut.selectedTds;\n\t\t\t\t\t\tisFullCol = ut.isFullCol();\n\t\t\t\t\t\tisFullRow = ut.isFullRow();\n\t\t\t\t\t\ttableCopyList = [\n\t\t\t\t\t\t\t[ut.cloneCell(tds[0], null, true)]\n\t\t\t\t\t\t];\n\t\t\t\t\t\tfor (var i = 1, ci; ci = tds[i]; i++) {\n\t\t\t\t\t\t\tif (ci.parentNode !== tds[i - 1].parentNode) {\n\t\t\t\t\t\t\t\ttableCopyList.push([ut.cloneCell(ci, null, true)]);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttableCopyList[tableCopyList.length - 1].push(ut.cloneCell(ci, null, true));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tme.addListener(\"tablehasdeleted\", function() {\n\t\t\t\ttoggleDraggableState(this, false, \"\", null);\n\t\t\t\tif (dragButton) domUtils.remove(dragButton);\n\t\t\t});\n\n\t\t\tme.addListener('beforepaste', function(cmd, html) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tif (domUtils.findParentByTagName(rng.startContainer, 'caption', true)) {\n\t\t\t\t\tvar div = me.document.createElement(\"div\");\n\t\t\t\t\tdiv.innerHTML = html.html;\n\t\t\t\t\t//trace:3729\n\t\t\t\t\thtml.html = div[browser.ie9below ? 'innerText' : 'textContent'];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar table = getUETableBySelected(me);\n\t\t\t\tif (tableCopyList) {\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\tvar td = domUtils.findParentByTagName(rng.startContainer, ['td', 'th'], true),\n\t\t\t\t\t\ttmpNode, preNode;\n\t\t\t\t\tif (td) {\n\t\t\t\t\t\tvar ut = getUETable(td);\n\t\t\t\t\t\tif (isFullRow) {\n\t\t\t\t\t\t\tvar rowIndex = ut.getCellInfo(td).rowIndex;\n\t\t\t\t\t\t\tif (td.tagName == 'TH') {\n\t\t\t\t\t\t\t\trowIndex++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\t\tvar tr = ut.insertRow(rowIndex++, \"td\");\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j]; j++) {\n\t\t\t\t\t\t\t\t\tvar cell = tr.cells[j];\n\t\t\t\t\t\t\t\t\tif (!cell) {\n\t\t\t\t\t\t\t\t\t\tcell = tr.insertCell(j)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcell.innerHTML = cj.innerHTML;\n\t\t\t\t\t\t\t\t\tcj.getAttribute('width') && cell.setAttribute('width', cj.getAttribute('width'));\n\t\t\t\t\t\t\t\t\tcj.getAttribute('vAlign') && cell.setAttribute('vAlign', cj.getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\tcj.getAttribute('align') && cell.setAttribute('align', cj.getAttribute('align'));\n\t\t\t\t\t\t\t\t\tcj.style.cssText && (cell.style.cssText = cj.style.cssText)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = tr.cells[j]; j++) {\n\t\t\t\t\t\t\t\t\tif (!ci[j])\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\tcj.innerHTML = ci[j].innerHTML;\n\t\t\t\t\t\t\t\t\tci[j].getAttribute('width') && cj.setAttribute('width', ci[j].getAttribute('width'));\n\t\t\t\t\t\t\t\t\tci[j].getAttribute('vAlign') && cj.setAttribute('vAlign', ci[j].getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\tci[j].getAttribute('align') && cj.setAttribute('align', ci[j].getAttribute('align'));\n\t\t\t\t\t\t\t\t\tci[j].style.cssText && (cj.style.cssText = ci[j].style.cssText)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (isFullCol) {\n\t\t\t\t\t\t\t\tcellInfo = ut.getCellInfo(td);\n\t\t\t\t\t\t\t\tvar maxColNum = 0;\n\t\t\t\t\t\t\t\tfor (var j = 0, ci = tableCopyList[0], cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\t\tmaxColNum += cj.colSpan || 1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t\t\tfor (i = 0; i < maxColNum; i++) {\n\t\t\t\t\t\t\t\t\tme.execCommand('insertcol');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t\t\ttd = ut.table.rows[0].cells[cellInfo.cellIndex];\n\t\t\t\t\t\t\t\tif (td.tagName == 'TH') {\n\t\t\t\t\t\t\t\t\ttd = ut.table.rows[1].cells[cellInfo.cellIndex];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\t\ttmpNode = td;\n\t\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\t\tif (td) {\n\t\t\t\t\t\t\t\t\t\ttd.innerHTML = cj.innerHTML;\n\t\t\t\t\t\t\t\t\t\t//todo 定制处理\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('width') && td.setAttribute('width', cj.getAttribute('width'));\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('vAlign') && td.setAttribute('vAlign', cj.getAttribute('vAlign'));\n\t\t\t\t\t\t\t\t\t\tcj.getAttribute('align') && td.setAttribute('align', cj.getAttribute('align'));\n\t\t\t\t\t\t\t\t\t\tcj.style.cssText && (td.style.cssText = cj.style.cssText);\n\t\t\t\t\t\t\t\t\t\tpreNode = td;\n\t\t\t\t\t\t\t\t\t\ttd = td.nextSibling;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tvar cloneTd = cj.cloneNode(true);\n\t\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(cloneTd, ['class', 'rowSpan', 'colSpan']);\n\n\t\t\t\t\t\t\t\t\t\tpreNode.parentNode.appendChild(cloneTd)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttd = ut.getNextCell(tmpNode, true, true);\n\t\t\t\t\t\t\t\tif (!tableCopyList[i])\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tif (!td) {\n\t\t\t\t\t\t\t\t\tvar cellInfo = ut.getCellInfo(tmpNode);\n\t\t\t\t\t\t\t\t\tut.table.insertRow(ut.table.rows.length);\n\t\t\t\t\t\t\t\t\tut.update();\n\t\t\t\t\t\t\t\t\ttd = ut.getVSideCell(tmpNode, true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tut.update();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttable = me.document.createElement('table');\n\t\t\t\t\t\tfor (var i = 0, ci; ci = tableCopyList[i++];) {\n\t\t\t\t\t\t\tvar tr = table.insertRow(table.rows.length);\n\t\t\t\t\t\t\tfor (var j = 0, cj; cj = ci[j++];) {\n\t\t\t\t\t\t\t\tcloneTd = UT.cloneCell(cj, null, true);\n\t\t\t\t\t\t\t\tdomUtils.removeAttributes(cloneTd, ['class']);\n\t\t\t\t\t\t\t\ttr.appendChild(cloneTd)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (j == 2 && cloneTd.rowSpan > 1) {\n\t\t\t\t\t\t\t\tcloneTd.rowSpan = 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar defaultValue = getDefaultValue(me),\n\t\t\t\t\t\t\twidth = me.body.offsetWidth -\n\t\t\t\t\t\t\t(needIEHack ? parseInt(domUtils.getComputedStyle(me.body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (me.options.offsetWidth || 0);\n\t\t\t\t\t\tme.execCommand('insertHTML', '<table  ' +\n\t\t\t\t\t\t\t(isFullCol && isFullRow ? 'width=\"' + width + '\"' : '') +\n\t\t\t\t\t\t\t'>' + table.innerHTML.replace(/>\\s*</g, '><').replace(/\\bth\\b/gi, \"td\") + '</table>')\n\t\t\t\t\t}\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\thtml.html = '';\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\tvar div = me.document.createElement(\"div\"),\n\t\t\t\t\t\ttables;\n\t\t\t\t\tdiv.innerHTML = html.html;\n\t\t\t\t\ttables = div.getElementsByTagName(\"table\");\n\t\t\t\t\tif (domUtils.findParentByTagName(me.selection.getStart(), 'table')) {\n\t\t\t\t\t\tutils.each(tables, function(t) {\n\t\t\t\t\t\t\tdomUtils.remove(t)\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (domUtils.findParentByTagName(me.selection.getStart(), 'caption', true)) {\n\t\t\t\t\t\t\tdiv.innerHTML = div[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tutils.each(tables, function(table) {\n\t\t\t\t\t\t\tremoveStyleSize(table, true);\n\t\t\t\t\t\t\tdomUtils.removeAttributes(table, ['style', 'border']);\n\t\t\t\t\t\t\tutils.each(domUtils.getElementsByTagName(table, \"td\"), function(td) {\n\t\t\t\t\t\t\t\tif (isEmptyBlock(td)) {\n\t\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, td);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tremoveStyleSize(td, true);\n\t\t\t\t\t\t\t\t//                            domUtils.removeAttributes(td, ['style'])\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\thtml.html = div.innerHTML;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.addListener('afterpaste', function() {\n\t\t\t\tutils.each(domUtils.getElementsByTagName(me.body, \"table\"), function(table) {\n\t\t\t\t\tif (table.offsetWidth > me.body.offsetWidth) {\n\t\t\t\t\t\tvar defaultValue = getDefaultValue(me, table);\n\t\t\t\t\t\ttable.style.width = me.body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(me.body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (me.options.offsetWidth || 0) + 'px'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t});\n\t\t\tme.addListener('blur', function() {\n\t\t\t\ttableCopyList = null;\n\t\t\t});\n\t\t\tvar timer;\n\t\t\tme.addListener('keydown', function() {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tcell = domUtils.findParentByTagName(rng.startContainer, ['th', 'td'], true);\n\t\t\t\t\tif (cell) {\n\t\t\t\t\t\tvar table = cell.parentNode.parentNode.parentNode;\n\t\t\t\t\t\tif (table.offsetWidth > table.getAttribute(\"width\")) {\n\t\t\t\t\t\t\tcell.style.wordBreak = \"break-all\";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}, 100);\n\t\t\t});\n\t\t\tme.addListener(\"selectionchange\", function() {\n\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t});\n\n\t\t\t//内容变化时触发索引更新\n\t\t\t//todo 可否考虑标记检测，如果不涉及表格的变化就不进行索引重建和更新\n\t\t\tme.addListener(\"contentchange\", function() {\n\t\t\t\tvar me = this;\n\t\t\t\t//尽可能排除一些不需要更新的状况\n\t\t\t\thideDragLine(me);\n\t\t\t\tif (getUETableBySelected(me)) return;\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tvar start = rng.startContainer;\n\t\t\t\tstart = domUtils.findParentByTagName(start, ['td', 'th'], true);\n\t\t\t\tutils.each(domUtils.getElementsByTagName(me.document, 'table'), function(table) {\n\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\ttable.ueTable = new UT(table);\n\t\t\t\t\t//trace:3742\n\t\t\t\t\t//                utils.each(domUtils.getElementsByTagName(me.document, 'td'), function (td) {\n\t\t\t\t\t//\n\t\t\t\t\t//                    if (domUtils.isEmptyBlock(td) && td !== start) {\n\t\t\t\t\t//                        domUtils.fillNode(me.document, td);\n\t\t\t\t\t//                        if (browser.ie && browser.version == 6) {\n\t\t\t\t\t//                            td.innerHTML = '&nbsp;'\n\t\t\t\t\t//                        }\n\t\t\t\t\t//                    }\n\t\t\t\t\t//                });\n\t\t\t\t\t//                utils.each(domUtils.getElementsByTagName(me.document, 'th'), function (th) {\n\t\t\t\t\t//                    if (domUtils.isEmptyBlock(th) && th !== start) {\n\t\t\t\t\t//                        domUtils.fillNode(me.document, th);\n\t\t\t\t\t//                        if (browser.ie && browser.version == 6) {\n\t\t\t\t\t//                            th.innerHTML = '&nbsp;'\n\t\t\t\t\t//                        }\n\t\t\t\t\t//                    }\n\t\t\t\t\t//                });\n\t\t\t\t\ttable.onmouseover = function() {\n\t\t\t\t\t\tme.fireEvent('tablemouseover', table);\n\t\t\t\t\t};\n\t\t\t\t\ttable.onmousemove = function() {\n\t\t\t\t\t\tme.fireEvent('tablemousemove', table);\n\t\t\t\t\t\tme.options.tableDragable && toggleDragButton(true, this, me);\n\t\t\t\t\t\tutils.defer(function() {\n\t\t\t\t\t\t\tme.fireEvent('contentchange', 50)\n\t\t\t\t\t\t}, true)\n\t\t\t\t\t};\n\t\t\t\t\ttable.onmouseout = function() {\n\t\t\t\t\t\tme.fireEvent('tablemouseout', table);\n\t\t\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t\t\t\thideDragLine(me);\n\t\t\t\t\t};\n\t\t\t\t\ttable.onclick = function(evt) {\n\t\t\t\t\t\tevt = me.window.event || evt;\n\t\t\t\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement);\n\t\t\t\t\t\tif (!target) return;\n\t\t\t\t\t\tvar ut = getUETable(target),\n\t\t\t\t\t\t\ttable = ut.table,\n\t\t\t\t\t\t\tcellInfo = ut.getCellInfo(target),\n\t\t\t\t\t\t\tcellsRange,\n\t\t\t\t\t\t\trng = me.selection.getRange();\n\t\t\t\t\t\t//                    if (\"topLeft\" == inPosition(table, mouseCoords(evt))) {\n\t\t\t\t\t\t//                        cellsRange = ut.getCellsRange(ut.table.rows[0].cells[0], ut.getLastCell());\n\t\t\t\t\t\t//                        ut.setSelected(cellsRange);\n\t\t\t\t\t\t//                        return;\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\t//                    if (\"bottomRight\" == inPosition(table, mouseCoords(evt))) {\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//                        return;\n\t\t\t\t\t\t//                    }\n\t\t\t\t\t\tif (inTableSide(table, target, evt, true)) {\n\t\t\t\t\t\t\tvar endTdCol = ut.getCell(ut.indexTable[ut.rowsNum - 1][cellInfo.colIndex].rowIndex, ut.indexTable[ut.rowsNum - 1][cellInfo.colIndex].cellIndex);\n\t\t\t\t\t\t\tif (evt.shiftKey && ut.selectedTds.length) {\n\t\t\t\t\t\t\t\tif (ut.selectedTds[0] !== endTdCol) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(ut.selectedTds[0], endTdCol);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdCol).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (target !== endTdCol) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(target, endTdCol);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdCol).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (inTableSide(table, target, evt)) {\n\t\t\t\t\t\t\tvar endTdRow = ut.getCell(ut.indexTable[cellInfo.rowIndex][ut.colsNum - 1].rowIndex, ut.indexTable[cellInfo.rowIndex][ut.colsNum - 1].cellIndex);\n\t\t\t\t\t\t\tif (evt.shiftKey && ut.selectedTds.length) {\n\t\t\t\t\t\t\t\tif (ut.selectedTds[0] !== endTdRow) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(ut.selectedTds[0], endTdRow);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdRow).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif (target !== endTdRow) {\n\t\t\t\t\t\t\t\t\tcellsRange = ut.getCellsRange(target, endTdRow);\n\t\t\t\t\t\t\t\t\tut.setSelected(cellsRange);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\trng && rng.selectNodeContents(endTdRow).select();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\tswitchBorderColor(me, true);\n\t\t\t});\n\n\t\t\tdomUtils.on(me.document, \"mousemove\", mouseMoveEvent);\n\n\t\t\tdomUtils.on(me.document, \"mouseout\", function(evt) {\n\t\t\t\tvar target = evt.target || evt.srcElement;\n\t\t\t\tif (target.tagName == \"TABLE\") {\n\t\t\t\t\ttoggleDraggableState(me, false, \"\", null);\n\t\t\t\t}\n\t\t\t});\n\t\t\t/**\n\t\t\t * 表格隔行变色\n\t\t\t */\n\t\t\tme.addListener(\"interlacetable\", function(type, table, classList) {\n\t\t\t\tif (!table) return;\n\t\t\t\tvar me = this,\n\t\t\t\t\trows = table.rows,\n\t\t\t\t\tlen = rows.length,\n\t\t\t\t\tgetClass = function(list, index, repeat) {\n\t\t\t\t\t\treturn list[index] ? list[index] : repeat ? list[index % list.length] : \"\";\n\t\t\t\t\t};\n\t\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t\trows[i].className = getClass(classList || me.options.classList, i, true);\n\t\t\t\t}\n\t\t\t});\n\t\t\tme.addListener(\"uninterlacetable\", function(type, table) {\n\t\t\t\tif (!table) return;\n\t\t\t\tvar me = this,\n\t\t\t\t\trows = table.rows,\n\t\t\t\t\tclassList = me.options.classList,\n\t\t\t\t\tlen = rows.length;\n\t\t\t\tfor (var i = 0; i < len; i++) {\n\t\t\t\t\tdomUtils.removeClasses(rows[i], classList);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tme.addListener(\"mousedown\", mouseDownEvent);\n\t\t\tme.addListener(\"mouseup\", mouseUpEvent);\n\t\t\t//拖动的时候触发mouseup\n\t\t\tdomUtils.on(me.body, 'dragstart', function(evt) {\n\t\t\t\tmouseUpEvent.call(me, 'dragstart', evt);\n\t\t\t});\n\t\t\tme.addOutputRule(function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('div'), function(n) {\n\t\t\t\t\tif (n.getAttr('id') == 'ue_tableDragLine') {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tvar currentRowIndex = 0;\n\t\t\tme.addListener(\"mousedown\", function() {\n\t\t\t\tcurrentRowIndex = 0;\n\t\t\t});\n\t\t\tme.addListener('tabkeydown', function() {\n\t\t\t\tvar range = this.selection.getRange(),\n\t\t\t\t\tcommon = range.getCommonAncestor(true, true),\n\t\t\t\t\ttable = domUtils.findParentByTagName(common, 'table');\n\t\t\t\tif (table) {\n\t\t\t\t\tif (domUtils.findParentByTagName(common, 'caption', true)) {\n\t\t\t\t\t\tvar cell = domUtils.getElementsByTagName(table, 'th td');\n\t\t\t\t\t\tif (cell && cell.length) {\n\t\t\t\t\t\t\trange.setStart(cell[0], 0).setCursor(false, true)\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar cell = domUtils.findParentByTagName(common, ['td', 'th'], true),\n\t\t\t\t\t\t\tua = getUETable(cell);\n\t\t\t\t\t\tcurrentRowIndex = cell.rowSpan > 1 ? currentRowIndex : ua.getCellInfo(cell).rowIndex;\n\t\t\t\t\t\tvar nextCell = ua.getTabNextCell(cell, currentRowIndex);\n\t\t\t\t\t\tif (nextCell) {\n\t\t\t\t\t\t\tif (isEmptyBlock(nextCell)) {\n\t\t\t\t\t\t\t\trange.setStart(nextCell, 0).setCursor(false, true)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\trange.selectNodeContents(nextCell).select()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t\t\tthis.execCommand('insertrownext');\n\t\t\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\t\t\t\trange.setStart(table.rows[table.rows.length - 1].cells[0], 0).setCursor();\n\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t});\n\t\t\tbrowser.ie && me.addListener('selectionchange', function() {\n\t\t\t\ttoggleDraggableState(this, false, \"\", null);\n\t\t\t});\n\t\t\tme.addListener(\"keydown\", function(type, evt) {\n\t\t\t\tvar me = this;\n\t\t\t\t//处理在表格的最后一个输入tab产生新的表格\n\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\tif (keyCode == 8 || keyCode == 46) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar notCtrlKey = !evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey;\n\t\t\t\tnotCtrlKey && removeSelectedClass(domUtils.getElementsByTagName(me.body, \"td\"));\n\t\t\t\tvar ut = getUETableBySelected(me);\n\t\t\t\tif (!ut) return;\n\t\t\t\tnotCtrlKey && ut.clearSelected();\n\t\t\t});\n\n\t\t\tme.addListener(\"beforegetcontent\", function() {\n\t\t\t\tswitchBorderColor(this, false);\n\t\t\t\tbrowser.ie && utils.each(this.document.getElementsByTagName('caption'), function(ci) {\n\t\t\t\t\tif (domUtils.isEmptyNode(ci)) {\n\t\t\t\t\t\tci.innerHTML = '&nbsp;'\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tme.addListener(\"aftergetcontent\", function() {\n\t\t\t\tswitchBorderColor(this, true);\n\t\t\t});\n\t\t\tme.addListener(\"getAllHtml\", function() {\n\t\t\t\tremoveSelectedClass(me.document.getElementsByTagName(\"td\"));\n\t\t\t});\n\t\t\t//修正全屏状态下插入的表格宽度在非全屏状态下撑开编辑器的情况\n\t\t\tme.addListener(\"fullscreenchanged\", function(type, fullscreen) {\n\t\t\t\tif (!fullscreen) {\n\t\t\t\t\tvar ratio = this.body.offsetWidth / document.body.offsetWidth,\n\t\t\t\t\t\ttables = domUtils.getElementsByTagName(this.body, \"table\");\n\t\t\t\t\tutils.each(tables, function(table) {\n\t\t\t\t\t\tif (table.offsetWidth < me.body.offsetWidth) return false;\n\t\t\t\t\t\tvar tds = domUtils.getElementsByTagName(table, \"td\"),\n\t\t\t\t\t\t\tbackWidths = [];\n\t\t\t\t\t\tutils.each(tds, function(td) {\n\t\t\t\t\t\t\tbackWidths.push(td.offsetWidth);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfor (var i = 0, td; td = tds[i]; i++) {\n\t\t\t\t\t\t\ttd.setAttribute(\"width\", Math.floor(backWidths[i] * ratio));\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttable.setAttribute(\"width\", Math.floor(getTableWidth(me, needIEHack, getDefaultValue(me))))\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//重写execCommand命令，用于处理框选时的处理\n\t\t\tvar oldExecCommand = me.execCommand;\n\t\t\tme.execCommand = function(cmd, datatat) {\n\n\t\t\t\tvar me = this,\n\t\t\t\t\targs = arguments;\n\n\t\t\t\tcmd = cmd.toLowerCase();\n\t\t\t\tvar ut = getUETableBySelected(me),\n\t\t\t\t\ttds,\n\t\t\t\t\trange = new dom.Range(me.document),\n\t\t\t\t\tcmdFun = me.commands[cmd] || UE.commands[cmd],\n\t\t\t\t\tresult;\n\t\t\t\tif (!cmdFun) return;\n\t\t\t\tif (ut && !commands[cmd] && !cmdFun.notNeedUndo && !me.__hasEnterExecCommand) {\n\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\tme.fireEvent(\"beforeexeccommand\", cmd);\n\t\t\t\t\ttds = ut.selectedTds;\n\t\t\t\t\tvar lastState = -2,\n\t\t\t\t\t\tlastValue = -2,\n\t\t\t\t\t\tvalue, state;\n\t\t\t\t\tfor (var i = 0, td; td = tds[i]; i++) {\n\t\t\t\t\t\tif (isEmptyBlock(td)) {\n\t\t\t\t\t\t\trange.setStart(td, 0).setCursor(false, true)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.selectNode(td).select(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstate = me.queryCommandState(cmd);\n\t\t\t\t\t\tvalue = me.queryCommandValue(cmd);\n\t\t\t\t\t\tif (state != -1) {\n\t\t\t\t\t\t\tif (lastState !== state || lastValue !== value) {\n\t\t\t\t\t\t\t\tme._ignoreContentChange = true;\n\t\t\t\t\t\t\t\tresult = oldExecCommand.apply(me, arguments);\n\t\t\t\t\t\t\t\tme._ignoreContentChange = false;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tlastState = me.queryCommandState(cmd);\n\t\t\t\t\t\t\tlastValue = me.queryCommandValue(cmd);\n\t\t\t\t\t\t\tif (domUtils.isEmptyBlock(td)) {\n\t\t\t\t\t\t\t\tdomUtils.fillNode(me.document, td)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trange.setStart(tds[0], 0).shrinkBoundary(true).setCursor(false, true);\n\t\t\t\t\tme.fireEvent('contentchange');\n\t\t\t\t\tme.fireEvent(\"afterexeccommand\", cmd);\n\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\tme._selectionChange();\n\t\t\t\t} else {\n\t\t\t\t\tresult = oldExecCommand.apply(me, arguments);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t};\n\n\t\t});\n\t\t/**\n\t\t * 删除obj的宽高style，改成属性宽高\n\t\t * @param obj\n\t\t * @param replaceToProperty\n\t\t */\n\t\tfunction removeStyleSize(obj, replaceToProperty) {\n\t\t\tremoveStyle(obj, \"width\", true);\n\t\t\tremoveStyle(obj, \"height\", true);\n\t\t}\n\n\t\tfunction removeStyle(obj, styleName, replaceToProperty) {\n\t\t\tif (obj.style[styleName]) {\n\t\t\t\treplaceToProperty && obj.setAttribute(styleName, parseInt(obj.style[styleName], 10));\n\t\t\t\tobj.style[styleName] = \"\";\n\t\t\t}\n\t\t}\n\n\t\tfunction getParentTdOrTh(ele) {\n\t\t\tif (ele.tagName == \"TD\" || ele.tagName == \"TH\") return ele;\n\t\t\tvar td;\n\t\t\tif (td = domUtils.findParentByTagName(ele, \"td\", true) || domUtils.findParentByTagName(ele, \"th\", true)) return td;\n\t\t\treturn null;\n\t\t}\n\n\t\tfunction isEmptyBlock(node) {\n\t\t\tvar reg = new RegExp(domUtils.fillChar, 'g');\n\t\t\tif (node[browser.ie ? 'innerText' : 'textContent'].replace(/^\\s*$/, '').replace(reg, '').length > 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tfor (var n in dtd.$isNotEmpty) {\n\t\t\t\tif (node.getElementsByTagName(n).length) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn 1;\n\t\t}\n\n\t\tfunction mouseCoords(evt) {\n\t\t\tif (evt.pageX || evt.pageY) {\n\t\t\t\treturn {\n\t\t\t\t\tx: evt.pageX,\n\t\t\t\t\ty: evt.pageY\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tx: evt.clientX + me.document.body.scrollLeft - me.document.body.clientLeft,\n\t\t\t\ty: evt.clientY + me.document.body.scrollTop - me.document.body.clientTop\n\t\t\t};\n\t\t}\n\n\t\tfunction mouseMoveEvent(evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\n\t\t\t\t//普通状态下鼠标移动\n\t\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement),\n\t\t\t\t\tpos;\n\n\t\t\t\t//区分用户的行为是拖动还是双击\n\t\t\t\tif (isInResizeBuffer) {\n\n\t\t\t\t\tme.body.style.webkitUserSelect = 'none';\n\n\t\t\t\t\tif (Math.abs(userActionStatus.x - evt.clientX) > offsetOfTableCell || Math.abs(userActionStatus.y - evt.clientY) > offsetOfTableCell) {\n\t\t\t\t\t\tclearTableDragTimer();\n\t\t\t\t\t\tisInResizeBuffer = false;\n\t\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\t\t//drag action\n\t\t\t\t\t\ttableBorderDrag(evt);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//修改单元格大小时的鼠标移动\n\t\t\t\tif (onDrag && dragTd) {\n\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\tme.body.style.webkitUserSelect = 'none';\n\t\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t\t\tpos = mouseCoords(evt);\n\t\t\t\t\ttoggleDraggableState(me, true, onDrag, pos, target);\n\t\t\t\t\tif (onDrag == \"h\") {\n\t\t\t\t\t\tdragLine.style.left = getPermissionX(dragTd, evt) + \"px\";\n\t\t\t\t\t} else if (onDrag == \"v\") {\n\t\t\t\t\t\tdragLine.style.top = getPermissionY(dragTd, evt) + \"px\";\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t//当鼠标处于table上时，修改移动过程中的光标状态\n\t\t\t\tif (target) {\n\t\t\t\t\t//针对使用table作为容器的组件不触发拖拽效果\n\t\t\t\t\tif (me.fireEvent('excludetable', target) === true)\n\t\t\t\t\t\treturn;\n\t\t\t\t\tpos = mouseCoords(evt);\n\t\t\t\t\tvar state = getRelation(target, pos),\n\t\t\t\t\t\ttable = domUtils.findParentByTagName(target, \"table\", true);\n\n\t\t\t\t\tif (inTableSide(table, target, evt, true)) {\n\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\t\tme.body.style.cursor = \"url(\" + me.options.cursorpath + \"h.png),pointer\";\n\t\t\t\t\t} else if (inTableSide(table, target, evt)) {\n\t\t\t\t\t\tif (me.fireEvent(\"excludetable\", table) === true) return;\n\t\t\t\t\t\tme.body.style.cursor = \"url(\" + me.options.cursorpath + \"v.png),pointer\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.body.style.cursor = \"text\";\n\t\t\t\t\t\tvar curCell = target;\n\t\t\t\t\t\tif (/\\d/.test(state)) {\n\t\t\t\t\t\t\tstate = state.replace(/\\d/, '');\n\t\t\t\t\t\t\ttarget = getUETable(target).getPreviewCell(target, state == \"v\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//位于第一行的顶部或者第一列的左边时不可拖动\n\t\t\t\t\t\ttoggleDraggableState(me, target ? !!state : false, target ? state : '', pos, target);\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttoggleDragButton(false, table, me);\n\t\t\t\t}\n\n\t\t\t} catch (e) {\n\t\t\t\tshowError(e);\n\t\t\t}\n\t\t}\n\n\t\tvar dragButtonTimer;\n\n\t\tfunction toggleDragButton(show, table, editor) {\n\t\t\tif (!show) {\n\t\t\t\tif (dragOver) return;\n\t\t\t\tdragButtonTimer = setTimeout(function() {\n\t\t\t\t\t!dragOver && dragButton && dragButton.parentNode && dragButton.parentNode.removeChild(dragButton);\n\t\t\t\t}, 2000);\n\t\t\t} else {\n\t\t\t\tcreateDragButton(table, editor);\n\t\t\t}\n\t\t}\n\n\t\tfunction createDragButton(table, editor) {\n\t\t\tvar pos = domUtils.getXY(table),\n\t\t\t\tdoc = table.ownerDocument;\n\t\t\tif (dragButton && dragButton.parentNode) return dragButton;\n\t\t\tdragButton = doc.createElement(\"div\");\n\t\t\tdragButton.contentEditable = false;\n\t\t\tdragButton.innerHTML = \"\";\n\t\t\tdragButton.style.cssText = \"width:15px;height:15px;background-image:url(\" + editor.options.UEDITOR_HOME_URL + \"dialogs/table/dragicon.png);position: absolute;cursor:move;top:\" + (pos.y - 15) + \"px;left:\" + (pos.x) + \"px;\";\n\t\t\tdomUtils.unSelectable(dragButton);\n\t\t\tdragButton.onmouseover = function(evt) {\n\t\t\t\tdragOver = true;\n\t\t\t};\n\t\t\tdragButton.onmouseout = function(evt) {\n\t\t\t\tdragOver = false;\n\t\t\t};\n\t\t\tdomUtils.on(dragButton, 'click', function(type, evt) {\n\t\t\t\tdoClick(evt, this);\n\t\t\t});\n\t\t\tdomUtils.on(dragButton, 'dblclick', function(type, evt) {\n\t\t\t\tdoDblClick(evt);\n\t\t\t});\n\t\t\tdomUtils.on(dragButton, 'dragstart', function(type, evt) {\n\t\t\t\tdomUtils.preventDefault(evt);\n\t\t\t});\n\t\t\tvar timer;\n\n\t\t\tfunction doClick(evt, button) {\n\t\t\t\t// 部分浏览器下需要清理\n\t\t\t\tclearTimeout(timer);\n\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\teditor.fireEvent(\"tableClicked\", table, button);\n\t\t\t\t}, 300);\n\t\t\t}\n\n\t\t\tfunction doDblClick(evt) {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\tvar ut = getUETable(table),\n\t\t\t\t\tstart = table.rows[0].cells[0],\n\t\t\t\t\tend = ut.getLastCell(),\n\t\t\t\t\trange = ut.getCellsRange(start, end);\n\t\t\t\teditor.selection.getRange().setStart(start, 0).setCursor(false, true);\n\t\t\t\tut.setSelected(range);\n\t\t\t}\n\n\t\t\tdoc.body.appendChild(dragButton);\n\t\t}\n\n\t\t//    function inPosition(table, pos) {\n\t\t//        var tablePos = domUtils.getXY(table),\n\t\t//            width = table.offsetWidth,\n\t\t//            height = table.offsetHeight;\n\t\t//        if (pos.x - tablePos.x < 5 && pos.y - tablePos.y < 5) {\n\t\t//            return \"topLeft\";\n\t\t//        } else if (tablePos.x + width - pos.x < 5 && tablePos.y + height - pos.y < 5) {\n\t\t//            return \"bottomRight\";\n\t\t//        }\n\t\t//    }\n\n\t\tfunction inTableSide(table, cell, evt, top) {\n\t\t\tvar pos = mouseCoords(evt),\n\t\t\t\tstate = getRelation(cell, pos);\n\n\t\t\tif (top) {\n\t\t\t\tvar caption = table.getElementsByTagName(\"caption\")[0],\n\t\t\t\t\tcapHeight = caption ? caption.offsetHeight : 0;\n\t\t\t\treturn (state == \"v1\") && ((pos.y - domUtils.getXY(table).y - capHeight) < 8);\n\t\t\t} else {\n\t\t\t\treturn (state == \"h1\") && ((pos.x - domUtils.getXY(table).x) < 8);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 获取拖动时允许的X轴坐标\n\t\t * @param dragTd\n\t\t * @param evt\n\t\t */\n\t\tfunction getPermissionX(dragTd, evt) {\n\t\t\tvar ut = getUETable(dragTd);\n\t\t\tif (ut) {\n\t\t\t\tvar preTd = ut.getSameEndPosCells(dragTd, \"x\")[0],\n\t\t\t\t\tnextTd = ut.getSameStartPosXCells(dragTd)[0],\n\t\t\t\t\tmouseX = mouseCoords(evt).x,\n\t\t\t\t\tleft = (preTd ? domUtils.getXY(preTd).x : domUtils.getXY(ut.table).x) + 20,\n\t\t\t\t\tright = nextTd ? domUtils.getXY(nextTd).x + nextTd.offsetWidth - 20 : (me.body.offsetWidth + 5 || parseInt(domUtils.getComputedStyle(me.body, \"width\"), 10));\n\n\t\t\t\tleft += cellMinWidth;\n\t\t\t\tright -= cellMinWidth;\n\n\t\t\t\treturn mouseX < left ? left : mouseX > right ? right : mouseX;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 获取拖动时允许的Y轴坐标\n\t\t */\n\t\tfunction getPermissionY(dragTd, evt) {\n\t\t\ttry {\n\t\t\t\tvar top = domUtils.getXY(dragTd).y,\n\t\t\t\t\tmousePosY = mouseCoords(evt).y;\n\t\t\t\treturn mousePosY < top ? top : mousePosY;\n\t\t\t} catch (e) {\n\t\t\t\tshowError(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 移动状态切换\n\t\t */\n\t\tfunction toggleDraggableState(editor, draggable, dir, mousePos, cell) {\n\t\t\ttry {\n\t\t\t\teditor.body.style.cursor = dir == \"h\" ? \"col-resize\" : dir == \"v\" ? \"row-resize\" : \"text\";\n\t\t\t\tif (browser.ie) {\n\t\t\t\t\tif (dir && !mousedown && !getUETableBySelected(editor)) {\n\t\t\t\t\t\tgetDragLine(editor, editor.document);\n\t\t\t\t\t\tshowDragLineAt(dir, cell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\thideDragLine(editor)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tonBorder = draggable;\n\t\t\t} catch (e) {\n\t\t\t\tshowError(e);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 获取与UETable相关的resize line\n\t\t * @param uetable UETable对象\n\t\t */\n\t\tfunction getResizeLineByUETable() {\n\n\t\t\tvar lineId = '_UETableResizeLine',\n\t\t\t\tline = this.document.getElementById(lineId);\n\n\t\t\tif (!line) {\n\t\t\t\tline = this.document.createElement(\"div\");\n\t\t\t\tline.id = lineId;\n\t\t\t\tline.contnetEditable = false;\n\t\t\t\tline.setAttribute(\"unselectable\", \"on\");\n\n\t\t\t\tvar styles = {\n\t\t\t\t\twidth: 2 * cellBorderWidth + 1 + 'px',\n\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t'z-index': 100000,\n\t\t\t\t\tcursor: 'col-resize',\n\t\t\t\t\tbackground: 'red',\n\t\t\t\t\tdisplay: 'none'\n\t\t\t\t};\n\n\t\t\t\t//切换状态\n\t\t\t\tline.onmouseout = function() {\n\t\t\t\t\tthis.style.display = 'none';\n\t\t\t\t};\n\n\t\t\t\tutils.extend(line.style, styles);\n\n\t\t\t\tthis.document.body.appendChild(line);\n\n\t\t\t}\n\n\t\t\treturn line;\n\n\t\t}\n\n\t\t/**\n\t\t * 更新resize-line\n\t\t */\n\t\tfunction updateResizeLine(cell, uetable) {\n\n\t\t\tvar line = getResizeLineByUETable.call(this),\n\t\t\t\ttable = uetable.table,\n\t\t\t\tstyles = {\n\t\t\t\t\ttop: domUtils.getXY(table).y + 'px',\n\t\t\t\t\tleft: domUtils.getXY(cell).x + cell.offsetWidth - cellBorderWidth + 'px',\n\t\t\t\t\tdisplay: 'block',\n\t\t\t\t\theight: table.offsetHeight + 'px'\n\t\t\t\t};\n\n\t\t\tutils.extend(line.style, styles);\n\n\t\t}\n\n\t\t/**\n\t\t * 显示resize-line\n\t\t */\n\t\tfunction showResizeLine(cell) {\n\n\t\t\tvar uetable = getUETable(cell);\n\n\t\t\tupdateResizeLine.call(this, cell, uetable);\n\n\t\t}\n\n\t\t/**\n\t\t * 获取鼠标与当前单元格的相对位置\n\t\t * @param ele\n\t\t * @param mousePos\n\t\t */\n\t\tfunction getRelation(ele, mousePos) {\n\t\t\tvar elePos = domUtils.getXY(ele);\n\n\t\t\tif (!elePos) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tif (elePos.x + ele.offsetWidth - mousePos.x < cellBorderWidth) {\n\t\t\t\treturn \"h\";\n\t\t\t}\n\t\t\tif (mousePos.x - elePos.x < cellBorderWidth) {\n\t\t\t\treturn 'h1'\n\t\t\t}\n\t\t\tif (elePos.y + ele.offsetHeight - mousePos.y < cellBorderWidth) {\n\t\t\t\treturn \"v\";\n\t\t\t}\n\t\t\tif (mousePos.y - elePos.y < cellBorderWidth) {\n\t\t\t\treturn 'v1'\n\t\t\t}\n\t\t\treturn '';\n\t\t}\n\n\t\tfunction mouseDownEvent(type, evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tuserActionStatus = {\n\t\t\t\tx: evt.clientX,\n\t\t\t\ty: evt.clientY\n\t\t\t};\n\n\t\t\t//右键菜单单独处理\n\t\t\tif (evt.button == 2) {\n\t\t\t\tvar ut = getUETableBySelected(me),\n\t\t\t\t\tflag = false;\n\n\t\t\t\tif (ut) {\n\t\t\t\t\tvar td = getTargetTd(me, evt);\n\t\t\t\t\tutils.each(ut.selectedTds, function(ti) {\n\t\t\t\t\t\tif (ti === td) {\n\t\t\t\t\t\t\tflag = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!flag) {\n\t\t\t\t\t\tremoveSelectedClass(domUtils.getElementsByTagName(me.body, \"th td\"));\n\t\t\t\t\t\tut.clearSelected()\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttd = ut.selectedTds[0];\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tme.selection.getRange().setStart(td, 0).setCursor(false, true);\n\t\t\t\t\t\t}, 0);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttableClickHander(evt);\n\t\t\t}\n\n\t\t}\n\n\t\t//清除表格的计时器\n\t\tfunction clearTableTimer() {\n\t\t\ttabTimer && clearTimeout(tabTimer);\n\t\t\ttabTimer = null;\n\t\t}\n\n\t\t//双击收缩\n\t\tfunction tableDbclickHandler(evt) {\n\t\t\tsingleClickState = 0;\n\t\t\tevt = evt || me.window.event;\n\t\t\tvar target = getParentTdOrTh(evt.target || evt.srcElement);\n\t\t\tif (target) {\n\t\t\t\tvar h;\n\t\t\t\tif (h = getRelation(target, mouseCoords(evt))) {\n\n\t\t\t\t\thideDragLine(me);\n\n\t\t\t\t\tif (h == 'h1') {\n\t\t\t\t\t\th = 'h';\n\t\t\t\t\t\tif (inTableSide(domUtils.findParentByTagName(target, \"table\"), target, evt)) {\n\t\t\t\t\t\t\tme.execCommand('adaptbywindow');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget = getUETable(target).getPreviewCell(target);\n\t\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\t\t\t\t\trng.selectNodeContents(target).setCursor(true, true)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (h == 'h') {\n\t\t\t\t\t\tvar ut = getUETable(target),\n\t\t\t\t\t\t\ttable = ut.table,\n\t\t\t\t\t\t\tcells = getCellsByMoveBorder(target, table, true);\n\n\t\t\t\t\t\tcells = extractArray(cells, 'left');\n\n\t\t\t\t\t\tut.width = ut.offsetWidth;\n\n\t\t\t\t\t\tvar oldWidth = [],\n\t\t\t\t\t\t\tnewWidth = [];\n\n\t\t\t\t\t\tutils.each(cells, function(cell) {\n\n\t\t\t\t\t\t\toldWidth.push(cell.offsetWidth);\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tutils.each(cells, function(cell) {\n\n\t\t\t\t\t\t\tcell.removeAttribute(\"width\");\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\twindow.setTimeout(function() {\n\n\t\t\t\t\t\t\t//是否允许改变\n\t\t\t\t\t\t\tvar changeable = true;\n\n\t\t\t\t\t\t\tutils.each(cells, function(cell, index) {\n\n\t\t\t\t\t\t\t\tvar width = cell.offsetWidth;\n\n\t\t\t\t\t\t\t\tif (width > oldWidth[index]) {\n\t\t\t\t\t\t\t\t\tchangeable = false;\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tnewWidth.push(width);\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tvar change = changeable ? newWidth : oldWidth;\n\n\t\t\t\t\t\t\tutils.each(cells, function(cell, index) {\n\n\t\t\t\t\t\t\t\tcell.width = change[index] - getTabcellSpace();\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t}, 0);\n\n\t\t\t\t\t\t//                    minWidth -= cellMinWidth;\n\t\t\t\t\t\t//\n\t\t\t\t\t\t//                    table.removeAttribute(\"width\");\n\t\t\t\t\t\t//                    utils.each(cells, function (cell) {\n\t\t\t\t\t\t//                        cell.style.width = \"\";\n\t\t\t\t\t\t//                        cell.width -= minWidth;\n\t\t\t\t\t\t//                    });\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction tableClickHander(evt) {\n\n\t\t\tremoveSelectedClass(domUtils.getElementsByTagName(me.body, \"td th\"));\n\t\t\t//trace:3113\n\t\t\t//选中单元格，点击table外部，不会清掉table上挂的ueTable,会引起getUETableBySelected方法返回值\n\t\t\tutils.each(me.document.getElementsByTagName('table'), function(t) {\n\t\t\t\tt.ueTable = null;\n\t\t\t});\n\t\t\tstartTd = getTargetTd(me, evt);\n\t\t\tif (!startTd) return;\n\t\t\tvar table = domUtils.findParentByTagName(startTd, \"table\", true);\n\t\t\tut = getUETable(table);\n\t\t\tut && ut.clearSelected();\n\n\t\t\t//判断当前鼠标状态\n\t\t\tif (!onBorder) {\n\t\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t\tmousedown = true;\n\t\t\t\tme.addListener('mouseover', mouseOverEvent);\n\t\t\t} else {\n\t\t\t\t//边框上的动作处理\n\t\t\t\tborderActionHandler(evt);\n\t\t\t}\n\n\t\t}\n\n\t\t//处理表格边框上的动作, 这里做延时处理，避免两种动作互相影响\n\t\tfunction borderActionHandler(evt) {\n\n\t\t\tif (browser.ie) {\n\t\t\t\tevt = reconstruct(evt);\n\t\t\t}\n\n\t\t\tclearTableDragTimer();\n\n\t\t\t//是否正在等待resize的缓冲中\n\t\t\tisInResizeBuffer = true;\n\n\t\t\ttableDragTimer = setTimeout(function() {\n\t\t\t\ttableBorderDrag(evt);\n\t\t\t}, dblclickTime);\n\n\t\t}\n\n\t\tfunction extractArray(originArr, key) {\n\n\t\t\tvar result = [],\n\t\t\t\ttmp = null;\n\n\t\t\tfor (var i = 0, len = originArr.length; i < len; i++) {\n\n\t\t\t\ttmp = originArr[i][key];\n\n\t\t\t\tif (tmp) {\n\t\t\t\t\tresult.push(tmp);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn result;\n\n\t\t}\n\n\t\tfunction clearTableDragTimer() {\n\t\t\ttableDragTimer && clearTimeout(tableDragTimer);\n\t\t\ttableDragTimer = null;\n\t\t}\n\n\t\tfunction reconstruct(obj) {\n\n\t\t\tvar attrs = ['pageX', 'pageY', 'clientX', 'clientY', 'srcElement', 'target'],\n\t\t\t\tnewObj = {};\n\n\t\t\tif (obj) {\n\n\t\t\t\tfor (var i = 0, key, val; key = attrs[i]; i++) {\n\t\t\t\t\tval = obj[key];\n\t\t\t\t\tval && (newObj[key] = val);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn newObj;\n\n\t\t}\n\n\t\t//边框拖动\n\t\tfunction tableBorderDrag(evt) {\n\n\t\t\tisInResizeBuffer = false;\n\n\t\t\tstartTd = evt.target || evt.srcElement;\n\t\t\tif (!startTd) return;\n\t\t\tvar state = getRelation(startTd, mouseCoords(evt));\n\t\t\tif (/\\d/.test(state)) {\n\t\t\t\tstate = state.replace(/\\d/, '');\n\t\t\t\tstartTd = getUETable(startTd).getPreviewCell(startTd, state == 'v');\n\t\t\t}\n\t\t\thideDragLine(me);\n\t\t\tgetDragLine(me, me.document);\n\t\t\tme.fireEvent('saveScene');\n\t\t\tshowDragLineAt(state, startTd);\n\t\t\tmousedown = true;\n\t\t\t//拖动开始\n\t\t\tonDrag = state;\n\t\t\tdragTd = startTd;\n\t\t}\n\n\t\tfunction mouseUpEvent(type, evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tclearTableDragTimer();\n\n\t\t\tisInResizeBuffer = false;\n\n\t\t\tif (onBorder) {\n\t\t\t\tsingleClickState = ++singleClickState % 3;\n\n\t\t\t\tuserActionStatus = {\n\t\t\t\t\tx: evt.clientX,\n\t\t\t\t\ty: evt.clientY\n\t\t\t\t};\n\n\t\t\t\ttableResizeTimer = setTimeout(function() {\n\t\t\t\t\tsingleClickState > 0 && singleClickState--;\n\t\t\t\t}, dblclickTime);\n\n\t\t\t\tif (singleClickState === 2) {\n\n\t\t\t\t\tsingleClickState = 0;\n\t\t\t\t\ttableDbclickHandler(evt);\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif (evt.button == 2) return;\n\t\t\tvar me = this;\n\t\t\t//清除表格上原生跨选问题\n\t\t\tvar range = me.selection.getRange(),\n\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, 'table', true),\n\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, 'table', true);\n\n\t\t\tif (start || end) {\n\t\t\t\tif (start === end) {\n\t\t\t\t\tstart = domUtils.findParentByTagName(range.startContainer, ['td', 'th', 'caption'], true);\n\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, ['td', 'th', 'caption'], true);\n\t\t\t\t\tif (start !== end) {\n\t\t\t\t\t\tme.selection.clearRange()\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tme.selection.clearRange()\n\t\t\t\t}\n\t\t\t}\n\t\t\tmousedown = false;\n\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t//拖拽状态下的mouseUP\n\t\t\tif (onDrag && dragTd) {\n\n\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\n\t\t\t\tsingleClickState = 0;\n\t\t\t\tdragLine = me.document.getElementById('ue_tableDragLine');\n\n\t\t\t\t// trace 3973\n\t\t\t\tif (dragLine) {\n\t\t\t\t\tvar dragTdPos = domUtils.getXY(dragTd),\n\t\t\t\t\t\tdragLinePos = domUtils.getXY(dragLine);\n\n\t\t\t\t\tswitch (onDrag) {\n\t\t\t\t\t\tcase \"h\":\n\t\t\t\t\t\t\tchangeColWidth(dragTd, dragLinePos.x - dragTdPos.x);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"v\":\n\t\t\t\t\t\t\tchangeRowHeight(dragTd, dragLinePos.y - dragTdPos.y - dragTd.offsetHeight);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t}\n\t\t\t\t\tonDrag = \"\";\n\t\t\t\t\tdragTd = null;\n\n\t\t\t\t\thideDragLine(me);\n\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//正常状态下的mouseup\n\t\t\tif (!startTd) {\n\t\t\t\tvar target = domUtils.findParentByTagName(evt.target || evt.srcElement, \"td\", true);\n\t\t\t\tif (!target) target = domUtils.findParentByTagName(evt.target || evt.srcElement, \"th\", true);\n\t\t\t\tif (target && (target.tagName == \"TD\" || target.tagName == \"TH\")) {\n\t\t\t\t\tif (me.fireEvent(\"excludetable\", target) === true) return;\n\t\t\t\t\trange = new dom.Range(me.document);\n\t\t\t\t\trange.setStart(target, 0).setCursor(false, true);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar ut = getUETable(startTd),\n\t\t\t\t\tcell = ut ? ut.selectedTds[0] : null;\n\t\t\t\tif (cell) {\n\t\t\t\t\trange = new dom.Range(me.document);\n\t\t\t\t\tif (domUtils.isEmptyBlock(cell)) {\n\t\t\t\t\t\trange.setStart(cell, 0).setCursor(false, true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trange.selectNodeContents(cell).shrinkBoundary().setCursor(false, true);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\trange = me.selection.getRange().shrinkBoundary();\n\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\tvar start = domUtils.findParentByTagName(range.startContainer, ['td', 'th'], true),\n\t\t\t\t\t\t\tend = domUtils.findParentByTagName(range.endContainer, ['td', 'th'], true);\n\t\t\t\t\t\t//在table里边的不能清除\n\t\t\t\t\t\tif (start && !end || !start && end || start && end && start !== end) {\n\t\t\t\t\t\t\trange.setCursor(false, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstartTd = null;\n\t\t\t\tme.removeListener('mouseover', mouseOverEvent);\n\t\t\t}\n\t\t\tme._selectionChange(250, evt);\n\t\t}\n\n\t\tfunction mouseOverEvent(type, evt) {\n\n\t\t\tif (isEditorDisabled()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar me = this,\n\t\t\t\ttar = evt.target || evt.srcElement;\n\t\t\tcurrentTd = domUtils.findParentByTagName(tar, \"td\", true) || domUtils.findParentByTagName(tar, \"th\", true);\n\t\t\t//需要判断两个TD是否位于同一个表格内\n\t\t\tif (startTd && currentTd &&\n\t\t\t\t((startTd.tagName == \"TD\" && currentTd.tagName == \"TD\") || (startTd.tagName == \"TH\" && currentTd.tagName == \"TH\")) &&\n\t\t\t\tdomUtils.findParentByTagName(startTd, 'table') == domUtils.findParentByTagName(currentTd, 'table')) {\n\t\t\t\tvar ut = getUETable(currentTd);\n\t\t\t\tif (startTd != currentTd) {\n\t\t\t\t\tme.document.body.style.webkitUserSelect = 'none';\n\t\t\t\t\tme.selection.getNative()[browser.ie9below ? 'empty' : 'removeAllRanges']();\n\t\t\t\t\tvar range = ut.getCellsRange(startTd, currentTd);\n\t\t\t\t\tut.setSelected(range);\n\t\t\t\t} else {\n\t\t\t\t\tme.document.body.style.webkitUserSelect = '';\n\t\t\t\t\tut.clearSelected();\n\t\t\t\t}\n\n\t\t\t}\n\t\t\tevt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n\t\t}\n\n\t\tfunction setCellHeight(cell, height, backHeight) {\n\t\t\tvar lineHight = parseInt(domUtils.getComputedStyle(cell, \"line-height\"), 10),\n\t\t\t\ttmpHeight = backHeight + height;\n\t\t\theight = tmpHeight < lineHight ? lineHight : tmpHeight;\n\t\t\tif (cell.style.height) cell.style.height = \"\";\n\t\t\tcell.rowSpan == 1 ? cell.setAttribute(\"height\", height) : (cell.removeAttribute && cell.removeAttribute(\"height\"));\n\t\t}\n\n\t\tfunction getWidth(cell) {\n\t\t\tif (!cell) return 0;\n\t\t\treturn parseInt(domUtils.getComputedStyle(cell, \"width\"), 10);\n\t\t}\n\n\t\tfunction changeColWidth(cell, changeValue) {\n\n\t\t\tvar ut = getUETable(cell);\n\t\t\tif (ut) {\n\n\t\t\t\t//根据当前移动的边框获取相关的单元格\n\t\t\t\tvar table = ut.table,\n\t\t\t\t\tcells = getCellsByMoveBorder(cell, table);\n\n\t\t\t\ttable.style.width = \"\";\n\t\t\t\ttable.removeAttribute(\"width\");\n\n\t\t\t\t//修正改变量\n\t\t\t\tchangeValue = correctChangeValue(changeValue, cell, cells);\n\n\t\t\t\tif (cell.nextSibling) {\n\n\t\t\t\t\tvar i = 0;\n\n\t\t\t\t\tutils.each(cells, function(cellGroup) {\n\n\t\t\t\t\t\tcellGroup.left.width = (+cellGroup.left.width) + changeValue;\n\t\t\t\t\t\tcellGroup.right && (cellGroup.right.width = (+cellGroup.right.width) - changeValue);\n\n\t\t\t\t\t});\n\n\t\t\t\t} else {\n\n\t\t\t\t\tutils.each(cells, function(cellGroup) {\n\t\t\t\t\t\tcellGroup.left.width -= -changeValue;\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\tfunction isEditorDisabled() {\n\t\t\treturn me.body.contentEditable === \"false\";\n\t\t}\n\n\t\tfunction changeRowHeight(td, changeValue) {\n\t\t\tif (Math.abs(changeValue) < 10) return;\n\t\t\tvar ut = getUETable(td);\n\t\t\tif (ut) {\n\t\t\t\tvar cells = ut.getSameEndPosCells(td, \"y\"),\n\t\t\t\t\t//备份需要连带变化的td的原始高度，否则后期无法获取正确的值\n\t\t\t\t\tbackHeight = cells[0] ? cells[0].offsetHeight : 0;\n\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\tsetCellHeight(cell, changeValue, backHeight);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\n\t\t/**\n\t\t * 获取调整单元格大小的相关单元格\n\t\t * @isContainMergeCell 返回的结果中是否包含发生合并后的单元格\n\t\t */\n\t\tfunction getCellsByMoveBorder(cell, table, isContainMergeCell) {\n\n\t\t\tif (!table) {\n\t\t\t\ttable = domUtils.findParentByTagName(cell, 'table');\n\t\t\t}\n\n\t\t\tif (!table) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t//获取到该单元格所在行的序列号\n\t\t\tvar index = domUtils.getNodeIndex(cell),\n\t\t\t\ttemp = cell,\n\t\t\t\trows = table.rows,\n\t\t\t\tcolIndex = 0;\n\n\t\t\twhile (temp) {\n\t\t\t\t//获取到当前单元格在未发生单元格合并时的序列\n\t\t\t\tif (temp.nodeType === 1) {\n\t\t\t\t\tcolIndex += (temp.colSpan || 1);\n\t\t\t\t}\n\t\t\t\ttemp = temp.previousSibling;\n\t\t\t}\n\n\t\t\ttemp = null;\n\n\t\t\t//记录想关的单元格\n\t\t\tvar borderCells = [];\n\n\t\t\tutils.each(rows, function(tabRow) {\n\n\t\t\t\tvar cells = tabRow.cells,\n\t\t\t\t\tcurrIndex = 0;\n\n\t\t\t\tutils.each(cells, function(tabCell) {\n\n\t\t\t\t\tcurrIndex += (tabCell.colSpan || 1);\n\n\t\t\t\t\tif (currIndex === colIndex) {\n\n\t\t\t\t\t\tborderCells.push({\n\t\t\t\t\t\t\tleft: tabCell,\n\t\t\t\t\t\t\tright: tabCell.nextSibling || null\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn false;\n\n\t\t\t\t\t} else if (currIndex > colIndex) {\n\n\t\t\t\t\t\tif (isContainMergeCell) {\n\t\t\t\t\t\t\tborderCells.push({\n\t\t\t\t\t\t\t\tleft: tabCell\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t});\n\n\t\t\t});\n\n\t\t\treturn borderCells;\n\n\t\t}\n\n\t\t/**\n\t\t * 通过给定的单元格集合获取最小的单元格width\n\t\t */\n\t\tfunction getMinWidthByTableCells(cells) {\n\n\t\t\tvar minWidth = Number.MAX_VALUE;\n\n\t\t\tfor (var i = 0, curCell; curCell = cells[i]; i++) {\n\n\t\t\t\tminWidth = Math.min(minWidth, curCell.width || getTableCellWidth(curCell));\n\n\t\t\t}\n\n\t\t\treturn minWidth;\n\n\t\t}\n\n\t\tfunction correctChangeValue(changeValue, relatedCell, cells) {\n\n\t\t\t//为单元格的paading预留空间\n\t\t\tchangeValue -= getTabcellSpace();\n\n\t\t\tif (changeValue < 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tchangeValue -= getTableCellWidth(relatedCell);\n\n\t\t\t//确定方向\n\t\t\tvar direction = changeValue < 0 ? 'left' : 'right';\n\n\t\t\tchangeValue = Math.abs(changeValue);\n\n\t\t\t//只关心非最后一个单元格就可以\n\t\t\tutils.each(cells, function(cellGroup) {\n\n\t\t\t\tvar curCell = cellGroup[direction];\n\n\t\t\t\t//为单元格保留最小空间\n\t\t\t\tif (curCell) {\n\t\t\t\t\tchangeValue = Math.min(changeValue, getTableCellWidth(curCell) - cellMinWidth);\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\t//修正越界\n\t\t\tchangeValue = changeValue < 0 ? 0 : changeValue;\n\n\t\t\treturn direction === 'left' ? -changeValue : changeValue;\n\n\t\t}\n\n\t\tfunction getTableCellWidth(cell) {\n\n\t\t\tvar width = 0,\n\t\t\t\t//偏移纠正量\n\t\t\t\toffset = 0,\n\t\t\t\twidth = cell.offsetWidth - getTabcellSpace();\n\n\t\t\t//最后一个节点纠正一下\n\t\t\tif (!cell.nextSibling) {\n\n\t\t\t\twidth -= getTableCellOffset(cell);\n\n\t\t\t}\n\n\t\t\twidth = width < 0 ? 0 : width;\n\n\t\t\ttry {\n\t\t\t\tcell.width = width;\n\t\t\t} catch (e) {}\n\n\t\t\treturn width;\n\n\t\t}\n\n\t\t/**\n\t\t * 获取单元格所在表格的最末单元格的偏移量\n\t\t */\n\t\tfunction getTableCellOffset(cell) {\n\n\t\t\ttab = domUtils.findParentByTagName(cell, \"table\", false);\n\n\t\t\tif (tab.offsetVal === undefined) {\n\n\t\t\t\tvar prev = cell.previousSibling;\n\n\t\t\t\tif (prev) {\n\n\t\t\t\t\t//最后一个单元格和前一个单元格的width diff结果 如果恰好为一个border width， 则条件成立\n\t\t\t\t\ttab.offsetVal = cell.offsetWidth - prev.offsetWidth === UT.borderWidth ? UT.borderWidth : 0;\n\n\t\t\t\t} else {\n\t\t\t\t\ttab.offsetVal = 0;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn tab.offsetVal;\n\n\t\t}\n\n\t\tfunction getTabcellSpace() {\n\n\t\t\tif (UT.tabcellSpace === undefined) {\n\n\t\t\t\tvar cell = null,\n\t\t\t\t\ttab = me.document.createElement(\"table\"),\n\t\t\t\t\ttbody = me.document.createElement(\"tbody\"),\n\t\t\t\t\ttrow = me.document.createElement(\"tr\"),\n\t\t\t\t\ttabcell = me.document.createElement(\"td\"),\n\t\t\t\t\tmirror = null;\n\n\t\t\t\ttabcell.style.cssText = 'border: 0;';\n\t\t\t\ttabcell.width = 1;\n\n\t\t\t\ttrow.appendChild(tabcell);\n\t\t\t\ttrow.appendChild(mirror = tabcell.cloneNode(false));\n\n\t\t\t\ttbody.appendChild(trow);\n\n\t\t\t\ttab.appendChild(tbody);\n\n\t\t\t\ttab.style.cssText = \"visibility: hidden;\";\n\n\t\t\t\tme.body.appendChild(tab);\n\n\t\t\t\tUT.paddingSpace = tabcell.offsetWidth - 1;\n\n\t\t\t\tvar tmpTabWidth = tab.offsetWidth;\n\n\t\t\t\ttabcell.style.cssText = '';\n\t\t\t\tmirror.style.cssText = '';\n\n\t\t\t\tUT.borderWidth = (tab.offsetWidth - tmpTabWidth) / 3;\n\n\t\t\t\tUT.tabcellSpace = UT.paddingSpace + UT.borderWidth;\n\n\t\t\t\tme.body.removeChild(tab);\n\n\t\t\t}\n\n\t\t\tgetTabcellSpace = function() {\n\t\t\t\treturn UT.tabcellSpace;\n\t\t\t};\n\n\t\t\treturn UT.tabcellSpace;\n\n\t\t}\n\n\t\tfunction getDragLine(editor, doc) {\n\t\t\tif (mousedown) return;\n\t\t\tdragLine = editor.document.createElement(\"div\");\n\t\t\tdomUtils.setAttributes(dragLine, {\n\t\t\t\tid: \"ue_tableDragLine\",\n\t\t\t\tunselectable: 'on',\n\t\t\t\tcontenteditable: false,\n\t\t\t\t'onresizestart': 'return false',\n\t\t\t\t'ondragstart': 'return false',\n\t\t\t\t'onselectstart': 'return false',\n\t\t\t\tstyle: \"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)\"\n\t\t\t});\n\t\t\teditor.body.appendChild(dragLine);\n\t\t}\n\n\t\tfunction hideDragLine(editor) {\n\t\t\tif (mousedown) return;\n\t\t\tvar line;\n\t\t\twhile (line = editor.document.getElementById('ue_tableDragLine')) {\n\t\t\t\tdomUtils.remove(line)\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 依据state（v|h）在cell位置显示横线\n\t\t * @param state\n\t\t * @param cell\n\t\t */\n\t\tfunction showDragLineAt(state, cell) {\n\t\t\tif (!cell) return;\n\t\t\tvar table = domUtils.findParentByTagName(cell, \"table\"),\n\t\t\t\tcaption = table.getElementsByTagName('caption'),\n\t\t\t\twidth = table.offsetWidth,\n\t\t\t\theight = table.offsetHeight - (caption.length > 0 ? caption[0].offsetHeight : 0),\n\t\t\t\ttablePos = domUtils.getXY(table),\n\t\t\t\tcellPos = domUtils.getXY(cell),\n\t\t\t\tcss;\n\t\t\tswitch (state) {\n\t\t\t\tcase \"h\":\n\t\t\t\t\tcss = 'height:' + height + 'px;top:' + (tablePos.y + (caption.length > 0 ? caption[0].offsetHeight : 0)) + 'px;left:' + (cellPos.x + cell.offsetWidth);\n\t\t\t\t\tdragLine.style.cssText = css + 'px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)';\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"v\":\n\t\t\t\t\tcss = 'width:' + width + 'px;left:' + tablePos.x + 'px;top:' + (cellPos.y + cell.offsetHeight);\n\t\t\t\t\t//必须加上border:0和color:blue，否则低版ie不支持背景色显示\n\t\t\t\t\tdragLine.style.cssText = css + 'px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * 当表格边框颜色为白色时设置为虚线,true为添加虚线\n\t\t * @param editor\n\t\t * @param flag\n\t\t */\n\t\tfunction switchBorderColor(editor, flag) {\n\t\t\tvar tableArr = domUtils.getElementsByTagName(editor.body, \"table\"),\n\t\t\t\tcolor;\n\t\t\tfor (var i = 0, node; node = tableArr[i++];) {\n\t\t\t\tvar td = domUtils.getElementsByTagName(node, \"td\");\n\t\t\t\tif (td[0]) {\n\t\t\t\t\tif (flag) {\n\t\t\t\t\t\tcolor = (td[0].style.borderColor).replace(/\\s/g, \"\");\n\t\t\t\t\t\tif (/(#ffffff)|(rgb\\(255,255,255\\))/ig.test(color))\n\t\t\t\t\t\t\tdomUtils.addClass(node, \"noBorderTable\")\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdomUtils.removeClasses(node, \"noBorderTable\")\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tfunction getTableWidth(editor, needIEHack, defaultValue) {\n\t\t\tvar body = editor.body;\n\t\t\treturn body.offsetWidth - (needIEHack ? parseInt(domUtils.getComputedStyle(body, 'margin-left'), 10) * 2 : 0) - defaultValue.tableBorder * 2 - (editor.options.offsetWidth || 0);\n\t\t}\n\n\t\t/**\n\t\t * 获取当前拖动的单元格\n\t\t */\n\t\tfunction getTargetTd(editor, evt) {\n\n\t\t\tvar target = domUtils.findParentByTagName(evt.target || evt.srcElement, [\"td\", \"th\"], true),\n\t\t\t\tdir = null;\n\n\t\t\tif (!target) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tdir = getRelation(target, mouseCoords(evt));\n\n\t\t\t//如果有前一个节点， 需要做一个修正， 否则可能会得到一个错误的td\n\n\t\t\tif (!target) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (dir === 'h1' && target.previousSibling) {\n\n\t\t\t\tvar position = domUtils.getXY(target),\n\t\t\t\t\tcellWidth = target.offsetWidth;\n\n\t\t\t\tif (Math.abs(position.x + cellWidth - evt.clientX) > cellWidth / 3) {\n\t\t\t\t\ttarget = target.previousSibling;\n\t\t\t\t}\n\n\t\t\t} else if (dir === 'v1' && target.parentNode.previousSibling) {\n\n\t\t\t\tvar position = domUtils.getXY(target),\n\t\t\t\t\tcellHeight = target.offsetHeight;\n\n\t\t\t\tif (Math.abs(position.y + cellHeight - evt.clientY) > cellHeight / 3) {\n\t\t\t\t\ttarget = target.parentNode.previousSibling.firstChild;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t//排除了非td内部以及用于代码高亮部分的td\n\t\t\treturn target && !(editor.fireEvent(\"excludetable\", target) === true) ? target : null;\n\t\t}\n\n\t};\n\n\t// plugins/table.sort.js\n\t/**\n\t * Created with JetBrains PhpStorm.\n\t * User: Jinqn\n\t * Date: 13-10-12\n\t * Time: 上午10:20\n\t * To change this template use File | Settings | File Templates.\n\t */\n\n\tUE.UETable.prototype.sortTable = function(sortByCellIndex, compareFn) {\n\t\tvar table = this.table,\n\t\t\trows = table.rows,\n\t\t\ttrArray = [],\n\t\t\tflag = rows[0].cells[0].tagName === \"TH\",\n\t\t\tlastRowIndex = 0;\n\t\tif (this.selectedTds.length) {\n\t\t\tvar range = this.cellsRange,\n\t\t\t\tlen = range.endRowIndex + 1;\n\t\t\tfor (var i = range.beginRowIndex; i < len; i++) {\n\t\t\t\ttrArray[i] = rows[i];\n\t\t\t}\n\t\t\ttrArray.splice(0, range.beginRowIndex);\n\t\t\tlastRowIndex = (range.endRowIndex + 1) === this.rowsNum ? 0 : range.endRowIndex + 1;\n\t\t} else {\n\t\t\tfor (var i = 0, len = rows.length; i < len; i++) {\n\t\t\t\ttrArray[i] = rows[i];\n\t\t\t}\n\t\t}\n\n\t\tvar Fn = {\n\t\t\t'reversecurrent': function(td1, td2) {\n\t\t\t\treturn 1;\n\t\t\t},\n\t\t\t'orderbyasc': function(td1, td2) {\n\t\t\t\tvar value1 = td1.innerText || td1.textContent,\n\t\t\t\t\tvalue2 = td2.innerText || td2.textContent;\n\t\t\t\treturn value1.localeCompare(value2);\n\t\t\t},\n\t\t\t'reversebyasc': function(td1, td2) {\n\t\t\t\tvar value1 = td1.innerHTML,\n\t\t\t\t\tvalue2 = td2.innerHTML;\n\t\t\t\treturn value2.localeCompare(value1);\n\t\t\t},\n\t\t\t'orderbynum': function(td1, td2) {\n\t\t\t\tvar value1 = td1[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/),\n\t\t\t\t\tvalue2 = td2[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/);\n\t\t\t\tif (value1) value1 = +value1[0];\n\t\t\t\tif (value2) value2 = +value2[0];\n\t\t\t\treturn (value1 || 0) - (value2 || 0);\n\t\t\t},\n\t\t\t'reversebynum': function(td1, td2) {\n\t\t\t\tvar value1 = td1[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/),\n\t\t\t\t\tvalue2 = td2[browser.ie ? 'innerText' : 'textContent'].match(/\\d+/);\n\t\t\t\tif (value1) value1 = +value1[0];\n\t\t\t\tif (value2) value2 = +value2[0];\n\t\t\t\treturn (value2 || 0) - (value1 || 0);\n\t\t\t}\n\t\t};\n\n\t\t//对表格设置排序的标记data-sort-type\n\t\ttable.setAttribute('data-sort-type', compareFn && typeof compareFn === \"string\" && Fn[compareFn] ? compareFn : '');\n\n\t\t//th不参与排序\n\t\tflag && trArray.splice(0, 1);\n\t\ttrArray = utils.sort(trArray, function(tr1, tr2) {\n\t\t\tvar result;\n\t\t\tif (compareFn && typeof compareFn === \"function\") {\n\t\t\t\tresult = compareFn.call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t} else if (compareFn && typeof compareFn === \"number\") {\n\t\t\t\tresult = 1;\n\t\t\t} else if (compareFn && typeof compareFn === \"string\" && Fn[compareFn]) {\n\t\t\t\tresult = Fn[compareFn].call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t} else {\n\t\t\t\tresult = Fn['orderbyasc'].call(this, tr1.cells[sortByCellIndex], tr2.cells[sortByCellIndex]);\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t\tvar fragment = table.ownerDocument.createDocumentFragment();\n\t\tfor (var j = 0, len = trArray.length; j < len; j++) {\n\t\t\tfragment.appendChild(trArray[j]);\n\t\t}\n\t\tvar tbody = table.getElementsByTagName(\"tbody\")[0];\n\t\tif (!lastRowIndex) {\n\t\t\ttbody.appendChild(fragment);\n\t\t} else {\n\t\t\ttbody.insertBefore(fragment, rows[lastRowIndex - range.endRowIndex + range.beginRowIndex - 1])\n\t\t}\n\t};\n\n\tUE.plugins['tablesort'] = function() {\n\t\tvar me = this,\n\t\t\tUT = UE.UETable,\n\t\t\tgetUETable = function(tdOrTable) {\n\t\t\t\treturn UT.getUETable(tdOrTable);\n\t\t\t},\n\t\t\tgetTableItemsByRange = function(editor) {\n\t\t\t\treturn UT.getTableItemsByRange(editor);\n\t\t\t};\n\n\t\tme.ready(function() {\n\t\t\t//添加表格可排序的样式\n\t\t\tutils.cssRule('tablesort',\n\t\t\t\t'table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;' +\n\t\t\t\t'   background-image:url(' + me.options.themePath + me.options.theme + '/images/sortable.png);}',\n\t\t\t\tme.document);\n\n\t\t\t//做单元格合并操作时,清除可排序标识\n\t\t\tme.addListener(\"afterexeccommand\", function(type, cmd) {\n\t\t\t\tif (cmd == 'mergeright' || cmd == 'mergedown' || cmd == 'mergecells') {\n\t\t\t\t\tthis.execCommand('disablesort');\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\t//表格排序\n\t\tUE.commands['sorttable'] = {\n\t\t\tqueryCommandState: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\ttableItems = getTableItemsByRange(me);\n\t\t\t\tif (!tableItems.cell) return -1;\n\t\t\t\tvar table = tableItems.table,\n\t\t\t\t\tcells = table.getElementsByTagName(\"td\");\n\t\t\t\tfor (var i = 0, cell; cell = cells[i++];) {\n\t\t\t\t\tif (cell.rowSpan != 1 || cell.colSpan != 1) return -1;\n\t\t\t\t}\n\t\t\t\treturn 0;\n\t\t\t},\n\t\t\texecCommand: function(cmd, fn) {\n\t\t\t\tvar me = this,\n\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\tbk = range.createBookmark(true),\n\t\t\t\t\ttableItems = getTableItemsByRange(me),\n\t\t\t\t\tcell = tableItems.cell,\n\t\t\t\t\tut = getUETable(tableItems.table),\n\t\t\t\t\tcellInfo = ut.getCellInfo(cell);\n\t\t\t\tut.sortTable(cellInfo.cellIndex, fn);\n\t\t\t\trange.moveToBookmark(bk);\n\t\t\t\ttry {\n\t\t\t\t\trange.select();\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\t\t};\n\n\t\t//设置表格可排序,清除表格可排序\n\t\tUE.commands[\"enablesort\"] = UE.commands[\"disablesort\"] = {\n\t\t\tqueryCommandState: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\tif (table && cmd == 'enablesort') {\n\t\t\t\t\tvar cells = domUtils.getElementsByTagName(table, 'th td');\n\t\t\t\t\tfor (var i = 0; i < cells.length; i++) {\n\t\t\t\t\t\tif (cells[i].getAttribute('colspan') > 1 || cells[i].getAttribute('rowspan') > 1) return -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn !table ? -1 : cmd == 'enablesort' ^ table.getAttribute('data-sort') != 'sortEnabled' ? -1 : 0;\n\t\t\t},\n\t\t\texecCommand: function(cmd) {\n\t\t\t\tvar table = getTableItemsByRange(this).table;\n\t\t\t\ttable.setAttribute(\"data-sort\", cmd == \"enablesort\" ? \"sortEnabled\" : \"sortDisabled\");\n\t\t\t\tcmd == \"enablesort\" ? domUtils.addClass(table, \"sortEnabled\") : domUtils.removeClasses(table, \"sortEnabled\");\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/contextmenu.js\n\t///import core\n\t///commands 右键菜单\n\t///commandsName  ContextMenu\n\t///commandsTitle  右键菜单\n\t/**\n\t * 右键菜单\n\t * @function\n\t * @name baidu.editor.plugins.contextmenu\n\t * @author zhanyi\n\t */\n\n\tUE.plugins['contextmenu'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt('enableContextMenu', true);\n\t\tif (me.getOpt('enableContextMenu') === false) {\n\t\t\treturn;\n\t\t}\n\t\tvar lang = me.getLang(\"contextMenu\"),\n\t\t\tmenu,\n\t\t\titems = me.options.contextMenu || [{\n\t\t\t\t\tlabel: lang['selectall'],\n\t\t\t\t\tcmdName: 'selectall'\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang.cleardoc,\n\t\t\t\t\tcmdName: 'cleardoc',\n\t\t\t\t\texec: function() {\n\t\t\t\t\t\tif (confirm(lang.confirmclear)) {\n\t\t\t\t\t\t\tthis.execCommand('cleardoc');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tlabel: lang.unlink,\n\t\t\t\t\tcmdName: 'unlink'\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tgroup: lang.paragraph,\n\t\t\t\t\ticon: 'justifyjustify',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tlabel: lang.justifyleft,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'left'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.justifyright,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'right'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.justifycenter,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'center'\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.justifyjustify,\n\t\t\t\t\t\tcmdName: 'justify',\n\t\t\t\t\t\tvalue: 'justify'\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tgroup: lang.table,\n\t\t\t\t\ticon: 'table',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tlabel: lang.inserttable,\n\t\t\t\t\t\t\tcmdName: 'inserttable'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletetable,\n\t\t\t\t\t\t\tcmdName: 'deletetable'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.deleterow,\n\t\t\t\t\t\t\tcmdName: 'deleterow'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletecol,\n\t\t\t\t\t\t\tcmdName: 'deletecol'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertcol,\n\t\t\t\t\t\t\tcmdName: 'insertcol'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertcolnext,\n\t\t\t\t\t\t\tcmdName: 'insertcolnext'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertrow,\n\t\t\t\t\t\t\tcmdName: 'insertrow'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.insertrownext,\n\t\t\t\t\t\t\tcmdName: 'insertrownext'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.insertcaption,\n\t\t\t\t\t\t\tcmdName: 'insertcaption'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletecaption,\n\t\t\t\t\t\t\tcmdName: 'deletecaption'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.inserttitle,\n\t\t\t\t\t\t\tcmdName: 'inserttitle'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletetitle,\n\t\t\t\t\t\t\tcmdName: 'deletetitle'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.inserttitlecol,\n\t\t\t\t\t\t\tcmdName: 'inserttitlecol'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.deletetitlecol,\n\t\t\t\t\t\t\tcmdName: 'deletetitlecol'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.mergecells,\n\t\t\t\t\t\t\tcmdName: 'mergecells'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.mergeright,\n\t\t\t\t\t\t\tcmdName: 'mergeright'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.mergedown,\n\t\t\t\t\t\t\tcmdName: 'mergedown'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.splittorows,\n\t\t\t\t\t\t\tcmdName: 'splittorows'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.splittocols,\n\t\t\t\t\t\t\tcmdName: 'splittocols'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.splittocells,\n\t\t\t\t\t\t\tcmdName: 'splittocells'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.averageDiseRow,\n\t\t\t\t\t\t\tcmdName: 'averagedistributerow'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.averageDisCol,\n\t\t\t\t\t\t\tcmdName: 'averagedistributecol'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.edittd,\n\t\t\t\t\t\t\tcmdName: 'edittd',\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tif (UE.ui['edittd']) {\n\t\t\t\t\t\t\t\t\tnew UE.ui['edittd'](this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.getDialog('edittd').open();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.edittable,\n\t\t\t\t\t\t\tcmdName: 'edittable',\n\t\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\t\tif (UE.ui['edittable']) {\n\t\t\t\t\t\t\t\t\tnew UE.ui['edittable'](this);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.getDialog('edittable').open();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.setbordervisible,\n\t\t\t\t\t\t\tcmdName: 'setbordervisible'\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.tablesort,\n\t\t\t\t\ticon: 'tablesort',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\t\tlabel: lang.enablesort,\n\t\t\t\t\t\t\tcmdName: 'enablesort'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.disablesort,\n\t\t\t\t\t\t\tcmdName: 'disablesort'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'-', {\n\t\t\t\t\t\t\tlabel: lang.reversecurrent,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'reversecurrent'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.orderbyasc,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'orderbyasc'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.reversebyasc,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'reversebyasc'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.orderbynum,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'orderbynum'\n\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\tlabel: lang.reversebynum,\n\t\t\t\t\t\t\tcmdName: 'sorttable',\n\t\t\t\t\t\t\tvalue: 'reversebynum'\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.borderbk,\n\t\t\t\t\ticon: 'borderBack',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tlabel: lang.setcolor,\n\t\t\t\t\t\tcmdName: \"interlacetable\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"interlacetable\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.unsetcolor,\n\t\t\t\t\t\tcmdName: \"uninterlacetable\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"uninterlacetable\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.setbackground,\n\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\tcolorList: [\"#bbb\", \"#ccc\"]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.unsetbackground,\n\t\t\t\t\t\tcmdName: \"cleartablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"cleartablebackground\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.redandblue,\n\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\tcolorList: [\"red\", \"blue\"]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: lang.threecolorgradient,\n\t\t\t\t\t\tcmdName: \"settablebackground\",\n\t\t\t\t\t\texec: function() {\n\t\t\t\t\t\t\tthis.execCommand(\"settablebackground\", {\n\t\t\t\t\t\t\t\trepeat: true,\n\t\t\t\t\t\t\t\tcolorList: [\"#aaa\", \"#bbb\", \"#ccc\"]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.aligntd,\n\t\t\t\t\ticon: 'aligntd',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tvAlign: 'top'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tvAlign: 'middle'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'cellalignment',\n\t\t\t\t\t\tvalue: {\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tvAlign: 'bottom'\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t}, {\n\t\t\t\t\tgroup: lang.aligntable,\n\t\t\t\t\ticon: 'aligntable',\n\t\t\t\t\tsubMenu: [{\n\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\tclassName: 'left',\n\t\t\t\t\t\tlabel: lang.tableleft,\n\t\t\t\t\t\tvalue: \"left\"\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\tclassName: 'center',\n\t\t\t\t\t\tlabel: lang.tablecenter,\n\t\t\t\t\t\tvalue: \"center\"\n\t\t\t\t\t}, {\n\t\t\t\t\t\tcmdName: 'tablealignment',\n\t\t\t\t\t\tclassName: 'right',\n\t\t\t\t\t\tlabel: lang.tableright,\n\t\t\t\t\t\tvalue: \"right\"\n\t\t\t\t\t}]\n\t\t\t\t},\n\t\t\t\t'-', {\n\t\t\t\t\tlabel: lang.insertparagraphbefore,\n\t\t\t\t\tcmdName: 'insertparagraph',\n\t\t\t\t\tvalue: true\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang.insertparagraphafter,\n\t\t\t\t\tcmdName: 'insertparagraph'\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang['copy'],\n\t\t\t\t\tcmdName: 'copy'\n\t\t\t\t}, {\n\t\t\t\t\tlabel: lang['paste'],\n\t\t\t\t\tcmdName: 'paste'\n\t\t\t\t}\n\t\t\t];\n\t\tif (!items.length) {\n\t\t\treturn;\n\t\t}\n\t\tvar uiUtils = UE.ui.uiUtils;\n\n\t\tme.addListener('contextmenu', function(type, evt) {\n\n\t\t\tvar offset = uiUtils.getViewportOffsetByEvent(evt);\n\t\t\tme.fireEvent('beforeselectionchange');\n\t\t\tif (menu) {\n\t\t\t\tmenu.destroy();\n\t\t\t}\n\t\t\tfor (var i = 0, ti, contextItems = []; ti = items[i]; i++) {\n\t\t\t\tvar last;\n\t\t\t\t(function(item) {\n\t\t\t\t\tif (item == '-') {\n\t\t\t\t\t\tif ((last = contextItems[contextItems.length - 1]) && last !== '-') {\n\t\t\t\t\t\t\tcontextItems.push('-');\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (item.hasOwnProperty(\"group\")) {\n\t\t\t\t\t\tfor (var j = 0, cj, subMenu = []; cj = item.subMenu[j]; j++) {\n\t\t\t\t\t\t\t(function(subItem) {\n\t\t\t\t\t\t\t\tif (subItem == '-') {\n\t\t\t\t\t\t\t\t\tif ((last = subMenu[subMenu.length - 1]) && last !== '-') {\n\t\t\t\t\t\t\t\t\t\tsubMenu.push('-');\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tsubMenu.splice(subMenu.length - 1);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif ((me.commands[subItem.cmdName] || UE.commands[subItem.cmdName] || subItem.query) &&\n\t\t\t\t\t\t\t\t\t\t(subItem.query ? subItem.query() : me.queryCommandState(subItem.cmdName)) > -1) {\n\t\t\t\t\t\t\t\t\t\tsubMenu.push({\n\t\t\t\t\t\t\t\t\t\t\t'label': subItem.label || me.getLang(\"contextMenu.\" + subItem.cmdName + (subItem.value || '')) || \"\",\n\t\t\t\t\t\t\t\t\t\t\t'className': 'edui-for-' + subItem.cmdName + (subItem.className ? (' edui-for-' + subItem.cmdName + '-' + subItem.className) : ''),\n\t\t\t\t\t\t\t\t\t\t\tonclick: subItem.exec ? function() {\n\t\t\t\t\t\t\t\t\t\t\t\tsubItem.exec.call(me);\n\t\t\t\t\t\t\t\t\t\t\t} : function() {\n\t\t\t\t\t\t\t\t\t\t\t\tme.execCommand(subItem.cmdName, subItem.value);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})(cj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (subMenu.length) {\n\t\t\t\t\t\t\tfunction getLabel() {\n\t\t\t\t\t\t\t\tswitch (item.icon) {\n\t\t\t\t\t\t\t\t\tcase \"table\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.table\");\n\t\t\t\t\t\t\t\t\tcase \"justifyjustify\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.paragraph\");\n\t\t\t\t\t\t\t\t\tcase \"aligntd\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.aligntd\");\n\t\t\t\t\t\t\t\t\tcase \"aligntable\":\n\t\t\t\t\t\t\t\t\t\treturn me.getLang(\"contextMenu.aligntable\");\n\t\t\t\t\t\t\t\t\tcase \"tablesort\":\n\t\t\t\t\t\t\t\t\t\treturn lang.tablesort;\n\t\t\t\t\t\t\t\t\tcase \"borderBack\":\n\t\t\t\t\t\t\t\t\t\treturn lang.borderbk;\n\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcontextItems.push({\n\t\t\t\t\t\t\t\t//todo 修正成自动获取方式\n\t\t\t\t\t\t\t\t'label': getLabel(),\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + item.icon,\n\t\t\t\t\t\t\t\t'subMenu': {\n\t\t\t\t\t\t\t\t\titems: subMenu,\n\t\t\t\t\t\t\t\t\teditor: me\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//有可能commmand没有加载右键不能出来，或者没有command也想能展示出来添加query方法\n\t\t\t\t\t\tif ((me.commands[item.cmdName] || UE.commands[item.cmdName] || item.query) &&\n\t\t\t\t\t\t\t(item.query ? item.query.call(me) : me.queryCommandState(item.cmdName)) > -1) {\n\n\t\t\t\t\t\t\tcontextItems.push({\n\t\t\t\t\t\t\t\t'label': item.label || me.getLang(\"contextMenu.\" + item.cmdName),\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + (item.icon ? item.icon : item.cmdName + (item.value || '')),\n\t\t\t\t\t\t\t\tonclick: item.exec ? function() {\n\t\t\t\t\t\t\t\t\titem.exec.call(me);\n\t\t\t\t\t\t\t\t} : function() {\n\t\t\t\t\t\t\t\t\tme.execCommand(item.cmdName, item.value);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t})(ti);\n\t\t\t}\n\t\t\tif (contextItems[contextItems.length - 1] == '-') {\n\t\t\t\tcontextItems.pop();\n\t\t\t}\n\n\t\t\tmenu = new UE.ui.Menu({\n\t\t\t\titems: contextItems,\n\t\t\t\tclassName: \"edui-contextmenu\",\n\t\t\t\teditor: me\n\t\t\t});\n\t\t\tmenu.render();\n\t\t\tmenu.showAt(offset);\n\n\t\t\tme.fireEvent(\"aftershowcontextmenu\", menu);\n\n\t\t\tdomUtils.preventDefault(evt);\n\t\t\tif (browser.ie) {\n\t\t\t\tvar ieRange;\n\t\t\t\ttry {\n\t\t\t\t\tieRange = me.selection.getNative().createRange();\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (ieRange.item) {\n\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\trange.selectNode(ieRange.item(0)).select(true, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// 添加复制的flash按钮\n\t\tme.addListener('aftershowcontextmenu', function(type, menu) {\n\t\t\tif (me.zeroclipboard) {\n\t\t\t\tvar items = menu.items;\n\t\t\t\tfor (var key in items) {\n\t\t\t\t\tif (items[key].className == 'edui-for-copy') {\n\t\t\t\t\t\tme.zeroclipboard.clip(items[key].getDom());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t};\n\n\t// plugins/shortcutmenu.js\n\t///import core\n\t///commands       弹出菜单\n\t// commandsName  popupmenu\n\t///commandsTitle  弹出菜单\n\t/**\n\t * 弹出菜单\n\t * @function\n\t * @name baidu.editor.plugins.popupmenu\n\t * @author xuheng\n\t */\n\n\tUE.plugins['shortcutmenu'] = function() {\n\t\tvar me = this,\n\t\t\tmenu,\n\t\t\titems = me.options.shortcutMenu || [];\n\n\t\tif (!items.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tme.addListener('contextmenu mouseup', function(type, e) {\n\t\t\tvar me = this,\n\t\t\t\tcustomEvt = {\n\t\t\t\t\ttype: type,\n\t\t\t\t\ttarget: e.target || e.srcElement,\n\t\t\t\t\tscreenX: e.screenX,\n\t\t\t\t\tscreenY: e.screenY,\n\t\t\t\t\tclientX: e.clientX,\n\t\t\t\t\tclientY: e.clientY\n\t\t\t\t};\n\n\t\t\tsetTimeout(function() {\n\t\t\t\tvar rng = me.selection.getRange();\n\t\t\t\tif (rng.collapsed === false || type == \"contextmenu\") {\n\n\t\t\t\t\tif (!menu) {\n\t\t\t\t\t\tmenu = new baidu.editor.ui.ShortCutMenu({\n\t\t\t\t\t\t\teditor: me,\n\t\t\t\t\t\t\titems: items,\n\t\t\t\t\t\t\ttheme: me.options.theme,\n\t\t\t\t\t\t\tclassName: 'edui-shortcutmenu'\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tmenu.render();\n\t\t\t\t\t\tme.fireEvent(\"afterrendershortcutmenu\", menu);\n\t\t\t\t\t}\n\n\t\t\t\t\tmenu.show(customEvt, !!UE.plugins['contextmenu']);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (type == 'contextmenu') {\n\t\t\t\tdomUtils.preventDefault(e);\n\t\t\t\tif (browser.ie9below) {\n\t\t\t\t\tvar ieRange;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tieRange = me.selection.getNative().createRange();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (ieRange.item) {\n\t\t\t\t\t\tvar range = new dom.Range(me.document);\n\t\t\t\t\t\trange.selectNode(ieRange.item(0)).select(true, true);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tme.addListener('keydown', function(type) {\n\t\t\tif (type == \"keydown\") {\n\t\t\t\tmenu && !menu.isHidden && menu.hide();\n\t\t\t}\n\n\t\t});\n\n\t};\n\n\t// plugins/basestyle.js\n\t/**\n\t * B、I、sub、super命令支持\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\tUE.plugins['basestyle'] = function() {\n\n\t\t/**\n\t\t * 字体加粗\n\t\t * @command bold\n\t\t * @param { String } cmd 命令字符串\n\t\t * @remind 对已加粗的文本内容执行该命令， 将取消加粗\n\t\t * @method execCommand\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行加粗操作\n\t\t * //第一次执行， 文本内容加粗\n\t\t * editor.execCommand( 'bold' );\n\t\t *\n\t\t * //第二次执行， 文本内容取消加粗\n\t\t * editor.execCommand( 'bold' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 字体倾斜\n\t\t * @command italic\n\t\t * @method execCommand\n\t\t * @param { String } cmd 命令字符串\n\t\t * @remind 对已倾斜的文本内容执行该命令， 将取消倾斜\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行斜体操作\n\t\t * //第一次操作， 文本内容将变成斜体\n\t\t * editor.execCommand( 'italic' );\n\t\t *\n\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t * editor.execCommand( 'italic' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 下标文本，与“superscript”命令互斥\n\t\t * @command subscript\n\t\t * @method execCommand\n\t\t * @remind  把选中的文本内容切换成下标文本， 如果当前选中的文本已经是下标， 则该操作会把文本内容还原成正常文本\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行下标操作\n\t\t * //第一次操作， 文本内容将变成下标文本\n\t\t * editor.execCommand( 'subscript' );\n\t\t *\n\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t * editor.execCommand( 'subscript' );\n\t\t * ```\n\t\t */\n\n\t\t/**\n\t\t * 上标文本，与“subscript”命令互斥\n\t\t * @command superscript\n\t\t * @method execCommand\n\t\t * @remind 把选中的文本内容切换成上标文本， 如果当前选中的文本已经是上标， 则该操作会把文本内容还原成正常文本\n\t\t * @param { String } cmd 命令字符串\n\t\t * @example\n\t\t * ```javascript\n\t\t * //editor是编辑器实例\n\t\t * //对当前选中的文本内容执行上标操作\n\t\t * //第一次操作， 文本内容将变成上标文本\n\t\t * editor.execCommand( 'superscript' );\n\t\t *\n\t\t * //再次对同一文本内容执行， 则文本内容将恢复正常\n\t\t * editor.execCommand( 'superscript' );\n\t\t * ```\n\t\t */\n\t\tvar basestyles = {\n\t\t\t\t'bold': ['strong', 'b'],\n\t\t\t\t'italic': ['em', 'i'],\n\t\t\t\t'subscript': ['sub'],\n\t\t\t\t'superscript': ['sup'],\n\t\t\t\t'underline':['u']\n\t\t\t},\n\t\t\tgetObj = function(editor, tagNames) {\n\t\t\t\treturn domUtils.filterNodeList(editor.selection.getStartElementPath(), tagNames);\n\t\t\t},\n\t\t\tme = this;\n\t\t//添加快捷键\n\t\tme.addshortcutkey({\n\t\t\t\"Bold\": \"ctrl+66\", //^B\n\t\t\t\"Italic\": \"ctrl+73\", //^I\n\t\t\t\"Underline\": \"ctrl+85\" //^U\n\t\t});\n\t\tme.addInputRule(function(root) {\n\t\t\tutils.each(root.getNodesByTagName('b i'), function(node) {\n\t\t\t\tswitch (node.tagName) {\n\t\t\t\t\tcase 'b':\n\t\t\t\t\t\tnode.tagName = 'strong';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'i':\n\t\t\t\t\t\tnode.tagName = 'em';\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t\tfor (var style in basestyles) {\n\t\t\t(function(cmd, tagNames) {\n\t\t\t\tme.commands[cmd] = {\n\t\t\t\t\texecCommand: function(cmdName) {\n\t\t\t\t\t\tvar range = me.selection.getRange(),\n\t\t\t\t\t\t\tobj = getObj(this, tagNames);\n\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\tif (obj) {\n\t\t\t\t\t\t\t\tvar tmpText = me.document.createTextNode('');\n\t\t\t\t\t\t\t\trange.insertNode(tmpText).removeInlineStyle(tagNames);\n\t\t\t\t\t\t\t\trange.setStartBefore(tmpText);\n\t\t\t\t\t\t\t\tdomUtils.remove(tmpText);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar tmpNode = range.document.createElement(tagNames[0]);\n\t\t\t\t\t\t\t\tif (cmdName == 'superscript' || cmdName == 'subscript') {\n\t\t\t\t\t\t\t\t\ttmpText = me.document.createTextNode('');\n\t\t\t\t\t\t\t\t\trange.insertNode(tmpText)\n\t\t\t\t\t\t\t\t\t\t.removeInlineStyle(['sub', 'sup'])\n\t\t\t\t\t\t\t\t\t\t.setStartBefore(tmpText)\n\t\t\t\t\t\t\t\t\t\t.collapse(true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trange.insertNode(tmpNode).setStart(tmpNode, 0);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trange.collapse(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (cmdName == 'superscript' || cmdName == 'subscript') {\n\t\t\t\t\t\t\t\tif (!obj || obj.tagName.toLowerCase() != cmdName) {\n\t\t\t\t\t\t\t\t\trange.removeInlineStyle(['sub', 'sup']);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tobj ? range.removeInlineStyle(tagNames) : range.applyInlineStyle(tagNames[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\trange.select();\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn getObj(this, tagNames) ? 1 : 0;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t})(style, basestyles[style]);\n\t\t}\n\t};\n\n\t// plugins/elementpath.js\n\t/**\n\t * 选取路径命令\n\t * @file\n\t */\n\tUE.plugins['elementpath'] = function() {\n\t\tvar currentLevel,\n\t\t\ttagNames,\n\t\t\tme = this;\n\t\tme.setOpt('elementPathEnabled', true);\n\t\tif (!me.options.elementPathEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tme.commands['elementpath'] = {\n\t\t\texecCommand: function(cmdName, level) {\n\t\t\t\tvar start = tagNames[level],\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\tcurrentLevel = level * 1;\n\t\t\t\trange.selectNode(start).select();\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\t//产生一个副本，不能修改原来的startElementPath;\n\t\t\t\tvar parents = [].concat(this.selection.getStartElementPath()).reverse(),\n\t\t\t\t\tnames = [];\n\t\t\t\ttagNames = parents;\n\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\tif (ci.nodeType == 3) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tvar name = ci.tagName.toLowerCase();\n\t\t\t\t\tif (name == 'img' && ci.getAttribute('anchorname')) {\n\t\t\t\t\t\tname = 'anchor';\n\t\t\t\t\t}\n\t\t\t\t\tnames[i] = name;\n\t\t\t\t\tif (currentLevel == i) {\n\t\t\t\t\t\tcurrentLevel = -1;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn names;\n\t\t\t}\n\t\t};\n\t};\n\n\t// plugins/formatmatch.js\n\t/**\n\t * 格式刷，只格式inline的\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 格式刷\n\t * @command formatmatch\n\t * @method execCommand\n\t * @remind 该操作不能复制段落格式\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * //editor是编辑器实例\n\t * //获取格式刷\n\t * editor.execCommand( 'formatmatch' );\n\t * ```\n\t */\n\tUE.plugins['formatmatch'] = function() {\n\n\t\tvar me = this,\n\t\t\tlist = [],\n\t\t\timg,\n\t\t\tflag = 0;\n\n\t\tme.addListener('reset', function() {\n\t\t\tlist = [];\n\t\t\tflag = 0;\n\t\t});\n\n\t\tfunction addList(type, evt) {\n\n\t\t\tif (browser.webkit) {\n\t\t\t\tvar target = evt.target.tagName == 'IMG' ? evt.target : null;\n\t\t\t}\n\n\t\t\tfunction addFormat(range) {\n\n\t\t\t\tif (text) {\n\t\t\t\t\trange.selectNode(text);\n\t\t\t\t}\n\t\t\t\treturn range.applyInlineStyle(list[list.length - 1].tagName, null, list);\n\n\t\t\t}\n\n\t\t\tme.undoManger && me.undoManger.save();\n\n\t\t\tvar range = me.selection.getRange(),\n\t\t\t\timgT = target || range.getClosedNode();\n\t\t\tif (img && imgT && imgT.tagName == 'IMG') {\n\t\t\t\t//trace:964\n\n\t\t\t\timgT.style.cssText += ';float:' + (img.style.cssFloat || img.style.styleFloat || 'none') + ';display:' + (img.style.display || 'inline');\n\n\t\t\t\timg = null;\n\t\t\t} else {\n\t\t\t\tif (!img) {\n\t\t\t\t\tvar collapsed = range.collapsed;\n\t\t\t\t\tif (collapsed) {\n\t\t\t\t\t\tvar text = me.document.createTextNode('match');\n\t\t\t\t\t\trange.insertNode(text).select();\n\n\t\t\t\t\t}\n\t\t\t\t\tme.__hasEnterExecCommand = true;\n\t\t\t\t\t//不能把block上的属性干掉\n\t\t\t\t\t//trace:1553\n\t\t\t\t\tvar removeFormatAttributes = me.options.removeFormatAttributes;\n\t\t\t\t\tme.options.removeFormatAttributes = '';\n\t\t\t\t\tme.execCommand('removeformat');\n\t\t\t\t\tme.options.removeFormatAttributes = removeFormatAttributes;\n\t\t\t\t\tme.__hasEnterExecCommand = false;\n\t\t\t\t\t//trace:969\n\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (list.length) {\n\t\t\t\t\t\taddFormat(range);\n\t\t\t\t\t}\n\t\t\t\t\tif (text) {\n\t\t\t\t\t\trange.setStartBefore(text).collapse(true);\n\n\t\t\t\t\t}\n\t\t\t\t\trange.select();\n\t\t\t\t\ttext && domUtils.remove(text);\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tme.undoManger && me.undoManger.save();\n\t\t\tme.removeListener('mouseup', addList);\n\t\t\tflag = 0;\n\t\t}\n\n\t\tme.commands['formatmatch'] = {\n\t\t\texecCommand: function(cmdName) {\n\n\t\t\t\tif (flag) {\n\t\t\t\t\tflag = 0;\n\t\t\t\t\tlist = [];\n\t\t\t\t\tme.removeListener('mouseup', addList);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\timg = range.getClosedNode();\n\t\t\t\tif (!img || img.tagName != 'IMG') {\n\t\t\t\t\trange.collapse(true).shrinkBoundary();\n\t\t\t\t\tvar start = range.startContainer;\n\t\t\t\t\tlist = domUtils.findParents(start, true, function(node) {\n\t\t\t\t\t\treturn !domUtils.isBlockElm(node) && node.nodeType == 1;\n\t\t\t\t\t});\n\t\t\t\t\t//a不能加入格式刷, 并且克隆节点\n\t\t\t\t\tfor (var i = 0, ci; ci = list[i]; i++) {\n\t\t\t\t\t\tif (ci.tagName == 'A') {\n\t\t\t\t\t\t\tlist.splice(i, 1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tme.addListener('mouseup', addList);\n\t\t\t\tflag = 1;\n\n\t\t\t},\n\t\t\tqueryCommandState: function() {\n\t\t\t\treturn flag;\n\t\t\t},\n\t\t\tnotNeedUndo: 1\n\t\t};\n\t};\n\n\t// plugins/searchreplace.js\n\t///import core\n\t///commands 查找替换\n\t///commandsName  SearchReplace\n\t///commandsTitle  查询替换\n\t///commandsDialog  dialogs\\searchreplace\n\t/**\n\t * @description 查找替换\n\t * @author zhanyi\n\t */\n\n\tUE.plugin.register('searchreplace', function() {\n\t\tvar me = this;\n\n\t\tvar _blockElm = {\n\t\t\t'table': 1,\n\t\t\t'tbody': 1,\n\t\t\t'tr': 1,\n\t\t\t'ol': 1,\n\t\t\t'ul': 1\n\t\t};\n\n\t\tfunction findTextInString(textContent, opt, currentIndex) {\n\t\t\tvar str = opt.searchStr;\n\t\t\tif (opt.dir == -1) {\n\t\t\t\ttextContent = textContent.split('').reverse().join('');\n\t\t\t\tstr = str.split('').reverse().join('');\n\t\t\t\tcurrentIndex = textContent.length - currentIndex;\n\n\t\t\t}\n\t\t\tvar reg = new RegExp(str, 'g' + (opt.casesensitive ? '' : 'i')),\n\t\t\t\tmatch;\n\n\t\t\twhile (match = reg.exec(textContent)) {\n\t\t\t\tif (match.index >= currentIndex) {\n\t\t\t\t\treturn opt.dir == -1 ? textContent.length - match.index - opt.searchStr.length : match.index;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn -1\n\t\t}\n\n\t\tfunction findTextBlockElm(node, currentIndex, opt) {\n\t\t\tvar textContent, index, methodName = opt.all || opt.dir == 1 ? 'getNextDomNode' : 'getPreDomNode';\n\t\t\tif (domUtils.isBody(node)) {\n\t\t\t\tnode = node.firstChild;\n\t\t\t}\n\t\t\tvar first = 1;\n\t\t\twhile (node) {\n\t\t\t\ttextContent = node.nodeType == 3 ? node.nodeValue : node[browser.ie ? 'innerText' : 'textContent'];\n\t\t\t\tindex = findTextInString(textContent, opt, currentIndex);\n\t\t\t\tfirst = 0;\n\t\t\t\tif (index != -1) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t'node': node,\n\t\t\t\t\t\t'index': index\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tnode = domUtils[methodName](node);\n\t\t\t\twhile (node && _blockElm[node.nodeName.toLowerCase()]) {\n\t\t\t\t\tnode = domUtils[methodName](node, true);\n\t\t\t\t}\n\t\t\t\tif (node) {\n\t\t\t\t\tcurrentIndex = opt.dir == -1 ? (node.nodeType == 3 ? node.nodeValue : node[browser.ie ? 'innerText' : 'textContent']).length : 0;\n\t\t\t\t}\n\n\t\t\t}\n\t\t}\n\n\t\tfunction findNTextInBlockElm(node, index, str) {\n\t\t\tvar currentIndex = 0,\n\t\t\t\tcurrentNode = node.firstChild,\n\t\t\t\tcurrentNodeLength = 0,\n\t\t\t\tresult;\n\t\t\twhile (currentNode) {\n\t\t\t\tif (currentNode.nodeType == 3) {\n\t\t\t\t\tcurrentNodeLength = currentNode.nodeValue.replace(/(^[\\t\\r\\n]+)|([\\t\\r\\n]+$)/, '').length;\n\t\t\t\t\tcurrentIndex += currentNodeLength;\n\t\t\t\t\tif (currentIndex >= index) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t'node': currentNode,\n\t\t\t\t\t\t\t'index': currentNodeLength - (currentIndex - index)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (!dtd.$empty[currentNode.tagName]) {\n\t\t\t\t\tcurrentNodeLength = currentNode[browser.ie ? 'innerText' : 'textContent'].replace(/(^[\\t\\r\\n]+)|([\\t\\r\\n]+$)/, '').length\n\t\t\t\t\tcurrentIndex += currentNodeLength;\n\t\t\t\t\tif (currentIndex >= index) {\n\t\t\t\t\t\tresult = findNTextInBlockElm(currentNode, currentNodeLength - (currentIndex - index), str);\n\t\t\t\t\t\tif (result) {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcurrentNode = domUtils.getNextDomNode(currentNode);\n\n\t\t\t}\n\t\t}\n\n\t\tfunction searchReplace(me, opt) {\n\n\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\tstartBlockNode,\n\t\t\t\tsearchStr = opt.searchStr,\n\t\t\t\tspan = me.document.createElement('span');\n\t\t\tspan.innerHTML = '$$ueditor_searchreplace_key$$';\n\n\t\t\trng.shrinkBoundary(true);\n\n\t\t\t//判断是不是第一次选中\n\t\t\tif (!rng.collapsed) {\n\t\t\t\trng.select();\n\t\t\t\tvar rngText = me.selection.getText();\n\t\t\t\tif (new RegExp('^' + opt.searchStr + '$', (opt.casesensitive ? '' : 'i')).test(rngText)) {\n\t\t\t\t\tif (opt.replaceStr != undefined) {\n\t\t\t\t\t\treplaceText(rng, opt.replaceStr);\n\t\t\t\t\t\trng.select();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trng.collapse(opt.dir == -1)\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trng.insertNode(span);\n\t\t\trng.enlargeToBlockElm(true);\n\t\t\tstartBlockNode = rng.startContainer;\n\t\t\tvar currentIndex = startBlockNode[browser.ie ? 'innerText' : 'textContent'].indexOf('$$ueditor_searchreplace_key$$');\n\t\t\trng.setStartBefore(span);\n\t\t\tdomUtils.remove(span);\n\t\t\tvar result = findTextBlockElm(startBlockNode, currentIndex, opt);\n\t\t\tif (result) {\n\t\t\t\tvar rngStart = findNTextInBlockElm(result.node, result.index, searchStr);\n\t\t\t\tvar rngEnd = findNTextInBlockElm(result.node, result.index + searchStr.length, searchStr);\n\t\t\t\trng.setStart(rngStart.node, rngStart.index).setEnd(rngEnd.node, rngEnd.index);\n\n\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\treplaceText(rng, opt.replaceStr)\n\t\t\t\t}\n\t\t\t\trng.select();\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\trng.setCursor()\n\t\t\t}\n\n\t\t}\n\n\t\tfunction replaceText(rng, str) {\n\n\t\t\tstr = me.document.createTextNode(str);\n\t\t\trng.deleteContents().insertNode(str);\n\n\t\t}\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t'searchreplace': {\n\t\t\t\t\texecCommand: function(cmdName, opt) {\n\t\t\t\t\t\tutils.extend(opt, {\n\t\t\t\t\t\t\tall: false,\n\t\t\t\t\t\t\tcasesensitive: false,\n\t\t\t\t\t\t\tdir: 1\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tvar num = 0;\n\t\t\t\t\t\tif (opt.all) {\n\n\t\t\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\t\t\tfirst = me.body.firstChild;\n\t\t\t\t\t\t\tif (first && first.nodeType == 1) {\n\t\t\t\t\t\t\t\trng.setStart(first, 0);\n\t\t\t\t\t\t\t\trng.shrinkBoundary(true);\n\t\t\t\t\t\t\t} else if (first.nodeType == 3) {\n\t\t\t\t\t\t\t\trng.setStartBefore(first)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\trng.collapse(true).select(true);\n\t\t\t\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twhile (searchReplace(this, opt)) {\n\t\t\t\t\t\t\t\tnum++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (num) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (opt.replaceStr !== undefined) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (searchReplace(this, opt)) {\n\t\t\t\t\t\t\t\tnum++\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (num) {\n\t\t\t\t\t\t\t\tme.fireEvent('saveScene');\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn num;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: 1\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/customstyle.js\n\t/**\n\t * 自定义样式\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 根据config配置文件里“customstyle”选项的值对匹配的标签执行样式替换。\n\t * @command customstyle\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * editor.execCommand( 'customstyle' );\n\t * ```\n\t */\n\tUE.plugins['customstyle'] = function() {\n\t\tvar me = this;\n\t\tme.setOpt({\n\t\t\t'customstyle': [{\n\t\t\t\ttag: 'h1',\n\t\t\t\tname: 'tc',\n\t\t\t\tstyle: 'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;'\n\t\t\t}, {\n\t\t\t\ttag: 'h1',\n\t\t\t\tname: 'tl',\n\t\t\t\tstyle: 'font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;'\n\t\t\t}, {\n\t\t\t\ttag: 'span',\n\t\t\t\tname: 'im',\n\t\t\t\tstyle: 'font-size:16px;font-style:italic;font-weight:bold;line-height:18px;'\n\t\t\t}, {\n\t\t\t\ttag: 'span',\n\t\t\t\tname: 'hi',\n\t\t\t\tstyle: 'font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;'\n\t\t\t}]\n\t\t});\n\t\tme.commands['customstyle'] = {\n\t\t\texecCommand: function(cmdName, obj) {\n\t\t\t\tvar me = this,\n\t\t\t\t\ttagName = obj.tag,\n\t\t\t\t\tnode = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\treturn node.getAttribute('label');\n\t\t\t\t\t}, true),\n\t\t\t\t\trange, bk, tmpObj = {};\n\t\t\t\tfor (var p in obj) {\n\t\t\t\t\tif (obj[p] !== undefined)\n\t\t\t\t\t\ttmpObj[p] = obj[p];\n\t\t\t\t}\n\t\t\t\tdelete tmpObj.tag;\n\t\t\t\tif (node && node.getAttribute('label') == obj.label) {\n\t\t\t\t\trange = this.selection.getRange();\n\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t//trace:1732 删掉自定义标签，要有p来回填站位\n\t\t\t\t\t\tif (dtd.$block[node.tagName]) {\n\t\t\t\t\t\t\tvar fillNode = me.document.createElement('p');\n\t\t\t\t\t\t\tdomUtils.moveChild(node, fillNode);\n\t\t\t\t\t\t\tnode.parentNode.insertBefore(fillNode, node);\n\t\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.remove(node, true);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tvar common = domUtils.getCommonAncestor(bk.start, bk.end),\n\t\t\t\t\t\t\tnodes = domUtils.getElementsByTagName(common, tagName);\n\t\t\t\t\t\tif (new RegExp(tagName, 'i').test(common.tagName)) {\n\t\t\t\t\t\t\tnodes.push(common);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ni; ni = nodes[i++];) {\n\t\t\t\t\t\t\tif (ni.getAttribute('label') == obj.label) {\n\t\t\t\t\t\t\t\tvar ps = domUtils.getPosition(ni, bk.start),\n\t\t\t\t\t\t\t\t\tpe = domUtils.getPosition(ni, bk.end);\n\t\t\t\t\t\t\t\tif ((ps & domUtils.POSITION_FOLLOWING || ps & domUtils.POSITION_CONTAINS) &&\n\t\t\t\t\t\t\t\t\t(pe & domUtils.POSITION_PRECEDING || pe & domUtils.POSITION_CONTAINS)\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\tif (dtd.$block[tagName]) {\n\t\t\t\t\t\t\t\t\t\tvar fillNode = me.document.createElement('p');\n\t\t\t\t\t\t\t\t\t\tdomUtils.moveChild(ni, fillNode);\n\t\t\t\t\t\t\t\t\t\tni.parentNode.insertBefore(fillNode, ni);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdomUtils.remove(ni, true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnode = domUtils.findParent(common, function(node) {\n\t\t\t\t\t\t\treturn node.getAttribute('label') == obj.label;\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tif (node) {\n\n\t\t\t\t\t\t\tdomUtils.remove(node, true);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t\trange.moveToBookmark(bk).select();\n\t\t\t\t} else {\n\t\t\t\t\tif (dtd.$block[tagName]) {\n\t\t\t\t\t\tthis.execCommand('paragraph', tagName, tmpObj, 'customstyle');\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\tif (!range.collapsed) {\n\t\t\t\t\t\t\trange.collapse();\n\t\t\t\t\t\t\tnode = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\t\t\treturn node.getAttribute('label') == obj.label;\n\t\t\t\t\t\t\t}, true);\n\t\t\t\t\t\t\tvar pNode = me.document.createElement('p');\n\t\t\t\t\t\t\tdomUtils.insertAfter(node, pNode);\n\t\t\t\t\t\t\tdomUtils.fillNode(me.document, pNode);\n\t\t\t\t\t\t\trange.setStart(pNode, 0).setCursor();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\t\tif (range.collapsed) {\n\t\t\t\t\t\t\tnode = me.document.createElement(tagName);\n\t\t\t\t\t\t\tdomUtils.setAttributes(node, tmpObj);\n\t\t\t\t\t\t\trange.insertNode(node).setStart(node, 0).setCursor();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbk = range.createBookmark();\n\t\t\t\t\t\trange.applyInlineStyle(tagName, tmpObj).moveToBookmark(bk).select();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tqueryCommandValue: function() {\n\t\t\t\tvar parent = domUtils.filterNodeList(\n\t\t\t\t\tthis.selection.getStartElementPath(),\n\t\t\t\t\tfunction(node) {\n\t\t\t\t\t\treturn node.getAttribute('label')\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treturn parent ? parent.getAttribute('label') : '';\n\t\t\t}\n\t\t};\n\t\t//当去掉customstyle是，如果是块元素，用p代替\n\t\tme.addListener('keyup', function(type, evt) {\n\t\t\tvar keyCode = evt.keyCode || evt.which;\n\n\t\t\tif (keyCode == 32 || keyCode == 13) {\n\t\t\t\tvar range = me.selection.getRange();\n\t\t\t\tif (range.collapsed) {\n\t\t\t\t\tvar node = domUtils.findParent(me.selection.getStart(), function(node) {\n\t\t\t\t\t\treturn node.getAttribute('label');\n\t\t\t\t\t}, true);\n\t\t\t\t\tif (node && dtd.$block[node.tagName] && domUtils.isEmptyNode(node)) {\n\t\t\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\t\t\tdomUtils.insertAfter(node, p);\n\t\t\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\t\t\tdomUtils.remove(node);\n\t\t\t\t\t\trange.setStart(p, 0).setCursor();\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/catchremoteimage.js\n\t///import core\n\t///commands 远程图片抓取\n\t///commandsName  catchRemoteImage,catchremoteimageenable\n\t///commandsTitle  远程图片抓取\n\t/**\n\t * 远程图片抓取,当开启本插件时所有不符合本地域名的图片都将被抓取成为本地服务器上的图片\n\t */\n\tUE.plugins['catchremoteimage'] = function() {\n\t\tvar me = this,\n\t\t\tajax = UE.ajax;\n\n\t\t/* 设置默认值 */\n\t\tif (me.options.catchRemoteImageEnable === false) return;\n\t\tme.setOpt({\n\t\t\tcatchRemoteImageEnable: false\n\t\t});\n\n\t\tme.addListener(\"afterpaste\", function() {\n\t\t\tme.fireEvent(\"catchRemoteImage\");\n\t\t});\n\n\t\tme.addListener(\"catchRemoteImage\", function() {\n\t\t\treturn;\n\t\t\tvar catcherLocalDomain = me.getOpt('catcherLocalDomain'),\n\t\t\t\tcatcherActionUrl = me.getActionUrl(me.getOpt('catcherActionName')),\n\t\t\t\tcatcherUrlPrefix = me.getOpt('catcherUrlPrefix'),\n\t\t\t\tcatcherFieldName = me.getOpt('catcherFieldName');\n\n\t\t\tvar remoteImages = [],\n\t\t\t\timgs = domUtils.getElementsByTagName(me.document, \"img\"),\n\t\t\t\ttest = function(src, urls) {\n\t\t\t\t\tif (src.indexOf(location.host) != -1 || /(^\\.)|(^\\/)/.test(src)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\tif (urls) {\n\t\t\t\t\t\tfor (var j = 0, url; url = urls[j++];) {\n\t\t\t\t\t\t\tif (src.indexOf(url) !== -1) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\n\t\t\tfor (var i = 0, ci; ci = imgs[i++];) {\n\t\t\t\tif (ci.getAttribute(\"word_img\")) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tvar src = ci.getAttribute(\"_src\") || ci.src || \"\";\n\t\t\t\tif (/^(https?|ftp):/i.test(src) && !test(src, catcherLocalDomain)) {\n\t\t\t\t\tremoteImages.push(src);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (remoteImages.length) {\n\t\t\t\tcatchremoteimage(remoteImages, {\n\t\t\t\t\t//成功抓取\n\t\t\t\t\tsuccess: function(r) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar info = r.state !== undefined ? r : eval(\"(\" + r.responseText + \")\");\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t/* 获取源路径和新路径 */\n\t\t\t\t\t\tvar i, j, ci, cj, oldSrc, newSrc, list = info.list;\n\n\t\t\t\t\t\tfor (i = 0; ci = imgs[i++];) {\n\t\t\t\t\t\t\toldSrc = ci.getAttribute(\"_src\") || ci.src || \"\";\n\t\t\t\t\t\t\tfor (j = 0; cj = list[j++];) {\n\t\t\t\t\t\t\t\tif (oldSrc == cj.source && cj.state == \"SUCCESS\") { //抓取失败时不做替换处理\n\t\t\t\t\t\t\t\t\tnewSrc = catcherUrlPrefix + cj.url;\n\t\t\t\t\t\t\t\t\tdomUtils.setAttributes(ci, {\n\t\t\t\t\t\t\t\t\t\t\"src\": newSrc,\n\t\t\t\t\t\t\t\t\t\t\"_src\": newSrc\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.fireEvent('catchremotesuccess')\n\t\t\t\t\t},\n\t\t\t\t\t//回调失败，本次请求超时\n\t\t\t\t\terror: function() {\n\t\t\t\t\t\tme.fireEvent(\"catchremoteerror\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tfunction catchremoteimage(imgs, callbacks) {\n\t\t\t\tvar params = utils.serializeParam(me.queryCommandValue('serverparam')) || '',\n\t\t\t\t\turl = utils.formatUrl(catcherActionUrl + (catcherActionUrl.indexOf('?') == -1 ? '?' : '&') + params),\n\t\t\t\t\tisJsonp = utils.isCrossDomainUrl(url),\n\t\t\t\t\topt = {\n\t\t\t\t\t\t'method': 'POST',\n\t\t\t\t\t\t'dataType': isJsonp ? 'jsonp' : '',\n\t\t\t\t\t\t'timeout': 60000, //单位：毫秒，回调请求超时设置。目标用户如果网速不是很快的话此处建议设置一个较大的数值\n\t\t\t\t\t\t'onsuccess': callbacks[\"success\"],\n\t\t\t\t\t\t'onerror': callbacks[\"error\"]\n\t\t\t\t\t};\n\t\t\t\topt[catcherFieldName] = imgs;\n\t\t\t\tajax.request(url, opt);\n\t\t\t}\n\n\t\t});\n\t};\n\n\t// plugins/snapscreen.js\n\t/**\n\t * 截屏插件，为UEditor提供插入支持\n\t * @file\n\t * @since 1.4.2\n\t */\n\tUE.plugin.register('snapscreen', function() {\n\n\t\tvar me = this;\n\t\tvar snapplugin;\n\n\t\tfunction getLocation(url) {\n\t\t\tvar search,\n\t\t\t\ta = document.createElement('a'),\n\t\t\t\tparams = utils.serializeParam(me.queryCommandValue('serverparam')) || '';\n\n\t\t\ta.href = url;\n\t\t\tif (browser.ie) {\n\t\t\t\ta.href = a.href;\n\t\t\t}\n\n\t\t\tsearch = a.search;\n\t\t\tif (params) {\n\t\t\t\tsearch = search + (search.indexOf('?') == -1 ? '?' : '&') + params;\n\t\t\t\tsearch = search.replace(/[&]+/ig, '&');\n\t\t\t}\n\t\t\treturn {\n\t\t\t\t'port': a.port,\n\t\t\t\t'hostname': a.hostname,\n\t\t\t\t'path': a.pathname + search || +a.hash\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 字体背景颜色\n\t\t\t\t * @command snapscreen\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('snapscreen');\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'snapscreen': {\n\t\t\t\t\texecCommand: function(cmd) {\n\t\t\t\t\t\tvar url, local, res;\n\t\t\t\t\t\tvar lang = me.getLang(\"snapScreen_plugin\");\n\n\t\t\t\t\t\tif (!snapplugin) {\n\t\t\t\t\t\t\tvar container = me.container;\n\t\t\t\t\t\t\tvar doc = me.container.ownerDocument || me.container.document;\n\t\t\t\t\t\t\tsnapplugin = doc.createElement(\"object\");\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tsnapplugin.type = \"application/x-pluginbaidusnap\";\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsnapplugin.style.cssText = \"position:absolute;left:-9999px;width:0;height:0;\";\n\t\t\t\t\t\t\tsnapplugin.setAttribute(\"width\", \"0\");\n\t\t\t\t\t\t\tsnapplugin.setAttribute(\"height\", \"0\");\n\t\t\t\t\t\t\tcontainer.appendChild(snapplugin);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfunction onSuccess(rs) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\trs = eval(\"(\" + rs + \")\");\n\t\t\t\t\t\t\t\tif (rs.state == 'SUCCESS') {\n\t\t\t\t\t\t\t\t\tvar opt = me.options;\n\t\t\t\t\t\t\t\t\tme.execCommand('insertimage', {\n\t\t\t\t\t\t\t\t\t\tsrc: opt.snapscreenUrlPrefix + rs.url,\n\t\t\t\t\t\t\t\t\t\t_src: opt.snapscreenUrlPrefix + rs.url,\n\t\t\t\t\t\t\t\t\t\talt: rs.title || '',\n\t\t\t\t\t\t\t\t\t\tfloatStyle: opt.snapscreenImgAlign\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\talert(rs.state);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\talert(lang.callBackErrorMsg);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdebugger;\n\t\t\t\t\t\turl = me.getActionUrl(me.getOpt('snapscreenActionName'));\n\t\t\t\t\t\tlocal = getLocation(url);\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tres = snapplugin.saveSnapshot(local.hostname, local.path, local.port);\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tme.ui._dialogs['snapscreenDialog'].open();\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tonSuccess(res);\n\t\t\t\t\t\t}, 50);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn (navigator.userAgent.indexOf(\"Windows\", 0) != -1) ? 0 : -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/insertparagraph.js\n\t/**\n\t * 插入段落\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入段落\n\t * @command insertparagraph\n\t * @method execCommand\n\t * @param { String } cmd 命令字符串\n\t * @example\n\t * ```javascript\n\t * //editor是编辑器实例\n\t * editor.execCommand( 'insertparagraph' );\n\t * ```\n\t */\n\n\tUE.commands['insertparagraph'] = {\n\t\texecCommand: function(cmdName, front) {\n\t\t\tvar me = this,\n\t\t\t\trange = me.selection.getRange(),\n\t\t\t\tstart = range.startContainer,\n\t\t\t\ttmpNode;\n\t\t\twhile (start) {\n\t\t\t\tif (domUtils.isBody(start)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\ttmpNode = start;\n\t\t\t\tstart = start.parentNode;\n\t\t\t}\n\t\t\tif (tmpNode) {\n\t\t\t\tvar p = me.document.createElement('p');\n\t\t\t\tif (front) {\n\t\t\t\t\ttmpNode.parentNode.insertBefore(p, tmpNode)\n\t\t\t\t} else {\n\t\t\t\t\ttmpNode.parentNode.insertBefore(p, tmpNode.nextSibling)\n\t\t\t\t}\n\t\t\t\tdomUtils.fillNode(me.document, p);\n\t\t\t\trange.setStart(p, 0).setCursor(false, true);\n\t\t\t}\n\t\t}\n\t};\n\n\t// plugins/webapp.js\n\t/**\n\t * 百度应用\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\n\t/**\n\t * 插入百度应用\n\t * @command webapp\n\t * @method execCommand\n\t * @remind 需要百度APPKey\n\t * @remind 百度应用主页： <a href=\"http://app.baidu.com/\" target=\"_blank\">http://app.baidu.com/</a>\n\t * @param { Object } appOptions 应用所需的参数项， 支持的key有： title=>应用标题， width=>应用容器宽度，\n\t * height=>应用容器高度，logo=>应用logo，url=>应用地址\n\t * @example\n\t * ```javascript\n\t * //editor是编辑器实例\n\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t * editor.execCommand( 'webapp' , {\n\t *     title: '植物大战僵尸',\n\t *     width: 560,\n\t *     height: 465,\n\t *     logo: '应用展示的图片',\n\t *     url: '百度应用的地址'\n\t * } );\n\t * ```\n\t */\n\n\t//UE.plugins['webapp'] = function () {\n\t//    var me = this;\n\t//    function createInsertStr( obj, toIframe, addParagraph ) {\n\t//        return !toIframe ?\n\t//                (addParagraph ? '<p>' : '') + '<img title=\"'+obj.title+'\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"' +\n\t//                        ' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" style=\"background:url(' + obj.logo+') no-repeat center center; border:1px solid gray;\" class=\"edui-faked-webapp\" _url=\"' + obj.url + '\" />' +\n\t//                        (addParagraph ? '</p>' : '')\n\t//                :\n\t//                '<iframe class=\"edui-faked-webapp\" title=\"'+obj.title+'\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"  scrolling=\"no\" frameborder=\"0\" src=\"' + obj.url + '\" logo_url = '+obj.logo+'></iframe>';\n\t//    }\n\t//\n\t//    function switchImgAndIframe( img2frame ) {\n\t//        var tmpdiv,\n\t//                nodes = domUtils.getElementsByTagName( me.document, !img2frame ? \"iframe\" : \"img\" );\n\t//        for ( var i = 0, node; node = nodes[i++]; ) {\n\t//            if ( node.className != \"edui-faked-webapp\" ){\n\t//                continue;\n\t//            }\n\t//            tmpdiv = me.document.createElement( \"div\" );\n\t//            tmpdiv.innerHTML = createInsertStr( img2frame ? {url:node.getAttribute( \"_url\" ), width:node.width, height:node.height,title:node.title,logo:node.style.backgroundImage.replace(\"url(\",\"\").replace(\")\",\"\")} : {url:node.getAttribute( \"src\", 2 ),title:node.title, width:node.width, height:node.height,logo:node.getAttribute(\"logo_url\")}, img2frame ? true : false,false );\n\t//            node.parentNode.replaceChild( tmpdiv.firstChild, node );\n\t//        }\n\t//    }\n\t//\n\t//    me.addListener( \"beforegetcontent\", function () {\n\t//        switchImgAndIframe( true );\n\t//    } );\n\t//    me.addListener( 'aftersetcontent', function () {\n\t//        switchImgAndIframe( false );\n\t//    } );\n\t//    me.addListener( 'aftergetcontent', function ( cmdName ) {\n\t//        if ( cmdName == 'aftergetcontent' && me.queryCommandState( 'source' ) ){\n\t//            return;\n\t//        }\n\t//        switchImgAndIframe( false );\n\t//    } );\n\t//\n\t//    me.commands['webapp'] = {\n\t//        execCommand:function ( cmd, obj ) {\n\t//            me.execCommand( \"inserthtml\", createInsertStr( obj, false,true ) );\n\t//        }\n\t//    };\n\t//};\n\n\tUE.plugin.register('webapp', function() {\n\t\tvar me = this;\n\n\t\tfunction createInsertStr(obj, toEmbed) {\n\t\t\treturn !toEmbed ?\n\t\t\t\t'<img title=\"' + obj.title + '\" width=\"' + obj.width + '\" height=\"' + obj.height + '\"' +\n\t\t\t\t' src=\"' + me.options.UEDITOR_HOME_URL + 'themes/default/images/spacer.gif\" _logo_url=\"' + obj.logo + '\" style=\"background:url(' + obj.logo + ') no-repeat center center; border:1px solid gray;\" class=\"edui-faked-webapp\" _url=\"' + obj.url + '\" ' +\n\t\t\t\t(obj.align && !obj.cssfloat ? 'align=\"' + obj.align + '\"' : '') +\n\t\t\t\t(obj.cssfloat ? 'style=\"float:' + obj.cssfloat + '\"' : '') +\n\t\t\t\t'/>' :\n\t\t\t\t'<iframe class=\"edui-faked-webapp\" title=\"' + obj.title + '\" ' +\n\t\t\t\t(obj.align && !obj.cssfloat ? 'align=\"' + obj.align + '\"' : '') +\n\t\t\t\t(obj.cssfloat ? 'style=\"float:' + obj.cssfloat + '\"' : '') +\n\t\t\t\t'width=\"' + obj.width + '\" height=\"' + obj.height + '\"  scrolling=\"no\" frameborder=\"0\" src=\"' + obj.url + '\" logo_url = \"' + obj.logo + '\"></iframe>'\n\n\t\t}\n\t\treturn {\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(node) {\n\t\t\t\t\tvar html;\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-webapp') {\n\t\t\t\t\t\thtml = createInsertStr({\n\t\t\t\t\t\t\ttitle: node.getAttr('title'),\n\t\t\t\t\t\t\t'width': node.getAttr('width'),\n\t\t\t\t\t\t\t'height': node.getAttr('height'),\n\t\t\t\t\t\t\t'align': node.getAttr('align'),\n\t\t\t\t\t\t\t'cssfloat': node.getStyle('float'),\n\t\t\t\t\t\t\t'url': node.getAttr(\"_url\"),\n\t\t\t\t\t\t\t'logo': node.getAttr('_logo_url')\n\t\t\t\t\t\t}, true);\n\t\t\t\t\t\tvar embed = UE.uNode.createElement(html);\n\t\t\t\t\t\tnode.parentNode.replaceChild(embed, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('iframe'), function(node) {\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-webapp') {\n\t\t\t\t\t\tvar img = UE.uNode.createElement(createInsertStr({\n\t\t\t\t\t\t\ttitle: node.getAttr('title'),\n\t\t\t\t\t\t\t'width': node.getAttr('width'),\n\t\t\t\t\t\t\t'height': node.getAttr('height'),\n\t\t\t\t\t\t\t'align': node.getAttr('align'),\n\t\t\t\t\t\t\t'cssfloat': node.getStyle('float'),\n\t\t\t\t\t\t\t'url': node.getAttr(\"src\"),\n\t\t\t\t\t\t\t'logo': node.getAttr('logo_url')\n\t\t\t\t\t\t}));\n\t\t\t\t\t\tnode.parentNode.replaceChild(img, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 插入百度应用\n\t\t\t\t * @command webapp\n\t\t\t\t * @method execCommand\n\t\t\t\t * @remind 需要百度APPKey\n\t\t\t\t * @remind 百度应用主页： <a href=\"http://app.baidu.com/\" target=\"_blank\">http://app.baidu.com/</a>\n\t\t\t\t * @param { Object } appOptions 应用所需的参数项， 支持的key有： title=>应用标题， width=>应用容器宽度，\n\t\t\t\t * height=>应用容器高度，logo=>应用logo，url=>应用地址\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //editor是编辑器实例\n\t\t\t\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t\t\t\t * editor.execCommand( 'webapp' , {\n\t\t\t\t *     title: '植物大战僵尸',\n\t\t\t\t *     width: 560,\n\t\t\t\t *     height: 465,\n\t\t\t\t *     logo: '应用展示的图片',\n\t\t\t\t *     url: '百度应用的地址'\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'webapp': {\n\t\t\t\t\texecCommand: function(cmd, obj) {\n\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tstr = createInsertStr(utils.extend(obj, {\n\t\t\t\t\t\t\t\talign: 'none'\n\t\t\t\t\t\t\t}), false);\n\t\t\t\t\t\tme.execCommand(\"inserthtml\", str);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\timg = me.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-webapp\");\n\t\t\t\t\t\treturn flag ? 1 : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/template.js\n\t///import core\n\t///import plugins\\inserthtml.js\n\t///import plugins\\cleardoc.js\n\t///commands 模板\n\t///commandsName  template\n\t///commandsTitle  模板\n\t///commandsDialog  dialogs\\template\n\tUE.plugins['template'] = function() {\n\t\tUE.commands['template'] = {\n\t\t\texecCommand: function(cmd, obj) {\n\t\t\t\tobj.html && this.execCommand(\"inserthtml\", obj.html);\n\t\t\t}\n\t\t};\n\t\tthis.addListener(\"click\", function(type, evt) {\n\t\t\tvar el = evt.target || evt.srcElement,\n\t\t\t\trange = this.selection.getRange();\n\t\t\tvar tnode = domUtils.findParent(el, function(node) {\n\t\t\t\tif (node.className && domUtils.hasClass(node, \"ue_t\")) {\n\t\t\t\t\treturn node;\n\t\t\t\t}\n\t\t\t}, true);\n\t\t\ttnode && range.selectNode(tnode).shrinkBoundary().select();\n\t\t});\n\t\tthis.addListener(\"keydown\", function(type, evt) {\n\t\t\tvar range = this.selection.getRange();\n\t\t\tif (!range.collapsed) {\n\t\t\t\tif (!evt.ctrlKey && !evt.metaKey && !evt.shiftKey && !evt.altKey) {\n\t\t\t\t\tvar tnode = domUtils.findParent(range.startContainer, function(node) {\n\t\t\t\t\t\tif (node.className && domUtils.hasClass(node, \"ue_t\")) {\n\t\t\t\t\t\t\treturn node;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, true);\n\t\t\t\t\tif (tnode) {\n\t\t\t\t\t\tdomUtils.removeClasses(tnode, [\"ue_t\"]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t};\n\n\t// plugins/music.js\n\t/**\n\t * 插入音乐命令\n\t * @file\n\t */\n\tUE.plugin.register('music', function() {\n\t\tvar me = this;\n\n\t\tfunction creatInsertStr(url, width, height, align, cssfloat, toEmbed) {\n\t\t\treturn !toEmbed ?\n\t\t\t\t'<img ' +\n\t\t\t\t(align && !cssfloat ? 'align=\"' + align + '\"' : '') +\n\t\t\t\t(cssfloat ? 'style=\"float:' + cssfloat + '\"' : '') +\n\t\t\t\t' width=\"' + width + '\" height=\"' + height + '\" _url=\"' + url + '\" class=\"edui-faked-music\"' +\n\t\t\t\t' src=\"' + me.options.langPath + me.options.lang + '/images/music.png\" />' :\n\t\t\t\t'<embed type=\"application/x-shockwave-flash\" class=\"edui-faked-music\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\"' +\n\t\t\t\t' src=\"' + url + '\" width=\"' + width + '\" height=\"' + height + '\" ' + (align && !cssfloat ? 'align=\"' + align + '\"' : '') +\n\t\t\t\t(cssfloat ? 'style=\"float:' + cssfloat + '\"' : '') +\n\t\t\t\t' wmode=\"transparent\" play=\"true\" loop=\"false\" menu=\"false\" allowscriptaccess=\"never\" allowfullscreen=\"true\" >';\n\t\t}\n\t\treturn {\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(node) {\n\t\t\t\t\tvar html;\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-music') {\n\t\t\t\t\t\tvar cssfloat = node.getStyle('float');\n\t\t\t\t\t\tvar align = node.getAttr('align');\n\t\t\t\t\t\thtml = creatInsertStr(node.getAttr(\"_url\"), node.getAttr('width'), node.getAttr('height'), align, cssfloat, true);\n\t\t\t\t\t\tvar embed = UE.uNode.createElement(html);\n\t\t\t\t\t\tnode.parentNode.replaceChild(embed, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('embed'), function(node) {\n\t\t\t\t\tif (node.getAttr('class') == 'edui-faked-music') {\n\t\t\t\t\t\tvar cssfloat = node.getStyle('float');\n\t\t\t\t\t\tvar align = node.getAttr('align');\n\t\t\t\t\t\thtml = creatInsertStr(node.getAttr(\"src\"), node.getAttr('width'), node.getAttr('height'), align, cssfloat, false);\n\t\t\t\t\t\tvar img = UE.uNode.createElement(html);\n\t\t\t\t\t\tnode.parentNode.replaceChild(img, node);\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 插入音乐\n\t\t\t\t * @command music\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { Object } musicOptions 插入音乐的参数项， 支持的key有： url=>音乐地址；\n\t\t\t\t * width=>音乐容器宽度；height=>音乐容器高度；align=>音乐文件的对齐方式， 可选值有: left, center, right, none\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * //editor是编辑器实例\n\t\t\t\t * //在编辑器里插入一个“植物大战僵尸”的APP\n\t\t\t\t * editor.execCommand( 'music' , {\n\t\t\t\t *     width: 400,\n\t\t\t\t *     height: 95,\n\t\t\t\t *     align: \"center\",\n\t\t\t\t *     url: \"音乐地址\"\n\t\t\t\t * } );\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'music': {\n\t\t\t\t\texecCommand: function(cmd, musicObj) {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tstr = creatInsertStr(musicObj.url, musicObj.width || 400, musicObj.height || 95, \"none\", false);\n\t\t\t\t\t\tme.execCommand(\"inserthtml\", str);\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\timg = me.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\tflag = img && (img.className == \"edui-faked-music\");\n\t\t\t\t\t\treturn flag ? 1 : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/autoupload.js\n\t/**\n\t * @description\n\t * 1.拖放文件到编辑区域，自动上传并插入到选区\n\t * 2.插入粘贴板的图片，自动上传并插入到选区\n\t * @author Jinqn\n\t * @date 2013-10-14\n\t */\n\tUE.plugin.register('autoupload', function() {\n\n\t\tfunction sendAndInsertFile(file, editor) {\n\t\t\tvar me = editor;\n\t\t\t//模拟数据\n\t\t\tvar fieldName, urlPrefix, maxSize, allowFiles, actionUrl,\n\t\t\t\tloadingHtml, errorHandler, successHandler,\n\t\t\t\tfiletype = /image\\/\\w+/i.test(file.type) ? 'image' : 'file',\n\t\t\t\tloadingId = 'loading_' + (+new Date()).toString(36);\n\n\t\t\tfieldName = me.getOpt(filetype + 'FieldName');\n\t\t\turlPrefix = me.getOpt(filetype + 'UrlPrefix');\n\t\t\tmaxSize = me.getOpt(filetype + 'MaxSize');\n\t\t\tallowFiles = me.getOpt(filetype + 'AllowFiles');\n\t\t\tactionUrl = me.getActionUrl(me.getOpt(filetype + 'ActionName'));\n\t\t\terrorHandler = function(title) {\n\t\t\t\tvar loader = me.document.getElementById(loadingId);\n\t\t\t\tloader && domUtils.remove(loader);\n\t\t\t\tme.fireEvent('showmessage', {\n\t\t\t\t\t'id': loadingId,\n\t\t\t\t\t'content': title,\n\t\t\t\t\t'type': 'error',\n\t\t\t\t\t'timeout': 4000\n\t\t\t\t});\n\t\t\t};\n\n\t\t\tif (filetype == 'image') {\n\t\t\t\tloadingHtml = '<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' +\n\t\t\t\t\tme.options.themePath + me.options.theme +\n\t\t\t\t\t'/images/spacer.gif\" title=\"' + (me.getLang('autoupload.loading') || '') + '\" >';\n\t\t\t\tsuccessHandler = function(data) {\n\t\t\t\t\tvar link = urlPrefix + data.url,\n\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\t\t\t\t\tif (loader) {\n\t\t\t\t\t\tloader.setAttribute('src', link);\n\t\t\t\t\t\tloader.setAttribute('_src', link);\n\t\t\t\t\t\tloader.setAttribute('title', data.title || '');\n\t\t\t\t\t\tloader.setAttribute('alt', data.original || '');\n\t\t\t\t\t\tloader.removeAttribute('id');\n\t\t\t\t\t\tdomUtils.removeClasses(loader, 'loadingclass');\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tloadingHtml = '<p>' +\n\t\t\t\t\t'<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' +\n\t\t\t\t\tme.options.themePath + me.options.theme +\n\t\t\t\t\t'/images/spacer.gif\" title=\"' + (me.getLang('autoupload.loading') || '') + '\" >' +\n\t\t\t\t\t'</p>';\n\t\t\t\tsuccessHandler = function(data) {\n\t\t\t\t\tvar link = urlPrefix + data.url,\n\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\n\t\t\t\t\tvar rng = me.selection.getRange(),\n\t\t\t\t\t\tbk = rng.createBookmark();\n\t\t\t\t\trng.selectNode(loader).select();\n\t\t\t\t\tme.execCommand('insertfile', {\n\t\t\t\t\t\t'url': link\n\t\t\t\t\t});\n\t\t\t\t\trng.moveToBookmark(bk).select();\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t/* 插入loading的占位符 */\n\t\t\tme.execCommand('inserthtml', loadingHtml);\n\n\t\t\t/* 判断后端配置是否没有加载成功 */\n\t\t\tif (!me.getOpt(filetype + 'ActionName')) {\n\t\t\t\terrorHandler(me.getLang('autoupload.errorLoadConfig'));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/* 判断文件大小是否超出限制 */\n\t\t\tif (file.size > maxSize) {\n\t\t\t\terrorHandler(me.getLang('autoupload.exceedSizeError'));\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t/* 判断文件格式是否超出允许 */\n\t\t\tvar fileext = file.name ? file.name.substr(file.name.lastIndexOf('.')) : '';\n\t\t\tif ((fileext && filetype != 'image') || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {\n\t\t\t\terrorHandler(me.getLang('autoupload.exceedTypeError'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t/* 创建Ajax并提交 */\n\t\t\tvar xhr = new XMLHttpRequest(),\n\t\t\t\tfd = new FormData(),\n\t\t\t\tparams = utils.serializeParam(me.queryCommandValue('serverparam')) || '',\n\t\t\t\turl = utils.formatUrl(actionUrl + (actionUrl.indexOf('?') == -1 ? '?' : '&') + params);\n\n\t\t\tfd.append(fieldName, file, file.name || ('blob.' + file.type.substr('image/'.length)));\n\t\t\tfd.append('type', 'ajax');\n\t\t\txhr.open(\"post\", url, true);\n\t\t\txhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n\t\t\txhr.addEventListener('load', function(e) {\n\t\t\t\ttry {\n\t\t\t\t\tvar json = (new Function(\"return \" + utils.trim(e.target.response)))();\n\t\t\t\t\tif (json.state == 'SUCCESS' && json.url) {\n\t\t\t\t\t\tsuccessHandler(json);\n\t\t\t\t\t} else {\n\t\t\t\t\t\terrorHandler(json.state);\n\t\t\t\t\t}\n\t\t\t\t} catch (er) {\n\t\t\t\t\terrorHandler(me.getLang('autoupload.loadError'));\n\t\t\t\t}\n\t\t\t});\n\t\t\txhr.send(fd);\n\t\t}\n\n\t\tfunction getPasteImage(e) {\n\t\t\tconsole.log(e.clipboardData)\n\t\t\tconsole.log( e.clipboardData.items)\n\t\t\tconsole.log(e.clipboardData.items[0])\n\t\t\tconsole.log(e.clipboardData.items[0].type)\n\t\t\t//return e.clipboardData && e.clipboardData.items && e.clipboardData.items.length == 1 && /^image\\//.test(e.clipboardData.items[0].type) ? e.clipboardData.items : null;\n\t\t}\n\n\t\tfunction getDropImage(e) {\n\t\t\treturn e.dataTransfer && e.dataTransfer.files ? e.dataTransfer.files : null;\n\t\t}\n\n\t\treturn {\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(n) {\n\t\t\t\t\tif (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tutils.each(root.getNodesByTagName('p'), function(n) {\n\t\t\t\t\tif (/\\bloadpara\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tbindEvents: {\n\t\t\t\t//插入粘贴板的图片，拖放插入图片\n\t\t\t\t'ready': function(e) {\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tif (window.FormData && window.FileReader) {\n\t\t\t\t\t\tdomUtils.on(me.body, 'paste drop', function(e) {\n\t\t\t\t\t\t\tvar hasImg = false,\n\t\t\t\t\t\t\t\titems;\n\t\t\t\t\t\t\t//获取粘贴板文件列表或者拖放文件列表\n\t\t\t\t\t\t\titems = e.type == 'paste' ? getPasteImage(e) : getDropImage(e);\n\t\t\t\t\t\t\tif (items) {\n\t\t\t\t\t\t\t\tconsole.log(items,items.length);\n\t\t\t\t\t\t\t\tvar len = items.length,\n\t\t\t\t\t\t\t\t\tfile;\n\t\t\t\t\t\t\t\t\tconsole.log(len,24329)\n\t\t\t\t\t\t\t\twhile (len--) {\n\t\t\t\t\t\t\t\t\tfile = items[len];\n\t\t\t\t\t\t\t\t\tif (file.getAsFile) file = file.getAsFile();\n\t\t\t\t\t\t\t\t\tif (file && file.size > 0) {\n\t\t\t\t\t\t\t\t\t\tsendAndInsertFile(file, me);\n\t\t\t\t\t\t\t\t\t\thasImg = true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thasImg && e.preventDefault();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//取消拖放图片时出现的文字光标位置提示\n\t\t\t\t\t\tdomUtils.on(me.body, 'dragover', function(e) {\n\t\t\t\t\t\t\tif (e.dataTransfer.types[0] == 'Files') {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t//设置loading的样式\n\t\t\t\t\t\tutils.cssRule('loading',\n\t\t\t\t\t\t\t'.loadingclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loading.gif\\') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\\n' +\n\t\t\t\t\t\t\t'.loaderrorclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loaderror.png\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +\n\t\t\t\t\t\t\t'}',\n\t\t\t\t\t\t\tthis.document);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/autosave.js\n\tUE.plugin.register('autosave', function() {\n\n\t\tvar me = this,\n\t\t\t//无限循环保护\n\t\t\tlastSaveTime = new Date(),\n\t\t\t//最小保存间隔时间\n\t\t\tMIN_TIME = 20,\n\t\t\t//auto save key\n\t\t\tsaveKey = null;\n\n\t\tif (!me.getOpt('enableAutoSave')) {\n\t\t\treturn;\n\t\t}\n\n\t\tfunction save(editor) {\n\n\t\t\tvar saveData;\n\n\t\t\tif (new Date() - lastSaveTime < MIN_TIME) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!editor.hasContents()) {\n\t\t\t\t//这里不能调用命令来删除， 会造成事件死循环\n\t\t\t\tsaveKey && me.removePreferences(saveKey);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlastSaveTime = new Date();\n\n\t\t\teditor._saveFlag = null;\n\n\t\t\tsaveData = me.body.innerHTML;\n\n\t\t\tif (editor.fireEvent(\"beforeautosave\", {\n\t\t\t\t\tcontent: saveData\n\t\t\t\t}) === false) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tme.setPreferences(saveKey, saveData);\n\n\t\t\teditor.fireEvent(\"afterautosave\", {\n\t\t\t\tcontent: saveData\n\t\t\t});\n\n\t\t}\n\n\t\treturn {\n\t\t\tdefaultOptions: {\n\t\t\t\t//默认间隔时间\n\t\t\t\tsaveInterval: 500\n\t\t\t},\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\n\t\t\t\t\tvar _suffix = \"-drafts-data\",\n\t\t\t\t\t\tkey = null;\n\n\t\t\t\t\tif (me.key) {\n\t\t\t\t\t\tkey = me.key + _suffix;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkey = (me.container.parentNode.id || 'ue-common') + _suffix;\n\t\t\t\t\t}\n\n\t\t\t\t\t//页面地址+编辑器ID 保持唯一\n\t\t\t\t\tsaveKey = (location.protocol + location.host + location.pathname).replace(/[.:\\/]/g, '_') + key;\n\n\t\t\t\t},\n\n\t\t\t\t'contentchange': function() {\n\n\t\t\t\t\tif (!saveKey) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (me._saveFlag) {\n\t\t\t\t\t\twindow.clearTimeout(me._saveFlag);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (me.options.saveInterval > 0) {\n\n\t\t\t\t\t\tme._saveFlag = window.setTimeout(function() {\n\n\t\t\t\t\t\t\tsave(me);\n\n\t\t\t\t\t\t}, me.options.saveInterval);\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tsave(me);\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'clearlocaldata': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\tif (saveKey && me.getPreferences(saveKey)) {\n\t\t\t\t\t\t\tme.removePreferences(saveKey)\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\tignoreContentChange: true\n\t\t\t\t},\n\n\t\t\t\t'getlocaldata': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\treturn saveKey ? me.getPreferences(saveKey) || '' : '';\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\tignoreContentChange: true\n\t\t\t\t},\n\n\t\t\t\t'drafts': {\n\t\t\t\t\texecCommand: function(cmd, name) {\n\t\t\t\t\t\tif (saveKey) {\n\t\t\t\t\t\t\tme.body.innerHTML = me.getPreferences(saveKey) || '<p>' + domUtils.fillHtml + '</p>';\n\t\t\t\t\t\t\tme.focus(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn saveKey ? (me.getPreferences(saveKey) === null ? -1 : 0) : -1;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true,\n\t\t\t\t\tignoreContentChange: true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t});\n\n\t// plugins/charts.js\n\tUE.plugin.register('charts', function() {\n\n\t\tvar me = this;\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'chartserror': function() {}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'charts': {\n\t\t\t\t\texecCommand: function(cmd, data) {\n\n\t\t\t\t\t\tvar tableNode = domUtils.findParentByTagName(this.selection.getRange().startContainer, 'table', true),\n\t\t\t\t\t\t\tflagText = [],\n\t\t\t\t\t\t\tconfig = {};\n\n\t\t\t\t\t\tif (!tableNode) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!validData(tableNode)) {\n\t\t\t\t\t\t\tme.fireEvent(\"chartserror\");\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconfig.title = data.title || '';\n\t\t\t\t\t\tconfig.subTitle = data.subTitle || '';\n\t\t\t\t\t\tconfig.xTitle = data.xTitle || '';\n\t\t\t\t\t\tconfig.yTitle = data.yTitle || '';\n\t\t\t\t\t\tconfig.suffix = data.suffix || '';\n\t\t\t\t\t\tconfig.tip = data.tip || '';\n\t\t\t\t\t\t//数据对齐方式\n\t\t\t\t\t\tconfig.dataFormat = data.tableDataFormat || '';\n\t\t\t\t\t\t//图表类型\n\t\t\t\t\t\tconfig.chartType = data.chartType || 0;\n\n\t\t\t\t\t\tfor (var key in config) {\n\n\t\t\t\t\t\t\tif (!config.hasOwnProperty(key)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tflagText.push(key + \":\" + config[key]);\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\ttableNode.setAttribute(\"data-chart\", flagText.join(\";\"));\n\t\t\t\t\t\tdomUtils.addClass(tableNode, \"edui-charts-table\");\n\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandState: function(cmd, name) {\n\n\t\t\t\t\t\tvar tableNode = domUtils.findParentByTagName(this.selection.getRange().startContainer, 'table', true);\n\t\t\t\t\t\treturn tableNode && validData(tableNode) ? 0 : -1;\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tinputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('table'), function(tableNode) {\n\n\t\t\t\t\tif (tableNode.getAttr(\"data-chart\") !== undefined) {\n\t\t\t\t\t\ttableNode.setAttr(\"style\");\n\t\t\t\t\t}\n\n\t\t\t\t})\n\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('table'), function(tableNode) {\n\n\t\t\t\t\tif (tableNode.getAttr(\"data-chart\") !== undefined) {\n\t\t\t\t\t\ttableNode.setAttr(\"style\", \"display: none;\");\n\t\t\t\t\t}\n\n\t\t\t\t})\n\n\t\t\t}\n\t\t}\n\n\t\tfunction validData(table) {\n\n\t\t\tvar firstRows = null,\n\t\t\t\tcellCount = 0;\n\n\t\t\t//行数不够\n\t\t\tif (table.rows.length < 2) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//列数不够\n\t\t\tif (table.rows[0].cells.length < 2) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t//第一行所有cell必须是th\n\t\t\tfirstRows = table.rows[0].cells;\n\t\t\tcellCount = firstRows.length;\n\n\t\t\tfor (var i = 0, cell; cell = firstRows[i]; i++) {\n\n\t\t\t\tif (cell.tagName.toLowerCase() !== 'th') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor (var i = 1, row; row = table.rows[i]; i++) {\n\n\t\t\t\t//每行单元格数不匹配， 返回false\n\t\t\t\tif (row.cells.length != cellCount) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t//第一列不是th也返回false\n\t\t\t\tif (row.cells[0].tagName.toLowerCase() !== 'th') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tfor (var j = 1, cell; cell = row.cells[j]; j++) {\n\n\t\t\t\t\tvar value = utils.trim((cell.innerText || cell.textContent || ''));\n\n\t\t\t\t\tvalue = value.replace(new RegExp(UE.dom.domUtils.fillChar, 'g'), '').replace(/^\\s+|\\s+$/g, '');\n\n\t\t\t\t\t//必须是数字\n\t\t\t\t\tif (!/^\\d*\\.?\\d+$/.test(value)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn true;\n\n\t\t}\n\n\t});\n\n\t// plugins/section.js\n\t/**\n\t * 目录大纲支持插件\n\t * @file\n\t * @since 1.3.0\n\t */\n\tUE.plugin.register('section', function() {\n\t\t/* 目录节点对象 */\n\t\tfunction Section(option) {\n\t\t\tthis.tag = '';\n\t\t\tthis.level = -1,\n\t\t\t\tthis.dom = null;\n\t\t\tthis.nextSection = null;\n\t\t\tthis.previousSection = null;\n\t\t\tthis.parentSection = null;\n\t\t\tthis.startAddress = [];\n\t\t\tthis.endAddress = [];\n\t\t\tthis.children = [];\n\t\t}\n\n\t\tfunction getSection(option) {\n\t\t\tvar section = new Section();\n\t\t\treturn utils.extend(section, option);\n\t\t}\n\n\t\tfunction getNodeFromAddress(startAddress, root) {\n\t\t\tvar current = root;\n\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\tif (!current.childNodes) return null;\n\t\t\t\tcurrent = current.childNodes[startAddress[i]];\n\t\t\t}\n\t\t\treturn current;\n\t\t}\n\n\t\tvar me = this;\n\n\t\treturn {\n\t\t\tbindMultiEvents: {\n\t\t\t\ttype: 'aftersetcontent afterscencerestore',\n\t\t\t\thandler: function() {\n\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t}\n\t\t\t},\n\t\t\tbindEvents: {\n\t\t\t\t/* 初始化、拖拽、粘贴、执行setcontent之后 */\n\t\t\t\t'ready': function() {\n\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\tdomUtils.on(me.body, 'drop paste', function() {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t/* 执行paragraph命令之后 */\n\t\t\t\t'afterexeccommand': function(type, cmd) {\n\t\t\t\t\tif (cmd == 'paragraph') {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t/* 部分键盘操作，触发updateSections事件 */\n\t\t\t\t'keyup': function(type, e) {\n\t\t\t\t\tvar me = this,\n\t\t\t\t\t\trange = me.selection.getRange();\n\t\t\t\t\tif (range.collapsed != true) {\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar keyCode = e.keyCode || e.which;\n\t\t\t\t\t\tif (keyCode == 13 || keyCode == 8 || keyCode == 46) {\n\t\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'getsections': {\n\t\t\t\t\texecCommand: function(cmd, levels) {\n\t\t\t\t\t\tvar levelFn = levels || ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n\n\t\t\t\t\t\tfor (var i = 0; i < levelFn.length; i++) {\n\t\t\t\t\t\t\tif (typeof levelFn[i] == 'string') {\n\t\t\t\t\t\t\t\tlevelFn[i] = function(fn) {\n\t\t\t\t\t\t\t\t\treturn function(node) {\n\t\t\t\t\t\t\t\t\t\treturn node.tagName == fn.toUpperCase()\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t}(levelFn[i]);\n\t\t\t\t\t\t\t} else if (typeof levelFn[i] != 'function') {\n\t\t\t\t\t\t\t\tlevelFn[i] = function(node) {\n\t\t\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfunction getSectionLevel(node) {\n\t\t\t\t\t\t\tfor (var i = 0; i < levelFn.length; i++) {\n\t\t\t\t\t\t\t\tif (levelFn[i](node)) return i;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\tDirectory = getSection({\n\t\t\t\t\t\t\t\t'level': -1,\n\t\t\t\t\t\t\t\t'title': 'root'\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tprevious = Directory;\n\n\t\t\t\t\t\tfunction traversal(node, Directory) {\n\t\t\t\t\t\t\tvar level,\n\t\t\t\t\t\t\t\ttmpSection = null,\n\t\t\t\t\t\t\t\tparent,\n\t\t\t\t\t\t\t\tchild,\n\t\t\t\t\t\t\t\tchildren = node.childNodes;\n\t\t\t\t\t\t\tfor (var i = 0, len = children.length; i < len; i++) {\n\t\t\t\t\t\t\t\tchild = children[i];\n\t\t\t\t\t\t\t\tlevel = getSectionLevel(child);\n\t\t\t\t\t\t\t\tif (level >= 0) {\n\t\t\t\t\t\t\t\t\tvar address = me.selection.getRange().selectNode(child).createAddress(true).startAddress,\n\t\t\t\t\t\t\t\t\t\tcurrent = getSection({\n\t\t\t\t\t\t\t\t\t\t\t'tag': child.tagName,\n\t\t\t\t\t\t\t\t\t\t\t'title': child.innerText || child.textContent || '',\n\t\t\t\t\t\t\t\t\t\t\t'level': level,\n\t\t\t\t\t\t\t\t\t\t\t'dom': child,\n\t\t\t\t\t\t\t\t\t\t\t'startAddress': utils.clone(address, []),\n\t\t\t\t\t\t\t\t\t\t\t'endAddress': utils.clone(address, []),\n\t\t\t\t\t\t\t\t\t\t\t'children': []\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tprevious.nextSection = current;\n\t\t\t\t\t\t\t\t\tcurrent.previousSection = previous;\n\t\t\t\t\t\t\t\t\tparent = previous;\n\t\t\t\t\t\t\t\t\twhile (level <= parent.level) {\n\t\t\t\t\t\t\t\t\t\tparent = parent.parentSection;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcurrent.parentSection = parent;\n\t\t\t\t\t\t\t\t\tparent.children.push(current);\n\t\t\t\t\t\t\t\t\ttmpSection = previous = current;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tchild.nodeType === 1 && traversal(child, Directory);\n\t\t\t\t\t\t\t\t\ttmpSection && tmpSection.endAddress[tmpSection.endAddress.length - 1]++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttraversal(me.body, Directory);\n\t\t\t\t\t\treturn Directory;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t},\n\t\t\t\t'movesection': {\n\t\t\t\t\texecCommand: function(cmd, sourceSection, targetSection, isAfter) {\n\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\ttargetAddress,\n\t\t\t\t\t\t\ttarget;\n\n\t\t\t\t\t\tif (!sourceSection || !targetSection || targetSection.level == -1) return;\n\n\t\t\t\t\t\ttargetAddress = isAfter ? targetSection.endAddress : targetSection.startAddress;\n\t\t\t\t\t\ttarget = getNodeFromAddress(targetAddress, me.body);\n\n\t\t\t\t\t\t/* 判断目标地址是否被源章节包含 */\n\t\t\t\t\t\tif (!targetAddress || !target || isContainsAddress(sourceSection.startAddress, sourceSection.endAddress, targetAddress)) return;\n\n\t\t\t\t\t\tvar startNode = getNodeFromAddress(sourceSection.startAddress, me.body),\n\t\t\t\t\t\t\tendNode = getNodeFromAddress(sourceSection.endAddress, me.body),\n\t\t\t\t\t\t\tcurrent,\n\t\t\t\t\t\t\tnextNode;\n\n\t\t\t\t\t\tif (isAfter) {\n\t\t\t\t\t\t\tcurrent = endNode;\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(startNode, current) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tnextNode = current.previousSibling;\n\t\t\t\t\t\t\t\tdomUtils.insertAfter(target, current);\n\t\t\t\t\t\t\t\tif (current == startNode) break;\n\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcurrent = startNode;\n\t\t\t\t\t\t\twhile (current && !(domUtils.getPosition(current, endNode) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tnextNode = current.nextSibling;\n\t\t\t\t\t\t\t\ttarget.parentNode.insertBefore(current, target);\n\t\t\t\t\t\t\t\tif (current == endNode) break;\n\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\n\t\t\t\t\t\t/* 获取地址的包含关系 */\n\t\t\t\t\t\tfunction isContainsAddress(startAddress, endAddress, addressTarget) {\n\t\t\t\t\t\t\tvar isAfterStartAddress = false,\n\t\t\t\t\t\t\t\tisBeforeEndAddress = false;\n\t\t\t\t\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\t\t\t\t\tif (i >= addressTarget.length) break;\n\t\t\t\t\t\t\t\tif (addressTarget[i] > startAddress[i]) {\n\t\t\t\t\t\t\t\t\tisAfterStartAddress = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else if (addressTarget[i] < startAddress[i]) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (var i = 0; i < endAddress.length; i++) {\n\t\t\t\t\t\t\t\tif (i >= addressTarget.length) break;\n\t\t\t\t\t\t\t\tif (addressTarget[i] < startAddress[i]) {\n\t\t\t\t\t\t\t\t\tisBeforeEndAddress = true;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else if (addressTarget[i] > startAddress[i]) {\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn isAfterStartAddress && isBeforeEndAddress;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'deletesection': {\n\t\t\t\t\texecCommand: function(cmd, section, keepChildren) {\n\t\t\t\t\t\tvar me = this;\n\n\t\t\t\t\t\tif (!section) return;\n\n\t\t\t\t\t\tfunction getNodeFromAddress(startAddress) {\n\t\t\t\t\t\t\tvar current = me.body;\n\t\t\t\t\t\t\tfor (var i = 0; i < startAddress.length; i++) {\n\t\t\t\t\t\t\t\tif (!current.childNodes) return null;\n\t\t\t\t\t\t\t\tcurrent = current.childNodes[startAddress[i]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn current;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar startNode = getNodeFromAddress(section.startAddress),\n\t\t\t\t\t\t\tendNode = getNodeFromAddress(section.endAddress),\n\t\t\t\t\t\t\tcurrent = startNode,\n\t\t\t\t\t\t\tnextNode;\n\n\t\t\t\t\t\tif (!keepChildren) {\n\t\t\t\t\t\t\twhile (current && domUtils.inDoc(endNode, me.document) && !(domUtils.getPosition(current, endNode) & domUtils.POSITION_FOLLOWING)) {\n\t\t\t\t\t\t\t\tnextNode = current.nextSibling;\n\t\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t\t\tcurrent = nextNode;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdomUtils.remove(current);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tme.fireEvent('updateSections');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'selectsection': {\n\t\t\t\t\texecCommand: function(cmd, section) {\n\t\t\t\t\t\tif (!section && !section.dom) return false;\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\t\t\taddress = {\n\t\t\t\t\t\t\t\t'startAddress': utils.clone(section.startAddress, []),\n\t\t\t\t\t\t\t\t'endAddress': utils.clone(section.endAddress, [])\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\taddress.endAddress[address.endAddress.length - 1]++;\n\t\t\t\t\t\trange.moveToAddress(address).select().scrollToView();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t},\n\t\t\t\t'scrolltosection': {\n\t\t\t\t\texecCommand: function(cmd, section) {\n\t\t\t\t\t\tif (!section && !section.dom) return false;\n\t\t\t\t\t\tvar me = this,\n\t\t\t\t\t\t\trange = me.selection.getRange(),\n\t\t\t\t\t\t\taddress = {\n\t\t\t\t\t\t\t\t'startAddress': section.startAddress,\n\t\t\t\t\t\t\t\t'endAddress': section.endAddress\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\taddress.endAddress[address.endAddress.length - 1]++;\n\t\t\t\t\t\trange.moveToAddress(address).scrollToView();\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tnotNeedUndo: true\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/simpleupload.js\n\t/**\n\t * @description\n\t * 简单上传:点击按钮,直接选择文件上传\n\t * @author Jinqn\n\t * @date 2014-03-31\n\t */\n\tUE.plugin.register('simpleupload', function() {\n\t\tvar me = this,\n\t\t\tisLoaded = false,\n\t\t\tcontainerBtn;\n\n\t\tfunction initUploadBtn() {\n\t\t\tvar w = containerBtn.offsetWidth || 20,\n\t\t\t\th = containerBtn.offsetHeight || 20,\n\t\t\t\tbtnIframe = document.createElement('iframe'),\n\t\t\t\tbtnStyle = 'display:block;width:' + w + 'px;height:' + h + 'px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;';\n\n\t\t\tdomUtils.on(btnIframe, 'load', function() {\n\n\t\t\t\tvar timestrap = (+new Date()).toString(36),\n\t\t\t\t\twrapper,\n\t\t\t\t\tbtnIframeDoc,\n\t\t\t\t\tbtnIframeBody;\n\n\t\t\t\tbtnIframeDoc = (btnIframe.contentDocument || btnIframe.contentWindow.document);\n\t\t\t\tbtnIframeBody = btnIframeDoc.body;\n\t\t\t\twrapper = btnIframeDoc.createElement('div');\n\n\t\t\t\twrapper.innerHTML = '<form id=\"edui_form_' + timestrap + '\" target=\"edui_iframe_' + timestrap + '\" method=\"POST\" enctype=\"multipart/form-data\" action=\"' + me.getOpt('serverUrl') + '\" ' +\n\t\t\t\t\t'style=\"' + btnStyle + '\">' +\n\t\t\t\t\t'<input id=\"edui_input_' + timestrap + '\" type=\"file\" accept=\"image/*\" name=\"' + me.options.imageFieldName + '\" ' +\n\t\t\t\t\t'style=\"' + btnStyle + '\">' +\n\t\t\t\t\t'</form>' +\n\t\t\t\t\t'<iframe id=\"edui_iframe_' + timestrap + '\" name=\"edui_iframe_' + timestrap + '\" style=\"display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;\"></iframe>';\n\n\t\t\t\twrapper.className = 'edui-' + me.options.theme;\n\t\t\t\twrapper.id = me.ui.id + '_iframeupload';\n\t\t\t\tbtnIframeBody.style.cssText = btnStyle;\n\t\t\t\tbtnIframeBody.style.width = w + 'px';\n\t\t\t\tbtnIframeBody.style.height = h + 'px';\n\t\t\t\tbtnIframeBody.appendChild(wrapper);\n\n\t\t\t\tif (btnIframeBody.parentNode) {\n\t\t\t\t\tbtnIframeBody.parentNode.style.width = w + 'px';\n\t\t\t\t\tbtnIframeBody.parentNode.style.height = w + 'px';\n\t\t\t\t}\n\n\t\t\t\tvar form = btnIframeDoc.getElementById('edui_form_' + timestrap);\n\t\t\t\tvar input = btnIframeDoc.getElementById('edui_input_' + timestrap);\n\t\t\t\tvar iframe = btnIframeDoc.getElementById('edui_iframe_' + timestrap);\n\n\t\t\t\tdomUtils.on(input, 'change', function() {\n\t\t\t\t\tif (!input.value) return;\n\t\t\t\t\tvar loadingId = 'loading_' + (+new Date()).toString(36);\n\t\t\t\t\tvar params = utils.serializeParam(me.queryCommandValue('serverparam')) || '';\n\n\t\t\t\t\tvar imageActionUrl = me.getActionUrl(me.getOpt('imageActionName'));\n\t\t\t\t\tvar allowFiles = me.getOpt('imageAllowFiles');\n\n\t\t\t\t\tme.focus();\n\t\t\t\t\tme.execCommand('inserthtml', '<img class=\"loadingclass\" id=\"' + loadingId + '\" src=\"' + me.options.themePath + me.options.theme + '/images/spacer.gif\" title=\"' + (me.getLang('simpleupload.loading') || '') + '\" >');\n\n\t\t\t\t\tfunction callback() {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar link, json, loader,\n\t\t\t\t\t\t\t\tbody = (iframe.contentDocument || iframe.contentWindow.document).body,\n\t\t\t\t\t\t\t\tresult = body.innerText || body.textContent || '';\n\t\t\t\t\t\t\tjson = (new Function(\"return \" + result))();\n\t\t\t\t\t\t\tlink = me.options.imageUrlPrefix + json.url;\n\t\t\t\t\t\t\tif (json.state == 'SUCCESS' && json.url) {\n\t\t\t\t\t\t\t\tloader = me.document.getElementById(loadingId);\n\t\t\t\t\t\t\t\tloader.setAttribute('src', link);\n\t\t\t\t\t\t\t\tloader.setAttribute('_src', link);\n\t\t\t\t\t\t\t\tloader.setAttribute('title', json.title || '');\n\t\t\t\t\t\t\t\tloader.setAttribute('alt', json.original || '');\n\t\t\t\t\t\t\t\tloader.removeAttribute('id');\n\t\t\t\t\t\t\t\tdomUtils.removeClasses(loader, 'loadingclass');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowErrorLoader && showErrorLoader(json.state);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (er) {\n\t\t\t\t\t\t\tshowErrorLoader && showErrorLoader(me.getLang('simpleupload.loadError'));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tform.reset();\n\t\t\t\t\t\tdomUtils.un(iframe, 'load', callback);\n\t\t\t\t\t}\n\n\t\t\t\t\tfunction showErrorLoader(title) {\n\t\t\t\t\t\tif (loadingId) {\n\t\t\t\t\t\t\tvar loader = me.document.getElementById(loadingId);\n\t\t\t\t\t\t\tloader && domUtils.remove(loader);\n\t\t\t\t\t\t\tme.fireEvent('showmessage', {\n\t\t\t\t\t\t\t\t'id': loadingId,\n\t\t\t\t\t\t\t\t'content': title,\n\t\t\t\t\t\t\t\t'type': 'error',\n\t\t\t\t\t\t\t\t'timeout': 4000\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t/* 判断后端配置是否没有加载成功 */\n\t\t\t\t\tif (!me.getOpt('imageActionName')) {\n\t\t\t\t\t\terrorHandler(me.getLang('autoupload.errorLoadConfig'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// 判断文件格式是否错误\n\t\t\t\t\tvar filename = input.value,\n\t\t\t\t\t\tfileext = filename ? filename.substr(filename.lastIndexOf('.')) : '';\n\t\t\t\t\tif (!fileext || (allowFiles && (allowFiles.join('') + '.').indexOf(fileext.toLowerCase() + '.') == -1)) {\n\t\t\t\t\t\tshowErrorLoader(me.getLang('simpleupload.exceedTypeError'));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdomUtils.on(iframe, 'load', callback);\n\t\t\t\t\tform.action = utils.formatUrl(imageActionUrl + (imageActionUrl.indexOf('?') == -1 ? '?' : '&') + params);\n\t\t\t\t\tform.submit();\n\t\t\t\t});\n\n\t\t\t\tvar stateTimer;\n\t\t\t\tme.addListener('selectionchange', function() {\n\t\t\t\t\tclearTimeout(stateTimer);\n\t\t\t\t\tstateTimer = setTimeout(function() {\n\t\t\t\t\t\tvar state = me.queryCommandState('simpleupload');\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tinput.disabled = 'disabled';\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tinput.disabled = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 400);\n\t\t\t\t});\n\t\t\t\tisLoaded = true;\n\t\t\t});\n\n\t\t\tbtnIframe.style.cssText = btnStyle;\n\t\t\tcontainerBtn.appendChild(btnIframe);\n\t\t}\n\n\t\treturn {\n\t\t\tbindEvents: {\n\t\t\t\t'ready': function() {\n\t\t\t\t\t//设置loading的样式\n\t\t\t\t\tutils.cssRule('loading',\n\t\t\t\t\t\t'.loadingclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loading.gif\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\\n' +\n\t\t\t\t\t\t'.loaderrorclass{display:inline-block;cursor:default;background: url(\\'' + this.options.themePath + this.options.theme + '/images/loaderror.png\\') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;' +\n\t\t\t\t\t\t'}',\n\t\t\t\t\t\tthis.document);\n\t\t\t\t},\n\t\t\t\t/* 初始化简单上传按钮 */\n\t\t\t\t'simpleuploadbtnready': function(type, container) {\n\t\t\t\t\tcontainerBtn = container;\n\t\t\t\t\tme.afterConfigReady(initUploadBtn);\n\t\t\t\t}\n\t\t\t},\n\t\t\toutputRule: function(root) {\n\t\t\t\tutils.each(root.getNodesByTagName('img'), function(n) {\n\t\t\t\t\tif (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n\t\t\t\t\t\tn.parentNode.removeChild(n);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t\tcommands: {\n\t\t\t\t'simpleupload': {\n\t\t\t\t\tqueryCommandState: function() {\n\t\t\t\t\t\treturn isLoaded ? 0 : -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/serverparam.js\n\t/**\n\t * 服务器提交的额外参数列表设置插件\n\t * @file\n\t * @since 1.2.6.1\n\t */\n\tUE.plugin.register('serverparam', function() {\n\n\t\tvar me = this,\n\t\t\tserverParam = {};\n\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,清除所有项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam');\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回空\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,删除指定项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { String } key 要清除的属性\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', 'name'); //删除属性name\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,使用键值添加项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { String } key 要添加的属性\n\t\t\t\t * @param { String } value 要添加属性的值\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', 'name', 'hello');\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'name': 'hello'}\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,传入键值对对象添加多项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { Object } key 传入的键值对对象\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', {'name': 'hello'});\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'name': 'hello'}\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t/**\n\t\t\t\t * 修改服务器提交的额外参数列表,使用自定义函数添加多项\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method execCommand\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @param { Function } key 自定义获取参数的函数\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.execCommand('serverparam', function(editor){\n\t\t\t\t *     return {'key': 'value'};\n\t\t\t\t * });\n\t\t\t\t * editor.queryCommandValue('serverparam'); //返回对象 {'key': 'value'}\n\t\t\t\t * ```\n\t\t\t\t */\n\n\t\t\t\t/**\n\t\t\t\t * 获取服务器提交的额外参数列表\n\t\t\t\t * @command serverparam\n\t\t\t\t * @method queryCommandValue\n\t\t\t\t * @param { String } cmd 命令字符串\n\t\t\t\t * @example\n\t\t\t\t * ```javascript\n\t\t\t\t * editor.queryCommandValue( 'serverparam' ); //返回对象 {'key': 'value'}\n\t\t\t\t * ```\n\t\t\t\t */\n\t\t\t\t'serverparam': {\n\t\t\t\t\texecCommand: function(cmd, key, value) {\n\t\t\t\t\t\tif (key === undefined || key === null) { //不传参数,清空列表\n\t\t\t\t\t\t\tserverParam = {};\n\t\t\t\t\t\t} else if (utils.isString(key)) { //传入键值\n\t\t\t\t\t\t\tif (value === undefined || value === null) {\n\t\t\t\t\t\t\t\tdelete serverParam[key];\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tserverParam[key] = value;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (utils.isObject(key)) { //传入对象,覆盖列表项\n\t\t\t\t\t\t\tutils.extend(serverParam, key, true);\n\t\t\t\t\t\t} else if (utils.isFunction(key)) { //传入函数,添加列表项\n\t\t\t\t\t\t\tutils.extend(serverParam, key(), true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tqueryCommandValue: function() {\n\t\t\t\t\t\treturn serverParam || {};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/insertfile.js\n\t/**\n\t * 插入附件\n\t */\n\tUE.plugin.register('insertfile', function() {\n\n\t\tvar me = this;\n\n\t\tfunction getFileIcon(url) {\n\t\t\tvar ext = url.substr(url.lastIndexOf('.') + 1).toLowerCase(),\n\t\t\t\tmaps = {\n\t\t\t\t\t\"rar\": \"icon_rar.gif\",\n\t\t\t\t\t\"zip\": \"icon_rar.gif\",\n\t\t\t\t\t\"tar\": \"icon_rar.gif\",\n\t\t\t\t\t\"gz\": \"icon_rar.gif\",\n\t\t\t\t\t\"bz2\": \"icon_rar.gif\",\n\t\t\t\t\t\"doc\": \"icon_doc.gif\",\n\t\t\t\t\t\"docx\": \"icon_doc.gif\",\n\t\t\t\t\t\"pdf\": \"icon_pdf.gif\",\n\t\t\t\t\t\"mp3\": \"icon_mp3.gif\",\n\t\t\t\t\t\"xls\": \"icon_xls.gif\",\n\t\t\t\t\t\"chm\": \"icon_chm.gif\",\n\t\t\t\t\t\"ppt\": \"icon_ppt.gif\",\n\t\t\t\t\t\"pptx\": \"icon_ppt.gif\",\n\t\t\t\t\t\"avi\": \"icon_mv.gif\",\n\t\t\t\t\t\"rmvb\": \"icon_mv.gif\",\n\t\t\t\t\t\"wmv\": \"icon_mv.gif\",\n\t\t\t\t\t\"flv\": \"icon_mv.gif\",\n\t\t\t\t\t\"swf\": \"icon_mv.gif\",\n\t\t\t\t\t\"rm\": \"icon_mv.gif\",\n\t\t\t\t\t\"exe\": \"icon_exe.gif\",\n\t\t\t\t\t\"psd\": \"icon_psd.gif\",\n\t\t\t\t\t\"txt\": \"icon_txt.gif\",\n\t\t\t\t\t\"jpg\": \"icon_jpg.gif\",\n\t\t\t\t\t\"png\": \"icon_jpg.gif\",\n\t\t\t\t\t\"jpeg\": \"icon_jpg.gif\",\n\t\t\t\t\t\"gif\": \"icon_jpg.gif\",\n\t\t\t\t\t\"ico\": \"icon_jpg.gif\",\n\t\t\t\t\t\"bmp\": \"icon_jpg.gif\"\n\t\t\t\t};\n\t\t\treturn maps[ext] ? maps[ext] : maps['txt'];\n\t\t}\n\n\t\treturn {\n\t\t\tcommands: {\n\t\t\t\t'insertfile': {\n\t\t\t\t\texecCommand: function(command, filelist) {\n\t\t\t\t\t\tfilelist = utils.isArray(filelist) ? filelist : [filelist];\n\n\t\t\t\t\t\tvar i, item, icon, title,\n\t\t\t\t\t\t\thtml = '',\n\t\t\t\t\t\t\tURL = me.getOpt('UEDITOR_HOME_URL'),\n\t\t\t\t\t\t\ticonDir = URL + (URL.substr(URL.length - 1) == '/' ? '' : '/') + 'dialogs/attachment/fileTypeImages/';\n\t\t\t\t\t\tfor (i = 0; i < filelist.length; i++) {\n\t\t\t\t\t\t\titem = filelist[i];\n\t\t\t\t\t\t\ticon = iconDir + getFileIcon(item.url);\n\t\t\t\t\t\t\ttitle = item.title || item.url.substr(item.url.lastIndexOf('/') + 1);\n\t\t\t\t\t\t\thtml += '<p style=\"line-height: 16px;\">' +\n\t\t\t\t\t\t\t\t'<img style=\"vertical-align: middle; margin-right: 2px;\" src=\"' + icon + '\" _src=\"' + icon + '\" />' +\n\t\t\t\t\t\t\t\t'<a style=\"font-size:12px; color:#0066cc;\" href=\"' + item.url + '\" title=\"' + title + '\">' + title + '</a>' +\n\t\t\t\t\t\t\t\t'</p>';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.execCommand('insertHtml', html);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\t// plugins/xssFilter.js\n\t/**\n\t * @file xssFilter.js\n\t * @desc xss过滤器\n\t * @author robbenmu\n\t */\n\n\tUE.plugins.xssFilter = function() {\n\n\t\tvar config = UEDITOR_CONFIG;\n\t\tvar whitList = config.whitList;\n\n\t\tfunction filter(node) {\n\n\t\t\tvar tagName = node.tagName;\n\t\t\tvar attrs = node.attrs;\n\n\t\t\tif (!whitList.hasOwnProperty(tagName)) {\n\t\t\t\tnode.parentNode.removeChild(node);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tUE.utils.each(attrs, function(val, key) {\n\n\t\t\t\tif (whitList[tagName].indexOf(key) === -1) {\n\t\t\t\t\tnode.setAttr(key);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// 添加inserthtml\\paste等操作用的过滤规则\n\t\tif (whitList && config.xssFilterRules) {\n\t\t\tthis.options.filterRules = function() {\n\n\t\t\t\tvar result = {};\n\n\t\t\t\tUE.utils.each(whitList, function(val, key) {\n\t\t\t\t\tresult[key] = function(node) {\n\t\t\t\t\t\treturn filter(node);\n\t\t\t\t\t};\n\t\t\t\t});\n\n\t\t\t\treturn result;\n\t\t\t}();\n\t\t}\n\n\t\tvar tagList = [];\n\n\t\tUE.utils.each(whitList, function(val, key) {\n\t\t\ttagList.push(key);\n\t\t});\n\n\t\t// 添加input过滤规则\n\t\t//\n\t\tif (whitList && config.inputXssFilter) {\n\t\t\tthis.addInputRule(function(root) {\n\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type !== 'element') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tfilter(node);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t// 添加output过滤规则\n\t\t//\n\t\tif (whitList && config.outputXssFilter) {\n\t\t\tthis.addOutputRule(function(root) {\n\n\t\t\t\troot.traversal(function(node) {\n\t\t\t\t\tif (node.type !== 'element') {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tfilter(node);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t};\n\n\t// ui/ui.js\n\tvar baidu = baidu || {};\n\tbaidu.editor = baidu.editor || {};\n\tUE.ui = baidu.editor.ui = {};\n\n\t// ui/uiutils.js\n\t(function() {\n\t\tvar browser = baidu.editor.browser,\n\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\n\t\tvar magic = '$EDITORUI';\n\t\tvar root = window[magic] = {};\n\t\tvar uidMagic = 'ID' + magic;\n\t\tvar uidCount = 0;\n\n\t\tvar uiUtils = baidu.editor.ui.uiUtils = {\n\t\t\tuid: function(obj) {\n\t\t\t\treturn (obj ? obj[uidMagic] || (obj[uidMagic] = ++uidCount) : ++uidCount);\n\t\t\t},\n\t\t\thook: function(fn, callback) {\n\t\t\t\tvar dg;\n\t\t\t\tif (fn && fn._callbacks) {\n\t\t\t\t\tdg = fn;\n\t\t\t\t} else {\n\t\t\t\t\tdg = function() {\n\t\t\t\t\t\tvar q;\n\t\t\t\t\t\tif (fn) {\n\t\t\t\t\t\t\tq = fn.apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar callbacks = dg._callbacks;\n\t\t\t\t\t\tvar k = callbacks.length;\n\t\t\t\t\t\twhile (k--) {\n\t\t\t\t\t\t\tvar r = callbacks[k].apply(this, arguments);\n\t\t\t\t\t\t\tif (q === undefined) {\n\t\t\t\t\t\t\t\tq = r;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn q;\n\t\t\t\t\t};\n\t\t\t\t\tdg._callbacks = [];\n\t\t\t\t}\n\t\t\t\tdg._callbacks.push(callback);\n\t\t\t\treturn dg;\n\t\t\t},\n\t\t\tcreateElementByHtml: function(html) {\n\t\t\t\tvar el = document.createElement('div');\n\t\t\t\tel.innerHTML = html;\n\t\t\t\tel = el.firstChild;\n\t\t\t\tel.parentNode.removeChild(el);\n\t\t\t\treturn el;\n\t\t\t},\n\t\t\tgetViewportElement: function() {\n\t\t\t\treturn (browser.ie && browser.quirks) ?\n\t\t\t\t\tdocument.body : document.documentElement;\n\t\t\t},\n\t\t\tgetClientRect: function(element) {\n\t\t\t\tvar bcr;\n\t\t\t\t//trace  IE6下在控制编辑器显隐时可能会报错，catch一下\n\t\t\t\ttry {\n\t\t\t\t\tbcr = element.getBoundingClientRect();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tbcr = {\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\theight: 0,\n\t\t\t\t\t\twidth: 0\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar rect = {\n\t\t\t\t\tleft: Math.round(bcr.left),\n\t\t\t\t\ttop: Math.round(bcr.top),\n\t\t\t\t\theight: Math.round(bcr.bottom - bcr.top),\n\t\t\t\t\twidth: Math.round(bcr.right - bcr.left)\n\t\t\t\t};\n\t\t\t\tvar doc;\n\t\t\t\twhile ((doc = element.ownerDocument) !== document &&\n\t\t\t\t\t(element = domUtils.getWindow(doc).frameElement)) {\n\t\t\t\t\tbcr = element.getBoundingClientRect();\n\t\t\t\t\trect.left += bcr.left;\n\t\t\t\t\trect.top += bcr.top;\n\t\t\t\t}\n\t\t\t\trect.bottom = rect.top + rect.height;\n\t\t\t\trect.right = rect.left + rect.width;\n\t\t\t\treturn rect;\n\t\t\t},\n\t\t\tgetViewportRect: function() {\n\t\t\t\tvar viewportEl = uiUtils.getViewportElement();\n\t\t\t\tvar width = (window.innerWidth || viewportEl.clientWidth) | 0;\n\t\t\t\tvar height = (window.innerHeight || viewportEl.clientHeight) | 0;\n\t\t\t\treturn {\n\t\t\t\t\tleft: 0,\n\t\t\t\t\ttop: 0,\n\t\t\t\t\theight: height,\n\t\t\t\t\twidth: width,\n\t\t\t\t\tbottom: height,\n\t\t\t\t\tright: width\n\t\t\t\t};\n\t\t\t},\n\t\t\tsetViewportOffset: function(element, offset) {\n\t\t\t\tvar rect;\n\t\t\t\tvar fixedLayer = uiUtils.getFixedLayer();\n\t\t\t\tif (element.parentNode === fixedLayer) {\n\t\t\t\t\telement.style.left = offset.left + 'px';\n\t\t\t\t\telement.style.top = offset.top + 'px';\n\t\t\t\t} else {\n\t\t\t\t\tdomUtils.setViewportOffset(element, offset);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetEventOffset: function(evt) {\n\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\tvar rect = uiUtils.getClientRect(el);\n\t\t\t\tvar offset = uiUtils.getViewportOffsetByEvent(evt);\n\t\t\t\treturn {\n\t\t\t\t\tleft: offset.left - rect.left,\n\t\t\t\t\ttop: offset.top - rect.top\n\t\t\t\t};\n\t\t\t},\n\t\t\tgetViewportOffsetByEvent: function(evt) {\n\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\tvar frameEl = domUtils.getWindow(el).frameElement;\n\t\t\t\tvar offset = {\n\t\t\t\t\tleft: evt.clientX,\n\t\t\t\t\ttop: evt.clientY\n\t\t\t\t};\n\t\t\t\tif (frameEl && el.ownerDocument !== document) {\n\t\t\t\t\tvar rect = uiUtils.getClientRect(frameEl);\n\t\t\t\t\toffset.left += rect.left;\n\t\t\t\t\toffset.top += rect.top;\n\t\t\t\t}\n\t\t\t\treturn offset;\n\t\t\t},\n\t\t\tsetGlobal: function(id, obj) {\n\t\t\t\troot[id] = obj;\n\t\t\t\treturn magic + '[\"' + id + '\"]';\n\t\t\t},\n\t\t\tunsetGlobal: function(id) {\n\t\t\t\tdelete root[id];\n\t\t\t},\n\t\t\tcopyAttributes: function(tgt, src) {\n\t\t\t\tvar attributes = src.attributes;\n\t\t\t\tvar k = attributes.length;\n\t\t\t\twhile (k--) {\n\t\t\t\t\tvar attrNode = attributes[k];\n\t\t\t\t\tif (attrNode.nodeName != 'style' && attrNode.nodeName != 'class' && (!browser.ie || attrNode.specified)) {\n\t\t\t\t\t\ttgt.setAttribute(attrNode.nodeName, attrNode.nodeValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (src.className) {\n\t\t\t\t\tdomUtils.addClass(tgt, src.className);\n\t\t\t\t}\n\t\t\t\tif (src.style.cssText) {\n\t\t\t\t\ttgt.style.cssText += ';' + src.style.cssText;\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveStyle: function(el, styleName) {\n\t\t\t\tif (el.style.removeProperty) {\n\t\t\t\t\tel.style.removeProperty(styleName);\n\t\t\t\t} else if (el.style.removeAttribute) {\n\t\t\t\t\tel.style.removeAttribute(styleName);\n\t\t\t\t} else throw '';\n\t\t\t},\n\t\t\tcontains: function(elA, elB) {\n\t\t\t\treturn elA && elB && (elA === elB ? false : (\n\t\t\t\t\telA.contains ? elA.contains(elB) :\n\t\t\t\t\telA.compareDocumentPosition(elB) & 16\n\t\t\t\t));\n\t\t\t},\n\t\t\tstartDrag: function(evt, callbacks, doc) {\n\t\t\t\tvar doc = doc || document;\n\t\t\t\tvar startX = evt.clientX;\n\t\t\t\tvar startY = evt.clientY;\n\n\t\t\t\tfunction handleMouseMove(evt) {\n\t\t\t\t\tvar x = evt.clientX - startX;\n\t\t\t\t\tvar y = evt.clientY - startY;\n\t\t\t\t\tcallbacks.ondragmove(x, y, evt);\n\t\t\t\t\tif (evt.stopPropagation) {\n\t\t\t\t\t\tevt.stopPropagation();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tevt.cancelBubble = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (doc.addEventListener) {\n\t\t\t\t\tfunction handleMouseUp(evt) {\n\t\t\t\t\t\tdoc.removeEventListener('mousemove', handleMouseMove, true);\n\t\t\t\t\t\tdoc.removeEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\t\twindow.removeEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\t\tcallbacks.ondragstop();\n\t\t\t\t\t}\n\t\t\t\t\tdoc.addEventListener('mousemove', handleMouseMove, true);\n\t\t\t\t\tdoc.addEventListener('mouseup', handleMouseUp, true);\n\t\t\t\t\twindow.addEventListener('mouseup', handleMouseUp, true);\n\n\t\t\t\t\tevt.preventDefault();\n\t\t\t\t} else {\n\t\t\t\t\tvar elm = evt.srcElement;\n\t\t\t\t\telm.setCapture();\n\n\t\t\t\t\tfunction releaseCaptrue() {\n\t\t\t\t\t\telm.releaseCapture();\n\t\t\t\t\t\telm.detachEvent('onmousemove', handleMouseMove);\n\t\t\t\t\t\telm.detachEvent('onmouseup', releaseCaptrue);\n\t\t\t\t\t\telm.detachEvent('onlosecaptrue', releaseCaptrue);\n\t\t\t\t\t\tcallbacks.ondragstop();\n\t\t\t\t\t}\n\t\t\t\t\telm.attachEvent('onmousemove', handleMouseMove);\n\t\t\t\t\telm.attachEvent('onmouseup', releaseCaptrue);\n\t\t\t\t\telm.attachEvent('onlosecaptrue', releaseCaptrue);\n\t\t\t\t\tevt.returnValue = false;\n\t\t\t\t}\n\t\t\t\tcallbacks.ondragstart();\n\t\t\t},\n\t\t\tgetFixedLayer: function() {\n\t\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\t\tif (layer == null) {\n\t\t\t\t\tlayer = document.createElement('div');\n\t\t\t\t\tlayer.id = 'edui_fixedlayer';\n\t\t\t\t\tdocument.body.appendChild(layer);\n\t\t\t\t\tif (browser.ie && browser.version <= 8) {\n\t\t\t\t\t\tlayer.style.position = 'absolute';\n\t\t\t\t\t\tbindFixedLayer();\n\t\t\t\t\t\tsetTimeout(updateFixedOffset);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlayer.style.position = 'fixed';\n\t\t\t\t\t}\n\t\t\t\t\tlayer.style.left = '0';\n\t\t\t\t\tlayer.style.top = '0';\n\t\t\t\t\tlayer.style.width = '0';\n\t\t\t\t\tlayer.style.height = '0';\n\t\t\t\t}\n\t\t\t\treturn layer;\n\t\t\t},\n\t\t\tmakeUnselectable: function(element) {\n\t\t\t\tif (browser.opera || (browser.ie && browser.version < 9)) {\n\t\t\t\t\telement.unselectable = 'on';\n\t\t\t\t\tif (element.hasChildNodes()) {\n\t\t\t\t\t\tfor (var i = 0; i < element.childNodes.length; i++) {\n\t\t\t\t\t\t\tif (element.childNodes[i].nodeType == 1) {\n\t\t\t\t\t\t\t\tuiUtils.makeUnselectable(element.childNodes[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (element.style.MozUserSelect !== undefined) {\n\t\t\t\t\t\telement.style.MozUserSelect = 'none';\n\t\t\t\t\t} else if (element.style.WebkitUserSelect !== undefined) {\n\t\t\t\t\t\telement.style.WebkitUserSelect = 'none';\n\t\t\t\t\t} else if (element.style.KhtmlUserSelect !== undefined) {\n\t\t\t\t\t\telement.style.KhtmlUserSelect = 'none';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfunction updateFixedOffset() {\n\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\tuiUtils.setViewportOffset(layer, {\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0\n\t\t\t});\n\t\t\t//        layer.style.display = 'none';\n\t\t\t//        layer.style.display = 'block';\n\n\t\t\t//#trace: 1354\n\t\t\t//        setTimeout(updateFixedOffset);\n\t\t}\n\n\t\tfunction bindFixedLayer(adjOffset) {\n\t\t\tdomUtils.on(window, 'scroll', updateFixedOffset);\n\t\t\tdomUtils.on(window, 'resize', baidu.editor.utils.defer(updateFixedOffset, 0, true));\n\t\t}\n\t})();\n\n\t// ui/uibase.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tEventBase = baidu.editor.EventBase,\n\t\t\tUIBase = baidu.editor.ui.UIBase = function() {};\n\n\t\tUIBase.prototype = {\n\t\t\tclassName: '',\n\t\t\tuiName: '',\n\t\t\tinitOptions: function(options) {\n\t\t\t\tvar me = this;\n\t\t\t\tfor (var k in options) {\n\t\t\t\t\tme[k] = options[k];\n\t\t\t\t}\n\t\t\t\tthis.id = this.id || 'edui' + uiUtils.uid();\n\t\t\t},\n\t\t\tinitUIBase: function() {\n\t\t\t\tthis._globalKey = utils.unhtml(uiUtils.setGlobal(this.id, this));\n\t\t\t},\n\t\t\trender: function(holder) {\n\t\t\t\tvar html = this.renderHtml();\n\t\t\t\tvar el = uiUtils.createElementByHtml(html);\n\n\t\t\t\t//by xuheng 给每个node添加class\n\t\t\t\tvar list = domUtils.getElementsByTagName(el, \"*\");\n\t\t\t\tvar theme = \"edui-\" + (this.theme || this.editor.options.theme);\n\t\t\t\tvar layer = document.getElementById('edui_fixedlayer');\n\t\t\t\tfor (var i = 0, node; node = list[i++];) {\n\t\t\t\t\tdomUtils.addClass(node, theme);\n\t\t\t\t}\n\t\t\t\tdomUtils.addClass(el, theme);\n\t\t\t\tif (layer) {\n\t\t\t\t\tlayer.className = \"\";\n\t\t\t\t\tdomUtils.addClass(layer, theme);\n\t\t\t\t}\n\n\t\t\t\tvar seatEl = this.getDom();\n\t\t\t\tif (seatEl != null) {\n\t\t\t\t\tseatEl.parentNode.replaceChild(el, seatEl);\n\t\t\t\t\tuiUtils.copyAttributes(el, seatEl);\n\t\t\t\t} else {\n\t\t\t\t\tif (typeof holder == 'string') {\n\t\t\t\t\t\tholder = document.getElementById(holder);\n\t\t\t\t\t}\n\t\t\t\t\tholder = holder || uiUtils.getFixedLayer();\n\t\t\t\t\tdomUtils.addClass(holder, theme);\n\t\t\t\t\tholder.appendChild(el);\n\t\t\t\t}\n\t\t\t\tthis.postRender();\n\t\t\t},\n\t\t\tgetDom: function(name) {\n\t\t\t\tif (!name) {\n\t\t\t\t\treturn document.getElementById(this.id);\n\t\t\t\t} else {\n\t\t\t\t\treturn document.getElementById(this.id + '_' + name);\n\t\t\t\t}\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tthis.fireEvent('postrender');\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '';\n\t\t\t},\n\t\t\tformatHtml: function(tpl) {\n\n\t\t\t\tvar prefix = 'edui-' + this.uiName;\n\t\t\t\treturn (tpl\n\t\t\t\t\t.replace(/##/g, this.id)\n\t\t\t\t\t.replace(/%%-/g, this.uiName ? prefix + '-' : '')\n\t\t\t\t\t.replace(/%%/g, (this.uiName ? prefix : '') + ' ' + this.className)\n\t\t\t\t\t.replace(/\\$\\$/g, this._globalKey));\n\t\t\t},\n\t\t\trenderHtml: function() {\n\t\t\t\treturn this.formatHtml(this.getHtmlTpl());\n\t\t\t},\n\t\t\tdispose: function() {\n\t\t\t\tvar box = this.getDom();\n\t\t\t\tif (box) baidu.editor.dom.domUtils.remove(box);\n\t\t\t\tuiUtils.unsetGlobal(this.id);\n\t\t\t}\n\t\t};\n\t\tutils.inherits(UIBase, EventBase);\n\t})();\n\n\t// ui/separator.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tSeparator = baidu.editor.ui.Separator = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initSeparator();\n\t\t\t};\n\t\tSeparator.prototype = {\n\t\t\tuiName: 'separator',\n\t\t\tinitSeparator: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\"></div>';\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Separator, UIBase);\n\n\t})();\n\n\t// ui/mask.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils;\n\n\t\tvar Mask = baidu.editor.ui.Mask = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initUIBase();\n\t\t};\n\t\tMask.prototype = {\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-mask %%\" onclick=\"return $$._onClick(event, this);\" onmousedown=\"return $$._onMouseDown(event, this);\"></div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tdomUtils.on(window, 'resize', function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tif (!me.isHidden()) {\n\t\t\t\t\t\t\tme._fill();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t},\n\t\t\tshow: function(zIndex) {\n\t\t\t\tthis._fill();\n\t\t\t\tthis.getDom().style.display = '';\n\t\t\t\tthis.getDom().style.zIndex = zIndex;\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\tthis.getDom().style.zIndex = '';\n\t\t\t},\n\t\t\tisHidden: function() {\n\t\t\t\treturn this.getDom().style.display == 'none';\n\t\t\t},\n\t\t\t_onMouseDown: function() {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\t_onClick: function(e, target) {\n\t\t\t\tthis.fireEvent('click', e, target);\n\t\t\t},\n\t\t\t_fill: function() {\n\t\t\t\tvar el = this.getDom();\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\tel.style.width = vpRect.width + 'px';\n\t\t\t\tel.style.height = vpRect.height + 'px';\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Mask, UIBase);\n\t})();\n\n\t// ui/popup.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tPopup = baidu.editor.ui.Popup = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initPopup();\n\t\t\t};\n\n\t\tvar allPopups = [];\n\n\t\tfunction closeAllPopup(evt, el) {\n\t\t\tfor (var i = 0; i < allPopups.length; i++) {\n\t\t\t\tvar pop = allPopups[i];\n\t\t\t\tif (!pop.isHidden()) {\n\t\t\t\t\tif (pop.queryAutoHide(el) !== false) {\n\t\t\t\t\t\tif (evt && /scroll/ig.test(evt.type) && pop.className == \"edui-wordpastepop\") return;\n\t\t\t\t\t\tpop.hide();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (allPopups.length)\n\t\t\t\tpop.editor.fireEvent(\"afterhidepop\");\n\t\t}\n\n\t\tPopup.postHide = closeAllPopup;\n\n\t\tvar ANCHOR_CLASSES = ['edui-anchor-topleft', 'edui-anchor-topright',\n\t\t\t'edui-anchor-bottomleft', 'edui-anchor-bottomright'\n\t\t];\n\t\tPopup.prototype = {\n\t\t\tSHADOW_RADIUS: 5,\n\t\t\tcontent: null,\n\t\t\t_hidden: false,\n\t\t\tautoRender: true,\n\t\t\tcanSideLeft: true,\n\t\t\tcanSideUp: true,\n\t\t\tinitPopup: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tallPopups.push(this);\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-popup %%\" onmousedown=\"return false;\">' +\n\t\t\t\t\t' <div id=\"##_body\" class=\"edui-popup-body\">' +\n\t\t\t\t\t' <iframe style=\"position:absolute;z-index:-1;left:0;top:0;background-color: transparent;\" frameborder=\"0\" width=\"100%\" height=\"100%\" src=\"about:blank\"></iframe>' +\n\t\t\t\t\t' <div class=\"edui-shadow\"></div>' +\n\t\t\t\t\t' <div id=\"##_content\" class=\"edui-popup-content\">' +\n\t\t\t\t\tthis.getContentHtmlTpl() +\n\t\t\t\t\t'  </div>' +\n\t\t\t\t\t' </div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tgetContentHtmlTpl: function() {\n\t\t\t\tif (this.content) {\n\t\t\t\t\tif (typeof this.content == 'string') {\n\t\t\t\t\t\treturn this.content;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.content.renderHtml();\n\t\t\t\t} else {\n\t\t\t\t\treturn ''\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t_UIBase_postRender: UIBase.prototype.postRender,\n\t\t\tpostRender: function() {\n\n\t\t\t\tif (this.content instanceof UIBase) {\n\t\t\t\t\tthis.content.postRender();\n\t\t\t\t}\n\n\t\t\t\t//捕获鼠标滚轮\n\t\t\t\tif (this.captureWheel && !this.captured) {\n\n\t\t\t\t\tthis.captured = true;\n\n\t\t\t\t\tvar winHeight = (document.documentElement.clientHeight || document.body.clientHeight) - 80,\n\t\t\t\t\t\t_height = this.getDom().offsetHeight,\n\t\t\t\t\t\t_top = uiUtils.getClientRect(this.combox.getDom()).top,\n\t\t\t\t\t\tcontent = this.getDom('content'),\n\t\t\t\t\t\tifr = this.getDom('body').getElementsByTagName('iframe'),\n\t\t\t\t\t\tme = this;\n\n\t\t\t\t\tifr.length && (ifr = ifr[0]);\n\n\t\t\t\t\twhile (_top + _height > winHeight) {\n\t\t\t\t\t\t_height -= 30;\n\t\t\t\t\t}\n\t\t\t\t\tcontent.style.height = _height + 'px';\n\t\t\t\t\t//同步更改iframe高度\n\t\t\t\t\tifr && (ifr.style.height = _height + 'px');\n\n\t\t\t\t\t//阻止在combox上的鼠标滚轮事件, 防止用户的正常操作被误解\n\t\t\t\t\tif (window.XMLHttpRequest) {\n\n\t\t\t\t\t\tdomUtils.on(content, ('onmousewheel' in document.body) ? 'mousewheel' : 'DOMMouseScroll', function(e) {\n\n\t\t\t\t\t\t\tif (e.preventDefault) {\n\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\te.returnValue = false;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.wheelDelta) {\n\n\t\t\t\t\t\t\t\tcontent.scrollTop -= (e.wheelDelta / 120) * 60;\n\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tcontent.scrollTop -= (e.detail / -3) * 60;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t//ie6\n\t\t\t\t\t\tdomUtils.on(this.getDom(), 'mousewheel', function(e) {\n\n\t\t\t\t\t\t\te.returnValue = false;\n\n\t\t\t\t\t\t\tme.getDom('content').scrollTop -= (e.wheelDelta / 120) * 60;\n\n\t\t\t\t\t\t});\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\tthis.fireEvent('postRenderAfter');\n\t\t\t\tthis.hide(true);\n\t\t\t\tthis._UIBase_postRender();\n\t\t\t},\n\t\t\t_doAutoRender: function() {\n\t\t\t\tif (!this.getDom() && this.autoRender) {\n\t\t\t\t\tthis.render();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmesureSize: function() {\n\t\t\t\tvar box = this.getDom('content');\n\t\t\t\treturn uiUtils.getClientRect(box);\n\t\t\t},\n\t\t\tfitSize: function() {\n\t\t\t\tif (this.captureWheel && this.sized) {\n\t\t\t\t\treturn this.__size;\n\t\t\t\t}\n\t\t\t\tthis.sized = true;\n\t\t\t\tvar popBodyEl = this.getDom('body');\n\t\t\t\tpopBodyEl.style.width = '';\n\t\t\t\tpopBodyEl.style.height = '';\n\t\t\t\tvar size = this.mesureSize();\n\t\t\t\tif (this.captureWheel) {\n\t\t\t\t\tpopBodyEl.style.width = -(-20 - size.width) + 'px';\n\t\t\t\t\tvar height = parseInt(this.getDom('content').style.height, 10);\n\t\t\t\t\t!window.isNaN(height) && (size.height = height);\n\t\t\t\t} else {\n\t\t\t\t\tpopBodyEl.style.width = size.width + 'px';\n\t\t\t\t}\n\t\t\t\tpopBodyEl.style.height = size.height + 'px';\n\t\t\t\tthis.__size = size;\n\t\t\t\tthis.captureWheel && (this.getDom('content').style.overflow = 'auto');\n\t\t\t\treturn size;\n\t\t\t},\n\t\t\tshowAnchor: function(element, hoz) {\n\t\t\t\tthis.showAnchorRect(uiUtils.getClientRect(element), hoz);\n\t\t\t},\n\t\t\tshowAnchorRect: function(rect, hoz, adj) {\n\t\t\t\tthis._doAutoRender();\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\tthis.getDom().style.visibility = 'hidden';\n\t\t\t\tthis._show();\n\t\t\t\tvar popSize = this.fitSize();\n\n\t\t\t\tvar sideLeft, sideUp, left, top;\n\t\t\t\tif (hoz) {\n\t\t\t\t\tsideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n\t\t\t\t\tsideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n\t\t\t\t\tleft = (sideLeft ? rect.left - popSize.width : rect.right);\n\t\t\t\t\ttop = (sideUp ? rect.bottom - popSize.height : rect.top);\n\t\t\t\t} else {\n\t\t\t\t\tsideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n\t\t\t\t\tsideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n\t\t\t\t\tleft = (sideLeft ? rect.right - popSize.width : rect.left);\n\t\t\t\t\ttop = (sideUp ? rect.top - popSize.height : rect.bottom);\n\t\t\t\t}\n\n\t\t\t\tvar popEl = this.getDom();\n\t\t\t\tuiUtils.setViewportOffset(popEl, {\n\t\t\t\t\tleft: left,\n\t\t\t\t\ttop: top\n\t\t\t\t});\n\t\t\t\tdomUtils.removeClasses(popEl, ANCHOR_CLASSES);\n\t\t\t\tpopEl.className += ' ' + ANCHOR_CLASSES[(sideUp ? 1 : 0) * 2 + (sideLeft ? 1 : 0)];\n\t\t\t\tif (this.editor) {\n\t\t\t\t\tpopEl.style.zIndex = this.editor.container.style.zIndex * 1 + 10;\n\t\t\t\t\tbaidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = popEl.style.zIndex - 1;\n\t\t\t\t}\n\t\t\t\tthis.getDom().style.visibility = 'visible';\n\n\t\t\t},\n\t\t\tshowAt: function(offset) {\n\t\t\t\tvar left = offset.left;\n\t\t\t\tvar top = offset.top;\n\t\t\t\tvar rect = {\n\t\t\t\t\tleft: left,\n\t\t\t\t\ttop: top,\n\t\t\t\t\tright: left,\n\t\t\t\t\tbottom: top,\n\t\t\t\t\theight: 0,\n\t\t\t\t\twidth: 0\n\t\t\t\t};\n\t\t\t\tthis.showAnchorRect(rect, false, true);\n\t\t\t},\n\t\t\t_show: function() {\n\t\t\t\tif (this._hidden) {\n\t\t\t\t\tvar box = this.getDom();\n\t\t\t\t\tbox.style.display = '';\n\t\t\t\t\tthis._hidden = false;\n\t\t\t\t\t//                if (box.setActive) {\n\t\t\t\t\t//                    box.setActive();\n\t\t\t\t\t//                }\n\t\t\t\t\tthis.fireEvent('show');\n\t\t\t\t}\n\t\t\t},\n\t\t\tisHidden: function() {\n\t\t\t\treturn this._hidden;\n\t\t\t},\n\t\t\tshow: function() {\n\t\t\t\tthis._doAutoRender();\n\t\t\t\tthis._show();\n\t\t\t},\n\t\t\thide: function(notNofity) {\n\t\t\t\tif (!this._hidden && this.getDom()) {\n\t\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\tif (!notNofity) {\n\t\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tqueryAutoHide: function(el) {\n\t\t\t\treturn !el || !uiUtils.contains(this.getDom(), el);\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Popup, UIBase);\n\n\t\tdomUtils.on(document, 'mousedown', function(evt) {\n\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\tcloseAllPopup(evt, el);\n\t\t});\n\t\tdomUtils.on(window, 'scroll', function(evt, el) {\n\t\t\tcloseAllPopup(evt, el);\n\t\t});\n\n\t})();\n\n\t// ui/colorpicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tColorPicker = baidu.editor.ui.ColorPicker = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.noColorText = this.noColorText || this.editor.getLang(\"clearColor\");\n\t\t\t\tthis.initUIBase();\n\t\t\t};\n\n\t\tColorPicker.prototype = {\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn genColorPicker(this.noColorText, this.editor);\n\t\t\t},\n\t\t\t_onTableClick: function(evt) {\n\t\t\t\tvar tgt = evt.target || evt.srcElement;\n\t\t\t\tvar color = tgt.getAttribute('data-color');\n\t\t\t\tif (color) {\n\t\t\t\t\tthis.fireEvent('pickcolor', color);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onTableOver: function(evt) {\n\t\t\t\tvar tgt = evt.target || evt.srcElement;\n\t\t\t\tvar color = tgt.getAttribute('data-color');\n\t\t\t\tif (color) {\n\t\t\t\t\tthis.getDom('preview').style.backgroundColor = color;\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onTableOut: function() {\n\t\t\t\tthis.getDom('preview').style.backgroundColor = '';\n\t\t\t},\n\t\t\t_onPickNoColor: function() {\n\t\t\t\tthis.fireEvent('picknocolor');\n\t\t\t}\n\t\t};\n\t\tutils.inherits(ColorPicker, UIBase);\n\n\t\tvar COLORS = (\n\t\t\t'ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,' +\n\t\t\t'f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,' +\n\t\t\t'd8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,' +\n\t\t\t'bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,' +\n\t\t\t'a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,' +\n\t\t\t'7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,' +\n\t\t\t'c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,').split(',');\n\n\t\tfunction genColorPicker(noColorText, editor) {\n\t\t\tvar html = '<div id=\"##\" class=\"edui-colorpicker %%\">' +\n\t\t\t\t'<div class=\"edui-colorpicker-topbar edui-clearfix\">' +\n\t\t\t\t'<div unselectable=\"on\" id=\"##_preview\" class=\"edui-colorpicker-preview\"></div>' +\n\t\t\t\t'<div unselectable=\"on\" class=\"edui-colorpicker-nocolor\" onclick=\"$$._onPickNoColor(event, this);\">' + noColorText + '</div>' +\n\t\t\t\t'</div>' +\n\t\t\t\t'<table  class=\"edui-box\" style=\"border-collapse: collapse;\" onmouseover=\"$$._onTableOver(event, this);\" onmouseout=\"$$._onTableOut(event, this);\" onclick=\"return $$._onTableClick(event, this);\" cellspacing=\"0\" cellpadding=\"0\">' +\n\t\t\t\t'<tr style=\"border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px\"><td colspan=\"10\">' + editor.getLang(\"themeColor\") + '</td> </tr>' +\n\t\t\t\t'<tr class=\"edui-colorpicker-tablefirstrow\" >';\n\t\t\tfor (var i = 0; i < COLORS.length; i++) {\n\t\t\t\tif (i && i % 10 === 0) {\n\t\t\t\t\thtml += '</tr>' + (i == 60 ? '<tr style=\"border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;\"><td colspan=\"10\">' + editor.getLang(\"standardColor\") + '</td></tr>' : '') + '<tr' + (i == 60 ? ' class=\"edui-colorpicker-tablefirstrow\"' : '') + '>';\n\t\t\t\t}\n\t\t\t\thtml += i < 70 ? '<td style=\"padding: 0 2px;\"><a hidefocus title=\"' + COLORS[i] + '\" onclick=\"return false;\" href=\"javascript:\" unselectable=\"on\" class=\"edui-box edui-colorpicker-colorcell\"' +\n\t\t\t\t\t' data-color=\"#' + COLORS[i] + '\"' +\n\t\t\t\t\t' style=\"background-color:#' + COLORS[i] + ';border:solid #ccc;' +\n\t\t\t\t\t(i < 10 || i >= 60 ? 'border-width:1px;' :\n\t\t\t\t\t\ti >= 10 && i < 20 ? 'border-width:1px 1px 0 1px;' :\n\n\t\t\t\t\t\t'border-width:0 1px 0 1px;') +\n\t\t\t\t\t'\"' +\n\t\t\t\t\t'></a></td>' : '';\n\t\t\t}\n\t\t\thtml += '</tr></table></div>';\n\t\t\treturn html;\n\t\t}\n\t})();\n\n\t// ui/tablepicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\tvar TablePicker = baidu.editor.ui.TablePicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initTablePicker();\n\t\t};\n\t\tTablePicker.prototype = {\n\t\t\tdefaultNumRows: 10,\n\t\t\tdefaultNumCols: 10,\n\t\t\tmaxNumRows: 20,\n\t\t\tmaxNumCols: 20,\n\t\t\tnumRows: 10,\n\t\t\tnumCols: 10,\n\t\t\tlengthOfCellSide: 22,\n\t\t\tinitTablePicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar me = this;\n\t\t\t\treturn '<div id=\"##\" class=\"edui-tablepicker %%\">' +\n\t\t\t\t\t'<div class=\"edui-tablepicker-body\">' +\n\t\t\t\t\t'<div class=\"edui-infoarea\">' +\n\t\t\t\t\t'<span id=\"##_label\" class=\"edui-label\"></span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"edui-pickarea\"' +\n\t\t\t\t\t' onmousemove=\"$$._onMouseMove(event, this);\"' +\n\t\t\t\t\t' onmouseover=\"$$._onMouseOver(event, this);\"' +\n\t\t\t\t\t' onmouseout=\"$$._onMouseOut(event, this);\"' +\n\t\t\t\t\t' onclick=\"$$._onClick(event, this);\"' +\n\t\t\t\t\t'>' +\n\t\t\t\t\t'<div id=\"##_overlay\" class=\"edui-overlay\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render,\n\t\t\trender: function(holder) {\n\t\t\t\tthis._UIBase_render(holder);\n\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_row\") + ' x 0' + this.editor.getLang(\"t_col\");\n\t\t\t},\n\t\t\t_track: function(numCols, numRows) {\n\t\t\t\tvar style = this.getDom('overlay').style;\n\t\t\t\tvar sideLen = this.lengthOfCellSide;\n\t\t\t\tstyle.width = numCols * sideLen + 'px';\n\t\t\t\tstyle.height = numRows * sideLen + 'px';\n\t\t\t\tvar label = this.getDom('label');\n\t\t\t\tlabel.innerHTML = numCols + this.editor.getLang(\"t_col\") + ' x ' + numRows + this.editor.getLang(\"t_row\");\n\t\t\t\tthis.numCols = numCols;\n\t\t\t\tthis.numRows = numRows;\n\t\t\t},\n\t\t\t_onMouseOver: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget || evt.fromElement;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_col\") + ' x 0' + this.editor.getLang(\"t_row\");\n\t\t\t\t\tthis.getDom('overlay').style.visibility = '';\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onMouseOut: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget || evt.toElement;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.getDom('label').innerHTML = '0' + this.editor.getLang(\"t_col\") + ' x 0' + this.editor.getLang(\"t_row\");\n\t\t\t\t\tthis.getDom('overlay').style.visibility = 'hidden';\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onMouseMove: function(evt, el) {\n\t\t\t\tvar style = this.getDom('overlay').style;\n\t\t\t\tvar offset = uiUtils.getEventOffset(evt);\n\t\t\t\tvar sideLen = this.lengthOfCellSide;\n\t\t\t\tvar numCols = Math.ceil(offset.left / sideLen);\n\t\t\t\tvar numRows = Math.ceil(offset.top / sideLen);\n\t\t\t\tthis._track(numCols, numRows);\n\t\t\t},\n\t\t\t_onClick: function() {\n\t\t\t\tthis.fireEvent('picktable', this.numCols, this.numRows);\n\t\t\t}\n\t\t};\n\t\tutils.inherits(TablePicker, UIBase);\n\t})();\n\n\t// ui/stateful.js\n\t(function() {\n\t\tvar browser = baidu.editor.browser,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils;\n\n\t\tvar TPL_STATEFUL = 'onmousedown=\"$$.Stateful_onMouseDown(event, this);\"' +\n\t\t\t' onmouseup=\"$$.Stateful_onMouseUp(event, this);\"' +\n\t\t\t(browser.ie ? (\n\t\t\t\t' onmouseenter=\"$$.Stateful_onMouseEnter(event, this);\"' +\n\t\t\t\t' onmouseleave=\"$$.Stateful_onMouseLeave(event, this);\"') : (\n\t\t\t\t' onmouseover=\"$$.Stateful_onMouseOver(event, this);\"' +\n\t\t\t\t' onmouseout=\"$$.Stateful_onMouseOut(event, this);\"'));\n\n\t\tbaidu.editor.ui.Stateful = {\n\t\t\talwalysHoverable: false,\n\t\t\ttarget: null, //目标元素和this指向dom不一样\n\t\t\tStateful_init: function() {\n\t\t\t\tthis._Stateful_dGetHtmlTpl = this.getHtmlTpl;\n\t\t\t\tthis.getHtmlTpl = this.Stateful_getHtmlTpl;\n\t\t\t},\n\t\t\tStateful_getHtmlTpl: function() {\n\t\t\t\tvar tpl = this._Stateful_dGetHtmlTpl();\n\t\t\t\t// 使用function避免$转义\n\t\t\t\treturn tpl.replace(/stateful/g, function() {\n\t\t\t\t\treturn TPL_STATEFUL;\n\t\t\t\t});\n\t\t\t},\n\t\t\tStateful_onMouseEnter: function(evt, el) {\n\t\t\t\tthis.target = el;\n\t\t\t\tif (!this.isDisabled() || this.alwalysHoverable) {\n\t\t\t\t\tthis.addState('hover');\n\t\t\t\t\tthis.fireEvent('over');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseLeave: function(evt, el) {\n\t\t\t\tif (!this.isDisabled() || this.alwalysHoverable) {\n\t\t\t\t\tthis.removeState('hover');\n\t\t\t\t\tthis.removeState('active');\n\t\t\t\t\tthis.fireEvent('out');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseOver: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.Stateful_onMouseEnter(evt, el);\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseOut: function(evt, el) {\n\t\t\t\tvar rel = evt.relatedTarget;\n\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\tthis.Stateful_onMouseLeave(evt, el);\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseDown: function(evt, el) {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.addState('active');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_onMouseUp: function(evt, el) {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.removeState('active');\n\t\t\t\t}\n\t\t\t},\n\t\t\tStateful_postRender: function() {\n\t\t\t\tif (this.disabled && !this.hasState('disabled')) {\n\t\t\t\t\tthis.addState('disabled');\n\t\t\t\t}\n\t\t\t},\n\t\t\thasState: function(state) {\n\t\t\t\treturn domUtils.hasClass(this.getStateDom(), 'edui-state-' + state);\n\t\t\t},\n\t\t\taddState: function(state) {\n\t\t\t\tif (!this.hasState(state)) {\n\t\t\t\t\tthis.getStateDom().className += ' edui-state-' + state;\n\t\t\t\t}\n\t\t\t},\n\t\t\tremoveState: function(state) {\n\t\t\t\tif (this.hasState(state)) {\n\t\t\t\t\tdomUtils.removeClasses(this.getStateDom(), ['edui-state-' + state]);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.getDom('state');\n\t\t\t},\n\t\t\tisChecked: function() {\n\t\t\t\treturn this.hasState('checked');\n\t\t\t},\n\t\t\tsetChecked: function(checked) {\n\t\t\t\tif (!this.isDisabled() && checked) {\n\t\t\t\t\tthis.addState('checked');\n\t\t\t\t} else {\n\t\t\t\t\tthis.removeState('checked');\n\t\t\t\t}\n\t\t\t},\n\t\t\tisDisabled: function() {\n\t\t\t\treturn this.hasState('disabled');\n\t\t\t},\n\t\t\tsetDisabled: function(disabled) {\n\t\t\t\tif (disabled) {\n\t\t\t\t\tthis.removeState('hover');\n\t\t\t\t\tthis.removeState('checked');\n\t\t\t\t\tthis.removeState('active');\n\t\t\t\t\tthis.addState('disabled');\n\t\t\t\t} else {\n\t\t\t\t\tthis.removeState('disabled');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t})();\n\n\t// ui/button.js\n\t///import core\n\t///import uicore\n\t///import ui/stateful.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tButton = baidu.editor.ui.Button = function(options) {\n\t\t\t\tif (options.name) {\n\t\t\t\t\tvar btnName = options.name;\n\t\t\t\t\tvar cssRules = options.cssRules;\n\t\t\t\t\tif (!options.className) {\n\t\t\t\t\t\toptions.className = 'edui-for-' + btnName;\n\t\t\t\t\t}\n\t\t\t\t\toptions.cssRules = '.edui-default  .edui-for-' + btnName + ' .edui-icon {' + cssRules + '}'\n\t\t\t\t}\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initButton();\n\t\t\t};\n\t\tButton.prototype = {\n\t\t\tuiName: 'button',\n\t\t\tlabel: '',\n\t\t\ttitle: '',\n\t\t\tshowIcon: true,\n\t\t\tshowText: true,\n\t\t\tcssRules: '',\n\t\t\tinitButton: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t\tif (this.cssRules) {\n\t\t\t\t\tutils.cssRule('edui-customize-' + this.name + '-style', this.cssRules);\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\">' +\n\t\t\t\t\t'<div id=\"##_state\" stateful>' +\n\t\t\t\t\t'<div class=\"%%-wrap\"><div id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n\t\t\t\t\t' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\">' +\n\t\t\t\t\t(this.showIcon ? '<div class=\"edui-box edui-icon\"></div>' : '') +\n\t\t\t\t\t(this.showText ? '<div class=\"edui-box edui-label\">' + this.label + '</div>' : '') +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div></div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tthis.Stateful_postRender();\n\t\t\t\tthis.setDisabled(this.disabled)\n\t\t\t},\n\t\t\t_onMouseDown: function(e) {\n\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\ttagName = target && target.tagName && target.tagName.toLowerCase();\n\t\t\t\tif (tagName == 'input' || tagName == 'object' || tagName == 'object') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onClick: function() {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.fireEvent('click');\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetTitle: function(text) {\n\t\t\t\tvar label = this.getDom('label');\n\t\t\t\tlabel.innerHTML = text;\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Button, UIBase);\n\t\tutils.extend(Button.prototype, Stateful);\n\n\t})();\n\n\t// ui/splitbutton.js\n\t///import core\n\t///import uicore\n\t///import ui/stateful.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initSplitButton();\n\t\t\t};\n\t\tSplitButton.prototype = {\n\t\t\tpopup: null,\n\t\t\tuiName: 'splitbutton',\n\t\t\ttitle: '',\n\t\t\tinitSplitButton: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t\tvar me = this;\n\t\t\t\tif (this.popup != null) {\n\t\t\t\t\tvar popup = this.popup;\n\t\t\t\t\tthis.popup = null;\n\t\t\t\t\tthis.setPopup(popup);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_UIBase_postRender: UIBase.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tthis.Stateful_postRender();\n\t\t\t\tthis._UIBase_postRender();\n\t\t\t},\n\t\t\tsetPopup: function(popup) {\n\t\t\t\tif (this.popup === popup) return;\n\t\t\t\tif (this.popup != null) {\n\t\t\t\t\tthis.popup.dispose();\n\t\t\t\t}\n\t\t\t\tpopup.addListener('show', utils.bind(this._onPopupShow, this));\n\t\t\t\tpopup.addListener('hide', utils.bind(this._onPopupHide, this));\n\t\t\t\tpopup.addListener('postrender', utils.bind(function() {\n\t\t\t\t\tpopup.getDom('body').appendChild(\n\t\t\t\t\t\tuiUtils.createElementByHtml('<div id=\"' +\n\t\t\t\t\t\t\tthis.popup.id + '_bordereraser\" class=\"edui-bordereraser edui-background\" style=\"width:' +\n\t\t\t\t\t\t\t(uiUtils.getClientRect(this.getDom()).width + 20) + 'px\"></div>')\n\t\t\t\t\t);\n\t\t\t\t\tpopup.getDom().className += ' ' + this.className;\n\t\t\t\t}, this));\n\t\t\t\tthis.popup = popup;\n\t\t\t},\n\t\t\t_onPopupShow: function() {\n\t\t\t\tthis.addState('opened');\n\t\t\t},\n\t\t\t_onPopupHide: function() {\n\t\t\t\tthis.removeState('opened');\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-box %%\">' +\n\t\t\t\t\t'<div ' + (this.title ? 'title=\"' + this.title + '\"' : '') + ' id=\"##_state\" stateful><div class=\"%%-body\">' +\n\t\t\t\t\t'<div id=\"##_button_body\" class=\"edui-box edui-button-body\" onclick=\"$$._onButtonClick(event, this);\">' +\n\t\t\t\t\t'<div class=\"edui-box edui-icon\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-splitborder\"></div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-arrow\" onclick=\"$$._onArrowClick();\"></div>' +\n\t\t\t\t\t'</div></div></div>';\n\t\t\t},\n\t\t\tshowPopup: function() {\n\t\t\t\t// 当popup往上弹出的时候，做特殊处理\n\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\trect.top -= this.popup.SHADOW_RADIUS;\n\t\t\t\trect.height += this.popup.SHADOW_RADIUS;\n\t\t\t\tthis.popup.showAnchorRect(rect);\n\t\t\t},\n\t\t\t_onArrowClick: function(event, el) {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onButtonClick: function() {\n\t\t\t\tif (!this.isDisabled()) {\n\t\t\t\t\tthis.fireEvent('buttonclick');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(SplitButton, UIBase);\n\t\tutils.extend(SplitButton.prototype, Stateful, true);\n\n\t})();\n\n\t// ui/colorbutton.js\n\t///import core\n\t///import uicore\n\t///import ui/colorpicker.js\n\t///import ui/popup.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tColorPicker = baidu.editor.ui.ColorPicker,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tColorButton = baidu.editor.ui.ColorButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initColorButton();\n\t\t\t};\n\t\tColorButton.prototype = {\n\t\t\tinitColorButton: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tcontent: new ColorPicker({\n\t\t\t\t\t\tnoColorText: me.editor.getLang(\"clearColor\"),\n\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\tonpickcolor: function(t, color) {\n\t\t\t\t\t\t\tme._onPickColor(color);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonpicknocolor: function(t, color) {\n\t\t\t\t\t\t\tme._onPickNoColor(color);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\teditor: me.editor\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\t_SplitButton_postRender: SplitButton.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tthis._SplitButton_postRender();\n\t\t\t\tthis.getDom('button_body').appendChild(\n\t\t\t\t\tuiUtils.createElementByHtml('<div id=\"' + this.id + '_colorlump\" class=\"edui-colorlump\"></div>')\n\t\t\t\t);\n\t\t\t\tthis.getDom().className += ' edui-colorbutton';\n\t\t\t},\n\t\t\tsetColor: function(color) {\n\t\t\t\tthis.getDom('colorlump').style.backgroundColor = color;\n\t\t\t\tthis.color = color;\n\t\t\t},\n\t\t\t_onPickColor: function(color) {\n\t\t\t\tif (this.fireEvent('pickcolor', color) !== false) {\n\t\t\t\t\tthis.setColor(color);\n\t\t\t\t\tthis.popup.hide();\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onPickNoColor: function(color) {\n\t\t\t\tif (this.fireEvent('picknocolor') !== false) {\n\t\t\t\t\tthis.popup.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(ColorButton, SplitButton);\n\n\t})();\n\n\t// ui/tablebutton.js\n\t///import core\n\t///import uicore\n\t///import ui/popup.js\n\t///import ui/tablepicker.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tTablePicker = baidu.editor.ui.TablePicker,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tTableButton = baidu.editor.ui.TableButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initTableButton();\n\t\t\t};\n\t\tTableButton.prototype = {\n\t\t\tinitTableButton: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tcontent: new TablePicker({\n\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\tonpicktable: function(t, numCols, numRows) {\n\t\t\t\t\t\t\tme._onPickTable(numCols, numRows);\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\t'editor': me.editor\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\t_onPickTable: function(numCols, numRows) {\n\t\t\t\tif (this.fireEvent('picktable', numCols, numRows) !== false) {\n\t\t\t\t\tthis.popup.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(TableButton, SplitButton);\n\n\t})();\n\n\t// ui/autotypesetpicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\tvar AutoTypeSetPicker = baidu.editor.ui.AutoTypeSetPicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initAutoTypeSetPicker();\n\t\t};\n\t\tAutoTypeSetPicker.prototype = {\n\t\t\tinitAutoTypeSetPicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar me = this.editor,\n\t\t\t\t\topt = me.options.autotypeset,\n\t\t\t\t\tlang = me.getLang(\"autoTypeSet\");\n\n\t\t\t\tvar textAlignInputName = 'textAlignValue' + me.uid,\n\t\t\t\t\timageBlockInputName = 'imageBlockLineValue' + me.uid,\n\t\t\t\t\tsymbolConverInputName = 'symbolConverValue' + me.uid;\n\n\t\t\t\treturn '<div id=\"##\" class=\"edui-autotypesetpicker %%\">' +\n\t\t\t\t\t'<div class=\"edui-autotypesetpicker-body\">' +\n\t\t\t\t\t'<table >' +\n\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"mergeEmptyline\" ' + (opt[\"mergeEmptyline\"] ? \"checked\" : \"\") + '>' + lang.mergeLine + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"removeEmptyline\" ' + (opt[\"removeEmptyline\"] ? \"checked\" : \"\") + '>' + lang.delLine + '</td></tr>' +\n\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"removeClass\" ' + (opt[\"removeClass\"] ? \"checked\" : \"\") + '>' + lang.removeFormat + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"indent\" ' + (opt[\"indent\"] ? \"checked\" : \"\") + '>' + lang.indent + '</td></tr>' +\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"textAlign\" ' + (opt[\"textAlign\"] ? \"checked\" : \"\") + '>' + lang.alignment + '</td>' +\n\t\t\t\t\t'<td colspan=\"2\" id=\"' + textAlignInputName + '\">' +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"left\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"left\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyleft\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"center\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"center\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifycenter\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + textAlignInputName + '\" value=\"right\" ' + ((opt[\"textAlign\"] && opt[\"textAlign\"] == \"right\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyright\") +\n\t\t\t\t\t'</td>' +\n\t\t\t\t\t'</tr>' +\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"imageBlockLine\" ' + (opt[\"imageBlockLine\"] ? \"checked\" : \"\") + '>' + lang.imageFloat + '</td>' +\n\t\t\t\t\t'<td nowrap id=\"' + imageBlockInputName + '\">' +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"none\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"none\") ? \"checked\" : \"\") + '>' + me.getLang(\"default\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"left\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"left\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyleft\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"center\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"center\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifycenter\") +\n\t\t\t\t\t'<input type=\"radio\" name=\"' + imageBlockInputName + '\" value=\"right\" ' + ((opt[\"imageBlockLine\"] && opt[\"imageBlockLine\"] == \"right\") ? \"checked\" : \"\") + '>' + me.getLang(\"justifyright\") +\n\t\t\t\t\t'</td>' +\n\t\t\t\t\t'</tr>' +\n\t\t\t\t\t'<tr><td nowrap><input type=\"checkbox\" name=\"clearFontSize\" ' + (opt[\"clearFontSize\"] ? \"checked\" : \"\") + '>' + lang.removeFontsize + '</td><td colspan=\"2\"><input type=\"checkbox\" name=\"clearFontFamily\" ' + (opt[\"clearFontFamily\"] ? \"checked\" : \"\") + '>' + lang.removeFontFamily + '</td></tr>' +\n\t\t\t\t\t'<tr><td nowrap colspan=\"3\"><input type=\"checkbox\" name=\"removeEmptyNode\" ' + (opt[\"removeEmptyNode\"] ? \"checked\" : \"\") + '>' + lang.removeHtml + '</td></tr>' +\n\t\t\t\t\t'<tr><td nowrap colspan=\"3\"><input type=\"checkbox\" name=\"pasteFilter\" ' + (opt[\"pasteFilter\"] ? \"checked\" : \"\") + '>' + lang.pasteFilter + '</td></tr>' +\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\t'<td nowrap><input type=\"checkbox\" name=\"symbolConver\" ' + (opt[\"bdc2sb\"] || opt[\"tobdc\"] ? \"checked\" : \"\") + '>' + lang.symbol + '</td>' +\n\t\t\t\t\t'<td id=\"' + symbolConverInputName + '\">' +\n\t\t\t\t\t'<input type=\"radio\" name=\"bdc\" value=\"bdc2sb\" ' + (opt[\"bdc2sb\"] ? \"checked\" : \"\") + '>' + lang.bdc2sb +\n\t\t\t\t\t'<input type=\"radio\" name=\"bdc\" value=\"tobdc\" ' + (opt[\"tobdc\"] ? \"checked\" : \"\") + '>' + lang.tobdc + '' +\n\t\t\t\t\t'</td>' +\n\t\t\t\t\t'<td nowrap align=\"right\"><button >' + lang.run + '</button></td>' +\n\t\t\t\t\t'</tr>' +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t};\n\t\tutils.inherits(AutoTypeSetPicker, UIBase);\n\t})();\n\n\t// ui/autotypesetbutton.js\n\t///import core\n\t///import uicore\n\t///import ui/popup.js\n\t///import ui/autotypesetpicker.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tAutoTypeSetPicker = baidu.editor.ui.AutoTypeSetPicker,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tAutoTypeSetButton = baidu.editor.ui.AutoTypeSetButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initAutoTypeSetButton();\n\t\t\t};\n\n\t\tfunction getPara(me) {\n\n\t\t\tvar opt = {},\n\t\t\t\tcont = me.getDom(),\n\t\t\t\teditorId = me.editor.uid,\n\t\t\t\tinputType = null,\n\t\t\t\tattrName = null,\n\t\t\t\tipts = domUtils.getElementsByTagName(cont, \"input\");\n\t\t\tfor (var i = ipts.length - 1, ipt; ipt = ipts[i--];) {\n\t\t\t\tinputType = ipt.getAttribute(\"type\");\n\t\t\t\tif (inputType == \"checkbox\") {\n\t\t\t\t\tattrName = ipt.getAttribute(\"name\");\n\t\t\t\t\topt[attrName] && delete opt[attrName];\n\t\t\t\t\tif (ipt.checked) {\n\t\t\t\t\t\tvar attrValue = document.getElementById(attrName + \"Value\" + editorId);\n\t\t\t\t\t\tif (attrValue) {\n\t\t\t\t\t\t\tif (/input/ig.test(attrValue.tagName)) {\n\t\t\t\t\t\t\t\topt[attrName] = attrValue.value;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar iptChilds = attrValue.getElementsByTagName(\"input\");\n\t\t\t\t\t\t\t\tfor (var j = iptChilds.length - 1, iptchild; iptchild = iptChilds[j--];) {\n\t\t\t\t\t\t\t\t\tif (iptchild.checked) {\n\t\t\t\t\t\t\t\t\t\topt[attrName] = iptchild.value;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\topt[attrName] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\topt[attrName] = false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\topt[ipt.getAttribute(\"value\")] = ipt.checked;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tvar selects = domUtils.getElementsByTagName(cont, \"select\");\n\t\t\tfor (var i = 0, si; si = selects[i++];) {\n\t\t\t\tvar attr = si.getAttribute('name');\n\t\t\t\topt[attr] = opt[attr] ? si.value : '';\n\t\t\t}\n\n\t\t\tutils.extend(me.editor.options.autotypeset, opt);\n\n\t\t\tme.editor.setPreferences('autotypeset', opt);\n\t\t}\n\n\t\tAutoTypeSetButton.prototype = {\n\t\t\tinitAutoTypeSetButton: function() {\n\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\t//传入配置参数\n\t\t\t\t\tcontent: new AutoTypeSetPicker({\n\t\t\t\t\t\teditor: me.editor\n\t\t\t\t\t}),\n\t\t\t\t\t'editor': me.editor,\n\t\t\t\t\thide: function() {\n\t\t\t\t\t\tif (!this._hidden && this.getDom()) {\n\t\t\t\t\t\t\tgetPara(this);\n\t\t\t\t\t\t\tthis.getDom().style.display = 'none';\n\t\t\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar flag = 0;\n\t\t\t\tthis.popup.addListener('postRenderAfter', function() {\n\t\t\t\t\tvar popupUI = this;\n\t\t\t\t\tif (flag) return;\n\t\t\t\t\tvar cont = this.getDom(),\n\t\t\t\t\t\tbtn = cont.getElementsByTagName('button')[0];\n\n\t\t\t\t\tbtn.onclick = function() {\n\t\t\t\t\t\tgetPara(popupUI);\n\t\t\t\t\t\tme.editor.execCommand('autotypeset');\n\t\t\t\t\t\tpopupUI.hide()\n\t\t\t\t\t};\n\n\t\t\t\t\tdomUtils.on(cont, 'click', function(e) {\n\t\t\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\t\t\teditorId = me.editor.uid;\n\t\t\t\t\t\tif (target && target.tagName == 'INPUT') {\n\n\t\t\t\t\t\t\t// 点击图片浮动的checkbox,去除对应的radio\n\t\t\t\t\t\t\tif (target.name == 'imageBlockLine' || target.name == 'textAlign' || target.name == 'symbolConver') {\n\t\t\t\t\t\t\t\tvar checked = target.checked,\n\t\t\t\t\t\t\t\t\tradioTd = document.getElementById(target.name + 'Value' + editorId),\n\t\t\t\t\t\t\t\t\tradios = radioTd.getElementsByTagName('input'),\n\t\t\t\t\t\t\t\t\tdefalutSelect = {\n\t\t\t\t\t\t\t\t\t\t'imageBlockLine': 'none',\n\t\t\t\t\t\t\t\t\t\t'textAlign': 'left',\n\t\t\t\t\t\t\t\t\t\t'symbolConver': 'tobdc'\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tfor (var i = 0; i < radios.length; i++) {\n\t\t\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\t\t\tif (radios[i].value == defalutSelect[target.name]) {\n\t\t\t\t\t\t\t\t\t\t\tradios[i].checked = 'checked';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tradios[i].checked = false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t// 点击radio,选中对应的checkbox\n\t\t\t\t\t\t\tif (target.name == ('imageBlockLineValue' + editorId) || target.name == ('textAlignValue' + editorId) || target.name == 'bdc') {\n\t\t\t\t\t\t\t\tvar checkboxs = target.parentNode.previousSibling.getElementsByTagName('input');\n\t\t\t\t\t\t\t\tcheckboxs && (checkboxs[0].checked = true);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tgetPara(popupUI);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tflag = 1;\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t}\n\t\t};\n\t\tutils.inherits(AutoTypeSetButton, SplitButton);\n\n\t})();\n\n\t// ui/cellalignpicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\t/**\n\t\t * 该参数将新增一个参数： selected， 参数类型为一个Object， 形如{ 'align': 'center', 'valign': 'top' }， 表示单元格的初始\n\t\t * 对齐状态为： 竖直居上，水平居中; 其中 align的取值为：'center', 'left', 'right'; valign的取值为: 'top', 'middle', 'bottom'\n\t\t * @update 2013/4/2 hancong03@baidu.com\n\t\t */\n\t\tvar CellAlignPicker = baidu.editor.ui.CellAlignPicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initSelected();\n\t\t\tthis.initCellAlignPicker();\n\t\t};\n\t\tCellAlignPicker.prototype = {\n\t\t\t//初始化选中状态， 该方法将根据传递进来的参数获取到应该选中的对齐方式图标的索引\n\t\t\tinitSelected: function() {\n\n\t\t\t\tvar status = {\n\n\t\t\t\t\t\tvalign: {\n\t\t\t\t\t\t\ttop: 0,\n\t\t\t\t\t\t\tmiddle: 1,\n\t\t\t\t\t\t\tbottom: 2\n\t\t\t\t\t\t},\n\t\t\t\t\t\talign: {\n\t\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\t\tcenter: 1,\n\t\t\t\t\t\t\tright: 2\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcount: 3\n\n\t\t\t\t\t},\n\t\t\t\t\tresult = -1;\n\n\t\t\t\tif (this.selected) {\n\t\t\t\t\tthis.selectedIndex = status.valign[this.selected.valign] * status.count + status.align[this.selected.align];\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tinitCellAlignPicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\n\t\t\t\tvar alignType = ['left', 'center', 'right'],\n\t\t\t\t\tCOUNT = 9,\n\t\t\t\t\ttempClassName = null,\n\t\t\t\t\ttempIndex = -1,\n\t\t\t\t\ttmpl = [];\n\n\t\t\t\tfor (var i = 0; i < COUNT; i++) {\n\n\t\t\t\t\ttempClassName = this.selectedIndex === i ? ' class=\"edui-cellalign-selected\" ' : '';\n\t\t\t\t\ttempIndex = i % 3;\n\n\t\t\t\t\ttempIndex === 0 && tmpl.push('<tr>');\n\n\t\t\t\t\ttmpl.push('<td index=\"' + i + '\" ' + tempClassName + ' stateful><div class=\"edui-icon edui-' + alignType[tempIndex] + '\"></div></td>');\n\n\t\t\t\t\ttempIndex === 2 && tmpl.push('</tr>');\n\n\t\t\t\t}\n\n\t\t\t\treturn '<div id=\"##\" class=\"edui-cellalignpicker %%\">' +\n\t\t\t\t\t'<div class=\"edui-cellalignpicker-body\">' +\n\t\t\t\t\t'<table onclick=\"$$._onClick(event);\">' +\n\t\t\t\t\ttmpl.join('') +\n\t\t\t\t\t'</table>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.target;\n\t\t\t},\n\t\t\t_onClick: function(evt) {\n\t\t\t\tvar target = evt.target || evt.srcElement;\n\t\t\t\tif (/icon/.test(target.className)) {\n\t\t\t\t\tthis.items[target.parentNode.getAttribute(\"index\")].onclick();\n\t\t\t\t\tPopup.postHide(evt);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t};\n\t\tutils.inherits(CellAlignPicker, UIBase);\n\t\tutils.extend(CellAlignPicker.prototype, Stateful, true);\n\t})();\n\n\t// ui/pastepicker.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase;\n\n\t\tvar PastePicker = baidu.editor.ui.PastePicker = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initPastePicker();\n\t\t};\n\t\tPastePicker.prototype = {\n\t\t\tinitPastePicker: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.Stateful_init();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div class=\"edui-pasteicon\" onclick=\"$$._onClick(this)\"></div>' +\n\t\t\t\t\t'<div class=\"edui-pastecontainer\">' +\n\t\t\t\t\t'<div class=\"edui-title\">' + this.editor.getLang(\"pasteOpt\") + '</div>' +\n\t\t\t\t\t'<div class=\"edui-button\">' +\n\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"pasteSourceFormat\") + '\" onclick=\"$$.format(false)\" stateful>' +\n\t\t\t\t\t'<div class=\"edui-richtxticon\"></div></div>' +\n\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"tagFormat\") + '\" onclick=\"$$.format(2)\" stateful>' +\n\t\t\t\t\t'<div class=\"edui-tagicon\"></div></div>' +\n\t\t\t\t\t'<div title=\"' + this.editor.getLang(\"pasteTextFormat\") + '\" onclick=\"$$.format(true)\" stateful>' +\n\t\t\t\t\t'<div class=\"edui-plaintxticon\"></div></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>'\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.target;\n\t\t\t},\n\t\t\tformat: function(param) {\n\t\t\t\tthis.editor.ui._isTransfer = true;\n\t\t\t\tthis.editor.fireEvent('pasteTransfer', param);\n\t\t\t},\n\t\t\t_onClick: function(cur) {\n\t\t\t\tvar node = domUtils.getNextDomNode(cur),\n\t\t\t\t\tscreenHt = uiUtils.getViewportRect().height,\n\t\t\t\t\tsubPop = uiUtils.getClientRect(node);\n\n\t\t\t\tif ((subPop.top + subPop.height) > screenHt)\n\t\t\t\t\tnode.style.top = (-subPop.height - cur.offsetHeight) + \"px\";\n\t\t\t\telse\n\t\t\t\t\tnode.style.top = \"\";\n\n\t\t\t\tif (/hidden/ig.test(domUtils.getComputedStyle(node, \"visibility\"))) {\n\t\t\t\t\tnode.style.visibility = \"visible\";\n\t\t\t\t\tdomUtils.addClass(cur, \"edui-state-opened\");\n\t\t\t\t} else {\n\t\t\t\t\tnode.style.visibility = \"hidden\";\n\t\t\t\t\tdomUtils.removeClasses(cur, \"edui-state-opened\")\n\t\t\t\t}\n\t\t\t},\n\t\t\t_UIBase_render: UIBase.prototype.render\n\t\t};\n\t\tutils.inherits(PastePicker, UIBase);\n\t\tutils.extend(PastePicker.prototype, Stateful, true);\n\t})();\n\n\t// ui/toolbar.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tToolbar = baidu.editor.ui.Toolbar = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initToolbar();\n\t\t\t};\n\t\tToolbar.prototype = {\n\t\t\titems: null,\n\t\t\tinitToolbar: function() {\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tadd: function(item, index) {\n\t\t\t\tif (index === undefined) {\n\t\t\t\t\tthis.items.push(item);\n\t\t\t\t} else {\n\t\t\t\t\tthis.items.splice(index, 0, item)\n\t\t\t\t}\n\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar buff = [];\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tbuff[i] = this.items[i].renderHtml();\n\t\t\t\t}\n\t\t\t\treturn '<div id=\"##\" class=\"edui-toolbar %%\" onselectstart=\"return false;\" onmousedown=\"return $$._onMouseDown(event, this);\">' +\n\t\t\t\t\tbuff.join('') +\n\t\t\t\t\t'</div>'\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar box = this.getDom();\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tthis.items[i].postRender();\n\t\t\t\t}\n\t\t\t\tuiUtils.makeUnselectable(box);\n\t\t\t},\n\t\t\t_onMouseDown: function(e) {\n\t\t\t\tvar target = e.target || e.srcElement,\n\t\t\t\t\ttagName = target && target.tagName && target.tagName.toLowerCase();\n\t\t\t\tif (tagName == 'input' || tagName == 'object' || tagName == 'object') {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Toolbar, UIBase);\n\n\t})();\n\n\t// ui/menu.js\n\t///import core\n\t///import uicore\n\t///import ui\\popup.js\n\t///import ui\\stateful.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tStateful = baidu.editor.ui.Stateful,\n\t\t\tCellAlignPicker = baidu.editor.ui.CellAlignPicker,\n\n\t\t\tMenu = baidu.editor.ui.Menu = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMenu();\n\t\t\t};\n\n\t\tvar menuSeparator = {\n\t\t\trenderHtml: function() {\n\t\t\t\treturn '<div class=\"edui-menuitem edui-menuseparator\"><div class=\"edui-menuseparator-inner\"></div></div>';\n\t\t\t},\n\t\t\tpostRender: function() {},\n\t\t\tqueryAutoHide: function() {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t};\n\t\tMenu.prototype = {\n\t\t\titems: null,\n\t\t\tuiName: 'menu',\n\t\t\tinitMenu: function() {\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tthis.initPopup();\n\t\t\t\tthis.initItems();\n\t\t\t},\n\t\t\tinitItems: function() {\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\tif (item == '-') {\n\t\t\t\t\t\tthis.items[i] = this.getSeparator();\n\t\t\t\t\t} else if (!(item instanceof MenuItem)) {\n\t\t\t\t\t\titem.editor = this.editor;\n\t\t\t\t\t\titem.theme = this.editor.options.theme;\n\t\t\t\t\t\tthis.items[i] = this.createItem(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetSeparator: function() {\n\t\t\t\treturn menuSeparator;\n\t\t\t},\n\t\t\tcreateItem: function(item) {\n\t\t\t\t//新增一个参数menu, 该参数存储了menuItem所对应的menu引用\n\t\t\t\titem.menu = this;\n\t\t\t\treturn new MenuItem(item);\n\t\t\t},\n\t\t\t_Popup_getContentHtmlTpl: Popup.prototype.getContentHtmlTpl,\n\t\t\tgetContentHtmlTpl: function() {\n\t\t\t\tif (this.items.length == 0) {\n\t\t\t\t\treturn this._Popup_getContentHtmlTpl();\n\t\t\t\t}\n\t\t\t\tvar buff = [];\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\tbuff[i] = item.renderHtml();\n\t\t\t\t}\n\t\t\t\treturn ('<div class=\"%%-body\">' + buff.join('') + '</div>');\n\t\t\t},\n\t\t\t_Popup_postRender: Popup.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\titem.ownerMenu = this;\n\t\t\t\t\titem.postRender();\n\t\t\t\t}\n\t\t\t\tdomUtils.on(this.getDom(), 'mouseover', function(evt) {\n\t\t\t\t\tevt = evt || event;\n\t\t\t\t\tvar rel = evt.relatedTarget || evt.fromElement;\n\t\t\t\t\tvar el = me.getDom();\n\t\t\t\t\tif (!uiUtils.contains(el, rel) && el !== rel) {\n\t\t\t\t\t\tme.fireEvent('over');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._Popup_postRender();\n\t\t\t},\n\t\t\tqueryAutoHide: function(el) {\n\t\t\t\tif (el) {\n\t\t\t\t\tif (uiUtils.contains(this.getDom(), el)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\t\tif (item.queryAutoHide(el) === false) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tclearItems: function() {\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\tclearTimeout(item._showingTimer);\n\t\t\t\t\tclearTimeout(item._closingTimer);\n\t\t\t\t\tif (item.subMenu) {\n\t\t\t\t\t\titem.subMenu.destroy();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.items = [];\n\t\t\t},\n\t\t\tdestroy: function() {\n\t\t\t\tif (this.getDom()) {\n\t\t\t\t\tdomUtils.remove(this.getDom());\n\t\t\t\t}\n\t\t\t\tthis.clearItems();\n\t\t\t},\n\t\t\tdispose: function() {\n\t\t\t\tthis.destroy();\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Menu, Popup);\n\n\t\t/**\n\t\t * @update 2013/04/03 hancong03 新增一个参数menu, 该参数存储了menuItem所对应的menu引用\n\t\t * @type {Function}\n\t\t */\n\t\tvar MenuItem = baidu.editor.ui.MenuItem = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initUIBase();\n\t\t\tthis.Stateful_init();\n\t\t\tif (this.subMenu && !(this.subMenu instanceof Menu)) {\n\t\t\t\tif (options.className && options.className.indexOf(\"aligntd\") != -1) {\n\t\t\t\t\tvar me = this;\n\n\t\t\t\t\t//获取单元格对齐初始状态\n\t\t\t\t\tthis.subMenu.selected = this.editor.queryCommandValue('cellalignment');\n\n\t\t\t\t\tthis.subMenu = new Popup({\n\t\t\t\t\t\tcontent: new CellAlignPicker(this.subMenu),\n\t\t\t\t\t\tparentMenu: me,\n\t\t\t\t\t\teditor: me.editor,\n\t\t\t\t\t\tdestroy: function() {\n\t\t\t\t\t\t\tif (this.getDom()) {\n\t\t\t\t\t\t\t\tdomUtils.remove(this.getDom());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.subMenu.addListener(\"postRenderAfter\", function() {\n\t\t\t\t\t\tdomUtils.on(this.getDom(), \"mouseover\", function() {\n\t\t\t\t\t\t\tme.addState('opened');\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.subMenu = new Menu(this.subMenu);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tMenuItem.prototype = {\n\t\t\tlabel: '',\n\t\t\tsubMenu: null,\n\t\t\townerMenu: null,\n\t\t\tuiName: 'menuitem',\n\t\t\talwalysHoverable: true,\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"%%\" stateful onclick=\"$$._onClick(event, this);\">' +\n\t\t\t\t\t'<div class=\"%%-body\">' +\n\t\t\t\t\tthis.renderLabelHtml() +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.addListener('over', function() {\n\t\t\t\t\tme.ownerMenu.fireEvent('submenuover', me);\n\t\t\t\t\tif (me.subMenu) {\n\t\t\t\t\t\tme.delayShowSubMenu();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tif (this.subMenu) {\n\t\t\t\t\tthis.getDom().className += ' edui-hassubmenu';\n\t\t\t\t\tthis.subMenu.render();\n\t\t\t\t\tthis.addListener('out', function() {\n\t\t\t\t\t\tme.delayHideSubMenu();\n\t\t\t\t\t});\n\t\t\t\t\tthis.subMenu.addListener('over', function() {\n\t\t\t\t\t\tclearTimeout(me._closingTimer);\n\t\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\t\tme.addState('opened');\n\t\t\t\t\t});\n\t\t\t\t\tthis.ownerMenu.addListener('hide', function() {\n\t\t\t\t\t\tme.hideSubMenu();\n\t\t\t\t\t});\n\t\t\t\t\tthis.ownerMenu.addListener('submenuover', function(t, subMenu) {\n\t\t\t\t\t\tif (subMenu !== me) {\n\t\t\t\t\t\t\tme.delayHideSubMenu();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.subMenu._bakQueryAutoHide = this.subMenu.queryAutoHide;\n\t\t\t\t\tthis.subMenu.queryAutoHide = function(el) {\n\t\t\t\t\t\tif (el && uiUtils.contains(me.getDom(), el)) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this._bakQueryAutoHide(el);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthis.getDom().style.tabIndex = '-1';\n\t\t\t\tuiUtils.makeUnselectable(this.getDom());\n\t\t\t\tthis.Stateful_postRender();\n\t\t\t},\n\t\t\tdelayShowSubMenu: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!me.isDisabled()) {\n\t\t\t\t\tme.addState('opened');\n\t\t\t\t\tclearTimeout(me._showingTimer);\n\t\t\t\t\tclearTimeout(me._closingTimer);\n\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\tme._showingTimer = setTimeout(function() {\n\t\t\t\t\t\tme.showSubMenu();\n\t\t\t\t\t}, 250);\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelayHideSubMenu: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!me.isDisabled()) {\n\t\t\t\t\tme.removeState('opened');\n\t\t\t\t\tclearTimeout(me._showingTimer);\n\t\t\t\t\tif (!me._closingTimer) {\n\t\t\t\t\t\tme._closingTimer = setTimeout(function() {\n\t\t\t\t\t\t\tif (!me.hasState('opened')) {\n\t\t\t\t\t\t\t\tme.hideSubMenu();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tme._closingTimer = null;\n\t\t\t\t\t\t}, 400);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\trenderLabelHtml: function() {\n\t\t\t\treturn '<div class=\"edui-arrow\"></div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-icon\"></div>' +\n\t\t\t\t\t'<div class=\"edui-box edui-label %%-label\">' + (this.label || '') + '</div>';\n\t\t\t},\n\t\t\tgetStateDom: function() {\n\t\t\t\treturn this.getDom();\n\t\t\t},\n\t\t\tqueryAutoHide: function(el) {\n\t\t\t\tif (this.subMenu && this.hasState('opened')) {\n\t\t\t\t\treturn this.subMenu.queryAutoHide(el);\n\t\t\t\t}\n\t\t\t},\n\t\t\t_onClick: function(event, this_) {\n\t\t\t\tif (this.hasState('disabled')) return;\n\t\t\t\tif (this.fireEvent('click', event, this_) !== false) {\n\t\t\t\t\tif (this.subMenu) {\n\t\t\t\t\t\tthis.showSubMenu();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tPopup.postHide(event);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tshowSubMenu: function() {\n\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\trect.right -= 5;\n\t\t\t\trect.left += 2;\n\t\t\t\trect.width -= 7;\n\t\t\t\trect.top -= 4;\n\t\t\t\trect.bottom += 4;\n\t\t\t\trect.height += 8;\n\t\t\t\tthis.subMenu.showAnchorRect(rect, true, true);\n\t\t\t},\n\t\t\thideSubMenu: function() {\n\t\t\t\tthis.subMenu.hide();\n\t\t\t}\n\t\t};\n\t\tutils.inherits(MenuItem, UIBase);\n\t\tutils.extend(MenuItem.prototype, Stateful, true);\n\t})();\n\n\t// ui/combox.js\n\t///import core\n\t///import uicore\n\t///import ui/menu.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\t// todo: menu和item提成通用list\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tMenu = baidu.editor.ui.Menu,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tCombox = baidu.editor.ui.Combox = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initCombox();\n\t\t\t};\n\t\tCombox.prototype = {\n\t\t\tuiName: 'combox',\n\t\t\tonbuttonclick: function() {\n\t\t\t\tthis.showPopup();\n\t\t\t},\n\t\t\tinitCombox: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tvar item = this.items[i];\n\t\t\t\t\titem.uiName = 'listitem';\n\t\t\t\t\titem.index = i;\n\t\t\t\t\titem.onclick = function() {\n\t\t\t\t\t\tme.selectByIndex(this.index);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tthis.popup = new Menu({\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tuiName: 'list',\n\t\t\t\t\teditor: this.editor,\n\t\t\t\t\tcaptureWheel: true,\n\t\t\t\t\tcombox: this\n\t\t\t\t});\n\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\t_SplitButton_postRender: SplitButton.prototype.postRender,\n\t\t\tpostRender: function() {\n\t\t\t\tthis._SplitButton_postRender();\n\t\t\t\tthis.setLabel(this.label || '');\n\t\t\t\tthis.setValue(this.initValue || '');\n\t\t\t},\n\t\t\tshowPopup: function() {\n\t\t\t\tvar rect = uiUtils.getClientRect(this.getDom());\n\t\t\t\trect.top += 1;\n\t\t\t\trect.bottom -= 1;\n\t\t\t\trect.height -= 2;\n\t\t\t\tthis.popup.showAnchorRect(rect);\n\t\t\t},\n\t\t\tgetValue: function() {\n\t\t\t\treturn this.value;\n\t\t\t},\n\t\t\tsetValue: function(value) {\n\t\t\t\tvar index = this.indexByValue(value);\n\t\t\t\tif (index != -1) {\n\t\t\t\t\tthis.selectedIndex = index;\n\t\t\t\t\tthis.setLabel(this.items[index].label);\n\t\t\t\t\tthis.value = this.items[index].value;\n\t\t\t\t} else {\n\t\t\t\t\tthis.selectedIndex = -1;\n\t\t\t\t\tthis.setLabel(this.getLabelForUnknowValue(value));\n\t\t\t\t\tthis.value = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetLabel: function(label) {\n\t\t\t\tthis.getDom('button_body').innerHTML = label;\n\t\t\t\tthis.label = label;\n\t\t\t},\n\t\t\tgetLabelForUnknowValue: function(value) {\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tindexByValue: function(value) {\n\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\tif (value == this.items[i].value) {\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn -1;\n\t\t\t},\n\t\t\tgetItem: function(index) {\n\t\t\t\treturn this.items[index];\n\t\t\t},\n\t\t\tselectByIndex: function(index) {\n\t\t\t\tif (index < this.items.length && this.fireEvent('select', index) !== false) {\n\t\t\t\t\tthis.selectedIndex = index;\n\t\t\t\t\tthis.value = this.items[index].value;\n\t\t\t\t\tthis.setLabel(this.items[index].label);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Combox, SplitButton);\n\t})();\n\n\t// ui/dialog.js\n\t///import core\n\t///import uicore\n\t///import ui/mask.js\n\t///import ui/button.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tMask = baidu.editor.ui.Mask,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tButton = baidu.editor.ui.Button,\n\t\t\tDialog = baidu.editor.ui.Dialog = function(options) {\n\t\t\t\tif (options.name) {\n\t\t\t\t\tvar name = options.name;\n\t\t\t\t\tvar cssRules = options.cssRules;\n\t\t\t\t\tif (!options.className) {\n\t\t\t\t\t\toptions.className = 'edui-for-' + name;\n\t\t\t\t\t}\n\t\t\t\t\tif (cssRules) {\n\t\t\t\t\t\toptions.cssRules = '.edui-default .edui-for-' + name + ' .edui-dialog-content  {' + cssRules + '}'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.initOptions(utils.extend({\n\t\t\t\t\tautoReset: true,\n\t\t\t\t\tdraggable: true,\n\t\t\t\t\tonok: function() {},\n\t\t\t\t\toncancel: function() {},\n\t\t\t\t\tonclose: function(t, ok) {\n\t\t\t\t\t\treturn ok ? this.onok() : this.oncancel();\n\t\t\t\t\t},\n\t\t\t\t\t//是否控制dialog中的scroll事件， 默认为不阻止\n\t\t\t\t\tholdScroll: false\n\t\t\t\t}, options));\n\t\t\t\tthis.initDialog();\n\t\t\t};\n\t\tvar modalMask;\n\t\tvar dragMask;\n\t\tvar activeDialog;\n\t\tDialog.prototype = {\n\t\t\tdraggable: false,\n\t\t\tuiName: 'dialog',\n\t\t\tinitDialog: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\ttheme = this.editor.options.theme;\n\t\t\t\tif (this.cssRules) {\n\t\t\t\t\tutils.cssRule('edui-customize-' + this.name + '-style', this.cssRules);\n\t\t\t\t}\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.modalMask = (modalMask || (modalMask = new Mask({\n\t\t\t\t\tclassName: 'edui-dialog-modalmask',\n\t\t\t\t\ttheme: theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\tactiveDialog && activeDialog.close(false);\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tthis.dragMask = (dragMask || (dragMask = new Mask({\n\t\t\t\t\tclassName: 'edui-dialog-dragmask',\n\t\t\t\t\ttheme: theme\n\t\t\t\t})));\n\t\t\t\tthis.closeButton = new Button({\n\t\t\t\t\tclassName: 'edui-dialog-closebutton',\n\t\t\t\t\ttitle: me.closeDialog,\n\t\t\t\t\ttheme: theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\tme.close(false);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.fullscreen && this.initResizeEvent();\n\n\t\t\t\tif (this.buttons) {\n\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\tif (!(this.buttons[i] instanceof Button)) {\n\t\t\t\t\t\t\tthis.buttons[i] = new Button(utils.extend(this.buttons[i], {\n\t\t\t\t\t\t\t\teditor: this.editor\n\t\t\t\t\t\t\t}, true));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tinitResizeEvent: function() {\n\n\t\t\t\tvar me = this;\n\n\t\t\t\tdomUtils.on(window, \"resize\", function() {\n\n\t\t\t\t\tif (me._hidden || me._hidden === undefined) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (me.__resizeTimer) {\n\t\t\t\t\t\twindow.clearTimeout(me.__resizeTimer);\n\t\t\t\t\t}\n\n\t\t\t\t\tme.__resizeTimer = window.setTimeout(function() {\n\n\t\t\t\t\t\tme.__resizeTimer = null;\n\n\t\t\t\t\t\tvar dialogWrapNode = me.getDom(),\n\t\t\t\t\t\t\tcontentNode = me.getDom('content'),\n\t\t\t\t\t\t\twrapRect = UE.ui.uiUtils.getClientRect(dialogWrapNode),\n\t\t\t\t\t\t\tcontentRect = UE.ui.uiUtils.getClientRect(contentNode),\n\t\t\t\t\t\t\tvpRect = uiUtils.getViewportRect();\n\n\t\t\t\t\t\tcontentNode.style.width = (vpRect.width - wrapRect.width + contentRect.width) + \"px\";\n\t\t\t\t\t\tcontentNode.style.height = (vpRect.height - wrapRect.height + contentRect.height) + \"px\";\n\n\t\t\t\t\t\tdialogWrapNode.style.width = vpRect.width + \"px\";\n\t\t\t\t\t\tdialogWrapNode.style.height = vpRect.height + \"px\";\n\n\t\t\t\t\t\tme.fireEvent(\"resize\");\n\n\t\t\t\t\t}, 100);\n\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tfitSize: function() {\n\t\t\t\tvar popBodyEl = this.getDom('body');\n\t\t\t\t//            if (!(baidu.editor.browser.ie && baidu.editor.browser.version == 7)) {\n\t\t\t\t//                uiUtils.removeStyle(popBodyEl, 'width');\n\t\t\t\t//                uiUtils.removeStyle(popBodyEl, 'height');\n\t\t\t\t//            }\n\t\t\t\tvar size = this.mesureSize();\n\t\t\t\tpopBodyEl.style.width = size.width + 'px';\n\t\t\t\tpopBodyEl.style.height = size.height + 'px';\n\t\t\t\treturn size;\n\t\t\t},\n\t\t\tsafeSetOffset: function(offset) {\n\t\t\t\tvar me = this;\n\t\t\t\tvar el = me.getDom();\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\tvar rect = uiUtils.getClientRect(el);\n\t\t\t\tvar left = offset.left;\n\t\t\t\tif (left + rect.width > vpRect.right) {\n\t\t\t\t\tleft = vpRect.right - rect.width;\n\t\t\t\t}\n\t\t\t\tvar top = offset.top;\n\t\t\t\tif (top + rect.height > vpRect.bottom) {\n\t\t\t\t\ttop = vpRect.bottom - rect.height;\n\t\t\t\t}\n\t\t\t\tel.style.left = Math.max(left, 0) + 'px';\n\t\t\t\tel.style.top = Math.max(top, 0) + 'px';\n\t\t\t},\n\t\t\tshowAtCenter: function() {\n\n\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\n\t\t\t\tif (!this.fullscreen) {\n\t\t\t\t\tthis.getDom().style.display = '';\n\t\t\t\t\tvar popSize = this.fitSize();\n\t\t\t\t\tvar titleHeight = this.getDom('titlebar').offsetHeight | 0;\n\t\t\t\t\tvar left = vpRect.width / 2 - popSize.width / 2;\n\t\t\t\t\tvar top = vpRect.height / 2 - (popSize.height - titleHeight) / 2 - titleHeight;\n\t\t\t\t\tvar popEl = this.getDom();\n\t\t\t\t\tthis.safeSetOffset({\n\t\t\t\t\t\tleft: Math.max(left | 0, 0),\n\t\t\t\t\t\ttop: Math.max(top | 0, 0)\n\t\t\t\t\t});\n\t\t\t\t\tif (!domUtils.hasClass(popEl, 'edui-state-centered')) {\n\t\t\t\t\t\tpopEl.className += ' edui-state-centered';\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar dialogWrapNode = this.getDom(),\n\t\t\t\t\t\tcontentNode = this.getDom('content');\n\n\t\t\t\t\tdialogWrapNode.style.display = \"block\";\n\n\t\t\t\t\tvar wrapRect = UE.ui.uiUtils.getClientRect(dialogWrapNode),\n\t\t\t\t\t\tcontentRect = UE.ui.uiUtils.getClientRect(contentNode);\n\t\t\t\t\tdialogWrapNode.style.left = \"-100000px\";\n\n\t\t\t\t\tcontentNode.style.width = (vpRect.width - wrapRect.width + contentRect.width) + \"px\";\n\t\t\t\t\tcontentNode.style.height = (vpRect.height - wrapRect.height + contentRect.height) + \"px\";\n\n\t\t\t\t\tdialogWrapNode.style.width = vpRect.width + \"px\";\n\t\t\t\t\tdialogWrapNode.style.height = vpRect.height + \"px\";\n\t\t\t\t\tdialogWrapNode.style.left = 0;\n\n\t\t\t\t\t//保存环境的overflow值\n\t\t\t\t\tthis._originalContext = {\n\t\t\t\t\t\thtml: {\n\t\t\t\t\t\t\toverflowX: document.documentElement.style.overflowX,\n\t\t\t\t\t\t\toverflowY: document.documentElement.style.overflowY\n\t\t\t\t\t\t},\n\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\toverflowX: document.body.style.overflowX,\n\t\t\t\t\t\t\toverflowY: document.body.style.overflowY\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tdocument.documentElement.style.overflowX = 'hidden';\n\t\t\t\t\tdocument.documentElement.style.overflowY = 'hidden';\n\t\t\t\t\tdocument.body.style.overflowX = 'hidden';\n\t\t\t\t\tdocument.body.style.overflowY = 'hidden';\n\n\t\t\t\t}\n\n\t\t\t\tthis._show();\n\t\t\t},\n\t\t\tgetContentHtml: function() {\n\t\t\t\tvar contentHtml = '';\n\t\t\t\tif (typeof this.content == 'string') {\n\t\t\t\t\tcontentHtml = this.content;\n\t\t\t\t} else if (this.iframeUrl) {\n\t\t\t\t\tcontentHtml = '<span id=\"' + this.id + '_contmask\" class=\"dialogcontmask\"></span><iframe id=\"' + this.id +\n\t\t\t\t\t\t'_iframe\" class=\"%%-iframe\" height=\"100%\" width=\"100%\" frameborder=\"0\" src=\"' + this.iframeUrl + '\"></iframe>';\n\t\t\t\t}\n\t\t\t\treturn contentHtml;\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar footHtml = '';\n\n\t\t\t\tif (this.buttons) {\n\t\t\t\t\tvar buff = [];\n\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\tbuff[i] = this.buttons[i].renderHtml();\n\t\t\t\t\t}\n\t\t\t\t\tfootHtml = '<div class=\"%%-foot\">' +\n\t\t\t\t\t\t'<div id=\"##_buttons\" class=\"%%-buttons\">' + buff.join('') + '</div>' +\n\t\t\t\t\t\t'</div>';\n\t\t\t\t}\n\n\t\t\t\treturn '<div id=\"##\" class=\"%%\"><div ' + (!this.fullscreen ? 'class=\"%%\"' : 'class=\"%%-wrap edui-dialog-fullscreen-flag\"') + '><div id=\"##_body\" class=\"%%-body\">' +\n\t\t\t\t\t'<div class=\"%%-shadow\"></div>' +\n\t\t\t\t\t'<div id=\"##_titlebar\" class=\"%%-titlebar\">' +\n\t\t\t\t\t'<div class=\"%%-draghandle\" onmousedown=\"$$._onTitlebarMouseDown(event, this);\">' +\n\t\t\t\t\t'<span class=\"%%-caption\">' + (this.title || '') + '</span>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\tthis.closeButton.renderHtml() +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"##_content\" class=\"%%-content\">' + (this.autoReset ? '' : this.getContentHtml()) + '</div>' +\n\t\t\t\t\tfootHtml +\n\t\t\t\t\t'</div></div></div>';\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\t// todo: 保持居中/记住上次关闭位置选项\n\t\t\t\tif (!this.modalMask.getDom()) {\n\t\t\t\t\tthis.modalMask.render();\n\t\t\t\t\tthis.modalMask.hide();\n\t\t\t\t}\n\t\t\t\tif (!this.dragMask.getDom()) {\n\t\t\t\t\tthis.dragMask.render();\n\t\t\t\t\tthis.dragMask.hide();\n\t\t\t\t}\n\t\t\t\tvar me = this;\n\t\t\t\tthis.addListener('show', function() {\n\t\t\t\t\tme.modalMask.show(this.getDom().style.zIndex - 2);\n\t\t\t\t});\n\t\t\t\tthis.addListener('hide', function() {\n\t\t\t\t\tme.modalMask.hide();\n\t\t\t\t});\n\t\t\t\tif (this.buttons) {\n\t\t\t\t\tfor (var i = 0; i < this.buttons.length; i++) {\n\t\t\t\t\t\tthis.buttons[i].postRender();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdomUtils.on(window, 'resize', function() {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tif (!me.isHidden()) {\n\t\t\t\t\t\t\tme.safeSetOffset(uiUtils.getClientRect(me.getDom()));\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\t//hold住scroll事件，防止dialog的滚动影响页面\n\t\t\t\t//            if( this.holdScroll ) {\n\t\t\t\t//\n\t\t\t\t//                if( !me.iframeUrl ) {\n\t\t\t\t//                    domUtils.on( document.getElementById( me.id + \"_iframe\"), !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t//                        domUtils.preventDefault(e);\n\t\t\t\t//                    } );\n\t\t\t\t//                } else {\n\t\t\t\t//                    me.addListener('dialogafterreset', function(){\n\t\t\t\t//                        window.setTimeout(function(){\n\t\t\t\t//                            var iframeWindow = document.getElementById( me.id + \"_iframe\").contentWindow;\n\t\t\t\t//\n\t\t\t\t//                            if( browser.ie ) {\n\t\t\t\t//\n\t\t\t\t//                                var timer = window.setInterval(function(){\n\t\t\t\t//\n\t\t\t\t//                                    if( iframeWindow.document && iframeWindow.document.body ) {\n\t\t\t\t//                                        window.clearInterval( timer );\n\t\t\t\t//                                        timer = null;\n\t\t\t\t//                                        domUtils.on( iframeWindow.document.body, !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t//                                            domUtils.preventDefault(e);\n\t\t\t\t//                                        } );\n\t\t\t\t//                                    }\n\t\t\t\t//\n\t\t\t\t//                                }, 100);\n\t\t\t\t//\n\t\t\t\t//                            } else {\n\t\t\t\t//                                domUtils.on( iframeWindow, !browser.gecko ? \"mousewheel\" : \"DOMMouseScroll\", function(e){\n\t\t\t\t//                                    domUtils.preventDefault(e);\n\t\t\t\t//                                } );\n\t\t\t\t//                            }\n\t\t\t\t//\n\t\t\t\t//                        }, 1);\n\t\t\t\t//                    });\n\t\t\t\t//                }\n\t\t\t\t//\n\t\t\t\t//            }\n\t\t\t\tthis._hide();\n\t\t\t},\n\t\t\tmesureSize: function() {\n\t\t\t\tvar body = this.getDom('body');\n\t\t\t\tvar width = uiUtils.getClientRect(this.getDom('content')).width;\n\t\t\t\tvar dialogBodyStyle = body.style;\n\t\t\t\tdialogBodyStyle.width = width;\n\t\t\t\treturn uiUtils.getClientRect(body);\n\t\t\t},\n\t\t\t_onTitlebarMouseDown: function(evt, el) {\n\t\t\t\tif (this.draggable) {\n\t\t\t\t\tvar rect;\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\tvar me = this;\n\t\t\t\t\tuiUtils.startDrag(evt, {\n\t\t\t\t\t\tondragstart: function() {\n\t\t\t\t\t\t\trect = uiUtils.getClientRect(me.getDom());\n\t\t\t\t\t\t\tme.getDom('contmask').style.visibility = 'visible';\n\t\t\t\t\t\t\tme.dragMask.show(me.getDom().style.zIndex - 1);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tondragmove: function(x, y) {\n\t\t\t\t\t\t\tvar left = rect.left + x;\n\t\t\t\t\t\t\tvar top = rect.top + y;\n\t\t\t\t\t\t\tme.safeSetOffset({\n\t\t\t\t\t\t\t\tleft: left,\n\t\t\t\t\t\t\t\ttop: top\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tondragstop: function() {\n\t\t\t\t\t\t\tme.getDom('contmask').style.visibility = 'hidden';\n\t\t\t\t\t\t\tdomUtils.removeClasses(me.getDom(), ['edui-state-centered']);\n\t\t\t\t\t\t\tme.dragMask.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\treset: function() {\n\t\t\t\tthis.getDom('content').innerHTML = this.getContentHtml();\n\t\t\t\tthis.fireEvent('dialogafterreset');\n\t\t\t},\n\t\t\t_show: function() {\n\t\t\t\tif (this._hidden) {\n\t\t\t\t\tthis.getDom().style.display = '';\n\n\t\t\t\t\t//要高过编辑器的zindxe\n\t\t\t\t\tthis.editor.container.style.zIndex && (this.getDom().style.zIndex = this.editor.container.style.zIndex * 1 + 10);\n\t\t\t\t\tthis._hidden = false;\n\t\t\t\t\tthis.fireEvent('show');\n\t\t\t\t\tbaidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = this.getDom().style.zIndex - 4;\n\t\t\t\t}\n\t\t\t},\n\t\t\tisHidden: function() {\n\t\t\t\treturn this._hidden;\n\t\t\t},\n\t\t\t_hide: function() {\n\t\t\t\tif (!this._hidden) {\n\t\t\t\t\tvar wrapNode = this.getDom();\n\t\t\t\t\twrapNode.style.display = 'none';\n\t\t\t\t\twrapNode.style.zIndex = '';\n\t\t\t\t\twrapNode.style.width = '';\n\t\t\t\t\twrapNode.style.height = '';\n\t\t\t\t\tthis._hidden = true;\n\t\t\t\t\tthis.fireEvent('hide');\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\tif (this.autoReset) {\n\t\t\t\t\t//有可能还没有渲染\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.reset();\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tthis.render();\n\t\t\t\t\t\tthis.open()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.showAtCenter();\n\t\t\t\tif (this.iframeUrl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.getDom('iframe').focus();\n\t\t\t\t\t} catch (ex) {}\n\t\t\t\t}\n\t\t\t\tactiveDialog = this;\n\t\t\t},\n\t\t\t_onCloseButtonClick: function(evt, el) {\n\t\t\t\tthis.close(false);\n\t\t\t},\n\t\t\tclose: function(ok) {\n\t\t\t\tif (this.fireEvent('close', ok) !== false) {\n\t\t\t\t\t//还原环境\n\t\t\t\t\tif (this.fullscreen) {\n\n\t\t\t\t\t\tdocument.documentElement.style.overflowX = this._originalContext.html.overflowX;\n\t\t\t\t\t\tdocument.documentElement.style.overflowY = this._originalContext.html.overflowY;\n\t\t\t\t\t\tdocument.body.style.overflowX = this._originalContext.body.overflowX;\n\t\t\t\t\t\tdocument.body.style.overflowY = this._originalContext.body.overflowY;\n\t\t\t\t\t\tdelete this._originalContext;\n\n\t\t\t\t\t}\n\t\t\t\t\tthis._hide();\n\n\t\t\t\t\t//销毁content\n\t\t\t\t\tvar content = this.getDom('content');\n\t\t\t\t\tvar iframe = this.getDom('iframe');\n\t\t\t\t\tif (content && iframe) {\n\t\t\t\t\t\tvar doc = iframe.contentDocument || iframe.contentWindow.document;\n\t\t\t\t\t\tdoc && (doc.body.innerHTML = '');\n\t\t\t\t\t\tdomUtils.remove(content);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Dialog, UIBase);\n\t})();\n\n\t// ui/menubutton.js\n\t///import core\n\t///import uicore\n\t///import ui/menu.js\n\t///import ui/splitbutton.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tMenu = baidu.editor.ui.Menu,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tMenuButton = baidu.editor.ui.MenuButton = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMenuButton();\n\t\t\t};\n\t\tMenuButton.prototype = {\n\t\t\tinitMenuButton: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.uiName = \"menubutton\";\n\t\t\t\tthis.popup = new Menu({\n\t\t\t\t\titems: me.items,\n\t\t\t\t\tclassName: me.className,\n\t\t\t\t\teditor: me.editor\n\t\t\t\t});\n\t\t\t\tthis.popup.addListener('show', function() {\n\t\t\t\t\tvar list = this;\n\t\t\t\t\tfor (var i = 0; i < list.items.length; i++) {\n\t\t\t\t\t\tlist.items[i].removeState('checked');\n\t\t\t\t\t\tif (list.items[i].value == me._value) {\n\t\t\t\t\t\t\tlist.items[i].addState('checked');\n\t\t\t\t\t\t\tthis.value = me._value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.initSplitButton();\n\t\t\t},\n\t\t\tsetValue: function(value) {\n\t\t\t\tthis._value = value;\n\t\t\t}\n\n\t\t};\n\t\tutils.inherits(MenuButton, SplitButton);\n\t})();\n\n\t// ui/multiMenu.js\n\t///import core\n\t///import uicore\n\t///commands 表情\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tPopup = baidu.editor.ui.Popup,\n\t\t\tSplitButton = baidu.editor.ui.SplitButton,\n\t\t\tMultiMenuPop = baidu.editor.ui.MultiMenuPop = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMultiMenu();\n\t\t\t};\n\n\t\tMultiMenuPop.prototype = {\n\t\t\tinitMultiMenu: function() {\n\t\t\t\tvar me = this;\n\t\t\t\tthis.popup = new Popup({\n\t\t\t\t\tcontent: '',\n\t\t\t\t\teditor: me.editor,\n\t\t\t\t\tiframe_rendered: false,\n\t\t\t\t\tonshow: function() {\n\t\t\t\t\t\t\tif (!this.iframe_rendered) {\n\t\t\t\t\t\t\t\tthis.iframe_rendered = true;\n\t\t\t\t\t\t\t\tthis.getDom('content').innerHTML = '<iframe id=\"' + me.id + '_iframe\" src=\"' + me.iframeUrl + '\" frameborder=\"0\"></iframe>';\n\t\t\t\t\t\t\t\tme.editor.container.style.zIndex && (this.getDom().style.zIndex = me.editor.container.style.zIndex * 1 + 1);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// canSideUp:false,\n\t\t\t\t\t\t// canSideLeft:false\n\t\t\t\t});\n\t\t\t\tthis.onbuttonclick = function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t};\n\t\t\t\tthis.initSplitButton();\n\t\t\t}\n\n\t\t};\n\n\t\tutils.inherits(MultiMenuPop, SplitButton);\n\t})();\n\n\t// ui/shortcutmenu.js\n\t(function() {\n\t\tvar UI = baidu.editor.ui,\n\t\t\tUIBase = UI.UIBase,\n\t\t\tuiUtils = UI.uiUtils,\n\t\t\tutils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\n\t\tvar allMenus = [], //存储所有快捷菜单\n\t\t\ttimeID,\n\t\t\tisSubMenuShow = false; //是否有子pop显示\n\n\t\tvar ShortCutMenu = UI.ShortCutMenu = function(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initShortCutMenu();\n\t\t};\n\n\t\tShortCutMenu.postHide = hideAllMenu;\n\n\t\tShortCutMenu.prototype = {\n\t\t\tisHidden: true,\n\t\t\tSPACE: 5,\n\t\t\tinitShortCutMenu: function() {\n\t\t\t\tthis.items = this.items || [];\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis.initItems();\n\t\t\t\tthis.initEvent();\n\t\t\t\tallMenus.push(this);\n\t\t\t},\n\t\t\tinitEvent: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tdoc = me.editor.document;\n\n\t\t\t\tdomUtils.on(doc, \"mousemove\", function(e) {\n\t\t\t\t\tif (me.isHidden === false) {\n\t\t\t\t\t\t//有pop显示就不隐藏快捷菜单\n\t\t\t\t\t\tif (me.getSubMenuMark() || me.eventType == \"contextmenu\") return;\n\n\t\t\t\t\t\tvar flag = true,\n\t\t\t\t\t\t\tel = me.getDom(),\n\t\t\t\t\t\t\twt = el.offsetWidth,\n\t\t\t\t\t\t\tht = el.offsetHeight,\n\t\t\t\t\t\t\tdistanceX = wt / 2 + me.SPACE, //距离中心X标准\n\t\t\t\t\t\t\tdistanceY = ht / 2, //距离中心Y标准\n\t\t\t\t\t\t\tx = Math.abs(e.screenX - me.left), //离中心距离横坐标\n\t\t\t\t\t\t\ty = Math.abs(e.screenY - me.top); //离中心距离纵坐标\n\n\t\t\t\t\t\tclearTimeout(timeID);\n\t\t\t\t\t\ttimeID = setTimeout(function() {\n\t\t\t\t\t\t\tif (y > 0 && y < distanceY) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"1\");\n\t\t\t\t\t\t\t} else if (y > distanceY && y < distanceY + 70) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"0.5\");\n\t\t\t\t\t\t\t\tflag = false;\n\t\t\t\t\t\t\t} else if (y > distanceY + 70 && y < distanceY + 140) {\n\t\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (flag && x > 0 && x < distanceX) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"1\")\n\t\t\t\t\t\t\t} else if (x > distanceX && x < distanceX + 70) {\n\t\t\t\t\t\t\t\tme.setOpacity(el, \"0.5\")\n\t\t\t\t\t\t\t} else if (x > distanceX + 70 && x < distanceX + 140) {\n\t\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t//ie\\ff下 mouseout不准\n\t\t\t\tif (browser.chrome) {\n\t\t\t\t\tdomUtils.on(doc, \"mouseout\", function(e) {\n\t\t\t\t\t\tvar relatedTgt = e.relatedTarget || e.toElement;\n\n\t\t\t\t\t\tif (relatedTgt == null || relatedTgt.tagName == \"HTML\") {\n\t\t\t\t\t\t\tme.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tme.editor.addListener(\"afterhidepop\", function() {\n\t\t\t\t\tif (!me.isHidden) {\n\t\t\t\t\t\tisSubMenuShow = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t},\n\t\t\tinitItems: function() {\n\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\tfor (var i = 0, len = this.items.length; i < len; i++) {\n\t\t\t\t\t\tvar item = this.items[i].toLowerCase();\n\n\t\t\t\t\t\tif (UI[item]) {\n\t\t\t\t\t\t\tthis.items[i] = new UI[item](this.editor);\n\t\t\t\t\t\t\tthis.items[i].className += \" edui-shortcutsubmenu \";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tsetOpacity: function(el, value) {\n\t\t\t\tif (browser.ie && browser.version < 9) {\n\t\t\t\t\tel.style.filter = \"alpha(opacity = \" + parseFloat(value) * 100 + \");\"\n\t\t\t\t} else {\n\t\t\t\t\tel.style.opacity = value;\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetSubMenuMark: function() {\n\t\t\t\tisSubMenuShow = false;\n\t\t\t\tvar layerEle = uiUtils.getFixedLayer();\n\t\t\t\tvar list = domUtils.getElementsByTagName(layerEle, \"div\", function(node) {\n\t\t\t\t\treturn domUtils.hasClass(node, \"edui-shortcutsubmenu edui-popup\")\n\t\t\t\t});\n\n\t\t\t\tfor (var i = 0, node; node = list[i++];) {\n\t\t\t\t\tif (node.style.display != \"none\") {\n\t\t\t\t\t\tisSubMenuShow = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn isSubMenuShow;\n\t\t\t},\n\t\t\tshow: function(e, hasContextmenu) {\n\t\t\t\tvar me = this,\n\t\t\t\t\toffset = {},\n\t\t\t\t\tel = this.getDom(),\n\t\t\t\t\tfixedlayer = uiUtils.getFixedLayer();\n\n\t\t\t\tfunction setPos(offset) {\n\t\t\t\t\tif (offset.left < 0) {\n\t\t\t\t\t\toffset.left = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (offset.top < 0) {\n\t\t\t\t\t\toffset.top = 0;\n\t\t\t\t\t}\n\t\t\t\t\tel.style.cssText = \"position:absolute;left:\" + offset.left + \"px;top:\" + offset.top + \"px;\";\n\t\t\t\t}\n\n\t\t\t\tfunction setPosByCxtMenu(menu) {\n\t\t\t\t\tif (!menu.tagName) {\n\t\t\t\t\t\tmenu = menu.getDom();\n\t\t\t\t\t}\n\t\t\t\t\toffset.left = parseInt(menu.style.left);\n\t\t\t\t\toffset.top = parseInt(menu.style.top);\n\t\t\t\t\toffset.top -= el.offsetHeight + 15;\n\t\t\t\t\tsetPos(offset);\n\t\t\t\t}\n\n\t\t\t\tme.eventType = e.type;\n\t\t\t\tel.style.cssText = \"display:block;left:-9999px\";\n\n\t\t\t\tif (e.type == \"contextmenu\" && hasContextmenu) {\n\t\t\t\t\tvar menu = domUtils.getElementsByTagName(fixedlayer, \"div\", \"edui-contextmenu\")[0];\n\t\t\t\t\tif (menu) {\n\t\t\t\t\t\tsetPosByCxtMenu(menu)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.editor.addListener(\"aftershowcontextmenu\", function(type, menu) {\n\t\t\t\t\t\t\tsetPosByCxtMenu(menu);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\toffset = uiUtils.getViewportOffsetByEvent(e);\n\t\t\t\t\toffset.top -= el.offsetHeight + me.SPACE;\n\t\t\t\t\toffset.left += me.SPACE + 20;\n\t\t\t\t\tsetPos(offset);\n\t\t\t\t\tme.setOpacity(el, 0.2);\n\t\t\t\t}\n\n\t\t\t\tme.isHidden = false;\n\t\t\t\tme.left = e.screenX + el.offsetWidth / 2 - me.SPACE;\n\t\t\t\tme.top = e.screenY - (el.offsetHeight / 2) - me.SPACE;\n\n\t\t\t\tif (me.editor) {\n\t\t\t\t\tel.style.zIndex = me.editor.container.style.zIndex * 1 + 10;\n\t\t\t\t\tfixedlayer.style.zIndex = el.style.zIndex - 1;\n\t\t\t\t}\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\tif (this.getDom()) {\n\t\t\t\t\tthis.getDom().style.display = \"none\";\n\t\t\t\t}\n\t\t\t\tthis.isHidden = true;\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\tfor (var i = 0, item; item = this.items[i++];) {\n\t\t\t\t\t\titem.postRender();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\tvar buff;\n\t\t\t\tif (utils.isArray(this.items)) {\n\t\t\t\t\tbuff = [];\n\t\t\t\t\tfor (var i = 0; i < this.items.length; i++) {\n\t\t\t\t\t\tbuff[i] = this.items[i].renderHtml();\n\t\t\t\t\t}\n\t\t\t\t\tbuff = buff.join(\"\");\n\t\t\t\t} else {\n\t\t\t\t\tbuff = this.items;\n\t\t\t\t}\n\n\t\t\t\treturn '<div id=\"##\" class=\"%% edui-toolbar\" data-src=\"shortcutmenu\" onmousedown=\"return false;\" onselectstart=\"return false;\" >' +\n\t\t\t\t\tbuff +\n\t\t\t\t\t'</div>';\n\t\t\t}\n\t\t};\n\n\t\tutils.inherits(ShortCutMenu, UIBase);\n\n\t\tfunction hideAllMenu(e) {\n\t\t\tvar tgt = e.target || e.srcElement,\n\t\t\t\tcur = domUtils.findParent(tgt, function(node) {\n\t\t\t\t\treturn domUtils.hasClass(node, \"edui-shortcutmenu\") || domUtils.hasClass(node, \"edui-popup\");\n\t\t\t\t}, true);\n\n\t\t\tif (!cur) {\n\t\t\t\tfor (var i = 0, menu; menu = allMenus[i++];) {\n\t\t\t\t\tmenu.hide()\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdomUtils.on(document, 'mousedown', function(e) {\n\t\t\thideAllMenu(e);\n\t\t});\n\n\t\tdomUtils.on(window, 'scroll', function(e) {\n\t\t\thideAllMenu(e);\n\t\t});\n\n\t})();\n\n\t// ui/breakline.js\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tBreakline = baidu.editor.ui.Breakline = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initSeparator();\n\t\t\t};\n\t\tBreakline.prototype = {\n\t\t\tuiName: 'Breakline',\n\t\t\tinitSeparator: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<br/>';\n\t\t\t}\n\t\t};\n\t\tutils.inherits(Breakline, UIBase);\n\n\t})();\n\n\t// ui/message.js\n\t///import core\n\t///import uicore\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tMessage = baidu.editor.ui.Message = function(options) {\n\t\t\t\tthis.initOptions(options);\n\t\t\t\tthis.initMessage();\n\t\t\t};\n\n\t\tMessage.prototype = {\n\t\t\tinitMessage: function() {\n\t\t\t\tthis.initUIBase();\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"edui-message %%\">' +\n\t\t\t\t\t' <div id=\"##_closer\" class=\"edui-message-closer\">×</div>' +\n\t\t\t\t\t' <div id=\"##_body\" class=\"edui-message-body edui-message-type-info\">' +\n\t\t\t\t\t' <iframe style=\"position:absolute;z-index:-1;left:0;top:0;background-color: transparent;\" frameborder=\"0\" width=\"100%\" height=\"100%\" src=\"about:blank\"></iframe>' +\n\t\t\t\t\t' <div class=\"edui-shadow\"></div>' +\n\t\t\t\t\t' <div id=\"##_content\" class=\"edui-message-content\">' +\n\t\t\t\t\t'  </div>' +\n\t\t\t\t\t' </div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\treset: function(opt) {\n\t\t\t\tvar me = this;\n\t\t\t\tif (!opt.keepshow) {\n\t\t\t\t\tclearTimeout(this.timer);\n\t\t\t\t\tme.timer = setTimeout(function() {\n\t\t\t\t\t\tme.hide();\n\t\t\t\t\t}, opt.timeout || 4000);\n\t\t\t\t}\n\n\t\t\t\topt.content !== undefined && me.setContent(opt.content);\n\t\t\t\topt.type !== undefined && me.setType(opt.type);\n\n\t\t\t\tme.show();\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tvar me = this,\n\t\t\t\t\tcloser = this.getDom('closer');\n\t\t\t\tcloser && domUtils.on(closer, 'click', function() {\n\t\t\t\t\tme.hide();\n\t\t\t\t});\n\t\t\t},\n\t\t\tsetContent: function(content) {\n\t\t\t\tthis.getDom('content').innerHTML = content;\n\t\t\t},\n\t\t\tsetType: function(type) {\n\t\t\t\ttype = type || 'info';\n\t\t\t\tvar body = this.getDom('body');\n\t\t\t\tbody.className = body.className.replace(/edui-message-type-[\\w-]+/, 'edui-message-type-' + type);\n\t\t\t},\n\t\t\tgetContent: function() {\n\t\t\t\treturn this.getDom('content').innerHTML;\n\t\t\t},\n\t\t\tgetType: function() {\n\t\t\t\tvar arr = this.getDom('body').match(/edui-message-type-([\\w-]+)/);\n\t\t\t\treturn arr ? arr[1] : '';\n\t\t\t},\n\t\t\tshow: function() {\n\t\t\t\tthis.getDom().style.display = 'block';\n\t\t\t},\n\t\t\thide: function() {\n\t\t\t\tvar dom = this.getDom();\n\t\t\t\tif (dom) {\n\t\t\t\t\tdom.style.display = 'none';\n\t\t\t\t\tdom.parentNode && dom.parentNode.removeChild(dom);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tutils.inherits(Message, UIBase);\n\n\t})();\n\n\t// adapter/editorui.js\n\t//ui跟编辑器的适配層\n\t//那个按钮弹出是dialog，是下拉筐等都是在这个js中配置\n\t//自己写的ui也要在这里配置，放到baidu.editor.ui下边，当编辑器实例化的时候会根据ueditor.config中的toolbars找到相应的进行实例化\n\t(function() {\n\t\tvar utils = baidu.editor.utils;\n\t\tvar editorui = baidu.editor.ui;\n\t\tvar _Dialog = editorui.Dialog;\n\t\teditorui.buttons = {};\n\n\t\teditorui.Dialog = function(options) {\n\t\t\tvar dialog = new _Dialog(options);\n\t\t\tdialog.addListener('hide', function() {\n\n\t\t\t\tif (dialog.editor) {\n\t\t\t\t\tvar editor = dialog.editor;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\t\tvar y = editor.window.scrollY,\n\t\t\t\t\t\t\t\tx = editor.window.scrollX;\n\t\t\t\t\t\t\teditor.body.focus();\n\t\t\t\t\t\t\teditor.window.scrollTo(x, y);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} catch (ex) {}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn dialog;\n\t\t};\n\n\t\tvar iframeUrlMap = {\n\t\t\t'anchor': '~/dialogs/anchor/anchor.html',\n\t\t\t'insertimage': '~/dialogs/image/image.html',\n\t\t\t'link': '~/dialogs/link/link.html',\n\t\t\t'spechars': '~/dialogs/spechars/spechars.html',\n\t\t\t'searchreplace': '~/dialogs/searchreplace/searchreplace.html',\n\t\t\t'map': '~/dialogs/map/map.html',\n\t\t\t'gmap': '~/dialogs/gmap/gmap.html',\n\t\t\t'insertvideo': '~/dialogs/video/video.html',\n\t\t\t'help': '~/dialogs/help/help.html',\n\t\t\t'preview': '~/dialogs/preview/preview.html',\n\t\t\t'emotion': '~/dialogs/emotion/emotion.html',\n\t\t\t'wordimage': '~/dialogs/wordimage/wordimage.html',\n\t\t\t'attachment': '~/dialogs/attachment/attachment.html',\n\t\t\t'insertframe': '~/dialogs/insertframe/insertframe.html',\n\t\t\t'edittip': '~/dialogs/table/edittip.html',\n\t\t\t'edittable': '~/dialogs/table/edittable.html',\n\t\t\t'edittd': '~/dialogs/table/edittd.html',\n\t\t\t'webapp': '~/dialogs/webapp/webapp.html',\n\t\t\t'snapscreen': '~/dialogs/snapscreen/snapscreen.html',\n\t\t\t'scrawl': '~/dialogs/scrawl/scrawl.html',\n\t\t\t'music': '~/dialogs/music/music.html',\n\t\t\t'template': '~/dialogs/template/template.html',\n\t\t\t'background': '~/dialogs/background/background.html',\n\t\t\t'charts': '~/dialogs/charts/charts.html'\n\t\t};\n\t\t//为工具栏添加按钮，以下都是统一的按钮触发命令，所以写在一起\n\t\tvar btnCmds = ['undo', 'redo', 'formatmatch',\n\t\t\t'bold', 'italic', 'underline', 'fontborder', 'touppercase', 'tolowercase',\n\t\t\t'strikethrough', 'subscript', 'superscript', 'source', 'indent', 'outdent',\n\t\t\t'blockquote', 'pasteplain', 'pagebreak',\n\t\t\t'selectall', 'print', 'horizontal', 'removeformat', 'time', 'date', 'unlink',\n\t\t\t'insertparagraphbeforetable', 'insertrow', 'insertcol', 'mergeright', 'mergedown', 'deleterow',\n\t\t\t'deletecol', 'splittorows', 'splittocols', 'splittocells', 'mergecells', 'deletetable', 'drafts'\n\t\t];\n\n\t\tfor (var i = 0, ci; ci = btnCmds[i++];) {\n\t\t\tci = ci.toLowerCase();\n\t\t\teditorui[ci] = function(cmd) {\n\t\t\t\treturn function(editor) {\n\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd);\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\tshowText: false\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t\tui.setChecked(false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t};\n\t\t\t}(ci);\n\t\t}\n\n\t\t//清除文档\n\t\teditorui.cleardoc = function(editor) {\n\t\t\tvar ui = new editorui.Button({\n\t\t\t\tclassName: 'edui-for-cleardoc',\n\t\t\t\ttitle: editor.options.labelMap.cleardoc || editor.getLang(\"labelMap.cleardoc\") || '',\n\t\t\t\ttheme: editor.options.theme,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tif (confirm(editor.getLang(\"confirmClear\"))) {\n\t\t\t\t\t\teditor.execCommand('cleardoc');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons[\"cleardoc\"] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('cleardoc') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t//排版，图片排版，文字方向\n\t\tvar typeset = {\n\t\t\t'justify': ['left', 'right', 'center', 'justify'],\n\t\t\t'imagefloat': ['none', 'left', 'center', 'right'],\n\t\t\t'directionality': ['ltr', 'rtl']\n\t\t};\n\n\t\tfor (var p in typeset) {\n\n\t\t\t(function(cmd, val) {\n\t\t\t\tfor (var i = 0, ci; ci = val[i++];) {\n\t\t\t\t\t(function(cmd2) {\n\t\t\t\t\t\teditorui[cmd.replace('float', '') + cmd2] = function(editor) {\n\t\t\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd.replace('float', '') + cmd2,\n\t\t\t\t\t\t\t\ttitle: editor.options.labelMap[cmd.replace('float', '') + cmd2] || editor.getLang(\"labelMap.\" + cmd.replace('float', '') + cmd2) || '',\n\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\teditor.execCommand(cmd, cmd2);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\t\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1);\n\t\t\t\t\t\t\t\tui.setChecked(editor.queryCommandValue(cmd) == cmd2 && !uiReady);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn ui;\n\t\t\t\t\t\t};\n\t\t\t\t\t})(ci)\n\t\t\t\t}\n\t\t\t})(p, typeset[p])\n\t\t}\n\n\t\t//字体颜色和背景颜色\n\t\tfor (var i = 0, ci; ci = ['backcolor', 'forecolor'][i++];) {\n\t\t\teditorui[ci] = function(cmd) {\n\t\t\t\treturn function(editor) {\n\t\t\t\t\tvar ui = new editorui.ColorButton({\n\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\tcolor: 'default',\n\t\t\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tonpickcolor: function(t, color) {\n\t\t\t\t\t\t\teditor.execCommand(cmd, color);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonpicknocolor: function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd, 'default');\n\t\t\t\t\t\t\tthis.setColor('transparent');\n\t\t\t\t\t\t\tthis.color = 'default';\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd, this.color);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1);\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t};\n\t\t\t}(ci);\n\t\t}\n\n\t\tvar dialogBtns = {\n\t\t\tnoOk: ['searchreplace', 'help', 'spechars', 'webapp', 'preview'],\n\t\t\tok: ['attachment', 'anchor', 'link', 'insertimage', 'map', 'gmap', 'insertframe', 'wordimage',\n\t\t\t\t'insertvideo', 'insertframe', 'edittip', 'edittable', 'edittd', 'scrawl', 'template', 'music', 'background', 'charts'\n\t\t\t]\n\t\t};\n\n\t\tfor (var p in dialogBtns) {\n\t\t\t(function(type, vals) {\n\t\t\t\tfor (var i = 0, ci; ci = vals[i++];) {\n\t\t\t\t\t//todo opera下存在问题\n\t\t\t\t\tif (browser.opera && ci === \"searchreplace\") {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t(function(cmd) {\n\t\t\t\t\t\teditorui[cmd] = function(editor, iframeUrl, title) {\n\t\t\t\t\t\t\tiframeUrl = iframeUrl || (editor.options.iframeUrlMap || {})[cmd] || iframeUrlMap[cmd];\n\t\t\t\t\t\t\ttitle = editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd) || '';\n\n\t\t\t\t\t\t\tvar dialog;\n\t\t\t\t\t\t\t//没有iframeUrl不创建dialog\n\t\t\t\t\t\t\tif (iframeUrl) {\n\t\t\t\t\t\t\t\tdialog = new editorui.Dialog(utils.extend({\n\t\t\t\t\t\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl),\n\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\t\tholdScroll: cmd === 'insertimage',\n\t\t\t\t\t\t\t\t\tfullscreen: /charts|preview/.test(cmd),\n\t\t\t\t\t\t\t\t\tcloseDialog: editor.getLang(\"closeDialog\")\n\t\t\t\t\t\t\t\t}, type == 'ok' ? {\n\t\t\t\t\t\t\t\t\tbuttons: [{\n\t\t\t\t\t\t\t\t\t\tclassName: 'edui-okbutton',\n\t\t\t\t\t\t\t\t\t\tlabel: editor.getLang(\"ok\"),\n\t\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\t\tdialog.close(true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\t\t\tclassName: 'edui-cancelbutton',\n\t\t\t\t\t\t\t\t\t\tlabel: editor.getLang(\"cancel\"),\n\t\t\t\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\t\t\tdialog.close(false);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}]\n\t\t\t\t\t\t\t\t} : {}));\n\n\t\t\t\t\t\t\t\teditor.ui._dialogs[cmd + \"Dialog\"] = dialog;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tvar ui = new editorui.Button({\n\t\t\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\t\tif (dialog) {\n\t\t\t\t\t\t\t\t\t\tswitch (cmd) {\n\t\t\t\t\t\t\t\t\t\t\tcase \"wordimage\":\n\t\t\t\t\t\t\t\t\t\t\t\tvar images = editor.execCommand(\"wordimage\");\n\t\t\t\t\t\t\t\t\t\t\t\tif (images && images.length) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tcase \"scrawl\":\n\t\t\t\t\t\t\t\t\t\t\t\tif (editor.queryCommandState(\"scrawl\") != -1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\t\t\t\t\tdialog.render();\n\t\t\t\t\t\t\t\t\t\t\t\tdialog.open();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\t\tdisabled: (cmd == 'scrawl' && editor.queryCommandState(\"scrawl\") == -1) || (cmd == 'charts')\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\t\t\t//只存在于右键菜单而无工具栏按钮的ui不需要检测状态\n\t\t\t\t\t\t\t\tvar unNeedCheckState = {\n\t\t\t\t\t\t\t\t\t'edittable': 1\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tif (cmd in unNeedCheckState) return;\n\n\t\t\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\t\t\tif (ui.getDom()) {\n\t\t\t\t\t\t\t\t\tui.setDisabled(state == -1);\n\t\t\t\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn ui;\n\t\t\t\t\t\t};\n\t\t\t\t\t})(ci.toLowerCase())\n\t\t\t\t}\n\t\t\t})(p, dialogBtns[p]);\n\t\t}\n\n\t\teditorui.snapscreen = function(editor, iframeUrl, title) {\n\t\t\ttitle = editor.options.labelMap['snapscreen'] || editor.getLang(\"labelMap.snapscreen\") || '';\n\t\t\tvar ui = new editorui.Button({\n\t\t\t\tclassName: 'edui-for-snapscreen',\n\t\t\t\ttitle: title,\n\t\t\t\tonclick: function() {\n\t\t\t\t\teditor.execCommand(\"snapscreen\");\n\t\t\t\t},\n\t\t\t\ttheme: editor.options.theme\n\n\t\t\t});\n\t\t\teditorui.buttons['snapscreen'] = ui;\n\t\t\tiframeUrl = iframeUrl || (editor.options.iframeUrlMap || {})[\"snapscreen\"] || iframeUrlMap[\"snapscreen\"];\n\t\t\tif (iframeUrl) {\n\t\t\t\tvar dialog = new editorui.Dialog({\n\t\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl),\n\t\t\t\t\teditor: editor,\n\t\t\t\t\tclassName: 'edui-for-snapscreen',\n\t\t\t\t\ttitle: title,\n\t\t\t\t\tbuttons: [{\n\t\t\t\t\t\tclassName: 'edui-okbutton',\n\t\t\t\t\t\tlabel: editor.getLang(\"ok\"),\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tdialog.close(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tclassName: 'edui-cancelbutton',\n\t\t\t\t\t\tlabel: editor.getLang(\"cancel\"),\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\tdialog.close(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\n\t\t\t\t});\n\t\t\t\tdialog.render();\n\t\t\t\teditor.ui._dialogs[\"snapscreenDialog\"] = dialog;\n\t\t\t}\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('snapscreen') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.insertcode = function(editor, list, title) {\n\t\t\tlist = editor.options['insertcode'] || [];\n\t\t\ttitle = editor.options.labelMap['insertcode'] || editor.getLang(\"labelMap.insertcode\") || '';\n\t\t\t// if (!list.length) return;\n\t\t\tvar items = [];\n\t\t\tutils.each(list, function(key, val) {\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: key,\n\t\t\t\t\tvalue: val,\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" >' + (this.label || '') + '</div>';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('insertcode', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-insertcode',\n\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.items[i]; i++) {\n\t\t\t\t\t\t\tif (ci.value.indexOf(value) != -1)\n\t\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['insertcode'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('insertcode');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('insertcode');\n\t\t\t\t\t\tif (!value) {\n\t\t\t\t\t\t\tui.setValue(title);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//trace:1871 ie下从源码模式切换回来时，字体会带单引号，而且会有逗号\n\t\t\t\t\t\tvalue && (value = value.replace(/['\"]/g, '').split(',')[0]);\n\t\t\t\t\t\tui.setValue(value);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\t\teditorui.fontfamily = function(editor, list, title) {\n\n\t\t\tlist = editor.options['fontfamily'] || [];\n\t\t\ttitle = editor.options.labelMap['fontfamily'] || editor.getLang(\"labelMap.fontfamily\") || '';\n\t\t\tif (!list.length) return;\n\t\t\tfor (var i = 0, ci, items = []; ci = list[i]; i++) {\n\t\t\t\tvar langLabel = editor.getLang('fontfamily')[ci.name] || \"\";\n\t\t\t\t(function(key, val) {\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: key,\n\t\t\t\t\t\tvalue: val,\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" style=\"font-family:' +\n\t\t\t\t\t\t\t\tutils.unhtml(this.value) + '\">' + (this.label || '') + '</div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})(ci.label || langLabel, ci.val)\n\t\t\t}\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('FontFamily', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-fontfamily',\n\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\tif (value) {\n\t\t\t\t\t\tfor (var i = 0, ci; ci = this.items[i]; i++) {\n\t\t\t\t\t\t\tif (ci.value.indexOf(value) != -1)\n\t\t\t\t\t\t\t\treturn i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['fontfamily'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('FontFamily');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('FontFamily');\n\t\t\t\t\t\t//trace:1871 ie下从源码模式切换回来时，字体会带单引号，而且会有逗号\n\t\t\t\t\t\tvalue && (value = value.replace(/['\"]/g, '').split(',')[0]);\n\t\t\t\t\t\tui.setValue(value);\n\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.fontsize = function(editor, list, title) {\n\t\t\ttitle = editor.options.labelMap['fontsize'] || editor.getLang(\"labelMap.fontsize\") || '';\n\t\t\tlist = list || editor.options['fontsize'] || [];\n\t\t\tif (!list.length) return;\n\t\t\tvar items = [];\n\t\t\tfor (var i = 0; i < list.length; i++) {\n\t\t\t\tvar size = list[i] + 'px';\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: size,\n\t\t\t\t\tvalue: size,\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\" style=\"line-height:1;font-size:' +\n\t\t\t\t\t\t\tthis.value + '\">' + (this.label || '') + '</div>';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('FontSize', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\tclassName: 'edui-for-fontsize'\n\t\t\t});\n\t\t\teditorui.buttons['fontsize'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('FontSize');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tui.setValue(editor.queryCommandValue('FontSize'));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.paragraph = function(editor, list, title) {\n\t\t\ttitle = editor.options.labelMap['paragraph'] || editor.getLang(\"labelMap.paragraph\") || '';\n\t\t\tlist = editor.options['paragraph'] || [];\n\t\t\tif (utils.isEmptyObject(list)) return;\n\t\t\tvar items = [];\n\t\t\tfor (var i in list) {\n\t\t\t\titems.push({\n\t\t\t\t\tvalue: i,\n\t\t\t\t\tlabel: list[i] || editor.getLang(\"paragraph\")[i],\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\"><span class=\"edui-for-' + this.value + '\">' + (this.label || '') + '</span></div>';\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-paragraph',\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('Paragraph', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['paragraph'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('Paragraph');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('Paragraph');\n\t\t\t\t\t\tvar index = ui.indexByValue(value);\n\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setValue(ui.initValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t//自定义标题\n\t\teditorui.customstyle = function(editor) {\n\t\t\tvar list = editor.options['customstyle'] || [],\n\t\t\t\ttitle = editor.options.labelMap['customstyle'] || editor.getLang(\"labelMap.customstyle\") || '';\n\t\t\tif (!list.length) return;\n\t\t\tvar langCs = editor.getLang('customstyle');\n\t\t\tfor (var i = 0, items = [], t; t = list[i++];) {\n\t\t\t\t(function(t) {\n\t\t\t\t\tvar ck = {};\n\t\t\t\t\tck.label = t.label ? t.label : langCs[t.name];\n\t\t\t\t\tck.style = t.style;\n\t\t\t\t\tck.className = t.className;\n\t\t\t\t\tck.tag = t.tag;\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tlabel: ck.label,\n\t\t\t\t\t\tvalue: ck,\n\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\trenderLabelHtml: function() {\n\t\t\t\t\t\t\treturn '<div class=\"edui-label %%-label\">' + '<' + ck.tag + ' ' + (ck.className ? ' class=\"' + ck.className + '\"' : \"\") + (ck.style ? ' style=\"' + ck.style + '\"' : \"\") + '>' + ck.label + \"<\\/\" + ck.tag + \">\" + '</div>';\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})(t);\n\t\t\t}\n\n\t\t\tvar ui = new editorui.Combox({\n\t\t\t\teditor: editor,\n\t\t\t\titems: items,\n\t\t\t\ttitle: title,\n\t\t\t\tinitValue: title,\n\t\t\t\tclassName: 'edui-for-customstyle',\n\t\t\t\tonselect: function(t, index) {\n\t\t\t\t\teditor.execCommand('customstyle', this.items[index].value);\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t},\n\t\t\t\tindexByValue: function(value) {\n\t\t\t\t\tfor (var i = 0, ti; ti = this.items[i++];) {\n\t\t\t\t\t\tif (ti.label == value) {\n\t\t\t\t\t\t\treturn i - 1\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['customstyle'] = ui;\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tif (!uiReady) {\n\t\t\t\t\tvar state = editor.queryCommandState('customstyle');\n\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tvar value = editor.queryCommandValue('customstyle');\n\t\t\t\t\t\tvar index = ui.indexByValue(value);\n\t\t\t\t\t\tif (index != -1) {\n\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setValue(ui.initValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\t\teditorui.inserttable = function(editor, iframeUrl, title) {\n\t\t\ttitle = editor.options.labelMap['inserttable'] || editor.getLang(\"labelMap.inserttable\") || '';\n\t\t\tvar ui = new editorui.TableButton({\n\t\t\t\teditor: editor,\n\t\t\t\ttitle: title,\n\t\t\t\tclassName: 'edui-for-inserttable',\n\t\t\t\tonpicktable: function(t, numCols, numRows) {\n\t\t\t\t\teditor.execCommand('InsertTable', {\n\t\t\t\t\t\tnumRows: numRows,\n\t\t\t\t\t\tnumCols: numCols,\n\t\t\t\t\t\tborder: 1\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tthis.showPopup();\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['inserttable'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('inserttable') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.lineheight = function(editor) {\n\t\t\tvar val = editor.options.lineheight || [];\n\t\t\tif (!val.length) return;\n\t\t\tfor (var i = 0, ci, items = []; ci = val[i++];) {\n\t\t\t\titems.push({\n\t\t\t\t\t//todo:写死了\n\t\t\t\t\tlabel: ci,\n\t\t\t\t\tvalue: ci,\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\teditor.execCommand(\"lineheight\", this.value);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\teditor: editor,\n\t\t\t\tclassName: 'edui-for-lineheight',\n\t\t\t\ttitle: editor.options.labelMap['lineheight'] || editor.getLang(\"labelMap.lineheight\") || '',\n\t\t\t\titems: items,\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\tvar value = editor.queryCommandValue('LineHeight') || this.value;\n\t\t\t\t\teditor.execCommand(\"LineHeight\", value);\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['lineheight'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tvar state = editor.queryCommandState('LineHeight');\n\t\t\t\tif (state == -1) {\n\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t} else {\n\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\tvar value = editor.queryCommandValue('LineHeight');\n\t\t\t\t\tvalue && ui.setValue((value + '').replace(/cm/, ''));\n\t\t\t\t\tui.setChecked(state)\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\tvar rowspacings = ['top', 'bottom'];\n\t\tfor (var r = 0, ri; ri = rowspacings[r++];) {\n\t\t\t(function(cmd) {\n\t\t\t\teditorui['rowspacing' + cmd] = function(editor) {\n\t\t\t\t\tvar val = editor.options['rowspacing' + cmd] || [];\n\t\t\t\t\tif (!val.length) return null;\n\t\t\t\t\tfor (var i = 0, ci, items = []; ci = val[i++];) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tlabel: ci,\n\t\t\t\t\t\t\tvalue: ci,\n\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\tonclick: function() {\n\t\t\t\t\t\t\t\teditor.execCommand(\"rowspacing\", this.value, cmd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tclassName: 'edui-for-rowspacing' + cmd,\n\t\t\t\t\t\ttitle: editor.options.labelMap['rowspacing' + cmd] || editor.getLang(\"labelMap.rowspacing\" + cmd) || '',\n\t\t\t\t\t\titems: items,\n\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('rowspacing', cmd) || this.value;\n\t\t\t\t\t\t\teditor.execCommand(\"rowspacing\", value, cmd);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\tvar state = editor.queryCommandState('rowspacing', cmd);\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue('rowspacing', cmd);\n\t\t\t\t\t\t\tvalue && ui.setValue((value + '').replace(/%/, ''));\n\t\t\t\t\t\t\tui.setChecked(state)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t}\n\t\t\t})(ri)\n\t\t}\n\t\t//有序，无序列表\n\t\tvar lists = ['insertorderedlist', 'insertunorderedlist'];\n\t\tfor (var l = 0, cl; cl = lists[l++];) {\n\t\t\t(function(cmd) {\n\t\t\t\teditorui[cmd] = function(editor) {\n\t\t\t\t\tvar vals = editor.options[cmd],\n\t\t\t\t\t\t_onMenuClick = function() {\n\t\t\t\t\t\t\teditor.execCommand(cmd, this.value);\n\t\t\t\t\t\t},\n\t\t\t\t\t\titems = [];\n\t\t\t\t\tfor (var i in vals) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tlabel: vals[i] || editor.getLang()[cmd][i] || \"\",\n\t\t\t\t\t\t\tvalue: i,\n\t\t\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\t\t\tonclick: _onMenuClick\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tvar ui = new editorui.MenuButton({\n\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\t\t\ttitle: editor.getLang(\"labelMap.\" + cmd) || '',\n\t\t\t\t\t\t'items': items,\n\t\t\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue(cmd) || this.value;\n\t\t\t\t\t\t\teditor.execCommand(cmd, value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditorui.buttons[cmd] = ui;\n\t\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\t\tvar state = editor.queryCommandState(cmd);\n\t\t\t\t\t\tif (state == -1) {\n\t\t\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\t\tvar value = editor.queryCommandValue(cmd);\n\t\t\t\t\t\t\tui.setValue(value);\n\t\t\t\t\t\t\tui.setChecked(state)\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\treturn ui;\n\t\t\t\t};\n\t\t\t})(cl)\n\t\t}\n\n\t\teditorui.fullscreen = function(editor, title) {\n\t\t\ttitle = editor.options.labelMap['fullscreen'] || editor.getLang(\"labelMap.fullscreen\") || '';\n\t\t\tvar ui = new editorui.Button({\n\t\t\t\tclassName: 'edui-for-fullscreen',\n\t\t\t\ttitle: title,\n\t\t\t\ttheme: editor.options.theme,\n\t\t\t\tonclick: function() {\n\t\t\t\t\tif (editor.ui) {\n\t\t\t\t\t\teditor.ui.setFullScreen(!editor.ui.isFullScreen());\n\t\t\t\t\t}\n\t\t\t\t\tthis.setChecked(editor.ui.isFullScreen());\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['fullscreen'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tvar state = editor.queryCommandState('fullscreen');\n\t\t\t\tui.setDisabled(state == -1);\n\t\t\t\tui.setChecked(editor.ui.isFullScreen());\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t// 表情\n\t\teditorui[\"emotion\"] = function(editor, iframeUrl) {\n\t\t\tvar cmd = \"emotion\";\n\t\t\tvar ui = new editorui.MultiMenuPop({\n\t\t\t\ttitle: editor.options.labelMap[cmd] || editor.getLang(\"labelMap.\" + cmd + \"\") || '',\n\t\t\t\teditor: editor,\n\t\t\t\tclassName: 'edui-for-' + cmd,\n\t\t\t\tiframeUrl: editor.ui.mapUrl(iframeUrl || (editor.options.iframeUrlMap || {})[cmd] || iframeUrlMap[cmd])\n\t\t\t});\n\t\t\teditorui.buttons[cmd] = ui;\n\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState(cmd) == -1)\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\teditorui.autotypeset = function(editor) {\n\t\t\tvar ui = new editorui.AutoTypeSetButton({\n\t\t\t\teditor: editor,\n\t\t\t\ttitle: editor.options.labelMap['autotypeset'] || editor.getLang(\"labelMap.autotypeset\") || '',\n\t\t\t\tclassName: 'edui-for-autotypeset',\n\t\t\t\tonbuttonclick: function() {\n\t\t\t\t\teditor.execCommand('autotypeset')\n\t\t\t\t}\n\t\t\t});\n\t\t\teditorui.buttons['autotypeset'] = ui;\n\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\tui.setDisabled(editor.queryCommandState('autotypeset') == -1);\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t\t/* 简单上传插件 */\n\t\teditorui[\"simpleupload\"] = function(editor) {\n\t\t\tvar name = 'simpleupload',\n\t\t\t\tui = new editorui.Button({\n\t\t\t\t\tclassName: 'edui-for-' + name,\n\t\t\t\t\ttitle: editor.options.labelMap[name] || editor.getLang(\"labelMap.\" + name) || '',\n\t\t\t\t\tonclick: function() {},\n\t\t\t\t\ttheme: editor.options.theme,\n\t\t\t\t\tshowText: false\n\t\t\t\t});\n\t\t\teditorui.buttons[name] = ui;\n\t\t\teditor.addListener('ready', function() {\n\t\t\t\tvar b = ui.getDom('body'),\n\t\t\t\t\ticonSpan = b.children[0];\n\t\t\t\teditor.fireEvent('simpleuploadbtnready', iconSpan);\n\t\t\t});\n\t\t\teditor.addListener('selectionchange', function(type, causeByUi, uiReady) {\n\t\t\t\tvar state = editor.queryCommandState(name);\n\t\t\t\tif (state == -1) {\n\t\t\t\t\tui.setDisabled(true);\n\t\t\t\t\tui.setChecked(false);\n\t\t\t\t} else {\n\t\t\t\t\tif (!uiReady) {\n\t\t\t\t\t\tui.setDisabled(false);\n\t\t\t\t\t\tui.setChecked(state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ui;\n\t\t};\n\n\t})();\n\n\t// adapter/editor.js\n\t///import core\n\t///commands 全屏\n\t///commandsName FullScreen\n\t///commandsTitle  全屏\n\t(function() {\n\t\tvar utils = baidu.editor.utils,\n\t\t\tuiUtils = baidu.editor.ui.uiUtils,\n\t\t\tUIBase = baidu.editor.ui.UIBase,\n\t\t\tdomUtils = baidu.editor.dom.domUtils;\n\t\tvar nodeStack = [];\n\n\t\tfunction EditorUI(options) {\n\t\t\tthis.initOptions(options);\n\t\t\tthis.initEditorUI();\n\t\t}\n\n\t\tEditorUI.prototype = {\n\t\t\tuiName: 'editor',\n\t\t\tinitEditorUI: function() {\n\t\t\t\tthis.editor.ui = this;\n\t\t\t\tthis._dialogs = {};\n\t\t\t\tthis.initUIBase();\n\t\t\t\tthis._initToolbars();\n\t\t\t\tvar editor = this.editor,\n\t\t\t\t\tme = this;\n\n\t\t\t\teditor.addListener('ready', function() {\n\t\t\t\t\t//提供getDialog方法\n\t\t\t\t\teditor.getDialog = function(name) {\n\t\t\t\t\t\treturn editor.ui._dialogs[name + \"Dialog\"];\n\t\t\t\t\t};\n\t\t\t\t\tdomUtils.on(editor.window, 'scroll', function(evt) {\n\t\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt);\n\t\t\t\t\t});\n\t\t\t\t\t//提供编辑器实时宽高(全屏时宽高不变化)\n\t\t\t\t\teditor.ui._actualFrameWidth = editor.options.initialFrameWidth;\n\n\t\t\t\t\tUE.browser.ie && UE.browser.version === 6 && editor.container.ownerDocument.execCommand(\"BackgroundImageCache\", false, true);\n\n\t\t\t\t\t//display bottom-bar label based on config\n\t\t\t\t\tif (editor.options.elementPathEnabled) {\n\t\t\t\t\t\teditor.ui.getDom('elementpath').innerHTML = '<div class=\"edui-editor-breadcrumb\">' + editor.getLang(\"elementPathTip\") + ':</div>';\n\t\t\t\t\t}\n\t\t\t\t\tif (editor.options.wordCount) {\n\t\t\t\t\t\tfunction countFn() {\n\t\t\t\t\t\t\tsetCount(editor, me);\n\t\t\t\t\t\t\tdomUtils.un(editor.document, \"click\", arguments.callee);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.on(editor.document, \"click\", countFn);\n\t\t\t\t\t\teditor.ui.getDom('wordcount').innerHTML = editor.getLang(\"wordCountTip\");\n\t\t\t\t\t}\n\t\t\t\t\teditor.ui._scale();\n\t\t\t\t\tif (editor.options.scaleEnabled) {\n\t\t\t\t\t\tif (editor.autoHeightEnabled) {\n\t\t\t\t\t\t\teditor.disableAutoHeight();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.enableScale();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tme.disableScale();\n\t\t\t\t\t}\n\t\t\t\t\tif (!editor.options.elementPathEnabled && !editor.options.wordCount && !editor.options.scaleEnabled) {\n\t\t\t\t\t\teditor.ui.getDom('elementpath').style.display = \"none\";\n\t\t\t\t\t\teditor.ui.getDom('wordcount').style.display = \"none\";\n\t\t\t\t\t\teditor.ui.getDom('scale').style.display = \"none\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!editor.selection.isFocus()) return;\n\t\t\t\t\teditor.fireEvent('selectionchange', false, true);\n\n\t\t\t\t});\n\n\t\t\t\teditor.addListener('mousedown', function(t, evt) {\n\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt, el);\n\t\t\t\t\tbaidu.editor.ui.ShortCutMenu.postHide(evt);\n\n\t\t\t\t});\n\t\t\t\teditor.addListener(\"delcells\", function() {\n\t\t\t\t\tif (UE.ui['edittip']) {\n\t\t\t\t\t\tnew UE.ui['edittip'](editor);\n\t\t\t\t\t}\n\t\t\t\t\teditor.getDialog('edittip').open();\n\t\t\t\t});\n\n\t\t\t\tvar pastePop, isPaste = false,\n\t\t\t\t\ttimer;\n\t\t\t\teditor.addListener(\"afterpaste\", function() {\n\t\t\t\t\tif (editor.queryCommandState('pasteplain'))\n\t\t\t\t\t\treturn;\n\t\t\t\t\tif (baidu.editor.ui.PastePicker) {\n\t\t\t\t\t\tpastePop = new baidu.editor.ui.Popup({\n\t\t\t\t\t\t\tcontent: new baidu.editor.ui.PastePicker({\n\t\t\t\t\t\t\t\teditor: editor\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\teditor: editor,\n\t\t\t\t\t\t\tclassName: 'edui-wordpastepop'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tpastePop.render();\n\t\t\t\t\t}\n\t\t\t\t\tisPaste = true;\n\t\t\t\t});\n\n\t\t\t\teditor.addListener(\"afterinserthtml\", function() {\n\t\t\t\t\tclearTimeout(timer);\n\t\t\t\t\ttimer = setTimeout(function() {\n\t\t\t\t\t\tif (pastePop && (isPaste || editor.ui._isTransfer)) {\n\t\t\t\t\t\t\tif (pastePop.isHidden()) {\n\t\t\t\t\t\t\t\tvar span = domUtils.createElement(editor.document, 'span', {\n\t\t\t\t\t\t\t\t\t\t'style': \"line-height:0px;\",\n\t\t\t\t\t\t\t\t\t\t'innerHTML': '\\ufeff'\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\trange = editor.selection.getRange();\n\t\t\t\t\t\t\t\trange.insertNode(span);\n\t\t\t\t\t\t\t\tvar tmp = getDomNode(span, 'firstChild', 'previousSibling');\n\t\t\t\t\t\t\t\ttmp && pastePop.showAnchor(tmp.nodeType == 3 ? tmp.parentNode : tmp);\n\t\t\t\t\t\t\t\tdomUtils.remove(span);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpastePop.show();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdelete editor.ui._isTransfer;\n\t\t\t\t\t\t\tisPaste = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 200)\n\t\t\t\t});\n\t\t\t\teditor.addListener('contextmenu', function(t, evt) {\n\t\t\t\t\tbaidu.editor.ui.Popup.postHide(evt);\n\t\t\t\t});\n\t\t\t\teditor.addListener('keydown', function(t, evt) {\n\t\t\t\t\tif (pastePop) pastePop.dispose(evt);\n\t\t\t\t\tvar keyCode = evt.keyCode || evt.which;\n\t\t\t\t\tif (evt.altKey && keyCode == 90) {\n\t\t\t\t\t\tUE.ui.buttons['fullscreen'].onclick();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\teditor.addListener('wordcount', function(type) {\n\t\t\t\t\tsetCount(this, me);\n\t\t\t\t});\n\n\t\t\t\tfunction setCount(editor, ui) {\n\t\t\t\t\teditor.setOpt({\n\t\t\t\t\t\twordCount: true,\n\t\t\t\t\t\tmaximumWords: 10000,\n\t\t\t\t\t\twordCountMsg: editor.options.wordCountMsg || editor.getLang(\"wordCountMsg\"),\n\t\t\t\t\t\twordOverFlowMsg: editor.options.wordOverFlowMsg || editor.getLang(\"wordOverFlowMsg\")\n\t\t\t\t\t});\n\t\t\t\t\tvar opt = editor.options,\n\t\t\t\t\t\tmax = opt.maximumWords,\n\t\t\t\t\t\tmsg = opt.wordCountMsg,\n\t\t\t\t\t\terrMsg = opt.wordOverFlowMsg,\n\t\t\t\t\t\tcountDom = ui.getDom('wordcount');\n\t\t\t\t\tif (!opt.wordCount) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tvar count = editor.getContentLength(true);\n\t\t\t\t\tif (count > max) {\n\t\t\t\t\t\tcountDom.innerHTML = errMsg;\n\t\t\t\t\t\teditor.fireEvent(\"wordcountoverflow\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcountDom.innerHTML = msg.replace(\"{#leave}\", max - count).replace(\"{#count}\", count);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\teditor.addListener('selectionchange', function() {\n\t\t\t\t\tif (editor.options.elementPathEnabled) {\n\t\t\t\t\t\tme[(editor.queryCommandState('elementpath') == -1 ? 'dis' : 'en') + 'ableElementPath']()\n\t\t\t\t\t}\n\t\t\t\t\tif (editor.options.scaleEnabled) {\n\t\t\t\t\t\tme[(editor.queryCommandState('scale') == -1 ? 'dis' : 'en') + 'ableScale']();\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvar popup = new baidu.editor.ui.Popup({\n\t\t\t\t\teditor: editor,\n\t\t\t\t\tcontent: '',\n\t\t\t\t\tclassName: 'edui-bubble',\n\t\t\t\t\t_onEditButtonClick: function() {\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\teditor.ui._dialogs.linkDialog.open();\n\t\t\t\t\t},\n\t\t\t\t\t_onImgEditButtonClick: function(name) {\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\teditor.ui._dialogs[name] && editor.ui._dialogs[name].open();\n\n\t\t\t\t\t},\n\t\t\t\t\t_onImgSetFloat: function(value) {\n\t\t\t\t\t\tconsole.log(this)\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\teditor.execCommand(\"imagefloat\", value);\n\n\t\t\t\t\t},\n\t\t\t\t\t_setIframeAlign: function(value) {\n\t\t\t\t\t\tvar frame = popup.anchorEl;\n\t\t\t\t\t\tvar newFrame = frame.cloneNode(true);\n\t\t\t\t\t\tswitch (value) {\n\t\t\t\t\t\t\tcase -2:\n\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase -1:\n\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"left\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\t\tnewFrame.setAttribute(\"align\", \"right\");\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tframe.parentNode.insertBefore(newFrame, frame);\n\t\t\t\t\t\tdomUtils.remove(frame);\n\t\t\t\t\t\tpopup.anchorEl = newFrame;\n\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t},\n\t\t\t\t\t_updateIframe: function() {\n\t\t\t\t\t\tvar frame = editor._iframe = popup.anchorEl;\n\t\t\t\t\t\tif (domUtils.hasClass(frame, 'ueditor_baidumap')) {\n\t\t\t\t\t\t\teditor.selection.getRange().selectNode(frame).select();\n\t\t\t\t\t\t\teditor.ui._dialogs.mapDialog.open();\n\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\teditor.ui._dialogs.insertframeDialog.open();\n\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t_onRemoveButtonClick: function(cmdName) {\n\t\t\t\t\t\teditor.execCommand(cmdName);\n\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t},\n\t\t\t\t\tqueryAutoHide: function(el) {\n\t\t\t\t\t\tif (el && el.ownerDocument == editor.document) {\n\t\t\t\t\t\t\tif (el.tagName.toLowerCase() == 'img' || domUtils.findParentByTagName(el, 'a', true)) {\n\t\t\t\t\t\t\t\treturn el !== popup.anchorEl;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn baidu.editor.ui.Popup.prototype.queryAutoHide.call(this, el);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpopup.render();\n\t\t\t\tif (editor.options.imagePopup) {\n\t\t\t\t\teditor.addListener('mouseover', function(t, evt) {\n\t\t\t\t\t\tevt = evt || window.event;\n\t\t\t\t\t\tvar el = evt.target || evt.srcElement;\n\t\t\t\t\t\tif (editor.ui._dialogs.insertframeDialog && /iframe/ig.test(el.tagName)) {\n\t\t\t\t\t\t\tvar html = popup.formatHtml(\n\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"property\") + ': <span onclick=$$._setIframeAlign(-2) class=\"edui-clickable\">' + editor.getLang(\"default\") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class=\"edui-clickable\">' + editor.getLang(\"justifyleft\") + '</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class=\"edui-clickable\">' + editor.getLang(\"justifyright\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t' <span onclick=\"$$._updateIframe( this);\" class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span></nobr>');\n\t\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\t\tpopup.getDom('content').innerHTML = html;\n\t\t\t\t\t\t\t\tpopup.anchorEl = el;\n\t\t\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\teditor.addListener('selectionchange', function(t, causeByUi) {\n\t\t\t\t\t\tif (!causeByUi) return;\n\t\t\t\t\t\tvar html = '',\n\t\t\t\t\t\t\tstr = \"\",\n\t\t\t\t\t\t\timg = editor.selection.getRange().getClosedNode(),\n\t\t\t\t\t\t\tdialogs = editor.ui._dialogs;\n\t\t\t\t\t\tif (img && img.tagName == 'IMG') {\n\t\t\t\t\t\t\tvar dialogName = 'insertimageDialog';\n\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-video\") != -1 || img.className.indexOf(\"edui-upload-video\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"insertvideoDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-webapp\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"webappDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.src.indexOf(\"http://api.map.baidu.com\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"mapDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.className.indexOf(\"edui-faked-music\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"musicDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.src.indexOf(\"http://maps.google.com/maps/api/staticmap\") != -1) {\n\t\t\t\t\t\t\t\tdialogName = \"gmapDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.getAttribute(\"anchorname\")) {\n\t\t\t\t\t\t\t\tdialogName = \"anchorDialog\";\n\t\t\t\t\t\t\t\thtml = popup.formatHtml(\n\t\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"property\") + ': <span onclick=$$._onImgEditButtonClick(\"anchorDialog\") class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t\t'<span onclick=$$._onRemoveButtonClick(\\'anchor\\') class=\"edui-clickable\">' + editor.getLang(\"delete\") + '</span></nobr>');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (img.getAttribute(\"word_img\")) {\n\t\t\t\t\t\t\t\t//todo 放到dialog去做查询\n\t\t\t\t\t\t\t\teditor.word_img = [img.getAttribute(\"word_img\")];\n\t\t\t\t\t\t\t\tdialogName = \"wordimageDialog\"\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (domUtils.hasClass(img, 'loadingclass') || domUtils.hasClass(img, 'loaderrorclass')) {\n\t\t\t\t\t\t\t\tdialogName = \"\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!dialogs[dialogName]) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstr = '<nobr>' + editor.getLang(\"property\") + ': ' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"none\") class=\"edui-clickable ssss\">' + editor.getLang(\"default\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"left\") class=\"edui-clickable\">' + editor.getLang(\"justifyleft\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"right\") class=\"edui-clickable\">' + editor.getLang(\"justifyright\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=$$._onImgSetFloat(\"center\") class=\"edui-clickable\">' + editor.getLang(\"justifycenter\") + '</span>&nbsp;&nbsp;' +\n\t\t\t\t\t\t\t\t'<span onclick=\"$$._onImgEditButtonClick(\\'' + dialogName + '\\');\" class=\"edui-clickable\">' + editor.getLang(\"modify\") + '</span></nobr>';\n\n\t\t\t\t\t\t\t!html && (html = popup.formatHtml(str))\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (editor.ui._dialogs.linkDialog) {\n\t\t\t\t\t\t\tvar link = editor.queryCommandValue('link');\n\t\t\t\t\t\t\tvar url;\n\t\t\t\t\t\t\tif (link && (url = (link.getAttribute('_href') || link.getAttribute('href', 2)))) {\n\t\t\t\t\t\t\t\tvar txt = url;\n\t\t\t\t\t\t\t\tif (url.length > 30) {\n\t\t\t\t\t\t\t\t\ttxt = url.substring(0, 20) + \"...\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\t\t\thtml += '<div style=\"height:5px;\"></div>'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\thtml += popup.formatHtml(\n\t\t\t\t\t\t\t\t\t'<nobr>' + editor.getLang(\"anthorMsg\") + ': <a target=\"_blank\" href=\"' + url + '\" title=\"' + url + '\" >' + txt + '</a>' +\n\t\t\t\t\t\t\t\t\t' <span class=\"edui-clickable\" onclick=\"$$._onEditButtonClick();\">' + editor.getLang(\"modify\") + '</span>' +\n\t\t\t\t\t\t\t\t\t' <span class=\"edui-clickable\" onclick=\"$$._onRemoveButtonClick(\\'unlink\\');\"> ' + editor.getLang(\"clear\") + '</span></nobr>');\n\t\t\t\t\t\t\t\tpopup.showAnchor(link);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (html) {\n\t\t\t\t\t\t\tpopup.getDom('content').innerHTML = html;\n\t\t\t\t\t\t\tpopup.anchorEl = img || link;\n\t\t\t\t\t\t\tpopup.showAnchor(popup.anchorEl);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpopup.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t_initToolbars: function() {\n\t\t\t\tvar editor = this.editor;\n\t\t\t\tvar toolbars = this.toolbars || [];\n\t\t\t\tvar toolbarUis = [];\n\t\t\t\tfor (var i = 0; i < toolbars.length; i++) {\n\t\t\t\t\tvar toolbar = toolbars[i];\n\t\t\t\t\tvar toolbarUi = new baidu.editor.ui.Toolbar({\n\t\t\t\t\t\ttheme: editor.options.theme\n\t\t\t\t\t});\n\t\t\t\t\tfor (var j = 0; j < toolbar.length; j++) {\n\t\t\t\t\t\tvar toolbarItem = toolbar[j];\n\t\t\t\t\t\tvar toolbarItemUi = null;\n\t\t\t\t\t\tif (typeof toolbarItem == 'string') {\n\t\t\t\t\t\t\ttoolbarItem = toolbarItem.toLowerCase();\n\t\t\t\t\t\t\tif (toolbarItem == '|') {\n\t\t\t\t\t\t\t\ttoolbarItem = 'Separator';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (toolbarItem == '||') {\n\t\t\t\t\t\t\t\ttoolbarItem = 'Breakline';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (baidu.editor.ui[toolbarItem]) {\n\t\t\t\t\t\t\t\ttoolbarItemUi = new baidu.editor.ui[toolbarItem](editor);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t//fullscreen这里单独处理一下，放到首行去\n\t\t\t\t\t\t\tif (toolbarItem == 'fullscreen') {\n\t\t\t\t\t\t\t\tif (toolbarUis && toolbarUis[0]) {\n\t\t\t\t\t\t\t\t\ttoolbarUis[0].items.splice(0, 0, toolbarItemUi);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\ttoolbarItemUi && toolbarUi.items.splice(0, 0, toolbarItemUi);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoolbarItemUi = toolbarItem;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (toolbarItemUi && toolbarItemUi.id) {\n\n\t\t\t\t\t\t\ttoolbarUi.add(toolbarItemUi);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ttoolbarUis[i] = toolbarUi;\n\t\t\t\t}\n\n\t\t\t\t//接受外部定制的UI\n\n\t\t\t\tutils.each(UE._customizeUI, function(obj, key) {\n\t\t\t\t\tvar itemUI, index;\n\t\t\t\t\tif (obj.id && obj.id != editor.key) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\titemUI = obj.execFn.call(editor, editor, key);\n\t\t\t\t\tif (itemUI) {\n\t\t\t\t\t\tindex = obj.index;\n\t\t\t\t\t\tif (index === undefined) {\n\t\t\t\t\t\t\tindex = toolbarUi.items.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ttoolbarUi.add(itemUI, index)\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.toolbars = toolbarUis;\n\t\t\t},\n\t\t\tgetHtmlTpl: function() {\n\t\t\t\treturn '<div id=\"##\" class=\"%%\">' +\n\t\t\t\t\t'<div id=\"##_toolbarbox\" class=\"%%-toolbarbox\">' +\n\t\t\t\t\t(this.toolbars.length ?\n\t\t\t\t\t\t'<div id=\"##_toolbarboxouter\" class=\"%%-toolbarboxouter\"><div class=\"%%-toolbarboxinner\">' +\n\t\t\t\t\t\tthis.renderToolbarBoxHtml() +\n\t\t\t\t\t\t'</div></div>' : '') +\n\t\t\t\t\t'<div id=\"##_toolbarmsg\" class=\"%%-toolbarmsg\" style=\"display:none;\">' +\n\t\t\t\t\t'<div id = \"##_upload_dialog\" class=\"%%-toolbarmsg-upload\" onclick=\"$$.showWordImageDialog();\">' + this.editor.getLang(\"clickToUpload\") + '</div>' +\n\t\t\t\t\t'<div class=\"%%-toolbarmsg-close\" onclick=\"$$.hideToolbarMsg();\">x</div>' +\n\t\t\t\t\t'<div id=\"##_toolbarmsg_label\" class=\"%%-toolbarmsg-label\"></div>' +\n\t\t\t\t\t'<div style=\"height:0;overflow:hidden;clear:both;\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"##_message_holder\" class=\"%%-messageholder\"></div>' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t'<div id=\"##_iframeholder\" class=\"%%-iframeholder\">' +\n\t\t\t\t\t'</div>' +\n\t\t\t\t\t//modify wdcount by matao\n\t\t\t\t\t'<div id=\"##_bottombar\" class=\"%%-bottomContainer\"><table><tr>' +\n\t\t\t\t\t'<td id=\"##_elementpath\" class=\"%%-bottombar\"></td>' +\n\t\t\t\t\t'<td id=\"##_wordcount\" class=\"%%-wordcount\"></td>' +\n\t\t\t\t\t'<td id=\"##_scale\" class=\"%%-scale\"><div class=\"%%-icon\"></div></td>' +\n\t\t\t\t\t'</tr></table></div>' +\n\t\t\t\t\t'<div id=\"##_scalelayer\"></div>' +\n\t\t\t\t\t'</div>';\n\t\t\t},\n\t\t\tshowWordImageDialog: function() {\n\t\t\t\tthis._dialogs['wordimageDialog'].open();\n\t\t\t},\n\t\t\trenderToolbarBoxHtml: function() {\n\t\t\t\tvar buff = [];\n\t\t\t\tfor (var i = 0; i < this.toolbars.length; i++) {\n\t\t\t\t\tbuff.push(this.toolbars[i].renderHtml());\n\t\t\t\t}\n\t\t\t\treturn buff.join('');\n\t\t\t},\n\t\t\tsetFullScreen: function(fullscreen) {\n\n\t\t\t\tvar editor = this.editor,\n\t\t\t\t\tcontainer = editor.container.parentNode.parentNode;\n\t\t\t\tif (this._fullscreen != fullscreen) {\n\t\t\t\t\tthis._fullscreen = fullscreen;\n\t\t\t\t\tthis.editor.fireEvent('beforefullscreenchange', fullscreen);\n\t\t\t\t\tif (baidu.editor.browser.gecko) {\n\t\t\t\t\t\tvar bk = editor.selection.getRange().createBookmark();\n\t\t\t\t\t}\n\t\t\t\t\tif (fullscreen) {\n\t\t\t\t\t\twhile (container.tagName != \"BODY\") {\n\t\t\t\t\t\t\tvar position = baidu.editor.dom.domUtils.getComputedStyle(container, \"position\");\n\t\t\t\t\t\t\tnodeStack.push(position);\n\t\t\t\t\t\t\tcontainer.style.position = \"static\";\n\t\t\t\t\t\t\tcontainer = container.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._bakHtmlOverflow = document.documentElement.style.overflow;\n\t\t\t\t\t\tthis._bakBodyOverflow = document.body.style.overflow;\n\t\t\t\t\t\tthis._bakAutoHeight = this.editor.autoHeightEnabled;\n\t\t\t\t\t\tthis._bakScrollTop = Math.max(document.documentElement.scrollTop, document.body.scrollTop);\n\n\t\t\t\t\t\tthis._bakEditorContaninerWidth = editor.iframe.parentNode.offsetWidth;\n\t\t\t\t\t\tif (this._bakAutoHeight) {\n\t\t\t\t\t\t\t//当全屏时不能执行自动长高\n\t\t\t\t\t\t\teditor.autoHeightEnabled = false;\n\t\t\t\t\t\t\tthis.editor.disableAutoHeight();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.documentElement.style.overflow = 'hidden';\n\t\t\t\t\t\t//修复，滚动条不收起的问题\n\n\t\t\t\t\t\twindow.scrollTo(0, window.scrollY);\n\t\t\t\t\t\tthis._bakCssText = this.getDom().style.cssText;\n\t\t\t\t\t\tthis._bakCssText1 = this.getDom('iframeholder').style.cssText;\n\t\t\t\t\t\teditor.iframe.parentNode.style.width = '';\n\t\t\t\t\t\tthis._updateFullScreen();\n\t\t\t\t\t} else {\n\t\t\t\t\t\twhile (container.tagName != \"BODY\") {\n\t\t\t\t\t\t\tcontainer.style.position = nodeStack.shift();\n\t\t\t\t\t\t\tcontainer = container.parentNode;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.getDom().style.cssText = this._bakCssText;\n\t\t\t\t\t\tthis.getDom('iframeholder').style.cssText = this._bakCssText1;\n\t\t\t\t\t\tif (this._bakAutoHeight) {\n\t\t\t\t\t\t\teditor.autoHeightEnabled = true;\n\t\t\t\t\t\t\tthis.editor.enableAutoHeight();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdocument.documentElement.style.overflow = this._bakHtmlOverflow;\n\t\t\t\t\t\tdocument.body.style.overflow = this._bakBodyOverflow;\n\t\t\t\t\t\teditor.iframe.parentNode.style.width = this._bakEditorContaninerWidth + 'px';\n\t\t\t\t\t\twindow.scrollTo(0, this._bakScrollTop);\n\t\t\t\t\t}\n\t\t\t\t\tif (browser.gecko && editor.body.contentEditable === 'true') {\n\t\t\t\t\t\tvar input = document.createElement('input');\n\t\t\t\t\t\tdocument.body.appendChild(input);\n\t\t\t\t\t\teditor.body.contentEditable = false;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tinput.focus();\n\t\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\t\teditor.body.contentEditable = true;\n\t\t\t\t\t\t\t\teditor.fireEvent('fullscreenchanged', fullscreen);\n\t\t\t\t\t\t\t\teditor.selection.getRange().moveToBookmark(bk).select(true);\n\t\t\t\t\t\t\t\tbaidu.editor.dom.domUtils.remove(input);\n\t\t\t\t\t\t\t\tfullscreen && window.scroll(0, 0);\n\t\t\t\t\t\t\t}, 0)\n\t\t\t\t\t\t}, 0)\n\t\t\t\t\t}\n\n\t\t\t\t\tif (editor.body.contentEditable === 'true') {\n\t\t\t\t\t\tthis.editor.fireEvent('fullscreenchanged', fullscreen);\n\t\t\t\t\t\tthis.triggerLayout();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\t\t\t_updateFullScreen: function() {\n\t\t\t\tif (this._fullscreen) {\n\t\t\t\t\tvar vpRect = uiUtils.getViewportRect();\n\t\t\t\t\tthis.getDom().style.cssText = 'border:0;position:absolute;left:0;top:' + (this.editor.options.topOffset || 0) + 'px;width:' + vpRect.width + 'px;height:' + vpRect.height + 'px;z-index:' + (this.getDom().style.zIndex * 1 + 100);\n\t\t\t\t\tuiUtils.setViewportOffset(this.getDom(), {\n\t\t\t\t\t\tleft: 0,\n\t\t\t\t\t\ttop: this.editor.options.topOffset || 0\n\t\t\t\t\t});\n\t\t\t\t\tthis.editor.setHeight(vpRect.height - this.getDom('toolbarbox').offsetHeight - this.getDom('bottombar').offsetHeight - (this.editor.options.topOffset || 0), true);\n\t\t\t\t\t//不手动调一下，会导致全屏失效\n\t\t\t\t\tif (browser.gecko) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\twindow.onresize();\n\t\t\t\t\t\t} catch (e) {\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t_updateElementPath: function() {\n\t\t\t\tvar bottom = this.getDom('elementpath'),\n\t\t\t\t\tlist;\n\t\t\t\tif (this.elementPathEnabled && (list = this.editor.queryCommandValue('elementpath'))) {\n\n\t\t\t\t\tvar buff = [];\n\t\t\t\t\tfor (var i = 0, ci; ci = list[i]; i++) {\n\t\t\t\t\t\tbuff[i] = this.formatHtml('<span unselectable=\"on\" onclick=\"$$.editor.execCommand(&quot;elementpath&quot;, &quot;' + i + '&quot;);\">' + ci + '</span>');\n\t\t\t\t\t}\n\t\t\t\t\tbottom.innerHTML = '<div class=\"edui-editor-breadcrumb\" onmousedown=\"return false;\">' + this.editor.getLang(\"elementPathTip\") + ': ' + buff.join(' &gt; ') + '</div>';\n\n\t\t\t\t} else {\n\t\t\t\t\tbottom.style.display = 'none'\n\t\t\t\t}\n\t\t\t},\n\t\t\tdisableElementPath: function() {\n\t\t\t\tvar bottom = this.getDom('elementpath');\n\t\t\t\tbottom.innerHTML = '';\n\t\t\t\tbottom.style.display = 'none';\n\t\t\t\tthis.elementPathEnabled = false;\n\n\t\t\t},\n\t\t\tenableElementPath: function() {\n\t\t\t\tvar bottom = this.getDom('elementpath');\n\t\t\t\tbottom.style.display = '';\n\t\t\t\tthis.elementPathEnabled = true;\n\t\t\t\tthis._updateElementPath();\n\t\t\t},\n\t\t\t_scale: function() {\n\t\t\t\tvar doc = document,\n\t\t\t\t\teditor = this.editor,\n\t\t\t\t\teditorHolder = editor.container,\n\t\t\t\t\teditorDocument = editor.document,\n\t\t\t\t\ttoolbarBox = this.getDom(\"toolbarbox\"),\n\t\t\t\t\tbottombar = this.getDom(\"bottombar\"),\n\t\t\t\t\tscale = this.getDom(\"scale\"),\n\t\t\t\t\tscalelayer = this.getDom(\"scalelayer\");\n\n\t\t\t\tvar isMouseMove = false,\n\t\t\t\t\tposition = null,\n\t\t\t\t\tminEditorHeight = 0,\n\t\t\t\t\tminEditorWidth = editor.options.minFrameWidth,\n\t\t\t\t\tpageX = 0,\n\t\t\t\t\tpageY = 0,\n\t\t\t\t\tscaleWidth = 0,\n\t\t\t\t\tscaleHeight = 0;\n\n\t\t\t\tfunction down() {\n\t\t\t\t\tposition = domUtils.getXY(editorHolder);\n\n\t\t\t\t\tif (!minEditorHeight) {\n\t\t\t\t\t\tminEditorHeight = editor.options.minFrameHeight + toolbarBox.offsetHeight + bottombar.offsetHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tscalelayer.style.cssText = \"position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:\" + editorHolder.offsetWidth + \"px;height:\" + editorHolder.offsetHeight + \"px;z-index:\" + (editor.options.zIndex + 1);\n\n\t\t\t\t\tdomUtils.on(doc, \"mousemove\", move);\n\t\t\t\t\tdomUtils.on(editorDocument, \"mouseup\", up);\n\t\t\t\t\tdomUtils.on(doc, \"mouseup\", up);\n\t\t\t\t}\n\n\t\t\t\tvar me = this;\n\t\t\t\t//by xuheng 全屏时关掉缩放\n\t\t\t\tthis.editor.addListener('fullscreenchanged', function(e, fullScreen) {\n\t\t\t\t\tif (fullScreen) {\n\t\t\t\t\t\tme.disableScale();\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (me.editor.options.scaleEnabled) {\n\t\t\t\t\t\t\tme.enableScale();\n\t\t\t\t\t\t\tvar tmpNode = me.editor.document.createElement('span');\n\t\t\t\t\t\t\tme.editor.body.appendChild(tmpNode);\n\t\t\t\t\t\t\tme.editor.body.style.height = Math.max(domUtils.getXY(tmpNode).y, me.editor.iframe.offsetHeight - 20) + 'px';\n\t\t\t\t\t\t\tdomUtils.remove(tmpNode)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tfunction move(event) {\n\t\t\t\t\tclearSelection();\n\t\t\t\t\tvar e = event || window.event;\n\t\t\t\t\tpageX = e.pageX || (doc.documentElement.scrollLeft + e.clientX);\n\t\t\t\t\tpageY = e.pageY || (doc.documentElement.scrollTop + e.clientY);\n\t\t\t\t\tscaleWidth = pageX - position.x;\n\t\t\t\t\tscaleHeight = pageY - position.y;\n\n\t\t\t\t\tif (scaleWidth >= minEditorWidth) {\n\t\t\t\t\t\tisMouseMove = true;\n\t\t\t\t\t\tscalelayer.style.width = scaleWidth + 'px';\n\t\t\t\t\t}\n\t\t\t\t\tif (scaleHeight >= minEditorHeight) {\n\t\t\t\t\t\tisMouseMove = true;\n\t\t\t\t\t\tscalelayer.style.height = scaleHeight + \"px\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction up() {\n\t\t\t\t\tif (isMouseMove) {\n\t\t\t\t\t\tisMouseMove = false;\n\t\t\t\t\t\teditor.ui._actualFrameWidth = scalelayer.offsetWidth - 2;\n\t\t\t\t\t\teditorHolder.style.width = editor.ui._actualFrameWidth + 'px';\n\n\t\t\t\t\t\teditor.setHeight(scalelayer.offsetHeight - bottombar.offsetHeight - toolbarBox.offsetHeight - 2, true);\n\t\t\t\t\t}\n\t\t\t\t\tif (scalelayer) {\n\t\t\t\t\t\tscalelayer.style.display = \"none\";\n\t\t\t\t\t}\n\t\t\t\t\tclearSelection();\n\t\t\t\t\tdomUtils.un(doc, \"mousemove\", move);\n\t\t\t\t\tdomUtils.un(editorDocument, \"mouseup\", up);\n\t\t\t\t\tdomUtils.un(doc, \"mouseup\", up);\n\t\t\t\t}\n\n\t\t\t\tfunction clearSelection() {\n\t\t\t\t\tif (browser.ie)\n\t\t\t\t\t\tdoc.selection.clear();\n\t\t\t\t\telse\n\t\t\t\t\t\twindow.getSelection().removeAllRanges();\n\t\t\t\t}\n\n\t\t\t\tthis.enableScale = function() {\n\t\t\t\t\t//trace:2868\n\t\t\t\t\tif (editor.queryCommandState(\"source\") == 1) return;\n\t\t\t\t\tscale.style.display = \"\";\n\t\t\t\t\tthis.scaleEnabled = true;\n\t\t\t\t\tdomUtils.on(scale, \"mousedown\", down);\n\t\t\t\t};\n\t\t\t\tthis.disableScale = function() {\n\t\t\t\t\tscale.style.display = \"none\";\n\t\t\t\t\tthis.scaleEnabled = false;\n\t\t\t\t\tdomUtils.un(scale, \"mousedown\", down);\n\t\t\t\t};\n\t\t\t},\n\t\t\tisFullScreen: function() {\n\t\t\t\treturn this._fullscreen;\n\t\t\t},\n\t\t\tpostRender: function() {\n\t\t\t\tUIBase.prototype.postRender.call(this);\n\t\t\t\tfor (var i = 0; i < this.toolbars.length; i++) {\n\t\t\t\t\tthis.toolbars[i].postRender();\n\t\t\t\t}\n\t\t\t\tvar me = this;\n\t\t\t\tvar timerId,\n\t\t\t\t\tdomUtils = baidu.editor.dom.domUtils,\n\t\t\t\t\tupdateFullScreenTime = function() {\n\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t\ttimerId = setTimeout(function() {\n\t\t\t\t\t\t\tme._updateFullScreen();\n\t\t\t\t\t\t});\n\t\t\t\t\t};\n\t\t\t\tdomUtils.on(window, 'resize', updateFullScreenTime);\n\n\t\t\t\tme.addListener('destroy', function() {\n\t\t\t\t\tdomUtils.un(window, 'resize', updateFullScreenTime);\n\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t})\n\t\t\t},\n\t\t\tshowToolbarMsg: function(msg, flag) {\n\t\t\t\tthis.getDom('toolbarmsg_label').innerHTML = msg;\n\t\t\t\tthis.getDom('toolbarmsg').style.display = '';\n\t\t\t\t//\n\t\t\t\tif (!flag) {\n\t\t\t\t\tvar w = this.getDom('upload_dialog');\n\t\t\t\t\tw.style.display = 'none';\n\t\t\t\t}\n\t\t\t},\n\t\t\thideToolbarMsg: function() {\n\t\t\t\tthis.getDom('toolbarmsg').style.display = 'none';\n\t\t\t},\n\t\t\tmapUrl: function(url) {\n\t\t\t\treturn url ? url.replace('~/', this.editor.options.UEDITOR_HOME_URL || '') : ''\n\t\t\t},\n\t\t\ttriggerLayout: function() {\n\t\t\t\tvar dom = this.getDom();\n\t\t\t\tif (dom.style.zoom == '1') {\n\t\t\t\t\tdom.style.zoom = '100%';\n\t\t\t\t} else {\n\t\t\t\t\tdom.style.zoom = '1';\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tutils.inherits(EditorUI, baidu.editor.ui.UIBase);\n\n\t\tvar instances = {};\n\n\t\tUE.ui.Editor = function(options) {\n\t\t\tvar editor = new UE.Editor(options);\n\t\t\teditor.options.editor = editor;\n\t\t\tutils.loadFile(document, {\n\t\t\t\thref: editor.options.themePath + \"ueditor.css?v=\"+$GLOBAL_CONFIG['versionData'],\n\t\t\t\ttag: \"link\",\n\t\t\t\ttype: \"text/css\",\n\t\t\t\trel: \"stylesheet\"\n\t\t\t});\n\n\t\t\tvar oldRender = editor.render;\n\t\t\teditor.render = function(holder) {\n\t\t\t\tif (holder.constructor === String) {\n\t\t\t\t\teditor.key = holder;\n\t\t\t\t\tinstances[holder] = editor;\n\t\t\t\t}\n\t\t\t\tutils.domReady(function() {\n\t\t\t\t\teditor.langIsReady ? renderUI() : editor.addListener(\"langReady\", renderUI);\n\n\t\t\t\t\tfunction renderUI() {\n\t\t\t\t\t\teditor.setOpt({\n\t\t\t\t\t\t\tlabelMap: editor.options.labelMap || editor.getLang('labelMap')\n\t\t\t\t\t\t});\n\t\t\t\t\t\tnew EditorUI(editor.options);\n\t\t\t\t\t\tif (holder) {\n\t\t\t\t\t\t\tif (holder.constructor === String) {\n\t\t\t\t\t\t\t\tholder = document.getElementById(holder);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tholder && holder.getAttribute('name') && (editor.options.textarea = holder.getAttribute('name'));\n\t\t\t\t\t\t\tif (holder && /script|textarea/ig.test(holder.tagName)) {\n\t\t\t\t\t\t\t\tvar newDiv = document.createElement('div');\n\t\t\t\t\t\t\t\tholder.parentNode.insertBefore(newDiv, holder);\n\t\t\t\t\t\t\t\tvar cont = holder.value || holder.innerHTML;\n\t\t\t\t\t\t\t\teditor.options.initialContent = /^[\\t\\r\\n ]*$/.test(cont) ? editor.options.initialContent :\n\t\t\t\t\t\t\t\t\tcont.replace(/>[\\n\\r\\t]+([ ]{4})+/g, '>')\n\t\t\t\t\t\t\t\t\t.replace(/[\\n\\r\\t]+([ ]{4})+</g, '<')\n\t\t\t\t\t\t\t\t\t.replace(/>[\\n\\r\\t]+</g, '><');\n\t\t\t\t\t\t\t\tholder.className && (newDiv.className = holder.className);\n\t\t\t\t\t\t\t\tholder.style.cssText && (newDiv.style.cssText = holder.style.cssText);\n\t\t\t\t\t\t\t\tif (/textarea/i.test(holder.tagName)) {\n\t\t\t\t\t\t\t\t\teditor.textarea = holder;\n\t\t\t\t\t\t\t\t\teditor.textarea.style.display = 'none';\n\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tholder.parentNode.removeChild(holder);\n\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif (holder.id) {\n\t\t\t\t\t\t\t\t\tnewDiv.id = holder.id;\n\t\t\t\t\t\t\t\t\tdomUtils.removeAttributes(holder, 'id');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tholder = newDiv;\n\t\t\t\t\t\t\t\tholder.innerHTML = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdomUtils.addClass(holder, \"edui-\" + editor.options.theme);\n\t\t\t\t\t\teditor.ui.render(holder);\n\t\t\t\t\t\tvar opt = editor.options;\n\t\t\t\t\t\t//给实例添加一个编辑器的容器引用\n\t\t\t\t\t\teditor.container = editor.ui.getDom();\n\t\t\t\t\t\tvar parents = domUtils.findParents(holder, true);\n\t\t\t\t\t\tvar displays = [];\n\t\t\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\t\t\tdisplays[i] = ci.style.display;\n\t\t\t\t\t\t\tci.style.display = 'block'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opt.initialFrameWidth) {\n\t\t\t\t\t\t\topt.minFrameWidth = opt.initialFrameWidth;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\topt.minFrameWidth = opt.initialFrameWidth = holder.offsetWidth;\n\t\t\t\t\t\t\tvar styleWidth = holder.style.width;\n\t\t\t\t\t\t\tif (/%$/.test(styleWidth)) {\n\t\t\t\t\t\t\t\topt.initialFrameWidth = styleWidth;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (opt.initialFrameHeight) {\n\t\t\t\t\t\t\topt.minFrameHeight = opt.initialFrameHeight;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\topt.initialFrameHeight = opt.minFrameHeight = holder.offsetHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor (var i = 0, ci; ci = parents[i]; i++) {\n\t\t\t\t\t\t\tci.style.display = displays[i]\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//编辑器最外容器设置了高度，会导致，编辑器不占位\n\t\t\t\t\t\t//todo 先去掉，没有找到原因\n\t\t\t\t\t\tif (holder.style.height) {\n\t\t\t\t\t\t\tholder.style.height = ''\n\t\t\t\t\t\t}\n\t\t\t\t\t\teditor.container.style.width = opt.initialFrameWidth + (/%$/.test(opt.initialFrameWidth) ? '' : 'px');\n\t\t\t\t\t\teditor.container.style.zIndex = opt.zIndex;\n\t\t\t\t\t\toldRender.call(editor, editor.ui.getDom('iframeholder'));\n\t\t\t\t\t\teditor.fireEvent(\"afteruiready\");\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t};\n\t\t\treturn editor;\n\t\t};\n\n\t\t/**\n\t\t * @file\n\t\t * @name UE\n\t\t * @short UE\n\t\t * @desc UEditor的顶部命名空间\n\t\t */\n\t\t/**\n\t\t * @name getEditor\n\t\t * @since 1.2.4+\n\t\t * @grammar UE.getEditor(id,[opt])  =>  Editor实例\n\t\t * @desc 提供一个全局的方法得到编辑器实例\n\t\t *\n\t\t * * ''id''  放置编辑器的容器id, 如果容器下的编辑器已经存在，就直接返回\n\t\t * * ''opt'' 编辑器的可选参数\n\t\t * @example\n\t\t *  UE.getEditor('containerId',{onready:function(){//创建一个编辑器实例\n\t\t *      this.setContent('hello')\n\t\t *  }});\n\t\t *  UE.getEditor('containerId'); //返回刚创建的实例\n\t\t *\n\t\t */\n\t\tUE.getEditor = function(id, opt) {\n\t\t\tvar editor = instances[id];\n\t\t\tif (!editor) {\n\t\t\t\teditor = instances[id] = new UE.ui.Editor(opt);\n\t\t\t\teditor.render(id);\n\t\t\t}\n\t\t\treturn editor;\n\t\t};\n\n\t\tUE.delEditor = function(id) {\n\t\t\tvar editor;\n\t\t\tif (editor = instances[id]) {\n\t\t\t\teditor.key && editor.destroy();\n\t\t\t\tdelete instances[id]\n\t\t\t}\n\t\t};\n\n\t\tUE.registerUI = function(uiName, fn, index, editorId) {\n\t\t\tutils.each(uiName.split(/\\s+/), function(name) {\n\t\t\t\tUE._customizeUI[name] = {\n\t\t\t\t\tid: editorId,\n\t\t\t\t\texecFn: fn,\n\t\t\t\t\tindex: index\n\t\t\t\t};\n\t\t\t})\n\n\t\t}\n\n\t})();\n\n\t// adapter/message.js\n\tUE.registerUI('message', function(editor) {\n\n\t\tvar editorui = baidu.editor.ui;\n\t\tvar Message = editorui.Message;\n\t\tvar holder;\n\t\tvar _messageItems = [];\n\t\tvar me = editor;\n\n\t\tme.addListener('ready', function() {\n\t\t\tholder = document.getElementById(me.ui.id + '_message_holder');\n\t\t\tupdateHolderPos();\n\t\t\tsetTimeout(function() {\n\t\t\t\tupdateHolderPos();\n\t\t\t}, 500);\n\t\t});\n\n\t\tme.addListener('showmessage', function(type, opt) {\n\t\t\topt = utils.isString(opt) ? {\n\t\t\t\t'content': opt\n\t\t\t} : opt;\n\t\t\tvar message = new Message({\n\t\t\t\t\t'timeout': opt.timeout,\n\t\t\t\t\t'type': opt.type,\n\t\t\t\t\t'content': opt.content,\n\t\t\t\t\t'keepshow': opt.keepshow,\n\t\t\t\t\t'editor': me\n\t\t\t\t}),\n\t\t\t\tmid = opt.id || ('msg_' + (+new Date()).toString(36));\n\t\t\tmessage.render(holder);\n\t\t\t_messageItems[mid] = message;\n\t\t\tmessage.reset(opt);\n\t\t\tupdateHolderPos();\n\t\t\treturn mid;\n\t\t});\n\n\t\tme.addListener('updatemessage', function(type, id, opt) {\n\t\t\topt = utils.isString(opt) ? {\n\t\t\t\t'content': opt\n\t\t\t} : opt;\n\t\t\tvar message = _messageItems[id];\n\t\t\tmessage.render(holder);\n\t\t\tmessage && message.reset(opt);\n\t\t});\n\n\t\tme.addListener('hidemessage', function(type, id) {\n\t\t\tvar message = _messageItems[id];\n\t\t\tmessage && message.hide();\n\t\t});\n\n\t\tfunction updateHolderPos() {\n\t\t\tvar toolbarbox = me.ui.getDom('toolbarbox');\n\t\t\tif (toolbarbox) {\n\t\t\t\tholder.style.top = toolbarbox.offsetHeight + 3 + 'px';\n\t\t\t}\n\t\t\tholder.style.zIndex = Math.max(me.options.zIndex, me.iframe.style.zIndex) + 1;\n\t\t}\n\n\t});\n\n\t// adapter/autosave.js\n\tUE.registerUI('autosave', function(editor) {\n\t\tvar timer = null,\n\t\t\tuid = null;\n\t\teditor.on('afterautosave', function() {\n\t\t\tclearTimeout(timer);\n\n\t\t\ttimer = setTimeout(function() {\n\t\t\t\tif (uid) {\n\t\t\t\t\teditor.trigger('hidemessage', uid);\n\t\t\t\t}\n\t\t\t\tuid = editor.trigger('showmessage', {\n\t\t\t\t\tcontent: editor.getLang('autosave.success'),\n\t\t\t\t\ttimeout: 2000\n\t\t\t\t});\n\n\t\t\t}, 2000)\n\t\t})\n\n\t});\n\n})();\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/ueditor/ueditor.all.js\n// module id = 108\n// module chunks = 6 16","/**\n * Created with JetBrains PhpStorm.\n * User: taoqili\n * Date: 12-6-12\n * Time: 下午5:02\n * To change this template use File | Settings | File Templates.\n */\nUE.I18N['zh-cn'] = {\n    'labelMap': {\n        'anchor': '锚点',\n        'undo': '撤销',\n        'redo': '重做',\n        'bold': '加粗',\n        'indent': '首行缩进',\n        'snapscreen': '截图',\n        'italic': '斜体',\n        'underline': '下划线',\n        'strikethrough': '删除线',\n        'subscript': '下标',\n        'fontborder': '字符边框',\n        'superscript': '上标',\n        'formatmatch': '格式刷',\n        'source': '源代码',\n        'blockquote': '引用',\n        'pasteplain': '纯文本粘贴模式',\n        'selectall': '全选',\n        'print': '打印',\n        'preview': '预览',\n        'horizontal': '分隔线',\n        'removeformat': '清除格式',\n        'time': '时间',\n        'date': '日期',\n        'unlink': '取消链接',\n        'insertrow': '前插入行',\n        'insertcol': '前插入列',\n        'mergeright': '右合并单元格',\n        'mergedown': '下合并单元格',\n        'deleterow': '删除行',\n        'deletecol': '删除列',\n        'splittorows': '拆分成行',\n        'splittocols': '拆分成列',\n        'splittocells': '完全拆分单元格',\n        'deletecaption': '删除表格标题',\n        'inserttitle': '插入标题',\n        'mergecells': '合并多个单元格',\n        'deletetable': '删除表格',\n        'cleardoc': '清空文档',\n        'insertparagraphbeforetable': \"表格前插入行\",\n        'insertcode': '代码语言',\n        'fontfamily': '字体',\n        'fontsize': '字号',\n        'paragraph': '段落格式',\n        'simpleupload': '单图上传',\n        'insertimage': '多图上传',\n        'edittable': '表格属性',\n        'edittd': '单元格属性',\n        'link': '超链接',\n        'emotion': '表情',\n        'spechars': '特殊字符',\n        'searchreplace': '查询替换',\n        'map': 'Baidu地图',\n        'gmap': 'Google地图',\n        'insertvideo': '视频',\n        'help': '帮助',\n        'justifyleft': '居左对齐',\n        'justifyright': '居右对齐',\n        'justifycenter': '居中对齐',\n        'justifyjustify': '两端对齐',\n        'forecolor': '字体颜色',\n        'backcolor': '背景色',\n        'insertorderedlist': '编号',\n        'insertunorderedlist': '项目符号',\n        'fullscreen': '全屏',\n        'directionalityltr': '从左向右输入',\n        'directionalityrtl': '从右向左输入',\n        'rowspacingtop': '段前距',\n        'rowspacingbottom': '段后距',\n        'pagebreak': '分页',\n        'insertframe': '插入Iframe',\n        'imagenone': '默认',\n        'imageleft': '左浮动',\n        'imageright': '右浮动',\n        'attachment': '附件',\n        'imagecenter': '居中',\n        'wordimage': '图片转存',\n        'lineheight': '行间距',\n        'edittip': '编辑提示',\n        'customstyle': '自定义标题',\n        'autotypeset': '自动排版',\n        'webapp': '百度应用',\n        'touppercase': '字母大写',\n        'tolowercase': '字母小写',\n        'background': '背景',\n        'template': '模板',\n        'scrawl': '涂鸦',\n        'music': '音乐',\n        'inserttable': '插入表格',\n        'drafts': '从草稿箱加载',\n        'charts': '图表'\n    },\n    'insertorderedlist': {\n        'num': '1,2,3...',\n        'num1': '1),2),3)...',\n        'num2': '(1),(2),(3)...',\n        'cn': '一,二,三....',\n        'cn1': '一),二),三)....',\n        'cn2': '(一),(二),(三)....',\n        'decimal': '1,2,3...',\n        'lower-alpha': 'a,b,c...',\n        'lower-roman': 'i,ii,iii...',\n        'upper-alpha': 'A,B,C...',\n        'upper-roman': 'I,II,III...'\n    },\n    'insertunorderedlist': {\n        'circle': '○ 大圆圈',\n        'disc': '● 小黑点',\n        'square': '■ 小方块 ',\n        'dash': '— 破折号',\n        'dot': ' 。 小圆圈'\n    },\n    'paragraph': {\n        'p': '段落',\n        'h1': '标题 1',\n        'h2': '标题 2',\n        'h3': '标题 3',\n        'h4': '标题 4',\n        'h5': '标题 5',\n        'h6': '标题 6'\n    },\n    'fontfamily': {\n        'songti': '宋体',\n        'kaiti': '楷体',\n        'heiti': '黑体',\n        'lishu': '隶书',\n        'yahei': '微软雅黑',\n        'andaleMono': 'andale mono',\n        'arial': 'arial',\n        'arialBlack': 'arial black',\n        'comicSansMs': 'comic sans ms',\n        'impact': 'impact',\n        'timesNewRoman': 'times new roman'\n    },\n    'customstyle': {\n        'tc': '标题居中',\n        'tl': '标题居左',\n        'im': '强调',\n        'hi': '明显强调'\n    },\n    'autoupload': {\n        'exceedSizeError': '文件大小超出限制',\n        'exceedTypeError': '文件格式不允许',\n        'jsonEncodeError': '服务器返回格式错误',\n        'loading': \"正在上传...\",\n        'loadError': \"上传错误\",\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'\n    },\n    'simpleupload': {\n        'exceedSizeError': '文件大小超出限制',\n        'exceedTypeError': '文件格式不允许',\n        'jsonEncodeError': '服务器返回格式错误',\n        'loading': \"正在上传...\",\n        'loadError': \"上传错误\",\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！'\n    },\n    'elementPathTip': \"元素路径\",\n    'wordCountTip': \"字数统计\",\n    'wordCountMsg': '当前已输入{#count}个字符, 您还可以输入{#leave}个字符。 ',\n    'wordOverFlowMsg': '<span style=\"color:red;\">字数超出最大允许值，服务器可能拒绝保存！</span>',\n    'ok': \"确认\",\n    'cancel': \"取消\",\n    'closeDialog': \"关闭对话框\",\n    'tableDrag': \"表格拖动必须引入uiUtils.js文件！\",\n    'autofloatMsg': \"工具栏浮动依赖编辑器UI，您首先需要引入UI文件!\",\n    'loadconfigError': '获取后台配置项请求出错，上传功能将不能正常使用！',\n    'loadconfigFormatError': '后台配置项返回格式出错，上传功能将不能正常使用！',\n    'loadconfigHttpError': '请求后台配置项http错误，上传功能将不能正常使用！',\n    'snapScreen_plugin': {\n        'browserMsg': \"仅支持IE浏览器！\",\n        'callBackErrorMsg': \"服务器返回数据有误，请检查配置项之后重试。\",\n        'uploadErrorMsg': \"截图上传失败，请检查服务器端环境! \"\n    },\n    'insertcode': {\n        'as3': 'ActionScript 3',\n        'bash': 'Bash/Shell',\n        'cpp': 'C/C++',\n        'css': 'CSS',\n        'cf': 'ColdFusion',\n        'c#': 'C#',\n        'delphi': 'Delphi',\n        'diff': 'Diff',\n        'erlang': 'Erlang',\n        'groovy': 'Groovy',\n        'html': 'HTML',\n        'java': 'Java',\n        'jfx': 'JavaFX',\n        'js': 'JavaScript',\n        'pl': 'Perl',\n        'php': 'PHP',\n        'plain': 'Plain Text',\n        'ps': 'PowerShell',\n        'python': 'Python',\n        'ruby': 'Ruby',\n        'scala': 'Scala',\n        'sql': 'SQL',\n        'vb': 'Visual Basic',\n        'xml': 'XML'\n    },\n    'confirmClear': \"确定清空当前文档么？\",\n    'contextMenu': {\n        'delete': \"删除\",\n        'selectall': \"全选\",\n        'deletecode': \"删除代码\",\n        'cleardoc': \"清空文档\",\n        'confirmclear': \"确定清空当前文档么？\",\n        'unlink': \"删除超链接\",\n        'paragraph': \"段落格式\",\n        'edittable': \"表格属性\",\n        'aligntd': \"单元格对齐方式\",\n        'aligntable': '表格对齐方式',\n        'tableleft': '左浮动',\n        'tablecenter': '居中显示',\n        'tableright': '右浮动',\n        'edittd': \"单元格属性\",\n        'setbordervisible': '设置表格边线可见',\n        'justifyleft': '左对齐',\n        'justifyright': '右对齐',\n        'justifycenter': '居中对齐',\n        'justifyjustify': '两端对齐',\n        'table': \"表格\",\n        'inserttable': '插入表格',\n        'deletetable': \"删除表格\",\n        'insertparagraphbefore': \"前插入段落\",\n        'insertparagraphafter': '后插入段落',\n        'deleterow': \"删除当前行\",\n        'deletecol': \"删除当前列\",\n        'insertrow': \"前插入行\",\n        'insertcol': \"左插入列\",\n        'insertrownext': '后插入行',\n        'insertcolnext': '右插入列',\n        'insertcaption': '插入表格名称',\n        'deletecaption': '删除表格名称',\n        'inserttitle': '插入表格标题行',\n        'deletetitle': '删除表格标题行',\n        'inserttitlecol': '插入表格标题列',\n        'deletetitlecol': '删除表格标题列',\n        'averageDiseRow': '平均分布各行',\n        'averageDisCol': '平均分布各列',\n        'mergeright': \"向右合并\",\n        'mergeleft': \"向左合并\",\n        'mergedown': \"向下合并\",\n        'mergecells': \"合并单元格\",\n        'splittocells': \"完全拆分单元格\",\n        'splittocols': \"拆分成列\",\n        'splittorows': \"拆分成行\",\n        'tablesort': '表格排序',\n        'enablesort': '设置表格可排序',\n        'disablesort': '取消表格可排序',\n        'reversecurrent': '逆序当前',\n        'orderbyasc': '按ASCII字符升序',\n        'reversebyasc': '按ASCII字符降序',\n        'orderbynum': '按数值大小升序',\n        'reversebynum': '按数值大小降序',\n        'borderbk': '边框底纹',\n        'setcolor': '表格隔行变色',\n        'unsetcolor': '取消表格隔行变色',\n        'setbackground': '选区背景隔行',\n        'unsetbackground': '取消选区背景',\n        'redandblue': '红蓝相间',\n        'threecolorgradient': '三色渐变',\n        'copy': \"复制(Ctrl + c)\",\n        'copymsg': \"浏览器不支持,请使用 'Ctrl + c'\",\n        'paste': \"粘贴(Ctrl + v)\",\n        'pastemsg': \"浏览器不支持,请使用 'Ctrl + v'\"\n    },\n    'copymsg': \"浏览器不支持,请使用 'Ctrl + c'\",\n    'pastemsg': \"浏览器不支持,请使用 'Ctrl + v'\",\n    'anthorMsg': \"链接\",\n    'clearColor': '清空颜色',\n    'standardColor': '标准颜色',\n    'themeColor': '主题颜色',\n    'property': '属性',\n    'default': '默认',\n    'modify': '修改',\n    'justifyleft': '左对齐',\n    'justifyright': '右对齐',\n    'justifycenter': '居中',\n    'justify': '默认',\n    'clear': '清除',\n    'anchorMsg': '锚点',\n    'delete': '删除',\n    'clickToUpload': \"点击上传\",\n    'unset': '尚未设置语言文件',\n    't_row': '行',\n    't_col': '列',\n    'more': '更多',\n    'pasteOpt': '粘贴选项',\n    'pasteSourceFormat': \"保留源格式\",\n    'tagFormat': '只保留标签',\n    'pasteTextFormat': '只保留文本',\n    'autoTypeSet': {\n        'mergeLine': \"合并空行\",\n        'delLine': \"清除空行\",\n        'removeFormat': \"清除格式\",\n        'indent': \"首行缩进\",\n        'alignment': \"对齐方式\",\n        'imageFloat': \"图片浮动\",\n        'removeFontsize': \"清除字号\",\n        'removeFontFamily': \"清除字体\",\n        'removeHtml': \"清除冗余HTML代码\",\n        'pasteFilter': \"粘贴过滤\",\n        'run': \"执行\",\n        'symbol': '符号转换',\n        'bdc2sb': '全角转半角',\n        'tobdc': '半角转全角'\n    },\n\n    'background': {\n        'static': {\n            'lang_background_normal': '背景设置',\n            'lang_background_local': '在线图片',\n            'lang_background_set': '选项',\n            'lang_background_none': '无背景色',\n            'lang_background_colored': '有背景色',\n            'lang_background_color': '颜色设置',\n            'lang_background_netimg': '网络图片',\n            'lang_background_align': '对齐方式',\n            'lang_background_position': '精确定位',\n            'repeatType': {\n                'options': [\"居中\", \"横向重复\", \"纵向重复\", \"平铺\", \"自定义\"]\n            }\n\n        },\n        'noUploadImage': \"当前未上传过任何图片！\",\n        'toggleSelect': \"单击可切换选中状态\\n原图尺寸: \"\n    },\n    //===============dialog i18N=======================\n    'insertimage': {\n        'static': {\n            'lang_tab_remote': \"插入图片\", //节点\n            'lang_tab_upload': \"本地上传\",\n            'lang_tab_online': \"在线管理\",\n            'lang_tab_search': \"图片搜索\",\n            'lang_input_url': \"地 址：\",\n            'lang_input_size': \"大 小：\",\n            'lang_input_width': \"宽度\",\n            'lang_input_height': \"高度\",\n            'lang_input_border': \"边 框：\",\n            'lang_input_vhspace': \"边 距：\",\n            'lang_input_title': \"描 述：\",\n            'lang_input_align': '图片浮动方式：',\n            'lang_imgLoading': \"　图片加载中……\",\n            'lang_start_upload': \"开始上传\",\n            'lock': {\n                'title': \"锁定宽高比例\"\n            }, //属性\n            'searchType': {\n                'title': \"图片类型\",\n                'options': [\"新闻\", \"壁纸\", \"表情\", \"头像\"]\n            }, //select的option\n            'searchTxt': {\n                'value': \"请输入搜索关键词\"\n            },\n            'searchBtn': {\n                'value': \"百度一下\"\n            },\n            'searchReset': {\n                'value': \"清空搜索\"\n            },\n            'noneAlign': {\n                'title': '无浮动'\n            },\n            'leftAlign': {\n                'title': '左浮动'\n            },\n            'rightAlign': {\n                'title': '右浮动'\n            },\n            'centerAlign': {\n                'title': '居中独占一行'\n            }\n        },\n        'uploadSelectFile': '点击选择图片',\n        'uploadAddFile': '继续添加',\n        'uploadStart': '开始上传',\n        'uploadPause': '暂停上传',\n        'uploadContinue': '继续上传',\n        'uploadRetry': '重试上传',\n        'uploadDelete': '删除',\n        'uploadTurnLeft': '向左旋转',\n        'uploadTurnRight': '向右旋转',\n        'uploadPreview': '预览中',\n        'uploadNoPreview': '不能预览',\n        'updateStatusReady': '选中_张图片，共_KB。',\n        'updateStatusConfirm': '已成功上传_张照片，_张照片上传失败',\n        'updateStatusFinish': '共_张（_KB），_张上传成功',\n        'updateStatusError': '，_张上传失败。',\n        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n        'errorExceedSize': '文件大小超出',\n        'errorFileType': '文件格式不允许',\n        'errorInterrupt': '文件传输中断',\n        'errorUploadRetry': '上传失败，请重试',\n        'errorHttp': 'http请求错误',\n        'errorServerUpload': '服务器返回出错',\n        'remoteLockError': \"宽高不正确,不能所定比例\",\n        'numError': \"请输入正确的长度或者宽度值！例如：123，400\",\n        'imageUrlError': \"不允许的图片格式或者图片域！\",\n        'imageLoadError': \"图片加载失败！请检查链接地址或网络状态！\",\n        'searchRemind': \"请输入搜索关键词\",\n        'searchLoading': \"图片加载中，请稍后……\",\n        'searchRetry': \" :( ，抱歉，没有找到图片！请重试一次！\"\n    },\n    'attachment': {\n        'static': {\n            'lang_tab_upload': '上传附件',\n            'lang_tab_online': '在线附件',\n            'lang_start_upload': \"开始上传\",\n            'lang_drop_remind': \"可以将文件拖到这里，单次最多可选100个文件\"\n        },\n        'uploadSelectFile': '点击选择文件',\n        'uploadAddFile': '继续添加',\n        'uploadStart': '开始上传',\n        'uploadPause': '暂停上传',\n        'uploadContinue': '继续上传',\n        'uploadRetry': '重试上传',\n        'uploadDelete': '删除',\n        'uploadTurnLeft': '向左旋转',\n        'uploadTurnRight': '向右旋转',\n        'uploadPreview': '预览中',\n        'updateStatusReady': '选中_个文件，共_KB。',\n        'updateStatusConfirm': '已成功上传_个文件，_个文件上传失败',\n        'updateStatusFinish': '共_个（_KB），_个上传成功',\n        'updateStatusError': '，_张上传失败。',\n        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n        'errorExceedSize': '文件大小超出',\n        'errorFileType': '文件格式不允许',\n        'errorInterrupt': '文件传输中断',\n        'errorUploadRetry': '上传失败，请重试',\n        'errorHttp': 'http请求错误',\n        'errorServerUpload': '服务器返回出错'\n    },\n    'insertvideo': {\n        'static': {\n            'lang_tab_insertV': \"插入视频\",\n            'lang_tab_searchV': \"搜索视频\",\n            'lang_tab_uploadV': \"上传视频\",\n            'lang_video_url': \"视频网址\",\n            'lang_video_size': \"视频尺寸\",\n            'lang_videoW': \"宽度\",\n            'lang_videoH': \"高度\",\n            'lang_alignment': \"对齐方式\",\n            'videoSearchTxt': {\n                'value': \"请输入搜索关键字！\"\n            },\n            'videoType': {\n                'options': [\"全部\", \"热门\", \"娱乐\", \"搞笑\", \"体育\", \"科技\", \"综艺\"]\n            },\n            'videoSearchBtn': {\n                'value': \"百度一下\"\n            },\n            'videoSearchReset': {\n                'value': \"清空结果\"\n            },\n\n            'lang_input_fileStatus': ' 当前未上传文件',\n            'startUpload': {\n                'style': \"background:url(upload.png) no-repeat;\"\n            },\n\n            'lang_upload_size': \"视频尺寸\",\n            'lang_upload_width': \"宽度\",\n            'lang_upload_height': \"高度\",\n            'lang_upload_alignment': \"对齐方式\",\n            'lang_format_advice': \"建议使用mp4格式.\"\n\n        },\n        'numError': \"请输入正确的数值，如123,400\",\n        'floatLeft': \"左浮动\",\n        'floatRight': \"右浮动\",\n        '\"default\"': \"默认\",\n        'block': \"独占一行\",\n        'urlError': \"输入的视频地址有误，请检查后再试！\",\n        'loading': \" &nbsp;视频加载中，请等待……\",\n        'clickToSelect': \"点击选中\",\n        'goToSource': '访问源视频',\n        'noVideo': \" &nbsp; &nbsp;抱歉，找不到对应的视频，请重试！\",\n\n        'browseFiles': '浏览文件',\n        'uploadSuccess': '上传成功!',\n        'delSuccessFile': '从成功队列中移除',\n        'delFailSaveFile': '移除保存失败文件',\n        'statusPrompt': ' 个文件已上传！ ',\n        'flashVersionError': '当前Flash版本过低，请更新FlashPlayer后重试！',\n        'flashLoadingError': 'Flash加载失败!请检查路径或网络状态',\n        'fileUploadReady': '等待上传……',\n        'delUploadQueue': '从上传队列中移除',\n        'limitPrompt1': '单次不能选择超过',\n        'limitPrompt2': '个文件！请重新选择！',\n        'delFailFile': '移除失败文件',\n        'fileSizeLimit': '文件大小超出限制！',\n        'emptyFile': '空文件无法上传！',\n        'fileTypeError': '文件类型不允许！',\n        'unknownError': '未知错误！',\n        'fileUploading': '上传中，请等待……',\n        'cancelUpload': '取消上传',\n        'netError': '网络错误',\n        'failUpload': '上传失败!',\n        'serverIOError': '服务器IO错误！',\n        'noAuthority': '无权限！',\n        'fileNumLimit': '上传个数限制',\n        'failCheck': '验证失败，本次上传被跳过！',\n        'fileCanceling': '取消中，请等待……',\n        'stopUploading': '上传已停止……',\n\n        'uploadSelectFile': '点击选择文件',\n        'uploadAddFile': '继续添加',\n        'uploadStart': '开始上传',\n        'uploadPause': '暂停上传',\n        'uploadContinue': '继续上传',\n        'uploadRetry': '重试上传',\n        'uploadDelete': '删除',\n        'uploadTurnLeft': '向左旋转',\n        'uploadTurnRight': '向右旋转',\n        'uploadPreview': '预览中',\n        'updateStatusReady': '选中_个文件，共_KB。',\n        'updateStatusConfirm': '成功上传_个，_个失败',\n        'updateStatusFinish': '共_个(_KB)，_个成功上传',\n        'updateStatusError': '，_张上传失败。',\n        'errorNotSupport': 'WebUploader 不支持您的浏览器！如果你使用的是IE浏览器，请尝试升级 flash 播放器。',\n        'errorLoadConfig': '后端配置项没有正常加载，上传插件不能正常使用！',\n        'errorExceedSize': '文件大小超出',\n        'errorFileType': '文件格式不允许',\n        'errorInterrupt': '文件传输中断',\n        'errorUploadRetry': '上传失败，请重试',\n        'errorHttp': 'http请求错误',\n        'errorServerUpload': '服务器返回出错'\n    },\n    'webapp': {\n        'tip1': \"本功能由百度APP提供，如看到此页面，请各位站长首先申请百度APPKey!\",\n        'tip2': \"申请完成之后请至ueditor.config.js中配置获得的appkey! \",\n        'applyFor': \"点此申请\",\n        'anthorApi': \"百度API\"\n    },\n    'template': {\n        'static': {\n            'lang_template_bkcolor': '背景颜色',\n            'lang_template_clear': '保留原有内容',\n            'lang_template_select': '选择模板'\n        },\n        'blank': \"空白文档\",\n        'blog': \"博客文章\",\n        'resume': \"个人简历\",\n        'richText': \"图文混排\",\n        'sciPapers': \"科技论文\"\n\n    },\n    'scrawl': {\n        'static': {\n            'lang_input_previousStep': \"上一步\",\n            'lang_input_nextsStep': \"下一步\",\n            'lang_input_clear': '清空',\n            'lang_input_addPic': '添加背景',\n            'lang_input_ScalePic': '缩放背景',\n            'lang_input_removePic': '删除背景',\n            'J_imgTxt': {\n                title: '添加背景图片'\n            }\n        },\n        'noScarwl': \"尚未作画，白纸一张~\",\n        'scrawlUpLoading': \"涂鸦上传中,别急哦~\",\n        'continueBtn': \"继续\",\n        'imageError': \"糟糕，图片读取失败了！\",\n        'backgroundUploading': '背景图片上传中,别急哦~'\n    },\n    'music': {\n        'static': {\n            'lang_input_tips': \"输入歌手/歌曲/专辑，搜索您感兴趣的音乐！\",\n            'J_searchBtn': {\n                value: '搜索歌曲'\n            }\n        },\n        'emptyTxt': '未搜索到相关音乐结果，请换一个关键词试试。',\n        'chapter': '歌曲',\n        'singer': '歌手',\n        'special': '专辑',\n        'listenTest': '试听'\n    },\n    'anchor': {\n        'static': {\n            'lang_input_anchorName': '锚点名字：'\n        }\n    },\n    'charts': {\n        'static': {\n            'lang_data_source': '数据源：',\n            'lang_chart_format': '图表格式：',\n            'lang_data_align': '数据对齐方式',\n            'lang_chart_align_same': '数据源与图表X轴Y轴一致',\n            'lang_chart_align_reverse': '数据源与图表X轴Y轴相反',\n            'lang_chart_title': '图表标题',\n            'lang_chart_main_title': '主标题：',\n            'lang_chart_sub_title': '子标题：',\n            'lang_chart_x_title': 'X轴标题：',\n            'lang_chart_y_title': 'Y轴标题：',\n            'lang_chart_tip': '提示文字',\n            'lang_cahrt_tip_prefix': '提示文字前缀：',\n            'lang_cahrt_tip_description': '仅饼图有效， 当鼠标移动到饼图中相应的块上时，提示框内的文字的前缀',\n            'lang_chart_data_unit': '数据单位',\n            'lang_chart_data_unit_title': '单位：',\n            'lang_chart_data_unit_description': '显示在每个数据点上的数据的单位， 比如： 温度的单位 ℃',\n            'lang_chart_type': '图表类型：',\n            'lang_prev_btn': '上一个',\n            'lang_next_btn': '下一个'\n        }\n    },\n    'emotion': {\n        'static': {\n            'lang_input_choice': '精选',\n            'lang_input_Tuzki': '兔斯基',\n            'lang_input_BOBO': 'BOBO',\n            'lang_input_lvdouwa': '绿豆蛙',\n            'lang_input_babyCat': 'baby猫',\n            'lang_input_bubble': '泡泡',\n            'lang_input_youa': '有啊'\n        }\n    },\n    'gmap': {\n        'static': {\n            'lang_input_address': '地址',\n            'lang_input_search': '搜索',\n            'address': {\n                value: \"北京\"\n            }\n        },\n        searchError: '无法定位到该地址!'\n    },\n    'help': {\n        'static': {\n            'lang_input_about': '关于UEditor',\n            'lang_input_shortcuts': '快捷键',\n            'lang_input_introduction': 'UEditor是由百度web前端研发部开发的所见即所得富文本web编辑器，具有轻量，可定制，注重用户体验等特点。开源基于BSD协议，允许自由使用和修改代码。',\n            'lang_Txt_shortcuts': '快捷键',\n            'lang_Txt_func': '功能',\n            'lang_Txt_bold': '给选中字设置为加粗',\n            'lang_Txt_copy': '复制选中内容',\n            'lang_Txt_cut': '剪切选中内容',\n            'lang_Txt_Paste': '粘贴',\n            'lang_Txt_undo': '重新执行上次操作',\n            'lang_Txt_redo': '撤销上一次操作',\n            'lang_Txt_italic': '给选中字设置为斜体',\n            'lang_Txt_underline': '给选中字加下划线',\n            'lang_Txt_selectAll': '全部选中',\n            'lang_Txt_visualEnter': '软回车',\n            'lang_Txt_fullscreen': '全屏'\n        }\n    },\n    'insertframe': {\n        'static': {\n            'lang_input_address': '地址：',\n            'lang_input_width': '宽度：',\n            'lang_input_height': '高度：',\n            'lang_input_isScroll': '允许滚动条：',\n            'lang_input_frameborder': '显示框架边框：',\n            'lang_input_alignMode': '对齐方式：',\n            'align': {\n                title: \"对齐方式\",\n                options: [\"默认\", \"左对齐\", \"右对齐\", \"居中\"]\n            }\n        },\n        'enterAddress': '请输入地址!'\n    },\n    'link': {\n        'static': {\n            'lang_input_text': '文本内容：',\n            'lang_input_url': '链接地址：',\n            'lang_input_title': '标题：',\n            'lang_input_target': '是否在新窗口打开：'\n        },\n        'validLink': '只支持选中一个链接时生效',\n        'httpPrompt': '您输入的超链接中不包含http等协议名称，默认将为您添加http://前缀'\n    },\n    'map': {\n        'static': {\n            lang_city: \"城市\",\n            lang_address: \"地址\",\n            city: {\n                value: \"北京\"\n            },\n            lang_search: \"搜索\",\n            lang_dynamicmap: \"插入动态地图\"\n        },\n        cityMsg: \"请选择城市\",\n        errorMsg: \"抱歉，找不到该位置！\"\n    },\n    'searchreplace': {\n        'static': {\n            lang_tab_search: \"查找\",\n            lang_tab_replace: \"替换\",\n            lang_search1: \"查找\",\n            lang_search2: \"查找\",\n            lang_replace: \"替换\",\n            lang_searchReg: '支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”',\n            lang_searchReg1: '支持正则表达式，添加前后斜杠标示为正则表达式，例如“/表达式/”',\n            lang_case_sensitive1: \"区分大小写\",\n            lang_case_sensitive2: \"区分大小写\",\n            nextFindBtn: {\n                value: \"下一个\"\n            },\n            preFindBtn: {\n                value: \"上一个\"\n            },\n            nextReplaceBtn: {\n                value: \"下一个\"\n            },\n            preReplaceBtn: {\n                value: \"上一个\"\n            },\n            repalceBtn: {\n                value: \"替换\"\n            },\n            repalceAllBtn: {\n                value: \"全部替换\"\n            }\n        },\n        getEnd: \"已经搜索到文章末尾！\",\n        getStart: \"已经搜索到文章头部\",\n        countMsg: \"总共替换了{#count}处！\"\n    },\n    'snapscreen': {\n        'static': {\n            lang_showMsg: \"截图功能需要首先安装UEditor截图插件！ \",\n            lang_download: \"点此下载\",\n            lang_step1: \"第一步，下载UEditor截图插件并运行安装。\",\n            lang_step2: \"第二步，插件安装完成后即可使用，如不生效，请重启浏览器后再试！\"\n        }\n    },\n    'spechars': {\n        'static': {},\n        tsfh: \"特殊字符\",\n        lmsz: \"罗马字符\",\n        szfh: \"数学字符\",\n        rwfh: \"日文字符\",\n        xlzm: \"希腊字母\",\n        ewzm: \"俄文字符\",\n        pyzm: \"拼音字母\",\n        yyyb: \"英语音标\",\n        zyzf: \"其他\"\n    },\n    'edittable': {\n        'static': {\n            'lang_tableStyle': '表格样式',\n            'lang_insertCaption': '添加表格名称行',\n            'lang_insertTitle': '添加表格标题行',\n            'lang_insertTitleCol': '添加表格标题列',\n            'lang_orderbycontent': \"使表格内容可排序\",\n            'lang_tableSize': '自动调整表格尺寸',\n            'lang_autoSizeContent': '按表格文字自适应',\n            'lang_autoSizePage': '按页面宽度自适应',\n            'lang_example': '示例',\n            'lang_borderStyle': '表格边框',\n            'lang_color': '颜色:'\n        },\n        captionName: '表格名称',\n        titleName: '标题',\n        cellsName: '内容',\n        errorMsg: '有合并单元格，不可排序'\n    },\n    'edittip': {\n        'static': {\n            lang_delRow: '删除整行',\n            lang_delCol: '删除整列'\n        }\n    },\n    'edittd': {\n        'static': {\n            lang_tdBkColor: '背景颜色:'\n        }\n    },\n    'formula': {\n        'static': {}\n    },\n    'wordimage': {\n        'static': {\n            lang_resave: \"转存步骤\",\n            uploadBtn: {\n                src: \"upload.png\",\n                alt: \"上传\"\n            },\n            clipboard: {\n                style: \"background: url(copy.png) -153px -1px no-repeat;\"\n            },\n            lang_step: \"1、点击顶部复制按钮，将地址复制到剪贴板；2、点击添加照片按钮，在弹出的对话框中使用Ctrl+V粘贴地址；3、点击打开后选择图片上传流程。\"\n        },\n        'fileType': \"图片\",\n        'flashError': \"FLASH初始化失败，请检查FLASH插件是否正确安装！\",\n        'netError': \"网络连接错误，请重试！\",\n        'copySuccess': \"图片地址已经复制！\",\n        'flashI18n': {} //留空默认中文\n    },\n    'autosave': {\n        'saving': '保存中...',\n        'success': '本地保存成功'\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ueditor/lang/zh-cn/zh-cn.js","require('./fonts');\nrequire('./emoji');\nrequire('./picture');\nrequire('./goods');\nrequire('./link');\n//屏蔽快捷键\n//require('./metakey');\n//删除图片\nrequire('./beforeInput');\n//过滤粘贴\nrequire('./grepPaste');\n//过滤拖拽\nrequire('./grepDrop');\n//修复选中图片\nrequire('./selectImg');\n//插入后重新计算高度\nrequire(\"./autoHeight\");\n//粘贴上传\nrequire(\"./autoUpload\");\n//\nrequire(\"./linkLayer\");\n//离开页面提示\n//require(\"./beforeUnload\");\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/index.js","require('./title');\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/fonts/index.js","var domUtils = UE.dom.domUtils;\n\nvar utils = UE.utils;\n\nvar getContent = require('editor/utils/getContent');\n\nvar changeTagName = function(editor, tagName, key, value) {\n    if (tagName == value) {\n        editor.execCommand(key, 'p');\n    } else {\n        editor.execCommand(key, value);\n    }\n}\n\nUE.registerUI('h2 h1', function(editor, uiName) {\n    //console.log(uiName)\n    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    /*  editor.registerCommand(uiName, {\n         execCommand: function() {\n             alert('execCommand:' + uiName)\n         }\n     }); */\n    //创建一个button\n    var aliasName;\n    var args = 0; //参数个数\n    var key = \"\";\n    var value = \"\";\n\n    switch (uiName) {\n        case 'h1':\n            aliasName = \"h1\";\n            args = 1;\n            key = \"Paragraph\";\n            value = \"h1\"\n            break;\n        case 'h2':\n            aliasName = \"h2\";\n            args = 1;\n            key = 'Paragraph';\n            value = 'h2';\n            break;\n    }\n\n    var btn = new UE.ui.Button({\n        //按钮的名字\n        name: aliasName,\n        //提示\n        title: aliasName,\n        //添加额外样式,指定icon图标,这里默认使用一个重复的icon\n        //cssRules: 'background-position: -500px 0;',\n        //iconEle: '<em class=\"insert-imoj iconn-27\">' + aliasName + '</em>',\n        //点击时执行的命令\n        onclick: function(e) {\n            var range = editor.selection.getRange();\n            if (getContent(range).indexOf('gmp-ebox') != -1) {\n                return false;\n            }\n            //这里可以不用执行命令,做你自己的操作也可\n            var startDom = range.startContainer;\n            var tag = domUtils.findParentByTagName(startDom, ['h1', 'h2', 'h3', 'p'], true);\n            if (!tag) return false;\n            var tagName = tag.tagName.toLowerCase();\n\n            switch (tagName) {\n                case 'p':\n                    editor.execCommand(key, value)\n                    break;\n                case 'h1':\n                    changeTagName(editor, tagName, key, value);\n                    break;\n                case 'h2':\n                    changeTagName(editor, tagName, key, value);\n                    break;\n                case 'h3':\n                    changeTagName(editor, tagName, key, value);\n                    break;\n                default:\n                    break;\n\n            }\n            return;\n\n        }\n    });\n    //当点到编辑内容上时，按钮要做的状态反射\n    editor.addListener('selectionchange', function(e) {\n        var range = editor.selection.getRange();\n        var startDom = range.startContainer;\n        var tag = domUtils.findParentByTagName(startDom, ['h1', 'h2', 'p'], true);\n        if (!tag) return false;\n        var tagName = tag.tagName.toLowerCase();\n\n        if (tagName == uiName) {\n            btn.setChecked(1);\n        } else {\n            btn.setChecked(0);\n        }\n\n        /*var state = editor.queryCommandState(uiName);\n        console.log(state)\n        if (state == -1) {\n            btn.setDisabled(true);\n            btn.setChecked(false);\n        } else {\n            btn.setDisabled(false);\n            btn.setChecked(state);\n        }\n        btn.setChecked(1);*/\n    });\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/fonts/title.js","var getContent = function(range) {\n\n    range.select();\n\n    var fragment = range.cloneContents();\n\n    var node = document.createElement(\"div\");\n\n    if (fragment) {\n        node.appendChild(fragment);\n    } else {\n        return '';\n    }\n\n    return node.innerHTML;\n}\n\nmodule.exports = getContent;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/utils/getContent.js","/**\n * 插入表情\n * @author Fu Xiaochun\n */\n\nUE.registerUI('insertemoji', function(editor, uiName) {\n\n    var face = editor.face;\n\n    // 当点击编辑区获得焦点后，表情弹层隐藏。\n    /*editor.addListener('focus', function(editor) {\n    \tface.hide();\n    });*/\n\n    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    editor.registerCommand(uiName, {\n        execCommand: function() {\n            editor.focus();\n            var $btn = $(btn.target);\n            var offset = $btn.offset();\n            var x = offset.left;\n            var y = offset.top / 1 + 30;\n\n            if (!face.isShow) {\n                face.show(x, y);\n            } else {\n                face.hide();\n            }\n        }\n    });\n\n    // 激活光标\n    editor.addListener('afterinserthtml', function() {\n        editor.focus();\n    });\n\n    //创建一个button\n    var btn = new UE.ui.Button({\n        name: 'insertemoji',\n        title: '插入表情',\n        label: '',\n        iconEle: '<em class=\"insert-imoj iconn-27\"></em>',\n        cssRules: '',\n        onclick: function() {\n            editor.execCommand(uiName);\n        }\n    });\n\n    //当点到编辑内容上时，按钮要做的状态反射\n    editor.addListener('selectionchange', function() {\n        var state = editor.queryCommandState(uiName);\n        if (state == -1) {\n            btn.setDisabled(true);\n            btn.setChecked(false);\n        } else {\n            btn.setDisabled(false);\n            btn.setChecked(state);\n        }\n    });\n\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/emoji/index.js","/**\n * 插入图片\n * @author Fu Xiaochun\n */\nvar alert = require('module/popup/alert');\nvar upload = require('module/popup/upload/uploader');\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar pictureTpl = require('./pictures.tpl');\nvar detectQr = require('module/popup/uploadfileQR');\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\nrequire('../transformImg');\n\nvar imgMaxLen = config.imgLimitNUm;\nvar maxLen = imgMaxLen;\nvar imgTimes = 0;\nvar $content = null;\n\nvar $picPopBox = $('[data-node=picPopBox]');\nvar $upLocal = $('[data-node=upLocal]');\nvar $cover = $('[data-node=cover]');\nUE.registerUI('insertpicture', function(editor, uiName) {\n    editor.newPop = \"\";\n    var obj = {\n            time: 2000,\n            $showBox: $('[data-node=picPopBox]'),\n            customCb: \"\",\n            $insertDom: \"\",\n            editor: editor\n        }\n        //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    editor.registerCommand(uiName, {\n        execCommand: function() {\n\n            $content = $(editor.getContent());\n\n            var insertedImgLen = $content.find('img').not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n            maxLen = imgMaxLen - insertedImgLen;\n            if (maxLen <= 0) {\n                alert('您最多能添加' + imgMaxLen + '张图片哦！');\n                return;\n            }\n\n            if (!window.topicQrId) {\n\n                window.topicQrId = [];\n            }\n\n            if (!window.topicQrId['single']) {\n\n                editor.focus();\n\n                window.topicQrId['single'] = {};\n                $.extend(obj, {\n                    $parent: editor,\n                    $target: $(btn.target)\n                })\n                editor.newPop = new detectQr(obj)\n\n                editor.newPop.init();\n\n            } else {\n                var newPop = editor.newPop;\n                if (!newPop.useNewCode) {\n                    newPop.getCode();\n                } else {\n                    if (!newPop.checkShow()) {\n\n                        newPop.show();\n                        newPop.sendNum();\n                    } else {\n                        newPop.hide();\n                    }\n                }\n            }\n\n            $('div[tabindex]').remove();\n            if ($picPopBox.css('display') == 'block') {\n                setTimeout(function() {\n                    upload(maxLen, 20);\n                }, 200)\n\n            } else {}\n\n        }\n    });\n\n    // 激活光标\n    editor.addListener('afterinserthtml', function() {\n        editor.focus();\n    });\n\n    // 接收图片\n    Pubsub(channel.setPubliser.changeImage).sub(function(data) {\n        var $lastNode = null;\n        var pictureHTML = '';\n\n        data.times = ++imgTimes;\n        var images = data.images;\n        var len = images.length;\n        for (var i = 0; i < len; i++) {\n            var temp = imgReplace.imgReplace(images[i]);\n            var proto = imgReplace.imgProto(images[i]);\n            pictureHTML += pictureTpl({\n                times: data.times,\n                src: temp,\n                _src: temp,\n                imgProto: proto\n            })\n        }\n        //pictureHTML = pictureTpl(data)\n\n        /*.replace(/p> <img/gi,'p><img')\n        .replace(/(<img .*?)(> <)(\\/p>)/,function(i,j,k,l){\n        \treturn j + \"><\" + l;\n        });*/\n        editor.focus();\n\n        editor.execCommand('inserthtml', pictureHTML);\n\n        setTimeout(function() {\n            var $editor = $(editor.body);\n\n            $lastNode = $editor.find('[data-t=t-' + imgTimes + ']').last();\n            var lastOffsetTop = $lastNode.offset().top;\n            var lastPosition = lastOffsetTop + $lastNode.height();\n            if (lastPosition > $(window).height()) {\n                $('html,body').scrollTop(lastPosition);\n            }\n\n            imgReplace.changeSrc($editor);\n        }, 300);\n\n    });\n\n    //创建一个button\n    var btn = new UE.ui.Button({\n        name: 'insertpicture',\n        title: '插入图片',\n        label: '',\n        iconEle: '<em class=\"insert-pic icon\">&#xe931;</em>',\n        cssRules: '',\n        onclick: function(e) {\n            editor.execCommand(uiName);\n        }\n    });\n\n    //当点到编辑内容上时，按钮要做的状态反射\n    editor.addListener('selectionchange', function() {\n        var state = editor.queryCommandState(uiName);\n        if (state == -1) {\n            btn.setDisabled(true);\n            btn.setChecked(false);\n        } else {\n            btn.setDisabled(false);\n            btn.setChecked(state);\n        }\n    });\n\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/picture/index.js","var uploadPop = require('module/popup/upload/dialog'),\n    Pubsub = require('io/pubsub'),\n    pubName = require('io/channel');\nvar upload = require('module/upload');\nvar alert = require('module/popup/alert');\nvar imgReplace = require('utils/imgReplace');\n\nvar init = function(maxLen, total) {\n    var dialogUploader,\n        $webUpLoader,\n        maxlength = maxLen;\n    if (maxlength > 0) {\n\n        dialogUploader = uploadPop.create({\n            maxlength: maxlength,\n            total: total\n        }, {\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                var $imgList = $('[data-node=\"uploadList\"] img'),\n                    images = [];\n                for (var i = 0, len = $imgList.length; i < len; i++) {\n                    images.push($imgList.eq(i).attr('src'));\n                }\n                //maxLen -= images.length;\n                Pubsub(pubName.setPubliser.changeImage).pub({\n                    images: images\n                });\n                $('[data-node=picPopBox]').hide();\n            },\n            cancel: function() {\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                $('[data-node=picPopBox]').hide();\n            }\n        });\n\n        $webUpLoader = upload.init({\n            maxlength: maxlength,\n            callbacks: {\n                onFileQueued: function(file, numList, number) {\n                    var $uploadBox = $('[data-node=\"uploadBox\"]');\n                    var picker = '[data-defaultaddfile=\"picker\"]';\n                    $('[data-node=picPopBox]').addClass('webuploader-element-invisible');\n                    dialogUploader.show();\n                    $uploadBox.find(picker).children().eq(0).html('<em class=\"icon-add\"></em>');\n                    var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n                    $uploadBox.find(picker).before(html);\n                    $uploadBox.find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n                    if (numList[file.source.ruid] === ~~number) {\n                        $uploadBox.find(picker).hide();\n                    }\n                    $uploadBox.find(picker).children().eq(1).css({\n                        'width': '78px',\n                        'height': '78px'\n                    })\n                },\n\n                onUploadSuccess: function(file, response) {\n                    if (response.code === 200 && response.success) {\n                        $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                        // 激活提交按钮\n                        $('[i-id=ok]').removeClass('btn-default');\n                    } else {\n                        $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                    }\n                }\n            }\n        });\n    } else {\n        alert('您最多能添加' + maxLen + '张图片哦！');\n    }\n    return $webUpLoader;\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/uploader.js","/***\n * upload.js\n * @author zhaodonghong\n * @params                      object      上传图片参数\n *     maxlength               number      可上传图片最大张数\n *     selector                object      jq选择器\n *         parents             string      每个图片上传外层jq选择器\n *         delSelector         string      删除按钮jq选择器\n *         selector            string      实例化上传插件的pick.id的值\n *     defaultApi              object      实例化webuploader参数\n *     callbacks               object      实例化webuploader方法回调集合\n *         onBeforeFileQueued  function    上传图片添加到上传队列之前\n *         onFileQueued        function    上传图片添加到上传队列后\n *         onUploadSuccess     function    上传成功\n *         onUploadError       function    上传失败\n *         onUploadProgress    function    上传中\n *         onErrored           function    报错\n *         retry               function    重新上传\n *         delImage            function    删除上传图片\n */\n\nvar WebUploader = require('../plugin/webuploader/webuploader');\nvar hint = require('module/hint');\nvar notice = require('module/i18n');\nvar imgReplace = require('utils/imgReplace');\nvar init = function(options) {\n\n    //var number = maxlength;\n    var numList = {};\n    var $webUpLoader;\n    var files = {};\n    var defaultOptions = {\n        //最大上传张数\n        maxlength: options.maxlength || 9,\n        //选择器\n        selector: {\n            parents: '[data-node=\"uploadBox\"]', //每个图片上传外层jq选择器\n            delSelector: '[data-action=\"delImage\"]', //删除按钮jq选择器\n            selector: '[data-defaultAddFile=picker]' //初始化时options.defaultApi.pick 的值，也就是 选择器的值\n        }\n    };\n    //初始化参数\n    defaultOptions.defaultApi = {\n        pick: {\n            id: '[data-defaultAddFile=picker]',\n            innerHTML: '本地上传图片'\n        },\n        accept: {\n            title: 'Images',\n            extensions: 'jpg,jpeg,png,gif',\n            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\n        },\n        method: 'post',\n        // swf文件路径\n        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\n        auto: true,\n        disableGlobalDnd: true,\n        duplicate: true,\n        prepareNextFile: true,\n        chunked: true,\n        fileVal: 'avatar_file',\n        server: '/ajax/crop/crop_img',\n        fileNumLimit: defaultOptions.maxlength * $(defaultOptions.selector).length,\n        fileSizeLimit: defaultOptions.maxlength * $(defaultOptions.selector).length * 4 * 1024 * 1024, // 50 M\n        fileSingleSizeLimit: 4 * 1024 * 1024\n    };\n    defaultOptions.callbacks = {\n        /***\n         * name: 图片加入队列之前\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * number: 最多可上传数\n         */\n        onBeforeFileQueued: function( /*file, numList, number*/ ) {\n            hint.init(notice.upload.excess);\n        },\n\n        /***\n         * name: 图片添加入队列后\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * maxlength: 最多可上传数\n         */\n        onFileQueued: function(file, numList, number) {\n            var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n            $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').before(html);\n\n            $('#rt_' + file.source.ruid).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\n            if (numList[file.source.ruid] === ~~number) {\n                $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').hide();\n            }\n\n        },\n\n        /***\n         * name: 上传成功（此成功指ajax有返回结果，故需要判断返回的状态码）\n         * file: 图片信息对象\n         * response: 上传图片ajax返回数据\n         */\n        onUploadSuccess: function(file, response) {\n            if (response.code === 200 && response.success) {\n                $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                //$('#' + file.id).html('<img src=\"' + imgReplace(response.data[0]) + '\" _src = \"' + response.data[0] + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            } else {\n                $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            }\n        },\n\n        /***\n         * name: 上传失败\n         * file: 图片信息对象\n         * reason: 出错的code\n         */\n        onUploadError: function(file /*, reason*/ ) {\n            $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n        },\n\n        /***\n         * name: 上传时，包含进度条\n         * file: 图片信息对象\n         * percentage: 上传进度\n         */\n        onUploadProgress: function(file, percentage) {\n            $('#' + file.id).find('[data-node=\"progress\"]').css('width', percentage * 100 + '%');\n        },\n\n        /***\n         * name: 报错\n         * type: 报错类型\n         */\n        onErrored: function( /*type*/ ) {\n            hint.init(notice.upload.uploadError);\n        },\n\n        //重新上传\n        retry: function() {\n            var _this = this;\n            $('[data-node=\"uploadList\"]').on('click', '[data-action=\"retry\"]', function() {\n                _this.retry(files[$(this).parents('li').attr('id')]);\n            });\n        },\n\n        /***\n         * name: 删除图片\n         * webuploader: webuploader实例化对象\n         * numList: 自定义json对象，用来存储每个实例化对象已上传的图片个数\n         * id: 每个webuploader实例化时，上传按钮所生成的唯一id\n         */\n        delImage: function(webuploader, numList, id, number) {\n            $webUpLoader.removeFile(files[$(this).parents('li').attr('id')]);\n            $(this).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[id]);\n            $(this).parents('ul').find('[data-defaultAddFile=\"picker\"]').show();\n            $(this).parents('li').eq(0).remove();\n            if (numList[id] === 0) {\n                $('[i-id=ok]').addClass('btn-default');\n            };\n        }\n    };\n    options.callbacks = $.extend({}, defaultOptions.callbacks, options.callbacks);\n    /*var */\n    options = $.extend({}, defaultOptions, options);\n    $webUpLoader = WebUploader.create(options.defaultApi);\n\n    $webUpLoader.onFileQueued = function(file) {\n        var ruid = $('[data-node=\"uploadBox\"]').find('[data-defaultaddfile=\"picker\"]').children().eq(1).attr('id');\n        file.source.ruid = ruid;\n        numList[file.source.ruid] = numList[file.source.ruid] !== undefined ? numList[file.source.ruid] : 0;\n        numList[file.source.ruid]++;\n        files[file.id] = file;\n        options.callbacks.onFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\n    };\n\n    //上传成功\n    $webUpLoader.on('uploadSuccess', function(file, response) {\n        options.callbacks.onUploadSuccess.call($webUpLoader, file, response);\n    });\n\n    //加入队列前\n    $webUpLoader.on('beforeFileQueued', function(file) {\n        if (numList[file.source.ruid] >= options.maxlength) {\n            options.callbacks.onBeforeFileQueued.call($webUpLoader, file, numList, options.maxlength);\n            return false;\n        }\n\n    });\n    //上传失败\n    $webUpLoader.on('uploadError', function(file, reason) {\n        options.callbacks.onUploadError.call($webUpLoader, file, reason);\n    });\n\n    //上传时\n    $webUpLoader.on('uploadProgress', function(file, percentage) {\n        options.callbacks.onUploadProgress.call($webUpLoader, file, percentage);\n    });\n\n    //报错\n    $webUpLoader.on('error', function(type) {\n        options.callbacks.onErrored.call($webUpLoader, type);\n    });\n    options.callbacks.retry.call($webUpLoader);\n\n    //删除图片\n    $(options.selector.parents).on('click', options.selector.delSelector, function() {\n        var id = $(this).parents(options.selector.parents).find(options.defaultApi.pick.id).children().eq(1).attr('id');\n        numList[id]--;\n        options.callbacks.delImage.call(this, $webUpLoader, numList, id, options.maxlength);\n    });\n\n    return $webUpLoader;\n}\n\nmodule.exports = {\n    init: init\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/upload.js"," var rules = /^https?:/i;\n var https = 'https';\n var imgRule = /^http/i;\n/* var grepStr = /-600!80\\./g;\n var grepOldStr = /\\.600q80\\.jpg/gi;*/\n var shotCut = \"-600!80\";\n var imgType = /\\.(jpg|jpeg|png)$/;\n\nvar grepStr1 = /(.+?)-[^\\.]+\\.(jp(e)?g|png|gif).*/;\nvar grepStr2 = /(.+?\\.(jp(e)?g|png|gif)).*/\n\n\n var imgReplace = function(src) {\n    return  src.replace(rules, '');\n }\n\nvar orignalImgReplace = function(src){\n    if(grepStr1.test(src)){\n        return src.replace(grepStr1,\"$1.$2\"); \n    }else{\n        return src.replace(grepStr2,\"$1\");\n    }\n      \n}\n\nvar addShortCut = function(src){\n    return src.replace(imgType,function($1){\n        return shotCut + $1;\n    })\n}\n var imgProto = function(src) {\n     if (src.indexOf(https) != -1) {\n         return 'https:';\n     } else {\n         return 'http:'\n     }\n }\n\n var changeSrc = function(container) {\n     var $imgs = container.find('img').not('[data-node=\"goodsPic\"]');\n     var len = $imgs.length;\n     for (var i = 0; i < len; i++) {\n         var _this = $($imgs[i])\n         var _src = _this.attr(\"_src\");\n         var _orignal = _this.attr(\"data-original\");\n         if (_orignal) {\n             _this.attr({\n                 'src': imgReplace(_orignal),\n                 '_src': imgReplace(_orignal),\n                 'proto': imgProto(_orignal)\n             })\n         } else if (!imgRule.test(_src)) {\n             var proto = _this.attr(\"proto\");\n             _this.attr(\"_src\", _src);\n         }\n\n     }\n }\n\n module.exports = {\n     imgReplace: imgReplace,\n     addShortCut:addShortCut,\n     imgProto: imgProto,\n     changeSrc: changeSrc,\n     orignalImgReplace:orignalImgReplace\n };\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/imgReplace.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/picture/pictures',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,images=$data.images,v=$data.v,$index=$data.$index,$escape=$utils.$escape,times=$data.times,src=$data.src,_src=$data._src,imgProto=$data.imgProto,$out='';$out+='<!-- ';\n$each(images,function(v,$index){\n$out+=' <p> <img data-t=\"t-';\n$out+=$escape(times);\n$out+='\" angle=\"0\" data-type=\"insertImg\" src=\"';\n$out+=$escape(v);\n$out+='\"> </p> ';\n});\n$out+=' --> <p> <img data-t=\"t-';\n$out+=$escape(times);\n$out+='\" angle=\"0\" data-type=\"insertImg\" src=\"';\n$out+=$escape(src);\n$out+='\" _src=\"';\n$out+=$escape(_src);\n$out+='\" proto=\"';\n$out+=$escape(imgProto);\n$out+='\"> </p> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/picture/pictures.tpl\n// module id = 119\n// module chunks = 6 16","var codeTpl = require('./upload.tpl');\nvar imgPath = $GLOBAL_CONFIG['pcimgpath'];\n\n$('body').append(codeTpl({\n    imgPath: imgPath\n}));\n\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar qrTips = require('module/i18n');\nvar alert = require('module/popup/alert');\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\nvar domain = $_CONFIG['group_domain'];\n\nvar pageId = window.pageId;\nvar maxLen = config.imgLimitNUm;\nvar pageId = window.pageId;\nfunction Scans(o) {\n    this.qid = o.qid || 'single'; //是否创建实例的唯一标示\n    this.topicQrId = \"\";\n    this.$parent = o.$parent; //用于寻找插入图片的节点\n    this.uploadMaxNum = o.maxNum || 20; //上传图片限制\n    //this.currentMaxNum = 0; //当前能够上传图片\n    this.useNewCode = 0; //二维码是否过期的判断\n    this.interval = 0;\n    this.type = o.type || 'pubsliser'; //扫码来源  评论页？发布话题页？等\n    this.$showBox = o.$showBox; //二维码弹层\n    this.time = o.time || 2000; //轮询请求间隔\n    this.customInit = o.customInit || \"\";\n    this.customCb = o.customCb; //用户自定义回调函数\n    this.isLoad = 0;\n    // this.$insertDom = o.$insertDom; //插入图片的节点\n    this.imgArr = []; //存储二维码未过期时，获得的的图片总数\n    this.editor = o.editor || \"\"; //用于编辑器\n    this.$cover = o.$showBox.find('[data-node=\"cover\"]'); //是否上传中\n    this.$localBtn = o.$showBox.find('[data-node=\"upLocal\"]'); //是否上传中\n    this.$target = o.$target;\n    this.code = \"\";\n    this.btn = o.btn;\n\n}\n\nScans.prototype = {\n    constructor: Scans,\n    init: function() {\n        var _this = this;\n        if (_this.editor) {\n            //\n            /*_this.editor.document.body.addEventListener('DOMNodeRemoved', function(evt) {\n                var code = evt.keyCode || evt.which\n                if (code == 8) {\n                    var target = evt.target\n                    debugger;\n                    console.log(target.nodeName, target.previousSibling, target.previousSibling.nodeName)\n                    if (target.nodeName == \"#text\") {\n                        if (target.previousSibling && target.previousSibling.nodeName == \"IMG\") {\n            console.log(333)\n                        }\n                    }\n                }\n            })*/\n\n            /*$(_this.editor.document).on('DOMNodeRemoved DOMNodeInserted', 'img', function(e) {\n                if (_this.interval) {\n                    //console.log(666)\n                    setTimeout(function() {\n                        _this.sendNum();\n                    }, 100)\n\n                }\n            })*/\n\n            $(_this.editor.body).on('click', function(e) {\n                //$webUpLoader.destroy();\n                _this.hide();\n                e.preventDefault();\n            })\n        }\n\n        if (typeof _this.customInit == 'function') {\n            this.customInit(this);\n        }\n        $('body').on('click', /* _this.$showBox*/ '[data-node=\"picPopBox\"]', function(e) {\n            var tagName = e.target.tagName;\n            tagName = tagName == 'INPUT' || tagName == 'LABEL'\n            if (!tagName) {\n                e.stopPropagation();\n            } else {\n                _this.hide()\n            }\n\n        });\n\n        this.start();\n    },\n    start: function() {\n        if (!this.useNewCode) {\n            this.getCode()\n        } else {\n\n            if (this.checkShow()) {\n                this.hide()\n            } else {\n                this.show();\n            }\n        }\n    },\n    //获取图片数量\n    imgLength: function() {\n        if (this.editor) {\n            return $(this.$parent.getContent()).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n        } else {\n            return this.$parent.find(\"img\").length;\n        }\n    },\n    //获取二维码\n    getCode: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var datas = {\n            pageId: pageId,\n            maxNum: this.uploadMaxNum - len\n        }\n        var qid = _this.qid;\n        var qidArr = window.topicQrId; //检测window变量是否有此变量 格式为：\n        _this.show();\n        //topicQrId:{\n        //  qid1:s1111,\n        //  qid2:s2222\n        // }\n        if (qidArr[qid].qrcodeId) {\n            datas.qrcodeId = _this.topicQrId;\n        }\n        fetch\n            .get(url.get('getUploadQrCode'), {\n                data: datas\n            })\n            .done(function(data) {\n                if (data.success == true) {\n\n                    if (data.code == 200) {\n\n                        _this.useNewCode = 1;\n\n                        var _data = data.data;\n\n                        var str = domain + 'qrupload/index?pageId=' + _data.pageId + '&qrcodeId=' + _data.qrcodeId + '&type=' + _this.type;;\n                        str = domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(str);\n\n                        window.topicQrId[qid].qrcodeId = _this.topicQrId = _data.qrcodeId; //把data的值赋予 window [qid].qrcodeId\n\n                        _this.code = str; //把二维码的值放入\n                        _this.getCodeCb();\n\n                        _this.interval = setInterval(function() {\n                            _this.monitor();\n                        }, _this.time)\n\n                    }\n                } else {\n                    alert(data.message);\n                }\n            })\n            .fail(function(e, s) {})\n\n    },\n    //扫码轮询\n    monitor: function() {\n        var _this = this;\n        fetch\n            .post(url.get('topListenImg'), {\n                data: {\n                    code: pageId,\n                    groupkey: window.topicQrId[_this.qid].qrcodeId\n                }\n\n            })\n            .done(function(data) {\n\n                if (data.success == true) { //ok\n                    _this.scanCb(data);\n                } else {\n                    _this.hide();\n                }\n            }).fail(function(e, m) {\n                clearInterval(_this.interval);\n                _this.interval = 0;\n                _this.hide();\n                // alert(e);\n            })\n    },\n    sendNum: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var maxNum = this.uploadMaxNum - len;\n        fetch\n            .get(url.get('topicuploadMax'), {\n                data: {\n                    qrcodeId: _this.topicQrId,\n                    maxNum: maxNum\n                }\n            })\n    },\n    //插入图片\n    insertPic: function(data) {\n        for (var i = 0, len = data.length; i < len; i++) {\n            var _data = data[i];\n            var _img = imgReplace.imgReplace(_data);\n            var _proto = imgReplace.imgProto(_data);\n            var str = '<p><img src=\"' + _img + '\" _src=\"' + _img + '\" data-type=\"insertImg\" proto=\"' + _proto + '\"/></p>';\n            this.editor.execCommand('inserthtml', str);\n        }\n    },\n    //用户正在上传中\n    loading: function() {\n        this.isLoad = 1;\n        this.$showBox.show();\n        this.$cover.show();\n        this.$localBtn.addClass('upload-unable');\n        if (this.editor) {\n            this.editor.setDisabled();\n        }\n\n    },\n    //用户不在上传中\n    unLoading: function() {\n        this.isLoad = 0;\n        this.$cover.hide();\n        this.$cover.css(\"display\", \"none\");\n        this.$localBtn.removeClass('upload-unable');\n        if (this.editor) {\n            this.editor.setEnabled();\n        }\n\n    },\n    //检查弹层状态\n    checkShow: function() {\n        if (this.$showBox.is(\":visible\")) {\n            return true;\n        }\n        return false;\n    },\n    //调整弹窗位置\n    fixPop: function() {\n        var $btn = this.$target;\n        var offset = $btn.offset();\n        var x = offset.left;\n        var y = offset.top / 1 + 30;\n\n        return this.$showBox.css({\n            'top': y + 'px',\n            'left': x + 'px'\n        });\n\n    },\n    //显示弹层\n    show: function() {\n        this.$showBox.removeClass('webuploader-element-invisible');\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        this.fixPop().show();\n    },\n    //隐藏弹层\n    hide: function() {\n        if (this.isLoad != 1) {\n            this.$showBox.hide();\n        }\n    },\n    //获得二维码回调\n    getCodeCb: function() {\n        this.sendNum(); //发送二维码数量\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        //this.show();\n    },\n    //扫码回调\n    scanCb: function(data) {\n\n            switch (data.isload) {\n                case 1:\n                    this.unLoading()\n                    break;\n                case 2: //上传中\n                    this.loading()\n\n                    break;\n                case 3: //上传完成\n                    var dataArr = data.data;\n                    var tempArr = [];\n\n                    var diffLen = dataArr.length - this.imgArr.length;\n\n                    if (diffLen) {\n                        this.loading()\n                        this.imgArr = dataArr;\n                        tempArr = dataArr.slice(-diffLen)\n                        var _this = this;\n                        setTimeout(function() {\n                            _this.unLoading()\n                            _this.hide();\n                            if (typeof _this.customCb == 'function') {\n                                _this.customCb(tempArr, _this)\n                            } else {\n                                _this.insertPic(tempArr);\n                            }\n\n                        }, 500)\n                    }\n                    break;\n                case 10000:\n                    this.imgArr = [];\n                    this.isload = 0;\n                    this.useNewCode = 0; //useNewCode 为0 意味着二维码过期\n                    clearInterval(this.interval);\n                    this.interval = 0;\n                    this.hide();\n                    break;\n            }\n        }\n        //prototype end\n}\n\nmodule.exports = Scans;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/uploadfileQR/index.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/uploadfileQR/upload',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgPath=$data.imgPath,$out='';$out+='<div data-node=\"picPopBox\" class=\"picPopBox\" data-node=\"picPopBox\"> <em class=\"sanjiao\"></em> <div class=\"container clearfix\"> <div class=\"left\"> <div class=\"qr\"> <img src=\\'\\'/> <div class=\"cover\" data-node=\"cover\">上传中...</div> </div> <p>扫描二维码,上传手机图片</p> </div> <div class=\"right\" data-node=\"uploadList\"> <div class=\"pc-btn pc-btnh35\" data-defaultAddFile=\\'picker\\'></div> </div> </div> </div> <div data-node=\"picLoading\" class=\"picLoading hide\"> <img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/public/loading.gif\"/> <div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/uploadfileQR/upload.tpl\n// module id = 121\n// module chunks = 6 16 30","//白名单\nvar whiteList = {\n    a: ['target', 'href', 'title', 'class', 'data-node'],\n    div: ['class', 'style', 'data-node', 'unselectable', 'onselectstart', 'data-type', 'data-skuid'],\n    dl: ['class', 'style', 'data-node'],\n    dt: ['class', 'style'],\n    em: ['class', 'style', 'data-node'],\n    h1: ['data-node'],\n    h2: ['data-node'],\n    h3: ['data-node'],\n    h4: ['data-node'],\n    h5: ['data-node'],\n    h6: ['data-node'],\n    img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-index', 'data-type', 'data-node', 'data-original', 'onerror', 'proto'],\n    p: ['class', 'style', 'data-node'],\n    span: ['class', 'style', 'data-node'],\n    ul: ['class', 'style', 'data-node'],\n    ol: ['class', 'style', 'data-node'],\n    li: ['class', 'style', 'data-node']\n};\n\nvar defaults = {\n    //图片张数限制\n    imgLimitNUm: 20,\n    //商品个数限制\n    goodsLimitNUm: 9,\n    initialFrameWidth: 788,\n    initialFrameHeight: 400,\n    zIndex: 9,\n    autoClearinitialContent: true,\n    //服务器根目录\n    UEDITOR_HOME_URL: $_CONFIG['js_domain'],\n    //后台地址\n    //serverUrl:'php/1.php',\n    //serverUrl: $_CONFIG['group_domain'],\n    serverUrl: '',\n    //css 路径\n    themePath: $_CONFIG.csspath + '/css/module/',\n    //白名单\n    whitList: whiteList,\n    //工具栏\n    toolbars: [\n        ['bold', 'italic', 'underline', 'insertunorderedlist', 'insertorderedlist', 'justifyleft', 'justifycenter', 'justifyright']\n        //['insertunorderedlist', 'insertorderedlist']\n    ],\n    //iframe 内置样式\n    iframeCssUrl: $_CONFIG.csspath + '/css/module/iframestyle.css?v=' + $GLOBAL_CONFIG['versionData'],\n    //'//localhost:8017/src/js/editor/themes/iframestyle.css',\n    //纯文本粘贴\n    pasteplain: true,\n    //禁止div转换成p标签\n    allowDivTransToP: false,\n    //禁止缩放图片\n    imageScaleEnabled: false,\n    elementPathEnabled: false, // 关闭元素路径,调试时暂时开启\n    wordCount: false, // 字数统计\n    //禁止非同域上传图片\n    catchRemoteImageEnable: true,\n    //匹配快捷按键回调\n    // callbackKey: shortcutKey.callbackKey,\n    //右键菜单功能\n    enableContextMenu: false,\n    // 因为是用的自定义的弹窗,所以,关闭了编辑器自带的图片弹窗\n    imagePopup: false,\n    // 禁止自动保存\n    enableAutoSave: false,\n    // 自定义过滤规则\n    // filterTxtRules:filterTxtRules()\n};\nmodule.exports = defaults;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/config.js","/**\n * @description\n * 图片角度转化\n *\n * @author 林飞\n */\nvar alert = require('module/popup/alert');\nvar transform = require('./angle');\nvar showText = require('./link/showText');\nUE.plugin.register('tansformImg', function(elm) {\n    var me = this;\n    var domUtils = UE.dom.domUtils;\n    //禁止连续请求\n\n    // img旋转弹层 鼠标离开，键盘事件都需要隐藏\n    var imageTransformPopup = window.imageTransformPopup = new baidu.editor.ui.Popup({\n        editor: me,\n        theme: 'default',\n        cutstomPosition: 'top-right',\n        _filterType: function(el) {\n            var src = $(el).attr(\"src\");\n            if (src.indexOf(\".gif\") != -1) {\n                alert(\"gif图不支持旋转\");\n                return false;\n            } else {\n                return true;\n            }\n        },\n        _link:function(){\n            var range = me.selection.getRange();\n            range.selectNode(this.anchorEl).select();\n            showText(me,this.anchorEl);\n        },\n        _left: function() {\n            var el = this.anchorEl;\n            if (this._filterType(el)) {\n                transform(this.anchorEl, 1);\n            }\n            me.focus();\n        },\n        _right: function() {\n            var el = this.anchorEl;\n            if (this._filterType(el)) {\n                transform(this.anchorEl, 2);\n            }\n            me.focus();\n        },\n        _delete: function() {\n            UE.dom.domUtils.remove( this.anchorEl, true )\n            //$(this.anchorEl).remove();\n            imageTransformPopup.hide();\n            me.focus();\n        }\n    })\n\n    imageTransformPopup.render();\n\n    me.addListener('mouseover', function(evtName, evt) {\n        if (me.loading) return;\n\n        var target = evt.target;\n        if($(target).attr('data-node') == 'goodsPic') return;\n        //console.log(evt.target.tagName === 'IMG')\n        //var img = me.selection.getRange().getClosedNode();\n        //if (img && img.tagName == \"IMG\" && img.parentNode.tagName != \"A\") {\n       // if (target && target.tagName == \"IMG\" && target.parentNode.tagName != \"A\") {\n        if (target && target.tagName == \"IMG\") {\n            var html = '',\n                str = \"\",\n                img = target;\n\n            str = '<nobr class=\"edui_angle_box edui-clearfix\">' +\n                '<span onclick=$$._link() class=\"edui-clickable\"></span>' +\n                '<span onclick=$$._left() class=\"edui-clickable\"></span>' +\n                '<span onclick=$$._right() class=\"edui-clickable\"></span>' +\n                '<span onclick=$$._delete() class=\"edui-clickable\"></span>' +\n                '</nobr>'\n\n            !html && (html = imageTransformPopup.formatHtml(str));\n            if (html) {\n                imageTransformPopup.getDom('content').innerHTML = html;\n                imageTransformPopup.anchorEl = img || link;\n                imageTransformPopup.showAnchor(imageTransformPopup.anchorEl);\n            } else {\n                imageTransformPopup.hide();\n            }\n        }\n    })\n\n    me.addListener('mouseover', function() {\n        imageTransformPopup.hide();\n    })\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/transformImg.js","var fetch = require('io/fetch');\nvar url = require('io/url');\n\nvar imgReplace = require('utils/imgReplace');\nvar firing = 0;\nvar imgArr = [];\nvar $picLoading;\n//var transformUrl = '1.json';\n\nvar transformAngle = function($obj, direction) { //img对象  角度\n    if (firing == 1) {\n        return false;\n    }\n    var def = $.Deferred();\n    var angle = parseInt($obj.attr(\"angle\")) || 0;\n    switch (direction) {\n        case 2:\n            if (angle == 0) {\n                angle = 270;\n            } else {\n                angle -= 90;\n            }\n            break;\n        case 1:\n            if (angle == 270) {\n                angle = 0;\n            } else {\n                angle += 90;\n            }\n            break;\n        case \"reset\":\n            angle = 0;\n            break;\n    }\n    def.resolve($obj, angle);\n    return def.promise();\n}\n\nvar detectImg = function($obj, angle) {\n    if (firing == 1) {\n        return false;\n    }\n    var def = $.Deferred();\n    var _src = $obj.attr(\"_src\");\n    var src = imgReplace.imgReplace(_src);\n\n    //数组是否包含 下标为_src的元素\n    var hasImg = imgArr[_src];\n    var angleStr = 'angle' + angle;\n    //是否包含已有角度的元素，\n    var tempObj = {\n        \"$obj\": $obj,\n        \"src\": src,\n        \"_src\": _src,\n        \"angle\": angle\n    }\n\n    var extendObj = {};\n\n    if (hasImg) {\n        if (hasImg[angleStr]) {\n            extendObj = {\n                \"status\": 1,\n                \"cache\": 1\n            };\n        } else {\n            extendObj = {\n                \"status\": 0,\n                \"cache\": 1\n            };\n        }\n\n    } else {\n        extendObj = {\n            \"status\": 0,\n            \"cache\": 0\n        };\n    }\n\n    $.extend(tempObj, extendObj)\n\n    def.resolve(tempObj);\n    return def.promise();\n}\n\nvar renderImg = function(obj) {\n\n    if (firing == 1) {\n        return false;\n    }\n    firing = 1;\n    var $obj = obj.$obj;\n    var src = obj.src;\n    var _src = obj._src;\n    var angle = obj.angle;\n    var status = obj.status;\n    var cache = obj.cache;\n\n    var angleStr = \"angle\" + angle;\n\n    var renderExist = function() {\n        $obj.attr({\n            'src': imgReplace.imgReplace(imgArr[_src][angleStr]),\n            'angle': angle,\n            \"proto\": imgReplace.imgProto(imgArr[_src][angleStr])\n        });\n        firing = 0;\n    }\n\n    if (obj.status) {\n        renderExist();\n        //直接渲染\n        return false;\n    }\n\n    if (obj.angle == 0) {\n\n        if (!imgArr[_src]) {\n            imgArr[_src] = [];\n        }\n\n        imgArr[_src][angleStr] = imgReplace.imgReplace($obj.attr(\"_src\"));\n        renderExist();\n        return false;\n    }\n\n    // fetch.get(transformUrl, {\n    fetch.post(url.get('topicRotateImg'), {\n        data: {\n            imgPath: _src,\n            angle: angle\n        },\n        beforeSend: function() {\n            if (!$picLoading) {\n                $picLoading = $('[data-node=\"picLoading\"]');\n            }\n            $picLoading.removeClass('hide');\n\n        }\n    }).done(function(data) {\n        var dataSrc = data.data[0];\n        if (data.success == true) {\n            $obj.attr({\n                'src': imgReplace.imgReplace(dataSrc),\n                'angle': angle,\n                'proto': imgReplace.imgProto(dataSrc)\n            });\n            if (!obj.cache) {\n\n                imgArr[_src] = [];\n\n            }\n            imgArr[_src][angleStr] = imgReplace.imgReplace(dataSrc);\n        } else {\n            alert(data.message);\n        }\n    }).always(function(data) {\n        firing = 0;\n        $picLoading.addClass('hide');\n\n    })\n}\n\nvar transform = function(obj, direction) {\n    var def = $.Deferred();\n    def.resolve($(obj), direction);\n\n    def\n        .then(transformAngle) //转化角度\n        .then(detectImg) //判断图片是否命中\n        .then(renderImg); //渲染图片\n}\nmodule.exports = transform;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/angle.js","\nvar domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\n\nvar pop = require('./pop');\nvar getContent = require('editor/utils/getContent');\n\nfunction showText(editor,el){\n    var range = editor.selection.getRange(),\n        //是否存在选区collapsed   startContainer === endContainer && startOffset === endOffset \n        link = range.collapsed ? editor.queryCommandValue( \"link\" ) : editor.selection.getStart(),\n        url,\n        rangeLink = domUtils.findParentByTagName(range.getCommonAncestor(),'a',true),\n        orgText;\n    link = domUtils.findParentByTagName( link, \"a\", true );\n\n    if (getContent(range).indexOf('gmp-ebox') != -1) {\n        return false;\n    }\n\n    editor.hoverEl = el;\n\n    //是否有href\n    if(link){\n        url = utils.html(link.getAttribute( '_href' ) || link.getAttribute( 'href', 2 ));\n         pop(editor,url,1);\n    }else{\n        url='';\n        pop(editor,url,0);\n    }\n   \n}\n\nmodule.exports = showText;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/link/showText.js","var Dialog = require('dialog');\nvar inputTpl = require('./input.tpl');\nvar dealLink = require('./dealLink');\n//var grepLocal = /( src=[\"'])https?:(\\/\\/.*?((meixincdn\\.com)|(((atguat)|(gomein))\\.net\\.cn)))/gi;\n\nvar domainReg = /((\\w+):\\/\\/)?([^/]+)/;\nvar grepLocal=/((\\.gome\\.com\\.cn)|(meixincdn\\.com)|(atguat.com.cn)|(((atguat)|(gomein))\\.net\\.cn))$/i;\n\nfunction pop(editor,url,num) {\n    var d = Dialog({\n        fixed: true,\n        title: '插入超链接',\n        modal: true,\n        width: 500,\n        content: inputTpl({'url':url}),\n        className: 'pop-box pop-links',\n        okValue: '插入',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        btnWrapCls: 'insert-cancel',\n        ok:function(){\n        \tvar value = $('[data-node=\"link-value\"]').val();\n            if(value == ''){\n                $('[data-node=\"link-msg\"]').text('链接地址不能为空');\n                return false;\n            }else{\n                var arr = value.match(domainReg)[0];\n                if( grepLocal.test(arr) ){\n                //if( true ){\n                    dealLink(editor,value,num);\n                }else{\n                    $('[data-node=\"link-msg\"]').text('不支持非gome站内链接地址，请重新输入');\n                    return false;\n                }\n            }\n\n        },\n        cancel: function() {\n        }\n    })\n    \n   \n\n    var $btn = $(d.node).find('.circle-pop-btn');\n\n    if( url == \"\" ){\n        $btn.addClass('btn-default');\n    }\n\n    $('[data-node=\"link-value\"]').on(\"keyup\",function(){\n        var $this = $(this);\n        var value = $this.val();\n        if(value.length){\n            var arr = value.match(domainReg)[0];\n            if( grepLocal.test(arr) ){\n                $btn.removeClass('btn-default');\n            }else{\n                $btn.addClass('btn-default');\n            }\n        }\n        \n    })\n\n     d.show();\n}\n\nmodule.exports = pop;\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/link/pop.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/link/input',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,url=$data.url,$out='';$out+='<div data-node=\"link-addr\" class=\"link-addr\"> <p class=\"pop-links clearfix\" data-node=\"pop-links\"> <span>链接地址:</span> <input type=\"text\" data-node=\"link-value\" placeholder=\"仅支持gome站内链接地址\" value=\"';\n$out+=$escape(url);\n$out+='\"/> </p> <p class=\"link-msg\" data-node=\"link-msg\"></p> </div>';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/link/input.tpl\n// module id = 127\n// module chunks = 6 16","var fetch = require('io/fetch');\nvar url = require('io/url');\nvar domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\n\nvar imgReplace = require('utils/imgReplace');\n\nvar $linkValue = $('[data-node=linkValue]');\n\n\nfunction dealLink(editor,value,num){\n    \n\n    var range = editor.selection.getRange();\n    var collapsed =  range.collapsed;\n    var reg = /^http/i;\n\n    //单独滑过图片要处理的js\n    if(editor.hoverEl){\n        range.selectNode(editor.hoverEl);\n        editor.hoverEl = null;\n        collapsed = false;\n    }\n\n    if( !reg.test(value) ){\n        value = 'http://' + value;\n    }\n    if(num == 1){    //有href\n\n        editor.execCommand('link', {href:value,target:'_blank'});\n\n    }else{//无href\n\n         if(!collapsed){\n            editor.execCommand('link', {href:value,target:'_blank'});\n         }else{\n            editor.execCommand('inserthtml', '<a href=\"'+value+'\" target=\"_blank\">'+value+'</a>');\n         }\n               \n    }\n    \n}\n    \n\nmodule.exports = dealLink\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/link/dealLink.js","/**\n * 插入商品\n * @author Fu Xiaochun\n */\n\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar empty = require('module/empty');\nvar toast = require('module/hint').init;\n\nvar dialog = require('module/addGoods');\nvar goodsTpl = require('./goods.tpl');\n\nvar imgReplace = require('utils/imgReplace');\n//var detectQr = require('../detectQr');\n//var maxLen = 9;\n\nvar from = $GLOBAL_CONFIG['from'];\nvar insertedGoods = {};\n\n//插入草稿 延迟2s执行\nif (from) {\n    setTimeout(function() {\n        insertedGoods = window.insertedGoods;\n    }, 2000)\n}\n\nUE.registerUI('insertgoods', function(editor, uiName) {\n\n    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    editor.registerCommand(uiName, {\n        execCommand: function() {\n            var $content = $(editor.body);\n            var $goodsDoms = $content.find('[data-type=insertGoods]');\n            var goodsLen = $goodsDoms.length;\n            var goodsData = {};\n\n            if (goodsLen) {\n                if (empty(insertedGoods)) {\n                    goodsData = $goodsDoms.data('goodsinfo');\n                    insertedGoods[goodsData.skuId] = goodsData;\n                } else {\n                    $.each(insertedGoods, function(k) {\n                        var len = $content.find('[data-skuId=' + k + ']').length;\n                        if (!len) {\n                            delete insertedGoods[k];\n                        }\n                    });\n                }\n\n            } else {\n                insertedGoods = {};\n            }\n            dialog(insertedGoods, 9);\n        }\n    });\n\n    // 插入后激活光标\n    editor.addListener('afterinserthtml', function() {\n        editor.focus();\n    });\n\n    // 接收商品\n    Pubsub(channel.setPubliser.changedItem).sub(function(data) {\n        var range = editor.selection.getRange();\n        var DomArr = editor.selection.getStartElementPath();\n        var startDom = DomArr[DomArr.length - 2];\n        var creatNewP = 0;\n        var nextNode = startDom.nextElementSibling;\n        if (startDom.nodeName == \"OL\" || startDom.nodeName == \"UL\") {\n            toast('列表状态下不能插入商品', {\n                duration: 2000\n            });\n            return false;\n        }\n\n        if (nextNode && nextNode.nodeName == 'DIV') {\n            creatNewP = 1;\n        }\n\n        insertedGoods = $.extend(true, {}, data);\n        var $content = $(editor.body);\n        var $goodsCards = $content.find('[data-type=insertGoods]');\n        $.each($goodsCards, function(i, e) {\n            var skuId = $(e).data('skuid');\n            var $eParent = $(e).parent('div');\n            var $preDom = $eParent.prev('p');\n            var preDomTxt = $.trim($preDom.text());\n            if (typeof data[skuId] === 'undefined') {\n                $content.find('[data-skuId=' + skuId + ']').parent().remove();\n            }\n        });\n        $.each(data, function(k) {\n            var $goodsCard = $content.find('[data-skuId=' + k + ']');\n            if ($goodsCard.length) {\n                delete data[k];\n            }\n        });\n\n        var goodsHTML = goodsTpl({\n            list: data\n        });\n        editor.focus();\n\n        if (creatNewP) {\n            goodsHTML = $.trim(goodsHTML) + '<p>&#8203<br/></p>' //编辑器bug 必须用trim\n        }\n        goodsHTML = imgReplace.imgReplace(goodsHTML);\n        editor.execCommand('insertgoodshtml', goodsHTML, true);\n\n        setTimeout(function() {\n            var $body = $(editor.body); //节点已经变化，重新获取\n            var $el = $body.find('[data-node=\"gmp-ebox\"]').last();\n            var $li = $el.parent('li');\n            var $parent = $li.parent();\n            var $next = $parent.next();\n            if (!$next.length) {\n                $parent.append(\"<li><p>&#8203<p></li>\");\n                editor.focus();\n            }\n\n        }, 200)\n    });\n\n    //创建一个button\n    var btn = new UE.ui.Button({\n        name: 'insertgoods',\n        title: '插入商品',\n        label: '',\n        iconEle: '<em class=\"insert-merchant iconn-29\"></em>',\n        cssRules: '',\n        onclick: function() {\n            editor.execCommand(uiName);\n        }\n    });\n\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 0);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/goods/index.js","/**\n * [判断Object是否为空]\n * @Author: Fu Xiaochun\n * @Email: \tfuzhengchun@gomeplus.com\n */\nmodule.exports = function(o) {\n\tfor (var k in o) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/empty.js","var dialog = require('module/popup/addGoods/dialog');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar Pubsub = require('io/pubsub');\nvar tpl = require('module/popup/addGoods/content.tpl');\nvar itemlist = require('module/popup/addGoods/itemContent.tpl');\nvar defaultItemlist = require('module/popup/addGoods/defaultItemContent.tpl');\nvar pubName = require('io/channel');\nvar indexof = require('lodash/indexOf');\nvar alert = require('module/popup/alert');\n\nvar pageNum = 1;\nvar maxlength = 9;\nvar isDefault = true;\nvar keyWord = '';\nvar changedList = [];\nvar isGetMore = false;\nvar options = {};\nvar degree = 1;\n// var delChanged = [];\nvar addDialog;\n\nvar $searchTop = null,\n    $searchInput = null,\n    $searchBtn = null,\n    $searchNormal = null,\n    $searchLoading = null,\n    $searchFail = null,\n    $searchResult = null,\n    $searchList = null,\n    // $searchPage = null,\n    $changeNum = null,\n    $listBox = null,\n    $changeList = null,\n    $title = null,\n    $getMore = null,\n    $searchListBox = null;\n\nvar selectedGoods = {};\n\nvar init = function(changedGoods, max /* 最多可选 */ ) {\n    var returnList = [];\n    selectedGoods = {};\n    // var selectedGoodsBak = {};\n    for (var i in changedGoods) {\n        changedList.push(i);\n        returnList.push(changedGoods[i]);\n    }\n\n    maxlength = max || 9;\n    selectedGoods = $.extend(true, selectedGoods, changedGoods);\n    if (maxlength - returnList.length !== 0) {\n        options = {\n            title: ' ',\n            modal: true,\n            fixed: true,\n            width: 712,\n            content: tpl({\n                imgSrc: $_CONFIG.imgpath,\n                returnList: returnList,\n                maxlength: maxlength,\n                changeNum: maxlength - returnList.length\n            }),\n            className: 'pop-box',\n            okValue: '插入商品',\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            btnWrapCls: 'insert-cancel',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n                dialogClosed();\n            },\n            cancel: function() {\n                dialogClosed();\n            },\n            onshow: function() {\n\n                $('[i=\"title\"]').hide();\n                getNode(); //获取节点\n                defaultItem(pageNum); //默认输出内容\n                searchItem(); //搜索商品\n                reGet(); //重新获取\n                changeItem(); //选择添加的商品\n                getMoreItem(); //加载 更多\n                $('body').css({\n                    height: '100%',\n                    overflowY: 'hidden'\n                });\n            }\n        };\n\n    } else {\n        options = {};\n    }\n\n    addDialog = dialog.create(options);\n    setTimeout(function() {\n        addDialog.show();\n    }, 100)\n\n};\n//获取节点\nvar getNode = function() {\n    $searchTop = $('[data-node=\"addTopBox\"]');\n    $searchInput = $searchTop.find('[data-action=\"addSearchInput\"]');\n    $searchBtn = $searchTop.find('[data-action=\"addSearchBtn\"]');\n    $searchNormal = $('[data-node=\"searchNormal\"]');\n    $searchLoading = $('[data-node=\"searchLoading\"]');\n    $searchFail = $('[data-node=\"searchFail\"]');\n    $searchResult = $('[data-node=\"searchResultBox\"]');\n    $searchList = $searchResult.find('[data-node=\"searchResultList\"]');\n    $listBox = $searchResult.find('[data-node=\"changedBox\"]');\n    $changeList = $listBox.find('[data-node=\"searchChangeList\"]');\n    $changeNum = $searchResult.find('[data-node=\"searchChangeNum\"]');\n    $title = $('[data-node=\"title\"]'),\n        $getMore = $searchResult.find('[data-action=\"moreItem\"]');\n    $searchListBox = $searchList.parent();\n};\n\n//初始化进弹窗获取数据\nvar defaultItem = function(pageNum) {\n    getItems(url.get('getCollectItem'), {\n        data: {\n            page: pageNum,\n            pagesize: 10\n        },\n        done: function(result) {\n            var html = defaultItemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//搜索 商品\nvar searchItem = function() {\n    $searchInput.on('keyup', function(e) {\n        var keycode = e.which;\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).val());\n        //处理回车的情况\n        if (keycode === 13) {\n            if (keyWord !== '') {\n                if (keyWord.length < 2) {\n                    alert('请输入两个字符以上关键词');\n                } else {\n                    pageNum = 1;\n                    $title.hide();\n                    $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                    moreItem(pageNum, keyWord);\n                }\n            } else {\n                alert('请输入关键词');\n            }\n        }\n        //返回我收藏的商品列表\n        if (keyWord === '') {\n            $searchResult.children().eq(0).hide();\n            isDefault = true;\n            pageNum = 1;\n            $title.show();\n            defaultItem(pageNum); //默认输出内容\n\n        }\n    });\n    $searchBtn.on('click', function() {\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).prev().val());\n\n        if (keyWord !== '') {\n            if (keyWord.length < 2) {\n                alert('请输入两个字符以上关键词');\n            } else {\n                $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                pageNum = 1;\n                $title.hide();\n                moreItem(pageNum, keyWord);\n            }\n        } else {\n            alert('请输入关键词');\n        }\n\n    });\n};\n\n//获取更多商品\n\nvar moreItem = function(pageNum, txt) {\n    getItems(url.get('getMoreItem'), {\n        data: {\n            pagenum: pageNum,\n            pagesize: 10,\n            word: txt\n        },\n        done: function(result) {\n            var html = itemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (result.pageCount != \"1\") {\n                $getMore.hide();\n            }\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//ajax\nvar getItems = function(link, options) {\n    if (pageNum === 1) {\n        $searchList.hide();\n        $searchFail.hide();\n        $searchLoading.show();\n        $searchNormal.hide();\n    } else {\n        $getMore.show();\n    }\n    fetch.get(link, {\n        data: options.data\n    }).done(function(result) {\n\n        if (result.code === 200) {\n            var resultItem = result.data.collections === undefined ? result.data.items : result.data.collections;\n            if ((!resultItem || resultItem.length === 0) && isDefault) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('暂无收藏的商品，可以搜索查找！');\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else if (!resultItem || resultItem.length === 0) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('没有找到相关产品');\n                    $searchResult.children().eq(0).hide();\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else {\n                $searchResult.show().children().eq(0).show();\n                $searchList.show();\n                options.done.call(this, result);\n                $getMore.hide();\n                isGetMore = false;\n\n                if (resultItem.length < 10 && pageNum !== 1) {\n\n                    isGetMore = true;\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            }\n\n            // 重新定位弹窗位置\n            // addDialog.reset();\n\n        } else if (result.code === 881001) {\n            if (pageNum === 1) {\n                $searchNormal.show().text('没有找到相关产品');\n                $searchResult.children().eq(0).hide();\n            } else {\n                $getMore.show().find('span').text('没有可加载内容');\n            }\n        } else {\n            if (pageNum === 1) {\n                $searchFail.show();\n            } else {\n                $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n            }\n        }\n    }).fail(function() {\n        if (pageNum === 1) {\n            $searchFail.show();\n        } else {\n            $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n        }\n    }).always(function() {\n        $searchLoading.hide();\n    });\n};\n\n//重新获取\nvar reGet = function() {\n    $searchFail.on('click', function() {\n        if (pageNum === 1) {\n            $searchLoading.show();\n            $searchFail.hide();\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n    $getMore.on('click', '[node-action=\"reget\"]', function() {\n        $(this).parent().html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n        if (isDefault) {\n            defaultItem(pageNum);\n        } else {\n            moreItem(pageNum, keyWord);\n        }\n    });\n};\n\nvar changeItem = function() {\n    if ($changeList.children().length) {\n        $('[i-id=ok]').removeClass('btn-default');\n    }\n    $searchResult.on('click', '[data-action=\"item\"]', function() {\n        var $this = $(this);\n        var imgSrc = $this.find('img').attr('src'),\n            pId = $this.attr('data-pId'),\n            shopId = $this.attr('data-shopid'),\n            itemLink = $this.attr('data-link'),\n            skuId = $this.attr('data-skuId'),\n            html = '';\n        if (maxlength == 1) {\n            if ($changeList.children().length) {\n                $changeList.empty();\n                $searchList.children(\"dl\").removeClass(\"chosed-mer-true\");\n\n            }\n            $this.addClass(\"chosed-mer-true\");\n\n            if ($changeList.children().length === 0) {\n                $listBox.show();\n            }\n            selectedGoods = {};\n            selectedGoods[skuId] = {\n                shopId: shopId,\n                skuId: skuId,\n                PId: pId,\n                title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                img: imgSrc,\n                price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                // 融合后的新商品链接\n                link: itemLink,\n                //rebate: $(this).attr('data-rebate')\n            };\n            html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\n            $changeList.append(html);\n            $changeNum.text(maxlength - $changeList.children().length);\n        } else {\n\n            if (!$(this).hasClass('chosed-mer-true')) {\n                if ($changeList.children().length >= maxlength) {\n                    alert('最多可选取' + maxlength + '个商品');\n                    return false;\n                }\n\n                changedList.push(skuId);\n                selectedGoods[skuId] = {\n                    shopId: shopId,\n                    skuId: skuId,\n                    PId: pId,\n                    title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                    img: imgSrc,\n                    price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                    // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                    // 融合后的新商品链接\n                    link: $(this).attr('data-link'),\n                    //rebate: $(this).attr('data-rebate')\n                };\n                $(this).addClass('chosed-mer-true');\n                html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n                if ($changeList.children().length === 0) {\n                    $listBox.show();\n                }\n                $changeList.append(html);\n                $changeNum.text(maxlength - $changeList.children().length);\n            } else {\n                var del = $changeList.find('[data-skuId=\"' + skuId + '\"]');\n                $(this).removeClass('chosed-mer-true');\n                del.remove();\n\n                var id = $(this).attr('data-skuId');\n                var index = changedList.indexOf(id);\n                if (index !== -1) {\n                    changedList.splice(index, 1)\n                }\n                delete selectedGoods[id];\n                if ($changeList.children().length === 0) {\n                    $listBox.hide();\n                }\n                $changeNum.text(maxlength - $changeList.children().length);\n            }\n\n        }\n\n        if ($changeList.children().length) {\n            $('[i-id=ok]').removeClass('btn-default');\n        } else {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n\n        addDialog.reset();\n\n    }).on('click', '[data-action=\"delChanged\"]', function() {\n        var id = $(this).closest('li').attr('data-skuId');\n        var index = changedList.indexOf(id);\n        if (index !== -1) {\n            changedList.splice(index, 1)\n        }\n        var _this = this;\n        $searchList.find('[data-skuId=\"' + $(_this).parent().attr('data-skuId') + '\"]').removeClass('chosed-mer-true');\n\n        $(_this).parents('li').remove();\n        delete selectedGoods[id];\n        if ($changeList.children().length === 0) {\n            $listBox.hide();\n        }\n        $changeNum.text(maxlength - $changeList.children().length);\n        if (!$changeList.children().length) {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n    });\n};\n\n//加载更多\nvar getMoreItem = function() {\n    $searchListBox.on('scroll', function() {\n        if (!isGetMore && $searchListBox.scrollTop() >= ($searchList.height() - $searchListBox.height())) {\n            isGetMore = true;\n            pageNum++;\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n};\n\n//弹窗关闭\nvar dialogClosed = function() {\n    degree++;\n    $('body').css({\n        height: 'auto',\n        overflowY: 'auto'\n    });\n\n    $searchListBox.off('scroll');\n    $searchResult.off('click');\n    $searchFail.off('click');\n    $searchInput.off('keyup');\n    $searchBtn.off('click');\n    pageNum = 1;\n    // delChanged = [];\n    isDefault = true;\n    keyWord = '';\n    isGetMore = false;\n    changedList = [];\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/addGoods.js","var Dialog = require('dialog');\r\n\r\n\r\n\r\nvar create = function(options) {\r\n    options = options || {};\r\n    var defaults = {\r\n        title: ' ',\r\n        modal: true,\r\n        fixed: true,\r\n        width: 350,\r\n        content: '<p class=\"del-pop-p\">您最多能添加9个商品哦！</p>',\r\n        className: 'pop-box',\r\n        okValue: '确定',\r\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\r\n        ok: function() {\r\n\r\n        },\r\n        onshow: function() {\r\n            $('[i=\"title\"]').hide();\r\n        }\r\n    };\r\n    $.extend(true, defaults, options);\r\n    return Dialog(defaults);\r\n};\r\n\r\n\r\nmodule.exports = {\r\n    create: create\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/addGoods/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgSrc=$data.imgSrc,returnList=$data.returnList,$each=$utils.$each,$value=$data.$value,$index=$data.$index,changeNum=$data.changeNum,maxlength=$data.maxlength,$out='';$out+=' <div class=\"search-box\" data-node=\"addTopBox\"> <input type=\"text\" placeholder=\"搜索商品\" data-action=\"addSearchInput\"> <em class=\"icon-search-sw\" data-action=\"addSearchBtn\"></em> </div> <div class=\"ui-dialog-title\" data-node=\"title\">我收藏的商品</div> <p class=\"no-saving-txt\" style=\"display:none;\" data-node=\"searchNormal\">暂无收藏的商品，可以搜索查找！</p> <div class=\"loading\" data-node=\"searchLoading\"><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\" alt=\"\"></div> <p class=\"failed-txt\" style=\"display:none;\" data-node=\"searchFail\">数据获取失败，点击重新加载！</p> <div style=\"display:';\n$out+=$escape((returnList.length === 0 ? 'none':''));\n$out+=';\" data-node=\"searchResultBox\"> <div class=\"merchant-list clearfix\" > <div class=\"clearfix\" data-node=\"searchResultList\"></div> <div class=\"more-comments pop-more-com\" data-action=\"moreItem\" style=\"display:none;\"> <span><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\">正在加载...</span> </div> </div> <div class=\"chosed-merchants\" data-node=\"changedBox\" style=\"display:';\n$out+=$escape((returnList.length>0?'':'none'));\n$out+='\"> <ul class=\"merchants-list clearfix\" data-node=\"searchChangeList\"> ';\n$each(returnList,function($value,$index){\n$out+=' <li data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" data-pid=\"';\n$out+=$escape($value.PId);\n$out+='\"> <img src=\"';\n$out+=$escape($value.img);\n$out+='\" alt=\"\" onerror=\"imgError(this)\"> <a href=\"javascript:;\" data-action=\"delChanged\"> <em class=\"icon-del-pic\"></em> </a> </li> ';\n});\n$out+=' </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"searchChangeNum\">';\n$out+=$escape(changeNum);\n$out+='</span>/<span class=\"deep-gray\">';\n$out+=$escape(maxlength);\n$out+='</span>个商品</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/content.tpl\n// module id = 133\n// module chunks = 6 16 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/itemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$string=$utils.$string,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"11111\" onerror=\"imgError(this)\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$string($value.name);\n$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.salePrice !== null?$value.salePrice:'暂无售价');\n$out+='</span></span> <!-- ';\nif($value.rebateMoney > 0){\n$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n$out+=$escape($value.rebateMoney);\n$out+='国美币</span> </div> ';\n}\n$out+=' --> </dd> </dl> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/itemContent.tpl\n// module id = 134\n// module chunks = 6 16 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/defaultItemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-shopId=\"';\n$out+=$escape($value.shopId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"\" onerror=\"imgError(this,\\'m\\')\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$escape($value.name);\n$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.skuPrice);\n$out+='</span></span> <!-- ';\nif($value.rebate > 0){\n$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n$out+=$escape($value.rebate);\n$out+='国美币</span> </div> ';\n}\n$out+=' --> </dd> </dl> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/defaultItemContent.tpl\n// module id = 135\n// module chunks = 6 16 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/goods/goods',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,$escape=$utils.$escape,$out='';$each(list,function(v,i){\n$out+='<p>&#8203<br></p><div data-node=\"gmp-ebox\" class=\"card-box\" contenteditable=\"false\"> <div data-type=\"insertGoods\" data-skuId=\"';\n$out+=$escape(v.skuId);\n$out+='\" data-pid=\"';\n$out+=$escape(v.PId);\n$out+='\" data-info=\\'{\"type\":\"item\",\"text\":\"\",\"id\":\"';\n$out+=$escape(v.PId);\n$out+='\",\"kid\":\"\", \"shopId\": \"';\n$out+=$escape(v.shopId);\n$out+='\",\"skuId\":\"';\n$out+=$escape(v.skuId);\n$out+='\"}\\' class=\"publish-item\"> <a href=\"';\n$out+=$escape(v.link);\n$out+='\" class=\"img-out\"> <img src=\"';\n$out+=$escape(v.img);\n$out+='\" data-node=\"goodsPic\"> </a> <div class=\"publish-cont\"> <h3 class=\"pub-tl\"> <a href=\"';\n$out+=$escape(v.link);\n$out+='\">';\n$out+=$escape(v.title);\n$out+='</a> </h3> <div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">';\n$out+=$escape(v.price);\n$out+='</strong> </div> <!-- ';\nif(v.rebate){\n$out+=' <div class=\"pub-row\"> <div class=\"fan\"> <em class=\"icon-fan\"></em> <span>最高返';\n$out+=$escape(v.rebate);\n$out+='国美币</span> </div> </div> ';\n}\n$out+=' --> <a href=\"';\n$out+=$escape(v.link);\n$out+='\" target=\"_blank\" class=\"scan-more\">查看详情</a> </div></div><div class=\"cover\">&nbsp;</div></div>';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/goods/goods.tpl\n// module id = 136\n// module chunks = 6 16","/**\n * 插入链接\n * @author Lin Fei\n */\n\nvar showText = require('./showText');\n\nUE.registerUI('insertlink', function(editor, uiName) {\n   \n\n    //注册按钮执行时的command命令，使用命令默认就会带有回退操作\n    editor.registerCommand(uiName, {\n        execCommand: function() {\n            showText(editor);\n        }\n    });\n\n    //创建一个button\n    var btn = new UE.ui.Button({\n        name: 'insertlink',\n        title: '插入链接',\n        label: '',\n        iconEle: '<em class=\"insert-merchant iconn-29\"></em>',\n        cssRules: '',\n        onclick: function() {\n            editor.execCommand(uiName);\n        }\n    });\n\n    //因为你是添加button,所以需要返回这个button\n    return btn;\n}, 13);\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/link/index.js","/**\n * @description\n * 处理不能正常删除图片\n *\n * @author 林飞\n */\n\nvar browser = baidu.editor.browser;\nvar gecko = browser.gecko ? browser.version : 0;\n\nUE.plugin.register('delImg', function() {\n    var me = this;\n    var domUtils = UE.dom.domUtils;\n    if (browser.version > 10 && !gecko) return; //ie10 以及chrome 不用处理\n    //设置光标位置\n    var setCursor = function(range, newNode, position) {\n\n            range.setStart(newNode);\n            if (position) {\n                range.setEnd(newNode, position);\n            } else {\n                range.setEnd(newNode, 0);\n            }\n\n            range.setCursor(true);\n        }\n        //删除节点\n    var deleteNode = function(node, evt) {\n        node.remove();\n        domUtils.preventDefault(evt);\n    }\n\n    //创建新行\n    var creatNewP = function(range, parent) {\n        var node = node;\n        var doc = me.document;\n\n        var newNode = doc.createElement('p');\n        var textNode = doc.createTextNode(\"\");\n        newNode.appendChild(textNode);\n\n        //插入当前节点前还是后\n        if (range.startOffset == 0) {\n            me.body.insertBefore(newNode, parent);\n        } else {\n            domUtils.insertAfter(parent, newNode);\n        }\n\n        setCursor(range, newNode);\n    }\n\n    me.addListener('keydown', function(evtName, evt) {\n        var keyCode = evt.keyCode || evt.which;\n        var range = me.selection.getRange();\n        var startContainer = range.startContainer;\n\n        var nodeName = startContainer.nodeName.toUpperCase();\n        var startOffset = range.startOffset;\n        var endOffset = range.endOffset;\n        var closedNode = range.getClosedNode();\n\n        var detectKey = function() {\n            switch (keyCode) {\n                case 8:\n                    backspaceKey();\n                    break;\n                case 46:\n                    deleteKey();\n                    break;\n                default:\n                    defaultKey();\n                    break;\n            }\n        }\n\n        //删除键\n        var backspaceKey = function() {\n                if (startOffset == 0) {\n                    //P的情况有以下几种：包括了 标题 h1,h2,h3\n                    //1.1 当前为<p>|</p>或(<p><img></p>), 上一级为<p><img></p> 要删除上一级，否则会和下一级合并\n                    //1.2 当前为<p><img></p>,上级为div 或者文本\n                    //1.3 当前为<p>|</p> 上一级为div 或者文本\n                    if (nodeName == \"#TEXT\") {\n                        var parentNode = startContainer.parentNode;\n\n                        var prev = parentNode.previousSibling;\n                        var $prev = $(prev);\n                        // console.log($prev.find(\"img\").length)\n                        if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                            deleteNode($prev, evt);\n                        }\n\n                    } else {\n                        var prev = startContainer.previousSibling;\n                        var $prev = $(prev);\n                        if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                            deleteNode($prev, evt);\n                        }\n                    }\n                    /*\n                                        if (nodeName == \"P\") {\n                                            var prev = startContainer.previousSibling;\n                                            var $prev = $(prev);\n                                            //第一种情况\n                                            if ($(startContainer).find(\"img\").length) {\n                                                //1.1\n                                                if ($prev.find(\"img\").length) {\n\n                                                    deleteNode($prev, evt);\n                                                } else {\n                                                    //1.2\n                                                    //前一个节点不是光标或者空节点\n                                                    if ($prev.text().replace(/[\\u200b]/gi, \"\") != \"\") {\n                                                        var last = prev.lastChild;\n                                                        //光标插入文本末端\n                                                        if (last.nodeName.toUpperCase() == \"#TEXT\") {\n                                                            var length = last.nodeValue.length;\n                                                            setCursor(range, last, length);\n                                                        } else if (last.nodeName.toUpperCase() == \"BR\") {\n                                                            //UE.dom.domUtils.remove( last, false );\n                                                            deleteNode($(last), false)\n                                                            domUtils.preventDefault(evt);\n                                                        }\n                                                    }\n                                                }\n                                                //第二种情况\n                                            } else if ($prev.find(\"img\").length) {\n                                                deleteNode($prev, evt);\n                                            }\n                                        }*/\n\n                    /* if (nodeName == \"#TEXT\") {\n                         var parentNode = startContainer.parentNode;\n                         var prev = parentNode.previousSibling;\n                         var $prev = $(prev);\n                         console.log($prev.find(\"img\").length)\n                         if ($prev.find(\"img\").length) {\n                             deleteNode($prev, evt);\n                         }\n                     }*/\n                }\n            }\n            // 往后删除键 恶心的玩意 害死人啊。。。\n        var deleteKey = function() {\n            if (startOffset != 0) return false;\n\n            if (nodeName == \"#TEXT\") {\n                var parentNode = startContainer.parentNode;\n\n                var prev = parentNode.previousSibling;\n                var $prev = $(prev);\n                // console.log($prev.find(\"img\").length)\n                console.log($prev && $prev.attr('data-node'))\n                if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                    if ($prev.find('.cover').hasClass('show')) {\n                        deleteNode($prev, evt);\n                    }\n\n                }\n\n            } else {\n                var prev = startContainer.previousSibling;\n                var $prev = $(prev);\n                if ($prev && $prev.attr('data-node') == 'gmp-ebox') {\n                    if ($prev.find('.cover').hasClass('show')) {\n                        deleteNode($prev, evt);\n                    }\n                }\n            }\n            /* switch (nodeName) {\n                 //在<p><img>|</p>\n                 case \"P\":\n                     if ($(startContainer).find(\"img\").length && startOffset != 0) {\n                         if (startContainer.nextSibling) {\n                             setCursor(range, startContainer.nextSibling)\n                         }\n                     }\n                     break;\n                     //<p><img>光标|</p> 或者<p>xxxx<p>\n                 case \"#TEXT\":\n                     var parent = startContainer.parentNode;\n                     var $parent = $(parent);\n                     if ($parent.find(\"img\").length) {\n                         deleteNode($parent, evt)\n                     } else if (parent.lastChild == startContainer) {\n                         if (startOffset == startContainer.nodeValue.length) {\n                             var $nextNode = $(parent).next();\n                             if ($nextNode.find(\"img\").length) {\n                                 deleteNode($nextNode, evt)\n                             }\n                         }\n                     }\n                     break;\n             }*/\n        }\n\n        var defaultKey = function() {\n            if (closedNode && closedNode.tagName == \"IMG\") {\n                if (gecko) {\n                    //禁止火狐选中图片 用键盘字符替换造成标签溢出\n                    domUtils.preventDefault(evt);\n                } else {\n                    domUtils.remove(closedNode.parentNode, false);\n                }\n            } else if (nodeName == \"P\") {\n                if ($(startContainer).find(\"img\").length != 0) {\n                    creatNewP(range, startContainer);\n                }\n            } else if ($(startContainer).parent().find(\"img\").length != 0) {\n                var prentsNode = startContainer.parentNode;\n                creatNewP(range, prentsNode);\n            }\n        }\n\n        if (evt.ctrlKey || keyCode == 37 || keyCode == 38 || keyCode == 39 || keyCode == 40) {\n\n        } else {\n            detectKey();\n        }\n\n        window.imageTransformPopup.hide();\n    })\n\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/beforeInput.js","var grepHtml = require('editor/rewrite/grepRule');\nvar pastedCheckImg = require('./pastedCheckImg');\n/**\n * @description\n * 过滤粘贴进来的文本\n *\n * @author linfei\n */\nUE.plugin.register('grepPaste', function(e) {\n\n    var me = this;\n    var domUtils = UE.dom.domUtils;\n    me.addListener('beforepaste', function(type, html) {\n        html.html = grepHtml(me, html.html);\n        if (html.html.indexOf('src') !== -1) {\n            pastedCheckImg(me);\n        }\n\n    });\n\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/grepPaste.js","var alert = require('module/popup/alert');\nvar config = require('editor/config');\n//过滤回车特殊字符\nvar grepFormat = /[\\n]/gi;\n//匹配商品\nvar grepDiv = /<div (data-node=[\"']gmp-ebox.*?|class=[\"']publish-item.*?)<\\/div><\\/div>/gi;\n//匹配img\nvar grepImg = /<img.*?>/gi;\n//匹配src\nvar grepLocal = /( src=[\"'])https?:(\\/\\/.*?((meixincdn\\.com)|(((atguat)|(gomein))\\.net\\.cn)))/gi;\n//匹配表情\nvar grepFace = /data-face=['\"](.*?)['\"]/;\n\nfunction getHtml(html, num) {\n    var i = 0;\n    var overload = 0;\n\n    html = html.replace(grepImg, function(j) {\n        if (i < num) {\n            i++;\n            return j;\n        } else {\n            overload = 1;\n            return '';\n        }\n    })\n    return {\n        html: html,\n        overload: overload\n    };\n}\n\nfunction selectGetHtml(html, obj) {\n\n    var len = obj.len;\n\n    var innerImgLen = obj.innerImgLen; //粘贴板数量\n    var outerImgLen = obj.outerImgLen; //浏览器内数量\n    var limitNum = obj.limitNum; //限制数量\n    var maybe = innerImgLen + outerImgLen - limitNum;\n\n    return getHtml(html, limitNum - outerImgLen - len);\n}\n\nfunction grepHtml(editor, html) {\n    var me = editor;\n    var limitNum = config.imgLimitNUm;\n    var tempHtml = html;\n    //检测图片数量\n    function checkNum(str) {\n        var innerImg = str.match(grepImg),\n            innerImgLen = innerImg ? innerImg.length : 0; //粘贴板 图片数量\n\n        var outerImg = me.getContent().replace(grepDiv, '')\n            .match(grepImg),\n            outerImgLen = outerImg ? outerImg.length : 0; //编辑器区域 图片数量\n\n        var range = me.selection.getRange(),\n            startContainer = range.startContainer,\n            endContainer = range.endContainer,\n            startOffset = range.startOffset,\n            endOffset = range.endOffset;\n\n        var useAlert = innerImgLen + outerImgLen - limitNum\n        if (useAlert >= 0) {\n            var case_1 = startContainer == endContainer && startOffset != endOffset;\n            var case_2 = startContainer != endContainer;\n            if (case_1 || case_2) {\n                var fragment = range.cloneContents(),\n                    node = document.createElement(\"div\");\n\n                node.appendChild(fragment);\n\n                var html = node.innerHTML;\n\n                var len = html.match(grepImg).length;\n                return selectGetHtml(tempHtml, {\n                    limitNum: limitNum,\n                    outerImgLen: outerImgLen,\n                    innerImgLen: innerImgLen,\n                    len: len\n                })\n            }\n            return getHtml(tempHtml, limitNum - outerImgLen);\n        }\n        return false;\n    }\n\n    var h = checkNum(tempHtml)\n\n    if (h) {\n        if (h.overload) {\n            if (!$(\".pop-box-backdrop\").length) {\n                alert('您最多能添加' + limitNum + '张图片哦！');\n                return h.html;\n            }\n        }\n    }\n    return tempHtml;\n}\n\nmodule.exports = grepHtml;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/grepRule.js","var imgPath = $GLOBAL_CONFIG['pcimgpath'];\nvar fetch = require('io/fetch')\nvar url = require('io/url')\n\nvar imgReplace = require('utils/imgReplace');\n\n//var grepLocal = /^https?\\:\\/\\/(i|js).*?meixincdn\\.com/;\nvar grepLocal = /\\/\\/(((i|js).*?meixincdn\\.com)|.*?((atguat)|(gomein))\\.net\\.cn)/i;\nvar defaultImg = imgReplace.imgReplace(imgPath) + '/images/editor/spacer.jpg';\n\nvar setImgPath = function(o, src, useDefault) {\n    if (useDefault) {\n        o.src = defaultImg;\n        o.setAttribute('_src', defaultImg);\n    } else {\n        if (typeof src == 'object') {\n            src = src[0];\n        }\n        o.src = imgReplace.imgReplace(src);\n        o.setAttribute('_src', imgReplace.imgReplace(src));\n        o.setAttribute('proto', imgReplace.imgProto(src));\n    }\n}\nvar pastedCheckImg = function(ue) {\n    setTimeout(function() {\n        var $imgs = $(ue.body).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]');\n\n        for (let i = 0, len = $imgs.length; i < len; i++) {\n            let _img = $imgs[i];\n            let src = _img.src;\n            let _src = $(_img).attr('_src');\n            let test_src = grepLocal.test(_src) || grepLocal.test(src);\n\n            if (!test_src) {\n                fetch\n                    .post(url.get('topicUrlUpload2'), {\n                        data: {\n                            src: src\n                        },\n                    })\n                    .done(function(data) {\n                        if (data.success == true) {\n                            var src = data.data;\n\n                            if (src.length) {\n                                setImgPath(_img, src)\n                            } else {\n                                setImgPath(_img, defaultImg, true)\n                            }\n\n                        } else {\n\n                            setImgPath(_img, defaultImg, true)\n\n                        }\n\n                    })\n                    .fail(function() {\n                        setImgPath(_img, defaultImg, true)\n\n                    })\n                    .always(function(data) {\n                        //firing = 0;\n                    })\n            } else {\n                var proto = $(_img).attr(\"proto\");\n                var thisSrc = imgReplace.imgReplace(src);\n                if (!proto) {\n                    proto = imgReplace.imgProto(src)\n                    $(_img)\n                        .attr({\n                            'src': thisSrc,\n                            '_src': thisSrc,\n                            'proto': proto\n                        })\n                        //.attr('_src', proto + thisSrc);\n                } else {\n                    $(_img)\n                        .attr({\n                            'src': thisSrc,\n                            '_src': thisSrc\n                        })\n                }\n\n            }\n\n        }\n\n    }, 500)\n\n}\nmodule.exports = pastedCheckImg\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/pastedCheckImg.js","//var grepHtml = require('editor/rewrite/grepRule');\n/**\n * @description \n * 过滤拖拽进来的文本\n * \n * @author linfei\n */\n\n\nUE.plugin.register('grepDrop', function (){\n    var me = this;\n    var body = me.body;\n    var domUtils = UE.dom.domUtils;\n    var target = 0; //判断是否是当前页面做拖拽\n    var browser = baidu.editor.browser;\n    var ieVersion = browser.ie ? browser.version : 0;\n    var dropStr = \"\";   //专门用于ie 【drop】inserthtml 使用到\n    var tempRange = \"\";  //存放拽入的选区 \n    var dropToP = 0;//是否拖拽进入P标签\n\n    var grepRule = {\n\n            grepFormat : /[\\n]/gi,\n\n            grepCursor : /[\\u200b]/gi,  //光标\n\n            grepImg : /(<img.*?>)/gi, \n\n            grepDiv : /<div class=[\"']card-box.*?i<\\/div><\\/div>/gi\n    }\n\n    //过滤html\n    var grepHtml = function(obj,isIe){\n        return  obj\n                    .replace(grepRule.grepFormat,'')\n                    .replace(grepRule.grepDiv,'')\n                    .replace(grepRule.grepCursor,'')\n                    .replace(grepRule.grepImg,function(i,j,k,l){\n\n                            if(isIe){\n                                return '<p>'+i+'</p>';\n                            }else{\n                                return  '<p>'+ i.replace('>','class=\"block\">') + '</p>';\n                            }                           \n                        }) \n    }\n\n    //创建新行\n    var creatNewP = function(parent,node,position){\n        var node = node;\n        var text = node.nodeValue;\n        var doc = me.document;\n\n        var newNode = doc.createElement('p');\n        var textNode = doc.createTextNode(text);\n        newNode.appendChild(textNode);\n        UE.dom.domUtils.remove( node, false );\n\n        //插入当前节点前还是后\n        if(position == 'before'){\n            me.body.insertBefore(newNode,parent);\n        }else{\n            domUtils.insertAfter(parent,newNode);\n        }\n    }\n    //渲染P标签\n    var renderP = function(node){     \n        var childNodes = node.childNodes;\n        var len = childNodes.length;\n        \n        var textOffset = -1;\n        var imgOffset = 0 ;\n        \n        for(var j = 0;j<len ;j++){\n            var _node = childNodes[j];\n            if(_node.nodeName.toUpperCase() == \"#TEXT\"){\n                var value = _node.nodeValue\n                                .replace(grepRule.grepCursor,'')\n                                .replace(\" \",'');\n                if(value){                                                \n                    textOffset = j;\n                }                                            \n            }\n            if(_node.nodeName.toUpperCase() == \"IMG\"){\n                imgOffset = j;\n            }\n        }\n        \n        //判断文本节点的位置\n        if(textOffset != -1){\n            var oldTextNode = childNodes[textOffset];\n            var position = textOffset < imgOffset ? 'before' :'after';\n            \n            creatNewP( node, oldTextNode, position );           \n        }\n        \n    }\n\n    var renderBody = function(){\n\n        if(dropToP == 1){\n            dropToP = 0;\n            return;\n        }\n\n        $body = $(me.body);\n        $body.find(\"img\").removeAttr(\"class\");\n        // 不能在P标签上加任何属性，会被过滤掉\n        var $imgs = $body.find(\"[data-type='insertImg']\");\n        var len = $imgs.length;\n        if( len ) {\n            for(var i = 0;i<len;i++){\n                var img = $imgs[i];\n                var imgPrent = img.parentNode;\n                renderP(imgPrent);  \n            }\n        }\n        dropToP = 0;\n    }\n\n    return {\n       bindEvents:{\n            'ready': function (){\n\n                var _body = me.body;\n                \n                //禁止商品拖拽\n                $(_body).delegate(\"div\",'dragstart',function(e){\n                    target = 0;\n                    domUtils.preventDefault(e);\n                })\n\n                $(_body).delegate(\"p\",'drop',function(e){\n                    \n                    var $this = $(this);\n                    var _this = this;\n                    setTimeout(function(){\n                        $(_body).find(\"img\").removeAttr(\"class\");\n                        if($this.find(\"img\").length!=0){\n                            renderP(_this);   \n                        }\n                    },100);\n                    dropToP = 1;\n                })\n\n                domUtils.on(document, 'dragstart', function(evt){\n                    target = 0;\n                })\n\n                domUtils.on(_body, 'dragstart', function(evt){                   \n                    target = 1;\n\n                    //ie是插入内容，其他浏览器是修改drag的内容\n                    if( ieVersion > 7){\n                        var range = me.selection.getRange();\n                        var fragment = range.cloneContents();\n                        var _node = document.createElement(\"div\");\n\n                        tempRange = range;\n\n                        _node.appendChild(fragment)\n                        dropStr =  _node.innerHTML;\n                        dropStr = grepHtml(dropStr); \n                    }else{\n                        var dataTransfer = evt.dataTransfer;\n                        var data = dataTransfer.getData(\"text/html\");\n                        data = grepHtml(data,false);\n                        dataTransfer.setData(\"text/html\",data);                        \n                    }           \n                })\n\n\n                domUtils.on(_body, 'drop', function(evt){\n                    var range = me.selection.getRange();\n                    if(!target){\n                        domUtils.preventDefault(evt);\n                    }\n\n                    if(ieVersion > 7){\n                        //要清空选区  并且 阻止默认触发事件，\n                        //否则会变成复制内容，两者缺一不可，很奇葩。。\n                        if(tempRange){\n                            tempRange.deleteContents();\n                        }\n                        me.execCommand(\"insertHtml\",dropStr);                    \n                        domUtils.preventDefault(evt);\n\n                    }\n\n                    setTimeout(function(){\n                        renderBody();\n                    },200);\n\n                    tempRange = \"\";\n                    target = 0;\n                    dropStr = \"\"; \n                })\n            } \n        }  \n    }\n})\n\n            \n        /*,备用\n\n        commands:{\n            'haha': {\n                execCommand: function (cmd, str) {\n                    //var range = me.selection.getRange();\n                    //range.select();\n                    //me.focus();\n                    me.execCommand(\"insertHtml\",str,true);                   \n                    //me.execCommand('anchor', 'anchor1')\n                }\n            }\n            \n        }*/\n    \n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/grepDrop.js","/**\n * @description \n * 处理firefox不能正常选中图片的bug\n * \n * @author 林飞\n */\n\n var browser = baidu.editor.browser;\n var gecko = browser.gecko ? browser.version:0;\n var ieversion = browser.ie ? browser.version : 0;\n\nvar setCursor = function (range,newNode){\n    range.setStart(newNode);\n    range.setEnd(newNode,0);\n    range.setCursor(true);\n}\n\n\n\nif(gecko) {\n\n    UE.plugin.register('selectImg', function (){\n        var me = this;\n        me.addListener('click',function(type,html){\n            var range = me.selection.getRange(),\n            startContainer = range.startContainer,\n            nodeName = startContainer.nodeName;\n\n            if(nodeName == \"P\" && startContainer.innerHTML.indexOf('<img') != -1){\n                range.selectNode(startContainer).select();\n            }\n        })\n    })\n}\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/selectImg.js","/**\n * 处理IE渲染延迟导致高度计算失误\n * \n * @林飞\n */\nUE.plugin.register('fixHeight', function (){\n    var me = this;     \n    var browser = baidu.editor.browser;\n    var ieVersion = browser.ie ? browser.version : 0;  \n\n    if(ieVersion > 7){\n    \tme.addListener('afterinserthtml', function() {\n\t    \tsetTimeout(function(){\n\t\t\t\tme.body.style.height=\"auto\";\n\t\t\t},500)\n\t    })\n    }\n      \n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/autoHeight.js","var fetch = require('io/fetch')\nvar url = require('io/url')\nvar alert = require('module/popup/alert');\nvar i18n = require('module/i18n');\nvar domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\nvar $picLoading;\nvar firing = 0;\n\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\n\nvar limitNum = config.imgLimitNUm;\nvar maxSize = 4 * 1024 * 1024;\nvar fetchData = function(src, editor) {\n    fetch\n    //.get('img.json', {})\n        .post(url.get('topicBase64Upload'), {\n            data: {\n                src: src\n            },\n            beforeSend: function() {\n                if (!$picLoading) {\n                    $picLoading = $('[data-node=\"picLoading\"]');\n                }\n                $picLoading.removeClass('hide');\n\n            }\n        })\n        .done(function(data) {\n            if (data.success == true) {\n                var datas = data.data\n                for (var i = 0, len = datas.length; i < len; i++) {\n                    var _datas = datas[i];\n                    var str = \"<p><img src='\" + imgReplace.imgReplace(_datas) + \"' _src='\" + _datas + \"' data-type='insertImg' proto = '\" + imgReplace.imgProto(_datas) + \"'></p>\";\n                    editor.execCommand(\"insertHtml\", str)\n\n                }\n            } else {\n                alert('上传失败,请重新上传');\n                firing = 0;\n                $picLoading.addClass('hide');\n            }\n\n        })\n        .always(function(data) {\n            firing = 0;\n            $picLoading.addClass('hide');\n\n        })\n}\n\nvar imgReader = function(file, editor) {\n    if (firing == 1) {\n        return false;\n    }\n    firing = 1;\n    var reader = new FileReader();\n\n    // 读取文件后将其显示在网页中\n    reader.onload = function(e) {\n        var img = new Image();\n        var data = e.target.result;\n\n        //图片压缩优化\n        var canvas = document.createElement(\"canvas\");\n        var context = canvas.getContext(\"2d\");\n        var imageBase64;\n\n        img.onload = function() {\n            var _w = img.width;\n            var _h = img.height;\n\n            canvas.width = _w;\n            canvas.height = _h;\n            context.drawImage(img, 0, 0);\n            imageBase64 = canvas.toDataURL(\"image/jpeg\");\n            fetchData(imageBase64, editor);\n        }\n\n        img.src = data;\n\n        domUtils.preventDefault(e)\n    };\n    // 读取文件\n    reader.readAsDataURL(file);\n};\n\nUE.plugin.register('autoupload', function() {\n    function getPasteImage(e) {\n        return e.clipboardData && e.clipboardData.items && e.clipboardData.items.length == 1 && /^image\\//.test(e.clipboardData.items[0].type) ? e.clipboardData.items : null;\n    }\n\n    function getDropImage(e) {\n        return e.dataTransfer && e.dataTransfer.files ? e.dataTransfer.files : null;\n    }\n\n    return {\n        outputRule: function(root) {\n            utils.each(root.getNodesByTagName('img'), function(n) {\n                if (/\\b(loaderrorclass)|(bloaderrorclass)\\b/.test(n.getAttr('class'))) {\n                    n.parentNode.removeChild(n);\n                }\n            });\n            utils.each(root.getNodesByTagName('p'), function(n) {\n                if (/\\bloadpara\\b/.test(n.getAttr('class'))) {\n                    n.parentNode.removeChild(n);\n                }\n            });\n        },\n        bindEvents: {\n            //插入粘贴板的图片，拖放插入图片\n            'ready': function(e) {\n                var me = this;\n\n                if (window.FormData && window.FileReader) {\n\n                    domUtils.on(me.body, 'paste', function(e) {\n                        var hasImg = false,\n                            items;\n                        //获取粘贴板文件列表\n                        items = e.type == 'paste' ? getPasteImage(e) : getDropImage(e);\n                        if (items) {\n                            var len = items.length,\n                                file;\n\n                            while (len--) {\n                                file = items[len];\n                                if (file.getAsFile) file = file.getAsFile();\n                                if (file && file.size > 0) {\n                                    if (/image\\/\\w+/i.test(file.type)) { //判断为图片文件\n                                        if (firing) {\n                                            hasImg = true;\n                                            e.preventDefault();\n                                            return;\n                                        }\n                                        if (file.size > maxSize) {\n                                            hasImg = true;\n                                            e.preventDefault();\n                                            alert(i18n.upload.uploadError);\n                                            return;\n                                        } else {\n                                            var $content = $(me.getContent());\n                                            var insertedImgLen = $content.find('[data-type=insertImg]').length;\n\n                                            if (insertedImgLen < limitNum) {\n                                                imgReader(file, me);\n                                            } else {\n\n                                                var range = me.selection.getRange(),\n                                                    startContainer = range.startContainer,\n                                                    nodeName = startContainer.nodeName;\n\n                                                if (insertedImgLen == limitNum) {\n                                                    if (e.target.tagName == \"IMG\") {\n                                                        imgReader(file, me);\n                                                    }\n                                                } else {\n                                                    if (!$(\".pop-box-backdrop\").length) {\n                                                        alert('您最多能添加' + limitNum + '张图片哦！');\n                                                    }\n                                                }\n\n                                            }\n                                            hasImg = true;\n                                        }\n\n                                    }\n                                }\n                            }\n\n                            setTimeout(function() {\n                                imgReplace.changeSrc($(me.body));\n                            }, 2000)\n                            hasImg && e.preventDefault();\n                        }\n                    });\n                }\n            }\n        }\n    }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/autoUpload.js","/**\n * @description\n * 增加超链接对话框转化\n *\n * @author 林飞\n */\n\n\nvar showText = require('./link/showText');\n\nUE.plugin.register('showLink', function(elm) {\n    var me = this;\n    var domUtils = UE.dom.domUtils;\n    //禁止连续请求\n\n    // img旋转弹层 鼠标离开，键盘事件都需要隐藏\n    var linkTransformPopup = window.linkTransformPopup = new baidu.editor.ui.Popup({\n        editor: me,\n        theme: 'default',\n        cutstomPosition: 'bottom-left',\n        _editLink: function(el) {\n           showText(me);\n           linkTransformPopup.hide();\n        },\n        _delLink: function() {\n            me.execCommand('unlink');\n            linkTransformPopup.hide();\n        }\n    })\n\n    linkTransformPopup.render();\n\n    me.addListener('click', function(evtName, evt) {\n\n        if (me.loading) return;\n\n        var target = evt.target;\n\n        if (target && (target.tagName == \"A\" || $(target).parents('a').length!=0)) {\n            var html = '',\n                str = \"\",\n                img = target;\n            var link = $(target).attr('href') || $(target).parents('a').attr('href');\n\n            str =   '<nobr class=\"edui-link-container edui-clearfix\">' +\n                        '<p class=\"edui-link-box edui-clearfix clearfix\">'+\n                            '<a onclick=$$._editLink() class=\"editLink\">'+link+'</a>' +\n                            '<a onclick=$$._delLink() class=\"delLink\">&nbsp;&nbsp;</a>' +\n                        '</p>'+\n                \n                    '</nobr>'\n\n            !html && (html = linkTransformPopup.formatHtml(str));\n            if (html) {\n                linkTransformPopup.getDom('content').innerHTML = html;\n                linkTransformPopup.anchorEl = img || link;\n                linkTransformPopup.showAnchor(linkTransformPopup.anchorEl);\n            } else {\n                linkTransformPopup.hide();\n            }\n        }\n    })\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/linkLayer.js","//toolbar\nrequire('./toolbar');\n//按钮规则\nrequire('./buttonRules');\n//商品插入数量限制\nrequire(\"./insertGoods\");\n//浮层位置\nrequire(\"./fixPopPosition\");\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/index.js","require('./baseFont');\nrequire('./align');\nrequire('./list');\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/index.js","var domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\n//var domUtils = baidu.editor.dom.domUtils\n\nvar getContent = require('editor/utils/getContent');\n\nUE.plugins['basestyle'] = function() {\n\n    var basestyles = {\n            'bold': ['strong', 'b'],\n            'italic': ['em', 'i'],\n            'subscript': ['sub'],\n            'superscript': ['sup'],\n            'underline': ['u']\n        },\n        getObj = function(editor, tagNames) {\n            return domUtils.filterNodeList(editor.selection.getStartElementPath(), tagNames);\n        },\n        me = this;\n    //添加快捷键\n    me.addshortcutkey({\n        \"Bold\": \"ctrl+66\", //^B\n        \"Italic\": \"ctrl+73\", //^I\n        \"Underline\": \"ctrl+85\" //^U\n    });\n    me.addInputRule(function(root) {\n        utils.each(root.getNodesByTagName('b i'), function(node) {\n            switch (node.tagName) {\n                case 'b':\n                    node.tagName = 'strong';\n                    break;\n                case 'i':\n                    node.tagName = 'em';\n            }\n        });\n    });\n    for (var style in basestyles) {\n        (function(cmd, tagNames) {\n            me.commands[cmd] = {\n                execCommand: function(cmdName) {\n                    var range = me.selection.getRange(),\n                        obj = getObj(this, tagNames);\n\n                    /* range.select();\n\n                     var fragment = range.cloneContents(),\n                         node = document.createElement(\"div\");\n\n                     node.appendChild(fragment);\n                     */\n\n                    if (getContent(range).indexOf('gmp-ebox') != -1) {\n                        return false;\n                    }\n                    if (range.collapsed) {\n\n                        if (obj) {\n                            var tmpText = me.document.createTextNode('');\n                            range.insertNode(tmpText).removeInlineStyle(tagNames);\n                            range.setStartBefore(tmpText);\n                            domUtils.remove(tmpText);\n                        } else {\n                            var tmpNode = range.document.createElement(tagNames[0]);\n                            if (cmdName == 'superscript' || cmdName == 'subscript') {\n                                tmpText = me.document.createTextNode('');\n                                range.insertNode(tmpText)\n                                    .removeInlineStyle(['sub', 'sup'])\n                                    .setStartBefore(tmpText)\n                                    .collapse(true);\n                            }\n                            range.insertNode(tmpNode).setStart(tmpNode, 0);\n                        }\n                        range.collapse(true);\n                    } else {\n                        if (cmdName == 'superscript' || cmdName == 'subscript') {\n                            if (!obj || obj.tagName.toLowerCase() != cmdName) {\n                                range.removeInlineStyle(['sub', 'sup']);\n                            }\n                        }\n                        obj ? range.removeInlineStyle(tagNames) : range.applyInlineStyle(tagNames[0]);\n                    }\n                    range.select();\n                },\n                queryCommandState: function() {\n                    return getObj(this, tagNames) ? 1 : 0;\n                }\n            };\n        })(style, basestyles[style]);\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/baseFont.js","var domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\n\nvar getContent = require('editor/utils/getContent');\n\nUE.plugins['justify'] = function() {\n    var me = this,\n        block = domUtils.isBlockElm,\n        defaultValue = {\n            left: 1,\n            right: 1,\n            center: 1,\n            justify: 1\n        },\n        doJustify = function(range, style) {\n            var bookmark = range.createBookmark(),\n                filterFn = function(node) {\n                    return node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' && !domUtils.isBookmarkNode(node) : !domUtils.isWhitespace(node);\n                };\n\n            range.enlarge(true);\n            var bookmark2 = range.createBookmark(),\n                current = domUtils.getNextDomNode(bookmark2.start, false, filterFn),\n                tmpRange = range.cloneRange(),\n                tmpNode;\n            while (current && !(domUtils.getPosition(current, bookmark2.end) & domUtils.POSITION_FOLLOWING)) {\n                if (current.nodeType == 3 || !block(current)) {\n                    tmpRange.setStartBefore(current);\n                    while (current && current !== bookmark2.end && !block(current)) {\n                        tmpNode = current;\n                        current = domUtils.getNextDomNode(current, false, null, function(node) {\n                            return !block(node);\n                        });\n                    }\n                    tmpRange.setEndAfter(tmpNode);\n                    var common = tmpRange.getCommonAncestor();\n                    if (!domUtils.isBody(common) && block(common)) {\n                        domUtils.setStyles(common, utils.isString(style) ? {\n                            'text-align': style\n                        } : style);\n                        current = common;\n                    } else {\n                        var p = range.document.createElement('p');\n                        domUtils.setStyles(p, utils.isString(style) ? {\n                            'text-align': style\n                        } : style);\n                        var frag = tmpRange.extractContents();\n                        p.appendChild(frag);\n                        tmpRange.insertNode(p);\n                        current = p;\n                    }\n                    current = domUtils.getNextDomNode(current, false, filterFn);\n                } else {\n                    current = domUtils.getNextDomNode(current, true, filterFn);\n                }\n            }\n            return range.moveToBookmark(bookmark2).moveToBookmark(bookmark);\n        };\n\n    UE.commands['justify'] = {\n        execCommand: function(cmdName, align) {\n            var range = this.selection.getRange(),\n                txt;\n\n            if (getContent(range).indexOf('gmp-ebox') != -1) {\n                return false;\n            }\n\n            //闭合时单独处理\n            if (range.collapsed) {\n                txt = this.document.createTextNode('p');\n                range.insertNode(txt);\n            }\n            doJustify(range, align);\n            if (txt) {\n                range.setStartBefore(txt).collapse(true);\n                domUtils.remove(txt);\n            }\n\n            range.select();\n\n            return true;\n        },\n        queryCommandValue: function() {\n            var startNode = this.selection.getStart(),\n                value = domUtils.getComputedStyle(startNode, 'text-align');\n            return defaultValue[value] ? value : 'left';\n        },\n        queryCommandState: function() {\n            var start = this.selection.getStart(),\n                cell = start && domUtils.findParentByTagName(start, [\"td\", \"th\", \"caption\"], true);\n\n            return cell ? -1 : 0;\n        }\n\n    };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/align.js","var domUtils = UE.dom.domUtils;\nvar utils = UE.utils;\nvar browser = UE.browser\nvar dtd = UE.dom.dtd;\nvar getContent = require('editor/utils/getContent');\nvar grepDom = 'gmp-ebox';\n\nUE.plugins['list'] = function() {\n    var me = this,\n        notExchange = {\n            'TD': 1,\n            'PRE': 1,\n            'BLOCKQUOTE': 1\n        };\n    var customStyle = {\n        'cn': 'cn-1-',\n        'cn1': 'cn-2-',\n        'cn2': 'cn-3-',\n        'num': 'num-1-',\n        'num1': 'num-2-',\n        'num2': 'num-3-',\n        'dash': 'dash',\n        'dot': 'dot'\n    };\n\n    me.setOpt({\n        'autoTransWordToList': false,\n        'insertorderedlist': {\n            'num': '',\n            'num1': '',\n            'num2': '',\n            'cn': '',\n            'cn1': '',\n            'cn2': '',\n            'decimal': '',\n            'lower-alpha': '',\n            'lower-roman': '',\n            'upper-alpha': '',\n            'upper-roman': ''\n        },\n        'insertunorderedlist': {\n            'circle': '',\n            'disc': '',\n            'square': '',\n            'dash': '',\n            'dot': ''\n        },\n        listDefaultPaddingLeft: '30',\n        listiconpath: 'http://bs.baidu.com/listicon/',\n        maxListLevel: -1, //-1不限制\n        disablePInList: false\n    });\n\n    function listToArray(list) {\n        var arr = [];\n        for (var p in list) {\n            arr.push(p)\n        }\n        return arr;\n    }\n    var listStyle = {\n        'OL': listToArray(me.options.insertorderedlist),\n        'UL': listToArray(me.options.insertunorderedlist)\n    };\n    var liiconpath = me.options.listiconpath;\n\n    //根据用户配置，调整customStyle\n    for (var s in customStyle) {\n        if (!me.options.insertorderedlist.hasOwnProperty(s) && !me.options.insertunorderedlist.hasOwnProperty(s)) {\n            delete customStyle[s];\n        }\n    }\n\n    me.ready(function() {\n        var customCss = [];\n        for (var p in customStyle) {\n            if (p == 'dash' || p == 'dot') {\n                customCss.push('li.list-' + customStyle[p] + '{background-image:url(' + liiconpath + customStyle[p] + '.gif)}');\n                customCss.push('ul.custom_' + p + '{list-style:none;}ul.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n            } else {\n                for (var i = 0; i < 99; i++) {\n                    customCss.push('li.list-' + customStyle[p] + i + '{background-image:url(' + liiconpath + 'list-' + customStyle[p] + i + '.gif)}')\n                }\n                customCss.push('ol.custom_' + p + '{list-style:none;}ol.custom_' + p + ' li{background-position:0 3px;background-repeat:no-repeat}');\n            }\n            switch (p) {\n                case 'cn':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n                    break;\n                case 'cn1':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:30px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:55px}');\n                    break;\n                case 'cn2':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:40px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:55px}');\n                    customCss.push('li.list-' + p + '-paddingleft-3{padding-left:68px}');\n                    break;\n                case 'num':\n                case 'num1':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:25px}');\n                    break;\n                case 'num2':\n                    customCss.push('li.list-' + p + '-paddingleft-1{padding-left:35px}');\n                    customCss.push('li.list-' + p + '-paddingleft-2{padding-left:40px}');\n                    break;\n                case 'dash':\n                    customCss.push('li.list-' + p + '-paddingleft{padding-left:35px}');\n                    break;\n                case 'dot':\n                    customCss.push('li.list-' + p + '-paddingleft{padding-left:20px}');\n            }\n        }\n        customCss.push('.list-paddingleft-1{padding-left:0}');\n        customCss.push('.list-paddingleft-2{padding-left:' + me.options.listDefaultPaddingLeft + 'px}');\n        customCss.push('.list-paddingleft-3{padding-left:' + me.options.listDefaultPaddingLeft * 2 + 'px}');\n        //如果不给宽度会在自定应样式里出现滚动条\n        utils.cssRule('list', 'ol,ul{margin:0;pading:0;' + (browser.ie ? '' : 'width:95%') + '}li{clear:both;}' + customCss.join('\\n'), me.document);\n    });\n    //单独处理剪切的问题\n    me.ready(function() {\n        domUtils.on(me.body, 'cut', function() {\n            setTimeout(function() {\n                var rng = me.selection.getRange(),\n                    li;\n                //trace:3416\n                if (!rng.collapsed) {\n                    if (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n                        if (!li.nextSibling && domUtils.isEmptyBlock(li)) {\n                            var pn = li.parentNode,\n                                node;\n                            if (node = pn.previousSibling) {\n                                domUtils.remove(pn);\n                                rng.setStartAtLast(node).collapse(true);\n                                rng.select(true);\n                            } else if (node = pn.nextSibling) {\n                                domUtils.remove(pn);\n                                rng.setStartAtFirst(node).collapse(true);\n                                rng.select(true);\n                            } else {\n                                var tmpNode = me.document.createElement('p');\n                                domUtils.fillNode(me.document, tmpNode);\n                                pn.parentNode.insertBefore(tmpNode, pn);\n                                domUtils.remove(pn);\n                                rng.setStart(tmpNode, 0).collapse(true);\n                                rng.select(true);\n                            }\n                        }\n                    }\n                }\n\n            })\n        })\n    });\n\n    function getStyle(node) {\n        var cls = node.className;\n        if (domUtils.hasClass(node, /custom_/)) {\n            return cls.match(/custom_(\\w+)/)[1]\n        }\n        return domUtils.getStyle(node, 'list-style-type')\n\n    }\n\n    me.addListener('beforepaste', function(type, html) {\n        var me = this,\n            rng = me.selection.getRange(),\n            li;\n        var root = UE.htmlparser(html.html, true);\n        if (li = domUtils.findParentByTagName(rng.startContainer, 'li', true)) {\n            var list = li.parentNode,\n                tagName = list.tagName == 'OL' ? 'ul' : 'ol';\n            utils.each(root.getNodesByTagName(tagName), function(n) {\n                n.tagName = list.tagName;\n                n.setAttr();\n                if (n.parentNode === root) {\n                    type = getStyle(list) || (list.tagName == 'OL' ? 'decimal' : 'disc')\n                } else {\n                    var className = n.parentNode.getAttr('class');\n                    if (className && /custom_/.test(className)) {\n                        type = className.match(/custom_(\\w+)/)[1]\n                    } else {\n                        type = n.parentNode.getStyle('list-style-type');\n                    }\n                    if (!type) {\n                        type = list.tagName == 'OL' ? 'decimal' : 'disc';\n                    }\n                }\n                var index = utils.indexOf(listStyle[list.tagName], type);\n                if (n.parentNode !== root)\n                    index = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n                var currentStyle = listStyle[list.tagName][index];\n                if (customStyle[currentStyle]) {\n                    n.setAttr('class', 'custom_' + currentStyle)\n\n                } else {\n                    n.setStyle('list-style-type', currentStyle)\n                }\n            })\n\n        }\n\n        html.html = root.toHtml();\n    });\n    //导出时，去掉p标签\n    me.getOpt('disablePInList') === true && me.addOutputRule(function(root) {\n        utils.each(root.getNodesByTagName('li'), function(li) {\n            var newChildrens = [],\n                index = 0;\n            utils.each(li.children, function(n) {\n                if (n.tagName == 'p') {\n                    var tmpNode;\n                    while (tmpNode = n.children.pop()) {\n                        newChildrens.splice(index, 0, tmpNode);\n                        tmpNode.parentNode = li;\n                        lastNode = tmpNode;\n                    }\n                    tmpNode = newChildrens[newChildrens.length - 1];\n                    if (!tmpNode || tmpNode.type != 'element' || tmpNode.tagName != 'br') {\n                        var br = UE.uNode.createElement('br');\n                        br.parentNode = li;\n                        newChildrens.push(br);\n                    }\n\n                    index = newChildrens.length;\n                }\n            });\n            if (newChildrens.length) {\n                li.children = newChildrens;\n            }\n        });\n    });\n    //进入编辑器的li要套p标签\n    me.addInputRule(function(root) {\n        utils.each(root.getNodesByTagName('li'), function(li) {\n            var tmpP = UE.uNode.createElement('p');\n            for (var i = 0, ci; ci = li.children[i];) {\n                if (ci.type == 'text' || dtd.p[ci.tagName]) {\n                    tmpP.appendChild(ci);\n                } else {\n                    if (tmpP.firstChild()) {\n                        li.insertBefore(tmpP, ci);\n                        tmpP = UE.uNode.createElement('p');\n                        i = i + 2;\n                    } else {\n                        i++;\n                    }\n\n                }\n            }\n            if (tmpP.firstChild() && !tmpP.parentNode || !li.firstChild()) {\n                li.appendChild(tmpP);\n            }\n            //trace:3357\n            //p不能为空\n            if (!tmpP.firstChild()) {\n                tmpP.innerHTML(browser.ie ? '&nbsp;' : '<br/>')\n            }\n            //去掉末尾的空白\n            var p = li.firstChild();\n            var lastChild = p.lastChild();\n            if (lastChild && lastChild.type == 'text' && /^\\s*$/.test(lastChild.data)) {\n                p.removeChild(lastChild)\n            }\n        });\n        if (me.options.autoTransWordToList) {\n            var orderlisttype = {\n                    'num1': /^\\d+\\)/,\n                    'decimal': /^\\d+\\./,\n                    'lower-alpha': /^[a-z]+\\)/,\n                    'upper-alpha': /^[A-Z]+\\./,\n                    'cn': /^[\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+[\\u3001]/,\n                    'cn2': /^\\([\\u4E00\\u4E8C\\u4E09\\u56DB\\u516d\\u4e94\\u4e03\\u516b\\u4e5d]+\\)/\n                },\n                unorderlisttype = {\n                    'square': 'n'\n                };\n\n            function checkListType(content, container) {\n                var span = container.firstChild();\n                if (span && span.type == 'element' && span.tagName == 'span' && /Wingdings|Symbol/.test(span.getStyle('font-family'))) {\n                    for (var p in unorderlisttype) {\n                        if (unorderlisttype[p] == span.data) {\n                            return p\n                        }\n                    }\n                    return 'disc'\n                }\n                for (var p in orderlisttype) {\n                    if (orderlisttype[p].test(content)) {\n                        return p;\n                    }\n                }\n\n            }\n            utils.each(root.getNodesByTagName('p'), function(node) {\n                if (node.getAttr('class') != 'MsoListParagraph') {\n                    return\n                }\n\n                //word粘贴过来的会带有margin要去掉,但这样也可能会误命中一些央视\n                node.setStyle('margin', '');\n                node.setStyle('margin-left', '');\n                node.setAttr('class', '');\n\n                function appendLi(list, p, type) {\n                    if (list.tagName == 'ol') {\n                        if (browser.ie) {\n                            var first = p.firstChild();\n                            if (first.type == 'element' && first.tagName == 'span' && orderlisttype[type].test(first.innerText())) {\n                                p.removeChild(first);\n                            }\n                        } else {\n                            p.innerHTML(p.innerHTML().replace(orderlisttype[type], ''));\n                        }\n                    } else {\n                        p.removeChild(p.firstChild())\n                    }\n\n                    var li = UE.uNode.createElement('li');\n                    li.appendChild(p);\n                    list.appendChild(li);\n                }\n                var tmp = node,\n                    type, cacheNode = node;\n\n                if (node.parentNode.tagName != 'li' && (type = checkListType(node.innerText(), node))) {\n\n                    var list = UE.uNode.createElement(me.options.insertorderedlist.hasOwnProperty(type) ? 'ol' : 'ul');\n                    if (customStyle[type]) {\n                        list.setAttr('class', 'custom_' + type)\n                    } else {\n                        list.setStyle('list-style-type', type)\n                    }\n                    while (node && node.parentNode.tagName != 'li' && checkListType(node.innerText(), node)) {\n                        tmp = node.nextSibling();\n                        if (!tmp) {\n                            node.parentNode.insertBefore(list, node)\n                        }\n                        appendLi(list, node, type);\n                        node = tmp;\n                    }\n                    if (!list.parentNode && node && node.parentNode) {\n                        node.parentNode.insertBefore(list, node)\n                    }\n                }\n                var span = cacheNode.firstChild();\n                if (span && span.type == 'element' && span.tagName == 'span' && /^\\s*(&nbsp;)+\\s*$/.test(span.innerText())) {\n                    span.parentNode.removeChild(span)\n                }\n            })\n        }\n\n    });\n\n    //调整索引标签\n    me.addListener('contentchange', function() {\n        adjustListStyle(me.document)\n    });\n\n    function adjustListStyle(doc, ignore) {\n        utils.each(domUtils.getElementsByTagName(doc, 'ol ul'), function(node) {\n\n            if (!domUtils.inDoc(node, doc))\n                return;\n\n            var parent = node.parentNode;\n            if (parent.tagName == node.tagName) {\n                var nodeStyleType = getStyle(node) || (node.tagName == 'OL' ? 'decimal' : 'disc'),\n                    parentStyleType = getStyle(parent) || (parent.tagName == 'OL' ? 'decimal' : 'disc');\n                if (nodeStyleType == parentStyleType) {\n                    var styleIndex = utils.indexOf(listStyle[node.tagName], nodeStyleType);\n                    styleIndex = styleIndex + 1 == listStyle[node.tagName].length ? 0 : styleIndex + 1;\n                    setListStyle(node, listStyle[node.tagName][styleIndex])\n                }\n\n            }\n            var index = 0,\n                type = 2;\n            if (domUtils.hasClass(node, /custom_/)) {\n                if (!(/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/))) {\n                    type = 1;\n                }\n            } else {\n                if (/[ou]l/i.test(parent.tagName) && domUtils.hasClass(parent, /custom_/)) {\n                    type = 3;\n                }\n            }\n\n            var style = domUtils.getStyle(node, 'list-style-type');\n            style && (node.style.cssText = 'list-style-type:' + style);\n            node.className = utils.trim(node.className.replace(/list-paddingleft-\\w+/, '')) + ' list-paddingleft-' + type;\n            utils.each(domUtils.getElementsByTagName(node, 'li'), function(li) {\n                li.style.cssText && (li.style.cssText = '');\n                if (!li.firstChild) {\n                    domUtils.remove(li);\n                    return;\n                }\n                if (li.parentNode !== node) {\n                    return;\n                }\n                index++;\n                if (domUtils.hasClass(node, /custom_/)) {\n                    var paddingLeft = 1,\n                        currentStyle = getStyle(node);\n                    if (node.tagName == 'OL') {\n                        if (currentStyle) {\n                            switch (currentStyle) {\n                                case 'cn':\n                                case 'cn1':\n                                case 'cn2':\n                                    if (index > 10 && (index % 10 == 0 || index > 10 && index < 20)) {\n                                        paddingLeft = 2\n                                    } else if (index > 20) {\n                                        paddingLeft = 3\n                                    }\n                                    break;\n                                case 'num2':\n                                    if (index > 9) {\n                                        paddingLeft = 2\n                                    }\n                            }\n                        }\n                        li.className = 'list-' + customStyle[currentStyle] + index + ' ' + 'list-' + currentStyle + '-paddingleft-' + paddingLeft;\n                    } else {\n                        li.className = 'list-' + customStyle[currentStyle] + ' ' + 'list-' + currentStyle + '-paddingleft';\n                    }\n                } else {\n                    li.className = li.className.replace(/list-[\\w\\-]+/gi, '');\n                }\n                var className = li.getAttribute('class');\n                if (className !== null && !className.replace(/\\s/g, '')) {\n                    domUtils.removeAttributes(li, 'class')\n                }\n            });\n            !ignore && adjustList(node, node.tagName.toLowerCase(), getStyle(node) || domUtils.getStyle(node, 'list-style-type'), true);\n        })\n    }\n\n    function adjustList(list, tag, style, ignoreEmpty) {\n        var nextList = list.nextSibling;\n        if (nextList && nextList.nodeType == 1 && nextList.tagName.toLowerCase() == tag && (getStyle(nextList) || domUtils.getStyle(nextList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n            domUtils.moveChild(nextList, list);\n            if (nextList.childNodes.length == 0) {\n                domUtils.remove(nextList);\n            }\n        }\n        if (nextList && domUtils.isFillChar(nextList)) {\n            domUtils.remove(nextList);\n        }\n        var preList = list.previousSibling;\n        if (preList && preList.nodeType == 1 && preList.tagName.toLowerCase() == tag && (getStyle(preList) || domUtils.getStyle(preList, 'list-style-type') || (tag == 'ol' ? 'decimal' : 'disc')) == style) {\n            domUtils.moveChild(list, preList);\n        }\n        if (preList && domUtils.isFillChar(preList)) {\n            domUtils.remove(preList);\n        }!ignoreEmpty && domUtils.isEmptyBlock(list) && domUtils.remove(list);\n        if (getStyle(list)) {\n            adjustListStyle(list.ownerDocument, true)\n        }\n    }\n\n    function setListStyle(list, style) {\n        if (customStyle[style]) {\n            list.className = 'custom_' + style;\n        }\n        try {\n            domUtils.setStyle(list, 'list-style-type', style);\n        } catch (e) {}\n    }\n\n    function clearEmptySibling(node) {\n        var tmpNode = node.previousSibling;\n        if (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n            domUtils.remove(tmpNode);\n        }\n        tmpNode = node.nextSibling;\n        if (tmpNode && domUtils.isEmptyBlock(tmpNode)) {\n            domUtils.remove(tmpNode);\n        }\n    }\n\n    me.addListener('keydown', function(type, evt) {\n        function preventAndSave() {\n            evt.preventDefault ? evt.preventDefault() : (evt.returnValue = false);\n            me.fireEvent('contentchange');\n            me.undoManger && me.undoManger.save();\n        }\n\n        function findList(node, filterFn) {\n            while (node && !domUtils.isBody(node)) {\n                if (filterFn(node)) {\n                    return null\n                }\n                if (node.nodeType == 1 && /[ou]l/i.test(node.tagName)) {\n                    return node;\n                }\n                node = node.parentNode;\n            }\n            return null;\n        }\n        var keyCode = evt.keyCode || evt.which;\n        if (keyCode == 13 && !evt.shiftKey) { //回车\n            var rng = me.selection.getRange(),\n                parent = domUtils.findParent(rng.startContainer, function(node) {\n                    return domUtils.isBlockElm(node)\n                }, true),\n                li = domUtils.findParentByTagName(rng.startContainer, 'li', true);\n            if (parent && parent.tagName != 'PRE' && !li) {\n                var html = parent.innerHTML.replace(new RegExp(domUtils.fillChar, 'g'), '');\n                if (/^\\s*1\\s*\\.[^\\d]/.test(html)) {\n                    parent.innerHTML = html.replace(/^\\s*1\\s*\\./, '');\n                    rng.setStartAtLast(parent).collapse(true).select();\n                    me.__hasEnterExecCommand = true;\n                    me.execCommand('insertorderedlist');\n                    me.__hasEnterExecCommand = false;\n                }\n            }\n            var range = me.selection.getRange(),\n                start = findList(range.startContainer, function(node) {\n                    return node.tagName == 'TABLE';\n                }),\n                end = range.collapsed ? start : findList(range.endContainer, function(node) {\n                    return node.tagName == 'TABLE';\n                });\n\n            if (start && end && start === end) {\n\n                if (!range.collapsed) {\n                    start = domUtils.findParentByTagName(range.startContainer, 'li', true);\n                    end = domUtils.findParentByTagName(range.endContainer, 'li', true);\n                    if (start && end && start === end) {\n                        range.deleteContents();\n                        li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n                        if (li && domUtils.isEmptyBlock(li)) {\n\n                            pre = li.previousSibling;\n                            next = li.nextSibling;\n                            p = me.document.createElement('p');\n\n                            domUtils.fillNode(me.document, p);\n                            parentList = li.parentNode;\n                            if (pre && next) {\n                                range.setStart(next, 0).collapse(true).select(true);\n                                domUtils.remove(li);\n\n                            } else {\n                                if (!pre && !next || !pre) {\n\n                                    parentList.parentNode.insertBefore(p, parentList);\n\n                                } else {\n                                    li.parentNode.parentNode.insertBefore(p, parentList.nextSibling);\n                                }\n                                domUtils.remove(li);\n                                if (!parentList.firstChild) {\n                                    domUtils.remove(parentList);\n                                }\n                                range.setStart(p, 0).setCursor();\n\n                            }\n                            preventAndSave();\n                            return;\n\n                        }\n                    } else {\n                        var tmpRange = range.cloneRange(),\n                            bk = tmpRange.collapse(false).createBookmark();\n\n                        range.deleteContents();\n                        tmpRange.moveToBookmark(bk);\n                        var li = domUtils.findParentByTagName(tmpRange.startContainer, 'li', true);\n\n                        clearEmptySibling(li);\n                        tmpRange.select();\n                        preventAndSave();\n                        return;\n                    }\n                }\n\n                li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n\n                if (li) {\n                    if (domUtils.isEmptyBlock(li)) {\n                        bk = range.createBookmark();\n                        var parentList = li.parentNode;\n                        if (li !== parentList.lastChild) {\n                            domUtils.breakParent(li, parentList);\n                            clearEmptySibling(li);\n                        } else {\n\n                            parentList.parentNode.insertBefore(li, parentList.nextSibling);\n                            if (domUtils.isEmptyNode(parentList)) {\n                                domUtils.remove(parentList);\n                            }\n                        }\n                        //嵌套不处理\n                        if (!dtd.$list[li.parentNode.tagName]) {\n\n                            if (!domUtils.isBlockElm(li.firstChild)) {\n                                p = me.document.createElement('p');\n                                li.parentNode.insertBefore(p, li);\n                                while (li.firstChild) {\n                                    p.appendChild(li.firstChild);\n                                }\n                                domUtils.remove(li);\n                            } else {\n                                domUtils.remove(li, true);\n                            }\n                        }\n                        range.moveToBookmark(bk).select();\n\n                    } else {\n                        var first = li.firstChild;\n                        if (!first || !domUtils.isBlockElm(first)) {\n                            var p = me.document.createElement('p');\n\n                            !li.firstChild && domUtils.fillNode(me.document, p);\n                            while (li.firstChild) {\n\n                                p.appendChild(li.firstChild);\n                            }\n                            li.appendChild(p);\n                            first = p;\n                        }\n\n                        var span = me.document.createElement('span');\n\n                        range.insertNode(span);\n                        domUtils.breakParent(span, li);\n\n                        var nextLi = span.nextSibling;\n                        first = nextLi.firstChild;\n\n                        if (!first) {\n                            p = me.document.createElement('p');\n\n                            domUtils.fillNode(me.document, p);\n                            nextLi.appendChild(p);\n                            first = p;\n                        }\n                        if (domUtils.isEmptyNode(first)) {\n                            first.innerHTML = '';\n                            domUtils.fillNode(me.document, first);\n                        }\n\n                        range.setStart(first, 0).collapse(true).shrinkBoundary().select();\n                        domUtils.remove(span);\n                        var pre = nextLi.previousSibling;\n                        if (pre && domUtils.isEmptyBlock(pre)) {\n                            pre.innerHTML = '<p></p>';\n                            domUtils.fillNode(me.document, pre.firstChild);\n                        }\n\n                    }\n                    //                        }\n                    preventAndSave();\n                }\n\n            }\n\n        }\n        if (keyCode == 8) {\n            //修中ie中li下的问题\n            range = me.selection.getRange();\n            if (range.collapsed && domUtils.isStartInblock(range)) {\n                tmpRange = range.cloneRange().trimBoundary();\n                li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n                //要在li的最左边，才能处理\n                if (li && domUtils.isStartInblock(tmpRange)) {\n                    start = domUtils.findParentByTagName(range.startContainer, 'p', true);\n                    if (start && start !== li.firstChild) {\n                        var parentList = domUtils.findParentByTagName(start, ['ol', 'ul']);\n                        domUtils.breakParent(start, parentList);\n                        clearEmptySibling(start);\n                        me.fireEvent('contentchange');\n                        range.setStart(start, 0).setCursor(false, true);\n                        me.fireEvent('saveScene');\n                        domUtils.preventDefault(evt);\n                        return;\n                    }\n\n                    if (li && (pre = li.previousSibling)) {\n                        if (keyCode == 46 && li.childNodes.length) {\n                            return;\n                        }\n                        //有可能上边的兄弟节点是个2级菜单，要追加到2级菜单的最后的li\n                        if (dtd.$list[pre.tagName]) {\n                            pre = pre.lastChild;\n                        }\n                        me.undoManger && me.undoManger.save();\n                        first = li.firstChild;\n                        if (domUtils.isBlockElm(first)) {\n                            if (domUtils.isEmptyNode(first)) {\n                                //                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n                                pre.appendChild(first);\n                                range.setStart(first, 0).setCursor(false, true);\n                                //first不是唯一的节点\n                                while (li.firstChild) {\n                                    pre.appendChild(li.firstChild);\n                                }\n                            } else {\n\n                                span = me.document.createElement('span');\n                                range.insertNode(span);\n                                //判断pre是否是空的节点,如果是<p><br/></p>类型的空节点，干掉p标签防止它占位\n                                if (domUtils.isEmptyBlock(pre)) {\n                                    pre.innerHTML = '';\n                                }\n                                domUtils.moveChild(li, pre);\n                                range.setStartBefore(span).collapse(true).select(true);\n\n                                domUtils.remove(span);\n\n                            }\n                        } else {\n                            if (domUtils.isEmptyNode(li)) {\n                                var p = me.document.createElement('p');\n                                pre.appendChild(p);\n                                range.setStart(p, 0).setCursor();\n                                //                                    range.setEnd(pre, pre.childNodes.length).shrinkBoundary().collapse().select(true);\n                            } else {\n                                range.setEnd(pre, pre.childNodes.length).collapse().select(true);\n                                while (li.firstChild) {\n                                    pre.appendChild(li.firstChild);\n                                }\n                            }\n                        }\n                        domUtils.remove(li);\n                        me.fireEvent('contentchange');\n                        me.fireEvent('saveScene');\n                        domUtils.preventDefault(evt);\n                        return;\n\n                    }\n                    //trace:980\n\n                    if (li && !li.previousSibling) {\n                        var parentList = li.parentNode;\n                        var bk = range.createBookmark();\n                        if (domUtils.isTagNode(parentList.parentNode, 'ol ul')) {\n                            parentList.parentNode.insertBefore(li, parentList);\n                            if (domUtils.isEmptyNode(parentList)) {\n                                domUtils.remove(parentList)\n                            }\n                        } else {\n\n                            while (li.firstChild) {\n                                parentList.parentNode.insertBefore(li.firstChild, parentList);\n                            }\n\n                            domUtils.remove(li);\n                            if (domUtils.isEmptyNode(parentList)) {\n                                domUtils.remove(parentList)\n                            }\n\n                        }\n                        range.moveToBookmark(bk).setCursor(false, true);\n                        me.fireEvent('contentchange');\n                        me.fireEvent('saveScene');\n                        domUtils.preventDefault(evt);\n                        return;\n\n                    }\n\n                }\n\n            }\n\n        }\n    });\n\n    me.addListener('keyup', function(type, evt) {\n        var keyCode = evt.keyCode || evt.which;\n        if (keyCode == 8) {\n            var rng = me.selection.getRange(),\n                list;\n            if (list = domUtils.findParentByTagName(rng.startContainer, ['ol', 'ul'], true)) {\n                adjustList(list, list.tagName.toLowerCase(), getStyle(list) || domUtils.getComputedStyle(list, 'list-style-type'), true)\n            }\n        }\n    });\n    //处理tab键\n    me.addListener('tabkeydown', function() {\n\n        var range = me.selection.getRange();\n\n        //控制级数\n        function checkLevel(li) {\n            if (me.options.maxListLevel != -1) {\n                var level = li.parentNode,\n                    levelNum = 0;\n                while (/[ou]l/i.test(level.tagName)) {\n                    levelNum++;\n                    level = level.parentNode;\n                }\n                if (levelNum >= me.options.maxListLevel) {\n                    return true;\n                }\n            }\n        }\n        //只以开始为准\n        //todo 后续改进\n        var li = domUtils.findParentByTagName(range.startContainer, 'li', true);\n        if (li) {\n\n            var bk;\n            if (range.collapsed) {\n                if (checkLevel(li))\n                    return true;\n                var parentLi = li.parentNode,\n                    list = me.document.createElement(parentLi.tagName),\n                    index = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n                index = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n                var currentStyle = listStyle[list.tagName][index];\n                setListStyle(list, currentStyle);\n                if (domUtils.isStartInblock(range)) {\n                    me.fireEvent('saveScene');\n                    bk = range.createBookmark();\n                    parentLi.insertBefore(list, li);\n                    list.appendChild(li);\n                    adjustList(list, list.tagName.toLowerCase(), currentStyle);\n                    me.fireEvent('contentchange');\n                    range.moveToBookmark(bk).select(true);\n                    return true;\n                }\n            } else {\n                me.fireEvent('saveScene');\n                bk = range.createBookmark();\n                for (var i = 0, closeList, parents = domUtils.findParents(li), ci; ci = parents[i++];) {\n                    if (domUtils.isTagNode(ci, 'ol ul')) {\n                        closeList = ci;\n                        break;\n                    }\n                }\n                var current = li;\n                if (bk.end) {\n                    while (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n                        if (checkLevel(current)) {\n                            current = domUtils.getNextDomNode(current, false, null, function(node) {\n                                return node !== closeList\n                            });\n                            continue;\n                        }\n                        var parentLi = current.parentNode,\n                            list = me.document.createElement(parentLi.tagName),\n                            index = utils.indexOf(listStyle[list.tagName], getStyle(parentLi) || domUtils.getComputedStyle(parentLi, 'list-style-type'));\n                        var currentIndex = index + 1 == listStyle[list.tagName].length ? 0 : index + 1;\n                        var currentStyle = listStyle[list.tagName][currentIndex];\n                        setListStyle(list, currentStyle);\n                        parentLi.insertBefore(list, current);\n                        while (current && !(domUtils.getPosition(current, bk.end) & domUtils.POSITION_FOLLOWING)) {\n                            li = current.nextSibling;\n                            list.appendChild(current);\n                            if (!li || domUtils.isTagNode(li, 'ol ul')) {\n                                if (li) {\n                                    while (li = li.firstChild) {\n                                        if (li.tagName == 'LI') {\n                                            break;\n                                        }\n                                    }\n                                } else {\n                                    li = domUtils.getNextDomNode(current, false, null, function(node) {\n                                        return node !== closeList\n                                    });\n                                }\n                                break;\n                            }\n                            current = li;\n                        }\n                        adjustList(list, list.tagName.toLowerCase(), currentStyle);\n                        current = li;\n                    }\n                }\n                me.fireEvent('contentchange');\n                range.moveToBookmark(bk).select();\n                return true;\n            }\n        }\n\n    });\n\n    function getLi(start) {\n        while (start && !domUtils.isBody(start)) {\n            if (start.nodeName == 'TABLE') {\n                return null;\n            }\n            if (start.nodeName == 'LI') {\n                return start\n            }\n            start = start.parentNode;\n        }\n    }\n\n    /**\n     * 有序列表，与“insertunorderedlist”命令互斥\n     * @command insertorderedlist\n     * @method execCommand\n     * @param { String } command 命令字符串\n     * @param { String } style 插入的有序列表类型，值为：decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n     * @example\n     * ```javascript\n     * editor.execCommand( 'insertorderedlist','decimal');\n     * ```\n     */\n    /**\n     * 查询当前选区内容是否有序列表\n     * @command insertorderedlist\n     * @method queryCommandState\n     * @param { String } cmd 命令字符串\n     * @return { int } 如果当前选区是有序列表返回1，否则返回0\n     * @example\n     * ```javascript\n     * editor.queryCommandState( 'insertorderedlist' );\n     * ```\n     */\n    /**\n     * 查询当前选区内容是否有序列表\n     * @command insertorderedlist\n     * @method queryCommandValue\n     * @param { String } cmd 命令字符串\n     * @return { String } 返回当前有序列表的类型，值为null或decimal,lower-alpha,lower-roman,upper-alpha,upper-roman,cn,cn1,cn2,num,num1,num2\n     * @example\n     * ```javascript\n     * editor.queryCommandValue( 'insertorderedlist' );\n     * ```\n     */\n\n    /**\n     * 无序列表，与“insertorderedlist”命令互斥\n     * @command insertunorderedlist\n     * @method execCommand\n     * @param { String } command 命令字符串\n     * @param { String } style 插入的无序列表类型，值为：circle,disc,square,dash,dot\n     * @example\n     * ```javascript\n     * editor.execCommand( 'insertunorderedlist','circle');\n     * ```\n     */\n    /**\n     * 查询当前是否有word文档粘贴进来的图片\n     * @command insertunorderedlist\n     * @method insertunorderedlist\n     * @param { String } command 命令字符串\n     * @return { int } 如果当前选区是无序列表返回1，否则返回0\n     * @example\n     * ```javascript\n     * editor.queryCommandState( 'insertunorderedlist' );\n     * ```\n     */\n    /**\n     * 查询当前选区内容是否有序列表\n     * @command insertunorderedlist\n     * @method queryCommandValue\n     * @param { String } command 命令字符串\n     * @return { String } 返回当前无序列表的类型，值为null或circle,disc,square,dash,dot\n     * @example\n     * ```javascript\n     * editor.queryCommandValue( 'insertunorderedlist' );\n     * ```\n     */\n\n    me.commands['insertorderedlist'] =\n        me.commands['insertunorderedlist'] = {\n            execCommand: function(command, style) {\n\n                if (!style) {\n                    style = command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc';\n                }\n                var me = this,\n                    range = this.selection.getRange(),\n                    filterFn = function(node) {\n                        return node.nodeType == 1 ? node.tagName.toLowerCase() != 'br' : !domUtils.isWhitespace(node);\n                    },\n                    tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul',\n                    frag = me.document.createDocumentFragment();\n                //去掉是因为会出现选到末尾，导致adjustmentBoundary缩到ol/ul的位置\n                //range.shrinkBoundary();//.adjustmentBoundary();\n\n                if (getContent(range).indexOf(grepDom) != -1) {\n                    return false;\n                }\n                range.adjustmentBoundary().shrinkBoundary();\n                var bko = range.createBookmark(true),\n                    start = getLi(me.document.getElementById(bko.start)),\n                    modifyStart = 0,\n                    end = getLi(me.document.getElementById(bko.end)),\n                    modifyEnd = 0,\n                    startParent, endParent,\n                    list, tmp;\n\n                if (start || end) {\n                    start && (startParent = start.parentNode);\n                    if (!bko.end) {\n                        end = start;\n                    }\n                    end && (endParent = end.parentNode);\n\n                    if (startParent === endParent) {\n                        while (start !== end) {\n                            tmp = start;\n                            start = start.nextSibling;\n                            if (!domUtils.isBlockElm(tmp.firstChild)) {\n                                var p = me.document.createElement('p');\n                                while (tmp.firstChild) {\n                                    p.appendChild(tmp.firstChild);\n                                }\n                                tmp.appendChild(p);\n                            }\n                            frag.appendChild(tmp);\n                        }\n                        tmp = me.document.createElement('span');\n                        startParent.insertBefore(tmp, end);\n                        if (!domUtils.isBlockElm(end.firstChild)) {\n                            p = me.document.createElement('p');\n                            while (end.firstChild) {\n                                p.appendChild(end.firstChild);\n                            }\n                            end.appendChild(p);\n                        }\n                        frag.appendChild(end);\n                        domUtils.breakParent(tmp, startParent);\n                        if (domUtils.isEmptyNode(tmp.previousSibling)) {\n                            domUtils.remove(tmp.previousSibling);\n                        }\n                        if (domUtils.isEmptyNode(tmp.nextSibling)) {\n                            domUtils.remove(tmp.nextSibling)\n                        }\n                        var nodeStyle = getStyle(startParent) || domUtils.getComputedStyle(startParent, 'list-style-type') || (command.toLowerCase() == 'insertorderedlist' ? 'decimal' : 'disc');\n                        if (startParent.tagName.toLowerCase() == tag && nodeStyle == style) {\n                            for (var i = 0, ci, tmpFrag = me.document.createDocumentFragment(); ci = frag.firstChild;) {\n                                if (domUtils.isTagNode(ci, 'ol ul')) {\n                                    //                                  删除时，子列表不处理\n                                    //                                  utils.each(domUtils.getElementsByTagName(ci,'li'),function(li){\n                                    //                                        while(li.firstChild){\n                                    //                                            tmpFrag.appendChild(li.firstChild);\n                                    //                                        }\n                                    //\n                                    //                                    });\n                                    tmpFrag.appendChild(ci);\n                                } else {\n                                    while (ci.firstChild) {\n\n                                        tmpFrag.appendChild(ci.firstChild);\n                                        domUtils.remove(ci);\n                                    }\n                                }\n\n                            }\n                            tmp.parentNode.insertBefore(tmpFrag, tmp);\n                        } else {\n                            list = me.document.createElement(tag);\n                            setListStyle(list, style);\n                            list.appendChild(frag);\n                            tmp.parentNode.insertBefore(list, tmp);\n                        }\n\n                        domUtils.remove(tmp);\n                        list && adjustList(list, tag, style);\n                        range.moveToBookmark(bko).select();\n                        return;\n                    }\n                    //开始\n                    if (start) {\n                        while (start) {\n                            tmp = start.nextSibling;\n                            if (domUtils.isTagNode(start, 'ol ul')) {\n                                frag.appendChild(start);\n                            } else {\n                                var tmpfrag = me.document.createDocumentFragment(),\n                                    hasBlock = 0;\n                                while (start.firstChild) {\n                                    if (domUtils.isBlockElm(start.firstChild)) {\n                                        hasBlock = 1;\n                                    }\n                                    tmpfrag.appendChild(start.firstChild);\n                                }\n                                if (!hasBlock) {\n                                    var tmpP = me.document.createElement('p');\n                                    tmpP.appendChild(tmpfrag);\n                                    frag.appendChild(tmpP);\n                                } else {\n                                    frag.appendChild(tmpfrag);\n                                }\n                                domUtils.remove(start);\n                            }\n\n                            start = tmp;\n                        }\n                        startParent.parentNode.insertBefore(frag, startParent.nextSibling);\n                        if (domUtils.isEmptyNode(startParent)) {\n                            range.setStartBefore(startParent);\n                            domUtils.remove(startParent);\n                        } else {\n                            range.setStartAfter(startParent);\n                        }\n                        modifyStart = 1;\n                    }\n\n                    if (end && domUtils.inDoc(endParent, me.document)) {\n                        //结束\n                        start = endParent.firstChild;\n                        while (start && start !== end) {\n                            tmp = start.nextSibling;\n                            if (domUtils.isTagNode(start, 'ol ul')) {\n                                frag.appendChild(start);\n                            } else {\n                                tmpfrag = me.document.createDocumentFragment();\n                                hasBlock = 0;\n                                while (start.firstChild) {\n                                    if (domUtils.isBlockElm(start.firstChild)) {\n                                        hasBlock = 1;\n                                    }\n                                    tmpfrag.appendChild(start.firstChild);\n                                }\n                                if (!hasBlock) {\n                                    tmpP = me.document.createElement('p');\n                                    tmpP.appendChild(tmpfrag);\n                                    frag.appendChild(tmpP);\n                                } else {\n                                    frag.appendChild(tmpfrag);\n                                }\n                                domUtils.remove(start);\n                            }\n                            start = tmp;\n                        }\n                        var tmpDiv = domUtils.createElement(me.document, 'div', {\n                            'tmpDiv': 1\n                        });\n                        domUtils.moveChild(end, tmpDiv);\n\n                        frag.appendChild(tmpDiv);\n                        domUtils.remove(end);\n                        endParent.parentNode.insertBefore(frag, endParent);\n                        range.setEndBefore(endParent);\n                        if (domUtils.isEmptyNode(endParent)) {\n                            domUtils.remove(endParent);\n                        }\n\n                        modifyEnd = 1;\n                    }\n\n                }\n\n                if (!modifyStart) {\n                    range.setStartBefore(me.document.getElementById(bko.start));\n                }\n                if (bko.end && !modifyEnd) {\n                    range.setEndAfter(me.document.getElementById(bko.end));\n                }\n                range.enlarge(true, function(node) {\n                    return notExchange[node.tagName];\n                });\n\n                frag = me.document.createDocumentFragment();\n\n                var bk = range.createBookmark(),\n                    current = domUtils.getNextDomNode(bk.start, false, filterFn),\n                    tmpRange = range.cloneRange(),\n                    tmpNode,\n                    block = domUtils.isBlockElm;\n\n                while (current && current !== bk.end && (domUtils.getPosition(current, bk.end) & domUtils.POSITION_PRECEDING)) {\n\n                    if (current.nodeType == 3 || dtd.li[current.tagName]) {\n                        if (current.nodeType == 1 && dtd.$list[current.tagName]) {\n                            while (current.firstChild) {\n                                frag.appendChild(current.firstChild);\n                            }\n                            tmpNode = domUtils.getNextDomNode(current, false, filterFn);\n                            domUtils.remove(current);\n                            current = tmpNode;\n                            continue;\n\n                        }\n                        tmpNode = current;\n                        tmpRange.setStartBefore(current);\n\n                        while (current && current !== bk.end && (!block(current) || domUtils.isBookmarkNode(current))) {\n                            tmpNode = current;\n                            current = domUtils.getNextDomNode(current, false, null, function(node) {\n                                return !notExchange[node.tagName];\n                            });\n                        }\n\n                        if (current && block(current)) {\n                            tmp = domUtils.getNextDomNode(tmpNode, false, filterFn);\n                            if (tmp && domUtils.isBookmarkNode(tmp)) {\n                                current = domUtils.getNextDomNode(tmp, false, filterFn);\n                                tmpNode = tmp;\n                            }\n                        }\n                        tmpRange.setEndAfter(tmpNode);\n\n                        current = domUtils.getNextDomNode(tmpNode, false, filterFn);\n\n                        var li = range.document.createElement('li');\n\n                        li.appendChild(tmpRange.extractContents());\n                        if (domUtils.isEmptyNode(li)) {\n                            var tmpNode = range.document.createElement('p');\n                            while (li.firstChild) {\n                                tmpNode.appendChild(li.firstChild)\n                            }\n                            li.appendChild(tmpNode);\n                        }\n                        frag.appendChild(li);\n                    } else {\n                        current = domUtils.getNextDomNode(current, true, filterFn);\n                    }\n                }\n                range.moveToBookmark(bk).collapse(true);\n                list = me.document.createElement(tag);\n                setListStyle(list, style);\n                list.appendChild(frag);\n                range.insertNode(list);\n                //当前list上下看能否合并\n                adjustList(list, tag, style);\n                //去掉冗余的tmpDiv\n                for (var i = 0, ci, tmpDivs = domUtils.getElementsByTagName(list, 'div'); ci = tmpDivs[i++];) {\n                    if (ci.getAttribute('tmpDiv')) {\n                        domUtils.remove(ci, true)\n                    }\n                }\n                range.moveToBookmark(bko).select();\n\n            },\n            queryCommandState: function(command) {\n                var tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n                var path = this.selection.getStartElementPath();\n                for (var i = 0, ci; ci = path[i++];) {\n                    if (ci.nodeName == 'TABLE') {\n                        return 0\n                    }\n                    if (tag == ci.nodeName.toLowerCase()) {\n                        return 1\n                    };\n                }\n                return 0;\n\n            },\n            queryCommandValue: function(command) {\n                var tag = command.toLowerCase() == 'insertorderedlist' ? 'ol' : 'ul';\n                var path = this.selection.getStartElementPath(),\n                    node;\n                for (var i = 0, ci; ci = path[i++];) {\n                    if (ci.nodeName == 'TABLE') {\n                        node = null;\n                        break;\n                    }\n                    if (tag == ci.nodeName.toLowerCase()) {\n                        node = ci;\n                        break;\n                    };\n                }\n                return node ? getStyle(node) || domUtils.getComputedStyle(node, 'list-style-type') : null;\n            }\n        };\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/toolbar/list.js","baidu.editor.ui.Button.prototype.getHtmlTpl = function() {\n\n    /* if (!this.iconEle) {\n\n         var str;\n         switch (this.title) {\n             case \"加粗\":\n                 str = \"B\";\n                 break;\n             case \"斜体\":\n                 str = \"I\"\n                 break;\n             case \"下划线\":\n                 str = \"U\"\n                 break;\n             case \"有序列表\":\n                 str = \"有\"\n                 break;\n             case \"无序列表\":\n                 str = \"无\";\n                 break;\n             case \"居左对齐\":\n                 str = \"左\"\n                 break;\n             case \"居中对齐\":\n                 str = \"中\"\n                 break;\n             case \"居右对齐\":\n                 str = \"右\"\n                 break;\n             default:\n                 str = \"测试\";\n         }\n         this.iconEle = \"<em>\" + str + \"</em>\";\n     }\n     return '<div id=\"##\" class=\"edui-box %%\">' +\n         '<div id=\"##_state\" stateful>' +\n         '<div class=\"%%-wrap\">' +\n         '<a id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n         ' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\" href=\"javascript:;\" data-node=\"toolbarBtn\">' +\n         (this.showIcon ? this.iconEle : '') +\n         (this.showText ? '<span>' + this.label + '</span>' : '') +\n         '</a>' +\n         '</div>' +\n         '</div></div>';*/\n\n    return '<div id=\"##\" class=\"edui-box %%\">' +\n        '<div id=\"##_state\" stateful>' +\n        '<div class=\"%%-wrap\">' +\n        '<div id=\"##_body\" unselectable=\"on\" ' + (this.title ? 'title=\"' + this.title + '\"' : '') +\n        ' class=\"%%-body\" onmousedown=\"return $$._onMouseDown(event, this);\" onclick=\"return $$._onClick(event, this);\">' +\n        (this.showIcon ? '<div class=\"edui-box edui-icon\"></div>' : '') +\n        /* (this.showText ? '<div class=\"edui-box edui-label\">' + this.label + '</div>' : '') +*/\n        '</div>' +\n        '</div>' +\n        '</div></div>';\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/buttonRules.js","var alert = require('module/popup/alert');\nvar config = require('editor/config');\n\nUE.commands['insertgoodshtml'] = {\n    execCommand: function(command, html, notNeedFilter) {\n        var me = this;\n        //限制商品数量\n        var limitNum = config.goodsLimitNUm;\n        var reg = /<div.*?gmp-ebox.*?>/gi;\n        //获取html的商品数\n        var innerGoods = html.match(reg),\n            innerGoodsLen = innerGoods ? innerGoods.length : 0;\n        //获取editor商品数\n        var ueGoods = me.getContent().match(reg),\n            outerGoodsLen = ueGoods ? ueGoods.length : 0;\n\n        if (innerGoodsLen + outerGoodsLen > limitNum) {\n            html = '';\n            alert('您最多能添加' + limitNum + '张图片哦！');\n            return;\n        }\n\n        me.execCommand('inserthtml', html, true);\n        return false;\n    }\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/insertGoods.js","var utils = baidu.editor.utils,\n    uiUtils = baidu.editor.ui.uiUtils,\n    domUtils = baidu.editor.dom.domUtils,\n    UIBase = baidu.editor.ui.UIBase;\nvar ANCHOR_CLASSES = ['edui-anchor-topright', 'edui-anchor-topright',\n    'edui-anchor-bottomleft', 'edui-anchor-bottomright'\n];\nbaidu.editor.ui.Popup.prototype.showAnchorRect = function(rect, hoz, adj) {\n    var width = this.anchorEl.width;\n    var height = this.anchorEl.height;\n    this._doAutoRender();\n    var vpRect = uiUtils.getViewportRect();\n    baidu.editor.ui.Button.prototype\n    this.getDom().style.visibility = 'hidden';\n    this._show();\n    var popSize = this.fitSize();\n    var sideLeft, sideUp, left, top;\n    if (hoz) {\n        sideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n        sideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n        left = (sideLeft ? rect.left - popSize.width : rect.right);\n        //top = (sideUp ? rect.bottom - popSize.height : rect.top);\n    } else {\n        sideLeft = this.canSideLeft && (rect.right + popSize.width > vpRect.right && rect.left > popSize.width);\n        sideUp = this.canSideUp && (rect.top + popSize.height > vpRect.bottom && rect.bottom > popSize.height);\n        left = (sideLeft ? rect.right - popSize.width : rect.left);\n        //top = (sideUp ? rect.top - popSize.height : rect.bottom);\n\n    }\n\n    var popEl = this.getDom();\n    var objs = {\n        left: left,\n        top: top\n    }\n    if (this.cutstomPosition) {\n        if(this.cutstomPosition == 'top-right'){\n            var popWidth = $(popEl).width()\n            objs = {\n                left: rect.right - popWidth,\n                top: rect.top\n            }\n        }else{\n            objs={\n                left:left,\n                top:rect.bottom\n            }\n        }\n        \n    }\n\n    uiUtils.setViewportOffset(popEl, objs);\n    domUtils.removeClasses(popEl, ANCHOR_CLASSES);\n    popEl.className += ' ' + ANCHOR_CLASSES[(sideUp ? 1 : 0) * 2 + (sideLeft ? 1 : 0)];\n    if (this.editor) {\n        popEl.style.zIndex = this.editor.container.style.zIndex * 1 + 10;\n        baidu.editor.ui.uiUtils.getFixedLayer().style.zIndex = popEl.style.zIndex - 1;\n    }\n    this.getDom().style.visibility = 'visible';\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/fixPopPosition.js","//require('./copy');\nrequire('./codemirror');\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ban/index.js","UE.plugins['source'] = function() {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/ban/codemirror.js","if (!Array.prototype.indexOf)\n{\n  Array.prototype.indexOf = function(elt /*, from*/)\n  {\n    var len = this.length >>> 0;\n\n    var from = Number(arguments[1]) || 0;\n    from = (from < 0)\n         ? Math.ceil(from)\n         : Math.floor(from);\n    if (from < 0)\n      from += len;\n\n    for (; from < len; from++)\n    {\n      if (from in this &&\n          this[from] === elt)\n        return from;\n    }\n    return -1;\n  };\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/indexOf.js","/**\n * [表情]\n * @Author: Fu Xiaochun\n * @Email: \tfuzhengchun@gomeplus.com\n */\nvar emojis = require('./emoji');\nvar backward = require('./backward');\nvar faceTpl = require('./face.tpl');\n\nvar emojiData = null;\n\n// 将表情转换成map\nvar emojiMap = {};\n\n// 数据适配转换\nvar makeData = function(data) {\n    var total = data.length;\n    var offset = 24;\n    var page = Math.ceil(total / offset);\n    var list = [];\n\n    for (var i = 0; i < page; i++) {\n        list[i] = [];\n        var end = offset * (i + 1);\n        end = end > total ? total : end;\n        for (var j = i * offset; j < end; j++) {\n            var emoji = data[j];\n            list[i].push(emoji);\n            emojiMap[emoji.name] = emoji.url;\n        }\n    }\n    emojiData = {\n        page: new Array(page),\n        list: list\n    };\n    return emojiData;\n};\n\nvar Face = function(opts) {\n    var foo = function() {};\n    this.$dom = null;\n    this.isShow = false;\n    this.onSelected = opts.onSelected || foo;\n};\n\nFace.prototype = {\n    constructor: Face,\n    _bindHtml: function() {\n        var data = emojiData || makeData(emojis);\n        var faceHTML = faceTpl(data);\n        this.$dom = $(faceHTML);\n    },\n    _bindEvent: function() {\n        var _this = this;\n\n        // tab方式显示所选页\n        var setShowIndex = function(index) {\n            var activeCls = 'active';\n            var hideCls = 'hide';\n            index = index || 0;\n\n            $('[data-action=facePage] > li').eq(index).addClass(activeCls).siblings('li').removeClass(activeCls);\n            $('[data-node=faceList] > div').eq(index).removeClass(hideCls).siblings('div').addClass(hideCls);\n        };\n\n        this.$dom.on('click.face', function(e) {\n            e.stopPropagation();\n        });\n        $(document).on('click.face', function() {\n            _this.hide();\n        });\n        // 分页切换显示\n        this.$dom.on('mouseenter', '[data-action=facePage] > li', function() {\n            var index = $(this).index();\n            setShowIndex(index);\n        });\n\n        this.$dom.on('click.face', '[data-face]', function() {\n            var $this = $(this);\n            var faceReg = $this.data('face');\n            var faceUrl = $this.attr('src');\n            _this.onSelected({\n                reg: faceReg,\n                url: faceUrl\n            });\n            _this.isShow !== false && _this.hide();\n            return false;\n        });\n    },\n    show: function(x, y) {\n        if (this.isShow) {\n            return;\n        }\n        this.$dom || this._bindHtml();\n        $('body').append(this.$dom);\n        this.$dom.css({\n            left: x + 'px',\n            top: y + 'px'\n        }).show();\n        this.isShow = true;\n        this._bindEvent();\n    },\n    hide: function() {\n        if (!this.isShow) {\n            return;\n        }\n        this.$dom.off('.face');\n        $(document).off('.face');\n        this.$dom.hide().remove();\n        this.isShow = false;\n    }\n};\n\n// 把表情占位符替换成img\nvar parseEmoji = function(str) {\n    var r = /(\\[([\\s\\S]+?)\\])/g;\n    if ($.isEmptyObject(emojiMap)) {\n        makeData(emojis);\n    }\n\n    return str.replace(r, function(s, $1, name) {\n        var img = emojiMap[name];\n        if (img) {\n            return '<img width=\"22\" height=\"22\" src=\"' + img + '\" />';\n        } else {\n            // 兼容旧版表情\n            var old = backward[name];\n            if (old) {\n                return '<img width=\"22\" height=\"22\" src=\"' + old.url + '\" />';\n            }\n            return s;\n        }\n    });\n};\n\nvar faceInstance = null;\nvar init = function(opts) {\n    if (!faceInstance) {\n        faceInstance = new Face(opts);\n    }\n    return faceInstance;\n};\nmodule.exports = {\n    init: init,\n    parseEmoji: parseEmoji\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/index.js","function goodsdMask(ue) {\n    var close = 0;\n\n    ue.addListener('selectionchange', function(editor) {\n        function hideMask() {\n            //var b = ue.body.getElementsByTagName('b');\n            $(ue.body).find(\".cover\").removeClass(\"show\")\n\n        }\n\n        //查找选区范围\n        var range = ue.selection.getRange();\n        //range.select();\n        var s = [].concat(ue.selection.getStartElementPath());\n\n        var len = s.length - 2;\n\n        if (len < 0) return;\n\n        s = s[len];\n\n        var tagName = s.tagName;\n        switch (tagName) {\n            case \"DIV\":\n                hideMask();\n                var $s = $(s);\n                var $el = $s.find(\".cover\");\n                var lenth = $el.length;\n\n                if (!lenth) {\n                    $s.append('<div class=\"cover show\">iii</div>');\n                    $s.attr('contenteditable', 'false');\n                } else {\n                    $el.addClass(\"show\");\n                }\n\n                close = 1;\n                var nextNode = s.nextSibling;\n                if (!nextNode) {\n                    var newNode = ue.createElement('p');\n                    var textNode = ue.createTextNode(text);\n                    newNode.appendChild(textNode);\n                    domUtils.insertAfter(s, newNode);\n                }\n                range.setStart(nextNode, 0).collapse(true).setCursor();\n\n                break;\n            case \"P\":\n                if (close == 0) return;\n                hideMask();\n                close = 0;\n                break;\n            default:\n                if (close == 0) return;\n                hideMask();\n                close = 0;\n                break;\n        }\n    })\n\n}\n\nmodule.exports = goodsdMask;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/goodsMask.js","var rewriteTxtRules = function(ue, fn) {\n    var txtRules = fn(ue);\n    var newRules = ue.options.filterTxtRules;\n    UE.utils.extend(newRules, txtRules);\n    ue.setOpt(\"filterTxtRules\", newRules)\n}\n\nvar rules = function(ue) {\n\n    return {\n        'img': {\n            $: {\n                'src': 1,\n                'data-type': 1,\n                '_src': 1,\n                'angle': 1,\n                'width': 1,\n                'height': 1,\n                'data-original': 1,\n                'proto': 1\n            }\n        }\n    }\n}\n\nvar init = function(ue) {\n    //过滤图片和替换表情\n    rewriteTxtRules(ue, rules);\n\n}\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/rewrite/filterTxtRules.js","var fetch = require('io/fetch');\nvar url = require('io/url');\n\nvar restoreContent = require('../../utils/restoreContent');\n\nvar editPath = $GLOBAL_CONFIG['from']; //0 新页面  1 编辑话题  2  草稿\nvar editKey = $GLOBAL_CONFIG['tid'];\nvar unsuccessful = require('page/publishTopic/unsuccessful');\nvar imgReplace = require('utils/imgReplace');\n\nfunction restoreData(editor) {\n    //加载草稿箱\n    if (editPath == undefined) return;\n\n    switch (editPath) {\n        case '0':\n            return;\n        case '1':\n            $(\"[data-action=save]\").remove();\n    }\n\n    var datas;\n    var _url;\n    switch (editPath) {\n        case '1':\n            datas = {\n                tid: editKey\n            }\n            _url = url.get('readTopicData');\n            break;\n        case '2':\n            datas = {\n                tid: editKey\n            }\n            _url = url.get('readTopicDraftsData');\n    }\n\n    fetch.get(_url, {\n        data: datas\n    }).done(function(data) {\n        if (data.success === true) {\n            var strs = restoreContent(data);\n            editor.execCommand('inserthtml', strs);\n            setTimeout(function() {\n                imgReplace.changeSrc($(editor.body));\n            }, 2000)\n\n        } else {\n            unsuccessful.init(data);\n        }\n\n    }).fail(function(data) {\n        console.log(data, \"err\")\n    })\n}\n\nmodule.exports = restoreData;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/plugin/restore/index.js","var $title = $('[data-node=topicTitle]');\nvar $topicTitleTips = $('[data-node=topicTitleTips]');\nvar $titleCharLen = $('[data-node=titleCharLen]');\nvar $crtLists = $('[data-node=crt-lists]');\nvar $selectGroup = $('[data-action=selectGroup]');\nvar empty = require('module/empty');\nvar decode = require('utils/decodeHtml.js');\n\nvar labelTpl = require('../plugin/restore/lenovoLabel.tpl');\nvar itemTpl = require('../plugin/goods/restoreGoods.tpl');\n\nvar imgReplace = require('utils/imgReplace');\n\nvar isMeihao = $GLOBAL_CONFIG.channel;\n\nvar originRule1 = /\\.600q80\\.jpg/gi;\nvar originRule2 = /-600!80\\./g;\n\n\nfunction orignText(str){\n    str = str.replace(originRule1,'');\n    return str.replace(originRule2,'.');\n}\n\nfunction restore(data) {\n    if (data.success == true) {\n        var num = 0;\n        var strs = \"\";\n        var datas = data.data;\n        var components = datas.components;\n\n        restoreTitle(datas);\n        restoreLabel(datas);\n        restoreGroup(datas)\n\n        for (var i = 0; i < components.length; i++) {\n\n            var arrs = components[i]\n            var type = arrs.type;\n            switch (type) {\n                case 'text':\n                    strs += restoreText(arrs);\n                    break;\n                case 'image':\n                    strs += restoreImg(arrs, num);\n                    break;\n                case 'item':\n                    strs += restoreItem(arrs);\n                    break;\n            }\n\n        }\n        return strs;\n    }\n}\n\nfunction formatText(text) {\n    var strs = \"\";\n    var temp = \"\";\n    temp = text.replace(/[\\n|\\r]/gi, function(i) {\n        return ',';\n    })\n\n    temp = temp.split(',');\n\n    for (var i = 0; i < temp.length; i++) {\n        var content = $.trim(temp[i]);\n        if (content != '') {\n            strs += '<p>' + content + '</p>';\n        }\n    }\n    return strs;\n}\n\n//恢复标题\nfunction restoreTitle(data) {\n    var name = data.name\n\n    if (name) {\n        name = decode(name);       \n        $title.val(name);\n        $topicTitleTips.hide();\n        $titleCharLen.html(name.length);\n    }\n\n}\n\n//恢复文字\n// 有richText键，有值   渲染 richtext\n\n// 有richText键，值为空  不渲染text\n\n// 没有richText键  ，text有值  渲染 text\n\n\nfunction restoreText(data) {\n    var r =data.richText;\n    // 有键\n    if ( r != 'undefined') { \n        //有值\n        if(r != ''){\n\n            var isVideo = /video-id=\"[\\d]+\"/.test(r);\n            //r = imgReplace.orignalImgReplace(r);\n            r = orignText(r);\n            if(isVideo && isMeihao){\n                r = r.replace('</div>',\"\");\n                r = r.replace('<div',\"<img\");\n            }\n            return r;\n        //无值\n        }else{\n            return '';\n        }\n        \n    } else {\n        if (data.text != '') {\n            //return '<p>' + data.text + '</p>';\n            return formatText(data.text);\n        } else {\n            return '';\n        }\n    }\n}\n//恢复图片\n//图片渲染需要渲染的情况：\n// 1、type=image 且 richText有值，用richText渲染\n// 2、type=image 且 没有richText字段，用url渲染\n\n// 不需要渲染的情况：\n// type=image 且 有richText字段但值为空\nfunction restoreImg(data, num) {\n\n    if (data.richText == \"\") {\n        return '';\n    }\n    if (data.richText == undefined) {\n        var tempSrc = imgReplace.imgReplace(data.url);\n        var tempProto = imgReplace.imgProto(data.url);\n        tempSrc = imgReplace.orignalImgReplace(tempSrc);\n        var img = '<img data-t =\"t-' +\n            num +\n            '\" data-type=\"insertImg\" src=\"' +\n            tempSrc +\n            '\" _src=\"' +\n            tempSrc +\n            '\" proto=\"' +\n            tempProto +\n            '\">'\n        num++;\n\n        var text = data.text;\n\n        //处理回车换行符号\n        if (text) {\n            img += formatText(text);\n        }\n\n        return img;\n    } else {\n        return data.richText;\n    }\n\n}\n\n//恢复商品\nfunction restoreItem(data) {\n\n    var item = data.item;\n    var json = {\n        skuId: item.skuId,\n        PId: item.id,\n        shopId: data.shopId,\n        link: item.itemDetailUrl,\n        img: imgReplace.imgReplace(item.mainImage),\n        price: item.salePrice,\n        title: item.name\n    }\n    var tpl = itemTpl(json);\n\n    if (empty(window.insertedGoods)) {\n        window.insertedGoods = {};\n    }\n\n    window.insertedGoods[item.skuId] = json;\n    //Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n    if (data.richText == '') {\n        return ''\n    } else {\n        return tpl;\n    }\n\n}\n\n//恢复标签\nfunction restoreLabel(data) {\n    var labels = data.labels || [];\n    var len = labels.length;\n    if (len) {\n        var str = \"\";\n        for (var i = 0; i < len; i++) {\n            var label = labels[i];\n            str += labelTpl({\n                id: label.id,\n                name: decode(label.name)\n            })\n        }\n        $crtLists.html(str);\n\n    }\n}\n\n//恢复圈子\nfunction restoreGroup(data) {\n\n    var gid = data.groupId;\n    if (gid) {\n        $selectGroup\n            .attr(\"data-groupid\", gid)\n            .text(data.group.name);\n    }\n}\n\nmodule.exports = restore\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/utils/restoreContent.js","var unhtml = function(str) {\n    return str ? str.replace(/&((g|l|quo|ldquo|rdquo)t|amp|#39|nbsp);/g, function(m) {\n        return {\n            '&lt;': '<',\n            '&amp;': '&',\n            '&quot;': '\"',\n            '&ldquo;': '“',\n            '&rdquo;': '”',\n            '&gt;': '>',\n            '&#39;': \"'\",\n            '&nbsp;': ' '\n        }[m]\n    }) : '';\n};\n\nmodule.exports = unhtml;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/decodeHtml.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/restore/lenovoLabel',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,name=$data.name,$out='';$out+='<li class=\"label-crt-items\" data-id=\"';\n$out+=$escape(id);\n$out+='\" title=\"';\n$out+=$escape(name);\n$out+='\"> <span class=\"crt-items-md\">';\n$out+=$escape(name);\n$out+='</span> <i class=\"crt-items-close\" data-node=\"crt-close\">×</i> </li> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/restore/lenovoLabel.tpl\n// module id = 164\n// module chunks = 6 16","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/editor/plugin/goods/restoreGoods',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,skuId=$data.skuId,PId=$data.PId,shopId=$data.shopId,link=$data.link,img=$data.img,title=$data.title,price=$data.price,$out='';$out+='<p><br/></p><div data-node=\"gmp-ebox\" class=\"card-box\" contenteditable=\"false\"> <div data-type=\"insertGoods\" data-skuId=\"';\n$out+=$escape(skuId);\n$out+='\" data-pid=\"';\n$out+=$escape(PId);\n$out+='\" data-info=\\'{\"type\":\"item\",\"text\":\"\",\"id\":\"';\n$out+=$escape(PId);\n$out+='\",\"kid\":\"\", \"shopId\": \"';\n$out+=$escape(shopId);\n$out+='\",\"skuId\":\"';\n$out+=$escape(skuId);\n$out+='\"}\\' class=\"publish-item\"> <a href=\"';\n$out+=$escape(link);\n$out+='\" class=\"img-out\"> <img src=\"';\n$out+=$escape(img);\n$out+='\" data-node=\"goodsPic\"> </a> <div class=\"publish-cont\"> <h3 class=\"pub-tl\"> <a href=\"';\n$out+=$escape(link);\n$out+='\">';\n$out+=$escape(title);\n$out+='</a> </h3> <div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">';\n$out+=$escape(price);\n$out+='</strong> </div> <a href=\"';\n$out+=$escape(link);\n$out+='\" target=\"_blank\" class=\"scan-more\">查看详情</a> </div> </div> <div class=\"cover\">&nbsp;</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/editor/plugin/goods/restoreGoods.tpl\n// module id = 165\n// module chunks = 6 16","var alert = require('module/popup/alert');\n\nvar unsuccessful = function(msg, relativePath) {\n    /*alert(msg, {\n        ok: function() {\n            window.location.href = $_CONFIG.group_domain + relativePath;\n        }\n    });*/\n    //页面强制跳转会对用户不友好，填写的数据可能会丢失！\n    alert(msg);\n}\n\nvar init = function(data) {\n    var code;\n    var msg = data.message;\n    console.log(typeof data.code)\n    switch (data.code) {\n        case 101:\n            code = 'group';\n            msg = \"图片超出限定数量\";\n            break;\n        case 102:\n            code = 'group';\n            msg = \"上传图片存在非法提交\";\n            break;\n        case 103:\n            code = 'group';\n            msg = \"商品超出限定数量\";\n            break;\n        case 410:\n            code = 'group_dissolve';\n            break;\n        case 403:\n            code = 'group';\n            msg = \"抱歉，该圈子审核不通过！\";\n            break;\n        case 404:\n        case 422:\n        case '911918':\n            window.location.href = $_CONFIG.i_domain + 'expert/error_' + data.code + '.html';\n            return;\n        default:\n            alert(data.message);\n            return;\n    }\n    var relUrl = 'index/get_error?code=' + code;\n    unsuccessful(msg, relUrl);\n}\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/publishTopic/unsuccessful/index.js","/* eslint-disable */\n\nvar str = '<div class=\"test\"  contenteditable=\"false\" data-node=\"gmp-ebox\" data-info= {\"id\":\"123\",\"shopId\":\"456\",\"kid\":\"789\"}>' +\n    '<div data-node=\"goodsItem\" class=\"publish-item hover-dele\">' +\n    '<a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\" class=\"img-out\"> <img src=\"https://i-pre.meixincdn.com/T1haCTBvJT1RXrhCrK.230x230cTzq80.jpg\" data-node=\"999\"> </a>' +\n    '<div class=\"publish-cont\">' +\n    '<h3 class=\"pub-tl\"> <a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\">情人节必备</a> </h3>' +\n    '<div class=\"pub-row\"> <span class=\"red\">￥</span><strong class=\"money-inf\">0.01</strong> </div>' +\n    '<a href=\"http://mall.dev.gomeplus.com/product/475-2430.html\" target=\"_blank\" class=\"scan-more\">查看详情</a> ' +\n    '</div>' +\n    ' </div>' +\n    '<b data-node=\"ifs\" style=\"position:absolute;top:0;left:0;width:1008px;background:#f00;height:230px;display:none;opacity:0.3;z-index:99999\">122</b>' +\n    '</div>'\n\n//require('editor/rewrite/insertGoods')\n\nvar init = function(ue) {\n    //test\n    $(function() {\n\n        ue.addListener('ready', function() {\n                var $body = $(\"iframe\").contents().find(\"body\");\n                //console.log($body)\n                $body.click(function() {\n                    //console.log($body.find(\"[data-node='gmp-ebox']\"))\n                })\n                $body.on(\"[data-node='gmp-ebox']\", \"click\", function() {\n                    //console.log($(this))\n                    var range = ue.selection.getRange();\n                    range.select();\n                    var s = [].concat(ue.selection.getStartElementPath());\n                    //console.log(s,1122)\n                })\n\n            })\n\n\n        var str2 = '123<b>000<em>111</em>0</b>321';\n        \n        $(\"#insert\").on(\"click\", function() {\n                ue.execCommand('insertHtml', str, true);\n                ue.focus();\n            })\n            /*\n            \t\t$(\"#insert2\").on(\"click\",function(){\n            \t\t\tue.execCommand('insertHtml', '1234567890',true);\n            \t\t})\n            */\n\n        //var tempstr = '<p><video src=\"http://js.dev.meixincdn.com:1314/dist/images/video.mp4\" controls=\"controls\">您的浏览器不支持 video 标签。</video></p>'\n        var tempstr = '3321321<img src=\"http://js.dev.meixincdn.com:1314/dist/images/circle/index/act-box-img.png\">321321'\n        $(\"#insert2\").on(\"click\", function() {\n            ue.execCommand('insertHtml', tempstr,true);\n            // console.log(UE.htmlparser('<p><b>htmlparser</b></p>', true));\n            //ue.execCommand('haha', tempstr, true);\n        })\n\n        $(\"#viewCode\").on(\"click\", function() {\n            var nodes = ue.document.body.children;\n            var arr = [];\n            for (var i = 0; i < nodes.length; i++) {\n                var tagNode = nodes[i];\n                if (tagNode.tagName = \"P\") {\n                    //var txt = thisNode.innerHTML;\n                    var childNodes = tagNode.childNodes;\n\n                    for (var j = 0; j < childNodes.length; j++) {\n                        var _thisNode = childNodes[j]\n                        if (_thisNode.nodeType == 3) {\n                            var _thisValue = _thisNode.nodeValue;\n                            if (_thisValue !== \"\" || _thisValue !== \"&#8203\") {\n                                arr.push({\n                                    \"type\": \"text\",\n                                    \"text\": _thisValue\n                                });\n                                console.log(_thisValue, typeof _thisValue)\n                            }\n                        } else {\n                            if (_thisNode.tagName == \"IMG\")\n                                arr.push({\n                                    \"type\": \"image\",\n                                    \"text\": \"美图\",\n                                    \"url\": _thisNode.src\n                                });\n                            if (_thisNode.tagName == \"BR\") {\n                                arr.push({\n                                    \"type\": \"text\",\n                                    \"text\": '<br/>'\n                                })\n                            }\n                        }\n                    }\n\n                    /*\n\t\t\t\t\tvar reg = /<img.*?>/gi;\n\t\t\t\t\tvar j = txt.split(reg)\n\t\t\t\t\tconsole.log(j)\n\n\t\t\t\t\tvar newStr = '<p>';\n\t\t\t\t\tvar j = txt.match(reg) ;\n\t\t\t\t\t*/\n                    //var j =txt.replace(/<img.*?>/g,'hahaha');\n                    //console.log(j,12)\n                }\n                if (tagNode.tagName == \"DIV\") {\n                    var data = tagNode.attributes.data.value;\n                    data = JSON.parse(data);\n                    arr.push({\n                        \"type\": \"item\",\n                        \"text\": \"sg\",\n                        \"id\": data.id,\n                        \"shopId\": data.shopId,\n                        \"kid\": data.kid\n                    });\n                }\n            }\n            console.log(arr);\n        })\n\n        $(\"#submitCode\").on(\"click\", function() {\n            //ue.execCommand('insertHtml', '1234567890',true);\n            var t = ue.getContent()\n\n            function htmlNull(str) {\n                var re = str.replace(/\\n|\\r\\n/g, \"</br>\");\n                return re; //去掉所有的html标记\n            }\n            console.log(htmlNull(t));\n        })\n\n        $(\"#del\").on(\"click\", function() {\n            var range = ue.selection.getRange();\n            range.select();\n            var s = [].concat(ue.selection.getStartElementPath());\n\n            var parents = $(s[0]).parents('[data-node=listItemBox]')\n            if (parents.length > 0) {\n                console.log(parents.get(0))\n                    //parents.find('[data-node=mask]').show();\n                range.setStart(parents.prev().get(0), 0)\n                range.setEnd(parents.next().get(0), 0)\n                range.select();\n            }\n        })\n    })\n}\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/editor/test.js"],"sourceRoot":""}
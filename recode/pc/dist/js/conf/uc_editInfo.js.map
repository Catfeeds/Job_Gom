{"version":3,"sources":["webpack:///uc_editInfo.js","webpack:///./src/js/page/uc_editInfo/index.js","webpack:///./src/js/module/hint.js?34fa***********","webpack:///./src/js/module/i18n.js?8f86*******","webpack:///./src/js/module/cropper.js?d1c7","webpack:///./src/js/plugin/webuploader/webuploader.js?37bb*****","webpack:///./src/js/plugin/jquery.cropper.js?6929*","webpack:///./src/js/page/uc_editInfo/editFace.js","webpack:///./src/js/page/uc_editInfo/selDate.js","webpack:///./src/js/module/date.js","webpack:///./src/js/page/uc_editInfo/nameEvent.js","webpack:///./src/js/page/uc_editInfo/verifyName.js","webpack:///./src/js/utils/check.js","webpack:///./src/js/page/uc_editInfo/editCls.js","webpack:///./src/js/utils/limitLen.js","webpack:///./src/js/page/uc_editInfo/subData.js"],"names":["webpackJsonp","0","module","exports","__webpack_require__","init","subInit","44","$","$publicMask","$publicTips","timer","events","off","on","hide","msg","options","defaults","duration","callback","extend","clearTimeout","length","show","text","append","css","offsetHeight","width","setTimeout","call","84","inputTip","tel","ept","err","errBack","msgCode","tipGet","tipEpt","tipErr","tipErrEdit","tipWrong","checkCodeWrong","send","tipSend","tipDisabled","tipLimitEdit","btnAfterSend","btnDefault","pwd","commonTip","pwdV","nickName","eptName","existName","sucSub","errLine","wrongName","birthTip","tip","refCode","imgCode","login","errCode","errNum","errPwd","agreement","createCircle","typeEmpty","nameEmpty","upperLimit","circle","unJoin","cannotJoin","review","joinSuccess","joinSuccessPublic","cannotJoinCircle","exit","dissolved","qrCodeTip","loseEffTip","loseEffBtn","failGetTip","failGetBtn","masterApply","nameLength","nameType","isIdCard","type","summary","upload","noUpload","uploadError","uploadFaild","uploadError_Master","Q_EXCEED_NUM_LIMIT","Q_EXCEED_SIZE_LIMIT","Q_TYPE_DENIED","F_EXCEED_SIZE","excess","85","$_CONFIG","WebUploader","$webUpLoader","files","$noticeBox","$wrap","$cropImg","find","$preview","$avatarSave","$progress","$error","$loadNotice","$retry","avatarData","defaultImage","attr","isUpload","link","isIE8","window","FormData","key","startCrop","cropper","aspectRatio","preview","selector","background","guides","create","undefined","removeFile","id","file","makeThumb","error","ret","removeClass","addClass","addButton","innerHTML","md5File","progress","percentage","then","response","success","code","data","submit","this","hasClass","object","retry","uploadOptions","cropperOptions","fn","defaultUpload","pick","multiple","thumb","compress","accept","title","extensions","mimeTypes","method","swf","imgpath","disableGlobalDnd","duplicate","prepareNextFile","chunked","fileVal","server","fileNumLimit","fileSizeLimit","fileSingleSizeLimit","defaultCropper","copper","webUpLoader","destroy","getData","86","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","__webpack_provided_window_dot_jQuery","root","factory","modules","_require","deps","args","len","i","getModule","push","apply","_define","arguments","setModule","returned","Error","exportsTo","obj","host","parts","part","last","ucFirst","str","charAt","toUpperCase","substr","hasOwnProperty","split","pop","shift","makeExport","dollar","__dollar","define","require","jQuery","Zepto","_","Deferred","when","isPromise","anything","promise","uncurryThis","bindFn","context","createObject","proto","f","Object","prototype","noop","Function","version","browser","ua","webkit","match","chrome","ie","firefox","safari","opera","parseFloat","navigator","userAgent","os","android","ios","replace","inherits","Super","protos","staticProtos","child","constructor","__super__","log","console","nextTick","cb","slice","guid","counter","prefix","Date","toString","Math","floor","random","formatSize","size","pointLength","units","unit","toFixed","Base","findHandlers","arr","name","grep","handler","e","_cb","ctx","eachEvent","iterator","each","separator","triggerHanders","stoped","ctx2","set","me","_events","once","trigger","allEvents","installTo","Mediator","Uploader","opts","_init","stop","getFile","getFiles","addFile","addFiles","sort","cancelFile","skipFile","isInProgress","getDimension","predictRuntimeType","refresh","disable","enable","reset","command","request","state","option","val","isPlainObject","getStats","stats","successNum","numOfSuccess","progressNum","numOfProgress","cancelNum","numOfCancel","invalidNum","numOfInvalid","uploadFailNum","numOfUploadFailed","queueNum","numOfQueue","interruptNum","numofInterrupt","substring","isFunction","concat","Runtime","container","document","body","uid","factories","getFirstKey","getContainer","parent","_container","createElement","position","top","left","height","overflow","_parent","exec","remove","orders","addRuntime","hasRuntime","runtime","RuntimeClient","component","standalone","deferred","runtimeReady","done","connectRuntime","cache","get","__promise","resolve","__client","runtimeOrder","add","__standalone","getRuntime","disconnectRuntime","unshift","getRuid","ruid","RuntimeClent","DragAndDrop","isArrayLike","nodeType","Widget","uploader","owner","_destroy","IGNORE","widgetClass","invoke","apiName","map","responseMap","widgets","_widgets","deactives","disableWidgets","klass","indexOf","_name","widget","rlt","rlts","dfds","pipe","register","widgetProto","toLowerCase","unRegister","splice","Dnd","dnd","items","FilePaste","paste","Blob","source","ext","start","end","getSource","File","rExt","RegExp","$1","lastModifiedDate","toLocaleString","FilePicker","label","html","button","_refer","_resizeHandler","shimContainer","outerWidth","outerHeight","pos","offset","bottom","right","btn","pickers","addBtn","promises","picker","Image","_info","_meta","quality","crop","preserveHeaders","allowMagnify","info","meta","loadFromBlob","blob","resize","getAsDataUrl","getAsBlob","throttle","max","occupied","waiting","tick","item","emiter","image","isArtwork","reason","beforeSendFile","compressSize","noCompressIfLarger","_compressed","always","reject","gid","idPrefix","idSuffix","WUFile","statusText","statusMap","Status","INITED","loaded","setStatus","ERROR","status","prevStatus","getStatus","QUEUED","PROGRESS","COMPLETE","CANCELLED","INTERRUPT","INVALID","Queue","numofDeleted","_queue","_map","STATUS","_fileAdded","prepend","fileId","fetch","sts","inArray","existing","cur","pre","_onFileStatusChange","curStatus","preStatus","join","queue","placeholder","_ruid","_wrapFile","acceptFile","invalid","test","_addFile","auto","fetchFile","noForceStart","sortFiles","support","Transport","_blob","_formData","formData","_headers","headers","_timeout","_timer","withCredentials","timeout","sendAsBinary","appendBlob","filename","value","setRequestHeader","abort","getResponse","getResponseAsJson","CuteFile","chunkSize","api","pending","total","chunks","ceil","index","has","block","min","chunk","cuted","blocks","remaning","chunkRetry","threads","runing","pool","stack","__tick","_tick","v","transport","_trigged","_promise","startUpload","stopUpload","interrupt","_putback","_popBlock","_tr","_getStats","skipped","_nextBlock","_startSend","idx","_getStack","act","next","preparing","_prepareNextFile","_finishFile","fail","_doSend","updateFileProgress","requestAccept","tr","_raw","flag","retried","hds","totalPercent","uploaded","validators","addValidator","removeValidator","count","parseInt","hashString","_char","hash","charCodeAt","mapping","__hash","Md5","getResult","md5","notify","CompBase","Html5Runtime","comp","instance","client","components","FileReader","DataView","webkitSlice","mozSlice","elem","dragEnterHandler","_dragEnterHandler","dragOverHandler","_dragOverHandler","dragLeaveHandler","_dragLeaveHandler","dropHandler","_dropHandler","dndOver","denied","_denied","originalEvent","dataTransfer","dropEffect","parentElem","contains","currentTarget","_leaveTimer","_getTansferFiles","results","canAccessFolder","webkitGetAsEntry","isDirectory","_traverseDirectoryTree","entry","isFile","createReader","readEntries","entries","hander","_pasteHander","allowed","clipboardData","kind","getAsFile","preventDefault","stopPropagation","mouseHandler","input","opacity","display","cursor","clone","callee","target","cloneNode","parentNode","replaceChild","urlAPI","createObjectURL","URL","revokeObjectURL","webkitURL","dataURL2Blob","dataURI","byteStr","intArray","ab","mimetype","atob","decodeURIComponent","ArrayBuffer","Uint8Array","arrayBufferToBlob","dataURL2ArrayBuffer","buffer","bb","builder","BlobBuilder","WebKitBlobBuilder","getBlob","canvasToDataUrl","canvas","toDataURL","parseMeta","updateImageHead","Util","parsers","65505","maxMetaDataSize","parse","fr","onload","_parse","result","onerror","message","readAsArrayBuffer","noParse","byteLength","markerBytes","markerLength","dataview","maxOffset","headLength","getUint16","imageHead","subarray","head","buf1","buf2","bodyoffset","ImageMeta","EXIF","ExifMap","Orientation","exifTagTypes","1","getValue","dataView","dataOffset","getUint8","2","String","fromCharCode","ascii","3","littleEndian","4","getUint32","5","9","getInt32","10","getExifValue","tiffOffset","tagSize","values","c","tagType","parseExifTag","tag","exif","parseExifTags","dirOffset","tagsNumber","dirEndOffset","parseExifData","JPEGEncoder","initQuantTables","sf","YQT","t","ffloor","YTable","ZigZag","UVQT","j","u","UVTable","aasf","k","row","col","fdtbl_Y","fdtbl_UV","computeHuffmanTbl","nrcodes","std_table","codevalue","pos_in_table","HT","Array","initHuffmanTbl","YDC_HT","std_dc_luminance_nrcodes","std_dc_luminance_values","UVDC_HT","std_dc_chrominance_nrcodes","std_dc_chrominance_values","YAC_HT","std_ac_luminance_nrcodes","std_ac_luminance_values","UVAC_HT","std_ac_chrominance_nrcodes","std_ac_chrominance_values","initCategoryNumber","nrlower","nrupper","cat","nr","category","bitcode","nrneg","initRGBYUVTable","RGB_YUV_TABLE","writeBits","bs","posval","bytenew","bytepos","writeByte","byteout","clt","writeWord","fDCTQuant","fdtbl","d0","d1","d2","d3","d4","d5","d6","d7","dataOff","I8","I64","tmp0","tmp7","tmp1","tmp6","tmp2","tmp5","tmp3","tmp4","tmp10","tmp13","tmp11","tmp12","z1","z5","z2","z4","z3","z11","z13","tmp0p2","tmp7p2","tmp1p2","tmp6p2","tmp2p2","tmp5p2","tmp3p2","tmp4p2","tmp10p2","tmp13p2","tmp11p2","tmp12p2","z1p2","z5p2","z2p2","z4p2","z3p2","z11p2","z13p2","outputfDCTQuant","writeAPP0","writeSOF0","writeDQT","writeDHT","l","m","n","o","p","writeSOS","processDU","CDU","DC","HTDC","HTAC","EOB","M16zeroes","I16","I63","DU_DCT","DU","Diff","end0pos","lng","startpos","nrzeroes","nrmarker","initCharLookupTable","sfcc","setQuality","currentQuality","round","YDU","UDU","VDU","encode","DCY","DCU","DCV","displayName","x","r","g","b","imageData","quadWidth","y","fillbits","jpegDataUri","btoa","encoder","supportJpeg","origin","w","h","fragement","getContext","getImageData","BLANK","modified","img","_metas","_img","src","_canvas","_resize","s","cvs","iw","naturalWidth","ih","naturalHeight","orientation","getOrientation","_rotate2Orientaion","_renderImageToCanvas","clearRect","scale","translate","rotate","PI","detectVerticalSquash","alpha","ratio","sy","ey","py","drawImage","detectSubsampling","vertSquashRatio","tmpCanvas","tmpCtx","dw","dh","sx","dx","subsampled","doSquash","d","dy","save","restore","_status","_response","binary","xhr","_initAjax","param","open","_setRequestHeader","overrideMimeType","_parseJson","_xhr","onprogress","onreadystatechange","XMLHttpRequest","XDomainRequest","lengthComputable","readyState","responseText","json","JSON","ex","FlashRuntime","add32","a","cmn","q","ff","gg","hh","ii","md5cycle","md5blk","md5blks","md5blk_array","md51","tail","tmp","lo","hi","md51_array","hex_chr","rhex","hex","SparkMD5","lsw","msw","unescape","encodeURIComponent","appendBinary","contents","_buff","_length","_state","raw","buff","_finish","hashBinary","content","_concatArrayBuffer","first","second","firstLength","loadNext","spark","blobSlice","onloadend","getFlashVersion","plugins","description","ActiveXObject","GetVariable","ex2","evt","clients","jsreciver","flashExec","flash","getFlash","_flash","copy","_responseJson","url","forceURLStream","mimeType","percent","readBody","base","logUrl","product","location","hostname","dv","master","online","c_error_code","c_reason","c_count","c_size","c_usage","preset","87","Symbol","protocol","port","getTime","R","degree","S","T","$element","DEFAULTS","ready","built","rotated","cropped","disabled","cropBox","load","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","sqrt","P","Q","abs","sin","cos","U","V","is","prop","Event","one","build","isDefaultPrevented","checkImageOrigin","$clone","proxy","crossOrigin","insertAfter","unbuild","$cropper","TEMPLATE","$container","$canvas","$dragBox","$cropBox","$viewBox","addListeners","initPreview","autoCrop","modal","highlight","movable","resizable","setDragMode","dragCrop","render","removeListeners","resetPreview","initContainer","initCanvas","initCropBox","renderCanvas","renderCropBox","minContainerWidth","minContainerHeight","oldLeft","oldTop","limitCanvas","initialImage","initialCanvas","strict","minCanvasWidth","minCanvasHeight","minWidth","minHeight","maxWidth","maxHeight","minLeft","minTop","maxLeft","maxTop","renderImage","limitCropBox","output","marginLeft","marginTop","transform","autoCropArea","initialCropBox","minCropBoxWidth","minCropBoxHeight","original","removeData","dragstart","dragmove","dragend","zoomin","zoomout","dblclick","zoomable","mouseWheelZoom","wheel","_dragmove","_dragend","responsive","getCanvasData","getCropBoxData","setCanvasData","setCropBoxData","deltaY","wheelDelta","detail","zoom","touches","touchDragZoom","startX2","pageX","startY2","pageY","dragType","cropping","startX","startY","endX2","endY2","endX","endY","change","toggleClass","clear","move","rotatable","getContainerData","getCroppedCanvas","fillColor","fillStyle","fillRect","setAspectRatio","X","Y","setDefaults","other","Constructor","noConflict","289","hint","$tabs","$tabBoxs","$faceBox","firstTab","cropperInit","post","facePicUrl","Tab","eq","click","href","290","tips","editBox","birTip","hideCls","dateClick","dateDefault","eTime","endTime","initDate","291","ShowDate","startTime","dateReg","yearErrTip","monErrTip","ymErrTip","addZero","num","handleVal","$node","compareDate","date","nowDate","switchNum","upperNum","numAry","_self","tplHtml","tpl","dateContainer","dateBox","yearBox","mnBox","ymBox","dataTable","tbody","td","prevM","nextM","monBtn","prevY","nextY","yearBtn","changeDefault","dateText","topBtn","leftBtn","event","Target","newDd","newYear","newMn","dateFlag","trIndex","parents","isNaN","newDate","dateComFlag","changeMn","changeYr","NewMn","alert","showNow","deVal","regExp","dayArr","changeDefault2","btnTxt","oPare","isChild","yr","mn","now","year","getFullYear","month","getMonth","dd","getDate","showAllDay","getDayLen","setDate","Yr","Mn","Dd","monthPre","firstDay","getDay","dayLen","dayLenPre","miniDate","292","verifyName","limitLen","editCls","remCls","addCls","nickname","nameErr","errBorder","comErr","borErrCls","nameFoc","nameKeyup","nameVal","initObj","blur","checkNameRule","focus","keyup","293","check","nickTips","checkRule","lenFlag","checkNickName","294","checkVal","pattern","isMobileNum","mobile","isEmail","email","isCertificate","certificate","isCID","cardNo","isCWord","word","reg","isArray","passwordReg","checkSpace","checkRefCode","nickNameReg","isMsgCode","isImgCode","295","cls","296","297","nameTips","sexBox","birthday","subDate","comTip","nameBorErr","faceImg","header","headImg","headName","birthPre","errBorCls","sub","sexVal","birthVal","faceImgUrl","nameFlag","errFlag","subData","gender","birFlag","subEvent"],"mappings":"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","file":"uc_editInfo.js","sourcesContent":["webpackJsonp([34],{\n\n/***/ 0:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t//修改头像\n\t__webpack_require__(289).init();\n\t\n\t//出生日期\n\t__webpack_require__(290).init();\n\t//昵称事件\n\t__webpack_require__(292).init();\n\t//提交保存\n\t__webpack_require__(297).subInit();\n\n/***/ }),\n\n/***/ 44:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/*\r\n\t * 弹层提示弹窗\r\n\t * zhaodonghong\r\n\t */\n\t\n\tvar $publicMask;\n\tvar $publicTips;\n\tvar timer;\n\t\n\tvar events = function events() {\n\t\n\t    $publicMask.off().on('click', function () {\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t    });\n\t\n\t    $publicTips.off().on('click', function () {\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t    });\n\t};\n\t\n\t/**\r\n\t * msg string 提示信息\r\n\t * options object \r\n\t * options.duration settimout消失时间\r\n\t * options.callback 提示消失的回调\r\n\t*/\n\tvar init = function init(msg, options) {\n\t    var defaults = {\n\t        duration: 2000,\n\t        callback: function callback() {}\n\t    };\n\t\n\t    $.extend(defaults, options || {});\n\t\n\t    clearTimeout(timer);\n\t    $publicMask = $('[data-action=\"publicMask\"]');\n\t    $publicTips = $('[data-action=\"publicTips\"]');\n\t\n\t    if ($publicMask.length > 0) {\n\t\n\t        $publicMask.show();\n\t        $publicTips.show().text(msg);\n\t    } else {\n\t\n\t        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\n\t        $publicMask = $('[data-action=\"publicMask\"]');\n\t        $publicTips = $('[data-action=\"publicTips\"]');\n\t        events();\n\t    }\n\t\n\t    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\n\t\n\t    timer = setTimeout(function () {\n\t\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t\n\t        defaults.callback();\n\t    }, defaults.duration);\n\t};\n\t\n\tmodule.exports = {\n\t    init: init,\n\t    events: events\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n\n/***/ 84:\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\n\t * Created by dongyukuan on 2016/7/4.\n\t */\n\tvar inputTip = {\n\t    tel: {\n\t        ept: '请填写11位手机号',\n\t        err: '手机号格式错误',\n\t        errBack: '该手机号已被注册'\n\t    },\n\t    msgCode: {\n\t        tipGet: '请获取短信验证码',\n\t        tipEpt: '请输入短信验证码',\n\t        tipErr: '验证码是6位数字,请重新输入',\n\t        tipErrEdit: '验证码错误',\n\t        tipWrong: '验证码有误,请重新输入',\n\t        checkCodeWrong: '验证码输入错误,请重新输入',\n\t        send: '验证码已发送，请注意查收',\n\t        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n\t        tipDisabled: \"验证码再次获取需间隔60s\",\n\t        tipLimitEdit: '获取验证码超限，请稍后再试',\n\t        btnAfterSend: \"秒后重新获取\",\n\t        btnDefault: \"获取验证码\"\n\t    },\n\t    pwd: {\n\t        commonTip: '请输入6-20位英文字母,数字或符号'\n\t    },\n\t    pwdV: {\n\t        ept: '请再次输入密码',\n\t        err: '两次输入的密码不一致'\n\t    },\n\t    nickName: {\n\t        eptName: '请输入昵称！',\n\t        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n\t        existName: '此昵称太受欢迎了，已经有人抢了~',\n\t        sucSub: '资料修改成功！',\n\t        errLine: \"网络超时!\",\n\t        wrongName: '此昵称含有敏感词,请重新输入'\n\t    },\n\t    birthTip: {\n\t        tip: '生日不能重复设置'\n\t    },\n\t    refCode: {\n\t        err: '推荐码错误'\n\t    },\n\t    imgCode: {\n\t        ept: '请输入验证码',\n\t        err: '验证码输入错误，请重新输入'\n\t    },\n\t    login: {\n\t        errCode: '请输入验证码',\n\t        errNum: '请输入账号',\n\t        errPwd: '请输入密码',\n\t        agreement: '请同意协议并勾选'\n\t    },\n\t    createCircle: {\n\t        typeEmpty: '请选择圈子分类',\n\t        nameEmpty: '圈子名称不能为空',\n\t        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n\t    },\n\t    circle: {\n\t        login: '登录成功！',\n\t        unJoin: '需要先加入该圈子才能发布话题',\n\t        cannotJoin: '抱歉！该圈子不允许发布话题!',\n\t        review: '加入圈子审核中，请耐心等待!',\n\t        joinSuccess: '恭喜您已经加入圈子！',\n\t        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n\t        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n\t        exit: '您已经退出该圈子！',\n\t        dissolved: '抱歉！该圈子已被解散'\n\t    },\n\t    qrCodeTip: {\n\t        loseEffTip: '二维码已失效',\n\t        loseEffBtn: '点击刷新',\n\t        failGetTip: '二维码生成失败',\n\t        failGetBtn: '重新生成'\n\t    },\n\t    masterApply: {\n\t        nameLength: '姓名要2-20个字符',\n\t        nameType: '姓名仅限汉字和字母',\n\t        isIdCard: '请填写18位有效身份证号',\n\t        type: '请选择达人类别',\n\t        summary: '请输入自我介绍，2-100个字符'\n\t    },\n\t    upload: {\n\t        noUpload: '请上传图片',\n\t        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n\t        uploadFaild: '上传失败,请重新上传',\n\t        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n\t        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n\t        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n\t        Q_TYPE_DENIED: '文件类型错误',\n\t        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n\t        excess: '文件个数超出限制'\n\t    },\n\t    errLine: {\n\t        tip: '网络错误,请稍后再试！'\n\t    }\n\t};\n\tmodule.exports = inputTip;\n\n/***/ }),\n\n/***/ 85:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar WebUploader = __webpack_require__(86);\n\t__webpack_require__(87);\n\t\n\tvar $webUpLoader;\n\tvar $noticeBox = $('[data-node=\"noticeBox\"]');\n\t// var $noticeInfo = $noticeBox.find('[data-node=\"noticeInfo\"]');\n\tvar $wrap = $('[data-node=\"cropWrap\"]');\n\tvar $cropImg = $wrap.find('img');\n\tvar $preview = $('[data-node=\"avatrSelector\"]');\n\tvar $avatarSave = $('[data-action=\"avatarSave\"]');\n\tvar $progress = $noticeBox.find('[data-node=\"uploadProgress\"]');\n\tvar $error = $('[data-node=\"error\"]');\n\tvar $loadNotice = $noticeBox.find('[data-node=\"loadNotice\"]');\n\tvar $retry = $noticeBox.find('[data-action=\"retry\"]');\n\t\n\tvar avatarData = {};\n\tvar files;\n\tvar defaultImage = $cropImg.attr('data-default');\n\tvar isUpload = false;\n\tvar link = '';\n\tvar isIE8 = !window.FormData;\n\tvar key = false;\n\t\n\tvar startCrop = function startCrop() {\n\t    isUpload = true;\n\t    $cropImg.cropper({\n\t        aspectRatio: 1,\n\t        preview: $preview.selector,\n\t        background: false,\n\t        guides: false\n\t    });\n\t};\n\t\n\tvar preview = function preview(upload, cropper, callback) {\n\t    $webUpLoader = WebUploader.create(upload);\n\t    $webUpLoader.on('beforeFileQueued', function () {\n\t        isUpload = false;\n\t        $cropImg.cropper('destroy');\n\t        $error.hide();\n\t        files !== undefined && $webUpLoader.removeFile(files.id);\n\t    });\n\t\n\t    $webUpLoader.on('fileQueued', function (file) {\n\t        files = file;\n\t        if (isIE8 && !key) {\n\t            $webUpLoader.upload(files);\n\t            key = true;\n\t        } else {\n\t            $webUpLoader.makeThumb(file, function (error, ret) {\n\t                if (error) {\n\t                    $webUpLoader.removeFile(files.id);\n\t                    $noticeBox.removeClass('load-ing').show();\n\t                } else {\n\t                    $cropImg.attr('src', ret);\n\t                    startCrop(cropper);\n\t                    $avatarSave.addClass('active');\n\t                    if ($cropImg.attr('data-edit')) {\n\t                        $('[data-defaultAddFile=picker]').hide();\n\t                        $webUpLoader.addButton({\n\t                            id: '[data-action=\"upload-edit\"]',\n\t                            innerHTML: '修改'\n\t                        });\n\t                    }\n\t                }\n\t            });\n\t        }\n\t        $webUpLoader.md5File(file)\n\t        // 及时显示进度\n\t        .progress(function (percentage) {\n\t            $loadNotice.text('图片加载中');\n\t            $noticeBox.addClass('load-ing').show();\n\t            $progress.css('width', percentage * 100 + '%');\n\t        })\n\t        // 完成\n\t        .then(function () /*val*/{\n\t            $noticeBox.hide();\n\t            $progress.css('width', 0);\n\t        });\n\t    });\n\t    //报错\n\t    $webUpLoader.on('error', function () /*type*/{\n\t        /*var errNotice = {\r\n\t            Q_EXCEED_NUM_LIMIT: '文件个数超出限制',\r\n\t            Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\r\n\t            Q_TYPE_DENIED: '文件类型错误',\r\n\t            F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！'\r\n\t        }*/\n\t        $cropImg.attr('src', defaultImage);\n\t        $preview.find('img').attr('src', defaultImage);\n\t        $error.show().find('span').text('请上传小于4M的图片，支持格式jpg、jpeg、png、gif！');\n\t        $avatarSave.removeClass('active');\n\t    });\n\t\n\t    //上传成功\n\t    $webUpLoader.on('uploadSuccess', function (file, response) {\n\t\n\t        if (response.success && response.code === 200) {\n\t            if (key) {\n\t                $cropImg.attr('src', response.data[0]);\n\t                startCrop();\n\t                $noticeBox.hide();\n\t                key = false;\n\t                $avatarSave.addClass('active');\n\t            } else {\n\t                $cropImg.attr('src', response.data[0]);\n\t                $noticeBox.hide();\n\t                $cropImg.cropper('destroy');\n\t                $preview.find('img').attr('src', response.data[0]);\n\t                $webUpLoader.removeFile(files);\n\t                link = response.data[0];\n\t                callback.call(null, response.data[0]);\n\t                $avatarSave.removeClass('active');\n\t                files = undefined;\n\t            }\n\t        } else {\n\t            $('.cropper-crop-box').hide();\n\t            $noticeBox.removeClass('load-ing').show();\n\t            isUpload = true;\n\t        }\n\t    });\n\t    //上传失败\n\t    $webUpLoader.on('uploadError', function () /*file, reason*/{\n\t        $('.cropper-crop-box').hide();\n\t        $noticeBox.removeClass('load-ing').show();\n\t        isUpload = true;\n\t    });\n\t\n\t    //上传时\n\t    $webUpLoader.on('uploadProgress', function (file, percentage) {\n\t        $('.cropper-crop-box').hide();\n\t        $loadNotice.text('图片上传中');\n\t        $noticeBox.addClass('load-ing').show();\n\t        $progress.css('width', percentage * 100 + '%');\n\t        isUpload = false;\n\t    });\n\t};\n\t\n\tvar submit = function submit() {\n\t    $avatarSave.on('click', function () {\n\t        if (isUpload && $(this).hasClass('active')) {\n\t            isUpload = false;\n\t            avatarData = $cropImg.cropper('getData');\n\t            avatarData.type = 'crop';\n\t            $webUpLoader.on('uploadBeforeSend', function (object, data) {\n\t                $.extend(data, avatarData);\n\t            });\n\t            $webUpLoader.upload(files);\n\t        }\n\t        $retry.addClass('active');\n\t    });\n\t    $retry.on('click', function () {\n\t        if (isUpload && $(this).hasClass('active')) {\n\t            isUpload = false;\n\t            avatarData = $cropImg.cropper('getData');\n\t            avatarData.type = 'crop';\n\t            $webUpLoader.on('uploadBeforeSend', function (object, data) {\n\t                $.extend(data, avatarData);\n\t            });\n\t            $webUpLoader.retry(files);\n\t        }\n\t    });\n\t};\n\t\n\tvar init = function init(callback, uploadOptions, cropperOptions) {\n\t    $noticeBox = $('[data-node=\"noticeBox\"]');\n\t    // $noticeInfo = $noticeBox.find('[data-node=\"noticeInfo\"]');\n\t    $wrap = $('[data-node=\"cropWrap\"]');\n\t    $cropImg = $wrap.find('img');\n\t    $preview = $('[data-node=\"avatrSelector\"]');\n\t    $avatarSave = $('[data-action=\"avatarSave\"]');\n\t    $progress = $noticeBox.find('[data-node=\"uploadProgress\"]');\n\t    $error = $('[data-node=\"error\"]');\n\t    $loadNotice = $noticeBox.find('[data-node=\"loadNotice\"]');\n\t    $retry = $noticeBox.find('[data-action=\"retry\"]');\n\t    defaultImage = $cropImg.attr('data-default');\n\t    var fn = callback || function () {};\n\t    var defaultUpload = {\n\t        pick: {\n\t            id: '[data-defaultAddFile=picker]',\n\t            innerHTML: '<span>+</span>上传头像',\n\t            multiple: false\n\t        },\n\t        thumb: false,\n\t        compress: false,\n\t        accept: {\n\t            title: 'Images',\n\t            extensions: 'jpg,jpeg,png',\n\t            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\n\t        },\n\t        method: 'post',\n\t        // swf文件路径\n\t        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\n\t        disableGlobalDnd: true,\n\t        duplicate: true,\n\t        prepareNextFile: true,\n\t        chunked: true,\n\t        fileVal: 'avatar_file',\n\t        server: '/ajax/crop/crop_img',\n\t        fileNumLimit: 1,\n\t        fileSizeLimit: 4 * 1024 * 1024,\n\t        fileSingleSizeLimit: 4 * 1024 * 1024\n\t    };\n\t    var defaultCropper = {\n\t        aspectRatio: 1,\n\t        preview: $preview.selector,\n\t        background: false,\n\t        guides: false\n\t    };\n\t    var upload = $.extend(true, defaultUpload, uploadOptions);\n\t    var copper = $.extend(true, defaultCropper, cropperOptions);\n\t    preview(upload, copper, fn);\n\t\n\t    submit();\n\t\n\t    return {\n\t        webUpLoader: $webUpLoader, //webuploader实例对象\n\t\n\t        cropper: $cropImg //cropper实例对象\n\t    };\n\t};\n\t\n\tvar destroy = function destroy(callback) {\n\t    callback = callback || function () {};\n\t    callback.call(null, {\n\t        webUpLoader: $webUpLoader, //webuploader实例对象\n\t        cropper: $cropImg //cropper实例对象\n\t    });\n\t    files = undefined;\n\t    $webUpLoader.destroy();\n\t    $cropImg.cropper('destroy');\n\t};\n\t\n\tvar getData = function getData() {\n\t    return link;\n\t};\n\t\n\tmodule.exports = {\n\t    init: init,\n\t    getData: getData,\n\t    destroy: destroy\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n\n/***/ 86:\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* WEBPACK VAR INJECTION */(function(__webpack_provided_window_dot_jQuery) {/*! WebUploader 0.1.5 */\n\t\n\t\n\t/**\n\t * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n\t *\n\t * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n\t */\n\t(function( root, factory ) {\n\t    var modules = {},\n\t\n\t        // 内部require, 简单不完全实现。\n\t        // https://github.com/amdjs/amdjs-api/wiki/require\n\t        _require = function( deps, callback ) {\n\t            var args, len, i;\n\t\n\t            // 如果deps不是数组，则直接返回指定module\n\t            if ( typeof deps === 'string' ) {\n\t                return getModule( deps );\n\t            } else {\n\t                args = [];\n\t                for( len = deps.length, i = 0; i < len; i++ ) {\n\t                    args.push( getModule( deps[ i ] ) );\n\t                }\n\t\n\t                return callback.apply( null, args );\n\t            }\n\t        },\n\t\n\t        // 内部define，暂时不支持不指定id.\n\t        _define = function( id, deps, factory ) {\n\t            if ( arguments.length === 2 ) {\n\t                factory = deps;\n\t                deps = null;\n\t            }\n\t\n\t            _require( deps || [], function() {\n\t                setModule( id, factory, arguments );\n\t            });\n\t        },\n\t\n\t        // 设置module, 兼容CommonJs写法。\n\t        setModule = function( id, factory, args ) {\n\t            var module = {\n\t                    exports: factory\n\t                },\n\t                returned;\n\t\n\t            if ( typeof factory === 'function' ) {\n\t                args.length || (args = [ _require, module.exports, module ,__webpack_provided_window_dot_jQuery]);\n\t                returned = factory.apply( null, args );\n\t                returned !== undefined && (module.exports = returned);\n\t            }\n\t\n\t            modules[ id ] = module.exports;\n\t        },\n\t\n\t        // 根据id获取module\n\t        getModule = function( id ) {\n\t            var module = modules[ id ] || root[ id ];\n\t\n\t            if ( !module ) {\n\t                throw new Error( '`' + id + '` is undefined' );\n\t            }\n\t\n\t            return module;\n\t        },\n\t\n\t        // 将所有modules，将路径ids装换成对象。\n\t        exportsTo = function( obj ) {\n\t            var key, host, parts, part, last, ucFirst;\n\t\n\t            // make the first character upper case.\n\t            ucFirst = function( str ) {\n\t                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n\t            };\n\t\n\t            for ( key in modules ) {\n\t                host = obj;\n\t\n\t                if ( !modules.hasOwnProperty( key ) ) {\n\t                    continue;\n\t                }\n\t\n\t                parts = key.split('/');\n\t                last = ucFirst( parts.pop() );\n\t\n\t                while( (part = ucFirst( parts.shift() )) ) {\n\t                    host[ part ] = host[ part ] || {};\n\t                    host = host[ part ];\n\t                }\n\t\n\t                host[ last ] = modules[ key ];\n\t            }\n\t\n\t            return obj;\n\t        },\n\t\n\t        makeExport = function( dollar ) {\n\t            root.__dollar = dollar;\n\t\n\t            // exports every module.\n\t            return exportsTo( factory( root, _define, _require,__webpack_provided_window_dot_jQuery ) );\n\t        },\n\t\n\t        origin;\n\t\n\t    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\t\n\t        // For CommonJS and CommonJS-like environments where a proper window is present,\n\t        module.exports = makeExport();\n\t    } else if ( true ) {\n\t\n\t        // Allow using this built library as an AMD module\n\t        // in another project. That other project will only\n\t        // see this AMD call, not the internal modules in\n\t        // the closure below.\n\t        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(2) ], __WEBPACK_AMD_DEFINE_FACTORY__ = (makeExport), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t    } else {\n\t\n\t        // Browser globals case. Just assign the\n\t        // result to a property on the global.\n\t        origin = root.WebUploader;\n\t        root.WebUploader = makeExport();\n\t        root.WebUploader.noConflict = function() {\n\t            root.WebUploader = origin;\n\t        };\n\t    }\n\t})( window, function( window, define, require ,jQuery ) {\n\t\n\t\n\t    /**\n\t     * @fileOverview jQuery or Zepto\n\t     */\n\t    define('dollar-third',[],function() {\n\t        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n\t\n\t        if ( !$ ) {\n\t            throw new Error('jQuery or Zepto not found!');\n\t        }\n\t\n\t        return $;\n\t    });\n\t    /**\n\t     * @fileOverview Dom 操作相关\n\t     */\n\t    define('dollar',[\n\t        'dollar-third'\n\t    ], function( _ ) {\n\t        return _;\n\t    });\n\t    /**\n\t     * @fileOverview 使用jQuery的Promise\n\t     */\n\t    define('promise-third',[\n\t        'dollar'\n\t    ], function( $ ) {\n\t        return {\n\t            Deferred: $.Deferred,\n\t            when: $.when,\n\t\n\t            isPromise: function( anything ) {\n\t                return anything && typeof anything.then === 'function';\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * @fileOverview Promise/A+\n\t     */\n\t    define('promise',[\n\t        'promise-third'\n\t    ], function( _ ) {\n\t        return _;\n\t    });\n\t    /**\n\t     * @fileOverview 基础类方法。\n\t     */\n\t\n\t    /**\n\t     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n\t     *\n\t     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n\t     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n\t     *\n\t     * * module `base`：WebUploader.Base\n\t     * * module `file`: WebUploader.File\n\t     * * module `lib/dnd`: WebUploader.Lib.Dnd\n\t     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n\t     *\n\t     *\n\t     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n\t     * @module WebUploader\n\t     * @title WebUploader API文档\n\t     */\n\t    define('base',[\n\t        'dollar',\n\t        'promise'\n\t    ], function( $, promise ) {\n\t\n\t        var noop = function() {},\n\t            call = Function.call;\n\t\n\t        // http://jsperf.com/uncurrythis\n\t        // 反科里化\n\t        function uncurryThis( fn ) {\n\t            return function() {\n\t                return call.apply( fn, arguments );\n\t            };\n\t        }\n\t\n\t        function bindFn( fn, context ) {\n\t            return function() {\n\t                return fn.apply( context, arguments );\n\t            };\n\t        }\n\t\n\t        function createObject( proto ) {\n\t            var f;\n\t\n\t            if ( Object.create ) {\n\t                return Object.create( proto );\n\t            } else {\n\t                f = function() {};\n\t                f.prototype = proto;\n\t                return new f();\n\t            }\n\t        }\n\t\n\t\n\t        /**\n\t         * 基础类，提供一些简单常用的方法。\n\t         * @class Base\n\t         */\n\t        return {\n\t\n\t            /**\n\t             * @property {String} version 当前版本号。\n\t             */\n\t            version: '0.1.5',\n\t\n\t            /**\n\t             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n\t             */\n\t            $: $,\n\t\n\t            Deferred: promise.Deferred,\n\t\n\t            isPromise: promise.isPromise,\n\t\n\t            when: promise.when,\n\t\n\t            /**\n\t             * @description  简单的浏览器检查结果。\n\t             *\n\t             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n\t             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n\t             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n\t             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n\t             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n\t             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n\t             *\n\t             * @property {Object} [browser]\n\t             */\n\t            browser: (function( ua ) {\n\t                var ret = {},\n\t                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n\t                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n\t                        ua.match( /CriOS\\/([\\d.]+)/ ),\n\t\n\t                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n\t                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n\t                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n\t                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n\t                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n\t\n\t                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n\t                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n\t                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n\t                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n\t                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n\t                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n\t\n\t                return ret;\n\t            })( navigator.userAgent ),\n\t\n\t            /**\n\t             * @description  操作系统检查结果。\n\t             *\n\t             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n\t             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n\t             * @property {Object} [os]\n\t             */\n\t            os: (function( ua ) {\n\t                var ret = {},\n\t\n\t                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n\t                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n\t                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n\t\n\t                // osx && (ret.osx = true);\n\t                android && (ret.android = parseFloat( android[ 1 ] ));\n\t                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n\t\n\t                return ret;\n\t            })( navigator.userAgent ),\n\t\n\t            /**\n\t             * 实现类与类之间的继承。\n\t             * @method inherits\n\t             * @grammar Base.inherits( super ) => child\n\t             * @grammar Base.inherits( super, protos ) => child\n\t             * @grammar Base.inherits( super, protos, statics ) => child\n\t             * @param  {Class} super 父类\n\t             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n\t             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n\t             * @param  {Object} [statics] 静态属性或方法。\n\t             * @return {Class} 返回子类。\n\t             * @example\n\t             * function Person() {\n\t             *     console.log( 'Super' );\n\t             * }\n\t             * Person.prototype.hello = function() {\n\t             *     console.log( 'hello' );\n\t             * };\n\t             *\n\t             * var Manager = Base.inherits( Person, {\n\t             *     world: function() {\n\t             *         console.log( 'World' );\n\t             *     }\n\t             * });\n\t             *\n\t             * // 因为没有指定构造器，父类的构造器将会执行。\n\t             * var instance = new Manager();    // => Super\n\t             *\n\t             * // 继承子父类的方法\n\t             * instance.hello();    // => hello\n\t             * instance.world();    // => World\n\t             *\n\t             * // 子类的__super__属性指向父类\n\t             * console.log( Manager.__super__ === Person );    // => true\n\t             */\n\t            inherits: function( Super, protos, staticProtos ) {\n\t                var child;\n\t\n\t                if ( typeof protos === 'function' ) {\n\t                    child = protos;\n\t                    protos = null;\n\t                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n\t                    child = protos.constructor;\n\t                } else {\n\t                    child = function() {\n\t                        return Super.apply( this, arguments );\n\t                    };\n\t                }\n\t\n\t                // 复制静态方法\n\t                $.extend( true, child, Super, staticProtos || {} );\n\t\n\t                /* jshint camelcase: false */\n\t\n\t                // 让子类的__super__属性指向父类。\n\t                child.__super__ = Super.prototype;\n\t\n\t                // 构建原型，添加原型方法或属性。\n\t                // 暂时用Object.create实现。\n\t                child.prototype = createObject( Super.prototype );\n\t                protos && $.extend( true, child.prototype, protos );\n\t\n\t                return child;\n\t            },\n\t\n\t            /**\n\t             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n\t             * @method noop\n\t             */\n\t            noop: noop,\n\t\n\t            /**\n\t             * 返回一个新的方法，此方法将已指定的`context`来执行。\n\t             * @grammar Base.bindFn( fn, context ) => Function\n\t             * @method bindFn\n\t             * @example\n\t             * var doSomething = function() {\n\t             *         console.log( this.name );\n\t             *     },\n\t             *     obj = {\n\t             *         name: 'Object Name'\n\t             *     },\n\t             *     aliasFn = Base.bind( doSomething, obj );\n\t             *\n\t             *  aliasFn();    // => Object Name\n\t             *\n\t             */\n\t            bindFn: bindFn,\n\t\n\t            /**\n\t             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n\t             * @grammar Base.log( args... ) => undefined\n\t             * @method log\n\t             */\n\t            log: (function() {\n\t                if ( window.console ) {\n\t                    return bindFn( console.log, console );\n\t                }\n\t                return noop;\n\t            })(),\n\t\n\t            nextTick: (function() {\n\t\n\t                return function( cb ) {\n\t                    setTimeout( cb, 1 );\n\t                };\n\t\n\t                // @bug 当浏览器不在当前窗口时就停了。\n\t                // var next = window.requestAnimationFrame ||\n\t                //     window.webkitRequestAnimationFrame ||\n\t                //     window.mozRequestAnimationFrame ||\n\t                //     function( cb ) {\n\t                //         window.setTimeout( cb, 1000 / 60 );\n\t                //     };\n\t\n\t                // // fix: Uncaught TypeError: Illegal invocation\n\t                // return bindFn( next, window );\n\t            })(),\n\t\n\t            /**\n\t             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n\t             * 将用来将非数组对象转化成数组对象。\n\t             * @grammar Base.slice( target, start[, end] ) => Array\n\t             * @method slice\n\t             * @example\n\t             * function doSomthing() {\n\t             *     var args = Base.slice( arguments, 1 );\n\t             *     console.log( args );\n\t             * }\n\t             *\n\t             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n\t             */\n\t            slice: uncurryThis( [].slice ),\n\t\n\t            /**\n\t             * 生成唯一的ID\n\t             * @method guid\n\t             * @grammar Base.guid() => String\n\t             * @grammar Base.guid( prefx ) => String\n\t             */\n\t            guid: (function() {\n\t                var counter = 0;\n\t\n\t                return function( prefix ) {\n\t                    var guid = (+new Date()).toString( 32 ),\n\t                        i = 0;\n\t\n\t                    for ( ; i < 5; i++ ) {\n\t                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n\t                    }\n\t\n\t                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n\t                };\n\t            })(),\n\t\n\t            /**\n\t             * 格式化文件大小, 输出成带单位的字符串\n\t             * @method formatSize\n\t             * @grammar Base.formatSize( size ) => String\n\t             * @grammar Base.formatSize( size, pointLength ) => String\n\t             * @grammar Base.formatSize( size, pointLength, units ) => String\n\t             * @param {Number} size 文件大小\n\t             * @param {Number} [pointLength=2] 精确到的小数点数。\n\t             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n\t             * @example\n\t             * console.log( Base.formatSize( 100 ) );    // => 100B\n\t             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n\t             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n\t             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n\t             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n\t             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n\t             */\n\t            formatSize: function( size, pointLength, units ) {\n\t                var unit;\n\t\n\t                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n\t\n\t                while ( (unit = units.shift()) && size > 1024 ) {\n\t                    size = size / 1024;\n\t                }\n\t\n\t                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n\t                        unit;\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n\t     * @fileOverview Mediator\n\t     */\n\t    define('mediator',[\n\t        'base'\n\t    ], function( Base ) {\n\t        var $ = Base.$,\n\t            slice = [].slice,\n\t            separator = /\\s+/,\n\t            protos;\n\t\n\t        // 根据条件过滤出事件handlers.\n\t        function findHandlers( arr, name, callback, context ) {\n\t            return $.grep( arr, function( handler ) {\n\t                return handler &&\n\t                        (!name || handler.e === name) &&\n\t                        (!callback || handler.cb === callback ||\n\t                        handler.cb._cb === callback) &&\n\t                        (!context || handler.ctx === context);\n\t            });\n\t        }\n\t\n\t        function eachEvent( events, callback, iterator ) {\n\t            // 不支持对象，只支持多个event用空格隔开\n\t            $.each( (events || '').split( separator ), function( _, key ) {\n\t                iterator( key, callback );\n\t            });\n\t        }\n\t\n\t        function triggerHanders( events, args ) {\n\t            var stoped = false,\n\t                i = -1,\n\t                len = events.length,\n\t                handler;\n\t\n\t            while ( ++i < len ) {\n\t                handler = events[ i ];\n\t\n\t                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n\t                    stoped = true;\n\t                    break;\n\t                }\n\t            }\n\t\n\t            return !stoped;\n\t        }\n\t\n\t        protos = {\n\t\n\t            /**\n\t             * 绑定事件。\n\t             *\n\t             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n\t             * ```javascript\n\t             * var obj = {};\n\t             *\n\t             * // 使得obj有事件行为\n\t             * Mediator.installTo( obj );\n\t             *\n\t             * obj.on( 'testa', function( arg1, arg2 ) {\n\t             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n\t             * });\n\t             *\n\t             * obj.trigger( 'testa', 'arg1', 'arg2' );\n\t             * ```\n\t             *\n\t             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n\t             * 切会影响到`trigger`方法的返回值，为`false`。\n\t             *\n\t             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n\t             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n\t             * ```javascript\n\t             * obj.on( 'all', function( type, arg1, arg2 ) {\n\t             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n\t             * });\n\t             * ```\n\t             *\n\t             * @method on\n\t             * @grammar on( name, callback[, context] ) => self\n\t             * @param  {String}   name     事件名，支持多个事件用空格隔开\n\t             * @param  {Function} callback 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             * @class Mediator\n\t             */\n\t            on: function( name, callback, context ) {\n\t                var me = this,\n\t                    set;\n\t\n\t                if ( !callback ) {\n\t                    return this;\n\t                }\n\t\n\t                set = this._events || (this._events = []);\n\t\n\t                eachEvent( name, callback, function( name, callback ) {\n\t                    var handler = { e: name };\n\t\n\t                    handler.cb = callback;\n\t                    handler.ctx = context;\n\t                    handler.ctx2 = context || me;\n\t                    handler.id = set.length;\n\t\n\t                    set.push( handler );\n\t                });\n\t\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 绑定事件，且当handler执行完后，自动解除绑定。\n\t             * @method once\n\t             * @grammar once( name, callback[, context] ) => self\n\t             * @param  {String}   name     事件名\n\t             * @param  {Function} callback 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             */\n\t            once: function( name, callback, context ) {\n\t                var me = this;\n\t\n\t                if ( !callback ) {\n\t                    return me;\n\t                }\n\t\n\t                eachEvent( name, callback, function( name, callback ) {\n\t                    var once = function() {\n\t                            me.off( name, once );\n\t                            return callback.apply( context || me, arguments );\n\t                        };\n\t\n\t                    once._cb = callback;\n\t                    me.on( name, once, context );\n\t                });\n\t\n\t                return me;\n\t            },\n\t\n\t            /**\n\t             * 解除事件绑定\n\t             * @method off\n\t             * @grammar off( [name[, callback[, context] ] ] ) => self\n\t             * @param  {String}   [name]     事件名\n\t             * @param  {Function} [callback] 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             */\n\t            off: function( name, cb, ctx ) {\n\t                var events = this._events;\n\t\n\t                if ( !events ) {\n\t                    return this;\n\t                }\n\t\n\t                if ( !name && !cb && !ctx ) {\n\t                    this._events = [];\n\t                    return this;\n\t                }\n\t\n\t                eachEvent( name, cb, function( name, cb ) {\n\t                    $.each( findHandlers( events, name, cb, ctx ), function() {\n\t                        delete events[ this.id ];\n\t                    });\n\t                });\n\t\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 触发事件\n\t             * @method trigger\n\t             * @grammar trigger( name[, args...] ) => self\n\t             * @param  {String}   type     事件名\n\t             * @param  {*} [...] 任意参数\n\t             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n\t             */\n\t            trigger: function( type ) {\n\t                var args, events, allEvents;\n\t\n\t                if ( !this._events || !type ) {\n\t                    return this;\n\t                }\n\t\n\t                args = slice.call( arguments, 1 );\n\t                events = findHandlers( this._events, type );\n\t                allEvents = findHandlers( this._events, 'all' );\n\t\n\t                return triggerHanders( events, args ) &&\n\t                        triggerHanders( allEvents, arguments );\n\t            }\n\t        };\n\t\n\t        /**\n\t         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n\t         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n\t         *\n\t         * @class Mediator\n\t         */\n\t        return $.extend({\n\t\n\t            /**\n\t             * 可以通过这个接口，使任何对象具备事件功能。\n\t             * @method installTo\n\t             * @param  {Object} obj 需要具备事件行为的对象。\n\t             * @return {Object} 返回obj.\n\t             */\n\t            installTo: function( obj ) {\n\t                return $.extend( obj, protos );\n\t            }\n\t\n\t        }, protos );\n\t    });\n\t    /**\n\t     * @fileOverview Uploader上传类\n\t     */\n\t    define('uploader',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        /**\n\t         * 上传入口类。\n\t         * @class Uploader\n\t         * @constructor\n\t         * @grammar new Uploader( opts ) => Uploader\n\t         * @example\n\t         * var uploader = WebUploader.Uploader({\n\t         *     swf: 'path_of_swf/Uploader.swf',\n\t         *\n\t         *     // 开起分片上传。\n\t         *     chunked: true\n\t         * });\n\t         */\n\t        function Uploader( opts ) {\n\t            this.options = $.extend( true, {}, Uploader.options, opts );\n\t            this._init( this.options );\n\t        }\n\t\n\t        // default Options\n\t        // widgets中有相应扩展\n\t        Uploader.options = {};\n\t        Mediator.installTo( Uploader.prototype );\n\t\n\t        // 批量添加纯命令式方法。\n\t        $.each({\n\t            upload: 'start-upload',\n\t            stop: 'stop-upload',\n\t            getFile: 'get-file',\n\t            getFiles: 'get-files',\n\t            addFile: 'add-file',\n\t            addFiles: 'add-file',\n\t            sort: 'sort-files',\n\t            removeFile: 'remove-file',\n\t            cancelFile: 'cancel-file',\n\t            skipFile: 'skip-file',\n\t            retry: 'retry',\n\t            isInProgress: 'is-in-progress',\n\t            makeThumb: 'make-thumb',\n\t            md5File: 'md5-file',\n\t            getDimension: 'get-dimension',\n\t            addButton: 'add-btn',\n\t            predictRuntimeType: 'predict-runtime-type',\n\t            refresh: 'refresh',\n\t            disable: 'disable',\n\t            enable: 'enable',\n\t            reset: 'reset'\n\t        }, function( fn, command ) {\n\t            Uploader.prototype[ fn ] = function() {\n\t                return this.request( command, arguments );\n\t            };\n\t        });\n\t\n\t        $.extend( Uploader.prototype, {\n\t            state: 'pending',\n\t\n\t            _init: function( opts ) {\n\t                var me = this;\n\t\n\t                me.request( 'init', opts, function() {\n\t                    me.state = 'ready';\n\t                    me.trigger('ready');\n\t                });\n\t            },\n\t\n\t            /**\n\t             * 获取或者设置Uploader配置项。\n\t             * @method option\n\t             * @grammar option( key ) => *\n\t             * @grammar option( key, val ) => self\n\t             * @example\n\t             *\n\t             * // 初始状态图片上传前不会压缩\n\t             * var uploader = new WebUploader.Uploader({\n\t             *     compress: null;\n\t             * });\n\t             *\n\t             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n\t             * uploader.option( 'compress', {\n\t             *     width: 1600,\n\t             *     height: 1600\n\t             * });\n\t             */\n\t            option: function( key, val ) {\n\t                var opts = this.options;\n\t\n\t                // setter\n\t                if ( arguments.length > 1 ) {\n\t\n\t                    if ( $.isPlainObject( val ) &&\n\t                            $.isPlainObject( opts[ key ] ) ) {\n\t                        $.extend( opts[ key ], val );\n\t                    } else {\n\t                        opts[ key ] = val;\n\t                    }\n\t\n\t                } else {    // getter\n\t                    return key ? opts[ key ] : opts;\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 获取文件统计信息。返回一个包含一下信息的对象。\n\t             * * `successNum` 上传成功的文件数\n\t             * * `progressNum` 上传中的文件数\n\t             * * `cancelNum` 被删除的文件数\n\t             * * `invalidNum` 无效的文件数\n\t             * * `uploadFailNum` 上传失败的文件数\n\t             * * `queueNum` 还在队列中的文件数\n\t             * * `interruptNum` 被暂停的文件数\n\t             * @method getStats\n\t             * @grammar getStats() => Object\n\t             */\n\t            getStats: function() {\n\t                // return this._mgr.getStats.apply( this._mgr, arguments );\n\t                var stats = this.request('get-stats');\n\t\n\t                return stats ? {\n\t                    successNum: stats.numOfSuccess,\n\t                    progressNum: stats.numOfProgress,\n\t\n\t                    // who care?\n\t                    // queueFailNum: 0,\n\t                    cancelNum: stats.numOfCancel,\n\t                    invalidNum: stats.numOfInvalid,\n\t                    uploadFailNum: stats.numOfUploadFailed,\n\t                    queueNum: stats.numOfQueue,\n\t                    interruptNum: stats.numofInterrupt\n\t                } : {};\n\t            },\n\t\n\t            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n\t            trigger: function( type/*, args...*/ ) {\n\t                var args = [].slice.call( arguments, 1 ),\n\t                    opts = this.options,\n\t                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n\t                        type.substring( 1 );\n\t\n\t                if (\n\t                        // 调用通过on方法注册的handler.\n\t                        Mediator.trigger.apply( this, arguments ) === false ||\n\t\n\t                        // 调用opts.onEvent\n\t                        $.isFunction( opts[ name ] ) &&\n\t                        opts[ name ].apply( this, args ) === false ||\n\t\n\t                        // 调用this.onEvent\n\t                        $.isFunction( this[ name ] ) &&\n\t                        this[ name ].apply( this, args ) === false ||\n\t\n\t                        // 广播所有uploader的事件。\n\t                        Mediator.trigger.apply( Mediator,\n\t                        [ this, type ].concat( args ) ) === false ) {\n\t\n\t                    return false;\n\t                }\n\t\n\t                return true;\n\t            },\n\t\n\t            /**\n\t             * 销毁 webuploader 实例\n\t             * @method destroy\n\t             * @grammar destroy() => undefined\n\t             */\n\t            destroy: function() {\n\t                this.request( 'destroy', arguments );\n\t                this.off();\n\t            },\n\t\n\t            // widgets/widget.js将补充此方法的详细文档。\n\t            request: Base.noop\n\t        });\n\t\n\t        /**\n\t         * 创建Uploader实例，等同于new Uploader( opts );\n\t         * @method create\n\t         * @class Base\n\t         * @static\n\t         * @grammar Base.create( opts ) => Uploader\n\t         */\n\t        Base.create = Uploader.create = function( opts ) {\n\t            return new Uploader( opts );\n\t        };\n\t\n\t        // 暴露Uploader，可以通过它来扩展业务逻辑。\n\t        Base.Uploader = Uploader;\n\t\n\t        return Uploader;\n\t    });\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/runtime',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$,\n\t            factories = {},\n\t\n\t            // 获取对象的第一个key\n\t            getFirstKey = function( obj ) {\n\t                for ( var key in obj ) {\n\t                    if ( obj.hasOwnProperty( key ) ) {\n\t                        return key;\n\t                    }\n\t                }\n\t                return null;\n\t            };\n\t\n\t        // 接口类。\n\t        function Runtime( options ) {\n\t            this.options = $.extend({\n\t                container: document.body\n\t            }, options );\n\t            this.uid = Base.guid('rt_');\n\t        }\n\t\n\t        $.extend( Runtime.prototype, {\n\t\n\t            getContainer: function() {\n\t                var opts = this.options,\n\t                    parent, container;\n\t\n\t                if ( this._container ) {\n\t                    return this._container;\n\t                }\n\t\n\t                parent = $( opts.container || document.body );\n\t                container = $( document.createElement('div') );\n\t\n\t                container.attr( 'id', 'rt_' + this.uid );\n\t                container.css({\n\t                    position: 'absolute',\n\t                    top: '0px',\n\t                    left: '0px',\n\t                    width: '1px',\n\t                    height: '1px',\n\t                    overflow: 'hidden'\n\t                });\n\t\n\t                parent.append( container );\n\t                parent.addClass('webuploader-container');\n\t                this._container = container;\n\t                this._parent = parent;\n\t                return container;\n\t            },\n\t\n\t            init: Base.noop,\n\t            exec: Base.noop,\n\t\n\t            destroy: function() {\n\t                this._container && this._container.remove();\n\t                this._parent && this._parent.removeClass('webuploader-container');\n\t                this.off();\n\t            }\n\t        });\n\t\n\t        Runtime.orders = 'html5,flash';\n\t\n\t\n\t        /**\n\t         * 添加Runtime实现。\n\t         * @param {String} type    类型\n\t         * @param {Runtime} factory 具体Runtime实现。\n\t         */\n\t        Runtime.addRuntime = function( type, factory ) {\n\t            factories[ type ] = factory;\n\t        };\n\t\n\t        Runtime.hasRuntime = function( type ) {\n\t            return !!(type ? factories[ type ] : getFirstKey( factories ));\n\t        };\n\t\n\t        Runtime.create = function( opts, orders ) {\n\t            var type, runtime;\n\t\n\t            orders = orders || Runtime.orders;\n\t            $.each( orders.split( /\\s*,\\s*/g ), function() {\n\t                if ( factories[ this ] ) {\n\t                    type = this;\n\t                    return false;\n\t                }\n\t            });\n\t\n\t            type = type || getFirstKey( factories );\n\t            if ( !type ) {\n\t                throw new Error('Runtime Error');\n\t            }\n\t\n\t            runtime = new factories[ type ]( opts );\n\t            return runtime;\n\t        };\n\t\n\t        Mediator.installTo( Runtime.prototype );\n\t        return Runtime;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/client',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/runtime'\n\t    ], function( Base, Mediator, Runtime ) {\n\t\n\t        var cache;\n\t\n\t        cache = (function() {\n\t            var obj = {};\n\t\n\t            return {\n\t                add: function( runtime ) {\n\t                    obj[ runtime.uid ] = runtime;\n\t                },\n\t\n\t                get: function( ruid, standalone ) {\n\t                    var i;\n\t\n\t                    if ( ruid ) {\n\t                        return obj[ ruid ];\n\t                    }\n\t\n\t                    for ( i in obj ) {\n\t                        // 有些类型不能重用，比如filepicker.\n\t                        if ( standalone && obj[ i ].__standalone ) {\n\t                            continue;\n\t                        }\n\t\n\t                        return obj[ i ];\n\t                    }\n\t\n\t                    return null;\n\t                },\n\t\n\t                remove: function( runtime ) {\n\t                    delete obj[ runtime.uid ];\n\t                }\n\t            };\n\t        })();\n\t\n\t        function RuntimeClient( component, standalone ) {\n\t            var deferred = Base.Deferred(),\n\t                runtime;\n\t\n\t            this.uid = Base.guid('client_');\n\t\n\t            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n\t            this.runtimeReady = function( cb ) {\n\t                return deferred.done( cb );\n\t            };\n\t\n\t            this.connectRuntime = function( opts, cb ) {\n\t\n\t                // already connected.\n\t                if ( runtime ) {\n\t                    throw new Error('already connected!');\n\t                }\n\t\n\t                deferred.done( cb );\n\t\n\t                if ( typeof opts === 'string' && cache.get( opts ) ) {\n\t                    runtime = cache.get( opts );\n\t                }\n\t\n\t                // 像filePicker只能独立存在，不能公用。\n\t                runtime = runtime || cache.get( null, standalone );\n\t\n\t                // 需要创建\n\t                if ( !runtime ) {\n\t                    runtime = Runtime.create( opts, opts.runtimeOrder );\n\t                    runtime.__promise = deferred.promise();\n\t                    runtime.once( 'ready', deferred.resolve );\n\t                    runtime.init();\n\t                    cache.add( runtime );\n\t                    runtime.__client = 1;\n\t                } else {\n\t                    // 来自cache\n\t                    Base.$.extend( runtime.options, opts );\n\t                    runtime.__promise.then( deferred.resolve );\n\t                    runtime.__client++;\n\t                }\n\t\n\t                standalone && (runtime.__standalone = standalone);\n\t                return runtime;\n\t            };\n\t\n\t            this.getRuntime = function() {\n\t                return runtime;\n\t            };\n\t\n\t            this.disconnectRuntime = function() {\n\t                if ( !runtime ) {\n\t                    return;\n\t                }\n\t\n\t                runtime.__client--;\n\t\n\t                if ( runtime.__client <= 0 ) {\n\t                    cache.remove( runtime );\n\t                    delete runtime.__promise;\n\t                    runtime.destroy();\n\t                }\n\t\n\t                runtime = null;\n\t            };\n\t\n\t            this.exec = function() {\n\t                if ( !runtime ) {\n\t                    return;\n\t                }\n\t\n\t                var args = Base.slice( arguments );\n\t                component && args.unshift( component );\n\t\n\t                return runtime.exec.apply( this, args );\n\t            };\n\t\n\t            this.getRuid = function() {\n\t                return runtime && runtime.uid;\n\t            };\n\t\n\t            this.destroy = (function( destroy ) {\n\t                return function() {\n\t                    destroy && destroy.apply( this, arguments );\n\t                    this.trigger('destroy');\n\t                    this.off();\n\t                    this.exec('destroy');\n\t                    this.disconnectRuntime();\n\t                };\n\t            })( this.destroy );\n\t        }\n\t\n\t        Mediator.installTo( RuntimeClient.prototype );\n\t        return RuntimeClient;\n\t    });\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/dnd',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/client'\n\t    ], function( Base, Mediator, RuntimeClent ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function DragAndDrop( opts ) {\n\t            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n\t\n\t            opts.container = $( opts.container );\n\t\n\t            if ( !opts.container.length ) {\n\t                return;\n\t            }\n\t\n\t            RuntimeClent.call( this, 'DragAndDrop' );\n\t        }\n\t\n\t        DragAndDrop.options = {\n\t            accept: null,\n\t            disableGlobalDnd: false\n\t        };\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: DragAndDrop,\n\t\n\t            init: function() {\n\t                var me = this;\n\t\n\t                me.connectRuntime( me.options, function() {\n\t                    me.exec('init');\n\t                    me.trigger('ready');\n\t                });\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( DragAndDrop.prototype );\n\t\n\t        return DragAndDrop;\n\t    });\n\t    /**\n\t     * @fileOverview 组件基类。\n\t     */\n\t    define('widgets/widget',[\n\t        'base',\n\t        'uploader'\n\t    ], function( Base, Uploader ) {\n\t\n\t        var $ = Base.$,\n\t            _init = Uploader.prototype._init,\n\t            _destroy = Uploader.prototype.destroy,\n\t            IGNORE = {},\n\t            widgetClass = [];\n\t\n\t        function isArrayLike( obj ) {\n\t            if ( !obj ) {\n\t                return false;\n\t            }\n\t\n\t            var length = obj.length,\n\t                type = $.type( obj );\n\t\n\t            if ( obj.nodeType === 1 && length ) {\n\t                return true;\n\t            }\n\t\n\t            return type === 'array' || type !== 'function' && type !== 'string' &&\n\t                    (length === 0 || typeof length === 'number' && length > 0 &&\n\t                    (length - 1) in obj);\n\t        }\n\t\n\t        function Widget( uploader ) {\n\t            this.owner = uploader;\n\t            this.options = uploader.options;\n\t        }\n\t\n\t        $.extend( Widget.prototype, {\n\t\n\t            init: Base.noop,\n\t\n\t            // 类Backbone的事件监听声明，监听uploader实例上的事件\n\t            // widget直接无法监听事件，事件只能通过uploader来传递\n\t            invoke: function( apiName, args ) {\n\t\n\t                /*\n\t                    {\n\t                        'make-thumb': 'makeThumb'\n\t                    }\n\t                 */\n\t                var map = this.responseMap;\n\t\n\t                // 如果无API响应声明则忽略\n\t                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n\t                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n\t\n\t                    return IGNORE;\n\t                }\n\t\n\t                return this[ map[ apiName ] ].apply( this, args );\n\t\n\t            },\n\t\n\t            /**\n\t             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n\t             * @method request\n\t             * @grammar request( command, args ) => * | Promise\n\t             * @grammar request( command, args, callback ) => Promise\n\t             * @for  Uploader\n\t             */\n\t            request: function() {\n\t                return this.owner.request.apply( this.owner, arguments );\n\t            }\n\t        });\n\t\n\t        // 扩展Uploader.\n\t        $.extend( Uploader.prototype, {\n\t\n\t            /**\n\t             * @property {String | Array} [disableWidgets=undefined]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n\t             */\n\t\n\t            // 覆写_init用来初始化widgets\n\t            _init: function() {\n\t                var me = this,\n\t                    widgets = me._widgets = [],\n\t                    deactives = me.options.disableWidgets || '';\n\t\n\t                $.each( widgetClass, function( _, klass ) {\n\t                    (!deactives || !~deactives.indexOf( klass._name )) &&\n\t                        widgets.push( new klass( me ) );\n\t                });\n\t\n\t                return _init.apply( me, arguments );\n\t            },\n\t\n\t            request: function( apiName, args, callback ) {\n\t                var i = 0,\n\t                    widgets = this._widgets,\n\t                    len = widgets && widgets.length,\n\t                    rlts = [],\n\t                    dfds = [],\n\t                    widget, rlt, promise, key;\n\t\n\t                args = isArrayLike( args ) ? args : [ args ];\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    widget = widgets[ i ];\n\t                    rlt = widget.invoke( apiName, args );\n\t\n\t                    if ( rlt !== IGNORE ) {\n\t\n\t                        // Deferred对象\n\t                        if ( Base.isPromise( rlt ) ) {\n\t                            dfds.push( rlt );\n\t                        } else {\n\t                            rlts.push( rlt );\n\t                        }\n\t                    }\n\t                }\n\t\n\t                // 如果有callback，则用异步方式。\n\t                if ( callback || dfds.length ) {\n\t                    promise = Base.when.apply( Base, dfds );\n\t                    key = promise.pipe ? 'pipe' : 'then';\n\t\n\t                    // 很重要不能删除。删除了会死循环。\n\t                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n\t                    return promise[ key ](function() {\n\t                                var deferred = Base.Deferred(),\n\t                                    args = arguments;\n\t\n\t                                if ( args.length === 1 ) {\n\t                                    args = args[ 0 ];\n\t                                }\n\t\n\t                                setTimeout(function() {\n\t                                    deferred.resolve( args );\n\t                                }, 1 );\n\t\n\t                                return deferred.promise();\n\t                            })[ callback ? key : 'done' ]( callback || Base.noop );\n\t                } else {\n\t                    return rlts[ 0 ];\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                _destroy.apply( this, arguments );\n\t                this._widgets = null;\n\t            }\n\t        });\n\t\n\t        /**\n\t         * 添加组件\n\t         * @grammar Uploader.register(proto);\n\t         * @grammar Uploader.register(map, proto);\n\t         * @param  {object} responseMap API 名称与函数实现的映射\n\t         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n\t         * @method Uploader.register\n\t         * @for Uploader\n\t         * @example\n\t         * Uploader.register({\n\t         *     'make-thumb': 'makeThumb'\n\t         * }, {\n\t         *     init: function( options ) {},\n\t         *     makeThumb: function() {}\n\t         * });\n\t         *\n\t         * Uploader.register({\n\t         *     'make-thumb': function() {\n\t         *\n\t         *     }\n\t         * });\n\t         */\n\t        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n\t            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n\t                klass;\n\t\n\t            if ( arguments.length === 1 ) {\n\t                widgetProto = responseMap;\n\t\n\t                // 自动生成 map 表。\n\t                $.each(widgetProto, function(key) {\n\t                    if ( key[0] === '_' || key === 'name' ) {\n\t                        key === 'name' && (map.name = widgetProto.name);\n\t                        return;\n\t                    }\n\t\n\t                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n\t                });\n\t\n\t            } else {\n\t                map = $.extend( map, responseMap );\n\t            }\n\t\n\t            widgetProto.responseMap = map;\n\t            klass = Base.inherits( Widget, widgetProto );\n\t            klass._name = map.name;\n\t            widgetClass.push( klass );\n\t\n\t            return klass;\n\t        };\n\t\n\t        /**\n\t         * 删除插件，只有在注册时指定了名字的才能被删除。\n\t         * @grammar Uploader.unRegister(name);\n\t         * @param  {string} name 组件名字\n\t         * @method Uploader.unRegister\n\t         * @for Uploader\n\t         * @example\n\t         *\n\t         * Uploader.register({\n\t         *     name: 'custom',\n\t         *\n\t         *     'make-thumb': function() {\n\t         *\n\t         *     }\n\t         * });\n\t         *\n\t         * Uploader.unRegister('custom');\n\t         */\n\t        Uploader.unRegister = Widget.unRegister = function( name ) {\n\t            if ( !name || name === 'anonymous' ) {\n\t                return;\n\t            }\n\t\n\t            // 删除指定的插件。\n\t            for ( var i = widgetClass.length; i--; ) {\n\t                if ( widgetClass[i]._name === name ) {\n\t                    widgetClass.splice(i, 1)\n\t                }\n\t            }\n\t        };\n\t\n\t        return Widget;\n\t    });\n\t    /**\n\t     * @fileOverview DragAndDrop Widget。\n\t     */\n\t    define('widgets/filednd',[\n\t        'base',\n\t        'uploader',\n\t        'lib/dnd',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Dnd ) {\n\t        var $ = Base.$;\n\t\n\t        Uploader.options.dnd = '';\n\t\n\t        /**\n\t         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t\n\t        /**\n\t         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t\n\t        /**\n\t         * @event dndAccept\n\t         * @param {DataTransferItemList} items DataTransferItem\n\t         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n\t         * @for  Uploader\n\t         */\n\t        return Uploader.register({\n\t            name: 'dnd',\n\t\n\t            init: function( opts ) {\n\t\n\t                if ( !opts.dnd ||\n\t                        this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                var me = this,\n\t                    deferred = Base.Deferred(),\n\t                    options = $.extend({}, {\n\t                        disableGlobalDnd: opts.disableGlobalDnd,\n\t                        container: opts.dnd,\n\t                        accept: opts.accept\n\t                    }),\n\t                    dnd;\n\t\n\t                this.dnd = dnd = new Dnd( options );\n\t\n\t                dnd.once( 'ready', deferred.resolve );\n\t                dnd.on( 'drop', function( files ) {\n\t                    me.request( 'add-file', [ files ]);\n\t                });\n\t\n\t                // 检测文件是否全部允许添加。\n\t                dnd.on( 'accept', function( items ) {\n\t                    return me.owner.trigger( 'dndAccept', items );\n\t                });\n\t\n\t                dnd.init();\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                this.dnd && this.dnd.destroy();\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/filepaste',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/client'\n\t    ], function( Base, Mediator, RuntimeClent ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function FilePaste( opts ) {\n\t            opts = this.options = $.extend({}, opts );\n\t            opts.container = $( opts.container || document.body );\n\t            RuntimeClent.call( this, 'FilePaste' );\n\t        }\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: FilePaste,\n\t\n\t            init: function() {\n\t                var me = this;\n\t\n\t                me.connectRuntime( me.options, function() {\n\t                    me.exec('init');\n\t                    me.trigger('ready');\n\t                });\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( FilePaste.prototype );\n\t\n\t        return FilePaste;\n\t    });\n\t    /**\n\t     * @fileOverview 组件基类。\n\t     */\n\t    define('widgets/filepaste',[\n\t        'base',\n\t        'uploader',\n\t        'lib/filepaste',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, FilePaste ) {\n\t        var $ = Base.$;\n\t\n\t        /**\n\t         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t        return Uploader.register({\n\t            name: 'paste',\n\t\n\t            init: function( opts ) {\n\t\n\t                if ( !opts.paste ||\n\t                        this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                var me = this,\n\t                    deferred = Base.Deferred(),\n\t                    options = $.extend({}, {\n\t                        container: opts.paste,\n\t                        accept: opts.accept\n\t                    }),\n\t                    paste;\n\t\n\t                this.paste = paste = new FilePaste( options );\n\t\n\t                paste.once( 'ready', deferred.resolve );\n\t                paste.on( 'paste', function( files ) {\n\t                    me.owner.request( 'add-file', [ files ]);\n\t                });\n\t                paste.init();\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                this.paste && this.paste.destroy();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Blob\n\t     */\n\t    define('lib/blob',[\n\t        'base',\n\t        'runtime/client'\n\t    ], function( Base, RuntimeClient ) {\n\t\n\t        function Blob( ruid, source ) {\n\t            var me = this;\n\t\n\t            me.source = source;\n\t            me.ruid = ruid;\n\t            this.size = source.size || 0;\n\t\n\t            // 如果没有指定 mimetype, 但是知道文件后缀。\n\t            if ( !source.type && this.ext &&\n\t                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n\t                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n\t            } else {\n\t                this.type = source.type || 'application/octet-stream';\n\t            }\n\t\n\t            RuntimeClient.call( me, 'Blob' );\n\t            this.uid = source.uid || this.uid;\n\t\n\t            if ( ruid ) {\n\t                me.connectRuntime( ruid );\n\t            }\n\t        }\n\t\n\t        Base.inherits( RuntimeClient, {\n\t            constructor: Blob,\n\t\n\t            slice: function( start, end ) {\n\t                return this.exec( 'slice', start, end );\n\t            },\n\t\n\t            getSource: function() {\n\t                return this.source;\n\t            }\n\t        });\n\t\n\t        return Blob;\n\t    });\n\t    /**\n\t     * 为了统一化Flash的File和HTML5的File而存在。\n\t     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n\t     * @fileOverview File\n\t     */\n\t    define('lib/file',[\n\t        'base',\n\t        'lib/blob'\n\t    ], function( Base, Blob ) {\n\t\n\t        var uid = 1,\n\t            rExt = /\\.([^.]+)$/;\n\t\n\t        function File( ruid, file ) {\n\t            var ext;\n\t\n\t            this.name = file.name || ('untitled' + uid++);\n\t            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n\t\n\t            // todo 支持其他类型文件的转换。\n\t            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n\t            if ( !ext && file.type ) {\n\t                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n\t                        RegExp.$1.toLowerCase() : '';\n\t                this.name += '.' + ext;\n\t            }\n\t\n\t            this.ext = ext;\n\t            this.lastModifiedDate = file.lastModifiedDate ||\n\t                    (new Date()).toLocaleString();\n\t\n\t            Blob.apply( this, arguments );\n\t        }\n\t\n\t        return Base.inherits( Blob, File );\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/filepicker',[\n\t        'base',\n\t        'runtime/client',\n\t        'lib/file'\n\t    ], function( Base, RuntimeClent, File ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function FilePicker( opts ) {\n\t            opts = this.options = $.extend({}, FilePicker.options, opts );\n\t\n\t            opts.container = $( opts.id );\n\t\n\t            if ( !opts.container.length ) {\n\t                throw new Error('按钮指定错误');\n\t            }\n\t\n\t            opts.innerHTML = opts.innerHTML || opts.label ||\n\t                    opts.container.html() || '';\n\t\n\t            opts.button = $( opts.button || document.createElement('div') );\n\t            opts.button.html( opts.innerHTML );\n\t            opts.container.html( opts.button );\n\t\n\t            RuntimeClent.call( this, 'FilePicker', true );\n\t        }\n\t\n\t        FilePicker.options = {\n\t            button: null,\n\t            container: null,\n\t            label: null,\n\t            innerHTML: null,\n\t            multiple: true,\n\t            accept: null,\n\t            name: 'file'\n\t        };\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: FilePicker,\n\t\n\t            init: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    button = opts.button;\n\t\n\t                button.addClass('webuploader-pick');\n\t\n\t                me.on( 'all', function( type ) {\n\t                    var files;\n\t\n\t                    switch ( type ) {\n\t                        case 'mouseenter':\n\t                            button.addClass('webuploader-pick-hover');\n\t                            break;\n\t\n\t                        case 'mouseleave':\n\t                            button.removeClass('webuploader-pick-hover');\n\t                            break;\n\t\n\t                        case 'change':\n\t                            files = me.exec('getFiles');\n\t                            me.trigger( 'select', $.map( files, function( file ) {\n\t                                file = new File( me.getRuid(), file );\n\t\n\t                                // 记录来源。\n\t                                file._refer = opts.container;\n\t                                return file;\n\t                            }), opts.container );\n\t                            break;\n\t                    }\n\t                });\n\t\n\t                me.connectRuntime( opts, function() {\n\t                    me.refresh();\n\t                    me.exec( 'init', opts );\n\t                    me.trigger('ready');\n\t                });\n\t\n\t                this._resizeHandler = Base.bindFn( this.refresh, this );\n\t                $( window ).on( 'resize', this._resizeHandler );\n\t            },\n\t\n\t            refresh: function() {\n\t                var shimContainer = this.getRuntime().getContainer(),\n\t                    button = this.options.button,\n\t                    width = button.outerWidth ?\n\t                            button.outerWidth() : button.width(),\n\t\n\t                    height = button.outerHeight ?\n\t                            button.outerHeight() : button.height(),\n\t\n\t                    pos = button.offset();\n\t\n\t                width && height && shimContainer.css({\n\t                    bottom: 'auto',\n\t                    right: 'auto',\n\t                    width: width + 'px',\n\t                    height: height + 'px'\n\t                }).offset( pos );\n\t            },\n\t\n\t            enable: function() {\n\t                var btn = this.options.button;\n\t\n\t                btn.removeClass('webuploader-pick-disable');\n\t                this.refresh();\n\t            },\n\t\n\t            disable: function() {\n\t                var btn = this.options.button;\n\t\n\t                this.getRuntime().getContainer().css({\n\t                    top: '-99999px'\n\t                });\n\t\n\t                btn.addClass('webuploader-pick-disable');\n\t            },\n\t\n\t            destroy: function() {\n\t                var btn = this.options.button;\n\t                $( window ).off( 'resize', this._resizeHandler );\n\t                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n\t                    'webuploader-pick');\n\t            }\n\t        });\n\t\n\t        return FilePicker;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 文件选择相关\n\t     */\n\t    define('widgets/filepicker',[\n\t        'base',\n\t        'uploader',\n\t        'lib/filepicker',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, FilePicker ) {\n\t        var $ = Base.$;\n\t\n\t        $.extend( Uploader.options, {\n\t\n\t            /**\n\t             * @property {Selector | Object} [pick=undefined]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n\t             *\n\t             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n\t             * * `label` {String} 请采用 `innerHTML` 代替\n\t             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n\t             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n\t             */\n\t            pick: null,\n\t\n\t            /**\n\t             * @property {Arroy} [accept=null]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n\t             *\n\t             * * `title` {String} 文字描述\n\t             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n\t             * * `mimeTypes` {String} 多个用逗号分割。\n\t             *\n\t             * 如：\n\t             *\n\t             * ```\n\t             * {\n\t             *     title: 'Images',\n\t             *     extensions: 'gif,jpg,jpeg,bmp,png',\n\t             *     mimeTypes: 'image/*'\n\t             * }\n\t             * ```\n\t             */\n\t            accept: null/*{\n\t                title: 'Images',\n\t                extensions: 'gif,jpg,jpeg,bmp,png',\n\t                mimeTypes: 'image/*'\n\t            }*/\n\t        });\n\t\n\t        return Uploader.register({\n\t            name: 'picker',\n\t\n\t            init: function( opts ) {\n\t                this.pickers = [];\n\t                return opts.pick && this.addBtn( opts.pick );\n\t            },\n\t\n\t            refresh: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.refresh();\n\t                });\n\t            },\n\t\n\t            /**\n\t             * @method addButton\n\t             * @for Uploader\n\t             * @grammar addButton( pick ) => Promise\n\t             * @description\n\t             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n\t             * @example\n\t             * uploader.addButton({\n\t             *     id: '#btnContainer',\n\t             *     innerHTML: '选择文件'\n\t             * });\n\t             */\n\t            addBtn: function( pick ) {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    accept = opts.accept,\n\t                    promises = [];\n\t\n\t                if ( !pick ) {\n\t                    return;\n\t                }\n\t\n\t                $.isPlainObject( pick ) || (pick = {\n\t                    id: pick\n\t                });\n\t\n\t                $( pick.id ).each(function() {\n\t                    var options, picker, deferred;\n\t\n\t                    deferred = Base.Deferred();\n\t\n\t                    options = $.extend({}, pick, {\n\t                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n\t                        swf: opts.swf,\n\t                        runtimeOrder: opts.runtimeOrder,\n\t                        id: this\n\t                    });\n\t\n\t                    picker = new FilePicker( options );\n\t\n\t                    picker.once( 'ready', deferred.resolve );\n\t                    picker.on( 'select', function( files ) {\n\t                        me.owner.request( 'add-file', [ files ]);\n\t                    });\n\t                    picker.init();\n\t\n\t                    me.pickers.push( picker );\n\t\n\t                    promises.push( deferred.promise() );\n\t                });\n\t\n\t                return Base.when.apply( Base, promises );\n\t            },\n\t\n\t            disable: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.disable();\n\t                });\n\t            },\n\t\n\t            enable: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.enable();\n\t                });\n\t            },\n\t\n\t            destroy: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.destroy();\n\t                });\n\t                this.pickers = null;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Image\n\t     */\n\t    define('lib/image',[\n\t        'base',\n\t        'runtime/client',\n\t        'lib/blob'\n\t    ], function( Base, RuntimeClient, Blob ) {\n\t        var $ = Base.$;\n\t\n\t        // 构造器。\n\t        function Image( opts ) {\n\t            this.options = $.extend({}, Image.options, opts );\n\t            RuntimeClient.call( this, 'Image' );\n\t\n\t            this.on( 'load', function() {\n\t                this._info = this.exec('info');\n\t                this._meta = this.exec('meta');\n\t            });\n\t        }\n\t\n\t        // 默认选项。\n\t        Image.options = {\n\t\n\t            // 默认的图片处理质量\n\t            quality: 90,\n\t\n\t            // 是否裁剪\n\t            crop: false,\n\t\n\t            // 是否保留头部信息\n\t            preserveHeaders: false,\n\t\n\t            // 是否允许放大。\n\t            allowMagnify: false\n\t        };\n\t\n\t        // 继承RuntimeClient.\n\t        Base.inherits( RuntimeClient, {\n\t            constructor: Image,\n\t\n\t            info: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._info = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._info;\n\t            },\n\t\n\t            meta: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._meta = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._meta;\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var me = this,\n\t                    ruid = blob.getRuid();\n\t\n\t                this.connectRuntime( ruid, function() {\n\t                    me.exec( 'init', me.options );\n\t                    me.exec( 'loadFromBlob', blob );\n\t                });\n\t            },\n\t\n\t            resize: function() {\n\t                var args = Base.slice( arguments );\n\t                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n\t            },\n\t\n\t            crop: function() {\n\t                var args = Base.slice( arguments );\n\t                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n\t            },\n\t\n\t            getAsDataUrl: function( type ) {\n\t                return this.exec( 'getAsDataUrl', type );\n\t            },\n\t\n\t            getAsBlob: function( type ) {\n\t                var blob = this.exec( 'getAsBlob', type );\n\t\n\t                return new Blob( this.getRuid(), blob );\n\t            }\n\t        });\n\t\n\t        return Image;\n\t    });\n\t    /**\n\t     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n\t     */\n\t    define('widgets/image',[\n\t        'base',\n\t        'uploader',\n\t        'lib/image',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Image ) {\n\t\n\t        var $ = Base.$,\n\t            throttle;\n\t\n\t        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n\t        throttle = (function( max ) {\n\t            var occupied = 0,\n\t                waiting = [],\n\t                tick = function() {\n\t                    var item;\n\t\n\t                    while ( waiting.length && occupied < max ) {\n\t                        item = waiting.shift();\n\t                        occupied += item[ 0 ];\n\t                        item[ 1 ]();\n\t                    }\n\t                };\n\t\n\t            return function( emiter, size, cb ) {\n\t                waiting.push([ size, cb ]);\n\t                emiter.once( 'destroy', function() {\n\t                    occupied -= size;\n\t                    setTimeout( tick, 1 );\n\t                });\n\t                setTimeout( tick, 1 );\n\t            };\n\t        })( 5 * 1024 * 1024 );\n\t\n\t        $.extend( Uploader.options, {\n\t\n\t            /**\n\t             * @property {Object} [thumb]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 配置生成缩略图的选项。\n\t             *\n\t             * 默认为：\n\t             *\n\t             * ```javascript\n\t             * {\n\t             *     width: 110,\n\t             *     height: 110,\n\t             *\n\t             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n\t             *     quality: 70,\n\t             *\n\t             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n\t             *     allowMagnify: true,\n\t             *\n\t             *     // 是否允许裁剪。\n\t             *     crop: true,\n\t             *\n\t             *     // 为空的话则保留原有图片格式。\n\t             *     // 否则强制转换成指定的类型。\n\t             *     type: 'image/jpeg'\n\t             * }\n\t             * ```\n\t             */\n\t            thumb: {\n\t                width: 110,\n\t                height: 110,\n\t                quality: 70,\n\t                allowMagnify: true,\n\t                crop: true,\n\t                preserveHeaders: false,\n\t\n\t                // 为空的话则保留原有图片格式。\n\t                // 否则强制转换成指定的类型。\n\t                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n\t                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n\t                type: 'image/jpeg'\n\t            },\n\t\n\t            /**\n\t             * @property {Object} [compress]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n\t             *\n\t             * 默认为：\n\t             *\n\t             * ```javascript\n\t             * {\n\t             *     width: 1600,\n\t             *     height: 1600,\n\t             *\n\t             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n\t             *     quality: 90,\n\t             *\n\t             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n\t             *     allowMagnify: false,\n\t             *\n\t             *     // 是否允许裁剪。\n\t             *     crop: false,\n\t             *\n\t             *     // 是否保留头部meta信息。\n\t             *     preserveHeaders: true,\n\t             *\n\t             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n\t             *     // 此属性可能会影响图片自动纠正功能\n\t             *     noCompressIfLarger: false,\n\t             *\n\t             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n\t             *     compressSize: 0\n\t             * }\n\t             * ```\n\t             */\n\t            compress: {\n\t                width: 1600,\n\t                height: 1600,\n\t                quality: 90,\n\t                allowMagnify: false,\n\t                crop: false,\n\t                preserveHeaders: true\n\t            }\n\t        });\n\t\n\t        return Uploader.register({\n\t\n\t            name: 'image',\n\t\n\t\n\t            /**\n\t             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n\t             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n\t             *\n\t             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n\t             *\n\t             * `callback`中可以接收到两个参数。\n\t             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n\t             * * 第二个为ret, 缩略图的Data URL值。\n\t             *\n\t             * **注意**\n\t             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n\t             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n\t             *\n\t             * @method makeThumb\n\t             * @grammar makeThumb( file, callback ) => undefined\n\t             * @grammar makeThumb( file, callback, width, height ) => undefined\n\t             * @for Uploader\n\t             * @example\n\t             *\n\t             * uploader.on( 'fileQueued', function( file ) {\n\t             *     var $li = ...;\n\t             *\n\t             *     uploader.makeThumb( file, function( error, ret ) {\n\t             *         if ( error ) {\n\t             *             $li.text('预览错误');\n\t             *         } else {\n\t             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n\t             *         }\n\t             *     });\n\t             *\n\t             * });\n\t             */\n\t            makeThumb: function( file, cb, width, height ) {\n\t                var opts, image;\n\t                var isArtwork = false;\n\t                file = this.request( 'get-file', file );\n\t\n\t                // 只预览图片格式。\n\t                if ( !file.type.match( /^image/ ) ) {\n\t                    cb( true );\n\t                    return;\n\t                }\n\t\n\t                opts = $.extend({}, this.options.thumb );\n\t                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n\t                // 如果传入的是object.\n\t                if ( $.isPlainObject( width ) ) {\n\t                    opts = $.extend( opts, width );\n\t                    width = null;\n\t                }\n\t\n\t                width = width || opts.width;\n\t                height = height || opts.height;\n\t\n\t                image = new Image( opts );\n\t\n\t                image.once( 'load', function() {\n\t                    file._info = file._info || image.info();\n\t                    file._meta = file._meta || image.meta();\n\t\n\t                    // 如果 width 的值介于 0 - 1\n\t                    // 说明设置的是百分比。\n\t                    if ( width <= 1 && width > 0 ) {\n\t                        width = file._info.width * width;\n\t                    }\n\t\n\t                    // 同样的规则应用于 height\n\t                    if ( height <= 1 && height > 0 ) {\n\t                        height = file._info.height * height;\n\t                    }\n\t                    if( isArtwork ){\n\t                        image.resize( file._info.width, file._info.height );\n\t\n\t                    }else{\n\t                        image.resize( width, height );\n\t\n\t\n\t                    }\n\t\n\t                });\n\t\n\t                // 当 resize 完后\n\t                image.once( 'complete', function() {\n\t                    cb( false, image.getAsDataUrl( opts.type ) );\n\t                    image.destroy();\n\t                });\n\t\n\t                image.once( 'error', function( reason ) {\n\t                    cb( reason || true );\n\t                    image.destroy();\n\t                });\n\t\n\t                throttle( image, file.source.size, function() {\n\t                    file._info && image.info( file._info );\n\t                    file._meta && image.meta( file._meta );\n\t                    image.loadFromBlob( file.source );\n\t                });\n\t            },\n\t\n\t            beforeSendFile: function( file ) {\n\t                var opts = this.options.compress || this.options.resize,\n\t                    compressSize = opts && opts.compressSize || 0,\n\t                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n\t                    image, deferred;\n\t\n\t                file = this.request( 'get-file', file );\n\t\n\t                // 只压缩 jpeg 图片格式。\n\t                // gif 可能会丢失针\n\t                // bmp png 基本上尺寸都不大，且压缩比比较小。\n\t                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n\t                        file.size < compressSize ||\n\t                        file._compressed ) {\n\t                    return;\n\t                }\n\t\n\t                opts = $.extend({}, opts );\n\t                deferred = Base.Deferred();\n\t\n\t                image = new Image( opts );\n\t\n\t                deferred.always(function() {\n\t                    image.destroy();\n\t                    image = null;\n\t                });\n\t                image.once( 'error', deferred.reject );\n\t                image.once( 'load', function() {\n\t                    var width = opts.width,\n\t                        height = opts.height;\n\t\n\t                    file._info = file._info || image.info();\n\t                    file._meta = file._meta || image.meta();\n\t\n\t                    // 如果 width 的值介于 0 - 1\n\t                    // 说明设置的是百分比。\n\t                    if ( width <= 1 && width > 0 ) {\n\t                        width = file._info.width * width;\n\t                    }\n\t\n\t                    // 同样的规则应用于 height\n\t                    if ( height <= 1 && height > 0 ) {\n\t                        height = file._info.height * height;\n\t                    }\n\t\n\t                    image.resize( width, height );\n\t                });\n\t\n\t                image.once( 'complete', function() {\n\t                    var blob, size;\n\t\n\t                    // 移动端 UC / qq 浏览器的无图模式下\n\t                    // ctx.getImageData 处理大图的时候会报 Exception\n\t                    // INDEX_SIZE_ERR: DOM Exception 1\n\t                    try {\n\t                        blob = image.getAsBlob( opts.type );\n\t\n\t                        size = file.size;\n\t\n\t                        // 如果压缩后，比原来还大则不用压缩后的。\n\t                        if ( !noCompressIfLarger || blob.size < size ) {\n\t                            // file.source.destroy && file.source.destroy();\n\t                            file.source = blob;\n\t                            file.size = blob.size;\n\t\n\t                            file.trigger( 'resize', blob.size, size );\n\t                        }\n\t\n\t                        // 标记，避免重复压缩。\n\t                        file._compressed = true;\n\t                        deferred.resolve();\n\t                    } catch ( e ) {\n\t                        // 出错了直接继续，让其上传原始图片\n\t                        deferred.resolve();\n\t                    }\n\t                });\n\t\n\t                file._info && image.info( file._info );\n\t                file._meta && image.meta( file._meta );\n\t\n\t                image.loadFromBlob( file.source );\n\t                return deferred.promise();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 文件属性封装\n\t     */\n\t    define('file',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$,\n\t            idPrefix = 'WU_FILE_',\n\t            idSuffix = 0,\n\t            rExt = /\\.([^.]+)$/,\n\t            statusMap = {};\n\t\n\t        function gid() {\n\t            return idPrefix + idSuffix++;\n\t        }\n\t\n\t        /**\n\t         * 文件类\n\t         * @class File\n\t         * @constructor 构造函数\n\t         * @grammar new File( source ) => File\n\t         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n\t         */\n\t        function WUFile( source ) {\n\t\n\t            /**\n\t             * 文件名，包括扩展名（后缀）\n\t             * @property name\n\t             * @type {string}\n\t             */\n\t            this.name = source.name || 'Untitled';\n\t\n\t            /**\n\t             * 文件体积（字节）\n\t             * @property size\n\t             * @type {uint}\n\t             * @default 0\n\t             */\n\t            this.size = source.size || 0;\n\t\n\t            /**\n\t             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n\t             * @property type\n\t             * @type {string}\n\t             * @default 'application/octet-stream'\n\t             */\n\t            this.type = source.type || 'application/octet-stream';\n\t\n\t            /**\n\t             * 文件最后修改日期\n\t             * @property lastModifiedDate\n\t             * @type {int}\n\t             * @default 当前时间戳\n\t             */\n\t            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n\t\n\t            /**\n\t             * 文件ID，每个对象具有唯一ID，与文件名无关\n\t             * @property id\n\t             * @type {string}\n\t             */\n\t            this.id = gid();\n\t\n\t            /**\n\t             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n\t             * @property ext\n\t             * @type {string}\n\t             */\n\t            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n\t\n\t\n\t            /**\n\t             * 状态文字说明。在不同的status语境下有不同的用途。\n\t             * @property statusText\n\t             * @type {string}\n\t             */\n\t            this.statusText = '';\n\t\n\t            // 存储文件状态，防止通过属性直接修改\n\t            statusMap[ this.id ] = WUFile.Status.INITED;\n\t\n\t            this.source = source;\n\t            this.loaded = 0;\n\t\n\t            this.on( 'error', function( msg ) {\n\t                this.setStatus( WUFile.Status.ERROR, msg );\n\t            });\n\t        }\n\t\n\t        $.extend( WUFile.prototype, {\n\t\n\t            /**\n\t             * 设置状态，状态变化时会触发`change`事件。\n\t             * @method setStatus\n\t             * @grammar setStatus( status[, statusText] );\n\t             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n\t             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n\t             */\n\t            setStatus: function( status, text ) {\n\t\n\t                var prevStatus = statusMap[ this.id ];\n\t\n\t                typeof text !== 'undefined' && (this.statusText = text);\n\t\n\t                if ( status !== prevStatus ) {\n\t                    statusMap[ this.id ] = status;\n\t                    /**\n\t                     * 文件状态变化\n\t                     * @event statuschange\n\t                     */\n\t                    this.trigger( 'statuschange', status, prevStatus );\n\t                }\n\t\n\t            },\n\t\n\t            /**\n\t             * 获取文件状态\n\t             * @return {File.Status}\n\t             * @example\n\t                     文件状态具体包括以下几种类型：\n\t                     {\n\t                         // 初始化\n\t                        INITED:     0,\n\t                        // 已入队列\n\t                        QUEUED:     1,\n\t                        // 正在上传\n\t                        PROGRESS:     2,\n\t                        // 上传出错\n\t                        ERROR:         3,\n\t                        // 上传成功\n\t                        COMPLETE:     4,\n\t                        // 上传取消\n\t                        CANCELLED:     5\n\t                    }\n\t             */\n\t            getStatus: function() {\n\t                return statusMap[ this.id ];\n\t            },\n\t\n\t            /**\n\t             * 获取文件原始信息。\n\t             * @return {*}\n\t             */\n\t            getSource: function() {\n\t                return this.source;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.off();\n\t                delete statusMap[ this.id ];\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( WUFile.prototype );\n\t\n\t        /**\n\t         * 文件状态值，具体包括以下几种类型：\n\t         * * `inited` 初始状态\n\t         * * `queued` 已经进入队列, 等待上传\n\t         * * `progress` 上传中\n\t         * * `complete` 上传完成。\n\t         * * `error` 上传出错，可重试\n\t         * * `interrupt` 上传中断，可续传。\n\t         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n\t         * * `cancelled` 文件被移除。\n\t         * @property {Object} Status\n\t         * @namespace File\n\t         * @class File\n\t         * @static\n\t         */\n\t        WUFile.Status = {\n\t            INITED:     'inited',    // 初始状态\n\t            QUEUED:     'queued',    // 已经进入队列, 等待上传\n\t            PROGRESS:   'progress',    // 上传中\n\t            ERROR:      'error',    // 上传出错，可重试\n\t            COMPLETE:   'complete',    // 上传完成。\n\t            CANCELLED:  'cancelled',    // 上传取消。\n\t            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n\t            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n\t        };\n\t\n\t        return WUFile;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 文件队列\n\t     */\n\t    define('queue',[\n\t        'base',\n\t        'mediator',\n\t        'file'\n\t    ], function( Base, Mediator, WUFile ) {\n\t\n\t        var $ = Base.$,\n\t            STATUS = WUFile.Status;\n\t\n\t        /**\n\t         * 文件队列, 用来存储各个状态中的文件。\n\t         * @class Queue\n\t         * @extends Mediator\n\t         */\n\t        function Queue() {\n\t\n\t            /**\n\t             * 统计文件数。\n\t             * * `numOfQueue` 队列中的文件数。\n\t             * * `numOfSuccess` 上传成功的文件数\n\t             * * `numOfCancel` 被取消的文件数\n\t             * * `numOfProgress` 正在上传中的文件数\n\t             * * `numOfUploadFailed` 上传错误的文件数。\n\t             * * `numOfInvalid` 无效的文件数。\n\t             * * `numofDeleted` 被移除的文件数。\n\t             * @property {Object} stats\n\t             */\n\t            this.stats = {\n\t                numOfQueue: 0,\n\t                numOfSuccess: 0,\n\t                numOfCancel: 0,\n\t                numOfProgress: 0,\n\t                numOfUploadFailed: 0,\n\t                numOfInvalid: 0,\n\t                numofDeleted: 0,\n\t                numofInterrupt: 0\n\t            };\n\t\n\t            // 上传队列，仅包括等待上传的文件\n\t            this._queue = [];\n\t\n\t            // 存储所有文件\n\t            this._map = {};\n\t        }\n\t\n\t        $.extend( Queue.prototype, {\n\t\n\t            /**\n\t             * 将新文件加入对队列尾部\n\t             *\n\t             * @method append\n\t             * @param  {File} file   文件对象\n\t             */\n\t            append: function( file ) {\n\t                this._queue.push( file );\n\t                this._fileAdded( file );\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 将新文件加入对队列头部\n\t             *\n\t             * @method prepend\n\t             * @param  {File} file   文件对象\n\t             */\n\t            prepend: function( file ) {\n\t                this._queue.unshift( file );\n\t                this._fileAdded( file );\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 获取文件对象\n\t             *\n\t             * @method getFile\n\t             * @param  {String} fileId   文件ID\n\t             * @return {File}\n\t             */\n\t            getFile: function( fileId ) {\n\t                if ( typeof fileId !== 'string' ) {\n\t                    return fileId;\n\t                }\n\t                return this._map[ fileId ];\n\t            },\n\t\n\t            /**\n\t             * 从队列中取出一个指定状态的文件。\n\t             * @grammar fetch( status ) => File\n\t             * @method fetch\n\t             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n\t             * @return {File} [File](#WebUploader:File)\n\t             */\n\t            fetch: function( status ) {\n\t                var len = this._queue.length,\n\t                    i, file;\n\t\n\t                status = status || STATUS.QUEUED;\n\t\n\t                for ( i = 0; i < len; i++ ) {\n\t                    file = this._queue[ i ];\n\t\n\t                    if ( status === file.getStatus() ) {\n\t                        return file;\n\t                    }\n\t                }\n\t\n\t                return null;\n\t            },\n\t\n\t            /**\n\t             * 对队列进行排序，能够控制文件上传顺序。\n\t             * @grammar sort( fn ) => undefined\n\t             * @method sort\n\t             * @param {Function} fn 排序方法\n\t             */\n\t            sort: function( fn ) {\n\t                if ( typeof fn === 'function' ) {\n\t                    this._queue.sort( fn );\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n\t             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n\t             * @method getFiles\n\t             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n\t             */\n\t            getFiles: function() {\n\t                var sts = [].slice.call( arguments, 0 ),\n\t                    ret = [],\n\t                    i = 0,\n\t                    len = this._queue.length,\n\t                    file;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    file = this._queue[ i ];\n\t\n\t                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n\t                        continue;\n\t                    }\n\t\n\t                    ret.push( file );\n\t                }\n\t\n\t                return ret;\n\t            },\n\t\n\t            /**\n\t             * 在队列中删除文件。\n\t             * @grammar removeFile( file ) => Array\n\t             * @method removeFile\n\t             * @param {File} 文件对象。\n\t             */\n\t            removeFile: function( file ) {\n\t                var me = this,\n\t                    existing = this._map[ file.id ];\n\t\n\t                if ( existing ) {\n\t                    delete this._map[ file.id ];\n\t                    file.destroy();\n\t                    this.stats.numofDeleted++;\n\t                }\n\t            },\n\t\n\t            _fileAdded: function( file ) {\n\t                var me = this,\n\t                    existing = this._map[ file.id ];\n\t\n\t                if ( !existing ) {\n\t                    this._map[ file.id ] = file;\n\t\n\t                    file.on( 'statuschange', function( cur, pre ) {\n\t                        me._onFileStatusChange( cur, pre );\n\t                    });\n\t                }\n\t            },\n\t\n\t            _onFileStatusChange: function( curStatus, preStatus ) {\n\t                var stats = this.stats;\n\t\n\t                switch ( preStatus ) {\n\t                    case STATUS.PROGRESS:\n\t                        stats.numOfProgress--;\n\t                        break;\n\t\n\t                    case STATUS.QUEUED:\n\t                        stats.numOfQueue --;\n\t                        break;\n\t\n\t                    case STATUS.ERROR:\n\t                        stats.numOfUploadFailed--;\n\t                        break;\n\t\n\t                    case STATUS.INVALID:\n\t                        stats.numOfInvalid--;\n\t                        break;\n\t\n\t                    case STATUS.INTERRUPT:\n\t                        stats.numofInterrupt--;\n\t                        break;\n\t                }\n\t\n\t                switch ( curStatus ) {\n\t                    case STATUS.QUEUED:\n\t                        stats.numOfQueue++;\n\t                        break;\n\t\n\t                    case STATUS.PROGRESS:\n\t                        stats.numOfProgress++;\n\t                        break;\n\t\n\t                    case STATUS.ERROR:\n\t                        stats.numOfUploadFailed++;\n\t                        break;\n\t\n\t                    case STATUS.COMPLETE:\n\t                        stats.numOfSuccess++;\n\t                        break;\n\t\n\t                    case STATUS.CANCELLED:\n\t                        stats.numOfCancel++;\n\t                        break;\n\t\n\t\n\t                    case STATUS.INVALID:\n\t                        stats.numOfInvalid++;\n\t                        break;\n\t\n\t                    case STATUS.INTERRUPT:\n\t                        stats.numofInterrupt++;\n\t                        break;\n\t                }\n\t            }\n\t\n\t        });\n\t\n\t        Mediator.installTo( Queue.prototype );\n\t\n\t        return Queue;\n\t    });\n\t    /**\n\t     * @fileOverview 队列\n\t     */\n\t    define('widgets/queue',[\n\t        'base',\n\t        'uploader',\n\t        'queue',\n\t        'file',\n\t        'lib/file',\n\t        'runtime/client',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n\t\n\t        var $ = Base.$,\n\t            rExt = /\\.\\w+$/,\n\t            Status = WUFile.Status;\n\t\n\t        return Uploader.register({\n\t            name: 'queue',\n\t\n\t            init: function( opts ) {\n\t                var me = this,\n\t                    deferred, len, i, item, arr, accept, runtime;\n\t\n\t                if ( $.isPlainObject( opts.accept ) ) {\n\t                    opts.accept = [ opts.accept ];\n\t                }\n\t\n\t                // accept中的中生成匹配正则。\n\t                if ( opts.accept ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        item = opts.accept[ i ].extensions;\n\t                        item && arr.push( item );\n\t                    }\n\t\n\t                    if ( arr.length ) {\n\t                        accept = '\\\\.' + arr.join(',')\n\t                                .replace( /,/g, '$|\\\\.' )\n\t                                .replace( /\\*/g, '.*' ) + '$';\n\t                    }\n\t\n\t                    me.accept = new RegExp( accept, 'i' );\n\t                }\n\t\n\t                me.queue = new Queue();\n\t                me.stats = me.queue.stats;\n\t\n\t                // 如果当前不是html5运行时，那就算了。\n\t                // 不执行后续操作\n\t                if ( this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                // 创建一个 html5 运行时的 placeholder\n\t                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n\t                deferred = Base.Deferred();\n\t                this.placeholder = runtime = new RuntimeClient('Placeholder');\n\t                runtime.connectRuntime({\n\t                    runtimeOrder: 'html5'\n\t                }, function() {\n\t                    me._ruid = runtime.getRuid();\n\t                    deferred.resolve();\n\t                });\n\t                return deferred.promise();\n\t            },\n\t\n\t\n\t            // 为了支持外部直接添加一个原生File对象。\n\t            _wrapFile: function( file ) {\n\t                if ( !(file instanceof WUFile) ) {\n\t\n\t                    if ( !(file instanceof File) ) {\n\t                        if ( !this._ruid ) {\n\t                            throw new Error('Can\\'t add external files.');\n\t                        }\n\t                        file = new File( this._ruid, file );\n\t                    }\n\t\n\t                    file = new WUFile( file );\n\t                }\n\t\n\t                return file;\n\t            },\n\t\n\t            // 判断文件是否可以被加入队列\n\t            acceptFile: function( file ) {\n\t                 var invalid = !file || !file.size || this.accept &&\n\t\n\t                        // 如果名字中有后缀，才做后缀白名单处理。\n\t                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n\t                return !invalid;\n\t            },\n\t\n\t\n\t            /**\n\t             * @event beforeFileQueued\n\t             * @param {File} file File对象\n\t             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event fileQueued\n\t             * @param {File} file File对象\n\t             * @description 当文件被加入队列以后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            _addFile: function( file ) {\n\t                var me = this;\n\t\n\t                file = me._wrapFile( file );\n\t\n\t                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n\t                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n\t                    return;\n\t                }\n\t\n\t                // 类型不匹配，则派送错误事件，并返回。\n\t                if ( !me.acceptFile( file ) ) {\n\t                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n\t                    return;\n\t                }\n\t\n\t                me.queue.append( file );\n\t                me.owner.trigger( 'fileQueued', file );\n\t                return file;\n\t            },\n\t\n\t            getFile: function( fileId ) {\n\t                return this.queue.getFile( fileId );\n\t            },\n\t\n\t            /**\n\t             * @event filesQueued\n\t             * @param {File} files 数组，内容为原始File(lib/File）对象。\n\t             * @description 当一批文件添加进队列以后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @property {Boolean} [auto=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n\t             *\n\t             */\n\t\n\t            /**\n\t             * @method addFiles\n\t             * @grammar addFiles( file ) => undefined\n\t             * @grammar addFiles( [file1, file2 ...] ) => undefined\n\t             * @param {Array of File or File} [files] Files 对象 数组\n\t             * @description 添加文件到队列\n\t             * @for  Uploader\n\t             */\n\t            addFile: function( files ) {\n\t                var me = this;\n\t\n\t                if ( !files.length ) {\n\t                    files = [ files ];\n\t                }\n\t\n\t                files = $.map( files, function( file ) {\n\t                    return me._addFile( file );\n\t                });\n\t\n\t                me.owner.trigger( 'filesQueued', files );\n\t\n\t                if ( me.options.auto ) {\n\t                    setTimeout(function() {\n\t                        me.request('start-upload');\n\t                    }, 20 );\n\t                }\n\t            },\n\t\n\t            getStats: function() {\n\t                return this.stats;\n\t            },\n\t\n\t            /**\n\t             * @event fileDequeued\n\t             * @param {File} file File对象\n\t             * @description 当文件被移除队列后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t             /**\n\t             * @method removeFile\n\t             * @grammar removeFile( file ) => undefined\n\t             * @grammar removeFile( id ) => undefined\n\t             * @grammar removeFile( file, true ) => undefined\n\t             * @grammar removeFile( id, true ) => undefined\n\t             * @param {File|id} file File对象或这File对象的id\n\t             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n\t             * @for  Uploader\n\t             * @example\n\t             *\n\t             * $li.on('click', '.remove-this', function() {\n\t             *     uploader.removeFile( file );\n\t             * })\n\t             */\n\t            removeFile: function( file, remove ) {\n\t                var me = this;\n\t\n\t                file = file.id ? file : me.queue.getFile( file );\n\t\n\t                this.request( 'cancel-file', file );\n\t\n\t                if ( remove ) {\n\t                    this.queue.removeFile( file );\n\t                }\n\t            },\n\t\n\t            /**\n\t             * @method getFiles\n\t             * @grammar getFiles() => Array\n\t             * @grammar getFiles( status1, status2, status... ) => Array\n\t             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n\t             * @for  Uploader\n\t             * @example\n\t             * console.log( uploader.getFiles() );    // => all files\n\t             * console.log( uploader.getFiles('error') )    // => all error files.\n\t             */\n\t            getFiles: function() {\n\t                return this.queue.getFiles.apply( this.queue, arguments );\n\t            },\n\t\n\t            fetchFile: function() {\n\t                return this.queue.fetch.apply( this.queue, arguments );\n\t            },\n\t\n\t            /**\n\t             * @method retry\n\t             * @grammar retry() => undefined\n\t             * @grammar retry( file ) => undefined\n\t             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n\t             * @for  Uploader\n\t             * @example\n\t             * function retry() {\n\t             *     uploader.retry();\n\t             * }\n\t             */\n\t            retry: function( file, noForceStart ) {\n\t                var me = this,\n\t                    files, i, len;\n\t\n\t                if ( file ) {\n\t                    file = file.id ? file : me.queue.getFile( file );\n\t                    file.setStatus( Status.QUEUED );\n\t                    noForceStart || me.request('start-upload');\n\t                    return;\n\t                }\n\t\n\t                files = me.queue.getFiles( Status.ERROR );\n\t                i = 0;\n\t                len = files.length;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    file = files[ i ];\n\t                    file.setStatus( Status.QUEUED );\n\t                }\n\t\n\t                me.request('start-upload');\n\t            },\n\t\n\t            /**\n\t             * @method sort\n\t             * @grammar sort( fn ) => undefined\n\t             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n\t             * @for  Uploader\n\t             */\n\t            sortFiles: function() {\n\t                return this.queue.sort.apply( this.queue, arguments );\n\t            },\n\t\n\t            /**\n\t             * @event reset\n\t             * @description 当 uploader 被重置的时候触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @method reset\n\t             * @grammar reset() => undefined\n\t             * @description 重置uploader。目前只重置了队列。\n\t             * @for  Uploader\n\t             * @example\n\t             * uploader.reset();\n\t             */\n\t            reset: function() {\n\t                this.owner.trigger('reset');\n\t                this.queue = new Queue();\n\t                this.stats = this.queue.stats;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.reset();\n\t                this.placeholder && this.placeholder.destroy();\n\t            }\n\t        });\n\t\n\t    });\n\t    /**\n\t     * @fileOverview 添加获取Runtime相关信息的方法。\n\t     */\n\t    define('widgets/runtime',[\n\t        'uploader',\n\t        'runtime/runtime',\n\t        'widgets/widget'\n\t    ], function( Uploader, Runtime ) {\n\t\n\t        Uploader.support = function() {\n\t            return Runtime.hasRuntime.apply( Runtime, arguments );\n\t        };\n\t\n\t        /**\n\t         * @property {Object} [runtimeOrder=html5,flash]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n\t         *\n\t         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n\t         */\n\t\n\t        return Uploader.register({\n\t            name: 'runtime',\n\t\n\t            init: function() {\n\t                if ( !this.predictRuntimeType() ) {\n\t                    throw Error('Runtime Error');\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 预测Uploader将采用哪个`Runtime`\n\t             * @grammar predictRuntimeType() => String\n\t             * @method predictRuntimeType\n\t             * @for  Uploader\n\t             */\n\t            predictRuntimeType: function() {\n\t                var orders = this.options.runtimeOrder || Runtime.orders,\n\t                    type = this.type,\n\t                    i, len;\n\t\n\t                if ( !type ) {\n\t                    orders = orders.split( /\\s*,\\s*/g );\n\t\n\t                    for ( i = 0, len = orders.length; i < len; i++ ) {\n\t                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n\t                            this.type = type = orders[ i ];\n\t                            break;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                return type;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Transport\n\t     */\n\t    define('lib/transport',[\n\t        'base',\n\t        'runtime/client',\n\t        'mediator'\n\t    ], function( Base, RuntimeClient, Mediator ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function Transport( opts ) {\n\t            var me = this;\n\t\n\t            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n\t            RuntimeClient.call( this, 'Transport' );\n\t\n\t            this._blob = null;\n\t            this._formData = opts.formData || {};\n\t            this._headers = opts.headers || {};\n\t\n\t            this.on( 'progress', this._timeout );\n\t            this.on( 'load error', function() {\n\t                me.trigger( 'progress', 1 );\n\t                clearTimeout( me._timer );\n\t            });\n\t        }\n\t\n\t        Transport.options = {\n\t            server: '',\n\t            method: 'POST',\n\t\n\t            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n\t            withCredentials: false,\n\t            fileVal: 'file',\n\t            timeout: 2 * 60 * 1000,    // 2分钟\n\t            formData: {},\n\t            headers: {},\n\t            sendAsBinary: false\n\t        };\n\t\n\t        $.extend( Transport.prototype, {\n\t\n\t            // 添加Blob, 只能添加一次，最后一次有效。\n\t            appendBlob: function( key, blob, filename ) {\n\t                var me = this,\n\t                    opts = me.options;\n\t\n\t                if ( me.getRuid() ) {\n\t                    me.disconnectRuntime();\n\t                }\n\t\n\t                // 连接到blob归属的同一个runtime.\n\t                me.connectRuntime( blob.ruid, function() {\n\t                    me.exec('init');\n\t                });\n\t\n\t                me._blob = blob;\n\t                opts.fileVal = key || opts.fileVal;\n\t                opts.filename = filename || opts.filename;\n\t\n\t            },\n\t\n\t            // 添加其他字段\n\t            append: function( key, value ) {\n\t                if ( typeof key === 'object' ) {\n\t                    $.extend( this._formData, key );\n\t                } else {\n\t                    this._formData[ key ] = value;\n\t                }\n\t            },\n\t\n\t            setRequestHeader: function( key, value ) {\n\t                if ( typeof key === 'object' ) {\n\t                    $.extend( this._headers, key );\n\t                } else {\n\t                    this._headers[ key ] = value;\n\t                }\n\t            },\n\t\n\t            send: function( method ) {\n\t                this.exec( 'send', method );\n\t                this._timeout();\n\t            },\n\t\n\t            abort: function() {\n\t                clearTimeout( this._timer );\n\t                return this.exec('abort');\n\t            },\n\t\n\t            destroy: function() {\n\t                this.trigger('destroy');\n\t                this.off();\n\t                this.exec('destroy');\n\t                this.disconnectRuntime();\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this.exec('getResponse');\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this.exec('getResponseAsJson');\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this.exec('getStatus');\n\t            },\n\t\n\t            _timeout: function() {\n\t                var me = this,\n\t                    duration = me.options.timeout;\n\t\n\t                if ( !duration ) {\n\t                    return;\n\t                }\n\t\n\t                clearTimeout( me._timer );\n\t                me._timer = setTimeout(function() {\n\t                    me.abort();\n\t                    me.trigger( 'error', 'timeout' );\n\t                }, duration );\n\t            }\n\t\n\t        });\n\t\n\t        // 让Transport具备事件功能。\n\t        Mediator.installTo( Transport.prototype );\n\t\n\t        return Transport;\n\t    });\n\t    /**\n\t     * @fileOverview 负责文件上传相关。\n\t     */\n\t    define('widgets/upload',[\n\t        'base',\n\t        'uploader',\n\t        'file',\n\t        'lib/transport',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, WUFile, Transport ) {\n\t\n\t        var $ = Base.$,\n\t            isPromise = Base.isPromise,\n\t            Status = WUFile.Status;\n\t\n\t        // 添加默认配置项\n\t        $.extend( Uploader.options, {\n\t\n\t\n\t            /**\n\t             * @property {Boolean} [prepareNextFile=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否允许在文件传输时提前把下一个文件准备好。\n\t             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n\t             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n\t             */\n\t            prepareNextFile: false,\n\t\n\t            /**\n\t             * @property {Boolean} [chunked=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否要分片处理大文件上传。\n\t             */\n\t            chunked: false,\n\t\n\t            /**\n\t             * @property {Boolean} [chunkSize=5242880]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 如果要分片，分多大一片？ 默认大小为5M.\n\t             */\n\t            chunkSize: 5 * 1024 * 1024,\n\t\n\t            /**\n\t             * @property {Boolean} [chunkRetry=2]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n\t             */\n\t            chunkRetry: 2,\n\t\n\t            /**\n\t             * @property {Boolean} [threads=3]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 上传并发数。允许同时最大上传进程数。\n\t             */\n\t            threads: 3,\n\t\n\t\n\t            /**\n\t             * @property {Object} [formData={}]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n\t             */\n\t            formData: {}\n\t\n\t            /**\n\t             * @property {Object} [fileVal='file']\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 设置文件上传域的name。\n\t             */\n\t\n\t            /**\n\t             * @property {Object} [method='POST']\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 文件上传方式，`POST`或者`GET`。\n\t             */\n\t\n\t            /**\n\t             * @property {Object} [sendAsBinary=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n\t             * 其他参数在$_GET数组中。\n\t             */\n\t        });\n\t\n\t        // 负责将文件切片。\n\t        function CuteFile( file, chunkSize ) {\n\t            var pending = [],\n\t                blob = file.source,\n\t                total = blob.size,\n\t                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n\t                start = 0,\n\t                index = 0,\n\t                len, api;\n\t\n\t            api = {\n\t                file: file,\n\t\n\t                has: function() {\n\t                    return !!pending.length;\n\t                },\n\t\n\t                shift: function() {\n\t                    return pending.shift();\n\t                },\n\t\n\t                unshift: function( block ) {\n\t                    pending.unshift( block );\n\t                }\n\t            };\n\t\n\t            while ( index < chunks ) {\n\t                len = Math.min( chunkSize, total - start );\n\t\n\t                pending.push({\n\t                    file: file,\n\t                    start: start,\n\t                    end: chunkSize ? (start + len) : total,\n\t                    total: total,\n\t                    chunks: chunks,\n\t                    chunk: index++,\n\t                    cuted: api\n\t                });\n\t                start += len;\n\t            }\n\t\n\t            file.blocks = pending.concat();\n\t            file.remaning = pending.length;\n\t\n\t            return api;\n\t        }\n\t\n\t        Uploader.register({\n\t            name: 'upload',\n\t\n\t            init: function() {\n\t                var owner = this.owner,\n\t                    me = this;\n\t\n\t                this.runing = false;\n\t                this.progress = false;\n\t\n\t                owner\n\t                    .on( 'startUpload', function() {\n\t                        me.progress = true;\n\t                    })\n\t                    .on( 'uploadFinished', function() {\n\t                        me.progress = false;\n\t                    });\n\t\n\t                // 记录当前正在传的数据，跟threads相关\n\t                this.pool = [];\n\t\n\t                // 缓存分好片的文件。\n\t                this.stack = [];\n\t\n\t                // 缓存即将上传的文件。\n\t                this.pending = [];\n\t\n\t                // 跟踪还有多少分片在上传中但是没有完成上传。\n\t                this.remaning = 0;\n\t                this.__tick = Base.bindFn( this._tick, this );\n\t\n\t                owner.on( 'uploadComplete', function( file ) {\n\t\n\t                    // 把其他块取消了。\n\t                    file.blocks && $.each( file.blocks, function( _, v ) {\n\t                        v.transport && (v.transport.abort(), v.transport.destroy());\n\t                        delete v.transport;\n\t                    });\n\t\n\t                    delete file.blocks;\n\t                    delete file.remaning;\n\t                });\n\t            },\n\t\n\t            reset: function() {\n\t                this.request( 'stop-upload', true );\n\t                this.runing = false;\n\t                this.pool = [];\n\t                this.stack = [];\n\t                this.pending = [];\n\t                this.remaning = 0;\n\t                this._trigged = false;\n\t                this._promise = null;\n\t            },\n\t\n\t            /**\n\t             * @event startUpload\n\t             * @description 当开始上传流程时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n\t             *\n\t             * 可以指定开始某一个文件。\n\t             * @grammar upload() => undefined\n\t             * @grammar upload( file | fileId) => undefined\n\t             * @method upload\n\t             * @for  Uploader\n\t             */\n\t            startUpload: function(file) {\n\t                var me = this;\n\t\n\t                // 移出invalid的文件\n\t                $.each( me.request( 'get-files', Status.INVALID ), function() {\n\t                    me.request( 'remove-file', this );\n\t                });\n\t\n\t                // 如果指定了开始某个文件，则只开始指定文件。\n\t                if ( file ) {\n\t                    file = file.id ? file : me.request( 'get-file', file );\n\t\n\t                    if (file.getStatus() === Status.INTERRUPT) {\n\t                        $.each( me.pool, function( _, v ) {\n\t\n\t                            // 之前暂停过。\n\t                            if (v.file !== file) {\n\t                                return;\n\t                            }\n\t\n\t                            v.transport && v.transport.send();\n\t                        });\n\t\n\t                        file.setStatus( Status.QUEUED );\n\t                    } else if (file.getStatus() === Status.PROGRESS) {\n\t                        return;\n\t                    } else {\n\t                        file.setStatus( Status.QUEUED );\n\t                    }\n\t                } else {\n\t                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n\t                        this.setStatus( Status.QUEUED );\n\t                    });\n\t                }\n\t\n\t                if ( me.runing ) {\n\t                    return;\n\t                }\n\t\n\t                me.runing = true;\n\t\n\t                var files = [];\n\t\n\t                // 如果有暂停的，则续传\n\t                $.each( me.pool, function( _, v ) {\n\t                    var file = v.file;\n\t\n\t                    if ( file.getStatus() === Status.INTERRUPT ) {\n\t                        files.push(file);\n\t                        me._trigged = false;\n\t                        v.transport && v.transport.send();\n\t                    }\n\t                });\n\t\n\t                var file;\n\t                while ( (file = files.shift()) ) {\n\t                    file.setStatus( Status.PROGRESS );\n\t                }\n\t\n\t                file || $.each( me.request( 'get-files',\n\t                        Status.INTERRUPT ), function() {\n\t                    this.setStatus( Status.PROGRESS );\n\t                });\n\t\n\t                me._trigged = false;\n\t                Base.nextTick( me.__tick );\n\t                me.owner.trigger('startUpload');\n\t            },\n\t\n\t            /**\n\t             * @event stopUpload\n\t             * @description 当开始上传流程暂停时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n\t             *\n\t             * 如果第一个参数是文件，则只暂停指定文件。\n\t             * @grammar stop() => undefined\n\t             * @grammar stop( true ) => undefined\n\t             * @grammar stop( file ) => undefined\n\t             * @method stop\n\t             * @for  Uploader\n\t             */\n\t            stopUpload: function( file, interrupt ) {\n\t                var me = this;\n\t\n\t                if (file === true) {\n\t                    interrupt = file;\n\t                    file = null;\n\t                }\n\t\n\t                if ( me.runing === false ) {\n\t                    return;\n\t                }\n\t\n\t                // 如果只是暂停某个文件。\n\t                if ( file ) {\n\t                    file = file.id ? file : me.request( 'get-file', file );\n\t\n\t                    if ( file.getStatus() !== Status.PROGRESS &&\n\t                            file.getStatus() !== Status.QUEUED ) {\n\t                        return;\n\t                    }\n\t\n\t                    file.setStatus( Status.INTERRUPT );\n\t                    $.each( me.pool, function( _, v ) {\n\t\n\t                        // 只 abort 指定的文件。\n\t                        if (v.file !== file) {\n\t                            return;\n\t                        }\n\t\n\t                        v.transport && v.transport.abort();\n\t                        me._putback(v);\n\t                        me._popBlock(v);\n\t                    });\n\t\n\t                    return Base.nextTick( me.__tick );\n\t                }\n\t\n\t                me.runing = false;\n\t\n\t                if (this._promise && this._promise.file) {\n\t                    this._promise.file.setStatus( Status.INTERRUPT );\n\t                }\n\t\n\t                interrupt && $.each( me.pool, function( _, v ) {\n\t                    v.transport && v.transport.abort();\n\t                    v.file.setStatus( Status.INTERRUPT );\n\t                });\n\t\n\t                me.owner.trigger('stopUpload');\n\t            },\n\t\n\t            /**\n\t             * @method cancelFile\n\t             * @grammar cancelFile( file ) => undefined\n\t             * @grammar cancelFile( id ) => undefined\n\t             * @param {File|id} file File对象或这File对象的id\n\t             * @description 标记文件状态为已取消, 同时将中断文件传输。\n\t             * @for  Uploader\n\t             * @example\n\t             *\n\t             * $li.on('click', '.remove-this', function() {\n\t             *     uploader.cancelFile( file );\n\t             * })\n\t             */\n\t            cancelFile: function( file ) {\n\t                file = file.id ? file : this.request( 'get-file', file );\n\t\n\t                // 如果正在上传。\n\t                file.blocks && $.each( file.blocks, function( _, v ) {\n\t                    var _tr = v.transport;\n\t\n\t                    if ( _tr ) {\n\t                        _tr.abort();\n\t                        _tr.destroy();\n\t                        delete v.transport;\n\t                    }\n\t                });\n\t\n\t                file.setStatus( Status.CANCELLED );\n\t                this.owner.trigger( 'fileDequeued', file );\n\t            },\n\t\n\t            /**\n\t             * 判断`Uplaode`r是否正在上传中。\n\t             * @grammar isInProgress() => Boolean\n\t             * @method isInProgress\n\t             * @for  Uploader\n\t             */\n\t            isInProgress: function() {\n\t                return !!this.progress;\n\t            },\n\t\n\t            _getStats: function() {\n\t                return this.request('get-stats');\n\t            },\n\t\n\t            /**\n\t             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n\t             * @grammar skipFile( file ) => undefined\n\t             * @method skipFile\n\t             * @for  Uploader\n\t             */\n\t            skipFile: function( file, status ) {\n\t                file = file.id ? file : this.request( 'get-file', file );\n\t\n\t                file.setStatus( status || Status.COMPLETE );\n\t                file.skipped = true;\n\t\n\t                // 如果正在上传。\n\t                file.blocks && $.each( file.blocks, function( _, v ) {\n\t                    var _tr = v.transport;\n\t\n\t                    if ( _tr ) {\n\t                        _tr.abort();\n\t                        _tr.destroy();\n\t                        delete v.transport;\n\t                    }\n\t                });\n\t\n\t                this.owner.trigger( 'uploadSkip', file );\n\t            },\n\t\n\t            /**\n\t             * @event uploadFinished\n\t             * @description 当所有文件上传结束时触发。\n\t             * @for  Uploader\n\t             */\n\t            _tick: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    fn, val;\n\t\n\t                // 上一个promise还没有结束，则等待完成后再执行。\n\t                if ( me._promise ) {\n\t                    return me._promise.always( me.__tick );\n\t                }\n\t\n\t                // 还有位置，且还有文件要处理的话。\n\t                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n\t                    me._trigged = false;\n\t\n\t                    fn = function( val ) {\n\t                        me._promise = null;\n\t\n\t                        // 有可能是reject过来的，所以要检测val的类型。\n\t                        val && val.file && me._startSend( val );\n\t                        Base.nextTick( me.__tick );\n\t                    };\n\t\n\t                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n\t\n\t                // 没有要上传的了，且没有正在传输的了。\n\t                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n\t                    !me._getStats().numofInterrupt ) {\n\t                    me.runing = false;\n\t\n\t                    me._trigged || Base.nextTick(function() {\n\t                        me.owner.trigger('uploadFinished');\n\t                    });\n\t                    me._trigged = true;\n\t                }\n\t            },\n\t\n\t            _putback: function(block) {\n\t                var idx;\n\t\n\t                block.cuted.unshift(block);\n\t                idx = this.stack.indexOf(block.cuted);\n\t\n\t                if (!~idx) {\n\t                    this.stack.unshift(block.cuted);\n\t                }\n\t            },\n\t\n\t            _getStack: function() {\n\t                var i = 0,\n\t                    act;\n\t\n\t                while ( (act = this.stack[ i++ ]) ) {\n\t                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n\t                        return act;\n\t                    } else if (!act.has() ||\n\t                            act.file.getStatus() !== Status.PROGRESS &&\n\t                            act.file.getStatus() !== Status.INTERRUPT ) {\n\t\n\t                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n\t                        // interupt（暂停中） 的移除。\n\t                        this.stack.splice( --i, 1 );\n\t                    }\n\t                }\n\t\n\t                return null;\n\t            },\n\t\n\t            _nextBlock: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    act, next, done, preparing;\n\t\n\t                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n\t                if ( (act = this._getStack()) ) {\n\t\n\t                    // 是否提前准备下一个文件\n\t                    if ( opts.prepareNextFile && !me.pending.length ) {\n\t                        me._prepareNextFile();\n\t                    }\n\t\n\t                    return act.shift();\n\t\n\t                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n\t                } else if ( me.runing ) {\n\t\n\t                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n\t                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n\t                        me._prepareNextFile();\n\t                    }\n\t\n\t                    next = me.pending.shift();\n\t                    done = function( file ) {\n\t                        if ( !file ) {\n\t                            return null;\n\t                        }\n\t\n\t                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n\t                        me.stack.push(act);\n\t                        return act.shift();\n\t                    };\n\t\n\t                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n\t                    if ( isPromise( next) ) {\n\t                        preparing = next.file;\n\t                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n\t                        next.file = preparing;\n\t                        return next;\n\t                    }\n\t\n\t                    return done( next );\n\t                }\n\t            },\n\t\n\t\n\t            /**\n\t             * @event uploadStart\n\t             * @param {File} file File对象\n\t             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n\t             * @for  Uploader\n\t             */\n\t            _prepareNextFile: function() {\n\t                var me = this,\n\t                    file = me.request('fetch-file'),\n\t                    pending = me.pending,\n\t                    promise;\n\t\n\t                if ( file ) {\n\t                    promise = me.request( 'before-send-file', file, function() {\n\t\n\t                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n\t                        if ( file.getStatus() === Status.PROGRESS ||\n\t                            file.getStatus() === Status.INTERRUPT ) {\n\t                            return file;\n\t                        }\n\t\n\t                        return me._finishFile( file );\n\t                    });\n\t\n\t                    me.owner.trigger( 'uploadStart', file );\n\t                    file.setStatus( Status.PROGRESS );\n\t\n\t                    promise.file = file;\n\t\n\t                    // 如果还在pending中，则替换成文件本身。\n\t                    promise.done(function() {\n\t                        var idx = $.inArray( promise, pending );\n\t\n\t                        ~idx && pending.splice( idx, 1, file );\n\t                    });\n\t\n\t                    // befeore-send-file的钩子就有错误发生。\n\t                    promise.fail(function( reason ) {\n\t                        file.setStatus( Status.ERROR, reason );\n\t                        me.owner.trigger( 'uploadError', file, reason );\n\t                        me.owner.trigger( 'uploadComplete', file );\n\t                    });\n\t\n\t                    pending.push( promise );\n\t                }\n\t            },\n\t\n\t            // 让出位置了，可以让其他分片开始上传\n\t            _popBlock: function( block ) {\n\t                var idx = $.inArray( block, this.pool );\n\t\n\t                this.pool.splice( idx, 1 );\n\t                block.file.remaning--;\n\t                this.remaning--;\n\t            },\n\t\n\t            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n\t            _startSend: function( block ) {\n\t                var me = this,\n\t                    file = block.file,\n\t                    promise;\n\t\n\t                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n\t                // 如：暂停，取消\n\t                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n\t                if ( file.getStatus() !== Status.PROGRESS ) {\n\t\n\t                    // 如果是中断，则还需要放回去。\n\t                    if (file.getStatus() === Status.INTERRUPT) {\n\t                        me._putback(block);\n\t                    }\n\t\n\t                    return;\n\t                }\n\t\n\t                me.pool.push( block );\n\t                me.remaning++;\n\t\n\t                // 如果没有分片，则直接使用原始的。\n\t                // 不会丢失content-type信息。\n\t                block.blob = block.chunks === 1 ? file.source :\n\t                        file.source.slice( block.start, block.end );\n\t\n\t                // hook, 每个分片发送之前可能要做些异步的事情。\n\t                promise = me.request( 'before-send', block, function() {\n\t\n\t                    // 有可能文件已经上传出错了，所以不需要再传输了。\n\t                    if ( file.getStatus() === Status.PROGRESS ) {\n\t                        me._doSend( block );\n\t                    } else {\n\t                        me._popBlock( block );\n\t                        Base.nextTick( me.__tick );\n\t                    }\n\t                });\n\t\n\t                // 如果为fail了，则跳过此分片。\n\t                promise.fail(function() {\n\t                    if ( file.remaning === 1 ) {\n\t                        me._finishFile( file ).always(function() {\n\t                            block.percentage = 1;\n\t                            me._popBlock( block );\n\t                            me.owner.trigger( 'uploadComplete', file );\n\t                            Base.nextTick( me.__tick );\n\t                        });\n\t                    } else {\n\t                        block.percentage = 1;\n\t                        me.updateFileProgress( file );\n\t                        me._popBlock( block );\n\t                        Base.nextTick( me.__tick );\n\t                    }\n\t                });\n\t            },\n\t\n\t\n\t            /**\n\t             * @event uploadBeforeSend\n\t             * @param {Object} object\n\t             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n\t             * @param {Object} headers 可以扩展此对象来控制上传头部。\n\t             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadAccept\n\t             * @param {Object} object\n\t             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n\t             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadProgress\n\t             * @param {File} file File对象\n\t             * @param {Number} percentage 上传进度\n\t             * @description 上传过程中触发，携带上传进度。\n\t             * @for  Uploader\n\t             */\n\t\n\t\n\t            /**\n\t             * @event uploadError\n\t             * @param {File} file File对象\n\t             * @param {String} reason 出错的code\n\t             * @description 当文件上传出错时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadSuccess\n\t             * @param {File} file File对象\n\t             * @param {Object} response 服务端返回的数据\n\t             * @description 当文件上传成功时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadComplete\n\t             * @param {File} [file] File对象\n\t             * @description 不管成功或者失败，文件上传完成时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            // 做上传操作。\n\t            _doSend: function( block ) {\n\t                var me = this,\n\t                    owner = me.owner,\n\t                    opts = me.options,\n\t                    file = block.file,\n\t                    tr = new Transport( opts ),\n\t                    data = $.extend({}, opts.formData ),\n\t                    headers = $.extend({}, opts.headers ),\n\t                    requestAccept, ret;\n\t\n\t                block.transport = tr;\n\t\n\t                tr.on( 'destroy', function() {\n\t                    delete block.transport;\n\t                    me._popBlock( block );\n\t                    Base.nextTick( me.__tick );\n\t                });\n\t\n\t                // 广播上传进度。以文件为单位。\n\t                tr.on( 'progress', function( percentage ) {\n\t                    block.percentage = percentage;\n\t                    me.updateFileProgress( file );\n\t                });\n\t\n\t                // 用来询问，是否返回的结果是有错误的。\n\t                requestAccept = function( reject ) {\n\t                    var fn;\n\t\n\t                    ret = tr.getResponseAsJson() || {};\n\t                    ret._raw = tr.getResponse();\n\t                    fn = function( value ) {\n\t                        reject = value;\n\t                    };\n\t\n\t                    // 服务端响应了，不代表成功了，询问是否响应正确。\n\t                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n\t                        reject = reject || 'server';\n\t                    }\n\t\n\t                    return reject;\n\t                };\n\t\n\t                // 尝试重试，然后广播文件上传出错。\n\t                tr.on( 'error', function( type, flag ) {\n\t                    block.retried = block.retried || 0;\n\t\n\t                    // 自动重试\n\t                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n\t                            block.retried < opts.chunkRetry ) {\n\t\n\t                        block.retried++;\n\t                        tr.send();\n\t\n\t                    } else {\n\t\n\t                        // http status 500 ~ 600\n\t                        if ( !flag && type === 'server' ) {\n\t                            type = requestAccept( type );\n\t                        }\n\t\n\t                        file.setStatus( Status.ERROR, type );\n\t                        owner.trigger( 'uploadError', file, type );\n\t                        owner.trigger( 'uploadComplete', file );\n\t                    }\n\t                });\n\t\n\t                // 上传成功\n\t                tr.on( 'load', function() {\n\t                    var reason;\n\t\n\t                    // 如果非预期，转向上传出错。\n\t                    if ( (reason = requestAccept()) ) {\n\t                        tr.trigger( 'error', reason, true );\n\t                        return;\n\t                    }\n\t\n\t                    // 全部上传完成。\n\t                    if ( file.remaning === 1 ) {\n\t                        me._finishFile( file, ret );\n\t                    } else {\n\t                        tr.destroy();\n\t                    }\n\t                });\n\t\n\t                // 配置默认的上传字段。\n\t                data = $.extend( data, {\n\t                    id: file.id,\n\t                    name: file.name,\n\t                    type: file.type,\n\t                    lastModifiedDate: file.lastModifiedDate,\n\t                    size: file.size\n\t                });\n\t\n\t                block.chunks > 1 && $.extend( data, {\n\t                    chunks: block.chunks,\n\t                    chunk: block.chunk\n\t                });\n\t\n\t                // 在发送之间可以添加字段什么的。。。\n\t                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n\t                owner.trigger( 'uploadBeforeSend', block, data, headers );\n\t\n\t                // 开始发送。\n\t                tr.appendBlob( opts.fileVal, block.blob, file.name );\n\t                tr.append( data );\n\t                tr.setRequestHeader( headers );\n\t                tr.send();\n\t            },\n\t\n\t            // 完成上传。\n\t            _finishFile: function( file, ret, hds ) {\n\t                var owner = this.owner;\n\t\n\t                return owner\n\t                        .request( 'after-send-file', arguments, function() {\n\t                            file.setStatus( Status.COMPLETE );\n\t                            owner.trigger( 'uploadSuccess', file, ret, hds );\n\t                        })\n\t                        .fail(function( reason ) {\n\t\n\t                            // 如果外部已经标记为invalid什么的，不再改状态。\n\t                            if ( file.getStatus() === Status.PROGRESS ) {\n\t                                file.setStatus( Status.ERROR, reason );\n\t                            }\n\t\n\t                            owner.trigger( 'uploadError', file, reason );\n\t                        })\n\t                        .always(function() {\n\t                            owner.trigger( 'uploadComplete', file );\n\t                        });\n\t            },\n\t\n\t            updateFileProgress: function(file) {\n\t                var totalPercent = 0,\n\t                    uploaded = 0;\n\t\n\t                if (!file.blocks) {\n\t                    return;\n\t                }\n\t\n\t                $.each( file.blocks, function( _, v ) {\n\t                    uploaded += (v.percentage || 0) * (v.end - v.start);\n\t                });\n\t\n\t                totalPercent = uploaded / file.size;\n\t                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n\t            }\n\t\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n\t     */\n\t\n\t    define('widgets/validator',[\n\t        'base',\n\t        'uploader',\n\t        'file',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, WUFile ) {\n\t\n\t        var $ = Base.$,\n\t            validators = {},\n\t            api;\n\t\n\t        /**\n\t         * @event error\n\t         * @param {String} type 错误类型。\n\t         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n\t         *\n\t         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n\t         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n\t         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n\t         * @for  Uploader\n\t         */\n\t\n\t        // 暴露给外面的api\n\t        api = {\n\t\n\t            // 添加验证器\n\t            addValidator: function( type, cb ) {\n\t                validators[ type ] = cb;\n\t            },\n\t\n\t            // 移除验证器\n\t            removeValidator: function( type ) {\n\t                delete validators[ type ];\n\t            }\n\t        };\n\t\n\t        // 在Uploader初始化的时候启动Validators的初始化\n\t        Uploader.register({\n\t            name: 'validator',\n\t\n\t            init: function() {\n\t                var me = this;\n\t                Base.nextTick(function() {\n\t                    $.each( validators, function() {\n\t                        this.call( me.owner );\n\t                    });\n\t                });\n\t            }\n\t        });\n\t\n\t        /**\n\t         * @property {int} [fileNumLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证文件总数量, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileNumLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                count = 0,\n\t                max = parseInt( opts.fileNumLimit, 10 ),\n\t                flag = true;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t\n\t                if ( count >= max && flag ) {\n\t                    flag = false;\n\t                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n\t                    setTimeout(function() {\n\t                        flag = true;\n\t                    }, 1 );\n\t                }\n\t\n\t                return count >= max ? false : true;\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function() {\n\t                count++;\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function() {\n\t                count--;\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                count = 0;\n\t            });\n\t        });\n\t\n\t\n\t        /**\n\t         * @property {int} [fileSizeLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileSizeLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                count = 0,\n\t                max = parseInt( opts.fileSizeLimit, 10 ),\n\t                flag = true;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t                var invalid = count + file.size > max;\n\t\n\t                if ( invalid && flag ) {\n\t                    flag = false;\n\t                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n\t                    setTimeout(function() {\n\t                        flag = true;\n\t                    }, 1 );\n\t                }\n\t\n\t                return invalid ? false : true;\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function( file ) {\n\t                count += file.size;\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function( file ) {\n\t                count -= file.size;\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                count = 0;\n\t            });\n\t        });\n\t\n\t        /**\n\t         * @property {int} [fileSingleSizeLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileSingleSizeLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                max = opts.fileSingleSizeLimit;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t\n\t                if ( file.size > max ) {\n\t                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n\t                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n\t                    return false;\n\t                }\n\t\n\t            });\n\t\n\t        });\n\t\n\t        /**\n\t         * @property {Boolean} [duplicate=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n\t         */\n\t        api.addValidator( 'duplicate', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                mapping = {};\n\t\n\t            if ( opts.duplicate ) {\n\t                return;\n\t            }\n\t\n\t            function hashString( str ) {\n\t                var hash = 0,\n\t                    i = 0,\n\t                    len = str.length,\n\t                    _char;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    _char = str.charCodeAt( i );\n\t                    hash = _char + (hash << 6) + (hash << 16) - hash;\n\t                }\n\t\n\t                return hash;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t                var hash = file.__hash || (file.__hash = hashString( file.name +\n\t                        file.size + file.lastModifiedDate ));\n\t\n\t                // 已经重复了\n\t                if ( mapping[ hash ] ) {\n\t                    this.trigger( 'error', 'F_DUPLICATE', file );\n\t                    return false;\n\t                }\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function( file ) {\n\t                var hash = file.__hash;\n\t\n\t                hash && (mapping[ hash ] = true);\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function( file ) {\n\t                var hash = file.__hash;\n\t\n\t                hash && (delete mapping[ hash ]);\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                mapping = {};\n\t            });\n\t        });\n\t\n\t        return api;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview Md5\n\t     */\n\t    define('lib/md5',[\n\t        'runtime/client',\n\t        'mediator'\n\t    ], function( RuntimeClient, Mediator ) {\n\t\n\t        function Md5() {\n\t            RuntimeClient.call( this, 'Md5' );\n\t        }\n\t\n\t        // 让 Md5 具备事件功能。\n\t        Mediator.installTo( Md5.prototype );\n\t\n\t        Md5.prototype.loadFromBlob = function( blob ) {\n\t            var me = this;\n\t\n\t            if ( me.getRuid() ) {\n\t                me.disconnectRuntime();\n\t            }\n\t\n\t            // 连接到blob归属的同一个runtime.\n\t            me.connectRuntime( blob.ruid, function() {\n\t                me.exec('init');\n\t                me.exec( 'loadFromBlob', blob );\n\t            });\n\t        };\n\t\n\t        Md5.prototype.getResult = function() {\n\t            return this.exec('getResult');\n\t        };\n\t\n\t        return Md5;\n\t    });\n\t    /**\n\t     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n\t     */\n\t    define('widgets/md5',[\n\t        'base',\n\t        'uploader',\n\t        'lib/md5',\n\t        'lib/blob',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Md5, Blob ) {\n\t\n\t        return Uploader.register({\n\t            name: 'md5',\n\t\n\t\n\t            /**\n\t             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n\t             *\n\t             *\n\t             * @method md5File\n\t             * @grammar md5File( file[, start[, end]] ) => promise\n\t             * @for Uploader\n\t             * @example\n\t             *\n\t             * uploader.on( 'fileQueued', function( file ) {\n\t             *     var $li = ...;\n\t             *\n\t             *     uploader.md5File( file )\n\t             *\n\t             *         // 及时显示进度\n\t             *         .progress(function(percentage) {\n\t             *             console.log('Percentage:', percentage);\n\t             *         })\n\t             *\n\t             *         // 完成\n\t             *         .then(function(val) {\n\t             *             console.log('md5 result:', val);\n\t             *         });\n\t             *\n\t             * });\n\t             */\n\t            md5File: function( file, start, end ) {\n\t                var md5 = new Md5(),\n\t                    deferred = Base.Deferred(),\n\t                    blob = (file instanceof Blob) ? file :\n\t                        this.request( 'get-file', file ).source;\n\t\n\t                md5.on( 'progress load', function( e ) {\n\t                    e = e || {};\n\t                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n\t                });\n\t\n\t                md5.on( 'complete', function() {\n\t                    deferred.resolve( md5.getResult() );\n\t                });\n\t\n\t                md5.on( 'error', function( reason ) {\n\t                    deferred.reject( reason );\n\t                });\n\t\n\t                if ( arguments.length > 1 ) {\n\t                    start = start || 0;\n\t                    end = end || 0;\n\t                    start < 0 && (start = blob.size + start);\n\t                    end < 0 && (end = blob.size + end);\n\t                    end = Math.min( end, blob.size );\n\t                    blob = blob.slice( start, end );\n\t                }\n\t\n\t                md5.loadFromBlob( blob );\n\t\n\t                return deferred.promise();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/compbase',[],function() {\n\t\n\t        function CompBase( owner, runtime ) {\n\t\n\t            this.owner = owner;\n\t            this.options = owner.options;\n\t\n\t            this.getRuntime = function() {\n\t                return runtime;\n\t            };\n\t\n\t            this.getRuid = function() {\n\t                return runtime.uid;\n\t            };\n\t\n\t            this.trigger = function() {\n\t                return owner.trigger.apply( owner, arguments );\n\t            };\n\t        }\n\t\n\t        return CompBase;\n\t    });\n\t    /**\n\t     * @fileOverview Html5Runtime\n\t     */\n\t    define('runtime/html5/runtime',[\n\t        'base',\n\t        'runtime/runtime',\n\t        'runtime/compbase'\n\t    ], function( Base, Runtime, CompBase ) {\n\t\n\t        var type = 'html5',\n\t            components = {};\n\t\n\t        function Html5Runtime() {\n\t            var pool = {},\n\t                me = this,\n\t                destroy = this.destroy;\n\t\n\t            Runtime.apply( me, arguments );\n\t            me.type = type;\n\t\n\t\n\t            // 这个方法的调用者，实际上是RuntimeClient\n\t            me.exec = function( comp, fn/*, args...*/) {\n\t                var client = this,\n\t                    uid = client.uid,\n\t                    args = Base.slice( arguments, 2 ),\n\t                    instance;\n\t\n\t                if ( components[ comp ] ) {\n\t                    instance = pool[ uid ] = pool[ uid ] ||\n\t                            new components[ comp ]( client, me );\n\t\n\t                    if ( instance[ fn ] ) {\n\t                        return instance[ fn ].apply( instance, args );\n\t                    }\n\t                }\n\t            };\n\t\n\t            me.destroy = function() {\n\t                // @todo 删除池子中的所有实例\n\t                return destroy && destroy.apply( this, arguments );\n\t            };\n\t        }\n\t\n\t        Base.inherits( Runtime, {\n\t            constructor: Html5Runtime,\n\t\n\t            // 不需要连接其他程序，直接执行callback\n\t            init: function() {\n\t                var me = this;\n\t                setTimeout(function() {\n\t                    me.trigger('ready');\n\t                }, 1 );\n\t            }\n\t\n\t        });\n\t\n\t        // 注册Components\n\t        Html5Runtime.register = function( name, component ) {\n\t            var klass = components[ name ] = Base.inherits( CompBase, component );\n\t            return klass;\n\t        };\n\t\n\t        // 注册html5运行时。\n\t        // 只有在支持的前提下注册。\n\t        if ( window.Blob && window.FileReader && window.DataView ) {\n\t            Runtime.addRuntime( type, Html5Runtime );\n\t        }\n\t\n\t        return Html5Runtime;\n\t    });\n\t    /**\n\t     * @fileOverview Blob Html实现\n\t     */\n\t    define('runtime/html5/blob',[\n\t        'runtime/html5/runtime',\n\t        'lib/blob'\n\t    ], function( Html5Runtime, Blob ) {\n\t\n\t        return Html5Runtime.register( 'Blob', {\n\t            slice: function( start, end ) {\n\t                var blob = this.owner.source,\n\t                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n\t\n\t                blob = slice.call( blob, start, end );\n\t\n\t                return new Blob( this.getRuid(), blob );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview FilePaste\n\t     */\n\t    define('runtime/html5/dnd',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'lib/file'\n\t    ], function( Base, Html5Runtime, File ) {\n\t\n\t        var $ = Base.$,\n\t            prefix = 'webuploader-dnd-';\n\t\n\t        return Html5Runtime.register( 'DragAndDrop', {\n\t            init: function() {\n\t                var elem = this.elem = this.options.container;\n\t\n\t                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n\t                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n\t                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n\t                this.dropHandler = Base.bindFn( this._dropHandler, this );\n\t                this.dndOver = false;\n\t\n\t                elem.on( 'dragenter', this.dragEnterHandler );\n\t                elem.on( 'dragover', this.dragOverHandler );\n\t                elem.on( 'dragleave', this.dragLeaveHandler );\n\t                elem.on( 'drop', this.dropHandler );\n\t\n\t                if ( this.options.disableGlobalDnd ) {\n\t                    $( document ).on( 'dragover', this.dragOverHandler );\n\t                    $( document ).on( 'drop', this.dropHandler );\n\t                }\n\t            },\n\t\n\t            _dragEnterHandler: function( e ) {\n\t                var me = this,\n\t                    denied = me._denied || false,\n\t                    items;\n\t\n\t                e = e.originalEvent || e;\n\t\n\t                if ( !me.dndOver ) {\n\t                    me.dndOver = true;\n\t\n\t                    // 注意只有 chrome 支持。\n\t                    items = e.dataTransfer.items;\n\t\n\t                    if ( items && items.length ) {\n\t                        me._denied = denied = !me.trigger( 'accept', items );\n\t                    }\n\t\n\t                    me.elem.addClass( prefix + 'over' );\n\t                    me.elem[ denied ? 'addClass' :\n\t                            'removeClass' ]( prefix + 'denied' );\n\t                }\n\t\n\t                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n\t\n\t                return false;\n\t            },\n\t\n\t            _dragOverHandler: function( e ) {\n\t                // 只处理框内的。\n\t                var parentElem = this.elem.parent().get( 0 );\n\t                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n\t                    return false;\n\t                }\n\t\n\t                clearTimeout( this._leaveTimer );\n\t                this._dragEnterHandler.call( this, e );\n\t\n\t                return false;\n\t            },\n\t\n\t            _dragLeaveHandler: function() {\n\t                var me = this,\n\t                    handler;\n\t\n\t                handler = function() {\n\t                    me.dndOver = false;\n\t                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n\t                };\n\t\n\t                clearTimeout( me._leaveTimer );\n\t                me._leaveTimer = setTimeout( handler, 100 );\n\t                return false;\n\t            },\n\t\n\t            _dropHandler: function( e ) {\n\t                var me = this,\n\t                    ruid = me.getRuid(),\n\t                    parentElem = me.elem.parent().get( 0 ),\n\t                    dataTransfer, data;\n\t\n\t                // 只处理框内的。\n\t                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n\t                    return false;\n\t                }\n\t\n\t                e = e.originalEvent || e;\n\t                dataTransfer = e.dataTransfer;\n\t\n\t                // 如果是页面内拖拽，还不能处理，不阻止事件。\n\t                // 此处 ie11 下会报参数错误，\n\t                try {\n\t                    data = dataTransfer.getData('text/html');\n\t                } catch( err ) {\n\t                }\n\t\n\t                if ( data ) {\n\t                    return;\n\t                }\n\t\n\t                me._getTansferFiles( dataTransfer, function( results ) {\n\t                    me.trigger( 'drop', $.map( results, function( file ) {\n\t                        return new File( ruid, file );\n\t                    }) );\n\t                });\n\t\n\t                me.dndOver = false;\n\t                me.elem.removeClass( prefix + 'over' );\n\t                return false;\n\t            },\n\t\n\t            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n\t            _getTansferFiles: function( dataTransfer, callback ) {\n\t                var results  = [],\n\t                    promises = [],\n\t                    items, files, file, item, i, len, canAccessFolder;\n\t\n\t                items = dataTransfer.items;\n\t                files = dataTransfer.files;\n\t\n\t                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n\t\n\t                for ( i = 0, len = files.length; i < len; i++ ) {\n\t                    file = files[ i ];\n\t                    item = items && items[ i ];\n\t\n\t                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n\t\n\t                        promises.push( this._traverseDirectoryTree(\n\t                                item.webkitGetAsEntry(), results ) );\n\t                    } else {\n\t                        results.push( file );\n\t                    }\n\t                }\n\t\n\t                Base.when.apply( Base, promises ).done(function() {\n\t\n\t                    if ( !results.length ) {\n\t                        return;\n\t                    }\n\t\n\t                    callback( results );\n\t                });\n\t            },\n\t\n\t            _traverseDirectoryTree: function( entry, results ) {\n\t                var deferred = Base.Deferred(),\n\t                    me = this;\n\t\n\t                if ( entry.isFile ) {\n\t                    entry.file(function( file ) {\n\t                        results.push( file );\n\t                        deferred.resolve();\n\t                    });\n\t                } else if ( entry.isDirectory ) {\n\t                    entry.createReader().readEntries(function( entries ) {\n\t                        var len = entries.length,\n\t                            promises = [],\n\t                            arr = [],    // 为了保证顺序。\n\t                            i;\n\t\n\t                        for ( i = 0; i < len; i++ ) {\n\t                            promises.push( me._traverseDirectoryTree(\n\t                                    entries[ i ], arr ) );\n\t                        }\n\t\n\t                        Base.when.apply( Base, promises ).then(function() {\n\t                            results.push.apply( results, arr );\n\t                            deferred.resolve();\n\t                        }, deferred.reject );\n\t                    });\n\t                }\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                var elem = this.elem;\n\t\n\t                // 还没 init 就调用 destroy\n\t                if (!elem) {\n\t                    return;\n\t                }\n\t\n\t                elem.off( 'dragenter', this.dragEnterHandler );\n\t                elem.off( 'dragover', this.dragOverHandler );\n\t                elem.off( 'dragleave', this.dragLeaveHandler );\n\t                elem.off( 'drop', this.dropHandler );\n\t\n\t                if ( this.options.disableGlobalDnd ) {\n\t                    $( document ).off( 'dragover', this.dragOverHandler );\n\t                    $( document ).off( 'drop', this.dropHandler );\n\t                }\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview FilePaste\n\t     */\n\t    define('runtime/html5/filepaste',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'lib/file'\n\t    ], function( Base, Html5Runtime, File ) {\n\t\n\t        return Html5Runtime.register( 'FilePaste', {\n\t            init: function() {\n\t                var opts = this.options,\n\t                    elem = this.elem = opts.container,\n\t                    accept = '.*',\n\t                    arr, i, len, item;\n\t\n\t                // accetp的mimeTypes中生成匹配正则。\n\t                if ( opts.accept ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        item = opts.accept[ i ].mimeTypes;\n\t                        item && arr.push( item );\n\t                    }\n\t\n\t                    if ( arr.length ) {\n\t                        accept = arr.join(',');\n\t                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n\t                    }\n\t                }\n\t                this.accept = accept = new RegExp( accept, 'i' );\n\t                this.hander = Base.bindFn( this._pasteHander, this );\n\t                elem.on( 'paste', this.hander );\n\t            },\n\t\n\t            _pasteHander: function( e ) {\n\t                var allowed = [],\n\t                    ruid = this.getRuid(),\n\t                    items, item, blob, i, len;\n\t\n\t                e = e.originalEvent || e;\n\t                items = e.clipboardData.items;\n\t\n\t                for ( i = 0, len = items.length; i < len; i++ ) {\n\t                    item = items[ i ];\n\t\n\t                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n\t                        continue;\n\t                    }\n\t\n\t                    allowed.push( new File( ruid, blob ) );\n\t                }\n\t\n\t                if ( allowed.length ) {\n\t                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n\t                    e.preventDefault();\n\t                    e.stopPropagation();\n\t                    this.trigger( 'paste', allowed );\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.elem.off( 'paste', this.hander );\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview FilePicker\n\t     */\n\t    define('runtime/html5/filepicker',[\n\t        'base',\n\t        'runtime/html5/runtime'\n\t    ], function( Base, Html5Runtime ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        return Html5Runtime.register( 'FilePicker', {\n\t            init: function() {\n\t                var container = this.getRuntime().getContainer(),\n\t                    me = this,\n\t                    owner = me.owner,\n\t                    opts = me.options,\n\t                    label = this.label = $( document.createElement('label') ),\n\t                    input =  this.input = $( document.createElement('input') ),\n\t                    arr, i, len, mouseHandler;\n\t\n\t                input.attr( 'type', 'file' );\n\t                //console.log(opts.name)\n\t                input.attr( 'name', 'file' );\n\t                input.addClass('webuploader-element-invisible');\n\t\n\t                label.on( 'click', function() {\n\t                    input.trigger('click');\n\t                });\n\t\n\t                label.css({\n\t                    opacity: 0,\n\t                    width: '100%',\n\t                    height: '100%',\n\t                    display: 'block',\n\t                    cursor: 'pointer',\n\t                    background: '#ffffff'\n\t                });\n\t\n\t                if ( opts.multiple ) {\n\t                    input.attr( 'multiple', 'multiple' );\n\t                }\n\t\n\t                // @todo Firefox不支持单独指定后缀\n\t                if ( opts.accept && opts.accept.length > 0 ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        arr.push( opts.accept[ i ].mimeTypes );\n\t                    }\n\t\n\t                    input.attr( 'accept', arr.join(',') );\n\t                }\n\t\n\t                container.append( input );\n\t                container.append( label );\n\t\n\t                mouseHandler = function( e ) {\n\t                    owner.trigger( e.type );\n\t                };\n\t\n\t                input.on( 'change', function( e ) {\n\t                    var fn = arguments.callee,\n\t                        clone;\n\t\n\t                    me.files = e.target.files;\n\t\n\t                    // reset input\n\t                    clone = this.cloneNode( true );\n\t                    clone.value = null;\n\t                    this.parentNode.replaceChild( clone, this );\n\t\n\t                    input.off();\n\t                    input = $( clone ).on( 'change', fn )\n\t                            .on( 'mouseenter mouseleave', mouseHandler );\n\t\n\t                    owner.trigger('change');\n\t                });\n\t\n\t                label.on( 'mouseenter mouseleave', mouseHandler );\n\t\n\t            },\n\t\n\t\n\t            getFiles: function() {\n\t                return this.files;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.input.off();\n\t                this.label.off();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * Terms:\n\t     *\n\t     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n\t     * @fileOverview Image控件\n\t     */\n\t    define('runtime/html5/util',[\n\t        'base'\n\t    ], function( Base ) {\n\t\n\t        var urlAPI = window.createObjectURL && window ||\n\t                window.URL && URL.revokeObjectURL && URL ||\n\t                window.webkitURL,\n\t            createObjectURL = Base.noop,\n\t            revokeObjectURL = createObjectURL;\n\t\n\t        if ( urlAPI ) {\n\t\n\t            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n\t            createObjectURL = function() {\n\t                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n\t            };\n\t\n\t            revokeObjectURL = function() {\n\t                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n\t            };\n\t        }\n\t\n\t        return {\n\t            createObjectURL: createObjectURL,\n\t            revokeObjectURL: revokeObjectURL,\n\t\n\t            dataURL2Blob: function( dataURI ) {\n\t                var byteStr, intArray, ab, i, mimetype, parts;\n\t\n\t                parts = dataURI.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    byteStr = atob( parts[ 1 ] );\n\t                } else {\n\t                    byteStr = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                ab = new ArrayBuffer( byteStr.length );\n\t                intArray = new Uint8Array( ab );\n\t\n\t                for ( i = 0; i < byteStr.length; i++ ) {\n\t                    intArray[ i ] = byteStr.charCodeAt( i );\n\t                }\n\t\n\t                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n\t\n\t                return this.arrayBufferToBlob( ab, mimetype );\n\t            },\n\t\n\t            dataURL2ArrayBuffer: function( dataURI ) {\n\t                var byteStr, intArray, i, parts;\n\t\n\t                parts = dataURI.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    byteStr = atob( parts[ 1 ] );\n\t                } else {\n\t                    byteStr = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                intArray = new Uint8Array( byteStr.length );\n\t\n\t                for ( i = 0; i < byteStr.length; i++ ) {\n\t                    intArray[ i ] = byteStr.charCodeAt( i );\n\t                }\n\t\n\t                return intArray.buffer;\n\t            },\n\t\n\t            arrayBufferToBlob: function( buffer, type ) {\n\t                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n\t                    bb;\n\t\n\t                // android不支持直接new Blob, 只能借助blobbuilder.\n\t                if ( builder ) {\n\t                    bb = new builder();\n\t                    bb.append( buffer );\n\t                    return bb.getBlob( type );\n\t                }\n\t\n\t                return new Blob([ buffer ], type ? { type: type } : {} );\n\t            },\n\t\n\t            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n\t            // 你得到的结果是png.\n\t            canvasToDataUrl: function( canvas, type, quality ) {\n\t                return canvas.toDataURL( type, quality / 100 );\n\t            },\n\t\n\t            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n\t            parseMeta: function( blob, callback ) {\n\t                callback( false, {});\n\t            },\n\t\n\t            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n\t            updateImageHead: function( data ) {\n\t                return data;\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * Terms:\n\t     *\n\t     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n\t     * @fileOverview Image控件\n\t     */\n\t    define('runtime/html5/imagemeta',[\n\t        'runtime/html5/util'\n\t    ], function( Util ) {\n\t\n\t        var api;\n\t\n\t        api = {\n\t            parsers: {\n\t                0xffe1: []\n\t            },\n\t\n\t            maxMetaDataSize: 262144,\n\t\n\t            parse: function( blob, cb ) {\n\t                var me = this,\n\t                    fr = new FileReader();\n\t\n\t                fr.onload = function() {\n\t                    cb( false, me._parse( this.result ) );\n\t                    fr = fr.onload = fr.onerror = null;\n\t                };\n\t\n\t                fr.onerror = function( e ) {\n\t                    cb( e.message );\n\t                    fr = fr.onload = fr.onerror = null;\n\t                };\n\t\n\t                blob = blob.slice( 0, me.maxMetaDataSize );\n\t                fr.readAsArrayBuffer( blob.getSource() );\n\t            },\n\t\n\t            _parse: function( buffer, noParse ) {\n\t                if ( buffer.byteLength < 6 ) {\n\t                    return;\n\t                }\n\t\n\t                var dataview = new DataView( buffer ),\n\t                    offset = 2,\n\t                    maxOffset = dataview.byteLength - 4,\n\t                    headLength = offset,\n\t                    ret = {},\n\t                    markerBytes, markerLength, parsers, i;\n\t\n\t                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n\t\n\t                    while ( offset < maxOffset ) {\n\t                        markerBytes = dataview.getUint16( offset );\n\t\n\t                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n\t                                markerBytes === 0xfffe ) {\n\t\n\t                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n\t\n\t                            if ( offset + markerLength > dataview.byteLength ) {\n\t                                break;\n\t                            }\n\t\n\t                            parsers = api.parsers[ markerBytes ];\n\t\n\t                            if ( !noParse && parsers ) {\n\t                                for ( i = 0; i < parsers.length; i += 1 ) {\n\t                                    parsers[ i ].call( api, dataview, offset,\n\t                                            markerLength, ret );\n\t                                }\n\t                            }\n\t\n\t                            offset += markerLength;\n\t                            headLength = offset;\n\t                        } else {\n\t                            break;\n\t                        }\n\t                    }\n\t\n\t                    if ( headLength > 6 ) {\n\t                        if ( buffer.slice ) {\n\t                            ret.imageHead = buffer.slice( 2, headLength );\n\t                        } else {\n\t                            // Workaround for IE10, which does not yet\n\t                            // support ArrayBuffer.slice:\n\t                            ret.imageHead = new Uint8Array( buffer )\n\t                                    .subarray( 2, headLength );\n\t                        }\n\t                    }\n\t                }\n\t\n\t                return ret;\n\t            },\n\t\n\t            updateImageHead: function( buffer, head ) {\n\t                var data = this._parse( buffer, true ),\n\t                    buf1, buf2, bodyoffset;\n\t\n\t\n\t                bodyoffset = 2;\n\t                if ( data.imageHead ) {\n\t                    bodyoffset = 2 + data.imageHead.byteLength;\n\t                }\n\t\n\t                if ( buffer.slice ) {\n\t                    buf2 = buffer.slice( bodyoffset );\n\t                } else {\n\t                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n\t                }\n\t\n\t                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n\t\n\t                buf1[ 0 ] = 0xFF;\n\t                buf1[ 1 ] = 0xD8;\n\t                buf1.set( new Uint8Array( head ), 2 );\n\t                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n\t\n\t                return buf1.buffer;\n\t            }\n\t        };\n\t\n\t        Util.parseMeta = function() {\n\t            return api.parse.apply( api, arguments );\n\t        };\n\t\n\t        Util.updateImageHead = function() {\n\t            return api.updateImageHead.apply( api, arguments );\n\t        };\n\t\n\t        return api;\n\t    });\n\t    /**\n\t     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n\t     * 暂时项目中只用了orientation.\n\t     *\n\t     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n\t     * @fileOverview EXIF解析\n\t     */\n\t\n\t    // Sample\n\t    // ====================================\n\t    // Make : Apple\n\t    // Model : iPhone 4S\n\t    // Orientation : 1\n\t    // XResolution : 72 [72/1]\n\t    // YResolution : 72 [72/1]\n\t    // ResolutionUnit : 2\n\t    // Software : QuickTime 7.7.1\n\t    // DateTime : 2013:09:01 22:53:55\n\t    // ExifIFDPointer : 190\n\t    // ExposureTime : 0.058823529411764705 [1/17]\n\t    // FNumber : 2.4 [12/5]\n\t    // ExposureProgram : Normal program\n\t    // ISOSpeedRatings : 800\n\t    // ExifVersion : 0220\n\t    // DateTimeOriginal : 2013:09:01 22:52:51\n\t    // DateTimeDigitized : 2013:09:01 22:52:51\n\t    // ComponentsConfiguration : YCbCr\n\t    // ShutterSpeedValue : 4.058893515764426\n\t    // ApertureValue : 2.5260688216892597 [4845/1918]\n\t    // BrightnessValue : -0.3126686601998395\n\t    // MeteringMode : Pattern\n\t    // Flash : Flash did not fire, compulsory flash mode\n\t    // FocalLength : 4.28 [107/25]\n\t    // SubjectArea : [4 values]\n\t    // FlashpixVersion : 0100\n\t    // ColorSpace : 1\n\t    // PixelXDimension : 2448\n\t    // PixelYDimension : 3264\n\t    // SensingMethod : One-chip color area sensor\n\t    // ExposureMode : 0\n\t    // WhiteBalance : Auto white balance\n\t    // FocalLengthIn35mmFilm : 35\n\t    // SceneCaptureType : Standard\n\t    define('runtime/html5/imagemeta/exif',[\n\t        'base',\n\t        'runtime/html5/imagemeta'\n\t    ], function( Base, ImageMeta ) {\n\t\n\t        var EXIF = {};\n\t\n\t        EXIF.ExifMap = function() {\n\t            return this;\n\t        };\n\t\n\t        EXIF.ExifMap.prototype.map = {\n\t            'Orientation': 0x0112\n\t        };\n\t\n\t        EXIF.ExifMap.prototype.get = function( id ) {\n\t            return this[ id ] || this[ this.map[ id ] ];\n\t        };\n\t\n\t        EXIF.exifTagTypes = {\n\t            // byte, 8-bit unsigned int:\n\t            1: {\n\t                getValue: function( dataView, dataOffset ) {\n\t                    return dataView.getUint8( dataOffset );\n\t                },\n\t                size: 1\n\t            },\n\t\n\t            // ascii, 8-bit byte:\n\t            2: {\n\t                getValue: function( dataView, dataOffset ) {\n\t                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n\t                },\n\t                size: 1,\n\t                ascii: true\n\t            },\n\t\n\t            // short, 16 bit int:\n\t            3: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint16( dataOffset, littleEndian );\n\t                },\n\t                size: 2\n\t            },\n\t\n\t            // long, 32 bit int:\n\t            4: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint32( dataOffset, littleEndian );\n\t                },\n\t                size: 4\n\t            },\n\t\n\t            // rational = two long values,\n\t            // first is numerator, second is denominator:\n\t            5: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint32( dataOffset, littleEndian ) /\n\t                        dataView.getUint32( dataOffset + 4, littleEndian );\n\t                },\n\t                size: 8\n\t            },\n\t\n\t            // slong, 32 bit signed int:\n\t            9: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getInt32( dataOffset, littleEndian );\n\t                },\n\t                size: 4\n\t            },\n\t\n\t            // srational, two slongs, first is numerator, second is denominator:\n\t            10: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getInt32( dataOffset, littleEndian ) /\n\t                        dataView.getInt32( dataOffset + 4, littleEndian );\n\t                },\n\t                size: 8\n\t            }\n\t        };\n\t\n\t        // undefined, 8-bit byte, value depending on field:\n\t        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n\t\n\t        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n\t                littleEndian ) {\n\t\n\t            var tagType = EXIF.exifTagTypes[ type ],\n\t                tagSize, dataOffset, values, i, str, c;\n\t\n\t            if ( !tagType ) {\n\t                Base.log('Invalid Exif data: Invalid tag type.');\n\t                return;\n\t            }\n\t\n\t            tagSize = tagType.size * length;\n\t\n\t            // Determine if the value is contained in the dataOffset bytes,\n\t            // or if the value at the dataOffset is a pointer to the actual data:\n\t            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n\t                    littleEndian ) : (offset + 8);\n\t\n\t            if ( dataOffset + tagSize > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid data offset.');\n\t                return;\n\t            }\n\t\n\t            if ( length === 1 ) {\n\t                return tagType.getValue( dataView, dataOffset, littleEndian );\n\t            }\n\t\n\t            values = [];\n\t\n\t            for ( i = 0; i < length; i += 1 ) {\n\t                values[ i ] = tagType.getValue( dataView,\n\t                        dataOffset + i * tagType.size, littleEndian );\n\t            }\n\t\n\t            if ( tagType.ascii ) {\n\t                str = '';\n\t\n\t                // Concatenate the chars:\n\t                for ( i = 0; i < values.length; i += 1 ) {\n\t                    c = values[ i ];\n\t\n\t                    // Ignore the terminating NULL byte(s):\n\t                    if ( c === '\\u0000' ) {\n\t                        break;\n\t                    }\n\t                    str += c;\n\t                }\n\t\n\t                return str;\n\t            }\n\t            return values;\n\t        };\n\t\n\t        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n\t                data ) {\n\t\n\t            var tag = dataView.getUint16( offset, littleEndian );\n\t            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n\t                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n\t                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n\t                    littleEndian );\n\t        };\n\t\n\t        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n\t                littleEndian, data ) {\n\t\n\t            var tagsNumber, dirEndOffset, i;\n\t\n\t            if ( dirOffset + 6 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid directory offset.');\n\t                return;\n\t            }\n\t\n\t            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n\t            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n\t\n\t            if ( dirEndOffset + 4 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid directory size.');\n\t                return;\n\t            }\n\t\n\t            for ( i = 0; i < tagsNumber; i += 1 ) {\n\t                this.parseExifTag( dataView, tiffOffset,\n\t                        dirOffset + 2 + 12 * i,    // tag offset\n\t                        littleEndian, data );\n\t            }\n\t\n\t            // Return the offset to the next directory:\n\t            return dataView.getUint32( dirEndOffset, littleEndian );\n\t        };\n\t\n\t        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n\t        //     var hexData,\n\t        //         i,\n\t        //         b;\n\t        //     if (!length || offset + length > dataView.byteLength) {\n\t        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n\t        //         return;\n\t        //     }\n\t        //     hexData = [];\n\t        //     for (i = 0; i < length; i += 1) {\n\t        //         b = dataView.getUint8(offset + i);\n\t        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n\t        //     }\n\t        //     return 'data:image/jpeg,%' + hexData.join('%');\n\t        // };\n\t\n\t        EXIF.parseExifData = function( dataView, offset, length, data ) {\n\t\n\t            var tiffOffset = offset + 10,\n\t                littleEndian, dirOffset;\n\t\n\t            // Check for the ASCII code for \"Exif\" (0x45786966):\n\t            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n\t                // No Exif data, might be XMP data instead\n\t                return;\n\t            }\n\t            if ( tiffOffset + 8 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid segment size.');\n\t                return;\n\t            }\n\t\n\t            // Check for the two null bytes:\n\t            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n\t                Base.log('Invalid Exif data: Missing byte alignment offset.');\n\t                return;\n\t            }\n\t\n\t            // Check the byte alignment:\n\t            switch ( dataView.getUint16( tiffOffset ) ) {\n\t                case 0x4949:\n\t                    littleEndian = true;\n\t                    break;\n\t\n\t                case 0x4D4D:\n\t                    littleEndian = false;\n\t                    break;\n\t\n\t                default:\n\t                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n\t                    return;\n\t            }\n\t\n\t            // Check for the TIFF tag marker (0x002A):\n\t            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n\t                Base.log('Invalid Exif data: Missing TIFF marker.');\n\t                return;\n\t            }\n\t\n\t            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n\t            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n\t            // Create the exif object to store the tags:\n\t            data.exif = new EXIF.ExifMap();\n\t            // Parse the tags of the main image directory and retrieve the\n\t            // offset to the next directory, usually the thumbnail directory:\n\t            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n\t                    tiffOffset + dirOffset, littleEndian, data );\n\t\n\t            // 尝试读取缩略图\n\t            // if ( dirOffset ) {\n\t            //     thumbnailData = {exif: {}};\n\t            //     dirOffset = EXIF.parseExifTags(\n\t            //         dataView,\n\t            //         tiffOffset,\n\t            //         tiffOffset + dirOffset,\n\t            //         littleEndian,\n\t            //         thumbnailData\n\t            //     );\n\t\n\t            //     // Check for JPEG Thumbnail offset:\n\t            //     if (thumbnailData.exif[0x0201]) {\n\t            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n\t            //             dataView,\n\t            //             tiffOffset + thumbnailData.exif[0x0201],\n\t            //             thumbnailData.exif[0x0202] // Thumbnail data length\n\t            //         );\n\t            //     }\n\t            // }\n\t        };\n\t\n\t        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n\t        return EXIF;\n\t    });\n\t    /**\n\t     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n\t     * android里面toDataUrl('image/jpege')得到的结果却是png.\n\t     *\n\t     * 所以这里没辙，只能借助这个工具\n\t     * @fileOverview jpeg encoder\n\t     */\n\t    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n\t\n\t        /*\n\t          Copyright (c) 2008, Adobe Systems Incorporated\n\t          All rights reserved.\n\t\n\t          Redistribution and use in source and binary forms, with or without\n\t          modification, are permitted provided that the following conditions are\n\t          met:\n\t\n\t          * Redistributions of source code must retain the above copyright notice,\n\t            this list of conditions and the following disclaimer.\n\t\n\t          * Redistributions in binary form must reproduce the above copyright\n\t            notice, this list of conditions and the following disclaimer in the\n\t            documentation and/or other materials provided with the distribution.\n\t\n\t          * Neither the name of Adobe Systems Incorporated nor the names of its\n\t            contributors may be used to endorse or promote products derived from\n\t            this software without specific prior written permission.\n\t\n\t          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n\t          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n\t          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n\t          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n\t          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n\t          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n\t          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n\t          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n\t          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n\t          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n\t          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\t        */\n\t        /*\n\t        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n\t\n\t        Basic GUI blocking jpeg encoder\n\t        */\n\t\n\t        function JPEGEncoder(quality) {\n\t          var self = this;\n\t            var fround = Math.round;\n\t            var ffloor = Math.floor;\n\t            var YTable = new Array(64);\n\t            var UVTable = new Array(64);\n\t            var fdtbl_Y = new Array(64);\n\t            var fdtbl_UV = new Array(64);\n\t            var YDC_HT;\n\t            var UVDC_HT;\n\t            var YAC_HT;\n\t            var UVAC_HT;\n\t\n\t            var bitcode = new Array(65535);\n\t            var category = new Array(65535);\n\t            var outputfDCTQuant = new Array(64);\n\t            var DU = new Array(64);\n\t            var byteout = [];\n\t            var bytenew = 0;\n\t            var bytepos = 7;\n\t\n\t            var YDU = new Array(64);\n\t            var UDU = new Array(64);\n\t            var VDU = new Array(64);\n\t            var clt = new Array(256);\n\t            var RGB_YUV_TABLE = new Array(2048);\n\t            var currentQuality;\n\t\n\t            var ZigZag = [\n\t                     0, 1, 5, 6,14,15,27,28,\n\t                     2, 4, 7,13,16,26,29,42,\n\t                     3, 8,12,17,25,30,41,43,\n\t                     9,11,18,24,31,40,44,53,\n\t                    10,19,23,32,39,45,52,54,\n\t                    20,22,33,38,46,51,55,60,\n\t                    21,34,37,47,50,56,59,61,\n\t                    35,36,48,49,57,58,62,63\n\t                ];\n\t\n\t            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n\t            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n\t            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n\t            var std_ac_luminance_values = [\n\t                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n\t                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n\t                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n\t                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n\t                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n\t                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n\t                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n\t                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n\t                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n\t                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n\t                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n\t                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n\t                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n\t                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n\t                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n\t                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n\t                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n\t                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n\t                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n\t                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n\t                    0xf9,0xfa\n\t                ];\n\t\n\t            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n\t            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n\t            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n\t            var std_ac_chrominance_values = [\n\t                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n\t                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n\t                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n\t                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n\t                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n\t                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n\t                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n\t                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n\t                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n\t                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n\t                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n\t                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n\t                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n\t                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n\t                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n\t                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n\t                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n\t                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n\t                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n\t                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n\t                    0xf9,0xfa\n\t                ];\n\t\n\t            function initQuantTables(sf){\n\t                    var YQT = [\n\t                        16, 11, 10, 16, 24, 40, 51, 61,\n\t                        12, 12, 14, 19, 26, 58, 60, 55,\n\t                        14, 13, 16, 24, 40, 57, 69, 56,\n\t                        14, 17, 22, 29, 51, 87, 80, 62,\n\t                        18, 22, 37, 56, 68,109,103, 77,\n\t                        24, 35, 55, 64, 81,104,113, 92,\n\t                        49, 64, 78, 87,103,121,120,101,\n\t                        72, 92, 95, 98,112,100,103, 99\n\t                    ];\n\t\n\t                    for (var i = 0; i < 64; i++) {\n\t                        var t = ffloor((YQT[i]*sf+50)/100);\n\t                        if (t < 1) {\n\t                            t = 1;\n\t                        } else if (t > 255) {\n\t                            t = 255;\n\t                        }\n\t                        YTable[ZigZag[i]] = t;\n\t                    }\n\t                    var UVQT = [\n\t                        17, 18, 24, 47, 99, 99, 99, 99,\n\t                        18, 21, 26, 66, 99, 99, 99, 99,\n\t                        24, 26, 56, 99, 99, 99, 99, 99,\n\t                        47, 66, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99\n\t                    ];\n\t                    for (var j = 0; j < 64; j++) {\n\t                        var u = ffloor((UVQT[j]*sf+50)/100);\n\t                        if (u < 1) {\n\t                            u = 1;\n\t                        } else if (u > 255) {\n\t                            u = 255;\n\t                        }\n\t                        UVTable[ZigZag[j]] = u;\n\t                    }\n\t                    var aasf = [\n\t                        1.0, 1.387039845, 1.306562965, 1.175875602,\n\t                        1.0, 0.785694958, 0.541196100, 0.275899379\n\t                    ];\n\t                    var k = 0;\n\t                    for (var row = 0; row < 8; row++)\n\t                    {\n\t                        for (var col = 0; col < 8; col++)\n\t                        {\n\t                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n\t                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n\t                            k++;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                function computeHuffmanTbl(nrcodes, std_table){\n\t                    var codevalue = 0;\n\t                    var pos_in_table = 0;\n\t                    var HT = new Array();\n\t                    for (var k = 1; k <= 16; k++) {\n\t                        for (var j = 1; j <= nrcodes[k]; j++) {\n\t                            HT[std_table[pos_in_table]] = [];\n\t                            HT[std_table[pos_in_table]][0] = codevalue;\n\t                            HT[std_table[pos_in_table]][1] = k;\n\t                            pos_in_table++;\n\t                            codevalue++;\n\t                        }\n\t                        codevalue*=2;\n\t                    }\n\t                    return HT;\n\t                }\n\t\n\t                function initHuffmanTbl()\n\t                {\n\t                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n\t                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n\t                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n\t                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n\t                }\n\t\n\t                function initCategoryNumber()\n\t                {\n\t                    var nrlower = 1;\n\t                    var nrupper = 2;\n\t                    for (var cat = 1; cat <= 15; cat++) {\n\t                        //Positive numbers\n\t                        for (var nr = nrlower; nr<nrupper; nr++) {\n\t                            category[32767+nr] = cat;\n\t                            bitcode[32767+nr] = [];\n\t                            bitcode[32767+nr][1] = cat;\n\t                            bitcode[32767+nr][0] = nr;\n\t                        }\n\t                        //Negative numbers\n\t                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n\t                            category[32767+nrneg] = cat;\n\t                            bitcode[32767+nrneg] = [];\n\t                            bitcode[32767+nrneg][1] = cat;\n\t                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n\t                        }\n\t                        nrlower <<= 1;\n\t                        nrupper <<= 1;\n\t                    }\n\t                }\n\t\n\t                function initRGBYUVTable() {\n\t                    for(var i = 0; i < 256;i++) {\n\t                        RGB_YUV_TABLE[i]            =  19595 * i;\n\t                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n\t                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n\t                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n\t                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n\t                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n\t                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n\t                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n\t                    }\n\t                }\n\t\n\t                // IO functions\n\t                function writeBits(bs)\n\t                {\n\t                    var value = bs[0];\n\t                    var posval = bs[1]-1;\n\t                    while ( posval >= 0 ) {\n\t                        if (value & (1 << posval) ) {\n\t                            bytenew |= (1 << bytepos);\n\t                        }\n\t                        posval--;\n\t                        bytepos--;\n\t                        if (bytepos < 0) {\n\t                            if (bytenew == 0xFF) {\n\t                                writeByte(0xFF);\n\t                                writeByte(0);\n\t                            }\n\t                            else {\n\t                                writeByte(bytenew);\n\t                            }\n\t                            bytepos=7;\n\t                            bytenew=0;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                function writeByte(value)\n\t                {\n\t                    byteout.push(clt[value]); // write char directly instead of converting later\n\t                }\n\t\n\t                function writeWord(value)\n\t                {\n\t                    writeByte((value>>8)&0xFF);\n\t                    writeByte((value   )&0xFF);\n\t                }\n\t\n\t                // DCT & quantization core\n\t                function fDCTQuant(data, fdtbl)\n\t                {\n\t                    var d0, d1, d2, d3, d4, d5, d6, d7;\n\t                    /* Pass 1: process rows. */\n\t                    var dataOff=0;\n\t                    var i;\n\t                    var I8 = 8;\n\t                    var I64 = 64;\n\t                    for (i=0; i<I8; ++i)\n\t                    {\n\t                        d0 = data[dataOff];\n\t                        d1 = data[dataOff+1];\n\t                        d2 = data[dataOff+2];\n\t                        d3 = data[dataOff+3];\n\t                        d4 = data[dataOff+4];\n\t                        d5 = data[dataOff+5];\n\t                        d6 = data[dataOff+6];\n\t                        d7 = data[dataOff+7];\n\t\n\t                        var tmp0 = d0 + d7;\n\t                        var tmp7 = d0 - d7;\n\t                        var tmp1 = d1 + d6;\n\t                        var tmp6 = d1 - d6;\n\t                        var tmp2 = d2 + d5;\n\t                        var tmp5 = d2 - d5;\n\t                        var tmp3 = d3 + d4;\n\t                        var tmp4 = d3 - d4;\n\t\n\t                        /* Even part */\n\t                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n\t                        var tmp13 = tmp0 - tmp3;\n\t                        var tmp11 = tmp1 + tmp2;\n\t                        var tmp12 = tmp1 - tmp2;\n\t\n\t                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n\t                        data[dataOff+4] = tmp10 - tmp11;\n\t\n\t                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n\t                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n\t                        data[dataOff+6] = tmp13 - z1;\n\t\n\t                        /* Odd part */\n\t                        tmp10 = tmp4 + tmp5; /* phase 2 */\n\t                        tmp11 = tmp5 + tmp6;\n\t                        tmp12 = tmp6 + tmp7;\n\t\n\t                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n\t                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n\t                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n\t                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n\t                        var z3 = tmp11 * 0.707106781; /* c4 */\n\t\n\t                        var z11 = tmp7 + z3;    /* phase 5 */\n\t                        var z13 = tmp7 - z3;\n\t\n\t                        data[dataOff+5] = z13 + z2; /* phase 6 */\n\t                        data[dataOff+3] = z13 - z2;\n\t                        data[dataOff+1] = z11 + z4;\n\t                        data[dataOff+7] = z11 - z4;\n\t\n\t                        dataOff += 8; /* advance pointer to next row */\n\t                    }\n\t\n\t                    /* Pass 2: process columns. */\n\t                    dataOff = 0;\n\t                    for (i=0; i<I8; ++i)\n\t                    {\n\t                        d0 = data[dataOff];\n\t                        d1 = data[dataOff + 8];\n\t                        d2 = data[dataOff + 16];\n\t                        d3 = data[dataOff + 24];\n\t                        d4 = data[dataOff + 32];\n\t                        d5 = data[dataOff + 40];\n\t                        d6 = data[dataOff + 48];\n\t                        d7 = data[dataOff + 56];\n\t\n\t                        var tmp0p2 = d0 + d7;\n\t                        var tmp7p2 = d0 - d7;\n\t                        var tmp1p2 = d1 + d6;\n\t                        var tmp6p2 = d1 - d6;\n\t                        var tmp2p2 = d2 + d5;\n\t                        var tmp5p2 = d2 - d5;\n\t                        var tmp3p2 = d3 + d4;\n\t                        var tmp4p2 = d3 - d4;\n\t\n\t                        /* Even part */\n\t                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n\t                        var tmp13p2 = tmp0p2 - tmp3p2;\n\t                        var tmp11p2 = tmp1p2 + tmp2p2;\n\t                        var tmp12p2 = tmp1p2 - tmp2p2;\n\t\n\t                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n\t                        data[dataOff+32] = tmp10p2 - tmp11p2;\n\t\n\t                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n\t                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n\t                        data[dataOff+48] = tmp13p2 - z1p2;\n\t\n\t                        /* Odd part */\n\t                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n\t                        tmp11p2 = tmp5p2 + tmp6p2;\n\t                        tmp12p2 = tmp6p2 + tmp7p2;\n\t\n\t                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n\t                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n\t                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n\t                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n\t                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n\t\n\t                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n\t                        var z13p2 = tmp7p2 - z3p2;\n\t\n\t                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n\t                        data[dataOff+24] = z13p2 - z2p2;\n\t                        data[dataOff+ 8] = z11p2 + z4p2;\n\t                        data[dataOff+56] = z11p2 - z4p2;\n\t\n\t                        dataOff++; /* advance pointer to next column */\n\t                    }\n\t\n\t                    // Quantize/descale the coefficients\n\t                    var fDCTQuant;\n\t                    for (i=0; i<I64; ++i)\n\t                    {\n\t                        // Apply the quantization and scaling factor & Round to nearest integer\n\t                        fDCTQuant = data[i]*fdtbl[i];\n\t                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n\t                        //outputfDCTQuant[i] = fround(fDCTQuant);\n\t\n\t                    }\n\t                    return outputfDCTQuant;\n\t                }\n\t\n\t                function writeAPP0()\n\t                {\n\t                    writeWord(0xFFE0); // marker\n\t                    writeWord(16); // length\n\t                    writeByte(0x4A); // J\n\t                    writeByte(0x46); // F\n\t                    writeByte(0x49); // I\n\t                    writeByte(0x46); // F\n\t                    writeByte(0); // = \"JFIF\",'\\0'\n\t                    writeByte(1); // versionhi\n\t                    writeByte(1); // versionlo\n\t                    writeByte(0); // xyunits\n\t                    writeWord(1); // xdensity\n\t                    writeWord(1); // ydensity\n\t                    writeByte(0); // thumbnwidth\n\t                    writeByte(0); // thumbnheight\n\t                }\n\t\n\t                function writeSOF0(width, height)\n\t                {\n\t                    writeWord(0xFFC0); // marker\n\t                    writeWord(17);   // length, truecolor YUV JPG\n\t                    writeByte(8);    // precision\n\t                    writeWord(height);\n\t                    writeWord(width);\n\t                    writeByte(3);    // nrofcomponents\n\t                    writeByte(1);    // IdY\n\t                    writeByte(0x11); // HVY\n\t                    writeByte(0);    // QTY\n\t                    writeByte(2);    // IdU\n\t                    writeByte(0x11); // HVU\n\t                    writeByte(1);    // QTU\n\t                    writeByte(3);    // IdV\n\t                    writeByte(0x11); // HVV\n\t                    writeByte(1);    // QTV\n\t                }\n\t\n\t                function writeDQT()\n\t                {\n\t                    writeWord(0xFFDB); // marker\n\t                    writeWord(132);    // length\n\t                    writeByte(0);\n\t                    for (var i=0; i<64; i++) {\n\t                        writeByte(YTable[i]);\n\t                    }\n\t                    writeByte(1);\n\t                    for (var j=0; j<64; j++) {\n\t                        writeByte(UVTable[j]);\n\t                    }\n\t                }\n\t\n\t                function writeDHT()\n\t                {\n\t                    writeWord(0xFFC4); // marker\n\t                    writeWord(0x01A2); // length\n\t\n\t                    writeByte(0); // HTYDCinfo\n\t                    for (var i=0; i<16; i++) {\n\t                        writeByte(std_dc_luminance_nrcodes[i+1]);\n\t                    }\n\t                    for (var j=0; j<=11; j++) {\n\t                        writeByte(std_dc_luminance_values[j]);\n\t                    }\n\t\n\t                    writeByte(0x10); // HTYACinfo\n\t                    for (var k=0; k<16; k++) {\n\t                        writeByte(std_ac_luminance_nrcodes[k+1]);\n\t                    }\n\t                    for (var l=0; l<=161; l++) {\n\t                        writeByte(std_ac_luminance_values[l]);\n\t                    }\n\t\n\t                    writeByte(1); // HTUDCinfo\n\t                    for (var m=0; m<16; m++) {\n\t                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n\t                    }\n\t                    for (var n=0; n<=11; n++) {\n\t                        writeByte(std_dc_chrominance_values[n]);\n\t                    }\n\t\n\t                    writeByte(0x11); // HTUACinfo\n\t                    for (var o=0; o<16; o++) {\n\t                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n\t                    }\n\t                    for (var p=0; p<=161; p++) {\n\t                        writeByte(std_ac_chrominance_values[p]);\n\t                    }\n\t                }\n\t\n\t                function writeSOS()\n\t                {\n\t                    writeWord(0xFFDA); // marker\n\t                    writeWord(12); // length\n\t                    writeByte(3); // nrofcomponents\n\t                    writeByte(1); // IdY\n\t                    writeByte(0); // HTY\n\t                    writeByte(2); // IdU\n\t                    writeByte(0x11); // HTU\n\t                    writeByte(3); // IdV\n\t                    writeByte(0x11); // HTV\n\t                    writeByte(0); // Ss\n\t                    writeByte(0x3f); // Se\n\t                    writeByte(0); // Bf\n\t                }\n\t\n\t                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n\t                    var EOB = HTAC[0x00];\n\t                    var M16zeroes = HTAC[0xF0];\n\t                    var pos;\n\t                    var I16 = 16;\n\t                    var I63 = 63;\n\t                    var I64 = 64;\n\t                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n\t                    //ZigZag reorder\n\t                    for (var j=0;j<I64;++j) {\n\t                        DU[ZigZag[j]]=DU_DCT[j];\n\t                    }\n\t                    var Diff = DU[0] - DC; DC = DU[0];\n\t                    //Encode DC\n\t                    if (Diff==0) {\n\t                        writeBits(HTDC[0]); // Diff might be 0\n\t                    } else {\n\t                        pos = 32767+Diff;\n\t                        writeBits(HTDC[category[pos]]);\n\t                        writeBits(bitcode[pos]);\n\t                    }\n\t                    //Encode ACs\n\t                    var end0pos = 63; // was const... which is crazy\n\t                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n\t                    //end0pos = first element in reverse order !=0\n\t                    if ( end0pos == 0) {\n\t                        writeBits(EOB);\n\t                        return DC;\n\t                    }\n\t                    var i = 1;\n\t                    var lng;\n\t                    while ( i <= end0pos ) {\n\t                        var startpos = i;\n\t                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n\t                        var nrzeroes = i-startpos;\n\t                        if ( nrzeroes >= I16 ) {\n\t                            lng = nrzeroes>>4;\n\t                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n\t                                writeBits(M16zeroes);\n\t                            nrzeroes = nrzeroes&0xF;\n\t                        }\n\t                        pos = 32767+DU[i];\n\t                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n\t                        writeBits(bitcode[pos]);\n\t                        i++;\n\t                    }\n\t                    if ( end0pos != I63 ) {\n\t                        writeBits(EOB);\n\t                    }\n\t                    return DC;\n\t                }\n\t\n\t                function initCharLookupTable(){\n\t                    var sfcc = String.fromCharCode;\n\t                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n\t                        clt[i] = sfcc(i);\n\t                    }\n\t                }\n\t\n\t                this.encode = function(image,quality) // image data object\n\t                {\n\t                    // var time_start = new Date().getTime();\n\t\n\t                    if(quality) setQuality(quality);\n\t\n\t                    // Initialize bit writer\n\t                    byteout = new Array();\n\t                    bytenew=0;\n\t                    bytepos=7;\n\t\n\t                    // Add JPEG headers\n\t                    writeWord(0xFFD8); // SOI\n\t                    writeAPP0();\n\t                    writeDQT();\n\t                    writeSOF0(image.width,image.height);\n\t                    writeDHT();\n\t                    writeSOS();\n\t\n\t\n\t                    // Encode 8x8 macroblocks\n\t                    var DCY=0;\n\t                    var DCU=0;\n\t                    var DCV=0;\n\t\n\t                    bytenew=0;\n\t                    bytepos=7;\n\t\n\t\n\t                    this.encode.displayName = \"_encode_\";\n\t\n\t                    var imageData = image.data;\n\t                    var width = image.width;\n\t                    var height = image.height;\n\t\n\t                    var quadWidth = width*4;\n\t                    var tripleWidth = width*3;\n\t\n\t                    var x, y = 0;\n\t                    var r, g, b;\n\t                    var start,p, col,row,pos;\n\t                    while(y < height){\n\t                        x = 0;\n\t                        while(x < quadWidth){\n\t                        start = quadWidth * y + x;\n\t                        p = start;\n\t                        col = -1;\n\t                        row = 0;\n\t\n\t                        for(pos=0; pos < 64; pos++){\n\t                            row = pos >> 3;// /8\n\t                            col = ( pos & 7 ) * 4; // %8\n\t                            p = start + ( row * quadWidth ) + col;\n\t\n\t                            if(y+row >= height){ // padding bottom\n\t                                p-= (quadWidth*(y+1+row-height));\n\t                            }\n\t\n\t                            if(x+col >= quadWidth){ // padding right\n\t                                p-= ((x+col) - quadWidth +4)\n\t                            }\n\t\n\t                            r = imageData[ p++ ];\n\t                            g = imageData[ p++ ];\n\t                            b = imageData[ p++ ];\n\t\n\t\n\t                            /* // calculate YUV values dynamically\n\t                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n\t                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n\t                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n\t                            */\n\t\n\t                            // use lookup table (slightly faster)\n\t                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n\t                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n\t                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n\t\n\t                        }\n\t\n\t                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n\t                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n\t                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n\t                        x+=32;\n\t                        }\n\t                        y+=8;\n\t                    }\n\t\n\t\n\t                    ////////////////////////////////////////////////////////////////\n\t\n\t                    // Do the bit alignment of the EOI marker\n\t                    if ( bytepos >= 0 ) {\n\t                        var fillbits = [];\n\t                        fillbits[1] = bytepos+1;\n\t                        fillbits[0] = (1<<(bytepos+1))-1;\n\t                        writeBits(fillbits);\n\t                    }\n\t\n\t                    writeWord(0xFFD9); //EOI\n\t\n\t                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n\t\n\t                    byteout = [];\n\t\n\t                    // benchmarking\n\t                    // var duration = new Date().getTime() - time_start;\n\t                    // console.log('Encoding time: '+ currentQuality + 'ms');\n\t                    //\n\t\n\t                    return jpegDataUri\n\t            }\n\t\n\t            function setQuality(quality){\n\t                if (quality <= 0) {\n\t                    quality = 1;\n\t                }\n\t                if (quality > 100) {\n\t                    quality = 100;\n\t                }\n\t\n\t                if(currentQuality == quality) return // don't recalc if unchanged\n\t\n\t                var sf = 0;\n\t                if (quality < 50) {\n\t                    sf = Math.floor(5000 / quality);\n\t                } else {\n\t                    sf = Math.floor(200 - quality*2);\n\t                }\n\t\n\t                initQuantTables(sf);\n\t                currentQuality = quality;\n\t                // console.log('Quality set to: '+quality +'%');\n\t            }\n\t\n\t            function init(){\n\t                // var time_start = new Date().getTime();\n\t                if(!quality) quality = 50;\n\t                // Create tables\n\t                initCharLookupTable()\n\t                initHuffmanTbl();\n\t                initCategoryNumber();\n\t                initRGBYUVTable();\n\t\n\t                setQuality(quality);\n\t                // var duration = new Date().getTime() - time_start;\n\t                // console.log('Initialization '+ duration + 'ms');\n\t            }\n\t\n\t            init();\n\t\n\t        }\n\t\n\t        JPEGEncoder.encode = function( data, quality ) {\n\t            var encoder = new JPEGEncoder( quality );\n\t\n\t            return encoder.encode( data );\n\t        }\n\t\n\t        return JPEGEncoder;\n\t    });\n\t    /**\n\t     * @fileOverview Fix android canvas.toDataUrl bug.\n\t     */\n\t    define('runtime/html5/androidpatch',[\n\t        'runtime/html5/util',\n\t        'runtime/html5/jpegencoder',\n\t        'base'\n\t    ], function( Util, encoder, Base ) {\n\t        var origin = Util.canvasToDataUrl,\n\t            supportJpeg;\n\t\n\t        Util.canvasToDataUrl = function( canvas, type, quality ) {\n\t            var ctx, w, h, fragement, parts;\n\t\n\t            // 非android手机直接跳过。\n\t            if ( !Base.os.android ) {\n\t                return origin.apply( null, arguments );\n\t            }\n\t\n\t            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n\t            // JPEG 前两位分别是：255, 216\n\t            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n\t                fragement = origin.apply( null, arguments );\n\t\n\t                parts = fragement.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    fragement = atob( parts[ 1 ] );\n\t                } else {\n\t                    fragement = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                fragement = fragement.substring( 0, 2 );\n\t\n\t                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n\t                        fragement.charCodeAt( 1 ) === 216;\n\t            }\n\t\n\t            // 只有在android环境下才修复\n\t            if ( type === 'image/jpeg' && !supportJpeg ) {\n\t                w = canvas.width;\n\t                h = canvas.height;\n\t                ctx = canvas.getContext('2d');\n\t\n\t                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n\t            }\n\t\n\t            return origin.apply( null, arguments );\n\t        };\n\t    });\n\t    /**\n\t     * @fileOverview Image\n\t     */\n\t    define('runtime/html5/image',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'runtime/html5/util'\n\t    ], function( Base, Html5Runtime, Util ) {\n\t\n\t        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n\t\n\t        return Html5Runtime.register( 'Image', {\n\t\n\t            // flag: 标记是否被修改过。\n\t            modified: false,\n\t\n\t            init: function() {\n\t                var me = this,\n\t                    img = new Image();\n\t\n\t                img.onload = function() {\n\t\n\t                    me._info = {\n\t                        type: me.type,\n\t                        width: this.width,\n\t                        height: this.height\n\t                    };\n\t\n\t                    // 读取meta信息。\n\t                    if ( !me._metas && 'image/jpeg' === me.type ) {\n\t                        Util.parseMeta( me._blob, function( error, ret ) {\n\t                            me._metas = ret;\n\t                            me.owner.trigger('load');\n\t                        });\n\t                    } else {\n\t                        me.owner.trigger('load');\n\t                    }\n\t                };\n\t\n\t                img.onerror = function() {\n\t                    me.owner.trigger('error');\n\t                };\n\t\n\t                me._img = img;\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var me = this,\n\t                    img = me._img;\n\t\n\t                me._blob = blob;\n\t                me.type = blob.type;\n\t                img.src = Util.createObjectURL( blob.getSource() );\n\t                me.owner.once( 'load', function() {\n\t                    Util.revokeObjectURL( img.src );\n\t                });\n\t            },\n\t\n\t            resize: function( width, height ) {\n\t                var canvas = this._canvas ||\n\t                        (this._canvas = document.createElement('canvas'));\n\t\n\t                this._resize( this._img, canvas, width, height );\n\t                this._blob = null;    // 没用了，可以删掉了。\n\t                this.modified = true;\n\t                this.owner.trigger( 'complete', 'resize' );\n\t            },\n\t\n\t            crop: function( x, y, w, h, s ) {\n\t                var cvs = this._canvas ||\n\t                        (this._canvas = document.createElement('canvas')),\n\t                    opts = this.options,\n\t                    img = this._img,\n\t                    iw = img.naturalWidth,\n\t                    ih = img.naturalHeight,\n\t                    orientation = this.getOrientation();\n\t\n\t                s = s || 1;\n\t\n\t                // todo 解决 orientation 的问题。\n\t                // values that require 90 degree rotation\n\t                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\t\n\t                //     switch ( orientation ) {\n\t                //         case 6:\n\t                //             tmp = x;\n\t                //             x = y;\n\t                //             y = iw * s - tmp - w;\n\t                //             console.log(ih * s, tmp, w)\n\t                //             break;\n\t                //     }\n\t\n\t                //     (w ^= h, h ^= w, w ^= h);\n\t                // }\n\t\n\t                cvs.width = w;\n\t                cvs.height = h;\n\t\n\t                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\t                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n\t\n\t                this._blob = null;    // 没用了，可以删掉了。\n\t                this.modified = true;\n\t                this.owner.trigger( 'complete', 'crop' );\n\t            },\n\t\n\t            getAsBlob: function( type ) {\n\t                var blob = this._blob,\n\t                    opts = this.options,\n\t                    canvas;\n\t\n\t                type = type || this.type;\n\t\n\t                // blob需要重新生成。\n\t                if ( this.modified || this.type !== type ) {\n\t                    canvas = this._canvas;\n\t\n\t                    if ( type === 'image/jpeg' ) {\n\t\n\t                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n\t\n\t                        if ( opts.preserveHeaders && this._metas &&\n\t                                this._metas.imageHead ) {\n\t\n\t                            blob = Util.dataURL2ArrayBuffer( blob );\n\t                            blob = Util.updateImageHead( blob,\n\t                                    this._metas.imageHead );\n\t                            blob = Util.arrayBufferToBlob( blob, type );\n\t                            return blob;\n\t                        }\n\t                    } else {\n\t                        blob = Util.canvasToDataUrl( canvas, type );\n\t                    }\n\t\n\t                    blob = Util.dataURL2Blob( blob );\n\t                }\n\t\n\t                return blob;\n\t            },\n\t\n\t            getAsDataUrl: function( type ) {\n\t                var opts = this.options;\n\t\n\t                type = type || this.type;\n\t\n\t                if ( type === 'image/jpeg' ) {\n\t                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n\t                } else {\n\t                    return this._canvas.toDataURL( type );\n\t                }\n\t            },\n\t\n\t            getOrientation: function() {\n\t                return this._metas && this._metas.exif &&\n\t                        this._metas.exif.get('Orientation') || 1;\n\t            },\n\t\n\t            info: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._info = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._info;\n\t            },\n\t\n\t            meta: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._meta = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._meta;\n\t            },\n\t\n\t            destroy: function() {\n\t                var canvas = this._canvas;\n\t                this._img.onload = null;\n\t\n\t                if ( canvas ) {\n\t                    canvas.getContext('2d')\n\t                            .clearRect( 0, 0, canvas.width, canvas.height );\n\t                    canvas.width = canvas.height = 0;\n\t                    this._canvas = null;\n\t                }\n\t\n\t                // 释放内存。非常重要，否则释放不了image的内存。\n\t                this._img.src = BLANK;\n\t                this._img = this._blob = null;\n\t            },\n\t\n\t            _resize: function( img, cvs, width, height ) {\n\t                var opts = this.options,\n\t                    naturalWidth = img.width,\n\t                    naturalHeight = img.height,\n\t                    orientation = this.getOrientation(),\n\t                    scale, w, h, x, y;\n\t\n\t                // values that require 90 degree rotation\n\t                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\t\n\t                    // 交换width, height的值。\n\t                    width ^= height;\n\t                    height ^= width;\n\t                    width ^= height;\n\t                }\n\t\n\t                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n\t                        height / naturalHeight );\n\t\n\t                // 不允许放大。\n\t                opts.allowMagnify || (scale = Math.min( 1, scale ));\n\t\n\t                w = naturalWidth * scale;\n\t                h = naturalHeight * scale;\n\t\n\t                if ( opts.crop ) {\n\t                    cvs.width = width;\n\t                    cvs.height = height;\n\t                } else {\n\t                    cvs.width = w;\n\t                    cvs.height = h;\n\t                }\n\t\n\t                x = (cvs.width - w) / 2;\n\t                y = (cvs.height - h) / 2;\n\t\n\t                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\t\n\t                this._renderImageToCanvas( cvs, img, x, y, w, h );\n\t            },\n\t\n\t            _rotate2Orientaion: function( canvas, orientation ) {\n\t                var width = canvas.width,\n\t                    height = canvas.height,\n\t                    ctx = canvas.getContext('2d');\n\t\n\t                switch ( orientation ) {\n\t                    case 5:\n\t                    case 6:\n\t                    case 7:\n\t                    case 8:\n\t                        canvas.width = height;\n\t                        canvas.height = width;\n\t                        break;\n\t                }\n\t\n\t                switch ( orientation ) {\n\t                    case 2:    // horizontal flip\n\t                        ctx.translate( width, 0 );\n\t                        ctx.scale( -1, 1 );\n\t                        break;\n\t\n\t                    case 3:    // 180 rotate left\n\t                        ctx.translate( width, height );\n\t                        ctx.rotate( Math.PI );\n\t                        break;\n\t\n\t                    case 4:    // vertical flip\n\t                        ctx.translate( 0, height );\n\t                        ctx.scale( 1, -1 );\n\t                        break;\n\t\n\t                    case 5:    // vertical flip + 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.scale( 1, -1 );\n\t                        break;\n\t\n\t                    case 6:    // 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.translate( 0, -height );\n\t                        break;\n\t\n\t                    case 7:    // horizontal flip + 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.translate( width, -height );\n\t                        ctx.scale( -1, 1 );\n\t                        break;\n\t\n\t                    case 8:    // 90 rotate left\n\t                        ctx.rotate( -0.5 * Math.PI );\n\t                        ctx.translate( -width, 0 );\n\t                        break;\n\t                }\n\t            },\n\t\n\t            // https://github.com/stomita/ios-imagefile-megapixel/\n\t            // blob/master/src/megapix-image.js\n\t            _renderImageToCanvas: (function() {\n\t\n\t                // 如果不是ios, 不需要这么复杂！\n\t                if ( !Base.os.ios ) {\n\t                    return function( canvas ) {\n\t                        var args = Base.slice( arguments, 1 ),\n\t                            ctx = canvas.getContext('2d');\n\t\n\t                        ctx.drawImage.apply( ctx, args );\n\t                    };\n\t                }\n\t\n\t                /**\n\t                 * Detecting vertical squash in loaded image.\n\t                 * Fixes a bug which squash image vertically while drawing into\n\t                 * canvas for some images.\n\t                 */\n\t                function detectVerticalSquash( img, iw, ih ) {\n\t                    var canvas = document.createElement('canvas'),\n\t                        ctx = canvas.getContext('2d'),\n\t                        sy = 0,\n\t                        ey = ih,\n\t                        py = ih,\n\t                        data, alpha, ratio;\n\t\n\t\n\t                    canvas.width = 1;\n\t                    canvas.height = ih;\n\t                    ctx.drawImage( img, 0, 0 );\n\t                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n\t\n\t                    // search image edge pixel position in case\n\t                    // it is squashed vertically.\n\t                    while ( py > sy ) {\n\t                        alpha = data[ (py - 1) * 4 + 3 ];\n\t\n\t                        if ( alpha === 0 ) {\n\t                            ey = py;\n\t                        } else {\n\t                            sy = py;\n\t                        }\n\t\n\t                        py = (ey + sy) >> 1;\n\t                    }\n\t\n\t                    ratio = (py / ih);\n\t                    return (ratio === 0) ? 1 : ratio;\n\t                }\n\t\n\t                // fix ie7 bug\n\t                // http://stackoverflow.com/questions/11929099/\n\t                // html5-canvas-drawimage-ratio-bug-ios\n\t                if ( Base.os.ios >= 7 ) {\n\t                    return function( canvas, img, x, y, w, h ) {\n\t                        var iw = img.naturalWidth,\n\t                            ih = img.naturalHeight,\n\t                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n\t\n\t                        return canvas.getContext('2d').drawImage( img, 0, 0,\n\t                                iw * vertSquashRatio, ih * vertSquashRatio,\n\t                                x, y, w, h );\n\t                    };\n\t                }\n\t\n\t                /**\n\t                 * Detect subsampling in loaded image.\n\t                 * In iOS, larger images than 2M pixels may be\n\t                 * subsampled in rendering.\n\t                 */\n\t                function detectSubsampling( img ) {\n\t                    var iw = img.naturalWidth,\n\t                        ih = img.naturalHeight,\n\t                        canvas, ctx;\n\t\n\t                    // subsampling may happen overmegapixel image\n\t                    if ( iw * ih > 1024 * 1024 ) {\n\t                        canvas = document.createElement('canvas');\n\t                        canvas.width = canvas.height = 1;\n\t                        ctx = canvas.getContext('2d');\n\t                        ctx.drawImage( img, -iw + 1, 0 );\n\t\n\t                        // subsampled image becomes half smaller in rendering size.\n\t                        // check alpha channel value to confirm image is covering\n\t                        // edge pixel or not. if alpha value is 0\n\t                        // image is not covering, hence subsampled.\n\t                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n\t                    } else {\n\t                        return false;\n\t                    }\n\t                }\n\t\n\t\n\t                return function( canvas, img, x, y, width, height ) {\n\t                    var iw = img.naturalWidth,\n\t                        ih = img.naturalHeight,\n\t                        ctx = canvas.getContext('2d'),\n\t                        subsampled = detectSubsampling( img ),\n\t                        doSquash = this.type === 'image/jpeg',\n\t                        d = 1024,\n\t                        sy = 0,\n\t                        dy = 0,\n\t                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n\t\n\t                    if ( subsampled ) {\n\t                        iw /= 2;\n\t                        ih /= 2;\n\t                    }\n\t\n\t                    ctx.save();\n\t                    tmpCanvas = document.createElement('canvas');\n\t                    tmpCanvas.width = tmpCanvas.height = d;\n\t\n\t                    tmpCtx = tmpCanvas.getContext('2d');\n\t                    vertSquashRatio = doSquash ?\n\t                            detectVerticalSquash( img, iw, ih ) : 1;\n\t\n\t                    dw = Math.ceil( d * width / iw );\n\t                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n\t\n\t                    while ( sy < ih ) {\n\t                        sx = 0;\n\t                        dx = 0;\n\t                        while ( sx < iw ) {\n\t                            tmpCtx.clearRect( 0, 0, d, d );\n\t                            tmpCtx.drawImage( img, -sx, -sy );\n\t                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n\t                                    x + dx, y + dy, dw, dh );\n\t                            sx += d;\n\t                            dx += dw;\n\t                        }\n\t                        sy += d;\n\t                        dy += dh;\n\t                    }\n\t                    ctx.restore();\n\t                    tmpCanvas = tmpCtx = null;\n\t                };\n\t            })()\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Transport\n\t     * @todo 支持chunked传输，优势：\n\t     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n\t     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n\t     */\n\t    define('runtime/html5/transport',[\n\t        'base',\n\t        'runtime/html5/runtime'\n\t    ], function( Base, Html5Runtime ) {\n\t\n\t        var noop = Base.noop,\n\t            $ = Base.$;\n\t\n\t        return Html5Runtime.register( 'Transport', {\n\t            init: function() {\n\t                this._status = 0;\n\t                this._response = null;\n\t            },\n\t\n\t            send: function() {\n\t                var owner = this.owner,\n\t                    opts = this.options,\n\t                    xhr = this._initAjax(),\n\t                    blob = owner._blob,\n\t                    server = opts.server,\n\t                    formData, binary, fr;\n\t\n\t                if ( opts.sendAsBinary ) {\n\t                    server += (/\\?/.test( server ) ? '&' : '?') +\n\t                            $.param( owner._formData );\n\t\n\t                    binary = blob.getSource();\n\t                } else {\n\t                    formData = new FormData();\n\t                    $.each( owner._formData, function( k, v ) {\n\t                        formData.append( k, v );\n\t                    });\n\t\n\t                    formData.append( opts.fileVal, blob.getSource(),\n\t                            opts.filename || owner._formData.name || '' );\n\t                }\n\t\n\t                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n\t                    xhr.open( opts.method, server, true );\n\t                    xhr.withCredentials = true;\n\t                } else {\n\t                    xhr.open( opts.method, server );\n\t                }\n\t\n\t                this._setRequestHeader( xhr, opts.headers );\n\t\n\t                if ( binary ) {\n\t                    // 强制设置成 content-type 为文件流。\n\t                    xhr.overrideMimeType &&\n\t                            xhr.overrideMimeType('application/octet-stream');\n\t\n\t                    // android直接发送blob会导致服务端接收到的是空文件。\n\t                    // bug详情。\n\t                    // https://code.google.com/p/android/issues/detail?id=39882\n\t                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n\t                    if ( Base.os.android ) {\n\t                        fr = new FileReader();\n\t\n\t                        fr.onload = function() {\n\t                            xhr.send( this.result );\n\t                            fr = fr.onload = null;\n\t                        };\n\t\n\t                        fr.readAsArrayBuffer( binary );\n\t                    } else {\n\t                        xhr.send( binary );\n\t                    }\n\t                } else {\n\t                    xhr.send( formData );\n\t                }\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this._response;\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this._parseJson( this._response );\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this._status;\n\t            },\n\t\n\t            abort: function() {\n\t                var xhr = this._xhr;\n\t\n\t                if ( xhr ) {\n\t                    xhr.upload.onprogress = noop;\n\t                    xhr.onreadystatechange = noop;\n\t                    xhr.abort();\n\t\n\t                    this._xhr = xhr = null;\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.abort();\n\t            },\n\t\n\t            _initAjax: function() {\n\t                var me = this,\n\t                    xhr = new XMLHttpRequest(),\n\t                    opts = this.options;\n\t\n\t                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n\t                        typeof XDomainRequest !== 'undefined' ) {\n\t                    xhr = new XDomainRequest();\n\t                }\n\t\n\t                xhr.upload.onprogress = function( e ) {\n\t                    var percentage = 0;\n\t\n\t                    if ( e.lengthComputable ) {\n\t                        percentage = e.loaded / e.total;\n\t                    }\n\t\n\t                    return me.trigger( 'progress', percentage );\n\t                };\n\t\n\t                xhr.onreadystatechange = function() {\n\t\n\t                    if ( xhr.readyState !== 4 ) {\n\t                        return;\n\t                    }\n\t\n\t                    xhr.upload.onprogress = noop;\n\t                    xhr.onreadystatechange = noop;\n\t                    me._xhr = null;\n\t                    me._status = xhr.status;\n\t\n\t                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n\t                        me._response = xhr.responseText;\n\t                        return me.trigger('load');\n\t                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n\t                        me._response = xhr.responseText;\n\t                        return me.trigger( 'error', 'server' );\n\t                    }\n\t\n\t\n\t                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n\t                };\n\t\n\t                me._xhr = xhr;\n\t                return xhr;\n\t            },\n\t\n\t            _setRequestHeader: function( xhr, headers ) {\n\t                $.each( headers, function( key, val ) {\n\t                    xhr.setRequestHeader( key, val );\n\t                });\n\t            },\n\t\n\t            _parseJson: function( str ) {\n\t                var json;\n\t\n\t                try {\n\t                    json = JSON.parse( str );\n\t                } catch ( ex ) {\n\t                    json = {};\n\t                }\n\t\n\t                return json;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Transport flash实现\n\t     */\n\t    define('runtime/html5/md5',[\n\t        'runtime/html5/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        /*\n\t         * Fastest md5 implementation around (JKM md5)\n\t         * Credits: Joseph Myers\n\t         *\n\t         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n\t         * @see http://jsperf.com/md5-shootout/7\n\t         */\n\t\n\t        /* this function is much faster,\n\t          so if possible we use it. Some IEs\n\t          are the only ones I know of that\n\t          need the idiotic second function,\n\t          generated by an if clause.  */\n\t        var add32 = function (a, b) {\n\t            return (a + b) & 0xFFFFFFFF;\n\t        },\n\t\n\t        cmn = function (q, a, b, x, s, t) {\n\t            a = add32(add32(a, q), add32(x, t));\n\t            return add32((a << s) | (a >>> (32 - s)), b);\n\t        },\n\t\n\t        ff = function (a, b, c, d, x, s, t) {\n\t            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n\t        },\n\t\n\t        gg = function (a, b, c, d, x, s, t) {\n\t            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n\t        },\n\t\n\t        hh = function (a, b, c, d, x, s, t) {\n\t            return cmn(b ^ c ^ d, a, b, x, s, t);\n\t        },\n\t\n\t        ii = function (a, b, c, d, x, s, t) {\n\t            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n\t        },\n\t\n\t        md5cycle = function (x, k) {\n\t            var a = x[0],\n\t                b = x[1],\n\t                c = x[2],\n\t                d = x[3];\n\t\n\t            a = ff(a, b, c, d, k[0], 7, -680876936);\n\t            d = ff(d, a, b, c, k[1], 12, -389564586);\n\t            c = ff(c, d, a, b, k[2], 17, 606105819);\n\t            b = ff(b, c, d, a, k[3], 22, -1044525330);\n\t            a = ff(a, b, c, d, k[4], 7, -176418897);\n\t            d = ff(d, a, b, c, k[5], 12, 1200080426);\n\t            c = ff(c, d, a, b, k[6], 17, -1473231341);\n\t            b = ff(b, c, d, a, k[7], 22, -45705983);\n\t            a = ff(a, b, c, d, k[8], 7, 1770035416);\n\t            d = ff(d, a, b, c, k[9], 12, -1958414417);\n\t            c = ff(c, d, a, b, k[10], 17, -42063);\n\t            b = ff(b, c, d, a, k[11], 22, -1990404162);\n\t            a = ff(a, b, c, d, k[12], 7, 1804603682);\n\t            d = ff(d, a, b, c, k[13], 12, -40341101);\n\t            c = ff(c, d, a, b, k[14], 17, -1502002290);\n\t            b = ff(b, c, d, a, k[15], 22, 1236535329);\n\t\n\t            a = gg(a, b, c, d, k[1], 5, -165796510);\n\t            d = gg(d, a, b, c, k[6], 9, -1069501632);\n\t            c = gg(c, d, a, b, k[11], 14, 643717713);\n\t            b = gg(b, c, d, a, k[0], 20, -373897302);\n\t            a = gg(a, b, c, d, k[5], 5, -701558691);\n\t            d = gg(d, a, b, c, k[10], 9, 38016083);\n\t            c = gg(c, d, a, b, k[15], 14, -660478335);\n\t            b = gg(b, c, d, a, k[4], 20, -405537848);\n\t            a = gg(a, b, c, d, k[9], 5, 568446438);\n\t            d = gg(d, a, b, c, k[14], 9, -1019803690);\n\t            c = gg(c, d, a, b, k[3], 14, -187363961);\n\t            b = gg(b, c, d, a, k[8], 20, 1163531501);\n\t            a = gg(a, b, c, d, k[13], 5, -1444681467);\n\t            d = gg(d, a, b, c, k[2], 9, -51403784);\n\t            c = gg(c, d, a, b, k[7], 14, 1735328473);\n\t            b = gg(b, c, d, a, k[12], 20, -1926607734);\n\t\n\t            a = hh(a, b, c, d, k[5], 4, -378558);\n\t            d = hh(d, a, b, c, k[8], 11, -2022574463);\n\t            c = hh(c, d, a, b, k[11], 16, 1839030562);\n\t            b = hh(b, c, d, a, k[14], 23, -35309556);\n\t            a = hh(a, b, c, d, k[1], 4, -1530992060);\n\t            d = hh(d, a, b, c, k[4], 11, 1272893353);\n\t            c = hh(c, d, a, b, k[7], 16, -155497632);\n\t            b = hh(b, c, d, a, k[10], 23, -1094730640);\n\t            a = hh(a, b, c, d, k[13], 4, 681279174);\n\t            d = hh(d, a, b, c, k[0], 11, -358537222);\n\t            c = hh(c, d, a, b, k[3], 16, -722521979);\n\t            b = hh(b, c, d, a, k[6], 23, 76029189);\n\t            a = hh(a, b, c, d, k[9], 4, -640364487);\n\t            d = hh(d, a, b, c, k[12], 11, -421815835);\n\t            c = hh(c, d, a, b, k[15], 16, 530742520);\n\t            b = hh(b, c, d, a, k[2], 23, -995338651);\n\t\n\t            a = ii(a, b, c, d, k[0], 6, -198630844);\n\t            d = ii(d, a, b, c, k[7], 10, 1126891415);\n\t            c = ii(c, d, a, b, k[14], 15, -1416354905);\n\t            b = ii(b, c, d, a, k[5], 21, -57434055);\n\t            a = ii(a, b, c, d, k[12], 6, 1700485571);\n\t            d = ii(d, a, b, c, k[3], 10, -1894986606);\n\t            c = ii(c, d, a, b, k[10], 15, -1051523);\n\t            b = ii(b, c, d, a, k[1], 21, -2054922799);\n\t            a = ii(a, b, c, d, k[8], 6, 1873313359);\n\t            d = ii(d, a, b, c, k[15], 10, -30611744);\n\t            c = ii(c, d, a, b, k[6], 15, -1560198380);\n\t            b = ii(b, c, d, a, k[13], 21, 1309151649);\n\t            a = ii(a, b, c, d, k[4], 6, -145523070);\n\t            d = ii(d, a, b, c, k[11], 10, -1120210379);\n\t            c = ii(c, d, a, b, k[2], 15, 718787259);\n\t            b = ii(b, c, d, a, k[9], 21, -343485551);\n\t\n\t            x[0] = add32(a, x[0]);\n\t            x[1] = add32(b, x[1]);\n\t            x[2] = add32(c, x[2]);\n\t            x[3] = add32(d, x[3]);\n\t        },\n\t\n\t        /* there needs to be support for Unicode here,\n\t           * unless we pretend that we can redefine the MD-5\n\t           * algorithm for multi-byte characters (perhaps\n\t           * by adding every four 16-bit characters and\n\t           * shortening the sum to 32 bits). Otherwise\n\t           * I suggest performing MD-5 as if every character\n\t           * was two bytes--e.g., 0040 0025 = @%--but then\n\t           * how will an ordinary MD-5 sum be matched?\n\t           * There is no way to standardize text to something\n\t           * like UTF-8 before transformation; speed cost is\n\t           * utterly prohibitive. The JavaScript standard\n\t           * itself needs to look at this: it should start\n\t           * providing access to strings as preformed UTF-8\n\t           * 8-bit unsigned value arrays.\n\t           */\n\t        md5blk = function (s) {\n\t            var md5blks = [],\n\t                i; /* Andy King said do it this way. */\n\t\n\t            for (i = 0; i < 64; i += 4) {\n\t                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n\t            }\n\t            return md5blks;\n\t        },\n\t\n\t        md5blk_array = function (a) {\n\t            var md5blks = [],\n\t                i; /* Andy King said do it this way. */\n\t\n\t            for (i = 0; i < 64; i += 4) {\n\t                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n\t            }\n\t            return md5blks;\n\t        },\n\t\n\t        md51 = function (s) {\n\t            var n = s.length,\n\t                state = [1732584193, -271733879, -1732584194, 271733878],\n\t                i,\n\t                length,\n\t                tail,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            for (i = 64; i <= n; i += 64) {\n\t                md5cycle(state, md5blk(s.substring(i - 64, i)));\n\t            }\n\t            s = s.substring(i - 64);\n\t            length = s.length;\n\t            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n\t            }\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Beware that the final length might not fit in 32 bits so we take care of that\n\t            tmp = n * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t\n\t            md5cycle(state, tail);\n\t            return state;\n\t        },\n\t\n\t        md51_array = function (a) {\n\t            var n = a.length,\n\t                state = [1732584193, -271733879, -1732584194, 271733878],\n\t                i,\n\t                length,\n\t                tail,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            for (i = 64; i <= n; i += 64) {\n\t                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n\t            }\n\t\n\t            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n\t            // containing the last element of the parent array if the sub array specified starts\n\t            // beyond the length of the parent array - weird.\n\t            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n\t            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\t\n\t            length = a.length;\n\t            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n\t            }\n\t\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Beware that the final length might not fit in 32 bits so we take care of that\n\t            tmp = n * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t\n\t            md5cycle(state, tail);\n\t\n\t            return state;\n\t        },\n\t\n\t        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n\t\n\t        rhex = function (n) {\n\t            var s = '',\n\t                j;\n\t            for (j = 0; j < 4; j += 1) {\n\t                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n\t            }\n\t            return s;\n\t        },\n\t\n\t        hex = function (x) {\n\t            var i;\n\t            for (i = 0; i < x.length; i += 1) {\n\t                x[i] = rhex(x[i]);\n\t            }\n\t            return x.join('');\n\t        },\n\t\n\t        md5 = function (s) {\n\t            return hex(md51(s));\n\t        },\n\t\n\t\n\t\n\t        ////////////////////////////////////////////////////////////////////////////\n\t\n\t        /**\n\t         * SparkMD5 OOP implementation.\n\t         *\n\t         * Use this class to perform an incremental md5, otherwise use the\n\t         * static methods instead.\n\t         */\n\t        SparkMD5 = function () {\n\t            // call reset to init the instance\n\t            this.reset();\n\t        };\n\t\n\t\n\t        // In some cases the fast add32 function cannot be used..\n\t        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n\t            add32 = function (x, y) {\n\t                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n\t                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n\t                return (msw << 16) | (lsw & 0xFFFF);\n\t            };\n\t        }\n\t\n\t\n\t        /**\n\t         * Appends a string.\n\t         * A conversion will be applied if an utf8 string is detected.\n\t         *\n\t         * @param {String} str The string to be appended\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.append = function (str) {\n\t            // converts the string to utf8 bytes if necessary\n\t            if (/[\\u0080-\\uFFFF]/.test(str)) {\n\t                str = unescape(encodeURIComponent(str));\n\t            }\n\t\n\t            // then append as binary\n\t            this.appendBinary(str);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Appends a binary string.\n\t         *\n\t         * @param {String} contents The binary string to be appended\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.appendBinary = function (contents) {\n\t            this._buff += contents;\n\t            this._length += contents.length;\n\t\n\t            var length = this._buff.length,\n\t                i;\n\t\n\t            for (i = 64; i <= length; i += 64) {\n\t                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n\t            }\n\t\n\t            this._buff = this._buff.substr(i - 64);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Finishes the incremental computation, reseting the internal state and\n\t         * returning the result.\n\t         * Use the raw parameter to obtain the raw result instead of the hex one.\n\t         *\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.prototype.end = function (raw) {\n\t            var buff = this._buff,\n\t                length = buff.length,\n\t                i,\n\t                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t                ret;\n\t\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n\t            }\n\t\n\t            this._finish(tail, length);\n\t            ret = raw ? this._state : hex(this._state);\n\t\n\t            this.reset();\n\t\n\t            return ret;\n\t        };\n\t\n\t        /**\n\t         * Finish the final calculation based on the tail.\n\t         *\n\t         * @param {Array}  tail   The tail (will be modified)\n\t         * @param {Number} length The length of the remaining buffer\n\t         */\n\t        SparkMD5.prototype._finish = function (tail, length) {\n\t            var i = length,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(this._state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Do the final computation based on the tail and length\n\t            // Beware that the final length may not fit in 32 bits so we take care of that\n\t            tmp = this._length * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t            md5cycle(this._state, tail);\n\t        };\n\t\n\t        /**\n\t         * Resets the internal state of the computation.\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.reset = function () {\n\t            this._buff = \"\";\n\t            this._length = 0;\n\t            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Releases memory used by the incremental buffer and other aditional\n\t         * resources. If you plan to use the instance again, use reset instead.\n\t         */\n\t        SparkMD5.prototype.destroy = function () {\n\t            delete this._state;\n\t            delete this._buff;\n\t            delete this._length;\n\t        };\n\t\n\t\n\t        /**\n\t         * Performs the md5 hash on a string.\n\t         * A conversion will be applied if utf8 string is detected.\n\t         *\n\t         * @param {String}  str The string\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.hash = function (str, raw) {\n\t            // converts the string to utf8 bytes if necessary\n\t            if (/[\\u0080-\\uFFFF]/.test(str)) {\n\t                str = unescape(encodeURIComponent(str));\n\t            }\n\t\n\t            var hash = md51(str);\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        /**\n\t         * Performs the md5 hash on a binary string.\n\t         *\n\t         * @param {String}  content The binary string\n\t         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.hashBinary = function (content, raw) {\n\t            var hash = md51(content);\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        /**\n\t         * SparkMD5 OOP implementation for array buffers.\n\t         *\n\t         * Use this class to perform an incremental md5 ONLY for array buffers.\n\t         */\n\t        SparkMD5.ArrayBuffer = function () {\n\t            // call reset to init the instance\n\t            this.reset();\n\t        };\n\t\n\t        ////////////////////////////////////////////////////////////////////////////\n\t\n\t        /**\n\t         * Appends an array buffer.\n\t         *\n\t         * @param {ArrayBuffer} arr The array to be appended\n\t         *\n\t         * @return {SparkMD5.ArrayBuffer} The instance itself\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n\t            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n\t            //       if you find yourself needing extra performance, please make a PR.\n\t            var buff = this._concatArrayBuffer(this._buff, arr),\n\t                length = buff.length,\n\t                i;\n\t\n\t            this._length += arr.byteLength;\n\t\n\t            for (i = 64; i <= length; i += 64) {\n\t                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n\t            }\n\t\n\t            // Avoids IE10 weirdness (documented above)\n\t            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Finishes the incremental computation, reseting the internal state and\n\t         * returning the result.\n\t         * Use the raw parameter to obtain the raw result instead of the hex one.\n\t         *\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n\t            var buff = this._buff,\n\t                length = buff.length,\n\t                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t                i,\n\t                ret;\n\t\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n\t            }\n\t\n\t            this._finish(tail, length);\n\t            ret = raw ? this._state : hex(this._state);\n\t\n\t            this.reset();\n\t\n\t            return ret;\n\t        };\n\t\n\t        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\t\n\t        /**\n\t         * Resets the internal state of the computation.\n\t         *\n\t         * @return {SparkMD5.ArrayBuffer} The instance itself\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.reset = function () {\n\t            this._buff = new Uint8Array(0);\n\t            this._length = 0;\n\t            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Releases memory used by the incremental buffer and other aditional\n\t         * resources. If you plan to use the instance again, use reset instead.\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\t\n\t        /**\n\t         * Concats two array buffers, returning a new one.\n\t         *\n\t         * @param  {ArrayBuffer} first  The first array buffer\n\t         * @param  {ArrayBuffer} second The second array buffer\n\t         *\n\t         * @return {ArrayBuffer} The new array buffer\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n\t            var firstLength = first.length,\n\t                result = new Uint8Array(firstLength + second.byteLength);\n\t\n\t            result.set(first);\n\t            result.set(new Uint8Array(second), firstLength);\n\t\n\t            return result;\n\t        };\n\t\n\t        /**\n\t         * Performs the md5 hash on an array buffer.\n\t         *\n\t         * @param {ArrayBuffer} arr The array buffer\n\t         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n\t            var hash = md51_array(new Uint8Array(arr));\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        return FlashRuntime.register( 'Md5', {\n\t            init: function() {\n\t                // do nothing.\n\t            },\n\t\n\t            loadFromBlob: function( file ) {\n\t                var blob = file.getSource(),\n\t                    chunkSize = 2 * 1024 * 1024,\n\t                    chunks = Math.ceil( blob.size / chunkSize ),\n\t                    chunk = 0,\n\t                    owner = this.owner,\n\t                    spark = new SparkMD5.ArrayBuffer(),\n\t                    me = this,\n\t                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n\t                    loadNext, fr;\n\t\n\t                fr = new FileReader();\n\t\n\t                loadNext = function() {\n\t                    var start, end;\n\t\n\t                    start = chunk * chunkSize;\n\t                    end = Math.min( start + chunkSize, blob.size );\n\t\n\t                    fr.onload = function( e ) {\n\t                        spark.append( e.target.result );\n\t                        owner.trigger( 'progress', {\n\t                            total: file.size,\n\t                            loaded: end\n\t                        });\n\t                    };\n\t\n\t                    fr.onloadend = function() {\n\t                        fr.onloadend = fr.onload = null;\n\t\n\t                        if ( ++chunk < chunks ) {\n\t                            setTimeout( loadNext, 1 );\n\t                        } else {\n\t                            setTimeout(function(){\n\t                                owner.trigger('load');\n\t                                me.result = spark.end();\n\t                                loadNext = file = blob = spark = null;\n\t                                owner.trigger('complete');\n\t                            }, 50 );\n\t                        }\n\t                    };\n\t\n\t                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n\t                };\n\t\n\t                loadNext();\n\t            },\n\t\n\t            getResult: function() {\n\t                return this.result;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview FlashRuntime\n\t     */\n\t    define('runtime/flash/runtime',[\n\t        'base',\n\t        'runtime/runtime',\n\t        'runtime/compbase'\n\t    ], function( Base, Runtime, CompBase ) {\n\t\n\t        var $ = Base.$,\n\t            type = 'flash',\n\t            components = {};\n\t\n\t\n\t        function getFlashVersion() {\n\t            var version;\n\t\n\t            try {\n\t                version = navigator.plugins[ 'Shockwave Flash' ];\n\t                version = version.description;\n\t            } catch ( ex ) {\n\t                try {\n\t                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n\t                            .GetVariable('$version');\n\t                } catch ( ex2 ) {\n\t                    version = '0.0';\n\t                }\n\t            }\n\t            version = version.match( /\\d+/g );\n\t            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n\t        }\n\t\n\t        function FlashRuntime() {\n\t            var pool = {},\n\t                clients = {},\n\t                destroy = this.destroy,\n\t                me = this,\n\t                jsreciver = Base.guid('webuploader_');\n\t\n\t            Runtime.apply( me, arguments );\n\t            me.type = type;\n\t\n\t\n\t            // 这个方法的调用者，实际上是RuntimeClient\n\t            me.exec = function( comp, fn/*, args...*/ ) {\n\t                var client = this,\n\t                    uid = client.uid,\n\t                    args = Base.slice( arguments, 2 ),\n\t                    instance;\n\t\n\t                clients[ uid ] = client;\n\t\n\t                if ( components[ comp ] ) {\n\t                    if ( !pool[ uid ] ) {\n\t                        pool[ uid ] = new components[ comp ]( client, me );\n\t                    }\n\t\n\t                    instance = pool[ uid ];\n\t\n\t                    if ( instance[ fn ] ) {\n\t                        return instance[ fn ].apply( instance, args );\n\t                    }\n\t                }\n\t\n\t                return me.flashExec.apply( client, arguments );\n\t            };\n\t\n\t            function handler( evt, obj ) {\n\t                var type = evt.type || evt,\n\t                    parts, uid;\n\t\n\t                parts = type.split('::');\n\t                uid = parts[ 0 ];\n\t                type = parts[ 1 ];\n\t\n\t                // console.log.apply( console, arguments );\n\t\n\t                if ( type === 'Ready' && uid === me.uid ) {\n\t                    me.trigger('ready');\n\t                } else if ( clients[ uid ] ) {\n\t                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n\t                }\n\t\n\t                // Base.log( evt, obj );\n\t            }\n\t\n\t            // flash的接受器。\n\t            window[ jsreciver ] = function() {\n\t                var args = arguments;\n\t\n\t                // 为了能捕获得到。\n\t                setTimeout(function() {\n\t                    handler.apply( null, args );\n\t                }, 1 );\n\t            };\n\t\n\t            this.jsreciver = jsreciver;\n\t\n\t            this.destroy = function() {\n\t                // @todo 删除池子中的所有实例\n\t                return destroy && destroy.apply( this, arguments );\n\t            };\n\t\n\t            this.flashExec = function( comp, fn ) {\n\t                var flash = me.getFlash(),\n\t                    args = Base.slice( arguments, 2 );\n\t\n\t                return flash.exec( this.uid, comp, fn, args );\n\t            };\n\t\n\t            // @todo\n\t        }\n\t\n\t        Base.inherits( Runtime, {\n\t            constructor: FlashRuntime,\n\t\n\t            init: function() {\n\t                var container = this.getContainer(),\n\t                    opts = this.options,\n\t                    html;\n\t\n\t                // if not the minimal height, shims are not initialized\n\t                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n\t                container.css({\n\t                    position: 'absolute',\n\t                    top: '-8px',\n\t                    left: '-8px',\n\t                    width: '9px',\n\t                    height: '9px',\n\t                    overflow: 'hidden'\n\t                });\n\t\n\t                // insert flash object\n\t                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n\t                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n\t\n\t                if ( Base.browser.ie ) {\n\t                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n\t                }\n\t\n\t                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n\t                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n\t                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n\t                    '&jsreciver=' + this.jsreciver + '\" />' +\n\t                    '<param name=\"wmode\" value=\"transparent\" />' +\n\t                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n\t                '</object>';\n\t\n\t                container.html( html );\n\t            },\n\t\n\t            getFlash: function() {\n\t                if ( this._flash ) {\n\t                    return this._flash;\n\t                }\n\t\n\t                this._flash = $( '#' + this.uid ).get( 0 );\n\t                return this._flash;\n\t            }\n\t\n\t        });\n\t\n\t        FlashRuntime.register = function( name, component ) {\n\t            component = components[ name ] = Base.inherits( CompBase, $.extend({\n\t\n\t                // @todo fix this later\n\t                flashExec: function() {\n\t                    var owner = this.owner,\n\t                        runtime = this.getRuntime();\n\t\n\t                    return runtime.flashExec.apply( owner, arguments );\n\t                }\n\t            }, component ) );\n\t\n\t            return component;\n\t        };\n\t\n\t        if ( getFlashVersion() >= 11.4 ) {\n\t            Runtime.addRuntime( type, FlashRuntime );\n\t        }\n\t\n\t        return FlashRuntime;\n\t    });\n\t    /**\n\t     * @fileOverview FilePicker\n\t     */\n\t    define('runtime/flash/filepicker',[\n\t        'base',\n\t        'runtime/flash/runtime'\n\t    ], function( Base, FlashRuntime ) {\n\t        var $ = Base.$;\n\t\n\t        return FlashRuntime.register( 'FilePicker', {\n\t            init: function( opts ) {\n\t                var copy = $.extend({}, opts ),\n\t                    len, i;\n\t\n\t                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n\t                len = copy.accept && copy.accept.length;\n\t                for (  i = 0; i < len; i++ ) {\n\t                    if ( !copy.accept[ i ].title ) {\n\t                        copy.accept[ i ].title = 'Files';\n\t                    }\n\t                }\n\t\n\t                delete copy.button;\n\t                delete copy.id;\n\t                delete copy.container;\n\t\n\t                this.flashExec( 'FilePicker', 'init', copy );\n\t            },\n\t\n\t            destroy: function() {\n\t                this.flashExec( 'FilePicker', 'destroy' );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 图片压缩\n\t     */\n\t    define('runtime/flash/image',[\n\t        'runtime/flash/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        return FlashRuntime.register( 'Image', {\n\t            // init: function( options ) {\n\t            //     var owner = this.owner;\n\t\n\t            //     this.flashExec( 'Image', 'init', options );\n\t            //     owner.on( 'load', function() {\n\t            //         debugger;\n\t            //     });\n\t            // },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var owner = this.owner;\n\t\n\t                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n\t                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n\t\n\t                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Transport flash实现\n\t     */\n\t    define('runtime/flash/transport',[\n\t        'base',\n\t        'runtime/flash/runtime',\n\t        'runtime/client'\n\t    ], function( Base, FlashRuntime, RuntimeClient ) {\n\t        var $ = Base.$;\n\t\n\t        return FlashRuntime.register( 'Transport', {\n\t            init: function() {\n\t                this._status = 0;\n\t                this._response = null;\n\t                this._responseJson = null;\n\t            },\n\t\n\t            send: function() {\n\t                var owner = this.owner,\n\t                    opts = this.options,\n\t                    xhr = this._initAjax(),\n\t                    blob = owner._blob,\n\t                    server = opts.server,\n\t                    binary;\n\t\n\t                xhr.connectRuntime( blob.ruid );\n\t\n\t                if ( opts.sendAsBinary ) {\n\t                    server += (/\\?/.test( server ) ? '&' : '?') +\n\t                            $.param( owner._formData );\n\t\n\t                    binary = blob.uid;\n\t                } else {\n\t                    $.each( owner._formData, function( k, v ) {\n\t                        xhr.exec( 'append', k, v );\n\t                    });\n\t\n\t                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n\t                            opts.filename || owner._formData.name || '' );\n\t                }\n\t\n\t                this._setRequestHeader( xhr, opts.headers );\n\t                xhr.exec( 'send', {\n\t                    method: opts.method,\n\t                    url: server,\n\t                    forceURLStream: opts.forceURLStream,\n\t                    mimeType: 'application/octet-stream',\n\t                }, binary );\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this._status;\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this._response || '';\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this._responseJson;\n\t            },\n\t\n\t            abort: function() {\n\t                var xhr = this._xhr;\n\t\n\t                if ( xhr ) {\n\t                    xhr.exec('abort');\n\t                    xhr.destroy();\n\t                    this._xhr = xhr = null;\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.abort();\n\t            },\n\t\n\t            _initAjax: function() {\n\t                var me = this,\n\t                    xhr = new RuntimeClient('XMLHttpRequest');\n\t\n\t                xhr.on( 'uploadprogress progress', function( e ) {\n\t                    var percent = e.loaded / e.total;\n\t                    percent = Math.min( 1, Math.max( 0, percent ) );\n\t                    return me.trigger( 'progress', percent );\n\t                });\n\t\n\t                xhr.on( 'load', function() {\n\t                    var status = xhr.exec('getStatus'),\n\t                        readBody = false,\n\t                        err = '',\n\t                        p;\n\t\n\t                    xhr.off();\n\t                    me._xhr = null;\n\t\n\t                    if ( status >= 200 && status < 300 ) {\n\t                        readBody = true;\n\t                    } else if ( status >= 500 && status < 600 ) {\n\t                        readBody = true;\n\t                        err = 'server';\n\t                    } else {\n\t                        err = 'http';\n\t                    }\n\t\n\t                    if ( readBody ) {\n\t                        me._response = xhr.exec('getResponse');\n\t                        me._response = decodeURIComponent( me._response );\n\t\n\t                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n\t                        // try {\n\t                        //     me._responseJson = xhr.exec('getResponseAsJson');\n\t                        // } catch ( error ) {\n\t\n\t                        p = window.JSON && window.JSON.parse || function( s ) {\n\t                            try {\n\t                                return new Function('return ' + s).call();\n\t                            } catch ( err ) {\n\t                                return {};\n\t                            }\n\t                        };\n\t                        me._responseJson  = me._response ? p(me._response) : {};\n\t\n\t                        // }\n\t                    }\n\t\n\t                    xhr.destroy();\n\t                    xhr = null;\n\t\n\t                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n\t                });\n\t\n\t                xhr.on( 'error', function() {\n\t                    xhr.off();\n\t                    me._xhr = null;\n\t                    me.trigger( 'error', 'http' );\n\t                });\n\t\n\t                me._xhr = xhr;\n\t                return xhr;\n\t            },\n\t\n\t            _setRequestHeader: function( xhr, headers ) {\n\t                $.each( headers, function( key, val ) {\n\t                    xhr.exec( 'setRequestHeader', key, val );\n\t                });\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Blob Html实现\n\t     */\n\t    define('runtime/flash/blob',[\n\t        'runtime/flash/runtime',\n\t        'lib/blob'\n\t    ], function( FlashRuntime, Blob ) {\n\t\n\t        return FlashRuntime.register( 'Blob', {\n\t            slice: function( start, end ) {\n\t                var blob = this.flashExec( 'Blob', 'slice', start, end );\n\t\n\t                return new Blob( blob.uid, blob );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Md5 flash实现\n\t     */\n\t    define('runtime/flash/md5',[\n\t        'runtime/flash/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        return FlashRuntime.register( 'Md5', {\n\t            init: function() {\n\t                // do nothing.\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 完全版本。\n\t     */\n\t    define('preset/all',[\n\t        'base',\n\t\n\t        // widgets\n\t        'widgets/filednd',\n\t        'widgets/filepaste',\n\t        'widgets/filepicker',\n\t        'widgets/image',\n\t        'widgets/queue',\n\t        'widgets/runtime',\n\t        'widgets/upload',\n\t        'widgets/validator',\n\t        'widgets/md5',\n\t\n\t        // runtimes\n\t        // html5\n\t        'runtime/html5/blob',\n\t        'runtime/html5/dnd',\n\t        'runtime/html5/filepaste',\n\t        'runtime/html5/filepicker',\n\t        'runtime/html5/imagemeta/exif',\n\t        'runtime/html5/androidpatch',\n\t        'runtime/html5/image',\n\t        'runtime/html5/transport',\n\t        'runtime/html5/md5',\n\t\n\t        // flash\n\t        'runtime/flash/filepicker',\n\t        'runtime/flash/image',\n\t        'runtime/flash/transport',\n\t        'runtime/flash/blob',\n\t        'runtime/flash/md5'\n\t    ], function( Base ) {\n\t        return Base;\n\t    });\n\t    /**\n\t     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n\t     *\n\t     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n\t     *\n\t     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n\t     *\n\t     * 如：\n\t     * WebUploader.create({\n\t     *     ...\n\t     *\n\t     *     disableWidgets: 'log',\n\t     *\n\t     *     ...\n\t     * })\n\t     */\n\t    define('widgets/log',[\n\t        'base',\n\t        'uploader',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader ) {\n\t        var $ = Base.$,\n\t            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n\t            product = (location.hostname || location.host || 'protected').toLowerCase(),\n\t\n\t            // 只针对 baidu 内部产品用户做统计功能。\n\t            enable = product && /baidu/i.exec(product),\n\t            base;\n\t\n\t        if (!enable) {\n\t            return;\n\t        }\n\t\n\t        base = {\n\t            dv: 3,\n\t            master: 'webuploader',\n\t            online: /test/.exec(product) ? 0 : 1,\n\t            module: '',\n\t            product: product,\n\t            type: 0\n\t        };\n\t\n\t        function send(data) {\n\t            var obj = $.extend({}, base, data),\n\t                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n\t                image = new Image();\n\t\n\t            image.src = url;\n\t        }\n\t\n\t        return Uploader.register({\n\t            name: 'log',\n\t\n\t            init: function() {\n\t                var owner = this.owner,\n\t                    count = 0,\n\t                    size = 0;\n\t\n\t                owner\n\t                    .on('error', function(code) {\n\t                        send({\n\t                            type: 2,\n\t                            c_error_code: code\n\t                        });\n\t                    })\n\t                    .on('uploadError', function(file, reason) {\n\t                        send({\n\t                            type: 2,\n\t                            c_error_code: 'UPLOAD_ERROR',\n\t                            c_reason: '' + reason\n\t                        });\n\t                    })\n\t                    .on('uploadComplete', function(file) {\n\t                        count++;\n\t                        size += file.size;\n\t                    }).\n\t                    on('uploadFinished', function() {\n\t                        send({\n\t                            c_count: count,\n\t                            c_size: size\n\t                        });\n\t                        count = size = 0;\n\t                    });\n\t\n\t                send({\n\t                    c_usage: 1\n\t                });\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Uploader上传类\n\t     */\n\t    define('webuploader',[\n\t        'preset/all',\n\t        'widgets/log'\n\t    ], function( preset ) {\n\t        return preset;\n\t    });\n\t    return require('webuploader');\n\t});\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n\n/***/ 87:\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;\"use strict\";\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t/*!\r\n\t * Cropper v0.9.2\r\n\t * https://github.com/fengyuanchen/cropper\r\n\t *\r\n\t * Copyright (c) 2014-2015 Fengyuan Chen and contributors\r\n\t * Released under the MIT license\r\n\t *\r\n\t * Date: 2015-04-18T04:35:01.500Z\r\n\t */\n\t!function (a) {\n\t   true ? !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(2)], __WEBPACK_AMD_DEFINE_FACTORY__ = (a), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : a(\"object\" == (typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) ? require(\"jquery\") : jQuery);\n\t}(function (a) {\n\t  \"use strict\";\n\t  function b(a) {\n\t    return \"number\" == typeof a;\n\t  }function c(a) {\n\t    return \"undefined\" == typeof a;\n\t  }function d(a, c) {\n\t    var d = [];return b(c) && d.push(c), d.slice.apply(a, d);\n\t  }function e(a, b) {\n\t    var c = d(arguments, 2);return function () {\n\t      return a.apply(b, c.concat(d(arguments)));\n\t    };\n\t  }function f(a) {\n\t    var b = a.match(/^(https?:)\\/\\/([^\\:\\/\\?#]+):?(\\d*)/i);return b && (b[1] !== o.protocol || b[2] !== o.hostname || b[3] !== o.port);\n\t  }function g(a) {\n\t    var b = \"timestamp=\" + new Date().getTime();return a + (-1 === a.indexOf(\"?\") ? \"?\" : \"&\") + b;\n\t  }function h(a, b) {\n\t    return b.left < 0 && a.width < b.left + b.width && b.top < 0 && a.height < b.top + b.height;\n\t  }function i(a) {\n\t    return a ? \"rotate(\" + a + \"deg)\" : \"none\";\n\t  }function j(a, b) {\n\t    var c,\n\t        d,\n\t        e = R(a.degree) % 180,\n\t        f = (e > 90 ? 180 - e : e) * Math.PI / 180,\n\t        g = S(f),\n\t        h = T(f),\n\t        i = a.width,\n\t        j = a.height,\n\t        k = a.aspectRatio;return b ? (c = i / (h + g / k), d = c / k) : (c = i * h + j * g, d = i * g + j * h), { width: c, height: d };\n\t  }function k(b, c) {\n\t    var d = a(\"<canvas>\")[0],\n\t        e = d.getContext(\"2d\"),\n\t        f = c.naturalWidth,\n\t        g = c.naturalHeight,\n\t        h = c.rotate,\n\t        i = j({ width: f, height: g, degree: h });return h ? (d.width = i.width, d.height = i.height, e.save(), e.translate(i.width / 2, i.height / 2), e.rotate(h * Math.PI / 180), e.drawImage(b, -f / 2, -g / 2, f, g), e.restore()) : (d.width = f, d.height = g, e.drawImage(b, 0, 0, f, g)), d;\n\t  }function l(b, c) {\n\t    this.$element = a(b), this.options = a.extend({}, l.DEFAULTS, a.isPlainObject(c) && c), this.ready = !1, this.built = !1, this.rotated = !1, this.cropped = !1, this.disabled = !1, this.canvas = null, this.cropBox = null, this.load();\n\t  }var m = a(window),\n\t      n = a(document),\n\t      o = window.location,\n\t      p = \".cropper\",\n\t      q = \"preview\" + p,\n\t      r = /^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,\n\t      s = \"cropper-modal\",\n\t      t = \"cropper-hide\",\n\t      u = \"cropper-hidden\",\n\t      v = \"cropper-invisible\",\n\t      w = \"cropper-move\",\n\t      x = \"cropper-crop\",\n\t      y = \"cropper-disabled\",\n\t      z = \"cropper-bg\",\n\t      A = \"mousedown touchstart\",\n\t      B = \"mousemove touchmove\",\n\t      C = \"mouseup mouseleave touchend touchleave touchcancel\",\n\t      D = \"wheel mousewheel DOMMouseScroll\",\n\t      E = \"dblclick\",\n\t      F = \"resize\" + p,\n\t      G = \"build\" + p,\n\t      H = \"built\" + p,\n\t      I = \"dragstart\" + p,\n\t      J = \"dragmove\" + p,\n\t      K = \"dragend\" + p,\n\t      L = \"zoomin\" + p,\n\t      M = \"zoomout\" + p,\n\t      N = a.isFunction(a(\"<canvas>\")[0].getContext),\n\t      O = Math.sqrt,\n\t      P = Math.min,\n\t      Q = Math.max,\n\t      R = Math.abs,\n\t      S = Math.sin,\n\t      T = Math.cos,\n\t      U = parseFloat,\n\t      V = {};V.load = function (b) {\n\t    var c,\n\t        d,\n\t        e,\n\t        h,\n\t        i = this.options,\n\t        j = this.$element;if (!b) if (j.is(\"img\")) {\n\t      if (!j.attr(\"src\")) return;b = j.prop(\"src\");\n\t    } else j.is(\"canvas\") && N && (b = j[0].toDataURL());b && (e = a.Event(G), j.one(G, i.build).trigger(e), e.isDefaultPrevented() || (i.checkImageOrigin && f(b) && (c = \"anonymous\", j.prop(\"crossOrigin\") || (d = g(b))), this.$clone = h = a(\"<img>\"), h.one(\"load\", a.proxy(function () {\n\t      var a = h.prop(\"naturalWidth\") || h.width(),\n\t          c = h.prop(\"naturalHeight\") || h.height();this.image = { naturalWidth: a, naturalHeight: c, aspectRatio: a / c, rotate: 0 }, this.url = b, this.ready = !0, this.build();\n\t    }, this)).one(\"error\", function () {\n\t      h.remove();\n\t    }).attr({ src: d || b, crossOrigin: c }), h.addClass(t).insertAfter(j)));\n\t  }, V.build = function () {\n\t    var b,\n\t        c,\n\t        d = this.$element,\n\t        e = this.$clone,\n\t        f = this.options;this.ready && (this.built && this.unbuild(), this.$cropper = b = a(l.TEMPLATE), d.addClass(u), e.removeClass(t), this.$container = d.parent().append(b), this.$canvas = b.find(\".cropper-canvas\").append(e), this.$dragBox = b.find(\".cropper-drag-box\"), this.$cropBox = c = b.find(\".cropper-crop-box\"), this.$viewBox = b.find(\".cropper-view-box\"), this.addListeners(), this.initPreview(), f.aspectRatio = U(f.aspectRatio) || 0 / 0, f.autoCrop ? (this.cropped = !0, f.modal && this.$dragBox.addClass(s)) : c.addClass(u), f.background && b.addClass(z), f.highlight || c.find(\".cropper-face\").addClass(v), f.guides || c.find(\".cropper-dashed\").addClass(u), f.movable || c.find(\".cropper-face\").data(\"drag\", \"move\"), f.resizable || c.find(\".cropper-line, .cropper-point\").addClass(u), this.setDragMode(f.dragCrop ? \"crop\" : \"move\"), this.built = !0, this.render(), d.one(H, f.built).trigger(H));\n\t  }, V.unbuild = function () {\n\t    this.built && (this.built = !1, this.container = null, this.canvas = null, this.cropBox = null, this.removeListeners(), this.resetPreview(), this.$preview = null, this.$viewBox = null, this.$cropBox = null, this.$dragBox = null, this.$canvas = null, this.$container = null, this.$cropper.remove(), this.$cropper = null);\n\t  }, a.extend(V, { render: function render() {\n\t      this.initContainer(), this.initCanvas(), this.initCropBox(), this.renderCanvas(), this.cropped && this.renderCropBox();\n\t    }, initContainer: function initContainer() {\n\t      var a = this.$element,\n\t          b = this.$container,\n\t          c = this.$cropper,\n\t          d = this.options;c.addClass(u), a.removeClass(u), c.css(this.container = { width: Q(b.width(), U(d.minContainerWidth) || 200), height: Q(b.height(), U(d.minContainerHeight) || 100) }), a.addClass(u), c.removeClass(u);\n\t    }, initCanvas: function initCanvas() {\n\t      var b = this.container,\n\t          c = b.width,\n\t          d = b.height,\n\t          e = this.image,\n\t          f = e.aspectRatio,\n\t          g = { aspectRatio: f, width: c, height: d };d * f > c ? g.height = c / f : g.width = d * f, g.oldLeft = g.left = (c - g.width) / 2, g.oldTop = g.top = (d - g.height) / 2, this.canvas = g, this.limitCanvas(!0, !0), this.initialImage = a.extend({}, e), this.initialCanvas = a.extend({}, g);\n\t    }, limitCanvas: function limitCanvas(b, c) {\n\t      var d,\n\t          e,\n\t          f = this.options,\n\t          g = f.strict,\n\t          h = this.container,\n\t          i = h.width,\n\t          j = h.height,\n\t          k = this.canvas,\n\t          l = k.aspectRatio,\n\t          m = this.cropBox,\n\t          n = this.cropped && m;b && (d = U(f.minCanvasWidth) || 0, e = U(f.minCanvasHeight) || 0, d ? (g && (d = Q(n ? m.width : i, d)), e = d / l) : e ? (g && (e = Q(n ? m.height : j, e)), d = e * l) : g && (n ? (d = m.width, e = m.height, e * l > d ? d = e * l : e = d / l) : (d = i, e = j, e * l > d ? e = d / l : d = e * l)), a.extend(k, { minWidth: d, minHeight: e, maxWidth: 1 / 0, maxHeight: 1 / 0 })), c && (g ? n ? (k.minLeft = P(m.left, m.left + m.width - k.width), k.minTop = P(m.top, m.top + m.height - k.height), k.maxLeft = m.left, k.maxTop = m.top) : (k.minLeft = P(0, i - k.width), k.minTop = P(0, j - k.height), k.maxLeft = Q(0, i - k.width), k.maxTop = Q(0, j - k.height)) : (k.minLeft = -k.width, k.minTop = -k.height, k.maxLeft = i, k.maxTop = j));\n\t    }, renderCanvas: function renderCanvas(a) {\n\t      var b,\n\t          c,\n\t          d = this.options,\n\t          e = this.canvas,\n\t          f = this.image;this.rotated && (this.rotated = !1, c = j({ width: f.width, height: f.height, degree: f.rotate }), b = c.width / c.height, b !== e.aspectRatio && (e.left -= (c.width - e.width) / 2, e.top -= (c.height - e.height) / 2, e.width = c.width, e.height = c.height, e.aspectRatio = b, this.limitCanvas(!0, !1))), (e.width > e.maxWidth || e.width < e.minWidth) && (e.left = e.oldLeft), (e.height > e.maxHeight || e.height < e.minHeight) && (e.top = e.oldTop), e.width = P(Q(e.width, e.minWidth), e.maxWidth), e.height = P(Q(e.height, e.minHeight), e.maxHeight), this.limitCanvas(!1, !0), e.oldLeft = e.left = P(Q(e.left, e.minLeft), e.maxLeft), e.oldTop = e.top = P(Q(e.top, e.minTop), e.maxTop), this.$canvas.css({ width: e.width, height: e.height, left: e.left, top: e.top }), this.renderImage(), this.cropped && d.strict && !h(this.container, e) && this.limitCropBox(!0, !0), a && this.output();\n\t    }, renderImage: function renderImage() {\n\t      var b,\n\t          c = this.canvas,\n\t          d = this.image;d.rotate && (b = j({ width: c.width, height: c.height, degree: d.rotate, aspectRatio: d.aspectRatio }, !0)), a.extend(d, b ? { width: b.width, height: b.height, left: (c.width - b.width) / 2, top: (c.height - b.height) / 2 } : { width: c.width, height: c.height, left: 0, top: 0 }), this.$clone.css({ width: d.width, height: d.height, marginLeft: d.left, marginTop: d.top, transform: i(d.rotate) });\n\t    }, initCropBox: function initCropBox() {\n\t      var b = this.options,\n\t          c = this.canvas,\n\t          d = b.aspectRatio,\n\t          e = U(b.autoCropArea) || .8,\n\t          f = { width: c.width, height: c.height };d && (c.height * d > c.width ? f.height = f.width / d : f.width = f.height * d), this.cropBox = f, this.limitCropBox(!0, !0), f.width = P(Q(f.width, f.minWidth), f.maxWidth), f.height = P(Q(f.height, f.minHeight), f.maxHeight), f.width = Q(f.minWidth, f.width * e), f.height = Q(f.minHeight, f.height * e), f.oldLeft = f.left = c.left + (c.width - f.width) / 2, f.oldTop = f.top = c.top + (c.height - f.height) / 2, this.initialCropBox = a.extend({}, f);\n\t    }, limitCropBox: function limitCropBox(a, b) {\n\t      var c,\n\t          d,\n\t          e = this.options,\n\t          f = e.strict,\n\t          g = this.container,\n\t          h = g.width,\n\t          i = g.height,\n\t          j = this.canvas,\n\t          k = this.cropBox,\n\t          l = e.aspectRatio;a && (c = U(e.minCropBoxWidth) || 0, d = U(e.minCropBoxHeight) || 0, k.minWidth = P(h, c), k.minHeight = P(i, d), k.maxWidth = P(h, f ? j.width : h), k.maxHeight = P(i, f ? j.height : i), l && (k.maxHeight * l > k.maxWidth ? (k.minHeight = k.minWidth / l, k.maxHeight = k.maxWidth / l) : (k.minWidth = k.minHeight * l, k.maxWidth = k.maxHeight * l)), k.minWidth = P(k.maxWidth, k.minWidth), k.minHeight = P(k.maxHeight, k.minHeight)), b && (f ? (k.minLeft = Q(0, j.left), k.minTop = Q(0, j.top), k.maxLeft = P(h, j.left + j.width) - k.width, k.maxTop = P(i, j.top + j.height) - k.height) : (k.minLeft = 0, k.minTop = 0, k.maxLeft = h - k.width, k.maxTop = i - k.height));\n\t    }, renderCropBox: function renderCropBox() {\n\t      var a = this.options,\n\t          b = this.container,\n\t          c = b.width,\n\t          d = b.height,\n\t          e = this.$cropBox,\n\t          f = this.cropBox;(f.width > f.maxWidth || f.width < f.minWidth) && (f.left = f.oldLeft), (f.height > f.maxHeight || f.height < f.minHeight) && (f.top = f.oldTop), f.width = P(Q(f.width, f.minWidth), f.maxWidth), f.height = P(Q(f.height, f.minHeight), f.maxHeight), this.limitCropBox(!1, !0), f.oldLeft = f.left = P(Q(f.left, f.minLeft), f.maxLeft), f.oldTop = f.top = P(Q(f.top, f.minTop), f.maxTop), a.movable && e.find(\".cropper-face\").data(\"drag\", f.width === c && f.height === d ? \"move\" : \"all\"), e.css({ width: f.width, height: f.height, left: f.left, top: f.top }), this.cropped && a.strict && !h(b, this.canvas) && this.limitCanvas(!0, !0), this.disabled || this.output();\n\t    }, output: function output() {\n\t      var a = this.options;this.preview(), a.crop && a.crop.call(this.$element, this.getData());\n\t    } }), V.initPreview = function () {\n\t    var b = this.url;this.$preview = a(this.options.preview), this.$viewBox.html('<img src=\"' + b + '\">'), this.$preview.each(function () {\n\t      var c = a(this);c.data(q, { width: c.width(), height: c.height(), original: c.html() }).html('<img src=\"' + b + '\" style=\"display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important\">');\n\t    });\n\t  }, V.resetPreview = function () {\n\t    this.$preview.each(function () {\n\t      var b = a(this);b.html(b.data(q).original).removeData(q);\n\t    });\n\t  }, V.preview = function () {\n\t    var b = this.image,\n\t        c = this.canvas,\n\t        d = this.cropBox,\n\t        e = b.width,\n\t        f = b.height,\n\t        g = d.left - c.left - b.left,\n\t        h = d.top - c.top - b.top,\n\t        j = b.rotate;this.cropped && !this.disabled && (this.$viewBox.find(\"img\").css({ width: e, height: f, marginLeft: -g, marginTop: -h, transform: i(j) }), this.$preview.each(function () {\n\t      var b = a(this),\n\t          c = b.data(q),\n\t          k = c.width / d.width,\n\t          l = c.width,\n\t          m = d.height * k;m > c.height && (k = c.height / d.height, l = d.width * k, m = c.height), b.width(l).height(m).find(\"img\").css({ width: e * k, height: f * k, marginLeft: -g * k, marginTop: -h * k, transform: i(j) });\n\t    }));\n\t  }, V.addListeners = function () {\n\t    var b = this.options;this.$element.on(I, b.dragstart).on(J, b.dragmove).on(K, b.dragend).on(L, b.zoomin).on(M, b.zoomout), this.$cropper.on(A, a.proxy(this.dragstart, this)).on(E, a.proxy(this.dblclick, this)), b.zoomable && b.mouseWheelZoom && this.$cropper.on(D, a.proxy(this.wheel, this)), n.on(B, this._dragmove = e(this.dragmove, this)).on(C, this._dragend = e(this.dragend, this)), b.responsive && m.on(F, this._resize = e(this.resize, this));\n\t  }, V.removeListeners = function () {\n\t    var a = this.options;this.$element.off(I, a.dragstart).off(J, a.dragmove).off(K, a.dragend).off(L, a.zoomin).off(M, a.zoomout), this.$cropper.off(A, this.dragstart).off(E, this.dblclick), a.zoomable && a.mouseWheelZoom && this.$cropper.off(D, this.wheel), n.off(B, this._dragmove).off(C, this._dragend), a.responsive && m.off(F, this._resize);\n\t  }, a.extend(V, { resize: function resize() {\n\t      var b,\n\t          c,\n\t          d,\n\t          e = this.$container,\n\t          f = this.container;this.disabled || (d = e.width() / f.width, (1 !== d || e.height() !== f.height) && (b = this.getCanvasData(), c = this.getCropBoxData(), this.render(), this.setCanvasData(a.each(b, function (a, c) {\n\t        b[a] = c * d;\n\t      })), this.setCropBoxData(a.each(c, function (a, b) {\n\t        c[a] = b * d;\n\t      }))));\n\t    }, dblclick: function dblclick() {\n\t      this.disabled || this.setDragMode(this.$dragBox.hasClass(x) ? \"move\" : \"crop\");\n\t    }, wheel: function wheel(a) {\n\t      var b = a.originalEvent,\n\t          c = 1;this.disabled || (a.preventDefault(), b.deltaY ? c = b.deltaY > 0 ? 1 : -1 : b.wheelDelta ? c = -b.wheelDelta / 120 : b.detail && (c = b.detail > 0 ? 1 : -1), this.zoom(.1 * -c));\n\t    }, dragstart: function dragstart(b) {\n\t      var c,\n\t          d,\n\t          e,\n\t          f = this.options,\n\t          g = b.originalEvent,\n\t          h = g && g.touches,\n\t          i = b;if (!this.disabled) {\n\t        if (h) {\n\t          if (e = h.length, e > 1) {\n\t            if (!f.zoomable || !f.touchDragZoom || 2 !== e) return;i = h[1], this.startX2 = i.pageX, this.startY2 = i.pageY, c = \"zoom\";\n\t          }i = h[0];\n\t        }if (c = c || a(i.target).data(\"drag\"), r.test(c)) {\n\t          if (b.preventDefault(), d = a.Event(I, { originalEvent: g, dragType: c }), this.$element.trigger(d), d.isDefaultPrevented()) return;this.dragType = c, this.cropping = !1, this.startX = i.pageX, this.startY = i.pageY, \"crop\" === c && (this.cropping = !0, this.$dragBox.addClass(s));\n\t        }\n\t      }\n\t    }, dragmove: function dragmove(b) {\n\t      var c,\n\t          d,\n\t          e = this.options,\n\t          f = b.originalEvent,\n\t          g = f && f.touches,\n\t          h = b,\n\t          i = this.dragType;if (!this.disabled) {\n\t        if (g) {\n\t          if (d = g.length, d > 1) {\n\t            if (!e.zoomable || !e.touchDragZoom || 2 !== d) return;h = g[1], this.endX2 = h.pageX, this.endY2 = h.pageY;\n\t          }h = g[0];\n\t        }if (i) {\n\t          if (b.preventDefault(), c = a.Event(J, { originalEvent: f, dragType: i }), this.$element.trigger(c), c.isDefaultPrevented()) return;this.endX = h.pageX, this.endY = h.pageY, this.change();\n\t        }\n\t      }\n\t    }, dragend: function dragend(b) {\n\t      var c,\n\t          d = this.dragType;if (!this.disabled && d) {\n\t        if (b.preventDefault(), c = a.Event(K, { originalEvent: b.originalEvent, dragType: d }), this.$element.trigger(c), c.isDefaultPrevented()) return;this.cropping && (this.cropping = !1, this.$dragBox.toggleClass(s, this.cropped && this.options.modal)), this.dragType = \"\";\n\t      }\n\t    } }), a.extend(V, { reset: function reset() {\n\t      this.built && !this.disabled && (this.image = a.extend({}, this.initialImage), this.canvas = a.extend({}, this.initialCanvas), this.renderCanvas(), this.cropped && (this.cropBox = a.extend({}, this.initialCropBox), this.renderCropBox()));\n\t    }, clear: function clear() {\n\t      this.cropped && !this.disabled && (a.extend(this.cropBox, { left: 0, top: 0, width: 0, height: 0 }), this.cropped = !1, this.renderCropBox(), this.limitCanvas(), this.renderCanvas(), this.$dragBox.removeClass(s), this.$cropBox.addClass(u));\n\t    }, destroy: function destroy() {\n\t      var a = this.$element;this.ready ? (this.unbuild(), a.removeClass(u)) : this.$clone.off(\"load\").remove(), a.removeData(\"cropper\");\n\t    }, replace: function replace(a) {\n\t      !this.disabled && a && this.load(a);\n\t    }, enable: function enable() {\n\t      this.built && (this.disabled = !1, this.$cropper.removeClass(y));\n\t    }, disable: function disable() {\n\t      this.built && (this.disabled = !0, this.$cropper.addClass(y));\n\t    }, move: function move(a, c) {\n\t      var d = this.canvas;this.built && !this.disabled && b(a) && b(c) && (d.left += a, d.top += c, this.renderCanvas(!0));\n\t    }, zoom: function zoom(b) {\n\t      var c,\n\t          d,\n\t          e,\n\t          f = this.canvas;if (b = U(b), b && this.built && !this.disabled && this.options.zoomable) {\n\t        if (c = a.Event(b > 0 ? L : M), this.$element.trigger(c), c.isDefaultPrevented()) return;b = -1 >= b ? 1 / (1 - b) : 1 >= b ? 1 + b : b, d = f.width * b, e = f.height * b, f.left -= (d - f.width) / 2, f.top -= (e - f.height) / 2, f.width = d, f.height = e, this.renderCanvas(!0), this.setDragMode(\"move\");\n\t      }\n\t    }, rotate: function rotate(a) {\n\t      var b = this.image;a = U(a), a && this.built && !this.disabled && this.options.rotatable && (b.rotate = (b.rotate + a) % 360, this.rotated = !0, this.renderCanvas(!0));\n\t    }, getData: function getData() {\n\t      var b,\n\t          c,\n\t          d = this.cropBox,\n\t          e = this.canvas,\n\t          f = this.image;return this.built && this.cropped ? (c = { x: d.left - e.left, y: d.top - e.top, width: d.width, height: d.height }, b = f.width / f.naturalWidth, a.each(c, function (a, d) {\n\t        d /= b, c[a] = d;\n\t      })) : c = { x: 0, y: 0, width: 0, height: 0 }, c.rotate = f.rotate, c;\n\t    }, getContainerData: function getContainerData() {\n\t      return this.built ? this.container : {};\n\t    }, getImageData: function getImageData() {\n\t      return this.ready ? this.image : {};\n\t    }, getCanvasData: function getCanvasData() {\n\t      var a,\n\t          b = this.canvas;return this.built && (a = { left: b.left, top: b.top, width: b.width, height: b.height }), a || {};\n\t    }, setCanvasData: function setCanvasData(c) {\n\t      var d = this.canvas,\n\t          e = d.aspectRatio;this.built && !this.disabled && a.isPlainObject(c) && (b(c.left) && (d.left = c.left), b(c.top) && (d.top = c.top), b(c.width) ? (d.width = c.width, d.height = c.width / e) : b(c.height) && (d.height = c.height, d.width = c.height * e), this.renderCanvas(!0));\n\t    }, getCropBoxData: function getCropBoxData() {\n\t      var a,\n\t          b = this.cropBox;return this.built && this.cropped && (a = { left: b.left, top: b.top, width: b.width, height: b.height }), a || {};\n\t    }, setCropBoxData: function setCropBoxData(c) {\n\t      var d = this.cropBox,\n\t          e = this.options.aspectRatio;this.built && this.cropped && !this.disabled && a.isPlainObject(c) && (b(c.left) && (d.left = c.left), b(c.top) && (d.top = c.top), e ? b(c.width) ? (d.width = c.width, d.height = d.width / e) : b(c.height) && (d.height = c.height, d.width = d.height * e) : (b(c.width) && (d.width = c.width), b(c.height) && (d.height = c.height)), this.renderCropBox());\n\t    }, getCroppedCanvas: function getCroppedCanvas(b) {\n\t      var c, d, e, f, g, h, i, j, l, m, n;if (this.built && this.cropped && N) return a.isPlainObject(b) || (b = {}), n = this.getData(), c = n.width, d = n.height, j = c / d, a.isPlainObject(b) && (g = b.width, h = b.height, g ? (h = g / j, i = g / c) : h && (g = h * j, i = h / d)), e = g || c, f = h || d, l = a(\"<canvas>\")[0], l.width = e, l.height = f, m = l.getContext(\"2d\"), b.fillColor && (m.fillStyle = b.fillColor, m.fillRect(0, 0, e, f)), m.drawImage.apply(m, function () {\n\t        var a,\n\t            b,\n\t            e,\n\t            f,\n\t            g,\n\t            h,\n\t            j = k(this.$clone[0], this.image),\n\t            l = j.width,\n\t            m = j.height,\n\t            o = [j],\n\t            p = n.x,\n\t            q = n.y;return -c >= p || p > l ? p = a = e = g = 0 : 0 >= p ? (e = -p, p = 0, a = g = P(l, c + p)) : l >= p && (e = 0, a = g = P(c, l - p)), 0 >= a || -d >= q || q > m ? q = b = f = h = 0 : 0 >= q ? (f = -q, q = 0, b = h = P(m, d + q)) : m >= q && (f = 0, b = h = P(d, m - q)), o.push(p, q, a, b), i && (e *= i, f *= i, g *= i, h *= i), g > 0 && h > 0 && o.push(e, f, g, h), o;\n\t      }.call(this)), l;\n\t    }, setAspectRatio: function setAspectRatio(a) {\n\t      var b = this.options;this.disabled || c(a) || (b.aspectRatio = U(a) || 0 / 0, this.built && (this.initCropBox(), this.cropped && this.renderCropBox()));\n\t    }, setDragMode: function setDragMode(a) {\n\t      var b = this.$dragBox,\n\t          c = !1,\n\t          d = !1;if (this.ready && !this.disabled) {\n\t        switch (a) {case \"crop\":\n\t            this.options.dragCrop ? (c = !0, b.data(\"drag\", a)) : d = !0;break;case \"move\":\n\t            d = !0, b.data(\"drag\", a);break;default:\n\t            b.removeData(\"drag\");}b.toggleClass(x, c).toggleClass(w, d);\n\t      }\n\t    } }), V.change = function () {\n\t    var a,\n\t        b = this.dragType,\n\t        c = this.options,\n\t        d = this.canvas,\n\t        e = this.container,\n\t        f = this.cropBox,\n\t        g = f.width,\n\t        h = f.height,\n\t        i = f.left,\n\t        j = f.top,\n\t        k = i + g,\n\t        l = j + h,\n\t        m = 0,\n\t        n = 0,\n\t        o = e.width,\n\t        p = e.height,\n\t        q = !0,\n\t        r = c.aspectRatio,\n\t        s = { x: this.endX - this.startX, y: this.endY - this.startY };switch (c.strict && (m = f.minLeft, n = f.minTop, o = m + P(e.width, d.width), p = n + P(e.height, d.height)), r && (s.X = s.y * r, s.Y = s.x / r), b) {case \"all\":\n\t        i += s.x, j += s.y;break;case \"e\":\n\t        if (s.x >= 0 && (k >= o || r && (n >= j || l >= p))) {\n\t          q = !1;break;\n\t        }g += s.x, r && (h = g / r, j -= s.Y / 2), 0 > g && (b = \"w\", g = 0);break;case \"n\":\n\t        if (s.y <= 0 && (n >= j || r && (m >= i || k >= o))) {\n\t          q = !1;break;\n\t        }h -= s.y, j += s.y, r && (g = h * r, i += s.X / 2), 0 > h && (b = \"s\", h = 0);break;case \"w\":\n\t        if (s.x <= 0 && (m >= i || r && (n >= j || l >= p))) {\n\t          q = !1;break;\n\t        }g -= s.x, i += s.x, r && (h = g / r, j += s.Y / 2), 0 > g && (b = \"e\", g = 0);break;case \"s\":\n\t        if (s.y >= 0 && (l >= p || r && (m >= i || k >= o))) {\n\t          q = !1;break;\n\t        }h += s.y, r && (g = h * r, i -= s.X / 2), 0 > h && (b = \"n\", h = 0);break;case \"ne\":\n\t        if (r) {\n\t          if (s.y <= 0 && (n >= j || k >= o)) {\n\t            q = !1;break;\n\t          }h -= s.y, j += s.y, g = h * r;\n\t        } else s.x >= 0 ? o > k ? g += s.x : s.y <= 0 && n >= j && (q = !1) : g += s.x, s.y <= 0 ? j > 0 && (h -= s.y, j += s.y) : (h -= s.y, j += s.y);0 > g && 0 > h ? (b = \"sw\", h = 0, g = 0) : 0 > g ? (b = \"nw\", g = 0) : 0 > h && (b = \"se\", h = 0);break;case \"nw\":\n\t        if (r) {\n\t          if (s.y <= 0 && (n >= j || m >= i)) {\n\t            q = !1;break;\n\t          }h -= s.y, j += s.y, g = h * r, i += s.X;\n\t        } else s.x <= 0 ? i > 0 ? (g -= s.x, i += s.x) : s.y <= 0 && n >= j && (q = !1) : (g -= s.x, i += s.x), s.y <= 0 ? j > 0 && (h -= s.y, j += s.y) : (h -= s.y, j += s.y);0 > g && 0 > h ? (b = \"se\", h = 0, g = 0) : 0 > g ? (b = \"ne\", g = 0) : 0 > h && (b = \"sw\", h = 0);break;case \"sw\":\n\t        if (r) {\n\t          if (s.x <= 0 && (m >= i || l >= p)) {\n\t            q = !1;break;\n\t          }g -= s.x, i += s.x, h = g / r;\n\t        } else s.x <= 0 ? i > 0 ? (g -= s.x, i += s.x) : s.y >= 0 && l >= p && (q = !1) : (g -= s.x, i += s.x), s.y >= 0 ? p > l && (h += s.y) : h += s.y;0 > g && 0 > h ? (b = \"ne\", h = 0, g = 0) : 0 > g ? (b = \"se\", g = 0) : 0 > h && (b = \"nw\", h = 0);break;case \"se\":\n\t        if (r) {\n\t          if (s.x >= 0 && (k >= o || l >= p)) {\n\t            q = !1;break;\n\t          }g += s.x, h = g / r;\n\t        } else s.x >= 0 ? o > k ? g += s.x : s.y >= 0 && l >= p && (q = !1) : g += s.x, s.y >= 0 ? p > l && (h += s.y) : h += s.y;0 > g && 0 > h ? (b = \"nw\", h = 0, g = 0) : 0 > g ? (b = \"sw\", g = 0) : 0 > h && (b = \"ne\", h = 0);break;case \"move\":\n\t        d.left += s.x, d.top += s.y, this.renderCanvas(!0), q = !1;break;case \"zoom\":\n\t        this.zoom(function (a, b, c, d) {\n\t          var e = O(a * a + b * b),\n\t              f = O(c * c + d * d);return (f - e) / e;\n\t        }(R(this.startX - this.startX2), R(this.startY - this.startY2), R(this.endX - this.endX2), R(this.endY - this.endY2))), this.startX2 = this.endX2, this.startY2 = this.endY2, q = !1;break;case \"crop\":\n\t        s.x && s.y && (a = this.$cropper.offset(), i = this.startX - a.left, j = this.startY - a.top, g = f.minWidth, h = f.minHeight, s.x > 0 ? s.y > 0 ? b = \"se\" : (b = \"ne\", j -= h) : s.y > 0 ? (b = \"sw\", i -= g) : (b = \"nw\", i -= g, j -= h), this.cropped || (this.cropped = !0, this.$cropBox.removeClass(u)));}q && (f.width = g, f.height = h, f.left = i, f.top = j, this.dragType = b, this.renderCropBox()), this.startX = this.endX, this.startY = this.endY;\n\t  }, a.extend(l.prototype, V), l.DEFAULTS = { aspectRatio: 0 / 0, autoCropArea: .8, crop: null, preview: \"\", strict: !0, responsive: !0, checkImageOrigin: !0, modal: !0, guides: !0, highlight: !0, background: !0, autoCrop: !0, dragCrop: !0, movable: !0, resizable: !0, rotatable: !0, zoomable: !0, touchDragZoom: !0, mouseWheelZoom: !0, minCanvasWidth: 0, minCanvasHeight: 0, minCropBoxWidth: 0, minCropBoxHeight: 0, minContainerWidth: 200, minContainerHeight: 100, build: null, built: null, dragstart: null, dragmove: null, dragend: null, zoomin: null, zoomout: null }, l.setDefaults = function (b) {\n\t    a.extend(l.DEFAULTS, b);\n\t  }, l.TEMPLATE = function (a, b) {\n\t    return b = b.split(\",\"), a.replace(/\\d+/g, function (a) {\n\t      return b[a];\n\t    });\n\t  }('<0 6=\"5-container\"><0 6=\"5-canvas\"></0><0 6=\"5-2-9\" 3-2=\"move\"></0><0 6=\"5-crop-9\"><1 6=\"5-view-9\"></1><1 6=\"5-8 8-h\"></1><1 6=\"5-8 8-v\"></1><1 6=\"5-face\" 3-2=\"all\"></1><1 6=\"5-7 7-e\" 3-2=\"e\"></1><1 6=\"5-7 7-n\" 3-2=\"n\"></1><1 6=\"5-7 7-w\" 3-2=\"w\"></1><1 6=\"5-7 7-s\" 3-2=\"s\"></1><1 6=\"5-4 4-e\" 3-2=\"e\"></1><1 6=\"5-4 4-n\" 3-2=\"n\"></1><1 6=\"5-4 4-w\" 3-2=\"w\"></1><1 6=\"5-4 4-s\" 3-2=\"s\"></1><1 6=\"5-4 4-ne\" 3-2=\"ne\"></1><1 6=\"5-4 4-nw\" 3-2=\"nw\"></1><1 6=\"5-4 4-sw\" 3-2=\"sw\"></1><1 6=\"5-4 4-se\" 3-2=\"se\"></1></0></0>', \"div,span,drag,data,point,cropper,class,line,dashed,box\"), l.other = a.fn.cropper, a.fn.cropper = function (b) {\n\t    var e,\n\t        f = d(arguments, 1);return this.each(function () {\n\t      var c,\n\t          d = a(this),\n\t          g = d.data(\"cropper\");g || d.data(\"cropper\", g = new l(this, b)), \"string\" == typeof b && a.isFunction(c = g[b]) && (e = c.apply(g, f));\n\t    }), c(e) ? this : e;\n\t  }, a.fn.cropper.Constructor = l, a.fn.cropper.setDefaults = l.setDefaults, a.fn.cropper.noConflict = function () {\n\t    return a.fn.cropper = l.other, this;\n\t  };\n\t});\n\n/***/ }),\n\n/***/ 289:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar cropper = __webpack_require__(85);\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar hint = __webpack_require__(44);\n\t\n\tvar $tabs = $('[data-node=\"editTab\"] a');\n\tvar $tabBoxs = $('[data-node=\"editBox\"]');\n\tvar $faceBox = $('[data-action=\"editFaceImg\"]');\n\t\n\tvar firstTab = true;\n\t\n\tvar cropperInit = function cropperInit() {\n\t\n\t\tcropper.init(function (src) {\n\t\t\tfetch.post(url.get('subName'), {\n\t\t\t\tdata: {\n\t\t\t\t\tfacePicUrl: src\n\t\t\t\t}\n\t\t\t}).done(function (result) {\n\t\n\t\t\t\tif (result && result.success && result.code === 200) {\n\t\t\t\t\t$faceBox.find('img').attr(\"src\", src);\n\t\t\t\t\t$('[data-node=\"headImg\"]').attr(\"src\", src);\n\t\t\t\t\thint.init('保存成功');\n\t\t\t\t} else {\n\t\t\t\t\thint.init('保存失败');\n\t\t\t\t}\n\t\t\t}).fail(function () {\n\t\t\t\thint.init('保存失败');\n\t\t\t});\n\t\t});\n\t};\n\t\n\tvar Tab = function Tab() {\n\t\t$(document).on('click', '[data-node=\"editTab\"] a', function () {\n\t\t\tif (!$(this).hasClass('active')) {\n\t\t\t\t$('[data-node=comErrTip]').addClass('hide');\n\t\t\t\tvar index = $tabs.index($(this));\n\t\t\t\t$tabs.removeClass('active').eq(index).addClass('active');\n\t\t\t\t$tabBoxs.hide().eq(index).show();\n\t\t\t\tif (index === 1 && firstTab) {\n\t\t\t\t\tfirstTab = false;\n\t\t\t\t\tcropperInit();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t$faceBox.on('click', function () {\n\t\t\t$('[data-node=comErrTip]').addClass('hide');\n\t\t\t$tabs.eq(1).click();\n\t\t});\n\t};\n\t\n\tvar init = function init() {\n\t\tTab();\n\t\tif (window.location.href.indexOf('type=2') !== -1) {\n\t\t\tcropperInit();\n\t\t}\n\t};\n\t\n\tmodule.exports = {\n\t\tinit: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n\n/***/ 290:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar tips = __webpack_require__(84);\n\tvar editBox = $('[data-node=editBox]').eq(0);\n\tvar birTip = editBox.find('[data-node=birTip]');\n\tvar hideCls = 'hide';\n\t\n\tvar dateClick = function dateClick() {\n\t    editBox.on('click', '[data-node=showDate]', function () {\n\t        var dateDefault = $(this).attr('data-default');\n\t        if (dateDefault) {\n\t            birTip.removeClass(hideCls).text(tips.birthTip.tip);\n\t            return false;\n\t        }\n\t    });\n\t    var eTime = +$_CONFIG['curr_time'];\n\t    var option = {\n\t        endTime: eTime\n\t    };\n\t    __webpack_require__(291).initDate(option);\n\t};\n\tmodule.exports = {\n\t    init: dateClick\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n\n/***/ 291:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {\"use strict\";\n\t\n\t/**\r\n\t * Created by dongyukuan on 2016/7/21.\r\n\t */\n\tfunction ShowDate(option) {\n\t    this.startTime = option ? option.startTime : +new Date(1930, 1, 1);\n\t    this.endTime = option ? option.endTime : +new Date(2099, 12, 30);\n\t    this.dateReg = /^\\d{4}-\\d{1,2}-\\d{1,2}$/;\n\t    this.yearErrTip = \"请输入正确年份！\";\n\t    this.monErrTip = \"请输入正确月份！\";\n\t    this.ymErrTip = \"请填写正确的年和月！\";\n\t}\n\tShowDate.prototype.addZero = function (num) {\n\t    var n = /^\\d$/;\n\t    var m;\n\t    if (n.test(num)) {\n\t        m = '0' + num;\n\t    } else {\n\t        m = num;\n\t    }\n\t    return m;\n\t};\n\t//获取内容或者写入内容\n\tShowDate.prototype.handleVal = function ($node, text) {\n\t    if (text) {\n\t        $node.text(text);\n\t    } else {\n\t        return $node.text();\n\t    }\n\t};\n\t//指定时间戳与当前时间戳做比较\n\tShowDate.prototype.compareDate = function (date) {\n\t    var nowDate = this.endTime;\n\t    var ret = true;\n\t    if (date > nowDate) {\n\t        ret = false;\n\t    } else {\n\t        ret = true;\n\t    }\n\t    return ret;\n\t};\n\t//阿拉伯数字与大写数字的转换\n\tShowDate.prototype.switchNum = function (num) {\n\t    var numAry = ['一', '二', '三', '四', '五', '六', '七', '八', '九', '十', '十一', '十二'];\n\t    var upperNum;\n\t    if (/^\\d+$/.test(num)) {\n\t        return numAry[num - 1];\n\t    } else {\n\t        $.each(numAry, function (index, value) {\n\t            if (value == num) {\n\t                upperNum = index + 1;\n\t            }\n\t        });\n\t        return upperNum;\n\t    }\n\t};\n\tShowDate.prototype.init = function () {\n\t    var _self = this;\n\t    //将日历模板添加到盒子中\n\t    if ($('[data-node=data_box]').length === 0) {\n\t        var tplHtml = _self.tpl();\n\t        $('body').append(tplHtml);\n\t    }\n\t    _self.dateContainer = $('[data-node=data_box]');\n\t\n\t    _self.dateBox = _self.dateContainer.find('[data-node=sel_date]');\n\t\n\t    _self.yearBox = _self.dateContainer.find('[data-node=year]');\n\t    _self.mnBox = _self.dateContainer.find('[data-node=month]');\n\t    _self.ymBox = _self.dateContainer.find('[data-node=month],[data-node=year]');\n\t\n\t    _self.dataTable = _self.dateBox.find('[data-node=data_table]');\n\t    _self.tbody = _self.dateBox.find('[data-node=tBody]');\n\t    _self.td = _self.tbody.find('td');\n\t\n\t    _self.prevM = _self.dateBox.find('[data-node=prev_m]');\n\t    _self.nextM = _self.dateBox.find('[data-node=next_m]');\n\t    _self.monBtn = _self.dateBox.find('[data-node=prev_m],[data-node=next_m]');\n\t\n\t    _self.prevY = _self.dateBox.find('[data-node=prev_y]');\n\t    _self.nextY = _self.dateBox.find('[data-node=next_y]');\n\t    _self.yearBtn = _self.dateBox.find('[data-node=prev_y],[data-node=next_y]');\n\t\n\t    //显示日历\n\t    $(document).on('click', '[data-node=showDate]', function () {\n\t        _self.changeDefault($(this));\n\t        _self.show();\n\t        _self.dateText = $(this);\n\t        var topBtn = $(this).offset().top;\n\t        var leftBtn = $(this).offset().left;\n\t\n\t        _self.dateContainer.css('position', 'absolute').css({\n\t            top: topBtn + 50,\n\t            left: leftBtn\n\t        });\n\t        _self.dateBox.css('marginTop', 0);\n\t        return false;\n\t    });\n\t    //点击空白 隐藏日历\n\t    $(document).on('click', function (event) {\n\t        var Target = $(event.target);\n\t        _self.hide(event, Target, $(this));\n\t    });\n\t    //点击选择日期\n\t    _self.tbody.on('click', 'td', function () {\n\t        var newDd = +$(this).text();\n\t        var newYear = parseInt(_self.handleVal(_self.yearBox), 10);\n\t        var newMn = _self.switchNum(_self.handleVal(_self.mnBox));\n\t        var dateFlag = $(this).hasClass('grayClr');\n\t        var trIndex = $(this).parents('tr').index();\n\t        if (dateFlag) {\n\t            if (trIndex === 0) {\n\t                if (newMn === 1) {\n\t                    newYear--;\n\t                    newMn = 12;\n\t                } else {\n\t                    newMn--;\n\t                }\n\t            } else {\n\t                if (newMn === 12) {\n\t                    newYear++;\n\t                    newMn = 1;\n\t                } else {\n\t                    newMn++;\n\t                }\n\t            }\n\t        }\n\t        if (isNaN(newYear) || isNaN(newMn) || newYear < 1930 || newYear > 2099 || newMn < 1 || newMn > 12) {\n\t            //如果td有值;\n\t            //alert(_self.ymErrTip);\n\t            return false;\n\t        }\n\t        var newDate = +new Date(newYear + \"/\" + newMn + \"/\" + newDd);\n\t        var dateComFlag = _self.compareDate(newDate);\n\t        if (!dateComFlag) {\n\t            //alert(_self.ymErrTip);\n\t            return false;\n\t        }\n\t        _self.dateText.val(newYear + \"-\" + _self.addZero(newMn) + \"-\" + _self.addZero(newDd));\n\t        _self.dateContainer.addClass('hide');\n\t        _self.dateBox.addClass(\"hide\");\n\t    });\n\t    //点击切换月份\n\t    _self.monBtn.on('click', function () {\n\t        _self.changeMn($(this));\n\t        return $(this);\n\t    });\n\t    //点击切换年份\n\t    _self.yearBtn.on('click', function () {\n\t        _self.changeYr($(this));\n\t        return $(this);\n\t    });\n\t};\n\t//日历模板\n\tShowDate.prototype.tpl = function () {\n\t    var str = '';\n\t    str += '<div class=\"data_box hide\" data-node=\"data_box\"> <div class=\"sel_date hide\" data-node=\"sel_date\"> <div class=\"date-nav clearfix\"> <span class=\"icon prev_y fl\" data-node=\"prev_y\">&#xea72;</span> <span class=\"icon prev_m fl\" data-node=\"prev_m\">&#xe970;</span> <div class=\"show_mn fl\"> <a href=\"javascript:;\" data-node=\"month\"> </a> <span class=\"ml5\">月</span> <a href=\"javascript:;\" data-node=\"year\"></a> </div>  <span class=\"icon next_y fr\" data-node=\"next_y\">&#xea73;</span> <span class=\"icon next_m fr\" data-node=\"next_m\">&#xe98c;</span> </div> <table class=\"data_table\" data-node=\"data_table\" cellpadding=\"0\" cellspacing=\"0\"> <thead> <tr> <td>日</td> <td>一</td> <td>二</td> <td>三</td> <td>四</td> <td>五</td> <td>六</td> </tr> </thead> <tbody data-node=\"tBody\"> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> </tbody> </table> </div> </div>';\n\t    return str;\n\t};\n\t//点击切换月份\n\tShowDate.prototype.changeMn = function (dateContainer) {\n\t    var _self = this;\n\t    var NewMn = _self.switchNum(_self.handleVal(_self.mnBox));\n\t    var newYear = parseInt(_self.handleVal(_self.yearBox), 10);\n\t    if (isNaN(NewMn) || isNaN(newYear)) {\n\t        alert(_self.ymErrTip);\n\t        return false;\n\t    }\n\t    if (dateContainer.hasClass('next_m')) {\n\t        NewMn++;\n\t    } else {\n\t        NewMn--;\n\t    }\n\t    if (NewMn < 1) {\n\t        NewMn = 12;\n\t        newYear--;\n\t    } else if (NewMn > 12) {\n\t        NewMn = 1;\n\t        newYear++;\n\t    }\n\t    _self.handleVal(_self.mnBox, _self.switchNum(NewMn));\n\t    _self.showNow(newYear, NewMn);\n\t};\n\t//点击切换年份\n\tShowDate.prototype.changeYr = function (dateContainer) {\n\t    var _self = this;\n\t    var NewMn = _self.switchNum(_self.handleVal(_self.mnBox));\n\t    var newYear = parseInt(_self.handleVal(_self.yearBox), 10);\n\t    if (isNaN(NewMn) || isNaN(newYear)) {\n\t        alert(_self.ymErrTip);\n\t        return false;\n\t    }\n\t    if (dateContainer.hasClass('next_y')) {\n\t        newYear++;\n\t    } else {\n\t        newYear--;\n\t    }\n\t    if (newYear < 1900) {\n\t        newYear = 1900;\n\t    } else if (newYear > 2099) {\n\t        newYear = 2099;\n\t    }\n\t    _self.handleVal(_self.mnBox, _self.switchNum(NewMn));\n\t    _self.showNow(newYear, NewMn);\n\t};\n\t//文本框 清空初始值\n\tShowDate.prototype.changeDefault = function (dateContainer) {\n\t    var _self = this;\n\t    var deVal = dateContainer.val();\n\t    var regExp = /^\\s*$/g;\n\t    if (!_self.dateReg.test(deVal)) {\n\t        dateContainer.text(\"\");\n\t        _self.showNow();\n\t    } else if (deVal.match(regExp) === null && _self.dateBox.hasClass('hide')) {\n\t        //如果显示的是非空字符\n\t        var dayArr = deVal.match(/[0-9]{1,4}/g);\n\t        _self.showNow(dayArr[0], dayArr[1], dayArr[2]); //刷新日期\n\t    }\n\t};\n\t//文本框 还原初始值;\n\tShowDate.prototype.changeDefault2 = function (dateContainer) {\n\t    var _self = this;\n\t    var deVal = dateContainer.text();\n\t    if (/^\\s{0}$/.test(deVal)) {\n\t        dateContainer.text(_self.btnTxt);\n\t    }\n\t};\n\t//显示日历\n\tShowDate.prototype.show = function () {\n\t    var _self = this;\n\t    _self.dateContainer.toggleClass('hide');\n\t    _self.dateBox.toggleClass('hide');\n\t};\n\t//隐藏日历\n\tShowDate.prototype.hide = function (event, Target) {\n\t    var _self = this;\n\t    var oPare = Target;\n\t    var isChild = true;\n\t    if (oPare.parents('[data-node=data_box]').length === 0) {\n\t        isChild = false;\n\t    }\n\t    if (!isChild && !_self.dateBox.hasClass('hide')) {\n\t        _self.dateContainer.toggleClass('hide');\n\t        _self.dateBox.addClass('hide');\n\t        _self.changeDefault2(_self.dateText);\n\t    }\n\t};\n\t//填充年、月\n\tShowDate.prototype.showNow = function (yr, mn, date) {\n\t    var _self = this;\n\t    var now = new Date(_self.endTime);\n\t    var year = yr || now.getFullYear();\n\t    var month = mn - 1 || now.getMonth();\n\t    var dd = date || now.getDate();\n\t    //填充 年 和 月\n\t    _self.handleVal(_self.yearBox, year);\n\t    _self.handleVal(_self.mnBox, _self.switchNum(mn) || _self.switchNum(now.getMonth() + 1));\n\t    //填充日期\n\t    _self.showAllDay(year, month, dd);\n\t};\n\t//获取每月多少天\n\tShowDate.prototype.getDayLen = function (year, month) {\n\t    var d = new Date(year, month + 1);\n\t    d.setDate(0);\n\t    return d.getDate();\n\t};\n\t//填充当月的所有日期\n\tShowDate.prototype.showAllDay = function (Yr, Mn, Dd) {\n\t    var _self = this;\n\t    var newDate = new Date(Yr, Mn, Dd);\n\t    var year = newDate.getFullYear();\n\t    var month = newDate.getMonth();\n\t    newDate.setDate(0);\n\t    var firstDay = newDate.getDay() + 1;\n\t    var monthPre; //, monthNext;\n\t    if (month === 0) {\n\t        monthPre = 11;\n\t        // monthNext = 1;\n\t    } else if (month === 11) {\n\t        monthPre = 10;\n\t        // monthNext = 0;\n\t    } else {\n\t        monthPre = month - 1;\n\t        // monthNext = month + 1;\n\t    }\n\t    var dayLen = _self.getDayLen(year, month);\n\t    var dayLenPre = _self.getDayLen(year, monthPre);\n\t    // var daylenNext = _self.getDayLen(year, monthNext);\n\t    //清空日期\n\t    _self.td.each(function (index) {\n\t        _self.td.eq(index).removeClass('active').find('span').text(\"\");\n\t    });\n\t    //渲染日期排列\n\t    _self.td.removeClass('grayClr');\n\t    /*\r\n\t    针对2012-4，日历第一行皆置灰的处理 \r\n\t       if(firstDay >= 7){\r\n\t            firstDay -=7;\r\n\t        }\r\n\t    */\n\t    for (var i = 0, len = _self.td.length; i < len; i++) {\n\t        if (i < firstDay) {\n\t            _self.td.eq(i).addClass('grayClr').find('span').text(dayLenPre - firstDay + i + 1);\n\t        } else if (i >= firstDay && i < firstDay + dayLen) {\n\t            _self.td.eq(i).find('span').text(i - firstDay + 1);\n\t            if (i - firstDay + 1 == Dd && !_self.td.eq(i).hasClass(\"active\")) {\n\t                _self.td.eq(i).addClass('active');\n\t            }\n\t        } else {\n\t            _self.td.eq(i).addClass('grayClr').find('span').text(i - firstDay - dayLen + 1);\n\t        }\n\t    }\n\t};\n\t//函数调用\n\tmodule.exports = {\n\t    initDate: function initDate(option) {\n\t        var miniDate = new ShowDate(option);\n\t        miniDate.init();\n\t    }\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n\n/***/ 292:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar verifyName = __webpack_require__(293);\n\tvar limitLen = __webpack_require__(296);\n\tvar editCls = __webpack_require__(295);\n\tvar remCls = editCls.remCls;\n\tvar addCls = editCls.addCls;\n\t\n\tvar editBox = $('[data-node=editBox]').eq(0);\n\tvar nickname = editBox.find('[data-node=nickname]');\n\tvar nameErr = editBox.find('[data-node=nameErr]');\n\tvar errBorder = editBox.find('[data-node=nameBorErr]');\n\tvar comErr = editBox.find('[data-node=comErrTip]');\n\t\n\tvar hideCls = 'hide';\n\tvar borErrCls = 'nicknerror';\n\tvar nameFoc = function nameFoc() {\n\t\tremCls(errBorder, borErrCls);\n\t\taddCls(nameErr, hideCls);\n\t\taddCls(comErr, hideCls);\n\t};\n\tvar nameKeyup = function nameKeyup() {\n\t\tvar nameVal = nickname.val();\n\t\tvar len = nameVal.length;\n\t\tif (len > 20) {\n\t\t\tnickname.val(limitLen(nameVal, 20));\n\t\t}\n\t};\n\tvar initObj = {\n\t\tinit: function init() {\n\t\t\tnickname.on({\n\t\t\t\tblur: verifyName.checkNameRule,\n\t\t\t\tfocus: nameFoc,\n\t\t\t\tkeyup: nameKeyup\n\t\t\t});\n\t\t}\n\t};\n\tmodule.exports = initObj;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n\n/***/ 293:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t// var fetch = require('io/fetch');\n\t// var url = require('io/url');\n\tvar check = __webpack_require__(294);\n\tvar nickTips = __webpack_require__(84).nickName;\n\t\n\tvar editCls = __webpack_require__(295);\n\tvar remCls = editCls.remCls;\n\tvar addCls = editCls.addCls;\n\t\n\tvar editBox = $('[data-node=editBox]').eq(0);\n\tvar nickname = editBox.find('[data-node=nickname]');\n\tvar nameErr = editBox.find('[data-node=nameErr]');\n\tvar errBorder = editBox.find('[data-node=nameBorErr]');\n\t\n\tvar hideCls = 'hide';\n\tvar borErrCls = 'nicknerror';\n\t\n\tvar checkRule = function checkRule() {\n\t    var ret = true;\n\t    var nameVal = nickname.val();\n\t    var len = nameVal.length;\n\t    var lenFlag = !!(len >= 2 && len <= 20);\n\t    if (!nameVal) {\n\t        ret = false;\n\t        addCls(errBorder, borErrCls);\n\t        remCls(nameErr, hideCls).text(nickTips.eptName);\n\t    } else if (!check.checkNickName(nameVal) || !lenFlag) {\n\t        ret = false;\n\t        addCls(errBorder, borErrCls);\n\t        remCls(nameErr, hideCls).text(nickTips.commonTip);\n\t    } else {\n\t        ret = true;\n\t    }\n\t    return ret;\n\t};\n\t/*var nameExist = function() {\r\n\t    var nameVal = nickname.val();\r\n\t    var nameData = {\r\n\t        \"nickname\": nameVal\r\n\t    };\r\n\t    return fetch.get(url.get('checkName'), {\r\n\t        \"data\": nameData\r\n\t    }).done(function(data) {\r\n\t        if (data.success) {\r\n\t            remCls(errBorder, borErrCls);\r\n\t            addCls(nameErr, hideCls);\r\n\t        } else {\r\n\t            addCls(errBorder, borErrCls);\r\n\t            remCls(nameErr, hideCls).text(data.message);\r\n\t        }\r\n\t    }).fail(function() {\r\n\t        addCls(errBorder, borErrCls);\r\n\t        remCls(nameErr, hideCls).text(nickTips.errLine);\r\n\t    });\r\n\t};*/\n\t/*var checkName = function() {\r\n\t    var nameFlag = checkRule();\r\n\t    if (nameFlag) {\r\n\t        nameExist();\r\n\t    }\r\n\t};*/\n\tmodule.exports = {\n\t    /*\"checkName\": checkName,*/\n\t    \"checkNameRule\": checkRule\n\t    /* \"checkExist\": nameExist*/\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n\n/***/ 294:\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\r\n\t * Created by dongyukuan on 2016/5/20.\r\n\t */\n\tvar obj = {\n\t    checkVal: function checkVal(val, pattern) {\n\t        return pattern.test(val);\n\t    },\n\t    isMobileNum: function isMobileNum(mobile) {\n\t        return (/^1[34578][0-9]{9}$/.test(mobile)\n\t        );\n\t    },\n\t    isEmail: function isEmail(email) {\n\t        return (/w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/.test(email)\n\t        );\n\t    },\n\t    isCertificate: function isCertificate(certificate) {\n\t        return (/^(\\d{15}$|^\\d{18}$|^\\d{17}(\\d|X|x))$/.test(certificate)\n\t        );\n\t    },\n\t    isCID: function isCID(cardNo) {\n\t        return (/^(\\d{16}|\\d{19})$/.test(cardNo)\n\t        );\n\t    },\n\t    isCWord: function isCWord(word, start, end) {\n\t        start = !isNaN(start) && start > 0 ? start : 1;\n\t        end = !isNaN(end) && end > 0 ? end : '';\n\t        var reg = new RegExp('^[\\\\u4e00-\\\\u9fa5]{' + start + ',' + end + '}$');\n\t        //var regPunctuation = /[1-9<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，；‘’“”：'\"\\·`]/;\n\t        // var regRes = reg.test(word);\n\t        //var pugRes = regPunctuation.test(word);\n\t        return reg.test(word);\n\t    },\n\t    isArray: function isArray(arr) {\n\t        return Array.isArray(arr) || arr instanceof Array;\n\t    },\n\t    passwordReg: function passwordReg(val) {\n\t        var reg = /^((?=.*?\\d)(?=.*?[A-Za-z])|(?=.*?\\d)(?=.*?[<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，\\\"\\,\\:\\;；,\\.‘’“”：'\"\\·`【】])|(?=.*?[A-Za-z])(?=.*?[<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，；‘’“”：'\"\\·`,\\.【】]))[\\dA-Za-z<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，；‘’“”：'\"\\·`,\\.【】]{6,21}$/;\n\t        return reg.test(val);\n\t    },\n\t    checkSpace: function checkSpace(val) {\n\t        var reg = /\\s+/;\n\t        return reg.test(val);\n\t    },\n\t    checkRefCode: function checkRefCode(refCode) {\n\t        var reg = /^[0-9a-zA-Z]{8}$/;\n\t        return reg.test(refCode);\n\t    },\n\t    checkNickName: function checkNickName(name) {\n\t        var nickNameReg = /^([\\u4e00-\\u9fa5]|[0-9a-zA-Z_-])+$/;\n\t        return nickNameReg.test(name);\n\t    },\n\t    isMsgCode: function isMsgCode(num) {\n\t        var reg = /^\\d{6}$/;\n\t        return reg.test(num);\n\t    },\n\t    isImgCode: function isImgCode(str) {\n\t        var reg = /^[0-9a-zA-Z]{4}$/;\n\t        return reg.test(str);\n\t    }\n\t};\n\tmodule.exports = obj;\n\n/***/ }),\n\n/***/ 295:\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar remCls = function remCls($node, cls) {\n\t    if ($node.hasClass(cls)) {\n\t        $node.removeClass(cls);\n\t    }\n\t    return $node;\n\t};\n\tvar addCls = function addCls($node, cls) {\n\t    if (!$node.hasClass(cls)) {\n\t        $node.addClass(cls);\n\t    }\n\t    return $node;\n\t};\n\tmodule.exports = {\n\t    remCls: remCls,\n\t    addCls: addCls\n\t};\n\n/***/ }),\n\n/***/ 296:\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\t/**\r\n\t * Created by dongyukuan on 2016/5/28.\r\n\t */\n\tfunction limitLen(str, len) {\n\t    if (str.length > len) {\n\t        return str.substr(0, len);\n\t    } else {\n\t        return str;\n\t    }\n\t}\n\tmodule.exports = limitLen;\n\n/***/ }),\n\n/***/ 297:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar nameTips = __webpack_require__(84).nickName;\n\tvar verifyName = __webpack_require__(293);\n\t\n\tvar editBox = $('[data-node=editBox]').eq(0);\n\tvar nickname = editBox.find('[data-node=nickname]');\n\tvar sexBox = editBox.find('[data-node=sexBox]');\n\tvar birthday = editBox.find('[data-node=showDate]');\n\tvar subDate = editBox.find('[data-action=subDate]');\n\tvar comTip = editBox.find('[data-node=comErrTip]');\n\tvar nameBorErr = editBox.find('[data-node=nameBorErr]');\n\tvar faceImg = editBox.find('[data-node=faceImg]');\n\tvar birthTip = editBox.find('[data-node=birTip]');\n\t\n\tvar header = $('[data-node=header]');\n\tvar headImg = header.find('[data-node=headImg]');\n\tvar headName = header.find('[data-node=headName]');\n\t\n\tvar birthPre = birthday.attr('data-default');\n\t\n\tvar dateReg = /^\\d{4}-\\d{1,2}-\\d{1,2}$/;\n\tvar hideCls = 'hide';\n\tvar errBorCls = 'nicknerror';\n\tvar sub = function sub() {\n\t    comTip.addClass(hideCls);\n\t    var nameVal = nickname.val();\n\t    var sexVal = sexBox.find('input:checked').val();\n\t    var birthVal = birthday.val();\n\t    birthVal = birthPre || (dateReg.test(birthVal) ? birthVal : '');\n\t    var faceImgUrl = faceImg.attr('src');\n\t    var nameFlag = verifyName.checkNameRule();\n\t    var errFlag = !nameBorErr.hasClass(errBorCls);\n\t    if (nameFlag && errFlag) {\n\t        // verifyName.checkExist().then(function(data) {\n\t        // if (data.success) {\n\t        var subData = {\n\t            \"facePicUrl\": faceImgUrl,\n\t            \"birthday\": birthVal,\n\t            \"nickname\": nameVal,\n\t            \"gender\": sexVal\n\t        };\n\t        fetch.post(url.get('subName'), {\n\t            data: subData\n\t        }).done(function (data) {\n\t            if (data.success) {\n\t                comTip.removeClass(hideCls).text(nameTips.sucSub);\n\t                headImg.attr('src', faceImgUrl);\n\t                headName.text(nameVal);\n\t                var birFlag = dateReg.test(birthVal);\n\t                if (birFlag && !birthPre) {\n\t                    birthday.attr('data-default', birthVal);\n\t                    birthTip.addClass(hideCls);\n\t                }\n\t            } else {\n\t                comTip.removeClass(hideCls).text(data.message);\n\t            }\n\t        }).fail(function () {\n\t            comTip.removeClass(hideCls).text(nameTips.errLine);\n\t        });\n\t    }\n\t    // });\n\t    // }\n\t};\n\tvar subEvent = function subEvent() {\n\t    subDate.on('click', sub);\n\t};\n\tmodule.exports = {\n\t    subInit: subEvent\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// uc_editInfo.js","//修改头像\r\nrequire('./editFace').init();\r\n\r\n//出生日期\r\nrequire('./selDate').init();\r\n//昵称事件\r\nrequire('./nameEvent').init();\r\n//提交保存\r\nrequire('./subData').subInit();\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/uc_editInfo/index.js","/*\r\n * 弹层提示弹窗\r\n * zhaodonghong\r\n */\r\n\r\n\r\n\r\nvar $publicMask;\r\nvar $publicTips;\r\nvar timer;\r\n\r\n\r\nvar events = function() {\r\n\r\n    $publicMask.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n\r\n    $publicTips.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * msg string 提示信息\r\n * options object \r\n * options.duration settimout消失时间\r\n * options.callback 提示消失的回调\r\n*/\r\nvar init = function(msg, options) {\r\n    var defaults = {\r\n        duration: 2000,\r\n        callback: function() {}\r\n    };\r\n\r\n    $.extend(defaults, options || {});\r\n\r\n    clearTimeout(timer);\r\n    $publicMask = $('[data-action=\"publicMask\"]');\r\n    $publicTips = $('[data-action=\"publicTips\"]');\r\n\r\n    if ($publicMask.length > 0) {\r\n\r\n        $publicMask.show();\r\n        $publicTips.show().text(msg);\r\n\r\n    } else {\r\n\r\n        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\r\n        $publicMask = $('[data-action=\"publicMask\"]');\r\n        $publicTips = $('[data-action=\"publicTips\"]');\r\n        events();\r\n    }\r\n\r\n    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\r\n\r\n    timer = setTimeout(function() {\r\n\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n\r\n        defaults.callback();\r\n\r\n    }, defaults.duration);\r\n};\r\n\r\n\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    events: events\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/hint.js","/**\n * Created by dongyukuan on 2016/7/4.\n */\nvar inputTip = {\n    tel: {\n        ept: '请填写11位手机号',\n        err: '手机号格式错误',\n        errBack: '该手机号已被注册'\n    },\n    msgCode: {\n        tipGet: '请获取短信验证码',\n        tipEpt: '请输入短信验证码',\n        tipErr: '验证码是6位数字,请重新输入',\n        tipErrEdit: '验证码错误',\n        tipWrong: '验证码有误,请重新输入',\n        checkCodeWrong: '验证码输入错误,请重新输入',\n        send: '验证码已发送，请注意查收',\n        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n        tipDisabled: \"验证码再次获取需间隔60s\",\n        tipLimitEdit: '获取验证码超限，请稍后再试',\n        btnAfterSend: \"秒后重新获取\",\n        btnDefault: \"获取验证码\"\n    },\n    pwd: {\n        commonTip: '请输入6-20位英文字母,数字或符号'\n    },\n    pwdV: {\n        ept: '请再次输入密码',\n        err: '两次输入的密码不一致'\n    },\n    nickName: {\n        eptName: '请输入昵称！',\n        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n        existName: '此昵称太受欢迎了，已经有人抢了~',\n        sucSub: '资料修改成功！',\n        errLine: \"网络超时!\",\n        wrongName: '此昵称含有敏感词,请重新输入'\n    },\n    birthTip: {\n        tip: '生日不能重复设置'\n    },\n    refCode: {\n        err: '推荐码错误'\n    },\n    imgCode: {\n        ept: '请输入验证码',\n        err: '验证码输入错误，请重新输入'\n    },\n    login: {\n        errCode: '请输入验证码',\n        errNum: '请输入账号',\n        errPwd: '请输入密码',\n        agreement: '请同意协议并勾选'\n    },\n    createCircle: {\n        typeEmpty: '请选择圈子分类',\n        nameEmpty: '圈子名称不能为空',\n        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n    },\n    circle: {\n    \tlogin: '登录成功！',\n        unJoin: '需要先加入该圈子才能发布话题',\n        cannotJoin: '抱歉！该圈子不允许发布话题!',\n        review: '加入圈子审核中，请耐心等待!',\n        joinSuccess: '恭喜您已经加入圈子！',\n        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n        exit: '您已经退出该圈子！',\n        dissolved: '抱歉！该圈子已被解散'\n    },\n    qrCodeTip: {\n        loseEffTip: '二维码已失效',\n        loseEffBtn: '点击刷新',\n        failGetTip: '二维码生成失败',\n        failGetBtn: '重新生成'\n    },\n    masterApply: {\n        nameLength: '姓名要2-20个字符',\n        nameType: '姓名仅限汉字和字母',\n        isIdCard: '请填写18位有效身份证号',\n        type: '请选择达人类别',\n        summary: '请输入自我介绍，2-100个字符'\n    },\n    upload: {\n        noUpload: '请上传图片',\n        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        uploadFaild: '上传失败,请重新上传',\n        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n        Q_TYPE_DENIED: '文件类型错误',\n        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n        excess: '文件个数超出限制'\n    },\n    errLine: {\n        tip: '网络错误,请稍后再试！'\n    }\n};\nmodule.exports = inputTip;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/i18n.js","var WebUploader = require('../plugin/webuploader/webuploader');\r\nrequire('../plugin/jquery.cropper');\r\n\r\nvar $webUpLoader;\r\nvar $noticeBox = $('[data-node=\"noticeBox\"]');\r\n// var $noticeInfo = $noticeBox.find('[data-node=\"noticeInfo\"]');\r\nvar $wrap = $('[data-node=\"cropWrap\"]');\r\nvar $cropImg = $wrap.find('img');\r\nvar $preview = $('[data-node=\"avatrSelector\"]');\r\nvar $avatarSave = $('[data-action=\"avatarSave\"]')\r\nvar $progress = $noticeBox.find('[data-node=\"uploadProgress\"]');\r\nvar $error = $('[data-node=\"error\"]');\r\nvar $loadNotice = $noticeBox.find('[data-node=\"loadNotice\"]');\r\nvar $retry = $noticeBox.find('[data-action=\"retry\"]');\r\n\r\nvar avatarData = {};\r\nvar files;\r\nvar defaultImage = $cropImg.attr('data-default');\r\nvar isUpload = false;\r\nvar link = '';\r\nvar isIE8 = !window.FormData;\r\nvar key = false;\r\n\r\nvar startCrop = function() {\r\n    isUpload = true;\r\n    $cropImg.cropper({\r\n        aspectRatio: 1,\r\n        preview: $preview.selector,\r\n        background: false,\r\n        guides: false\r\n    });\r\n};\r\n\r\nvar preview = function(upload, cropper, callback) {\r\n    $webUpLoader = WebUploader.create(upload);\r\n    $webUpLoader.on('beforeFileQueued', function() {\r\n        isUpload = false;\r\n        $cropImg.cropper('destroy');\r\n        $error.hide();\r\n        files !== undefined && $webUpLoader.removeFile(files.id);\r\n    });\r\n\r\n    $webUpLoader.on('fileQueued', function(file) {\r\n            files = file;\r\n            if (isIE8 && !key) {\r\n                $webUpLoader.upload(files);\r\n                key = true;\r\n            } else {\r\n                $webUpLoader.makeThumb(file, function(error, ret) {\r\n                    if (error) {\r\n                        $webUpLoader.removeFile(files.id);\r\n                        $noticeBox.removeClass('load-ing').show();\r\n                    } else {\r\n                        $cropImg.attr('src', ret);\r\n                        startCrop(cropper);\r\n                        $avatarSave.addClass('active');\r\n                        if( $cropImg.attr('data-edit') ){\r\n                            $('[data-defaultAddFile=picker]').hide();\r\n                            $webUpLoader.addButton({\r\n                                id: '[data-action=\"upload-edit\"]',\r\n                                innerHTML: '修改'\r\n                            });\r\n                        }\r\n\r\n                    }\r\n                });\r\n            }\r\n            $webUpLoader.md5File(file)\r\n                // 及时显示进度\r\n                .progress(function(percentage) {\r\n                    $loadNotice.text('图片加载中');\r\n                    $noticeBox.addClass('load-ing').show();\r\n                    $progress.css('width', percentage * 100 + '%');\r\n                })\r\n                // 完成\r\n                .then(function( /*val*/ ) {\r\n                    $noticeBox.hide();\r\n                    $progress.css('width', 0);\r\n                });\r\n        })\r\n        //报错\r\n    $webUpLoader.on('error', function( /*type*/ ) {\r\n        /*var errNotice = {\r\n            Q_EXCEED_NUM_LIMIT: '文件个数超出限制',\r\n            Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\r\n            Q_TYPE_DENIED: '文件类型错误',\r\n            F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！'\r\n        }*/\r\n        $cropImg.attr('src', defaultImage);\r\n        $preview.find('img').attr('src', defaultImage);\r\n        $error.show().find('span').text('请上传小于4M的图片，支持格式jpg、jpeg、png、gif！');\r\n        $avatarSave.removeClass('active');\r\n    });\r\n\r\n    //上传成功\r\n    $webUpLoader.on('uploadSuccess', function(file, response) {\r\n\r\n        if (response.success && response.code === 200) {\r\n            if (key) {\r\n                $cropImg.attr('src', response.data[0]);\r\n                startCrop();\r\n                $noticeBox.hide();\r\n                key = false;\r\n                $avatarSave.addClass('active');\r\n            } else {\r\n                $cropImg.attr('src', response.data[0]);\r\n                $noticeBox.hide();\r\n                $cropImg.cropper('destroy');\r\n                $preview.find('img').attr('src', response.data[0]);\r\n                $webUpLoader.removeFile(files);\r\n                link = response.data[0];\r\n                callback.call(null, response.data[0]);\r\n                $avatarSave.removeClass('active');\r\n                files = undefined;\r\n            }\r\n        } else {\r\n            $('.cropper-crop-box').hide();\r\n            $noticeBox.removeClass('load-ing').show();\r\n            isUpload = true;\r\n        }\r\n    });\r\n    //上传失败\r\n    $webUpLoader.on('uploadError', function( /*file, reason*/ ) {\r\n        $('.cropper-crop-box').hide();\r\n        $noticeBox.removeClass('load-ing').show();\r\n        isUpload = true;\r\n    });\r\n\r\n    //上传时\r\n    $webUpLoader.on('uploadProgress', function(file, percentage) {\r\n        $('.cropper-crop-box').hide();\r\n        $loadNotice.text('图片上传中');\r\n        $noticeBox.addClass('load-ing').show();\r\n        $progress.css('width', percentage * 100 + '%');\r\n        isUpload = false;\r\n    });\r\n\r\n}\r\n\r\nvar submit = function() {\r\n    $avatarSave.on('click', function() {\r\n        if (isUpload && $(this).hasClass('active')) {\r\n            isUpload = false;\r\n            avatarData = $cropImg.cropper('getData');\r\n            avatarData.type = 'crop';\r\n            $webUpLoader.on('uploadBeforeSend', function(object, data) {\r\n                $.extend(data, avatarData);\r\n            });\r\n            $webUpLoader.upload(files);\r\n        }\r\n        $retry.addClass('active');\r\n    });\r\n    $retry.on('click', function() {\r\n        if (isUpload && $(this).hasClass('active')) {\r\n            isUpload = false;\r\n            avatarData = $cropImg.cropper('getData');\r\n            avatarData.type = 'crop';\r\n            $webUpLoader.on('uploadBeforeSend', function(object, data) {\r\n                $.extend(data, avatarData);\r\n            });\r\n            $webUpLoader.retry(files);\r\n        }\r\n    });\r\n}\r\n\r\nvar init = function(callback, uploadOptions, cropperOptions) {\r\n    $noticeBox = $('[data-node=\"noticeBox\"]');\r\n    // $noticeInfo = $noticeBox.find('[data-node=\"noticeInfo\"]');\r\n    $wrap = $('[data-node=\"cropWrap\"]');\r\n    $cropImg = $wrap.find('img');\r\n    $preview = $('[data-node=\"avatrSelector\"]');\r\n    $avatarSave = $('[data-action=\"avatarSave\"]')\r\n    $progress = $noticeBox.find('[data-node=\"uploadProgress\"]');\r\n    $error = $('[data-node=\"error\"]');\r\n    $loadNotice = $noticeBox.find('[data-node=\"loadNotice\"]');\r\n    $retry = $noticeBox.find('[data-action=\"retry\"]');\r\n    defaultImage = $cropImg.attr('data-default');\r\n    var fn = callback || function() {};\r\n    var defaultUpload = {\r\n        pick: {\r\n            id: '[data-defaultAddFile=picker]',\r\n            innerHTML: '<span>+</span>上传头像',\r\n            multiple: false\r\n        },\r\n        thumb: false,\r\n        compress: false,\r\n        accept: {\r\n            title: 'Images',\r\n            extensions: 'jpg,jpeg,png',\r\n            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\r\n        },\r\n        method: 'post',\r\n        // swf文件路径\r\n        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\r\n        disableGlobalDnd: true,\r\n        duplicate: true,\r\n        prepareNextFile: true,\r\n        chunked: true,\r\n        fileVal: 'avatar_file',\r\n        server: '/ajax/crop/crop_img',\r\n        fileNumLimit: 1,\r\n        fileSizeLimit: 4 * 1024 * 1024,\r\n        fileSingleSizeLimit: 4 * 1024 * 1024\r\n    };\r\n    var defaultCropper = {\r\n        aspectRatio: 1,\r\n        preview: $preview.selector,\r\n        background: false,\r\n        guides: false\r\n    };\r\n    var upload = $.extend(true, defaultUpload, uploadOptions);\r\n    var copper = $.extend(true, defaultCropper, cropperOptions);\r\n    preview(upload, copper, fn);\r\n\r\n    submit();\r\n\r\n    return {\r\n        webUpLoader: $webUpLoader, //webuploader实例对象\r\n\r\n        cropper: $cropImg //cropper实例对象\r\n    }\r\n}\r\n\r\nvar destroy = function(callback) {\r\n    callback = callback || function() {};\r\n    callback.call(null, {\r\n        webUpLoader: $webUpLoader, //webuploader实例对象\r\n        cropper: $cropImg //cropper实例对象\r\n    });\r\n    files = undefined;\r\n    $webUpLoader.destroy();\r\n    $cropImg.cropper('destroy');\r\n}\r\n\r\nvar getData = function() {\r\n    return link;\r\n}\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    getData: getData,\r\n    destroy: destroy\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/cropper.js","/*! WebUploader 0.1.5 */\n\n\n/**\n * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n *\n * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n */\n(function( root, factory ) {\n    var modules = {},\n\n        // 内部require, 简单不完全实现。\n        // https://github.com/amdjs/amdjs-api/wiki/require\n        _require = function( deps, callback ) {\n            var args, len, i;\n\n            // 如果deps不是数组，则直接返回指定module\n            if ( typeof deps === 'string' ) {\n                return getModule( deps );\n            } else {\n                args = [];\n                for( len = deps.length, i = 0; i < len; i++ ) {\n                    args.push( getModule( deps[ i ] ) );\n                }\n\n                return callback.apply( null, args );\n            }\n        },\n\n        // 内部define，暂时不支持不指定id.\n        _define = function( id, deps, factory ) {\n            if ( arguments.length === 2 ) {\n                factory = deps;\n                deps = null;\n            }\n\n            _require( deps || [], function() {\n                setModule( id, factory, arguments );\n            });\n        },\n\n        // 设置module, 兼容CommonJs写法。\n        setModule = function( id, factory, args ) {\n            var module = {\n                    exports: factory\n                },\n                returned;\n\n            if ( typeof factory === 'function' ) {\n                args.length || (args = [ _require, module.exports, module ,window.jQuery]);\n                returned = factory.apply( null, args );\n                returned !== undefined && (module.exports = returned);\n            }\n\n            modules[ id ] = module.exports;\n        },\n\n        // 根据id获取module\n        getModule = function( id ) {\n            var module = modules[ id ] || root[ id ];\n\n            if ( !module ) {\n                throw new Error( '`' + id + '` is undefined' );\n            }\n\n            return module;\n        },\n\n        // 将所有modules，将路径ids装换成对象。\n        exportsTo = function( obj ) {\n            var key, host, parts, part, last, ucFirst;\n\n            // make the first character upper case.\n            ucFirst = function( str ) {\n                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n            };\n\n            for ( key in modules ) {\n                host = obj;\n\n                if ( !modules.hasOwnProperty( key ) ) {\n                    continue;\n                }\n\n                parts = key.split('/');\n                last = ucFirst( parts.pop() );\n\n                while( (part = ucFirst( parts.shift() )) ) {\n                    host[ part ] = host[ part ] || {};\n                    host = host[ part ];\n                }\n\n                host[ last ] = modules[ key ];\n            }\n\n            return obj;\n        },\n\n        makeExport = function( dollar ) {\n            root.__dollar = dollar;\n\n            // exports every module.\n            return exportsTo( factory( root, _define, _require,window.jQuery ) );\n        },\n\n        origin;\n\n    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\n        // For CommonJS and CommonJS-like environments where a proper window is present,\n        module.exports = makeExport();\n    } else if ( typeof define === 'function' && define.amd ) {\n\n        // Allow using this built library as an AMD module\n        // in another project. That other project will only\n        // see this AMD call, not the internal modules in\n        // the closure below.\n        define([ 'jquery' ], makeExport );\n    } else {\n\n        // Browser globals case. Just assign the\n        // result to a property on the global.\n        origin = root.WebUploader;\n        root.WebUploader = makeExport();\n        root.WebUploader.noConflict = function() {\n            root.WebUploader = origin;\n        };\n    }\n})( window, function( window, define, require ,jQuery ) {\n\n\n    /**\n     * @fileOverview jQuery or Zepto\n     */\n    define('dollar-third',[],function() {\n        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n\n        if ( !$ ) {\n            throw new Error('jQuery or Zepto not found!');\n        }\n\n        return $;\n    });\n    /**\n     * @fileOverview Dom 操作相关\n     */\n    define('dollar',[\n        'dollar-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 使用jQuery的Promise\n     */\n    define('promise-third',[\n        'dollar'\n    ], function( $ ) {\n        return {\n            Deferred: $.Deferred,\n            when: $.when,\n\n            isPromise: function( anything ) {\n                return anything && typeof anything.then === 'function';\n            }\n        };\n    });\n    /**\n     * @fileOverview Promise/A+\n     */\n    define('promise',[\n        'promise-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 基础类方法。\n     */\n\n    /**\n     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n     *\n     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n     *\n     * * module `base`：WebUploader.Base\n     * * module `file`: WebUploader.File\n     * * module `lib/dnd`: WebUploader.Lib.Dnd\n     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n     *\n     *\n     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n     * @module WebUploader\n     * @title WebUploader API文档\n     */\n    define('base',[\n        'dollar',\n        'promise'\n    ], function( $, promise ) {\n\n        var noop = function() {},\n            call = Function.call;\n\n        // http://jsperf.com/uncurrythis\n        // 反科里化\n        function uncurryThis( fn ) {\n            return function() {\n                return call.apply( fn, arguments );\n            };\n        }\n\n        function bindFn( fn, context ) {\n            return function() {\n                return fn.apply( context, arguments );\n            };\n        }\n\n        function createObject( proto ) {\n            var f;\n\n            if ( Object.create ) {\n                return Object.create( proto );\n            } else {\n                f = function() {};\n                f.prototype = proto;\n                return new f();\n            }\n        }\n\n\n        /**\n         * 基础类，提供一些简单常用的方法。\n         * @class Base\n         */\n        return {\n\n            /**\n             * @property {String} version 当前版本号。\n             */\n            version: '0.1.5',\n\n            /**\n             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n             */\n            $: $,\n\n            Deferred: promise.Deferred,\n\n            isPromise: promise.isPromise,\n\n            when: promise.when,\n\n            /**\n             * @description  简单的浏览器检查结果。\n             *\n             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n             *\n             * @property {Object} [browser]\n             */\n            browser: (function( ua ) {\n                var ret = {},\n                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n                        ua.match( /CriOS\\/([\\d.]+)/ ),\n\n                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n\n                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n\n                return ret;\n            })( navigator.userAgent ),\n\n            /**\n             * @description  操作系统检查结果。\n             *\n             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n             * @property {Object} [os]\n             */\n            os: (function( ua ) {\n                var ret = {},\n\n                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n\n                // osx && (ret.osx = true);\n                android && (ret.android = parseFloat( android[ 1 ] ));\n                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n\n                return ret;\n            })( navigator.userAgent ),\n\n            /**\n             * 实现类与类之间的继承。\n             * @method inherits\n             * @grammar Base.inherits( super ) => child\n             * @grammar Base.inherits( super, protos ) => child\n             * @grammar Base.inherits( super, protos, statics ) => child\n             * @param  {Class} super 父类\n             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n             * @param  {Object} [statics] 静态属性或方法。\n             * @return {Class} 返回子类。\n             * @example\n             * function Person() {\n             *     console.log( 'Super' );\n             * }\n             * Person.prototype.hello = function() {\n             *     console.log( 'hello' );\n             * };\n             *\n             * var Manager = Base.inherits( Person, {\n             *     world: function() {\n             *         console.log( 'World' );\n             *     }\n             * });\n             *\n             * // 因为没有指定构造器，父类的构造器将会执行。\n             * var instance = new Manager();    // => Super\n             *\n             * // 继承子父类的方法\n             * instance.hello();    // => hello\n             * instance.world();    // => World\n             *\n             * // 子类的__super__属性指向父类\n             * console.log( Manager.__super__ === Person );    // => true\n             */\n            inherits: function( Super, protos, staticProtos ) {\n                var child;\n\n                if ( typeof protos === 'function' ) {\n                    child = protos;\n                    protos = null;\n                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n                    child = protos.constructor;\n                } else {\n                    child = function() {\n                        return Super.apply( this, arguments );\n                    };\n                }\n\n                // 复制静态方法\n                $.extend( true, child, Super, staticProtos || {} );\n\n                /* jshint camelcase: false */\n\n                // 让子类的__super__属性指向父类。\n                child.__super__ = Super.prototype;\n\n                // 构建原型，添加原型方法或属性。\n                // 暂时用Object.create实现。\n                child.prototype = createObject( Super.prototype );\n                protos && $.extend( true, child.prototype, protos );\n\n                return child;\n            },\n\n            /**\n             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n             * @method noop\n             */\n            noop: noop,\n\n            /**\n             * 返回一个新的方法，此方法将已指定的`context`来执行。\n             * @grammar Base.bindFn( fn, context ) => Function\n             * @method bindFn\n             * @example\n             * var doSomething = function() {\n             *         console.log( this.name );\n             *     },\n             *     obj = {\n             *         name: 'Object Name'\n             *     },\n             *     aliasFn = Base.bind( doSomething, obj );\n             *\n             *  aliasFn();    // => Object Name\n             *\n             */\n            bindFn: bindFn,\n\n            /**\n             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n             * @grammar Base.log( args... ) => undefined\n             * @method log\n             */\n            log: (function() {\n                if ( window.console ) {\n                    return bindFn( console.log, console );\n                }\n                return noop;\n            })(),\n\n            nextTick: (function() {\n\n                return function( cb ) {\n                    setTimeout( cb, 1 );\n                };\n\n                // @bug 当浏览器不在当前窗口时就停了。\n                // var next = window.requestAnimationFrame ||\n                //     window.webkitRequestAnimationFrame ||\n                //     window.mozRequestAnimationFrame ||\n                //     function( cb ) {\n                //         window.setTimeout( cb, 1000 / 60 );\n                //     };\n\n                // // fix: Uncaught TypeError: Illegal invocation\n                // return bindFn( next, window );\n            })(),\n\n            /**\n             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n             * 将用来将非数组对象转化成数组对象。\n             * @grammar Base.slice( target, start[, end] ) => Array\n             * @method slice\n             * @example\n             * function doSomthing() {\n             *     var args = Base.slice( arguments, 1 );\n             *     console.log( args );\n             * }\n             *\n             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n             */\n            slice: uncurryThis( [].slice ),\n\n            /**\n             * 生成唯一的ID\n             * @method guid\n             * @grammar Base.guid() => String\n             * @grammar Base.guid( prefx ) => String\n             */\n            guid: (function() {\n                var counter = 0;\n\n                return function( prefix ) {\n                    var guid = (+new Date()).toString( 32 ),\n                        i = 0;\n\n                    for ( ; i < 5; i++ ) {\n                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n                    }\n\n                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n                };\n            })(),\n\n            /**\n             * 格式化文件大小, 输出成带单位的字符串\n             * @method formatSize\n             * @grammar Base.formatSize( size ) => String\n             * @grammar Base.formatSize( size, pointLength ) => String\n             * @grammar Base.formatSize( size, pointLength, units ) => String\n             * @param {Number} size 文件大小\n             * @param {Number} [pointLength=2] 精确到的小数点数。\n             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n             * @example\n             * console.log( Base.formatSize( 100 ) );    // => 100B\n             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n             */\n            formatSize: function( size, pointLength, units ) {\n                var unit;\n\n                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n\n                while ( (unit = units.shift()) && size > 1024 ) {\n                    size = size / 1024;\n                }\n\n                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n                        unit;\n            }\n        };\n    });\n    /**\n     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n     * @fileOverview Mediator\n     */\n    define('mediator',[\n        'base'\n    ], function( Base ) {\n        var $ = Base.$,\n            slice = [].slice,\n            separator = /\\s+/,\n            protos;\n\n        // 根据条件过滤出事件handlers.\n        function findHandlers( arr, name, callback, context ) {\n            return $.grep( arr, function( handler ) {\n                return handler &&\n                        (!name || handler.e === name) &&\n                        (!callback || handler.cb === callback ||\n                        handler.cb._cb === callback) &&\n                        (!context || handler.ctx === context);\n            });\n        }\n\n        function eachEvent( events, callback, iterator ) {\n            // 不支持对象，只支持多个event用空格隔开\n            $.each( (events || '').split( separator ), function( _, key ) {\n                iterator( key, callback );\n            });\n        }\n\n        function triggerHanders( events, args ) {\n            var stoped = false,\n                i = -1,\n                len = events.length,\n                handler;\n\n            while ( ++i < len ) {\n                handler = events[ i ];\n\n                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n                    stoped = true;\n                    break;\n                }\n            }\n\n            return !stoped;\n        }\n\n        protos = {\n\n            /**\n             * 绑定事件。\n             *\n             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n             * ```javascript\n             * var obj = {};\n             *\n             * // 使得obj有事件行为\n             * Mediator.installTo( obj );\n             *\n             * obj.on( 'testa', function( arg1, arg2 ) {\n             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n             * });\n             *\n             * obj.trigger( 'testa', 'arg1', 'arg2' );\n             * ```\n             *\n             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n             * 切会影响到`trigger`方法的返回值，为`false`。\n             *\n             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n             * ```javascript\n             * obj.on( 'all', function( type, arg1, arg2 ) {\n             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n             * });\n             * ```\n             *\n             * @method on\n             * @grammar on( name, callback[, context] ) => self\n             * @param  {String}   name     事件名，支持多个事件用空格隔开\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             * @class Mediator\n             */\n            on: function( name, callback, context ) {\n                var me = this,\n                    set;\n\n                if ( !callback ) {\n                    return this;\n                }\n\n                set = this._events || (this._events = []);\n\n                eachEvent( name, callback, function( name, callback ) {\n                    var handler = { e: name };\n\n                    handler.cb = callback;\n                    handler.ctx = context;\n                    handler.ctx2 = context || me;\n                    handler.id = set.length;\n\n                    set.push( handler );\n                });\n\n                return this;\n            },\n\n            /**\n             * 绑定事件，且当handler执行完后，自动解除绑定。\n             * @method once\n             * @grammar once( name, callback[, context] ) => self\n             * @param  {String}   name     事件名\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            once: function( name, callback, context ) {\n                var me = this;\n\n                if ( !callback ) {\n                    return me;\n                }\n\n                eachEvent( name, callback, function( name, callback ) {\n                    var once = function() {\n                            me.off( name, once );\n                            return callback.apply( context || me, arguments );\n                        };\n\n                    once._cb = callback;\n                    me.on( name, once, context );\n                });\n\n                return me;\n            },\n\n            /**\n             * 解除事件绑定\n             * @method off\n             * @grammar off( [name[, callback[, context] ] ] ) => self\n             * @param  {String}   [name]     事件名\n             * @param  {Function} [callback] 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            off: function( name, cb, ctx ) {\n                var events = this._events;\n\n                if ( !events ) {\n                    return this;\n                }\n\n                if ( !name && !cb && !ctx ) {\n                    this._events = [];\n                    return this;\n                }\n\n                eachEvent( name, cb, function( name, cb ) {\n                    $.each( findHandlers( events, name, cb, ctx ), function() {\n                        delete events[ this.id ];\n                    });\n                });\n\n                return this;\n            },\n\n            /**\n             * 触发事件\n             * @method trigger\n             * @grammar trigger( name[, args...] ) => self\n             * @param  {String}   type     事件名\n             * @param  {*} [...] 任意参数\n             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n             */\n            trigger: function( type ) {\n                var args, events, allEvents;\n\n                if ( !this._events || !type ) {\n                    return this;\n                }\n\n                args = slice.call( arguments, 1 );\n                events = findHandlers( this._events, type );\n                allEvents = findHandlers( this._events, 'all' );\n\n                return triggerHanders( events, args ) &&\n                        triggerHanders( allEvents, arguments );\n            }\n        };\n\n        /**\n         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n         *\n         * @class Mediator\n         */\n        return $.extend({\n\n            /**\n             * 可以通过这个接口，使任何对象具备事件功能。\n             * @method installTo\n             * @param  {Object} obj 需要具备事件行为的对象。\n             * @return {Object} 返回obj.\n             */\n            installTo: function( obj ) {\n                return $.extend( obj, protos );\n            }\n\n        }, protos );\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('uploader',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$;\n\n        /**\n         * 上传入口类。\n         * @class Uploader\n         * @constructor\n         * @grammar new Uploader( opts ) => Uploader\n         * @example\n         * var uploader = WebUploader.Uploader({\n         *     swf: 'path_of_swf/Uploader.swf',\n         *\n         *     // 开起分片上传。\n         *     chunked: true\n         * });\n         */\n        function Uploader( opts ) {\n            this.options = $.extend( true, {}, Uploader.options, opts );\n            this._init( this.options );\n        }\n\n        // default Options\n        // widgets中有相应扩展\n        Uploader.options = {};\n        Mediator.installTo( Uploader.prototype );\n\n        // 批量添加纯命令式方法。\n        $.each({\n            upload: 'start-upload',\n            stop: 'stop-upload',\n            getFile: 'get-file',\n            getFiles: 'get-files',\n            addFile: 'add-file',\n            addFiles: 'add-file',\n            sort: 'sort-files',\n            removeFile: 'remove-file',\n            cancelFile: 'cancel-file',\n            skipFile: 'skip-file',\n            retry: 'retry',\n            isInProgress: 'is-in-progress',\n            makeThumb: 'make-thumb',\n            md5File: 'md5-file',\n            getDimension: 'get-dimension',\n            addButton: 'add-btn',\n            predictRuntimeType: 'predict-runtime-type',\n            refresh: 'refresh',\n            disable: 'disable',\n            enable: 'enable',\n            reset: 'reset'\n        }, function( fn, command ) {\n            Uploader.prototype[ fn ] = function() {\n                return this.request( command, arguments );\n            };\n        });\n\n        $.extend( Uploader.prototype, {\n            state: 'pending',\n\n            _init: function( opts ) {\n                var me = this;\n\n                me.request( 'init', opts, function() {\n                    me.state = 'ready';\n                    me.trigger('ready');\n                });\n            },\n\n            /**\n             * 获取或者设置Uploader配置项。\n             * @method option\n             * @grammar option( key ) => *\n             * @grammar option( key, val ) => self\n             * @example\n             *\n             * // 初始状态图片上传前不会压缩\n             * var uploader = new WebUploader.Uploader({\n             *     compress: null;\n             * });\n             *\n             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n             * uploader.option( 'compress', {\n             *     width: 1600,\n             *     height: 1600\n             * });\n             */\n            option: function( key, val ) {\n                var opts = this.options;\n\n                // setter\n                if ( arguments.length > 1 ) {\n\n                    if ( $.isPlainObject( val ) &&\n                            $.isPlainObject( opts[ key ] ) ) {\n                        $.extend( opts[ key ], val );\n                    } else {\n                        opts[ key ] = val;\n                    }\n\n                } else {    // getter\n                    return key ? opts[ key ] : opts;\n                }\n            },\n\n            /**\n             * 获取文件统计信息。返回一个包含一下信息的对象。\n             * * `successNum` 上传成功的文件数\n             * * `progressNum` 上传中的文件数\n             * * `cancelNum` 被删除的文件数\n             * * `invalidNum` 无效的文件数\n             * * `uploadFailNum` 上传失败的文件数\n             * * `queueNum` 还在队列中的文件数\n             * * `interruptNum` 被暂停的文件数\n             * @method getStats\n             * @grammar getStats() => Object\n             */\n            getStats: function() {\n                // return this._mgr.getStats.apply( this._mgr, arguments );\n                var stats = this.request('get-stats');\n\n                return stats ? {\n                    successNum: stats.numOfSuccess,\n                    progressNum: stats.numOfProgress,\n\n                    // who care?\n                    // queueFailNum: 0,\n                    cancelNum: stats.numOfCancel,\n                    invalidNum: stats.numOfInvalid,\n                    uploadFailNum: stats.numOfUploadFailed,\n                    queueNum: stats.numOfQueue,\n                    interruptNum: stats.numofInterrupt\n                } : {};\n            },\n\n            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n            trigger: function( type/*, args...*/ ) {\n                var args = [].slice.call( arguments, 1 ),\n                    opts = this.options,\n                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n                        type.substring( 1 );\n\n                if (\n                        // 调用通过on方法注册的handler.\n                        Mediator.trigger.apply( this, arguments ) === false ||\n\n                        // 调用opts.onEvent\n                        $.isFunction( opts[ name ] ) &&\n                        opts[ name ].apply( this, args ) === false ||\n\n                        // 调用this.onEvent\n                        $.isFunction( this[ name ] ) &&\n                        this[ name ].apply( this, args ) === false ||\n\n                        // 广播所有uploader的事件。\n                        Mediator.trigger.apply( Mediator,\n                        [ this, type ].concat( args ) ) === false ) {\n\n                    return false;\n                }\n\n                return true;\n            },\n\n            /**\n             * 销毁 webuploader 实例\n             * @method destroy\n             * @grammar destroy() => undefined\n             */\n            destroy: function() {\n                this.request( 'destroy', arguments );\n                this.off();\n            },\n\n            // widgets/widget.js将补充此方法的详细文档。\n            request: Base.noop\n        });\n\n        /**\n         * 创建Uploader实例，等同于new Uploader( opts );\n         * @method create\n         * @class Base\n         * @static\n         * @grammar Base.create( opts ) => Uploader\n         */\n        Base.create = Uploader.create = function( opts ) {\n            return new Uploader( opts );\n        };\n\n        // 暴露Uploader，可以通过它来扩展业务逻辑。\n        Base.Uploader = Uploader;\n\n        return Uploader;\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/runtime',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$,\n            factories = {},\n\n            // 获取对象的第一个key\n            getFirstKey = function( obj ) {\n                for ( var key in obj ) {\n                    if ( obj.hasOwnProperty( key ) ) {\n                        return key;\n                    }\n                }\n                return null;\n            };\n\n        // 接口类。\n        function Runtime( options ) {\n            this.options = $.extend({\n                container: document.body\n            }, options );\n            this.uid = Base.guid('rt_');\n        }\n\n        $.extend( Runtime.prototype, {\n\n            getContainer: function() {\n                var opts = this.options,\n                    parent, container;\n\n                if ( this._container ) {\n                    return this._container;\n                }\n\n                parent = $( opts.container || document.body );\n                container = $( document.createElement('div') );\n\n                container.attr( 'id', 'rt_' + this.uid );\n                container.css({\n                    position: 'absolute',\n                    top: '0px',\n                    left: '0px',\n                    width: '1px',\n                    height: '1px',\n                    overflow: 'hidden'\n                });\n\n                parent.append( container );\n                parent.addClass('webuploader-container');\n                this._container = container;\n                this._parent = parent;\n                return container;\n            },\n\n            init: Base.noop,\n            exec: Base.noop,\n\n            destroy: function() {\n                this._container && this._container.remove();\n                this._parent && this._parent.removeClass('webuploader-container');\n                this.off();\n            }\n        });\n\n        Runtime.orders = 'html5,flash';\n\n\n        /**\n         * 添加Runtime实现。\n         * @param {String} type    类型\n         * @param {Runtime} factory 具体Runtime实现。\n         */\n        Runtime.addRuntime = function( type, factory ) {\n            factories[ type ] = factory;\n        };\n\n        Runtime.hasRuntime = function( type ) {\n            return !!(type ? factories[ type ] : getFirstKey( factories ));\n        };\n\n        Runtime.create = function( opts, orders ) {\n            var type, runtime;\n\n            orders = orders || Runtime.orders;\n            $.each( orders.split( /\\s*,\\s*/g ), function() {\n                if ( factories[ this ] ) {\n                    type = this;\n                    return false;\n                }\n            });\n\n            type = type || getFirstKey( factories );\n            if ( !type ) {\n                throw new Error('Runtime Error');\n            }\n\n            runtime = new factories[ type ]( opts );\n            return runtime;\n        };\n\n        Mediator.installTo( Runtime.prototype );\n        return Runtime;\n    });\n\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/client',[\n        'base',\n        'mediator',\n        'runtime/runtime'\n    ], function( Base, Mediator, Runtime ) {\n\n        var cache;\n\n        cache = (function() {\n            var obj = {};\n\n            return {\n                add: function( runtime ) {\n                    obj[ runtime.uid ] = runtime;\n                },\n\n                get: function( ruid, standalone ) {\n                    var i;\n\n                    if ( ruid ) {\n                        return obj[ ruid ];\n                    }\n\n                    for ( i in obj ) {\n                        // 有些类型不能重用，比如filepicker.\n                        if ( standalone && obj[ i ].__standalone ) {\n                            continue;\n                        }\n\n                        return obj[ i ];\n                    }\n\n                    return null;\n                },\n\n                remove: function( runtime ) {\n                    delete obj[ runtime.uid ];\n                }\n            };\n        })();\n\n        function RuntimeClient( component, standalone ) {\n            var deferred = Base.Deferred(),\n                runtime;\n\n            this.uid = Base.guid('client_');\n\n            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n            this.runtimeReady = function( cb ) {\n                return deferred.done( cb );\n            };\n\n            this.connectRuntime = function( opts, cb ) {\n\n                // already connected.\n                if ( runtime ) {\n                    throw new Error('already connected!');\n                }\n\n                deferred.done( cb );\n\n                if ( typeof opts === 'string' && cache.get( opts ) ) {\n                    runtime = cache.get( opts );\n                }\n\n                // 像filePicker只能独立存在，不能公用。\n                runtime = runtime || cache.get( null, standalone );\n\n                // 需要创建\n                if ( !runtime ) {\n                    runtime = Runtime.create( opts, opts.runtimeOrder );\n                    runtime.__promise = deferred.promise();\n                    runtime.once( 'ready', deferred.resolve );\n                    runtime.init();\n                    cache.add( runtime );\n                    runtime.__client = 1;\n                } else {\n                    // 来自cache\n                    Base.$.extend( runtime.options, opts );\n                    runtime.__promise.then( deferred.resolve );\n                    runtime.__client++;\n                }\n\n                standalone && (runtime.__standalone = standalone);\n                return runtime;\n            };\n\n            this.getRuntime = function() {\n                return runtime;\n            };\n\n            this.disconnectRuntime = function() {\n                if ( !runtime ) {\n                    return;\n                }\n\n                runtime.__client--;\n\n                if ( runtime.__client <= 0 ) {\n                    cache.remove( runtime );\n                    delete runtime.__promise;\n                    runtime.destroy();\n                }\n\n                runtime = null;\n            };\n\n            this.exec = function() {\n                if ( !runtime ) {\n                    return;\n                }\n\n                var args = Base.slice( arguments );\n                component && args.unshift( component );\n\n                return runtime.exec.apply( this, args );\n            };\n\n            this.getRuid = function() {\n                return runtime && runtime.uid;\n            };\n\n            this.destroy = (function( destroy ) {\n                return function() {\n                    destroy && destroy.apply( this, arguments );\n                    this.trigger('destroy');\n                    this.off();\n                    this.exec('destroy');\n                    this.disconnectRuntime();\n                };\n            })( this.destroy );\n        }\n\n        Mediator.installTo( RuntimeClient.prototype );\n        return RuntimeClient;\n    });\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/dnd',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n\n        var $ = Base.$;\n\n        function DragAndDrop( opts ) {\n            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n\n            opts.container = $( opts.container );\n\n            if ( !opts.container.length ) {\n                return;\n            }\n\n            RuntimeClent.call( this, 'DragAndDrop' );\n        }\n\n        DragAndDrop.options = {\n            accept: null,\n            disableGlobalDnd: false\n        };\n\n        Base.inherits( RuntimeClent, {\n            constructor: DragAndDrop,\n\n            init: function() {\n                var me = this;\n\n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n\n        Mediator.installTo( DragAndDrop.prototype );\n\n        return DragAndDrop;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/widget',[\n        'base',\n        'uploader'\n    ], function( Base, Uploader ) {\n\n        var $ = Base.$,\n            _init = Uploader.prototype._init,\n            _destroy = Uploader.prototype.destroy,\n            IGNORE = {},\n            widgetClass = [];\n\n        function isArrayLike( obj ) {\n            if ( !obj ) {\n                return false;\n            }\n\n            var length = obj.length,\n                type = $.type( obj );\n\n            if ( obj.nodeType === 1 && length ) {\n                return true;\n            }\n\n            return type === 'array' || type !== 'function' && type !== 'string' &&\n                    (length === 0 || typeof length === 'number' && length > 0 &&\n                    (length - 1) in obj);\n        }\n\n        function Widget( uploader ) {\n            this.owner = uploader;\n            this.options = uploader.options;\n        }\n\n        $.extend( Widget.prototype, {\n\n            init: Base.noop,\n\n            // 类Backbone的事件监听声明，监听uploader实例上的事件\n            // widget直接无法监听事件，事件只能通过uploader来传递\n            invoke: function( apiName, args ) {\n\n                /*\n                    {\n                        'make-thumb': 'makeThumb'\n                    }\n                 */\n                var map = this.responseMap;\n\n                // 如果无API响应声明则忽略\n                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n\n                    return IGNORE;\n                }\n\n                return this[ map[ apiName ] ].apply( this, args );\n\n            },\n\n            /**\n             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n             * @method request\n             * @grammar request( command, args ) => * | Promise\n             * @grammar request( command, args, callback ) => Promise\n             * @for  Uploader\n             */\n            request: function() {\n                return this.owner.request.apply( this.owner, arguments );\n            }\n        });\n\n        // 扩展Uploader.\n        $.extend( Uploader.prototype, {\n\n            /**\n             * @property {String | Array} [disableWidgets=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n             */\n\n            // 覆写_init用来初始化widgets\n            _init: function() {\n                var me = this,\n                    widgets = me._widgets = [],\n                    deactives = me.options.disableWidgets || '';\n\n                $.each( widgetClass, function( _, klass ) {\n                    (!deactives || !~deactives.indexOf( klass._name )) &&\n                        widgets.push( new klass( me ) );\n                });\n\n                return _init.apply( me, arguments );\n            },\n\n            request: function( apiName, args, callback ) {\n                var i = 0,\n                    widgets = this._widgets,\n                    len = widgets && widgets.length,\n                    rlts = [],\n                    dfds = [],\n                    widget, rlt, promise, key;\n\n                args = isArrayLike( args ) ? args : [ args ];\n\n                for ( ; i < len; i++ ) {\n                    widget = widgets[ i ];\n                    rlt = widget.invoke( apiName, args );\n\n                    if ( rlt !== IGNORE ) {\n\n                        // Deferred对象\n                        if ( Base.isPromise( rlt ) ) {\n                            dfds.push( rlt );\n                        } else {\n                            rlts.push( rlt );\n                        }\n                    }\n                }\n\n                // 如果有callback，则用异步方式。\n                if ( callback || dfds.length ) {\n                    promise = Base.when.apply( Base, dfds );\n                    key = promise.pipe ? 'pipe' : 'then';\n\n                    // 很重要不能删除。删除了会死循环。\n                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n                    return promise[ key ](function() {\n                                var deferred = Base.Deferred(),\n                                    args = arguments;\n\n                                if ( args.length === 1 ) {\n                                    args = args[ 0 ];\n                                }\n\n                                setTimeout(function() {\n                                    deferred.resolve( args );\n                                }, 1 );\n\n                                return deferred.promise();\n                            })[ callback ? key : 'done' ]( callback || Base.noop );\n                } else {\n                    return rlts[ 0 ];\n                }\n            },\n\n            destroy: function() {\n                _destroy.apply( this, arguments );\n                this._widgets = null;\n            }\n        });\n\n        /**\n         * 添加组件\n         * @grammar Uploader.register(proto);\n         * @grammar Uploader.register(map, proto);\n         * @param  {object} responseMap API 名称与函数实现的映射\n         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n         * @method Uploader.register\n         * @for Uploader\n         * @example\n         * Uploader.register({\n         *     'make-thumb': 'makeThumb'\n         * }, {\n         *     init: function( options ) {},\n         *     makeThumb: function() {}\n         * });\n         *\n         * Uploader.register({\n         *     'make-thumb': function() {\n         *\n         *     }\n         * });\n         */\n        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n                klass;\n\n            if ( arguments.length === 1 ) {\n                widgetProto = responseMap;\n\n                // 自动生成 map 表。\n                $.each(widgetProto, function(key) {\n                    if ( key[0] === '_' || key === 'name' ) {\n                        key === 'name' && (map.name = widgetProto.name);\n                        return;\n                    }\n\n                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n                });\n\n            } else {\n                map = $.extend( map, responseMap );\n            }\n\n            widgetProto.responseMap = map;\n            klass = Base.inherits( Widget, widgetProto );\n            klass._name = map.name;\n            widgetClass.push( klass );\n\n            return klass;\n        };\n\n        /**\n         * 删除插件，只有在注册时指定了名字的才能被删除。\n         * @grammar Uploader.unRegister(name);\n         * @param  {string} name 组件名字\n         * @method Uploader.unRegister\n         * @for Uploader\n         * @example\n         *\n         * Uploader.register({\n         *     name: 'custom',\n         *\n         *     'make-thumb': function() {\n         *\n         *     }\n         * });\n         *\n         * Uploader.unRegister('custom');\n         */\n        Uploader.unRegister = Widget.unRegister = function( name ) {\n            if ( !name || name === 'anonymous' ) {\n                return;\n            }\n\n            // 删除指定的插件。\n            for ( var i = widgetClass.length; i--; ) {\n                if ( widgetClass[i]._name === name ) {\n                    widgetClass.splice(i, 1)\n                }\n            }\n        };\n\n        return Widget;\n    });\n    /**\n     * @fileOverview DragAndDrop Widget。\n     */\n    define('widgets/filednd',[\n        'base',\n        'uploader',\n        'lib/dnd',\n        'widgets/widget'\n    ], function( Base, Uploader, Dnd ) {\n        var $ = Base.$;\n\n        Uploader.options.dnd = '';\n\n        /**\n         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n         * @namespace options\n         * @for Uploader\n         */\n\n        /**\n         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n         * @namespace options\n         * @for Uploader\n         */\n\n        /**\n         * @event dndAccept\n         * @param {DataTransferItemList} items DataTransferItem\n         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n         * @for  Uploader\n         */\n        return Uploader.register({\n            name: 'dnd',\n\n            init: function( opts ) {\n\n                if ( !opts.dnd ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        disableGlobalDnd: opts.disableGlobalDnd,\n                        container: opts.dnd,\n                        accept: opts.accept\n                    }),\n                    dnd;\n\n                this.dnd = dnd = new Dnd( options );\n\n                dnd.once( 'ready', deferred.resolve );\n                dnd.on( 'drop', function( files ) {\n                    me.request( 'add-file', [ files ]);\n                });\n\n                // 检测文件是否全部允许添加。\n                dnd.on( 'accept', function( items ) {\n                    return me.owner.trigger( 'dndAccept', items );\n                });\n\n                dnd.init();\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                this.dnd && this.dnd.destroy();\n            }\n        });\n    });\n\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepaste',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n\n        var $ = Base.$;\n\n        function FilePaste( opts ) {\n            opts = this.options = $.extend({}, opts );\n            opts.container = $( opts.container || document.body );\n            RuntimeClent.call( this, 'FilePaste' );\n        }\n\n        Base.inherits( RuntimeClent, {\n            constructor: FilePaste,\n\n            init: function() {\n                var me = this;\n\n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n\n        Mediator.installTo( FilePaste.prototype );\n\n        return FilePaste;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/filepaste',[\n        'base',\n        'uploader',\n        'lib/filepaste',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePaste ) {\n        var $ = Base.$;\n\n        /**\n         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n         * @namespace options\n         * @for Uploader\n         */\n        return Uploader.register({\n            name: 'paste',\n\n            init: function( opts ) {\n\n                if ( !opts.paste ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        container: opts.paste,\n                        accept: opts.accept\n                    }),\n                    paste;\n\n                this.paste = paste = new FilePaste( options );\n\n                paste.once( 'ready', deferred.resolve );\n                paste.on( 'paste', function( files ) {\n                    me.owner.request( 'add-file', [ files ]);\n                });\n                paste.init();\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                this.paste && this.paste.destroy();\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob\n     */\n    define('lib/blob',[\n        'base',\n        'runtime/client'\n    ], function( Base, RuntimeClient ) {\n\n        function Blob( ruid, source ) {\n            var me = this;\n\n            me.source = source;\n            me.ruid = ruid;\n            this.size = source.size || 0;\n\n            // 如果没有指定 mimetype, 但是知道文件后缀。\n            if ( !source.type && this.ext &&\n                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n            } else {\n                this.type = source.type || 'application/octet-stream';\n            }\n\n            RuntimeClient.call( me, 'Blob' );\n            this.uid = source.uid || this.uid;\n\n            if ( ruid ) {\n                me.connectRuntime( ruid );\n            }\n        }\n\n        Base.inherits( RuntimeClient, {\n            constructor: Blob,\n\n            slice: function( start, end ) {\n                return this.exec( 'slice', start, end );\n            },\n\n            getSource: function() {\n                return this.source;\n            }\n        });\n\n        return Blob;\n    });\n    /**\n     * 为了统一化Flash的File和HTML5的File而存在。\n     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n     * @fileOverview File\n     */\n    define('lib/file',[\n        'base',\n        'lib/blob'\n    ], function( Base, Blob ) {\n\n        var uid = 1,\n            rExt = /\\.([^.]+)$/;\n\n        function File( ruid, file ) {\n            var ext;\n\n            this.name = file.name || ('untitled' + uid++);\n            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n\n            // todo 支持其他类型文件的转换。\n            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n            if ( !ext && file.type ) {\n                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n                        RegExp.$1.toLowerCase() : '';\n                this.name += '.' + ext;\n            }\n\n            this.ext = ext;\n            this.lastModifiedDate = file.lastModifiedDate ||\n                    (new Date()).toLocaleString();\n\n            Blob.apply( this, arguments );\n        }\n\n        return Base.inherits( Blob, File );\n    });\n\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepicker',[\n        'base',\n        'runtime/client',\n        'lib/file'\n    ], function( Base, RuntimeClent, File ) {\n\n        var $ = Base.$;\n\n        function FilePicker( opts ) {\n            opts = this.options = $.extend({}, FilePicker.options, opts );\n\n            opts.container = $( opts.id );\n\n            if ( !opts.container.length ) {\n                throw new Error('按钮指定错误');\n            }\n\n            opts.innerHTML = opts.innerHTML || opts.label ||\n                    opts.container.html() || '';\n\n            opts.button = $( opts.button || document.createElement('div') );\n            opts.button.html( opts.innerHTML );\n            opts.container.html( opts.button );\n\n            RuntimeClent.call( this, 'FilePicker', true );\n        }\n\n        FilePicker.options = {\n            button: null,\n            container: null,\n            label: null,\n            innerHTML: null,\n            multiple: true,\n            accept: null,\n            name: 'file'\n        };\n\n        Base.inherits( RuntimeClent, {\n            constructor: FilePicker,\n\n            init: function() {\n                var me = this,\n                    opts = me.options,\n                    button = opts.button;\n\n                button.addClass('webuploader-pick');\n\n                me.on( 'all', function( type ) {\n                    var files;\n\n                    switch ( type ) {\n                        case 'mouseenter':\n                            button.addClass('webuploader-pick-hover');\n                            break;\n\n                        case 'mouseleave':\n                            button.removeClass('webuploader-pick-hover');\n                            break;\n\n                        case 'change':\n                            files = me.exec('getFiles');\n                            me.trigger( 'select', $.map( files, function( file ) {\n                                file = new File( me.getRuid(), file );\n\n                                // 记录来源。\n                                file._refer = opts.container;\n                                return file;\n                            }), opts.container );\n                            break;\n                    }\n                });\n\n                me.connectRuntime( opts, function() {\n                    me.refresh();\n                    me.exec( 'init', opts );\n                    me.trigger('ready');\n                });\n\n                this._resizeHandler = Base.bindFn( this.refresh, this );\n                $( window ).on( 'resize', this._resizeHandler );\n            },\n\n            refresh: function() {\n                var shimContainer = this.getRuntime().getContainer(),\n                    button = this.options.button,\n                    width = button.outerWidth ?\n                            button.outerWidth() : button.width(),\n\n                    height = button.outerHeight ?\n                            button.outerHeight() : button.height(),\n\n                    pos = button.offset();\n\n                width && height && shimContainer.css({\n                    bottom: 'auto',\n                    right: 'auto',\n                    width: width + 'px',\n                    height: height + 'px'\n                }).offset( pos );\n            },\n\n            enable: function() {\n                var btn = this.options.button;\n\n                btn.removeClass('webuploader-pick-disable');\n                this.refresh();\n            },\n\n            disable: function() {\n                var btn = this.options.button;\n\n                this.getRuntime().getContainer().css({\n                    top: '-99999px'\n                });\n\n                btn.addClass('webuploader-pick-disable');\n            },\n\n            destroy: function() {\n                var btn = this.options.button;\n                $( window ).off( 'resize', this._resizeHandler );\n                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n                    'webuploader-pick');\n            }\n        });\n\n        return FilePicker;\n    });\n\n    /**\n     * @fileOverview 文件选择相关\n     */\n    define('widgets/filepicker',[\n        'base',\n        'uploader',\n        'lib/filepicker',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePicker ) {\n        var $ = Base.$;\n\n        $.extend( Uploader.options, {\n\n            /**\n             * @property {Selector | Object} [pick=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n             *\n             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n             * * `label` {String} 请采用 `innerHTML` 代替\n             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n             */\n            pick: null,\n\n            /**\n             * @property {Arroy} [accept=null]\n             * @namespace options\n             * @for Uploader\n             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n             *\n             * * `title` {String} 文字描述\n             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n             * * `mimeTypes` {String} 多个用逗号分割。\n             *\n             * 如：\n             *\n             * ```\n             * {\n             *     title: 'Images',\n             *     extensions: 'gif,jpg,jpeg,bmp,png',\n             *     mimeTypes: 'image/*'\n             * }\n             * ```\n             */\n            accept: null/*{\n                title: 'Images',\n                extensions: 'gif,jpg,jpeg,bmp,png',\n                mimeTypes: 'image/*'\n            }*/\n        });\n\n        return Uploader.register({\n            name: 'picker',\n\n            init: function( opts ) {\n                this.pickers = [];\n                return opts.pick && this.addBtn( opts.pick );\n            },\n\n            refresh: function() {\n                $.each( this.pickers, function() {\n                    this.refresh();\n                });\n            },\n\n            /**\n             * @method addButton\n             * @for Uploader\n             * @grammar addButton( pick ) => Promise\n             * @description\n             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n             * @example\n             * uploader.addButton({\n             *     id: '#btnContainer',\n             *     innerHTML: '选择文件'\n             * });\n             */\n            addBtn: function( pick ) {\n                var me = this,\n                    opts = me.options,\n                    accept = opts.accept,\n                    promises = [];\n\n                if ( !pick ) {\n                    return;\n                }\n\n                $.isPlainObject( pick ) || (pick = {\n                    id: pick\n                });\n\n                $( pick.id ).each(function() {\n                    var options, picker, deferred;\n\n                    deferred = Base.Deferred();\n\n                    options = $.extend({}, pick, {\n                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n                        swf: opts.swf,\n                        runtimeOrder: opts.runtimeOrder,\n                        id: this\n                    });\n\n                    picker = new FilePicker( options );\n\n                    picker.once( 'ready', deferred.resolve );\n                    picker.on( 'select', function( files ) {\n                        me.owner.request( 'add-file', [ files ]);\n                    });\n                    picker.init();\n\n                    me.pickers.push( picker );\n\n                    promises.push( deferred.promise() );\n                });\n\n                return Base.when.apply( Base, promises );\n            },\n\n            disable: function() {\n                $.each( this.pickers, function() {\n                    this.disable();\n                });\n            },\n\n            enable: function() {\n                $.each( this.pickers, function() {\n                    this.enable();\n                });\n            },\n\n            destroy: function() {\n                $.each( this.pickers, function() {\n                    this.destroy();\n                });\n                this.pickers = null;\n            }\n        });\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('lib/image',[\n        'base',\n        'runtime/client',\n        'lib/blob'\n    ], function( Base, RuntimeClient, Blob ) {\n        var $ = Base.$;\n\n        // 构造器。\n        function Image( opts ) {\n            this.options = $.extend({}, Image.options, opts );\n            RuntimeClient.call( this, 'Image' );\n\n            this.on( 'load', function() {\n                this._info = this.exec('info');\n                this._meta = this.exec('meta');\n            });\n        }\n\n        // 默认选项。\n        Image.options = {\n\n            // 默认的图片处理质量\n            quality: 90,\n\n            // 是否裁剪\n            crop: false,\n\n            // 是否保留头部信息\n            preserveHeaders: false,\n\n            // 是否允许放大。\n            allowMagnify: false\n        };\n\n        // 继承RuntimeClient.\n        Base.inherits( RuntimeClient, {\n            constructor: Image,\n\n            info: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n\n                // getter\n                return this._info;\n            },\n\n            meta: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n\n                // getter\n                return this._meta;\n            },\n\n            loadFromBlob: function( blob ) {\n                var me = this,\n                    ruid = blob.getRuid();\n\n                this.connectRuntime( ruid, function() {\n                    me.exec( 'init', me.options );\n                    me.exec( 'loadFromBlob', blob );\n                });\n            },\n\n            resize: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n            },\n\n            crop: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n            },\n\n            getAsDataUrl: function( type ) {\n                return this.exec( 'getAsDataUrl', type );\n            },\n\n            getAsBlob: function( type ) {\n                var blob = this.exec( 'getAsBlob', type );\n\n                return new Blob( this.getRuid(), blob );\n            }\n        });\n\n        return Image;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/image',[\n        'base',\n        'uploader',\n        'lib/image',\n        'widgets/widget'\n    ], function( Base, Uploader, Image ) {\n\n        var $ = Base.$,\n            throttle;\n\n        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n        throttle = (function( max ) {\n            var occupied = 0,\n                waiting = [],\n                tick = function() {\n                    var item;\n\n                    while ( waiting.length && occupied < max ) {\n                        item = waiting.shift();\n                        occupied += item[ 0 ];\n                        item[ 1 ]();\n                    }\n                };\n\n            return function( emiter, size, cb ) {\n                waiting.push([ size, cb ]);\n                emiter.once( 'destroy', function() {\n                    occupied -= size;\n                    setTimeout( tick, 1 );\n                });\n                setTimeout( tick, 1 );\n            };\n        })( 5 * 1024 * 1024 );\n\n        $.extend( Uploader.options, {\n\n            /**\n             * @property {Object} [thumb]\n             * @namespace options\n             * @for Uploader\n             * @description 配置生成缩略图的选项。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 110,\n             *     height: 110,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 70,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: true,\n             *\n             *     // 是否允许裁剪。\n             *     crop: true,\n             *\n             *     // 为空的话则保留原有图片格式。\n             *     // 否则强制转换成指定的类型。\n             *     type: 'image/jpeg'\n             * }\n             * ```\n             */\n            thumb: {\n                width: 110,\n                height: 110,\n                quality: 70,\n                allowMagnify: true,\n                crop: true,\n                preserveHeaders: false,\n\n                // 为空的话则保留原有图片格式。\n                // 否则强制转换成指定的类型。\n                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n                type: 'image/jpeg'\n            },\n\n            /**\n             * @property {Object} [compress]\n             * @namespace options\n             * @for Uploader\n             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 1600,\n             *     height: 1600,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 90,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: false,\n             *\n             *     // 是否允许裁剪。\n             *     crop: false,\n             *\n             *     // 是否保留头部meta信息。\n             *     preserveHeaders: true,\n             *\n             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n             *     // 此属性可能会影响图片自动纠正功能\n             *     noCompressIfLarger: false,\n             *\n             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n             *     compressSize: 0\n             * }\n             * ```\n             */\n            compress: {\n                width: 1600,\n                height: 1600,\n                quality: 90,\n                allowMagnify: false,\n                crop: false,\n                preserveHeaders: true\n            }\n        });\n\n        return Uploader.register({\n\n            name: 'image',\n\n\n            /**\n             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n             *\n             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n             *\n             * `callback`中可以接收到两个参数。\n             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n             * * 第二个为ret, 缩略图的Data URL值。\n             *\n             * **注意**\n             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n             *\n             * @method makeThumb\n             * @grammar makeThumb( file, callback ) => undefined\n             * @grammar makeThumb( file, callback, width, height ) => undefined\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.makeThumb( file, function( error, ret ) {\n             *         if ( error ) {\n             *             $li.text('预览错误');\n             *         } else {\n             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n             *         }\n             *     });\n             *\n             * });\n             */\n            makeThumb: function( file, cb, width, height ) {\n                var opts, image;\n                var isArtwork = false;\n                file = this.request( 'get-file', file );\n\n                // 只预览图片格式。\n                if ( !file.type.match( /^image/ ) ) {\n                    cb( true );\n                    return;\n                }\n\n                opts = $.extend({}, this.options.thumb );\n                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n                // 如果传入的是object.\n                if ( $.isPlainObject( width ) ) {\n                    opts = $.extend( opts, width );\n                    width = null;\n                }\n\n                width = width || opts.width;\n                height = height || opts.height;\n\n                image = new Image( opts );\n\n                image.once( 'load', function() {\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n\n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n\n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n                    if( isArtwork ){\n                        image.resize( file._info.width, file._info.height );\n\n                    }else{\n                        image.resize( width, height );\n\n\n                    }\n\n                });\n\n                // 当 resize 完后\n                image.once( 'complete', function() {\n                    cb( false, image.getAsDataUrl( opts.type ) );\n                    image.destroy();\n                });\n\n                image.once( 'error', function( reason ) {\n                    cb( reason || true );\n                    image.destroy();\n                });\n\n                throttle( image, file.source.size, function() {\n                    file._info && image.info( file._info );\n                    file._meta && image.meta( file._meta );\n                    image.loadFromBlob( file.source );\n                });\n            },\n\n            beforeSendFile: function( file ) {\n                var opts = this.options.compress || this.options.resize,\n                    compressSize = opts && opts.compressSize || 0,\n                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n                    image, deferred;\n\n                file = this.request( 'get-file', file );\n\n                // 只压缩 jpeg 图片格式。\n                // gif 可能会丢失针\n                // bmp png 基本上尺寸都不大，且压缩比比较小。\n                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n                        file.size < compressSize ||\n                        file._compressed ) {\n                    return;\n                }\n\n                opts = $.extend({}, opts );\n                deferred = Base.Deferred();\n\n                image = new Image( opts );\n\n                deferred.always(function() {\n                    image.destroy();\n                    image = null;\n                });\n                image.once( 'error', deferred.reject );\n                image.once( 'load', function() {\n                    var width = opts.width,\n                        height = opts.height;\n\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n\n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n\n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n\n                    image.resize( width, height );\n                });\n\n                image.once( 'complete', function() {\n                    var blob, size;\n\n                    // 移动端 UC / qq 浏览器的无图模式下\n                    // ctx.getImageData 处理大图的时候会报 Exception\n                    // INDEX_SIZE_ERR: DOM Exception 1\n                    try {\n                        blob = image.getAsBlob( opts.type );\n\n                        size = file.size;\n\n                        // 如果压缩后，比原来还大则不用压缩后的。\n                        if ( !noCompressIfLarger || blob.size < size ) {\n                            // file.source.destroy && file.source.destroy();\n                            file.source = blob;\n                            file.size = blob.size;\n\n                            file.trigger( 'resize', blob.size, size );\n                        }\n\n                        // 标记，避免重复压缩。\n                        file._compressed = true;\n                        deferred.resolve();\n                    } catch ( e ) {\n                        // 出错了直接继续，让其上传原始图片\n                        deferred.resolve();\n                    }\n                });\n\n                file._info && image.info( file._info );\n                file._meta && image.meta( file._meta );\n\n                image.loadFromBlob( file.source );\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview 文件属性封装\n     */\n    define('file',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$,\n            idPrefix = 'WU_FILE_',\n            idSuffix = 0,\n            rExt = /\\.([^.]+)$/,\n            statusMap = {};\n\n        function gid() {\n            return idPrefix + idSuffix++;\n        }\n\n        /**\n         * 文件类\n         * @class File\n         * @constructor 构造函数\n         * @grammar new File( source ) => File\n         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n         */\n        function WUFile( source ) {\n\n            /**\n             * 文件名，包括扩展名（后缀）\n             * @property name\n             * @type {string}\n             */\n            this.name = source.name || 'Untitled';\n\n            /**\n             * 文件体积（字节）\n             * @property size\n             * @type {uint}\n             * @default 0\n             */\n            this.size = source.size || 0;\n\n            /**\n             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n             * @property type\n             * @type {string}\n             * @default 'application/octet-stream'\n             */\n            this.type = source.type || 'application/octet-stream';\n\n            /**\n             * 文件最后修改日期\n             * @property lastModifiedDate\n             * @type {int}\n             * @default 当前时间戳\n             */\n            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n\n            /**\n             * 文件ID，每个对象具有唯一ID，与文件名无关\n             * @property id\n             * @type {string}\n             */\n            this.id = gid();\n\n            /**\n             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n             * @property ext\n             * @type {string}\n             */\n            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n\n\n            /**\n             * 状态文字说明。在不同的status语境下有不同的用途。\n             * @property statusText\n             * @type {string}\n             */\n            this.statusText = '';\n\n            // 存储文件状态，防止通过属性直接修改\n            statusMap[ this.id ] = WUFile.Status.INITED;\n\n            this.source = source;\n            this.loaded = 0;\n\n            this.on( 'error', function( msg ) {\n                this.setStatus( WUFile.Status.ERROR, msg );\n            });\n        }\n\n        $.extend( WUFile.prototype, {\n\n            /**\n             * 设置状态，状态变化时会触发`change`事件。\n             * @method setStatus\n             * @grammar setStatus( status[, statusText] );\n             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n             */\n            setStatus: function( status, text ) {\n\n                var prevStatus = statusMap[ this.id ];\n\n                typeof text !== 'undefined' && (this.statusText = text);\n\n                if ( status !== prevStatus ) {\n                    statusMap[ this.id ] = status;\n                    /**\n                     * 文件状态变化\n                     * @event statuschange\n                     */\n                    this.trigger( 'statuschange', status, prevStatus );\n                }\n\n            },\n\n            /**\n             * 获取文件状态\n             * @return {File.Status}\n             * @example\n                     文件状态具体包括以下几种类型：\n                     {\n                         // 初始化\n                        INITED:     0,\n                        // 已入队列\n                        QUEUED:     1,\n                        // 正在上传\n                        PROGRESS:     2,\n                        // 上传出错\n                        ERROR:         3,\n                        // 上传成功\n                        COMPLETE:     4,\n                        // 上传取消\n                        CANCELLED:     5\n                    }\n             */\n            getStatus: function() {\n                return statusMap[ this.id ];\n            },\n\n            /**\n             * 获取文件原始信息。\n             * @return {*}\n             */\n            getSource: function() {\n                return this.source;\n            },\n\n            destroy: function() {\n                this.off();\n                delete statusMap[ this.id ];\n            }\n        });\n\n        Mediator.installTo( WUFile.prototype );\n\n        /**\n         * 文件状态值，具体包括以下几种类型：\n         * * `inited` 初始状态\n         * * `queued` 已经进入队列, 等待上传\n         * * `progress` 上传中\n         * * `complete` 上传完成。\n         * * `error` 上传出错，可重试\n         * * `interrupt` 上传中断，可续传。\n         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n         * * `cancelled` 文件被移除。\n         * @property {Object} Status\n         * @namespace File\n         * @class File\n         * @static\n         */\n        WUFile.Status = {\n            INITED:     'inited',    // 初始状态\n            QUEUED:     'queued',    // 已经进入队列, 等待上传\n            PROGRESS:   'progress',    // 上传中\n            ERROR:      'error',    // 上传出错，可重试\n            COMPLETE:   'complete',    // 上传完成。\n            CANCELLED:  'cancelled',    // 上传取消。\n            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n        };\n\n        return WUFile;\n    });\n\n    /**\n     * @fileOverview 文件队列\n     */\n    define('queue',[\n        'base',\n        'mediator',\n        'file'\n    ], function( Base, Mediator, WUFile ) {\n\n        var $ = Base.$,\n            STATUS = WUFile.Status;\n\n        /**\n         * 文件队列, 用来存储各个状态中的文件。\n         * @class Queue\n         * @extends Mediator\n         */\n        function Queue() {\n\n            /**\n             * 统计文件数。\n             * * `numOfQueue` 队列中的文件数。\n             * * `numOfSuccess` 上传成功的文件数\n             * * `numOfCancel` 被取消的文件数\n             * * `numOfProgress` 正在上传中的文件数\n             * * `numOfUploadFailed` 上传错误的文件数。\n             * * `numOfInvalid` 无效的文件数。\n             * * `numofDeleted` 被移除的文件数。\n             * @property {Object} stats\n             */\n            this.stats = {\n                numOfQueue: 0,\n                numOfSuccess: 0,\n                numOfCancel: 0,\n                numOfProgress: 0,\n                numOfUploadFailed: 0,\n                numOfInvalid: 0,\n                numofDeleted: 0,\n                numofInterrupt: 0\n            };\n\n            // 上传队列，仅包括等待上传的文件\n            this._queue = [];\n\n            // 存储所有文件\n            this._map = {};\n        }\n\n        $.extend( Queue.prototype, {\n\n            /**\n             * 将新文件加入对队列尾部\n             *\n             * @method append\n             * @param  {File} file   文件对象\n             */\n            append: function( file ) {\n                this._queue.push( file );\n                this._fileAdded( file );\n                return this;\n            },\n\n            /**\n             * 将新文件加入对队列头部\n             *\n             * @method prepend\n             * @param  {File} file   文件对象\n             */\n            prepend: function( file ) {\n                this._queue.unshift( file );\n                this._fileAdded( file );\n                return this;\n            },\n\n            /**\n             * 获取文件对象\n             *\n             * @method getFile\n             * @param  {String} fileId   文件ID\n             * @return {File}\n             */\n            getFile: function( fileId ) {\n                if ( typeof fileId !== 'string' ) {\n                    return fileId;\n                }\n                return this._map[ fileId ];\n            },\n\n            /**\n             * 从队列中取出一个指定状态的文件。\n             * @grammar fetch( status ) => File\n             * @method fetch\n             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n             * @return {File} [File](#WebUploader:File)\n             */\n            fetch: function( status ) {\n                var len = this._queue.length,\n                    i, file;\n\n                status = status || STATUS.QUEUED;\n\n                for ( i = 0; i < len; i++ ) {\n                    file = this._queue[ i ];\n\n                    if ( status === file.getStatus() ) {\n                        return file;\n                    }\n                }\n\n                return null;\n            },\n\n            /**\n             * 对队列进行排序，能够控制文件上传顺序。\n             * @grammar sort( fn ) => undefined\n             * @method sort\n             * @param {Function} fn 排序方法\n             */\n            sort: function( fn ) {\n                if ( typeof fn === 'function' ) {\n                    this._queue.sort( fn );\n                }\n            },\n\n            /**\n             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n             * @method getFiles\n             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n             */\n            getFiles: function() {\n                var sts = [].slice.call( arguments, 0 ),\n                    ret = [],\n                    i = 0,\n                    len = this._queue.length,\n                    file;\n\n                for ( ; i < len; i++ ) {\n                    file = this._queue[ i ];\n\n                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n                        continue;\n                    }\n\n                    ret.push( file );\n                }\n\n                return ret;\n            },\n\n            /**\n             * 在队列中删除文件。\n             * @grammar removeFile( file ) => Array\n             * @method removeFile\n             * @param {File} 文件对象。\n             */\n            removeFile: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n\n                if ( existing ) {\n                    delete this._map[ file.id ];\n                    file.destroy();\n                    this.stats.numofDeleted++;\n                }\n            },\n\n            _fileAdded: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n\n                if ( !existing ) {\n                    this._map[ file.id ] = file;\n\n                    file.on( 'statuschange', function( cur, pre ) {\n                        me._onFileStatusChange( cur, pre );\n                    });\n                }\n            },\n\n            _onFileStatusChange: function( curStatus, preStatus ) {\n                var stats = this.stats;\n\n                switch ( preStatus ) {\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress--;\n                        break;\n\n                    case STATUS.QUEUED:\n                        stats.numOfQueue --;\n                        break;\n\n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed--;\n                        break;\n\n                    case STATUS.INVALID:\n                        stats.numOfInvalid--;\n                        break;\n\n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt--;\n                        break;\n                }\n\n                switch ( curStatus ) {\n                    case STATUS.QUEUED:\n                        stats.numOfQueue++;\n                        break;\n\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress++;\n                        break;\n\n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed++;\n                        break;\n\n                    case STATUS.COMPLETE:\n                        stats.numOfSuccess++;\n                        break;\n\n                    case STATUS.CANCELLED:\n                        stats.numOfCancel++;\n                        break;\n\n\n                    case STATUS.INVALID:\n                        stats.numOfInvalid++;\n                        break;\n\n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt++;\n                        break;\n                }\n            }\n\n        });\n\n        Mediator.installTo( Queue.prototype );\n\n        return Queue;\n    });\n    /**\n     * @fileOverview 队列\n     */\n    define('widgets/queue',[\n        'base',\n        'uploader',\n        'queue',\n        'file',\n        'lib/file',\n        'runtime/client',\n        'widgets/widget'\n    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n\n        var $ = Base.$,\n            rExt = /\\.\\w+$/,\n            Status = WUFile.Status;\n\n        return Uploader.register({\n            name: 'queue',\n\n            init: function( opts ) {\n                var me = this,\n                    deferred, len, i, item, arr, accept, runtime;\n\n                if ( $.isPlainObject( opts.accept ) ) {\n                    opts.accept = [ opts.accept ];\n                }\n\n                // accept中的中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].extensions;\n                        item && arr.push( item );\n                    }\n\n                    if ( arr.length ) {\n                        accept = '\\\\.' + arr.join(',')\n                                .replace( /,/g, '$|\\\\.' )\n                                .replace( /\\*/g, '.*' ) + '$';\n                    }\n\n                    me.accept = new RegExp( accept, 'i' );\n                }\n\n                me.queue = new Queue();\n                me.stats = me.queue.stats;\n\n                // 如果当前不是html5运行时，那就算了。\n                // 不执行后续操作\n                if ( this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                // 创建一个 html5 运行时的 placeholder\n                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n                deferred = Base.Deferred();\n                this.placeholder = runtime = new RuntimeClient('Placeholder');\n                runtime.connectRuntime({\n                    runtimeOrder: 'html5'\n                }, function() {\n                    me._ruid = runtime.getRuid();\n                    deferred.resolve();\n                });\n                return deferred.promise();\n            },\n\n\n            // 为了支持外部直接添加一个原生File对象。\n            _wrapFile: function( file ) {\n                if ( !(file instanceof WUFile) ) {\n\n                    if ( !(file instanceof File) ) {\n                        if ( !this._ruid ) {\n                            throw new Error('Can\\'t add external files.');\n                        }\n                        file = new File( this._ruid, file );\n                    }\n\n                    file = new WUFile( file );\n                }\n\n                return file;\n            },\n\n            // 判断文件是否可以被加入队列\n            acceptFile: function( file ) {\n                 var invalid = !file || !file.size || this.accept &&\n\n                        // 如果名字中有后缀，才做后缀白名单处理。\n                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n                return !invalid;\n            },\n\n\n            /**\n             * @event beforeFileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n             * @for  Uploader\n             */\n\n            /**\n             * @event fileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列以后触发。\n             * @for  Uploader\n             */\n\n            _addFile: function( file ) {\n                var me = this;\n\n                file = me._wrapFile( file );\n\n                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n                    return;\n                }\n\n                // 类型不匹配，则派送错误事件，并返回。\n                if ( !me.acceptFile( file ) ) {\n                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n                    return;\n                }\n\n                me.queue.append( file );\n                me.owner.trigger( 'fileQueued', file );\n                return file;\n            },\n\n            getFile: function( fileId ) {\n                return this.queue.getFile( fileId );\n            },\n\n            /**\n             * @event filesQueued\n             * @param {File} files 数组，内容为原始File(lib/File）对象。\n             * @description 当一批文件添加进队列以后触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @property {Boolean} [auto=false]\n             * @namespace options\n             * @for Uploader\n             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n             *\n             */\n\n            /**\n             * @method addFiles\n             * @grammar addFiles( file ) => undefined\n             * @grammar addFiles( [file1, file2 ...] ) => undefined\n             * @param {Array of File or File} [files] Files 对象 数组\n             * @description 添加文件到队列\n             * @for  Uploader\n             */\n            addFile: function( files ) {\n                var me = this;\n\n                if ( !files.length ) {\n                    files = [ files ];\n                }\n\n                files = $.map( files, function( file ) {\n                    return me._addFile( file );\n                });\n\n                me.owner.trigger( 'filesQueued', files );\n\n                if ( me.options.auto ) {\n                    setTimeout(function() {\n                        me.request('start-upload');\n                    }, 20 );\n                }\n            },\n\n            getStats: function() {\n                return this.stats;\n            },\n\n            /**\n             * @event fileDequeued\n             * @param {File} file File对象\n             * @description 当文件被移除队列后触发。\n             * @for  Uploader\n             */\n\n             /**\n             * @method removeFile\n             * @grammar removeFile( file ) => undefined\n             * @grammar removeFile( id ) => undefined\n             * @grammar removeFile( file, true ) => undefined\n             * @grammar removeFile( id, true ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.removeFile( file );\n             * })\n             */\n            removeFile: function( file, remove ) {\n                var me = this;\n\n                file = file.id ? file : me.queue.getFile( file );\n\n                this.request( 'cancel-file', file );\n\n                if ( remove ) {\n                    this.queue.removeFile( file );\n                }\n            },\n\n            /**\n             * @method getFiles\n             * @grammar getFiles() => Array\n             * @grammar getFiles( status1, status2, status... ) => Array\n             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n             * @for  Uploader\n             * @example\n             * console.log( uploader.getFiles() );    // => all files\n             * console.log( uploader.getFiles('error') )    // => all error files.\n             */\n            getFiles: function() {\n                return this.queue.getFiles.apply( this.queue, arguments );\n            },\n\n            fetchFile: function() {\n                return this.queue.fetch.apply( this.queue, arguments );\n            },\n\n            /**\n             * @method retry\n             * @grammar retry() => undefined\n             * @grammar retry( file ) => undefined\n             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n             * @for  Uploader\n             * @example\n             * function retry() {\n             *     uploader.retry();\n             * }\n             */\n            retry: function( file, noForceStart ) {\n                var me = this,\n                    files, i, len;\n\n                if ( file ) {\n                    file = file.id ? file : me.queue.getFile( file );\n                    file.setStatus( Status.QUEUED );\n                    noForceStart || me.request('start-upload');\n                    return;\n                }\n\n                files = me.queue.getFiles( Status.ERROR );\n                i = 0;\n                len = files.length;\n\n                for ( ; i < len; i++ ) {\n                    file = files[ i ];\n                    file.setStatus( Status.QUEUED );\n                }\n\n                me.request('start-upload');\n            },\n\n            /**\n             * @method sort\n             * @grammar sort( fn ) => undefined\n             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n             * @for  Uploader\n             */\n            sortFiles: function() {\n                return this.queue.sort.apply( this.queue, arguments );\n            },\n\n            /**\n             * @event reset\n             * @description 当 uploader 被重置的时候触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @method reset\n             * @grammar reset() => undefined\n             * @description 重置uploader。目前只重置了队列。\n             * @for  Uploader\n             * @example\n             * uploader.reset();\n             */\n            reset: function() {\n                this.owner.trigger('reset');\n                this.queue = new Queue();\n                this.stats = this.queue.stats;\n            },\n\n            destroy: function() {\n                this.reset();\n                this.placeholder && this.placeholder.destroy();\n            }\n        });\n\n    });\n    /**\n     * @fileOverview 添加获取Runtime相关信息的方法。\n     */\n    define('widgets/runtime',[\n        'uploader',\n        'runtime/runtime',\n        'widgets/widget'\n    ], function( Uploader, Runtime ) {\n\n        Uploader.support = function() {\n            return Runtime.hasRuntime.apply( Runtime, arguments );\n        };\n\n        /**\n         * @property {Object} [runtimeOrder=html5,flash]\n         * @namespace options\n         * @for Uploader\n         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n         *\n         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n         */\n\n        return Uploader.register({\n            name: 'runtime',\n\n            init: function() {\n                if ( !this.predictRuntimeType() ) {\n                    throw Error('Runtime Error');\n                }\n            },\n\n            /**\n             * 预测Uploader将采用哪个`Runtime`\n             * @grammar predictRuntimeType() => String\n             * @method predictRuntimeType\n             * @for  Uploader\n             */\n            predictRuntimeType: function() {\n                var orders = this.options.runtimeOrder || Runtime.orders,\n                    type = this.type,\n                    i, len;\n\n                if ( !type ) {\n                    orders = orders.split( /\\s*,\\s*/g );\n\n                    for ( i = 0, len = orders.length; i < len; i++ ) {\n                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n                            this.type = type = orders[ i ];\n                            break;\n                        }\n                    }\n                }\n\n                return type;\n            }\n        });\n    });\n    /**\n     * @fileOverview Transport\n     */\n    define('lib/transport',[\n        'base',\n        'runtime/client',\n        'mediator'\n    ], function( Base, RuntimeClient, Mediator ) {\n\n        var $ = Base.$;\n\n        function Transport( opts ) {\n            var me = this;\n\n            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n            RuntimeClient.call( this, 'Transport' );\n\n            this._blob = null;\n            this._formData = opts.formData || {};\n            this._headers = opts.headers || {};\n\n            this.on( 'progress', this._timeout );\n            this.on( 'load error', function() {\n                me.trigger( 'progress', 1 );\n                clearTimeout( me._timer );\n            });\n        }\n\n        Transport.options = {\n            server: '',\n            method: 'POST',\n\n            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n            withCredentials: false,\n            fileVal: 'file',\n            timeout: 2 * 60 * 1000,    // 2分钟\n            formData: {},\n            headers: {},\n            sendAsBinary: false\n        };\n\n        $.extend( Transport.prototype, {\n\n            // 添加Blob, 只能添加一次，最后一次有效。\n            appendBlob: function( key, blob, filename ) {\n                var me = this,\n                    opts = me.options;\n\n                if ( me.getRuid() ) {\n                    me.disconnectRuntime();\n                }\n\n                // 连接到blob归属的同一个runtime.\n                me.connectRuntime( blob.ruid, function() {\n                    me.exec('init');\n                });\n\n                me._blob = blob;\n                opts.fileVal = key || opts.fileVal;\n                opts.filename = filename || opts.filename;\n\n            },\n\n            // 添加其他字段\n            append: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._formData, key );\n                } else {\n                    this._formData[ key ] = value;\n                }\n            },\n\n            setRequestHeader: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._headers, key );\n                } else {\n                    this._headers[ key ] = value;\n                }\n            },\n\n            send: function( method ) {\n                this.exec( 'send', method );\n                this._timeout();\n            },\n\n            abort: function() {\n                clearTimeout( this._timer );\n                return this.exec('abort');\n            },\n\n            destroy: function() {\n                this.trigger('destroy');\n                this.off();\n                this.exec('destroy');\n                this.disconnectRuntime();\n            },\n\n            getResponse: function() {\n                return this.exec('getResponse');\n            },\n\n            getResponseAsJson: function() {\n                return this.exec('getResponseAsJson');\n            },\n\n            getStatus: function() {\n                return this.exec('getStatus');\n            },\n\n            _timeout: function() {\n                var me = this,\n                    duration = me.options.timeout;\n\n                if ( !duration ) {\n                    return;\n                }\n\n                clearTimeout( me._timer );\n                me._timer = setTimeout(function() {\n                    me.abort();\n                    me.trigger( 'error', 'timeout' );\n                }, duration );\n            }\n\n        });\n\n        // 让Transport具备事件功能。\n        Mediator.installTo( Transport.prototype );\n\n        return Transport;\n    });\n    /**\n     * @fileOverview 负责文件上传相关。\n     */\n    define('widgets/upload',[\n        'base',\n        'uploader',\n        'file',\n        'lib/transport',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile, Transport ) {\n\n        var $ = Base.$,\n            isPromise = Base.isPromise,\n            Status = WUFile.Status;\n\n        // 添加默认配置项\n        $.extend( Uploader.options, {\n\n\n            /**\n             * @property {Boolean} [prepareNextFile=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否允许在文件传输时提前把下一个文件准备好。\n             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n             */\n            prepareNextFile: false,\n\n            /**\n             * @property {Boolean} [chunked=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否要分片处理大文件上传。\n             */\n            chunked: false,\n\n            /**\n             * @property {Boolean} [chunkSize=5242880]\n             * @namespace options\n             * @for Uploader\n             * @description 如果要分片，分多大一片？ 默认大小为5M.\n             */\n            chunkSize: 5 * 1024 * 1024,\n\n            /**\n             * @property {Boolean} [chunkRetry=2]\n             * @namespace options\n             * @for Uploader\n             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n             */\n            chunkRetry: 2,\n\n            /**\n             * @property {Boolean} [threads=3]\n             * @namespace options\n             * @for Uploader\n             * @description 上传并发数。允许同时最大上传进程数。\n             */\n            threads: 3,\n\n\n            /**\n             * @property {Object} [formData={}]\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n             */\n            formData: {}\n\n            /**\n             * @property {Object} [fileVal='file']\n             * @namespace options\n             * @for Uploader\n             * @description 设置文件上传域的name。\n             */\n\n            /**\n             * @property {Object} [method='POST']\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传方式，`POST`或者`GET`。\n             */\n\n            /**\n             * @property {Object} [sendAsBinary=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n             * 其他参数在$_GET数组中。\n             */\n        });\n\n        // 负责将文件切片。\n        function CuteFile( file, chunkSize ) {\n            var pending = [],\n                blob = file.source,\n                total = blob.size,\n                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n                start = 0,\n                index = 0,\n                len, api;\n\n            api = {\n                file: file,\n\n                has: function() {\n                    return !!pending.length;\n                },\n\n                shift: function() {\n                    return pending.shift();\n                },\n\n                unshift: function( block ) {\n                    pending.unshift( block );\n                }\n            };\n\n            while ( index < chunks ) {\n                len = Math.min( chunkSize, total - start );\n\n                pending.push({\n                    file: file,\n                    start: start,\n                    end: chunkSize ? (start + len) : total,\n                    total: total,\n                    chunks: chunks,\n                    chunk: index++,\n                    cuted: api\n                });\n                start += len;\n            }\n\n            file.blocks = pending.concat();\n            file.remaning = pending.length;\n\n            return api;\n        }\n\n        Uploader.register({\n            name: 'upload',\n\n            init: function() {\n                var owner = this.owner,\n                    me = this;\n\n                this.runing = false;\n                this.progress = false;\n\n                owner\n                    .on( 'startUpload', function() {\n                        me.progress = true;\n                    })\n                    .on( 'uploadFinished', function() {\n                        me.progress = false;\n                    });\n\n                // 记录当前正在传的数据，跟threads相关\n                this.pool = [];\n\n                // 缓存分好片的文件。\n                this.stack = [];\n\n                // 缓存即将上传的文件。\n                this.pending = [];\n\n                // 跟踪还有多少分片在上传中但是没有完成上传。\n                this.remaning = 0;\n                this.__tick = Base.bindFn( this._tick, this );\n\n                owner.on( 'uploadComplete', function( file ) {\n\n                    // 把其他块取消了。\n                    file.blocks && $.each( file.blocks, function( _, v ) {\n                        v.transport && (v.transport.abort(), v.transport.destroy());\n                        delete v.transport;\n                    });\n\n                    delete file.blocks;\n                    delete file.remaning;\n                });\n            },\n\n            reset: function() {\n                this.request( 'stop-upload', true );\n                this.runing = false;\n                this.pool = [];\n                this.stack = [];\n                this.pending = [];\n                this.remaning = 0;\n                this._trigged = false;\n                this._promise = null;\n            },\n\n            /**\n             * @event startUpload\n             * @description 当开始上传流程时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n             *\n             * 可以指定开始某一个文件。\n             * @grammar upload() => undefined\n             * @grammar upload( file | fileId) => undefined\n             * @method upload\n             * @for  Uploader\n             */\n            startUpload: function(file) {\n                var me = this;\n\n                // 移出invalid的文件\n                $.each( me.request( 'get-files', Status.INVALID ), function() {\n                    me.request( 'remove-file', this );\n                });\n\n                // 如果指定了开始某个文件，则只开始指定文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        $.each( me.pool, function( _, v ) {\n\n                            // 之前暂停过。\n                            if (v.file !== file) {\n                                return;\n                            }\n\n                            v.transport && v.transport.send();\n                        });\n\n                        file.setStatus( Status.QUEUED );\n                    } else if (file.getStatus() === Status.PROGRESS) {\n                        return;\n                    } else {\n                        file.setStatus( Status.QUEUED );\n                    }\n                } else {\n                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n                        this.setStatus( Status.QUEUED );\n                    });\n                }\n\n                if ( me.runing ) {\n                    return;\n                }\n\n                me.runing = true;\n\n                var files = [];\n\n                // 如果有暂停的，则续传\n                $.each( me.pool, function( _, v ) {\n                    var file = v.file;\n\n                    if ( file.getStatus() === Status.INTERRUPT ) {\n                        files.push(file);\n                        me._trigged = false;\n                        v.transport && v.transport.send();\n                    }\n                });\n\n                var file;\n                while ( (file = files.shift()) ) {\n                    file.setStatus( Status.PROGRESS );\n                }\n\n                file || $.each( me.request( 'get-files',\n                        Status.INTERRUPT ), function() {\n                    this.setStatus( Status.PROGRESS );\n                });\n\n                me._trigged = false;\n                Base.nextTick( me.__tick );\n                me.owner.trigger('startUpload');\n            },\n\n            /**\n             * @event stopUpload\n             * @description 当开始上传流程暂停时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n             *\n             * 如果第一个参数是文件，则只暂停指定文件。\n             * @grammar stop() => undefined\n             * @grammar stop( true ) => undefined\n             * @grammar stop( file ) => undefined\n             * @method stop\n             * @for  Uploader\n             */\n            stopUpload: function( file, interrupt ) {\n                var me = this;\n\n                if (file === true) {\n                    interrupt = file;\n                    file = null;\n                }\n\n                if ( me.runing === false ) {\n                    return;\n                }\n\n                // 如果只是暂停某个文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n\n                    if ( file.getStatus() !== Status.PROGRESS &&\n                            file.getStatus() !== Status.QUEUED ) {\n                        return;\n                    }\n\n                    file.setStatus( Status.INTERRUPT );\n                    $.each( me.pool, function( _, v ) {\n\n                        // 只 abort 指定的文件。\n                        if (v.file !== file) {\n                            return;\n                        }\n\n                        v.transport && v.transport.abort();\n                        me._putback(v);\n                        me._popBlock(v);\n                    });\n\n                    return Base.nextTick( me.__tick );\n                }\n\n                me.runing = false;\n\n                if (this._promise && this._promise.file) {\n                    this._promise.file.setStatus( Status.INTERRUPT );\n                }\n\n                interrupt && $.each( me.pool, function( _, v ) {\n                    v.transport && v.transport.abort();\n                    v.file.setStatus( Status.INTERRUPT );\n                });\n\n                me.owner.trigger('stopUpload');\n            },\n\n            /**\n             * @method cancelFile\n             * @grammar cancelFile( file ) => undefined\n             * @grammar cancelFile( id ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 标记文件状态为已取消, 同时将中断文件传输。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.cancelFile( file );\n             * })\n             */\n            cancelFile: function( file ) {\n                file = file.id ? file : this.request( 'get-file', file );\n\n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n\n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n\n                file.setStatus( Status.CANCELLED );\n                this.owner.trigger( 'fileDequeued', file );\n            },\n\n            /**\n             * 判断`Uplaode`r是否正在上传中。\n             * @grammar isInProgress() => Boolean\n             * @method isInProgress\n             * @for  Uploader\n             */\n            isInProgress: function() {\n                return !!this.progress;\n            },\n\n            _getStats: function() {\n                return this.request('get-stats');\n            },\n\n            /**\n             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n             * @grammar skipFile( file ) => undefined\n             * @method skipFile\n             * @for  Uploader\n             */\n            skipFile: function( file, status ) {\n                file = file.id ? file : this.request( 'get-file', file );\n\n                file.setStatus( status || Status.COMPLETE );\n                file.skipped = true;\n\n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n\n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n\n                this.owner.trigger( 'uploadSkip', file );\n            },\n\n            /**\n             * @event uploadFinished\n             * @description 当所有文件上传结束时触发。\n             * @for  Uploader\n             */\n            _tick: function() {\n                var me = this,\n                    opts = me.options,\n                    fn, val;\n\n                // 上一个promise还没有结束，则等待完成后再执行。\n                if ( me._promise ) {\n                    return me._promise.always( me.__tick );\n                }\n\n                // 还有位置，且还有文件要处理的话。\n                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n                    me._trigged = false;\n\n                    fn = function( val ) {\n                        me._promise = null;\n\n                        // 有可能是reject过来的，所以要检测val的类型。\n                        val && val.file && me._startSend( val );\n                        Base.nextTick( me.__tick );\n                    };\n\n                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n\n                // 没有要上传的了，且没有正在传输的了。\n                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n                    !me._getStats().numofInterrupt ) {\n                    me.runing = false;\n\n                    me._trigged || Base.nextTick(function() {\n                        me.owner.trigger('uploadFinished');\n                    });\n                    me._trigged = true;\n                }\n            },\n\n            _putback: function(block) {\n                var idx;\n\n                block.cuted.unshift(block);\n                idx = this.stack.indexOf(block.cuted);\n\n                if (!~idx) {\n                    this.stack.unshift(block.cuted);\n                }\n            },\n\n            _getStack: function() {\n                var i = 0,\n                    act;\n\n                while ( (act = this.stack[ i++ ]) ) {\n                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n                        return act;\n                    } else if (!act.has() ||\n                            act.file.getStatus() !== Status.PROGRESS &&\n                            act.file.getStatus() !== Status.INTERRUPT ) {\n\n                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n                        // interupt（暂停中） 的移除。\n                        this.stack.splice( --i, 1 );\n                    }\n                }\n\n                return null;\n            },\n\n            _nextBlock: function() {\n                var me = this,\n                    opts = me.options,\n                    act, next, done, preparing;\n\n                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n                if ( (act = this._getStack()) ) {\n\n                    // 是否提前准备下一个文件\n                    if ( opts.prepareNextFile && !me.pending.length ) {\n                        me._prepareNextFile();\n                    }\n\n                    return act.shift();\n\n                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n                } else if ( me.runing ) {\n\n                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n                        me._prepareNextFile();\n                    }\n\n                    next = me.pending.shift();\n                    done = function( file ) {\n                        if ( !file ) {\n                            return null;\n                        }\n\n                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n                        me.stack.push(act);\n                        return act.shift();\n                    };\n\n                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n                    if ( isPromise( next) ) {\n                        preparing = next.file;\n                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n                        next.file = preparing;\n                        return next;\n                    }\n\n                    return done( next );\n                }\n            },\n\n\n            /**\n             * @event uploadStart\n             * @param {File} file File对象\n             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n             * @for  Uploader\n             */\n            _prepareNextFile: function() {\n                var me = this,\n                    file = me.request('fetch-file'),\n                    pending = me.pending,\n                    promise;\n\n                if ( file ) {\n                    promise = me.request( 'before-send-file', file, function() {\n\n                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n                        if ( file.getStatus() === Status.PROGRESS ||\n                            file.getStatus() === Status.INTERRUPT ) {\n                            return file;\n                        }\n\n                        return me._finishFile( file );\n                    });\n\n                    me.owner.trigger( 'uploadStart', file );\n                    file.setStatus( Status.PROGRESS );\n\n                    promise.file = file;\n\n                    // 如果还在pending中，则替换成文件本身。\n                    promise.done(function() {\n                        var idx = $.inArray( promise, pending );\n\n                        ~idx && pending.splice( idx, 1, file );\n                    });\n\n                    // befeore-send-file的钩子就有错误发生。\n                    promise.fail(function( reason ) {\n                        file.setStatus( Status.ERROR, reason );\n                        me.owner.trigger( 'uploadError', file, reason );\n                        me.owner.trigger( 'uploadComplete', file );\n                    });\n\n                    pending.push( promise );\n                }\n            },\n\n            // 让出位置了，可以让其他分片开始上传\n            _popBlock: function( block ) {\n                var idx = $.inArray( block, this.pool );\n\n                this.pool.splice( idx, 1 );\n                block.file.remaning--;\n                this.remaning--;\n            },\n\n            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n            _startSend: function( block ) {\n                var me = this,\n                    file = block.file,\n                    promise;\n\n                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n                // 如：暂停，取消\n                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n                if ( file.getStatus() !== Status.PROGRESS ) {\n\n                    // 如果是中断，则还需要放回去。\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        me._putback(block);\n                    }\n\n                    return;\n                }\n\n                me.pool.push( block );\n                me.remaning++;\n\n                // 如果没有分片，则直接使用原始的。\n                // 不会丢失content-type信息。\n                block.blob = block.chunks === 1 ? file.source :\n                        file.source.slice( block.start, block.end );\n\n                // hook, 每个分片发送之前可能要做些异步的事情。\n                promise = me.request( 'before-send', block, function() {\n\n                    // 有可能文件已经上传出错了，所以不需要再传输了。\n                    if ( file.getStatus() === Status.PROGRESS ) {\n                        me._doSend( block );\n                    } else {\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n\n                // 如果为fail了，则跳过此分片。\n                promise.fail(function() {\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file ).always(function() {\n                            block.percentage = 1;\n                            me._popBlock( block );\n                            me.owner.trigger( 'uploadComplete', file );\n                            Base.nextTick( me.__tick );\n                        });\n                    } else {\n                        block.percentage = 1;\n                        me.updateFileProgress( file );\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n            },\n\n\n            /**\n             * @event uploadBeforeSend\n             * @param {Object} object\n             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n             * @param {Object} headers 可以扩展此对象来控制上传头部。\n             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadAccept\n             * @param {Object} object\n             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadProgress\n             * @param {File} file File对象\n             * @param {Number} percentage 上传进度\n             * @description 上传过程中触发，携带上传进度。\n             * @for  Uploader\n             */\n\n\n            /**\n             * @event uploadError\n             * @param {File} file File对象\n             * @param {String} reason 出错的code\n             * @description 当文件上传出错时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadSuccess\n             * @param {File} file File对象\n             * @param {Object} response 服务端返回的数据\n             * @description 当文件上传成功时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadComplete\n             * @param {File} [file] File对象\n             * @description 不管成功或者失败，文件上传完成时触发。\n             * @for  Uploader\n             */\n\n            // 做上传操作。\n            _doSend: function( block ) {\n                var me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    file = block.file,\n                    tr = new Transport( opts ),\n                    data = $.extend({}, opts.formData ),\n                    headers = $.extend({}, opts.headers ),\n                    requestAccept, ret;\n\n                block.transport = tr;\n\n                tr.on( 'destroy', function() {\n                    delete block.transport;\n                    me._popBlock( block );\n                    Base.nextTick( me.__tick );\n                });\n\n                // 广播上传进度。以文件为单位。\n                tr.on( 'progress', function( percentage ) {\n                    block.percentage = percentage;\n                    me.updateFileProgress( file );\n                });\n\n                // 用来询问，是否返回的结果是有错误的。\n                requestAccept = function( reject ) {\n                    var fn;\n\n                    ret = tr.getResponseAsJson() || {};\n                    ret._raw = tr.getResponse();\n                    fn = function( value ) {\n                        reject = value;\n                    };\n\n                    // 服务端响应了，不代表成功了，询问是否响应正确。\n                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n                        reject = reject || 'server';\n                    }\n\n                    return reject;\n                };\n\n                // 尝试重试，然后广播文件上传出错。\n                tr.on( 'error', function( type, flag ) {\n                    block.retried = block.retried || 0;\n\n                    // 自动重试\n                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n                            block.retried < opts.chunkRetry ) {\n\n                        block.retried++;\n                        tr.send();\n\n                    } else {\n\n                        // http status 500 ~ 600\n                        if ( !flag && type === 'server' ) {\n                            type = requestAccept( type );\n                        }\n\n                        file.setStatus( Status.ERROR, type );\n                        owner.trigger( 'uploadError', file, type );\n                        owner.trigger( 'uploadComplete', file );\n                    }\n                });\n\n                // 上传成功\n                tr.on( 'load', function() {\n                    var reason;\n\n                    // 如果非预期，转向上传出错。\n                    if ( (reason = requestAccept()) ) {\n                        tr.trigger( 'error', reason, true );\n                        return;\n                    }\n\n                    // 全部上传完成。\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file, ret );\n                    } else {\n                        tr.destroy();\n                    }\n                });\n\n                // 配置默认的上传字段。\n                data = $.extend( data, {\n                    id: file.id,\n                    name: file.name,\n                    type: file.type,\n                    lastModifiedDate: file.lastModifiedDate,\n                    size: file.size\n                });\n\n                block.chunks > 1 && $.extend( data, {\n                    chunks: block.chunks,\n                    chunk: block.chunk\n                });\n\n                // 在发送之间可以添加字段什么的。。。\n                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n                owner.trigger( 'uploadBeforeSend', block, data, headers );\n\n                // 开始发送。\n                tr.appendBlob( opts.fileVal, block.blob, file.name );\n                tr.append( data );\n                tr.setRequestHeader( headers );\n                tr.send();\n            },\n\n            // 完成上传。\n            _finishFile: function( file, ret, hds ) {\n                var owner = this.owner;\n\n                return owner\n                        .request( 'after-send-file', arguments, function() {\n                            file.setStatus( Status.COMPLETE );\n                            owner.trigger( 'uploadSuccess', file, ret, hds );\n                        })\n                        .fail(function( reason ) {\n\n                            // 如果外部已经标记为invalid什么的，不再改状态。\n                            if ( file.getStatus() === Status.PROGRESS ) {\n                                file.setStatus( Status.ERROR, reason );\n                            }\n\n                            owner.trigger( 'uploadError', file, reason );\n                        })\n                        .always(function() {\n                            owner.trigger( 'uploadComplete', file );\n                        });\n            },\n\n            updateFileProgress: function(file) {\n                var totalPercent = 0,\n                    uploaded = 0;\n\n                if (!file.blocks) {\n                    return;\n                }\n\n                $.each( file.blocks, function( _, v ) {\n                    uploaded += (v.percentage || 0) * (v.end - v.start);\n                });\n\n                totalPercent = uploaded / file.size;\n                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n            }\n\n        });\n    });\n    /**\n     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n     */\n\n    define('widgets/validator',[\n        'base',\n        'uploader',\n        'file',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile ) {\n\n        var $ = Base.$,\n            validators = {},\n            api;\n\n        /**\n         * @event error\n         * @param {String} type 错误类型。\n         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n         *\n         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n         * @for  Uploader\n         */\n\n        // 暴露给外面的api\n        api = {\n\n            // 添加验证器\n            addValidator: function( type, cb ) {\n                validators[ type ] = cb;\n            },\n\n            // 移除验证器\n            removeValidator: function( type ) {\n                delete validators[ type ];\n            }\n        };\n\n        // 在Uploader初始化的时候启动Validators的初始化\n        Uploader.register({\n            name: 'validator',\n\n            init: function() {\n                var me = this;\n                Base.nextTick(function() {\n                    $.each( validators, function() {\n                        this.call( me.owner );\n                    });\n                });\n            }\n        });\n\n        /**\n         * @property {int} [fileNumLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总数量, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileNumLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileNumLimit, 10 ),\n                flag = true;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n\n                if ( count >= max && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n\n                return count >= max ? false : true;\n            });\n\n            uploader.on( 'fileQueued', function() {\n                count++;\n            });\n\n            uploader.on( 'fileDequeued', function() {\n                count--;\n            });\n\n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n\n\n        /**\n         * @property {int} [fileSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileSizeLimit, 10 ),\n                flag = true;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n                var invalid = count + file.size > max;\n\n                if ( invalid && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n\n                return invalid ? false : true;\n            });\n\n            uploader.on( 'fileQueued', function( file ) {\n                count += file.size;\n            });\n\n            uploader.on( 'fileDequeued', function( file ) {\n                count -= file.size;\n            });\n\n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n\n        /**\n         * @property {int} [fileSingleSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSingleSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                max = opts.fileSingleSizeLimit;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n\n                if ( file.size > max ) {\n                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n                    return false;\n                }\n\n            });\n\n        });\n\n        /**\n         * @property {Boolean} [duplicate=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n         */\n        api.addValidator( 'duplicate', function() {\n            var uploader = this,\n                opts = uploader.options,\n                mapping = {};\n\n            if ( opts.duplicate ) {\n                return;\n            }\n\n            function hashString( str ) {\n                var hash = 0,\n                    i = 0,\n                    len = str.length,\n                    _char;\n\n                for ( ; i < len; i++ ) {\n                    _char = str.charCodeAt( i );\n                    hash = _char + (hash << 6) + (hash << 16) - hash;\n                }\n\n                return hash;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n                var hash = file.__hash || (file.__hash = hashString( file.name +\n                        file.size + file.lastModifiedDate ));\n\n                // 已经重复了\n                if ( mapping[ hash ] ) {\n                    this.trigger( 'error', 'F_DUPLICATE', file );\n                    return false;\n                }\n            });\n\n            uploader.on( 'fileQueued', function( file ) {\n                var hash = file.__hash;\n\n                hash && (mapping[ hash ] = true);\n            });\n\n            uploader.on( 'fileDequeued', function( file ) {\n                var hash = file.__hash;\n\n                hash && (delete mapping[ hash ]);\n            });\n\n            uploader.on( 'reset', function() {\n                mapping = {};\n            });\n        });\n\n        return api;\n    });\n\n    /**\n     * @fileOverview Md5\n     */\n    define('lib/md5',[\n        'runtime/client',\n        'mediator'\n    ], function( RuntimeClient, Mediator ) {\n\n        function Md5() {\n            RuntimeClient.call( this, 'Md5' );\n        }\n\n        // 让 Md5 具备事件功能。\n        Mediator.installTo( Md5.prototype );\n\n        Md5.prototype.loadFromBlob = function( blob ) {\n            var me = this;\n\n            if ( me.getRuid() ) {\n                me.disconnectRuntime();\n            }\n\n            // 连接到blob归属的同一个runtime.\n            me.connectRuntime( blob.ruid, function() {\n                me.exec('init');\n                me.exec( 'loadFromBlob', blob );\n            });\n        };\n\n        Md5.prototype.getResult = function() {\n            return this.exec('getResult');\n        };\n\n        return Md5;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/md5',[\n        'base',\n        'uploader',\n        'lib/md5',\n        'lib/blob',\n        'widgets/widget'\n    ], function( Base, Uploader, Md5, Blob ) {\n\n        return Uploader.register({\n            name: 'md5',\n\n\n            /**\n             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n             *\n             *\n             * @method md5File\n             * @grammar md5File( file[, start[, end]] ) => promise\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.md5File( file )\n             *\n             *         // 及时显示进度\n             *         .progress(function(percentage) {\n             *             console.log('Percentage:', percentage);\n             *         })\n             *\n             *         // 完成\n             *         .then(function(val) {\n             *             console.log('md5 result:', val);\n             *         });\n             *\n             * });\n             */\n            md5File: function( file, start, end ) {\n                var md5 = new Md5(),\n                    deferred = Base.Deferred(),\n                    blob = (file instanceof Blob) ? file :\n                        this.request( 'get-file', file ).source;\n\n                md5.on( 'progress load', function( e ) {\n                    e = e || {};\n                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n                });\n\n                md5.on( 'complete', function() {\n                    deferred.resolve( md5.getResult() );\n                });\n\n                md5.on( 'error', function( reason ) {\n                    deferred.reject( reason );\n                });\n\n                if ( arguments.length > 1 ) {\n                    start = start || 0;\n                    end = end || 0;\n                    start < 0 && (start = blob.size + start);\n                    end < 0 && (end = blob.size + end);\n                    end = Math.min( end, blob.size );\n                    blob = blob.slice( start, end );\n                }\n\n                md5.loadFromBlob( blob );\n\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/compbase',[],function() {\n\n        function CompBase( owner, runtime ) {\n\n            this.owner = owner;\n            this.options = owner.options;\n\n            this.getRuntime = function() {\n                return runtime;\n            };\n\n            this.getRuid = function() {\n                return runtime.uid;\n            };\n\n            this.trigger = function() {\n                return owner.trigger.apply( owner, arguments );\n            };\n        }\n\n        return CompBase;\n    });\n    /**\n     * @fileOverview Html5Runtime\n     */\n    define('runtime/html5/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n\n        var type = 'html5',\n            components = {};\n\n        function Html5Runtime() {\n            var pool = {},\n                me = this,\n                destroy = this.destroy;\n\n            Runtime.apply( me, arguments );\n            me.type = type;\n\n\n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n\n                if ( components[ comp ] ) {\n                    instance = pool[ uid ] = pool[ uid ] ||\n                            new components[ comp ]( client, me );\n\n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n            };\n\n            me.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n        }\n\n        Base.inherits( Runtime, {\n            constructor: Html5Runtime,\n\n            // 不需要连接其他程序，直接执行callback\n            init: function() {\n                var me = this;\n                setTimeout(function() {\n                    me.trigger('ready');\n                }, 1 );\n            }\n\n        });\n\n        // 注册Components\n        Html5Runtime.register = function( name, component ) {\n            var klass = components[ name ] = Base.inherits( CompBase, component );\n            return klass;\n        };\n\n        // 注册html5运行时。\n        // 只有在支持的前提下注册。\n        if ( window.Blob && window.FileReader && window.DataView ) {\n            Runtime.addRuntime( type, Html5Runtime );\n        }\n\n        return Html5Runtime;\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/html5/blob',[\n        'runtime/html5/runtime',\n        'lib/blob'\n    ], function( Html5Runtime, Blob ) {\n\n        return Html5Runtime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.owner.source,\n                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n\n                blob = slice.call( blob, start, end );\n\n                return new Blob( this.getRuid(), blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/dnd',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n\n        var $ = Base.$,\n            prefix = 'webuploader-dnd-';\n\n        return Html5Runtime.register( 'DragAndDrop', {\n            init: function() {\n                var elem = this.elem = this.options.container;\n\n                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n                this.dropHandler = Base.bindFn( this._dropHandler, this );\n                this.dndOver = false;\n\n                elem.on( 'dragenter', this.dragEnterHandler );\n                elem.on( 'dragover', this.dragOverHandler );\n                elem.on( 'dragleave', this.dragLeaveHandler );\n                elem.on( 'drop', this.dropHandler );\n\n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).on( 'dragover', this.dragOverHandler );\n                    $( document ).on( 'drop', this.dropHandler );\n                }\n            },\n\n            _dragEnterHandler: function( e ) {\n                var me = this,\n                    denied = me._denied || false,\n                    items;\n\n                e = e.originalEvent || e;\n\n                if ( !me.dndOver ) {\n                    me.dndOver = true;\n\n                    // 注意只有 chrome 支持。\n                    items = e.dataTransfer.items;\n\n                    if ( items && items.length ) {\n                        me._denied = denied = !me.trigger( 'accept', items );\n                    }\n\n                    me.elem.addClass( prefix + 'over' );\n                    me.elem[ denied ? 'addClass' :\n                            'removeClass' ]( prefix + 'denied' );\n                }\n\n                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n\n                return false;\n            },\n\n            _dragOverHandler: function( e ) {\n                // 只处理框内的。\n                var parentElem = this.elem.parent().get( 0 );\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n\n                clearTimeout( this._leaveTimer );\n                this._dragEnterHandler.call( this, e );\n\n                return false;\n            },\n\n            _dragLeaveHandler: function() {\n                var me = this,\n                    handler;\n\n                handler = function() {\n                    me.dndOver = false;\n                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n                };\n\n                clearTimeout( me._leaveTimer );\n                me._leaveTimer = setTimeout( handler, 100 );\n                return false;\n            },\n\n            _dropHandler: function( e ) {\n                var me = this,\n                    ruid = me.getRuid(),\n                    parentElem = me.elem.parent().get( 0 ),\n                    dataTransfer, data;\n\n                // 只处理框内的。\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n\n                e = e.originalEvent || e;\n                dataTransfer = e.dataTransfer;\n\n                // 如果是页面内拖拽，还不能处理，不阻止事件。\n                // 此处 ie11 下会报参数错误，\n                try {\n                    data = dataTransfer.getData('text/html');\n                } catch( err ) {\n                }\n\n                if ( data ) {\n                    return;\n                }\n\n                me._getTansferFiles( dataTransfer, function( results ) {\n                    me.trigger( 'drop', $.map( results, function( file ) {\n                        return new File( ruid, file );\n                    }) );\n                });\n\n                me.dndOver = false;\n                me.elem.removeClass( prefix + 'over' );\n                return false;\n            },\n\n            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n            _getTansferFiles: function( dataTransfer, callback ) {\n                var results  = [],\n                    promises = [],\n                    items, files, file, item, i, len, canAccessFolder;\n\n                items = dataTransfer.items;\n                files = dataTransfer.files;\n\n                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n\n                for ( i = 0, len = files.length; i < len; i++ ) {\n                    file = files[ i ];\n                    item = items && items[ i ];\n\n                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n\n                        promises.push( this._traverseDirectoryTree(\n                                item.webkitGetAsEntry(), results ) );\n                    } else {\n                        results.push( file );\n                    }\n                }\n\n                Base.when.apply( Base, promises ).done(function() {\n\n                    if ( !results.length ) {\n                        return;\n                    }\n\n                    callback( results );\n                });\n            },\n\n            _traverseDirectoryTree: function( entry, results ) {\n                var deferred = Base.Deferred(),\n                    me = this;\n\n                if ( entry.isFile ) {\n                    entry.file(function( file ) {\n                        results.push( file );\n                        deferred.resolve();\n                    });\n                } else if ( entry.isDirectory ) {\n                    entry.createReader().readEntries(function( entries ) {\n                        var len = entries.length,\n                            promises = [],\n                            arr = [],    // 为了保证顺序。\n                            i;\n\n                        for ( i = 0; i < len; i++ ) {\n                            promises.push( me._traverseDirectoryTree(\n                                    entries[ i ], arr ) );\n                        }\n\n                        Base.when.apply( Base, promises ).then(function() {\n                            results.push.apply( results, arr );\n                            deferred.resolve();\n                        }, deferred.reject );\n                    });\n                }\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                var elem = this.elem;\n\n                // 还没 init 就调用 destroy\n                if (!elem) {\n                    return;\n                }\n\n                elem.off( 'dragenter', this.dragEnterHandler );\n                elem.off( 'dragover', this.dragOverHandler );\n                elem.off( 'dragleave', this.dragLeaveHandler );\n                elem.off( 'drop', this.dropHandler );\n\n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).off( 'dragover', this.dragOverHandler );\n                    $( document ).off( 'drop', this.dropHandler );\n                }\n            }\n        });\n    });\n\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/filepaste',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n\n        return Html5Runtime.register( 'FilePaste', {\n            init: function() {\n                var opts = this.options,\n                    elem = this.elem = opts.container,\n                    accept = '.*',\n                    arr, i, len, item;\n\n                // accetp的mimeTypes中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].mimeTypes;\n                        item && arr.push( item );\n                    }\n\n                    if ( arr.length ) {\n                        accept = arr.join(',');\n                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n                    }\n                }\n                this.accept = accept = new RegExp( accept, 'i' );\n                this.hander = Base.bindFn( this._pasteHander, this );\n                elem.on( 'paste', this.hander );\n            },\n\n            _pasteHander: function( e ) {\n                var allowed = [],\n                    ruid = this.getRuid(),\n                    items, item, blob, i, len;\n\n                e = e.originalEvent || e;\n                items = e.clipboardData.items;\n\n                for ( i = 0, len = items.length; i < len; i++ ) {\n                    item = items[ i ];\n\n                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n                        continue;\n                    }\n\n                    allowed.push( new File( ruid, blob ) );\n                }\n\n                if ( allowed.length ) {\n                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.trigger( 'paste', allowed );\n                }\n            },\n\n            destroy: function() {\n                this.elem.off( 'paste', this.hander );\n            }\n        });\n    });\n\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/html5/filepicker',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n\n        var $ = Base.$;\n\n        return Html5Runtime.register( 'FilePicker', {\n            init: function() {\n                var container = this.getRuntime().getContainer(),\n                    me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    label = this.label = $( document.createElement('label') ),\n                    input =  this.input = $( document.createElement('input') ),\n                    arr, i, len, mouseHandler;\n\n                input.attr( 'type', 'file' );\n                //console.log(opts.name)\n                input.attr( 'name', 'file' );\n                input.addClass('webuploader-element-invisible');\n\n                label.on( 'click', function() {\n                    input.trigger('click');\n                });\n\n                label.css({\n                    opacity: 0,\n                    width: '100%',\n                    height: '100%',\n                    display: 'block',\n                    cursor: 'pointer',\n                    background: '#ffffff'\n                });\n\n                if ( opts.multiple ) {\n                    input.attr( 'multiple', 'multiple' );\n                }\n\n                // @todo Firefox不支持单独指定后缀\n                if ( opts.accept && opts.accept.length > 0 ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        arr.push( opts.accept[ i ].mimeTypes );\n                    }\n\n                    input.attr( 'accept', arr.join(',') );\n                }\n\n                container.append( input );\n                container.append( label );\n\n                mouseHandler = function( e ) {\n                    owner.trigger( e.type );\n                };\n\n                input.on( 'change', function( e ) {\n                    var fn = arguments.callee,\n                        clone;\n\n                    me.files = e.target.files;\n\n                    // reset input\n                    clone = this.cloneNode( true );\n                    clone.value = null;\n                    this.parentNode.replaceChild( clone, this );\n\n                    input.off();\n                    input = $( clone ).on( 'change', fn )\n                            .on( 'mouseenter mouseleave', mouseHandler );\n\n                    owner.trigger('change');\n                });\n\n                label.on( 'mouseenter mouseleave', mouseHandler );\n\n            },\n\n\n            getFiles: function() {\n                return this.files;\n            },\n\n            destroy: function() {\n                this.input.off();\n                this.label.off();\n            }\n        });\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/util',[\n        'base'\n    ], function( Base ) {\n\n        var urlAPI = window.createObjectURL && window ||\n                window.URL && URL.revokeObjectURL && URL ||\n                window.webkitURL,\n            createObjectURL = Base.noop,\n            revokeObjectURL = createObjectURL;\n\n        if ( urlAPI ) {\n\n            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n            createObjectURL = function() {\n                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n            };\n\n            revokeObjectURL = function() {\n                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n            };\n        }\n\n        return {\n            createObjectURL: createObjectURL,\n            revokeObjectURL: revokeObjectURL,\n\n            dataURL2Blob: function( dataURI ) {\n                var byteStr, intArray, ab, i, mimetype, parts;\n\n                parts = dataURI.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n\n                ab = new ArrayBuffer( byteStr.length );\n                intArray = new Uint8Array( ab );\n\n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n\n                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n\n                return this.arrayBufferToBlob( ab, mimetype );\n            },\n\n            dataURL2ArrayBuffer: function( dataURI ) {\n                var byteStr, intArray, i, parts;\n\n                parts = dataURI.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n\n                intArray = new Uint8Array( byteStr.length );\n\n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n\n                return intArray.buffer;\n            },\n\n            arrayBufferToBlob: function( buffer, type ) {\n                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n                    bb;\n\n                // android不支持直接new Blob, 只能借助blobbuilder.\n                if ( builder ) {\n                    bb = new builder();\n                    bb.append( buffer );\n                    return bb.getBlob( type );\n                }\n\n                return new Blob([ buffer ], type ? { type: type } : {} );\n            },\n\n            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n            // 你得到的结果是png.\n            canvasToDataUrl: function( canvas, type, quality ) {\n                return canvas.toDataURL( type, quality / 100 );\n            },\n\n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            parseMeta: function( blob, callback ) {\n                callback( false, {});\n            },\n\n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            updateImageHead: function( data ) {\n                return data;\n            }\n        };\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/imagemeta',[\n        'runtime/html5/util'\n    ], function( Util ) {\n\n        var api;\n\n        api = {\n            parsers: {\n                0xffe1: []\n            },\n\n            maxMetaDataSize: 262144,\n\n            parse: function( blob, cb ) {\n                var me = this,\n                    fr = new FileReader();\n\n                fr.onload = function() {\n                    cb( false, me._parse( this.result ) );\n                    fr = fr.onload = fr.onerror = null;\n                };\n\n                fr.onerror = function( e ) {\n                    cb( e.message );\n                    fr = fr.onload = fr.onerror = null;\n                };\n\n                blob = blob.slice( 0, me.maxMetaDataSize );\n                fr.readAsArrayBuffer( blob.getSource() );\n            },\n\n            _parse: function( buffer, noParse ) {\n                if ( buffer.byteLength < 6 ) {\n                    return;\n                }\n\n                var dataview = new DataView( buffer ),\n                    offset = 2,\n                    maxOffset = dataview.byteLength - 4,\n                    headLength = offset,\n                    ret = {},\n                    markerBytes, markerLength, parsers, i;\n\n                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n\n                    while ( offset < maxOffset ) {\n                        markerBytes = dataview.getUint16( offset );\n\n                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n                                markerBytes === 0xfffe ) {\n\n                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n\n                            if ( offset + markerLength > dataview.byteLength ) {\n                                break;\n                            }\n\n                            parsers = api.parsers[ markerBytes ];\n\n                            if ( !noParse && parsers ) {\n                                for ( i = 0; i < parsers.length; i += 1 ) {\n                                    parsers[ i ].call( api, dataview, offset,\n                                            markerLength, ret );\n                                }\n                            }\n\n                            offset += markerLength;\n                            headLength = offset;\n                        } else {\n                            break;\n                        }\n                    }\n\n                    if ( headLength > 6 ) {\n                        if ( buffer.slice ) {\n                            ret.imageHead = buffer.slice( 2, headLength );\n                        } else {\n                            // Workaround for IE10, which does not yet\n                            // support ArrayBuffer.slice:\n                            ret.imageHead = new Uint8Array( buffer )\n                                    .subarray( 2, headLength );\n                        }\n                    }\n                }\n\n                return ret;\n            },\n\n            updateImageHead: function( buffer, head ) {\n                var data = this._parse( buffer, true ),\n                    buf1, buf2, bodyoffset;\n\n\n                bodyoffset = 2;\n                if ( data.imageHead ) {\n                    bodyoffset = 2 + data.imageHead.byteLength;\n                }\n\n                if ( buffer.slice ) {\n                    buf2 = buffer.slice( bodyoffset );\n                } else {\n                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n                }\n\n                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n\n                buf1[ 0 ] = 0xFF;\n                buf1[ 1 ] = 0xD8;\n                buf1.set( new Uint8Array( head ), 2 );\n                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n\n                return buf1.buffer;\n            }\n        };\n\n        Util.parseMeta = function() {\n            return api.parse.apply( api, arguments );\n        };\n\n        Util.updateImageHead = function() {\n            return api.updateImageHead.apply( api, arguments );\n        };\n\n        return api;\n    });\n    /**\n     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n     * 暂时项目中只用了orientation.\n     *\n     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n     * @fileOverview EXIF解析\n     */\n\n    // Sample\n    // ====================================\n    // Make : Apple\n    // Model : iPhone 4S\n    // Orientation : 1\n    // XResolution : 72 [72/1]\n    // YResolution : 72 [72/1]\n    // ResolutionUnit : 2\n    // Software : QuickTime 7.7.1\n    // DateTime : 2013:09:01 22:53:55\n    // ExifIFDPointer : 190\n    // ExposureTime : 0.058823529411764705 [1/17]\n    // FNumber : 2.4 [12/5]\n    // ExposureProgram : Normal program\n    // ISOSpeedRatings : 800\n    // ExifVersion : 0220\n    // DateTimeOriginal : 2013:09:01 22:52:51\n    // DateTimeDigitized : 2013:09:01 22:52:51\n    // ComponentsConfiguration : YCbCr\n    // ShutterSpeedValue : 4.058893515764426\n    // ApertureValue : 2.5260688216892597 [4845/1918]\n    // BrightnessValue : -0.3126686601998395\n    // MeteringMode : Pattern\n    // Flash : Flash did not fire, compulsory flash mode\n    // FocalLength : 4.28 [107/25]\n    // SubjectArea : [4 values]\n    // FlashpixVersion : 0100\n    // ColorSpace : 1\n    // PixelXDimension : 2448\n    // PixelYDimension : 3264\n    // SensingMethod : One-chip color area sensor\n    // ExposureMode : 0\n    // WhiteBalance : Auto white balance\n    // FocalLengthIn35mmFilm : 35\n    // SceneCaptureType : Standard\n    define('runtime/html5/imagemeta/exif',[\n        'base',\n        'runtime/html5/imagemeta'\n    ], function( Base, ImageMeta ) {\n\n        var EXIF = {};\n\n        EXIF.ExifMap = function() {\n            return this;\n        };\n\n        EXIF.ExifMap.prototype.map = {\n            'Orientation': 0x0112\n        };\n\n        EXIF.ExifMap.prototype.get = function( id ) {\n            return this[ id ] || this[ this.map[ id ] ];\n        };\n\n        EXIF.exifTagTypes = {\n            // byte, 8-bit unsigned int:\n            1: {\n                getValue: function( dataView, dataOffset ) {\n                    return dataView.getUint8( dataOffset );\n                },\n                size: 1\n            },\n\n            // ascii, 8-bit byte:\n            2: {\n                getValue: function( dataView, dataOffset ) {\n                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n                },\n                size: 1,\n                ascii: true\n            },\n\n            // short, 16 bit int:\n            3: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint16( dataOffset, littleEndian );\n                },\n                size: 2\n            },\n\n            // long, 32 bit int:\n            4: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n\n            // rational = two long values,\n            // first is numerator, second is denominator:\n            5: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian ) /\n                        dataView.getUint32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            },\n\n            // slong, 32 bit signed int:\n            9: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n\n            // srational, two slongs, first is numerator, second is denominator:\n            10: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian ) /\n                        dataView.getInt32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            }\n        };\n\n        // undefined, 8-bit byte, value depending on field:\n        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n\n        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n                littleEndian ) {\n\n            var tagType = EXIF.exifTagTypes[ type ],\n                tagSize, dataOffset, values, i, str, c;\n\n            if ( !tagType ) {\n                Base.log('Invalid Exif data: Invalid tag type.');\n                return;\n            }\n\n            tagSize = tagType.size * length;\n\n            // Determine if the value is contained in the dataOffset bytes,\n            // or if the value at the dataOffset is a pointer to the actual data:\n            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n                    littleEndian ) : (offset + 8);\n\n            if ( dataOffset + tagSize > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid data offset.');\n                return;\n            }\n\n            if ( length === 1 ) {\n                return tagType.getValue( dataView, dataOffset, littleEndian );\n            }\n\n            values = [];\n\n            for ( i = 0; i < length; i += 1 ) {\n                values[ i ] = tagType.getValue( dataView,\n                        dataOffset + i * tagType.size, littleEndian );\n            }\n\n            if ( tagType.ascii ) {\n                str = '';\n\n                // Concatenate the chars:\n                for ( i = 0; i < values.length; i += 1 ) {\n                    c = values[ i ];\n\n                    // Ignore the terminating NULL byte(s):\n                    if ( c === '\\u0000' ) {\n                        break;\n                    }\n                    str += c;\n                }\n\n                return str;\n            }\n            return values;\n        };\n\n        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n                data ) {\n\n            var tag = dataView.getUint16( offset, littleEndian );\n            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n                    littleEndian );\n        };\n\n        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n                littleEndian, data ) {\n\n            var tagsNumber, dirEndOffset, i;\n\n            if ( dirOffset + 6 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory offset.');\n                return;\n            }\n\n            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n\n            if ( dirEndOffset + 4 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory size.');\n                return;\n            }\n\n            for ( i = 0; i < tagsNumber; i += 1 ) {\n                this.parseExifTag( dataView, tiffOffset,\n                        dirOffset + 2 + 12 * i,    // tag offset\n                        littleEndian, data );\n            }\n\n            // Return the offset to the next directory:\n            return dataView.getUint32( dirEndOffset, littleEndian );\n        };\n\n        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n        //     var hexData,\n        //         i,\n        //         b;\n        //     if (!length || offset + length > dataView.byteLength) {\n        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n        //         return;\n        //     }\n        //     hexData = [];\n        //     for (i = 0; i < length; i += 1) {\n        //         b = dataView.getUint8(offset + i);\n        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n        //     }\n        //     return 'data:image/jpeg,%' + hexData.join('%');\n        // };\n\n        EXIF.parseExifData = function( dataView, offset, length, data ) {\n\n            var tiffOffset = offset + 10,\n                littleEndian, dirOffset;\n\n            // Check for the ASCII code for \"Exif\" (0x45786966):\n            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n                // No Exif data, might be XMP data instead\n                return;\n            }\n            if ( tiffOffset + 8 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid segment size.');\n                return;\n            }\n\n            // Check for the two null bytes:\n            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n                Base.log('Invalid Exif data: Missing byte alignment offset.');\n                return;\n            }\n\n            // Check the byte alignment:\n            switch ( dataView.getUint16( tiffOffset ) ) {\n                case 0x4949:\n                    littleEndian = true;\n                    break;\n\n                case 0x4D4D:\n                    littleEndian = false;\n                    break;\n\n                default:\n                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n                    return;\n            }\n\n            // Check for the TIFF tag marker (0x002A):\n            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n                Base.log('Invalid Exif data: Missing TIFF marker.');\n                return;\n            }\n\n            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n            // Create the exif object to store the tags:\n            data.exif = new EXIF.ExifMap();\n            // Parse the tags of the main image directory and retrieve the\n            // offset to the next directory, usually the thumbnail directory:\n            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n                    tiffOffset + dirOffset, littleEndian, data );\n\n            // 尝试读取缩略图\n            // if ( dirOffset ) {\n            //     thumbnailData = {exif: {}};\n            //     dirOffset = EXIF.parseExifTags(\n            //         dataView,\n            //         tiffOffset,\n            //         tiffOffset + dirOffset,\n            //         littleEndian,\n            //         thumbnailData\n            //     );\n\n            //     // Check for JPEG Thumbnail offset:\n            //     if (thumbnailData.exif[0x0201]) {\n            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n            //             dataView,\n            //             tiffOffset + thumbnailData.exif[0x0201],\n            //             thumbnailData.exif[0x0202] // Thumbnail data length\n            //         );\n            //     }\n            // }\n        };\n\n        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n        return EXIF;\n    });\n    /**\n     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n     * android里面toDataUrl('image/jpege')得到的结果却是png.\n     *\n     * 所以这里没辙，只能借助这个工具\n     * @fileOverview jpeg encoder\n     */\n    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n\n        /*\n          Copyright (c) 2008, Adobe Systems Incorporated\n          All rights reserved.\n\n          Redistribution and use in source and binary forms, with or without\n          modification, are permitted provided that the following conditions are\n          met:\n\n          * Redistributions of source code must retain the above copyright notice,\n            this list of conditions and the following disclaimer.\n\n          * Redistributions in binary form must reproduce the above copyright\n            notice, this list of conditions and the following disclaimer in the\n            documentation and/or other materials provided with the distribution.\n\n          * Neither the name of Adobe Systems Incorporated nor the names of its\n            contributors may be used to endorse or promote products derived from\n            this software without specific prior written permission.\n\n          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n        */\n        /*\n        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n\n        Basic GUI blocking jpeg encoder\n        */\n\n        function JPEGEncoder(quality) {\n          var self = this;\n            var fround = Math.round;\n            var ffloor = Math.floor;\n            var YTable = new Array(64);\n            var UVTable = new Array(64);\n            var fdtbl_Y = new Array(64);\n            var fdtbl_UV = new Array(64);\n            var YDC_HT;\n            var UVDC_HT;\n            var YAC_HT;\n            var UVAC_HT;\n\n            var bitcode = new Array(65535);\n            var category = new Array(65535);\n            var outputfDCTQuant = new Array(64);\n            var DU = new Array(64);\n            var byteout = [];\n            var bytenew = 0;\n            var bytepos = 7;\n\n            var YDU = new Array(64);\n            var UDU = new Array(64);\n            var VDU = new Array(64);\n            var clt = new Array(256);\n            var RGB_YUV_TABLE = new Array(2048);\n            var currentQuality;\n\n            var ZigZag = [\n                     0, 1, 5, 6,14,15,27,28,\n                     2, 4, 7,13,16,26,29,42,\n                     3, 8,12,17,25,30,41,43,\n                     9,11,18,24,31,40,44,53,\n                    10,19,23,32,39,45,52,54,\n                    20,22,33,38,46,51,55,60,\n                    21,34,37,47,50,56,59,61,\n                    35,36,48,49,57,58,62,63\n                ];\n\n            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n            var std_ac_luminance_values = [\n                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n\n            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n            var std_ac_chrominance_values = [\n                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n\n            function initQuantTables(sf){\n                    var YQT = [\n                        16, 11, 10, 16, 24, 40, 51, 61,\n                        12, 12, 14, 19, 26, 58, 60, 55,\n                        14, 13, 16, 24, 40, 57, 69, 56,\n                        14, 17, 22, 29, 51, 87, 80, 62,\n                        18, 22, 37, 56, 68,109,103, 77,\n                        24, 35, 55, 64, 81,104,113, 92,\n                        49, 64, 78, 87,103,121,120,101,\n                        72, 92, 95, 98,112,100,103, 99\n                    ];\n\n                    for (var i = 0; i < 64; i++) {\n                        var t = ffloor((YQT[i]*sf+50)/100);\n                        if (t < 1) {\n                            t = 1;\n                        } else if (t > 255) {\n                            t = 255;\n                        }\n                        YTable[ZigZag[i]] = t;\n                    }\n                    var UVQT = [\n                        17, 18, 24, 47, 99, 99, 99, 99,\n                        18, 21, 26, 66, 99, 99, 99, 99,\n                        24, 26, 56, 99, 99, 99, 99, 99,\n                        47, 66, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99\n                    ];\n                    for (var j = 0; j < 64; j++) {\n                        var u = ffloor((UVQT[j]*sf+50)/100);\n                        if (u < 1) {\n                            u = 1;\n                        } else if (u > 255) {\n                            u = 255;\n                        }\n                        UVTable[ZigZag[j]] = u;\n                    }\n                    var aasf = [\n                        1.0, 1.387039845, 1.306562965, 1.175875602,\n                        1.0, 0.785694958, 0.541196100, 0.275899379\n                    ];\n                    var k = 0;\n                    for (var row = 0; row < 8; row++)\n                    {\n                        for (var col = 0; col < 8; col++)\n                        {\n                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            k++;\n                        }\n                    }\n                }\n\n                function computeHuffmanTbl(nrcodes, std_table){\n                    var codevalue = 0;\n                    var pos_in_table = 0;\n                    var HT = new Array();\n                    for (var k = 1; k <= 16; k++) {\n                        for (var j = 1; j <= nrcodes[k]; j++) {\n                            HT[std_table[pos_in_table]] = [];\n                            HT[std_table[pos_in_table]][0] = codevalue;\n                            HT[std_table[pos_in_table]][1] = k;\n                            pos_in_table++;\n                            codevalue++;\n                        }\n                        codevalue*=2;\n                    }\n                    return HT;\n                }\n\n                function initHuffmanTbl()\n                {\n                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n                }\n\n                function initCategoryNumber()\n                {\n                    var nrlower = 1;\n                    var nrupper = 2;\n                    for (var cat = 1; cat <= 15; cat++) {\n                        //Positive numbers\n                        for (var nr = nrlower; nr<nrupper; nr++) {\n                            category[32767+nr] = cat;\n                            bitcode[32767+nr] = [];\n                            bitcode[32767+nr][1] = cat;\n                            bitcode[32767+nr][0] = nr;\n                        }\n                        //Negative numbers\n                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n                            category[32767+nrneg] = cat;\n                            bitcode[32767+nrneg] = [];\n                            bitcode[32767+nrneg][1] = cat;\n                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n                        }\n                        nrlower <<= 1;\n                        nrupper <<= 1;\n                    }\n                }\n\n                function initRGBYUVTable() {\n                    for(var i = 0; i < 256;i++) {\n                        RGB_YUV_TABLE[i]            =  19595 * i;\n                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n                    }\n                }\n\n                // IO functions\n                function writeBits(bs)\n                {\n                    var value = bs[0];\n                    var posval = bs[1]-1;\n                    while ( posval >= 0 ) {\n                        if (value & (1 << posval) ) {\n                            bytenew |= (1 << bytepos);\n                        }\n                        posval--;\n                        bytepos--;\n                        if (bytepos < 0) {\n                            if (bytenew == 0xFF) {\n                                writeByte(0xFF);\n                                writeByte(0);\n                            }\n                            else {\n                                writeByte(bytenew);\n                            }\n                            bytepos=7;\n                            bytenew=0;\n                        }\n                    }\n                }\n\n                function writeByte(value)\n                {\n                    byteout.push(clt[value]); // write char directly instead of converting later\n                }\n\n                function writeWord(value)\n                {\n                    writeByte((value>>8)&0xFF);\n                    writeByte((value   )&0xFF);\n                }\n\n                // DCT & quantization core\n                function fDCTQuant(data, fdtbl)\n                {\n                    var d0, d1, d2, d3, d4, d5, d6, d7;\n                    /* Pass 1: process rows. */\n                    var dataOff=0;\n                    var i;\n                    var I8 = 8;\n                    var I64 = 64;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff+1];\n                        d2 = data[dataOff+2];\n                        d3 = data[dataOff+3];\n                        d4 = data[dataOff+4];\n                        d5 = data[dataOff+5];\n                        d6 = data[dataOff+6];\n                        d7 = data[dataOff+7];\n\n                        var tmp0 = d0 + d7;\n                        var tmp7 = d0 - d7;\n                        var tmp1 = d1 + d6;\n                        var tmp6 = d1 - d6;\n                        var tmp2 = d2 + d5;\n                        var tmp5 = d2 - d5;\n                        var tmp3 = d3 + d4;\n                        var tmp4 = d3 - d4;\n\n                        /* Even part */\n                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n                        var tmp13 = tmp0 - tmp3;\n                        var tmp11 = tmp1 + tmp2;\n                        var tmp12 = tmp1 - tmp2;\n\n                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n                        data[dataOff+4] = tmp10 - tmp11;\n\n                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n                        data[dataOff+6] = tmp13 - z1;\n\n                        /* Odd part */\n                        tmp10 = tmp4 + tmp5; /* phase 2 */\n                        tmp11 = tmp5 + tmp6;\n                        tmp12 = tmp6 + tmp7;\n\n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n                        var z3 = tmp11 * 0.707106781; /* c4 */\n\n                        var z11 = tmp7 + z3;    /* phase 5 */\n                        var z13 = tmp7 - z3;\n\n                        data[dataOff+5] = z13 + z2; /* phase 6 */\n                        data[dataOff+3] = z13 - z2;\n                        data[dataOff+1] = z11 + z4;\n                        data[dataOff+7] = z11 - z4;\n\n                        dataOff += 8; /* advance pointer to next row */\n                    }\n\n                    /* Pass 2: process columns. */\n                    dataOff = 0;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff + 8];\n                        d2 = data[dataOff + 16];\n                        d3 = data[dataOff + 24];\n                        d4 = data[dataOff + 32];\n                        d5 = data[dataOff + 40];\n                        d6 = data[dataOff + 48];\n                        d7 = data[dataOff + 56];\n\n                        var tmp0p2 = d0 + d7;\n                        var tmp7p2 = d0 - d7;\n                        var tmp1p2 = d1 + d6;\n                        var tmp6p2 = d1 - d6;\n                        var tmp2p2 = d2 + d5;\n                        var tmp5p2 = d2 - d5;\n                        var tmp3p2 = d3 + d4;\n                        var tmp4p2 = d3 - d4;\n\n                        /* Even part */\n                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n                        var tmp13p2 = tmp0p2 - tmp3p2;\n                        var tmp11p2 = tmp1p2 + tmp2p2;\n                        var tmp12p2 = tmp1p2 - tmp2p2;\n\n                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n                        data[dataOff+32] = tmp10p2 - tmp11p2;\n\n                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n                        data[dataOff+48] = tmp13p2 - z1p2;\n\n                        /* Odd part */\n                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n                        tmp11p2 = tmp5p2 + tmp6p2;\n                        tmp12p2 = tmp6p2 + tmp7p2;\n\n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n\n                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n                        var z13p2 = tmp7p2 - z3p2;\n\n                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n                        data[dataOff+24] = z13p2 - z2p2;\n                        data[dataOff+ 8] = z11p2 + z4p2;\n                        data[dataOff+56] = z11p2 - z4p2;\n\n                        dataOff++; /* advance pointer to next column */\n                    }\n\n                    // Quantize/descale the coefficients\n                    var fDCTQuant;\n                    for (i=0; i<I64; ++i)\n                    {\n                        // Apply the quantization and scaling factor & Round to nearest integer\n                        fDCTQuant = data[i]*fdtbl[i];\n                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n                        //outputfDCTQuant[i] = fround(fDCTQuant);\n\n                    }\n                    return outputfDCTQuant;\n                }\n\n                function writeAPP0()\n                {\n                    writeWord(0xFFE0); // marker\n                    writeWord(16); // length\n                    writeByte(0x4A); // J\n                    writeByte(0x46); // F\n                    writeByte(0x49); // I\n                    writeByte(0x46); // F\n                    writeByte(0); // = \"JFIF\",'\\0'\n                    writeByte(1); // versionhi\n                    writeByte(1); // versionlo\n                    writeByte(0); // xyunits\n                    writeWord(1); // xdensity\n                    writeWord(1); // ydensity\n                    writeByte(0); // thumbnwidth\n                    writeByte(0); // thumbnheight\n                }\n\n                function writeSOF0(width, height)\n                {\n                    writeWord(0xFFC0); // marker\n                    writeWord(17);   // length, truecolor YUV JPG\n                    writeByte(8);    // precision\n                    writeWord(height);\n                    writeWord(width);\n                    writeByte(3);    // nrofcomponents\n                    writeByte(1);    // IdY\n                    writeByte(0x11); // HVY\n                    writeByte(0);    // QTY\n                    writeByte(2);    // IdU\n                    writeByte(0x11); // HVU\n                    writeByte(1);    // QTU\n                    writeByte(3);    // IdV\n                    writeByte(0x11); // HVV\n                    writeByte(1);    // QTV\n                }\n\n                function writeDQT()\n                {\n                    writeWord(0xFFDB); // marker\n                    writeWord(132);    // length\n                    writeByte(0);\n                    for (var i=0; i<64; i++) {\n                        writeByte(YTable[i]);\n                    }\n                    writeByte(1);\n                    for (var j=0; j<64; j++) {\n                        writeByte(UVTable[j]);\n                    }\n                }\n\n                function writeDHT()\n                {\n                    writeWord(0xFFC4); // marker\n                    writeWord(0x01A2); // length\n\n                    writeByte(0); // HTYDCinfo\n                    for (var i=0; i<16; i++) {\n                        writeByte(std_dc_luminance_nrcodes[i+1]);\n                    }\n                    for (var j=0; j<=11; j++) {\n                        writeByte(std_dc_luminance_values[j]);\n                    }\n\n                    writeByte(0x10); // HTYACinfo\n                    for (var k=0; k<16; k++) {\n                        writeByte(std_ac_luminance_nrcodes[k+1]);\n                    }\n                    for (var l=0; l<=161; l++) {\n                        writeByte(std_ac_luminance_values[l]);\n                    }\n\n                    writeByte(1); // HTUDCinfo\n                    for (var m=0; m<16; m++) {\n                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n                    }\n                    for (var n=0; n<=11; n++) {\n                        writeByte(std_dc_chrominance_values[n]);\n                    }\n\n                    writeByte(0x11); // HTUACinfo\n                    for (var o=0; o<16; o++) {\n                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n                    }\n                    for (var p=0; p<=161; p++) {\n                        writeByte(std_ac_chrominance_values[p]);\n                    }\n                }\n\n                function writeSOS()\n                {\n                    writeWord(0xFFDA); // marker\n                    writeWord(12); // length\n                    writeByte(3); // nrofcomponents\n                    writeByte(1); // IdY\n                    writeByte(0); // HTY\n                    writeByte(2); // IdU\n                    writeByte(0x11); // HTU\n                    writeByte(3); // IdV\n                    writeByte(0x11); // HTV\n                    writeByte(0); // Ss\n                    writeByte(0x3f); // Se\n                    writeByte(0); // Bf\n                }\n\n                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n                    var EOB = HTAC[0x00];\n                    var M16zeroes = HTAC[0xF0];\n                    var pos;\n                    var I16 = 16;\n                    var I63 = 63;\n                    var I64 = 64;\n                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n                    //ZigZag reorder\n                    for (var j=0;j<I64;++j) {\n                        DU[ZigZag[j]]=DU_DCT[j];\n                    }\n                    var Diff = DU[0] - DC; DC = DU[0];\n                    //Encode DC\n                    if (Diff==0) {\n                        writeBits(HTDC[0]); // Diff might be 0\n                    } else {\n                        pos = 32767+Diff;\n                        writeBits(HTDC[category[pos]]);\n                        writeBits(bitcode[pos]);\n                    }\n                    //Encode ACs\n                    var end0pos = 63; // was const... which is crazy\n                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n                    //end0pos = first element in reverse order !=0\n                    if ( end0pos == 0) {\n                        writeBits(EOB);\n                        return DC;\n                    }\n                    var i = 1;\n                    var lng;\n                    while ( i <= end0pos ) {\n                        var startpos = i;\n                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n                        var nrzeroes = i-startpos;\n                        if ( nrzeroes >= I16 ) {\n                            lng = nrzeroes>>4;\n                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n                                writeBits(M16zeroes);\n                            nrzeroes = nrzeroes&0xF;\n                        }\n                        pos = 32767+DU[i];\n                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n                        writeBits(bitcode[pos]);\n                        i++;\n                    }\n                    if ( end0pos != I63 ) {\n                        writeBits(EOB);\n                    }\n                    return DC;\n                }\n\n                function initCharLookupTable(){\n                    var sfcc = String.fromCharCode;\n                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n                        clt[i] = sfcc(i);\n                    }\n                }\n\n                this.encode = function(image,quality) // image data object\n                {\n                    // var time_start = new Date().getTime();\n\n                    if(quality) setQuality(quality);\n\n                    // Initialize bit writer\n                    byteout = new Array();\n                    bytenew=0;\n                    bytepos=7;\n\n                    // Add JPEG headers\n                    writeWord(0xFFD8); // SOI\n                    writeAPP0();\n                    writeDQT();\n                    writeSOF0(image.width,image.height);\n                    writeDHT();\n                    writeSOS();\n\n\n                    // Encode 8x8 macroblocks\n                    var DCY=0;\n                    var DCU=0;\n                    var DCV=0;\n\n                    bytenew=0;\n                    bytepos=7;\n\n\n                    this.encode.displayName = \"_encode_\";\n\n                    var imageData = image.data;\n                    var width = image.width;\n                    var height = image.height;\n\n                    var quadWidth = width*4;\n                    var tripleWidth = width*3;\n\n                    var x, y = 0;\n                    var r, g, b;\n                    var start,p, col,row,pos;\n                    while(y < height){\n                        x = 0;\n                        while(x < quadWidth){\n                        start = quadWidth * y + x;\n                        p = start;\n                        col = -1;\n                        row = 0;\n\n                        for(pos=0; pos < 64; pos++){\n                            row = pos >> 3;// /8\n                            col = ( pos & 7 ) * 4; // %8\n                            p = start + ( row * quadWidth ) + col;\n\n                            if(y+row >= height){ // padding bottom\n                                p-= (quadWidth*(y+1+row-height));\n                            }\n\n                            if(x+col >= quadWidth){ // padding right\n                                p-= ((x+col) - quadWidth +4)\n                            }\n\n                            r = imageData[ p++ ];\n                            g = imageData[ p++ ];\n                            b = imageData[ p++ ];\n\n\n                            /* // calculate YUV values dynamically\n                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n                            */\n\n                            // use lookup table (slightly faster)\n                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n\n                        }\n\n                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n                        x+=32;\n                        }\n                        y+=8;\n                    }\n\n\n                    ////////////////////////////////////////////////////////////////\n\n                    // Do the bit alignment of the EOI marker\n                    if ( bytepos >= 0 ) {\n                        var fillbits = [];\n                        fillbits[1] = bytepos+1;\n                        fillbits[0] = (1<<(bytepos+1))-1;\n                        writeBits(fillbits);\n                    }\n\n                    writeWord(0xFFD9); //EOI\n\n                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n\n                    byteout = [];\n\n                    // benchmarking\n                    // var duration = new Date().getTime() - time_start;\n                    // console.log('Encoding time: '+ currentQuality + 'ms');\n                    //\n\n                    return jpegDataUri\n            }\n\n            function setQuality(quality){\n                if (quality <= 0) {\n                    quality = 1;\n                }\n                if (quality > 100) {\n                    quality = 100;\n                }\n\n                if(currentQuality == quality) return // don't recalc if unchanged\n\n                var sf = 0;\n                if (quality < 50) {\n                    sf = Math.floor(5000 / quality);\n                } else {\n                    sf = Math.floor(200 - quality*2);\n                }\n\n                initQuantTables(sf);\n                currentQuality = quality;\n                // console.log('Quality set to: '+quality +'%');\n            }\n\n            function init(){\n                // var time_start = new Date().getTime();\n                if(!quality) quality = 50;\n                // Create tables\n                initCharLookupTable()\n                initHuffmanTbl();\n                initCategoryNumber();\n                initRGBYUVTable();\n\n                setQuality(quality);\n                // var duration = new Date().getTime() - time_start;\n                // console.log('Initialization '+ duration + 'ms');\n            }\n\n            init();\n\n        }\n\n        JPEGEncoder.encode = function( data, quality ) {\n            var encoder = new JPEGEncoder( quality );\n\n            return encoder.encode( data );\n        }\n\n        return JPEGEncoder;\n    });\n    /**\n     * @fileOverview Fix android canvas.toDataUrl bug.\n     */\n    define('runtime/html5/androidpatch',[\n        'runtime/html5/util',\n        'runtime/html5/jpegencoder',\n        'base'\n    ], function( Util, encoder, Base ) {\n        var origin = Util.canvasToDataUrl,\n            supportJpeg;\n\n        Util.canvasToDataUrl = function( canvas, type, quality ) {\n            var ctx, w, h, fragement, parts;\n\n            // 非android手机直接跳过。\n            if ( !Base.os.android ) {\n                return origin.apply( null, arguments );\n            }\n\n            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n            // JPEG 前两位分别是：255, 216\n            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n                fragement = origin.apply( null, arguments );\n\n                parts = fragement.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    fragement = atob( parts[ 1 ] );\n                } else {\n                    fragement = decodeURIComponent( parts[ 1 ] );\n                }\n\n                fragement = fragement.substring( 0, 2 );\n\n                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n                        fragement.charCodeAt( 1 ) === 216;\n            }\n\n            // 只有在android环境下才修复\n            if ( type === 'image/jpeg' && !supportJpeg ) {\n                w = canvas.width;\n                h = canvas.height;\n                ctx = canvas.getContext('2d');\n\n                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n            }\n\n            return origin.apply( null, arguments );\n        };\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('runtime/html5/image',[\n        'base',\n        'runtime/html5/runtime',\n        'runtime/html5/util'\n    ], function( Base, Html5Runtime, Util ) {\n\n        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n\n        return Html5Runtime.register( 'Image', {\n\n            // flag: 标记是否被修改过。\n            modified: false,\n\n            init: function() {\n                var me = this,\n                    img = new Image();\n\n                img.onload = function() {\n\n                    me._info = {\n                        type: me.type,\n                        width: this.width,\n                        height: this.height\n                    };\n\n                    // 读取meta信息。\n                    if ( !me._metas && 'image/jpeg' === me.type ) {\n                        Util.parseMeta( me._blob, function( error, ret ) {\n                            me._metas = ret;\n                            me.owner.trigger('load');\n                        });\n                    } else {\n                        me.owner.trigger('load');\n                    }\n                };\n\n                img.onerror = function() {\n                    me.owner.trigger('error');\n                };\n\n                me._img = img;\n            },\n\n            loadFromBlob: function( blob ) {\n                var me = this,\n                    img = me._img;\n\n                me._blob = blob;\n                me.type = blob.type;\n                img.src = Util.createObjectURL( blob.getSource() );\n                me.owner.once( 'load', function() {\n                    Util.revokeObjectURL( img.src );\n                });\n            },\n\n            resize: function( width, height ) {\n                var canvas = this._canvas ||\n                        (this._canvas = document.createElement('canvas'));\n\n                this._resize( this._img, canvas, width, height );\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'resize' );\n            },\n\n            crop: function( x, y, w, h, s ) {\n                var cvs = this._canvas ||\n                        (this._canvas = document.createElement('canvas')),\n                    opts = this.options,\n                    img = this._img,\n                    iw = img.naturalWidth,\n                    ih = img.naturalHeight,\n                    orientation = this.getOrientation();\n\n                s = s || 1;\n\n                // todo 解决 orientation 的问题。\n                // values that require 90 degree rotation\n                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\n                //     switch ( orientation ) {\n                //         case 6:\n                //             tmp = x;\n                //             x = y;\n                //             y = iw * s - tmp - w;\n                //             console.log(ih * s, tmp, w)\n                //             break;\n                //     }\n\n                //     (w ^= h, h ^= w, w ^= h);\n                // }\n\n                cvs.width = w;\n                cvs.height = h;\n\n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'crop' );\n            },\n\n            getAsBlob: function( type ) {\n                var blob = this._blob,\n                    opts = this.options,\n                    canvas;\n\n                type = type || this.type;\n\n                // blob需要重新生成。\n                if ( this.modified || this.type !== type ) {\n                    canvas = this._canvas;\n\n                    if ( type === 'image/jpeg' ) {\n\n                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n\n                        if ( opts.preserveHeaders && this._metas &&\n                                this._metas.imageHead ) {\n\n                            blob = Util.dataURL2ArrayBuffer( blob );\n                            blob = Util.updateImageHead( blob,\n                                    this._metas.imageHead );\n                            blob = Util.arrayBufferToBlob( blob, type );\n                            return blob;\n                        }\n                    } else {\n                        blob = Util.canvasToDataUrl( canvas, type );\n                    }\n\n                    blob = Util.dataURL2Blob( blob );\n                }\n\n                return blob;\n            },\n\n            getAsDataUrl: function( type ) {\n                var opts = this.options;\n\n                type = type || this.type;\n\n                if ( type === 'image/jpeg' ) {\n                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n                } else {\n                    return this._canvas.toDataURL( type );\n                }\n            },\n\n            getOrientation: function() {\n                return this._metas && this._metas.exif &&\n                        this._metas.exif.get('Orientation') || 1;\n            },\n\n            info: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n\n                // getter\n                return this._info;\n            },\n\n            meta: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n\n                // getter\n                return this._meta;\n            },\n\n            destroy: function() {\n                var canvas = this._canvas;\n                this._img.onload = null;\n\n                if ( canvas ) {\n                    canvas.getContext('2d')\n                            .clearRect( 0, 0, canvas.width, canvas.height );\n                    canvas.width = canvas.height = 0;\n                    this._canvas = null;\n                }\n\n                // 释放内存。非常重要，否则释放不了image的内存。\n                this._img.src = BLANK;\n                this._img = this._blob = null;\n            },\n\n            _resize: function( img, cvs, width, height ) {\n                var opts = this.options,\n                    naturalWidth = img.width,\n                    naturalHeight = img.height,\n                    orientation = this.getOrientation(),\n                    scale, w, h, x, y;\n\n                // values that require 90 degree rotation\n                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\n                    // 交换width, height的值。\n                    width ^= height;\n                    height ^= width;\n                    width ^= height;\n                }\n\n                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n                        height / naturalHeight );\n\n                // 不允许放大。\n                opts.allowMagnify || (scale = Math.min( 1, scale ));\n\n                w = naturalWidth * scale;\n                h = naturalHeight * scale;\n\n                if ( opts.crop ) {\n                    cvs.width = width;\n                    cvs.height = height;\n                } else {\n                    cvs.width = w;\n                    cvs.height = h;\n                }\n\n                x = (cvs.width - w) / 2;\n                y = (cvs.height - h) / 2;\n\n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\n                this._renderImageToCanvas( cvs, img, x, y, w, h );\n            },\n\n            _rotate2Orientaion: function( canvas, orientation ) {\n                var width = canvas.width,\n                    height = canvas.height,\n                    ctx = canvas.getContext('2d');\n\n                switch ( orientation ) {\n                    case 5:\n                    case 6:\n                    case 7:\n                    case 8:\n                        canvas.width = height;\n                        canvas.height = width;\n                        break;\n                }\n\n                switch ( orientation ) {\n                    case 2:    // horizontal flip\n                        ctx.translate( width, 0 );\n                        ctx.scale( -1, 1 );\n                        break;\n\n                    case 3:    // 180 rotate left\n                        ctx.translate( width, height );\n                        ctx.rotate( Math.PI );\n                        break;\n\n                    case 4:    // vertical flip\n                        ctx.translate( 0, height );\n                        ctx.scale( 1, -1 );\n                        break;\n\n                    case 5:    // vertical flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.scale( 1, -1 );\n                        break;\n\n                    case 6:    // 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( 0, -height );\n                        break;\n\n                    case 7:    // horizontal flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( width, -height );\n                        ctx.scale( -1, 1 );\n                        break;\n\n                    case 8:    // 90 rotate left\n                        ctx.rotate( -0.5 * Math.PI );\n                        ctx.translate( -width, 0 );\n                        break;\n                }\n            },\n\n            // https://github.com/stomita/ios-imagefile-megapixel/\n            // blob/master/src/megapix-image.js\n            _renderImageToCanvas: (function() {\n\n                // 如果不是ios, 不需要这么复杂！\n                if ( !Base.os.ios ) {\n                    return function( canvas ) {\n                        var args = Base.slice( arguments, 1 ),\n                            ctx = canvas.getContext('2d');\n\n                        ctx.drawImage.apply( ctx, args );\n                    };\n                }\n\n                /**\n                 * Detecting vertical squash in loaded image.\n                 * Fixes a bug which squash image vertically while drawing into\n                 * canvas for some images.\n                 */\n                function detectVerticalSquash( img, iw, ih ) {\n                    var canvas = document.createElement('canvas'),\n                        ctx = canvas.getContext('2d'),\n                        sy = 0,\n                        ey = ih,\n                        py = ih,\n                        data, alpha, ratio;\n\n\n                    canvas.width = 1;\n                    canvas.height = ih;\n                    ctx.drawImage( img, 0, 0 );\n                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n\n                    // search image edge pixel position in case\n                    // it is squashed vertically.\n                    while ( py > sy ) {\n                        alpha = data[ (py - 1) * 4 + 3 ];\n\n                        if ( alpha === 0 ) {\n                            ey = py;\n                        } else {\n                            sy = py;\n                        }\n\n                        py = (ey + sy) >> 1;\n                    }\n\n                    ratio = (py / ih);\n                    return (ratio === 0) ? 1 : ratio;\n                }\n\n                // fix ie7 bug\n                // http://stackoverflow.com/questions/11929099/\n                // html5-canvas-drawimage-ratio-bug-ios\n                if ( Base.os.ios >= 7 ) {\n                    return function( canvas, img, x, y, w, h ) {\n                        var iw = img.naturalWidth,\n                            ih = img.naturalHeight,\n                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n\n                        return canvas.getContext('2d').drawImage( img, 0, 0,\n                                iw * vertSquashRatio, ih * vertSquashRatio,\n                                x, y, w, h );\n                    };\n                }\n\n                /**\n                 * Detect subsampling in loaded image.\n                 * In iOS, larger images than 2M pixels may be\n                 * subsampled in rendering.\n                 */\n                function detectSubsampling( img ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        canvas, ctx;\n\n                    // subsampling may happen overmegapixel image\n                    if ( iw * ih > 1024 * 1024 ) {\n                        canvas = document.createElement('canvas');\n                        canvas.width = canvas.height = 1;\n                        ctx = canvas.getContext('2d');\n                        ctx.drawImage( img, -iw + 1, 0 );\n\n                        // subsampled image becomes half smaller in rendering size.\n                        // check alpha channel value to confirm image is covering\n                        // edge pixel or not. if alpha value is 0\n                        // image is not covering, hence subsampled.\n                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n                    } else {\n                        return false;\n                    }\n                }\n\n\n                return function( canvas, img, x, y, width, height ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        ctx = canvas.getContext('2d'),\n                        subsampled = detectSubsampling( img ),\n                        doSquash = this.type === 'image/jpeg',\n                        d = 1024,\n                        sy = 0,\n                        dy = 0,\n                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n\n                    if ( subsampled ) {\n                        iw /= 2;\n                        ih /= 2;\n                    }\n\n                    ctx.save();\n                    tmpCanvas = document.createElement('canvas');\n                    tmpCanvas.width = tmpCanvas.height = d;\n\n                    tmpCtx = tmpCanvas.getContext('2d');\n                    vertSquashRatio = doSquash ?\n                            detectVerticalSquash( img, iw, ih ) : 1;\n\n                    dw = Math.ceil( d * width / iw );\n                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n\n                    while ( sy < ih ) {\n                        sx = 0;\n                        dx = 0;\n                        while ( sx < iw ) {\n                            tmpCtx.clearRect( 0, 0, d, d );\n                            tmpCtx.drawImage( img, -sx, -sy );\n                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n                                    x + dx, y + dy, dw, dh );\n                            sx += d;\n                            dx += dw;\n                        }\n                        sy += d;\n                        dy += dh;\n                    }\n                    ctx.restore();\n                    tmpCanvas = tmpCtx = null;\n                };\n            })()\n        });\n    });\n    /**\n     * @fileOverview Transport\n     * @todo 支持chunked传输，优势：\n     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n     */\n    define('runtime/html5/transport',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n\n        var noop = Base.noop,\n            $ = Base.$;\n\n        return Html5Runtime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n            },\n\n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    formData, binary, fr;\n\n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n\n                    binary = blob.getSource();\n                } else {\n                    formData = new FormData();\n                    $.each( owner._formData, function( k, v ) {\n                        formData.append( k, v );\n                    });\n\n                    formData.append( opts.fileVal, blob.getSource(),\n                            opts.filename || owner._formData.name || '' );\n                }\n\n                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n                    xhr.open( opts.method, server, true );\n                    xhr.withCredentials = true;\n                } else {\n                    xhr.open( opts.method, server );\n                }\n\n                this._setRequestHeader( xhr, opts.headers );\n\n                if ( binary ) {\n                    // 强制设置成 content-type 为文件流。\n                    xhr.overrideMimeType &&\n                            xhr.overrideMimeType('application/octet-stream');\n\n                    // android直接发送blob会导致服务端接收到的是空文件。\n                    // bug详情。\n                    // https://code.google.com/p/android/issues/detail?id=39882\n                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n                    if ( Base.os.android ) {\n                        fr = new FileReader();\n\n                        fr.onload = function() {\n                            xhr.send( this.result );\n                            fr = fr.onload = null;\n                        };\n\n                        fr.readAsArrayBuffer( binary );\n                    } else {\n                        xhr.send( binary );\n                    }\n                } else {\n                    xhr.send( formData );\n                }\n            },\n\n            getResponse: function() {\n                return this._response;\n            },\n\n            getResponseAsJson: function() {\n                return this._parseJson( this._response );\n            },\n\n            getStatus: function() {\n                return this._status;\n            },\n\n            abort: function() {\n                var xhr = this._xhr;\n\n                if ( xhr ) {\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    xhr.abort();\n\n                    this._xhr = xhr = null;\n                }\n            },\n\n            destroy: function() {\n                this.abort();\n            },\n\n            _initAjax: function() {\n                var me = this,\n                    xhr = new XMLHttpRequest(),\n                    opts = this.options;\n\n                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n                        typeof XDomainRequest !== 'undefined' ) {\n                    xhr = new XDomainRequest();\n                }\n\n                xhr.upload.onprogress = function( e ) {\n                    var percentage = 0;\n\n                    if ( e.lengthComputable ) {\n                        percentage = e.loaded / e.total;\n                    }\n\n                    return me.trigger( 'progress', percentage );\n                };\n\n                xhr.onreadystatechange = function() {\n\n                    if ( xhr.readyState !== 4 ) {\n                        return;\n                    }\n\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    me._xhr = null;\n                    me._status = xhr.status;\n\n                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger('load');\n                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger( 'error', 'server' );\n                    }\n\n\n                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n                };\n\n                me._xhr = xhr;\n                return xhr;\n            },\n\n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.setRequestHeader( key, val );\n                });\n            },\n\n            _parseJson: function( str ) {\n                var json;\n\n                try {\n                    json = JSON.parse( str );\n                } catch ( ex ) {\n                    json = {};\n                }\n\n                return json;\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/html5/md5',[\n        'runtime/html5/runtime'\n    ], function( FlashRuntime ) {\n\n        /*\n         * Fastest md5 implementation around (JKM md5)\n         * Credits: Joseph Myers\n         *\n         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n         * @see http://jsperf.com/md5-shootout/7\n         */\n\n        /* this function is much faster,\n          so if possible we use it. Some IEs\n          are the only ones I know of that\n          need the idiotic second function,\n          generated by an if clause.  */\n        var add32 = function (a, b) {\n            return (a + b) & 0xFFFFFFFF;\n        },\n\n        cmn = function (q, a, b, x, s, t) {\n            a = add32(add32(a, q), add32(x, t));\n            return add32((a << s) | (a >>> (32 - s)), b);\n        },\n\n        ff = function (a, b, c, d, x, s, t) {\n            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n        },\n\n        gg = function (a, b, c, d, x, s, t) {\n            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n        },\n\n        hh = function (a, b, c, d, x, s, t) {\n            return cmn(b ^ c ^ d, a, b, x, s, t);\n        },\n\n        ii = function (a, b, c, d, x, s, t) {\n            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n        },\n\n        md5cycle = function (x, k) {\n            var a = x[0],\n                b = x[1],\n                c = x[2],\n                d = x[3];\n\n            a = ff(a, b, c, d, k[0], 7, -680876936);\n            d = ff(d, a, b, c, k[1], 12, -389564586);\n            c = ff(c, d, a, b, k[2], 17, 606105819);\n            b = ff(b, c, d, a, k[3], 22, -1044525330);\n            a = ff(a, b, c, d, k[4], 7, -176418897);\n            d = ff(d, a, b, c, k[5], 12, 1200080426);\n            c = ff(c, d, a, b, k[6], 17, -1473231341);\n            b = ff(b, c, d, a, k[7], 22, -45705983);\n            a = ff(a, b, c, d, k[8], 7, 1770035416);\n            d = ff(d, a, b, c, k[9], 12, -1958414417);\n            c = ff(c, d, a, b, k[10], 17, -42063);\n            b = ff(b, c, d, a, k[11], 22, -1990404162);\n            a = ff(a, b, c, d, k[12], 7, 1804603682);\n            d = ff(d, a, b, c, k[13], 12, -40341101);\n            c = ff(c, d, a, b, k[14], 17, -1502002290);\n            b = ff(b, c, d, a, k[15], 22, 1236535329);\n\n            a = gg(a, b, c, d, k[1], 5, -165796510);\n            d = gg(d, a, b, c, k[6], 9, -1069501632);\n            c = gg(c, d, a, b, k[11], 14, 643717713);\n            b = gg(b, c, d, a, k[0], 20, -373897302);\n            a = gg(a, b, c, d, k[5], 5, -701558691);\n            d = gg(d, a, b, c, k[10], 9, 38016083);\n            c = gg(c, d, a, b, k[15], 14, -660478335);\n            b = gg(b, c, d, a, k[4], 20, -405537848);\n            a = gg(a, b, c, d, k[9], 5, 568446438);\n            d = gg(d, a, b, c, k[14], 9, -1019803690);\n            c = gg(c, d, a, b, k[3], 14, -187363961);\n            b = gg(b, c, d, a, k[8], 20, 1163531501);\n            a = gg(a, b, c, d, k[13], 5, -1444681467);\n            d = gg(d, a, b, c, k[2], 9, -51403784);\n            c = gg(c, d, a, b, k[7], 14, 1735328473);\n            b = gg(b, c, d, a, k[12], 20, -1926607734);\n\n            a = hh(a, b, c, d, k[5], 4, -378558);\n            d = hh(d, a, b, c, k[8], 11, -2022574463);\n            c = hh(c, d, a, b, k[11], 16, 1839030562);\n            b = hh(b, c, d, a, k[14], 23, -35309556);\n            a = hh(a, b, c, d, k[1], 4, -1530992060);\n            d = hh(d, a, b, c, k[4], 11, 1272893353);\n            c = hh(c, d, a, b, k[7], 16, -155497632);\n            b = hh(b, c, d, a, k[10], 23, -1094730640);\n            a = hh(a, b, c, d, k[13], 4, 681279174);\n            d = hh(d, a, b, c, k[0], 11, -358537222);\n            c = hh(c, d, a, b, k[3], 16, -722521979);\n            b = hh(b, c, d, a, k[6], 23, 76029189);\n            a = hh(a, b, c, d, k[9], 4, -640364487);\n            d = hh(d, a, b, c, k[12], 11, -421815835);\n            c = hh(c, d, a, b, k[15], 16, 530742520);\n            b = hh(b, c, d, a, k[2], 23, -995338651);\n\n            a = ii(a, b, c, d, k[0], 6, -198630844);\n            d = ii(d, a, b, c, k[7], 10, 1126891415);\n            c = ii(c, d, a, b, k[14], 15, -1416354905);\n            b = ii(b, c, d, a, k[5], 21, -57434055);\n            a = ii(a, b, c, d, k[12], 6, 1700485571);\n            d = ii(d, a, b, c, k[3], 10, -1894986606);\n            c = ii(c, d, a, b, k[10], 15, -1051523);\n            b = ii(b, c, d, a, k[1], 21, -2054922799);\n            a = ii(a, b, c, d, k[8], 6, 1873313359);\n            d = ii(d, a, b, c, k[15], 10, -30611744);\n            c = ii(c, d, a, b, k[6], 15, -1560198380);\n            b = ii(b, c, d, a, k[13], 21, 1309151649);\n            a = ii(a, b, c, d, k[4], 6, -145523070);\n            d = ii(d, a, b, c, k[11], 10, -1120210379);\n            c = ii(c, d, a, b, k[2], 15, 718787259);\n            b = ii(b, c, d, a, k[9], 21, -343485551);\n\n            x[0] = add32(a, x[0]);\n            x[1] = add32(b, x[1]);\n            x[2] = add32(c, x[2]);\n            x[3] = add32(d, x[3]);\n        },\n\n        /* there needs to be support for Unicode here,\n           * unless we pretend that we can redefine the MD-5\n           * algorithm for multi-byte characters (perhaps\n           * by adding every four 16-bit characters and\n           * shortening the sum to 32 bits). Otherwise\n           * I suggest performing MD-5 as if every character\n           * was two bytes--e.g., 0040 0025 = @%--but then\n           * how will an ordinary MD-5 sum be matched?\n           * There is no way to standardize text to something\n           * like UTF-8 before transformation; speed cost is\n           * utterly prohibitive. The JavaScript standard\n           * itself needs to look at this: it should start\n           * providing access to strings as preformed UTF-8\n           * 8-bit unsigned value arrays.\n           */\n        md5blk = function (s) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n\n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n            }\n            return md5blks;\n        },\n\n        md5blk_array = function (a) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n\n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n            }\n            return md5blks;\n        },\n\n        md51 = function (s) {\n            var n = s.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n\n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk(s.substring(i - 64, i)));\n            }\n            s = s.substring(i - 64);\n            length = s.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n            }\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n\n            md5cycle(state, tail);\n            return state;\n        },\n\n        md51_array = function (a) {\n            var n = a.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n\n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n            }\n\n            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n            // containing the last element of the parent array if the sub array specified starts\n            // beyond the length of the parent array - weird.\n            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\n            length = a.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n            }\n\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n\n            md5cycle(state, tail);\n\n            return state;\n        },\n\n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n\n        rhex = function (n) {\n            var s = '',\n                j;\n            for (j = 0; j < 4; j += 1) {\n                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n            }\n            return s;\n        },\n\n        hex = function (x) {\n            var i;\n            for (i = 0; i < x.length; i += 1) {\n                x[i] = rhex(x[i]);\n            }\n            return x.join('');\n        },\n\n        md5 = function (s) {\n            return hex(md51(s));\n        },\n\n\n\n        ////////////////////////////////////////////////////////////////////////////\n\n        /**\n         * SparkMD5 OOP implementation.\n         *\n         * Use this class to perform an incremental md5, otherwise use the\n         * static methods instead.\n         */\n        SparkMD5 = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n\n\n        // In some cases the fast add32 function cannot be used..\n        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n            add32 = function (x, y) {\n                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n                return (msw << 16) | (lsw & 0xFFFF);\n            };\n        }\n\n\n        /**\n         * Appends a string.\n         * A conversion will be applied if an utf8 string is detected.\n         *\n         * @param {String} str The string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.append = function (str) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n\n            // then append as binary\n            this.appendBinary(str);\n\n            return this;\n        };\n\n        /**\n         * Appends a binary string.\n         *\n         * @param {String} contents The binary string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.appendBinary = function (contents) {\n            this._buff += contents;\n            this._length += contents.length;\n\n            var length = this._buff.length,\n                i;\n\n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n            }\n\n            this._buff = this._buff.substr(i - 64);\n\n            return this;\n        };\n\n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                i,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                ret;\n\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n            }\n\n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n\n            this.reset();\n\n            return ret;\n        };\n\n        /**\n         * Finish the final calculation based on the tail.\n         *\n         * @param {Array}  tail   The tail (will be modified)\n         * @param {Number} length The length of the remaining buffer\n         */\n        SparkMD5.prototype._finish = function (tail, length) {\n            var i = length,\n                tmp,\n                lo,\n                hi;\n\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(this._state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Do the final computation based on the tail and length\n            // Beware that the final length may not fit in 32 bits so we take care of that\n            tmp = this._length * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n            md5cycle(this._state, tail);\n        };\n\n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.reset = function () {\n            this._buff = \"\";\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\n            return this;\n        };\n\n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.prototype.destroy = function () {\n            delete this._state;\n            delete this._buff;\n            delete this._length;\n        };\n\n\n        /**\n         * Performs the md5 hash on a string.\n         * A conversion will be applied if utf8 string is detected.\n         *\n         * @param {String}  str The string\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hash = function (str, raw) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n\n            var hash = md51(str);\n\n            return raw ? hash : hex(hash);\n        };\n\n        /**\n         * Performs the md5 hash on a binary string.\n         *\n         * @param {String}  content The binary string\n         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hashBinary = function (content, raw) {\n            var hash = md51(content);\n\n            return raw ? hash : hex(hash);\n        };\n\n        /**\n         * SparkMD5 OOP implementation for array buffers.\n         *\n         * Use this class to perform an incremental md5 ONLY for array buffers.\n         */\n        SparkMD5.ArrayBuffer = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n\n        ////////////////////////////////////////////////////////////////////////////\n\n        /**\n         * Appends an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array to be appended\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n            //       if you find yourself needing extra performance, please make a PR.\n            var buff = this._concatArrayBuffer(this._buff, arr),\n                length = buff.length,\n                i;\n\n            this._length += arr.byteLength;\n\n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n            }\n\n            // Avoids IE10 weirdness (documented above)\n            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n\n            return this;\n        };\n\n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                i,\n                ret;\n\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n            }\n\n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n\n            this.reset();\n\n            return ret;\n        };\n\n        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.reset = function () {\n            this._buff = new Uint8Array(0);\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\n            return this;\n        };\n\n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\n        /**\n         * Concats two array buffers, returning a new one.\n         *\n         * @param  {ArrayBuffer} first  The first array buffer\n         * @param  {ArrayBuffer} second The second array buffer\n         *\n         * @return {ArrayBuffer} The new array buffer\n         */\n        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n            var firstLength = first.length,\n                result = new Uint8Array(firstLength + second.byteLength);\n\n            result.set(first);\n            result.set(new Uint8Array(second), firstLength);\n\n            return result;\n        };\n\n        /**\n         * Performs the md5 hash on an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array buffer\n         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n            var hash = md51_array(new Uint8Array(arr));\n\n            return raw ? hash : hex(hash);\n        };\n\n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n\n            loadFromBlob: function( file ) {\n                var blob = file.getSource(),\n                    chunkSize = 2 * 1024 * 1024,\n                    chunks = Math.ceil( blob.size / chunkSize ),\n                    chunk = 0,\n                    owner = this.owner,\n                    spark = new SparkMD5.ArrayBuffer(),\n                    me = this,\n                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n                    loadNext, fr;\n\n                fr = new FileReader();\n\n                loadNext = function() {\n                    var start, end;\n\n                    start = chunk * chunkSize;\n                    end = Math.min( start + chunkSize, blob.size );\n\n                    fr.onload = function( e ) {\n                        spark.append( e.target.result );\n                        owner.trigger( 'progress', {\n                            total: file.size,\n                            loaded: end\n                        });\n                    };\n\n                    fr.onloadend = function() {\n                        fr.onloadend = fr.onload = null;\n\n                        if ( ++chunk < chunks ) {\n                            setTimeout( loadNext, 1 );\n                        } else {\n                            setTimeout(function(){\n                                owner.trigger('load');\n                                me.result = spark.end();\n                                loadNext = file = blob = spark = null;\n                                owner.trigger('complete');\n                            }, 50 );\n                        }\n                    };\n\n                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n                };\n\n                loadNext();\n            },\n\n            getResult: function() {\n                return this.result;\n            }\n        });\n    });\n    /**\n     * @fileOverview FlashRuntime\n     */\n    define('runtime/flash/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n\n        var $ = Base.$,\n            type = 'flash',\n            components = {};\n\n\n        function getFlashVersion() {\n            var version;\n\n            try {\n                version = navigator.plugins[ 'Shockwave Flash' ];\n                version = version.description;\n            } catch ( ex ) {\n                try {\n                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n                            .GetVariable('$version');\n                } catch ( ex2 ) {\n                    version = '0.0';\n                }\n            }\n            version = version.match( /\\d+/g );\n            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n        }\n\n        function FlashRuntime() {\n            var pool = {},\n                clients = {},\n                destroy = this.destroy,\n                me = this,\n                jsreciver = Base.guid('webuploader_');\n\n            Runtime.apply( me, arguments );\n            me.type = type;\n\n\n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/ ) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n\n                clients[ uid ] = client;\n\n                if ( components[ comp ] ) {\n                    if ( !pool[ uid ] ) {\n                        pool[ uid ] = new components[ comp ]( client, me );\n                    }\n\n                    instance = pool[ uid ];\n\n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n\n                return me.flashExec.apply( client, arguments );\n            };\n\n            function handler( evt, obj ) {\n                var type = evt.type || evt,\n                    parts, uid;\n\n                parts = type.split('::');\n                uid = parts[ 0 ];\n                type = parts[ 1 ];\n\n                // console.log.apply( console, arguments );\n\n                if ( type === 'Ready' && uid === me.uid ) {\n                    me.trigger('ready');\n                } else if ( clients[ uid ] ) {\n                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n                }\n\n                // Base.log( evt, obj );\n            }\n\n            // flash的接受器。\n            window[ jsreciver ] = function() {\n                var args = arguments;\n\n                // 为了能捕获得到。\n                setTimeout(function() {\n                    handler.apply( null, args );\n                }, 1 );\n            };\n\n            this.jsreciver = jsreciver;\n\n            this.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n\n            this.flashExec = function( comp, fn ) {\n                var flash = me.getFlash(),\n                    args = Base.slice( arguments, 2 );\n\n                return flash.exec( this.uid, comp, fn, args );\n            };\n\n            // @todo\n        }\n\n        Base.inherits( Runtime, {\n            constructor: FlashRuntime,\n\n            init: function() {\n                var container = this.getContainer(),\n                    opts = this.options,\n                    html;\n\n                // if not the minimal height, shims are not initialized\n                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n                container.css({\n                    position: 'absolute',\n                    top: '-8px',\n                    left: '-8px',\n                    width: '9px',\n                    height: '9px',\n                    overflow: 'hidden'\n                });\n\n                // insert flash object\n                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n\n                if ( Base.browser.ie ) {\n                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n                }\n\n                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n                    '&jsreciver=' + this.jsreciver + '\" />' +\n                    '<param name=\"wmode\" value=\"transparent\" />' +\n                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n                '</object>';\n\n                container.html( html );\n            },\n\n            getFlash: function() {\n                if ( this._flash ) {\n                    return this._flash;\n                }\n\n                this._flash = $( '#' + this.uid ).get( 0 );\n                return this._flash;\n            }\n\n        });\n\n        FlashRuntime.register = function( name, component ) {\n            component = components[ name ] = Base.inherits( CompBase, $.extend({\n\n                // @todo fix this later\n                flashExec: function() {\n                    var owner = this.owner,\n                        runtime = this.getRuntime();\n\n                    return runtime.flashExec.apply( owner, arguments );\n                }\n            }, component ) );\n\n            return component;\n        };\n\n        if ( getFlashVersion() >= 11.4 ) {\n            Runtime.addRuntime( type, FlashRuntime );\n        }\n\n        return FlashRuntime;\n    });\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/flash/filepicker',[\n        'base',\n        'runtime/flash/runtime'\n    ], function( Base, FlashRuntime ) {\n        var $ = Base.$;\n\n        return FlashRuntime.register( 'FilePicker', {\n            init: function( opts ) {\n                var copy = $.extend({}, opts ),\n                    len, i;\n\n                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n                len = copy.accept && copy.accept.length;\n                for (  i = 0; i < len; i++ ) {\n                    if ( !copy.accept[ i ].title ) {\n                        copy.accept[ i ].title = 'Files';\n                    }\n                }\n\n                delete copy.button;\n                delete copy.id;\n                delete copy.container;\n\n                this.flashExec( 'FilePicker', 'init', copy );\n            },\n\n            destroy: function() {\n                this.flashExec( 'FilePicker', 'destroy' );\n            }\n        });\n    });\n    /**\n     * @fileOverview 图片压缩\n     */\n    define('runtime/flash/image',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n\n        return FlashRuntime.register( 'Image', {\n            // init: function( options ) {\n            //     var owner = this.owner;\n\n            //     this.flashExec( 'Image', 'init', options );\n            //     owner.on( 'load', function() {\n            //         debugger;\n            //     });\n            // },\n\n            loadFromBlob: function( blob ) {\n                var owner = this.owner;\n\n                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n\n                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/flash/transport',[\n        'base',\n        'runtime/flash/runtime',\n        'runtime/client'\n    ], function( Base, FlashRuntime, RuntimeClient ) {\n        var $ = Base.$;\n\n        return FlashRuntime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n                this._responseJson = null;\n            },\n\n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    binary;\n\n                xhr.connectRuntime( blob.ruid );\n\n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n\n                    binary = blob.uid;\n                } else {\n                    $.each( owner._formData, function( k, v ) {\n                        xhr.exec( 'append', k, v );\n                    });\n\n                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n                            opts.filename || owner._formData.name || '' );\n                }\n\n                this._setRequestHeader( xhr, opts.headers );\n                xhr.exec( 'send', {\n                    method: opts.method,\n                    url: server,\n                    forceURLStream: opts.forceURLStream,\n                    mimeType: 'application/octet-stream',\n                }, binary );\n            },\n\n            getStatus: function() {\n                return this._status;\n            },\n\n            getResponse: function() {\n                return this._response || '';\n            },\n\n            getResponseAsJson: function() {\n                return this._responseJson;\n            },\n\n            abort: function() {\n                var xhr = this._xhr;\n\n                if ( xhr ) {\n                    xhr.exec('abort');\n                    xhr.destroy();\n                    this._xhr = xhr = null;\n                }\n            },\n\n            destroy: function() {\n                this.abort();\n            },\n\n            _initAjax: function() {\n                var me = this,\n                    xhr = new RuntimeClient('XMLHttpRequest');\n\n                xhr.on( 'uploadprogress progress', function( e ) {\n                    var percent = e.loaded / e.total;\n                    percent = Math.min( 1, Math.max( 0, percent ) );\n                    return me.trigger( 'progress', percent );\n                });\n\n                xhr.on( 'load', function() {\n                    var status = xhr.exec('getStatus'),\n                        readBody = false,\n                        err = '',\n                        p;\n\n                    xhr.off();\n                    me._xhr = null;\n\n                    if ( status >= 200 && status < 300 ) {\n                        readBody = true;\n                    } else if ( status >= 500 && status < 600 ) {\n                        readBody = true;\n                        err = 'server';\n                    } else {\n                        err = 'http';\n                    }\n\n                    if ( readBody ) {\n                        me._response = xhr.exec('getResponse');\n                        me._response = decodeURIComponent( me._response );\n\n                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n                        // try {\n                        //     me._responseJson = xhr.exec('getResponseAsJson');\n                        // } catch ( error ) {\n\n                        p = window.JSON && window.JSON.parse || function( s ) {\n                            try {\n                                return new Function('return ' + s).call();\n                            } catch ( err ) {\n                                return {};\n                            }\n                        };\n                        me._responseJson  = me._response ? p(me._response) : {};\n\n                        // }\n                    }\n\n                    xhr.destroy();\n                    xhr = null;\n\n                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n                });\n\n                xhr.on( 'error', function() {\n                    xhr.off();\n                    me._xhr = null;\n                    me.trigger( 'error', 'http' );\n                });\n\n                me._xhr = xhr;\n                return xhr;\n            },\n\n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.exec( 'setRequestHeader', key, val );\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/flash/blob',[\n        'runtime/flash/runtime',\n        'lib/blob'\n    ], function( FlashRuntime, Blob ) {\n\n        return FlashRuntime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.flashExec( 'Blob', 'slice', start, end );\n\n                return new Blob( blob.uid, blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Md5 flash实现\n     */\n    define('runtime/flash/md5',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n\n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n\n            loadFromBlob: function( blob ) {\n                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview 完全版本。\n     */\n    define('preset/all',[\n        'base',\n\n        // widgets\n        'widgets/filednd',\n        'widgets/filepaste',\n        'widgets/filepicker',\n        'widgets/image',\n        'widgets/queue',\n        'widgets/runtime',\n        'widgets/upload',\n        'widgets/validator',\n        'widgets/md5',\n\n        // runtimes\n        // html5\n        'runtime/html5/blob',\n        'runtime/html5/dnd',\n        'runtime/html5/filepaste',\n        'runtime/html5/filepicker',\n        'runtime/html5/imagemeta/exif',\n        'runtime/html5/androidpatch',\n        'runtime/html5/image',\n        'runtime/html5/transport',\n        'runtime/html5/md5',\n\n        // flash\n        'runtime/flash/filepicker',\n        'runtime/flash/image',\n        'runtime/flash/transport',\n        'runtime/flash/blob',\n        'runtime/flash/md5'\n    ], function( Base ) {\n        return Base;\n    });\n    /**\n     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n     *\n     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n     *\n     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n     *\n     * 如：\n     * WebUploader.create({\n     *     ...\n     *\n     *     disableWidgets: 'log',\n     *\n     *     ...\n     * })\n     */\n    define('widgets/log',[\n        'base',\n        'uploader',\n        'widgets/widget'\n    ], function( Base, Uploader ) {\n        var $ = Base.$,\n            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n            product = (location.hostname || location.host || 'protected').toLowerCase(),\n\n            // 只针对 baidu 内部产品用户做统计功能。\n            enable = product && /baidu/i.exec(product),\n            base;\n\n        if (!enable) {\n            return;\n        }\n\n        base = {\n            dv: 3,\n            master: 'webuploader',\n            online: /test/.exec(product) ? 0 : 1,\n            module: '',\n            product: product,\n            type: 0\n        };\n\n        function send(data) {\n            var obj = $.extend({}, base, data),\n                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n                image = new Image();\n\n            image.src = url;\n        }\n\n        return Uploader.register({\n            name: 'log',\n\n            init: function() {\n                var owner = this.owner,\n                    count = 0,\n                    size = 0;\n\n                owner\n                    .on('error', function(code) {\n                        send({\n                            type: 2,\n                            c_error_code: code\n                        });\n                    })\n                    .on('uploadError', function(file, reason) {\n                        send({\n                            type: 2,\n                            c_error_code: 'UPLOAD_ERROR',\n                            c_reason: '' + reason\n                        });\n                    })\n                    .on('uploadComplete', function(file) {\n                        count++;\n                        size += file.size;\n                    }).\n                    on('uploadFinished', function() {\n                        send({\n                            c_count: count,\n                            c_size: size\n                        });\n                        count = size = 0;\n                    });\n\n                send({\n                    c_usage: 1\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('webuploader',[\n        'preset/all',\n        'widgets/log'\n    ], function( preset ) {\n        return preset;\n    });\n    return require('webuploader');\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/plugin/webuploader/webuploader.js\n// module id = 86\n// module chunks = 4 6 7 12 16 30 34","/*!\r\n * Cropper v0.9.2\r\n * https://github.com/fengyuanchen/cropper\r\n *\r\n * Copyright (c) 2014-2015 Fengyuan Chen and contributors\r\n * Released under the MIT license\r\n *\r\n * Date: 2015-04-18T04:35:01.500Z\r\n */\r\n!function(a){\"function\"==typeof define&&define.amd?define([\"jquery\"],a):a(\"object\"==typeof exports?require(\"jquery\"):jQuery)}(function(a){\"use strict\";function b(a){return\"number\"==typeof a}function c(a){return\"undefined\"==typeof a}function d(a,c){var d=[];return b(c)&&d.push(c),d.slice.apply(a,d)}function e(a,b){var c=d(arguments,2);return function(){return a.apply(b,c.concat(d(arguments)))}}function f(a){var b=a.match(/^(https?:)\\/\\/([^\\:\\/\\?#]+):?(\\d*)/i);return b&&(b[1]!==o.protocol||b[2]!==o.hostname||b[3]!==o.port)}function g(a){var b=\"timestamp=\"+(new Date).getTime();return a+(-1===a.indexOf(\"?\")?\"?\":\"&\")+b}function h(a,b){return b.left<0&&a.width<b.left+b.width&&b.top<0&&a.height<b.top+b.height}function i(a){return a?\"rotate(\"+a+\"deg)\":\"none\"}function j(a,b){var c,d,e=R(a.degree)%180,f=(e>90?180-e:e)*Math.PI/180,g=S(f),h=T(f),i=a.width,j=a.height,k=a.aspectRatio;return b?(c=i/(h+g/k),d=c/k):(c=i*h+j*g,d=i*g+j*h),{width:c,height:d}}function k(b,c){var d=a(\"<canvas>\")[0],e=d.getContext(\"2d\"),f=c.naturalWidth,g=c.naturalHeight,h=c.rotate,i=j({width:f,height:g,degree:h});return h?(d.width=i.width,d.height=i.height,e.save(),e.translate(i.width/2,i.height/2),e.rotate(h*Math.PI/180),e.drawImage(b,-f/2,-g/2,f,g),e.restore()):(d.width=f,d.height=g,e.drawImage(b,0,0,f,g)),d}function l(b,c){this.$element=a(b),this.options=a.extend({},l.DEFAULTS,a.isPlainObject(c)&&c),this.ready=!1,this.built=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.canvas=null,this.cropBox=null,this.load()}var m=a(window),n=a(document),o=window.location,p=\".cropper\",q=\"preview\"+p,r=/^(e|n|w|s|ne|nw|sw|se|all|crop|move|zoom)$/,s=\"cropper-modal\",t=\"cropper-hide\",u=\"cropper-hidden\",v=\"cropper-invisible\",w=\"cropper-move\",x=\"cropper-crop\",y=\"cropper-disabled\",z=\"cropper-bg\",A=\"mousedown touchstart\",B=\"mousemove touchmove\",C=\"mouseup mouseleave touchend touchleave touchcancel\",D=\"wheel mousewheel DOMMouseScroll\",E=\"dblclick\",F=\"resize\"+p,G=\"build\"+p,H=\"built\"+p,I=\"dragstart\"+p,J=\"dragmove\"+p,K=\"dragend\"+p,L=\"zoomin\"+p,M=\"zoomout\"+p,N=a.isFunction(a(\"<canvas>\")[0].getContext),O=Math.sqrt,P=Math.min,Q=Math.max,R=Math.abs,S=Math.sin,T=Math.cos,U=parseFloat,V={};V.load=function(b){var c,d,e,h,i=this.options,j=this.$element;if(!b)if(j.is(\"img\")){if(!j.attr(\"src\"))return;b=j.prop(\"src\")}else j.is(\"canvas\")&&N&&(b=j[0].toDataURL());b&&(e=a.Event(G),j.one(G,i.build).trigger(e),e.isDefaultPrevented()||(i.checkImageOrigin&&f(b)&&(c=\"anonymous\",j.prop(\"crossOrigin\")||(d=g(b))),this.$clone=h=a(\"<img>\"),h.one(\"load\",a.proxy(function(){var a=h.prop(\"naturalWidth\")||h.width(),c=h.prop(\"naturalHeight\")||h.height();this.image={naturalWidth:a,naturalHeight:c,aspectRatio:a/c,rotate:0},this.url=b,this.ready=!0,this.build()},this)).one(\"error\",function(){h.remove()}).attr({src:d||b,crossOrigin:c}),h.addClass(t).insertAfter(j)))},V.build=function(){var b,c,d=this.$element,e=this.$clone,f=this.options;this.ready&&(this.built&&this.unbuild(),this.$cropper=b=a(l.TEMPLATE),d.addClass(u),e.removeClass(t),this.$container=d.parent().append(b),this.$canvas=b.find(\".cropper-canvas\").append(e),this.$dragBox=b.find(\".cropper-drag-box\"),this.$cropBox=c=b.find(\".cropper-crop-box\"),this.$viewBox=b.find(\".cropper-view-box\"),this.addListeners(),this.initPreview(),f.aspectRatio=U(f.aspectRatio)||0/0,f.autoCrop?(this.cropped=!0,f.modal&&this.$dragBox.addClass(s)):c.addClass(u),f.background&&b.addClass(z),f.highlight||c.find(\".cropper-face\").addClass(v),f.guides||c.find(\".cropper-dashed\").addClass(u),f.movable||c.find(\".cropper-face\").data(\"drag\",\"move\"),f.resizable||c.find(\".cropper-line, .cropper-point\").addClass(u),this.setDragMode(f.dragCrop?\"crop\":\"move\"),this.built=!0,this.render(),d.one(H,f.built).trigger(H))},V.unbuild=function(){this.built&&(this.built=!1,this.container=null,this.canvas=null,this.cropBox=null,this.removeListeners(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},a.extend(V,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var a=this.$element,b=this.$container,c=this.$cropper,d=this.options;c.addClass(u),a.removeClass(u),c.css(this.container={width:Q(b.width(),U(d.minContainerWidth)||200),height:Q(b.height(),U(d.minContainerHeight)||100)}),a.addClass(u),c.removeClass(u)},initCanvas:function(){var b=this.container,c=b.width,d=b.height,e=this.image,f=e.aspectRatio,g={aspectRatio:f,width:c,height:d};d*f>c?g.height=c/f:g.width=d*f,g.oldLeft=g.left=(c-g.width)/2,g.oldTop=g.top=(d-g.height)/2,this.canvas=g,this.limitCanvas(!0,!0),this.initialImage=a.extend({},e),this.initialCanvas=a.extend({},g)},limitCanvas:function(b,c){var d,e,f=this.options,g=f.strict,h=this.container,i=h.width,j=h.height,k=this.canvas,l=k.aspectRatio,m=this.cropBox,n=this.cropped&&m;b&&(d=U(f.minCanvasWidth)||0,e=U(f.minCanvasHeight)||0,d?(g&&(d=Q(n?m.width:i,d)),e=d/l):e?(g&&(e=Q(n?m.height:j,e)),d=e*l):g&&(n?(d=m.width,e=m.height,e*l>d?d=e*l:e=d/l):(d=i,e=j,e*l>d?e=d/l:d=e*l)),a.extend(k,{minWidth:d,minHeight:e,maxWidth:1/0,maxHeight:1/0})),c&&(g?n?(k.minLeft=P(m.left,m.left+m.width-k.width),k.minTop=P(m.top,m.top+m.height-k.height),k.maxLeft=m.left,k.maxTop=m.top):(k.minLeft=P(0,i-k.width),k.minTop=P(0,j-k.height),k.maxLeft=Q(0,i-k.width),k.maxTop=Q(0,j-k.height)):(k.minLeft=-k.width,k.minTop=-k.height,k.maxLeft=i,k.maxTop=j))},renderCanvas:function(a){var b,c,d=this.options,e=this.canvas,f=this.image;this.rotated&&(this.rotated=!1,c=j({width:f.width,height:f.height,degree:f.rotate}),b=c.width/c.height,b!==e.aspectRatio&&(e.left-=(c.width-e.width)/2,e.top-=(c.height-e.height)/2,e.width=c.width,e.height=c.height,e.aspectRatio=b,this.limitCanvas(!0,!1))),(e.width>e.maxWidth||e.width<e.minWidth)&&(e.left=e.oldLeft),(e.height>e.maxHeight||e.height<e.minHeight)&&(e.top=e.oldTop),e.width=P(Q(e.width,e.minWidth),e.maxWidth),e.height=P(Q(e.height,e.minHeight),e.maxHeight),this.limitCanvas(!1,!0),e.oldLeft=e.left=P(Q(e.left,e.minLeft),e.maxLeft),e.oldTop=e.top=P(Q(e.top,e.minTop),e.maxTop),this.$canvas.css({width:e.width,height:e.height,left:e.left,top:e.top}),this.renderImage(),this.cropped&&d.strict&&!h(this.container,e)&&this.limitCropBox(!0,!0),a&&this.output()},renderImage:function(){var b,c=this.canvas,d=this.image;d.rotate&&(b=j({width:c.width,height:c.height,degree:d.rotate,aspectRatio:d.aspectRatio},!0)),a.extend(d,b?{width:b.width,height:b.height,left:(c.width-b.width)/2,top:(c.height-b.height)/2}:{width:c.width,height:c.height,left:0,top:0}),this.$clone.css({width:d.width,height:d.height,marginLeft:d.left,marginTop:d.top,transform:i(d.rotate)})},initCropBox:function(){var b=this.options,c=this.canvas,d=b.aspectRatio,e=U(b.autoCropArea)||.8,f={width:c.width,height:c.height};d&&(c.height*d>c.width?f.height=f.width/d:f.width=f.height*d),this.cropBox=f,this.limitCropBox(!0,!0),f.width=P(Q(f.width,f.minWidth),f.maxWidth),f.height=P(Q(f.height,f.minHeight),f.maxHeight),f.width=Q(f.minWidth,f.width*e),f.height=Q(f.minHeight,f.height*e),f.oldLeft=f.left=c.left+(c.width-f.width)/2,f.oldTop=f.top=c.top+(c.height-f.height)/2,this.initialCropBox=a.extend({},f)},limitCropBox:function(a,b){var c,d,e=this.options,f=e.strict,g=this.container,h=g.width,i=g.height,j=this.canvas,k=this.cropBox,l=e.aspectRatio;a&&(c=U(e.minCropBoxWidth)||0,d=U(e.minCropBoxHeight)||0,k.minWidth=P(h,c),k.minHeight=P(i,d),k.maxWidth=P(h,f?j.width:h),k.maxHeight=P(i,f?j.height:i),l&&(k.maxHeight*l>k.maxWidth?(k.minHeight=k.minWidth/l,k.maxHeight=k.maxWidth/l):(k.minWidth=k.minHeight*l,k.maxWidth=k.maxHeight*l)),k.minWidth=P(k.maxWidth,k.minWidth),k.minHeight=P(k.maxHeight,k.minHeight)),b&&(f?(k.minLeft=Q(0,j.left),k.minTop=Q(0,j.top),k.maxLeft=P(h,j.left+j.width)-k.width,k.maxTop=P(i,j.top+j.height)-k.height):(k.minLeft=0,k.minTop=0,k.maxLeft=h-k.width,k.maxTop=i-k.height))},renderCropBox:function(){var a=this.options,b=this.container,c=b.width,d=b.height,e=this.$cropBox,f=this.cropBox;(f.width>f.maxWidth||f.width<f.minWidth)&&(f.left=f.oldLeft),(f.height>f.maxHeight||f.height<f.minHeight)&&(f.top=f.oldTop),f.width=P(Q(f.width,f.minWidth),f.maxWidth),f.height=P(Q(f.height,f.minHeight),f.maxHeight),this.limitCropBox(!1,!0),f.oldLeft=f.left=P(Q(f.left,f.minLeft),f.maxLeft),f.oldTop=f.top=P(Q(f.top,f.minTop),f.maxTop),a.movable&&e.find(\".cropper-face\").data(\"drag\",f.width===c&&f.height===d?\"move\":\"all\"),e.css({width:f.width,height:f.height,left:f.left,top:f.top}),this.cropped&&a.strict&&!h(b,this.canvas)&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){var a=this.options;this.preview(),a.crop&&a.crop.call(this.$element,this.getData())}}),V.initPreview=function(){var b=this.url;this.$preview=a(this.options.preview),this.$viewBox.html('<img src=\"'+b+'\">'),this.$preview.each(function(){var c=a(this);c.data(q,{width:c.width(),height:c.height(),original:c.html()}).html('<img src=\"'+b+'\" style=\"display:block;width:100%;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation: 0deg!important\">')})},V.resetPreview=function(){this.$preview.each(function(){var b=a(this);b.html(b.data(q).original).removeData(q)})},V.preview=function(){var b=this.image,c=this.canvas,d=this.cropBox,e=b.width,f=b.height,g=d.left-c.left-b.left,h=d.top-c.top-b.top,j=b.rotate;this.cropped&&!this.disabled&&(this.$viewBox.find(\"img\").css({width:e,height:f,marginLeft:-g,marginTop:-h,transform:i(j)}),this.$preview.each(function(){var b=a(this),c=b.data(q),k=c.width/d.width,l=c.width,m=d.height*k;m>c.height&&(k=c.height/d.height,l=d.width*k,m=c.height),b.width(l).height(m).find(\"img\").css({width:e*k,height:f*k,marginLeft:-g*k,marginTop:-h*k,transform:i(j)})}))},V.addListeners=function(){var b=this.options;this.$element.on(I,b.dragstart).on(J,b.dragmove).on(K,b.dragend).on(L,b.zoomin).on(M,b.zoomout),this.$cropper.on(A,a.proxy(this.dragstart,this)).on(E,a.proxy(this.dblclick,this)),b.zoomable&&b.mouseWheelZoom&&this.$cropper.on(D,a.proxy(this.wheel,this)),n.on(B,this._dragmove=e(this.dragmove,this)).on(C,this._dragend=e(this.dragend,this)),b.responsive&&m.on(F,this._resize=e(this.resize,this))},V.removeListeners=function(){var a=this.options;this.$element.off(I,a.dragstart).off(J,a.dragmove).off(K,a.dragend).off(L,a.zoomin).off(M,a.zoomout),this.$cropper.off(A,this.dragstart).off(E,this.dblclick),a.zoomable&&a.mouseWheelZoom&&this.$cropper.off(D,this.wheel),n.off(B,this._dragmove).off(C,this._dragend),a.responsive&&m.off(F,this._resize)},a.extend(V,{resize:function(){var b,c,d,e=this.$container,f=this.container;this.disabled||(d=e.width()/f.width,(1!==d||e.height()!==f.height)&&(b=this.getCanvasData(),c=this.getCropBoxData(),this.render(),this.setCanvasData(a.each(b,function(a,c){b[a]=c*d})),this.setCropBoxData(a.each(c,function(a,b){c[a]=b*d}))))},dblclick:function(){this.disabled||this.setDragMode(this.$dragBox.hasClass(x)?\"move\":\"crop\")},wheel:function(a){var b=a.originalEvent,c=1;this.disabled||(a.preventDefault(),b.deltaY?c=b.deltaY>0?1:-1:b.wheelDelta?c=-b.wheelDelta/120:b.detail&&(c=b.detail>0?1:-1),this.zoom(.1*-c))},dragstart:function(b){var c,d,e,f=this.options,g=b.originalEvent,h=g&&g.touches,i=b;if(!this.disabled){if(h){if(e=h.length,e>1){if(!f.zoomable||!f.touchDragZoom||2!==e)return;i=h[1],this.startX2=i.pageX,this.startY2=i.pageY,c=\"zoom\"}i=h[0]}if(c=c||a(i.target).data(\"drag\"),r.test(c)){if(b.preventDefault(),d=a.Event(I,{originalEvent:g,dragType:c}),this.$element.trigger(d),d.isDefaultPrevented())return;this.dragType=c,this.cropping=!1,this.startX=i.pageX,this.startY=i.pageY,\"crop\"===c&&(this.cropping=!0,this.$dragBox.addClass(s))}}},dragmove:function(b){var c,d,e=this.options,f=b.originalEvent,g=f&&f.touches,h=b,i=this.dragType;if(!this.disabled){if(g){if(d=g.length,d>1){if(!e.zoomable||!e.touchDragZoom||2!==d)return;h=g[1],this.endX2=h.pageX,this.endY2=h.pageY}h=g[0]}if(i){if(b.preventDefault(),c=a.Event(J,{originalEvent:f,dragType:i}),this.$element.trigger(c),c.isDefaultPrevented())return;this.endX=h.pageX,this.endY=h.pageY,this.change()}}},dragend:function(b){var c,d=this.dragType;if(!this.disabled&&d){if(b.preventDefault(),c=a.Event(K,{originalEvent:b.originalEvent,dragType:d}),this.$element.trigger(c),c.isDefaultPrevented())return;this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(s,this.cropped&&this.options.modal)),this.dragType=\"\"}}}),a.extend(V,{reset:function(){this.built&&!this.disabled&&(this.image=a.extend({},this.initialImage),this.canvas=a.extend({},this.initialCanvas),this.renderCanvas(),this.cropped&&(this.cropBox=a.extend({},this.initialCropBox),this.renderCropBox()))},clear:function(){this.cropped&&!this.disabled&&(a.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),this.$dragBox.removeClass(s),this.$cropBox.addClass(u))},destroy:function(){var a=this.$element;this.ready?(this.unbuild(),a.removeClass(u)):this.$clone.off(\"load\").remove(),a.removeData(\"cropper\")},replace:function(a){!this.disabled&&a&&this.load(a)},enable:function(){this.built&&(this.disabled=!1,this.$cropper.removeClass(y))},disable:function(){this.built&&(this.disabled=!0,this.$cropper.addClass(y))},move:function(a,c){var d=this.canvas;this.built&&!this.disabled&&b(a)&&b(c)&&(d.left+=a,d.top+=c,this.renderCanvas(!0))},zoom:function(b){var c,d,e,f=this.canvas;if(b=U(b),b&&this.built&&!this.disabled&&this.options.zoomable){if(c=a.Event(b>0?L:M),this.$element.trigger(c),c.isDefaultPrevented())return;b=-1>=b?1/(1-b):1>=b?1+b:b,d=f.width*b,e=f.height*b,f.left-=(d-f.width)/2,f.top-=(e-f.height)/2,f.width=d,f.height=e,this.renderCanvas(!0),this.setDragMode(\"move\")}},rotate:function(a){var b=this.image;a=U(a),a&&this.built&&!this.disabled&&this.options.rotatable&&(b.rotate=(b.rotate+a)%360,this.rotated=!0,this.renderCanvas(!0))},getData:function(){var b,c,d=this.cropBox,e=this.canvas,f=this.image;return this.built&&this.cropped?(c={x:d.left-e.left,y:d.top-e.top,width:d.width,height:d.height},b=f.width/f.naturalWidth,a.each(c,function(a,d){d/=b,c[a]=d})):c={x:0,y:0,width:0,height:0},c.rotate=f.rotate,c},getContainerData:function(){return this.built?this.container:{}},getImageData:function(){return this.ready?this.image:{}},getCanvasData:function(){var a,b=this.canvas;return this.built&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCanvasData:function(c){var d=this.canvas,e=d.aspectRatio;this.built&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(d.left=c.left),b(c.top)&&(d.top=c.top),b(c.width)?(d.width=c.width,d.height=c.width/e):b(c.height)&&(d.height=c.height,d.width=c.height*e),this.renderCanvas(!0))},getCropBoxData:function(){var a,b=this.cropBox;return this.built&&this.cropped&&(a={left:b.left,top:b.top,width:b.width,height:b.height}),a||{}},setCropBoxData:function(c){var d=this.cropBox,e=this.options.aspectRatio;this.built&&this.cropped&&!this.disabled&&a.isPlainObject(c)&&(b(c.left)&&(d.left=c.left),b(c.top)&&(d.top=c.top),e?b(c.width)?(d.width=c.width,d.height=d.width/e):b(c.height)&&(d.height=c.height,d.width=d.height*e):(b(c.width)&&(d.width=c.width),b(c.height)&&(d.height=c.height)),this.renderCropBox())},getCroppedCanvas:function(b){var c,d,e,f,g,h,i,j,l,m,n;if(this.built&&this.cropped&&N)return a.isPlainObject(b)||(b={}),n=this.getData(),c=n.width,d=n.height,j=c/d,a.isPlainObject(b)&&(g=b.width,h=b.height,g?(h=g/j,i=g/c):h&&(g=h*j,i=h/d)),e=g||c,f=h||d,l=a(\"<canvas>\")[0],l.width=e,l.height=f,m=l.getContext(\"2d\"),b.fillColor&&(m.fillStyle=b.fillColor,m.fillRect(0,0,e,f)),m.drawImage.apply(m,function(){var a,b,e,f,g,h,j=k(this.$clone[0],this.image),l=j.width,m=j.height,o=[j],p=n.x,q=n.y;return-c>=p||p>l?p=a=e=g=0:0>=p?(e=-p,p=0,a=g=P(l,c+p)):l>=p&&(e=0,a=g=P(c,l-p)),0>=a||-d>=q||q>m?q=b=f=h=0:0>=q?(f=-q,q=0,b=h=P(m,d+q)):m>=q&&(f=0,b=h=P(d,m-q)),o.push(p,q,a,b),i&&(e*=i,f*=i,g*=i,h*=i),g>0&&h>0&&o.push(e,f,g,h),o}.call(this)),l},setAspectRatio:function(a){var b=this.options;this.disabled||c(a)||(b.aspectRatio=U(a)||0/0,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox()))},setDragMode:function(a){var b=this.$dragBox,c=!1,d=!1;if(this.ready&&!this.disabled){switch(a){case\"crop\":this.options.dragCrop?(c=!0,b.data(\"drag\",a)):d=!0;break;case\"move\":d=!0,b.data(\"drag\",a);break;default:b.removeData(\"drag\")}b.toggleClass(x,c).toggleClass(w,d)}}}),V.change=function(){var a,b=this.dragType,c=this.options,d=this.canvas,e=this.container,f=this.cropBox,g=f.width,h=f.height,i=f.left,j=f.top,k=i+g,l=j+h,m=0,n=0,o=e.width,p=e.height,q=!0,r=c.aspectRatio,s={x:this.endX-this.startX,y:this.endY-this.startY};switch(c.strict&&(m=f.minLeft,n=f.minTop,o=m+P(e.width,d.width),p=n+P(e.height,d.height)),r&&(s.X=s.y*r,s.Y=s.x/r),b){case\"all\":i+=s.x,j+=s.y;break;case\"e\":if(s.x>=0&&(k>=o||r&&(n>=j||l>=p))){q=!1;break}g+=s.x,r&&(h=g/r,j-=s.Y/2),0>g&&(b=\"w\",g=0);break;case\"n\":if(s.y<=0&&(n>=j||r&&(m>=i||k>=o))){q=!1;break}h-=s.y,j+=s.y,r&&(g=h*r,i+=s.X/2),0>h&&(b=\"s\",h=0);break;case\"w\":if(s.x<=0&&(m>=i||r&&(n>=j||l>=p))){q=!1;break}g-=s.x,i+=s.x,r&&(h=g/r,j+=s.Y/2),0>g&&(b=\"e\",g=0);break;case\"s\":if(s.y>=0&&(l>=p||r&&(m>=i||k>=o))){q=!1;break}h+=s.y,r&&(g=h*r,i-=s.X/2),0>h&&(b=\"n\",h=0);break;case\"ne\":if(r){if(s.y<=0&&(n>=j||k>=o)){q=!1;break}h-=s.y,j+=s.y,g=h*r}else s.x>=0?o>k?g+=s.x:s.y<=0&&n>=j&&(q=!1):g+=s.x,s.y<=0?j>0&&(h-=s.y,j+=s.y):(h-=s.y,j+=s.y);0>g&&0>h?(b=\"sw\",h=0,g=0):0>g?(b=\"nw\",g=0):0>h&&(b=\"se\",h=0);break;case\"nw\":if(r){if(s.y<=0&&(n>=j||m>=i)){q=!1;break}h-=s.y,j+=s.y,g=h*r,i+=s.X}else s.x<=0?i>0?(g-=s.x,i+=s.x):s.y<=0&&n>=j&&(q=!1):(g-=s.x,i+=s.x),s.y<=0?j>0&&(h-=s.y,j+=s.y):(h-=s.y,j+=s.y);0>g&&0>h?(b=\"se\",h=0,g=0):0>g?(b=\"ne\",g=0):0>h&&(b=\"sw\",h=0);break;case\"sw\":if(r){if(s.x<=0&&(m>=i||l>=p)){q=!1;break}g-=s.x,i+=s.x,h=g/r}else s.x<=0?i>0?(g-=s.x,i+=s.x):s.y>=0&&l>=p&&(q=!1):(g-=s.x,i+=s.x),s.y>=0?p>l&&(h+=s.y):h+=s.y;0>g&&0>h?(b=\"ne\",h=0,g=0):0>g?(b=\"se\",g=0):0>h&&(b=\"nw\",h=0);break;case\"se\":if(r){if(s.x>=0&&(k>=o||l>=p)){q=!1;break}g+=s.x,h=g/r}else s.x>=0?o>k?g+=s.x:s.y>=0&&l>=p&&(q=!1):g+=s.x,s.y>=0?p>l&&(h+=s.y):h+=s.y;0>g&&0>h?(b=\"nw\",h=0,g=0):0>g?(b=\"sw\",g=0):0>h&&(b=\"ne\",h=0);break;case\"move\":d.left+=s.x,d.top+=s.y,this.renderCanvas(!0),q=!1;break;case\"zoom\":this.zoom(function(a,b,c,d){var e=O(a*a+b*b),f=O(c*c+d*d);return(f-e)/e}(R(this.startX-this.startX2),R(this.startY-this.startY2),R(this.endX-this.endX2),R(this.endY-this.endY2))),this.startX2=this.endX2,this.startY2=this.endY2,q=!1;break;case\"crop\":s.x&&s.y&&(a=this.$cropper.offset(),i=this.startX-a.left,j=this.startY-a.top,g=f.minWidth,h=f.minHeight,s.x>0?s.y>0?b=\"se\":(b=\"ne\",j-=h):s.y>0?(b=\"sw\",i-=g):(b=\"nw\",i-=g,j-=h),this.cropped||(this.cropped=!0,this.$cropBox.removeClass(u)))}q&&(f.width=g,f.height=h,f.left=i,f.top=j,this.dragType=b,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},a.extend(l.prototype,V),l.DEFAULTS={aspectRatio:0/0,autoCropArea:.8,crop:null,preview:\"\",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,highlight:!0,background:!0,autoCrop:!0,dragCrop:!0,movable:!0,resizable:!0,rotatable:!0,zoomable:!0,touchDragZoom:!0,mouseWheelZoom:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,dragstart:null,dragmove:null,dragend:null,zoomin:null,zoomout:null},l.setDefaults=function(b){a.extend(l.DEFAULTS,b)},l.TEMPLATE=function(a,b){return b=b.split(\",\"),a.replace(/\\d+/g,function(a){return b[a]})}('<0 6=\"5-container\"><0 6=\"5-canvas\"></0><0 6=\"5-2-9\" 3-2=\"move\"></0><0 6=\"5-crop-9\"><1 6=\"5-view-9\"></1><1 6=\"5-8 8-h\"></1><1 6=\"5-8 8-v\"></1><1 6=\"5-face\" 3-2=\"all\"></1><1 6=\"5-7 7-e\" 3-2=\"e\"></1><1 6=\"5-7 7-n\" 3-2=\"n\"></1><1 6=\"5-7 7-w\" 3-2=\"w\"></1><1 6=\"5-7 7-s\" 3-2=\"s\"></1><1 6=\"5-4 4-e\" 3-2=\"e\"></1><1 6=\"5-4 4-n\" 3-2=\"n\"></1><1 6=\"5-4 4-w\" 3-2=\"w\"></1><1 6=\"5-4 4-s\" 3-2=\"s\"></1><1 6=\"5-4 4-ne\" 3-2=\"ne\"></1><1 6=\"5-4 4-nw\" 3-2=\"nw\"></1><1 6=\"5-4 4-sw\" 3-2=\"sw\"></1><1 6=\"5-4 4-se\" 3-2=\"se\"></1></0></0>',\"div,span,drag,data,point,cropper,class,line,dashed,box\"),l.other=a.fn.cropper,a.fn.cropper=function(b){var e,f=d(arguments,1);return this.each(function(){var c,d=a(this),g=d.data(\"cropper\");g||d.data(\"cropper\",g=new l(this,b)),\"string\"==typeof b&&a.isFunction(c=g[b])&&(e=c.apply(g,f))}),c(e)?this:e},a.fn.cropper.Constructor=l,a.fn.cropper.setDefaults=l.setDefaults,a.fn.cropper.noConflict=function(){return a.fn.cropper=l.other,this}});\n\n\n// WEBPACK FOOTER //\n// ./src/js/plugin/jquery.cropper.js","var cropper = require('module/cropper');\r\nvar fetch = require('io/fetch');\r\nvar url = require('io/url');\r\nvar hint = require('module/hint');\r\n\r\nvar $tabs = $('[data-node=\"editTab\"] a');\r\nvar $tabBoxs = $('[data-node=\"editBox\"]');\r\nvar $faceBox = $('[data-action=\"editFaceImg\"]');\r\n\r\nvar firstTab = true;\r\n\r\n\r\nvar cropperInit = function() {\r\n\r\n\tcropper.init(function(src) {\r\n\t\tfetch.post(url.get('subName'), {\r\n\t\t\tdata: {\r\n\t\t\t\tfacePicUrl: src\r\n\t\t\t}\r\n\t\t}).done(function(result) {\r\n\r\n\t\t\tif (result && result.success && result.code === 200) {\r\n\t\t\t\t$faceBox.find('img').attr(\"src\", src);\r\n\t\t\t\t$('[data-node=\"headImg\"]').attr(\"src\", src);\r\n\t\t\t\thint.init('保存成功');\r\n\t\t\t} else {\r\n\t\t\t\thint.init('保存失败');\r\n\t\t\t}\r\n\r\n\t\t}).fail(function() {\r\n\t\t\thint.init('保存失败');\r\n\t\t});\r\n\r\n\t});\r\n}\r\n\r\nvar Tab = function() {\r\n\t$(document).on('click', '[data-node=\"editTab\"] a', function() {\r\n\t\tif (!$(this).hasClass('active')) {\r\n\t\t\t$('[data-node=comErrTip]').addClass('hide');\r\n\t\t\tvar index = $tabs.index($(this));\r\n\t\t\t$tabs.removeClass('active').eq(index).addClass('active');\r\n\t\t\t$tabBoxs.hide().eq(index).show();\r\n\t\t\tif (index === 1 && firstTab) {\r\n\t\t\t\tfirstTab = false;\r\n\t\t\t\tcropperInit();\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t$faceBox.on('click', function() {\r\n\t\t$('[data-node=comErrTip]').addClass('hide');\r\n\t\t$tabs.eq(1).click();\r\n\t});\r\n};\r\n\r\n\r\n\r\nvar init = function() {\r\n\tTab();\r\n\tif (window.location.href.indexOf('type=2') !== -1) {\r\n\t\tcropperInit();\r\n\t}\r\n\r\n};\r\n\r\n\r\n\r\nmodule.exports = {\r\n\tinit: init\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/uc_editInfo/editFace.js","var tips = require('module/i18n');\r\nvar editBox = $('[data-node=editBox]').eq(0);\r\nvar birTip = editBox.find('[data-node=birTip]');\r\nvar hideCls = 'hide';\r\n\r\nvar dateClick = function() {\r\n    editBox.on('click', '[data-node=showDate]', function() {\r\n        var dateDefault = $(this).attr('data-default');\r\n        if (dateDefault) {\r\n            birTip.removeClass(hideCls).text(tips.birthTip.tip);\r\n            return false;\r\n        }\r\n    });\r\n    var eTime = +$_CONFIG['curr_time'];\r\n    var option = {\r\n        endTime: eTime\r\n    };\r\n    require('module/date').initDate(option);\r\n};\r\nmodule.exports = {\r\n    init: dateClick\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/uc_editInfo/selDate.js","/**\r\n * Created by dongyukuan on 2016/7/21.\r\n */\r\nfunction ShowDate(option) {\r\n    this.startTime = option ? option.startTime : +new Date(1930, 1, 1);\r\n    this.endTime = option ? option.endTime : +new Date(2099, 12, 30);\r\n    this.dateReg = /^\\d{4}-\\d{1,2}-\\d{1,2}$/;\r\n    this.yearErrTip = \"请输入正确年份！\";\r\n    this.monErrTip = \"请输入正确月份！\";\r\n    this.ymErrTip = \"请填写正确的年和月！\";\r\n}\r\nShowDate.prototype.addZero = function(num) {\r\n    var n = /^\\d$/;\r\n    var m;\r\n    if (n.test(num)) {\r\n        m = '0' + num;\r\n    } else {\r\n        m = num;\r\n    }\r\n    return m;\r\n};\r\n//获取内容或者写入内容\r\nShowDate.prototype.handleVal = function($node, text) {\r\n    if (text) {\r\n        $node.text(text);\r\n    } else {\r\n        return $node.text();\r\n    }\r\n};\r\n//指定时间戳与当前时间戳做比较\r\nShowDate.prototype.compareDate = function(date) {\r\n    var nowDate = this.endTime;\r\n    var ret = true;\r\n    if (date > nowDate) {\r\n        ret = false;\r\n    } else {\r\n        ret = true;\r\n    }\r\n    return ret;\r\n};\r\n//阿拉伯数字与大写数字的转换\r\nShowDate.prototype.switchNum = function(num) {\r\n    var numAry = ['一',\r\n        '二', '三', '四', '五', '六', '七', '八', '九', '十', '十一', '十二'\r\n    ];\r\n    var upperNum;\r\n    if (/^\\d+$/.test(num)) {\r\n        return numAry[num - 1];\r\n    } else {\r\n        $.each(numAry, function(index, value) {\r\n            if (value == num) {\r\n                upperNum = index + 1;\r\n            }\r\n        });\r\n        return upperNum;\r\n    }\r\n};\r\nShowDate.prototype.init = function() {\r\n    var _self = this;\r\n    //将日历模板添加到盒子中\r\n    if ($('[data-node=data_box]').length === 0) {\r\n        var tplHtml = _self.tpl();\r\n        $('body').append(tplHtml);\r\n    }\r\n    _self.dateContainer = $('[data-node=data_box]');\r\n\r\n    _self.dateBox = _self.dateContainer.find('[data-node=sel_date]');\r\n\r\n    _self.yearBox = _self.dateContainer.find('[data-node=year]');\r\n    _self.mnBox = _self.dateContainer.find('[data-node=month]');\r\n    _self.ymBox = _self.dateContainer.find('[data-node=month],[data-node=year]');\r\n\r\n    _self.dataTable = _self.dateBox.find('[data-node=data_table]');\r\n    _self.tbody = _self.dateBox.find('[data-node=tBody]');\r\n    _self.td = _self.tbody.find('td');\r\n\r\n    _self.prevM = _self.dateBox.find('[data-node=prev_m]');\r\n    _self.nextM = _self.dateBox.find('[data-node=next_m]');\r\n    _self.monBtn = _self.dateBox.find('[data-node=prev_m],[data-node=next_m]');\r\n\r\n    _self.prevY = _self.dateBox.find('[data-node=prev_y]');\r\n    _self.nextY = _self.dateBox.find('[data-node=next_y]');\r\n    _self.yearBtn = _self.dateBox.find('[data-node=prev_y],[data-node=next_y]');\r\n\r\n    //显示日历\r\n    $(document).on('click', '[data-node=showDate]', function() {\r\n        _self.changeDefault($(this));\r\n        _self.show();\r\n        _self.dateText = $(this);\r\n        var topBtn = $(this).offset().top;\r\n        var leftBtn = $(this).offset().left;\r\n\r\n        _self.dateContainer.css('position', 'absolute').css({\r\n            top: topBtn + 50,\r\n            left: leftBtn\r\n        });\r\n        _self.dateBox.css('marginTop', 0);\r\n        return false;\r\n    });\r\n    //点击空白 隐藏日历\r\n    $(document).on('click', function(event) {\r\n        var Target = $(event.target);\r\n        _self.hide(event, Target, $(this));\r\n    });\r\n    //点击选择日期\r\n    _self.tbody.on('click', 'td', function() {\r\n        var newDd = +$(this).text();\r\n        var newYear = parseInt(_self.handleVal(_self.yearBox), 10);\r\n        var newMn = _self.switchNum(_self.handleVal(_self.mnBox));\r\n        var dateFlag = $(this).hasClass('grayClr');\r\n        var trIndex = $(this).parents('tr').index();\r\n        if (dateFlag) {\r\n            if (trIndex === 0) {\r\n                if (newMn === 1) {\r\n                    newYear--;\r\n                    newMn = 12;\r\n                } else {\r\n                    newMn--;\r\n                }\r\n            } else {\r\n                if (newMn === 12) {\r\n                    newYear++;\r\n                    newMn = 1;\r\n                } else {\r\n                    newMn++;\r\n                }\r\n            }\r\n        }\r\n        if (isNaN(newYear) || isNaN(newMn) || newYear < 1930 || newYear > 2099 || newMn < 1 || newMn > 12) { //如果td有值;\r\n            //alert(_self.ymErrTip);\r\n            return false;\r\n        }\r\n        var newDate = +new Date(newYear + \"/\" + newMn + \"/\" + newDd);\r\n        var dateComFlag = _self.compareDate(newDate);\r\n        if (!dateComFlag) {\r\n            //alert(_self.ymErrTip);\r\n            return false;\r\n        }\r\n        _self.dateText.val(newYear + \"-\" + _self.addZero(newMn) + \"-\" + _self.addZero(newDd));\r\n        _self.dateContainer.addClass('hide');\r\n        _self.dateBox.addClass(\"hide\");\r\n    });\r\n    //点击切换月份\r\n    _self.monBtn.on('click', function() {\r\n        _self.changeMn($(this));\r\n        return $(this);\r\n    });\r\n    //点击切换年份\r\n    _self.yearBtn.on('click', function() {\r\n        _self.changeYr($(this));\r\n        return $(this);\r\n    });\r\n};\r\n//日历模板\r\nShowDate.prototype.tpl = function() {\r\n    var str = '';\r\n    str += '<div class=\"data_box hide\" data-node=\"data_box\"> <div class=\"sel_date hide\" data-node=\"sel_date\"> <div class=\"date-nav clearfix\"> <span class=\"icon prev_y fl\" data-node=\"prev_y\">&#xea72;</span> <span class=\"icon prev_m fl\" data-node=\"prev_m\">&#xe970;</span> <div class=\"show_mn fl\"> <a href=\"javascript:;\" data-node=\"month\"> </a> <span class=\"ml5\">月</span> <a href=\"javascript:;\" data-node=\"year\"></a> </div>  <span class=\"icon next_y fr\" data-node=\"next_y\">&#xea73;</span> <span class=\"icon next_m fr\" data-node=\"next_m\">&#xe98c;</span> </div> <table class=\"data_table\" data-node=\"data_table\" cellpadding=\"0\" cellspacing=\"0\"> <thead> <tr> <td>日</td> <td>一</td> <td>二</td> <td>三</td> <td>四</td> <td>五</td> <td>六</td> </tr> </thead> <tbody data-node=\"tBody\"> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> <tr> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> <td><span></span></td> </tr> </tbody> </table> </div> </div>';\r\n    return str;\r\n};\r\n//点击切换月份\r\nShowDate.prototype.changeMn = function(dateContainer) {\r\n    var _self = this;\r\n    var NewMn = _self.switchNum(_self.handleVal(_self.mnBox));\r\n    var newYear = parseInt(_self.handleVal(_self.yearBox), 10);\r\n    if (isNaN(NewMn) || isNaN(newYear)) {\r\n        alert(_self.ymErrTip);\r\n        return false;\r\n    }\r\n    if (dateContainer.hasClass('next_m')) {\r\n        NewMn++;\r\n    } else {\r\n        NewMn--;\r\n    }\r\n    if (NewMn < 1) {\r\n        NewMn = 12;\r\n        newYear--;\r\n    } else if (NewMn > 12) {\r\n        NewMn = 1;\r\n        newYear++;\r\n    }\r\n    _self.handleVal(_self.mnBox, _self.switchNum(NewMn));\r\n    _self.showNow(newYear, NewMn);\r\n};\r\n//点击切换年份\r\nShowDate.prototype.changeYr = function(dateContainer) {\r\n    var _self = this;\r\n    var NewMn = _self.switchNum(_self.handleVal(_self.mnBox));\r\n    var newYear = parseInt(_self.handleVal(_self.yearBox), 10);\r\n    if (isNaN(NewMn) || isNaN(newYear)) {\r\n        alert(_self.ymErrTip);\r\n        return false;\r\n    }\r\n    if (dateContainer.hasClass('next_y')) {\r\n        newYear++;\r\n    } else {\r\n        newYear--;\r\n    }\r\n    if (newYear < 1900) {\r\n        newYear = 1900;\r\n    } else if (newYear > 2099) {\r\n        newYear = 2099;\r\n    }\r\n    _self.handleVal(_self.mnBox, _self.switchNum(NewMn));\r\n    _self.showNow(newYear, NewMn);\r\n};\r\n//文本框 清空初始值\r\nShowDate.prototype.changeDefault = function(dateContainer) {\r\n    var _self = this;\r\n    var deVal = dateContainer.val();\r\n    var regExp = /^\\s*$/g;\r\n    if (!_self.dateReg.test(deVal)) {\r\n        dateContainer.text(\"\");\r\n        _self.showNow();\r\n    } else if (deVal.match(regExp) === null && _self.dateBox.hasClass('hide')) { //如果显示的是非空字符\r\n        var dayArr = deVal.match(/[0-9]{1,4}/g);\r\n        _self.showNow(dayArr[0], dayArr[1], dayArr[2]); //刷新日期\r\n    }\r\n};\r\n//文本框 还原初始值;\r\nShowDate.prototype.changeDefault2 = function(dateContainer) {\r\n    var _self = this;\r\n    var deVal = dateContainer.text();\r\n    if (/^\\s{0}$/.test(deVal)) {\r\n        dateContainer.text(_self.btnTxt);\r\n    }\r\n};\r\n//显示日历\r\nShowDate.prototype.show = function() {\r\n    var _self = this;\r\n    _self.dateContainer.toggleClass('hide');\r\n    _self.dateBox.toggleClass('hide');\r\n};\r\n//隐藏日历\r\nShowDate.prototype.hide = function(event, Target) {\r\n    var _self = this;\r\n    var oPare = Target;\r\n    var isChild = true;\r\n    if (oPare.parents('[data-node=data_box]').length === 0) {\r\n        isChild = false;\r\n    }\r\n    if (!isChild && !_self.dateBox.hasClass('hide')) {\r\n        _self.dateContainer.toggleClass('hide');\r\n        _self.dateBox.addClass('hide');\r\n        _self.changeDefault2(_self.dateText);\r\n    }\r\n};\r\n//填充年、月\r\nShowDate.prototype.showNow = function(yr, mn, date) {\r\n    var _self = this;\r\n    var now = new Date(_self.endTime);\r\n    var year = yr || now.getFullYear();\r\n    var month = mn - 1 || now.getMonth();\r\n    var dd = date || now.getDate();\r\n    //填充 年 和 月\r\n    _self.handleVal(_self.yearBox, year);\r\n    _self.handleVal(_self.mnBox, (_self.switchNum(mn) || _self.switchNum(now.getMonth() + 1)));\r\n    //填充日期\r\n    _self.showAllDay(year, month, dd);\r\n};\r\n//获取每月多少天\r\nShowDate.prototype.getDayLen = function(year, month) {\r\n    var d = new Date(year, month + 1);\r\n    d.setDate(0);\r\n    return d.getDate();\r\n};\r\n//填充当月的所有日期\r\nShowDate.prototype.showAllDay = function(Yr, Mn, Dd) {\r\n    var _self = this;\r\n    var newDate = new Date(Yr, Mn, Dd);\r\n    var year = newDate.getFullYear();\r\n    var month = newDate.getMonth();\r\n    newDate.setDate(0);\r\n    var firstDay = newDate.getDay() + 1;\r\n    var monthPre;//, monthNext;\r\n    if (month === 0) {\r\n        monthPre = 11;\r\n        // monthNext = 1;\r\n    } else if (month === 11) {\r\n        monthPre = 10;\r\n        // monthNext = 0;\r\n    } else {\r\n        monthPre = month - 1;\r\n        // monthNext = month + 1;\r\n    }\r\n    var dayLen = _self.getDayLen(year, month);\r\n    var dayLenPre = _self.getDayLen(year, monthPre);\r\n    // var daylenNext = _self.getDayLen(year, monthNext);\r\n    //清空日期\r\n    _self.td.each(function(index) {\r\n        _self.td.eq(index).removeClass('active').find('span').text(\"\");\r\n    });\r\n    //渲染日期排列\r\n    _self.td.removeClass('grayClr');\r\n    /*\r\n    针对2012-4，日历第一行皆置灰的处理 \r\n       if(firstDay >= 7){\r\n            firstDay -=7;\r\n        }\r\n    */\r\n    for (var i = 0, len = _self.td.length; i < len; i++) {\r\n        if (i < firstDay) {\r\n            _self.td.eq(i).addClass('grayClr').find('span').text(dayLenPre - firstDay + i + 1);\r\n        } else if (i >= firstDay && i < firstDay + dayLen) {\r\n            _self.td.eq(i).find('span').text(i - firstDay + 1);\r\n            if (i - firstDay + 1 == Dd && !_self.td.eq(i).hasClass(\"active\")) {\r\n                _self.td.eq(i).addClass('active');\r\n            }\r\n        } else {\r\n            _self.td.eq(i).addClass('grayClr').find('span').text(i - firstDay - dayLen + 1);\r\n        }\r\n    }\r\n};\r\n//函数调用\r\nmodule.exports = {\r\n    initDate: function(option) {\r\n        var miniDate = new ShowDate(option);\r\n        miniDate.init();\r\n    }\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/date.js","var verifyName = require('./verifyName');\r\nvar limitLen = require('utils/limitLen');\r\nvar editCls = require('./editCls');\r\nvar remCls = editCls.remCls;\r\nvar addCls = editCls.addCls;\r\n\r\nvar editBox = $('[data-node=editBox]').eq(0);\r\nvar nickname = editBox.find('[data-node=nickname]');\r\nvar nameErr = editBox.find('[data-node=nameErr]');\r\nvar errBorder = editBox.find('[data-node=nameBorErr]');\r\nvar comErr = editBox.find('[data-node=comErrTip]');\r\n\r\nvar hideCls = 'hide';\r\nvar borErrCls = 'nicknerror';\r\nvar nameFoc = function() {\r\n\tremCls(errBorder, borErrCls);\r\n\taddCls(nameErr, hideCls);\r\n\taddCls(comErr, hideCls);\r\n};\r\nvar nameKeyup = function() {\r\n\tvar nameVal = nickname.val();\r\n\tvar len = nameVal.length;\r\n\tif (len > 20) {\r\n\t\tnickname.val(limitLen(nameVal, 20));\r\n\t}\r\n};\r\nvar initObj = {\r\n\tinit: function() {\r\n\t\tnickname.on({\r\n\t\t\tblur: verifyName.checkNameRule,\r\n\t\t\tfocus: nameFoc,\r\n\t\t\tkeyup: nameKeyup\r\n\t\t});\r\n\t}\r\n};\r\nmodule.exports = initObj;\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/uc_editInfo/nameEvent.js","// var fetch = require('io/fetch');\r\n// var url = require('io/url');\r\nvar check = require('utils/check');\r\nvar nickTips = require('module/i18n').nickName;\r\n\r\n\r\nvar editCls = require('./editCls');\r\nvar remCls = editCls.remCls;\r\nvar addCls = editCls.addCls;\r\n\r\nvar editBox = $('[data-node=editBox]').eq(0);\r\nvar nickname = editBox.find('[data-node=nickname]');\r\nvar nameErr = editBox.find('[data-node=nameErr]');\r\nvar errBorder = editBox.find('[data-node=nameBorErr]');\r\n\r\nvar hideCls = 'hide';\r\nvar borErrCls = 'nicknerror';\r\n\r\nvar checkRule = function() {\r\n    var ret = true;\r\n    var nameVal = nickname.val();\r\n    var len = nameVal.length;\r\n    var lenFlag = !!(len >= 2 && len <= 20);\r\n    if (!nameVal) {\r\n        ret = false;\r\n        addCls(errBorder, borErrCls);\r\n        remCls(nameErr, hideCls).text(nickTips.eptName);\r\n    } else if (!check.checkNickName(nameVal) || !lenFlag) {\r\n        ret = false;\r\n        addCls(errBorder, borErrCls);\r\n        remCls(nameErr, hideCls).text(nickTips.commonTip);\r\n    } else {\r\n        ret = true;\r\n    }\r\n    return ret;\r\n};\r\n/*var nameExist = function() {\r\n    var nameVal = nickname.val();\r\n    var nameData = {\r\n        \"nickname\": nameVal\r\n    };\r\n    return fetch.get(url.get('checkName'), {\r\n        \"data\": nameData\r\n    }).done(function(data) {\r\n        if (data.success) {\r\n            remCls(errBorder, borErrCls);\r\n            addCls(nameErr, hideCls);\r\n        } else {\r\n            addCls(errBorder, borErrCls);\r\n            remCls(nameErr, hideCls).text(data.message);\r\n        }\r\n    }).fail(function() {\r\n        addCls(errBorder, borErrCls);\r\n        remCls(nameErr, hideCls).text(nickTips.errLine);\r\n    });\r\n};*/\r\n/*var checkName = function() {\r\n    var nameFlag = checkRule();\r\n    if (nameFlag) {\r\n        nameExist();\r\n    }\r\n};*/\r\nmodule.exports = {\r\n    /*\"checkName\": checkName,*/\r\n    \"checkNameRule\": checkRule\r\n   /* \"checkExist\": nameExist*/\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/uc_editInfo/verifyName.js","/**\r\n * Created by dongyukuan on 2016/5/20.\r\n */\r\nvar obj = {\r\n    checkVal: function(val, pattern) {\r\n        return pattern.test(val);\r\n    },\r\n    isMobileNum: function(mobile) {\r\n        return /^1[34578][0-9]{9}$/.test(mobile);\r\n    },\r\n    isEmail: function(email) {\r\n        return /w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*/.test(email);\r\n    },\r\n    isCertificate: function(certificate) {\r\n        return /^(\\d{15}$|^\\d{18}$|^\\d{17}(\\d|X|x))$/.test(certificate);\r\n    },\r\n    isCID: function(cardNo) {\r\n        return /^(\\d{16}|\\d{19})$/.test(cardNo);\r\n    },\r\n    isCWord: function(word, start, end) {\r\n        start = !isNaN(start) && start > 0 ? start : 1;\r\n        end = !isNaN(end) && end > 0 ? end : '';\r\n        var reg = new RegExp('^[\\\\u4e00-\\\\u9fa5]{' + start + ',' + end + '}$');\r\n        //var regPunctuation = /[1-9<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，；‘’“”：'\"\\·`]/;\r\n        // var regRes = reg.test(word);\r\n        //var pugRes = regPunctuation.test(word);\r\n        return reg.test(word);\r\n    },\r\n    isArray: function(arr) {\r\n        return Array.isArray(arr) || (arr instanceof Array);\r\n    },\r\n    passwordReg: function(val) {\r\n        var reg = /^((?=.*?\\d)(?=.*?[A-Za-z])|(?=.*?\\d)(?=.*?[<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，\\\"\\,\\:\\;；,\\.‘’“”：'\"\\·`【】])|(?=.*?[A-Za-z])(?=.*?[<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，；‘’“”：'\"\\·`,\\.【】]))[\\dA-Za-z<>《》！\\*\\(\\^\\)\\$%~!@#\\…&%￥—\\+=、。，；‘’“”：'\"\\·`,\\.【】]{6,21}$/;\r\n        return reg.test(val);\r\n    },\r\n    checkSpace: function(val) {\r\n        var reg = /\\s+/;\r\n        return reg.test(val);\r\n    },\r\n    checkRefCode: function(refCode) {\r\n        var reg = /^[0-9a-zA-Z]{8}$/;\r\n        return reg.test(refCode);\r\n    },\r\n    checkNickName: function(name) {\r\n        var nickNameReg = /^([\\u4e00-\\u9fa5]|[0-9a-zA-Z_-])+$/;\r\n        return nickNameReg.test(name);\r\n    },\r\n    isMsgCode: function(num) {\r\n        var reg = /^\\d{6}$/;\r\n        return reg.test(num);\r\n    },\r\n    isImgCode: function(str) {\r\n        var reg = /^[0-9a-zA-Z]{4}$/;\r\n        return reg.test(str);\r\n    }\r\n};\r\nmodule.exports = obj;\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/check.js","var remCls = function($node, cls) {\r\n    if ($node.hasClass(cls)) {\r\n        $node.removeClass(cls);\r\n    }\r\n    return $node;\r\n};\r\nvar addCls = function($node, cls) {\r\n    if (!$node.hasClass(cls)) {\r\n        $node.addClass(cls);\r\n    }\r\n    return $node;\r\n};\r\nmodule.exports = {\r\n    remCls: remCls,\r\n    addCls: addCls\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/uc_editInfo/editCls.js","/**\r\n * Created by dongyukuan on 2016/5/28.\r\n */\r\nfunction limitLen(str, len) {\r\n    if (str.length > len) {\r\n        return str.substr(0, len);\r\n    } else {\r\n        return str;\r\n    }\r\n}\r\nmodule.exports = limitLen;\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/limitLen.js","var fetch = require('io/fetch');\r\nvar url = require('io/url');\r\nvar nameTips = require('module/i18n').nickName;\r\nvar verifyName = require('./verifyName');\r\n\r\nvar editBox = $('[data-node=editBox]').eq(0);\r\nvar nickname = editBox.find('[data-node=nickname]');\r\nvar sexBox = editBox.find('[data-node=sexBox]');\r\nvar birthday = editBox.find('[data-node=showDate]');\r\nvar subDate = editBox.find('[data-action=subDate]');\r\nvar comTip = editBox.find('[data-node=comErrTip]');\r\nvar nameBorErr = editBox.find('[data-node=nameBorErr]');\r\nvar faceImg = editBox.find('[data-node=faceImg]');\r\nvar birthTip = editBox.find('[data-node=birTip]');\r\n\r\nvar header = $('[data-node=header]');\r\nvar headImg = header.find('[data-node=headImg]');\r\nvar headName = header.find('[data-node=headName]');\r\n\r\nvar birthPre = birthday.attr('data-default');\r\n\r\nvar dateReg = /^\\d{4}-\\d{1,2}-\\d{1,2}$/;\r\nvar hideCls = 'hide';\r\nvar errBorCls = 'nicknerror';\r\nvar sub = function() {\r\n    comTip.addClass(hideCls);\r\n    var nameVal = nickname.val();\r\n    var sexVal = sexBox.find('input:checked').val();\r\n    var birthVal = birthday.val();\r\n    birthVal = birthPre || (dateReg.test(birthVal) ? birthVal : '');\r\n    var faceImgUrl = faceImg.attr('src');\r\n    var nameFlag = verifyName.checkNameRule();\r\n    var errFlag = !nameBorErr.hasClass(errBorCls);\r\n    if (nameFlag && errFlag) {\r\n        // verifyName.checkExist().then(function(data) {\r\n        // if (data.success) {\r\n        var subData = {\r\n            \"facePicUrl\": faceImgUrl,\r\n            \"birthday\": birthVal,\r\n            \"nickname\": nameVal,\r\n            \"gender\": sexVal\r\n        };\r\n        fetch.post(url.get('subName'), {\r\n            data: subData\r\n        }).done(function(data) {\r\n            if (data.success) {\r\n                comTip.removeClass(hideCls).text(nameTips.sucSub);\r\n                headImg.attr('src', faceImgUrl);\r\n                headName.text(nameVal);\r\n                var birFlag = dateReg.test(birthVal);\r\n                if (birFlag && !birthPre) {\r\n                    birthday.attr('data-default', birthVal);\r\n                    birthTip.addClass(hideCls);\r\n                }\r\n            } else {\r\n                comTip.removeClass(hideCls).text(data.message);\r\n            }\r\n        }).fail(function() {\r\n            comTip.removeClass(hideCls).text(nameTips.errLine);\r\n        });\r\n    }\r\n    // });\r\n    // }\r\n};\r\nvar subEvent = function() {\r\n    subDate.on('click', sub);\r\n};\r\nmodule.exports = {\r\n    subInit: subEvent\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/uc_editInfo/subData.js"],"sourceRoot":""}
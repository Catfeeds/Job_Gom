{"version":3,"sources":["webpack:///topicDetails.js","webpack:///./src/js/page/topicDetails/index.js","webpack:///./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js?5041***************","webpack:///./src/js/module/popup/alert.js?466a***************","webpack:///./src/js/module/hint.js?34fa**********","webpack:///./src/js/module/atgregion.js?5113","webpack:///./src/js/plugin/jquery.lazyload.js?7b8d*","webpack:///./src/js/module/popup/face/emoji.js?d6cd*****","webpack:///./src/js/module/popup/confirm.js","webpack:///./src/js/utils/encodeHtml.js?4c98**","webpack:///./src/js/module/popup/face/face.js?b70b**","webpack:///./src/js/module/popup/face/backward.js?6a63****","webpack:///./src/js/module/popup/face/face.tpl?dd34****","webpack:///./src/js/module/i18n.js","webpack:///./src/js/plugin/webuploader/webuploader.js?37bb****","webpack:///./src/js/module/popup/upload/dialog.js?5b30**","webpack:///./src/js/module/popup/upload/content.tpl?cddf**","webpack:///./src/js/module/share.js?fbb7***","webpack:///./src/js/utils/getQRCode.js?13de***","webpack:///./src/js/module/popup/upload/uploader.js?5c04*","webpack:///./src/js/module/upload.js?e6aa*","webpack:///./src/js/utils/imgReplace.js?de1e*","webpack:///./src/js/module/popup/uploadfileQR/index.js?bd83*","webpack:///./src/js/module/popup/uploadfileQR/upload.tpl?dece*","webpack:///./src/js/editor/config.js?f540*","webpack:///./src/js/module/addGoods.js?afd4*","webpack:///./src/js/module/popup/addGoods/dialog.js?fbcd*","webpack:///./src/js/module/popup/addGoods/content.tpl?33fc*","webpack:///./src/js/module/popup/addGoods/itemContent.tpl?2c0d*","webpack:///./src/js/module/popup/addGoods/defaultItemContent.tpl?2cc1*","webpack:///./src/js/module/joinCircle.js?325d","webpack:///./src/js/module/sensitiveContent.js?7deb","webpack:///./src/js/module/praise.js?0d4d*","webpack:///./src/js/page/topicDetails/comment/commentv2.js","webpack:///./src/js/utils/IdentifyIE8-.js","webpack:///./src/js/page/topicDetails/comment/getCommentList.js","webpack:///./src/js/page/topicDetails/comment/changeContent.js","webpack:///./src/js/utils/fromNow.js","webpack:///./src/js/page/topicDetails/comment/commentList.tpl","webpack:///./src/js/page/topicDetails/comment/addImageTpl.tpl","webpack:///./src/js/page/topicDetails/comment/a_submit.js","webpack:///./src/js/page/topicDetails/comment/loginState.js","webpack:///./src/js/page/topicDetails/comment/a_secondComBtn.js","webpack:///./src/js/page/topicDetails/comment/secondComList.tpl","webpack:///./src/js/page/topicDetails/comment/showMoreList.js","webpack:///./src/js/page/topicDetails/comment/Smiley.js","webpack:///./src/js/page/topicDetails/comment/otherFn.js","webpack:///./src/js/page/topicDetails/praise.js","webpack:///./src/js/page/topicDetails/share.js","webpack:///./src/js/module/shareBP.js","webpack:///./src/js/page/topicDetails/collect.js","webpack:///./src/js/page/topicDetails/topicAddMore/topicAddMore.js","webpack:///./src/js/page/topicDetails/topicAddMore/title.tpl","webpack:///./src/js/page/topicDetails/topicAddMore/comList.tpl","webpack:///./src/js/page/topicDetails/topicAddMore/commentBox.tpl","webpack:///./src/js/page/topicDetails/topicAddMore/topicRight.tpl","webpack:///./src/js/plugin/jquery.history.js","webpack:///./src/js/page/topicDetails/deletUserTopic.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/addIMG.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/rotateImg.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/chooseImg.tpl","webpack:///./src/js/page/topicDetails/comment/addImgGoods/addGoods.js","webpack:///./src/js/page/topicDetails/comment/addImgGoods/goodsIn.tpl","webpack:///./src/js/page/topicDetails/report.js","webpack:///./src/js/page/topicDetails/report.tpl"],"names":["webpackJsonp","module","exports","__webpack_require__","$","attr","lazyload","effect","commentv2","circle","praise","share","collect","topicAddMore","deleUserTopic","addImg","addGoods","buriedPoint","setPageData","reportTopic","init","on","done","getLoginState","window","location","reload","call","a","b","test","h","g","c","l","d","replace","e","m","length","f","match","get","i","filename","name","message","k","j","prototype","n","toString","stack","split","slice","join","console","error","cache","this","String","<",">","\"","'","&","Array","isArray","utils","$helpers","$include","$string","$escape","$each","o","helpers","helper","Dialog","noop","create","content","options","defaults","fixed","modal","autofocus","className","okCls","ok","extend","header","_$","title","css","show","$publicMask","$publicTips","timer","events","off","hide","msg","duration","callback","clearTimeout","text","append","offsetHeight","width","setTimeout","$_CONFIG","fetch","Pubsub","url","hostname","len","domain","getCookieArea","ss_service_gome","dataType","jsonpCallback","data","value","atgregion","success","cookie","expires","path","pub","jQuery","$container","$window","fn","update","counter","elements","each","$this","settings","skip_invisible","is","abovethetop","leftofbegin","belowthefold","rightoffold","failure_limit","trigger","threshold","event","container","data_attribute","appear","load","undefined","failurelimit","effectspeed","effect_speed","indexOf","bind","self","$self","loaded","one","elements_left","temp","grep","element","fold","height","scrollTop","offset","top","scrollLeft","left","inviewport","rightofscreen","leftofscreen","expr","below-the-fold","above-the-top","right-of-screen","left-of-screen","in-viewport","above-the-fold","right-of-fold","left-of-fold","imgPath","imgpath","ext","groupOne","groupTwo","groupThree","groupFour","groupFive","format","arr","emoji","concat","cancel","btnWrapCls","html","str","reg","“","”","faceReg","faceUrl","emojis","backward","faceTpl","defaultIndex","emojiMap","makeData","total","page","Math","ceil","list","end","push","x","y","setShowIndex","index","eq","addClass","siblings","removeClass","insertFace","isHide","preventDefault","stopPropagation","initHTML","faceHTML","initEvent","document","parseEmoji","r","isEmptyObject","s","$1","img","old","insert","亲","愤怒","惊恐","迷茫","伤心","努力","YY","恶心","template","$data","$filename","$utils","v","face","$index","$out","inputTip","tel","ept","err","errBack","msgCode","tipGet","tipEpt","tipErr","tipErrEdit","tipWrong","checkCodeWrong","send","tipSend","tipDisabled","tipLimitEdit","btnAfterSend","btnDefault","pwd","commonTip","pwdV","nickName","eptName","existName","sucSub","errLine","wrongName","birthTip","tip","refCode","imgCode","login","errCode","errNum","errPwd","agreement","createCircle","typeEmpty","nameEmpty","upperLimit","unJoin","cannotJoin","review","joinSuccess","joinSuccessPublic","cannotJoinCircle","exit","dissolved","qrCodeTip","loseEffTip","loseEffBtn","failGetTip","failGetBtn","masterApply","nameLength","nameType","isIdCard","type","summary","upload","noUpload","uploadError","uploadFaild","uploadError_Master","Q_EXCEED_NUM_LIMIT","Q_EXCEED_SIZE_LIMIT","Q_TYPE_DENIED","F_EXCEED_SIZE","excess","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","__webpack_provided_window_dot_jQuery","root","factory","modules","_require","deps","args","getModule","apply","_define","id","arguments","setModule","returned","Error","exportsTo","obj","key","host","parts","part","last","ucFirst","charAt","toUpperCase","substr","hasOwnProperty","pop","shift","makeExport","dollar","__dollar","define","require","Zepto","_","Deferred","when","isPromise","anything","then","promise","uncurryThis","bindFn","context","createObject","proto","Object","Function","version","browser","ua","ret","webkit","chrome","ie","firefox","safari","opera","parseFloat","navigator","userAgent","os","android","ios","inherits","Super","protos","staticProtos","child","constructor","__super__","log","nextTick","cb","guid","prefix","Date","floor","random","formatSize","size","pointLength","units","unit","toFixed","Base","findHandlers","handler","_cb","ctx","eachEvent","iterator","separator","triggerHanders","stoped","ctx2","set","me","_events","once","allEvents","installTo","Mediator","Uploader","opts","_init","stop","getFile","getFiles","addFile","addFiles","sort","removeFile","cancelFile","skipFile","retry","isInProgress","makeThumb","md5File","getDimension","addButton","predictRuntimeType","refresh","disable","enable","reset","command","request","state","option","val","isPlainObject","getStats","stats","successNum","numOfSuccess","progressNum","numOfProgress","cancelNum","numOfCancel","invalidNum","numOfInvalid","uploadFailNum","numOfUploadFailed","queueNum","numOfQueue","interruptNum","numofInterrupt","substring","isFunction","destroy","Runtime","body","uid","factories","getFirstKey","getContainer","parent","_container","createElement","position","overflow","_parent","exec","remove","orders","addRuntime","hasRuntime","runtime","RuntimeClient","component","standalone","deferred","runtimeReady","connectRuntime","__promise","resolve","__client","runtimeOrder","add","__standalone","getRuntime","disconnectRuntime","unshift","getRuid","ruid","RuntimeClent","DragAndDrop","accept","disableGlobalDnd","isArrayLike","nodeType","Widget","uploader","owner","_destroy","IGNORE","widgetClass","invoke","apiName","map","responseMap","widgets","_widgets","deactives","disableWidgets","klass","_name","widget","rlt","rlts","dfds","pipe","register","widgetProto","toLowerCase","unRegister","splice","Dnd","dnd","files","items","FilePaste","paste","Blob","source","start","getSource","File","file","rExt","RegExp","lastModifiedDate","toLocaleString","FilePicker","innerHTML","label","button","multiple","_refer","_resizeHandler","shimContainer","outerWidth","outerHeight","pos","bottom","right","btn","pick","pickers","addBtn","promises","picker","swf","Image","_info","_meta","quality","crop","preserveHeaders","allowMagnify","info","meta","loadFromBlob","blob","resize","getAsDataUrl","getAsBlob","throttle","max","occupied","waiting","tick","item","emiter","thumb","compress","image","isArtwork","reason","beforeSendFile","compressSize","noCompressIfLarger","_compressed","always","reject","gid","idPrefix","idSuffix","WUFile","statusText","statusMap","Status","INITED","setStatus","ERROR","status","prevStatus","getStatus","QUEUED","PROGRESS","COMPLETE","CANCELLED","INTERRUPT","INVALID","Queue","numofDeleted","_queue","_map","STATUS","_fileAdded","prepend","fileId","sts","inArray","existing","cur","pre","_onFileStatusChange","curStatus","preStatus","extensions","queue","placeholder","_ruid","_wrapFile","acceptFile","invalid","_addFile","auto","fetchFile","noForceStart","sortFiles","support","Transport","_blob","_formData","formData","_headers","headers","_timeout","_timer","server","method","withCredentials","fileVal","timeout","sendAsBinary","appendBlob","setRequestHeader","abort","getResponse","getResponseAsJson","CuteFile","chunkSize","api","pending","chunks","has","block","min","chunk","cuted","blocks","remaning","prepareNextFile","chunked","chunkRetry","threads","runing","progress","pool","__tick","_tick","transport","_trigged","_promise","startUpload","stopUpload","interrupt","_putback","_popBlock","_tr","_getStats","skipped","_nextBlock","_startSend","idx","_getStack","act","next","preparing","_prepareNextFile","_finishFile","fail","_doSend","percentage","updateFileProgress","requestAccept","tr","_raw","flag","retried","hds","totalPercent","uploaded","validators","addValidator","removeValidator","count","parseInt","fileNumLimit","fileSizeLimit","fileSingleSizeLimit","hashString","_char","hash","charCodeAt","mapping","duplicate","__hash","Md5","getResult","md5","notify","CompBase","Html5Runtime","comp","instance","client","components","FileReader","DataView","webkitSlice","mozSlice","elem","dragEnterHandler","_dragEnterHandler","dragOverHandler","_dragOverHandler","dragLeaveHandler","_dragLeaveHandler","dropHandler","_dropHandler","dndOver","denied","_denied","originalEvent","dataTransfer","dropEffect","parentElem","contains","currentTarget","_leaveTimer","getData","_getTansferFiles","results","canAccessFolder","webkitGetAsEntry","isDirectory","_traverseDirectoryTree","entry","isFile","createReader","readEntries","entries","mimeTypes","hander","_pasteHander","allowed","clipboardData","kind","getAsFile","mouseHandler","input","opacity","display","cursor","background","clone","callee","target","cloneNode","parentNode","replaceChild","urlAPI","createObjectURL","URL","revokeObjectURL","webkitURL","dataURL2Blob","dataURI","byteStr","intArray","ab","mimetype","atob","decodeURIComponent","ArrayBuffer","Uint8Array","arrayBufferToBlob","dataURL2ArrayBuffer","buffer","bb","builder","BlobBuilder","WebKitBlobBuilder","getBlob","canvasToDataUrl","canvas","toDataURL","parseMeta","updateImageHead","Util","parsers","65505","maxMetaDataSize","parse","fr","onload","_parse","result","onerror","readAsArrayBuffer","noParse","byteLength","markerBytes","markerLength","dataview","maxOffset","headLength","getUint16","imageHead","subarray","head","buf1","buf2","bodyoffset","ImageMeta","EXIF","ExifMap","Orientation","exifTagTypes","1","getValue","dataView","dataOffset","getUint8","2","fromCharCode","ascii","3","littleEndian","4","getUint32","5","9","getInt32","10","getExifValue","tiffOffset","tagSize","values","tagType","parseExifTag","tag","exif","parseExifTags","dirOffset","tagsNumber","dirEndOffset","parseExifData","JPEGEncoder","initQuantTables","sf","YQT","t","ffloor","YTable","ZigZag","UVQT","u","UVTable","aasf","row","col","fdtbl_Y","fdtbl_UV","computeHuffmanTbl","nrcodes","std_table","codevalue","pos_in_table","HT","initHuffmanTbl","YDC_HT","std_dc_luminance_nrcodes","std_dc_luminance_values","UVDC_HT","std_dc_chrominance_nrcodes","std_dc_chrominance_values","YAC_HT","std_ac_luminance_nrcodes","std_ac_luminance_values","UVAC_HT","std_ac_chrominance_nrcodes","std_ac_chrominance_values","initCategoryNumber","nrlower","nrupper","cat","nr","category","bitcode","nrneg","initRGBYUVTable","RGB_YUV_TABLE","writeBits","bs","posval","bytenew","bytepos","writeByte","byteout","clt","writeWord","fDCTQuant","fdtbl","d0","d1","d2","d3","d4","d5","d6","d7","dataOff","I8","I64","tmp0","tmp7","tmp1","tmp6","tmp2","tmp5","tmp3","tmp4","tmp10","tmp13","tmp11","tmp12","z1","z5","z2","z4","z3","z11","z13","tmp0p2","tmp7p2","tmp1p2","tmp6p2","tmp2p2","tmp5p2","tmp3p2","tmp4p2","tmp10p2","tmp13p2","tmp11p2","tmp12p2","z1p2","z5p2","z2p2","z4p2","z3p2","z11p2","z13p2","outputfDCTQuant","writeAPP0","writeSOF0","writeDQT","writeDHT","p","writeSOS","processDU","CDU","DC","HTDC","HTAC","EOB","M16zeroes","I16","I63","DU_DCT","DU","Diff","end0pos","lng","startpos","nrzeroes","nrmarker","initCharLookupTable","sfcc","setQuality","currentQuality","round","YDU","UDU","VDU","encode","DCY","DCU","DCV","displayName","imageData","quadWidth","fillbits","jpegDataUri","btoa","encoder","supportJpeg","origin","w","fragement","getContext","getImageData","BLANK","modified","_metas","_img","src","_canvas","_resize","cvs","iw","naturalWidth","ih","naturalHeight","orientation","getOrientation","_rotate2Orientaion","_renderImageToCanvas","clearRect","scale","translate","rotate","PI","detectVerticalSquash","alpha","ratio","sy","ey","py","drawImage","detectSubsampling","vertSquashRatio","tmpCanvas","tmpCtx","dw","dh","sx","dx","subsampled","doSquash","dy","save","restore","_status","_response","binary","xhr","_initAjax","param","FormData","open","_setRequestHeader","overrideMimeType","_parseJson","_xhr","onprogress","onreadystatechange","XMLHttpRequest","XDomainRequest","lengthComputable","readyState","responseText","json","JSON","ex","FlashRuntime","add32","cmn","q","ff","gg","hh","ii","md5cycle","md5blk","md5blks","md5blk_array","md51","tail","tmp","lo","hi","md51_array","hex_chr","rhex","hex","SparkMD5","lsw","msw","unescape","encodeURIComponent","appendBinary","contents","_buff","_length","_state","raw","buff","_finish","hashBinary","_concatArrayBuffer","first","second","firstLength","loadNext","spark","blobSlice","onloadend","getFlashVersion","plugins","description","ActiveXObject","GetVariable","ex2","evt","clients","jsreciver","flashExec","flash","getFlash","_flash","copy","_responseJson","forceURLStream","mimeType","percent","readBody","base","logUrl","product","dv","master","online","code","c_error_code","c_reason","c_count","c_size","c_usage","preset","tpl","okValue","cancalValue","maxlength","getQRCode","checkLoginStatus","APIS","qq","wb","qz","defaultInfo","pic","hasShareBtnsHTML","initShareBtns","shareBtns","showShareToBtns","style","hasWeixinHTML","initWeixinHTML","weixinBox","formatParams","pics","site","shareTo","weixin","link","shareWithKid","isRebate","validate","skuId","itemId","parentKid","async","kid","shareInfo","onlineUserId","shareto","go","desc","shareItem","selector","beforeShare","$item","shareUrl","shareTitle","sharePic","pw","ph","px","shareType","group_domain","uploadPop","pubName","alert","imgReplace","maxLen","dialogUploader","$webUpLoader","node","find","hasClass","$imgList","images","setPubliser","changeImage","callbacks","onFileQueued","numList","number","$uploadBox","children","before","onUploadSuccess","response","WebUploader","hint","notice","defaultOptions","parents","delSelector","defaultApi","onBeforeFileQueued","onUploadError","onUploadProgress","onErrored","_this","delImage","webuploader","rules","https","imgRule","shotCut","imgType","grepStr1","grepStr2","orignalImgReplace","addShortCut","imgProto","changeSrc","$imgs","not","_src","_orignal","Scans","qid","topicQrId","$parent","uploadMaxNum","maxNum","useNewCode","interval","$showBox","time","customInit","customCb","isLoad","imgArr","editor","$cover","$localBtn","$target","codeTpl","$GLOBAL_CONFIG","config","pageId","imgLimitNUm","tagName","checkShow","getCode","imgLength","getContent","datas","qidArr","qrcodeId","_data","getCodeCb","setInterval","monitor","post","groupkey","scanCb","clearInterval","sendNum","insertPic","_proto","execCommand","loading","setDisabled","unLoading","setEnabled","fixPop","$btn","isload","dataArr","tempArr","diffLen","whiteList","div","dl","dt","em","h1","h2","h3","h4","h5","h6","span","ul","ol","li","goodsLimitNUm","initialFrameWidth","initialFrameHeight","zIndex","autoClearinitialContent","UEDITOR_HOME_URL","serverUrl","themePath","csspath","whitList","toolbars","iframeCssUrl","pasteplain","allowDivTransToP","imageScaleEnabled","elementPathEnabled","wordCount","catchRemoteImageEnable","enableContextMenu","imagePopup","enableAutoSave","addDialog","dialog","itemlist","defaultItemlist","indexof","pageNum","isDefault","keyWord","changedList","isGetMore","degree","$searchTop","$searchInput","$searchBtn","$searchNormal","$searchLoading","$searchFail","$searchResult","$searchList","$changeNum","$listBox","$changeList","$title","$getMore","$searchListBox","selectedGoods","changedGoods","returnList","imgSrc","changeNum","changedItem","dialogClosed","onshow","getNode","defaultItem","searchItem","reGet","changeItem","getMoreItem","overflowY","getItems","pagesize","keycode","which","trim","moreItem","prev","txt","pagenum","word","pageCount","resultItem","collections","pId","shopId","itemLink","empty","PId","price","del","closest","$value","sUrl","mainImage","salePrice","rebateMoney","skuPrice","rebate","confirm","tips","loginPop","$els","$action","focus","groupId","memberType","bpData","event_id","group_id","circle_type","topic_id","BP","userid","noRefreshFetch","groupid","imid","cancelValue","cancelCls","text-align","margin","font-size","margin-left","exitCircle","onclose","href","sensitiveTitle","comment","channel","popFlag","setData","$node","normal","reduce","getCallback","mode","onPraise","onUnPraise","onPraised","objs","enableEditor","pid","isPraise","identify","getCommentList","a_Submit","secondComBtn","showMoreList","loginState","Smiley","otherFn","$loadlist","$comment_Msg","clickTopicId","DIVOBJ","textareaTips","commentDomInit","commentCheck","secondCom_Key","hideComBox","a_secondComBtn","showEmoji","hideTextareaTips","showTextareaTips","textVal","insertAtCursor","curretTextAreaObj","lodingMore","goComment","sub","isIE","safariVersion","checkUserId","$is_Login","i_domain","timeString","addZero","num","newNum","date","fullYear","getFullYear","month","getMonth","day","getDate","getHours","mm","getMinutes","ss","getSeconds","changeContent","fromNow","commentList","addImageTpl","$mall_domain","$userIsExpert","$secondCom_Key","LoadListStr","LoadtingStr","currPage","pageSize","listSize","nodelist","$hidDiv","$thisObjId","$ComTopicId","$loading","currUserImg","paramList","topicReplys","topicMsg","subReplyQuantity","subTop","topicSubReplys","replySecArr","showNum","dlShowBorder","showMall","UserId","user","showReport","showSecComm","subTopMsg","replayToPub","beReplyUserName","beReplyUserId","threeUserId","topicSubReplyUser","nickname","contentSed","SenUserId","replySecMsg","parentCommentId","replyUserName","replyUserId","replyCommentId","topicPic","imageStr","imgsrcPic","picsSrc","picture","pictures","itemsPic","itemShopName","itemPrice","itemShopId","itemShopNameItem","shopPic","redPackage","shop","icon","promotionMark","hasCouponPlan","showDateList","userIsExpert","isExpert","expertInfo","userPic","facePicUrl","username","backTopicId","topicType","replyType","topicId","times","createTime","isFirstCom","secondReply","mall_domain","htmlNull","re","encodeHtml","timeStr","showTime","getTime","maxDay","oneMin","oneHour","oneDay","getd","userSubmit","imId","replyCommentNum","currentPage","sensitiveContent","popUnion","parentDiv","comment_Msg","topicid","lis","imgPics","imgObj","$addImgGoods","itemid","$goodIn","params","reply_type","shopid","skuid","Msg","contentMsg","goodObj","basics","idNode","animate","$a_Submit","ISLOGIN","removeAttr","secondComList","beReplyId","tId","replyId","topic_reply_id","topic_subreply_id","contentT","showCom","replyuserid","replycommentid","dataPublis","dataObj","hideId","getRelyList","replyCommentList","commentid","replyaList","objHtml","childrens","curretTextArea","selectText","textbox","startIndex","stopIndex","setSelectionRange","createTextRagen","range","createTextRange","collapse","moveStart","moveEnd","select","selectionStart","selectionEnd","selection","createRange","hideDiv","userSubmits","addmorepages","listsize","toPage","$body","s_c","channel_id","$topObj","offsetTop","$praiseClick","shareBP","gomeplusLogo","getShareInfo","$ul","shareId","evtType","wap_circle_url","getcookie","objname","cookieArr","share_id","shareData","sp","pf","sc","st","page_id","sid","shareObj","user_id","cid","env","di","stringify","ht","wx","share_time","userId","cookie_id","share_ssid","share_env","passport_domain","$collect","$CONF","iscollect","onLogin","addDivHtml","newMsg1","newMsg","rightNextMsg","topicRT","hotTopicUl","nextTopName","topicName","nextTopTime","lastReplyTime","htqzxxmodule","htrmhtmodule","htxyymodule","elemTitle","titel","elemCommentBox","commentBox","elemComList","comList","elemRight","topicRight","topicHtml","$topicWrap","$leftImg","getVideo","videoArr","newVideo","idVideo","_video","video_id","MeixinPlayer","videoObj","stopVideo","getNextTopicId","openTopicId","arrayIdBoolean","$getNext","nextLoading","slideDown","userImage","pathImg","isLoginClass","isLoginStr","readyOnly","isLogin","dataStr","downLoadTopic","allNum","replyQuantity","jctjmodule","getModuleString","htxqmodule","htcyplmodule","htpllbmodule","ggjzgdmodule","isEssence","isUpper","groupCircleName","group","extGroupUrl","group_url","extImagesLst","surl","share_text","extSpic","images_lst","extStitle","isLike","isLikeName","userQuantity","userCollection","userCollectionName","userCollectionStatu","dataParise","mshopFlag","mshop_flag","mshopUrl","mshop_url","coverPic","is_del","Number","ListTopsValid","topRightH","addMoreEvent","OpenedTop","clickTopicObj","History","replaceState","$no_next","addVisitTopicId","changeGoodsPrice","currentId","id1","name1","scrollToTop","nextiD","topFixed","showTopicID","$showDiv","$showRight","$thisScroll","$showLeft","showDivHeight","showRightHeight","thisScrollHeight","windowHight","showLeftHeight","floatRight","TopShow","BottomShow","pp","autoTop","opx","ulFixt","containerId","$divConter","divTop","divHeight","ulHeight","leftS","toTopBtn","$Btn","btnScroll","winScrollTop","dropTop","lastScroll","oldCurrentId","getGoodsPrice","goodsId","ids","curTopicId","modulestr","$textareaTips","Adapter","noneHeight","$current","nextAll","prevAll","_typeof","Symbol","el","extra","extractEventData","onDomLoad","sessionStorage","history","setItem","removeItem","decode","initCore","initHtml4","initialized","hashChangeInterval","safariPollInterval","doubleCheckInterval","disableSuid","storeInterval","busyDelay","debug","initialTitle","html4Mode","delayInit","intervalList","clearAllIntervals","il","arg","consoleExists","textarea","getElementById","Exception","scrollHeight","clientHeight","getInternetExplorerMajorVersion","cached","all","getElementsByTagName","isInternetExplorer","Boolean","emulated","pushState","hashChange","enabled","bugs","setHash","vendor","safariPoll","ieDoubleCheck","hashEscape","cloneObject","newObj","getRootUrl","rootUrl","protocol","port","getBaseHref","baseElements","baseElement","baseHref","getBaseUrl","baseUrl","getBasePageUrl","getPageUrl","pageUrl","State","getState","stateUrl","getLocationHref","string","basePageUrl","getFullUrl","allowBaseHref","fullUrl","firstChar","getShortUrl","shortUrl","isTraditionalAnchor","doc","store","idToState","stateToId","urlToId","storedStates","savedStates","normalizeStore","friendly","getLastSavedState","createStateObject","cleanUrl","getIdByState","newState","extractId","getStateString","normalizeState","oldState","dataNotEmpty","normalized","hashedUrl","hasUrlDuplicate","getStateById","passedState","cleanedState","getStateId","getHashByState","url_or_hash","isTraditional","extractState","getIdByUrl","getLastStoredState","hasDuplicate","storeState","isLastSavedState","newId","oldId","isLast","saveState","getStateByIndex","getCurrentIndex","getHash","getHashByUrl","unescapeHash","normalizeHash","busy","pushQueue","scope","escapeHash","setTitle","firstState","queues","fireNext","fireQueueItem","clearQueue","stateChanged","doubleChecker","doubleCheckComplete","doubleCheckClear","doubleCheck","tryAgain","safariStatePoll","urlState","back","forward","emptyFunction","onPopState","currentHash","currentState","stateId","expectedStateId","getItem","onUnload","currentStore","currentStoreString","DOMException","QUOTA_EXCEEDED_ERR","appCodeName","deletTopic","sendMsg","idd","rotateImg","addImgTpl","detectQr","showImgBox","btnEvent","addMoreImgFn","imgPicsBig","imgBigHindFn","hideBigPicFn","imgBigPNFn","deletImgFn","showImgFn","picPopBoxEvent","codeBoxEvent","$div","imgLENG","arriMG","imgNum","toImG","curPage","tootalPage","click","divObj","parentObj","ulObj","divBig","thisBigPic","thisImage","aBtn","$imgSrc","setImage","arrImg","nextnum","imgsrt","pictureHTML","lengthImg","_newObj","$insertDom","imgs","addEvent","divEm","$img","oldImgSrc","roteNum","transform","-ms-transform","-moz-transform","-webkit-transform","-o-transform","angle","_defineProperty","defineProperty","enumerable","configurable","writable","goodsInTpl","showGoodsBox","setGoods","goodsData","strGood","reportId","reportTpl","reportBtn","reportSpan","checked","active","isChecked"],"mappings":"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","file":"topicDetails.js","sourcesContent":["webpackJsonp([30],[\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {\"use strict\";\n\t\n\t$(\"body\").attr(\"data-module\", \"1\");\n\t__webpack_require__(50);\n\t$(\"img\").lazyload({\n\t    effect: \"fadeIn\"\n\t});\n\tvar commentv2 = __webpack_require__(244);\n\tvar circle = __webpack_require__(187);\n\t//var follow = require('./follow');\n\tvar praise = __webpack_require__(258);\n\tvar share = __webpack_require__(259);\n\tvar collect = __webpack_require__(261);\n\t\n\tvar topicAddMore = __webpack_require__(262);\n\t// 发送统计数据用\n\tvar deleUserTopic = __webpack_require__(268);\n\tvar addImg = __webpack_require__(269);\n\tvar addGoods = __webpack_require__(272);\n\tvar buriedPoint = __webpack_require__(40);\n\tburiedPoint.setPageData('topicDetail');\n\tvar reportTopic = __webpack_require__(274);\n\t\n\tcommentv2.init(); // 评论\n\tshare.init(); // 分享\n\tcollect.init(); // 收藏\n\tpraise.init(); // 赞\n\t//follow.init($('[data-node=\"follow\"]')); // 加关注\n\ttopicAddMore.init(); //加载更多话题\n\t\n\tdeleUserTopic.init();\n\t\n\taddGoods.init(); //商品选择\n\taddImg.init(); //添加图片事件\n\t\n\treportTopic.init(); //举报话题\n\t\n\t\n\t// 加入圈子\n\t$('body').on('click', '[data-node=\"circle\"]', {\n\t    done: function done() {\n\t        commentv2.getLoginState();\n\t        window.location.reload();\n\t    }\n\t}, circle);\n\t$(\"img\").lazyload({\n\t    effect: \"fadeIn\"\n\t});\n\t\n\t/*$(\".source-rig-box img\").not('.publish-item img').attr('src', '').on('error', function() {\n\t    imgError(this, 'l');\n\t})\n\t*/\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */,\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */,\n/* 17 */,\n/* 18 */,\n/* 19 */,\n/* 20 */,\n/* 21 */,\n/* 22 */,\n/* 23 */,\n/* 24 */,\n/* 25 */,\n/* 26 */,\n/* 27 */,\n/* 28 */,\n/* 29 */,\n/* 30 */,\n/* 31 */,\n/* 32 */,\n/* 33 */,\n/* 34 */\n/***/ (function(module, exports) {\n\n\t/*TMODJS:{}*/\r\n\t!function () {\r\n\t\tfunction a(a, b) {\r\n\t\t\treturn (/string|function/.test(typeof b) ? h : g)(a, b)\r\n\t\t}\r\n\t\r\n\t\tfunction b(a, c) {\r\n\t\t\treturn \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a\r\n\t\t}\r\n\t\r\n\t\tfunction c(a) {\r\n\t\t\treturn l[a]\r\n\t\t}\r\n\t\r\n\t\tfunction d(a) {\r\n\t\t\treturn b(a).replace(/&(?![\\w#]+;)|[<>\"']/g, c)\r\n\t\t}\r\n\t\r\n\t\tfunction e(a, b) {\r\n\t\t\tif (m(a))for (var c = 0, d = a.length; d > c; c++)b.call(a, a[c], c, a); else for (c in a)b.call(a, a[c], c)\r\n\t\t}\r\n\t\r\n\t\tfunction f(a, b) {\r\n\t\t\tvar c = /(\\/)[^\\/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^\\/]+$/, \"\"), e = d + b;\r\n\t\t\tfor (e = e.replace(/\\/\\.\\//g, \"/\"); e.match(c);)e = e.replace(c, \"/\");\r\n\t\t\treturn e\r\n\t\t}\r\n\t\r\n\t\tfunction g(b, c) {\r\n\t\t\tvar d = a.get(b) || i({filename: b, name: \"Render Error\", message: \"Template not found\"});\r\n\t\t\treturn c ? d(c) : d\r\n\t\t}\r\n\t\r\n\t\tfunction h(a, b) {\r\n\t\t\tif (\"string\" == typeof b) {\r\n\t\t\t\tvar c = b;\r\n\t\t\t\tb = function () {\r\n\t\t\t\t\treturn new k(c)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar d = j[a] = function (c) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn new b(c, a) + \"\"\r\n\t\t\t\t} catch (d) {\r\n\t\t\t\t\treturn i(d)()\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn d.prototype = b.prototype = n, d.toString = function () {\r\n\t\t\t\treturn b + \"\"\r\n\t\t\t}, d\r\n\t\t}\r\n\t\r\n\t\tfunction i(a) {\r\n\t\t\tvar b = \"{Template Error}\", c = a.stack || \"\";\r\n\t\t\tif (c)c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); else for (var d in a)c += \"<\" + d + \">\\n\" + a[d] + \"\\n\\n\";\r\n\t\t\treturn function () {\r\n\t\t\t\treturn \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tvar j = a.cache = {}, k = this.String, l = {\r\n\t\t\t\"<\": \"&#60;\",\r\n\t\t\t\">\": \"&#62;\",\r\n\t\t\t'\"': \"&#34;\",\r\n\t\t\t\"'\": \"&#39;\",\r\n\t\t\t\"&\": \"&#38;\"\r\n\t\t}, m = Array.isArray || function (a) {\r\n\t\t\t\treturn \"[object Array]\" === {}.toString.call(a)\r\n\t\t\t}, n = a.utils = {\r\n\t\t\t$helpers: {}, $include: function (a, b, c) {\r\n\t\t\t\treturn a = f(c, a), g(a, b)\r\n\t\t\t}, $string: b, $escape: d, $each: e\r\n\t\t}, o = a.helpers = n.$helpers;\r\n\t\ta.get = function (a) {\r\n\t\t\treturn j[a.replace(/^\\.\\//, \"\")]\r\n\t\t}, a.helper = function (a, b) {\r\n\t\t\to[a] = b\r\n\t\t}, module.exports = a\r\n\t}();\n\n/***/ }),\n/* 35 */,\n/* 36 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar Dialog = __webpack_require__(37);\n\tvar noop = function noop() {};\n\t\n\tvar create = function create(content, options) {\n\t    content = content || '';\n\t    options = options || {};\n\t    var defaults = {\n\t        fixed: true,\n\t        modal: true,\n\t        autofocus: false,\n\t        content: '<p class=\"del-pop-p\">' + content + '</p>',\n\t        className: 'pop-box',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        ok: noop\n\t    };\n\t    $.extend(true, defaults, options);\n\t    var d = Dialog(defaults);\n\t\n\t    var header = d._$('header');\n\t    var title = d._$('title');\n\t    if (!options.title) {\n\t        title.css('borderBottom', 'none');\n\t    }\n\t    header.show();\n\t    d.show();\n\t    return d;\n\t};\n\t\n\tmodule.exports = create;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 37 */,\n/* 38 */,\n/* 39 */,\n/* 40 */,\n/* 41 */,\n/* 42 */,\n/* 43 */,\n/* 44 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/*\r\n\t * 弹层提示弹窗\r\n\t * zhaodonghong\r\n\t */\n\t\n\tvar $publicMask;\n\tvar $publicTips;\n\tvar timer;\n\t\n\tvar events = function events() {\n\t\n\t    $publicMask.off().on('click', function () {\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t    });\n\t\n\t    $publicTips.off().on('click', function () {\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t    });\n\t};\n\t\n\t/**\r\n\t * msg string 提示信息\r\n\t * options object \r\n\t * options.duration settimout消失时间\r\n\t * options.callback 提示消失的回调\r\n\t*/\n\tvar init = function init(msg, options) {\n\t    var defaults = {\n\t        duration: 2000,\n\t        callback: function callback() {}\n\t    };\n\t\n\t    $.extend(defaults, options || {});\n\t\n\t    clearTimeout(timer);\n\t    $publicMask = $('[data-action=\"publicMask\"]');\n\t    $publicTips = $('[data-action=\"publicTips\"]');\n\t\n\t    if ($publicMask.length > 0) {\n\t\n\t        $publicMask.show();\n\t        $publicTips.show().text(msg);\n\t    } else {\n\t\n\t        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\n\t        $publicMask = $('[data-action=\"publicMask\"]');\n\t        $publicTips = $('[data-action=\"publicTips\"]');\n\t        events();\n\t    }\n\t\n\t    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\n\t\n\t    timer = setTimeout(function () {\n\t\n\t        $publicMask.hide();\n\t        $publicTips.hide();\n\t\n\t        defaults.callback();\n\t    }, defaults.duration);\n\t};\n\t\n\tmodule.exports = {\n\t    init: init,\n\t    events: events\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 45 */,\n/* 46 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG, $) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar Pubsub = __webpack_require__(45);\n\t\n\tvar url = location.hostname.split('.');\n\tvar len = url.length;\n\tvar domain = url[len - 2] + '.' + url[len - 1];\n\tvar getCookieArea = function getCookieArea() {\n\t    fetch.get($_CONFIG.ss_service_gome + 'item/v1/cookie/getregion/flag/public/ip', {\n\t        dataType: 'jsonp',\n\t        jsonpCallback: \"ip\"\n\t    }).done(function (data) {\n\t        var value = data.atgregion;\n\t        if (data.success === true) {\n\t            $.cookie('atgregion', value, {\n\t                expires: 1,\n\t                path: '/',\n\t                domain: domain\n\t            });\n\t            Pubsub('getAreaId').pub();\n\t        }\n\t    });\n\t};\n\tmodule.exports = getCookieArea;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3), __webpack_require__(2)))\n\n/***/ }),\n/* 47 */,\n/* 48 */,\n/* 49 */,\n/* 50 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(jQuery) {/*\n\t * Lazy Load - jQuery plugin for lazy loading images\n\t *\n\t * Copyright (c) 2007-2012 Mika Tuupola\n\t *\n\t * Licensed under the MIT license:\n\t *   http://www.opensource.org/licenses/mit-license.php\n\t *\n\t * Project home:\n\t *   http://www.appelsiini.net/projects/lazyload\n\t *\n\t * Version:  1.7.2\n\t *\n\t */\n\t(function($, window) {\n\t\n\t    var $window = $(window);\n\t    var $container;\n\t\n\t    $.fn.lazyload = function(options) {\n\t        var elements = this;\n\t        var settings = {\n\t            threshold: 0,\n\t            failure_limit: 0,\n\t            event: \"scroll\",\n\t            effect: \"show\",\n\t            container: window,\n\t            data_attribute: \"original\",\n\t            skip_invisible: true,\n\t            appear: null,\n\t            load: null\n\t        };\n\t\n\t        function update() {\n\t            var counter = 0;\n\t\n\t            elements.each(function() {\n\t                var $this = $(this);\n\t                if (settings.skip_invisible && !$this.is(\":visible\")) {\n\t                    return;\n\t                }\n\t                if ($.abovethetop(this, settings) ||\n\t                    $.leftofbegin(this, settings)) {\n\t                    /* Nothing. */\n\t                } else if (!$.belowthefold(this, settings) &&\n\t                    !$.rightoffold(this, settings)) {\n\t                    $this.trigger(\"appear\");\n\t                } else {\n\t                    if (++counter > settings.failure_limit) {\n\t                        return false;\n\t                    }\n\t                }\n\t            });\n\t\n\t        }\n\t\n\t        if (options) {\n\t            /* Maintain BC for a couple of versions. */\n\t            if (undefined !== options.failurelimit) {\n\t                options.failure_limit = options.failurelimit;\n\t                delete options.failurelimit;\n\t            }\n\t            if (undefined !== options.effectspeed) {\n\t                options.effect_speed = options.effectspeed;\n\t                delete options.effectspeed;\n\t            }\n\t\n\t            $.extend(settings, options);\n\t        }\n\t\n\t        /* Cache container as jQuery as object. */\n\t        $container = (settings.container === undefined ||\n\t            settings.container === window) ? $window : $(settings.container);\n\t\n\t        /* Fire one scroll event per scroll. Not one scroll event per image. */\n\t        if (0 === settings.event.indexOf(\"scroll\")) {\n\t            $container.bind(settings.event, function() {\n\t                return update();\n\t            });\n\t        }\n\t\n\t        this.each(function() {\n\t            var self = this;\n\t            var $self = $(self);\n\t\n\t            self.loaded = false;\n\t\n\t            /* When appear is triggered load original image. */\n\t            $self.one(\"appear\", function() {\n\t                if (!this.loaded) {\n\t                    if (settings.appear) {\n\t                        var elements_left = elements.length;\n\t                        settings.appear.call(self, elements_left, settings);\n\t                    }\n\t                    $(\"<img />\")\n\t                        .bind(\"load\", function() {\n\t                            $self\n\t                            //.hide()\n\t                                .attr(\"src\", $self.data(settings.data_attribute))[settings.effect](settings.effect_speed);\n\t                            self.loaded = true;\n\t\n\t                            /* Remove image from array so it is not looped next time. */\n\t                            var temp = $.grep(elements, function(element) {\n\t                                return !element.loaded;\n\t                            });\n\t                            elements = $(temp);\n\t\n\t                            if (settings.load) {\n\t                                var elements_left = elements.length;\n\t                                settings.load.call(self, elements_left, settings);\n\t                            }\n\t                        })\n\t                        .attr(\"src\", $self.data(settings.data_attribute));\n\t                }\n\t            });\n\t\n\t            /* When wanted event is triggered load original image */\n\t            /* by triggering appear.                              */\n\t            if (0 !== settings.event.indexOf(\"scroll\")) {\n\t                $self.bind(settings.event, function() {\n\t                    if (!self.loaded) {\n\t                        $self.trigger(\"appear\");\n\t                    }\n\t                });\n\t            }\n\t        });\n\t\n\t        /* Check if something appears when window is resized. */\n\t        $window.bind(\"resize\", function() {\n\t            update();\n\t        });\n\t\n\t        /* Force initial check if images should appear. */\n\t        update();\n\t\n\t        return this;\n\t    };\n\t\n\t    /* Convenience methods in jQuery namespace.           */\n\t    /* Use as  $.belowthefold(element, {threshold : 100, container : window}) */\n\t\n\t    $.belowthefold = function(element, settings) {\n\t        var fold;\n\t\n\t        if (settings.container === undefined || settings.container === window) {\n\t            fold = $window.height() + $window.scrollTop();\n\t        } else {\n\t            fold = $container.offset().top + $container.height();\n\t        }\n\t\n\t        return fold <= $(element).offset().top - settings.threshold;\n\t    };\n\t\n\t    $.rightoffold = function(element, settings) {\n\t        var fold;\n\t\n\t        if (settings.container === undefined || settings.container === window) {\n\t            fold = $window.width() + $window.scrollLeft();\n\t        } else {\n\t            fold = $container.offset().left + $container.width();\n\t        }\n\t\n\t        return fold <= $(element).offset().left - settings.threshold;\n\t    };\n\t\n\t    $.abovethetop = function(element, settings) {\n\t        var fold;\n\t\n\t        if (settings.container === undefined || settings.container === window) {\n\t            fold = $window.scrollTop();\n\t        } else {\n\t            fold = $container.offset().top;\n\t        }\n\t\n\t        return fold >= $(element).offset().top + settings.threshold + $(element).height();\n\t    };\n\t\n\t    $.leftofbegin = function(element, settings) {\n\t        var fold;\n\t\n\t        if (settings.container === undefined || settings.container === window) {\n\t            fold = $window.scrollLeft();\n\t        } else {\n\t            fold = $container.offset().left;\n\t        }\n\t\n\t        return fold >= $(element).offset().left + settings.threshold + $(element).width();\n\t    };\n\t\n\t    $.inviewport = function(element, settings) {\n\t        return !$.rightofscreen(element, settings) && !$.leftofscreen(element, settings) &&\n\t            !$.belowthefold(element, settings) && !$.abovethetop(element, settings);\n\t    };\n\t\n\t    /* Custom selectors for your convenience.   */\n\t    /* Use as $(\"img:below-the-fold\").something() */\n\t\n\t    $.extend($.expr[':'], {\n\t        \"below-the-fold\": function(a) {\n\t            return $.belowthefold(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        },\n\t        \"above-the-top\": function(a) {\n\t            return !$.belowthefold(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        },\n\t        \"right-of-screen\": function(a) {\n\t            return $.rightoffold(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        },\n\t        \"left-of-screen\": function(a) {\n\t            return !$.rightoffold(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        },\n\t        \"in-viewport\": function(a) {\n\t            return !$.inviewport(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        },\n\t        /* Maintain BC for couple of versions. */\n\t        \"above-the-fold\": function(a) {\n\t            return !$.belowthefold(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        },\n\t        \"right-of-fold\": function(a) {\n\t            return $.rightoffold(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        },\n\t        \"left-of-fold\": function(a) {\n\t            return !$.rightoffold(a, {\n\t                threshold: 0,\n\t                container: window\n\t            });\n\t        }\n\t    });\n\t\n\t})(jQuery, window);\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 51 */,\n/* 52 */,\n/* 53 */,\n/* 54 */,\n/* 55 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\tvar imgPath = $_CONFIG.imgpath + '/images/emoji/';\n\t\n\tvar ext = '.png';\n\t\n\tvar groupOne = [{\n\t    name: '微笑',\n\t    url: 'weixiao'\n\t}, {\n\t    name: '色',\n\t    url: 'se'\n\t}, {\n\t    name: '亲亲',\n\t    url: 'qinqin'\n\t}, {\n\t    name: '得意',\n\t    url: 'deyi'\n\t}, {\n\t    name: '流泪',\n\t    url: 'liulei'\n\t}, {\n\t    name: '害羞',\n\t    url: 'haixiu'\n\t}, {\n\t    name: '闭嘴',\n\t    url: 'bizui'\n\t}, {\n\t    name: '鼓掌',\n\t    url: 'guzhang'\n\t}, {\n\t    name: '大哭',\n\t    url: 'daku'\n\t}, {\n\t    name: '尴尬',\n\t    url: 'ganga'\n\t}, {\n\t    name: '生气',\n\t    url: 'shengqi'\n\t}, {\n\t    name: '调皮',\n\t    url: 'tiaopi'\n\t}, {\n\t    name: '呲牙',\n\t    url: 'ciya'\n\t}, {\n\t    name: '惊讶',\n\t    url: 'jingya'\n\t}, {\n\t    name: '委屈',\n\t    url: 'weiqu'\n\t}, {\n\t    name: '吐血',\n\t    url: 'tuxue'\n\t}, {\n\t    name: '冷汗',\n\t    url: 'lenghan'\n\t}, {\n\t    name: '抓狂',\n\t    url: 'zhuakuang'\n\t}, {\n\t    name: '难过',\n\t    url: 'nanguo'\n\t}, {\n\t    name: '偷笑',\n\t    url: 'touxiao'\n\t}, {\n\t    name: '白眼',\n\t    url: 'baiyan'\n\t}, {\n\t    name: '不屑',\n\t    url: 'buxie'\n\t}, {\n\t    name: '快哭了',\n\t    url: 'kuaikule'\n\t}];\n\t\n\tvar groupTwo = [{\n\t    name: '困',\n\t    url: 'kun'\n\t}, {\n\t    name: '装酷',\n\t    url: 'zhuangku'\n\t}, {\n\t    name: '大笑',\n\t    url: 'daxiao'\n\t}, {\n\t    name: '偷瞄',\n\t    url: 'toumiao'\n\t}, {\n\t    name: '奋斗',\n\t    url: 'fendou'\n\t}, {\n\t    name: '咒骂',\n\t    url: 'zhouma'\n\t}, {\n\t    name: '疑问',\n\t    url: 'yiwen'\n\t}, {\n\t    name: '晕',\n\t    url: 'yun'\n\t}, {\n\t    name: '捶打',\n\t    url: 'chuida'\n\t}, {\n\t    name: '再见',\n\t    url: 'zaijian'\n\t}, {\n\t    name: '抠鼻',\n\t    url: 'koubi'\n\t}, {\n\t    name: '发呆',\n\t    url: 'fadai'\n\t}, {\n\t    name: '坏笑',\n\t    url: 'huaixiao'\n\t}, {\n\t    name: '哈欠',\n\t    url: 'haqian'\n\t}, {\n\t    name: '鄙视',\n\t    url: 'bishi'\n\t}, {\n\t    name: '睡觉',\n\t    url: 'shuijiao'\n\t}, {\n\t    name: '饿',\n\t    url: 'e'\n\t}, {\n\t    name: '阴险',\n\t    url: 'yinxian'\n\t}, {\n\t    name: '难受',\n\t    url: 'nanshou'\n\t}, {\n\t    name: '可怜',\n\t    url: 'kelian'\n\t}, {\n\t    name: '撇嘴',\n\t    url: 'piezui'\n\t}, {\n\t    name: '石化',\n\t    url: 'shihua'\n\t}, {\n\t    name: '泪眼',\n\t    url: 'leiyan'\n\t}];\n\t\n\tvar groupThree = [{\n\t    name: '嘘',\n\t    url: 'xu'\n\t}, {\n\t    name: '哼哼',\n\t    url: 'hengheng'\n\t}, {\n\t    name: '爱慕',\n\t    url: 'aimu'\n\t}, {\n\t    name: '财迷',\n\t    url: 'caimi'\n\t}, {\n\t    name: '耶',\n\t    url: 'ye'\n\t}, {\n\t    name: '思考',\n\t    url: 'sikao'\n\t}, {\n\t    name: '骷髅',\n\t    url: 'kulou'\n\t}, {\n\t    name: '痛哭',\n\t    url: 'tongku'\n\t}, {\n\t    name: '恭喜',\n\t    url: 'gongxi'\n\t}, {\n\t    name: '捂脸',\n\t    url: 'wulian'\n\t}, {\n\t    name: '嘿哈',\n\t    url: 'heiha'\n\t}, {\n\t    name: '机智',\n\t    url: 'jizhi'\n\t}, {\n\t    name: '皱眉',\n\t    url: 'zhoumei'\n\t}, {\n\t    name: '安慰',\n\t    url: 'anwei'\n\t}, {\n\t    name: '飞吻',\n\t    url: 'feiwen'\n\t}, {\n\t    name: '奸笑',\n\t    url: 'jianxiao'\n\t}, {\n\t    name: '猪头',\n\t    url: 'zhutou'\n\t}, {\n\t    name: '玫瑰',\n\t    url: 'meigui'\n\t}, {\n\t    name: '凋谢',\n\t    url: 'diaoxie'\n\t}, {\n\t    name: '爱心',\n\t    url: 'aixin'\n\t}, {\n\t    name: '心碎',\n\t    url: 'xinsui'\n\t}, {\n\t    name: '蛋糕',\n\t    url: 'dangao'\n\t}, {\n\t    name: '喝水',\n\t    url: 'heshui'\n\t}];\n\t\n\tvar groupFour = [{\n\t    name: '西瓜',\n\t    url: 'xigua'\n\t}, {\n\t    name: '咖啡',\n\t    url: 'kafei'\n\t}, {\n\t    name: '啤酒',\n\t    url: 'pijiu'\n\t}, {\n\t    name: '包包',\n\t    url: 'baobao'\n\t}, {\n\t    name: '高跟鞋',\n\t    url: 'gaogenxie'\n\t}, {\n\t    name: '帽子',\n\t    url: 'maozi'\n\t}, {\n\t    name: '口红',\n\t    url: 'kouhong'\n\t}, {\n\t    name: '裙子',\n\t    url: 'qunzi'\n\t}, {\n\t    name: 'T恤',\n\t    url: 'txu'\n\t}, {\n\t    name: '裤子',\n\t    url: 'kuzi'\n\t}, {\n\t    name: '眼镜',\n\t    url: 'yanjing'\n\t}, {\n\t    name: '太阳镜',\n\t    url: 'taiyangjing'\n\t}, {\n\t    name: '蜡烛',\n\t    url: 'lazhu'\n\t}, {\n\t    name: '礼物',\n\t    url: 'liwu'\n\t}, {\n\t    name: '红包',\n\t    url: 'hongbao'\n\t}, {\n\t    name: '拥抱',\n\t    url: 'yongbao'\n\t}, {\n\t    name: '太阳',\n\t    url: 'taiyang'\n\t}, {\n\t    name: '月亮',\n\t    url: 'yueliang'\n\t}, {\n\t    name: '便便',\n\t    url: 'bianbian'\n\t}, {\n\t    name: '炸弹',\n\t    url: 'zhadan'\n\t}, {\n\t    name: '菜刀',\n\t    url: 'caidao'\n\t}, {\n\t    name: '握手',\n\t    url: 'woshou'\n\t}, {\n\t    name: '胜利',\n\t    url: 'shengli'\n\t}];\n\t\n\tvar groupFive = [{\n\t    name: '赞',\n\t    url: 'zan'\n\t}, {\n\t    name: 'OK',\n\t    url: 'ok'\n\t}, {\n\t    name: '勾引',\n\t    url: 'gouyin'\n\t}, {\n\t    name: 'NO',\n\t    url: 'no'\n\t}, {\n\t    name: '打脸',\n\t    url: 'dalian'\n\t}, {\n\t    name: '抱拳',\n\t    url: 'baoquan'\n\t}, {\n\t    name: '乒乓球',\n\t    url: 'pingpangqiu'\n\t}, {\n\t    name: '足球',\n\t    url: 'zuqiu'\n\t}, {\n\t    name: '篮球',\n\t    url: 'lanqiu'\n\t}];\n\t\n\tvar format = function format(arr) {\n\t    for (var i = 0, len = arr.length; i < len; i++) {\n\t        var emoji = arr[i];\n\t        emoji.url = imgPath + emoji.url + ext;\n\t    }\n\t    return arr;\n\t};\n\t\n\tmodule.exports = format(groupOne.concat(groupTwo, groupThree, groupFour, groupFive));\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 56 */,\n/* 57 */,\n/* 58 */,\n/* 59 */,\n/* 60 */,\n/* 61 */,\n/* 62 */,\n/* 63 */,\n/* 64 */,\n/* 65 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar Dialog = __webpack_require__(37);\n\tvar noop = function noop() {};\n\t\n\tvar create = function create(content, options) {\n\t    var defaults = {\n\t        fixed: true,\n\t        modal: true,\n\t        content: '<p class=\"del-pop-p\">' + content + '</p>',\n\t        className: 'pop-box',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        ok: noop,\n\t        cancel: noop,\n\t        btnWrapCls: 'two-buttons'\n\t    };\n\t    $.extend(true, defaults, options);\n\t\n\t    var d = Dialog(defaults);\n\t\n\t    // var header = d._$('header');\n\t    // var title = d._$('title');\n\t    // title.css('borderBottom', 'none');\n\t    // header.show();\n\t\n\t    d.show();\n\t    return d;\n\t};\n\t\n\tmodule.exports = create;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 66 */,\n/* 67 */,\n/* 68 */,\n/* 69 */,\n/* 70 */,\n/* 71 */,\n/* 72 */,\n/* 73 */,\n/* 74 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tvar html = function html(str, reg) {\n\t    return str ? str.replace(reg || /[&<\">'](?:(amp|lt|ldquo|rdquo|quot|gt|#39|nbsp|#\\d+);)?/g, function (a, b) {\n\t        if (b) {\n\t            return a;\n\t        } else {\n\t            return {\n\t                '<': '&lt;',\n\t                '&': '&amp;',\n\t                '\"': '&quot;',\n\t                '“': '&ldquo;',\n\t                '”': '&rdquo;',\n\t                '>': '&gt;',\n\t                \"'\": '&#39;'\n\t            }[a];\n\t        }\n\t    }) : '';\n\t};\n\t\n\tmodule.exports = html;\n\n/***/ }),\n/* 75 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar emojis = __webpack_require__(55);\n\tvar backward = __webpack_require__(76);\n\tvar faceTpl = __webpack_require__(77);\n\t\n\tvar faceReg,\n\t    faceUrl,\n\t    defaultIndex = 0;\n\t\n\t// 将表情转换成map\n\tvar emojiMap = {};\n\t\n\t// 数据适配转换\n\tvar makeData = function makeData(data) {\n\t    var total = data.length;\n\t    var offset = 24;\n\t    var page = Math.ceil(total / offset);\n\t    var list = [];\n\t\n\t    for (var i = 0; i < page; i++) {\n\t        list[i] = [];\n\t        var end = offset * (i + 1);\n\t        end = end > total ? total : end;\n\t        for (var j = i * offset; j < end; j++) {\n\t            var emoji = data[j];\n\t            list[i].push(emoji);\n\t            emojiMap[emoji.name] = emoji.url;\n\t        }\n\t    }\n\t    return {\n\t        page: new Array(page),\n\t        list: list\n\t    };\n\t};\n\t// 表情层显示\n\tvar show = function show(x, y) {\n\t    setShowIndex(0);\n\t    $('[data-node=faceBox]').css({\n\t        left: x + 'px',\n\t        top: y + 'px'\n\t    }).show();\n\t};\n\t// 表情层隐藏\n\tvar hide = function hide() {\n\t    $('[data-node=faceBox]').hide();\n\t};\n\t// tab方式显示所选页\n\tvar setShowIndex = function setShowIndex(index) {\n\t    index = index || defaultIndex;\n\t\n\t    $('[data-action=facePage] > li').eq(index).addClass('active').siblings('li').removeClass('active');\n\t    $('[data-node=faceList] > div').eq(index).removeClass('hide').siblings('div').addClass('hide');\n\t};\n\t\n\t/**\r\n\t * 插入表情，回调数据\r\n\t * @param  {Function} fn     回调函数\r\n\t * @param  {Boolean}  isHide 点击表情后是否隐藏表情浮层，默认隐藏\r\n\t * @return {[type]}          null\r\n\t */\n\tvar insertFace = function insertFace(fn, isHide) {\n\t    $('body').on('click', '[data-face]', function (e) {\n\t        e.preventDefault();\n\t        e.stopPropagation();\n\t        faceReg = $(this).data('face');\n\t        faceUrl = $(this).attr('src');\n\t        fn({\n\t            reg: faceReg,\n\t            url: faceUrl\n\t        });\n\t        isHide !== false && $('[data-node=faceBox]').hide();\n\t    });\n\t};\n\t// 初始化表情弹层\n\tvar initHTML = function initHTML(fn) {\n\t    var data = makeData(emojis);\n\t    var faceHTML = faceTpl(data);\n\t    $('body').append(faceHTML);\n\t    fn();\n\t};\n\t// 初始化事件\n\tvar initEvent = function initEvent() {\n\t    $('body').on('click', '[data-node=faceBox]', function (e) {\n\t        e.stopPropagation();\n\t    });\n\t    $(document).on('click', function () {\n\t        $('[data-node=faceBox]').hide();\n\t    });\n\t    // 分页切换显示\n\t    $('[data-node=faceBox]').on('mouseenter', '[data-action=facePage] > li', function () {\n\t        var index = $(this).index();\n\t        setShowIndex(index);\n\t    });\n\t};\n\t\n\t// 把表情占位符替换成img\n\tvar parseEmoji = function parseEmoji(str) {\n\t    var r = /(\\[([\\s\\S]+?)\\])/g;\n\t    if ($.isEmptyObject(emojiMap)) {\n\t        makeData(emojis);\n\t    }\n\t\n\t    return str.replace(r, function (s, $1, name) {\n\t        var img = emojiMap[name];\n\t        if (img) {\n\t            return '<img width=\"22\" height=\"22\" src=\"' + img + '\" />';\n\t        } else {\n\t            // 兼容旧版表情\n\t            var old = backward[name];\n\t            if (old) {\n\t                return '<img width=\"22\" height=\"22\" src=\"' + old.url + '\" />';\n\t            }\n\t            return s;\n\t        }\n\t    });\n\t};\n\t\n\tvar init = function init() {\n\t    initHTML(initEvent);\n\t};\n\t\n\tmodule.exports = {\n\t    init: init,\n\t    insert: insertFace,\n\t    show: show,\n\t    hide: hide,\n\t    parseEmoji: parseEmoji\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 76 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\tvar path = $_CONFIG.imgpath + '/images/emoji/';\n\tvar ext = '.png';\n\t\n\tvar backward = {\n\t    '亲': {\n\t        name: '亲亲',\n\t        url: path + 'qinqin' + ext\n\t    },\n\t    '愤怒': {\n\t        name: '生气',\n\t        url: path + 'shengqi' + ext\n\t    },\n\t    '惊恐': {\n\t        name: '惊讶',\n\t        url: path + 'jingya' + ext\n\t    },\n\t    '迷茫': {\n\t        name: '委屈',\n\t        url: path + 'weiqu' + ext\n\t    },\n\t    '伤心': {\n\t        name: '难过',\n\t        url: path + 'nanguo' + ext\n\t    },\n\t    '努力': {\n\t        name: '奋斗',\n\t        url: path + 'fendou' + ext\n\t    },\n\t    'YY': {\n\t        name: ' 坏笑',\n\t        url: path + 'huaixiao' + ext\n\t    },\n\t    '恶心': {\n\t        name: '难受',\n\t        url: path + 'nanshou' + ext\n\t    }\n\t};\n\t\n\tmodule.exports = backward;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 77 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/face/face',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,face=$data.face,$index=$data.$index,$escape=$utils.$escape,page=$data.page,$out='';$out+='<div data-node=\"faceBox\" class=\"imoj-box\" style=\"position: absolute;z-index: 9999;display:none\"> <em class=\"sanjiao\"></em> <div data-node=\"faceList\" class=\"imoj-list\"> ';\n\t$each(list,function(v,i){\n\t$out+=' <div class=\"imoj-content clearfix ';\n\tif(i){\n\t$out+='hide';\n\t}\n\t$out+='\"> ';\n\t$each(v,function(face,$index){\n\t$out+=' <a href=\"javascript:;\"> <img width=\"22\" height=\"22\" data-face=\"[';\n\t$out+=$escape(face.name);\n\t$out+=']\" src=\"';\n\t$out+=$escape(face.url);\n\t$out+='\" alt=\"';\n\t$out+=$escape(face.name);\n\t$out+='\" title=\"';\n\t$out+=$escape(face.name);\n\t$out+='\"> </a> ';\n\t});\n\t$out+=' </div> ';\n\t});\n\t$out+=' </div> <ul data-action=\"facePage\" class=\"pagination\"> ';\n\t$each(page,function(v,i){\n\t$out+=' <li ';\n\tif(i==0){\n\t$out+='class=\"active\"';\n\t}\n\t$out+='>';\n\t$out+=$escape(i+1);\n\t$out+='</li> ';\n\t});\n\t$out+=' </ul> </div>';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 78 */,\n/* 79 */,\n/* 80 */,\n/* 81 */,\n/* 82 */,\n/* 83 */,\n/* 84 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\t/**\n\t * Created by dongyukuan on 2016/7/4.\n\t */\n\tvar inputTip = {\n\t    tel: {\n\t        ept: '请填写11位手机号',\n\t        err: '手机号格式错误',\n\t        errBack: '该手机号已被注册'\n\t    },\n\t    msgCode: {\n\t        tipGet: '请获取短信验证码',\n\t        tipEpt: '请输入短信验证码',\n\t        tipErr: '验证码是6位数字,请重新输入',\n\t        tipErrEdit: '验证码错误',\n\t        tipWrong: '验证码有误,请重新输入',\n\t        checkCodeWrong: '验证码输入错误,请重新输入',\n\t        send: '验证码已发送，请注意查收',\n\t        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n\t        tipDisabled: \"验证码再次获取需间隔60s\",\n\t        tipLimitEdit: '获取验证码超限，请稍后再试',\n\t        btnAfterSend: \"秒后重新获取\",\n\t        btnDefault: \"获取验证码\"\n\t    },\n\t    pwd: {\n\t        commonTip: '请输入6-20位英文字母,数字或符号'\n\t    },\n\t    pwdV: {\n\t        ept: '请再次输入密码',\n\t        err: '两次输入的密码不一致'\n\t    },\n\t    nickName: {\n\t        eptName: '请输入昵称！',\n\t        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n\t        existName: '此昵称太受欢迎了，已经有人抢了~',\n\t        sucSub: '资料修改成功！',\n\t        errLine: \"网络超时!\",\n\t        wrongName: '此昵称含有敏感词,请重新输入'\n\t    },\n\t    birthTip: {\n\t        tip: '生日不能重复设置'\n\t    },\n\t    refCode: {\n\t        err: '推荐码错误'\n\t    },\n\t    imgCode: {\n\t        ept: '请输入验证码',\n\t        err: '验证码输入错误，请重新输入'\n\t    },\n\t    login: {\n\t        errCode: '请输入验证码',\n\t        errNum: '请输入账号',\n\t        errPwd: '请输入密码',\n\t        agreement: '请同意协议并勾选'\n\t    },\n\t    createCircle: {\n\t        typeEmpty: '请选择圈子分类',\n\t        nameEmpty: '圈子名称不能为空',\n\t        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n\t    },\n\t    circle: {\n\t        login: '登录成功！',\n\t        unJoin: '需要先加入该圈子才能发布话题',\n\t        cannotJoin: '抱歉！该圈子不允许发布话题!',\n\t        review: '加入圈子审核中，请耐心等待!',\n\t        joinSuccess: '恭喜您已经加入圈子！',\n\t        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n\t        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n\t        exit: '您已经退出该圈子！',\n\t        dissolved: '抱歉！该圈子已被解散'\n\t    },\n\t    qrCodeTip: {\n\t        loseEffTip: '二维码已失效',\n\t        loseEffBtn: '点击刷新',\n\t        failGetTip: '二维码生成失败',\n\t        failGetBtn: '重新生成'\n\t    },\n\t    masterApply: {\n\t        nameLength: '姓名要2-20个字符',\n\t        nameType: '姓名仅限汉字和字母',\n\t        isIdCard: '请填写18位有效身份证号',\n\t        type: '请选择达人类别',\n\t        summary: '请输入自我介绍，2-100个字符'\n\t    },\n\t    upload: {\n\t        noUpload: '请上传图片',\n\t        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n\t        uploadFaild: '上传失败,请重新上传',\n\t        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n\t        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n\t        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n\t        Q_TYPE_DENIED: '文件类型错误',\n\t        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n\t        excess: '文件个数超出限制'\n\t    },\n\t    errLine: {\n\t        tip: '网络错误,请稍后再试！'\n\t    }\n\t};\n\tmodule.exports = inputTip;\n\n/***/ }),\n/* 85 */,\n/* 86 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* WEBPACK VAR INJECTION */(function(__webpack_provided_window_dot_jQuery) {/*! WebUploader 0.1.5 */\n\t\n\t\n\t/**\n\t * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n\t *\n\t * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n\t */\n\t(function( root, factory ) {\n\t    var modules = {},\n\t\n\t        // 内部require, 简单不完全实现。\n\t        // https://github.com/amdjs/amdjs-api/wiki/require\n\t        _require = function( deps, callback ) {\n\t            var args, len, i;\n\t\n\t            // 如果deps不是数组，则直接返回指定module\n\t            if ( typeof deps === 'string' ) {\n\t                return getModule( deps );\n\t            } else {\n\t                args = [];\n\t                for( len = deps.length, i = 0; i < len; i++ ) {\n\t                    args.push( getModule( deps[ i ] ) );\n\t                }\n\t\n\t                return callback.apply( null, args );\n\t            }\n\t        },\n\t\n\t        // 内部define，暂时不支持不指定id.\n\t        _define = function( id, deps, factory ) {\n\t            if ( arguments.length === 2 ) {\n\t                factory = deps;\n\t                deps = null;\n\t            }\n\t\n\t            _require( deps || [], function() {\n\t                setModule( id, factory, arguments );\n\t            });\n\t        },\n\t\n\t        // 设置module, 兼容CommonJs写法。\n\t        setModule = function( id, factory, args ) {\n\t            var module = {\n\t                    exports: factory\n\t                },\n\t                returned;\n\t\n\t            if ( typeof factory === 'function' ) {\n\t                args.length || (args = [ _require, module.exports, module ,__webpack_provided_window_dot_jQuery]);\n\t                returned = factory.apply( null, args );\n\t                returned !== undefined && (module.exports = returned);\n\t            }\n\t\n\t            modules[ id ] = module.exports;\n\t        },\n\t\n\t        // 根据id获取module\n\t        getModule = function( id ) {\n\t            var module = modules[ id ] || root[ id ];\n\t\n\t            if ( !module ) {\n\t                throw new Error( '`' + id + '` is undefined' );\n\t            }\n\t\n\t            return module;\n\t        },\n\t\n\t        // 将所有modules，将路径ids装换成对象。\n\t        exportsTo = function( obj ) {\n\t            var key, host, parts, part, last, ucFirst;\n\t\n\t            // make the first character upper case.\n\t            ucFirst = function( str ) {\n\t                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n\t            };\n\t\n\t            for ( key in modules ) {\n\t                host = obj;\n\t\n\t                if ( !modules.hasOwnProperty( key ) ) {\n\t                    continue;\n\t                }\n\t\n\t                parts = key.split('/');\n\t                last = ucFirst( parts.pop() );\n\t\n\t                while( (part = ucFirst( parts.shift() )) ) {\n\t                    host[ part ] = host[ part ] || {};\n\t                    host = host[ part ];\n\t                }\n\t\n\t                host[ last ] = modules[ key ];\n\t            }\n\t\n\t            return obj;\n\t        },\n\t\n\t        makeExport = function( dollar ) {\n\t            root.__dollar = dollar;\n\t\n\t            // exports every module.\n\t            return exportsTo( factory( root, _define, _require,__webpack_provided_window_dot_jQuery ) );\n\t        },\n\t\n\t        origin;\n\t\n\t    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\t\n\t        // For CommonJS and CommonJS-like environments where a proper window is present,\n\t        module.exports = makeExport();\n\t    } else if ( true ) {\n\t\n\t        // Allow using this built library as an AMD module\n\t        // in another project. That other project will only\n\t        // see this AMD call, not the internal modules in\n\t        // the closure below.\n\t        !(__WEBPACK_AMD_DEFINE_ARRAY__ = [ __webpack_require__(2) ], __WEBPACK_AMD_DEFINE_FACTORY__ = (makeExport), __WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? (__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__), __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n\t    } else {\n\t\n\t        // Browser globals case. Just assign the\n\t        // result to a property on the global.\n\t        origin = root.WebUploader;\n\t        root.WebUploader = makeExport();\n\t        root.WebUploader.noConflict = function() {\n\t            root.WebUploader = origin;\n\t        };\n\t    }\n\t})( window, function( window, define, require ,jQuery ) {\n\t\n\t\n\t    /**\n\t     * @fileOverview jQuery or Zepto\n\t     */\n\t    define('dollar-third',[],function() {\n\t        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n\t\n\t        if ( !$ ) {\n\t            throw new Error('jQuery or Zepto not found!');\n\t        }\n\t\n\t        return $;\n\t    });\n\t    /**\n\t     * @fileOverview Dom 操作相关\n\t     */\n\t    define('dollar',[\n\t        'dollar-third'\n\t    ], function( _ ) {\n\t        return _;\n\t    });\n\t    /**\n\t     * @fileOverview 使用jQuery的Promise\n\t     */\n\t    define('promise-third',[\n\t        'dollar'\n\t    ], function( $ ) {\n\t        return {\n\t            Deferred: $.Deferred,\n\t            when: $.when,\n\t\n\t            isPromise: function( anything ) {\n\t                return anything && typeof anything.then === 'function';\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * @fileOverview Promise/A+\n\t     */\n\t    define('promise',[\n\t        'promise-third'\n\t    ], function( _ ) {\n\t        return _;\n\t    });\n\t    /**\n\t     * @fileOverview 基础类方法。\n\t     */\n\t\n\t    /**\n\t     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n\t     *\n\t     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n\t     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n\t     *\n\t     * * module `base`：WebUploader.Base\n\t     * * module `file`: WebUploader.File\n\t     * * module `lib/dnd`: WebUploader.Lib.Dnd\n\t     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n\t     *\n\t     *\n\t     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n\t     * @module WebUploader\n\t     * @title WebUploader API文档\n\t     */\n\t    define('base',[\n\t        'dollar',\n\t        'promise'\n\t    ], function( $, promise ) {\n\t\n\t        var noop = function() {},\n\t            call = Function.call;\n\t\n\t        // http://jsperf.com/uncurrythis\n\t        // 反科里化\n\t        function uncurryThis( fn ) {\n\t            return function() {\n\t                return call.apply( fn, arguments );\n\t            };\n\t        }\n\t\n\t        function bindFn( fn, context ) {\n\t            return function() {\n\t                return fn.apply( context, arguments );\n\t            };\n\t        }\n\t\n\t        function createObject( proto ) {\n\t            var f;\n\t\n\t            if ( Object.create ) {\n\t                return Object.create( proto );\n\t            } else {\n\t                f = function() {};\n\t                f.prototype = proto;\n\t                return new f();\n\t            }\n\t        }\n\t\n\t\n\t        /**\n\t         * 基础类，提供一些简单常用的方法。\n\t         * @class Base\n\t         */\n\t        return {\n\t\n\t            /**\n\t             * @property {String} version 当前版本号。\n\t             */\n\t            version: '0.1.5',\n\t\n\t            /**\n\t             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n\t             */\n\t            $: $,\n\t\n\t            Deferred: promise.Deferred,\n\t\n\t            isPromise: promise.isPromise,\n\t\n\t            when: promise.when,\n\t\n\t            /**\n\t             * @description  简单的浏览器检查结果。\n\t             *\n\t             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n\t             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n\t             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n\t             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n\t             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n\t             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n\t             *\n\t             * @property {Object} [browser]\n\t             */\n\t            browser: (function( ua ) {\n\t                var ret = {},\n\t                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n\t                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n\t                        ua.match( /CriOS\\/([\\d.]+)/ ),\n\t\n\t                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n\t                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n\t                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n\t                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n\t                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n\t\n\t                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n\t                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n\t                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n\t                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n\t                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n\t                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n\t\n\t                return ret;\n\t            })( navigator.userAgent ),\n\t\n\t            /**\n\t             * @description  操作系统检查结果。\n\t             *\n\t             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n\t             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n\t             * @property {Object} [os]\n\t             */\n\t            os: (function( ua ) {\n\t                var ret = {},\n\t\n\t                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n\t                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n\t                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n\t\n\t                // osx && (ret.osx = true);\n\t                android && (ret.android = parseFloat( android[ 1 ] ));\n\t                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n\t\n\t                return ret;\n\t            })( navigator.userAgent ),\n\t\n\t            /**\n\t             * 实现类与类之间的继承。\n\t             * @method inherits\n\t             * @grammar Base.inherits( super ) => child\n\t             * @grammar Base.inherits( super, protos ) => child\n\t             * @grammar Base.inherits( super, protos, statics ) => child\n\t             * @param  {Class} super 父类\n\t             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n\t             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n\t             * @param  {Object} [statics] 静态属性或方法。\n\t             * @return {Class} 返回子类。\n\t             * @example\n\t             * function Person() {\n\t             *     console.log( 'Super' );\n\t             * }\n\t             * Person.prototype.hello = function() {\n\t             *     console.log( 'hello' );\n\t             * };\n\t             *\n\t             * var Manager = Base.inherits( Person, {\n\t             *     world: function() {\n\t             *         console.log( 'World' );\n\t             *     }\n\t             * });\n\t             *\n\t             * // 因为没有指定构造器，父类的构造器将会执行。\n\t             * var instance = new Manager();    // => Super\n\t             *\n\t             * // 继承子父类的方法\n\t             * instance.hello();    // => hello\n\t             * instance.world();    // => World\n\t             *\n\t             * // 子类的__super__属性指向父类\n\t             * console.log( Manager.__super__ === Person );    // => true\n\t             */\n\t            inherits: function( Super, protos, staticProtos ) {\n\t                var child;\n\t\n\t                if ( typeof protos === 'function' ) {\n\t                    child = protos;\n\t                    protos = null;\n\t                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n\t                    child = protos.constructor;\n\t                } else {\n\t                    child = function() {\n\t                        return Super.apply( this, arguments );\n\t                    };\n\t                }\n\t\n\t                // 复制静态方法\n\t                $.extend( true, child, Super, staticProtos || {} );\n\t\n\t                /* jshint camelcase: false */\n\t\n\t                // 让子类的__super__属性指向父类。\n\t                child.__super__ = Super.prototype;\n\t\n\t                // 构建原型，添加原型方法或属性。\n\t                // 暂时用Object.create实现。\n\t                child.prototype = createObject( Super.prototype );\n\t                protos && $.extend( true, child.prototype, protos );\n\t\n\t                return child;\n\t            },\n\t\n\t            /**\n\t             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n\t             * @method noop\n\t             */\n\t            noop: noop,\n\t\n\t            /**\n\t             * 返回一个新的方法，此方法将已指定的`context`来执行。\n\t             * @grammar Base.bindFn( fn, context ) => Function\n\t             * @method bindFn\n\t             * @example\n\t             * var doSomething = function() {\n\t             *         console.log( this.name );\n\t             *     },\n\t             *     obj = {\n\t             *         name: 'Object Name'\n\t             *     },\n\t             *     aliasFn = Base.bind( doSomething, obj );\n\t             *\n\t             *  aliasFn();    // => Object Name\n\t             *\n\t             */\n\t            bindFn: bindFn,\n\t\n\t            /**\n\t             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n\t             * @grammar Base.log( args... ) => undefined\n\t             * @method log\n\t             */\n\t            log: (function() {\n\t                if ( window.console ) {\n\t                    return bindFn( console.log, console );\n\t                }\n\t                return noop;\n\t            })(),\n\t\n\t            nextTick: (function() {\n\t\n\t                return function( cb ) {\n\t                    setTimeout( cb, 1 );\n\t                };\n\t\n\t                // @bug 当浏览器不在当前窗口时就停了。\n\t                // var next = window.requestAnimationFrame ||\n\t                //     window.webkitRequestAnimationFrame ||\n\t                //     window.mozRequestAnimationFrame ||\n\t                //     function( cb ) {\n\t                //         window.setTimeout( cb, 1000 / 60 );\n\t                //     };\n\t\n\t                // // fix: Uncaught TypeError: Illegal invocation\n\t                // return bindFn( next, window );\n\t            })(),\n\t\n\t            /**\n\t             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n\t             * 将用来将非数组对象转化成数组对象。\n\t             * @grammar Base.slice( target, start[, end] ) => Array\n\t             * @method slice\n\t             * @example\n\t             * function doSomthing() {\n\t             *     var args = Base.slice( arguments, 1 );\n\t             *     console.log( args );\n\t             * }\n\t             *\n\t             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n\t             */\n\t            slice: uncurryThis( [].slice ),\n\t\n\t            /**\n\t             * 生成唯一的ID\n\t             * @method guid\n\t             * @grammar Base.guid() => String\n\t             * @grammar Base.guid( prefx ) => String\n\t             */\n\t            guid: (function() {\n\t                var counter = 0;\n\t\n\t                return function( prefix ) {\n\t                    var guid = (+new Date()).toString( 32 ),\n\t                        i = 0;\n\t\n\t                    for ( ; i < 5; i++ ) {\n\t                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n\t                    }\n\t\n\t                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n\t                };\n\t            })(),\n\t\n\t            /**\n\t             * 格式化文件大小, 输出成带单位的字符串\n\t             * @method formatSize\n\t             * @grammar Base.formatSize( size ) => String\n\t             * @grammar Base.formatSize( size, pointLength ) => String\n\t             * @grammar Base.formatSize( size, pointLength, units ) => String\n\t             * @param {Number} size 文件大小\n\t             * @param {Number} [pointLength=2] 精确到的小数点数。\n\t             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n\t             * @example\n\t             * console.log( Base.formatSize( 100 ) );    // => 100B\n\t             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n\t             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n\t             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n\t             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n\t             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n\t             */\n\t            formatSize: function( size, pointLength, units ) {\n\t                var unit;\n\t\n\t                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n\t\n\t                while ( (unit = units.shift()) && size > 1024 ) {\n\t                    size = size / 1024;\n\t                }\n\t\n\t                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n\t                        unit;\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n\t     * @fileOverview Mediator\n\t     */\n\t    define('mediator',[\n\t        'base'\n\t    ], function( Base ) {\n\t        var $ = Base.$,\n\t            slice = [].slice,\n\t            separator = /\\s+/,\n\t            protos;\n\t\n\t        // 根据条件过滤出事件handlers.\n\t        function findHandlers( arr, name, callback, context ) {\n\t            return $.grep( arr, function( handler ) {\n\t                return handler &&\n\t                        (!name || handler.e === name) &&\n\t                        (!callback || handler.cb === callback ||\n\t                        handler.cb._cb === callback) &&\n\t                        (!context || handler.ctx === context);\n\t            });\n\t        }\n\t\n\t        function eachEvent( events, callback, iterator ) {\n\t            // 不支持对象，只支持多个event用空格隔开\n\t            $.each( (events || '').split( separator ), function( _, key ) {\n\t                iterator( key, callback );\n\t            });\n\t        }\n\t\n\t        function triggerHanders( events, args ) {\n\t            var stoped = false,\n\t                i = -1,\n\t                len = events.length,\n\t                handler;\n\t\n\t            while ( ++i < len ) {\n\t                handler = events[ i ];\n\t\n\t                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n\t                    stoped = true;\n\t                    break;\n\t                }\n\t            }\n\t\n\t            return !stoped;\n\t        }\n\t\n\t        protos = {\n\t\n\t            /**\n\t             * 绑定事件。\n\t             *\n\t             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n\t             * ```javascript\n\t             * var obj = {};\n\t             *\n\t             * // 使得obj有事件行为\n\t             * Mediator.installTo( obj );\n\t             *\n\t             * obj.on( 'testa', function( arg1, arg2 ) {\n\t             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n\t             * });\n\t             *\n\t             * obj.trigger( 'testa', 'arg1', 'arg2' );\n\t             * ```\n\t             *\n\t             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n\t             * 切会影响到`trigger`方法的返回值，为`false`。\n\t             *\n\t             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n\t             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n\t             * ```javascript\n\t             * obj.on( 'all', function( type, arg1, arg2 ) {\n\t             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n\t             * });\n\t             * ```\n\t             *\n\t             * @method on\n\t             * @grammar on( name, callback[, context] ) => self\n\t             * @param  {String}   name     事件名，支持多个事件用空格隔开\n\t             * @param  {Function} callback 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             * @class Mediator\n\t             */\n\t            on: function( name, callback, context ) {\n\t                var me = this,\n\t                    set;\n\t\n\t                if ( !callback ) {\n\t                    return this;\n\t                }\n\t\n\t                set = this._events || (this._events = []);\n\t\n\t                eachEvent( name, callback, function( name, callback ) {\n\t                    var handler = { e: name };\n\t\n\t                    handler.cb = callback;\n\t                    handler.ctx = context;\n\t                    handler.ctx2 = context || me;\n\t                    handler.id = set.length;\n\t\n\t                    set.push( handler );\n\t                });\n\t\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 绑定事件，且当handler执行完后，自动解除绑定。\n\t             * @method once\n\t             * @grammar once( name, callback[, context] ) => self\n\t             * @param  {String}   name     事件名\n\t             * @param  {Function} callback 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             */\n\t            once: function( name, callback, context ) {\n\t                var me = this;\n\t\n\t                if ( !callback ) {\n\t                    return me;\n\t                }\n\t\n\t                eachEvent( name, callback, function( name, callback ) {\n\t                    var once = function() {\n\t                            me.off( name, once );\n\t                            return callback.apply( context || me, arguments );\n\t                        };\n\t\n\t                    once._cb = callback;\n\t                    me.on( name, once, context );\n\t                });\n\t\n\t                return me;\n\t            },\n\t\n\t            /**\n\t             * 解除事件绑定\n\t             * @method off\n\t             * @grammar off( [name[, callback[, context] ] ] ) => self\n\t             * @param  {String}   [name]     事件名\n\t             * @param  {Function} [callback] 事件处理器\n\t             * @param  {Object}   [context]  事件处理器的上下文。\n\t             * @return {self} 返回自身，方便链式\n\t             * @chainable\n\t             */\n\t            off: function( name, cb, ctx ) {\n\t                var events = this._events;\n\t\n\t                if ( !events ) {\n\t                    return this;\n\t                }\n\t\n\t                if ( !name && !cb && !ctx ) {\n\t                    this._events = [];\n\t                    return this;\n\t                }\n\t\n\t                eachEvent( name, cb, function( name, cb ) {\n\t                    $.each( findHandlers( events, name, cb, ctx ), function() {\n\t                        delete events[ this.id ];\n\t                    });\n\t                });\n\t\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 触发事件\n\t             * @method trigger\n\t             * @grammar trigger( name[, args...] ) => self\n\t             * @param  {String}   type     事件名\n\t             * @param  {*} [...] 任意参数\n\t             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n\t             */\n\t            trigger: function( type ) {\n\t                var args, events, allEvents;\n\t\n\t                if ( !this._events || !type ) {\n\t                    return this;\n\t                }\n\t\n\t                args = slice.call( arguments, 1 );\n\t                events = findHandlers( this._events, type );\n\t                allEvents = findHandlers( this._events, 'all' );\n\t\n\t                return triggerHanders( events, args ) &&\n\t                        triggerHanders( allEvents, arguments );\n\t            }\n\t        };\n\t\n\t        /**\n\t         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n\t         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n\t         *\n\t         * @class Mediator\n\t         */\n\t        return $.extend({\n\t\n\t            /**\n\t             * 可以通过这个接口，使任何对象具备事件功能。\n\t             * @method installTo\n\t             * @param  {Object} obj 需要具备事件行为的对象。\n\t             * @return {Object} 返回obj.\n\t             */\n\t            installTo: function( obj ) {\n\t                return $.extend( obj, protos );\n\t            }\n\t\n\t        }, protos );\n\t    });\n\t    /**\n\t     * @fileOverview Uploader上传类\n\t     */\n\t    define('uploader',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        /**\n\t         * 上传入口类。\n\t         * @class Uploader\n\t         * @constructor\n\t         * @grammar new Uploader( opts ) => Uploader\n\t         * @example\n\t         * var uploader = WebUploader.Uploader({\n\t         *     swf: 'path_of_swf/Uploader.swf',\n\t         *\n\t         *     // 开起分片上传。\n\t         *     chunked: true\n\t         * });\n\t         */\n\t        function Uploader( opts ) {\n\t            this.options = $.extend( true, {}, Uploader.options, opts );\n\t            this._init( this.options );\n\t        }\n\t\n\t        // default Options\n\t        // widgets中有相应扩展\n\t        Uploader.options = {};\n\t        Mediator.installTo( Uploader.prototype );\n\t\n\t        // 批量添加纯命令式方法。\n\t        $.each({\n\t            upload: 'start-upload',\n\t            stop: 'stop-upload',\n\t            getFile: 'get-file',\n\t            getFiles: 'get-files',\n\t            addFile: 'add-file',\n\t            addFiles: 'add-file',\n\t            sort: 'sort-files',\n\t            removeFile: 'remove-file',\n\t            cancelFile: 'cancel-file',\n\t            skipFile: 'skip-file',\n\t            retry: 'retry',\n\t            isInProgress: 'is-in-progress',\n\t            makeThumb: 'make-thumb',\n\t            md5File: 'md5-file',\n\t            getDimension: 'get-dimension',\n\t            addButton: 'add-btn',\n\t            predictRuntimeType: 'predict-runtime-type',\n\t            refresh: 'refresh',\n\t            disable: 'disable',\n\t            enable: 'enable',\n\t            reset: 'reset'\n\t        }, function( fn, command ) {\n\t            Uploader.prototype[ fn ] = function() {\n\t                return this.request( command, arguments );\n\t            };\n\t        });\n\t\n\t        $.extend( Uploader.prototype, {\n\t            state: 'pending',\n\t\n\t            _init: function( opts ) {\n\t                var me = this;\n\t\n\t                me.request( 'init', opts, function() {\n\t                    me.state = 'ready';\n\t                    me.trigger('ready');\n\t                });\n\t            },\n\t\n\t            /**\n\t             * 获取或者设置Uploader配置项。\n\t             * @method option\n\t             * @grammar option( key ) => *\n\t             * @grammar option( key, val ) => self\n\t             * @example\n\t             *\n\t             * // 初始状态图片上传前不会压缩\n\t             * var uploader = new WebUploader.Uploader({\n\t             *     compress: null;\n\t             * });\n\t             *\n\t             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n\t             * uploader.option( 'compress', {\n\t             *     width: 1600,\n\t             *     height: 1600\n\t             * });\n\t             */\n\t            option: function( key, val ) {\n\t                var opts = this.options;\n\t\n\t                // setter\n\t                if ( arguments.length > 1 ) {\n\t\n\t                    if ( $.isPlainObject( val ) &&\n\t                            $.isPlainObject( opts[ key ] ) ) {\n\t                        $.extend( opts[ key ], val );\n\t                    } else {\n\t                        opts[ key ] = val;\n\t                    }\n\t\n\t                } else {    // getter\n\t                    return key ? opts[ key ] : opts;\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 获取文件统计信息。返回一个包含一下信息的对象。\n\t             * * `successNum` 上传成功的文件数\n\t             * * `progressNum` 上传中的文件数\n\t             * * `cancelNum` 被删除的文件数\n\t             * * `invalidNum` 无效的文件数\n\t             * * `uploadFailNum` 上传失败的文件数\n\t             * * `queueNum` 还在队列中的文件数\n\t             * * `interruptNum` 被暂停的文件数\n\t             * @method getStats\n\t             * @grammar getStats() => Object\n\t             */\n\t            getStats: function() {\n\t                // return this._mgr.getStats.apply( this._mgr, arguments );\n\t                var stats = this.request('get-stats');\n\t\n\t                return stats ? {\n\t                    successNum: stats.numOfSuccess,\n\t                    progressNum: stats.numOfProgress,\n\t\n\t                    // who care?\n\t                    // queueFailNum: 0,\n\t                    cancelNum: stats.numOfCancel,\n\t                    invalidNum: stats.numOfInvalid,\n\t                    uploadFailNum: stats.numOfUploadFailed,\n\t                    queueNum: stats.numOfQueue,\n\t                    interruptNum: stats.numofInterrupt\n\t                } : {};\n\t            },\n\t\n\t            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n\t            trigger: function( type/*, args...*/ ) {\n\t                var args = [].slice.call( arguments, 1 ),\n\t                    opts = this.options,\n\t                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n\t                        type.substring( 1 );\n\t\n\t                if (\n\t                        // 调用通过on方法注册的handler.\n\t                        Mediator.trigger.apply( this, arguments ) === false ||\n\t\n\t                        // 调用opts.onEvent\n\t                        $.isFunction( opts[ name ] ) &&\n\t                        opts[ name ].apply( this, args ) === false ||\n\t\n\t                        // 调用this.onEvent\n\t                        $.isFunction( this[ name ] ) &&\n\t                        this[ name ].apply( this, args ) === false ||\n\t\n\t                        // 广播所有uploader的事件。\n\t                        Mediator.trigger.apply( Mediator,\n\t                        [ this, type ].concat( args ) ) === false ) {\n\t\n\t                    return false;\n\t                }\n\t\n\t                return true;\n\t            },\n\t\n\t            /**\n\t             * 销毁 webuploader 实例\n\t             * @method destroy\n\t             * @grammar destroy() => undefined\n\t             */\n\t            destroy: function() {\n\t                this.request( 'destroy', arguments );\n\t                this.off();\n\t            },\n\t\n\t            // widgets/widget.js将补充此方法的详细文档。\n\t            request: Base.noop\n\t        });\n\t\n\t        /**\n\t         * 创建Uploader实例，等同于new Uploader( opts );\n\t         * @method create\n\t         * @class Base\n\t         * @static\n\t         * @grammar Base.create( opts ) => Uploader\n\t         */\n\t        Base.create = Uploader.create = function( opts ) {\n\t            return new Uploader( opts );\n\t        };\n\t\n\t        // 暴露Uploader，可以通过它来扩展业务逻辑。\n\t        Base.Uploader = Uploader;\n\t\n\t        return Uploader;\n\t    });\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/runtime',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$,\n\t            factories = {},\n\t\n\t            // 获取对象的第一个key\n\t            getFirstKey = function( obj ) {\n\t                for ( var key in obj ) {\n\t                    if ( obj.hasOwnProperty( key ) ) {\n\t                        return key;\n\t                    }\n\t                }\n\t                return null;\n\t            };\n\t\n\t        // 接口类。\n\t        function Runtime( options ) {\n\t            this.options = $.extend({\n\t                container: document.body\n\t            }, options );\n\t            this.uid = Base.guid('rt_');\n\t        }\n\t\n\t        $.extend( Runtime.prototype, {\n\t\n\t            getContainer: function() {\n\t                var opts = this.options,\n\t                    parent, container;\n\t\n\t                if ( this._container ) {\n\t                    return this._container;\n\t                }\n\t\n\t                parent = $( opts.container || document.body );\n\t                container = $( document.createElement('div') );\n\t\n\t                container.attr( 'id', 'rt_' + this.uid );\n\t                container.css({\n\t                    position: 'absolute',\n\t                    top: '0px',\n\t                    left: '0px',\n\t                    width: '1px',\n\t                    height: '1px',\n\t                    overflow: 'hidden'\n\t                });\n\t\n\t                parent.append( container );\n\t                parent.addClass('webuploader-container');\n\t                this._container = container;\n\t                this._parent = parent;\n\t                return container;\n\t            },\n\t\n\t            init: Base.noop,\n\t            exec: Base.noop,\n\t\n\t            destroy: function() {\n\t                this._container && this._container.remove();\n\t                this._parent && this._parent.removeClass('webuploader-container');\n\t                this.off();\n\t            }\n\t        });\n\t\n\t        Runtime.orders = 'html5,flash';\n\t\n\t\n\t        /**\n\t         * 添加Runtime实现。\n\t         * @param {String} type    类型\n\t         * @param {Runtime} factory 具体Runtime实现。\n\t         */\n\t        Runtime.addRuntime = function( type, factory ) {\n\t            factories[ type ] = factory;\n\t        };\n\t\n\t        Runtime.hasRuntime = function( type ) {\n\t            return !!(type ? factories[ type ] : getFirstKey( factories ));\n\t        };\n\t\n\t        Runtime.create = function( opts, orders ) {\n\t            var type, runtime;\n\t\n\t            orders = orders || Runtime.orders;\n\t            $.each( orders.split( /\\s*,\\s*/g ), function() {\n\t                if ( factories[ this ] ) {\n\t                    type = this;\n\t                    return false;\n\t                }\n\t            });\n\t\n\t            type = type || getFirstKey( factories );\n\t            if ( !type ) {\n\t                throw new Error('Runtime Error');\n\t            }\n\t\n\t            runtime = new factories[ type ]( opts );\n\t            return runtime;\n\t        };\n\t\n\t        Mediator.installTo( Runtime.prototype );\n\t        return Runtime;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/client',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/runtime'\n\t    ], function( Base, Mediator, Runtime ) {\n\t\n\t        var cache;\n\t\n\t        cache = (function() {\n\t            var obj = {};\n\t\n\t            return {\n\t                add: function( runtime ) {\n\t                    obj[ runtime.uid ] = runtime;\n\t                },\n\t\n\t                get: function( ruid, standalone ) {\n\t                    var i;\n\t\n\t                    if ( ruid ) {\n\t                        return obj[ ruid ];\n\t                    }\n\t\n\t                    for ( i in obj ) {\n\t                        // 有些类型不能重用，比如filepicker.\n\t                        if ( standalone && obj[ i ].__standalone ) {\n\t                            continue;\n\t                        }\n\t\n\t                        return obj[ i ];\n\t                    }\n\t\n\t                    return null;\n\t                },\n\t\n\t                remove: function( runtime ) {\n\t                    delete obj[ runtime.uid ];\n\t                }\n\t            };\n\t        })();\n\t\n\t        function RuntimeClient( component, standalone ) {\n\t            var deferred = Base.Deferred(),\n\t                runtime;\n\t\n\t            this.uid = Base.guid('client_');\n\t\n\t            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n\t            this.runtimeReady = function( cb ) {\n\t                return deferred.done( cb );\n\t            };\n\t\n\t            this.connectRuntime = function( opts, cb ) {\n\t\n\t                // already connected.\n\t                if ( runtime ) {\n\t                    throw new Error('already connected!');\n\t                }\n\t\n\t                deferred.done( cb );\n\t\n\t                if ( typeof opts === 'string' && cache.get( opts ) ) {\n\t                    runtime = cache.get( opts );\n\t                }\n\t\n\t                // 像filePicker只能独立存在，不能公用。\n\t                runtime = runtime || cache.get( null, standalone );\n\t\n\t                // 需要创建\n\t                if ( !runtime ) {\n\t                    runtime = Runtime.create( opts, opts.runtimeOrder );\n\t                    runtime.__promise = deferred.promise();\n\t                    runtime.once( 'ready', deferred.resolve );\n\t                    runtime.init();\n\t                    cache.add( runtime );\n\t                    runtime.__client = 1;\n\t                } else {\n\t                    // 来自cache\n\t                    Base.$.extend( runtime.options, opts );\n\t                    runtime.__promise.then( deferred.resolve );\n\t                    runtime.__client++;\n\t                }\n\t\n\t                standalone && (runtime.__standalone = standalone);\n\t                return runtime;\n\t            };\n\t\n\t            this.getRuntime = function() {\n\t                return runtime;\n\t            };\n\t\n\t            this.disconnectRuntime = function() {\n\t                if ( !runtime ) {\n\t                    return;\n\t                }\n\t\n\t                runtime.__client--;\n\t\n\t                if ( runtime.__client <= 0 ) {\n\t                    cache.remove( runtime );\n\t                    delete runtime.__promise;\n\t                    runtime.destroy();\n\t                }\n\t\n\t                runtime = null;\n\t            };\n\t\n\t            this.exec = function() {\n\t                if ( !runtime ) {\n\t                    return;\n\t                }\n\t\n\t                var args = Base.slice( arguments );\n\t                component && args.unshift( component );\n\t\n\t                return runtime.exec.apply( this, args );\n\t            };\n\t\n\t            this.getRuid = function() {\n\t                return runtime && runtime.uid;\n\t            };\n\t\n\t            this.destroy = (function( destroy ) {\n\t                return function() {\n\t                    destroy && destroy.apply( this, arguments );\n\t                    this.trigger('destroy');\n\t                    this.off();\n\t                    this.exec('destroy');\n\t                    this.disconnectRuntime();\n\t                };\n\t            })( this.destroy );\n\t        }\n\t\n\t        Mediator.installTo( RuntimeClient.prototype );\n\t        return RuntimeClient;\n\t    });\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/dnd',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/client'\n\t    ], function( Base, Mediator, RuntimeClent ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function DragAndDrop( opts ) {\n\t            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n\t\n\t            opts.container = $( opts.container );\n\t\n\t            if ( !opts.container.length ) {\n\t                return;\n\t            }\n\t\n\t            RuntimeClent.call( this, 'DragAndDrop' );\n\t        }\n\t\n\t        DragAndDrop.options = {\n\t            accept: null,\n\t            disableGlobalDnd: false\n\t        };\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: DragAndDrop,\n\t\n\t            init: function() {\n\t                var me = this;\n\t\n\t                me.connectRuntime( me.options, function() {\n\t                    me.exec('init');\n\t                    me.trigger('ready');\n\t                });\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( DragAndDrop.prototype );\n\t\n\t        return DragAndDrop;\n\t    });\n\t    /**\n\t     * @fileOverview 组件基类。\n\t     */\n\t    define('widgets/widget',[\n\t        'base',\n\t        'uploader'\n\t    ], function( Base, Uploader ) {\n\t\n\t        var $ = Base.$,\n\t            _init = Uploader.prototype._init,\n\t            _destroy = Uploader.prototype.destroy,\n\t            IGNORE = {},\n\t            widgetClass = [];\n\t\n\t        function isArrayLike( obj ) {\n\t            if ( !obj ) {\n\t                return false;\n\t            }\n\t\n\t            var length = obj.length,\n\t                type = $.type( obj );\n\t\n\t            if ( obj.nodeType === 1 && length ) {\n\t                return true;\n\t            }\n\t\n\t            return type === 'array' || type !== 'function' && type !== 'string' &&\n\t                    (length === 0 || typeof length === 'number' && length > 0 &&\n\t                    (length - 1) in obj);\n\t        }\n\t\n\t        function Widget( uploader ) {\n\t            this.owner = uploader;\n\t            this.options = uploader.options;\n\t        }\n\t\n\t        $.extend( Widget.prototype, {\n\t\n\t            init: Base.noop,\n\t\n\t            // 类Backbone的事件监听声明，监听uploader实例上的事件\n\t            // widget直接无法监听事件，事件只能通过uploader来传递\n\t            invoke: function( apiName, args ) {\n\t\n\t                /*\n\t                    {\n\t                        'make-thumb': 'makeThumb'\n\t                    }\n\t                 */\n\t                var map = this.responseMap;\n\t\n\t                // 如果无API响应声明则忽略\n\t                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n\t                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n\t\n\t                    return IGNORE;\n\t                }\n\t\n\t                return this[ map[ apiName ] ].apply( this, args );\n\t\n\t            },\n\t\n\t            /**\n\t             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n\t             * @method request\n\t             * @grammar request( command, args ) => * | Promise\n\t             * @grammar request( command, args, callback ) => Promise\n\t             * @for  Uploader\n\t             */\n\t            request: function() {\n\t                return this.owner.request.apply( this.owner, arguments );\n\t            }\n\t        });\n\t\n\t        // 扩展Uploader.\n\t        $.extend( Uploader.prototype, {\n\t\n\t            /**\n\t             * @property {String | Array} [disableWidgets=undefined]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n\t             */\n\t\n\t            // 覆写_init用来初始化widgets\n\t            _init: function() {\n\t                var me = this,\n\t                    widgets = me._widgets = [],\n\t                    deactives = me.options.disableWidgets || '';\n\t\n\t                $.each( widgetClass, function( _, klass ) {\n\t                    (!deactives || !~deactives.indexOf( klass._name )) &&\n\t                        widgets.push( new klass( me ) );\n\t                });\n\t\n\t                return _init.apply( me, arguments );\n\t            },\n\t\n\t            request: function( apiName, args, callback ) {\n\t                var i = 0,\n\t                    widgets = this._widgets,\n\t                    len = widgets && widgets.length,\n\t                    rlts = [],\n\t                    dfds = [],\n\t                    widget, rlt, promise, key;\n\t\n\t                args = isArrayLike( args ) ? args : [ args ];\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    widget = widgets[ i ];\n\t                    rlt = widget.invoke( apiName, args );\n\t\n\t                    if ( rlt !== IGNORE ) {\n\t\n\t                        // Deferred对象\n\t                        if ( Base.isPromise( rlt ) ) {\n\t                            dfds.push( rlt );\n\t                        } else {\n\t                            rlts.push( rlt );\n\t                        }\n\t                    }\n\t                }\n\t\n\t                // 如果有callback，则用异步方式。\n\t                if ( callback || dfds.length ) {\n\t                    promise = Base.when.apply( Base, dfds );\n\t                    key = promise.pipe ? 'pipe' : 'then';\n\t\n\t                    // 很重要不能删除。删除了会死循环。\n\t                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n\t                    return promise[ key ](function() {\n\t                                var deferred = Base.Deferred(),\n\t                                    args = arguments;\n\t\n\t                                if ( args.length === 1 ) {\n\t                                    args = args[ 0 ];\n\t                                }\n\t\n\t                                setTimeout(function() {\n\t                                    deferred.resolve( args );\n\t                                }, 1 );\n\t\n\t                                return deferred.promise();\n\t                            })[ callback ? key : 'done' ]( callback || Base.noop );\n\t                } else {\n\t                    return rlts[ 0 ];\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                _destroy.apply( this, arguments );\n\t                this._widgets = null;\n\t            }\n\t        });\n\t\n\t        /**\n\t         * 添加组件\n\t         * @grammar Uploader.register(proto);\n\t         * @grammar Uploader.register(map, proto);\n\t         * @param  {object} responseMap API 名称与函数实现的映射\n\t         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n\t         * @method Uploader.register\n\t         * @for Uploader\n\t         * @example\n\t         * Uploader.register({\n\t         *     'make-thumb': 'makeThumb'\n\t         * }, {\n\t         *     init: function( options ) {},\n\t         *     makeThumb: function() {}\n\t         * });\n\t         *\n\t         * Uploader.register({\n\t         *     'make-thumb': function() {\n\t         *\n\t         *     }\n\t         * });\n\t         */\n\t        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n\t            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n\t                klass;\n\t\n\t            if ( arguments.length === 1 ) {\n\t                widgetProto = responseMap;\n\t\n\t                // 自动生成 map 表。\n\t                $.each(widgetProto, function(key) {\n\t                    if ( key[0] === '_' || key === 'name' ) {\n\t                        key === 'name' && (map.name = widgetProto.name);\n\t                        return;\n\t                    }\n\t\n\t                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n\t                });\n\t\n\t            } else {\n\t                map = $.extend( map, responseMap );\n\t            }\n\t\n\t            widgetProto.responseMap = map;\n\t            klass = Base.inherits( Widget, widgetProto );\n\t            klass._name = map.name;\n\t            widgetClass.push( klass );\n\t\n\t            return klass;\n\t        };\n\t\n\t        /**\n\t         * 删除插件，只有在注册时指定了名字的才能被删除。\n\t         * @grammar Uploader.unRegister(name);\n\t         * @param  {string} name 组件名字\n\t         * @method Uploader.unRegister\n\t         * @for Uploader\n\t         * @example\n\t         *\n\t         * Uploader.register({\n\t         *     name: 'custom',\n\t         *\n\t         *     'make-thumb': function() {\n\t         *\n\t         *     }\n\t         * });\n\t         *\n\t         * Uploader.unRegister('custom');\n\t         */\n\t        Uploader.unRegister = Widget.unRegister = function( name ) {\n\t            if ( !name || name === 'anonymous' ) {\n\t                return;\n\t            }\n\t\n\t            // 删除指定的插件。\n\t            for ( var i = widgetClass.length; i--; ) {\n\t                if ( widgetClass[i]._name === name ) {\n\t                    widgetClass.splice(i, 1)\n\t                }\n\t            }\n\t        };\n\t\n\t        return Widget;\n\t    });\n\t    /**\n\t     * @fileOverview DragAndDrop Widget。\n\t     */\n\t    define('widgets/filednd',[\n\t        'base',\n\t        'uploader',\n\t        'lib/dnd',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Dnd ) {\n\t        var $ = Base.$;\n\t\n\t        Uploader.options.dnd = '';\n\t\n\t        /**\n\t         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t\n\t        /**\n\t         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t\n\t        /**\n\t         * @event dndAccept\n\t         * @param {DataTransferItemList} items DataTransferItem\n\t         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n\t         * @for  Uploader\n\t         */\n\t        return Uploader.register({\n\t            name: 'dnd',\n\t\n\t            init: function( opts ) {\n\t\n\t                if ( !opts.dnd ||\n\t                        this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                var me = this,\n\t                    deferred = Base.Deferred(),\n\t                    options = $.extend({}, {\n\t                        disableGlobalDnd: opts.disableGlobalDnd,\n\t                        container: opts.dnd,\n\t                        accept: opts.accept\n\t                    }),\n\t                    dnd;\n\t\n\t                this.dnd = dnd = new Dnd( options );\n\t\n\t                dnd.once( 'ready', deferred.resolve );\n\t                dnd.on( 'drop', function( files ) {\n\t                    me.request( 'add-file', [ files ]);\n\t                });\n\t\n\t                // 检测文件是否全部允许添加。\n\t                dnd.on( 'accept', function( items ) {\n\t                    return me.owner.trigger( 'dndAccept', items );\n\t                });\n\t\n\t                dnd.init();\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                this.dnd && this.dnd.destroy();\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/filepaste',[\n\t        'base',\n\t        'mediator',\n\t        'runtime/client'\n\t    ], function( Base, Mediator, RuntimeClent ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function FilePaste( opts ) {\n\t            opts = this.options = $.extend({}, opts );\n\t            opts.container = $( opts.container || document.body );\n\t            RuntimeClent.call( this, 'FilePaste' );\n\t        }\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: FilePaste,\n\t\n\t            init: function() {\n\t                var me = this;\n\t\n\t                me.connectRuntime( me.options, function() {\n\t                    me.exec('init');\n\t                    me.trigger('ready');\n\t                });\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( FilePaste.prototype );\n\t\n\t        return FilePaste;\n\t    });\n\t    /**\n\t     * @fileOverview 组件基类。\n\t     */\n\t    define('widgets/filepaste',[\n\t        'base',\n\t        'uploader',\n\t        'lib/filepaste',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, FilePaste ) {\n\t        var $ = Base.$;\n\t\n\t        /**\n\t         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n\t         * @namespace options\n\t         * @for Uploader\n\t         */\n\t        return Uploader.register({\n\t            name: 'paste',\n\t\n\t            init: function( opts ) {\n\t\n\t                if ( !opts.paste ||\n\t                        this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                var me = this,\n\t                    deferred = Base.Deferred(),\n\t                    options = $.extend({}, {\n\t                        container: opts.paste,\n\t                        accept: opts.accept\n\t                    }),\n\t                    paste;\n\t\n\t                this.paste = paste = new FilePaste( options );\n\t\n\t                paste.once( 'ready', deferred.resolve );\n\t                paste.on( 'paste', function( files ) {\n\t                    me.owner.request( 'add-file', [ files ]);\n\t                });\n\t                paste.init();\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                this.paste && this.paste.destroy();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Blob\n\t     */\n\t    define('lib/blob',[\n\t        'base',\n\t        'runtime/client'\n\t    ], function( Base, RuntimeClient ) {\n\t\n\t        function Blob( ruid, source ) {\n\t            var me = this;\n\t\n\t            me.source = source;\n\t            me.ruid = ruid;\n\t            this.size = source.size || 0;\n\t\n\t            // 如果没有指定 mimetype, 但是知道文件后缀。\n\t            if ( !source.type && this.ext &&\n\t                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n\t                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n\t            } else {\n\t                this.type = source.type || 'application/octet-stream';\n\t            }\n\t\n\t            RuntimeClient.call( me, 'Blob' );\n\t            this.uid = source.uid || this.uid;\n\t\n\t            if ( ruid ) {\n\t                me.connectRuntime( ruid );\n\t            }\n\t        }\n\t\n\t        Base.inherits( RuntimeClient, {\n\t            constructor: Blob,\n\t\n\t            slice: function( start, end ) {\n\t                return this.exec( 'slice', start, end );\n\t            },\n\t\n\t            getSource: function() {\n\t                return this.source;\n\t            }\n\t        });\n\t\n\t        return Blob;\n\t    });\n\t    /**\n\t     * 为了统一化Flash的File和HTML5的File而存在。\n\t     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n\t     * @fileOverview File\n\t     */\n\t    define('lib/file',[\n\t        'base',\n\t        'lib/blob'\n\t    ], function( Base, Blob ) {\n\t\n\t        var uid = 1,\n\t            rExt = /\\.([^.]+)$/;\n\t\n\t        function File( ruid, file ) {\n\t            var ext;\n\t\n\t            this.name = file.name || ('untitled' + uid++);\n\t            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n\t\n\t            // todo 支持其他类型文件的转换。\n\t            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n\t            if ( !ext && file.type ) {\n\t                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n\t                        RegExp.$1.toLowerCase() : '';\n\t                this.name += '.' + ext;\n\t            }\n\t\n\t            this.ext = ext;\n\t            this.lastModifiedDate = file.lastModifiedDate ||\n\t                    (new Date()).toLocaleString();\n\t\n\t            Blob.apply( this, arguments );\n\t        }\n\t\n\t        return Base.inherits( Blob, File );\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 错误信息\n\t     */\n\t    define('lib/filepicker',[\n\t        'base',\n\t        'runtime/client',\n\t        'lib/file'\n\t    ], function( Base, RuntimeClent, File ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function FilePicker( opts ) {\n\t            opts = this.options = $.extend({}, FilePicker.options, opts );\n\t\n\t            opts.container = $( opts.id );\n\t\n\t            if ( !opts.container.length ) {\n\t                throw new Error('按钮指定错误');\n\t            }\n\t\n\t            opts.innerHTML = opts.innerHTML || opts.label ||\n\t                    opts.container.html() || '';\n\t\n\t            opts.button = $( opts.button || document.createElement('div') );\n\t            opts.button.html( opts.innerHTML );\n\t            opts.container.html( opts.button );\n\t\n\t            RuntimeClent.call( this, 'FilePicker', true );\n\t        }\n\t\n\t        FilePicker.options = {\n\t            button: null,\n\t            container: null,\n\t            label: null,\n\t            innerHTML: null,\n\t            multiple: true,\n\t            accept: null,\n\t            name: 'file'\n\t        };\n\t\n\t        Base.inherits( RuntimeClent, {\n\t            constructor: FilePicker,\n\t\n\t            init: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    button = opts.button;\n\t\n\t                button.addClass('webuploader-pick');\n\t\n\t                me.on( 'all', function( type ) {\n\t                    var files;\n\t\n\t                    switch ( type ) {\n\t                        case 'mouseenter':\n\t                            button.addClass('webuploader-pick-hover');\n\t                            break;\n\t\n\t                        case 'mouseleave':\n\t                            button.removeClass('webuploader-pick-hover');\n\t                            break;\n\t\n\t                        case 'change':\n\t                            files = me.exec('getFiles');\n\t                            me.trigger( 'select', $.map( files, function( file ) {\n\t                                file = new File( me.getRuid(), file );\n\t\n\t                                // 记录来源。\n\t                                file._refer = opts.container;\n\t                                return file;\n\t                            }), opts.container );\n\t                            break;\n\t                    }\n\t                });\n\t\n\t                me.connectRuntime( opts, function() {\n\t                    me.refresh();\n\t                    me.exec( 'init', opts );\n\t                    me.trigger('ready');\n\t                });\n\t\n\t                this._resizeHandler = Base.bindFn( this.refresh, this );\n\t                $( window ).on( 'resize', this._resizeHandler );\n\t            },\n\t\n\t            refresh: function() {\n\t                var shimContainer = this.getRuntime().getContainer(),\n\t                    button = this.options.button,\n\t                    width = button.outerWidth ?\n\t                            button.outerWidth() : button.width(),\n\t\n\t                    height = button.outerHeight ?\n\t                            button.outerHeight() : button.height(),\n\t\n\t                    pos = button.offset();\n\t\n\t                width && height && shimContainer.css({\n\t                    bottom: 'auto',\n\t                    right: 'auto',\n\t                    width: width + 'px',\n\t                    height: height + 'px'\n\t                }).offset( pos );\n\t            },\n\t\n\t            enable: function() {\n\t                var btn = this.options.button;\n\t\n\t                btn.removeClass('webuploader-pick-disable');\n\t                this.refresh();\n\t            },\n\t\n\t            disable: function() {\n\t                var btn = this.options.button;\n\t\n\t                this.getRuntime().getContainer().css({\n\t                    top: '-99999px'\n\t                });\n\t\n\t                btn.addClass('webuploader-pick-disable');\n\t            },\n\t\n\t            destroy: function() {\n\t                var btn = this.options.button;\n\t                $( window ).off( 'resize', this._resizeHandler );\n\t                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n\t                    'webuploader-pick');\n\t            }\n\t        });\n\t\n\t        return FilePicker;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 文件选择相关\n\t     */\n\t    define('widgets/filepicker',[\n\t        'base',\n\t        'uploader',\n\t        'lib/filepicker',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, FilePicker ) {\n\t        var $ = Base.$;\n\t\n\t        $.extend( Uploader.options, {\n\t\n\t            /**\n\t             * @property {Selector | Object} [pick=undefined]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n\t             *\n\t             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n\t             * * `label` {String} 请采用 `innerHTML` 代替\n\t             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n\t             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n\t             */\n\t            pick: null,\n\t\n\t            /**\n\t             * @property {Arroy} [accept=null]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n\t             *\n\t             * * `title` {String} 文字描述\n\t             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n\t             * * `mimeTypes` {String} 多个用逗号分割。\n\t             *\n\t             * 如：\n\t             *\n\t             * ```\n\t             * {\n\t             *     title: 'Images',\n\t             *     extensions: 'gif,jpg,jpeg,bmp,png',\n\t             *     mimeTypes: 'image/*'\n\t             * }\n\t             * ```\n\t             */\n\t            accept: null/*{\n\t                title: 'Images',\n\t                extensions: 'gif,jpg,jpeg,bmp,png',\n\t                mimeTypes: 'image/*'\n\t            }*/\n\t        });\n\t\n\t        return Uploader.register({\n\t            name: 'picker',\n\t\n\t            init: function( opts ) {\n\t                this.pickers = [];\n\t                return opts.pick && this.addBtn( opts.pick );\n\t            },\n\t\n\t            refresh: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.refresh();\n\t                });\n\t            },\n\t\n\t            /**\n\t             * @method addButton\n\t             * @for Uploader\n\t             * @grammar addButton( pick ) => Promise\n\t             * @description\n\t             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n\t             * @example\n\t             * uploader.addButton({\n\t             *     id: '#btnContainer',\n\t             *     innerHTML: '选择文件'\n\t             * });\n\t             */\n\t            addBtn: function( pick ) {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    accept = opts.accept,\n\t                    promises = [];\n\t\n\t                if ( !pick ) {\n\t                    return;\n\t                }\n\t\n\t                $.isPlainObject( pick ) || (pick = {\n\t                    id: pick\n\t                });\n\t\n\t                $( pick.id ).each(function() {\n\t                    var options, picker, deferred;\n\t\n\t                    deferred = Base.Deferred();\n\t\n\t                    options = $.extend({}, pick, {\n\t                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n\t                        swf: opts.swf,\n\t                        runtimeOrder: opts.runtimeOrder,\n\t                        id: this\n\t                    });\n\t\n\t                    picker = new FilePicker( options );\n\t\n\t                    picker.once( 'ready', deferred.resolve );\n\t                    picker.on( 'select', function( files ) {\n\t                        me.owner.request( 'add-file', [ files ]);\n\t                    });\n\t                    picker.init();\n\t\n\t                    me.pickers.push( picker );\n\t\n\t                    promises.push( deferred.promise() );\n\t                });\n\t\n\t                return Base.when.apply( Base, promises );\n\t            },\n\t\n\t            disable: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.disable();\n\t                });\n\t            },\n\t\n\t            enable: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.enable();\n\t                });\n\t            },\n\t\n\t            destroy: function() {\n\t                $.each( this.pickers, function() {\n\t                    this.destroy();\n\t                });\n\t                this.pickers = null;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Image\n\t     */\n\t    define('lib/image',[\n\t        'base',\n\t        'runtime/client',\n\t        'lib/blob'\n\t    ], function( Base, RuntimeClient, Blob ) {\n\t        var $ = Base.$;\n\t\n\t        // 构造器。\n\t        function Image( opts ) {\n\t            this.options = $.extend({}, Image.options, opts );\n\t            RuntimeClient.call( this, 'Image' );\n\t\n\t            this.on( 'load', function() {\n\t                this._info = this.exec('info');\n\t                this._meta = this.exec('meta');\n\t            });\n\t        }\n\t\n\t        // 默认选项。\n\t        Image.options = {\n\t\n\t            // 默认的图片处理质量\n\t            quality: 90,\n\t\n\t            // 是否裁剪\n\t            crop: false,\n\t\n\t            // 是否保留头部信息\n\t            preserveHeaders: false,\n\t\n\t            // 是否允许放大。\n\t            allowMagnify: false\n\t        };\n\t\n\t        // 继承RuntimeClient.\n\t        Base.inherits( RuntimeClient, {\n\t            constructor: Image,\n\t\n\t            info: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._info = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._info;\n\t            },\n\t\n\t            meta: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._meta = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._meta;\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var me = this,\n\t                    ruid = blob.getRuid();\n\t\n\t                this.connectRuntime( ruid, function() {\n\t                    me.exec( 'init', me.options );\n\t                    me.exec( 'loadFromBlob', blob );\n\t                });\n\t            },\n\t\n\t            resize: function() {\n\t                var args = Base.slice( arguments );\n\t                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n\t            },\n\t\n\t            crop: function() {\n\t                var args = Base.slice( arguments );\n\t                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n\t            },\n\t\n\t            getAsDataUrl: function( type ) {\n\t                return this.exec( 'getAsDataUrl', type );\n\t            },\n\t\n\t            getAsBlob: function( type ) {\n\t                var blob = this.exec( 'getAsBlob', type );\n\t\n\t                return new Blob( this.getRuid(), blob );\n\t            }\n\t        });\n\t\n\t        return Image;\n\t    });\n\t    /**\n\t     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n\t     */\n\t    define('widgets/image',[\n\t        'base',\n\t        'uploader',\n\t        'lib/image',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Image ) {\n\t\n\t        var $ = Base.$,\n\t            throttle;\n\t\n\t        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n\t        throttle = (function( max ) {\n\t            var occupied = 0,\n\t                waiting = [],\n\t                tick = function() {\n\t                    var item;\n\t\n\t                    while ( waiting.length && occupied < max ) {\n\t                        item = waiting.shift();\n\t                        occupied += item[ 0 ];\n\t                        item[ 1 ]();\n\t                    }\n\t                };\n\t\n\t            return function( emiter, size, cb ) {\n\t                waiting.push([ size, cb ]);\n\t                emiter.once( 'destroy', function() {\n\t                    occupied -= size;\n\t                    setTimeout( tick, 1 );\n\t                });\n\t                setTimeout( tick, 1 );\n\t            };\n\t        })( 5 * 1024 * 1024 );\n\t\n\t        $.extend( Uploader.options, {\n\t\n\t            /**\n\t             * @property {Object} [thumb]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 配置生成缩略图的选项。\n\t             *\n\t             * 默认为：\n\t             *\n\t             * ```javascript\n\t             * {\n\t             *     width: 110,\n\t             *     height: 110,\n\t             *\n\t             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n\t             *     quality: 70,\n\t             *\n\t             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n\t             *     allowMagnify: true,\n\t             *\n\t             *     // 是否允许裁剪。\n\t             *     crop: true,\n\t             *\n\t             *     // 为空的话则保留原有图片格式。\n\t             *     // 否则强制转换成指定的类型。\n\t             *     type: 'image/jpeg'\n\t             * }\n\t             * ```\n\t             */\n\t            thumb: {\n\t                width: 110,\n\t                height: 110,\n\t                quality: 70,\n\t                allowMagnify: true,\n\t                crop: true,\n\t                preserveHeaders: false,\n\t\n\t                // 为空的话则保留原有图片格式。\n\t                // 否则强制转换成指定的类型。\n\t                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n\t                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n\t                type: 'image/jpeg'\n\t            },\n\t\n\t            /**\n\t             * @property {Object} [compress]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n\t             *\n\t             * 默认为：\n\t             *\n\t             * ```javascript\n\t             * {\n\t             *     width: 1600,\n\t             *     height: 1600,\n\t             *\n\t             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n\t             *     quality: 90,\n\t             *\n\t             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n\t             *     allowMagnify: false,\n\t             *\n\t             *     // 是否允许裁剪。\n\t             *     crop: false,\n\t             *\n\t             *     // 是否保留头部meta信息。\n\t             *     preserveHeaders: true,\n\t             *\n\t             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n\t             *     // 此属性可能会影响图片自动纠正功能\n\t             *     noCompressIfLarger: false,\n\t             *\n\t             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n\t             *     compressSize: 0\n\t             * }\n\t             * ```\n\t             */\n\t            compress: {\n\t                width: 1600,\n\t                height: 1600,\n\t                quality: 90,\n\t                allowMagnify: false,\n\t                crop: false,\n\t                preserveHeaders: true\n\t            }\n\t        });\n\t\n\t        return Uploader.register({\n\t\n\t            name: 'image',\n\t\n\t\n\t            /**\n\t             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n\t             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n\t             *\n\t             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n\t             *\n\t             * `callback`中可以接收到两个参数。\n\t             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n\t             * * 第二个为ret, 缩略图的Data URL值。\n\t             *\n\t             * **注意**\n\t             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n\t             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n\t             *\n\t             * @method makeThumb\n\t             * @grammar makeThumb( file, callback ) => undefined\n\t             * @grammar makeThumb( file, callback, width, height ) => undefined\n\t             * @for Uploader\n\t             * @example\n\t             *\n\t             * uploader.on( 'fileQueued', function( file ) {\n\t             *     var $li = ...;\n\t             *\n\t             *     uploader.makeThumb( file, function( error, ret ) {\n\t             *         if ( error ) {\n\t             *             $li.text('预览错误');\n\t             *         } else {\n\t             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n\t             *         }\n\t             *     });\n\t             *\n\t             * });\n\t             */\n\t            makeThumb: function( file, cb, width, height ) {\n\t                var opts, image;\n\t                var isArtwork = false;\n\t                file = this.request( 'get-file', file );\n\t\n\t                // 只预览图片格式。\n\t                if ( !file.type.match( /^image/ ) ) {\n\t                    cb( true );\n\t                    return;\n\t                }\n\t\n\t                opts = $.extend({}, this.options.thumb );\n\t                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n\t                // 如果传入的是object.\n\t                if ( $.isPlainObject( width ) ) {\n\t                    opts = $.extend( opts, width );\n\t                    width = null;\n\t                }\n\t\n\t                width = width || opts.width;\n\t                height = height || opts.height;\n\t\n\t                image = new Image( opts );\n\t\n\t                image.once( 'load', function() {\n\t                    file._info = file._info || image.info();\n\t                    file._meta = file._meta || image.meta();\n\t\n\t                    // 如果 width 的值介于 0 - 1\n\t                    // 说明设置的是百分比。\n\t                    if ( width <= 1 && width > 0 ) {\n\t                        width = file._info.width * width;\n\t                    }\n\t\n\t                    // 同样的规则应用于 height\n\t                    if ( height <= 1 && height > 0 ) {\n\t                        height = file._info.height * height;\n\t                    }\n\t                    if( isArtwork ){\n\t                        image.resize( file._info.width, file._info.height );\n\t\n\t                    }else{\n\t                        image.resize( width, height );\n\t\n\t\n\t                    }\n\t\n\t                });\n\t\n\t                // 当 resize 完后\n\t                image.once( 'complete', function() {\n\t                    cb( false, image.getAsDataUrl( opts.type ) );\n\t                    image.destroy();\n\t                });\n\t\n\t                image.once( 'error', function( reason ) {\n\t                    cb( reason || true );\n\t                    image.destroy();\n\t                });\n\t\n\t                throttle( image, file.source.size, function() {\n\t                    file._info && image.info( file._info );\n\t                    file._meta && image.meta( file._meta );\n\t                    image.loadFromBlob( file.source );\n\t                });\n\t            },\n\t\n\t            beforeSendFile: function( file ) {\n\t                var opts = this.options.compress || this.options.resize,\n\t                    compressSize = opts && opts.compressSize || 0,\n\t                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n\t                    image, deferred;\n\t\n\t                file = this.request( 'get-file', file );\n\t\n\t                // 只压缩 jpeg 图片格式。\n\t                // gif 可能会丢失针\n\t                // bmp png 基本上尺寸都不大，且压缩比比较小。\n\t                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n\t                        file.size < compressSize ||\n\t                        file._compressed ) {\n\t                    return;\n\t                }\n\t\n\t                opts = $.extend({}, opts );\n\t                deferred = Base.Deferred();\n\t\n\t                image = new Image( opts );\n\t\n\t                deferred.always(function() {\n\t                    image.destroy();\n\t                    image = null;\n\t                });\n\t                image.once( 'error', deferred.reject );\n\t                image.once( 'load', function() {\n\t                    var width = opts.width,\n\t                        height = opts.height;\n\t\n\t                    file._info = file._info || image.info();\n\t                    file._meta = file._meta || image.meta();\n\t\n\t                    // 如果 width 的值介于 0 - 1\n\t                    // 说明设置的是百分比。\n\t                    if ( width <= 1 && width > 0 ) {\n\t                        width = file._info.width * width;\n\t                    }\n\t\n\t                    // 同样的规则应用于 height\n\t                    if ( height <= 1 && height > 0 ) {\n\t                        height = file._info.height * height;\n\t                    }\n\t\n\t                    image.resize( width, height );\n\t                });\n\t\n\t                image.once( 'complete', function() {\n\t                    var blob, size;\n\t\n\t                    // 移动端 UC / qq 浏览器的无图模式下\n\t                    // ctx.getImageData 处理大图的时候会报 Exception\n\t                    // INDEX_SIZE_ERR: DOM Exception 1\n\t                    try {\n\t                        blob = image.getAsBlob( opts.type );\n\t\n\t                        size = file.size;\n\t\n\t                        // 如果压缩后，比原来还大则不用压缩后的。\n\t                        if ( !noCompressIfLarger || blob.size < size ) {\n\t                            // file.source.destroy && file.source.destroy();\n\t                            file.source = blob;\n\t                            file.size = blob.size;\n\t\n\t                            file.trigger( 'resize', blob.size, size );\n\t                        }\n\t\n\t                        // 标记，避免重复压缩。\n\t                        file._compressed = true;\n\t                        deferred.resolve();\n\t                    } catch ( e ) {\n\t                        // 出错了直接继续，让其上传原始图片\n\t                        deferred.resolve();\n\t                    }\n\t                });\n\t\n\t                file._info && image.info( file._info );\n\t                file._meta && image.meta( file._meta );\n\t\n\t                image.loadFromBlob( file.source );\n\t                return deferred.promise();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 文件属性封装\n\t     */\n\t    define('file',[\n\t        'base',\n\t        'mediator'\n\t    ], function( Base, Mediator ) {\n\t\n\t        var $ = Base.$,\n\t            idPrefix = 'WU_FILE_',\n\t            idSuffix = 0,\n\t            rExt = /\\.([^.]+)$/,\n\t            statusMap = {};\n\t\n\t        function gid() {\n\t            return idPrefix + idSuffix++;\n\t        }\n\t\n\t        /**\n\t         * 文件类\n\t         * @class File\n\t         * @constructor 构造函数\n\t         * @grammar new File( source ) => File\n\t         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n\t         */\n\t        function WUFile( source ) {\n\t\n\t            /**\n\t             * 文件名，包括扩展名（后缀）\n\t             * @property name\n\t             * @type {string}\n\t             */\n\t            this.name = source.name || 'Untitled';\n\t\n\t            /**\n\t             * 文件体积（字节）\n\t             * @property size\n\t             * @type {uint}\n\t             * @default 0\n\t             */\n\t            this.size = source.size || 0;\n\t\n\t            /**\n\t             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n\t             * @property type\n\t             * @type {string}\n\t             * @default 'application/octet-stream'\n\t             */\n\t            this.type = source.type || 'application/octet-stream';\n\t\n\t            /**\n\t             * 文件最后修改日期\n\t             * @property lastModifiedDate\n\t             * @type {int}\n\t             * @default 当前时间戳\n\t             */\n\t            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n\t\n\t            /**\n\t             * 文件ID，每个对象具有唯一ID，与文件名无关\n\t             * @property id\n\t             * @type {string}\n\t             */\n\t            this.id = gid();\n\t\n\t            /**\n\t             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n\t             * @property ext\n\t             * @type {string}\n\t             */\n\t            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n\t\n\t\n\t            /**\n\t             * 状态文字说明。在不同的status语境下有不同的用途。\n\t             * @property statusText\n\t             * @type {string}\n\t             */\n\t            this.statusText = '';\n\t\n\t            // 存储文件状态，防止通过属性直接修改\n\t            statusMap[ this.id ] = WUFile.Status.INITED;\n\t\n\t            this.source = source;\n\t            this.loaded = 0;\n\t\n\t            this.on( 'error', function( msg ) {\n\t                this.setStatus( WUFile.Status.ERROR, msg );\n\t            });\n\t        }\n\t\n\t        $.extend( WUFile.prototype, {\n\t\n\t            /**\n\t             * 设置状态，状态变化时会触发`change`事件。\n\t             * @method setStatus\n\t             * @grammar setStatus( status[, statusText] );\n\t             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n\t             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n\t             */\n\t            setStatus: function( status, text ) {\n\t\n\t                var prevStatus = statusMap[ this.id ];\n\t\n\t                typeof text !== 'undefined' && (this.statusText = text);\n\t\n\t                if ( status !== prevStatus ) {\n\t                    statusMap[ this.id ] = status;\n\t                    /**\n\t                     * 文件状态变化\n\t                     * @event statuschange\n\t                     */\n\t                    this.trigger( 'statuschange', status, prevStatus );\n\t                }\n\t\n\t            },\n\t\n\t            /**\n\t             * 获取文件状态\n\t             * @return {File.Status}\n\t             * @example\n\t                     文件状态具体包括以下几种类型：\n\t                     {\n\t                         // 初始化\n\t                        INITED:     0,\n\t                        // 已入队列\n\t                        QUEUED:     1,\n\t                        // 正在上传\n\t                        PROGRESS:     2,\n\t                        // 上传出错\n\t                        ERROR:         3,\n\t                        // 上传成功\n\t                        COMPLETE:     4,\n\t                        // 上传取消\n\t                        CANCELLED:     5\n\t                    }\n\t             */\n\t            getStatus: function() {\n\t                return statusMap[ this.id ];\n\t            },\n\t\n\t            /**\n\t             * 获取文件原始信息。\n\t             * @return {*}\n\t             */\n\t            getSource: function() {\n\t                return this.source;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.off();\n\t                delete statusMap[ this.id ];\n\t            }\n\t        });\n\t\n\t        Mediator.installTo( WUFile.prototype );\n\t\n\t        /**\n\t         * 文件状态值，具体包括以下几种类型：\n\t         * * `inited` 初始状态\n\t         * * `queued` 已经进入队列, 等待上传\n\t         * * `progress` 上传中\n\t         * * `complete` 上传完成。\n\t         * * `error` 上传出错，可重试\n\t         * * `interrupt` 上传中断，可续传。\n\t         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n\t         * * `cancelled` 文件被移除。\n\t         * @property {Object} Status\n\t         * @namespace File\n\t         * @class File\n\t         * @static\n\t         */\n\t        WUFile.Status = {\n\t            INITED:     'inited',    // 初始状态\n\t            QUEUED:     'queued',    // 已经进入队列, 等待上传\n\t            PROGRESS:   'progress',    // 上传中\n\t            ERROR:      'error',    // 上传出错，可重试\n\t            COMPLETE:   'complete',    // 上传完成。\n\t            CANCELLED:  'cancelled',    // 上传取消。\n\t            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n\t            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n\t        };\n\t\n\t        return WUFile;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview 文件队列\n\t     */\n\t    define('queue',[\n\t        'base',\n\t        'mediator',\n\t        'file'\n\t    ], function( Base, Mediator, WUFile ) {\n\t\n\t        var $ = Base.$,\n\t            STATUS = WUFile.Status;\n\t\n\t        /**\n\t         * 文件队列, 用来存储各个状态中的文件。\n\t         * @class Queue\n\t         * @extends Mediator\n\t         */\n\t        function Queue() {\n\t\n\t            /**\n\t             * 统计文件数。\n\t             * * `numOfQueue` 队列中的文件数。\n\t             * * `numOfSuccess` 上传成功的文件数\n\t             * * `numOfCancel` 被取消的文件数\n\t             * * `numOfProgress` 正在上传中的文件数\n\t             * * `numOfUploadFailed` 上传错误的文件数。\n\t             * * `numOfInvalid` 无效的文件数。\n\t             * * `numofDeleted` 被移除的文件数。\n\t             * @property {Object} stats\n\t             */\n\t            this.stats = {\n\t                numOfQueue: 0,\n\t                numOfSuccess: 0,\n\t                numOfCancel: 0,\n\t                numOfProgress: 0,\n\t                numOfUploadFailed: 0,\n\t                numOfInvalid: 0,\n\t                numofDeleted: 0,\n\t                numofInterrupt: 0\n\t            };\n\t\n\t            // 上传队列，仅包括等待上传的文件\n\t            this._queue = [];\n\t\n\t            // 存储所有文件\n\t            this._map = {};\n\t        }\n\t\n\t        $.extend( Queue.prototype, {\n\t\n\t            /**\n\t             * 将新文件加入对队列尾部\n\t             *\n\t             * @method append\n\t             * @param  {File} file   文件对象\n\t             */\n\t            append: function( file ) {\n\t                this._queue.push( file );\n\t                this._fileAdded( file );\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 将新文件加入对队列头部\n\t             *\n\t             * @method prepend\n\t             * @param  {File} file   文件对象\n\t             */\n\t            prepend: function( file ) {\n\t                this._queue.unshift( file );\n\t                this._fileAdded( file );\n\t                return this;\n\t            },\n\t\n\t            /**\n\t             * 获取文件对象\n\t             *\n\t             * @method getFile\n\t             * @param  {String} fileId   文件ID\n\t             * @return {File}\n\t             */\n\t            getFile: function( fileId ) {\n\t                if ( typeof fileId !== 'string' ) {\n\t                    return fileId;\n\t                }\n\t                return this._map[ fileId ];\n\t            },\n\t\n\t            /**\n\t             * 从队列中取出一个指定状态的文件。\n\t             * @grammar fetch( status ) => File\n\t             * @method fetch\n\t             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n\t             * @return {File} [File](#WebUploader:File)\n\t             */\n\t            fetch: function( status ) {\n\t                var len = this._queue.length,\n\t                    i, file;\n\t\n\t                status = status || STATUS.QUEUED;\n\t\n\t                for ( i = 0; i < len; i++ ) {\n\t                    file = this._queue[ i ];\n\t\n\t                    if ( status === file.getStatus() ) {\n\t                        return file;\n\t                    }\n\t                }\n\t\n\t                return null;\n\t            },\n\t\n\t            /**\n\t             * 对队列进行排序，能够控制文件上传顺序。\n\t             * @grammar sort( fn ) => undefined\n\t             * @method sort\n\t             * @param {Function} fn 排序方法\n\t             */\n\t            sort: function( fn ) {\n\t                if ( typeof fn === 'function' ) {\n\t                    this._queue.sort( fn );\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n\t             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n\t             * @method getFiles\n\t             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n\t             */\n\t            getFiles: function() {\n\t                var sts = [].slice.call( arguments, 0 ),\n\t                    ret = [],\n\t                    i = 0,\n\t                    len = this._queue.length,\n\t                    file;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    file = this._queue[ i ];\n\t\n\t                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n\t                        continue;\n\t                    }\n\t\n\t                    ret.push( file );\n\t                }\n\t\n\t                return ret;\n\t            },\n\t\n\t            /**\n\t             * 在队列中删除文件。\n\t             * @grammar removeFile( file ) => Array\n\t             * @method removeFile\n\t             * @param {File} 文件对象。\n\t             */\n\t            removeFile: function( file ) {\n\t                var me = this,\n\t                    existing = this._map[ file.id ];\n\t\n\t                if ( existing ) {\n\t                    delete this._map[ file.id ];\n\t                    file.destroy();\n\t                    this.stats.numofDeleted++;\n\t                }\n\t            },\n\t\n\t            _fileAdded: function( file ) {\n\t                var me = this,\n\t                    existing = this._map[ file.id ];\n\t\n\t                if ( !existing ) {\n\t                    this._map[ file.id ] = file;\n\t\n\t                    file.on( 'statuschange', function( cur, pre ) {\n\t                        me._onFileStatusChange( cur, pre );\n\t                    });\n\t                }\n\t            },\n\t\n\t            _onFileStatusChange: function( curStatus, preStatus ) {\n\t                var stats = this.stats;\n\t\n\t                switch ( preStatus ) {\n\t                    case STATUS.PROGRESS:\n\t                        stats.numOfProgress--;\n\t                        break;\n\t\n\t                    case STATUS.QUEUED:\n\t                        stats.numOfQueue --;\n\t                        break;\n\t\n\t                    case STATUS.ERROR:\n\t                        stats.numOfUploadFailed--;\n\t                        break;\n\t\n\t                    case STATUS.INVALID:\n\t                        stats.numOfInvalid--;\n\t                        break;\n\t\n\t                    case STATUS.INTERRUPT:\n\t                        stats.numofInterrupt--;\n\t                        break;\n\t                }\n\t\n\t                switch ( curStatus ) {\n\t                    case STATUS.QUEUED:\n\t                        stats.numOfQueue++;\n\t                        break;\n\t\n\t                    case STATUS.PROGRESS:\n\t                        stats.numOfProgress++;\n\t                        break;\n\t\n\t                    case STATUS.ERROR:\n\t                        stats.numOfUploadFailed++;\n\t                        break;\n\t\n\t                    case STATUS.COMPLETE:\n\t                        stats.numOfSuccess++;\n\t                        break;\n\t\n\t                    case STATUS.CANCELLED:\n\t                        stats.numOfCancel++;\n\t                        break;\n\t\n\t\n\t                    case STATUS.INVALID:\n\t                        stats.numOfInvalid++;\n\t                        break;\n\t\n\t                    case STATUS.INTERRUPT:\n\t                        stats.numofInterrupt++;\n\t                        break;\n\t                }\n\t            }\n\t\n\t        });\n\t\n\t        Mediator.installTo( Queue.prototype );\n\t\n\t        return Queue;\n\t    });\n\t    /**\n\t     * @fileOverview 队列\n\t     */\n\t    define('widgets/queue',[\n\t        'base',\n\t        'uploader',\n\t        'queue',\n\t        'file',\n\t        'lib/file',\n\t        'runtime/client',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n\t\n\t        var $ = Base.$,\n\t            rExt = /\\.\\w+$/,\n\t            Status = WUFile.Status;\n\t\n\t        return Uploader.register({\n\t            name: 'queue',\n\t\n\t            init: function( opts ) {\n\t                var me = this,\n\t                    deferred, len, i, item, arr, accept, runtime;\n\t\n\t                if ( $.isPlainObject( opts.accept ) ) {\n\t                    opts.accept = [ opts.accept ];\n\t                }\n\t\n\t                // accept中的中生成匹配正则。\n\t                if ( opts.accept ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        item = opts.accept[ i ].extensions;\n\t                        item && arr.push( item );\n\t                    }\n\t\n\t                    if ( arr.length ) {\n\t                        accept = '\\\\.' + arr.join(',')\n\t                                .replace( /,/g, '$|\\\\.' )\n\t                                .replace( /\\*/g, '.*' ) + '$';\n\t                    }\n\t\n\t                    me.accept = new RegExp( accept, 'i' );\n\t                }\n\t\n\t                me.queue = new Queue();\n\t                me.stats = me.queue.stats;\n\t\n\t                // 如果当前不是html5运行时，那就算了。\n\t                // 不执行后续操作\n\t                if ( this.request('predict-runtime-type') !== 'html5' ) {\n\t                    return;\n\t                }\n\t\n\t                // 创建一个 html5 运行时的 placeholder\n\t                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n\t                deferred = Base.Deferred();\n\t                this.placeholder = runtime = new RuntimeClient('Placeholder');\n\t                runtime.connectRuntime({\n\t                    runtimeOrder: 'html5'\n\t                }, function() {\n\t                    me._ruid = runtime.getRuid();\n\t                    deferred.resolve();\n\t                });\n\t                return deferred.promise();\n\t            },\n\t\n\t\n\t            // 为了支持外部直接添加一个原生File对象。\n\t            _wrapFile: function( file ) {\n\t                if ( !(file instanceof WUFile) ) {\n\t\n\t                    if ( !(file instanceof File) ) {\n\t                        if ( !this._ruid ) {\n\t                            throw new Error('Can\\'t add external files.');\n\t                        }\n\t                        file = new File( this._ruid, file );\n\t                    }\n\t\n\t                    file = new WUFile( file );\n\t                }\n\t\n\t                return file;\n\t            },\n\t\n\t            // 判断文件是否可以被加入队列\n\t            acceptFile: function( file ) {\n\t                 var invalid = !file || !file.size || this.accept &&\n\t\n\t                        // 如果名字中有后缀，才做后缀白名单处理。\n\t                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n\t                return !invalid;\n\t            },\n\t\n\t\n\t            /**\n\t             * @event beforeFileQueued\n\t             * @param {File} file File对象\n\t             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event fileQueued\n\t             * @param {File} file File对象\n\t             * @description 当文件被加入队列以后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            _addFile: function( file ) {\n\t                var me = this;\n\t\n\t                file = me._wrapFile( file );\n\t\n\t                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n\t                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n\t                    return;\n\t                }\n\t\n\t                // 类型不匹配，则派送错误事件，并返回。\n\t                if ( !me.acceptFile( file ) ) {\n\t                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n\t                    return;\n\t                }\n\t\n\t                me.queue.append( file );\n\t                me.owner.trigger( 'fileQueued', file );\n\t                return file;\n\t            },\n\t\n\t            getFile: function( fileId ) {\n\t                return this.queue.getFile( fileId );\n\t            },\n\t\n\t            /**\n\t             * @event filesQueued\n\t             * @param {File} files 数组，内容为原始File(lib/File）对象。\n\t             * @description 当一批文件添加进队列以后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @property {Boolean} [auto=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n\t             *\n\t             */\n\t\n\t            /**\n\t             * @method addFiles\n\t             * @grammar addFiles( file ) => undefined\n\t             * @grammar addFiles( [file1, file2 ...] ) => undefined\n\t             * @param {Array of File or File} [files] Files 对象 数组\n\t             * @description 添加文件到队列\n\t             * @for  Uploader\n\t             */\n\t            addFile: function( files ) {\n\t                var me = this;\n\t\n\t                if ( !files.length ) {\n\t                    files = [ files ];\n\t                }\n\t\n\t                files = $.map( files, function( file ) {\n\t                    return me._addFile( file );\n\t                });\n\t\n\t                me.owner.trigger( 'filesQueued', files );\n\t\n\t                if ( me.options.auto ) {\n\t                    setTimeout(function() {\n\t                        me.request('start-upload');\n\t                    }, 20 );\n\t                }\n\t            },\n\t\n\t            getStats: function() {\n\t                return this.stats;\n\t            },\n\t\n\t            /**\n\t             * @event fileDequeued\n\t             * @param {File} file File对象\n\t             * @description 当文件被移除队列后触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t             /**\n\t             * @method removeFile\n\t             * @grammar removeFile( file ) => undefined\n\t             * @grammar removeFile( id ) => undefined\n\t             * @grammar removeFile( file, true ) => undefined\n\t             * @grammar removeFile( id, true ) => undefined\n\t             * @param {File|id} file File对象或这File对象的id\n\t             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n\t             * @for  Uploader\n\t             * @example\n\t             *\n\t             * $li.on('click', '.remove-this', function() {\n\t             *     uploader.removeFile( file );\n\t             * })\n\t             */\n\t            removeFile: function( file, remove ) {\n\t                var me = this;\n\t\n\t                file = file.id ? file : me.queue.getFile( file );\n\t\n\t                this.request( 'cancel-file', file );\n\t\n\t                if ( remove ) {\n\t                    this.queue.removeFile( file );\n\t                }\n\t            },\n\t\n\t            /**\n\t             * @method getFiles\n\t             * @grammar getFiles() => Array\n\t             * @grammar getFiles( status1, status2, status... ) => Array\n\t             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n\t             * @for  Uploader\n\t             * @example\n\t             * console.log( uploader.getFiles() );    // => all files\n\t             * console.log( uploader.getFiles('error') )    // => all error files.\n\t             */\n\t            getFiles: function() {\n\t                return this.queue.getFiles.apply( this.queue, arguments );\n\t            },\n\t\n\t            fetchFile: function() {\n\t                return this.queue.fetch.apply( this.queue, arguments );\n\t            },\n\t\n\t            /**\n\t             * @method retry\n\t             * @grammar retry() => undefined\n\t             * @grammar retry( file ) => undefined\n\t             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n\t             * @for  Uploader\n\t             * @example\n\t             * function retry() {\n\t             *     uploader.retry();\n\t             * }\n\t             */\n\t            retry: function( file, noForceStart ) {\n\t                var me = this,\n\t                    files, i, len;\n\t\n\t                if ( file ) {\n\t                    file = file.id ? file : me.queue.getFile( file );\n\t                    file.setStatus( Status.QUEUED );\n\t                    noForceStart || me.request('start-upload');\n\t                    return;\n\t                }\n\t\n\t                files = me.queue.getFiles( Status.ERROR );\n\t                i = 0;\n\t                len = files.length;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    file = files[ i ];\n\t                    file.setStatus( Status.QUEUED );\n\t                }\n\t\n\t                me.request('start-upload');\n\t            },\n\t\n\t            /**\n\t             * @method sort\n\t             * @grammar sort( fn ) => undefined\n\t             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n\t             * @for  Uploader\n\t             */\n\t            sortFiles: function() {\n\t                return this.queue.sort.apply( this.queue, arguments );\n\t            },\n\t\n\t            /**\n\t             * @event reset\n\t             * @description 当 uploader 被重置的时候触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @method reset\n\t             * @grammar reset() => undefined\n\t             * @description 重置uploader。目前只重置了队列。\n\t             * @for  Uploader\n\t             * @example\n\t             * uploader.reset();\n\t             */\n\t            reset: function() {\n\t                this.owner.trigger('reset');\n\t                this.queue = new Queue();\n\t                this.stats = this.queue.stats;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.reset();\n\t                this.placeholder && this.placeholder.destroy();\n\t            }\n\t        });\n\t\n\t    });\n\t    /**\n\t     * @fileOverview 添加获取Runtime相关信息的方法。\n\t     */\n\t    define('widgets/runtime',[\n\t        'uploader',\n\t        'runtime/runtime',\n\t        'widgets/widget'\n\t    ], function( Uploader, Runtime ) {\n\t\n\t        Uploader.support = function() {\n\t            return Runtime.hasRuntime.apply( Runtime, arguments );\n\t        };\n\t\n\t        /**\n\t         * @property {Object} [runtimeOrder=html5,flash]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n\t         *\n\t         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n\t         */\n\t\n\t        return Uploader.register({\n\t            name: 'runtime',\n\t\n\t            init: function() {\n\t                if ( !this.predictRuntimeType() ) {\n\t                    throw Error('Runtime Error');\n\t                }\n\t            },\n\t\n\t            /**\n\t             * 预测Uploader将采用哪个`Runtime`\n\t             * @grammar predictRuntimeType() => String\n\t             * @method predictRuntimeType\n\t             * @for  Uploader\n\t             */\n\t            predictRuntimeType: function() {\n\t                var orders = this.options.runtimeOrder || Runtime.orders,\n\t                    type = this.type,\n\t                    i, len;\n\t\n\t                if ( !type ) {\n\t                    orders = orders.split( /\\s*,\\s*/g );\n\t\n\t                    for ( i = 0, len = orders.length; i < len; i++ ) {\n\t                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n\t                            this.type = type = orders[ i ];\n\t                            break;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                return type;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Transport\n\t     */\n\t    define('lib/transport',[\n\t        'base',\n\t        'runtime/client',\n\t        'mediator'\n\t    ], function( Base, RuntimeClient, Mediator ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        function Transport( opts ) {\n\t            var me = this;\n\t\n\t            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n\t            RuntimeClient.call( this, 'Transport' );\n\t\n\t            this._blob = null;\n\t            this._formData = opts.formData || {};\n\t            this._headers = opts.headers || {};\n\t\n\t            this.on( 'progress', this._timeout );\n\t            this.on( 'load error', function() {\n\t                me.trigger( 'progress', 1 );\n\t                clearTimeout( me._timer );\n\t            });\n\t        }\n\t\n\t        Transport.options = {\n\t            server: '',\n\t            method: 'POST',\n\t\n\t            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n\t            withCredentials: false,\n\t            fileVal: 'file',\n\t            timeout: 2 * 60 * 1000,    // 2分钟\n\t            formData: {},\n\t            headers: {},\n\t            sendAsBinary: false\n\t        };\n\t\n\t        $.extend( Transport.prototype, {\n\t\n\t            // 添加Blob, 只能添加一次，最后一次有效。\n\t            appendBlob: function( key, blob, filename ) {\n\t                var me = this,\n\t                    opts = me.options;\n\t\n\t                if ( me.getRuid() ) {\n\t                    me.disconnectRuntime();\n\t                }\n\t\n\t                // 连接到blob归属的同一个runtime.\n\t                me.connectRuntime( blob.ruid, function() {\n\t                    me.exec('init');\n\t                });\n\t\n\t                me._blob = blob;\n\t                opts.fileVal = key || opts.fileVal;\n\t                opts.filename = filename || opts.filename;\n\t\n\t            },\n\t\n\t            // 添加其他字段\n\t            append: function( key, value ) {\n\t                if ( typeof key === 'object' ) {\n\t                    $.extend( this._formData, key );\n\t                } else {\n\t                    this._formData[ key ] = value;\n\t                }\n\t            },\n\t\n\t            setRequestHeader: function( key, value ) {\n\t                if ( typeof key === 'object' ) {\n\t                    $.extend( this._headers, key );\n\t                } else {\n\t                    this._headers[ key ] = value;\n\t                }\n\t            },\n\t\n\t            send: function( method ) {\n\t                this.exec( 'send', method );\n\t                this._timeout();\n\t            },\n\t\n\t            abort: function() {\n\t                clearTimeout( this._timer );\n\t                return this.exec('abort');\n\t            },\n\t\n\t            destroy: function() {\n\t                this.trigger('destroy');\n\t                this.off();\n\t                this.exec('destroy');\n\t                this.disconnectRuntime();\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this.exec('getResponse');\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this.exec('getResponseAsJson');\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this.exec('getStatus');\n\t            },\n\t\n\t            _timeout: function() {\n\t                var me = this,\n\t                    duration = me.options.timeout;\n\t\n\t                if ( !duration ) {\n\t                    return;\n\t                }\n\t\n\t                clearTimeout( me._timer );\n\t                me._timer = setTimeout(function() {\n\t                    me.abort();\n\t                    me.trigger( 'error', 'timeout' );\n\t                }, duration );\n\t            }\n\t\n\t        });\n\t\n\t        // 让Transport具备事件功能。\n\t        Mediator.installTo( Transport.prototype );\n\t\n\t        return Transport;\n\t    });\n\t    /**\n\t     * @fileOverview 负责文件上传相关。\n\t     */\n\t    define('widgets/upload',[\n\t        'base',\n\t        'uploader',\n\t        'file',\n\t        'lib/transport',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, WUFile, Transport ) {\n\t\n\t        var $ = Base.$,\n\t            isPromise = Base.isPromise,\n\t            Status = WUFile.Status;\n\t\n\t        // 添加默认配置项\n\t        $.extend( Uploader.options, {\n\t\n\t\n\t            /**\n\t             * @property {Boolean} [prepareNextFile=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否允许在文件传输时提前把下一个文件准备好。\n\t             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n\t             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n\t             */\n\t            prepareNextFile: false,\n\t\n\t            /**\n\t             * @property {Boolean} [chunked=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否要分片处理大文件上传。\n\t             */\n\t            chunked: false,\n\t\n\t            /**\n\t             * @property {Boolean} [chunkSize=5242880]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 如果要分片，分多大一片？ 默认大小为5M.\n\t             */\n\t            chunkSize: 5 * 1024 * 1024,\n\t\n\t            /**\n\t             * @property {Boolean} [chunkRetry=2]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n\t             */\n\t            chunkRetry: 2,\n\t\n\t            /**\n\t             * @property {Boolean} [threads=3]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 上传并发数。允许同时最大上传进程数。\n\t             */\n\t            threads: 3,\n\t\n\t\n\t            /**\n\t             * @property {Object} [formData={}]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n\t             */\n\t            formData: {}\n\t\n\t            /**\n\t             * @property {Object} [fileVal='file']\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 设置文件上传域的name。\n\t             */\n\t\n\t            /**\n\t             * @property {Object} [method='POST']\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 文件上传方式，`POST`或者`GET`。\n\t             */\n\t\n\t            /**\n\t             * @property {Object} [sendAsBinary=false]\n\t             * @namespace options\n\t             * @for Uploader\n\t             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n\t             * 其他参数在$_GET数组中。\n\t             */\n\t        });\n\t\n\t        // 负责将文件切片。\n\t        function CuteFile( file, chunkSize ) {\n\t            var pending = [],\n\t                blob = file.source,\n\t                total = blob.size,\n\t                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n\t                start = 0,\n\t                index = 0,\n\t                len, api;\n\t\n\t            api = {\n\t                file: file,\n\t\n\t                has: function() {\n\t                    return !!pending.length;\n\t                },\n\t\n\t                shift: function() {\n\t                    return pending.shift();\n\t                },\n\t\n\t                unshift: function( block ) {\n\t                    pending.unshift( block );\n\t                }\n\t            };\n\t\n\t            while ( index < chunks ) {\n\t                len = Math.min( chunkSize, total - start );\n\t\n\t                pending.push({\n\t                    file: file,\n\t                    start: start,\n\t                    end: chunkSize ? (start + len) : total,\n\t                    total: total,\n\t                    chunks: chunks,\n\t                    chunk: index++,\n\t                    cuted: api\n\t                });\n\t                start += len;\n\t            }\n\t\n\t            file.blocks = pending.concat();\n\t            file.remaning = pending.length;\n\t\n\t            return api;\n\t        }\n\t\n\t        Uploader.register({\n\t            name: 'upload',\n\t\n\t            init: function() {\n\t                var owner = this.owner,\n\t                    me = this;\n\t\n\t                this.runing = false;\n\t                this.progress = false;\n\t\n\t                owner\n\t                    .on( 'startUpload', function() {\n\t                        me.progress = true;\n\t                    })\n\t                    .on( 'uploadFinished', function() {\n\t                        me.progress = false;\n\t                    });\n\t\n\t                // 记录当前正在传的数据，跟threads相关\n\t                this.pool = [];\n\t\n\t                // 缓存分好片的文件。\n\t                this.stack = [];\n\t\n\t                // 缓存即将上传的文件。\n\t                this.pending = [];\n\t\n\t                // 跟踪还有多少分片在上传中但是没有完成上传。\n\t                this.remaning = 0;\n\t                this.__tick = Base.bindFn( this._tick, this );\n\t\n\t                owner.on( 'uploadComplete', function( file ) {\n\t\n\t                    // 把其他块取消了。\n\t                    file.blocks && $.each( file.blocks, function( _, v ) {\n\t                        v.transport && (v.transport.abort(), v.transport.destroy());\n\t                        delete v.transport;\n\t                    });\n\t\n\t                    delete file.blocks;\n\t                    delete file.remaning;\n\t                });\n\t            },\n\t\n\t            reset: function() {\n\t                this.request( 'stop-upload', true );\n\t                this.runing = false;\n\t                this.pool = [];\n\t                this.stack = [];\n\t                this.pending = [];\n\t                this.remaning = 0;\n\t                this._trigged = false;\n\t                this._promise = null;\n\t            },\n\t\n\t            /**\n\t             * @event startUpload\n\t             * @description 当开始上传流程时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n\t             *\n\t             * 可以指定开始某一个文件。\n\t             * @grammar upload() => undefined\n\t             * @grammar upload( file | fileId) => undefined\n\t             * @method upload\n\t             * @for  Uploader\n\t             */\n\t            startUpload: function(file) {\n\t                var me = this;\n\t\n\t                // 移出invalid的文件\n\t                $.each( me.request( 'get-files', Status.INVALID ), function() {\n\t                    me.request( 'remove-file', this );\n\t                });\n\t\n\t                // 如果指定了开始某个文件，则只开始指定文件。\n\t                if ( file ) {\n\t                    file = file.id ? file : me.request( 'get-file', file );\n\t\n\t                    if (file.getStatus() === Status.INTERRUPT) {\n\t                        $.each( me.pool, function( _, v ) {\n\t\n\t                            // 之前暂停过。\n\t                            if (v.file !== file) {\n\t                                return;\n\t                            }\n\t\n\t                            v.transport && v.transport.send();\n\t                        });\n\t\n\t                        file.setStatus( Status.QUEUED );\n\t                    } else if (file.getStatus() === Status.PROGRESS) {\n\t                        return;\n\t                    } else {\n\t                        file.setStatus( Status.QUEUED );\n\t                    }\n\t                } else {\n\t                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n\t                        this.setStatus( Status.QUEUED );\n\t                    });\n\t                }\n\t\n\t                if ( me.runing ) {\n\t                    return;\n\t                }\n\t\n\t                me.runing = true;\n\t\n\t                var files = [];\n\t\n\t                // 如果有暂停的，则续传\n\t                $.each( me.pool, function( _, v ) {\n\t                    var file = v.file;\n\t\n\t                    if ( file.getStatus() === Status.INTERRUPT ) {\n\t                        files.push(file);\n\t                        me._trigged = false;\n\t                        v.transport && v.transport.send();\n\t                    }\n\t                });\n\t\n\t                var file;\n\t                while ( (file = files.shift()) ) {\n\t                    file.setStatus( Status.PROGRESS );\n\t                }\n\t\n\t                file || $.each( me.request( 'get-files',\n\t                        Status.INTERRUPT ), function() {\n\t                    this.setStatus( Status.PROGRESS );\n\t                });\n\t\n\t                me._trigged = false;\n\t                Base.nextTick( me.__tick );\n\t                me.owner.trigger('startUpload');\n\t            },\n\t\n\t            /**\n\t             * @event stopUpload\n\t             * @description 当开始上传流程暂停时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n\t             *\n\t             * 如果第一个参数是文件，则只暂停指定文件。\n\t             * @grammar stop() => undefined\n\t             * @grammar stop( true ) => undefined\n\t             * @grammar stop( file ) => undefined\n\t             * @method stop\n\t             * @for  Uploader\n\t             */\n\t            stopUpload: function( file, interrupt ) {\n\t                var me = this;\n\t\n\t                if (file === true) {\n\t                    interrupt = file;\n\t                    file = null;\n\t                }\n\t\n\t                if ( me.runing === false ) {\n\t                    return;\n\t                }\n\t\n\t                // 如果只是暂停某个文件。\n\t                if ( file ) {\n\t                    file = file.id ? file : me.request( 'get-file', file );\n\t\n\t                    if ( file.getStatus() !== Status.PROGRESS &&\n\t                            file.getStatus() !== Status.QUEUED ) {\n\t                        return;\n\t                    }\n\t\n\t                    file.setStatus( Status.INTERRUPT );\n\t                    $.each( me.pool, function( _, v ) {\n\t\n\t                        // 只 abort 指定的文件。\n\t                        if (v.file !== file) {\n\t                            return;\n\t                        }\n\t\n\t                        v.transport && v.transport.abort();\n\t                        me._putback(v);\n\t                        me._popBlock(v);\n\t                    });\n\t\n\t                    return Base.nextTick( me.__tick );\n\t                }\n\t\n\t                me.runing = false;\n\t\n\t                if (this._promise && this._promise.file) {\n\t                    this._promise.file.setStatus( Status.INTERRUPT );\n\t                }\n\t\n\t                interrupt && $.each( me.pool, function( _, v ) {\n\t                    v.transport && v.transport.abort();\n\t                    v.file.setStatus( Status.INTERRUPT );\n\t                });\n\t\n\t                me.owner.trigger('stopUpload');\n\t            },\n\t\n\t            /**\n\t             * @method cancelFile\n\t             * @grammar cancelFile( file ) => undefined\n\t             * @grammar cancelFile( id ) => undefined\n\t             * @param {File|id} file File对象或这File对象的id\n\t             * @description 标记文件状态为已取消, 同时将中断文件传输。\n\t             * @for  Uploader\n\t             * @example\n\t             *\n\t             * $li.on('click', '.remove-this', function() {\n\t             *     uploader.cancelFile( file );\n\t             * })\n\t             */\n\t            cancelFile: function( file ) {\n\t                file = file.id ? file : this.request( 'get-file', file );\n\t\n\t                // 如果正在上传。\n\t                file.blocks && $.each( file.blocks, function( _, v ) {\n\t                    var _tr = v.transport;\n\t\n\t                    if ( _tr ) {\n\t                        _tr.abort();\n\t                        _tr.destroy();\n\t                        delete v.transport;\n\t                    }\n\t                });\n\t\n\t                file.setStatus( Status.CANCELLED );\n\t                this.owner.trigger( 'fileDequeued', file );\n\t            },\n\t\n\t            /**\n\t             * 判断`Uplaode`r是否正在上传中。\n\t             * @grammar isInProgress() => Boolean\n\t             * @method isInProgress\n\t             * @for  Uploader\n\t             */\n\t            isInProgress: function() {\n\t                return !!this.progress;\n\t            },\n\t\n\t            _getStats: function() {\n\t                return this.request('get-stats');\n\t            },\n\t\n\t            /**\n\t             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n\t             * @grammar skipFile( file ) => undefined\n\t             * @method skipFile\n\t             * @for  Uploader\n\t             */\n\t            skipFile: function( file, status ) {\n\t                file = file.id ? file : this.request( 'get-file', file );\n\t\n\t                file.setStatus( status || Status.COMPLETE );\n\t                file.skipped = true;\n\t\n\t                // 如果正在上传。\n\t                file.blocks && $.each( file.blocks, function( _, v ) {\n\t                    var _tr = v.transport;\n\t\n\t                    if ( _tr ) {\n\t                        _tr.abort();\n\t                        _tr.destroy();\n\t                        delete v.transport;\n\t                    }\n\t                });\n\t\n\t                this.owner.trigger( 'uploadSkip', file );\n\t            },\n\t\n\t            /**\n\t             * @event uploadFinished\n\t             * @description 当所有文件上传结束时触发。\n\t             * @for  Uploader\n\t             */\n\t            _tick: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    fn, val;\n\t\n\t                // 上一个promise还没有结束，则等待完成后再执行。\n\t                if ( me._promise ) {\n\t                    return me._promise.always( me.__tick );\n\t                }\n\t\n\t                // 还有位置，且还有文件要处理的话。\n\t                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n\t                    me._trigged = false;\n\t\n\t                    fn = function( val ) {\n\t                        me._promise = null;\n\t\n\t                        // 有可能是reject过来的，所以要检测val的类型。\n\t                        val && val.file && me._startSend( val );\n\t                        Base.nextTick( me.__tick );\n\t                    };\n\t\n\t                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n\t\n\t                // 没有要上传的了，且没有正在传输的了。\n\t                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n\t                    !me._getStats().numofInterrupt ) {\n\t                    me.runing = false;\n\t\n\t                    me._trigged || Base.nextTick(function() {\n\t                        me.owner.trigger('uploadFinished');\n\t                    });\n\t                    me._trigged = true;\n\t                }\n\t            },\n\t\n\t            _putback: function(block) {\n\t                var idx;\n\t\n\t                block.cuted.unshift(block);\n\t                idx = this.stack.indexOf(block.cuted);\n\t\n\t                if (!~idx) {\n\t                    this.stack.unshift(block.cuted);\n\t                }\n\t            },\n\t\n\t            _getStack: function() {\n\t                var i = 0,\n\t                    act;\n\t\n\t                while ( (act = this.stack[ i++ ]) ) {\n\t                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n\t                        return act;\n\t                    } else if (!act.has() ||\n\t                            act.file.getStatus() !== Status.PROGRESS &&\n\t                            act.file.getStatus() !== Status.INTERRUPT ) {\n\t\n\t                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n\t                        // interupt（暂停中） 的移除。\n\t                        this.stack.splice( --i, 1 );\n\t                    }\n\t                }\n\t\n\t                return null;\n\t            },\n\t\n\t            _nextBlock: function() {\n\t                var me = this,\n\t                    opts = me.options,\n\t                    act, next, done, preparing;\n\t\n\t                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n\t                if ( (act = this._getStack()) ) {\n\t\n\t                    // 是否提前准备下一个文件\n\t                    if ( opts.prepareNextFile && !me.pending.length ) {\n\t                        me._prepareNextFile();\n\t                    }\n\t\n\t                    return act.shift();\n\t\n\t                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n\t                } else if ( me.runing ) {\n\t\n\t                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n\t                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n\t                        me._prepareNextFile();\n\t                    }\n\t\n\t                    next = me.pending.shift();\n\t                    done = function( file ) {\n\t                        if ( !file ) {\n\t                            return null;\n\t                        }\n\t\n\t                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n\t                        me.stack.push(act);\n\t                        return act.shift();\n\t                    };\n\t\n\t                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n\t                    if ( isPromise( next) ) {\n\t                        preparing = next.file;\n\t                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n\t                        next.file = preparing;\n\t                        return next;\n\t                    }\n\t\n\t                    return done( next );\n\t                }\n\t            },\n\t\n\t\n\t            /**\n\t             * @event uploadStart\n\t             * @param {File} file File对象\n\t             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n\t             * @for  Uploader\n\t             */\n\t            _prepareNextFile: function() {\n\t                var me = this,\n\t                    file = me.request('fetch-file'),\n\t                    pending = me.pending,\n\t                    promise;\n\t\n\t                if ( file ) {\n\t                    promise = me.request( 'before-send-file', file, function() {\n\t\n\t                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n\t                        if ( file.getStatus() === Status.PROGRESS ||\n\t                            file.getStatus() === Status.INTERRUPT ) {\n\t                            return file;\n\t                        }\n\t\n\t                        return me._finishFile( file );\n\t                    });\n\t\n\t                    me.owner.trigger( 'uploadStart', file );\n\t                    file.setStatus( Status.PROGRESS );\n\t\n\t                    promise.file = file;\n\t\n\t                    // 如果还在pending中，则替换成文件本身。\n\t                    promise.done(function() {\n\t                        var idx = $.inArray( promise, pending );\n\t\n\t                        ~idx && pending.splice( idx, 1, file );\n\t                    });\n\t\n\t                    // befeore-send-file的钩子就有错误发生。\n\t                    promise.fail(function( reason ) {\n\t                        file.setStatus( Status.ERROR, reason );\n\t                        me.owner.trigger( 'uploadError', file, reason );\n\t                        me.owner.trigger( 'uploadComplete', file );\n\t                    });\n\t\n\t                    pending.push( promise );\n\t                }\n\t            },\n\t\n\t            // 让出位置了，可以让其他分片开始上传\n\t            _popBlock: function( block ) {\n\t                var idx = $.inArray( block, this.pool );\n\t\n\t                this.pool.splice( idx, 1 );\n\t                block.file.remaning--;\n\t                this.remaning--;\n\t            },\n\t\n\t            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n\t            _startSend: function( block ) {\n\t                var me = this,\n\t                    file = block.file,\n\t                    promise;\n\t\n\t                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n\t                // 如：暂停，取消\n\t                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n\t                if ( file.getStatus() !== Status.PROGRESS ) {\n\t\n\t                    // 如果是中断，则还需要放回去。\n\t                    if (file.getStatus() === Status.INTERRUPT) {\n\t                        me._putback(block);\n\t                    }\n\t\n\t                    return;\n\t                }\n\t\n\t                me.pool.push( block );\n\t                me.remaning++;\n\t\n\t                // 如果没有分片，则直接使用原始的。\n\t                // 不会丢失content-type信息。\n\t                block.blob = block.chunks === 1 ? file.source :\n\t                        file.source.slice( block.start, block.end );\n\t\n\t                // hook, 每个分片发送之前可能要做些异步的事情。\n\t                promise = me.request( 'before-send', block, function() {\n\t\n\t                    // 有可能文件已经上传出错了，所以不需要再传输了。\n\t                    if ( file.getStatus() === Status.PROGRESS ) {\n\t                        me._doSend( block );\n\t                    } else {\n\t                        me._popBlock( block );\n\t                        Base.nextTick( me.__tick );\n\t                    }\n\t                });\n\t\n\t                // 如果为fail了，则跳过此分片。\n\t                promise.fail(function() {\n\t                    if ( file.remaning === 1 ) {\n\t                        me._finishFile( file ).always(function() {\n\t                            block.percentage = 1;\n\t                            me._popBlock( block );\n\t                            me.owner.trigger( 'uploadComplete', file );\n\t                            Base.nextTick( me.__tick );\n\t                        });\n\t                    } else {\n\t                        block.percentage = 1;\n\t                        me.updateFileProgress( file );\n\t                        me._popBlock( block );\n\t                        Base.nextTick( me.__tick );\n\t                    }\n\t                });\n\t            },\n\t\n\t\n\t            /**\n\t             * @event uploadBeforeSend\n\t             * @param {Object} object\n\t             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n\t             * @param {Object} headers 可以扩展此对象来控制上传头部。\n\t             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadAccept\n\t             * @param {Object} object\n\t             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n\t             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadProgress\n\t             * @param {File} file File对象\n\t             * @param {Number} percentage 上传进度\n\t             * @description 上传过程中触发，携带上传进度。\n\t             * @for  Uploader\n\t             */\n\t\n\t\n\t            /**\n\t             * @event uploadError\n\t             * @param {File} file File对象\n\t             * @param {String} reason 出错的code\n\t             * @description 当文件上传出错时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadSuccess\n\t             * @param {File} file File对象\n\t             * @param {Object} response 服务端返回的数据\n\t             * @description 当文件上传成功时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            /**\n\t             * @event uploadComplete\n\t             * @param {File} [file] File对象\n\t             * @description 不管成功或者失败，文件上传完成时触发。\n\t             * @for  Uploader\n\t             */\n\t\n\t            // 做上传操作。\n\t            _doSend: function( block ) {\n\t                var me = this,\n\t                    owner = me.owner,\n\t                    opts = me.options,\n\t                    file = block.file,\n\t                    tr = new Transport( opts ),\n\t                    data = $.extend({}, opts.formData ),\n\t                    headers = $.extend({}, opts.headers ),\n\t                    requestAccept, ret;\n\t\n\t                block.transport = tr;\n\t\n\t                tr.on( 'destroy', function() {\n\t                    delete block.transport;\n\t                    me._popBlock( block );\n\t                    Base.nextTick( me.__tick );\n\t                });\n\t\n\t                // 广播上传进度。以文件为单位。\n\t                tr.on( 'progress', function( percentage ) {\n\t                    block.percentage = percentage;\n\t                    me.updateFileProgress( file );\n\t                });\n\t\n\t                // 用来询问，是否返回的结果是有错误的。\n\t                requestAccept = function( reject ) {\n\t                    var fn;\n\t\n\t                    ret = tr.getResponseAsJson() || {};\n\t                    ret._raw = tr.getResponse();\n\t                    fn = function( value ) {\n\t                        reject = value;\n\t                    };\n\t\n\t                    // 服务端响应了，不代表成功了，询问是否响应正确。\n\t                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n\t                        reject = reject || 'server';\n\t                    }\n\t\n\t                    return reject;\n\t                };\n\t\n\t                // 尝试重试，然后广播文件上传出错。\n\t                tr.on( 'error', function( type, flag ) {\n\t                    block.retried = block.retried || 0;\n\t\n\t                    // 自动重试\n\t                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n\t                            block.retried < opts.chunkRetry ) {\n\t\n\t                        block.retried++;\n\t                        tr.send();\n\t\n\t                    } else {\n\t\n\t                        // http status 500 ~ 600\n\t                        if ( !flag && type === 'server' ) {\n\t                            type = requestAccept( type );\n\t                        }\n\t\n\t                        file.setStatus( Status.ERROR, type );\n\t                        owner.trigger( 'uploadError', file, type );\n\t                        owner.trigger( 'uploadComplete', file );\n\t                    }\n\t                });\n\t\n\t                // 上传成功\n\t                tr.on( 'load', function() {\n\t                    var reason;\n\t\n\t                    // 如果非预期，转向上传出错。\n\t                    if ( (reason = requestAccept()) ) {\n\t                        tr.trigger( 'error', reason, true );\n\t                        return;\n\t                    }\n\t\n\t                    // 全部上传完成。\n\t                    if ( file.remaning === 1 ) {\n\t                        me._finishFile( file, ret );\n\t                    } else {\n\t                        tr.destroy();\n\t                    }\n\t                });\n\t\n\t                // 配置默认的上传字段。\n\t                data = $.extend( data, {\n\t                    id: file.id,\n\t                    name: file.name,\n\t                    type: file.type,\n\t                    lastModifiedDate: file.lastModifiedDate,\n\t                    size: file.size\n\t                });\n\t\n\t                block.chunks > 1 && $.extend( data, {\n\t                    chunks: block.chunks,\n\t                    chunk: block.chunk\n\t                });\n\t\n\t                // 在发送之间可以添加字段什么的。。。\n\t                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n\t                owner.trigger( 'uploadBeforeSend', block, data, headers );\n\t\n\t                // 开始发送。\n\t                tr.appendBlob( opts.fileVal, block.blob, file.name );\n\t                tr.append( data );\n\t                tr.setRequestHeader( headers );\n\t                tr.send();\n\t            },\n\t\n\t            // 完成上传。\n\t            _finishFile: function( file, ret, hds ) {\n\t                var owner = this.owner;\n\t\n\t                return owner\n\t                        .request( 'after-send-file', arguments, function() {\n\t                            file.setStatus( Status.COMPLETE );\n\t                            owner.trigger( 'uploadSuccess', file, ret, hds );\n\t                        })\n\t                        .fail(function( reason ) {\n\t\n\t                            // 如果外部已经标记为invalid什么的，不再改状态。\n\t                            if ( file.getStatus() === Status.PROGRESS ) {\n\t                                file.setStatus( Status.ERROR, reason );\n\t                            }\n\t\n\t                            owner.trigger( 'uploadError', file, reason );\n\t                        })\n\t                        .always(function() {\n\t                            owner.trigger( 'uploadComplete', file );\n\t                        });\n\t            },\n\t\n\t            updateFileProgress: function(file) {\n\t                var totalPercent = 0,\n\t                    uploaded = 0;\n\t\n\t                if (!file.blocks) {\n\t                    return;\n\t                }\n\t\n\t                $.each( file.blocks, function( _, v ) {\n\t                    uploaded += (v.percentage || 0) * (v.end - v.start);\n\t                });\n\t\n\t                totalPercent = uploaded / file.size;\n\t                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n\t            }\n\t\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n\t     */\n\t\n\t    define('widgets/validator',[\n\t        'base',\n\t        'uploader',\n\t        'file',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, WUFile ) {\n\t\n\t        var $ = Base.$,\n\t            validators = {},\n\t            api;\n\t\n\t        /**\n\t         * @event error\n\t         * @param {String} type 错误类型。\n\t         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n\t         *\n\t         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n\t         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n\t         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n\t         * @for  Uploader\n\t         */\n\t\n\t        // 暴露给外面的api\n\t        api = {\n\t\n\t            // 添加验证器\n\t            addValidator: function( type, cb ) {\n\t                validators[ type ] = cb;\n\t            },\n\t\n\t            // 移除验证器\n\t            removeValidator: function( type ) {\n\t                delete validators[ type ];\n\t            }\n\t        };\n\t\n\t        // 在Uploader初始化的时候启动Validators的初始化\n\t        Uploader.register({\n\t            name: 'validator',\n\t\n\t            init: function() {\n\t                var me = this;\n\t                Base.nextTick(function() {\n\t                    $.each( validators, function() {\n\t                        this.call( me.owner );\n\t                    });\n\t                });\n\t            }\n\t        });\n\t\n\t        /**\n\t         * @property {int} [fileNumLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证文件总数量, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileNumLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                count = 0,\n\t                max = parseInt( opts.fileNumLimit, 10 ),\n\t                flag = true;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t\n\t                if ( count >= max && flag ) {\n\t                    flag = false;\n\t                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n\t                    setTimeout(function() {\n\t                        flag = true;\n\t                    }, 1 );\n\t                }\n\t\n\t                return count >= max ? false : true;\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function() {\n\t                count++;\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function() {\n\t                count--;\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                count = 0;\n\t            });\n\t        });\n\t\n\t\n\t        /**\n\t         * @property {int} [fileSizeLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileSizeLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                count = 0,\n\t                max = parseInt( opts.fileSizeLimit, 10 ),\n\t                flag = true;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t                var invalid = count + file.size > max;\n\t\n\t                if ( invalid && flag ) {\n\t                    flag = false;\n\t                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n\t                    setTimeout(function() {\n\t                        flag = true;\n\t                    }, 1 );\n\t                }\n\t\n\t                return invalid ? false : true;\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function( file ) {\n\t                count += file.size;\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function( file ) {\n\t                count -= file.size;\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                count = 0;\n\t            });\n\t        });\n\t\n\t        /**\n\t         * @property {int} [fileSingleSizeLimit=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n\t         */\n\t        api.addValidator( 'fileSingleSizeLimit', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                max = opts.fileSingleSizeLimit;\n\t\n\t            if ( !max ) {\n\t                return;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t\n\t                if ( file.size > max ) {\n\t                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n\t                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n\t                    return false;\n\t                }\n\t\n\t            });\n\t\n\t        });\n\t\n\t        /**\n\t         * @property {Boolean} [duplicate=undefined]\n\t         * @namespace options\n\t         * @for Uploader\n\t         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n\t         */\n\t        api.addValidator( 'duplicate', function() {\n\t            var uploader = this,\n\t                opts = uploader.options,\n\t                mapping = {};\n\t\n\t            if ( opts.duplicate ) {\n\t                return;\n\t            }\n\t\n\t            function hashString( str ) {\n\t                var hash = 0,\n\t                    i = 0,\n\t                    len = str.length,\n\t                    _char;\n\t\n\t                for ( ; i < len; i++ ) {\n\t                    _char = str.charCodeAt( i );\n\t                    hash = _char + (hash << 6) + (hash << 16) - hash;\n\t                }\n\t\n\t                return hash;\n\t            }\n\t\n\t            uploader.on( 'beforeFileQueued', function( file ) {\n\t                var hash = file.__hash || (file.__hash = hashString( file.name +\n\t                        file.size + file.lastModifiedDate ));\n\t\n\t                // 已经重复了\n\t                if ( mapping[ hash ] ) {\n\t                    this.trigger( 'error', 'F_DUPLICATE', file );\n\t                    return false;\n\t                }\n\t            });\n\t\n\t            uploader.on( 'fileQueued', function( file ) {\n\t                var hash = file.__hash;\n\t\n\t                hash && (mapping[ hash ] = true);\n\t            });\n\t\n\t            uploader.on( 'fileDequeued', function( file ) {\n\t                var hash = file.__hash;\n\t\n\t                hash && (delete mapping[ hash ]);\n\t            });\n\t\n\t            uploader.on( 'reset', function() {\n\t                mapping = {};\n\t            });\n\t        });\n\t\n\t        return api;\n\t    });\n\t\n\t    /**\n\t     * @fileOverview Md5\n\t     */\n\t    define('lib/md5',[\n\t        'runtime/client',\n\t        'mediator'\n\t    ], function( RuntimeClient, Mediator ) {\n\t\n\t        function Md5() {\n\t            RuntimeClient.call( this, 'Md5' );\n\t        }\n\t\n\t        // 让 Md5 具备事件功能。\n\t        Mediator.installTo( Md5.prototype );\n\t\n\t        Md5.prototype.loadFromBlob = function( blob ) {\n\t            var me = this;\n\t\n\t            if ( me.getRuid() ) {\n\t                me.disconnectRuntime();\n\t            }\n\t\n\t            // 连接到blob归属的同一个runtime.\n\t            me.connectRuntime( blob.ruid, function() {\n\t                me.exec('init');\n\t                me.exec( 'loadFromBlob', blob );\n\t            });\n\t        };\n\t\n\t        Md5.prototype.getResult = function() {\n\t            return this.exec('getResult');\n\t        };\n\t\n\t        return Md5;\n\t    });\n\t    /**\n\t     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n\t     */\n\t    define('widgets/md5',[\n\t        'base',\n\t        'uploader',\n\t        'lib/md5',\n\t        'lib/blob',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader, Md5, Blob ) {\n\t\n\t        return Uploader.register({\n\t            name: 'md5',\n\t\n\t\n\t            /**\n\t             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n\t             *\n\t             *\n\t             * @method md5File\n\t             * @grammar md5File( file[, start[, end]] ) => promise\n\t             * @for Uploader\n\t             * @example\n\t             *\n\t             * uploader.on( 'fileQueued', function( file ) {\n\t             *     var $li = ...;\n\t             *\n\t             *     uploader.md5File( file )\n\t             *\n\t             *         // 及时显示进度\n\t             *         .progress(function(percentage) {\n\t             *             console.log('Percentage:', percentage);\n\t             *         })\n\t             *\n\t             *         // 完成\n\t             *         .then(function(val) {\n\t             *             console.log('md5 result:', val);\n\t             *         });\n\t             *\n\t             * });\n\t             */\n\t            md5File: function( file, start, end ) {\n\t                var md5 = new Md5(),\n\t                    deferred = Base.Deferred(),\n\t                    blob = (file instanceof Blob) ? file :\n\t                        this.request( 'get-file', file ).source;\n\t\n\t                md5.on( 'progress load', function( e ) {\n\t                    e = e || {};\n\t                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n\t                });\n\t\n\t                md5.on( 'complete', function() {\n\t                    deferred.resolve( md5.getResult() );\n\t                });\n\t\n\t                md5.on( 'error', function( reason ) {\n\t                    deferred.reject( reason );\n\t                });\n\t\n\t                if ( arguments.length > 1 ) {\n\t                    start = start || 0;\n\t                    end = end || 0;\n\t                    start < 0 && (start = blob.size + start);\n\t                    end < 0 && (end = blob.size + end);\n\t                    end = Math.min( end, blob.size );\n\t                    blob = blob.slice( start, end );\n\t                }\n\t\n\t                md5.loadFromBlob( blob );\n\t\n\t                return deferred.promise();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n\t     */\n\t    define('runtime/compbase',[],function() {\n\t\n\t        function CompBase( owner, runtime ) {\n\t\n\t            this.owner = owner;\n\t            this.options = owner.options;\n\t\n\t            this.getRuntime = function() {\n\t                return runtime;\n\t            };\n\t\n\t            this.getRuid = function() {\n\t                return runtime.uid;\n\t            };\n\t\n\t            this.trigger = function() {\n\t                return owner.trigger.apply( owner, arguments );\n\t            };\n\t        }\n\t\n\t        return CompBase;\n\t    });\n\t    /**\n\t     * @fileOverview Html5Runtime\n\t     */\n\t    define('runtime/html5/runtime',[\n\t        'base',\n\t        'runtime/runtime',\n\t        'runtime/compbase'\n\t    ], function( Base, Runtime, CompBase ) {\n\t\n\t        var type = 'html5',\n\t            components = {};\n\t\n\t        function Html5Runtime() {\n\t            var pool = {},\n\t                me = this,\n\t                destroy = this.destroy;\n\t\n\t            Runtime.apply( me, arguments );\n\t            me.type = type;\n\t\n\t\n\t            // 这个方法的调用者，实际上是RuntimeClient\n\t            me.exec = function( comp, fn/*, args...*/) {\n\t                var client = this,\n\t                    uid = client.uid,\n\t                    args = Base.slice( arguments, 2 ),\n\t                    instance;\n\t\n\t                if ( components[ comp ] ) {\n\t                    instance = pool[ uid ] = pool[ uid ] ||\n\t                            new components[ comp ]( client, me );\n\t\n\t                    if ( instance[ fn ] ) {\n\t                        return instance[ fn ].apply( instance, args );\n\t                    }\n\t                }\n\t            };\n\t\n\t            me.destroy = function() {\n\t                // @todo 删除池子中的所有实例\n\t                return destroy && destroy.apply( this, arguments );\n\t            };\n\t        }\n\t\n\t        Base.inherits( Runtime, {\n\t            constructor: Html5Runtime,\n\t\n\t            // 不需要连接其他程序，直接执行callback\n\t            init: function() {\n\t                var me = this;\n\t                setTimeout(function() {\n\t                    me.trigger('ready');\n\t                }, 1 );\n\t            }\n\t\n\t        });\n\t\n\t        // 注册Components\n\t        Html5Runtime.register = function( name, component ) {\n\t            var klass = components[ name ] = Base.inherits( CompBase, component );\n\t            return klass;\n\t        };\n\t\n\t        // 注册html5运行时。\n\t        // 只有在支持的前提下注册。\n\t        if ( window.Blob && window.FileReader && window.DataView ) {\n\t            Runtime.addRuntime( type, Html5Runtime );\n\t        }\n\t\n\t        return Html5Runtime;\n\t    });\n\t    /**\n\t     * @fileOverview Blob Html实现\n\t     */\n\t    define('runtime/html5/blob',[\n\t        'runtime/html5/runtime',\n\t        'lib/blob'\n\t    ], function( Html5Runtime, Blob ) {\n\t\n\t        return Html5Runtime.register( 'Blob', {\n\t            slice: function( start, end ) {\n\t                var blob = this.owner.source,\n\t                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n\t\n\t                blob = slice.call( blob, start, end );\n\t\n\t                return new Blob( this.getRuid(), blob );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview FilePaste\n\t     */\n\t    define('runtime/html5/dnd',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'lib/file'\n\t    ], function( Base, Html5Runtime, File ) {\n\t\n\t        var $ = Base.$,\n\t            prefix = 'webuploader-dnd-';\n\t\n\t        return Html5Runtime.register( 'DragAndDrop', {\n\t            init: function() {\n\t                var elem = this.elem = this.options.container;\n\t\n\t                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n\t                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n\t                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n\t                this.dropHandler = Base.bindFn( this._dropHandler, this );\n\t                this.dndOver = false;\n\t\n\t                elem.on( 'dragenter', this.dragEnterHandler );\n\t                elem.on( 'dragover', this.dragOverHandler );\n\t                elem.on( 'dragleave', this.dragLeaveHandler );\n\t                elem.on( 'drop', this.dropHandler );\n\t\n\t                if ( this.options.disableGlobalDnd ) {\n\t                    $( document ).on( 'dragover', this.dragOverHandler );\n\t                    $( document ).on( 'drop', this.dropHandler );\n\t                }\n\t            },\n\t\n\t            _dragEnterHandler: function( e ) {\n\t                var me = this,\n\t                    denied = me._denied || false,\n\t                    items;\n\t\n\t                e = e.originalEvent || e;\n\t\n\t                if ( !me.dndOver ) {\n\t                    me.dndOver = true;\n\t\n\t                    // 注意只有 chrome 支持。\n\t                    items = e.dataTransfer.items;\n\t\n\t                    if ( items && items.length ) {\n\t                        me._denied = denied = !me.trigger( 'accept', items );\n\t                    }\n\t\n\t                    me.elem.addClass( prefix + 'over' );\n\t                    me.elem[ denied ? 'addClass' :\n\t                            'removeClass' ]( prefix + 'denied' );\n\t                }\n\t\n\t                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n\t\n\t                return false;\n\t            },\n\t\n\t            _dragOverHandler: function( e ) {\n\t                // 只处理框内的。\n\t                var parentElem = this.elem.parent().get( 0 );\n\t                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n\t                    return false;\n\t                }\n\t\n\t                clearTimeout( this._leaveTimer );\n\t                this._dragEnterHandler.call( this, e );\n\t\n\t                return false;\n\t            },\n\t\n\t            _dragLeaveHandler: function() {\n\t                var me = this,\n\t                    handler;\n\t\n\t                handler = function() {\n\t                    me.dndOver = false;\n\t                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n\t                };\n\t\n\t                clearTimeout( me._leaveTimer );\n\t                me._leaveTimer = setTimeout( handler, 100 );\n\t                return false;\n\t            },\n\t\n\t            _dropHandler: function( e ) {\n\t                var me = this,\n\t                    ruid = me.getRuid(),\n\t                    parentElem = me.elem.parent().get( 0 ),\n\t                    dataTransfer, data;\n\t\n\t                // 只处理框内的。\n\t                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n\t                    return false;\n\t                }\n\t\n\t                e = e.originalEvent || e;\n\t                dataTransfer = e.dataTransfer;\n\t\n\t                // 如果是页面内拖拽，还不能处理，不阻止事件。\n\t                // 此处 ie11 下会报参数错误，\n\t                try {\n\t                    data = dataTransfer.getData('text/html');\n\t                } catch( err ) {\n\t                }\n\t\n\t                if ( data ) {\n\t                    return;\n\t                }\n\t\n\t                me._getTansferFiles( dataTransfer, function( results ) {\n\t                    me.trigger( 'drop', $.map( results, function( file ) {\n\t                        return new File( ruid, file );\n\t                    }) );\n\t                });\n\t\n\t                me.dndOver = false;\n\t                me.elem.removeClass( prefix + 'over' );\n\t                return false;\n\t            },\n\t\n\t            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n\t            _getTansferFiles: function( dataTransfer, callback ) {\n\t                var results  = [],\n\t                    promises = [],\n\t                    items, files, file, item, i, len, canAccessFolder;\n\t\n\t                items = dataTransfer.items;\n\t                files = dataTransfer.files;\n\t\n\t                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n\t\n\t                for ( i = 0, len = files.length; i < len; i++ ) {\n\t                    file = files[ i ];\n\t                    item = items && items[ i ];\n\t\n\t                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n\t\n\t                        promises.push( this._traverseDirectoryTree(\n\t                                item.webkitGetAsEntry(), results ) );\n\t                    } else {\n\t                        results.push( file );\n\t                    }\n\t                }\n\t\n\t                Base.when.apply( Base, promises ).done(function() {\n\t\n\t                    if ( !results.length ) {\n\t                        return;\n\t                    }\n\t\n\t                    callback( results );\n\t                });\n\t            },\n\t\n\t            _traverseDirectoryTree: function( entry, results ) {\n\t                var deferred = Base.Deferred(),\n\t                    me = this;\n\t\n\t                if ( entry.isFile ) {\n\t                    entry.file(function( file ) {\n\t                        results.push( file );\n\t                        deferred.resolve();\n\t                    });\n\t                } else if ( entry.isDirectory ) {\n\t                    entry.createReader().readEntries(function( entries ) {\n\t                        var len = entries.length,\n\t                            promises = [],\n\t                            arr = [],    // 为了保证顺序。\n\t                            i;\n\t\n\t                        for ( i = 0; i < len; i++ ) {\n\t                            promises.push( me._traverseDirectoryTree(\n\t                                    entries[ i ], arr ) );\n\t                        }\n\t\n\t                        Base.when.apply( Base, promises ).then(function() {\n\t                            results.push.apply( results, arr );\n\t                            deferred.resolve();\n\t                        }, deferred.reject );\n\t                    });\n\t                }\n\t\n\t                return deferred.promise();\n\t            },\n\t\n\t            destroy: function() {\n\t                var elem = this.elem;\n\t\n\t                // 还没 init 就调用 destroy\n\t                if (!elem) {\n\t                    return;\n\t                }\n\t\n\t                elem.off( 'dragenter', this.dragEnterHandler );\n\t                elem.off( 'dragover', this.dragOverHandler );\n\t                elem.off( 'dragleave', this.dragLeaveHandler );\n\t                elem.off( 'drop', this.dropHandler );\n\t\n\t                if ( this.options.disableGlobalDnd ) {\n\t                    $( document ).off( 'dragover', this.dragOverHandler );\n\t                    $( document ).off( 'drop', this.dropHandler );\n\t                }\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview FilePaste\n\t     */\n\t    define('runtime/html5/filepaste',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'lib/file'\n\t    ], function( Base, Html5Runtime, File ) {\n\t\n\t        return Html5Runtime.register( 'FilePaste', {\n\t            init: function() {\n\t                var opts = this.options,\n\t                    elem = this.elem = opts.container,\n\t                    accept = '.*',\n\t                    arr, i, len, item;\n\t\n\t                // accetp的mimeTypes中生成匹配正则。\n\t                if ( opts.accept ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        item = opts.accept[ i ].mimeTypes;\n\t                        item && arr.push( item );\n\t                    }\n\t\n\t                    if ( arr.length ) {\n\t                        accept = arr.join(',');\n\t                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n\t                    }\n\t                }\n\t                this.accept = accept = new RegExp( accept, 'i' );\n\t                this.hander = Base.bindFn( this._pasteHander, this );\n\t                elem.on( 'paste', this.hander );\n\t            },\n\t\n\t            _pasteHander: function( e ) {\n\t                var allowed = [],\n\t                    ruid = this.getRuid(),\n\t                    items, item, blob, i, len;\n\t\n\t                e = e.originalEvent || e;\n\t                items = e.clipboardData.items;\n\t\n\t                for ( i = 0, len = items.length; i < len; i++ ) {\n\t                    item = items[ i ];\n\t\n\t                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n\t                        continue;\n\t                    }\n\t\n\t                    allowed.push( new File( ruid, blob ) );\n\t                }\n\t\n\t                if ( allowed.length ) {\n\t                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n\t                    e.preventDefault();\n\t                    e.stopPropagation();\n\t                    this.trigger( 'paste', allowed );\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.elem.off( 'paste', this.hander );\n\t            }\n\t        });\n\t    });\n\t\n\t    /**\n\t     * @fileOverview FilePicker\n\t     */\n\t    define('runtime/html5/filepicker',[\n\t        'base',\n\t        'runtime/html5/runtime'\n\t    ], function( Base, Html5Runtime ) {\n\t\n\t        var $ = Base.$;\n\t\n\t        return Html5Runtime.register( 'FilePicker', {\n\t            init: function() {\n\t                var container = this.getRuntime().getContainer(),\n\t                    me = this,\n\t                    owner = me.owner,\n\t                    opts = me.options,\n\t                    label = this.label = $( document.createElement('label') ),\n\t                    input =  this.input = $( document.createElement('input') ),\n\t                    arr, i, len, mouseHandler;\n\t\n\t                input.attr( 'type', 'file' );\n\t                //console.log(opts.name)\n\t                input.attr( 'name', 'file' );\n\t                input.addClass('webuploader-element-invisible');\n\t\n\t                label.on( 'click', function() {\n\t                    input.trigger('click');\n\t                });\n\t\n\t                label.css({\n\t                    opacity: 0,\n\t                    width: '100%',\n\t                    height: '100%',\n\t                    display: 'block',\n\t                    cursor: 'pointer',\n\t                    background: '#ffffff'\n\t                });\n\t\n\t                if ( opts.multiple ) {\n\t                    input.attr( 'multiple', 'multiple' );\n\t                }\n\t\n\t                // @todo Firefox不支持单独指定后缀\n\t                if ( opts.accept && opts.accept.length > 0 ) {\n\t                    arr = [];\n\t\n\t                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n\t                        arr.push( opts.accept[ i ].mimeTypes );\n\t                    }\n\t\n\t                    input.attr( 'accept', arr.join(',') );\n\t                }\n\t\n\t                container.append( input );\n\t                container.append( label );\n\t\n\t                mouseHandler = function( e ) {\n\t                    owner.trigger( e.type );\n\t                };\n\t\n\t                input.on( 'change', function( e ) {\n\t                    var fn = arguments.callee,\n\t                        clone;\n\t\n\t                    me.files = e.target.files;\n\t\n\t                    // reset input\n\t                    clone = this.cloneNode( true );\n\t                    clone.value = null;\n\t                    this.parentNode.replaceChild( clone, this );\n\t\n\t                    input.off();\n\t                    input = $( clone ).on( 'change', fn )\n\t                            .on( 'mouseenter mouseleave', mouseHandler );\n\t\n\t                    owner.trigger('change');\n\t                });\n\t\n\t                label.on( 'mouseenter mouseleave', mouseHandler );\n\t\n\t            },\n\t\n\t\n\t            getFiles: function() {\n\t                return this.files;\n\t            },\n\t\n\t            destroy: function() {\n\t                this.input.off();\n\t                this.label.off();\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * Terms:\n\t     *\n\t     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n\t     * @fileOverview Image控件\n\t     */\n\t    define('runtime/html5/util',[\n\t        'base'\n\t    ], function( Base ) {\n\t\n\t        var urlAPI = window.createObjectURL && window ||\n\t                window.URL && URL.revokeObjectURL && URL ||\n\t                window.webkitURL,\n\t            createObjectURL = Base.noop,\n\t            revokeObjectURL = createObjectURL;\n\t\n\t        if ( urlAPI ) {\n\t\n\t            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n\t            createObjectURL = function() {\n\t                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n\t            };\n\t\n\t            revokeObjectURL = function() {\n\t                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n\t            };\n\t        }\n\t\n\t        return {\n\t            createObjectURL: createObjectURL,\n\t            revokeObjectURL: revokeObjectURL,\n\t\n\t            dataURL2Blob: function( dataURI ) {\n\t                var byteStr, intArray, ab, i, mimetype, parts;\n\t\n\t                parts = dataURI.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    byteStr = atob( parts[ 1 ] );\n\t                } else {\n\t                    byteStr = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                ab = new ArrayBuffer( byteStr.length );\n\t                intArray = new Uint8Array( ab );\n\t\n\t                for ( i = 0; i < byteStr.length; i++ ) {\n\t                    intArray[ i ] = byteStr.charCodeAt( i );\n\t                }\n\t\n\t                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n\t\n\t                return this.arrayBufferToBlob( ab, mimetype );\n\t            },\n\t\n\t            dataURL2ArrayBuffer: function( dataURI ) {\n\t                var byteStr, intArray, i, parts;\n\t\n\t                parts = dataURI.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    byteStr = atob( parts[ 1 ] );\n\t                } else {\n\t                    byteStr = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                intArray = new Uint8Array( byteStr.length );\n\t\n\t                for ( i = 0; i < byteStr.length; i++ ) {\n\t                    intArray[ i ] = byteStr.charCodeAt( i );\n\t                }\n\t\n\t                return intArray.buffer;\n\t            },\n\t\n\t            arrayBufferToBlob: function( buffer, type ) {\n\t                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n\t                    bb;\n\t\n\t                // android不支持直接new Blob, 只能借助blobbuilder.\n\t                if ( builder ) {\n\t                    bb = new builder();\n\t                    bb.append( buffer );\n\t                    return bb.getBlob( type );\n\t                }\n\t\n\t                return new Blob([ buffer ], type ? { type: type } : {} );\n\t            },\n\t\n\t            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n\t            // 你得到的结果是png.\n\t            canvasToDataUrl: function( canvas, type, quality ) {\n\t                return canvas.toDataURL( type, quality / 100 );\n\t            },\n\t\n\t            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n\t            parseMeta: function( blob, callback ) {\n\t                callback( false, {});\n\t            },\n\t\n\t            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n\t            updateImageHead: function( data ) {\n\t                return data;\n\t            }\n\t        };\n\t    });\n\t    /**\n\t     * Terms:\n\t     *\n\t     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n\t     * @fileOverview Image控件\n\t     */\n\t    define('runtime/html5/imagemeta',[\n\t        'runtime/html5/util'\n\t    ], function( Util ) {\n\t\n\t        var api;\n\t\n\t        api = {\n\t            parsers: {\n\t                0xffe1: []\n\t            },\n\t\n\t            maxMetaDataSize: 262144,\n\t\n\t            parse: function( blob, cb ) {\n\t                var me = this,\n\t                    fr = new FileReader();\n\t\n\t                fr.onload = function() {\n\t                    cb( false, me._parse( this.result ) );\n\t                    fr = fr.onload = fr.onerror = null;\n\t                };\n\t\n\t                fr.onerror = function( e ) {\n\t                    cb( e.message );\n\t                    fr = fr.onload = fr.onerror = null;\n\t                };\n\t\n\t                blob = blob.slice( 0, me.maxMetaDataSize );\n\t                fr.readAsArrayBuffer( blob.getSource() );\n\t            },\n\t\n\t            _parse: function( buffer, noParse ) {\n\t                if ( buffer.byteLength < 6 ) {\n\t                    return;\n\t                }\n\t\n\t                var dataview = new DataView( buffer ),\n\t                    offset = 2,\n\t                    maxOffset = dataview.byteLength - 4,\n\t                    headLength = offset,\n\t                    ret = {},\n\t                    markerBytes, markerLength, parsers, i;\n\t\n\t                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n\t\n\t                    while ( offset < maxOffset ) {\n\t                        markerBytes = dataview.getUint16( offset );\n\t\n\t                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n\t                                markerBytes === 0xfffe ) {\n\t\n\t                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n\t\n\t                            if ( offset + markerLength > dataview.byteLength ) {\n\t                                break;\n\t                            }\n\t\n\t                            parsers = api.parsers[ markerBytes ];\n\t\n\t                            if ( !noParse && parsers ) {\n\t                                for ( i = 0; i < parsers.length; i += 1 ) {\n\t                                    parsers[ i ].call( api, dataview, offset,\n\t                                            markerLength, ret );\n\t                                }\n\t                            }\n\t\n\t                            offset += markerLength;\n\t                            headLength = offset;\n\t                        } else {\n\t                            break;\n\t                        }\n\t                    }\n\t\n\t                    if ( headLength > 6 ) {\n\t                        if ( buffer.slice ) {\n\t                            ret.imageHead = buffer.slice( 2, headLength );\n\t                        } else {\n\t                            // Workaround for IE10, which does not yet\n\t                            // support ArrayBuffer.slice:\n\t                            ret.imageHead = new Uint8Array( buffer )\n\t                                    .subarray( 2, headLength );\n\t                        }\n\t                    }\n\t                }\n\t\n\t                return ret;\n\t            },\n\t\n\t            updateImageHead: function( buffer, head ) {\n\t                var data = this._parse( buffer, true ),\n\t                    buf1, buf2, bodyoffset;\n\t\n\t\n\t                bodyoffset = 2;\n\t                if ( data.imageHead ) {\n\t                    bodyoffset = 2 + data.imageHead.byteLength;\n\t                }\n\t\n\t                if ( buffer.slice ) {\n\t                    buf2 = buffer.slice( bodyoffset );\n\t                } else {\n\t                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n\t                }\n\t\n\t                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n\t\n\t                buf1[ 0 ] = 0xFF;\n\t                buf1[ 1 ] = 0xD8;\n\t                buf1.set( new Uint8Array( head ), 2 );\n\t                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n\t\n\t                return buf1.buffer;\n\t            }\n\t        };\n\t\n\t        Util.parseMeta = function() {\n\t            return api.parse.apply( api, arguments );\n\t        };\n\t\n\t        Util.updateImageHead = function() {\n\t            return api.updateImageHead.apply( api, arguments );\n\t        };\n\t\n\t        return api;\n\t    });\n\t    /**\n\t     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n\t     * 暂时项目中只用了orientation.\n\t     *\n\t     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n\t     * @fileOverview EXIF解析\n\t     */\n\t\n\t    // Sample\n\t    // ====================================\n\t    // Make : Apple\n\t    // Model : iPhone 4S\n\t    // Orientation : 1\n\t    // XResolution : 72 [72/1]\n\t    // YResolution : 72 [72/1]\n\t    // ResolutionUnit : 2\n\t    // Software : QuickTime 7.7.1\n\t    // DateTime : 2013:09:01 22:53:55\n\t    // ExifIFDPointer : 190\n\t    // ExposureTime : 0.058823529411764705 [1/17]\n\t    // FNumber : 2.4 [12/5]\n\t    // ExposureProgram : Normal program\n\t    // ISOSpeedRatings : 800\n\t    // ExifVersion : 0220\n\t    // DateTimeOriginal : 2013:09:01 22:52:51\n\t    // DateTimeDigitized : 2013:09:01 22:52:51\n\t    // ComponentsConfiguration : YCbCr\n\t    // ShutterSpeedValue : 4.058893515764426\n\t    // ApertureValue : 2.5260688216892597 [4845/1918]\n\t    // BrightnessValue : -0.3126686601998395\n\t    // MeteringMode : Pattern\n\t    // Flash : Flash did not fire, compulsory flash mode\n\t    // FocalLength : 4.28 [107/25]\n\t    // SubjectArea : [4 values]\n\t    // FlashpixVersion : 0100\n\t    // ColorSpace : 1\n\t    // PixelXDimension : 2448\n\t    // PixelYDimension : 3264\n\t    // SensingMethod : One-chip color area sensor\n\t    // ExposureMode : 0\n\t    // WhiteBalance : Auto white balance\n\t    // FocalLengthIn35mmFilm : 35\n\t    // SceneCaptureType : Standard\n\t    define('runtime/html5/imagemeta/exif',[\n\t        'base',\n\t        'runtime/html5/imagemeta'\n\t    ], function( Base, ImageMeta ) {\n\t\n\t        var EXIF = {};\n\t\n\t        EXIF.ExifMap = function() {\n\t            return this;\n\t        };\n\t\n\t        EXIF.ExifMap.prototype.map = {\n\t            'Orientation': 0x0112\n\t        };\n\t\n\t        EXIF.ExifMap.prototype.get = function( id ) {\n\t            return this[ id ] || this[ this.map[ id ] ];\n\t        };\n\t\n\t        EXIF.exifTagTypes = {\n\t            // byte, 8-bit unsigned int:\n\t            1: {\n\t                getValue: function( dataView, dataOffset ) {\n\t                    return dataView.getUint8( dataOffset );\n\t                },\n\t                size: 1\n\t            },\n\t\n\t            // ascii, 8-bit byte:\n\t            2: {\n\t                getValue: function( dataView, dataOffset ) {\n\t                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n\t                },\n\t                size: 1,\n\t                ascii: true\n\t            },\n\t\n\t            // short, 16 bit int:\n\t            3: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint16( dataOffset, littleEndian );\n\t                },\n\t                size: 2\n\t            },\n\t\n\t            // long, 32 bit int:\n\t            4: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint32( dataOffset, littleEndian );\n\t                },\n\t                size: 4\n\t            },\n\t\n\t            // rational = two long values,\n\t            // first is numerator, second is denominator:\n\t            5: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getUint32( dataOffset, littleEndian ) /\n\t                        dataView.getUint32( dataOffset + 4, littleEndian );\n\t                },\n\t                size: 8\n\t            },\n\t\n\t            // slong, 32 bit signed int:\n\t            9: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getInt32( dataOffset, littleEndian );\n\t                },\n\t                size: 4\n\t            },\n\t\n\t            // srational, two slongs, first is numerator, second is denominator:\n\t            10: {\n\t                getValue: function( dataView, dataOffset, littleEndian ) {\n\t                    return dataView.getInt32( dataOffset, littleEndian ) /\n\t                        dataView.getInt32( dataOffset + 4, littleEndian );\n\t                },\n\t                size: 8\n\t            }\n\t        };\n\t\n\t        // undefined, 8-bit byte, value depending on field:\n\t        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n\t\n\t        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n\t                littleEndian ) {\n\t\n\t            var tagType = EXIF.exifTagTypes[ type ],\n\t                tagSize, dataOffset, values, i, str, c;\n\t\n\t            if ( !tagType ) {\n\t                Base.log('Invalid Exif data: Invalid tag type.');\n\t                return;\n\t            }\n\t\n\t            tagSize = tagType.size * length;\n\t\n\t            // Determine if the value is contained in the dataOffset bytes,\n\t            // or if the value at the dataOffset is a pointer to the actual data:\n\t            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n\t                    littleEndian ) : (offset + 8);\n\t\n\t            if ( dataOffset + tagSize > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid data offset.');\n\t                return;\n\t            }\n\t\n\t            if ( length === 1 ) {\n\t                return tagType.getValue( dataView, dataOffset, littleEndian );\n\t            }\n\t\n\t            values = [];\n\t\n\t            for ( i = 0; i < length; i += 1 ) {\n\t                values[ i ] = tagType.getValue( dataView,\n\t                        dataOffset + i * tagType.size, littleEndian );\n\t            }\n\t\n\t            if ( tagType.ascii ) {\n\t                str = '';\n\t\n\t                // Concatenate the chars:\n\t                for ( i = 0; i < values.length; i += 1 ) {\n\t                    c = values[ i ];\n\t\n\t                    // Ignore the terminating NULL byte(s):\n\t                    if ( c === '\\u0000' ) {\n\t                        break;\n\t                    }\n\t                    str += c;\n\t                }\n\t\n\t                return str;\n\t            }\n\t            return values;\n\t        };\n\t\n\t        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n\t                data ) {\n\t\n\t            var tag = dataView.getUint16( offset, littleEndian );\n\t            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n\t                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n\t                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n\t                    littleEndian );\n\t        };\n\t\n\t        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n\t                littleEndian, data ) {\n\t\n\t            var tagsNumber, dirEndOffset, i;\n\t\n\t            if ( dirOffset + 6 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid directory offset.');\n\t                return;\n\t            }\n\t\n\t            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n\t            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n\t\n\t            if ( dirEndOffset + 4 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid directory size.');\n\t                return;\n\t            }\n\t\n\t            for ( i = 0; i < tagsNumber; i += 1 ) {\n\t                this.parseExifTag( dataView, tiffOffset,\n\t                        dirOffset + 2 + 12 * i,    // tag offset\n\t                        littleEndian, data );\n\t            }\n\t\n\t            // Return the offset to the next directory:\n\t            return dataView.getUint32( dirEndOffset, littleEndian );\n\t        };\n\t\n\t        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n\t        //     var hexData,\n\t        //         i,\n\t        //         b;\n\t        //     if (!length || offset + length > dataView.byteLength) {\n\t        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n\t        //         return;\n\t        //     }\n\t        //     hexData = [];\n\t        //     for (i = 0; i < length; i += 1) {\n\t        //         b = dataView.getUint8(offset + i);\n\t        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n\t        //     }\n\t        //     return 'data:image/jpeg,%' + hexData.join('%');\n\t        // };\n\t\n\t        EXIF.parseExifData = function( dataView, offset, length, data ) {\n\t\n\t            var tiffOffset = offset + 10,\n\t                littleEndian, dirOffset;\n\t\n\t            // Check for the ASCII code for \"Exif\" (0x45786966):\n\t            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n\t                // No Exif data, might be XMP data instead\n\t                return;\n\t            }\n\t            if ( tiffOffset + 8 > dataView.byteLength ) {\n\t                Base.log('Invalid Exif data: Invalid segment size.');\n\t                return;\n\t            }\n\t\n\t            // Check for the two null bytes:\n\t            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n\t                Base.log('Invalid Exif data: Missing byte alignment offset.');\n\t                return;\n\t            }\n\t\n\t            // Check the byte alignment:\n\t            switch ( dataView.getUint16( tiffOffset ) ) {\n\t                case 0x4949:\n\t                    littleEndian = true;\n\t                    break;\n\t\n\t                case 0x4D4D:\n\t                    littleEndian = false;\n\t                    break;\n\t\n\t                default:\n\t                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n\t                    return;\n\t            }\n\t\n\t            // Check for the TIFF tag marker (0x002A):\n\t            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n\t                Base.log('Invalid Exif data: Missing TIFF marker.');\n\t                return;\n\t            }\n\t\n\t            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n\t            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n\t            // Create the exif object to store the tags:\n\t            data.exif = new EXIF.ExifMap();\n\t            // Parse the tags of the main image directory and retrieve the\n\t            // offset to the next directory, usually the thumbnail directory:\n\t            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n\t                    tiffOffset + dirOffset, littleEndian, data );\n\t\n\t            // 尝试读取缩略图\n\t            // if ( dirOffset ) {\n\t            //     thumbnailData = {exif: {}};\n\t            //     dirOffset = EXIF.parseExifTags(\n\t            //         dataView,\n\t            //         tiffOffset,\n\t            //         tiffOffset + dirOffset,\n\t            //         littleEndian,\n\t            //         thumbnailData\n\t            //     );\n\t\n\t            //     // Check for JPEG Thumbnail offset:\n\t            //     if (thumbnailData.exif[0x0201]) {\n\t            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n\t            //             dataView,\n\t            //             tiffOffset + thumbnailData.exif[0x0201],\n\t            //             thumbnailData.exif[0x0202] // Thumbnail data length\n\t            //         );\n\t            //     }\n\t            // }\n\t        };\n\t\n\t        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n\t        return EXIF;\n\t    });\n\t    /**\n\t     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n\t     * android里面toDataUrl('image/jpege')得到的结果却是png.\n\t     *\n\t     * 所以这里没辙，只能借助这个工具\n\t     * @fileOverview jpeg encoder\n\t     */\n\t    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n\t\n\t        /*\n\t          Copyright (c) 2008, Adobe Systems Incorporated\n\t          All rights reserved.\n\t\n\t          Redistribution and use in source and binary forms, with or without\n\t          modification, are permitted provided that the following conditions are\n\t          met:\n\t\n\t          * Redistributions of source code must retain the above copyright notice,\n\t            this list of conditions and the following disclaimer.\n\t\n\t          * Redistributions in binary form must reproduce the above copyright\n\t            notice, this list of conditions and the following disclaimer in the\n\t            documentation and/or other materials provided with the distribution.\n\t\n\t          * Neither the name of Adobe Systems Incorporated nor the names of its\n\t            contributors may be used to endorse or promote products derived from\n\t            this software without specific prior written permission.\n\t\n\t          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n\t          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n\t          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n\t          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n\t          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n\t          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n\t          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n\t          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n\t          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n\t          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n\t          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n\t        */\n\t        /*\n\t        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n\t\n\t        Basic GUI blocking jpeg encoder\n\t        */\n\t\n\t        function JPEGEncoder(quality) {\n\t          var self = this;\n\t            var fround = Math.round;\n\t            var ffloor = Math.floor;\n\t            var YTable = new Array(64);\n\t            var UVTable = new Array(64);\n\t            var fdtbl_Y = new Array(64);\n\t            var fdtbl_UV = new Array(64);\n\t            var YDC_HT;\n\t            var UVDC_HT;\n\t            var YAC_HT;\n\t            var UVAC_HT;\n\t\n\t            var bitcode = new Array(65535);\n\t            var category = new Array(65535);\n\t            var outputfDCTQuant = new Array(64);\n\t            var DU = new Array(64);\n\t            var byteout = [];\n\t            var bytenew = 0;\n\t            var bytepos = 7;\n\t\n\t            var YDU = new Array(64);\n\t            var UDU = new Array(64);\n\t            var VDU = new Array(64);\n\t            var clt = new Array(256);\n\t            var RGB_YUV_TABLE = new Array(2048);\n\t            var currentQuality;\n\t\n\t            var ZigZag = [\n\t                     0, 1, 5, 6,14,15,27,28,\n\t                     2, 4, 7,13,16,26,29,42,\n\t                     3, 8,12,17,25,30,41,43,\n\t                     9,11,18,24,31,40,44,53,\n\t                    10,19,23,32,39,45,52,54,\n\t                    20,22,33,38,46,51,55,60,\n\t                    21,34,37,47,50,56,59,61,\n\t                    35,36,48,49,57,58,62,63\n\t                ];\n\t\n\t            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n\t            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n\t            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n\t            var std_ac_luminance_values = [\n\t                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n\t                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n\t                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n\t                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n\t                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n\t                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n\t                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n\t                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n\t                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n\t                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n\t                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n\t                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n\t                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n\t                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n\t                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n\t                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n\t                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n\t                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n\t                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n\t                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n\t                    0xf9,0xfa\n\t                ];\n\t\n\t            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n\t            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n\t            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n\t            var std_ac_chrominance_values = [\n\t                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n\t                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n\t                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n\t                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n\t                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n\t                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n\t                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n\t                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n\t                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n\t                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n\t                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n\t                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n\t                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n\t                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n\t                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n\t                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n\t                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n\t                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n\t                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n\t                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n\t                    0xf9,0xfa\n\t                ];\n\t\n\t            function initQuantTables(sf){\n\t                    var YQT = [\n\t                        16, 11, 10, 16, 24, 40, 51, 61,\n\t                        12, 12, 14, 19, 26, 58, 60, 55,\n\t                        14, 13, 16, 24, 40, 57, 69, 56,\n\t                        14, 17, 22, 29, 51, 87, 80, 62,\n\t                        18, 22, 37, 56, 68,109,103, 77,\n\t                        24, 35, 55, 64, 81,104,113, 92,\n\t                        49, 64, 78, 87,103,121,120,101,\n\t                        72, 92, 95, 98,112,100,103, 99\n\t                    ];\n\t\n\t                    for (var i = 0; i < 64; i++) {\n\t                        var t = ffloor((YQT[i]*sf+50)/100);\n\t                        if (t < 1) {\n\t                            t = 1;\n\t                        } else if (t > 255) {\n\t                            t = 255;\n\t                        }\n\t                        YTable[ZigZag[i]] = t;\n\t                    }\n\t                    var UVQT = [\n\t                        17, 18, 24, 47, 99, 99, 99, 99,\n\t                        18, 21, 26, 66, 99, 99, 99, 99,\n\t                        24, 26, 56, 99, 99, 99, 99, 99,\n\t                        47, 66, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99,\n\t                        99, 99, 99, 99, 99, 99, 99, 99\n\t                    ];\n\t                    for (var j = 0; j < 64; j++) {\n\t                        var u = ffloor((UVQT[j]*sf+50)/100);\n\t                        if (u < 1) {\n\t                            u = 1;\n\t                        } else if (u > 255) {\n\t                            u = 255;\n\t                        }\n\t                        UVTable[ZigZag[j]] = u;\n\t                    }\n\t                    var aasf = [\n\t                        1.0, 1.387039845, 1.306562965, 1.175875602,\n\t                        1.0, 0.785694958, 0.541196100, 0.275899379\n\t                    ];\n\t                    var k = 0;\n\t                    for (var row = 0; row < 8; row++)\n\t                    {\n\t                        for (var col = 0; col < 8; col++)\n\t                        {\n\t                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n\t                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n\t                            k++;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                function computeHuffmanTbl(nrcodes, std_table){\n\t                    var codevalue = 0;\n\t                    var pos_in_table = 0;\n\t                    var HT = new Array();\n\t                    for (var k = 1; k <= 16; k++) {\n\t                        for (var j = 1; j <= nrcodes[k]; j++) {\n\t                            HT[std_table[pos_in_table]] = [];\n\t                            HT[std_table[pos_in_table]][0] = codevalue;\n\t                            HT[std_table[pos_in_table]][1] = k;\n\t                            pos_in_table++;\n\t                            codevalue++;\n\t                        }\n\t                        codevalue*=2;\n\t                    }\n\t                    return HT;\n\t                }\n\t\n\t                function initHuffmanTbl()\n\t                {\n\t                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n\t                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n\t                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n\t                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n\t                }\n\t\n\t                function initCategoryNumber()\n\t                {\n\t                    var nrlower = 1;\n\t                    var nrupper = 2;\n\t                    for (var cat = 1; cat <= 15; cat++) {\n\t                        //Positive numbers\n\t                        for (var nr = nrlower; nr<nrupper; nr++) {\n\t                            category[32767+nr] = cat;\n\t                            bitcode[32767+nr] = [];\n\t                            bitcode[32767+nr][1] = cat;\n\t                            bitcode[32767+nr][0] = nr;\n\t                        }\n\t                        //Negative numbers\n\t                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n\t                            category[32767+nrneg] = cat;\n\t                            bitcode[32767+nrneg] = [];\n\t                            bitcode[32767+nrneg][1] = cat;\n\t                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n\t                        }\n\t                        nrlower <<= 1;\n\t                        nrupper <<= 1;\n\t                    }\n\t                }\n\t\n\t                function initRGBYUVTable() {\n\t                    for(var i = 0; i < 256;i++) {\n\t                        RGB_YUV_TABLE[i]            =  19595 * i;\n\t                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n\t                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n\t                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n\t                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n\t                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n\t                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n\t                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n\t                    }\n\t                }\n\t\n\t                // IO functions\n\t                function writeBits(bs)\n\t                {\n\t                    var value = bs[0];\n\t                    var posval = bs[1]-1;\n\t                    while ( posval >= 0 ) {\n\t                        if (value & (1 << posval) ) {\n\t                            bytenew |= (1 << bytepos);\n\t                        }\n\t                        posval--;\n\t                        bytepos--;\n\t                        if (bytepos < 0) {\n\t                            if (bytenew == 0xFF) {\n\t                                writeByte(0xFF);\n\t                                writeByte(0);\n\t                            }\n\t                            else {\n\t                                writeByte(bytenew);\n\t                            }\n\t                            bytepos=7;\n\t                            bytenew=0;\n\t                        }\n\t                    }\n\t                }\n\t\n\t                function writeByte(value)\n\t                {\n\t                    byteout.push(clt[value]); // write char directly instead of converting later\n\t                }\n\t\n\t                function writeWord(value)\n\t                {\n\t                    writeByte((value>>8)&0xFF);\n\t                    writeByte((value   )&0xFF);\n\t                }\n\t\n\t                // DCT & quantization core\n\t                function fDCTQuant(data, fdtbl)\n\t                {\n\t                    var d0, d1, d2, d3, d4, d5, d6, d7;\n\t                    /* Pass 1: process rows. */\n\t                    var dataOff=0;\n\t                    var i;\n\t                    var I8 = 8;\n\t                    var I64 = 64;\n\t                    for (i=0; i<I8; ++i)\n\t                    {\n\t                        d0 = data[dataOff];\n\t                        d1 = data[dataOff+1];\n\t                        d2 = data[dataOff+2];\n\t                        d3 = data[dataOff+3];\n\t                        d4 = data[dataOff+4];\n\t                        d5 = data[dataOff+5];\n\t                        d6 = data[dataOff+6];\n\t                        d7 = data[dataOff+7];\n\t\n\t                        var tmp0 = d0 + d7;\n\t                        var tmp7 = d0 - d7;\n\t                        var tmp1 = d1 + d6;\n\t                        var tmp6 = d1 - d6;\n\t                        var tmp2 = d2 + d5;\n\t                        var tmp5 = d2 - d5;\n\t                        var tmp3 = d3 + d4;\n\t                        var tmp4 = d3 - d4;\n\t\n\t                        /* Even part */\n\t                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n\t                        var tmp13 = tmp0 - tmp3;\n\t                        var tmp11 = tmp1 + tmp2;\n\t                        var tmp12 = tmp1 - tmp2;\n\t\n\t                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n\t                        data[dataOff+4] = tmp10 - tmp11;\n\t\n\t                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n\t                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n\t                        data[dataOff+6] = tmp13 - z1;\n\t\n\t                        /* Odd part */\n\t                        tmp10 = tmp4 + tmp5; /* phase 2 */\n\t                        tmp11 = tmp5 + tmp6;\n\t                        tmp12 = tmp6 + tmp7;\n\t\n\t                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n\t                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n\t                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n\t                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n\t                        var z3 = tmp11 * 0.707106781; /* c4 */\n\t\n\t                        var z11 = tmp7 + z3;    /* phase 5 */\n\t                        var z13 = tmp7 - z3;\n\t\n\t                        data[dataOff+5] = z13 + z2; /* phase 6 */\n\t                        data[dataOff+3] = z13 - z2;\n\t                        data[dataOff+1] = z11 + z4;\n\t                        data[dataOff+7] = z11 - z4;\n\t\n\t                        dataOff += 8; /* advance pointer to next row */\n\t                    }\n\t\n\t                    /* Pass 2: process columns. */\n\t                    dataOff = 0;\n\t                    for (i=0; i<I8; ++i)\n\t                    {\n\t                        d0 = data[dataOff];\n\t                        d1 = data[dataOff + 8];\n\t                        d2 = data[dataOff + 16];\n\t                        d3 = data[dataOff + 24];\n\t                        d4 = data[dataOff + 32];\n\t                        d5 = data[dataOff + 40];\n\t                        d6 = data[dataOff + 48];\n\t                        d7 = data[dataOff + 56];\n\t\n\t                        var tmp0p2 = d0 + d7;\n\t                        var tmp7p2 = d0 - d7;\n\t                        var tmp1p2 = d1 + d6;\n\t                        var tmp6p2 = d1 - d6;\n\t                        var tmp2p2 = d2 + d5;\n\t                        var tmp5p2 = d2 - d5;\n\t                        var tmp3p2 = d3 + d4;\n\t                        var tmp4p2 = d3 - d4;\n\t\n\t                        /* Even part */\n\t                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n\t                        var tmp13p2 = tmp0p2 - tmp3p2;\n\t                        var tmp11p2 = tmp1p2 + tmp2p2;\n\t                        var tmp12p2 = tmp1p2 - tmp2p2;\n\t\n\t                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n\t                        data[dataOff+32] = tmp10p2 - tmp11p2;\n\t\n\t                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n\t                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n\t                        data[dataOff+48] = tmp13p2 - z1p2;\n\t\n\t                        /* Odd part */\n\t                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n\t                        tmp11p2 = tmp5p2 + tmp6p2;\n\t                        tmp12p2 = tmp6p2 + tmp7p2;\n\t\n\t                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n\t                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n\t                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n\t                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n\t                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n\t\n\t                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n\t                        var z13p2 = tmp7p2 - z3p2;\n\t\n\t                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n\t                        data[dataOff+24] = z13p2 - z2p2;\n\t                        data[dataOff+ 8] = z11p2 + z4p2;\n\t                        data[dataOff+56] = z11p2 - z4p2;\n\t\n\t                        dataOff++; /* advance pointer to next column */\n\t                    }\n\t\n\t                    // Quantize/descale the coefficients\n\t                    var fDCTQuant;\n\t                    for (i=0; i<I64; ++i)\n\t                    {\n\t                        // Apply the quantization and scaling factor & Round to nearest integer\n\t                        fDCTQuant = data[i]*fdtbl[i];\n\t                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n\t                        //outputfDCTQuant[i] = fround(fDCTQuant);\n\t\n\t                    }\n\t                    return outputfDCTQuant;\n\t                }\n\t\n\t                function writeAPP0()\n\t                {\n\t                    writeWord(0xFFE0); // marker\n\t                    writeWord(16); // length\n\t                    writeByte(0x4A); // J\n\t                    writeByte(0x46); // F\n\t                    writeByte(0x49); // I\n\t                    writeByte(0x46); // F\n\t                    writeByte(0); // = \"JFIF\",'\\0'\n\t                    writeByte(1); // versionhi\n\t                    writeByte(1); // versionlo\n\t                    writeByte(0); // xyunits\n\t                    writeWord(1); // xdensity\n\t                    writeWord(1); // ydensity\n\t                    writeByte(0); // thumbnwidth\n\t                    writeByte(0); // thumbnheight\n\t                }\n\t\n\t                function writeSOF0(width, height)\n\t                {\n\t                    writeWord(0xFFC0); // marker\n\t                    writeWord(17);   // length, truecolor YUV JPG\n\t                    writeByte(8);    // precision\n\t                    writeWord(height);\n\t                    writeWord(width);\n\t                    writeByte(3);    // nrofcomponents\n\t                    writeByte(1);    // IdY\n\t                    writeByte(0x11); // HVY\n\t                    writeByte(0);    // QTY\n\t                    writeByte(2);    // IdU\n\t                    writeByte(0x11); // HVU\n\t                    writeByte(1);    // QTU\n\t                    writeByte(3);    // IdV\n\t                    writeByte(0x11); // HVV\n\t                    writeByte(1);    // QTV\n\t                }\n\t\n\t                function writeDQT()\n\t                {\n\t                    writeWord(0xFFDB); // marker\n\t                    writeWord(132);    // length\n\t                    writeByte(0);\n\t                    for (var i=0; i<64; i++) {\n\t                        writeByte(YTable[i]);\n\t                    }\n\t                    writeByte(1);\n\t                    for (var j=0; j<64; j++) {\n\t                        writeByte(UVTable[j]);\n\t                    }\n\t                }\n\t\n\t                function writeDHT()\n\t                {\n\t                    writeWord(0xFFC4); // marker\n\t                    writeWord(0x01A2); // length\n\t\n\t                    writeByte(0); // HTYDCinfo\n\t                    for (var i=0; i<16; i++) {\n\t                        writeByte(std_dc_luminance_nrcodes[i+1]);\n\t                    }\n\t                    for (var j=0; j<=11; j++) {\n\t                        writeByte(std_dc_luminance_values[j]);\n\t                    }\n\t\n\t                    writeByte(0x10); // HTYACinfo\n\t                    for (var k=0; k<16; k++) {\n\t                        writeByte(std_ac_luminance_nrcodes[k+1]);\n\t                    }\n\t                    for (var l=0; l<=161; l++) {\n\t                        writeByte(std_ac_luminance_values[l]);\n\t                    }\n\t\n\t                    writeByte(1); // HTUDCinfo\n\t                    for (var m=0; m<16; m++) {\n\t                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n\t                    }\n\t                    for (var n=0; n<=11; n++) {\n\t                        writeByte(std_dc_chrominance_values[n]);\n\t                    }\n\t\n\t                    writeByte(0x11); // HTUACinfo\n\t                    for (var o=0; o<16; o++) {\n\t                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n\t                    }\n\t                    for (var p=0; p<=161; p++) {\n\t                        writeByte(std_ac_chrominance_values[p]);\n\t                    }\n\t                }\n\t\n\t                function writeSOS()\n\t                {\n\t                    writeWord(0xFFDA); // marker\n\t                    writeWord(12); // length\n\t                    writeByte(3); // nrofcomponents\n\t                    writeByte(1); // IdY\n\t                    writeByte(0); // HTY\n\t                    writeByte(2); // IdU\n\t                    writeByte(0x11); // HTU\n\t                    writeByte(3); // IdV\n\t                    writeByte(0x11); // HTV\n\t                    writeByte(0); // Ss\n\t                    writeByte(0x3f); // Se\n\t                    writeByte(0); // Bf\n\t                }\n\t\n\t                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n\t                    var EOB = HTAC[0x00];\n\t                    var M16zeroes = HTAC[0xF0];\n\t                    var pos;\n\t                    var I16 = 16;\n\t                    var I63 = 63;\n\t                    var I64 = 64;\n\t                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n\t                    //ZigZag reorder\n\t                    for (var j=0;j<I64;++j) {\n\t                        DU[ZigZag[j]]=DU_DCT[j];\n\t                    }\n\t                    var Diff = DU[0] - DC; DC = DU[0];\n\t                    //Encode DC\n\t                    if (Diff==0) {\n\t                        writeBits(HTDC[0]); // Diff might be 0\n\t                    } else {\n\t                        pos = 32767+Diff;\n\t                        writeBits(HTDC[category[pos]]);\n\t                        writeBits(bitcode[pos]);\n\t                    }\n\t                    //Encode ACs\n\t                    var end0pos = 63; // was const... which is crazy\n\t                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n\t                    //end0pos = first element in reverse order !=0\n\t                    if ( end0pos == 0) {\n\t                        writeBits(EOB);\n\t                        return DC;\n\t                    }\n\t                    var i = 1;\n\t                    var lng;\n\t                    while ( i <= end0pos ) {\n\t                        var startpos = i;\n\t                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n\t                        var nrzeroes = i-startpos;\n\t                        if ( nrzeroes >= I16 ) {\n\t                            lng = nrzeroes>>4;\n\t                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n\t                                writeBits(M16zeroes);\n\t                            nrzeroes = nrzeroes&0xF;\n\t                        }\n\t                        pos = 32767+DU[i];\n\t                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n\t                        writeBits(bitcode[pos]);\n\t                        i++;\n\t                    }\n\t                    if ( end0pos != I63 ) {\n\t                        writeBits(EOB);\n\t                    }\n\t                    return DC;\n\t                }\n\t\n\t                function initCharLookupTable(){\n\t                    var sfcc = String.fromCharCode;\n\t                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n\t                        clt[i] = sfcc(i);\n\t                    }\n\t                }\n\t\n\t                this.encode = function(image,quality) // image data object\n\t                {\n\t                    // var time_start = new Date().getTime();\n\t\n\t                    if(quality) setQuality(quality);\n\t\n\t                    // Initialize bit writer\n\t                    byteout = new Array();\n\t                    bytenew=0;\n\t                    bytepos=7;\n\t\n\t                    // Add JPEG headers\n\t                    writeWord(0xFFD8); // SOI\n\t                    writeAPP0();\n\t                    writeDQT();\n\t                    writeSOF0(image.width,image.height);\n\t                    writeDHT();\n\t                    writeSOS();\n\t\n\t\n\t                    // Encode 8x8 macroblocks\n\t                    var DCY=0;\n\t                    var DCU=0;\n\t                    var DCV=0;\n\t\n\t                    bytenew=0;\n\t                    bytepos=7;\n\t\n\t\n\t                    this.encode.displayName = \"_encode_\";\n\t\n\t                    var imageData = image.data;\n\t                    var width = image.width;\n\t                    var height = image.height;\n\t\n\t                    var quadWidth = width*4;\n\t                    var tripleWidth = width*3;\n\t\n\t                    var x, y = 0;\n\t                    var r, g, b;\n\t                    var start,p, col,row,pos;\n\t                    while(y < height){\n\t                        x = 0;\n\t                        while(x < quadWidth){\n\t                        start = quadWidth * y + x;\n\t                        p = start;\n\t                        col = -1;\n\t                        row = 0;\n\t\n\t                        for(pos=0; pos < 64; pos++){\n\t                            row = pos >> 3;// /8\n\t                            col = ( pos & 7 ) * 4; // %8\n\t                            p = start + ( row * quadWidth ) + col;\n\t\n\t                            if(y+row >= height){ // padding bottom\n\t                                p-= (quadWidth*(y+1+row-height));\n\t                            }\n\t\n\t                            if(x+col >= quadWidth){ // padding right\n\t                                p-= ((x+col) - quadWidth +4)\n\t                            }\n\t\n\t                            r = imageData[ p++ ];\n\t                            g = imageData[ p++ ];\n\t                            b = imageData[ p++ ];\n\t\n\t\n\t                            /* // calculate YUV values dynamically\n\t                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n\t                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n\t                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n\t                            */\n\t\n\t                            // use lookup table (slightly faster)\n\t                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n\t                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n\t                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n\t\n\t                        }\n\t\n\t                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n\t                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n\t                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n\t                        x+=32;\n\t                        }\n\t                        y+=8;\n\t                    }\n\t\n\t\n\t                    ////////////////////////////////////////////////////////////////\n\t\n\t                    // Do the bit alignment of the EOI marker\n\t                    if ( bytepos >= 0 ) {\n\t                        var fillbits = [];\n\t                        fillbits[1] = bytepos+1;\n\t                        fillbits[0] = (1<<(bytepos+1))-1;\n\t                        writeBits(fillbits);\n\t                    }\n\t\n\t                    writeWord(0xFFD9); //EOI\n\t\n\t                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n\t\n\t                    byteout = [];\n\t\n\t                    // benchmarking\n\t                    // var duration = new Date().getTime() - time_start;\n\t                    // console.log('Encoding time: '+ currentQuality + 'ms');\n\t                    //\n\t\n\t                    return jpegDataUri\n\t            }\n\t\n\t            function setQuality(quality){\n\t                if (quality <= 0) {\n\t                    quality = 1;\n\t                }\n\t                if (quality > 100) {\n\t                    quality = 100;\n\t                }\n\t\n\t                if(currentQuality == quality) return // don't recalc if unchanged\n\t\n\t                var sf = 0;\n\t                if (quality < 50) {\n\t                    sf = Math.floor(5000 / quality);\n\t                } else {\n\t                    sf = Math.floor(200 - quality*2);\n\t                }\n\t\n\t                initQuantTables(sf);\n\t                currentQuality = quality;\n\t                // console.log('Quality set to: '+quality +'%');\n\t            }\n\t\n\t            function init(){\n\t                // var time_start = new Date().getTime();\n\t                if(!quality) quality = 50;\n\t                // Create tables\n\t                initCharLookupTable()\n\t                initHuffmanTbl();\n\t                initCategoryNumber();\n\t                initRGBYUVTable();\n\t\n\t                setQuality(quality);\n\t                // var duration = new Date().getTime() - time_start;\n\t                // console.log('Initialization '+ duration + 'ms');\n\t            }\n\t\n\t            init();\n\t\n\t        }\n\t\n\t        JPEGEncoder.encode = function( data, quality ) {\n\t            var encoder = new JPEGEncoder( quality );\n\t\n\t            return encoder.encode( data );\n\t        }\n\t\n\t        return JPEGEncoder;\n\t    });\n\t    /**\n\t     * @fileOverview Fix android canvas.toDataUrl bug.\n\t     */\n\t    define('runtime/html5/androidpatch',[\n\t        'runtime/html5/util',\n\t        'runtime/html5/jpegencoder',\n\t        'base'\n\t    ], function( Util, encoder, Base ) {\n\t        var origin = Util.canvasToDataUrl,\n\t            supportJpeg;\n\t\n\t        Util.canvasToDataUrl = function( canvas, type, quality ) {\n\t            var ctx, w, h, fragement, parts;\n\t\n\t            // 非android手机直接跳过。\n\t            if ( !Base.os.android ) {\n\t                return origin.apply( null, arguments );\n\t            }\n\t\n\t            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n\t            // JPEG 前两位分别是：255, 216\n\t            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n\t                fragement = origin.apply( null, arguments );\n\t\n\t                parts = fragement.split(',');\n\t\n\t                if ( ~parts[ 0 ].indexOf('base64') ) {\n\t                    fragement = atob( parts[ 1 ] );\n\t                } else {\n\t                    fragement = decodeURIComponent( parts[ 1 ] );\n\t                }\n\t\n\t                fragement = fragement.substring( 0, 2 );\n\t\n\t                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n\t                        fragement.charCodeAt( 1 ) === 216;\n\t            }\n\t\n\t            // 只有在android环境下才修复\n\t            if ( type === 'image/jpeg' && !supportJpeg ) {\n\t                w = canvas.width;\n\t                h = canvas.height;\n\t                ctx = canvas.getContext('2d');\n\t\n\t                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n\t            }\n\t\n\t            return origin.apply( null, arguments );\n\t        };\n\t    });\n\t    /**\n\t     * @fileOverview Image\n\t     */\n\t    define('runtime/html5/image',[\n\t        'base',\n\t        'runtime/html5/runtime',\n\t        'runtime/html5/util'\n\t    ], function( Base, Html5Runtime, Util ) {\n\t\n\t        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n\t\n\t        return Html5Runtime.register( 'Image', {\n\t\n\t            // flag: 标记是否被修改过。\n\t            modified: false,\n\t\n\t            init: function() {\n\t                var me = this,\n\t                    img = new Image();\n\t\n\t                img.onload = function() {\n\t\n\t                    me._info = {\n\t                        type: me.type,\n\t                        width: this.width,\n\t                        height: this.height\n\t                    };\n\t\n\t                    // 读取meta信息。\n\t                    if ( !me._metas && 'image/jpeg' === me.type ) {\n\t                        Util.parseMeta( me._blob, function( error, ret ) {\n\t                            me._metas = ret;\n\t                            me.owner.trigger('load');\n\t                        });\n\t                    } else {\n\t                        me.owner.trigger('load');\n\t                    }\n\t                };\n\t\n\t                img.onerror = function() {\n\t                    me.owner.trigger('error');\n\t                };\n\t\n\t                me._img = img;\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var me = this,\n\t                    img = me._img;\n\t\n\t                me._blob = blob;\n\t                me.type = blob.type;\n\t                img.src = Util.createObjectURL( blob.getSource() );\n\t                me.owner.once( 'load', function() {\n\t                    Util.revokeObjectURL( img.src );\n\t                });\n\t            },\n\t\n\t            resize: function( width, height ) {\n\t                var canvas = this._canvas ||\n\t                        (this._canvas = document.createElement('canvas'));\n\t\n\t                this._resize( this._img, canvas, width, height );\n\t                this._blob = null;    // 没用了，可以删掉了。\n\t                this.modified = true;\n\t                this.owner.trigger( 'complete', 'resize' );\n\t            },\n\t\n\t            crop: function( x, y, w, h, s ) {\n\t                var cvs = this._canvas ||\n\t                        (this._canvas = document.createElement('canvas')),\n\t                    opts = this.options,\n\t                    img = this._img,\n\t                    iw = img.naturalWidth,\n\t                    ih = img.naturalHeight,\n\t                    orientation = this.getOrientation();\n\t\n\t                s = s || 1;\n\t\n\t                // todo 解决 orientation 的问题。\n\t                // values that require 90 degree rotation\n\t                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\t\n\t                //     switch ( orientation ) {\n\t                //         case 6:\n\t                //             tmp = x;\n\t                //             x = y;\n\t                //             y = iw * s - tmp - w;\n\t                //             console.log(ih * s, tmp, w)\n\t                //             break;\n\t                //     }\n\t\n\t                //     (w ^= h, h ^= w, w ^= h);\n\t                // }\n\t\n\t                cvs.width = w;\n\t                cvs.height = h;\n\t\n\t                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\t                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n\t\n\t                this._blob = null;    // 没用了，可以删掉了。\n\t                this.modified = true;\n\t                this.owner.trigger( 'complete', 'crop' );\n\t            },\n\t\n\t            getAsBlob: function( type ) {\n\t                var blob = this._blob,\n\t                    opts = this.options,\n\t                    canvas;\n\t\n\t                type = type || this.type;\n\t\n\t                // blob需要重新生成。\n\t                if ( this.modified || this.type !== type ) {\n\t                    canvas = this._canvas;\n\t\n\t                    if ( type === 'image/jpeg' ) {\n\t\n\t                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n\t\n\t                        if ( opts.preserveHeaders && this._metas &&\n\t                                this._metas.imageHead ) {\n\t\n\t                            blob = Util.dataURL2ArrayBuffer( blob );\n\t                            blob = Util.updateImageHead( blob,\n\t                                    this._metas.imageHead );\n\t                            blob = Util.arrayBufferToBlob( blob, type );\n\t                            return blob;\n\t                        }\n\t                    } else {\n\t                        blob = Util.canvasToDataUrl( canvas, type );\n\t                    }\n\t\n\t                    blob = Util.dataURL2Blob( blob );\n\t                }\n\t\n\t                return blob;\n\t            },\n\t\n\t            getAsDataUrl: function( type ) {\n\t                var opts = this.options;\n\t\n\t                type = type || this.type;\n\t\n\t                if ( type === 'image/jpeg' ) {\n\t                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n\t                } else {\n\t                    return this._canvas.toDataURL( type );\n\t                }\n\t            },\n\t\n\t            getOrientation: function() {\n\t                return this._metas && this._metas.exif &&\n\t                        this._metas.exif.get('Orientation') || 1;\n\t            },\n\t\n\t            info: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._info = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._info;\n\t            },\n\t\n\t            meta: function( val ) {\n\t\n\t                // setter\n\t                if ( val ) {\n\t                    this._meta = val;\n\t                    return this;\n\t                }\n\t\n\t                // getter\n\t                return this._meta;\n\t            },\n\t\n\t            destroy: function() {\n\t                var canvas = this._canvas;\n\t                this._img.onload = null;\n\t\n\t                if ( canvas ) {\n\t                    canvas.getContext('2d')\n\t                            .clearRect( 0, 0, canvas.width, canvas.height );\n\t                    canvas.width = canvas.height = 0;\n\t                    this._canvas = null;\n\t                }\n\t\n\t                // 释放内存。非常重要，否则释放不了image的内存。\n\t                this._img.src = BLANK;\n\t                this._img = this._blob = null;\n\t            },\n\t\n\t            _resize: function( img, cvs, width, height ) {\n\t                var opts = this.options,\n\t                    naturalWidth = img.width,\n\t                    naturalHeight = img.height,\n\t                    orientation = this.getOrientation(),\n\t                    scale, w, h, x, y;\n\t\n\t                // values that require 90 degree rotation\n\t                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\t\n\t                    // 交换width, height的值。\n\t                    width ^= height;\n\t                    height ^= width;\n\t                    width ^= height;\n\t                }\n\t\n\t                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n\t                        height / naturalHeight );\n\t\n\t                // 不允许放大。\n\t                opts.allowMagnify || (scale = Math.min( 1, scale ));\n\t\n\t                w = naturalWidth * scale;\n\t                h = naturalHeight * scale;\n\t\n\t                if ( opts.crop ) {\n\t                    cvs.width = width;\n\t                    cvs.height = height;\n\t                } else {\n\t                    cvs.width = w;\n\t                    cvs.height = h;\n\t                }\n\t\n\t                x = (cvs.width - w) / 2;\n\t                y = (cvs.height - h) / 2;\n\t\n\t                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\t\n\t                this._renderImageToCanvas( cvs, img, x, y, w, h );\n\t            },\n\t\n\t            _rotate2Orientaion: function( canvas, orientation ) {\n\t                var width = canvas.width,\n\t                    height = canvas.height,\n\t                    ctx = canvas.getContext('2d');\n\t\n\t                switch ( orientation ) {\n\t                    case 5:\n\t                    case 6:\n\t                    case 7:\n\t                    case 8:\n\t                        canvas.width = height;\n\t                        canvas.height = width;\n\t                        break;\n\t                }\n\t\n\t                switch ( orientation ) {\n\t                    case 2:    // horizontal flip\n\t                        ctx.translate( width, 0 );\n\t                        ctx.scale( -1, 1 );\n\t                        break;\n\t\n\t                    case 3:    // 180 rotate left\n\t                        ctx.translate( width, height );\n\t                        ctx.rotate( Math.PI );\n\t                        break;\n\t\n\t                    case 4:    // vertical flip\n\t                        ctx.translate( 0, height );\n\t                        ctx.scale( 1, -1 );\n\t                        break;\n\t\n\t                    case 5:    // vertical flip + 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.scale( 1, -1 );\n\t                        break;\n\t\n\t                    case 6:    // 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.translate( 0, -height );\n\t                        break;\n\t\n\t                    case 7:    // horizontal flip + 90 rotate right\n\t                        ctx.rotate( 0.5 * Math.PI );\n\t                        ctx.translate( width, -height );\n\t                        ctx.scale( -1, 1 );\n\t                        break;\n\t\n\t                    case 8:    // 90 rotate left\n\t                        ctx.rotate( -0.5 * Math.PI );\n\t                        ctx.translate( -width, 0 );\n\t                        break;\n\t                }\n\t            },\n\t\n\t            // https://github.com/stomita/ios-imagefile-megapixel/\n\t            // blob/master/src/megapix-image.js\n\t            _renderImageToCanvas: (function() {\n\t\n\t                // 如果不是ios, 不需要这么复杂！\n\t                if ( !Base.os.ios ) {\n\t                    return function( canvas ) {\n\t                        var args = Base.slice( arguments, 1 ),\n\t                            ctx = canvas.getContext('2d');\n\t\n\t                        ctx.drawImage.apply( ctx, args );\n\t                    };\n\t                }\n\t\n\t                /**\n\t                 * Detecting vertical squash in loaded image.\n\t                 * Fixes a bug which squash image vertically while drawing into\n\t                 * canvas for some images.\n\t                 */\n\t                function detectVerticalSquash( img, iw, ih ) {\n\t                    var canvas = document.createElement('canvas'),\n\t                        ctx = canvas.getContext('2d'),\n\t                        sy = 0,\n\t                        ey = ih,\n\t                        py = ih,\n\t                        data, alpha, ratio;\n\t\n\t\n\t                    canvas.width = 1;\n\t                    canvas.height = ih;\n\t                    ctx.drawImage( img, 0, 0 );\n\t                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n\t\n\t                    // search image edge pixel position in case\n\t                    // it is squashed vertically.\n\t                    while ( py > sy ) {\n\t                        alpha = data[ (py - 1) * 4 + 3 ];\n\t\n\t                        if ( alpha === 0 ) {\n\t                            ey = py;\n\t                        } else {\n\t                            sy = py;\n\t                        }\n\t\n\t                        py = (ey + sy) >> 1;\n\t                    }\n\t\n\t                    ratio = (py / ih);\n\t                    return (ratio === 0) ? 1 : ratio;\n\t                }\n\t\n\t                // fix ie7 bug\n\t                // http://stackoverflow.com/questions/11929099/\n\t                // html5-canvas-drawimage-ratio-bug-ios\n\t                if ( Base.os.ios >= 7 ) {\n\t                    return function( canvas, img, x, y, w, h ) {\n\t                        var iw = img.naturalWidth,\n\t                            ih = img.naturalHeight,\n\t                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n\t\n\t                        return canvas.getContext('2d').drawImage( img, 0, 0,\n\t                                iw * vertSquashRatio, ih * vertSquashRatio,\n\t                                x, y, w, h );\n\t                    };\n\t                }\n\t\n\t                /**\n\t                 * Detect subsampling in loaded image.\n\t                 * In iOS, larger images than 2M pixels may be\n\t                 * subsampled in rendering.\n\t                 */\n\t                function detectSubsampling( img ) {\n\t                    var iw = img.naturalWidth,\n\t                        ih = img.naturalHeight,\n\t                        canvas, ctx;\n\t\n\t                    // subsampling may happen overmegapixel image\n\t                    if ( iw * ih > 1024 * 1024 ) {\n\t                        canvas = document.createElement('canvas');\n\t                        canvas.width = canvas.height = 1;\n\t                        ctx = canvas.getContext('2d');\n\t                        ctx.drawImage( img, -iw + 1, 0 );\n\t\n\t                        // subsampled image becomes half smaller in rendering size.\n\t                        // check alpha channel value to confirm image is covering\n\t                        // edge pixel or not. if alpha value is 0\n\t                        // image is not covering, hence subsampled.\n\t                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n\t                    } else {\n\t                        return false;\n\t                    }\n\t                }\n\t\n\t\n\t                return function( canvas, img, x, y, width, height ) {\n\t                    var iw = img.naturalWidth,\n\t                        ih = img.naturalHeight,\n\t                        ctx = canvas.getContext('2d'),\n\t                        subsampled = detectSubsampling( img ),\n\t                        doSquash = this.type === 'image/jpeg',\n\t                        d = 1024,\n\t                        sy = 0,\n\t                        dy = 0,\n\t                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n\t\n\t                    if ( subsampled ) {\n\t                        iw /= 2;\n\t                        ih /= 2;\n\t                    }\n\t\n\t                    ctx.save();\n\t                    tmpCanvas = document.createElement('canvas');\n\t                    tmpCanvas.width = tmpCanvas.height = d;\n\t\n\t                    tmpCtx = tmpCanvas.getContext('2d');\n\t                    vertSquashRatio = doSquash ?\n\t                            detectVerticalSquash( img, iw, ih ) : 1;\n\t\n\t                    dw = Math.ceil( d * width / iw );\n\t                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n\t\n\t                    while ( sy < ih ) {\n\t                        sx = 0;\n\t                        dx = 0;\n\t                        while ( sx < iw ) {\n\t                            tmpCtx.clearRect( 0, 0, d, d );\n\t                            tmpCtx.drawImage( img, -sx, -sy );\n\t                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n\t                                    x + dx, y + dy, dw, dh );\n\t                            sx += d;\n\t                            dx += dw;\n\t                        }\n\t                        sy += d;\n\t                        dy += dh;\n\t                    }\n\t                    ctx.restore();\n\t                    tmpCanvas = tmpCtx = null;\n\t                };\n\t            })()\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Transport\n\t     * @todo 支持chunked传输，优势：\n\t     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n\t     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n\t     */\n\t    define('runtime/html5/transport',[\n\t        'base',\n\t        'runtime/html5/runtime'\n\t    ], function( Base, Html5Runtime ) {\n\t\n\t        var noop = Base.noop,\n\t            $ = Base.$;\n\t\n\t        return Html5Runtime.register( 'Transport', {\n\t            init: function() {\n\t                this._status = 0;\n\t                this._response = null;\n\t            },\n\t\n\t            send: function() {\n\t                var owner = this.owner,\n\t                    opts = this.options,\n\t                    xhr = this._initAjax(),\n\t                    blob = owner._blob,\n\t                    server = opts.server,\n\t                    formData, binary, fr;\n\t\n\t                if ( opts.sendAsBinary ) {\n\t                    server += (/\\?/.test( server ) ? '&' : '?') +\n\t                            $.param( owner._formData );\n\t\n\t                    binary = blob.getSource();\n\t                } else {\n\t                    formData = new FormData();\n\t                    $.each( owner._formData, function( k, v ) {\n\t                        formData.append( k, v );\n\t                    });\n\t\n\t                    formData.append( opts.fileVal, blob.getSource(),\n\t                            opts.filename || owner._formData.name || '' );\n\t                }\n\t\n\t                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n\t                    xhr.open( opts.method, server, true );\n\t                    xhr.withCredentials = true;\n\t                } else {\n\t                    xhr.open( opts.method, server );\n\t                }\n\t\n\t                this._setRequestHeader( xhr, opts.headers );\n\t\n\t                if ( binary ) {\n\t                    // 强制设置成 content-type 为文件流。\n\t                    xhr.overrideMimeType &&\n\t                            xhr.overrideMimeType('application/octet-stream');\n\t\n\t                    // android直接发送blob会导致服务端接收到的是空文件。\n\t                    // bug详情。\n\t                    // https://code.google.com/p/android/issues/detail?id=39882\n\t                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n\t                    if ( Base.os.android ) {\n\t                        fr = new FileReader();\n\t\n\t                        fr.onload = function() {\n\t                            xhr.send( this.result );\n\t                            fr = fr.onload = null;\n\t                        };\n\t\n\t                        fr.readAsArrayBuffer( binary );\n\t                    } else {\n\t                        xhr.send( binary );\n\t                    }\n\t                } else {\n\t                    xhr.send( formData );\n\t                }\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this._response;\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this._parseJson( this._response );\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this._status;\n\t            },\n\t\n\t            abort: function() {\n\t                var xhr = this._xhr;\n\t\n\t                if ( xhr ) {\n\t                    xhr.upload.onprogress = noop;\n\t                    xhr.onreadystatechange = noop;\n\t                    xhr.abort();\n\t\n\t                    this._xhr = xhr = null;\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.abort();\n\t            },\n\t\n\t            _initAjax: function() {\n\t                var me = this,\n\t                    xhr = new XMLHttpRequest(),\n\t                    opts = this.options;\n\t\n\t                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n\t                        typeof XDomainRequest !== 'undefined' ) {\n\t                    xhr = new XDomainRequest();\n\t                }\n\t\n\t                xhr.upload.onprogress = function( e ) {\n\t                    var percentage = 0;\n\t\n\t                    if ( e.lengthComputable ) {\n\t                        percentage = e.loaded / e.total;\n\t                    }\n\t\n\t                    return me.trigger( 'progress', percentage );\n\t                };\n\t\n\t                xhr.onreadystatechange = function() {\n\t\n\t                    if ( xhr.readyState !== 4 ) {\n\t                        return;\n\t                    }\n\t\n\t                    xhr.upload.onprogress = noop;\n\t                    xhr.onreadystatechange = noop;\n\t                    me._xhr = null;\n\t                    me._status = xhr.status;\n\t\n\t                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n\t                        me._response = xhr.responseText;\n\t                        return me.trigger('load');\n\t                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n\t                        me._response = xhr.responseText;\n\t                        return me.trigger( 'error', 'server' );\n\t                    }\n\t\n\t\n\t                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n\t                };\n\t\n\t                me._xhr = xhr;\n\t                return xhr;\n\t            },\n\t\n\t            _setRequestHeader: function( xhr, headers ) {\n\t                $.each( headers, function( key, val ) {\n\t                    xhr.setRequestHeader( key, val );\n\t                });\n\t            },\n\t\n\t            _parseJson: function( str ) {\n\t                var json;\n\t\n\t                try {\n\t                    json = JSON.parse( str );\n\t                } catch ( ex ) {\n\t                    json = {};\n\t                }\n\t\n\t                return json;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Transport flash实现\n\t     */\n\t    define('runtime/html5/md5',[\n\t        'runtime/html5/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        /*\n\t         * Fastest md5 implementation around (JKM md5)\n\t         * Credits: Joseph Myers\n\t         *\n\t         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n\t         * @see http://jsperf.com/md5-shootout/7\n\t         */\n\t\n\t        /* this function is much faster,\n\t          so if possible we use it. Some IEs\n\t          are the only ones I know of that\n\t          need the idiotic second function,\n\t          generated by an if clause.  */\n\t        var add32 = function (a, b) {\n\t            return (a + b) & 0xFFFFFFFF;\n\t        },\n\t\n\t        cmn = function (q, a, b, x, s, t) {\n\t            a = add32(add32(a, q), add32(x, t));\n\t            return add32((a << s) | (a >>> (32 - s)), b);\n\t        },\n\t\n\t        ff = function (a, b, c, d, x, s, t) {\n\t            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n\t        },\n\t\n\t        gg = function (a, b, c, d, x, s, t) {\n\t            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n\t        },\n\t\n\t        hh = function (a, b, c, d, x, s, t) {\n\t            return cmn(b ^ c ^ d, a, b, x, s, t);\n\t        },\n\t\n\t        ii = function (a, b, c, d, x, s, t) {\n\t            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n\t        },\n\t\n\t        md5cycle = function (x, k) {\n\t            var a = x[0],\n\t                b = x[1],\n\t                c = x[2],\n\t                d = x[3];\n\t\n\t            a = ff(a, b, c, d, k[0], 7, -680876936);\n\t            d = ff(d, a, b, c, k[1], 12, -389564586);\n\t            c = ff(c, d, a, b, k[2], 17, 606105819);\n\t            b = ff(b, c, d, a, k[3], 22, -1044525330);\n\t            a = ff(a, b, c, d, k[4], 7, -176418897);\n\t            d = ff(d, a, b, c, k[5], 12, 1200080426);\n\t            c = ff(c, d, a, b, k[6], 17, -1473231341);\n\t            b = ff(b, c, d, a, k[7], 22, -45705983);\n\t            a = ff(a, b, c, d, k[8], 7, 1770035416);\n\t            d = ff(d, a, b, c, k[9], 12, -1958414417);\n\t            c = ff(c, d, a, b, k[10], 17, -42063);\n\t            b = ff(b, c, d, a, k[11], 22, -1990404162);\n\t            a = ff(a, b, c, d, k[12], 7, 1804603682);\n\t            d = ff(d, a, b, c, k[13], 12, -40341101);\n\t            c = ff(c, d, a, b, k[14], 17, -1502002290);\n\t            b = ff(b, c, d, a, k[15], 22, 1236535329);\n\t\n\t            a = gg(a, b, c, d, k[1], 5, -165796510);\n\t            d = gg(d, a, b, c, k[6], 9, -1069501632);\n\t            c = gg(c, d, a, b, k[11], 14, 643717713);\n\t            b = gg(b, c, d, a, k[0], 20, -373897302);\n\t            a = gg(a, b, c, d, k[5], 5, -701558691);\n\t            d = gg(d, a, b, c, k[10], 9, 38016083);\n\t            c = gg(c, d, a, b, k[15], 14, -660478335);\n\t            b = gg(b, c, d, a, k[4], 20, -405537848);\n\t            a = gg(a, b, c, d, k[9], 5, 568446438);\n\t            d = gg(d, a, b, c, k[14], 9, -1019803690);\n\t            c = gg(c, d, a, b, k[3], 14, -187363961);\n\t            b = gg(b, c, d, a, k[8], 20, 1163531501);\n\t            a = gg(a, b, c, d, k[13], 5, -1444681467);\n\t            d = gg(d, a, b, c, k[2], 9, -51403784);\n\t            c = gg(c, d, a, b, k[7], 14, 1735328473);\n\t            b = gg(b, c, d, a, k[12], 20, -1926607734);\n\t\n\t            a = hh(a, b, c, d, k[5], 4, -378558);\n\t            d = hh(d, a, b, c, k[8], 11, -2022574463);\n\t            c = hh(c, d, a, b, k[11], 16, 1839030562);\n\t            b = hh(b, c, d, a, k[14], 23, -35309556);\n\t            a = hh(a, b, c, d, k[1], 4, -1530992060);\n\t            d = hh(d, a, b, c, k[4], 11, 1272893353);\n\t            c = hh(c, d, a, b, k[7], 16, -155497632);\n\t            b = hh(b, c, d, a, k[10], 23, -1094730640);\n\t            a = hh(a, b, c, d, k[13], 4, 681279174);\n\t            d = hh(d, a, b, c, k[0], 11, -358537222);\n\t            c = hh(c, d, a, b, k[3], 16, -722521979);\n\t            b = hh(b, c, d, a, k[6], 23, 76029189);\n\t            a = hh(a, b, c, d, k[9], 4, -640364487);\n\t            d = hh(d, a, b, c, k[12], 11, -421815835);\n\t            c = hh(c, d, a, b, k[15], 16, 530742520);\n\t            b = hh(b, c, d, a, k[2], 23, -995338651);\n\t\n\t            a = ii(a, b, c, d, k[0], 6, -198630844);\n\t            d = ii(d, a, b, c, k[7], 10, 1126891415);\n\t            c = ii(c, d, a, b, k[14], 15, -1416354905);\n\t            b = ii(b, c, d, a, k[5], 21, -57434055);\n\t            a = ii(a, b, c, d, k[12], 6, 1700485571);\n\t            d = ii(d, a, b, c, k[3], 10, -1894986606);\n\t            c = ii(c, d, a, b, k[10], 15, -1051523);\n\t            b = ii(b, c, d, a, k[1], 21, -2054922799);\n\t            a = ii(a, b, c, d, k[8], 6, 1873313359);\n\t            d = ii(d, a, b, c, k[15], 10, -30611744);\n\t            c = ii(c, d, a, b, k[6], 15, -1560198380);\n\t            b = ii(b, c, d, a, k[13], 21, 1309151649);\n\t            a = ii(a, b, c, d, k[4], 6, -145523070);\n\t            d = ii(d, a, b, c, k[11], 10, -1120210379);\n\t            c = ii(c, d, a, b, k[2], 15, 718787259);\n\t            b = ii(b, c, d, a, k[9], 21, -343485551);\n\t\n\t            x[0] = add32(a, x[0]);\n\t            x[1] = add32(b, x[1]);\n\t            x[2] = add32(c, x[2]);\n\t            x[3] = add32(d, x[3]);\n\t        },\n\t\n\t        /* there needs to be support for Unicode here,\n\t           * unless we pretend that we can redefine the MD-5\n\t           * algorithm for multi-byte characters (perhaps\n\t           * by adding every four 16-bit characters and\n\t           * shortening the sum to 32 bits). Otherwise\n\t           * I suggest performing MD-5 as if every character\n\t           * was two bytes--e.g., 0040 0025 = @%--but then\n\t           * how will an ordinary MD-5 sum be matched?\n\t           * There is no way to standardize text to something\n\t           * like UTF-8 before transformation; speed cost is\n\t           * utterly prohibitive. The JavaScript standard\n\t           * itself needs to look at this: it should start\n\t           * providing access to strings as preformed UTF-8\n\t           * 8-bit unsigned value arrays.\n\t           */\n\t        md5blk = function (s) {\n\t            var md5blks = [],\n\t                i; /* Andy King said do it this way. */\n\t\n\t            for (i = 0; i < 64; i += 4) {\n\t                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n\t            }\n\t            return md5blks;\n\t        },\n\t\n\t        md5blk_array = function (a) {\n\t            var md5blks = [],\n\t                i; /* Andy King said do it this way. */\n\t\n\t            for (i = 0; i < 64; i += 4) {\n\t                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n\t            }\n\t            return md5blks;\n\t        },\n\t\n\t        md51 = function (s) {\n\t            var n = s.length,\n\t                state = [1732584193, -271733879, -1732584194, 271733878],\n\t                i,\n\t                length,\n\t                tail,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            for (i = 64; i <= n; i += 64) {\n\t                md5cycle(state, md5blk(s.substring(i - 64, i)));\n\t            }\n\t            s = s.substring(i - 64);\n\t            length = s.length;\n\t            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n\t            }\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Beware that the final length might not fit in 32 bits so we take care of that\n\t            tmp = n * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t\n\t            md5cycle(state, tail);\n\t            return state;\n\t        },\n\t\n\t        md51_array = function (a) {\n\t            var n = a.length,\n\t                state = [1732584193, -271733879, -1732584194, 271733878],\n\t                i,\n\t                length,\n\t                tail,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            for (i = 64; i <= n; i += 64) {\n\t                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n\t            }\n\t\n\t            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n\t            // containing the last element of the parent array if the sub array specified starts\n\t            // beyond the length of the parent array - weird.\n\t            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n\t            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\t\n\t            length = a.length;\n\t            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n\t            }\n\t\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Beware that the final length might not fit in 32 bits so we take care of that\n\t            tmp = n * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t\n\t            md5cycle(state, tail);\n\t\n\t            return state;\n\t        },\n\t\n\t        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n\t\n\t        rhex = function (n) {\n\t            var s = '',\n\t                j;\n\t            for (j = 0; j < 4; j += 1) {\n\t                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n\t            }\n\t            return s;\n\t        },\n\t\n\t        hex = function (x) {\n\t            var i;\n\t            for (i = 0; i < x.length; i += 1) {\n\t                x[i] = rhex(x[i]);\n\t            }\n\t            return x.join('');\n\t        },\n\t\n\t        md5 = function (s) {\n\t            return hex(md51(s));\n\t        },\n\t\n\t\n\t\n\t        ////////////////////////////////////////////////////////////////////////////\n\t\n\t        /**\n\t         * SparkMD5 OOP implementation.\n\t         *\n\t         * Use this class to perform an incremental md5, otherwise use the\n\t         * static methods instead.\n\t         */\n\t        SparkMD5 = function () {\n\t            // call reset to init the instance\n\t            this.reset();\n\t        };\n\t\n\t\n\t        // In some cases the fast add32 function cannot be used..\n\t        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n\t            add32 = function (x, y) {\n\t                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n\t                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n\t                return (msw << 16) | (lsw & 0xFFFF);\n\t            };\n\t        }\n\t\n\t\n\t        /**\n\t         * Appends a string.\n\t         * A conversion will be applied if an utf8 string is detected.\n\t         *\n\t         * @param {String} str The string to be appended\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.append = function (str) {\n\t            // converts the string to utf8 bytes if necessary\n\t            if (/[\\u0080-\\uFFFF]/.test(str)) {\n\t                str = unescape(encodeURIComponent(str));\n\t            }\n\t\n\t            // then append as binary\n\t            this.appendBinary(str);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Appends a binary string.\n\t         *\n\t         * @param {String} contents The binary string to be appended\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.appendBinary = function (contents) {\n\t            this._buff += contents;\n\t            this._length += contents.length;\n\t\n\t            var length = this._buff.length,\n\t                i;\n\t\n\t            for (i = 64; i <= length; i += 64) {\n\t                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n\t            }\n\t\n\t            this._buff = this._buff.substr(i - 64);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Finishes the incremental computation, reseting the internal state and\n\t         * returning the result.\n\t         * Use the raw parameter to obtain the raw result instead of the hex one.\n\t         *\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.prototype.end = function (raw) {\n\t            var buff = this._buff,\n\t                length = buff.length,\n\t                i,\n\t                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t                ret;\n\t\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n\t            }\n\t\n\t            this._finish(tail, length);\n\t            ret = raw ? this._state : hex(this._state);\n\t\n\t            this.reset();\n\t\n\t            return ret;\n\t        };\n\t\n\t        /**\n\t         * Finish the final calculation based on the tail.\n\t         *\n\t         * @param {Array}  tail   The tail (will be modified)\n\t         * @param {Number} length The length of the remaining buffer\n\t         */\n\t        SparkMD5.prototype._finish = function (tail, length) {\n\t            var i = length,\n\t                tmp,\n\t                lo,\n\t                hi;\n\t\n\t            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n\t            if (i > 55) {\n\t                md5cycle(this._state, tail);\n\t                for (i = 0; i < 16; i += 1) {\n\t                    tail[i] = 0;\n\t                }\n\t            }\n\t\n\t            // Do the final computation based on the tail and length\n\t            // Beware that the final length may not fit in 32 bits so we take care of that\n\t            tmp = this._length * 8;\n\t            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n\t            lo = parseInt(tmp[2], 16);\n\t            hi = parseInt(tmp[1], 16) || 0;\n\t\n\t            tail[14] = lo;\n\t            tail[15] = hi;\n\t            md5cycle(this._state, tail);\n\t        };\n\t\n\t        /**\n\t         * Resets the internal state of the computation.\n\t         *\n\t         * @return {SparkMD5} The instance itself\n\t         */\n\t        SparkMD5.prototype.reset = function () {\n\t            this._buff = \"\";\n\t            this._length = 0;\n\t            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Releases memory used by the incremental buffer and other aditional\n\t         * resources. If you plan to use the instance again, use reset instead.\n\t         */\n\t        SparkMD5.prototype.destroy = function () {\n\t            delete this._state;\n\t            delete this._buff;\n\t            delete this._length;\n\t        };\n\t\n\t\n\t        /**\n\t         * Performs the md5 hash on a string.\n\t         * A conversion will be applied if utf8 string is detected.\n\t         *\n\t         * @param {String}  str The string\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.hash = function (str, raw) {\n\t            // converts the string to utf8 bytes if necessary\n\t            if (/[\\u0080-\\uFFFF]/.test(str)) {\n\t                str = unescape(encodeURIComponent(str));\n\t            }\n\t\n\t            var hash = md51(str);\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        /**\n\t         * Performs the md5 hash on a binary string.\n\t         *\n\t         * @param {String}  content The binary string\n\t         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.hashBinary = function (content, raw) {\n\t            var hash = md51(content);\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        /**\n\t         * SparkMD5 OOP implementation for array buffers.\n\t         *\n\t         * Use this class to perform an incremental md5 ONLY for array buffers.\n\t         */\n\t        SparkMD5.ArrayBuffer = function () {\n\t            // call reset to init the instance\n\t            this.reset();\n\t        };\n\t\n\t        ////////////////////////////////////////////////////////////////////////////\n\t\n\t        /**\n\t         * Appends an array buffer.\n\t         *\n\t         * @param {ArrayBuffer} arr The array to be appended\n\t         *\n\t         * @return {SparkMD5.ArrayBuffer} The instance itself\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n\t            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n\t            //       if you find yourself needing extra performance, please make a PR.\n\t            var buff = this._concatArrayBuffer(this._buff, arr),\n\t                length = buff.length,\n\t                i;\n\t\n\t            this._length += arr.byteLength;\n\t\n\t            for (i = 64; i <= length; i += 64) {\n\t                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n\t            }\n\t\n\t            // Avoids IE10 weirdness (documented above)\n\t            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Finishes the incremental computation, reseting the internal state and\n\t         * returning the result.\n\t         * Use the raw parameter to obtain the raw result instead of the hex one.\n\t         *\n\t         * @param {Boolean} raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n\t            var buff = this._buff,\n\t                length = buff.length,\n\t                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t                i,\n\t                ret;\n\t\n\t            for (i = 0; i < length; i += 1) {\n\t                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n\t            }\n\t\n\t            this._finish(tail, length);\n\t            ret = raw ? this._state : hex(this._state);\n\t\n\t            this.reset();\n\t\n\t            return ret;\n\t        };\n\t\n\t        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\t\n\t        /**\n\t         * Resets the internal state of the computation.\n\t         *\n\t         * @return {SparkMD5.ArrayBuffer} The instance itself\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.reset = function () {\n\t            this._buff = new Uint8Array(0);\n\t            this._length = 0;\n\t            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\t\n\t            return this;\n\t        };\n\t\n\t        /**\n\t         * Releases memory used by the incremental buffer and other aditional\n\t         * resources. If you plan to use the instance again, use reset instead.\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\t\n\t        /**\n\t         * Concats two array buffers, returning a new one.\n\t         *\n\t         * @param  {ArrayBuffer} first  The first array buffer\n\t         * @param  {ArrayBuffer} second The second array buffer\n\t         *\n\t         * @return {ArrayBuffer} The new array buffer\n\t         */\n\t        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n\t            var firstLength = first.length,\n\t                result = new Uint8Array(firstLength + second.byteLength);\n\t\n\t            result.set(first);\n\t            result.set(new Uint8Array(second), firstLength);\n\t\n\t            return result;\n\t        };\n\t\n\t        /**\n\t         * Performs the md5 hash on an array buffer.\n\t         *\n\t         * @param {ArrayBuffer} arr The array buffer\n\t         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n\t         *\n\t         * @return {String|Array} The result\n\t         */\n\t        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n\t            var hash = md51_array(new Uint8Array(arr));\n\t\n\t            return raw ? hash : hex(hash);\n\t        };\n\t\n\t        return FlashRuntime.register( 'Md5', {\n\t            init: function() {\n\t                // do nothing.\n\t            },\n\t\n\t            loadFromBlob: function( file ) {\n\t                var blob = file.getSource(),\n\t                    chunkSize = 2 * 1024 * 1024,\n\t                    chunks = Math.ceil( blob.size / chunkSize ),\n\t                    chunk = 0,\n\t                    owner = this.owner,\n\t                    spark = new SparkMD5.ArrayBuffer(),\n\t                    me = this,\n\t                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n\t                    loadNext, fr;\n\t\n\t                fr = new FileReader();\n\t\n\t                loadNext = function() {\n\t                    var start, end;\n\t\n\t                    start = chunk * chunkSize;\n\t                    end = Math.min( start + chunkSize, blob.size );\n\t\n\t                    fr.onload = function( e ) {\n\t                        spark.append( e.target.result );\n\t                        owner.trigger( 'progress', {\n\t                            total: file.size,\n\t                            loaded: end\n\t                        });\n\t                    };\n\t\n\t                    fr.onloadend = function() {\n\t                        fr.onloadend = fr.onload = null;\n\t\n\t                        if ( ++chunk < chunks ) {\n\t                            setTimeout( loadNext, 1 );\n\t                        } else {\n\t                            setTimeout(function(){\n\t                                owner.trigger('load');\n\t                                me.result = spark.end();\n\t                                loadNext = file = blob = spark = null;\n\t                                owner.trigger('complete');\n\t                            }, 50 );\n\t                        }\n\t                    };\n\t\n\t                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n\t                };\n\t\n\t                loadNext();\n\t            },\n\t\n\t            getResult: function() {\n\t                return this.result;\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview FlashRuntime\n\t     */\n\t    define('runtime/flash/runtime',[\n\t        'base',\n\t        'runtime/runtime',\n\t        'runtime/compbase'\n\t    ], function( Base, Runtime, CompBase ) {\n\t\n\t        var $ = Base.$,\n\t            type = 'flash',\n\t            components = {};\n\t\n\t\n\t        function getFlashVersion() {\n\t            var version;\n\t\n\t            try {\n\t                version = navigator.plugins[ 'Shockwave Flash' ];\n\t                version = version.description;\n\t            } catch ( ex ) {\n\t                try {\n\t                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n\t                            .GetVariable('$version');\n\t                } catch ( ex2 ) {\n\t                    version = '0.0';\n\t                }\n\t            }\n\t            version = version.match( /\\d+/g );\n\t            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n\t        }\n\t\n\t        function FlashRuntime() {\n\t            var pool = {},\n\t                clients = {},\n\t                destroy = this.destroy,\n\t                me = this,\n\t                jsreciver = Base.guid('webuploader_');\n\t\n\t            Runtime.apply( me, arguments );\n\t            me.type = type;\n\t\n\t\n\t            // 这个方法的调用者，实际上是RuntimeClient\n\t            me.exec = function( comp, fn/*, args...*/ ) {\n\t                var client = this,\n\t                    uid = client.uid,\n\t                    args = Base.slice( arguments, 2 ),\n\t                    instance;\n\t\n\t                clients[ uid ] = client;\n\t\n\t                if ( components[ comp ] ) {\n\t                    if ( !pool[ uid ] ) {\n\t                        pool[ uid ] = new components[ comp ]( client, me );\n\t                    }\n\t\n\t                    instance = pool[ uid ];\n\t\n\t                    if ( instance[ fn ] ) {\n\t                        return instance[ fn ].apply( instance, args );\n\t                    }\n\t                }\n\t\n\t                return me.flashExec.apply( client, arguments );\n\t            };\n\t\n\t            function handler( evt, obj ) {\n\t                var type = evt.type || evt,\n\t                    parts, uid;\n\t\n\t                parts = type.split('::');\n\t                uid = parts[ 0 ];\n\t                type = parts[ 1 ];\n\t\n\t                // console.log.apply( console, arguments );\n\t\n\t                if ( type === 'Ready' && uid === me.uid ) {\n\t                    me.trigger('ready');\n\t                } else if ( clients[ uid ] ) {\n\t                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n\t                }\n\t\n\t                // Base.log( evt, obj );\n\t            }\n\t\n\t            // flash的接受器。\n\t            window[ jsreciver ] = function() {\n\t                var args = arguments;\n\t\n\t                // 为了能捕获得到。\n\t                setTimeout(function() {\n\t                    handler.apply( null, args );\n\t                }, 1 );\n\t            };\n\t\n\t            this.jsreciver = jsreciver;\n\t\n\t            this.destroy = function() {\n\t                // @todo 删除池子中的所有实例\n\t                return destroy && destroy.apply( this, arguments );\n\t            };\n\t\n\t            this.flashExec = function( comp, fn ) {\n\t                var flash = me.getFlash(),\n\t                    args = Base.slice( arguments, 2 );\n\t\n\t                return flash.exec( this.uid, comp, fn, args );\n\t            };\n\t\n\t            // @todo\n\t        }\n\t\n\t        Base.inherits( Runtime, {\n\t            constructor: FlashRuntime,\n\t\n\t            init: function() {\n\t                var container = this.getContainer(),\n\t                    opts = this.options,\n\t                    html;\n\t\n\t                // if not the minimal height, shims are not initialized\n\t                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n\t                container.css({\n\t                    position: 'absolute',\n\t                    top: '-8px',\n\t                    left: '-8px',\n\t                    width: '9px',\n\t                    height: '9px',\n\t                    overflow: 'hidden'\n\t                });\n\t\n\t                // insert flash object\n\t                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n\t                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n\t\n\t                if ( Base.browser.ie ) {\n\t                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n\t                }\n\t\n\t                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n\t                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n\t                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n\t                    '&jsreciver=' + this.jsreciver + '\" />' +\n\t                    '<param name=\"wmode\" value=\"transparent\" />' +\n\t                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n\t                '</object>';\n\t\n\t                container.html( html );\n\t            },\n\t\n\t            getFlash: function() {\n\t                if ( this._flash ) {\n\t                    return this._flash;\n\t                }\n\t\n\t                this._flash = $( '#' + this.uid ).get( 0 );\n\t                return this._flash;\n\t            }\n\t\n\t        });\n\t\n\t        FlashRuntime.register = function( name, component ) {\n\t            component = components[ name ] = Base.inherits( CompBase, $.extend({\n\t\n\t                // @todo fix this later\n\t                flashExec: function() {\n\t                    var owner = this.owner,\n\t                        runtime = this.getRuntime();\n\t\n\t                    return runtime.flashExec.apply( owner, arguments );\n\t                }\n\t            }, component ) );\n\t\n\t            return component;\n\t        };\n\t\n\t        if ( getFlashVersion() >= 11.4 ) {\n\t            Runtime.addRuntime( type, FlashRuntime );\n\t        }\n\t\n\t        return FlashRuntime;\n\t    });\n\t    /**\n\t     * @fileOverview FilePicker\n\t     */\n\t    define('runtime/flash/filepicker',[\n\t        'base',\n\t        'runtime/flash/runtime'\n\t    ], function( Base, FlashRuntime ) {\n\t        var $ = Base.$;\n\t\n\t        return FlashRuntime.register( 'FilePicker', {\n\t            init: function( opts ) {\n\t                var copy = $.extend({}, opts ),\n\t                    len, i;\n\t\n\t                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n\t                len = copy.accept && copy.accept.length;\n\t                for (  i = 0; i < len; i++ ) {\n\t                    if ( !copy.accept[ i ].title ) {\n\t                        copy.accept[ i ].title = 'Files';\n\t                    }\n\t                }\n\t\n\t                delete copy.button;\n\t                delete copy.id;\n\t                delete copy.container;\n\t\n\t                this.flashExec( 'FilePicker', 'init', copy );\n\t            },\n\t\n\t            destroy: function() {\n\t                this.flashExec( 'FilePicker', 'destroy' );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 图片压缩\n\t     */\n\t    define('runtime/flash/image',[\n\t        'runtime/flash/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        return FlashRuntime.register( 'Image', {\n\t            // init: function( options ) {\n\t            //     var owner = this.owner;\n\t\n\t            //     this.flashExec( 'Image', 'init', options );\n\t            //     owner.on( 'load', function() {\n\t            //         debugger;\n\t            //     });\n\t            // },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                var owner = this.owner;\n\t\n\t                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n\t                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n\t\n\t                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Transport flash实现\n\t     */\n\t    define('runtime/flash/transport',[\n\t        'base',\n\t        'runtime/flash/runtime',\n\t        'runtime/client'\n\t    ], function( Base, FlashRuntime, RuntimeClient ) {\n\t        var $ = Base.$;\n\t\n\t        return FlashRuntime.register( 'Transport', {\n\t            init: function() {\n\t                this._status = 0;\n\t                this._response = null;\n\t                this._responseJson = null;\n\t            },\n\t\n\t            send: function() {\n\t                var owner = this.owner,\n\t                    opts = this.options,\n\t                    xhr = this._initAjax(),\n\t                    blob = owner._blob,\n\t                    server = opts.server,\n\t                    binary;\n\t\n\t                xhr.connectRuntime( blob.ruid );\n\t\n\t                if ( opts.sendAsBinary ) {\n\t                    server += (/\\?/.test( server ) ? '&' : '?') +\n\t                            $.param( owner._formData );\n\t\n\t                    binary = blob.uid;\n\t                } else {\n\t                    $.each( owner._formData, function( k, v ) {\n\t                        xhr.exec( 'append', k, v );\n\t                    });\n\t\n\t                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n\t                            opts.filename || owner._formData.name || '' );\n\t                }\n\t\n\t                this._setRequestHeader( xhr, opts.headers );\n\t                xhr.exec( 'send', {\n\t                    method: opts.method,\n\t                    url: server,\n\t                    forceURLStream: opts.forceURLStream,\n\t                    mimeType: 'application/octet-stream',\n\t                }, binary );\n\t            },\n\t\n\t            getStatus: function() {\n\t                return this._status;\n\t            },\n\t\n\t            getResponse: function() {\n\t                return this._response || '';\n\t            },\n\t\n\t            getResponseAsJson: function() {\n\t                return this._responseJson;\n\t            },\n\t\n\t            abort: function() {\n\t                var xhr = this._xhr;\n\t\n\t                if ( xhr ) {\n\t                    xhr.exec('abort');\n\t                    xhr.destroy();\n\t                    this._xhr = xhr = null;\n\t                }\n\t            },\n\t\n\t            destroy: function() {\n\t                this.abort();\n\t            },\n\t\n\t            _initAjax: function() {\n\t                var me = this,\n\t                    xhr = new RuntimeClient('XMLHttpRequest');\n\t\n\t                xhr.on( 'uploadprogress progress', function( e ) {\n\t                    var percent = e.loaded / e.total;\n\t                    percent = Math.min( 1, Math.max( 0, percent ) );\n\t                    return me.trigger( 'progress', percent );\n\t                });\n\t\n\t                xhr.on( 'load', function() {\n\t                    var status = xhr.exec('getStatus'),\n\t                        readBody = false,\n\t                        err = '',\n\t                        p;\n\t\n\t                    xhr.off();\n\t                    me._xhr = null;\n\t\n\t                    if ( status >= 200 && status < 300 ) {\n\t                        readBody = true;\n\t                    } else if ( status >= 500 && status < 600 ) {\n\t                        readBody = true;\n\t                        err = 'server';\n\t                    } else {\n\t                        err = 'http';\n\t                    }\n\t\n\t                    if ( readBody ) {\n\t                        me._response = xhr.exec('getResponse');\n\t                        me._response = decodeURIComponent( me._response );\n\t\n\t                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n\t                        // try {\n\t                        //     me._responseJson = xhr.exec('getResponseAsJson');\n\t                        // } catch ( error ) {\n\t\n\t                        p = window.JSON && window.JSON.parse || function( s ) {\n\t                            try {\n\t                                return new Function('return ' + s).call();\n\t                            } catch ( err ) {\n\t                                return {};\n\t                            }\n\t                        };\n\t                        me._responseJson  = me._response ? p(me._response) : {};\n\t\n\t                        // }\n\t                    }\n\t\n\t                    xhr.destroy();\n\t                    xhr = null;\n\t\n\t                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n\t                });\n\t\n\t                xhr.on( 'error', function() {\n\t                    xhr.off();\n\t                    me._xhr = null;\n\t                    me.trigger( 'error', 'http' );\n\t                });\n\t\n\t                me._xhr = xhr;\n\t                return xhr;\n\t            },\n\t\n\t            _setRequestHeader: function( xhr, headers ) {\n\t                $.each( headers, function( key, val ) {\n\t                    xhr.exec( 'setRequestHeader', key, val );\n\t                });\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Blob Html实现\n\t     */\n\t    define('runtime/flash/blob',[\n\t        'runtime/flash/runtime',\n\t        'lib/blob'\n\t    ], function( FlashRuntime, Blob ) {\n\t\n\t        return FlashRuntime.register( 'Blob', {\n\t            slice: function( start, end ) {\n\t                var blob = this.flashExec( 'Blob', 'slice', start, end );\n\t\n\t                return new Blob( blob.uid, blob );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview  Md5 flash实现\n\t     */\n\t    define('runtime/flash/md5',[\n\t        'runtime/flash/runtime'\n\t    ], function( FlashRuntime ) {\n\t\n\t        return FlashRuntime.register( 'Md5', {\n\t            init: function() {\n\t                // do nothing.\n\t            },\n\t\n\t            loadFromBlob: function( blob ) {\n\t                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview 完全版本。\n\t     */\n\t    define('preset/all',[\n\t        'base',\n\t\n\t        // widgets\n\t        'widgets/filednd',\n\t        'widgets/filepaste',\n\t        'widgets/filepicker',\n\t        'widgets/image',\n\t        'widgets/queue',\n\t        'widgets/runtime',\n\t        'widgets/upload',\n\t        'widgets/validator',\n\t        'widgets/md5',\n\t\n\t        // runtimes\n\t        // html5\n\t        'runtime/html5/blob',\n\t        'runtime/html5/dnd',\n\t        'runtime/html5/filepaste',\n\t        'runtime/html5/filepicker',\n\t        'runtime/html5/imagemeta/exif',\n\t        'runtime/html5/androidpatch',\n\t        'runtime/html5/image',\n\t        'runtime/html5/transport',\n\t        'runtime/html5/md5',\n\t\n\t        // flash\n\t        'runtime/flash/filepicker',\n\t        'runtime/flash/image',\n\t        'runtime/flash/transport',\n\t        'runtime/flash/blob',\n\t        'runtime/flash/md5'\n\t    ], function( Base ) {\n\t        return Base;\n\t    });\n\t    /**\n\t     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n\t     *\n\t     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n\t     *\n\t     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n\t     *\n\t     * 如：\n\t     * WebUploader.create({\n\t     *     ...\n\t     *\n\t     *     disableWidgets: 'log',\n\t     *\n\t     *     ...\n\t     * })\n\t     */\n\t    define('widgets/log',[\n\t        'base',\n\t        'uploader',\n\t        'widgets/widget'\n\t    ], function( Base, Uploader ) {\n\t        var $ = Base.$,\n\t            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n\t            product = (location.hostname || location.host || 'protected').toLowerCase(),\n\t\n\t            // 只针对 baidu 内部产品用户做统计功能。\n\t            enable = product && /baidu/i.exec(product),\n\t            base;\n\t\n\t        if (!enable) {\n\t            return;\n\t        }\n\t\n\t        base = {\n\t            dv: 3,\n\t            master: 'webuploader',\n\t            online: /test/.exec(product) ? 0 : 1,\n\t            module: '',\n\t            product: product,\n\t            type: 0\n\t        };\n\t\n\t        function send(data) {\n\t            var obj = $.extend({}, base, data),\n\t                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n\t                image = new Image();\n\t\n\t            image.src = url;\n\t        }\n\t\n\t        return Uploader.register({\n\t            name: 'log',\n\t\n\t            init: function() {\n\t                var owner = this.owner,\n\t                    count = 0,\n\t                    size = 0;\n\t\n\t                owner\n\t                    .on('error', function(code) {\n\t                        send({\n\t                            type: 2,\n\t                            c_error_code: code\n\t                        });\n\t                    })\n\t                    .on('uploadError', function(file, reason) {\n\t                        send({\n\t                            type: 2,\n\t                            c_error_code: 'UPLOAD_ERROR',\n\t                            c_reason: '' + reason\n\t                        });\n\t                    })\n\t                    .on('uploadComplete', function(file) {\n\t                        count++;\n\t                        size += file.size;\n\t                    }).\n\t                    on('uploadFinished', function() {\n\t                        send({\n\t                            c_count: count,\n\t                            c_size: size\n\t                        });\n\t                        count = size = 0;\n\t                    });\n\t\n\t                send({\n\t                    c_usage: 1\n\t                });\n\t            }\n\t        });\n\t    });\n\t    /**\n\t     * @fileOverview Uploader上传类\n\t     */\n\t    define('webuploader',[\n\t        'preset/all',\n\t        'widgets/log'\n\t    ], function( preset ) {\n\t        return preset;\n\t    });\n\t    return require('webuploader');\n\t});\n\t\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 87 */,\n/* 88 */,\n/* 89 */,\n/* 90 */,\n/* 91 */,\n/* 92 */,\n/* 93 */,\n/* 94 */,\n/* 95 */,\n/* 96 */,\n/* 97 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar tpl = __webpack_require__(98);\n\tvar Dialog = __webpack_require__(37);\n\t\n\tvar create = function create(data, options) {\n\t    var content = tpl(data || {}); // 显示编辑弹窗之前,需要自己拼装数据\n\t    options = options || {};\n\t\n\t    var defaults = {\n\t        title: '选择图片',\n\t        modal: true,\n\t        fixed: true,\n\t        content: content,\n\t        className: 'pop-box',\n\t        okValue: '插入图片',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        cancalValue: '取消',\n\t        btnWrapCls: 'insert-cancel'\n\t        /*function () {\n\t            // var value = $('#property-returnValue-demo').val();\n\t            // this.close(value);\n\t            // this.remove();\n\t        }*/\n\t    };\n\t    $.extend(true, defaults, options);\n\t    return Dialog(defaults);\n\t};\n\t\n\tmodule.exports = {\n\t    create: create\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 98 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/upload/content',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,maxlength=$data.maxlength,total=$data.total,$out='';$out+='<div data-node=\"uploadBox\"> <div class=\"pics-list-wrap clearfix\"> <ul class=\"pics-list clearfix\" data-node=\"uploadList\"> <li data-defaultAddFile=\\'picker\\'></li> </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"addNum\">';\n\t$out+=$escape(maxlength);\n\t$out+='</span><span class=\"deep-gray\">/';\n\t$out+=$escape(total);\n\t$out+='</span>张图片</div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 99 */,\n/* 100 */,\n/* 101 */,\n/* 102 */,\n/* 103 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t/**\n\t * 分享到 微信，QQ，微博，空间\n\t * @author Zhengchun Fu\n\t */\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar getQRCode = __webpack_require__(104);\n\tvar checkLoginStatus = __webpack_require__(23);\n\t\n\tvar APIS = {\n\t    qq: \"http://connect.qq.com/widget/shareqq/index.html\",\n\t    wb: \"http://v.t.sina.com.cn/share/share.php\",\n\t    qz: \"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey\"\n\t};\n\t\n\tvar defaultInfo = {\n\t    url: 'https://group.gomeplus.com/',\n\t    title: '国美APP边玩边分享，购物不孤单',\n\t    pic: '../../images/public/logo.png', // logo图片地址\n\t    summary: '国美APP边玩边分享，购物不孤单'\n\t};\n\t\n\tvar open = function open(url) {\n\t    window.open(url);\n\t};\n\t\n\t// 分享按钮渲染\n\tvar hasShareBtnsHTML = false;\n\tvar initShareBtns = function initShareBtns() {\n\t    var shareBtns = '<p data-node=\"shareBtnBox\" class=\"share-down\" style=\"z-index:21;\"><span class=\"share-box\"><span class=\"icon icon-up-arrow\"></span><span class=\"icon-box\"><em data-shareto=\"weixin\" class=\"iconn-30\"></em><em data-shareto=\"qq\" class=\"iconn-32\"></em><em data-shareto=\"sina\" class=\"iconn-31\"></em><em data-shareto=\"qzone\" class=\"iconn-33\"></em></span></span></p>';\n\t    $('body').append(shareBtns);\n\t    hasShareBtnsHTML = true;\n\t};\n\tvar showShareToBtns = function showShareToBtns(style) {\n\t    !hasShareBtnsHTML && initShareBtns();\n\t    $('[data-node=shareBtnBox]').css({\n\t        left: style.x,\n\t        top: style.y\n\t    }).show();\n\t};\n\t\n\t// 微信弹层渲染\n\tvar hasWeixinHTML = false;\n\tvar initWeixinHTML = function initWeixinHTML() {\n\t\n\t    var weixinBox = '<div class=\"share-weixin\"><div class=\"wx-mask\"></div><div class=\"wx-main\"><div class=\"wx-code\"><span></span><img data-node=\"shareWeixinCode\" alt=\"分享到微信\" /></div><p>打开微信扫一扫，即可分享</p><a href=\"javascript:;\" title=\"点击关闭\" class=\"wx-close\">×</a></div></div>';\n\t    $('body').append(weixinBox);\n\t    hasWeixinHTML = true;\n\t};\n\t\n\t// pics: 图片参数是否为pics，默认是pic。\n\tvar formatParams = function formatParams(p, pics) {\n\t    var s = [];\n\t    var data = {\n\t        title: p.title,\n\t        url: p.url,\n\t        summary: p.summary,\n\t        //desc: p.desc,\n\t        site: p.site\n\t    };\n\t\n\t    for (var i in data) {\n\t        s.push(i + '=' + encodeURIComponent(data[i] || ''));\n\t    }\n\t    if (pics) {\n\t        s.push('pics=' + p.pic);\n\t    } else {\n\t        s.push('pic=' + p.pic);\n\t    }\n\t    return s.join('&');\n\t};\n\t\n\t// 单个调用方法\n\t// 分享的图片多个用||隔开。\n\tvar shareTo = {\n\t    weixin: function weixin(options) {\n\t        var link = getQRCode(options.url);\n\t        !hasWeixinHTML && initWeixinHTML();\n\t\n\t        $('[data-node=shareWeixinCode]')[0].src = link;\n\t        $('.share-weixin').show();\n\t        $('.wx-close').on('click', function () {\n\t            $('.share-weixin').hide();\n\t        });\n\t    },\n\t    qq: function qq(options) {\n\t        var link = APIS.qq + '?' + formatParams(options, true);\n\t        open(link);\n\t    },\n\t    wb: function wb(options) {\n\t        var link = APIS.wb + '?' + formatParams(options);\n\t        open(link);\n\t    },\n\t    qz: function qz(options) {\n\t        var link = APIS.qz + '?' + formatParams(options, true);\n\t        open(link);\n\t    }\n\t};\n\t\n\t// share with kid\n\tvar shareWithKid = function shareWithKid(args) {\n\t    var isRebate = args.isRebate === '0' ? false : true;\n\t    fetch.get(url.get('shareGetGoodsKid'), {\n\t        validate: isRebate,\n\t        data: {\n\t            skuId: args.skuId,\n\t            itemId: args.itemId,\n\t            parentKid: args.parentKid\n\t        },\n\t        async: false // 防止新窗口被拦截\n\t    }).done(function (data) {\n\t        if (data.success === true) {\n\t            var kid = data.data.kid;\n\t            var shareInfo = args.shareInfo;\n\t            // 替换分享链接\n\t            // 规则：mall_domain+product/shopid-productId.html?onlineUserId=xxxx&kid=xxxx\n\t            var url = shareInfo.url;\n\t            var index = url.indexOf('?');\n\t            if (index > 0) {\n\t                url = url.substring(0, index);\n\t            }\n\t            shareInfo.url = url + '?onlineUserId=' + shareInfo.onlineUserId + '&kId=' + kid;\n\t            shareTo[args.shareto](shareInfo);\n\t        } else {\n\t            shareTo[args.shareto](args.shareInfo);\n\t        }\n\t    }).fail(function () {\n\t        if (isRebate) {\n\t            if (checkLoginStatus()) {\n\t                shareTo[args.shareto](args.shareInfo);\n\t            }\n\t        } else {\n\t            shareTo[args.shareto](args.shareInfo);\n\t        }\n\t    });\n\t};\n\t\n\t// 统一方法\n\tvar go = function go(obj) {\n\t    // {type:x,title:x,url:x,pic:x}\n\t    var info = {\n\t        title: obj.title || defaultInfo.title,\n\t        url: obj.url || defaultInfo.url,\n\t        pic: obj.pic || defaultInfo.pic,\n\t        summary: obj.summary || '',\n\t        desc: obj.desc || ''\n\t    };\n\t\n\t    !!shareTo[obj.type] && shareTo[obj.type](info);\n\t};\n\t\n\t/**\n\t * 简化分享\n\t * @param  {str} [parent] [容器节点]\n\t * @param {str} [selector] [子节点选择器]\n\t */\n\tvar shareItem = function shareItem(parent, selector, beforeShare) {\n\t    var shareInfo = null;\n\t    var $item = null;\n\t    $item = typeof parent === 'string' ? $(parent) : parent;\n\t    selector = selector || '[data-action=shareto]';\n\t    // 显示分享按钮\n\t    $item.on('mouseenter', selector, function () {\n\t        var shareUrl = $(this).data('surl');\n\t        var shareTitle = $(this).data('stitle');\n\t        var sharePic = $(this).data('spic');\n\t\n\t        shareInfo = {\n\t            url: shareUrl,\n\t            title: shareTitle,\n\t            pic: sharePic\n\t        };\n\t\n\t        var pw = $(this).width();\n\t        var ph = $(this).height();\n\t        var px = $(this).offset().left / 1 + pw / 2 - 80 + 'px';\n\t        var py = $(this).offset().top / 1 + (ph - 1) + 'px';\n\t\n\t        showShareToBtns({\n\t            x: px,\n\t            y: py\n\t        });\n\t        return false;\n\t    });\n\t    // 隐藏分享按钮\n\t    $item.on('mouseleave', selector, function () {\n\t        $('[data-node=shareBtnBox]').hide();\n\t        return false;\n\t    });\n\t\n\t    $('body').on('click', '[data-shareto]', function (e) {\n\t        e.preventDefault();\n\t        var shareType = $(this).data('shareto');\n\t        shareInfo.type = shareType;\n\t        beforeShare = beforeShare || function () {};\n\t        beforeShare.call(null, shareInfo);\n\t        go(shareInfo);\n\t    });\n\t\n\t    $('body').on('mouseenter', '[data-node=shareBtnBox]', function () {\n\t        $(this).show();\n\t    });\n\t    $('body').on('mouseleave', '[data-node=shareBtnBox]', function () {\n\t        $(this).hide();\n\t    });\n\t};\n\t\n\tmodule.exports = {\n\t    share: go,\n\t    shareto: shareTo,\n\t    shareItem: shareItem,\n\t    shareWithKid: shareWithKid\n\t};\n\t\n\t/**\n\t * 分享到 使用说明\n\t * 在[data-action=shareto]节点上输出要获取的数据\n\t * data-surl,data-stitle,data-spic\n\t * url要是绝对地址，带https?://的\n\t * pic是要分享的图片绝对地址，多张图片用||隔开。\n\t *\n\t * 页面中在分享按钮加 [data-action=shareto] 自定义属性；\n\t * 如果是分享当前页面的也要加shareInfo,值为当前页面对应的信息。格式都一样。\n\t *\n\t * 调用方法:\n\t * var share = require(..);\n\t * share.shareItem(要分享的区域父节点字符串e.g. 'data-node=shareList');\n\t *\n\t * shareto.weixin({shareInfo})\n\t * shareto.qq({shareInfo})\n\t * shareto.sina({shareInfo})\n\t * shareto.qzone({shareInfo})\n\t *\n\t *\n\t * share.share({shareInfo});这个shareInfo里要有type：[weixin,qq,sina,qzone]\n\t */\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 104 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\t// 根据字符串生成二维码\n\tvar getQRCode = function getQRCode(url) {\n\t    return $_CONFIG.group_domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(url);\n\t};\n\t\n\tmodule.exports = getQRCode;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 105 */,\n/* 106 */,\n/* 107 */,\n/* 108 */,\n/* 109 */,\n/* 110 */,\n/* 111 */,\n/* 112 */,\n/* 113 */,\n/* 114 */,\n/* 115 */,\n/* 116 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar uploadPop = __webpack_require__(97),\n\t    Pubsub = __webpack_require__(45),\n\t    pubName = __webpack_require__(100);\n\tvar upload = __webpack_require__(117);\n\tvar alert = __webpack_require__(36);\n\tvar imgReplace = __webpack_require__(118);\n\t\n\tvar init = function init(maxLen, total) {\n\t    var dialogUploader,\n\t        $webUpLoader,\n\t        maxlength = maxLen;\n\t    if (maxlength > 0) {\n\t\n\t        dialogUploader = uploadPop.create({\n\t            maxlength: maxlength,\n\t            total: total\n\t        }, {\n\t            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n\t            ok: function ok() {\n\t                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n\t                    return false;\n\t                }\n\t                $('[data-node=\"uploadList\"]').off();\n\t                $webUpLoader.destroy();\n\t                var $imgList = $('[data-node=\"uploadList\"] img'),\n\t                    images = [];\n\t                for (var i = 0, len = $imgList.length; i < len; i++) {\n\t                    images.push($imgList.eq(i).attr('src'));\n\t                }\n\t                //maxLen -= images.length;\n\t                Pubsub(pubName.setPubliser.changeImage).pub({\n\t                    images: images\n\t                });\n\t                $('[data-node=picPopBox]').hide();\n\t            },\n\t            cancel: function cancel() {\n\t                $('[data-node=\"uploadList\"]').off();\n\t                $webUpLoader.destroy();\n\t                $('[data-node=picPopBox]').hide();\n\t            }\n\t        });\n\t\n\t        $webUpLoader = upload.init({\n\t            maxlength: maxlength,\n\t            callbacks: {\n\t                onFileQueued: function onFileQueued(file, numList, number) {\n\t                    var $uploadBox = $('[data-node=\"uploadBox\"]');\n\t                    var picker = '[data-defaultaddfile=\"picker\"]';\n\t                    $('[data-node=picPopBox]').addClass('webuploader-element-invisible');\n\t                    dialogUploader.show();\n\t                    $uploadBox.find(picker).children().eq(0).html('<em class=\"icon-add\"></em>');\n\t                    var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n\t                    $uploadBox.find(picker).before(html);\n\t                    $uploadBox.find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\t                    if (numList[file.source.ruid] === ~~number) {\n\t                        $uploadBox.find(picker).hide();\n\t                    }\n\t                    $uploadBox.find(picker).children().eq(1).css({\n\t                        'width': '78px',\n\t                        'height': '78px'\n\t                    });\n\t                },\n\t\n\t                onUploadSuccess: function onUploadSuccess(file, response) {\n\t                    if (response.code === 200 && response.success) {\n\t                        $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t                        // 激活提交按钮\n\t                        $('[i-id=ok]').removeClass('btn-default');\n\t                    } else {\n\t                        $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t                    }\n\t                }\n\t            }\n\t        });\n\t    } else {\n\t        alert('您最多能添加' + maxLen + '张图片哦！');\n\t    }\n\t    return $webUpLoader;\n\t};\n\t\n\tmodule.exports = init;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 117 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG, $) {'use strict';\n\t\n\t/***\n\t * upload.js\n\t * @author zhaodonghong\n\t * @params                      object      上传图片参数\n\t *     maxlength               number      可上传图片最大张数\n\t *     selector                object      jq选择器\n\t *         parents             string      每个图片上传外层jq选择器\n\t *         delSelector         string      删除按钮jq选择器\n\t *         selector            string      实例化上传插件的pick.id的值\n\t *     defaultApi              object      实例化webuploader参数\n\t *     callbacks               object      实例化webuploader方法回调集合\n\t *         onBeforeFileQueued  function    上传图片添加到上传队列之前\n\t *         onFileQueued        function    上传图片添加到上传队列后\n\t *         onUploadSuccess     function    上传成功\n\t *         onUploadError       function    上传失败\n\t *         onUploadProgress    function    上传中\n\t *         onErrored           function    报错\n\t *         retry               function    重新上传\n\t *         delImage            function    删除上传图片\n\t */\n\t\n\tvar WebUploader = __webpack_require__(86);\n\tvar hint = __webpack_require__(44);\n\tvar notice = __webpack_require__(84);\n\tvar imgReplace = __webpack_require__(118);\n\tvar init = function init(options) {\n\t\n\t    //var number = maxlength;\n\t    var numList = {};\n\t    var $webUpLoader;\n\t    var files = {};\n\t    var defaultOptions = {\n\t        //最大上传张数\n\t        maxlength: options.maxlength || 9,\n\t        //选择器\n\t        selector: {\n\t            parents: '[data-node=\"uploadBox\"]', //每个图片上传外层jq选择器\n\t            delSelector: '[data-action=\"delImage\"]', //删除按钮jq选择器\n\t            selector: '[data-defaultAddFile=picker]' //初始化时options.defaultApi.pick 的值，也就是 选择器的值\n\t        }\n\t    };\n\t    //初始化参数\n\t    defaultOptions.defaultApi = {\n\t        pick: {\n\t            id: '[data-defaultAddFile=picker]',\n\t            innerHTML: '本地上传图片'\n\t        },\n\t        accept: {\n\t            title: 'Images',\n\t            extensions: 'jpg,jpeg,png,gif',\n\t            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\n\t        },\n\t        method: 'post',\n\t        // swf文件路径\n\t        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\n\t        auto: true,\n\t        disableGlobalDnd: true,\n\t        duplicate: true,\n\t        prepareNextFile: true,\n\t        chunked: true,\n\t        fileVal: 'avatar_file',\n\t        server: '/ajax/crop/crop_img',\n\t        fileNumLimit: defaultOptions.maxlength * $(defaultOptions.selector).length,\n\t        fileSizeLimit: defaultOptions.maxlength * $(defaultOptions.selector).length * 4 * 1024 * 1024, // 50 M\n\t        fileSingleSizeLimit: 4 * 1024 * 1024\n\t    };\n\t    defaultOptions.callbacks = {\n\t        /***\n\t         * name: 图片加入队列之前\n\t         * file: 图片信息对象\n\t         * numList: 以 file.source.ruid 为key的计数json对象\n\t         * number: 最多可上传数\n\t         */\n\t        onBeforeFileQueued: function onBeforeFileQueued() /*file, numList, number*/{\n\t            hint.init(notice.upload.excess);\n\t        },\n\t\n\t        /***\n\t         * name: 图片添加入队列后\n\t         * file: 图片信息对象\n\t         * numList: 以 file.source.ruid 为key的计数json对象\n\t         * maxlength: 最多可上传数\n\t         */\n\t        onFileQueued: function onFileQueued(file, numList, number) {\n\t            var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n\t            $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').before(html);\n\t\n\t            $('#rt_' + file.source.ruid).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\t\n\t            if (numList[file.source.ruid] === ~~number) {\n\t                $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').hide();\n\t            }\n\t        },\n\t\n\t        /***\n\t         * name: 上传成功（此成功指ajax有返回结果，故需要判断返回的状态码）\n\t         * file: 图片信息对象\n\t         * response: 上传图片ajax返回数据\n\t         */\n\t        onUploadSuccess: function onUploadSuccess(file, response) {\n\t            if (response.code === 200 && response.success) {\n\t                $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t                //$('#' + file.id).html('<img src=\"' + imgReplace(response.data[0]) + '\" _src = \"' + response.data[0] + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t            } else {\n\t                $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t            }\n\t        },\n\t\n\t        /***\n\t         * name: 上传失败\n\t         * file: 图片信息对象\n\t         * reason: 出错的code\n\t         */\n\t        onUploadError: function onUploadError(file /*, reason*/) {\n\t            $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n\t        },\n\t\n\t        /***\n\t         * name: 上传时，包含进度条\n\t         * file: 图片信息对象\n\t         * percentage: 上传进度\n\t         */\n\t        onUploadProgress: function onUploadProgress(file, percentage) {\n\t            $('#' + file.id).find('[data-node=\"progress\"]').css('width', percentage * 100 + '%');\n\t        },\n\t\n\t        /***\n\t         * name: 报错\n\t         * type: 报错类型\n\t         */\n\t        onErrored: function onErrored() /*type*/{\n\t            hint.init(notice.upload.uploadError);\n\t        },\n\t\n\t        //重新上传\n\t        retry: function retry() {\n\t            var _this = this;\n\t            $('[data-node=\"uploadList\"]').on('click', '[data-action=\"retry\"]', function () {\n\t                _this.retry(files[$(this).parents('li').attr('id')]);\n\t            });\n\t        },\n\t\n\t        /***\n\t         * name: 删除图片\n\t         * webuploader: webuploader实例化对象\n\t         * numList: 自定义json对象，用来存储每个实例化对象已上传的图片个数\n\t         * id: 每个webuploader实例化时，上传按钮所生成的唯一id\n\t         */\n\t        delImage: function delImage(webuploader, numList, id, number) {\n\t            $webUpLoader.removeFile(files[$(this).parents('li').attr('id')]);\n\t            $(this).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[id]);\n\t            $(this).parents('ul').find('[data-defaultAddFile=\"picker\"]').show();\n\t            $(this).parents('li').eq(0).remove();\n\t            if (numList[id] === 0) {\n\t                $('[i-id=ok]').addClass('btn-default');\n\t            };\n\t        }\n\t    };\n\t    options.callbacks = $.extend({}, defaultOptions.callbacks, options.callbacks);\n\t    /*var */\n\t    options = $.extend({}, defaultOptions, options);\n\t    $webUpLoader = WebUploader.create(options.defaultApi);\n\t\n\t    $webUpLoader.onFileQueued = function (file) {\n\t        var ruid = $('[data-node=\"uploadBox\"]').find('[data-defaultaddfile=\"picker\"]').children().eq(1).attr('id');\n\t        file.source.ruid = ruid;\n\t        numList[file.source.ruid] = numList[file.source.ruid] !== undefined ? numList[file.source.ruid] : 0;\n\t        numList[file.source.ruid]++;\n\t        files[file.id] = file;\n\t        options.callbacks.onFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\t    };\n\t\n\t    //上传成功\n\t    $webUpLoader.on('uploadSuccess', function (file, response) {\n\t        options.callbacks.onUploadSuccess.call($webUpLoader, file, response);\n\t    });\n\t\n\t    //加入队列前\n\t    $webUpLoader.on('beforeFileQueued', function (file) {\n\t        if (numList[file.source.ruid] >= options.maxlength) {\n\t            options.callbacks.onBeforeFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\t            return false;\n\t        }\n\t    });\n\t    //上传失败\n\t    $webUpLoader.on('uploadError', function (file, reason) {\n\t        options.callbacks.onUploadError.call($webUpLoader, file, reason);\n\t    });\n\t\n\t    //上传时\n\t    $webUpLoader.on('uploadProgress', function (file, percentage) {\n\t        options.callbacks.onUploadProgress.call($webUpLoader, file, percentage);\n\t    });\n\t\n\t    //报错\n\t    $webUpLoader.on('error', function (type) {\n\t        options.callbacks.onErrored.call($webUpLoader, type);\n\t    });\n\t    options.callbacks.retry.call($webUpLoader);\n\t\n\t    //删除图片\n\t    $(options.selector.parents).on('click', options.selector.delSelector, function () {\n\t        var id = $(this).parents(options.selector.parents).find(options.defaultApi.pick.id).children().eq(1).attr('id');\n\t        numList[id]--;\n\t        options.callbacks.delImage.call(this, $webUpLoader, numList, id, options.maxlength);\n\t    });\n\t\n\t    return $webUpLoader;\n\t};\n\t\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3), __webpack_require__(2)))\n\n/***/ }),\n/* 118 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar rules = /^https?:/i;\n\tvar https = 'https';\n\tvar imgRule = /^http/i;\n\t/* var grepStr = /-600!80\\./g;\n\t var grepOldStr = /\\.600q80\\.jpg/gi;*/\n\tvar shotCut = \"-600!80\";\n\tvar imgType = /\\.(jpg|jpeg|png)$/;\n\t\n\tvar grepStr1 = /(.+?)-[^\\.]+\\.(jp(e)?g|png|gif).*/;\n\tvar grepStr2 = /(.+?\\.(jp(e)?g|png|gif)).*/;\n\t\n\tvar imgReplace = function imgReplace(src) {\n\t    return src.replace(rules, '');\n\t};\n\t\n\tvar orignalImgReplace = function orignalImgReplace(src) {\n\t    if (grepStr1.test(src)) {\n\t        return src.replace(grepStr1, \"$1.$2\");\n\t    } else {\n\t        return src.replace(grepStr2, \"$1\");\n\t    }\n\t};\n\t\n\tvar addShortCut = function addShortCut(src) {\n\t    return src.replace(imgType, function ($1) {\n\t        return shotCut + $1;\n\t    });\n\t};\n\tvar imgProto = function imgProto(src) {\n\t    if (src.indexOf(https) != -1) {\n\t        return 'https:';\n\t    } else {\n\t        return 'http:';\n\t    }\n\t};\n\t\n\tvar changeSrc = function changeSrc(container) {\n\t    var $imgs = container.find('img').not('[data-node=\"goodsPic\"]');\n\t    var len = $imgs.length;\n\t    for (var i = 0; i < len; i++) {\n\t        var _this = $($imgs[i]);\n\t        var _src = _this.attr(\"_src\");\n\t        var _orignal = _this.attr(\"data-original\");\n\t        if (_orignal) {\n\t            _this.attr({\n\t                'src': imgReplace(_orignal),\n\t                '_src': imgReplace(_orignal),\n\t                'proto': imgProto(_orignal)\n\t            });\n\t        } else if (!imgRule.test(_src)) {\n\t            var proto = _this.attr(\"proto\");\n\t            _this.attr(\"_src\", _src);\n\t        }\n\t    }\n\t};\n\t\n\tmodule.exports = {\n\t    imgReplace: imgReplace,\n\t    addShortCut: addShortCut,\n\t    imgProto: imgProto,\n\t    changeSrc: changeSrc,\n\t    orignalImgReplace: orignalImgReplace\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 119 */,\n/* 120 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar codeTpl = __webpack_require__(121);\n\tvar imgPath = $GLOBAL_CONFIG['pcimgpath'];\n\t\n\t$('body').append(codeTpl({\n\t    imgPath: imgPath\n\t}));\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar qrTips = __webpack_require__(84);\n\tvar alert = __webpack_require__(36);\n\tvar config = __webpack_require__(122);\n\tvar imgReplace = __webpack_require__(118);\n\tvar domain = $_CONFIG['group_domain'];\n\t\n\tvar pageId = window.pageId;\n\tvar maxLen = config.imgLimitNUm;\n\tvar pageId = window.pageId;\n\tfunction Scans(o) {\n\t    this.qid = o.qid || 'single'; //是否创建实例的唯一标示\n\t    this.topicQrId = \"\";\n\t    this.$parent = o.$parent; //用于寻找插入图片的节点\n\t    this.uploadMaxNum = o.maxNum || 20; //上传图片限制\n\t    //this.currentMaxNum = 0; //当前能够上传图片\n\t    this.useNewCode = 0; //二维码是否过期的判断\n\t    this.interval = 0;\n\t    this.type = o.type || 'pubsliser'; //扫码来源  评论页？发布话题页？等\n\t    this.$showBox = o.$showBox; //二维码弹层\n\t    this.time = o.time || 2000; //轮询请求间隔\n\t    this.customInit = o.customInit || \"\";\n\t    this.customCb = o.customCb; //用户自定义回调函数\n\t    this.isLoad = 0;\n\t    // this.$insertDom = o.$insertDom; //插入图片的节点\n\t    this.imgArr = []; //存储二维码未过期时，获得的的图片总数\n\t    this.editor = o.editor || \"\"; //用于编辑器\n\t    this.$cover = o.$showBox.find('[data-node=\"cover\"]'); //是否上传中\n\t    this.$localBtn = o.$showBox.find('[data-node=\"upLocal\"]'); //是否上传中\n\t    this.$target = o.$target;\n\t    this.code = \"\";\n\t    this.btn = o.btn;\n\t}\n\t\n\tScans.prototype = {\n\t    constructor: Scans,\n\t    init: function init() {\n\t        var _this = this;\n\t        if (_this.editor) {\n\t            //\n\t            /*_this.editor.document.body.addEventListener('DOMNodeRemoved', function(evt) {\n\t                var code = evt.keyCode || evt.which\n\t                if (code == 8) {\n\t                    var target = evt.target\n\t                    debugger;\n\t                    console.log(target.nodeName, target.previousSibling, target.previousSibling.nodeName)\n\t                    if (target.nodeName == \"#text\") {\n\t                        if (target.previousSibling && target.previousSibling.nodeName == \"IMG\") {\n\t            console.log(333)\n\t                        }\n\t                    }\n\t                }\n\t            })*/\n\t\n\t            /*$(_this.editor.document).on('DOMNodeRemoved DOMNodeInserted', 'img', function(e) {\n\t                if (_this.interval) {\n\t                    //console.log(666)\n\t                    setTimeout(function() {\n\t                        _this.sendNum();\n\t                    }, 100)\n\t                 }\n\t            })*/\n\t\n\t            $(_this.editor.body).on('click', function (e) {\n\t                //$webUpLoader.destroy();\n\t                _this.hide();\n\t                e.preventDefault();\n\t            });\n\t        }\n\t\n\t        if (typeof _this.customInit == 'function') {\n\t            this.customInit(this);\n\t        }\n\t        $('body').on('click', /* _this.$showBox*/'[data-node=\"picPopBox\"]', function (e) {\n\t            var tagName = e.target.tagName;\n\t            tagName = tagName == 'INPUT' || tagName == 'LABEL';\n\t            if (!tagName) {\n\t                e.stopPropagation();\n\t            } else {\n\t                _this.hide();\n\t            }\n\t        });\n\t\n\t        this.start();\n\t    },\n\t    start: function start() {\n\t        if (!this.useNewCode) {\n\t            this.getCode();\n\t        } else {\n\t\n\t            if (this.checkShow()) {\n\t                this.hide();\n\t            } else {\n\t                this.show();\n\t            }\n\t        }\n\t    },\n\t    //获取图片数量\n\t    imgLength: function imgLength() {\n\t        if (this.editor) {\n\t            return $(this.$parent.getContent()).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n\t        } else {\n\t            return this.$parent.find(\"img\").length;\n\t        }\n\t    },\n\t    //获取二维码\n\t    getCode: function getCode() {\n\t        var _this = this;\n\t        var len = this.imgLength();\n\t        var datas = {\n\t            pageId: pageId,\n\t            maxNum: this.uploadMaxNum - len\n\t        };\n\t        var qid = _this.qid;\n\t        var qidArr = window.topicQrId; //检测window变量是否有此变量 格式为：\n\t        _this.show();\n\t        //topicQrId:{\n\t        //  qid1:s1111,\n\t        //  qid2:s2222\n\t        // }\n\t        if (qidArr[qid].qrcodeId) {\n\t            datas.qrcodeId = _this.topicQrId;\n\t        }\n\t        fetch.get(url.get('getUploadQrCode'), {\n\t            data: datas\n\t        }).done(function (data) {\n\t            if (data.success == true) {\n\t\n\t                if (data.code == 200) {\n\t\n\t                    _this.useNewCode = 1;\n\t\n\t                    var _data = data.data;\n\t\n\t                    var str = domain + 'qrupload/index?pageId=' + _data.pageId + '&qrcodeId=' + _data.qrcodeId + '&type=' + _this.type;;\n\t                    str = domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(str);\n\t\n\t                    window.topicQrId[qid].qrcodeId = _this.topicQrId = _data.qrcodeId; //把data的值赋予 window [qid].qrcodeId\n\t\n\t                    _this.code = str; //把二维码的值放入\n\t                    _this.getCodeCb();\n\t\n\t                    _this.interval = setInterval(function () {\n\t                        _this.monitor();\n\t                    }, _this.time);\n\t                }\n\t            } else {\n\t                alert(data.message);\n\t            }\n\t        }).fail(function (e, s) {});\n\t    },\n\t    //扫码轮询\n\t    monitor: function monitor() {\n\t        var _this = this;\n\t        fetch.post(url.get('topListenImg'), {\n\t            data: {\n\t                code: pageId,\n\t                groupkey: window.topicQrId[_this.qid].qrcodeId\n\t            }\n\t\n\t        }).done(function (data) {\n\t\n\t            if (data.success == true) {\n\t                //ok\n\t                _this.scanCb(data);\n\t            } else {\n\t                _this.hide();\n\t            }\n\t        }).fail(function (e, m) {\n\t            clearInterval(_this.interval);\n\t            _this.interval = 0;\n\t            _this.hide();\n\t            // alert(e);\n\t        });\n\t    },\n\t    sendNum: function sendNum() {\n\t        var _this = this;\n\t        var len = this.imgLength();\n\t        var maxNum = this.uploadMaxNum - len;\n\t        fetch.get(url.get('topicuploadMax'), {\n\t            data: {\n\t                qrcodeId: _this.topicQrId,\n\t                maxNum: maxNum\n\t            }\n\t        });\n\t    },\n\t    //插入图片\n\t    insertPic: function insertPic(data) {\n\t        for (var i = 0, len = data.length; i < len; i++) {\n\t            var _data = data[i];\n\t            var _img = imgReplace.imgReplace(_data);\n\t            var _proto = imgReplace.imgProto(_data);\n\t            var str = '<p><img src=\"' + _img + '\" _src=\"' + _img + '\" data-type=\"insertImg\" proto=\"' + _proto + '\"/></p>';\n\t            this.editor.execCommand('inserthtml', str);\n\t        }\n\t    },\n\t    //用户正在上传中\n\t    loading: function loading() {\n\t        this.isLoad = 1;\n\t        this.$showBox.show();\n\t        this.$cover.show();\n\t        this.$localBtn.addClass('upload-unable');\n\t        if (this.editor) {\n\t            this.editor.setDisabled();\n\t        }\n\t    },\n\t    //用户不在上传中\n\t    unLoading: function unLoading() {\n\t        this.isLoad = 0;\n\t        this.$cover.hide();\n\t        this.$cover.css(\"display\", \"none\");\n\t        this.$localBtn.removeClass('upload-unable');\n\t        if (this.editor) {\n\t            this.editor.setEnabled();\n\t        }\n\t    },\n\t    //检查弹层状态\n\t    checkShow: function checkShow() {\n\t        if (this.$showBox.is(\":visible\")) {\n\t            return true;\n\t        }\n\t        return false;\n\t    },\n\t    //调整弹窗位置\n\t    fixPop: function fixPop() {\n\t        var $btn = this.$target;\n\t        var offset = $btn.offset();\n\t        var x = offset.left;\n\t        var y = offset.top / 1 + 30;\n\t\n\t        return this.$showBox.css({\n\t            'top': y + 'px',\n\t            'left': x + 'px'\n\t        });\n\t    },\n\t    //显示弹层\n\t    show: function show() {\n\t        this.$showBox.removeClass('webuploader-element-invisible');\n\t        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n\t        this.fixPop().show();\n\t    },\n\t    //隐藏弹层\n\t    hide: function hide() {\n\t        if (this.isLoad != 1) {\n\t            this.$showBox.hide();\n\t        }\n\t    },\n\t    //获得二维码回调\n\t    getCodeCb: function getCodeCb() {\n\t        this.sendNum(); //发送二维码数量\n\t        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n\t        //this.show();\n\t    },\n\t    //扫码回调\n\t    scanCb: function scanCb(data) {\n\t\n\t        switch (data.isload) {\n\t            case 1:\n\t                this.unLoading();\n\t                break;\n\t            case 2:\n\t                //上传中\n\t                this.loading();\n\t\n\t                break;\n\t            case 3:\n\t                //上传完成\n\t                var dataArr = data.data;\n\t                var tempArr = [];\n\t\n\t                var diffLen = dataArr.length - this.imgArr.length;\n\t\n\t                if (diffLen) {\n\t                    this.loading();\n\t                    this.imgArr = dataArr;\n\t                    tempArr = dataArr.slice(-diffLen);\n\t                    var _this = this;\n\t                    setTimeout(function () {\n\t                        _this.unLoading();\n\t                        _this.hide();\n\t                        if (typeof _this.customCb == 'function') {\n\t                            _this.customCb(tempArr, _this);\n\t                        } else {\n\t                            _this.insertPic(tempArr);\n\t                        }\n\t                    }, 500);\n\t                }\n\t                break;\n\t            case 10000:\n\t                this.imgArr = [];\n\t                this.isload = 0;\n\t                this.useNewCode = 0; //useNewCode 为0 意味着二维码过期\n\t                clearInterval(this.interval);\n\t                this.interval = 0;\n\t                this.hide();\n\t                break;\n\t        }\n\t    }\n\t    //prototype end\n\t};\n\t\n\tmodule.exports = Scans;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 121 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/uploadfileQR/upload',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgPath=$data.imgPath,$out='';$out+='<div data-node=\"picPopBox\" class=\"picPopBox\" data-node=\"picPopBox\"> <em class=\"sanjiao\"></em> <div class=\"container clearfix\"> <div class=\"left\"> <div class=\"qr\"> <img src=\\'\\'/> <div class=\"cover\" data-node=\"cover\">上传中...</div> </div> <p>扫描二维码,上传手机图片</p> </div> <div class=\"right\" data-node=\"uploadList\"> <div class=\"pc-btn pc-btnh35\" data-defaultAddFile=\\'picker\\'></div> </div> </div> </div> <div data-node=\"picLoading\" class=\"picLoading hide\"> <img src=\"';\n\t$out+=$escape(imgPath);\n\t$out+='/images/public/loading.gif\"/> <div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 122 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\t//白名单\n\tvar whiteList = {\n\t    a: ['target', 'href', 'title', 'class', 'data-node'],\n\t    div: ['class', 'style', 'data-node', 'unselectable', 'onselectstart', 'data-type', 'data-skuid'],\n\t    dl: ['class', 'style', 'data-node'],\n\t    dt: ['class', 'style'],\n\t    em: ['class', 'style', 'data-node'],\n\t    h1: ['data-node'],\n\t    h2: ['data-node'],\n\t    h3: ['data-node'],\n\t    h4: ['data-node'],\n\t    h5: ['data-node'],\n\t    h6: ['data-node'],\n\t    img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-index', 'data-type', 'data-node', 'data-original', 'onerror', 'proto'],\n\t    p: ['class', 'style', 'data-node'],\n\t    span: ['class', 'style', 'data-node'],\n\t    ul: ['class', 'style', 'data-node'],\n\t    ol: ['class', 'style', 'data-node'],\n\t    li: ['class', 'style', 'data-node']\n\t};\n\t\n\tvar defaults = {\n\t    //图片张数限制\n\t    imgLimitNUm: 20,\n\t    //商品个数限制\n\t    goodsLimitNUm: 9,\n\t    initialFrameWidth: 788,\n\t    initialFrameHeight: 400,\n\t    zIndex: 9,\n\t    autoClearinitialContent: true,\n\t    //服务器根目录\n\t    UEDITOR_HOME_URL: $_CONFIG['js_domain'],\n\t    //后台地址\n\t    //serverUrl:'php/1.php',\n\t    //serverUrl: $_CONFIG['group_domain'],\n\t    serverUrl: '',\n\t    //css 路径\n\t    themePath: $_CONFIG.csspath + '/css/module/',\n\t    //白名单\n\t    whitList: whiteList,\n\t    //工具栏\n\t    toolbars: [['bold', 'italic', 'underline', 'insertunorderedlist', 'insertorderedlist', 'justifyleft', 'justifycenter', 'justifyright']\n\t    //['insertunorderedlist', 'insertorderedlist']\n\t    ],\n\t    //iframe 内置样式\n\t    iframeCssUrl: $_CONFIG.csspath + '/css/module/iframestyle.css?v=' + $GLOBAL_CONFIG['versionData'],\n\t    //'//localhost:8017/src/js/editor/themes/iframestyle.css',\n\t    //纯文本粘贴\n\t    pasteplain: true,\n\t    //禁止div转换成p标签\n\t    allowDivTransToP: false,\n\t    //禁止缩放图片\n\t    imageScaleEnabled: false,\n\t    elementPathEnabled: false, // 关闭元素路径,调试时暂时开启\n\t    wordCount: false, // 字数统计\n\t    //禁止非同域上传图片\n\t    catchRemoteImageEnable: true,\n\t    //匹配快捷按键回调\n\t    // callbackKey: shortcutKey.callbackKey,\n\t    //右键菜单功能\n\t    enableContextMenu: false,\n\t    // 因为是用的自定义的弹窗,所以,关闭了编辑器自带的图片弹窗\n\t    imagePopup: false,\n\t    // 禁止自动保存\n\t    enableAutoSave: false\n\t    // 自定义过滤规则\n\t    // filterTxtRules:filterTxtRules()\n\t};\n\tmodule.exports = defaults;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 123 */,\n/* 124 */,\n/* 125 */,\n/* 126 */,\n/* 127 */,\n/* 128 */,\n/* 129 */,\n/* 130 */,\n/* 131 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar dialog = __webpack_require__(132);\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar Pubsub = __webpack_require__(45);\n\tvar tpl = __webpack_require__(133);\n\tvar itemlist = __webpack_require__(134);\n\tvar defaultItemlist = __webpack_require__(135);\n\tvar pubName = __webpack_require__(100);\n\tvar indexof = __webpack_require__(4);\n\tvar alert = __webpack_require__(36);\n\t\n\tvar pageNum = 1;\n\tvar maxlength = 9;\n\tvar isDefault = true;\n\tvar keyWord = '';\n\tvar changedList = [];\n\tvar isGetMore = false;\n\tvar options = {};\n\tvar degree = 1;\n\t// var delChanged = [];\n\tvar addDialog;\n\t\n\tvar $searchTop = null,\n\t    $searchInput = null,\n\t    $searchBtn = null,\n\t    $searchNormal = null,\n\t    $searchLoading = null,\n\t    $searchFail = null,\n\t    $searchResult = null,\n\t    $searchList = null,\n\t\n\t// $searchPage = null,\n\t$changeNum = null,\n\t    $listBox = null,\n\t    $changeList = null,\n\t    $title = null,\n\t    $getMore = null,\n\t    $searchListBox = null;\n\t\n\tvar selectedGoods = {};\n\t\n\tvar init = function init(changedGoods, max /* 最多可选 */) {\n\t    var returnList = [];\n\t    selectedGoods = {};\n\t    // var selectedGoodsBak = {};\n\t    for (var i in changedGoods) {\n\t        changedList.push(i);\n\t        returnList.push(changedGoods[i]);\n\t    }\n\t\n\t    maxlength = max || 9;\n\t    selectedGoods = $.extend(true, selectedGoods, changedGoods);\n\t    if (maxlength - returnList.length !== 0) {\n\t        options = {\n\t            title: ' ',\n\t            modal: true,\n\t            fixed: true,\n\t            width: 712,\n\t            content: tpl({\n\t                imgSrc: $_CONFIG.imgpath,\n\t                returnList: returnList,\n\t                maxlength: maxlength,\n\t                changeNum: maxlength - returnList.length\n\t            }),\n\t            className: 'pop-box',\n\t            okValue: '插入商品',\n\t            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n\t            btnWrapCls: 'insert-cancel',\n\t            ok: function ok() {\n\t                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n\t                    return false;\n\t                }\n\t                Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n\t                dialogClosed();\n\t            },\n\t            cancel: function cancel() {\n\t                dialogClosed();\n\t            },\n\t            onshow: function onshow() {\n\t\n\t                $('[i=\"title\"]').hide();\n\t                getNode(); //获取节点\n\t                defaultItem(pageNum); //默认输出内容\n\t                searchItem(); //搜索商品\n\t                reGet(); //重新获取\n\t                changeItem(); //选择添加的商品\n\t                getMoreItem(); //加载 更多\n\t                $('body').css({\n\t                    height: '100%',\n\t                    overflowY: 'hidden'\n\t                });\n\t            }\n\t        };\n\t    } else {\n\t        options = {};\n\t    }\n\t\n\t    addDialog = dialog.create(options);\n\t    setTimeout(function () {\n\t        addDialog.show();\n\t    }, 100);\n\t};\n\t//获取节点\n\tvar getNode = function getNode() {\n\t    $searchTop = $('[data-node=\"addTopBox\"]');\n\t    $searchInput = $searchTop.find('[data-action=\"addSearchInput\"]');\n\t    $searchBtn = $searchTop.find('[data-action=\"addSearchBtn\"]');\n\t    $searchNormal = $('[data-node=\"searchNormal\"]');\n\t    $searchLoading = $('[data-node=\"searchLoading\"]');\n\t    $searchFail = $('[data-node=\"searchFail\"]');\n\t    $searchResult = $('[data-node=\"searchResultBox\"]');\n\t    $searchList = $searchResult.find('[data-node=\"searchResultList\"]');\n\t    $listBox = $searchResult.find('[data-node=\"changedBox\"]');\n\t    $changeList = $listBox.find('[data-node=\"searchChangeList\"]');\n\t    $changeNum = $searchResult.find('[data-node=\"searchChangeNum\"]');\n\t    $title = $('[data-node=\"title\"]'), $getMore = $searchResult.find('[data-action=\"moreItem\"]');\n\t    $searchListBox = $searchList.parent();\n\t};\n\t\n\t//初始化进弹窗获取数据\n\tvar defaultItem = function defaultItem(pageNum) {\n\t    getItems(url.get('getCollectItem'), {\n\t        data: {\n\t            page: pageNum,\n\t            pagesize: 10\n\t        },\n\t        done: function done(result) {\n\t            var html = defaultItemlist({\n\t                itemlist: result.data.items,\n\t                changedList: changedList,\n\t                indexof: indexof\n\t            });\n\t            if (pageNum === 1) {\n\t                $searchList.html(html);\n\t            } else {\n\t                $searchList.append(html);\n\t            }\n\t        }\n\t    });\n\t};\n\t\n\t//搜索 商品\n\tvar searchItem = function searchItem() {\n\t    $searchInput.on('keyup', function (e) {\n\t        var keycode = e.which;\n\t        isDefault = false;\n\t        isGetMore = false;\n\t        keyWord = $.trim($(this).val());\n\t        //处理回车的情况\n\t        if (keycode === 13) {\n\t            if (keyWord !== '') {\n\t                if (keyWord.length < 2) {\n\t                    alert('请输入两个字符以上关键词');\n\t                } else {\n\t                    pageNum = 1;\n\t                    $title.hide();\n\t                    $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n\t                    moreItem(pageNum, keyWord);\n\t                }\n\t            } else {\n\t                alert('请输入关键词');\n\t            }\n\t        }\n\t        //返回我收藏的商品列表\n\t        if (keyWord === '') {\n\t            $searchResult.children().eq(0).hide();\n\t            isDefault = true;\n\t            pageNum = 1;\n\t            $title.show();\n\t            defaultItem(pageNum); //默认输出内容\n\t        }\n\t    });\n\t    $searchBtn.on('click', function () {\n\t        isDefault = false;\n\t        isGetMore = false;\n\t        keyWord = $.trim($(this).prev().val());\n\t\n\t        if (keyWord !== '') {\n\t            if (keyWord.length < 2) {\n\t                alert('请输入两个字符以上关键词');\n\t            } else {\n\t                $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n\t                pageNum = 1;\n\t                $title.hide();\n\t                moreItem(pageNum, keyWord);\n\t            }\n\t        } else {\n\t            alert('请输入关键词');\n\t        }\n\t    });\n\t};\n\t\n\t//获取更多商品\n\t\n\tvar moreItem = function moreItem(pageNum, txt) {\n\t    getItems(url.get('getMoreItem'), {\n\t        data: {\n\t            pagenum: pageNum,\n\t            pagesize: 10,\n\t            word: txt\n\t        },\n\t        done: function done(result) {\n\t            var html = itemlist({\n\t                itemlist: result.data.items,\n\t                changedList: changedList,\n\t                indexof: indexof\n\t            });\n\t            if (result.pageCount != \"1\") {\n\t                $getMore.hide();\n\t            }\n\t            if (pageNum === 1) {\n\t                $searchList.html(html);\n\t            } else {\n\t                $searchList.append(html);\n\t            }\n\t        }\n\t    });\n\t};\n\t\n\t//ajax\n\tvar getItems = function getItems(link, options) {\n\t    if (pageNum === 1) {\n\t        $searchList.hide();\n\t        $searchFail.hide();\n\t        $searchLoading.show();\n\t        $searchNormal.hide();\n\t    } else {\n\t        $getMore.show();\n\t    }\n\t    fetch.get(link, {\n\t        data: options.data\n\t    }).done(function (result) {\n\t\n\t        if (result.code === 200) {\n\t            var resultItem = result.data.collections === undefined ? result.data.items : result.data.collections;\n\t            if ((!resultItem || resultItem.length === 0) && isDefault) {\n\t                if (pageNum === 1) {\n\t                    $searchNormal.show().text('暂无收藏的商品，可以搜索查找！');\n\t                } else {\n\t                    $getMore.show().find('span').text('没有可加载内容');\n\t                }\n\t            } else if (!resultItem || resultItem.length === 0) {\n\t                if (pageNum === 1) {\n\t                    $searchNormal.show().text('没有找到相关产品');\n\t                    $searchResult.children().eq(0).hide();\n\t                } else {\n\t                    $getMore.show().find('span').text('没有可加载内容');\n\t                }\n\t            } else {\n\t                $searchResult.show().children().eq(0).show();\n\t                $searchList.show();\n\t                options.done.call(this, result);\n\t                $getMore.hide();\n\t                isGetMore = false;\n\t\n\t                if (resultItem.length < 10 && pageNum !== 1) {\n\t\n\t                    isGetMore = true;\n\t                    $getMore.show().find('span').text('没有可加载内容');\n\t                }\n\t            }\n\t\n\t            // 重新定位弹窗位置\n\t            // addDialog.reset();\n\t        } else if (result.code === 881001) {\n\t            if (pageNum === 1) {\n\t                $searchNormal.show().text('没有找到相关产品');\n\t                $searchResult.children().eq(0).hide();\n\t            } else {\n\t                $getMore.show().find('span').text('没有可加载内容');\n\t            }\n\t        } else {\n\t            if (pageNum === 1) {\n\t                $searchFail.show();\n\t            } else {\n\t                $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n\t            }\n\t        }\n\t    }).fail(function () {\n\t        if (pageNum === 1) {\n\t            $searchFail.show();\n\t        } else {\n\t            $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n\t        }\n\t    }).always(function () {\n\t        $searchLoading.hide();\n\t    });\n\t};\n\t\n\t//重新获取\n\tvar reGet = function reGet() {\n\t    $searchFail.on('click', function () {\n\t        if (pageNum === 1) {\n\t            $searchLoading.show();\n\t            $searchFail.hide();\n\t            if (isDefault) {\n\t                defaultItem(pageNum);\n\t            } else {\n\t                moreItem(pageNum, keyWord);\n\t            }\n\t        }\n\t    });\n\t    $getMore.on('click', '[node-action=\"reget\"]', function () {\n\t        $(this).parent().html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n\t        if (isDefault) {\n\t            defaultItem(pageNum);\n\t        } else {\n\t            moreItem(pageNum, keyWord);\n\t        }\n\t    });\n\t};\n\t\n\tvar changeItem = function changeItem() {\n\t    if ($changeList.children().length) {\n\t        $('[i-id=ok]').removeClass('btn-default');\n\t    }\n\t    $searchResult.on('click', '[data-action=\"item\"]', function () {\n\t        var $this = $(this);\n\t        var imgSrc = $this.find('img').attr('src'),\n\t            pId = $this.attr('data-pId'),\n\t            shopId = $this.attr('data-shopid'),\n\t            itemLink = $this.attr('data-link'),\n\t            skuId = $this.attr('data-skuId'),\n\t            html = '';\n\t        if (maxlength == 1) {\n\t            if ($changeList.children().length) {\n\t                $changeList.empty();\n\t                $searchList.children(\"dl\").removeClass(\"chosed-mer-true\");\n\t            }\n\t            $this.addClass(\"chosed-mer-true\");\n\t\n\t            if ($changeList.children().length === 0) {\n\t                $listBox.show();\n\t            }\n\t            selectedGoods = {};\n\t            selectedGoods[skuId] = {\n\t                shopId: shopId,\n\t                skuId: skuId,\n\t                PId: pId,\n\t                title: $(this).find('[node-data=\"itemTitle\"]').text(),\n\t                img: imgSrc,\n\t                price: $(this).find('[node-data=\"itemPrice\"]').text(),\n\t                // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n\t                // 融合后的新商品链接\n\t                link: itemLink\n\t                //rebate: $(this).attr('data-rebate')\n\t            };\n\t            html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\t\n\t            $changeList.append(html);\n\t            $changeNum.text(maxlength - $changeList.children().length);\n\t        } else {\n\t\n\t            if (!$(this).hasClass('chosed-mer-true')) {\n\t                if ($changeList.children().length >= maxlength) {\n\t                    alert('最多可选取' + maxlength + '个商品');\n\t                    return false;\n\t                }\n\t\n\t                changedList.push(skuId);\n\t                selectedGoods[skuId] = {\n\t                    shopId: shopId,\n\t                    skuId: skuId,\n\t                    PId: pId,\n\t                    title: $(this).find('[node-data=\"itemTitle\"]').text(),\n\t                    img: imgSrc,\n\t                    price: $(this).find('[node-data=\"itemPrice\"]').text(),\n\t                    // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n\t                    // 融合后的新商品链接\n\t                    link: $(this).attr('data-link')\n\t                    //rebate: $(this).attr('data-rebate')\n\t                };\n\t                $(this).addClass('chosed-mer-true');\n\t                html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\t                if ($changeList.children().length === 0) {\n\t                    $listBox.show();\n\t                }\n\t                $changeList.append(html);\n\t                $changeNum.text(maxlength - $changeList.children().length);\n\t            } else {\n\t                var del = $changeList.find('[data-skuId=\"' + skuId + '\"]');\n\t                $(this).removeClass('chosed-mer-true');\n\t                del.remove();\n\t\n\t                var id = $(this).attr('data-skuId');\n\t                var index = changedList.indexOf(id);\n\t                if (index !== -1) {\n\t                    changedList.splice(index, 1);\n\t                }\n\t                delete selectedGoods[id];\n\t                if ($changeList.children().length === 0) {\n\t                    $listBox.hide();\n\t                }\n\t                $changeNum.text(maxlength - $changeList.children().length);\n\t            }\n\t        }\n\t\n\t        if ($changeList.children().length) {\n\t            $('[i-id=ok]').removeClass('btn-default');\n\t        } else {\n\t            $('[i-id=ok]').addClass('btn-default');\n\t        }\n\t\n\t        addDialog.reset();\n\t    }).on('click', '[data-action=\"delChanged\"]', function () {\n\t        var id = $(this).closest('li').attr('data-skuId');\n\t        var index = changedList.indexOf(id);\n\t        if (index !== -1) {\n\t            changedList.splice(index, 1);\n\t        }\n\t        var _this = this;\n\t        $searchList.find('[data-skuId=\"' + $(_this).parent().attr('data-skuId') + '\"]').removeClass('chosed-mer-true');\n\t\n\t        $(_this).parents('li').remove();\n\t        delete selectedGoods[id];\n\t        if ($changeList.children().length === 0) {\n\t            $listBox.hide();\n\t        }\n\t        $changeNum.text(maxlength - $changeList.children().length);\n\t        if (!$changeList.children().length) {\n\t            $('[i-id=ok]').addClass('btn-default');\n\t        }\n\t    });\n\t};\n\t\n\t//加载更多\n\tvar getMoreItem = function getMoreItem() {\n\t    $searchListBox.on('scroll', function () {\n\t        if (!isGetMore && $searchListBox.scrollTop() >= $searchList.height() - $searchListBox.height()) {\n\t            isGetMore = true;\n\t            pageNum++;\n\t            if (isDefault) {\n\t                defaultItem(pageNum);\n\t            } else {\n\t                moreItem(pageNum, keyWord);\n\t            }\n\t        }\n\t    });\n\t};\n\t\n\t//弹窗关闭\n\tvar dialogClosed = function dialogClosed() {\n\t    degree++;\n\t    $('body').css({\n\t        height: 'auto',\n\t        overflowY: 'auto'\n\t    });\n\t\n\t    $searchListBox.off('scroll');\n\t    $searchResult.off('click');\n\t    $searchFail.off('click');\n\t    $searchInput.off('keyup');\n\t    $searchBtn.off('click');\n\t    pageNum = 1;\n\t    // delChanged = [];\n\t    isDefault = true;\n\t    keyWord = '';\n\t    isGetMore = false;\n\t    changedList = [];\n\t};\n\t\n\tmodule.exports = init;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 132 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar Dialog = __webpack_require__(37);\n\t\n\tvar create = function create(options) {\n\t    options = options || {};\n\t    var defaults = {\n\t        title: ' ',\n\t        modal: true,\n\t        fixed: true,\n\t        width: 350,\n\t        content: '<p class=\"del-pop-p\">您最多能添加9个商品哦！</p>',\n\t        className: 'pop-box',\n\t        okValue: '确定',\n\t        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t        ok: function ok() {},\n\t        onshow: function onshow() {\n\t            $('[i=\"title\"]').hide();\n\t        }\n\t    };\n\t    $.extend(true, defaults, options);\n\t    return Dialog(defaults);\n\t};\n\t\n\tmodule.exports = {\n\t    create: create\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 133 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/addGoods/content',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgSrc=$data.imgSrc,returnList=$data.returnList,$each=$utils.$each,$value=$data.$value,$index=$data.$index,changeNum=$data.changeNum,maxlength=$data.maxlength,$out='';$out+=' <div class=\"search-box\" data-node=\"addTopBox\"> <input type=\"text\" placeholder=\"搜索商品\" data-action=\"addSearchInput\"> <em class=\"icon-search-sw\" data-action=\"addSearchBtn\"></em> </div> <div class=\"ui-dialog-title\" data-node=\"title\">我收藏的商品</div> <p class=\"no-saving-txt\" style=\"display:none;\" data-node=\"searchNormal\">暂无收藏的商品，可以搜索查找！</p> <div class=\"loading\" data-node=\"searchLoading\"><img src=\"';\n\t$out+=$escape(imgSrc);\n\t$out+='/images/public/loading.gif\" alt=\"\"></div> <p class=\"failed-txt\" style=\"display:none;\" data-node=\"searchFail\">数据获取失败，点击重新加载！</p> <div style=\"display:';\n\t$out+=$escape((returnList.length === 0 ? 'none':''));\n\t$out+=';\" data-node=\"searchResultBox\"> <div class=\"merchant-list clearfix\" > <div class=\"clearfix\" data-node=\"searchResultList\"></div> <div class=\"more-comments pop-more-com\" data-action=\"moreItem\" style=\"display:none;\"> <span><img src=\"';\n\t$out+=$escape(imgSrc);\n\t$out+='/images/public/loading.gif\">正在加载...</span> </div> </div> <div class=\"chosed-merchants\" data-node=\"changedBox\" style=\"display:';\n\t$out+=$escape((returnList.length>0?'':'none'));\n\t$out+='\"> <ul class=\"merchants-list clearfix\" data-node=\"searchChangeList\"> ';\n\t$each(returnList,function($value,$index){\n\t$out+=' <li data-skuId=\"';\n\t$out+=$escape($value.skuId);\n\t$out+='\" data-pid=\"';\n\t$out+=$escape($value.PId);\n\t$out+='\"> <img src=\"';\n\t$out+=$escape($value.img);\n\t$out+='\" alt=\"\" onerror=\"imgError(this)\"> <a href=\"javascript:;\" data-action=\"delChanged\"> <em class=\"icon-del-pic\"></em> </a> </li> ';\n\t});\n\t$out+=' </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"searchChangeNum\">';\n\t$out+=$escape(changeNum);\n\t$out+='</span>/<span class=\"deep-gray\">';\n\t$out+=$escape(maxlength);\n\t$out+='</span>个商品</div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 134 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/addGoods/itemContent',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$string=$utils.$string,$out='';$each(itemlist,function($value,$index){\n\t$out+=' <dl class=\"merchant-item clearfix ';\n\t$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n\t$out+='\" data-action=\"item\" data-pId=\"';\n\t$out+=$escape($value.pId);\n\t$out+='\" data-link=\"';\n\t$out+=$escape($value.sUrl);\n\t$out+='\" data-skuId=\"';\n\t$out+=$escape($value.skuId);\n\t$out+='\" > <dt><img src=';\n\t$out+=$escape($value.mainImage);\n\t$out+=' alt=\"11111\" onerror=\"imgError(this)\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n\t$out+=$string($value.name);\n\t$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n\t$out+=$escape($value.salePrice !== null?$value.salePrice:'暂无售价');\n\t$out+='</span></span> <!-- ';\n\tif($value.rebateMoney > 0){\n\t$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n\t$out+=$escape($value.rebateMoney);\n\t$out+='国美币</span> </div> ';\n\t}\n\t$out+=' --> </dd> </dl> ';\n\t});\n\t$out+=' ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 135 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/module/popup/addGoods/defaultItemContent',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$out='';$each(itemlist,function($value,$index){\n\t$out+=' <dl class=\"merchant-item clearfix ';\n\t$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n\t$out+='\" data-action=\"item\" data-pId=\"';\n\t$out+=$escape($value.pId);\n\t$out+='\" data-shopId=\"';\n\t$out+=$escape($value.shopId);\n\t$out+='\" data-link=\"';\n\t$out+=$escape($value.sUrl);\n\t$out+='\" data-skuId=\"';\n\t$out+=$escape($value.skuId);\n\t$out+='\" > <dt><img src=';\n\t$out+=$escape($value.mainImage);\n\t$out+=' alt=\"\" onerror=\"imgError(this,\\'m\\')\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n\t$out+=$escape($value.name);\n\t$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n\t$out+=$escape($value.skuPrice);\n\t$out+='</span></span> <!-- ';\n\tif($value.rebate > 0){\n\t$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n\t$out+=$escape($value.rebate);\n\t$out+='国美币</span> </div> ';\n\t}\n\t$out+=' --> </dd> </dl> ';\n\t});\n\t$out+=' ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 136 */,\n/* 137 */,\n/* 138 */,\n/* 139 */,\n/* 140 */,\n/* 141 */,\n/* 142 */,\n/* 143 */,\n/* 144 */,\n/* 145 */,\n/* 146 */,\n/* 147 */,\n/* 148 */,\n/* 149 */,\n/* 150 */,\n/* 151 */,\n/* 152 */,\n/* 153 */,\n/* 154 */,\n/* 155 */,\n/* 156 */,\n/* 157 */,\n/* 158 */,\n/* 159 */,\n/* 160 */,\n/* 161 */,\n/* 162 */,\n/* 163 */,\n/* 164 */,\n/* 165 */,\n/* 166 */,\n/* 167 */,\n/* 168 */,\n/* 169 */,\n/* 170 */,\n/* 171 */,\n/* 172 */,\n/* 173 */,\n/* 174 */,\n/* 175 */,\n/* 176 */,\n/* 177 */,\n/* 178 */,\n/* 179 */,\n/* 180 */,\n/* 181 */,\n/* 182 */,\n/* 183 */,\n/* 184 */,\n/* 185 */,\n/* 186 */,\n/* 187 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar alert = __webpack_require__(36);\n\tvar confirm = __webpack_require__(65);\n\tvar tips = __webpack_require__(84).circle;\n\tvar checkLoginStatus = __webpack_require__(23);\n\tvar loginPop = __webpack_require__(22);\n\t\n\t// var popTpl = \"<p data-node='alertTitle' class='dialog_p'>申请已发送，请耐心等待</p><img data-node='QRcode' src=''><p class='dialog_p'>下载国美APP随时关注</p>\";\n\t\n\tvar join = function join(event) {\n\t\tvar $els = event.data ? event.data.selector || $(this) : $(this);\n\t\tvar $action = $els.attr('data-action');\n\t\tvar done = event.data ? event.data.done || function () {} : function () {};\n\t\tvar word = event.data ? event.data.word || { join: '加入圈子', focus: '退出圈子' } : { join: '加入圈子', focus: '退出圈子' };\n\t\tvar groupId = $els.attr('data-groupid'),\n\t\t    memberType = $els.attr('data-membertype'),\n\t\t    bpData = {\n\t\t\tevent_id: $els.attr('event-id'), // 埋点数据\n\t\t\tgroup_id: groupId,\n\t\t\tcircle_type: $_CONFIG['s_c'] // 2级分类\n\t\t};\n\t\tif ($_CONFIG['topicid']) {\n\t\t\tbpData.topic_id = $_CONFIG['topicid'];\n\t\t}\n\t\t// 发送统计数据\n\t\tif (window.BP !== undefined) {\n\t\t\tBP.send(bpData);\n\t\t}\n\t\n\t\tif ($els.attr('data-verif') == 1) {\n\t\t\talert('您已提交申请，请等待审核');\n\t\t\treturn;\n\t\t}\n\t\t/*var firing = $els.attr('data-firing');\n\t if (firing == 1) {\n\t \treturn false;\n\t }\n\t $els.attr('data-firing', 1);*/\n\t\tvar userid = $els.attr('data-userid');\n\t\t// var approvaltype = $els.attr('data-approvaltype');\n\t\n\t\n\t\tvar newWeb = '';\n\t\tvar noRefreshFetch = function noRefreshFetch(flag) {\n\t\t\tfetch.post(url.get('joinCircle'), {\n\t\t\t\t// validate: true,\n\t\t\t\tdata: {\n\t\t\t\t\tgroupid: groupId,\n\t\t\t\t\timid: 'b_' + userid /*,\n\t                        onLogin: function (){\n\t                        $_CONFIG['islogin'] = '1';\n\t                        noRefreshFetch();\n\t                        }*/\n\t\t\t\t} }).done(function (data /*, textStatus, jqXHR*/) {\n\t\t\t\tif (data && data.code === 200 && data.success) {\n\t\t\t\t\tif (data.data.status === 0) {\n\t\t\t\t\t\tif ($action && $action == 'joinGroup' && !flag) {\n\t\t\t\t\t\t\tconfirm(tips.joinSuccessPublic, {\n\t\t\t\t\t\t\t\tclassName: 'pop-box',\n\t\t\t\t\t\t\t\tokValue: '暂不发布',\n\t\t\t\t\t\t\t\tcancelValue: '立即发布话题',\n\t\t\t\t\t\t\t\tokCls: 'pc-btn pc-btnh35 circle-pop-btn circle-cancel-btn',\n\t\t\t\t\t\t\t\tcancelCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t\t\t\t\t\t\t\tcontent: '<button data-active=\"close-join\" class=\"ui-dialog-close icon icon-close\" title=\"取消\">×</button><div i=\"title\" class=\"ui-dialog-title\" style=\"border-bottom: none;\"></div><p class=\"del-pop-p\">' + tips.joinSuccessPublic + '</p>',\n\t\t\t\t\t\t\t\tok: function ok() {},\n\t\t\t\t\t\t\t\tcancel: function cancel() {\n\t\t\t\t\t\t\t\t\t// var $postTopic = $('[data-node=postTopic]');\n\t\t\t\t\t\t\t\t\tvar url = 'topic/publiser?gid=' + $els.attr('data-groupid');\n\t\t\t\t\t\t\t\t\twindow.open($_CONFIG['group_domain'] + url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if ($action && $action == 'joinCircle') {\n\t\t\t\t\t\t\talert(tips.joinSuccess);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\talert(tips.joinSuccess);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$('[data-active=close-join]').on('click', function () {\n\t\t\t\t\t\t\t$('.pop-box-backdrop').hide();\n\t\t\t\t\t\t\t$('[role=alertdialog]').hide();\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$els.html(word.focus);\n\t\t\t\t\t} else if (data.data.status === 1) {\n\t\t\t\t\t\t// alert('申请已发送，请耐心等待');\n\t\t\t\t\t\t// var Dialog = alert('', {\n\t\t\t\t\t\t//     width: \"500px\",\n\t\t\t\t\t\t//     content: popTpl,\n\t\t\t\t\t\t//     cancel: false\n\t\t\t\t\t\t// });\n\t\t\t\t\t\t$('[data-node=QRcode]').attr('src', $_CONFIG.imgpath + '/images/public/down-ma.png');\n\t\t\t\t\t\t$('.dialog_p').css({\n\t\t\t\t\t\t\t'text-align': 'center',\n\t\t\t\t\t\t\t'margin': '10px 0px',\n\t\t\t\t\t\t\t'font-size': '1.5em'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t$('[data-node=QRcode]').css({\n\t\t\t\t\t\t\t'margin-left': '173px'\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// $els.css('background', '#CCC').html('审核中').off();\n\t\t\t\t\t\t// $els.html(word.join);\n\t\t\t\t\t\talert('您已申请加入圈子，请等待圈主审核');\n\t\t\t\t\t\tdone(\"joining\", $els);\n\t\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\t\tflag && location.reload();\n\t\t\t\t\t\t}, 1500);\n\t\t\t\t\t}\n\t\t\t\t\tdone(\"join\", $els);\n\t\t\t\t} else {\n\t\t\t\t\tif (data.code === 403 || data.message == '圈子拒绝加入') {\n\t\t\t\t\t\talert(tips.cannotJoinCircle);\n\t\t\t\t\t} else if (data.code === 409) {\n\t\t\t\t\t\t$els.html(word.join);\n\t\t\t\t\t\tif (data.error) {\n\t\t\t\t\t\t\tif (data.error.code === '2' || data.message === '该圈子人数已达上限') {\n\t\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\t\tdone(\"limit\", $els);\n\t\t\t\t\t\t\t} else if (data.error.code === '3' || data.message === '您已申请加入圈子，请等待圈主审核') {\n\t\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\t\tdone(\"joining\", $els);\n\t\t\t\t\t\t\t} else if (data.error.code === '1' || data.message === '您已加入该圈子！') {\n\t\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\t\tdone(\"joined\", $els);\n\t\t\t\t\t\t\t\t$els.html(word.focus);\n\t\t\t\t\t\t\t\t// location.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).fail(function () /*jqXHR, textStatus, errorThrown*/{\n\t\t\t\t// console.log(arguments);\n\t\t\t}).always(function () {\n\t\t\t\t// $els.attr('data-firing', 0);\n\t\t\t});\n\t\t};\n\t\tvar exitCircle = function exitCircle() {\n\t\t\tfetch.post(url.get('exitCircle'), {\n\t\t\t\tdata: {\n\t\t\t\t\tgroupid: groupId\n\t\t\t\t}\n\t\t\t}).done(function (data /*, textStatus, jqXHR*/) {\n\t\t\t\tif (data && data.code == 200 && data.success) {\n\t\t\t\t\talert(tips.exit);\n\t\t\t\t\t$els.attr('data-membertype', 1);\n\t\t\t\t\t$els.html(word.join);\n\t\t\t\t\tdone(\"exit\", $els);\n\t\t\t\t} else {\n\t\t\t\t\tif (data.code == 410) {\n\t\t\t\t\t\talert(tips.dissolved, {\n\t\t\t\t\t\t\tok: function ok() {\n\t\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonclose: function onclose() {\n\t\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (data.code == 404) {\n\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}).fail(function () /*jqXHR, textStatus, errorThrown*/{\n\t\t\t\t// console.log(arguments);\n\t\t\t}).always(function () {\n\t\t\t\t$els.attr('data-firing', 0);\n\t\t\t});\n\t\t};\n\t\tif (!checkLoginStatus()) {\n\t\t\tloginPop(function () {\n\t\t\t\t$_CONFIG['islogin'] = '1';\n\t\t\t\tnoRefreshFetch(1);\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\twindow.location.href = window.location;\n\t\t\t\t}, 1500);\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tif (memberType == 0) {\n\t\t\texitCircle();\n\t\t} else {\n\t\t\tnoRefreshFetch();\n\t\t}\n\t\treturn false;\n\t};\n\tmodule.exports = join;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 188 */,\n/* 189 */,\n/* 190 */,\n/* 191 */,\n/* 192 */,\n/* 193 */,\n/* 194 */,\n/* 195 */,\n/* 196 */,\n/* 197 */,\n/* 198 */,\n/* 199 */,\n/* 200 */,\n/* 201 */,\n/* 202 */,\n/* 203 */,\n/* 204 */,\n/* 205 */,\n/* 206 */,\n/* 207 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar alert = __webpack_require__(36);\n\tvar flag = false;\n\tvar sensitiveTitle = function sensitiveTitle(node, comment) {\n\t    fetch.post(url.get('sensitiveWord'), {\n\t        data: {\n\t            text: node\n\t        },\n\t        async: false\n\t    }).done(function (data) {\n\t        if (data.success === false) {\n\t            var msg = '标题';\n\t            flag = true;\n\t            if (comment) {\n\t                msg = '评论';\n\t            }\n\t            alert(msg + '中含有\"' + data.data + '\"敏感词');\n\t        } else {\n\t            flag = false;\n\t        }\n\t    }).fail(function () {\n\t        alert('数据加载失败');\n\t    });\n\t    return flag;\n\t};\n\t\n\tmodule.exports = sensitiveTitle;\n\n/***/ }),\n/* 208 */,\n/* 209 */,\n/* 210 */,\n/* 211 */,\n/* 212 */,\n/* 213 */,\n/* 214 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\t/**\n\t *\n\t * 赞/取消赞\n\t */\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar alert = __webpack_require__(36);\n\tvar Pubsub = __webpack_require__(45);\n\tvar channel = __webpack_require__(100);\n\tvar checkLoginStatus = __webpack_require__(23);\n\tvar loginPop = __webpack_require__(22);\n\t\n\tvar isLogin = checkLoginStatus(); //页面初始化是否登录判断\n\tvar popFlag = 0;\n\t\n\tvar noop = function noop() {};\n\tvar setData = function setData($node, praise, count) {\n\t    $node.data('praise', praise);\n\t    $node.data('count', count);\n\t};\n\t\n\tvar helper = {\n\t    normal: {\n\t        add: function add($node, data, count) {\n\t            $node.addClass('active');\n\t            if (!count) {\n\t                count = \"取消点赞\";\n\t            }\n\t            $node.find('span').text(count);\n\t        },\n\t        reduce: function reduce($node, data, count) {\n\t            $node.removeClass('active');\n\t            if (!count) {\n\t                count = \"点赞\";\n\t            }\n\t            $node.find('span').text(count);\n\t        }\n\t    }\n\t};\n\t\n\tvar getCallback = function getCallback(mode) {\n\t    return helper[mode];\n\t};\n\t\n\tvar praise = function praise(container, selector, options) {\n\t    var $container = $(container);\n\t    var onPraise = options.onPraise || noop;\n\t    var onUnPraise = options.onUnPraise || noop;\n\t    var onPraised = options.onPraised || noop;\n\t    var mode = options.mode || 'normal';\n\t\n\t    $container.on('click', selector, function () {\n\t        var $this = $(this);\n\t        /* var firing = $this.data('firing');\n\t         if (firing === 1) {\n\t             return;\n\t         }*/\n\t\n\t        // $this.data('firing', 1);\n\t        var t = $this.data('type');\n\t        var isPraise = $this.data('praise');\n\t        var id = $this.data('id');\n\t        var count = $this.data('count');\n\t\n\t        var objs = {\n\t            data: {\n\t                groupId: $_CONFIG['groupid'],\n\t                id: id,\n\t                type: t, // 0 店铺,  1 话题\n\t                isPraise: isPraise // 0 取消点赞, 1 点赞\n\t\n\t                /*,\n\t                            onLogin: noRefreshFetch,\n\t                            refresh: true*/\n\t            }\n\t\n\t            //无刷新登录\n\t        };function noRefreshFetch() {\n\t            var o = objs;\n\t            fetch.post(url.get('praise'), o).done(function (data /*, textStatus, jqXHR*/) {\n\t                var callbacks = getCallback(mode);\n\t                //推送 评论区状态\n\t                Pubsub(channel.comment.enableEditor).pub({\n\t                    pid: \"enable\"\n\t                });\n\t\n\t                if (data && data.code === 200 && data.success) {\n\t                    if (isPraise === 1) {\n\t                        setData($this, 0, ++count);\n\t                        callbacks.add($this, data, count);\n\t                        onPraise.call($this, data, count);\n\t                    } else if (isPraise === 0) {\n\t                        setData($this, 1, --count);\n\t                        callbacks.reduce($this, data, count);\n\t                        onUnPraise.call($this, data, count);\n\t                    }\n\t                } else if (data && data.code === 422) {\n\t                    // window.location.href = $_CONFIG.passport_domain + 'login/index';\n\t                } else if (data && data.code === 403) {\n\t                    alert('抱歉！该话题审核未通过', {\n\t                        ok: function ok() {\n\t                            window.location.href = $_CONFIG.group_domain + 'index/error?code=topic';\n\t                        }\n\t                    });\n\t                } else if (data.code === 409) {\n\t                    //409点过赞  已经登录 把点赞状态回带，不刷新\n\t                    onPraised.call($this, data, count);\n\t                    if (!popFlag) {\n\t                        alert(data.message);\n\t                    }\n\t                } else {\n\t                    var message = data.message;\n\t                    if (t === 0) {\n\t                        if (data.code === 404) {\n\t                            alert(message, {\n\t                                ok: function ok() {\n\t                                    window.location.reload();\n\t                                }\n\t                            });\n\t                        } else {\n\t                            alert(message);\n\t                        }\n\t                    } else {\n\t                        alert(message);\n\t                    }\n\t                }\n\t                if (popFlag) {\n\t                    window.location.reload();\n\t                }\n\t            }).fail(function () /*jqXHR, textStatus, errorThrown*/{\n\t                // 点赞失败时,如何处理\n\t            }).always(function () {\n\t                // $this.data('firing', 0);\n\t            });\n\t        }\n\t        if (!checkLoginStatus()) {\n\t            popFlag = 1;\n\t            loginPop(noRefreshFetch);\n\t        } else {\n\t            popFlag = 0;\n\t            noRefreshFetch();\n\t        }\n\t        return false;\n\t    });\n\t};\n\t\n\tmodule.exports = praise;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 215 */,\n/* 216 */,\n/* 217 */,\n/* 218 */,\n/* 219 */,\n/* 220 */,\n/* 221 */,\n/* 222 */,\n/* 223 */,\n/* 224 */,\n/* 225 */,\n/* 226 */,\n/* 227 */,\n/* 228 */,\n/* 229 */,\n/* 230 */,\n/* 231 */,\n/* 232 */,\n/* 233 */,\n/* 234 */,\n/* 235 */,\n/* 236 */,\n/* 237 */,\n/* 238 */,\n/* 239 */,\n/* 240 */,\n/* 241 */,\n/* 242 */,\n/* 243 */,\n/* 244 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\t/*话题详情页 v2版本改造*/\n\t\n\t__webpack_require__(50);\n\tvar face = __webpack_require__(75);\n\t//var loginPop = require('module/popup/login'); //登录弹窗\n\t//var checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\n\t\n\tvar Pubsub = __webpack_require__(45);\n\tvar channel = __webpack_require__(100);\n\tvar identify = __webpack_require__(245);\n\t\n\tvar getCommentList = __webpack_require__(246); //\n\tvar a_Submit = __webpack_require__(251); //\n\tvar secondComBtn = __webpack_require__(253); //\n\tvar showMoreList = __webpack_require__(255); //\n\tvar loginState = __webpack_require__(252);\n\tvar Smiley = __webpack_require__(256);\n\tvar otherFn = __webpack_require__(257);\n\t\n\tvar $loadlist = $(\"[data-node='loadlist']\");\n\tvar $comment_Msg = $(\"[data-node='comment_Msg']\");\n\t//var $a_Submit = $(\"[data-node=a_Submit]\");\n\t//var $circleCom = $(\"[data-node=circleCom]\");\n\tvar clickTopicId = $_CONFIG['topicid'];\n\t\n\tvar DIVOBJ = $(\"[data-node='more-topic']\");\n\tvar textareaTips = '[data-node=\"textareaTips\"]';\n\tvar hide = 'hide';\n\t\n\t$loadlist.css(\"display\", \"none\");\n\t$(\"[data-node='loading']\").css(\"display\", \"none\");\n\t$(\"[data-node='noload']\").css(\"display\", \"none\");\n\t$(\"[data-node='imgUl']\").addClass(\"hide\");\n\t\n\tvar commentDomInit = function commentDomInit() {\n\t    $comment_Msg.on('click', loginState.commentCheck);\n\t\n\t    DIVOBJ.on(\"click\", \"[data-node='a_Submit']\", a_Submit);\n\t    //$a_Submit.on(\"click\", $); //一级话题回复 绑定事件\n\t    DIVOBJ.on(\"click\", \"[data-node='secondCom_Key']\", secondComBtn.secondCom_Key); //显示二级回复框\n\t    DIVOBJ.on(\"click\", \"[data-node='hideComBox']\", secondComBtn.hideComBox); //点击收起 按钮，隐藏二级输入框\n\t    DIVOBJ.on(\"click\", \"[data-node='a_secondComBtn']\", secondComBtn.a_secondComBtn); //二级话题回复\n\t    DIVOBJ.on('click', '[data-node=\"smilies_Face\"]', Smiley.showEmoji); //表情添加\n\t    DIVOBJ.on(\"click\", \"[data-node='showMoreList']\", showMoreList); // 二级列表\n\t    if (identify()) {\n\t        DIVOBJ.on('keydown', 'textarea', hideTextareaTips);\n\t        DIVOBJ.on('blur', 'textarea', showTextareaTips);\n\t    }\n\t};\n\t\n\t// placeholder显示隐藏\n\tvar hideTextareaTips = function hideTextareaTips() {\n\t    var $this = $(this);\n\t    $this.parent($comment_Msg).find(textareaTips).addClass(hide);\n\t};\n\tvar showTextareaTips = function showTextareaTips() {\n\t    var $this = $(this);\n\t    var textVal = $.trim($this.val());\n\t    $this.val(textVal);\n\t    if (textVal.length) {\n\t        $this.parent($comment_Msg).find(textareaTips).addClass(hide);\n\t    } else {\n\t        $this.parent($comment_Msg).find(textareaTips).removeClass(hide);\n\t    }\n\t};\n\t\n\tvar init = function init() {\n\t    //登陆状态以及事件绑定\n\t    if (loginState.getLoginState()) {\n\t        face.insert(function (data) {\n\t            Smiley.insertAtCursor(Smiley.curretTextAreaObj(), data.reg);\n\t        });\n\t    }\n\t    getCommentList(clickTopicId, 1, 10, 2); //评论列表\n\t    commentDomInit(); //事件绑定\n\t    otherFn.lodingMore(); //一级评论列表加载更多\n\t    otherFn.goComment(); // 点击评论图标页面滚动到评论区域\n\t    face.init(); // 初始化表情\n\t    $(\"img\").lazyload({\n\t        effect: \"fadeIn\"\n\t    });\n\t};\n\t\n\t// 订阅\n\tPubsub(channel.comment.enableEditor).sub(function (data) {\n\t    if (data.pid == \"enable\") {\n\t        loginState.getLoginState();\n\t    }\n\t});\n\t\n\tmodule.exports = {\n\t    init: init,\n\t    getLoginState: loginState.getLoginState\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 245 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\t//识别当前浏览器是否为IE8及以下版本\n\t//返回值为 boolean true:当前版本为IE8及以下浏览器\n\tvar identify = function identify() {\n\t    var ua = navigator.userAgent.toLowerCase();\n\t    var version = 8.0;\n\t    var isIE = ua.indexOf(\"msie\") > -1;\n\t    if (isIE) {\n\t        var safariVersion = ua.match(/msie ([\\d.]+)/)[1];\n\t        if (safariVersion <= version) {\n\t            return true;\n\t        } else {\n\t            return false;\n\t        }\n\t    } else {\n\t        return false;\n\t    }\n\t};\n\tmodule.exports = identify;\n\n/***/ }),\n/* 246 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG, $) {'use strict';\n\t\n\t/**评论一级列表**/\n\tvar changeContent = __webpack_require__(247); //评论内容转换\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar checkLoginStatus = __webpack_require__(23); // 登陆判断\n\tvar face = __webpack_require__(75);\n\tvar fromNow = __webpack_require__(248);\n\tvar commentList = __webpack_require__(249);\n\tvar addImageTpl = __webpack_require__(250);\n\t//var fixedTopic = require('../fixedTopic');\n\t\n\tvar $is_Login = checkLoginStatus() == true ? 1 : 0; // 判断登陆状态\n\t//var  $LoginSrc = $_CONFIG.passport_domain; //登录注册域名\n\tvar $mall_domain = $_CONFIG['product_item_gome']; // 商城\n\tvar $userIsExpert = $_CONFIG['isExpert']; // 当前用户是否为达人\n\t\n\tvar $secondCom_Key = $(\"[data-node='secondCom_Key']\");\n\t\n\tvar LoadListStr = \"[data-node='loadlist']\";\n\tvar LoadtingStr = \"[data-node='loading']\";\n\t//var NoLoadStr = \"[data-node=noload]\";\n\t\n\tvar getCommentList = function getCommentList(id, currPage, pageSize, listSize, nodelist) {\n\t\n\t    var $hidDiv = $(\"[id-node='\" + id + \"']\").children(\".topic-lfet\").children(\"[data-node='hidDiv']\");\n\t\n\t    var $thisObjId = $(\"[data-circlecom='\" + id + \"']\"); //每个话题的评论容器\n\t    var $ComTopicId = $thisObjId.parent(\".bjfff\");\n\t    //var $ComTopicId = $(\"[data-ComTopicId=\"+id+\"]\");\n\t    var $loadlist = $($ComTopicId.children(LoadListStr));\n\t    var $loading = $($ComTopicId.children(LoadtingStr));\n\t    //var $noload = $($ComTopicId.children(NoLoadStr));\n\t\n\t    $loadlist.css(\"display\", \"none\");\n\t    $loading.css(\"display\", \"block\");\n\t\n\t    var currUserImg = $(\"[data-tid='\" + id + \"']\").attr(\"data-headface\");\n\t    var paramList = '?page=' + currPage + '&pagesize=' + pageSize + '&topicid=' + id;\n\t\n\t    fetch.get(url.get('commentListUrlV2') + paramList).then(function (data) {\n\t\n\t        if (data.success) {\n\t            //获取所有的一级评论\n\t            //console.log(data);\n\t            var topicReplys = data.data.topicReplys;\n\t            // var windowHeight = parseInt($(window).height());\n\t            var height = $(\"[data-comtopicid='\" + id + \"']\").offset().top;\n\t            if (topicReplys.length > 0) {\n\t\n\t                //显示 正在加载中\n\t                $loading.css(\"display\", \"block\");\n\t                $loadlist.css(\"display\", \"block\").attr(\"data-addMorePages\", currPage).attr(\"data-ListSize\", pageSize);\n\t\n\t                for (var i = 0; i < topicReplys.length; i++) {\n\t\n\t                    //获取每个评论下的二级评论\n\t                    var topicMsg = topicReplys[i];\n\t                    var subReplyQuantity = topicMsg.subReplyQuantity; //二级回复的总数\n\t                    var subTop = topicMsg.topicSubReplys; //二级回复\n\t                    var replySecArr = []; //二级评论数组\n\t\n\t                    //判断是否显示  查看更多按钮\n\t                    var showNum = null;\n\t                    var dlShowBorder = null;\n\t                    var showMall = null;\n\t                    if (subReplyQuantity > listSize) {\n\t                        showMall = true;\n\t                        dlShowBorder = \"clearfix\";\n\t                        showNum = listSize;\n\t                    } else {\n\t                        showMall = false;\n\t                        showNum = parseInt(subTop.length);\n\t                        dlShowBorder = \"clearfix bd-bottom\";\n\t                    }\n\t                    var UserId = checkUserId(topicMsg.user.id);\n\t                    var showReport = $is_Login == 1 && $_CONFIG['userId'] != topicMsg.user.id ? true : false;\n\t                    var showSecComm = showNum > 0 ? \"\" : \"hide\";\n\t                    for (var j = 0; j < showNum; j++) {\n\t                        var subTopMsg = subTop[j];\n\t                        if (subTopMsg) {\n\t                            // console.log(subTopMsg.creatorId +\" \" +subTopMsg.user.id);\n\t                            //判断是二级评论还是三级评论\n\t                            var replayToPub = null;\n\t                            var beReplyUserName = \"\";\n\t                            var beReplyUserId = \"\";\n\t                            var threeUserId = \"javascript:;\";\n\t                            if (subTopMsg.topicSubReplyUser) {\n\t                                // 三级回复\n\t\n\t                                replayToPub = true;\n\t                                beReplyUserName = subTopMsg.topicSubReplyUser.nickname;\n\t                                beReplyUserId = subTopMsg.topicSubReplyUser.id;\n\t                                threeUserId = checkUserId(beReplyUserId);\n\t                            } else {\n\t                                //二级回复\n\t                                replayToPub = false;\n\t                            }\n\t\n\t                            var contentSed = subTopMsg.content;\n\t                            contentSed = changeContent(contentSed);\n\t                            var SenUserId = \"\";\n\t                            if (subTopMsg.user) {\n\t                                SenUserId = checkUserId(subTopMsg.user.id);\n\t                            }\n\t                            //var SenUserId =  checkUserId(subTopMsg.user.id);\n\t\n\t                            //二级回复中参数\n\t                            var replySecMsg = {\n\t                                \"threeUserId\": threeUserId,\n\t                                \"SenUserId\": SenUserId,\n\t                                \"parentCommentId\": topicMsg.id, //话题id\n\t                                // \"topicId\": topicId, //\n\t                                \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n\t                                \"content\": contentSed, //回复内容\n\t                                \"replyUserName\": subTopMsg.user.nickname, //回复人昵称\n\t                                \"replyUserId\": subTopMsg.user.id, //回复人id\n\t                                \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n\t                                \"beReplyUserId\": beReplyUserId, //被回复人的id\n\t                                \"replyCommentId\": subTopMsg.id // 二级回复内容id\n\t                            };\n\t\n\t                            replySecArr.push(replySecMsg);\n\t                        }\n\t                    }\n\t\n\t                    var content = topicMsg.content; //获取一级评论内容\n\t                    content = changeContent(content);\n\t                    var topicPic = topicMsg.pics; //一级评论的图片\n\t                    //var str = \"\";\n\t                    var imageStr = \"\";\n\t                    if (topicPic.length > 0) {\n\t                        var imgsrcPic = {\n\t                            picsSrc: topicPic,\n\t                            picture: topicMsg.pictures,\n\t                            length: topicPic.length\n\t                        };\n\t                        imageStr = addImageTpl(imgsrcPic);\n\t\n\t                        //addImageTpl\n\t                        // var imgArr = topicPic;\n\t                        // var imgArrLen = imgArr.length;\n\t\n\t                        // $.each(imgArr, function(index, img) {\n\t                        //     str += '<li><a href=\"javascript:;\"><img src=\"'+img+'\"></a></li>';\n\t                        //     //str += \"</br><img     data-original=\" + img + \"  >\";\n\t                        // })\n\t                        // imageStr =  '<ul class=\"clearfix comments-imglist\">'+str+'</ul>';\n\t                    }\n\t                    //content = content + str;\n\t                    //商品参数添加\n\t\n\t                    var itemsPic = \"\"; //商品图标\n\t                    var itemShopName = \"\"; //\n\t                    var itemPrice = \"\";\n\t                    var shopId = \"\";\n\t                    var itemShopId = \"\";\n\t                    var itemShopNameItem = \"\";\n\t                    var skuId = \"\";\n\t                    //var rebate = \"\";\n\t                    //var rebateSummary = \"\";\n\t                    if (topicMsg.item) {\n\t\n\t                        itemsPic = topicMsg.item.mainImage;\n\t                        itemShopNameItem = topicMsg.item.name;\n\t                        itemPrice = topicMsg.item.salePrice !== null ? topicMsg.item.salePrice : '暂无售价';\n\t                        shopId = topicMsg.item.id;\n\t                        itemShopId = topicMsg.item.id;\n\t                        skuId = topicMsg.item.skuId;\n\t                        //rebate = topicMsg.item.rebateSummary.mostRebate;\n\t                        // rebateSummary = topicMsg.item.rebateSummary; //返利金额\n\t\n\t                        /*\n\t                        \"discount\": 0, // 直降金额\n\t                        \"id\": 1179,  //商品id\n\t                        \"mainImage\": \"http://img.gomein.net.cn/image/prodimg/production_image/img/1000083845/1000027654\",\n\t                        \"name\": \"尤尼克斯（YONEX）SHB-60C羽毛球鞋\",\n\t                        \"originalPrice\": 18400, //市场价格\n\t                        \"price\": 18400,\n\t                        \"salePrice\": 18400, 售价\n\t                        \"saleQuantity\": 16, 销量\n\t                        \"shopId\": 3,\n\t                        \"skuHighestPrice\": 45900,\n\t                        \"status\": -1,\n\t                        \"stock\": 50000\n\t                        */\n\t                    }\n\t\n\t                    //店铺参数\n\t                    var shopPic = \"\";\n\t                    var redPackage = \"\";\n\t                    if (topicMsg.shop) {\n\t                        shopPic = topicMsg.shop.icon;\n\t                        itemShopName = topicMsg.shop.name;\n\t                        if (topicMsg.shop.promotionMark) {\n\t                            redPackage = topicMsg.shop.promotionMark.hasCouponPlan; //是否有优惠券\n\t                        }\n\t                        //redPackage = topicMsg.shop.promotionMark.hasCouponPlan; //是否有优惠券\n\t                        itemShopId = topicMsg.shop.id;\n\t                    }\n\t                    //所有参数集合\n\t                    var showDateList = {\n\t                        \"showSecComm\": showSecComm,\n\t                        \"imageStr\": imageStr,\n\t                        \"itemShopNameItem\": itemShopNameItem,\n\t                        \"UserId\": UserId,\n\t                        \"dlShowBorder\": dlShowBorder,\n\t                        \"showMall\": showMall,\n\t                        \"userIsExpert\": $userIsExpert, //当前用户是否是达人\n\t                        \"isExpert\": topicMsg.expertInfo.isExpert, //是否是达人\n\t                        \"userPic\": topicMsg.user.facePicUrl, //用户头像\n\t                        \"username\": topicMsg.user.nickname, //用户昵称\n\t                        \"backTopicId\": topicMsg.id, //本条评论id\n\t                        \"content\": face.parseEmoji(content), //过滤之后的内容\n\t                        \"topicType\": topicMsg.replyType, // 评论类型\n\t                        \"topicId\": topicMsg.topicId, // 话题id\n\t                        \"currUserImg\": currUserImg, // 当前用户的头像，在二级评论框中显示\n\t                        \"times\": fromNow(timeString(topicMsg.createTime)), //评论时间\n\t                        \"isFirstCom\": false, // 是否是一级评论  --  判断是否显示二级评论\n\t                        \"secondReply\": replySecArr, // 二级评论数组\n\t                        //商品参数\n\t                        \"mall_domain\": $mall_domain,\n\t                        \"itemsPic\": itemsPic,\n\t                        \"itemShopName\": itemShopName,\n\t                        \"itemPrice\": itemPrice,\n\t                        \"shopId\": shopId,\n\t                        \"itemShopId\": itemShopId,\n\t                        \"skuId\": skuId ? \"-\" + skuId : \"\",\n\t                        // 店铺参数\n\t                        \"redPackage\": redPackage,\n\t                        \"shopPic\": shopPic,\n\t                        //举报\n\t                        \"showReport\": showReport,\n\t                        //\"rebate\": rebate,\n\t                        \"kid\": topicMsg.kid\n\t                    };\n\t\n\t                    var item = commentList(showDateList);\n\t                    //$circleCom.append($(item));\n\t                    $thisObjId.append($(item));\n\t                    $loading.css(\"display\", \"none\");\n\t                    $loadlist.css(\"display\", \"block\");\n\t\n\t                    $(\"img\").lazyload({\n\t                        effect: \"fadeIn\"\n\t                    });\n\t\n\t                    //没有登录时不显示 “回复”\n\t                    if ($is_Login == \"0\") {\n\t                        $secondCom_Key.css(\"display\", \"none\");\n\t                    }\n\t                    if (topicReplys.length < pageSize) {\n\t                        $loadlist.css(\"display\", \"none\");\n\t                    }\n\t                }\n\t                //fixedTopic.init();\n\t                if (nodelist) {\n\t\n\t                    //console.log(id);\n\t                    // var height = $(\"[data-comtopicid=\"+id+\"]\").height() - windowHeight;\n\t                    //console.log(height);\n\t                    $(window).scrollTop(height);\n\t                }\n\t            } else {\n\t                $loading.css(\"display\", \"none\");\n\t                if (pageSize == 1) {\n\t                    $hidDiv.css(\"display\", \"none\");\n\t                }\n\t            }\n\t        } else {\n\t            $loadlist.css(\"display\", \"none\");\n\t            // $noload.css(\"display\", \"block\");\n\t            $loading.css(\"display\", \"none\");\n\t        }\n\t    });\n\t};\n\t\n\tfunction checkUserId(id) {\n\t\n\t    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n\t        return $_CONFIG.i_domain + 'member/profileHome';\n\t    } else {\n\t        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n\t    }\n\t}\n\t\n\tfunction timeString(str) {\n\t    var date = new Date(str);\n\t    var fullYear = date.getFullYear();\n\t    var month = date.getMonth() + 1;\n\t    var day = date.getDate();\n\t    var hh = date.getHours();\n\t    var mm = date.getMinutes();\n\t    var ss = date.getSeconds();\n\t\n\t    function addZero(num) {\n\t\n\t        var newNum = \"\";\n\t        if (parseInt(num) < 10) {\n\t            newNum = \"0\" + num;\n\t        } else {\n\t            newNum = num;\n\t        }\n\t        return newNum;\n\t    }\n\t\n\t    return fullYear + \"-\" + addZero(month) + \"-\" + addZero(day) + \" \" + addZero(hh) + \":\" + addZero(mm) + \":\" + addZero(ss);\n\t}\n\t\n\tmodule.exports = getCommentList;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3), __webpack_require__(2)))\n\n/***/ }),\n/* 247 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t//话题评论内容转换\n\t\n\tvar encodeHtml = __webpack_require__(74);\n\tvar face = __webpack_require__(75);\n\t\n\tfunction htmlNull(str) {\n\t    var re = str.replace(/\\n|\\r\\n/g, \"</br>\");\n\t    return re; //去掉所有的html标记\n\t}\n\t\n\tvar changeContent = function changeContent(content) {\n\t    content = encodeHtml(content);\n\t    content = face.parseEmoji(content);\n\t    content = htmlNull(content);\n\t    return content;\n\t};\n\t\n\tmodule.exports = changeContent;\n\n/***/ }),\n/* 248 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\t// 传入的时间格式  2016-04-27 15:12:58\n\tvar fromNow = function fromNow(timeStr, max) {\n\t    /**\n\t      1）1个小时以内发表的消息，显示发表的分钟数，如“20分钟前”；\n\t      2）在24小时以内，发表的信息，显示具体小时数，如“15小时前”；\n\t      3）大于24小时小于48小时，发表的消息，显示昨天；\n\t      4）大于48小时小于72小时，发表的消息，显示2天前；大于72小时小于96小时，发表的消息，显示3天前；依此类推，最多到7天前\n\t      5）超过7天前，显示具体年/月/日\n\t    **/\n\t\n\t    var showTime = \"\";\n\t    var time = new Date(timeStr).getTime();\n\t    var date = new Date().getTime();\n\t    var num = date - time;\n\t    var maxDay = max || 7;\n\t    var oneMin = 60000,\n\t        oneHour = 3600000,\n\t        oneDay = 24 * 3600000;\n\t    var s;\n\t    if (num < oneMin) {\n\t        showTime = '1分钟前';\n\t        //console.log(showTime);\n\t    } else if (num >= oneMin & num < oneHour) {\n\t        s = Math.floor(num / oneMin);\n\t        showTime = s + \"分钟前\";\n\t        //console.log(showTime);\n\t    } else if (num >= oneHour & num < oneDay) {\n\t        s = Math.floor(num / oneHour);\n\t        showTime = s + \"小时前\";\n\t        //console.log(showTime);\n\t    } else if (num >= oneDay & num < 2 * oneDay) {\n\t        s = Math.floor(num / oneDay);\n\t        showTime = \"昨天\";\n\t        //console.log(showTime);\n\t    } else if (num >= 2 * oneDay & num < maxDay * oneDay) {\n\t        s = Math.floor(num / oneDay);\n\t        showTime = s + \"天前\";\n\t        //console.log(showTime);\n\t    } else {\n\t        var getd = timeStr.split(' ');\n\t        showTime = getd[0];\n\t    }\n\t    return showTime;\n\t};\n\tmodule.exports = fromNow;\n\n/***/ }),\n/* 249 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/comment/commentList',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dlShowBorder=$data.dlShowBorder,userSubmit=$data.userSubmit,UserId=$data.UserId,isExpert=$data.isExpert,userPic=$data.userPic,backTopicId=$data.backTopicId,topicType=$data.topicType,topicId=$data.topicId,showReport=$data.showReport,username=$data.username,times=$data.times,$string=$utils.$string,content=$data.content,itemsPic=$data.itemsPic,itemShopNameItem=$data.itemShopNameItem,itemPrice=$data.itemPrice,rebate=$data.rebate,mall_domain=$data.mall_domain,shopId=$data.shopId,skuId=$data.skuId,kid=$data.kid,itemShopId=$data.itemShopId,imageStr=$data.imageStr,showSecComm=$data.showSecComm,isFirstCom=$data.isFirstCom,$each=$utils.$each,secondReply=$data.secondReply,value=$data.value,i=$data.i,imId=$data.imId,showMall=$data.showMall,groupId=$data.groupId,replyCommentNum=$data.replyCommentNum,currentPage=$data.currentPage,pageSize=$data.pageSize,userIsExpert=$data.userIsExpert,currUserImg=$data.currUserImg,$out='';$out+=' <dl class=\"';\n\t$out+=$escape(dlShowBorder);\n\t$out+=' \" ';\n\tif(userSubmit){\n\t$out+=' data-node=\"userSubmit\"';\n\t}\n\t$out+='> <dt> <a href=\"';\n\t$out+=$escape(UserId);\n\t$out+='\" target=\"_blank\"> ';\n\tif(isExpert){\n\t$out+=' <em class=\"icon-daren\"></em>';\n\t}\n\t$out+=' <img src=\"';\n\t$out+=$escape(userPic);\n\t$out+='\" onerror=\"imgError(this, \\'g\\')\"> </a> </dt> <dd data-ddList=\"';\n\t$out+=$escape(backTopicId);\n\t$out+='\"> <div class=\"circle-comments-title\" data-topicType=';\n\t$out+=$escape(topicType);\n\t$out+=' data-htId=';\n\t$out+=$escape(backTopicId);\n\t$out+=' data-tid=';\n\t$out+=$escape(topicId);\n\t$out+='> <p class=\"comments-replay\" data-node=\"comReplay\"> ';\n\tif(showReport){\n\t$out+=' <a href=\"javascript:;\" class=\"replay-report\" data-action=\"topic-report\" data-type=\"1\">举报</a> <span class=\"line\"></span> ';\n\t}\n\t$out+=' <a href=\"javascript:;\" data-node=\"secondCom_Key\" data-comId=\"';\n\t$out+=$escape(backTopicId);\n\t$out+='\" data-replayUser=';\n\t$out+=$escape(username);\n\t$out+=' data-publish=\"1\">回复</a> </p> <a href=\"';\n\t$out+=$escape(UserId);\n\t$out+='\" target=\"_blank\">';\n\t$out+=$escape(username);\n\t$out+='</a> <span>';\n\t$out+=$escape(times);\n\t$out+='</span> </div> <div class=\"first-comment\"> <p class=\"clearfix\">';\n\t$out+=$string(content);\n\t$out+='</p> ';\n\tif(topicType==\"1\"){\n\t$out+=' <div class=\"reply-details merchant\"> <div class=\"reply-picture\"> <img src=\"';\n\t$out+=$escape(itemsPic);\n\t$out+='\" onerror=\"imgError(this)\"> </div> <div class=\"reply-contxt\"> <p>';\n\t$out+=$escape(itemShopNameItem);\n\t$out+='</p> <div class=\"price\"> <p class=\"price-numb\">￥<span>';\n\t$out+=$escape(itemPrice);\n\t$out+='</span></p> <!-- ';\n\tif(rebate > 0){\n\t$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n\t$out+=$escape(rebate);\n\t$out+='国美币</span> </div> ';\n\t}\n\t$out+=' --> </div> </div> <a href=\"';\n\t$out+=$escape(mall_domain);\n\t$out+=$escape(shopId);\n\t$out+=$escape(skuId);\n\t$out+='.html';\n\tif(kid){\n\t$out+='?kid=';\n\t$out+=$escape(kid);\n\t}\n\t$out+='\" target=\"_blank\" class=\"see-details pc-btn pc-btnw105 pc-btnh40\" data-shopId=';\n\t$out+=$escape(shopId);\n\t$out+=' data-itemShopId=';\n\t$out+=$escape(itemShopId);\n\t$out+=' data-node=\"checkDetailMsg\">查看详情</a> </div> ';\n\t}\n\t$out+=' ';\n\t$out+=$string(imageStr);\n\t$out+=' </div> <div class=\"comments-box ';\n\t$out+=$escape(showSecComm);\n\t$out+='\"> ';\n\tif(!isFirstCom){\n\t$out+=' ';\n\t$each(secondReply,function(value,i){\n\t$out+=' <div class=\"comments-s\" data-topicType=';\n\t$out+=$escape(topicType);\n\t$out+=' data-htId=';\n\t$out+=$escape(backTopicId);\n\t$out+=' data-tid=';\n\t$out+=$escape(topicId);\n\t$out+='> <a href=\"';\n\t$out+=$escape(value.SenUserId);\n\t$out+='\" target=\"_blank\" data-replyUserId=';\n\t$out+=$escape(value.replyUserId);\n\t$out+='>';\n\t$out+=$escape(value.replyUserName);\n\t$out+='</a> ';\n\tif(value.replayToPub){\n\t$out+=' ：<span>回复</span> ';\n\t}\n\t$out+=' <a href=\"';\n\t$out+=$escape(value.threeUserId);\n\t$out+='\" target=\"_blank\" data-replyCommentId =';\n\t$out+=$escape(value.replyCommentId);\n\t$out+='>';\n\t$out+=$escape(value.beReplyUserName);\n\t$out+=':</a> <span data-replyCommentId=';\n\t$out+=$escape(value.replyCommentId);\n\t$out+='>';\n\t$out+=$string(value.content);\n\t$out+='</span> <a href=\"javascript:;\" class=\"hf-btn fr\" data-getTopicId=';\n\t$out+=$escape(backTopicId);\n\t$out+=' data-node=\"secondCom_Key\" data-replayUser=';\n\t$out+=$escape(value.replyUserName);\n\t$out+=' data-publish=\"0\" data-comId=\"';\n\t$out+=$escape(value.parentCommentId);\n\t$out+='\" data-replyCommentId =';\n\t$out+=$escape(value.replyCommentId);\n\t$out+=' data-replyUserId=';\n\t$out+=$escape(value.replyUserId);\n\t$out+=' data-imId=';\n\t$out+=$escape(imId);\n\t$out+='>回复</a> </div> ';\n\t});\n\t$out+=' ';\n\t}\n\t$out+=' </div> </dd> </dl> ';\n\tif(!isFirstCom){\n\t$out+=' ';\n\tif(showMall){\n\t$out+=' <a href=\"javascript:;\" class=\"comments-more\" data-node=\"showMoreList\" data-groupId=';\n\t$out+=$escape(groupId);\n\t$out+=' data-imId=';\n\t$out+=$escape(imId);\n\t$out+=' data-topicType=';\n\t$out+=$escape(topicType);\n\t$out+=' data-htId=';\n\t$out+=$escape(backTopicId);\n\t$out+=' data-tid=';\n\t$out+=$escape(topicId);\n\t$out+=' data-tootlePages=';\n\t$out+=$escape(replyCommentNum);\n\t$out+=' data-currentPage= ';\n\t$out+=$escape(currentPage);\n\t$out+=' data-pageSize=';\n\t$out+=$escape(pageSize);\n\t$out+='>查看回复...</a> ';\n\t}\n\t$out+=' ';\n\t}\n\t$out+=' <a class=\"pack-up\" style=\"display: none\" data-node=\"hideComBox\" data-parentTopicIdBtn=';\n\t$out+=$escape(backTopicId);\n\t$out+='>收起</a> <div class=\"text-field-box clearfix secondText margin-width\" style=\"display: none\" data-parentTopicId=';\n\t$out+=$escape(backTopicId);\n\t$out+='> <div class=\"topic-user-head\"> ';\n\tif(userIsExpert){\n\t$out+=' <em class=\"icon-daren\"></em>';\n\t}\n\t$out+=' <img src=\"';\n\t$out+=$escape(currUserImg);\n\t$out+='\" onerror=\"imgError(this, \\'g\\')\"> </div> <div class=\"topic-publish-content\"> <textarea placeholder=\"说点什么吧…\" class=\"textarea-bx secondT\"></textarea> <label class=\"textarea-tips hide\" data-node=\"textareaTips\"></label> <div class=\"publish-face-bx\"> <p class=\"icon-face\" data-node=\"smilies_Face\"><em class=\"icon-emoji\"></em> 表情</p> <a href=\"javascript:;\" class=\"pc-btn pc-btnh30 pc-btnw105\" data-node=\"a_secondComBtn\" data-getTopicId=';\n\t$out+=$escape(backTopicId);\n\t$out+='>发布</a> </div> </div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 250 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/comment/addImageTpl',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,picsSrc=$data.picsSrc,value=$data.value,i=$data.i,$escape=$utils.$escape,length=$data.length,picture=$data.picture,$out='';$out+=' <div class=\"comments-imglist\" > <ul class=\"clearfix comments-imglist\" > ';\n\t$each(picsSrc,function(value,i){\n\t$out+=' <li data-imgSort=';\n\t$out+=$escape(i);\n\t$out+=' data-node=\"imgPics\"><a href=\"javascript:;\"><img src=\"';\n\t$out+=$escape(value);\n\t$out+='\"></a></li> ';\n\t});\n\t$out+=' </ul> <div class=\"imglist-big hide\" data-node=\"imgBigPic\"> <div class=\"big-title\"> <a href=\"javascript:;\" data-node=\"imgBigHind\"><em class=\"icon-up\"></em>收起</a> <a href=\"javascript:;\" data-node=\"imgBigSrc\" target=\"_blank\"><em class=\"icon-view-img\"></em>查看原图</a> </div> <div class=\"big-img\" data-picLength=\"';\n\t$out+=$escape(length);\n\t$out+='\"> <div class=\"img-hidden\"> ';\n\t$each(picture,function(value,i){\n\t$out+=' <div class=\"img-box\" data-bigImg=';\n\t$out+=$escape(i);\n\t$out+=' data-node=\"hideBigPic\"><img class=\"srcError\" data-imgsrc = \"';\n\t$out+=$escape(value.url);\n\t$out+='\"></div> ';\n\t});\n\t$out+=' </div> <em class=\"icon-left\" data-node=\"imgBigPN\" data-page=\"pre\"></em> <em class=\"icon-right\" data-node=\"imgBigPN\" data-page=\"next\"></em> </div> <div class=\"img-slide\"> ';\n\t$each(picture,function(value,i){\n\t$out+=' <a href=\"javascript:;\" data-node=\"showImg\" data-active=\"';\n\t$out+=$escape(i);\n\t$out+='\" ></a> ';\n\t});\n\t$out+=' </div> </div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 251 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\t/*\n\t\t一级评论\n\t*/\n\tvar $is_Login = 1;\n\tvar alert = __webpack_require__(36);\n\tvar hint = __webpack_require__(44);\n\t//var fixedTopic = require('../fixedTopic');\n\tvar commentList = __webpack_require__(249);\n\tvar changeContent = __webpack_require__(247); //评论内容转换\n\tvar checkLoginStatus = __webpack_require__(23); //登陆判断\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar loginState = __webpack_require__(252);\n\tvar face = __webpack_require__(75);\n\tvar fromNow = __webpack_require__(248);\n\t//var addImg = require('./addImgGoods/addIMG');\n\tvar addImageTpl = __webpack_require__(250);\n\t\n\t// 敏感词过滤\n\tvar sensitiveContent = __webpack_require__(207);\n\t\n\tvar $comment_Msg = $(\"[data-node='comment_Msg']\");\n\tvar $userIsExpert = $_CONFIG['isExpert'];\n\t//var $circleCom = $(\"[data-node=circleCom]\");\n\t\n\tvar $mall_domain = $_CONFIG[\"product_item_gome\"]; // 商城\n\t\n\tvar a_Submit = function a_Submit() {\n\t\n\t    // 判断是否登陆，没登录，显示登录框\n\t    if (!checkLoginStatus()) {\n\t        loginState.popUnion();\n\t        return false;\n\t    }\n\t\n\t    var currUserImg = $comment_Msg.attr(\"data-headface\"); //头像\n\t    var parentDiv = $(this).parents().eq(1);\n\t    var comment_Msg = parentDiv.children(\"textarea\").val();\n\t    comment_Msg = comment_Msg.trim(); //对输入空格进行过滤\n\t    if (comment_Msg) {\n\t        if (sensitiveContent(comment_Msg, true)) {\n\t            return false;\n\t        }\n\t    }\n\t\n\t    //var data_userid = parentDiv.attr(\"data-userid\");\n\t    var topicid = parentDiv.attr(\"data-tid\");\n\t\n\t    //var imgPics = parentDiv.find(\"[data-node=imgUl]\").attr(\"data-imgsrt\");\n\t    var lis = parentDiv.find(\"[data-node='imgUl']\").children(\"li\");\n\t    var imgPics = [];\n\t\n\t    for (var i = 0; i < lis.length; i++) {\n\t        //console.log(lis[i]);\n\t        var imgObj = $(lis[i]).find(\"img\").attr(\"src\");\n\t        if (imgObj) {\n\t            imgPics.push(imgObj);\n\t        }\n\t    }\n\t\n\t    var $addImgGoods = parentDiv.find(\"[data-node='addImgGoods']\");\n\t\n\t    //var shopid = $(\"[data-node=goodsDiv]\").attr(\"data-shopId\");\n\t\n\t    if (comment_Msg || imgPics.length || $addImgGoods.hasClass(\"hasGoods\")) {\n\t        //var imId = \"b_\" + data_userid;\n\t        //var businessid = 0;\n\t        var topicType = null;\n\t        var shopId = \"\";\n\t        var itemid = \"\";\n\t        var skuId = \"\";\n\t        if ($addImgGoods.hasClass(\"hasGoods\")) {\n\t            var $goodIn = $addImgGoods.find(\"[data-node='goodsIn']\");\n\t            shopId = $goodIn.attr(\"data-shopId\");\n\t            itemid = $goodIn.attr(\"data-itemId\");\n\t            skuId = $goodIn.attr(\"data-skuId\");\n\t            topicType = 1;\n\t        } else {\n\t            topicType = 0;\n\t        }\n\t        var params = {\n\t            \"reply_type\": topicType, //回复的类型\n\t            \"topicid\": topicid, //话题id\n\t            \"content\": comment_Msg, //话题回复内容\n\t            \"pics\": imgPics, //话题回复图片\n\t            \"shopid\": shopId, //如果topicType = 1 或者 =2 那么这个字段必填\n\t            \"itemid\": itemid //如果topicType = 1 那么这个字段必填\n\t        };\n\t        if (skuId) {\n\t            params.skuid = skuId;\n\t        }\n\t\n\t        //提交请求\n\t        fetch.post(url.get('commentFirstV2'), {\n\t            data: params\n\t        }).then(function (data) {\n\t            if (data.success) {\n\t                var Msg = data.data;\n\t                var contentMsg = Msg.content;\n\t                contentMsg = changeContent(contentMsg);\n\t                parentDiv.children(\"textarea\").val(\"\");\n\t\n\t                var imageStr = null;\n\t\n\t                if (Msg.pics.length > 0) {\n\t                    var imgsrcPic = {\n\t                        \"picsSrc\": Msg.pics,\n\t                        \"picture\": Msg.pictures,\n\t                        \"length\": Msg.pics.length\n\t                    };\n\t                    imageStr = addImageTpl(imgsrcPic);\n\t                    //console.log(Msg.pics);\n\t                }\n\t                var mall_domain = \"\",\n\t                    itemsPic = \"\",\n\t                    itemShopName = \"\",\n\t                    itemPrice = \"\",\n\t                    shopId = \"\",\n\t                    itemShopId = \"\",\n\t                    skuId = \"\";\n\t                //rebate= \"\";\n\t                if (Msg.item) {\n\t                    // var goodStr = $(\"[data-node=addImgGoods]\").attr(\"data-goodStr\");\n\t                    var goodObj = Msg.item;\n\t                    mall_domain = $mall_domain;\n\t                    itemsPic = goodObj.mainImage;\n\t                    itemShopName = goodObj.name;\n\t                    itemPrice = goodObj.salePrice !== null ? goodObj.salePrice : '暂无售价';\n\t                    shopId = goodObj.id;\n\t                    itemShopId = Msg.id;\n\t                    skuId = Msg.skuId ? \"-\" + Msg.skuId : \"\";\n\t                    //rebate = goodObj.rebateSummary.mostRebate;\n\t                }\n\t\n\t                //time = timeString(Msg.createTime);\n\t                var UserId = checkUserId(data.data.user.id);\n\t                var showReport = $is_Login == 1 && $_CONFIG['userId'] != data.data.user.id ? true : false;\n\t                var basics = {\n\t                    \"showSecComm\": \"hide\",\n\t                    \"mall_domain\": mall_domain,\n\t                    \"itemsPic\": itemsPic,\n\t                    \"itemShopNameItem\": itemShopName,\n\t                    \"itemPrice\": itemPrice,\n\t                    \"shopId\": shopId,\n\t                    \"itemShopId\": itemShopId,\n\t                    \"skuId\": skuId,\n\t                    \"imageStr\": imageStr,\n\t                    \"UserId\": UserId,\n\t                    \"dlShowBorder\": \"clearfix bd-bottom\",\n\t                    \"userIsExpert\": $userIsExpert, //当前用户是否是达人\n\t                    \"isExpert\": Msg.expertInfo.isExpert, //是否是达人\n\t                    \"userPic\": Msg.user.facePicUrl, //用户头像\n\t                    \"username\": Msg.user.nickname, //用户昵称\n\t                    \"backTopicId\": Msg.id, //本条评论id\n\t                    \"content\": face.parseEmoji(contentMsg), //过滤之后的内容\n\t                    \"topicType\": topicType, // 评论类型\n\t                    \"topicId\": Msg.topicId, // 话题id\n\t                    \"currUserImg\": currUserImg, // 当前用户的头像，在二级评论框中显示\n\t                    \"times\": fromNow(timeString(Msg.createTime)), //评论时间\n\t                    \"isFirstCom\": true, // 是否是一级评论  --  判断是否显示二级评论\n\t                    \"userSubmit\": true, //是否用户自己发布的评论\n\t                    \"showReport\": showReport, //是否显示举报\n\t                    //\"rebate\": rebate, //是否显示返利\n\t                    \"kid\": Msg.kid\n\t                    //$(\"[data-node=noload]\").css(\"display\", \"none\");\n\t                };$(\"[data-node='hidDiv']\").css(\"display\", \"block\");\n\t\n\t                var item = commentList(basics);\n\t                //$circleCom.append($(item));\n\t\n\t                $(\"[data-circlecom='\" + topicid + \"']\").append($(item));\n\t                //console.log($(\"[data-circlecom=\"+topicid+\"]\").attr(\"class\"));\n\t                //var newDL = $(\"[data-ddlist=\" + basics.backTopicId + \"]\");\n\t\n\t                // 商品选择列表清空\n\t                // 图片列表清空\n\t                $(\"[data-tid='\" + topicid + \"']\").children('[data-node=\"addImgGoods\"]').attr(\"data-imgnum\", 9).attr(\"data-goodstr\", \"\").removeClass(\"hasGoods\");\n\t                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='imgUl']\").attr(\"data-imgsrt\", \"\").addClass(\"hide\").children(\".imgClass\").remove();\n\t                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='addGoods_btn']\").removeClass(\"disabled\");\n\t                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='addImg_btn']\").removeClass(\"disabled\");\n\t                $(\"[data-node='goodsIn']\").remove();\n\t\n\t                var idNode = $(\"[id-node='\" + topicid + \"']\");\n\t                $(\"body,html\").animate({ //？？？？？有问题\n\t                    scrollTop: parseInt(idNode.height() + idNode.offset().top - $(window).height() / 2)\n\t\n\t                });\n\t                hint.init(\"评论成功\");\n\t            } else {\n\t\n\t                if (data.code === 881001) {\n\t                    alert(\"评论内容不能超过200个汉字\");\n\t                } else if (data.code === 404 || data.code === 410) {\n\t                    alert(\"抱歉，该话题已被删除\", {\n\t                        ok: function ok() {\n\t                            window.location.href = \"/index/get_error?code=topic_404\";\n\t                        }\n\t                    });\n\t                } else if (data.code === 422) {\n\t                    alert(\"抱歉，服务器君正在打盹\", {\n\t                        ok: function ok() {\n\t                            window.location.href = \"/index/get_error?code=500\";\n\t                        }\n\t                    });\n\t                } else if (data.code === 403) {\n\t                    alert(\"抱歉，该话题审核不通过！\", {\n\t                        ok: function ok() {\n\t                            window.location.href = \"/index/get_error?code=topic\";\n\t                        }\n\t                    });\n\t                } else {\n\t                    alert(data.message);\n\t                }\n\t            }\n\t        });\n\t    } else {\n\t        alert(\"请输入评论内容！\");\n\t    }\n\t};\n\t\n\tfunction checkUserId(id) {\n\t    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n\t        return $_CONFIG.i_domain + 'member/profileHome';\n\t    } else {\n\t        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n\t    }\n\t}\n\t\n\tfunction timeString(str) {\n\t    var date = new Date(str);\n\t    var fullYear = date.getFullYear();\n\t    var month = date.getMonth() + 1;\n\t    var day = date.getDate();\n\t    var hh = date.getHours();\n\t    var mm = date.getMinutes();\n\t    var ss = date.getSeconds();\n\t\n\t    function addZero(num) {\n\t\n\t        var newNum = \"\";\n\t        if (parseInt(num) < 10) {\n\t            newNum = \"0\" + num;\n\t        } else {\n\t            newNum = num;\n\t        }\n\t        return newNum;\n\t    }\n\t\n\t    return fullYear + \"-\" + addZero(month) + \"-\" + addZero(day) + \" \" + addZero(hh) + \":\" + addZero(mm) + \":\" + addZero(ss);\n\t}\n\t\n\tmodule.exports = a_Submit;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 252 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {\"use strict\";\n\t\n\t// 判断登陆状态\n\tvar checkLoginStatus = __webpack_require__(23); // 登陆判断\n\tvar $comment_Msg = $(\"[data-node='comment_Msg']\");\n\tvar $a_Submit = $(\"[data-node='a_Submit']\");\n\t\n\t//var getCommentList = require('./getCommentList'); //\n\tvar loginPop = __webpack_require__(22); //登录弹窗\n\t//var checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\n\t\n\t//var $is_Login = checkLoginStatus() == true ? 1 : 0;\n\t\n\t\n\tvar getLoginState = function getLoginState() {\n\t    var ISLOGIN = null;\n\t    if (!checkLoginStatus()) {\n\t        //必须重新判断 别的无刷新事件修改了登录状态\n\t        //没有登录\n\t        ISLOGIN = \"0\";\n\t        $comment_Msg.children(\"textarea\").attr(\"readonly\", \"readonly\").css(\"background\", \"#fff\");\n\t        $(\"[data-node='secondCom_Key']\").css(\"display\", \"none\");\n\t    } else {\n\t        $comment_Msg.children(\"textarea\").removeAttr(\"readonly\").css(\"background\", \"transparent\");\n\t\n\t        $a_Submit.removeClass(\"pc-bj-fc8753\").html(\"发布\");\n\t\n\t        $(\"[data-node='secondCom_Key']\").css(\"display\", \"block\");\n\t        //添加事件\n\t        ISLOGIN = \"1\";\n\t    }\n\t    return ISLOGIN;\n\t};\n\t\n\t// var loginCallback = function() {\n\t//     $is_Login = 1;\n\t//     getLoginState();\n\t//     $(\".topic-publish-content\").children(\"textarea\").removeAttr(\"readonly\").css(\"background\", \"transparent\");\n\t//     $(\".publish-face-bx\").children(\"a\").removeClass(\"pc-bj-fc8753\").html(\"发布\");\n\t//     //$(\"[data-node=circleCom]\").empty();\n\t//     //getCommentList(1, 10, 2);\n\t// }\n\t\n\tvar popUnion = function popUnion() {\n\t    loginPop();\n\t};\n\t\n\tvar commentCheck = function commentCheck() {\n\t    if (!checkLoginStatus()) {\n\t        popUnion();\n\t        return false;\n\t    }\n\t};\n\t\n\tmodule.exports = {\n\t    getLoginState: getLoginState,\n\t    popUnion: popUnion,\n\t    commentCheck: commentCheck\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 253 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar identify = __webpack_require__(245);\n\t\n\t//二级话题回复\n\tvar getCommentList = __webpack_require__(246);\n\tvar $is_Login = 1;\n\tvar alert = __webpack_require__(36);\n\t//var hint = require('module/hint.js');\n\t//var commentList = require('./commentList.tpl');\n\tvar changeContent = __webpack_require__(247); //评论内容转换\n\tvar checkLoginStatus = __webpack_require__(23); //登陆判断\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar loginState = __webpack_require__(252);\n\t//var face = require('module/popup/face/face');\n\t//var fromNow = require('utils/fromNow');\n\tvar secondComList = __webpack_require__(254);\n\t\n\t// 敏感词过滤\n\tvar sensitiveContent = __webpack_require__(207);\n\t\n\t//var $comment_Msg = $(\"[data-node=comment_Msg]\");\n\t\n\tvar a_secondComBtn = function a_secondComBtn() {\n\t\n\t    if (!checkLoginStatus()) {\n\t        loginState.popUnion();\n\t        return false;\n\t    }\n\t\n\t    var replayToPub = $(this).parents().eq(2).attr(\"data-ispublish\"); //\n\t    var beReplyId = \"\";\n\t    //var replayImid = \"\";\n\t\n\t    if (replayToPub == \"1\") {\n\t        replayToPub = false;\n\t    } else {\n\t        replayToPub = true;\n\t        beReplyId = $(this).parents().eq(2).attr(\"data-replycommentid\");\n\t        // var replayImid = \"b_\" + $(this).parents().eq(2).attr(\"data-replyuserid\");\n\t    }\n\t    //var replyUserName = $comment_Msg.attr(\"data-nickname\");\n\t    //var beReplyUserName = $(this).parents().eq(2).attr(\"data-replayto\");\n\t    var tId = $(this).attr(\"data-gettopicid\");\n\t    //var groupId = $(\"[data-htid=\" + tId + \"]\").attr(\"data-groupid\");\n\t\n\t    //var topicType = $(\"[data-htid=\" + tId + \"]\").attr(\"data-topictype\");;\n\t    var topicId = $(\"[data-htid='\" + tId + \"']\").attr(\"data-tid\");\n\t    var content = $(this).parents().eq(1).children(\"textarea\").val();\n\t    content = content.trim();\n\t    // var contentLong = \"\";\n\t\n\t    // if (content.length > 200) {\n\t    //     contentLong = true;\n\t    // } else {\n\t    //     contentLong = false;\n\t    // }\n\t    //var imId = \"b_\" + $comment_Msg.attr(\"data-userid\");\n\t    // var id = $(this).parents().eq(2).attr(\"data-replycommentid\");\n\t    var replyId = tId;\n\t\n\t    var params = {\n\t        \"topic_reply_id\": replyId,\n\t        \"topicid\": topicId,\n\t        \"content\": content,\n\t        \"topic_subreply_id\": beReplyId\n\t    };\n\t    if (content) {\n\t        if (sensitiveContent(content, true)) {\n\t            return false;\n\t        }\n\t        fetch.post(url.get('secondtopicV2'), {\n\t            data: params\n\t        }).then(function (data) {\n\t            if (data.success) {\n\t\n\t                var contentT = data.data.content;\n\t                contentT = changeContent(contentT);\n\t                //判断是二级回复还是三级回复\n\t                var beReplyUserName = \"\";\n\t                var beReplyUserId = \"\";\n\t\n\t                var SenUserId = checkUserId(data.data.user.id);\n\t                var threeUserId = \"javascript:;\";\n\t\n\t                if (replayToPub) {\n\t                    beReplyUserName = data.data.topicSubReplyUser.nickname;\n\t                    beReplyUserId = data.data.topicSubReplyUser.id;\n\t                    threeUserId = checkUserId(beReplyUserId);\n\t                }\n\t                var showCom = {\n\t                    \"SenUserId\": SenUserId,\n\t                    \"threeUserId\": threeUserId,\n\t                    \"topicType\": 0,\n\t                    \"backTopicId\": tId,\n\t                    \"parentCommentId\": tId, //话题id\n\t                    \"topicId\": data.data.topicId,\n\t                    \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n\t                    \"content\": contentT, //回复内容\n\t                    \"replyUserName\": data.data.user.nickname, //回复人昵称\n\t                    \"replyUserId\": data.data.user.id, //回复人id\n\t                    \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n\t                    \"beReplyUserId\": beReplyUserId, //被回复人的id\n\t                    \"replyCommentId\": data.data.id // 二级回复内容id\n\t                };\n\t\n\t                var item = secondComList(showCom);\n\t                $(\"[data-ddlist='\" + tId + \"']\").find(\".comments-box\").removeClass(\"hide\").append(item);\n\t                $(\"[data-parentTopicIdBtn='\" + tId + \"']\").css(\"display\", \"none\");\n\t                $(\"[data-parentTopicId='\" + tId + \"']\").css(\"display\", \"none\");\n\t                $(\"[data-parentTopicId='\" + tId + \"']\").removeAttr(\"data-replayto\");\n\t                $(\".textarea-bx\", \"[data-parentTopicId='\" + tId + \"']\").val(\"\");\n\t            } else {\n\t                if (data.code === 500 || data.message === \"请求参数为空\") {\n\t                    alert(data.message);\n\t                } else {\n\t                    // console.log(data.code);\n\t                    if (data.code === 403) {\n\t                        data.message = \"抱歉，该回复审核不通过！\";\n\t                    }\n\t                    alert(data.message, {\n\t                        ok: function ok() {\n\t                            $(\"[data-node=circleCom]\").empty();\n\t                            getCommentList(topicId, 1, 10, 2);\n\t                        }\n\t                    });\n\t                }\n\t            }\n\t        });\n\t    } else {\n\t        alert(\"请输入评论内容！\");\n\t    }\n\t};\n\t\n\t//点击回复按钮，显示二级输入框\n\tvar secondCom_Key = function secondCom_Key() {\n\t    if (!checkLoginStatus()) {\n\t        loginState.popUnion();\n\t        return false;\n\t    }\n\t\n\t    var replyuserid = $(this).attr(\"data-replyuserid\");\n\t    //var replyimId = $(this).attr(\"data-imId\");\n\t\n\t    var replycommentid = $(this).attr(\"data-replycommentid\");\n\t    var topicid = $(this).attr(\"data-comid\");\n\t    var username = $(this).attr(\"data-replayUser\");\n\t    var dataPublis = $(this).attr(\"data-publish\");\n\t    var isHide = $(\"[data-parenttopicid='\" + topicid + \"']\").css(\"display\");\n\t    var dataObj = $(\"[data-parentTopicId='\" + topicid + \"']\");\n\t\n\t    dataObj.removeAttr(\"data-replyuserid\");\n\t    //dataObj.removeAttr(\"data-imId\");\n\t    dataObj.removeAttr(\"data-replayTo\");\n\t    dataObj.removeAttr(\"data-replycommentid\");\n\t    dataObj.removeAttr(\"data-isPublish\");\n\t    //dataObj.attr(\"data-imId\",replyimId);\n\t    dataObj.attr(\"data-replyuserid\", replyuserid);\n\t    dataObj.attr(\"data-replayTo\", username);\n\t    dataObj.attr(\"data-isPublish\", dataPublis);\n\t    dataObj.attr(\"data-replycommentid\", replycommentid);\n\t    dataObj.children(\".topic-publish-content\").children(\"textarea\").attr(\"placeholder\", \"回复: \" + username);\n\t    if (identify()) {\n\t        dataObj.children(\".topic-publish-content\").children(\"label\").html(\"回复: \" + username);\n\t    }\n\t    if (isHide == \"none\") {\n\t        $(\".secondText\").css(\"display\", \"none\");\n\t        $(\".pack-up\").css(\"display\", \"none\");\n\t        dataObj.css(\"display\", \"block\");\n\t        $(\"[data-parentTopicIdBtn='\" + topicid + \"']\").css(\"display\", \"block\");\n\t\n\t        var a = $(window).scrollTop() + $(window).height();\n\t        var b = dataObj.offset().top;\n\t        if (a + 60 < b) {\n\t\n\t            $('html,body').animate({\n\t                'scrollTop': dataObj.offset().top - $(window).height() + 185\n\t            }, 200);\n\t        }\n\t\n\t        dataObj.children(\".topic-publish-content\").children(\"textarea\").focus();\n\t        if (identify()) {\n\t            dataObj.children(\".topic-publish-content\").children(\"label\").removeClass('hide');\n\t        }\n\t    }\n\t};\n\t\n\t//隐藏二级输入框\n\tvar hideComBox = function hideComBox() {\n\t    if (!checkLoginStatus()) {\n\t        loginState.popUnion();\n\t        return false;\n\t    }\n\t    var hideId = $(this).attr(\"data-parentTopicIdBtn\");\n\t    $(\"[data-parentTopicId='\" + hideId + \"']\").css(\"display\", \"none\");\n\t    $(\"[data-parentTopicId='\" + hideId + \"']\").children(\"textarea\").attr(\"placeholder\", \"说点什么吧\");\n\t    $(\"[data-parentTopicIdBtn='\" + hideId + \"']\").css(\"display\", \"none\");\n\t    $(\"[data-parentTopicId='\" + hideId + \"']\").removeAttr(\"data-isPublish\").removeAttr(\"data-replayTo\");\n\t    $(\".textarea-bx\", \"[data-parentTopicId='\" + hideId + \"']\").val(\"\");\n\t};\n\t\n\tfunction checkUserId(id) {\n\t    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n\t        return $_CONFIG.i_domain + 'member/profileHome';\n\t    } else {\n\t        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n\t    }\n\t}\n\tmodule.exports = {\n\t    a_secondComBtn: a_secondComBtn,\n\t    secondCom_Key: secondCom_Key,\n\t    hideComBox: hideComBox\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 254 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/comment/secondComList',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,topicType=$data.topicType,backTopicId=$data.backTopicId,topicId=$data.topicId,SenUserId=$data.SenUserId,replyUserId=$data.replyUserId,replyUserName=$data.replyUserName,replayToPub=$data.replayToPub,threeUserId=$data.threeUserId,replyCommentId=$data.replyCommentId,beReplyUserName=$data.beReplyUserName,$string=$utils.$string,content=$data.content,parentCommentId=$data.parentCommentId,imId=$data.imId,$out='';$out+='<div class=\"comments-s\" data-topicType=';\n\t$out+=$escape(topicType);\n\t$out+=' data-htId=';\n\t$out+=$escape(backTopicId);\n\t$out+=' data-tid=';\n\t$out+=$escape(topicId);\n\t$out+='> <a href=\"';\n\t$out+=$escape(SenUserId);\n\t$out+='\" target=\"_blank\" data-replyUserId=\"';\n\t$out+=$escape(replyUserId);\n\t$out+='\">';\n\t$out+=$escape(replyUserName);\n\t$out+='</a> ';\n\tif(replayToPub){\n\t$out+=' ：<span>回复</span> <a href=\"';\n\t$out+=$escape(threeUserId);\n\t$out+='\" target=\"_blank\" data-replyCommentId =\"';\n\t$out+=$escape(replyCommentId);\n\t$out+='\">';\n\t$out+=$escape(beReplyUserName);\n\t$out+='</a> ';\n\t}\n\t$out+=' <span data-replyCommentId=';\n\t$out+=$escape(replyCommentId);\n\t$out+='>：';\n\t$out+=$string(content);\n\t$out+='</span> <a href=\"javascript:;\" class=\"fr\" data-node=\"secondCom_Key\" data-getTopicId=';\n\t$out+=$escape(backTopicId);\n\t$out+=' data-replayUser=';\n\t$out+=$escape(replyUserName);\n\t$out+=' data-publish=\"0\" data-comId=\"';\n\t$out+=$escape(parentCommentId);\n\t$out+='\" data-replyCommentId=\"';\n\t$out+=$escape(replyCommentId);\n\t$out+='\" data-imId=\"';\n\t$out+=$escape(imId);\n\t$out+='\" data-replyUserId=';\n\t$out+=$escape(replyUserId);\n\t$out+=' >回复</a> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 255 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\t//二级列表\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar changeContent = __webpack_require__(247); //评论内容转换\n\tvar secondComList = __webpack_require__(254);\n\tvar checkLoginStatus = __webpack_require__(23); //登陆判断\n\t\n\tvar $is_Login = checkLoginStatus() == true ? 1 : 0; // 判断登陆状态\n\t\n\tvar showMoreList = function showMoreList() {\n\t\n\t    //var groupId = $(this).attr(\"data-groupId\");\n\t    //var imId = $(this).attr(\"data-imId\");\n\t    //var topicType = $(this).attr(\"data-topicType\");\n\t    var commentid = $(this).attr(\"data-htid\");\n\t    //var tid = $(this).attr(\"data-tid\");\n\t    //var tootalPages = $(this).attr(\"data-tootlePages\"); //\n\t    //var currentPage = $(this).attr(\"data-currentPage\"); //当前页数\n\t    //var pageSize = $(this).attr(\"data-pageSize\"); //当前展示列表数\n\t    //var a = Math.ceil(parseInt(tootalPages) / parseInt(pageSize)); //获取总页数\n\t    // var b = parseInt(tootalPages) % parseInt(pageSize); //获取最后一页的列表数目\n\t    //var toPage = parseInt(currentPage) + 1;\n\t    var obj = $(this);\n\t    var paramList = '?page=1&pagesize=70&topic_replyid=' + commentid;\n\t    var objHtml = obj.html();\n\t\n\t    if (objHtml === \"查看回复...\") {\n\t        getRelyList(paramList, obj);\n\t    } else {\n\t        //\n\t        var childrens = $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-s\");\n\t        //console.log(childrens);\n\t        for (var k = 2; k < childrens.length; k++) {\n\t            childrens.eq(k).remove();\n\t        }\n\t        obj.html(\"查看回复...\");\n\t    }\n\t\n\t    function getRelyList(paramList, obj) {\n\t        fetch.get(url.get('getRelyListV2') + paramList).then(function (data) {\n\t            //console.log(data);\n\t\n\t            var replyCommentList = data.data.topicSubReplys;\n\t            if (replyCommentList.length > 2) {\n\t\n\t                $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-box\").empty();\n\t                for (var i = 0; i < replyCommentList.length; i++) {\n\t\n\t                    var replyaList = replyCommentList[i];\n\t                    var content = replyaList.content;\n\t                    content = changeContent(content);\n\t                    var beReplyUserName = \"\";\n\t                    var beReplyUserId = \"\";\n\t                    var replayToPub = false;\n\t                    // console.log(replyaList);\n\t                    var SenUserId = checkUserId(replyaList.user.id);\n\t                    var threeUserId = \"javascript:;\";\n\t\n\t                    if (replyaList.topicSubReplyUser) {\n\t                        beReplyUserName = replyaList.topicSubReplyUser.nickname;\n\t                        beReplyUserId = replyaList.topicSubReplyUser.id;\n\t                        replayToPub = true;\n\t                        threeUserId = checkUserId(beReplyUserId);\n\t                    }\n\t                    var showCom = {\n\t                        \"SenUserId\": SenUserId,\n\t                        \"threeUserId\": threeUserId,\n\t                        \"topicType\": 0,\n\t                        \"backTopicId\": commentid,\n\t                        \"parentCommentId\": commentid, //话题id\n\t                        \"topicId\": replyaList.topicId,\n\t                        \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n\t                        \"content\": content, //回复内容\n\t                        \"replyUserName\": replyaList.user.nickname, //回复人昵称\n\t                        \"replyUserId\": replyaList.user.id, //回复人id\n\t                        \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n\t                        \"beReplyUserId\": beReplyUserId, //被回复人的id\n\t                        \"replyCommentId\": replyaList.id // 二级回复内容id\n\t                    };\n\t                    var item = secondComList(showCom);\n\t                    //console.log(showCom);\n\t                    $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-box\").append(item);\n\t                    // if ($is_Login == \"0\") {\n\t                    //     $(\"[data-node=secondCom_Key]\").css(\"display\", \"none\");\n\t                    // }\n\t                    obj.html(\"收起\");\n\t                    //obj.css(\"display\", \"none\");\n\t                }\n\t            } else {\n\t                obj.addClass(\"hide\");\n\t                $(\"[data-ddlist='\" + commentid + \"']\").parent().addClass(\"bd-bottom\");\n\t            }\n\t        });\n\t    }\n\t};\n\t\n\tfunction checkUserId(id) {\n\t    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n\t        return $_CONFIG.i_domain + 'member/profileHome';\n\t    } else {\n\t        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n\t    }\n\t}\n\tmodule.exports = showMoreList;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 256 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t//表情添加\n\t\n\tvar checkLoginStatus = __webpack_require__(23); // 登陆判断\n\tvar face = __webpack_require__(75);\n\tvar loginState = __webpack_require__(252);\n\t\n\tvar textareaTips = '[data-node=\"textareaTips\"]';\n\tvar curretTextArea = [];\n\tvar $showBox;\n\tvar selectText = function selectText(textbox, startIndex, stopIndex) {\n\t    if (textbox.setSelectionRange) {\n\t        textbox.setSelectionRange(startIndex, stopIndex);\n\t    } else if (textbox.createTextRagen) {\n\t        var range = textbox.createTextRange();\n\t        range.collapse(true);\n\t        range.moveStart('character', startIndex);\n\t        range.moveEnd('character', stopIndex - startIndex);\n\t        range.select();\n\t    }\n\t    textbox.focus();\n\t};\n\t\n\tvar insertAtCursor = function insertAtCursor(textbox, text) {\n\t    if (textbox.selectionStart >= 0) {\n\t        var val = textbox.value;\n\t        var startIndex = textbox.selectionStart;\n\t        textbox.value = val.substring(0, startIndex) + text + val.substring(textbox.selectionEnd);\n\t        textbox.selectionStart = textbox.selectionEnd = startIndex + text.length;\n\t        textbox.focus();\n\t    } else if (typeof document.selection != 'undefined' && typeof document.selection.createRange != 'undefined') {\n\t        textbox.focus();\n\t        $(textbox).siblings(textareaTips).addClass('hide');\n\t        var range = document.selection.createRange();\n\t        range.text = text;\n\t        range.select();\n\t    }\n\t};\n\tvar showEmoji = function showEmoji() {\n\t    if ($showBox) {\n\t        $showBox.hide();\n\t    } else {\n\t        $showBox = $('[data-node=\"picPopBox\"]');\n\t        $showBox.hide();\n\t    }\n\t\n\t    if (!checkLoginStatus()) {\n\t        loginState.popUnion();\n\t        return false;\n\t    }\n\t\n\t    var $this = $(this);\n\t\n\t    var offset = $this.offset();\n\t    var x = offset.left - 2;\n\t    var y = offset.top + 38;\n\t\n\t    curretTextArea = $this.closest('.topic-publish-content').children(\"textarea\");\n\t    curretTextArea.focus();\n\t    if ($('[data-node=\"faceBox\"]').is(':hidden')) {\n\t        face.show(x, y);\n\t    } else {\n\t        face.hide();\n\t    }\n\t\n\t    return false;\n\t};\n\t\n\tmodule.exports = {\n\t    showEmoji: showEmoji,\n\t    insertAtCursor: insertAtCursor,\n\t    selectText: selectText,\n\t    curretTextAreaObj: function curretTextAreaObj() {\n\t        return curretTextArea.get(0);\n\t    }\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 257 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar getCommentList = __webpack_require__(246); //\n\t\n\t//var $loadlist = $(\"[data-node=loadlist]\");\n\t//var $comment_Msg = $(\"[data-node=comment_Msg]\");\n\t//var $a_Submit = $(\"[data-node=a_Submit]\");\n\t//var $circleCom = $(\"[data-node=circleCom]\");\n\tvar checkLoginStatus = __webpack_require__(23); //登陆判断\n\tvar DIVOBJ = $(\"[data-node='more-topic']\");\n\tvar loginPop = __webpack_require__(22);\n\tvar lodingMore = function lodingMore() {\n\t\n\t    //加载更多\n\t\n\t    //$(\"[data-node=loading]\").css(\"display\", \"none\");\n\t    //$(\"[data-node=noload]\").css(\"display\", \"none\");\n\t\n\t    DIVOBJ.on(\"click\", \"[data-node='loadlist']\", function () {\n\t        var hideDiv = $(this).parent(\"[data-node='hidDiv']\");\n\t        var topicId = hideDiv.attr(\"data-comtopicid\");\n\t        var userSubmits = hideDiv.find(\"[data-node='userSubmit']\");\n\t        var addmorepages = $(this).attr(\"data-addmorepages\"); //当前页\n\t        var listsize = $(this).attr(\"data-listsize\"); //\n\t        //var tootalPa = $(this).attr(\"data-tootlepa\"); //总页数\n\t        var toPage = parseInt(addmorepages) + 1;\n\t        var nodelist = \"nodelist\";\n\t\n\t        for (var i = 0, len = userSubmits.length; i < len; i++) {\n\t            var $this = $(userSubmits[i]);\n\t            $this.next('a').remove();\n\t            $this.next('div').remove();\n\t            $this.remove();\n\t        }\n\t\n\t        getCommentList(topicId, toPage, listsize, 5, nodelist);\n\t        return false;\n\t    });\n\t};\n\t\n\t// 点击评论图标页面滚动到评论区域\n\tvar goComment = function goComment() {\n\t\n\t    var $body = $('body');\n\t    $body.on('click', \"[data-action='goComment']\", function () {\n\t        if (!checkLoginStatus()) {\n\t            loginPop();\n\t            return false;\n\t        }\n\t        var id = $($(this).parents()[2]).attr(\"data-conter-ul\");\n\t        //console.log(id);\n\t        if (window.BP) {\n\t            BP.send({\n\t                event_id: 'G000P008',\n\t                group_id: $_CONFIG.groupid,\n\t                topic_id: $_CONFIG.topicid,\n\t                circle_type: $_CONFIG.s_c,\n\t                channel_id: 'in-pinglun'\n\t            });\n\t        }\n\t\n\t        var $topObj = $(\"[data-left='\" + id + \"']\").children(\"[data-node='commentBox']\");\n\t        var offsetTop = $topObj.offset().top;\n\t        $(\"[data-tid='\" + id + \"']\").children(\"textarea\").focus();\n\t        $('html,body').animate({\n\t            'scrollTop': offsetTop\n\t        }, 200);\n\t    });\n\t};\n\t\n\tmodule.exports = {\n\t    lodingMore: lodingMore,\n\t    goComment: goComment\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 258 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {\"use strict\";\n\t\n\tvar praise = __webpack_require__(214);\n\t\n\tvar $praiseClick = $(\"[data-node='praiseClick']\");\n\t\n\tif ($praiseClick.children(\"em\").hasClass(\"active\")) {\n\t    $praiseClick.children(\"span\").html(\"取消点赞\");\n\t}\n\t\n\tvar init = function init() {\n\t    praise('body', '[data-node=\"praiseClick\"]', {\n\t        mode: 'normal'\n\t    });\n\t    /* praise('[data-node=hot_topics]', '[data-action=like]', {\n\t         mode: 'normal'\n\t     });\n\t     */\n\t\n\t    return false;\n\t};\n\t\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 259 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\tvar share = __webpack_require__(103).shareto;\n\tvar shareBP = __webpack_require__(260);\n\t\n\tvar init = function init() {\n\t    var $body = $(\"body\");\n\t    //var $wx = $('[data-node=wx]');\n\t    // var $wb = $('[data-node=wb]');\n\t    //var $qq = $('[data-node=qq]');\n\t    //var $qzone = $('[data-node=qzone]');\n\t\n\t    var gomeplusLogo = $_CONFIG.imgpath + '/images/public/down-logo.png';\n\t\n\t    var getShareInfo = function getShareInfo($node) {\n\t        var $ul = $node.closest('ul');\n\t        var shareInfo = {\n\t            url: $ul.data('surl'),\n\t            title: $ul.data('stitle'),\n\t            pic: $ul.data('spic') || gomeplusLogo,\n\t            summary: $ul.data('content') || \"这里有志趣相投的小伙伴，机智诙谐的猛料，还有你\"\n\t            //desc: $ul.data('content')\n\t        };\n\t        return shareInfo;\n\t    };\n\t\n\t    var shareTo = function shareTo(type) {\n\t        return function () {\n\t            var info = getShareInfo($(this));\n\t            //console.log(info);\n\t            var topicId = $(this).closest('.topic-conter').attr(\"data-conter-ul\");\n\t            //console.log(topicId);\n\t            share[type](info);\n\t            // analytic(type, topicId); // 发送统计数据\n\t            var opts = {\n\t                page: 'ht',\n\t                shareTo: type,\n\t                shareId: topicId\n\t            };\n\t            shareBP(opts);\n\t            return false;\n\t        };\n\t    };\n\t\n\t    var evtType = 'click';\n\t    var $conf = $_CONFIG;\n\t\n\t    /*var channels = {\n\t        'wx': 'out-weixin',\n\t        'sina': 'out-xlwb',\n\t        'qq': 'out-QQ',\n\t        'qzone': 'out-Qqzone'\n\t    };\n\t    var analytic = function(channel, topicId) {\n\t        BP.send({\n\t            event_id: 'G000P008',\n\t            group_id: $conf.groupid,\n\t            topic_id: topicId,\n\t            circle_type: $conf.s_c,\n\t            channel_id: channels[channel] || ''\n\t        });\n\t    };*/\n\t    $body.on(evtType, \"[data-node='wx']\", function () {\n\t        // 当前话题页所对应的wap页的地址\n\t        // https://m-pre.gomeplus.com/group/topic?topicId=56dfeac86af14853711f4668\n\t        var topicid = $(this).closest('.topic-conter').attr(\"data-conter-ul\");\n\t        share.weixin({\n\t            url: $_CONFIG.wap_circle_url + '/topic-' + topicid + '.html'\n\t            //url: \"https://circle.m.gomeplus.com/topic-\" + topicid + \".html\"\n\t        });\n\t\n\t        // analytic('wx'); // 发送统计数据\n\t        var opts = {\n\t            page: 'ht',\n\t            shareTo: 'wx',\n\t            shareId: topicid\n\t        };\n\t        shareBP(opts); //发送统计数据\n\t        return false;\n\t    });\n\t    $body.on(evtType, \"[data-node='wb']\", shareTo('wb'));\n\t    $body.on(evtType, \"[data-node='qq']\", shareTo('qq'));\n\t    $body.on(evtType, \"[data-node='qzone']\", shareTo('qz'));\n\t};\n\t\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 260 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG) {'use strict';\n\t\n\t/*\n\t@Author:dongyukuan\n\t@data:2017/3/2\n\t话题详情页和圈子主页的分享埋点\n\t使用方法：\n\t    1、var shareBP = require('module/shareBP');\n\t    2、shareBP(opts);\n\t       注：opts={\n\t            page:是圈子主页还是话题详情页\n\t            shareTo:分享到微信、微博等\n\t            share_id:topic_id或group_id\n\t       }\n\t*/\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar api = 'https://beacon.gomeplus.com/log_share';\n\tvar shareObj = {\n\t    ht: {\n\t        share: {\n\t            qq: '2010506904',\n\t            qz: '2020506904',\n\t            wx: '2030506904',\n\t            wb: '2050506904'\n\t        },\n\t        url: {\n\t            qq: location.href + '&cmpid=fx_pc_qq' + $_CONFIG.share_time,\n\t            qz: location.href + '&cmpid=fx_pc_qz' + $_CONFIG.share_time,\n\t            wx: location.href + '&cmpid=fx_pc_wx' + $_CONFIG.share_time,\n\t            wb: location.href + '&cmpid=fx_pc_wb' + $_CONFIG.share_time\n\t        }\n\t    },\n\t    qz: {\n\t        share: {\n\t            qq: '2010507903',\n\t            qz: '2020507903',\n\t            wx: '2030507903',\n\t            wb: '2050507903'\n\t        },\n\t        url: {\n\t            qq: location.href + '&cmpid=fx_pc_qq' + $_CONFIG.share_time,\n\t            qz: location.href + '&cmpid=fx_pc_qz' + $_CONFIG.share_time,\n\t            wx: location.href + '&cmpid=fx_pc_wx' + $_CONFIG.share_time,\n\t            wb: location.href + '&cmpid=fx_pc_wb' + $_CONFIG.share_time\n\t        }\n\t    },\n\t    user_id: $_CONFIG.userId,\n\t    cookie_id: $_CONFIG.share_ssid,\n\t    env: $_CONFIG.share_env\n\t};\n\t\n\tfunction jianjie(data) {\n\t    console.log(data);\n\t};\n\t\n\tfunction shareBP(opts) {\n\t    var page = opts.page; //需传入'topic'(话题详情页)；'circle'(圈子主页);\n\t    var shareTo = opts.shareTo; //分享到哪(qq,qzone,wx,sina);\n\t    var share_id = opts.shareId; //topic_id或group_id;\n\t    function getcookie(objname) {\n\t        //获取指定名称的cookie的值\n\t        var cookieArr = document.cookie.split(\"; \");\n\t        for (var i = 0; i < cookieArr.length; i++) {\n\t            var temp = cookieArr[i].split(\"=\");\n\t            if (temp[0] == objname) return unescape(temp[1]);\n\t        }\n\t    }\n\t    var shareData = {\n\t        'sp': 'plus',\n\t        'pf': 'pc',\n\t        'sc': shareTo,\n\t        'st': page,\n\t        'ss': 0,\n\t        'pid': window.page_id,\n\t        'sid': share_id,\n\t        'uid': shareObj.user_id,\n\t        'cid': getcookie('__gmz'),\n\t        'url': shareObj[page].url[shareTo],\n\t        'env': shareObj.env,\n\t        'di': ''\n\t    };\n\t    shareData = JSON.stringify(shareData);\n\t    fetch.post(api, {\n\t        data: shareData\n\t    }).done(function (data) {});\n\t};\n\tmodule.exports = shareBP;\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3)))\n\n/***/ }),\n/* 261 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG, $) {'use strict';\n\t\n\t/**\n\t * 话题收藏/取消收藏\n\t */\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar alert = __webpack_require__(36);\n\tvar Pubsub = __webpack_require__(45);\n\tvar channel = __webpack_require__(100);\n\tvar loginPop = __webpack_require__(22);\n\tvar checkLoginStatus = __webpack_require__(23);\n\t\n\tvar popFlag = 0;\n\t\n\tvar login = function login() {\n\t    window.location.href = $_CONFIG.passport_domain + 'login/index';\n\t};\n\tvar $collect = $(\"[data-node='collect']\");\n\tif ($collect.children(\"em\").parent().hasClass(\"active\")) {\n\t    $collect.children(\"span\").html(\"取消收藏\");\n\t    // $collect.attr(\"data-status\",\"1\");\n\t}\n\t\n\tvar init = function init() {\n\t    var $body = $(\"body\");\n\t    $body.on('click', \"[data-node='collect']\", function () {\n\t        var $CONF = $_CONFIG;\n\t        if (window.BP) {\n\t            BP.send({\n\t                event_id: 'G000P008',\n\t                group_id: $CONF.groupid,\n\t                topic_id: $($(this).parents()[2]).attr(\"data-conter-ul\"),\n\t                circle_type: $CONF.s_c,\n\t                channel_id: 'in-shoucang'\n\t            });\n\t        }\n\t\n\t        var $this = $(this);\n\t        // var firing = $this.data('firing');\n\t        // if (firing) {\n\t        //     return false;\n\t        // }\n\t        // $this.data('firing', 1);\n\t        var iscollect = $this.data('status');\n\t        // 1 收藏, 2 取消收藏\n\t        var t = iscollect === 0 ? 1 : 2;\n\t\n\t        //console.log($($this.parents()[2]).attr(\"data-conter-ul\"));\n\t        var objs = {\n\t            //validate: true,\n\t            data: {\n\t                groupId: $_CONFIG['groupid'],\n\t                topicId: $($this.parents()[2]).attr(\"data-conter-ul\"),\n\t                type: t\n\t            },\n\t            onLogin: noRefreshFetch,\n\t            refresh: true // 目前登录和收藏需要刷新页面\n\t\n\t\n\t            //无刷新登录\n\t        };function noRefreshFetch() {\n\t            var o = objs;\n\t            fetch.post(url.get('collectTopic'), o).done(function (data) {\n\t                //订阅评论区编辑状态\n\t                Pubsub(channel.comment.enableEditor).pub({\n\t                    pid: \"enable\"\n\t                });\n\t                if (data && data.code === 200 && data.success) {\n\t                    if (t === 1) {\n\t                        $this.data('status', 1);\n\t                        $this.find('em').parent().addClass('active');\n\t                        $this.find('span').text('取消收藏');\n\t                    } else if (t === 2) {\n\t                        $this.data('status', 0);\n\t                        $this.find('em').parent().removeClass('active');\n\t                        $this.find('span').text('收藏');\n\t                    }\n\t                } else if (data && data.code === 422) {\n\t                    login();\n\t                } else {\n\t                    alert(data.message);\n\t                }\n\t                if (popFlag) {\n\t                    window.location.reload();\n\t                }\n\t            }).fail(function () {}).always(function () {\n\t                // $this.data('firing', 0);\n\t            });\n\t        }\n\t        if (!checkLoginStatus()) {\n\t            popFlag = 1;\n\t            loginPop(noRefreshFetch);\n\t        } else {\n\t            popFlag = 0;\n\t            noRefreshFetch();\n\t        }\n\t        return false;\n\t    });\n\t};\n\t\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3), __webpack_require__(2)))\n\n/***/ }),\n/* 262 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($_CONFIG, $) {'use strict';\n\t\n\tvar Pubsub = __webpack_require__(45);\n\tvar identify = __webpack_require__(245);\n\tvar titel = __webpack_require__(263);\n\tvar comList = __webpack_require__(264);\n\tvar commentBox = __webpack_require__(265);\n\tvar topicRight = __webpack_require__(266);\n\t__webpack_require__(50);\n\t\n\t__webpack_require__(267);\n\t__webpack_require__(46)();\n\t\n\tvar getCommentList = __webpack_require__(246);\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\t\n\tvar clickTopicId = $_CONFIG['topicid'];\n\tvar clickTopicObj = {\n\t    \"name\": $_CONFIG['topic_title'],\n\t    \"id\": clickTopicId\n\t};\n\t//console.log(clickTopicObj);\n\tvar len = 0;\n\tvar lastScroll = 0;\n\t\n\tvar downLoadTopic = [clickTopicObj]; //已加载的有效话题id\n\t\n\tvar OpenedTop = [clickTopicObj]; //记录页面已经滑过的话题id\n\tvar ListTopsValid = [];\n\t\n\tvar arrayIdBoolean = []; //改变ul地址的判断\n\tvar idVideo = [];\n\tvar videoObj = [];\n\tvar currentId = clickTopicObj.id;\n\tvar oldCurrentId = clickTopicObj.id;\n\t//var vid = null;\n\t\n\tvar $no_next = $_CONFIG['no_next']; //1 false\n\t\n\tvar imgPath = $_CONFIG['imgpath'];\n\tvar isLogin = $_CONFIG['islogin'];\n\t\n\tvar jctjmodule = $_CONFIG['htfxan']; //分享按钮\n\tvar htxqmodule = $_CONFIG['htxq']; //话题详情\n\tvar htcyplmodule = $_CONFIG['htcypl']; //参与评论\n\tvar htpllbmodule = $_CONFIG['htpllb']; //评论列表\n\tvar htqzxxmodule = $_CONFIG['htqzxx']; //圈主信息\n\tvar htrmhtmodule = $_CONFIG['htrmht']; //热门话题\n\tvar htxyymodule = $_CONFIG['htxyy']; //下一篇\n\t//$GLOBAL_CONFIG['ggckgd'] = 'PGGMKCKmd0003';  //埋点查看更多标示\n\tvar ggjzgdmodule = $_CONFIG['ggjzgd']; //埋点加载更多标示\n\tvar hotTopicUl = $(\"[data-node='hot_topics']\").html();\n\tvar topicRT = $(\".topic-r-t\").html();\n\tvar $topicWrap = $(\"[data-node='more-topic']\");\n\tvar number = 0;\n\tfunction addDivHtml(newMsg1) {\n\t    var newMsg = newMsg1;\n\t    var id = newMsg.id;\n\t    //右侧的参数\n\t    var rightNextMsg = {\n\t        topicRT: topicRT,\n\t        hotTopicUl: hotTopicUl,\n\t        id: id,\n\t        nextTopName: newMsg.topicName,\n\t        nextTopTime: newMsg.lastReplyTime,\n\t        htqzxxmodule: newMsg.htqzxxmodule,\n\t        htrmhtmodule: newMsg.htrmhtmodule,\n\t        htxyymodule: newMsg.htxyymodule\n\t    };\n\t\n\t    var elemTitle = titel(newMsg); //头部\n\t    var elemCommentBox = commentBox(newMsg);\n\t    var elemComList = comList(newMsg); //评论\n\t    var elemRight = topicRight(rightNextMsg);\n\t\n\t    var topicHtml = '<div class=\"more-topic\" >' + '<div class=\"wrap-box ovflow-hid wrap-reletive \" data-node=\"wrap-box\" id-node=' + id + '>' + '<div class=\"topic-lfet\" data-left=' + id + '>' + elemTitle + elemCommentBox + elemComList + '</div>' + elemRight + '</div>';\n\t    '</div>';\n\t    $topicWrap.append(topicHtml);\n\t\n\t    var $leftImg = $topicWrap.children().last().find('.source-rig-box img');\n\t    $leftImg.lazyload({\n\t        effect: \"fadeIn\"\n\t    });\n\t}\n\t\n\tfunction getVideo() {\n\t\n\t    var videoArr = $_CONFIG['video_arr'];\n\t    //console.log();\n\t    var newVideo = [videoArr];\n\t    if (videoArr.length > idVideo.length) {\n\t\n\t        newVideo = videoArr.slice(idVideo.length);\n\t        for (var i = 0; i < newVideo.length; i++) {\n\t\n\t            var _video = newVideo[i];\n\t            var video_id = _video.base.id;\n\t\n\t            var v = new MeixinPlayer();\n\t            v.init(video_id, 'videoContainer_' + video_id + \"_\" + _video.config.topicId, _video.config);\n\t            idVideo.push(newVideo[i]);\n\t            videoObj.push(v);\n\t\n\t            v.on('playStart', function () {\n\t                for (var i = 0; i < videoObj.length; i++) {\n\t                    if (videoObj[i] === v) {\n\t                        //return false;\n\t                    } else {\n\t                        videoObj[i].stopVideo();\n\t                    }\n\t                }\n\t            }, v);\n\t        }\n\t    } else {\n\t        return false;\n\t    }\n\t}\n\tvar nextLoading = 0;\n\t\n\t//增加话题访问量\n\tvar addVisitTopicId = function addVisitTopicId(openTopicId) {\n\t    fetch.get(url.get('addVisitTopic'), {\n\t        data: {\n\t            topicid: openTopicId\n\t        }\n\t    });\n\t};\n\t\n\t//获取话题中商品价格\n\tvar getGoodsPrice = function getGoodsPrice(goodsId) {\n\t    var ids = '';\n\t    $.each(goodsId, function (i, v) {\n\t        ids += ',' + $(v).attr('data-id') + '|' + $(v).attr('data-skuid');\n\t    });\n\t    return ids.substr(1);\n\t};\n\t\n\t//渲染话题中的价格\n\tvar changeGoodsPrice = function changeGoodsPrice(topicId) {\n\t    var curTopicId = $('[id-node=\"' + topicId + '\"]');\n\t    var len = curTopicId.find('strong[data-id]').length;\n\t    var ids = getGoodsPrice(curTopicId.find('strong[data-id]'));\n\t    if (len !== 0) {\n\t        fetch.get(url.get('getIndexData'), {\n\t            data: {\n\t                type: 'product',\n\t                ids: ids\n\t            }\n\t        }).done(function (data) {\n\t            if (data.success === true) {\n\t                $.each(data.data, function (i, v) {\n\t                    if (v.salePrice === null) {\n\t                        v.salePrice = '暂无售价';\n\t                    }\n\t                    $('[data-id=\"' + v.id + '\"]').text(v.salePrice);\n\t                    $('[data-id=\"' + v.id + '\"]').parent('[data-node=\"price\"]').removeClass('hide');\n\t                });\n\t            }\n\t        });\n\t    }\n\t};\n\t\n\tfunction getNextTopicId(openTopicId) {\n\t    arrayIdBoolean.push(openTopicId);\n\t\n\t    fetch.get(url.get('getNextTopic') + \"?topicid=\" + openTopicId).then(function (data) {\n\t        if (data.success == true && data.code == 200) {\n\t\n\t            var $getNext = $(\"[data-get-next-topic='\" + openTopicId + \"']\");\n\t            if (nextLoading) {\n\t                $getNext.children(\"a\").html(data.data.name).attr(\"href\", \"/topic/\" + data.data.id + \".html\").attr(\"target\", \"_blank\");\n\t                $getNext.find(\".f12\").html(data.data.lastReplyTime);\n\t                $getNext.slideDown(\"slow\");\n\t            } else {\n\t                nextLoading = 1;\n\t            }\n\t            //获取下个话题的信息，id\n\t            var userImage = $_CONFIG['headface'];\n\t            var pathImg = $_CONFIG.imgpath;\n\t            if (!userImage) {\n\t                userImage = pathImg + \"/images/public/head-default.png\";\n\t            }\n\t            var isExpert = $_CONFIG['isExpert'] ? true : false; //是否为达人\n\t\n\t            //console.log(isLogin);\n\t            var isLoginClass = \"\";\n\t            var isLoginStr = '';\n\t            var readyOnly = '';\n\t            if (isLogin == \"0\") {\n\t                isLoginStr = \"登录\";\n\t                isLoginClass = \"pc-bj-fc8753\";\n\t                readyOnly = \"readonly\";\n\t                //var headface\n\t            } else {\n\t                isLoginStr = \"发布\";\n\t                isLoginClass = \"\";\n\t                readyOnly = \"\";\n\t            }\n\t\n\t            var dataStr = data.data;\n\t            var id = dataStr.id;\n\t            var name = data.data.name;\n\t            $(\"body\").attr(\"data-currentTopicId\", openTopicId);\n\t            $(\"body\").attr(\"data-nextTopicId\", id);\n\t\n\t            downLoadTopic.push({\n\t                \"name\": name,\n\t                \"id\": id\n\t            });\n\t\n\t            // 点赞和收藏\n\t\n\t            //var likeIS = dataStr.ext.praise.isLike == false ? \"\" : \"active\";\n\t            var UserId = checkUserId(dataStr.user.id);\n\t            var showReport = isLogin == 1 && $_CONFIG['userId'] != dataStr.user.id ? true : false;\n\t            var allNum = parseInt(dataStr.replyQuantity + dataStr.subReplyQuantity);\n\t            var newMsg = {\n\t                jctjmodule: getModuleString(jctjmodule),\n\t                htxqmodule: getModuleString(htxqmodule),\n\t                htcyplmodule: getModuleString(htcyplmodule),\n\t                htpllbmodule: getModuleString(htpllbmodule),\n\t                htqzxxmodule: getModuleString(htqzxxmodule),\n\t                htrmhtmodule: getModuleString(htrmhtmodule),\n\t                htxyymodule: getModuleString(htxyymodule),\n\t                ggjzgdmodule: ggjzgdmodule,\n\t                UserId: UserId,\n\t                html: dataStr.html,\n\t                isEssence: dataStr.isEssence, //精品,\n\t                isUpper: dataStr.isUpper, //置顶,\n\t                style: dataStr.style == \"0\" ? false : true, //专访\n\t                topicName: dataStr.name, //话题名称\n\t                id: id, //话题ID\n\t                imgPath: imgPath,\n\t                facePicUrl: dataStr.user.facePicUrl, // 话题 用户头像\n\t                nickName: dataStr.user.nickname, //话题 用户名\n\t                groupCircleName: dataStr.group.name, //来自圈子\n\t                lastReplyTime: dataStr.lastReplyTime, //话题时间\n\t                allNum: allNum, //评论数\n\t                extGroupUrl: dataStr.ext.group_url, // 圈子路径\n\t\n\t                extImagesLst: dataStr.ext.surl, //左侧ul上添加的数据\n\t                share_text: dataStr.ext.share_text, // 左侧ul上的data-content 属性值\n\t                extSpic: dataStr.ext.images_lst,\n\t                extStitle: dataStr.name,\n\t\n\t                isLike: dataStr.ext.praise.isLike == false ? \"\" : \"active\", //点赞\n\t                isLikeName: dataStr.ext.praise.isLike == false ? \"点赞\" : \"取消点赞\", //点赞\n\t                userQuantity: dataStr.ext.praise.userQuantity, // 点赞数\n\t                userCollection: dataStr.userCollection.result == 0 ? \"\" : \"active\", //收藏\n\t                userCollectionName: dataStr.userCollection.result == 0 ? \"收藏\" : \"取消收藏\", //收藏\n\t                userCollectionStatu: dataStr.userCollection.result == 0 ? 0 : 1,\n\t                dataParise: dataStr.ext.praise.isLike == false ? \"1\" : \"0\", //点赞\n\t                mshopFlag: dataStr.ext.mshop_flag, //是否显示美店图标\n\t                mshopUrl: dataStr.ext.mshop_url, //美店链接\n\t                coverPic: dataStr.coverPic, //封面\n\t\n\t                is_del: dataStr.user.is_del,\n\t                isExpert: isExpert, //是否是达人\n\t                userImage: userImage, //用户头像\n\t                groupId: data.data.groupId, //groupid\n\t\n\t                isLoginStr: isLoginStr, //根据是否登陆判断显示 按钮内容\n\t                isLoginClass: isLoginClass, //根据是否登陆显示  样式\n\t                readyOnly: readyOnly, //根据是否登陆判断是  只读还是可写\n\t                showReport: showReport //举报\n\t\n\t                //填写数据\n\t            };addDivHtml(newMsg); //添加数据到页面\n\t            showTextareaTips();\n\t            $(\"body\").attr(\"data-module\", Number($(\"body\").attr(\"data-module\")) + 1);\n\t            if (allNum != 0) {\n\t                getCommentList(id, 1, 10, 2);\n\t            }\n\t            ListTopsValid.push({\n\t                \"name\": name,\n\t                \"id\": id\n\t            });\n\t\n\t            var topRightH = $(\"[data-topicrt='\" + openTopicId + \"']\");\n\t            var h = topRightH.children(\".topic-r-t\").height() + topRightH.children(\".topic-position\").height();\n\t\n\t            $(\"[id-node='\" + openTopicId + \"']\").css(\"min-height\", h + \"px\");\n\t        } else if (data.success == false && data.code == 404) {\n\t            return false;\n\t        }\n\t    });\n\t}\n\t\n\t//鼠标下滑\n\tfunction addMoreEvent(s) {\n\t    //var TopicIdNext = $(\"body\").attr(\"data-nexttopicid\"); //\n\t    if (len == -1) {\n\t        // 已经滑过的对象数字\n\t        OpenedTop.push(clickTopicObj); //clickTopic\n\t        len = 0;\n\t    }\n\t    if (ListTopsValid.length - 1 == len) {\n\t        var id = ListTopsValid[ListTopsValid.length - 1].id;\n\t        var name = ListTopsValid[ListTopsValid.length - 1].name;\n\t\n\t        if (s > $(\"[id-node='\" + id + \"']\").offset().top) {\n\t            History.replaceState({}, name, id + \".html\");\n\t            OpenedTop.push({\n\t                name: name,\n\t                id: id\n\t            });\n\t            if ($no_next == 0 && arrayIdBoolean[arrayIdBoolean.length - 1] != id) {\n\t                getNextTopicId(id);\n\t                addVisitTopicId(id);\n\t                changeGoodsPrice(id);\n\t            }\n\t            getVideo();\n\t            len++;\n\t            currentId = id;\n\t        }\n\t    }\n\t\n\t    if (ListTopsValid.length - 1 > len) {\n\t        var id1 = ListTopsValid[len].id;\n\t        var name1 = ListTopsValid[len].name;\n\t\n\t        if (s > $(\"[id-node='\" + id1 + \"']\").offset().top) {\n\t            History.replaceState({}, name1, id1 + \".html\");\n\t            OpenedTop.push({\n\t                name: name1,\n\t                id: id1\n\t            });\n\t            len++;\n\t            currentId = id1;\n\t        }\n\t    }\n\t}\n\t//鼠标上滑\n\tfunction scrollToTop(t) {\n\t\n\t    var id = \"\";\n\t    var nextiD = \"\";\n\t    var name = \"\";\n\t    if (len < 1) {\n\t        nextiD = clickTopicObj.id;\n\t        name = clickTopicObj.name;\n\t        currentId = nextiD;\n\t    } else {\n\t        id = OpenedTop[len].id;\n\t        nextiD = OpenedTop[len - 1].id;\n\t        name = OpenedTop[len - 1].name;\n\t        currentId = id;\n\t    }\n\t    if (id) {\n\t        //var scrollTop = $(this).scrollTop();\n\t        if (t < $(\"[id-node='\" + id + \"']\").offset().top) {\n\t            History.replaceState({}, name, nextiD + \".html\");\n\t            OpenedTop.length = len;\n\t            len--;\n\t        }\n\t    }\n\t}\n\t\n\t//右侧 固定\n\tfunction topFixed(scrollTop) {\n\t\n\t    var showTopicID = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n\t\n\t    var $showDiv = $(\"[id-node='\" + showTopicID + \"']\"); //当前话题的div\n\t    var $showRight = $showDiv.children(\".topic-right \"); //右侧整体\n\t    var $thisScroll = $showRight.children(\"[data-node='topic_xi']\"); // 滚动部分\n\t    var $showLeft = $showDiv.children(\".topic-lfet\"); //左侧\n\t\n\t    var showDivHeight = $showDiv.height(); // 话题整体高度\n\t    var showRightHeight = $showRight.height(); //右侧高度\n\t    var thisScrollHeight = $thisScroll.height(); //热门话题的高度\n\t    var windowHight = $(window).height(); //窗口高度\n\t    var showLeftHeight = $showLeft.height(); //左侧高度\n\t\n\t    var floatRight = $(\"body\").width() - $(\".wrap-box\").width();\n\t    floatRight = parseInt(floatRight) / 2; //右边浮动的宽度\n\t\n\t    var s = scrollTop; //鼠标滚动的高度\n\t    var TopShow = parseInt($showDiv.offset().top); //整个话题div距离顶部的高度\n\t    var topicRT = TopShow + 320; //热门话题距离页面顶部的距离\n\t    var BottomShow = parseInt(TopShow) + showDivHeight; //热门话题距离页面底部的距离，应该减去热门话题的高度\n\t\n\t    // 左侧小于右侧，不操作\n\t    if (showLeftHeight <= showRightHeight) {\n\t        return false;\n\t    } else {\n\t        var pp = null;\n\t        var autoTop = null;\n\t        var opx = null;\n\t        //var toTopHeight = $(\".topic-r-t\").height();\n\t\n\t        var h = 0;\n\t        //var m = 0;\n\t        if (windowHight > thisScrollHeight) {\n\t            h = windowHight - thisScrollHeight;\n\t        } else {\n\t            //m = thisScrollHeight - windowHight;\n\t        }\n\t\n\t        if (thisScrollHeight <= windowHight) {\n\t            //吸顶\n\t            pp = topicRT;\n\t            autoTop = \"0px\";\n\t            opx = \"auto\";\n\t        } else {\n\t            //吸底\n\t            pp = topicRT - windowHight + thisScrollHeight;\n\t            autoTop = \"auto\";\n\t            opx = \"0px\";\n\t        }\n\t        //var h = windowHight - thisScrollHeight;\n\t        if (s > pp && s + windowHight <= BottomShow + h) {\n\t            $($thisScroll).css({\n\t                \"position\": \"fixed\",\n\t                \"right\": floatRight + \"px\",\n\t                \"top\": autoTop,\n\t                \"bottom\": opx\n\t            });\n\t        } else if (s + windowHight > BottomShow + h) {\n\t            $($thisScroll).css({\n\t                \"position\": \"absolute\",\n\t                \"right\": \"0px\",\n\t                \"top\": \"auto\",\n\t                \"bottom\": \"0px\"\n\t            });\n\t        } else if (s < pp) {\n\t            $($thisScroll).css({\n\t                \"position\": \"absolute\",\n\t                \"right\": \"0px\",\n\t                \"top\": \"320px\",\n\t                \"bottom\": \"auto\"\n\t            });\n\t        }\n\t    }\n\t}\n\tvar leftS = parseInt($(\".wrap-box.ovflow-hid\").css(\"margin-left\"), 10) + 20;\n\tfunction ulFixt(scrollTop) {\n\t    var containerId = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n\t    var $divConter = $(\"[data-conter-ul='\" + containerId + \"']\");\n\t    var $ul = $($divConter).children(\"ul\");\n\t    var divTop = $divConter.offset().top;\n\t    var divHeight = $divConter.height();\n\t    var ulHeight = $ul.height();\n\t    var s = divHeight + divTop - ulHeight;\n\t    if (scrollTop > divTop && scrollTop < s) {\n\t        $ul.css({\n\t            \"position\": \"fixed\",\n\t            \"top\": \"6px\",\n\t            \"left\": leftS + \"px\",\n\t            \"bottom\": \"auto\"\n\t        });\n\t    } else if (scrollTop > s) {\n\t        $ul.css({\n\t            \"position\": \"absolute\",\n\t            \"top\": \"auto\",\n\t            \"left\": \"0px\",\n\t            \"bottom\": \"0px\"\n\t        });\n\t    } else if (scrollTop < divTop) {\n\t        $ul.css({\n\t            \"position\": \"absolute\",\n\t            \"top\": \"0\",\n\t            \"bottom\": \"auto\",\n\t            \"left\": \"0px\"\n\t        });\n\t    }\n\t}\n\t\n\tfunction checkUserId(id) {\n\t    if (isLogin == 1 && $_CONFIG['userId'] == id) {\n\t        return $_CONFIG.i_domain + 'member/profileHome';\n\t    } else {\n\t        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n\t    }\n\t}\n\t\n\t// 返回顶部a\n\tfunction toTopBtn() {\n\t    var $Btn = $(\"[data-node='top']\");\n\t    $Btn.off();\n\t    var btnScroll = -1;\n\t\n\t    $Btn.on(\"click\", function () {\n\t\n\t        var topicId = \"\";\n\t        var winScrollTop = parseInt($(window).scrollTop());\n\t        $(this).attr(\"data-winScrollTop\", winScrollTop);\n\t        if (btnScroll == winScrollTop) {\n\t            OpenedTop = [clickTopicObj];\n\t            topicId = OpenedTop[OpenedTop.length - 1]; //当前话题id\n\t            len = 0;\n\t            $(\"html, body\").scrollTop(10);\n\t            History.replaceState({}, topicId.name, topicId.id + \".html\");\n\t        } else {\n\t            topicId = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n\t            var dropTop = parseInt($(\"[id-node='\" + topicId + \"']\").offset().top);\n\t            $(window).scrollTop(dropTop);\n\t            btnScroll = dropTop;\n\t        }\n\t        $(this).attr(\"data-btnScroll\", btnScroll);\n\t        //console.log(\"winScrollTop: \"+winScrollTop +\" dropTop: \"+dropTop);\n\t    });\n\t}\n\t\n\tvar getModuleString = function getModuleString(modulestr) {\n\t    // var num = Number($(\"body\").attr(\"data-module\")) +1;\n\t    // if(num <10 ){\n\t    //     return modulestr+\"000\"+num;\n\t    // }else if(num >=10 && num <1000 ){\n\t    //     return modulestr+\"00\"+num;\n\t    // }else if(num >=100 && num <100){\n\t    //     return modulestr+\"0\"+num;\n\t    // }else if( num >=1000 &&num <10000){\n\t    //     return modulestr+\"\"+num;\n\t    // }\n\t    return modulestr;\n\t};\n\t\n\t//IE显示placeholder内容\n\tvar showTextareaTips = function showTextareaTips() {\n\t    var $textareaTips = $('[data-node=\"textareaTips\"]');\n\t    if (identify()) {\n\t        $textareaTips.removeClass('hide');\n\t    }\n\t};\n\t\n\tvar init = function init() {\n\t    getVideo();\n\t    toTopBtn();\n\t    History.Adapter.bind(window, 'statechange', function () {\n\t        //var State = History.getState();\n\t        //History.log('statechange:', State.data, State.title, State.hash);\n\t    });\n\t    showTextareaTips();\n\t    //var topicRT = $(\".topic-r-t\").html(); // 右侧的html\n\t    //var hotTopicUl = $(\"[data-node=hot_topics]\").html(); //热门话题的html\n\t\n\t    //获取下一个话题\n\t    if ($no_next == 0) {\n\t        getNextTopicId(clickTopicId);\n\t    }\n\t    addVisitTopicId(clickTopicId);\n\t\n\t    Pubsub('getAreaId').sub(function () {\n\t        changeGoodsPrice(clickTopicId);\n\t    });\n\t\n\t    var scrollTop = 0;\n\t    var windowHight = $(window).height();\n\t    var s = 0;\n\t    var noneHeight = 0;\n\t    //鼠标滚动事件\n\t    $(window).on(\"scroll\", function () {\n\t\n\t        scrollTop = $(this).scrollTop();\n\t        windowHight = $(window).height();\n\t        s = parseInt(scrollTop + windowHight / 3);\n\t        topFixed(scrollTop);\n\t        ulFixt(scrollTop);\n\t        var $current = $(\"[id-node='\" + currentId + \"']\").parent();\n\t        // 视频暂停\n\t        if (scrollTop - lastScroll > 0) {\n\t            //下滑\n\t            //判断并加载话题\n\t            addMoreEvent(s);\n\t        } else {\n\t            //上滑\n\t            //改变ulr地址\n\t            scrollToTop(s);\n\t            $current.next().nextAll() !== 'none' && $current.next().nextAll().hide();\n\t\n\t            if ($current.prev().css('display') === 'none') {\n\t                $current.prev().show();\n\t                noneHeight = scrollTop + $current.prev().height();\n\t                $(window).scrollTop(noneHeight);\n\t            }\n\t        }\n\t        if (oldCurrentId !== currentId) {\n\t            if (scrollTop - lastScroll > 0) {\n\t                noneHeight = scrollTop - $current.prev().prev().height();\n\t                $current.prev().prevAll().css('display') !== 'none' && $current.prev().prevAll().hide();\n\t                $current.next().css('display') === 'none' && $current.next().show();\n\t                $(window).scrollTop(noneHeight);\n\t            }\n\t            oldCurrentId = currentId;\n\t        }\n\t\n\t        lastScroll = scrollTop;\n\t    });\n\t};\n\t\n\tmodule.exports = {\n\t    init: init,\n\t    topFixed: topFixed\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(3), __webpack_require__(2)))\n\n/***/ }),\n/* 263 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/topicAddMore/title',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htxqmodule=$data.htxqmodule,coverPic=$data.coverPic,isUpper=$data.isUpper,isEssence=$data.isEssence,style=$data.style,$string=$utils.$string,topicName=$data.topicName,UserId=$data.UserId,facePicUrl=$data.facePicUrl,nickName=$data.nickName,extGroupUrl=$data.extGroupUrl,groupCircleName=$data.groupCircleName,lastReplyTime=$data.lastReplyTime,allNum=$data.allNum,userQuantity=$data.userQuantity,extImagesLst=$data.extImagesLst,extSpic=$data.extSpic,extStitle=$data.extStitle,share_text=$data.share_text,jctjmodule=$data.jctjmodule,dataParise=$data.dataParise,isLike=$data.isLike,isLikeName=$data.isLikeName,userCollectionStatu=$data.userCollectionStatu,userCollection=$data.userCollection,userCollectionName=$data.userCollectionName,mshopFlag=$data.mshopFlag,mshopUrl=$data.mshopUrl,html=$data.html,is_del=$data.is_del,showReport=$data.showReport,$out='';$out+='<div class=\"bjfff\" data-node=\"tiles\" data-title =';\n\t$out+=$escape(id);\n\t$out+=' modelid=\"';\n\t$out+=$escape(htxqmodule);\n\t$out+='\"> ';\n\tif(coverPic){\n\t$out+=' <div class=\"topic-cover\"><img src=';\n\t$out+=$escape(coverPic);\n\t$out+='></div> ';\n\t}\n\t$out+=' <div class=\"topic-title0\"> <h1> ';\n\tif(isUpper){\n\t$out+='<em class=\"set-top\">置顶</em> ';\n\t}\n\t$out+=' ';\n\tif(isEssence){\n\t$out+='<em class=\"set-spark\">精品</em> ';\n\t}\n\t$out+=' ';\n\tif(style){\n\t$out+='<em class=\"set-access\">专访</em> ';\n\t}\n\t$out+=' ';\n\t$out+=$string(topicName);\n\t$out+=' </h1> <p class=\"topic-source\" data-node=\"likewrap\"> <a href=\"';\n\t$out+=$escape(UserId);\n\t$out+='\" target=\"_blank\"> <img onerror=\"imgError(this, \\'h\\')\" src=';\n\t$out+=$escape(facePicUrl);\n\t$out+=' alt=\"\">';\n\t$out+=$escape(nickName);\n\t$out+=' </a> <span>来自圈子：</span> <a href=';\n\t$out+=$escape(extGroupUrl);\n\t$out+=' target=\"_blank\">';\n\t$out+=$escape(groupCircleName);\n\t$out+='</a> <span>';\n\t$out+=$escape(lastReplyTime);\n\t$out+='</span> <span class=\"fr\"> <em class=\"icon-discuss\"></em> <span class=\"topic-count\">';\n\t$out+=$escape(allNum);\n\t$out+='</span> </span> <span class=\"fr\"> <em class=\"icon-like\"></em> <span class=\"topic-count\">';\n\t$out+=$escape(userQuantity);\n\t$out+='</span> </span>  </a> </p> </div> <div class=\"topic-conter\" data-conter-ul =';\n\t$out+=$escape(id);\n\t$out+=' > <ul class=\"source-lef-list\" data-node=\"ulFloat\" data-surl=\"';\n\t$out+=$escape(extImagesLst);\n\t$out+='\" data-spic=\"';\n\t$out+=$escape(extSpic);\n\t$out+='\" data-stitle=\"';\n\t$out+=$escape(extStitle);\n\t$out+='\" data-content=\"';\n\t$out+=$escape(share_text);\n\t$out+='\" > <!--modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='\"--> <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0001\"><a href=\"javascript:void(0)\" data-node=\"wx\"><em class=\"icon-weixin\"></em><span>微信</span></a></li> <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0002\"><a href=\"javascript:void(0)\" data-node=\"wb\"><em class=\"icon-weibo\"></em><span>微博</span></a></li> <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0003\"><a href=\"javascript:void(0)\" data-node=\"qq\"><em class=\"icon-qq\"></em><span>QQ</span></a></li> <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0004\"><a href=\"javascript:void(0)\" data-node=\"qzone\"><em class=\"icon-qzone\"></em><span>QQ空间</span></a></li> <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0005\"> <a href=\"javascript:void(0)\" data-id=\"';\n\t$out+=$escape(id);\n\t$out+='\" data-node=\"praiseClick\" data-type=\"1\" data-praise=\"';\n\t$out+=$escape(dataParise);\n\t$out+='\" class=\"';\n\t$out+=$escape(isLike);\n\t$out+='\"> <em class=\"icon-like-big ';\n\t$out+=$escape(isLike);\n\t$out+=' \"></em><span>';\n\t$out+=$escape(isLikeName);\n\t$out+='</span></a></li> <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0006\"> <a href=\"javascript:void(0)\" data-node=\"collect\" data-status=\"';\n\t$out+=$escape(userCollectionStatu);\n\t$out+='\" class=\"';\n\t$out+=$escape(userCollection);\n\t$out+='\"> <em class=\"icon-collect-big ';\n\t$out+=$escape(userCollection);\n\t$out+='\" ></em><span>';\n\t$out+=$escape(userCollectionName);\n\t$out+='</span></a></li> <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0007\"><a data-action=\"goComment\" href=\"javascript:;\"><em class=\"icon-discuss-big\"></em><span>评论</span></a></li> ';\n\tif(mshopFlag == 1){\n\t$out+=' <li modelid=\"';\n\t$out+=$escape(jctjmodule);\n\t$out+='0008\"><a href=';\n\t$out+=$escape(mshopUrl);\n\t$out+=' target=\"_blank\"><em class=\"icon-meidian-big\"></em><span>美店</span></a></li> ';\n\t}\n\t$out+=' </ul> <div class=\"source-right-box\"> ';\n\t$out+=$string(html);\n\t$out+=' </div> </div> <div class=\"topic-operate\"> ';\n\tif(is_del){\n\t$out+=' <a data-node=\"userTopic-del\" href=\"javascript:;\" title=\"删除该话题\">删除</a> ';\n\t}\n\t$out+=' ';\n\tif(is_del && showReport){\n\t$out+=' <em class=\"line\"></em> ';\n\t}\n\t$out+=' ';\n\tif(showReport){\n\t$out+=' <a data-action=\"topic-report\" href=\"javascript:;\" title=\"举报该话题\">举报</a> ';\n\t}\n\t$out+=' </div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 264 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/topicAddMore/comList',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htpllbmodule=$data.htpllbmodule,ggjzgdmodule=$data.ggjzgdmodule,imgPath=$data.imgPath,$out='';$out+='<div class=\"bjfff\" data-node =\"hidDiv\" data-ComTopicId=';\n\t$out+=$escape(id);\n\t$out+=' > <div class=\"circle-comments\" data-node=\"circleCom\" data-circleCom = ';\n\t$out+=$escape(id);\n\t$out+=' modelid=\"';\n\t$out+=$escape(htpllbmodule);\n\t$out+='\"> </div> <div class=\"more-comments\" data-node=\"loadlist\" style=\"display: none;\" modelid=\"';\n\t$out+=$escape(ggjzgdmodule);\n\t$out+='\"> <a href=\"##\" class=\"clearfix\"> <span> <img src=\"';\n\t$out+=$escape(imgPath);\n\t$out+='/images/circle/small-logo.png\" >点击加载更多 <em class=\"icon icon-right\"></em> </span> </a> </div> <div class=\"more-comments\" data-node=\"loading\" style=\"display: none;\" > <a href=\"javascript:;\" class=\"disabled clearfix\"><span><img src=\"';\n\t$out+=$escape(imgPath);\n\t$out+='/images/public/loading.gif\">正在加载...</span></a> </div> <div class=\"more-comments\" data-node=\"noload\" style=\"display: none;\" > <a href=\"javascript:;\" class=\"disabled clearfix\"> <span>没有可加载内容</span> </a> </div> </div>';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 265 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/topicAddMore/commentBox',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,htcyplmodule=$data.htcyplmodule,isExpert=$data.isExpert,userImage=$data.userImage,id=$data.id,readyOnly=$data.readyOnly,isLoginClass=$data.isLoginClass,isLoginStr=$data.isLoginStr,allNum=$data.allNum,$out='';$out+='<div data-node=\"commentBox\" class=\"topic-review-box\" modelid=\"';\n\t$out+=$escape(htcyplmodule);\n\t$out+='\"> <h2 class=\"review-title\">参与评论</h2> <div class=\"bjfff margin-btom20\" data-node=\"comment_FirDiv\"> <div class=\"text-field-box clearfix\"> <div class=\"topic-user-head\"> ';\n\tif(isExpert){\n\t$out+=' <em class=\"icon-daren\"></em> ';\n\t}\n\t$out+=' <img src=\"';\n\t$out+=$escape(userImage);\n\t$out+='\" onerror=\"imgError(this, \\'g\\')\"> </div> <div class=\"topic-publish-content\" data-node=\"comment_Msg\" data-nickname=\"\" data-tid=\"';\n\t$out+=$escape(id);\n\t$out+='\" data-userid=\"0\" data-headface=\"';\n\t$out+=$escape(userImage);\n\t$out+='\"> <textarea class=\"textarea-bx\" ';\n\t$out+=$escape(readyOnly);\n\t$out+=' placeholder=\"说点什么吧…\" style=\"background: rgb(255, 255, 255);\"></textarea> <label class=\"textarea-tips hide\" data-node=\"textareaTips\">说点什么吧…</label> <div data-node=\"addImgGoods\" data-imgNum =\"9\"> <ul data-node=\"imgUl\" class=\"clearfix hide\"></ul> </div> <div class=\"publish-face-bx\" data-publish=\"';\n\t$out+=$escape(id);\n\t$out+='\"> <p class=\"icon-face cursor-pointer\" data-node=\"smilies_Face\"><em class=\"icon-emoji\"></em>表情</p> <p class=\"icon-face cursor-pointer\" data-node=\"addImg_btn\"><em class=\"icon-picture\"></em>图片</p> <p class=\"icon-face cursor-pointer\" data-node=\"addGoods_btn\"><em class=\"icon-goods\"></em>商品</p> <a href=\"javascript:;\" class=\"pc-btn pc-btnh30 pc-btnw105 ';\n\t$out+=$escape(isLoginClass);\n\t$out+='\" data-node=\"a_Submit\">';\n\t$out+=$escape(isLoginStr);\n\t$out+='</a> </div> </div> </div> </div> </div> <div class=\"comment-title\" data-node=\"hidDiv\"> <div class=\"bd-bottom\"><span class=\"red\">';\n\t$out+=$escape(allNum);\n\t$out+='</span><span>条评论</span></div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 266 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/topicAddMore/topicRight',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htqzxxmodule=$data.htqzxxmodule,$string=$utils.$string,topicRT=$data.topicRT,htrmhtmodule=$data.htrmhtmodule,hotTopicUl=$data.hotTopicUl,htxyymodule=$data.htxyymodule,$out='';$out+='<div class=\"topic-right topic-absolute\" data-topicRT= ';\n\t$out+=$escape(id);\n\t$out+='> <div class=\"topic-r-t\" modelid=\"';\n\t$out+=$escape(htqzxxmodule);\n\t$out+='\"> <!--modelid=\"';\n\t$out+=$escape(htqzxxmodule);\n\t$out+='\"--> ';\n\t$out+=$string(topicRT);\n\t$out+=' </div> <div class=\"topic-position\" data-node=\"topic_xi\"> <div class=\"topic-r-b\" data-node=\"hot_topics\"> <!--modelid=\"';\n\t$out+=$escape(htrmhtmodule);\n\t$out+='\"--> ';\n\t$out+=$string(hotTopicUl);\n\t$out+=' </div> <div class=\"next-page\" data-node=\"next-page\" data-get-next-topic =';\n\t$out+=$escape(id);\n\t$out+=' style=\"display: none\" modelid=\"';\n\t$out+=$escape(htxyymodule);\n\t$out+='\"> <p><span class=\"f12\" data-node=\"times\"></span>下一篇</p> <a></a> </div> </div> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 267 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function(__webpack_provided_window_dot_jQuery) {'use strict';\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\t/**\n\t * History.js jQuery Adapter\n\t * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>\n\t * @license New BSD License <http://creativecommons.org/licenses/BSD/>\n\t */\n\t\n\t// Closure\n\t(function (window, undefined) {\n\t\t\"use strict\";\n\t\n\t\t// Localise Globals\n\t\n\t\tvar History = window.History = window.History || {},\n\t\t    jQuery = __webpack_provided_window_dot_jQuery;\n\t\n\t\t// Check Existence\n\t\tif (typeof History.Adapter !== 'undefined') {\n\t\t\tthrow new Error('History.js Adapter has already been loaded...');\n\t\t}\n\t\n\t\t// Add the Adapter\n\t\tHistory.Adapter = {\n\t\t\t/**\n\t   * History.Adapter.bind(el,event,callback)\n\t   * @param {Element|string} el\n\t   * @param {string} event - custom and standard events\n\t   * @param {function} callback\n\t   * @return {void}\n\t   */\n\t\t\tbind: function bind(el, event, callback) {\n\t\t\t\tjQuery(el).bind(event, callback);\n\t\t\t},\n\t\n\t\t\t/**\n\t   * History.Adapter.trigger(el,event)\n\t   * @param {Element|string} el\n\t   * @param {string} event - custom and standard events\n\t   * @param {Object=} extra - a object of extra event data (optional)\n\t   * @return {void}\n\t   */\n\t\t\ttrigger: function trigger(el, event, extra) {\n\t\t\t\tjQuery(el).trigger(event, extra);\n\t\t\t},\n\t\n\t\t\t/**\n\t   * History.Adapter.extractEventData(key,event,extra)\n\t   * @param {string} key - key for the event data to extract\n\t   * @param {string} event - custom and standard events\n\t   * @param {Object=} extra - a object of extra event data (optional)\n\t   * @return {mixed}\n\t   */\n\t\t\textractEventData: function extractEventData(key, event, extra) {\n\t\t\t\t// jQuery Native then jQuery Custom\n\t\t\t\tvar result = event && event.originalEvent && event.originalEvent[key] || extra && extra[key] || undefined;\n\t\n\t\t\t\t// Return\n\t\t\t\treturn result;\n\t\t\t},\n\t\n\t\t\t/**\n\t   * History.Adapter.onDomLoad(callback)\n\t   * @param {function} callback\n\t   * @return {void}\n\t   */\n\t\t\tonDomLoad: function onDomLoad(callback) {\n\t\t\t\tjQuery(callback);\n\t\t\t}\n\t\t};\n\t\n\t\t// Try and Initialise History\n\t\tif (typeof History.init !== 'undefined') {\n\t\t\tHistory.init();\n\t\t}\n\t})(window);\n\t\n\t/**\n\t * History.js Core\n\t * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>\n\t * @license New BSD License <http://creativecommons.org/licenses/BSD/>\n\t */\n\t\n\t(function (window, undefined) {\n\t\t\"use strict\";\n\t\n\t\t// ========================================================================\n\t\t// Initialise\n\t\n\t\t// Localise Globals\n\t\n\t\tvar console = window.console || undefined,\n\t\t    // Prevent a JSLint complain\n\t\tdocument = window.document,\n\t\t    // Make sure we are using the correct document\n\t\tnavigator = window.navigator,\n\t\t    // Make sure we are using the correct navigator\n\t\tsessionStorage = false,\n\t\t    // sessionStorage\n\t\tsetTimeout = window.setTimeout,\n\t\t    clearTimeout = window.clearTimeout,\n\t\t    setInterval = window.setInterval,\n\t\t    clearInterval = window.clearInterval,\n\t\t    JSON = window.JSON,\n\t\t    alert = window.alert,\n\t\t    History = window.History = window.History || {},\n\t\t    // Public History Object\n\t\thistory = window.history; // Old History Object\n\t\n\t\ttry {\n\t\t\tsessionStorage = window.sessionStorage; // This will throw an exception in some browsers when cookies/localStorage are explicitly disabled (i.e. Chrome)\n\t\t\tsessionStorage.setItem('TEST', '1');\n\t\t\tsessionStorage.removeItem('TEST');\n\t\t} catch (e) {\n\t\t\tsessionStorage = false;\n\t\t}\n\t\n\t\t// MooTools Compatibility\n\t\tJSON.stringify = JSON.stringify || JSON.encode;\n\t\tJSON.parse = JSON.parse || JSON.decode;\n\t\n\t\t// Check Existence\n\t\tif (typeof History.init !== 'undefined') {\n\t\t\tthrow new Error('History.js Core has already been loaded...');\n\t\t}\n\t\n\t\t// Initialise History\n\t\tHistory.init = function (options) {\n\t\t\t// Check Load Status of Adapter\n\t\t\tif (typeof History.Adapter === 'undefined') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\n\t\t\t// Check Load Status of Core\n\t\t\tif (typeof History.initCore !== 'undefined') {\n\t\t\t\tHistory.initCore();\n\t\t\t}\n\t\n\t\t\t// Check Load Status of HTML4 Support\n\t\t\tif (typeof History.initHtml4 !== 'undefined') {\n\t\t\t\tHistory.initHtml4();\n\t\t\t}\n\t\n\t\t\t// Return true\n\t\t\treturn true;\n\t\t};\n\t\n\t\t// ========================================================================\n\t\t// Initialise Core\n\t\n\t\t// Initialise Core\n\t\tHistory.initCore = function (options) {\n\t\t\t// Initialise\n\t\t\tif (typeof History.initCore.initialized !== 'undefined') {\n\t\t\t\t// Already Loaded\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tHistory.initCore.initialized = true;\n\t\t\t}\n\t\n\t\t\t// ====================================================================\n\t\t\t// Options\n\t\n\t\t\t/**\n\t   * History.options\n\t   * Configurable options\n\t   */\n\t\t\tHistory.options = History.options || {};\n\t\n\t\t\t/**\n\t   * History.options.hashChangeInterval\n\t   * How long should the interval be before hashchange checks\n\t   */\n\t\t\tHistory.options.hashChangeInterval = History.options.hashChangeInterval || 100;\n\t\n\t\t\t/**\n\t   * History.options.safariPollInterval\n\t   * How long should the interval be before safari poll checks\n\t   */\n\t\t\tHistory.options.safariPollInterval = History.options.safariPollInterval || 500;\n\t\n\t\t\t/**\n\t   * History.options.doubleCheckInterval\n\t   * How long should the interval be before we perform a double check\n\t   */\n\t\t\tHistory.options.doubleCheckInterval = History.options.doubleCheckInterval || 500;\n\t\n\t\t\t/**\n\t   * History.options.disableSuid\n\t   * Force History not to append suid\n\t   */\n\t\t\tHistory.options.disableSuid = History.options.disableSuid || false;\n\t\n\t\t\t/**\n\t   * History.options.storeInterval\n\t   * How long should we wait between store calls\n\t   */\n\t\t\tHistory.options.storeInterval = History.options.storeInterval || 1000;\n\t\n\t\t\t/**\n\t   * History.options.busyDelay\n\t   * How long should we wait between busy events\n\t   */\n\t\t\tHistory.options.busyDelay = History.options.busyDelay || 250;\n\t\n\t\t\t/**\n\t   * History.options.debug\n\t   * If true will enable debug messages to be logged\n\t   */\n\t\t\tHistory.options.debug = History.options.debug || false;\n\t\n\t\t\t/**\n\t   * History.options.initialTitle\n\t   * What is the title of the initial state\n\t   */\n\t\t\tHistory.options.initialTitle = History.options.initialTitle || document.title;\n\t\n\t\t\t/**\n\t   * History.options.html4Mode\n\t   * If true, will force HTMl4 mode (hashtags)\n\t   */\n\t\t\tHistory.options.html4Mode = History.options.html4Mode || false;\n\t\n\t\t\t/**\n\t   * History.options.delayInit\n\t   * Want to override default options and call init manually.\n\t   */\n\t\t\tHistory.options.delayInit = History.options.delayInit || false;\n\t\n\t\t\t// ====================================================================\n\t\t\t// Interval record\n\t\n\t\t\t/**\n\t   * History.intervalList\n\t   * List of intervals set, to be cleared when document is unloaded.\n\t   */\n\t\t\tHistory.intervalList = [];\n\t\n\t\t\t/**\n\t   * History.clearAllIntervals\n\t   * Clears all setInterval instances.\n\t   */\n\t\t\tHistory.clearAllIntervals = function () {\n\t\t\t\tvar i,\n\t\t\t\t    il = History.intervalList;\n\t\t\t\tif (typeof il !== \"undefined\" && il !== null) {\n\t\t\t\t\tfor (i = 0; i < il.length; i++) {\n\t\t\t\t\t\tclearInterval(il[i]);\n\t\t\t\t\t}\n\t\t\t\t\tHistory.intervalList = null;\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// Debug\n\t\n\t\t\t/**\n\t   * History.debug(message,...)\n\t   * Logs the passed arguments if debug enabled\n\t   */\n\t\t\tHistory.debug = function () {\n\t\t\t\tif (History.options.debug || false) {\n\t\t\t\t\tHistory.log.apply(History, arguments);\n\t\t\t\t}\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.log(message,...)\n\t   * Logs the passed arguments\n\t   */\n\t\t\tHistory.log = function () {\n\t\t\t\t// Prepare\n\t\t\t\tvar consoleExists = !(typeof console === 'undefined' || typeof console.log === 'undefined' || typeof console.log.apply === 'undefined'),\n\t\t\t\t    textarea = document.getElementById('log'),\n\t\t\t\t    message,\n\t\t\t\t    i,\n\t\t\t\t    n,\n\t\t\t\t    args,\n\t\t\t\t    arg;\n\t\n\t\t\t\t// Write to Console\n\t\t\t\tif (consoleExists) {\n\t\t\t\t\targs = Array.prototype.slice.call(arguments);\n\t\t\t\t\tmessage = args.shift();\n\t\t\t\t\tif (typeof console.debug !== 'undefined') {\n\t\t\t\t\t\tconsole.debug.apply(console, [message, args]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log.apply(console, [message, args]);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tmessage = \"\\n\" + arguments[0] + \"\\n\";\n\t\t\t\t}\n\t\n\t\t\t\t// Write to log\n\t\t\t\tfor (i = 1, n = arguments.length; i < n; ++i) {\n\t\t\t\t\targ = arguments[i];\n\t\t\t\t\tif ((typeof arg === 'undefined' ? 'undefined' : _typeof(arg)) === 'object' && typeof JSON !== 'undefined') {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\targ = JSON.stringify(arg);\n\t\t\t\t\t\t} catch (Exception) {\n\t\t\t\t\t\t\t// Recursive Object\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tmessage += \"\\n\" + arg + \"\\n\";\n\t\t\t\t}\n\t\n\t\t\t\t// Textarea\n\t\t\t\tif (textarea) {\n\t\t\t\t\ttextarea.value += message + \"\\n-----\\n\";\n\t\t\t\t\ttextarea.scrollTop = textarea.scrollHeight - textarea.clientHeight;\n\t\t\t\t}\n\t\t\t\t// No Textarea, No Console\n\t\t\t\telse if (!consoleExists) {\n\t\t\t\t\t\talert(message);\n\t\t\t\t\t}\n\t\n\t\t\t\t// Return true\n\t\t\t\treturn true;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// Emulated Status\n\t\n\t\t\t/**\n\t   * History.getInternetExplorerMajorVersion()\n\t   * Get's the major version of Internet Explorer\n\t   * @return {integer}\n\t   * @license Public Domain\n\t   * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t   * @author James Padolsey <https://gist.github.com/527683>\n\t   */\n\t\t\tHistory.getInternetExplorerMajorVersion = function () {\n\t\t\t\tvar result = History.getInternetExplorerMajorVersion.cached = typeof History.getInternetExplorerMajorVersion.cached !== 'undefined' ? History.getInternetExplorerMajorVersion.cached : function () {\n\t\t\t\t\tvar v = 3,\n\t\t\t\t\t    div = document.createElement('div'),\n\t\t\t\t\t    all = div.getElementsByTagName('i');\n\t\t\t\t\twhile ((div.innerHTML = '<!--[if gt IE ' + ++v + ']><i></i><![endif]-->') && all[0]) {}\n\t\t\t\t\treturn v > 4 ? v : false;\n\t\t\t\t}();\n\t\t\t\treturn result;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.isInternetExplorer()\n\t   * Are we using Internet Explorer?\n\t   * @return {boolean}\n\t   * @license Public Domain\n\t   * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t   */\n\t\t\tHistory.isInternetExplorer = function () {\n\t\t\t\tvar result = History.isInternetExplorer.cached = typeof History.isInternetExplorer.cached !== 'undefined' ? History.isInternetExplorer.cached : Boolean(History.getInternetExplorerMajorVersion());\n\t\t\t\treturn result;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.emulated\n\t   * Which features require emulating?\n\t   */\n\t\n\t\t\tif (History.options.html4Mode) {\n\t\t\t\tconsole.log(1);\n\t\t\t\tHistory.emulated = {\n\t\t\t\t\tpushState: true,\n\t\t\t\t\thashChange: true\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tHistory.emulated = {\n\t\t\t\t\tpushState: /trident\\/7.0/i.test(navigator.userAgent),\n\t\t\t\t\thashChange: History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8\n\t\t\t\t};\n\t\t\t}\n\t\n\t\t\t/**\n\t   * History.enabled\n\t   * Is History enabled?\n\t   */\n\t\t\tHistory.enabled = !History.emulated.pushState;\n\t\n\t\t\t/**\n\t   * History.bugs\n\t   * Which bugs are present\n\t   */\n\t\t\tHistory.bugs = {\n\t\t\t\t/**\n\t    * Safari 5 and Safari iOS 4 fail to return to the correct state once a hash is replaced by a `replaceState` call\n\t    * https://bugs.webkit.org/show_bug.cgi?id=56249\n\t    */\n\t\t\t\tsetHash: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\t\n\t\t\t\t/**\n\t    * Safari 5 and Safari iOS 4 sometimes fail to apply the state change under busy conditions\n\t    * https://bugs.webkit.org/show_bug.cgi?id=42940\n\t    */\n\t\t\t\tsafariPoll: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\t\n\t\t\t\t/**\n\t    * MSIE 6 and 7 sometimes do not apply a hash even it was told to (requiring a second call to the apply function)\n\t    */\n\t\t\t\tieDoubleCheck: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8),\n\t\n\t\t\t\t/**\n\t    * MSIE 6 requires the entire hash to be encoded for the hashes to trigger the onHashChange event\n\t    */\n\t\t\t\thashEscape: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 7)\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.isEmptyObject(obj)\n\t   * Checks to see if the Object is Empty\n\t   * @param {Object} obj\n\t   * @return {boolean}\n\t   */\n\t\t\tHistory.isEmptyObject = function (obj) {\n\t\t\t\tfor (var name in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(name)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.cloneObject(obj)\n\t   * Clones a object and eliminate all references to the original contexts\n\t   * @param {Object} obj\n\t   * @return {Object}\n\t   */\n\t\t\tHistory.cloneObject = function (obj) {\n\t\t\t\tvar hash, newObj;\n\t\t\t\tif (obj) {\n\t\t\t\t\thash = JSON.stringify(obj);\n\t\t\t\t\tnewObj = JSON.parse(hash);\n\t\t\t\t} else {\n\t\t\t\t\tnewObj = {};\n\t\t\t\t}\n\t\t\t\treturn newObj;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// URL Helpers\n\t\n\t\t\t/**\n\t   * History.getRootUrl()\n\t   * Turns \"http://mysite.com/dir/page.html?asd\" into \"http://mysite.com\"\n\t   * @return {String} rootUrl\n\t   */\n\t\t\tHistory.getRootUrl = function () {\n\t\t\t\t// Create\n\t\t\t\tvar rootUrl = document.location.protocol + '//' + (document.location.hostname || document.location.host);\n\t\t\t\tif (document.location.port || false) {\n\t\t\t\t\trootUrl += ':' + document.location.port;\n\t\t\t\t}\n\t\t\t\trootUrl += '/';\n\t\n\t\t\t\t// Return\n\t\t\t\treturn rootUrl;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getBaseHref()\n\t   * Fetches the `href` attribute of the `<base href=\"...\">` element if it exists\n\t   * @return {String} baseHref\n\t   */\n\t\t\tHistory.getBaseHref = function () {\n\t\t\t\t// Create\n\t\t\t\tvar baseElements = document.getElementsByTagName('base'),\n\t\t\t\t    baseElement = null,\n\t\t\t\t    baseHref = '';\n\t\n\t\t\t\t// Test for Base Element\n\t\t\t\tif (baseElements.length === 1) {\n\t\t\t\t\t// Prepare for Base Element\n\t\t\t\t\tbaseElement = baseElements[0];\n\t\t\t\t\tbaseHref = baseElement.href.replace(/[^\\/]+$/, '');\n\t\t\t\t}\n\t\n\t\t\t\t// Adjust trailing slash\n\t\t\t\tbaseHref = baseHref.replace(/\\/+$/, '');\n\t\t\t\tif (baseHref) baseHref += '/';\n\t\n\t\t\t\t// Return\n\t\t\t\treturn baseHref;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getBaseUrl()\n\t   * Fetches the baseHref or basePageUrl or rootUrl (whichever one exists first)\n\t   * @return {String} baseUrl\n\t   */\n\t\t\tHistory.getBaseUrl = function () {\n\t\t\t\t// Create\n\t\t\t\tvar baseUrl = History.getBaseHref() || History.getBasePageUrl() || History.getRootUrl();\n\t\n\t\t\t\t// Return\n\t\t\t\treturn baseUrl;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getPageUrl()\n\t   * Fetches the URL of the current page\n\t   * @return {String} pageUrl\n\t   */\n\t\t\tHistory.getPageUrl = function () {\n\t\t\t\t// Fetch\n\t\t\t\tvar State = History.getState(false, false),\n\t\t\t\t    stateUrl = (State || {}).url || History.getLocationHref(),\n\t\t\t\t    pageUrl;\n\t\n\t\t\t\t// Create\n\t\t\t\tpageUrl = stateUrl.replace(/\\/+$/, '').replace(/[^\\/]+$/, function (part, index, string) {\n\t\t\t\t\treturn (/\\./.test(part) ? part : part + '/'\n\t\t\t\t\t);\n\t\t\t\t});\n\t\n\t\t\t\t// Return\n\t\t\t\treturn pageUrl;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getBasePageUrl()\n\t   * Fetches the Url of the directory of the current page\n\t   * @return {String} basePageUrl\n\t   */\n\t\t\tHistory.getBasePageUrl = function () {\n\t\t\t\t// Create\n\t\t\t\tvar basePageUrl = History.getLocationHref().replace(/[#\\?].*/, '').replace(/[^\\/]+$/, function (part, index, string) {\n\t\t\t\t\treturn (/[^\\/]$/.test(part) ? '' : part\n\t\t\t\t\t);\n\t\t\t\t}).replace(/\\/+$/, '') + '/';\n\t\n\t\t\t\t// Return\n\t\t\t\treturn basePageUrl;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getFullUrl(url)\n\t   * Ensures that we have an absolute URL and not a relative URL\n\t   * @param {string} url\n\t   * @param {Boolean} allowBaseHref\n\t   * @return {string} fullUrl\n\t   */\n\t\t\tHistory.getFullUrl = function (url, allowBaseHref) {\n\t\t\t\t// Prepare\n\t\t\t\tvar fullUrl = url,\n\t\t\t\t    firstChar = url.substring(0, 1);\n\t\t\t\tallowBaseHref = typeof allowBaseHref === 'undefined' ? true : allowBaseHref;\n\t\n\t\t\t\t// Check\n\t\t\t\tif (/[a-z]+\\:\\/\\//.test(url)) {\n\t\t\t\t\t// Full URL\n\t\t\t\t} else if (firstChar === '/') {\n\t\t\t\t\t// Root URL\n\t\t\t\t\tfullUrl = History.getRootUrl() + url.replace(/^\\/+/, '');\n\t\t\t\t} else if (firstChar === '#') {\n\t\t\t\t\t// Anchor URL\n\t\t\t\t\tfullUrl = History.getPageUrl().replace(/#.*/, '') + url;\n\t\t\t\t} else if (firstChar === '?') {\n\t\t\t\t\t// Query URL\n\t\t\t\t\tfullUrl = History.getPageUrl().replace(/[\\?#].*/, '') + url;\n\t\t\t\t} else {\n\t\t\t\t\t// Relative URL\n\t\t\t\t\tif (allowBaseHref) {\n\t\t\t\t\t\tfullUrl = History.getBaseUrl() + url.replace(/^(\\.\\/)+/, '');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfullUrl = History.getBasePageUrl() + url.replace(/^(\\.\\/)+/, '');\n\t\t\t\t\t}\n\t\t\t\t\t// We have an if condition above as we do not want hashes\n\t\t\t\t\t// which are relative to the baseHref in our URLs\n\t\t\t\t\t// as if the baseHref changes, then all our bookmarks\n\t\t\t\t\t// would now point to different locations\n\t\t\t\t\t// whereas the basePageUrl will always stay the same\n\t\t\t\t}\n\t\n\t\t\t\t// Return\n\t\t\t\treturn fullUrl.replace(/\\#$/, '');\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getShortUrl(url)\n\t   * Ensures that we have a relative URL and not a absolute URL\n\t   * @param {string} url\n\t   * @return {string} url\n\t   */\n\t\t\tHistory.getShortUrl = function (url) {\n\t\t\t\t// Prepare\n\t\t\t\tvar shortUrl = url,\n\t\t\t\t    baseUrl = History.getBaseUrl(),\n\t\t\t\t    rootUrl = History.getRootUrl();\n\t\n\t\t\t\t// Trim baseUrl\n\t\t\t\tif (History.emulated.pushState) {\n\t\t\t\t\t// We are in a if statement as when pushState is not emulated\n\t\t\t\t\t// The actual url these short urls are relative to can change\n\t\t\t\t\t// So within the same session, we the url may end up somewhere different\n\t\t\t\t\tshortUrl = shortUrl.replace(baseUrl, '');\n\t\t\t\t}\n\t\n\t\t\t\t// Trim rootUrl\n\t\t\t\tshortUrl = shortUrl.replace(rootUrl, '/');\n\t\n\t\t\t\t// Ensure we can still detect it as a state\n\t\t\t\tif (History.isTraditionalAnchor(shortUrl)) {\n\t\t\t\t\tshortUrl = './' + shortUrl;\n\t\t\t\t}\n\t\n\t\t\t\t// Clean It\n\t\t\t\tshortUrl = shortUrl.replace(/^(\\.\\/)+/g, './').replace(/\\#$/, '');\n\t\n\t\t\t\t// Return\n\t\t\t\treturn shortUrl;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getLocationHref(document)\n\t   * Returns a normalized version of document.location.href\n\t   * accounting for browser inconsistencies, etc.\n\t   *\n\t   * This URL will be URI-encoded and will include the hash\n\t   *\n\t   * @param {object} document\n\t   * @return {string} url\n\t   */\n\t\t\tHistory.getLocationHref = function (doc) {\n\t\t\t\tdoc = doc || document;\n\t\n\t\t\t\t// most of the time, this will be true\n\t\t\t\tif (doc.URL === doc.location.href) return doc.location.href;\n\t\n\t\t\t\t// some versions of webkit URI-decode document.location.href\n\t\t\t\t// but they leave document.URL in an encoded state\n\t\t\t\tif (doc.location.href === decodeURIComponent(doc.URL)) return doc.URL;\n\t\n\t\t\t\t// FF 3.6 only updates document.URL when a page is reloaded\n\t\t\t\t// document.location.href is updated correctly\n\t\t\t\tif (doc.location.hash && decodeURIComponent(doc.location.href.replace(/^[^#]+/, \"\")) === doc.location.hash) return doc.location.href;\n\t\n\t\t\t\tif (doc.URL.indexOf('#') == -1 && doc.location.href.indexOf('#') != -1) return doc.location.href;\n\t\n\t\t\t\treturn doc.URL || doc.location.href;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// State Storage\n\t\n\t\t\t/**\n\t   * History.store\n\t   * The store for all session specific data\n\t   */\n\t\t\tHistory.store = {};\n\t\n\t\t\t/**\n\t   * History.idToState\n\t   * 1-1: State ID to State Object\n\t   */\n\t\t\tHistory.idToState = History.idToState || {};\n\t\n\t\t\t/**\n\t   * History.stateToId\n\t   * 1-1: State String to State ID\n\t   */\n\t\t\tHistory.stateToId = History.stateToId || {};\n\t\n\t\t\t/**\n\t   * History.urlToId\n\t   * 1-1: State URL to State ID\n\t   */\n\t\t\tHistory.urlToId = History.urlToId || {};\n\t\n\t\t\t/**\n\t   * History.storedStates\n\t   * Store the states in an array\n\t   */\n\t\t\tHistory.storedStates = History.storedStates || [];\n\t\n\t\t\t/**\n\t   * History.savedStates\n\t   * Saved the states in an array\n\t   */\n\t\t\tHistory.savedStates = History.savedStates || [];\n\t\n\t\t\t/**\n\t   * History.noramlizeStore()\n\t   * Noramlize the store by adding necessary values\n\t   */\n\t\t\tHistory.normalizeStore = function () {\n\t\t\t\tHistory.store.idToState = History.store.idToState || {};\n\t\t\t\tHistory.store.urlToId = History.store.urlToId || {};\n\t\t\t\tHistory.store.stateToId = History.store.stateToId || {};\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getState()\n\t   * Get an object containing the data, title and url of the current state\n\t   * @param {Boolean} friendly\n\t   * @param {Boolean} create\n\t   * @return {Object} State\n\t   */\n\t\t\tHistory.getState = function (friendly, create) {\n\t\t\t\t// Prepare\n\t\t\t\tif (typeof friendly === 'undefined') {\n\t\t\t\t\tfriendly = true;\n\t\t\t\t}\n\t\t\t\tif (typeof create === 'undefined') {\n\t\t\t\t\tcreate = true;\n\t\t\t\t}\n\t\n\t\t\t\t// Fetch\n\t\t\t\tvar State = History.getLastSavedState();\n\t\n\t\t\t\t// Create\n\t\t\t\tif (!State && create) {\n\t\t\t\t\tState = History.createStateObject();\n\t\t\t\t}\n\t\n\t\t\t\t// Adjust\n\t\t\t\tif (friendly) {\n\t\t\t\t\tState = History.cloneObject(State);\n\t\t\t\t\tState.url = State.cleanUrl || State.url;\n\t\t\t\t}\n\t\n\t\t\t\t// Return\n\t\t\t\treturn State;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getIdByState(State)\n\t   * Gets a ID for a State\n\t   * @param {State} newState\n\t   * @return {String} id\n\t   */\n\t\t\tHistory.getIdByState = function (newState) {\n\t\n\t\t\t\t// Fetch ID\n\t\t\t\tvar id = History.extractId(newState.url),\n\t\t\t\t    str;\n\t\n\t\t\t\tif (!id) {\n\t\t\t\t\t// Find ID via State String\n\t\t\t\t\tstr = History.getStateString(newState);\n\t\t\t\t\tif (typeof History.stateToId[str] !== 'undefined') {\n\t\t\t\t\t\tid = History.stateToId[str];\n\t\t\t\t\t} else if (typeof History.store.stateToId[str] !== 'undefined') {\n\t\t\t\t\t\tid = History.store.stateToId[str];\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Generate a new ID\n\t\t\t\t\t\twhile (true) {\n\t\t\t\t\t\t\tid = new Date().getTime() + String(Math.random()).replace(/\\D/g, '');\n\t\t\t\t\t\t\tif (typeof History.idToState[id] === 'undefined' && typeof History.store.idToState[id] === 'undefined') {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Apply the new State to the ID\n\t\t\t\t\t\tHistory.stateToId[str] = id;\n\t\t\t\t\t\tHistory.idToState[id] = newState;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t// Return ID\n\t\t\t\treturn id;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.normalizeState(State)\n\t   * Expands a State Object\n\t   * @param {object} State\n\t   * @return {object}\n\t   */\n\t\t\tHistory.normalizeState = function (oldState) {\n\t\t\t\t// Variables\n\t\t\t\tvar newState, dataNotEmpty;\n\t\n\t\t\t\t// Prepare\n\t\t\t\tif (!oldState || (typeof oldState === 'undefined' ? 'undefined' : _typeof(oldState)) !== 'object') {\n\t\t\t\t\toldState = {};\n\t\t\t\t}\n\t\n\t\t\t\t// Check\n\t\t\t\tif (typeof oldState.normalized !== 'undefined') {\n\t\t\t\t\treturn oldState;\n\t\t\t\t}\n\t\n\t\t\t\t// Adjust\n\t\t\t\tif (!oldState.data || _typeof(oldState.data) !== 'object') {\n\t\t\t\t\toldState.data = {};\n\t\t\t\t}\n\t\n\t\t\t\t// ----------------------------------------------------------------\n\t\n\t\t\t\t// Create\n\t\t\t\tnewState = {};\n\t\t\t\tnewState.normalized = true;\n\t\t\t\tnewState.title = oldState.title || '';\n\t\t\t\tnewState.url = History.getFullUrl(oldState.url ? oldState.url : History.getLocationHref());\n\t\t\t\tnewState.hash = History.getShortUrl(newState.url);\n\t\t\t\tnewState.data = History.cloneObject(oldState.data);\n\t\n\t\t\t\t// Fetch ID\n\t\t\t\tnewState.id = History.getIdByState(newState);\n\t\n\t\t\t\t// ----------------------------------------------------------------\n\t\n\t\t\t\t// Clean the URL\n\t\t\t\tnewState.cleanUrl = newState.url.replace(/\\??\\&_suid.*/, '');\n\t\t\t\tnewState.url = newState.cleanUrl;\n\t\n\t\t\t\t// Check to see if we have more than just a url\n\t\t\t\tdataNotEmpty = !History.isEmptyObject(newState.data);\n\t\n\t\t\t\t// Apply\n\t\t\t\tif ((newState.title || dataNotEmpty) && History.options.disableSuid !== true) {\n\t\t\t\t\t// Add ID to Hash\n\t\t\t\t\tnewState.hash = History.getShortUrl(newState.url).replace(/\\??\\&_suid.*/, '');\n\t\t\t\t\tif (!/\\?/.test(newState.hash)) {\n\t\t\t\t\t\tnewState.hash += '?';\n\t\t\t\t\t}\n\t\t\t\t\tnewState.hash += '&_suid=' + newState.id;\n\t\t\t\t}\n\t\n\t\t\t\t// Create the Hashed URL\n\t\t\t\tnewState.hashedUrl = History.getFullUrl(newState.hash);\n\t\n\t\t\t\t// ----------------------------------------------------------------\n\t\n\t\t\t\t// Update the URL if we have a duplicate\n\t\t\t\tif ((History.emulated.pushState || History.bugs.safariPoll) && History.hasUrlDuplicate(newState)) {\n\t\t\t\t\tnewState.url = newState.hashedUrl;\n\t\t\t\t}\n\t\n\t\t\t\t// ----------------------------------------------------------------\n\t\n\t\t\t\t// Return\n\t\t\t\treturn newState;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.createStateObject(data,title,url)\n\t   * Creates a object based on the data, title and url state params\n\t   * @param {object} data\n\t   * @param {string} title\n\t   * @param {string} url\n\t   * @return {object}\n\t   */\n\t\t\tHistory.createStateObject = function (data, title, url) {\n\t\t\t\t// Hashify\n\t\t\t\tvar State = {\n\t\t\t\t\t'data': data,\n\t\t\t\t\t'title': title,\n\t\t\t\t\t'url': url\n\t\t\t\t};\n\t\n\t\t\t\t// Expand the State\n\t\t\t\tState = History.normalizeState(State);\n\t\n\t\t\t\t// Return object\n\t\t\t\treturn State;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getStateById(id)\n\t   * Get a state by it's UID\n\t   * @param {String} id\n\t   */\n\t\t\tHistory.getStateById = function (id) {\n\t\t\t\t// Prepare\n\t\t\t\tid = String(id);\n\t\n\t\t\t\t// Retrieve\n\t\t\t\tvar State = History.idToState[id] || History.store.idToState[id] || undefined;\n\t\n\t\t\t\t// Return State\n\t\t\t\treturn State;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * Get a State's String\n\t   * @param {State} passedState\n\t   */\n\t\t\tHistory.getStateString = function (passedState) {\n\t\t\t\t// Prepare\n\t\t\t\tvar State, cleanedState, str;\n\t\n\t\t\t\t// Fetch\n\t\t\t\tState = History.normalizeState(passedState);\n\t\n\t\t\t\t// Clean\n\t\t\t\tcleanedState = {\n\t\t\t\t\tdata: State.data,\n\t\t\t\t\ttitle: passedState.title,\n\t\t\t\t\turl: passedState.url\n\t\t\t\t};\n\t\n\t\t\t\t// Fetch\n\t\t\t\tstr = JSON.stringify(cleanedState);\n\t\n\t\t\t\t// Return\n\t\t\t\treturn str;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * Get a State's ID\n\t   * @param {State} passedState\n\t   * @return {String} id\n\t   */\n\t\t\tHistory.getStateId = function (passedState) {\n\t\t\t\t// Prepare\n\t\t\t\tvar State, id;\n\t\n\t\t\t\t// Fetch\n\t\t\t\tState = History.normalizeState(passedState);\n\t\n\t\t\t\t// Fetch\n\t\t\t\tid = State.id;\n\t\n\t\t\t\t// Return\n\t\t\t\treturn id;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getHashByState(State)\n\t   * Creates a Hash for the State Object\n\t   * @param {State} passedState\n\t   * @return {String} hash\n\t   */\n\t\t\tHistory.getHashByState = function (passedState) {\n\t\t\t\t// Prepare\n\t\t\t\tvar State, hash;\n\t\n\t\t\t\t// Fetch\n\t\t\t\tState = History.normalizeState(passedState);\n\t\n\t\t\t\t// Hash\n\t\t\t\thash = State.hash;\n\t\n\t\t\t\t// Return\n\t\t\t\treturn hash;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.extractId(url_or_hash)\n\t   * Get a State ID by it's URL or Hash\n\t   * @param {string} url_or_hash\n\t   * @return {string} id\n\t   */\n\t\t\tHistory.extractId = function (url_or_hash) {\n\t\t\t\t// Prepare\n\t\t\t\tvar id, parts, url, tmp;\n\t\n\t\t\t\t// Extract\n\t\n\t\t\t\t// If the URL has a #, use the id from before the #\n\t\t\t\tif (url_or_hash.indexOf('#') != -1) {\n\t\t\t\t\ttmp = url_or_hash.split(\"#\")[0];\n\t\t\t\t} else {\n\t\t\t\t\ttmp = url_or_hash;\n\t\t\t\t}\n\t\n\t\t\t\tparts = /(.*)\\&_suid=([0-9]+)$/.exec(tmp);\n\t\t\t\turl = parts ? parts[1] || url_or_hash : url_or_hash;\n\t\t\t\tid = parts ? String(parts[2] || '') : '';\n\t\n\t\t\t\t// Return\n\t\t\t\treturn id || false;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.isTraditionalAnchor\n\t   * Checks to see if the url is a traditional anchor or not\n\t   * @param {String} url_or_hash\n\t   * @return {Boolean}\n\t   */\n\t\t\tHistory.isTraditionalAnchor = function (url_or_hash) {\n\t\t\t\t// Check\n\t\t\t\tvar isTraditional = !/[\\/\\?\\.]/.test(url_or_hash);\n\t\n\t\t\t\t// Return\n\t\t\t\treturn isTraditional;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.extractState\n\t   * Get a State by it's URL or Hash\n\t   * @param {String} url_or_hash\n\t   * @return {State|null}\n\t   */\n\t\t\tHistory.extractState = function (url_or_hash, create) {\n\t\t\t\t// Prepare\n\t\t\t\tvar State = null,\n\t\t\t\t    id,\n\t\t\t\t    url;\n\t\t\t\tcreate = create || false;\n\t\n\t\t\t\t// Fetch SUID\n\t\t\t\tid = History.extractId(url_or_hash);\n\t\t\t\tif (id) {\n\t\t\t\t\tState = History.getStateById(id);\n\t\t\t\t}\n\t\n\t\t\t\t// Fetch SUID returned no State\n\t\t\t\tif (!State) {\n\t\t\t\t\t// Fetch URL\n\t\t\t\t\turl = History.getFullUrl(url_or_hash);\n\t\n\t\t\t\t\t// Check URL\n\t\t\t\t\tid = History.getIdByUrl(url) || false;\n\t\t\t\t\tif (id) {\n\t\t\t\t\t\tState = History.getStateById(id);\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Create State\n\t\t\t\t\tif (!State && create && !History.isTraditionalAnchor(url_or_hash)) {\n\t\t\t\t\t\tState = History.createStateObject(null, null, url);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t// Return\n\t\t\t\treturn State;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getIdByUrl()\n\t   * Get a State ID by a State URL\n\t   */\n\t\t\tHistory.getIdByUrl = function (url) {\n\t\t\t\t// Fetch\n\t\t\t\tvar id = History.urlToId[url] || History.store.urlToId[url] || undefined;\n\t\n\t\t\t\t// Return\n\t\t\t\treturn id;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getLastSavedState()\n\t   * Get an object containing the data, title and url of the current state\n\t   * @return {Object} State\n\t   */\n\t\t\tHistory.getLastSavedState = function () {\n\t\t\t\treturn History.savedStates[History.savedStates.length - 1] || undefined;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getLastStoredState()\n\t   * Get an object containing the data, title and url of the current state\n\t   * @return {Object} State\n\t   */\n\t\t\tHistory.getLastStoredState = function () {\n\t\t\t\treturn History.storedStates[History.storedStates.length - 1] || undefined;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.hasUrlDuplicate\n\t   * Checks if a Url will have a url conflict\n\t   * @param {Object} newState\n\t   * @return {Boolean} hasDuplicate\n\t   */\n\t\t\tHistory.hasUrlDuplicate = function (newState) {\n\t\t\t\t// Prepare\n\t\t\t\tvar hasDuplicate = false,\n\t\t\t\t    oldState;\n\t\n\t\t\t\t// Fetch\n\t\t\t\toldState = History.extractState(newState.url);\n\t\n\t\t\t\t// Check\n\t\t\t\thasDuplicate = oldState && oldState.id !== newState.id;\n\t\n\t\t\t\t// Return\n\t\t\t\treturn hasDuplicate;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.storeState\n\t   * Store a State\n\t   * @param {Object} newState\n\t   * @return {Object} newState\n\t   */\n\t\t\tHistory.storeState = function (newState) {\n\t\t\t\t// Store the State\n\t\t\t\tHistory.urlToId[newState.url] = newState.id;\n\t\n\t\t\t\t// Push the State\n\t\t\t\tHistory.storedStates.push(History.cloneObject(newState));\n\t\n\t\t\t\t// Return newState\n\t\t\t\treturn newState;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.isLastSavedState(newState)\n\t   * Tests to see if the state is the last state\n\t   * @param {Object} newState\n\t   * @return {boolean} isLast\n\t   */\n\t\t\tHistory.isLastSavedState = function (newState) {\n\t\t\t\t// Prepare\n\t\t\t\tvar isLast = false,\n\t\t\t\t    newId,\n\t\t\t\t    oldState,\n\t\t\t\t    oldId;\n\t\n\t\t\t\t// Check\n\t\t\t\tif (History.savedStates.length) {\n\t\t\t\t\tnewId = newState.id;\n\t\t\t\t\toldState = History.getLastSavedState();\n\t\t\t\t\toldId = oldState.id;\n\t\n\t\t\t\t\t// Check\n\t\t\t\t\tisLast = newId === oldId;\n\t\t\t\t}\n\t\n\t\t\t\t// Return\n\t\t\t\treturn isLast;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.saveState\n\t   * Push a State\n\t   * @param {Object} newState\n\t   * @return {boolean} changed\n\t   */\n\t\t\tHistory.saveState = function (newState) {\n\t\t\t\t// Check Hash\n\t\t\t\tif (History.isLastSavedState(newState)) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t// Push the State\n\t\t\t\tHistory.savedStates.push(History.cloneObject(newState));\n\t\n\t\t\t\t// Return true\n\t\t\t\treturn true;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getStateByIndex()\n\t   * Gets a state by the index\n\t   * @param {integer} index\n\t   * @return {Object}\n\t   */\n\t\t\tHistory.getStateByIndex = function (index) {\n\t\t\t\t// Prepare\n\t\t\t\tvar State = null;\n\t\n\t\t\t\t// Handle\n\t\t\t\tif (typeof index === 'undefined') {\n\t\t\t\t\t// Get the last inserted\n\t\t\t\t\tState = History.savedStates[History.savedStates.length - 1];\n\t\t\t\t} else if (index < 0) {\n\t\t\t\t\t// Get from the end\n\t\t\t\t\tState = History.savedStates[History.savedStates.length + index];\n\t\t\t\t} else {\n\t\t\t\t\t// Get from the beginning\n\t\t\t\t\tState = History.savedStates[index];\n\t\t\t\t}\n\t\n\t\t\t\t// Return State\n\t\t\t\treturn State;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getCurrentIndex()\n\t   * Gets the current index\n\t   * @return (integer)\n\t  */\n\t\t\tHistory.getCurrentIndex = function () {\n\t\t\t\t// Prepare\n\t\t\t\tvar index = null;\n\t\n\t\t\t\t// No states saved\n\t\t\t\tif (History.savedStates.length < 1) {\n\t\t\t\t\tindex = 0;\n\t\t\t\t} else {\n\t\t\t\t\tindex = History.savedStates.length - 1;\n\t\t\t\t}\n\t\t\t\treturn index;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// Hash Helpers\n\t\n\t\t\t/**\n\t   * History.getHash()\n\t   * @param {Location=} location\n\t   * Gets the current document hash\n\t   * Note: unlike location.hash, this is guaranteed to return the escaped hash in all browsers\n\t   * @return {string}\n\t   */\n\t\t\tHistory.getHash = function (doc) {\n\t\t\t\tvar url = History.getLocationHref(doc),\n\t\t\t\t    hash;\n\t\t\t\thash = History.getHashByUrl(url);\n\t\t\t\treturn hash;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.unescapeHash()\n\t   * normalize and Unescape a Hash\n\t   * @param {String} hash\n\t   * @return {string}\n\t   */\n\t\t\tHistory.unescapeHash = function (hash) {\n\t\t\t\t// Prepare\n\t\t\t\tvar result = History.normalizeHash(hash);\n\t\n\t\t\t\t// Unescape hash\n\t\t\t\tresult = decodeURIComponent(result);\n\t\n\t\t\t\t// Return result\n\t\t\t\treturn result;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.normalizeHash()\n\t   * normalize a hash across browsers\n\t   * @return {string}\n\t   */\n\t\t\tHistory.normalizeHash = function (hash) {\n\t\t\t\t// Prepare\n\t\t\t\tvar result = hash.replace(/[^#]*#/, '').replace(/#.*/, '');\n\t\n\t\t\t\t// Return result\n\t\t\t\treturn result;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.setHash(hash)\n\t   * Sets the document hash\n\t   * @param {string} hash\n\t   * @return {History}\n\t   */\n\t\t\tHistory.setHash = function (hash, queue) {\n\t\t\t\t// Prepare\n\t\t\t\tvar State, pageUrl;\n\t\n\t\t\t\t// Handle Queueing\n\t\t\t\tif (queue !== false && History.busy()) {\n\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t//History.debug('History.setHash: we must wait', arguments);\n\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\tcallback: History.setHash,\n\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t// Log\n\t\t\t\t//History.debug('History.setHash: called',hash);\n\t\n\t\t\t\t// Make Busy + Continue\n\t\t\t\tHistory.busy(true);\n\t\n\t\t\t\t// Check if hash is a state\n\t\t\t\tState = History.extractState(hash, true);\n\t\t\t\tif (State && !History.emulated.pushState) {\n\t\t\t\t\t// Hash is a state so skip the setHash\n\t\t\t\t\t//History.debug('History.setHash: Hash is a state so skipping the hash set with a direct pushState call',arguments);\n\t\n\t\t\t\t\t// PushState\n\t\t\t\t\tHistory.pushState(State.data, State.title, State.url, false);\n\t\t\t\t} else if (History.getHash() !== hash) {\n\t\t\t\t\t// Hash is a proper hash, so apply it\n\t\n\t\t\t\t\t// Handle browser bugs\n\t\t\t\t\tif (History.bugs.setHash) {\n\t\t\t\t\t\t// Fix Safari Bug https://bugs.webkit.org/show_bug.cgi?id=56249\n\t\n\t\t\t\t\t\t// Fetch the base page\n\t\t\t\t\t\tpageUrl = History.getPageUrl();\n\t\n\t\t\t\t\t\t// Safari hash apply\n\t\t\t\t\t\tHistory.pushState(null, null, pageUrl + '#' + hash, false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Normal hash apply\n\t\t\t\t\t\tdocument.location.hash = hash;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.escape()\n\t   * normalize and Escape a Hash\n\t   * @return {string}\n\t   */\n\t\t\tHistory.escapeHash = function (hash) {\n\t\t\t\t// Prepare\n\t\t\t\tvar result = History.normalizeHash(hash);\n\t\n\t\t\t\t// Escape hash\n\t\t\t\tresult = window.encodeURIComponent(result);\n\t\n\t\t\t\t// IE6 Escape Bug\n\t\t\t\tif (!History.bugs.hashEscape) {\n\t\t\t\t\t// Restore common parts\n\t\t\t\t\tresult = result.replace(/\\%21/g, '!').replace(/\\%26/g, '&').replace(/\\%3D/g, '=').replace(/\\%3F/g, '?');\n\t\t\t\t}\n\t\n\t\t\t\t// Return result\n\t\t\t\treturn result;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.getHashByUrl(url)\n\t   * Extracts the Hash from a URL\n\t   * @param {string} url\n\t   * @return {string} url\n\t   */\n\t\t\tHistory.getHashByUrl = function (url) {\n\t\t\t\t// Extract the hash\n\t\t\t\tvar hash = String(url).replace(/([^#]*)#?([^#]*)#?(.*)/, '$2');\n\t\n\t\t\t\t// Unescape hash\n\t\t\t\thash = History.unescapeHash(hash);\n\t\n\t\t\t\t// Return hash\n\t\t\t\treturn hash;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.setTitle(title)\n\t   * Applies the title to the document\n\t   * @param {State} newState\n\t   * @return {Boolean}\n\t   */\n\t\t\tHistory.setTitle = function (newState) {\n\t\t\t\t// Prepare\n\t\t\t\tvar title = newState.title,\n\t\t\t\t    firstState;\n\t\n\t\t\t\t// Initial\n\t\t\t\tif (!title) {\n\t\t\t\t\tfirstState = History.getStateByIndex(0);\n\t\t\t\t\tif (firstState && firstState.url === newState.url) {\n\t\t\t\t\t\ttitle = firstState.title || History.options.initialTitle;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t// Apply\n\t\t\t\ttry {\n\t\t\t\t\tdocument.getElementsByTagName('title')[0].innerHTML = title.replace('<', '&lt;').replace('>', '&gt;').replace(' & ', ' &amp; ');\n\t\t\t\t} catch (Exception) {}\n\t\t\t\tdocument.title = title;\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// Queueing\n\t\n\t\t\t/**\n\t   * History.queues\n\t   * The list of queues to use\n\t   * First In, First Out\n\t   */\n\t\t\tHistory.queues = [];\n\t\n\t\t\t/**\n\t   * History.busy(value)\n\t   * @param {boolean} value [optional]\n\t   * @return {boolean} busy\n\t   */\n\t\t\tHistory.busy = function (value) {\n\t\t\t\t// Apply\n\t\t\t\tif (typeof value !== 'undefined') {\n\t\t\t\t\t//History.debug('History.busy: changing ['+(History.busy.flag||false)+'] to ['+(value||false)+']', History.queues.length);\n\t\t\t\t\tHistory.busy.flag = value;\n\t\t\t\t}\n\t\t\t\t// Default\n\t\t\t\telse if (typeof History.busy.flag === 'undefined') {\n\t\t\t\t\t\tHistory.busy.flag = false;\n\t\t\t\t\t}\n\t\n\t\t\t\t// Queue\n\t\t\t\tif (!History.busy.flag) {\n\t\t\t\t\t// Execute the next item in the queue\n\t\t\t\t\tclearTimeout(History.busy.timeout);\n\t\t\t\t\tvar fireNext = function fireNext() {\n\t\t\t\t\t\tvar i, queue, item;\n\t\t\t\t\t\tif (History.busy.flag) return;\n\t\t\t\t\t\tfor (i = History.queues.length - 1; i >= 0; --i) {\n\t\t\t\t\t\t\tqueue = History.queues[i];\n\t\t\t\t\t\t\tif (queue.length === 0) continue;\n\t\t\t\t\t\t\titem = queue.shift();\n\t\t\t\t\t\t\tHistory.fireQueueItem(item);\n\t\t\t\t\t\t\tHistory.busy.timeout = setTimeout(fireNext, History.options.busyDelay);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tHistory.busy.timeout = setTimeout(fireNext, History.options.busyDelay);\n\t\t\t\t}\n\t\n\t\t\t\t// Return\n\t\t\t\treturn History.busy.flag;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.busy.flag\n\t   */\n\t\t\tHistory.busy.flag = false;\n\t\n\t\t\t/**\n\t   * History.fireQueueItem(item)\n\t   * Fire a Queue Item\n\t   * @param {Object} item\n\t   * @return {Mixed} result\n\t   */\n\t\t\tHistory.fireQueueItem = function (item) {\n\t\t\t\treturn item.callback.apply(item.scope || History, item.args || []);\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.pushQueue(callback,args)\n\t   * Add an item to the queue\n\t   * @param {Object} item [scope,callback,args,queue]\n\t   */\n\t\t\tHistory.pushQueue = function (item) {\n\t\t\t\t// Prepare the queue\n\t\t\t\tHistory.queues[item.queue || 0] = History.queues[item.queue || 0] || [];\n\t\n\t\t\t\t// Add to the queue\n\t\t\t\tHistory.queues[item.queue || 0].push(item);\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.queue (item,queue), (func,queue), (func), (item)\n\t   * Either firs the item now if not busy, or adds it to the queue\n\t   */\n\t\t\tHistory.queue = function (item, queue) {\n\t\t\t\t// Prepare\n\t\t\t\tif (typeof item === 'function') {\n\t\t\t\t\titem = {\n\t\t\t\t\t\tcallback: item\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tif (typeof queue !== 'undefined') {\n\t\t\t\t\titem.queue = queue;\n\t\t\t\t}\n\t\n\t\t\t\t// Handle\n\t\t\t\tif (History.busy()) {\n\t\t\t\t\tHistory.pushQueue(item);\n\t\t\t\t} else {\n\t\t\t\t\tHistory.fireQueueItem(item);\n\t\t\t\t}\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.clearQueue()\n\t   * Clears the Queue\n\t   */\n\t\t\tHistory.clearQueue = function () {\n\t\t\t\tHistory.busy.flag = false;\n\t\t\t\tHistory.queues = [];\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// IE Bug Fix\n\t\n\t\t\t/**\n\t   * History.stateChanged\n\t   * States whether or not the state has changed since the last double check was initialised\n\t   */\n\t\t\tHistory.stateChanged = false;\n\t\n\t\t\t/**\n\t   * History.doubleChecker\n\t   * Contains the timeout used for the double checks\n\t   */\n\t\t\tHistory.doubleChecker = false;\n\t\n\t\t\t/**\n\t   * History.doubleCheckComplete()\n\t   * Complete a double check\n\t   * @return {History}\n\t   */\n\t\t\tHistory.doubleCheckComplete = function () {\n\t\t\t\t// Update\n\t\t\t\tHistory.stateChanged = true;\n\t\n\t\t\t\t// Clear\n\t\t\t\tHistory.doubleCheckClear();\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.doubleCheckClear()\n\t   * Clear a double check\n\t   * @return {History}\n\t   */\n\t\t\tHistory.doubleCheckClear = function () {\n\t\t\t\t// Clear\n\t\t\t\tif (History.doubleChecker) {\n\t\t\t\t\tclearTimeout(History.doubleChecker);\n\t\t\t\t\tHistory.doubleChecker = false;\n\t\t\t\t}\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.doubleCheck()\n\t   * Create a double check\n\t   * @return {History}\n\t   */\n\t\t\tHistory.doubleCheck = function (tryAgain) {\n\t\t\t\t// Reset\n\t\t\t\tHistory.stateChanged = false;\n\t\t\t\tHistory.doubleCheckClear();\n\t\n\t\t\t\t// Fix IE6,IE7 bug where calling history.back or history.forward does not actually change the hash (whereas doing it manually does)\n\t\t\t\t// Fix Safari 5 bug where sometimes the state does not change: https://bugs.webkit.org/show_bug.cgi?id=42940\n\t\t\t\tif (History.bugs.ieDoubleCheck) {\n\t\t\t\t\t// Apply Check\n\t\t\t\t\tHistory.doubleChecker = setTimeout(function () {\n\t\t\t\t\t\tHistory.doubleCheckClear();\n\t\t\t\t\t\tif (!History.stateChanged) {\n\t\t\t\t\t\t\t//History.debug('History.doubleCheck: State has not yet changed, trying again', arguments);\n\t\t\t\t\t\t\t// Re-Attempt\n\t\t\t\t\t\t\ttryAgain();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}, History.options.doubleCheckInterval);\n\t\t\t\t}\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// Safari Bug Fix\n\t\n\t\t\t/**\n\t   * History.safariStatePoll()\n\t   * Poll the current state\n\t   * @return {History}\n\t   */\n\t\t\tHistory.safariStatePoll = function () {\n\t\t\t\t// Poll the URL\n\t\n\t\t\t\t// Get the Last State which has the new URL\n\t\t\t\tvar urlState = History.extractState(History.getLocationHref()),\n\t\t\t\t    newState;\n\t\n\t\t\t\t// Check for a difference\n\t\t\t\tif (!History.isLastSavedState(urlState)) {\n\t\t\t\t\tnewState = urlState;\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\n\t\t\t\t// Check if we have a state with that url\n\t\t\t\t// If not create it\n\t\t\t\tif (!newState) {\n\t\t\t\t\t//History.debug('History.safariStatePoll: new');\n\t\t\t\t\tnewState = History.createStateObject();\n\t\t\t\t}\n\t\n\t\t\t\t// Apply the New State\n\t\t\t\t//History.debug('History.safariStatePoll: trigger');\n\t\t\t\tHistory.Adapter.trigger(window, 'popstate');\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// State Aliases\n\t\n\t\t\t/**\n\t   * History.back(queue)\n\t   * Send the browser history back one item\n\t   * @param {Integer} queue [optional]\n\t   */\n\t\t\tHistory.back = function (queue) {\n\t\t\t\t//History.debug('History.back: called', arguments);\n\t\n\t\t\t\t// Handle Queueing\n\t\t\t\tif (queue !== false && History.busy()) {\n\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t//History.debug('History.back: we must wait', arguments);\n\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\tcallback: History.back,\n\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t// Make Busy + Continue\n\t\t\t\tHistory.busy(true);\n\t\n\t\t\t\t// Fix certain browser bugs that prevent the state from changing\n\t\t\t\tHistory.doubleCheck(function () {\n\t\t\t\t\tHistory.back(false);\n\t\t\t\t});\n\t\n\t\t\t\t// Go back\n\t\t\t\thistory.go(-1);\n\t\n\t\t\t\t// End back closure\n\t\t\t\treturn true;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.forward(queue)\n\t   * Send the browser history forward one item\n\t   * @param {Integer} queue [optional]\n\t   */\n\t\t\tHistory.forward = function (queue) {\n\t\t\t\t//History.debug('History.forward: called', arguments);\n\t\n\t\t\t\t// Handle Queueing\n\t\t\t\tif (queue !== false && History.busy()) {\n\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t//History.debug('History.forward: we must wait', arguments);\n\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\tcallback: History.forward,\n\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\n\t\t\t\t// Make Busy + Continue\n\t\t\t\tHistory.busy(true);\n\t\n\t\t\t\t// Fix certain browser bugs that prevent the state from changing\n\t\t\t\tHistory.doubleCheck(function () {\n\t\t\t\t\tHistory.forward(false);\n\t\t\t\t});\n\t\n\t\t\t\t// Go forward\n\t\t\t\thistory.go(1);\n\t\n\t\t\t\t// End forward closure\n\t\t\t\treturn true;\n\t\t\t};\n\t\n\t\t\t/**\n\t   * History.go(index,queue)\n\t   * Send the browser history back or forward index times\n\t   * @param {Integer} queue [optional]\n\t   */\n\t\t\tHistory.go = function (index, queue) {\n\t\t\t\t//History.debug('History.go: called', arguments);\n\t\n\t\t\t\t// Prepare\n\t\t\t\tvar i;\n\t\n\t\t\t\t// Handle\n\t\t\t\tif (index > 0) {\n\t\t\t\t\t// Forward\n\t\t\t\t\tfor (i = 1; i <= index; ++i) {\n\t\t\t\t\t\tHistory.forward(queue);\n\t\t\t\t\t}\n\t\t\t\t} else if (index < 0) {\n\t\t\t\t\t// Backward\n\t\t\t\t\tfor (i = -1; i >= index; --i) {\n\t\t\t\t\t\tHistory.back(queue);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('History.go: History.go requires a positive or negative integer passed.');\n\t\t\t\t}\n\t\n\t\t\t\t// Chain\n\t\t\t\treturn History;\n\t\t\t};\n\t\n\t\t\t// ====================================================================\n\t\t\t// HTML5 State Support\n\t\n\t\t\t// Non-Native pushState Implementation\n\t\t\tif (History.emulated.pushState) {\n\t\t\t\t/*\n\t    * Provide Skeleton for HTML4 Browsers\n\t    */\n\t\n\t\t\t\t// Prepare\n\t\t\t\tvar emptyFunction = function emptyFunction() {};\n\t\t\t\tHistory.pushState = History.pushState || emptyFunction;\n\t\t\t\tHistory.replaceState = History.replaceState || emptyFunction;\n\t\t\t} // History.emulated.pushState\n\t\n\t\t\t// Native pushState Implementation\n\t\t\telse {\n\t\t\t\t\t/*\n\t     * Use native HTML5 History API Implementation\n\t     */\n\t\n\t\t\t\t\t/**\n\t     * History.onPopState(event,extra)\n\t     * Refresh the Current State\n\t     */\n\t\t\t\t\tHistory.onPopState = function (event, extra) {\n\t\t\t\t\t\t// Prepare\n\t\t\t\t\t\tvar stateId = false,\n\t\t\t\t\t\t    newState = false,\n\t\t\t\t\t\t    currentHash,\n\t\t\t\t\t\t    currentState;\n\t\n\t\t\t\t\t\t// Reset the double check\n\t\t\t\t\t\tHistory.doubleCheckComplete();\n\t\n\t\t\t\t\t\t// Check for a Hash, and handle apporiatly\n\t\t\t\t\t\tcurrentHash = History.getHash();\n\t\t\t\t\t\tif (currentHash) {\n\t\t\t\t\t\t\t// Expand Hash\n\t\t\t\t\t\t\tcurrentState = History.extractState(currentHash || History.getLocationHref(), true);\n\t\t\t\t\t\t\tif (currentState) {\n\t\t\t\t\t\t\t\t// We were able to parse it, it must be a State!\n\t\t\t\t\t\t\t\t// Let's forward to replaceState\n\t\t\t\t\t\t\t\t//History.debug('History.onPopState: state anchor', currentHash, currentState);\n\t\t\t\t\t\t\t\tHistory.replaceState(currentState.data, currentState.title, currentState.url, false);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Traditional Anchor\n\t\t\t\t\t\t\t\t//History.debug('History.onPopState: traditional anchor', currentHash);\n\t\t\t\t\t\t\t\tHistory.Adapter.trigger(window, 'anchorchange');\n\t\t\t\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t\t// We don't care for hashes\n\t\t\t\t\t\t\tHistory.expectedStateId = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Ensure\n\t\t\t\t\t\tstateId = History.Adapter.extractEventData('state', event, extra) || false;\n\t\n\t\t\t\t\t\t// Fetch State\n\t\t\t\t\t\tif (stateId) {\n\t\t\t\t\t\t\t// Vanilla: Back/forward button was used\n\t\t\t\t\t\t\tnewState = History.getStateById(stateId);\n\t\t\t\t\t\t} else if (History.expectedStateId) {\n\t\t\t\t\t\t\t// Vanilla: A new state was pushed, and popstate was called manually\n\t\t\t\t\t\t\tnewState = History.getStateById(History.expectedStateId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Initial State\n\t\t\t\t\t\t\tnewState = History.extractState(History.getLocationHref());\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// The State did not exist in our store\n\t\t\t\t\t\tif (!newState) {\n\t\t\t\t\t\t\t// Regenerate the State\n\t\t\t\t\t\t\tnewState = History.createStateObject(null, null, History.getLocationHref());\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Clean\n\t\t\t\t\t\tHistory.expectedStateId = false;\n\t\n\t\t\t\t\t\t// Check if we are the same state\n\t\t\t\t\t\tif (History.isLastSavedState(newState)) {\n\t\t\t\t\t\t\t// There has been no change (just the page's hash has finally propagated)\n\t\t\t\t\t\t\t//History.debug('History.onPopState: no change', newState, History.savedStates);\n\t\t\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Store the State\n\t\t\t\t\t\tHistory.storeState(newState);\n\t\t\t\t\t\tHistory.saveState(newState);\n\t\n\t\t\t\t\t\t// Force update of the title\n\t\t\t\t\t\tHistory.setTitle(newState);\n\t\n\t\t\t\t\t\t// Fire Our Event\n\t\t\t\t\t\tHistory.Adapter.trigger(window, 'statechange');\n\t\t\t\t\t\tHistory.busy(false);\n\t\n\t\t\t\t\t\t// Return true\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t};\n\t\t\t\t\tHistory.Adapter.bind(window, 'popstate', History.onPopState);\n\t\n\t\t\t\t\t/**\n\t     * History.pushState(data,title,url)\n\t     * Add a new State to the history object, become it, and trigger onpopstate\n\t     * We have to trigger for HTML4 compatibility\n\t     * @param {object} data\n\t     * @param {string} title\n\t     * @param {string} url\n\t     * @return {true}\n\t     */\n\t\t\t\t\tHistory.pushState = function (data, title, url, queue) {\n\t\t\t\t\t\t//History.debug('History.pushState: called', arguments);\n\t\n\t\t\t\t\t\t// Check the State\n\t\t\t\t\t\tif (History.getHashByUrl(url) && History.emulated.pushState) {\n\t\t\t\t\t\t\tthrow new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Handle Queueing\n\t\t\t\t\t\tif (queue !== false && History.busy()) {\n\t\t\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t\t\t//History.debug('History.pushState: we must wait', arguments);\n\t\t\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\t\t\tcallback: History.pushState,\n\t\t\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Make Busy + Continue\n\t\t\t\t\t\tHistory.busy(true);\n\t\n\t\t\t\t\t\t// Create the newState\n\t\t\t\t\t\tvar newState = History.createStateObject(data, title, url);\n\t\n\t\t\t\t\t\t// Check it\n\t\t\t\t\t\tif (History.isLastSavedState(newState)) {\n\t\t\t\t\t\t\t// Won't be a change\n\t\t\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Store the newState\n\t\t\t\t\t\t\tHistory.storeState(newState);\n\t\t\t\t\t\t\tHistory.expectedStateId = newState.id;\n\t\n\t\t\t\t\t\t\t// Push the newState\n\t\t\t\t\t\t\thistory.pushState(newState.id, newState.title, newState.url);\n\t\n\t\t\t\t\t\t\t// Fire HTML5 Event\n\t\t\t\t\t\t\tHistory.Adapter.trigger(window, 'popstate');\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// End pushState closure\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t};\n\t\n\t\t\t\t\t/**\n\t     * History.replaceState(data,title,url)\n\t     * Replace the State and trigger onpopstate\n\t     * We have to trigger for HTML4 compatibility\n\t     * @param {object} data\n\t     * @param {string} title\n\t     * @param {string} url\n\t     * @return {true}\n\t     */\n\t\t\t\t\tHistory.replaceState = function (data, title, url, queue) {\n\t\t\t\t\t\t//History.debug('History.replaceState: called', arguments);\n\t\n\t\t\t\t\t\t// Check the State\n\t\t\t\t\t\tif (History.getHashByUrl(url) && History.emulated.pushState) {\n\t\t\t\t\t\t\tthrow new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Handle Queueing\n\t\t\t\t\t\tif (queue !== false && History.busy()) {\n\t\t\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t\t\t//History.debug('History.replaceState: we must wait', arguments);\n\t\t\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\t\t\tcallback: History.replaceState,\n\t\t\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// Make Busy + Continue\n\t\t\t\t\t\tHistory.busy(true);\n\t\n\t\t\t\t\t\t// Create the newState\n\t\t\t\t\t\tvar newState = History.createStateObject(data, title, url);\n\t\n\t\t\t\t\t\t// Check it\n\t\t\t\t\t\tif (History.isLastSavedState(newState)) {\n\t\t\t\t\t\t\t// Won't be a change\n\t\t\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Store the newState\n\t\t\t\t\t\t\tHistory.storeState(newState);\n\t\t\t\t\t\t\tHistory.expectedStateId = newState.id;\n\t\n\t\t\t\t\t\t\t// Push the newState\n\t\t\t\t\t\t\thistory.replaceState(newState.id, newState.title, newState.url);\n\t\n\t\t\t\t\t\t\t// Fire HTML5 Event\n\t\t\t\t\t\t\tHistory.Adapter.trigger(window, 'popstate');\n\t\t\t\t\t\t}\n\t\n\t\t\t\t\t\t// End replaceState closure\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t};\n\t\t\t\t} // !History.emulated.pushState\n\t\n\t\n\t\t\t// ====================================================================\n\t\t\t// Initialise\n\t\n\t\t\t/**\n\t   * Load the Store\n\t   */\n\t\t\tif (sessionStorage) {\n\t\t\t\t// Fetch\n\t\t\t\ttry {\n\t\t\t\t\tHistory.store = JSON.parse(sessionStorage.getItem('History.store')) || {};\n\t\t\t\t} catch (err) {\n\t\t\t\t\tHistory.store = {};\n\t\t\t\t}\n\t\n\t\t\t\t// Normalize\n\t\t\t\tHistory.normalizeStore();\n\t\t\t} else {\n\t\t\t\t// Default Load\n\t\t\t\tHistory.store = {};\n\t\t\t\tHistory.normalizeStore();\n\t\t\t}\n\t\n\t\t\t/**\n\t   * Clear Intervals on exit to prevent memory leaks\n\t   */\n\t\t\tHistory.Adapter.bind(window, \"unload\", History.clearAllIntervals);\n\t\n\t\t\t/**\n\t   * Create the initial State\n\t   */\n\t\t\tHistory.saveState(History.storeState(History.extractState(History.getLocationHref(), true)));\n\t\n\t\t\t/**\n\t   * Bind for Saving Store\n\t   */\n\t\t\tif (sessionStorage) {\n\t\t\t\t// When the page is closed\n\t\t\t\tHistory.onUnload = function () {\n\t\t\t\t\t// Prepare\n\t\t\t\t\tvar currentStore, item, currentStoreString;\n\t\n\t\t\t\t\t// Fetch\n\t\t\t\t\ttry {\n\t\t\t\t\t\tcurrentStore = JSON.parse(sessionStorage.getItem('History.store')) || {};\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tcurrentStore = {};\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Ensure\n\t\t\t\t\tcurrentStore.idToState = currentStore.idToState || {};\n\t\t\t\t\tcurrentStore.urlToId = currentStore.urlToId || {};\n\t\t\t\t\tcurrentStore.stateToId = currentStore.stateToId || {};\n\t\n\t\t\t\t\t// Sync\n\t\t\t\t\tfor (item in History.idToState) {\n\t\t\t\t\t\tif (!History.idToState.hasOwnProperty(item)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentStore.idToState[item] = History.idToState[item];\n\t\t\t\t\t}\n\t\t\t\t\tfor (item in History.urlToId) {\n\t\t\t\t\t\tif (!History.urlToId.hasOwnProperty(item)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentStore.urlToId[item] = History.urlToId[item];\n\t\t\t\t\t}\n\t\t\t\t\tfor (item in History.stateToId) {\n\t\t\t\t\t\tif (!History.stateToId.hasOwnProperty(item)) {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrentStore.stateToId[item] = History.stateToId[item];\n\t\t\t\t\t}\n\t\n\t\t\t\t\t// Update\n\t\t\t\t\tHistory.store = currentStore;\n\t\t\t\t\tHistory.normalizeStore();\n\t\n\t\t\t\t\t// In Safari, going into Private Browsing mode causes the\n\t\t\t\t\t// Session Storage object to still exist but if you try and use\n\t\t\t\t\t// or set any property/function of it it throws the exception\n\t\t\t\t\t// \"QUOTA_EXCEEDED_ERR: DOM Exception 22: An attempt was made to\n\t\t\t\t\t// add something to storage that exceeded the quota.\" infinitely\n\t\t\t\t\t// every second.\n\t\t\t\t\tcurrentStoreString = JSON.stringify(currentStore);\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// Store\n\t\t\t\t\t\tsessionStorage.setItem('History.store', currentStoreString);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tif (e.code === DOMException.QUOTA_EXCEEDED_ERR) {\n\t\t\t\t\t\t\tif (sessionStorage.length) {\n\t\t\t\t\t\t\t\t// Workaround for a bug seen on iPads. Sometimes the quota exceeded error comes up and simply\n\t\t\t\t\t\t\t\t// removing/resetting the storage can work.\n\t\t\t\t\t\t\t\tsessionStorage.removeItem('History.store');\n\t\t\t\t\t\t\t\tsessionStorage.setItem('History.store', currentStoreString);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Otherwise, we're probably private browsing in Safari, so we'll ignore the exception.\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow e;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\n\t\t\t\t// For Internet Explorer\n\t\t\t\tHistory.intervalList.push(setInterval(History.onUnload, History.options.storeInterval));\n\t\n\t\t\t\t// For Other Browsers\n\t\t\t\tHistory.Adapter.bind(window, 'beforeunload', History.onUnload);\n\t\t\t\tHistory.Adapter.bind(window, 'unload', History.onUnload);\n\t\n\t\t\t\t// Both are enabled for consistency\n\t\t\t}\n\t\n\t\t\t// Non-Native pushState Implementation\n\t\t\tif (!History.emulated.pushState) {\n\t\t\t\t// Be aware, the following is only for native pushState implementations\n\t\t\t\t// If you are wanting to include something for all browsers\n\t\t\t\t// Then include it above this if block\n\t\n\t\t\t\t/**\n\t    * Setup Safari Fix\n\t    */\n\t\t\t\tif (History.bugs.safariPoll) {\n\t\t\t\t\tHistory.intervalList.push(setInterval(History.safariStatePoll, History.options.safariPollInterval));\n\t\t\t\t}\n\t\n\t\t\t\t/**\n\t    * Ensure Cross Browser Compatibility\n\t    */\n\t\t\t\tif (navigator.vendor === 'Apple Computer, Inc.' || (navigator.appCodeName || '') === 'Mozilla') {\n\t\t\t\t\t/**\n\t     * Fix Safari HashChange Issue\n\t     */\n\t\n\t\t\t\t\t// Setup Alias\n\t\t\t\t\tHistory.Adapter.bind(window, 'hashchange', function () {\n\t\t\t\t\t\tHistory.Adapter.trigger(window, 'popstate');\n\t\t\t\t\t});\n\t\n\t\t\t\t\t// Initialise Alias\n\t\t\t\t\tif (History.getHash()) {\n\t\t\t\t\t\tHistory.Adapter.onDomLoad(function () {\n\t\t\t\t\t\t\tHistory.Adapter.trigger(window, 'hashchange');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} // !History.emulated.pushState\n\t\n\t\t}; // History.initCore\n\t\n\t\t// Try to Initialise History\n\t\tif (!History.options || !History.options.delayInit) {\n\t\t\tHistory.init();\n\t\t}\n\t})(window);\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 268 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\t// 删除自己发布的话题\n\tvar alert = __webpack_require__(36);\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar confirm = __webpack_require__(65);\n\t// //提交请求\n\t//        fetch.post(url.get('commentFirstV2'), {\n\t//            data: params\n\t//        }).then(function(data) {\n\t\n\tvar init = function init() {\n\t    $(\"body\").on(\"click\", '[data-node=\"userTopic-del\"]', deletTopic);\n\t};\n\t\n\tvar deletTopic = function deletTopic() {\n\t    var $this = $(this);\n\t    var id = $($this.parents().eq(2)).attr('data-left');\n\t    confirm('', {\n\t        content: \"<p class='del-pop-p' data-node='gettopId' data-topicH=\" + id + \">确定要删除该话题吗？</p>\",\n\t        title: '提示',\n\t        okCls: 'two-button two-button-red',\n\t        cancelCls: 'two-button',\n\t        ok: sendMsg,\n\t        btnWrapCls: 'text-center'\n\t    });\n\t};\n\tvar sendMsg = function sendMsg() {\n\t    var groupid = $_CONFIG['groupid'];\n\t    var idd = {\n\t        id: $(\"[data-node='gettopId']\").attr('data-topicH'),\n\t        groupId: groupid\n\t    };\n\t\n\t    fetch.post(url.get('topicDel'), {\n\t        data: idd\n\t    }).then(function (data) {\n\t        if (data.success) {\n\t            location.replace($GLOBAL_CONFIG['group_domain'] + 'circle/' + groupid + '.html');\n\t        } else {\n\t            alert(\"删除失败！\");\n\t        }\n\t    });\n\t};\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 269 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\t//var alert = require('module/popup/alert');\n\tvar upload = __webpack_require__(116);\n\t//var addBox = $('[data-node=addImgGoods]');\n\tvar confirm = __webpack_require__(65);\n\tvar loginState = __webpack_require__(252);\n\tvar rotateImg = __webpack_require__(270);\n\tvar checkLoginStatus = __webpack_require__(23); //登陆判断\n\tvar addImgTpl = __webpack_require__(271);\n\tvar topFixed = __webpack_require__(262).topFixed; //右侧固定\n\tvar Pubsub = __webpack_require__(45);\n\tvar channel = __webpack_require__(100);\n\t\n\t//插入二维码上传\n\tvar detectQr = __webpack_require__(120);\n\t//存储二维码\n\tvar codeArr = [];\n\t\n\tvar $showBox = $('[data-node=\"picPopBox\"]');\n\tvar topicId = '';\n\tvar showImgBox = function showImgBox() {\n\t\n\t    $(\"body\").on(\"click\", '[data-node=\"addImg_btn\"]', btnEvent).on(\"click\", \"[data-node='addMoreImg']\", addMoreImgFn) //+ tu\n\t    .on(\"click\", \"[data-node='imgPics']\", imgPicsBig).on(\"click\", '[data-node=\"imgBigHind\"]', imgBigHindFn).on(\"click\", '[data-node=\"hideBigPic\"]', hideBigPicFn).on(\"click\", '[data-node=\"imgBigPN\"]', imgBigPNFn).on(\"click\", '[data-node=\"deletImg\"]', deletImgFn).on(\"click\", '[data-node=\"showImg\"]', showImgFn).on(\"click\", '[data-node=\"roteRo\"]', rotateImg.init).on(\"click\", '[data-node=\"addImg_btn\"]', picPopBoxEvent).on(\"click\", '[data-node=\"picPopBox\"]', picPopBoxEvent).on('click', codeBoxEvent);\n\t};\n\t\n\tvar deletImgFn = function deletImgFn() {\n\t    var $this = $($(this).parents().eq(2));\n\t    var imgSrc = $this.children(\"a\").children(\"img\").attr(\"src\");\n\t    var ul = $this.parent();\n\t    var $div = ul.parent();\n\t    var imgLENG = parseInt($div.attr(\"data-imgnum\"));\n\t    //var arrImg=[];\n\t    confirm('确认删除该图片？', {\n\t        title: '提示',\n\t        okCls: 'two-button two-button-red',\n\t        cancelCls: 'two-button',\n\t        btnWrapCls: 'text-center',\n\t        ok: function ok() {\n\t            $this.remove();\n\t            var arriMG = ul.attr(\"data-imgsrt\");\n\t            var a = arriMG.split(',');\n\t            var b = a;\n\t            b.splice(imgSrc, 1);\n\t            ul.attr(\"data-imgsrt\", b);\n\t            $div.attr(\"data-imgnum\", imgLENG + 1);\n\t            ul.children(\"[data-node='addMoreImg']\").removeClass(\"hide\");\n\t            $div.parent().find(\"[data-node='addImg_btn']\").removeClass(\"disabled\");\n\t            if (parseInt(imgLENG + 1) >= 9) {\n\t                ul.addClass(\"hide\");\n\t            }\n\t        }\n\t    });\n\t};\n\tvar addMoreImgFn = function addMoreImgFn() {\n\t    var imgNum = $($(this).parents().eq(1)).attr(\"data-imgNum\");\n\t    topicId = $($(this).parents().eq(2)).children(\".publish-face-bx\").attr(\"data-publish\");\n\t    if (imgNum == 0) {\n\t        return false;\n\t    } else {\n\t        upload(imgNum, topicId); //\n\t    }\n\t};\n\tvar showImgFn = function showImgFn() {\n\t    var $this = $(this);\n\t\n\t    if ($this.hasClass(\"active\")) {\n\t        return false;\n\t    } else {\n\t        var toPage = $(this).attr(\"data-active\");\n\t        var toImG = $($this.parents().eq(1)).children(\".big-img\").children(\".img-hidden\").children(\"[data-bigimg='\" + toPage + \"']\");\n\t\n\t        $(toImG).removeClass(\"hide\").siblings().addClass(\"hide\");\n\t        var imgObj = $(toImG).children(\"img\");\n\t        if ($(imgObj).hasClass(\"srcError\")) {\n\t            $(imgObj).removeClass(\"srcError\");\n\t            $(imgObj).attr(\"src\", $(imgObj).attr(\"data-imgsrc\"));\n\t        }\n\t        $this.addClass(\"active\").siblings().removeClass(\"active\");\n\t        var imgSrc = $($this.parents().eq(1)).children(\".big-title\").children(\"[data-node='imgBigSrc']\");\n\t        $(imgSrc).attr(\"href\", $(imgObj).attr(\"data-imgsrc\"));\n\t    }\n\t};\n\tvar imgBigPNFn = function imgBigPNFn() {\n\t    var $this = $(this);\n\t    var curPage = $($this.parents().eq(1)).children(\".img-slide\").children(\".active\").attr(\"data-active\");\n\t    curPage = parseInt(curPage);\n\t\n\t    var toPage = null;\n\t    var tootalPage = parseInt($this.parent().attr(\"data-piclength\")) - 1;\n\t\n\t    if ($this.attr(\"data-page\") == \"pre\") {\n\t        if (curPage == 0) {\n\t            toPage = tootalPage;\n\t        } else {\n\t            toPage = curPage - 1;\n\t        }\n\t    } else {\n\t        if (curPage == tootalPage) {\n\t            toPage = 0;\n\t        } else {\n\t            toPage = curPage + 1;\n\t        }\n\t    }\n\t    // 图片更改\n\t    $($this.parents().eq(1)).children(\".img-slide\").children(\"[data-active='\" + toPage + \"']\").click();\n\t};\n\tvar hideBigPicFn = function hideBigPicFn() {\n\t    var divObj = $(this).parents().eq(2);\n\t    var parentObj = $(this).parents().eq(3);\n\t    $(divObj).addClass(\"hide\");\n\t    $(parentObj).children(\"ul\").removeClass(\"hide\");\n\t    topFixed($(window).scrollTop());\n\t};\n\t\n\t//大图隐藏\n\tvar imgBigHindFn = function imgBigHindFn() {\n\t    var divObj = $(this).parents().eq(1);\n\t    var parentObj = $(this).parents().eq(2);\n\t    $(divObj).addClass(\"hide\");\n\t    $(parentObj).children(\"ul\").removeClass(\"hide\");\n\t    topFixed($(window).scrollTop());\n\t};\n\t// 评论列表中大图展示\n\tvar imgPicsBig = function imgPicsBig() {\n\t    var parentObj = $(this).parents().eq(1);\n\t    var ulObj = $(this).parents().eq(0);\n\t    var divBig = $(parentObj).children(\"[data-node='imgBigPic']\");\n\t    $(ulObj).addClass(\"hide\");\n\t    divBig.removeClass(\"hide\");\n\t\n\t    //大图定位显示\n\t    var pageId = $(this).attr(\"data-imgsort\");\n\t    //获取当前大图节点\n\t    //div\n\t    var thisBigPic = divBig.children(\".big-img\").children(\".img-hidden\").children(\"[data-bigimg='\" + pageId + \"']\");\n\t    var thisImage = $(thisBigPic).children(\"img\"); //img\n\t\n\t    $(thisBigPic).removeClass(\"hide\").siblings().addClass(\"hide\");\n\t    if ($(thisImage).hasClass(\"srcError\")) {\n\t        $(thisImage).removeClass(\"srcError\");\n\t        $(thisImage).attr(\"src\", $(thisImage).attr(\"data-imgsrc\"));\n\t    }\n\t\n\t    var aBtn = divBig.children(\".img-slide\").children(\"[data-active='\" + pageId + \"']\");\n\t    $(aBtn).addClass(\"active\").siblings().removeClass(\"active\");\n\t    //查看原图 添加链接\n\t    var $imgSrc = divBig.children(\".big-title\").children(\"[data-node='imgBigSrc']\");\n\t    $($imgSrc).attr(\"href\", $(thisImage).attr(\"data-imgsrc\"));\n\t    topFixed($(window).scrollTop());\n\t};\n\t\n\t//添加图片按钮事件\n\tvar btnEvent = function btnEvent() {\n\t\n\t    if (!checkLoginStatus()) {\n\t        loginState.popUnion();\n\t        return false;\n\t    }\n\t\n\t    var imgNum = $(this).parents().eq(1).children(\"[data-node='addImgGoods']\").attr(\"data-imgNum\");\n\t    topicId = $(this).parent().attr(\"data-publish\");\n\t    $('[data-node=\"picPopBox\"]').removeClass('webuploader-element-invisible');\n\t    $('div[tabindex]').remove();\n\t    if (imgNum == 0) {\n\t        return false;\n\t    } else {\n\t        code(topicId, $(this));\n\t        upload(imgNum, 9);\n\t    }\n\t};\n\tPubsub(channel.setPubliser.changeImage).sub(function (data) {\n\t    setImage(data, topicId);\n\t});\n\tvar setImage = function setImage(data, topicId) {\n\t    if (data.images.length > 0) {\n\t        var arrImg = [];\n\t        var $div = $(\"[data-tid=\" + topicId + \"]\").children(\"[data-node='addImgGoods']\");\n\t        var num = parseInt($div.attr(\"data-imgNum\"));\n\t        var nextnum = parseInt(num - data.images.length);\n\t        $div.attr(\"data-imgNum\", nextnum);\n\t        var $ul = $(\"[data-tid='\" + topicId + \"']\").find(\"[data-node='imgUl']\");\n\t        $ul.addClass(\"topic-imglist\");\n\t        var imgsrt = $ul.attr(\"data-imgsrt\");\n\t        var pictureHTML = addImgTpl(data);\n\t        $ul.removeClass(\"hide\").append(pictureHTML);\n\t        if (imgsrt) {\n\t            arrImg.push(imgsrt);\n\t        }\n\t        for (var i = 0; i < data.images.length; i++) {\n\t            arrImg.push(data.images[i]);\n\t        }\n\t        $ul.attr(\"data-imgsrt\", arrImg);\n\t        var lengthImg = parseInt($ul.parent().attr(\"data-imgNum\"));\n\t        if (lengthImg <= 0) {\n\t            $(\"[data-tid=\" + topicId + \"]\").find(\"[data-node='addImg_btn']\").addClass(\"disabled\");\n\t        }\n\t    } else {\n\t        return false;\n\t    }\n\t};\n\t\n\t//图片二维码弹窗显示隐藏\n\tvar picPopBoxEvent = function picPopBoxEvent(e) {\n\t\n\t    $('[data-node=\"faceBox\"]').hide();\n\t    e.stopPropagation();\n\t};\n\t\n\t//body点击事件,二维码弹窗隐藏\n\tvar codeBoxEvent = function codeBoxEvent(e) {\n\t    $showBox.hide();\n\t};\n\t\n\tvar code = function code(topicId, $this) {\n\t\n\t    if (!window.topicQrId) {\n\t\n\t        window.topicQrId = [];\n\t    }\n\t    topicId = 's' + topicId;\n\t    //var arr = window.topicQrId;\n\t    if (!window.topicQrId[topicId]) {\n\t\n\t        var obj = {\n\t            qid: topicId,\n\t            time: 2000,\n\t            $showBox: $showBox,\n\t            customCb: customCb,\n\t            $insertDom: \"\",\n\t            $target: $this,\n\t            type: 'detail',\n\t            maxNum: 9\n\t        };\n\t\n\t        $.extend(obj, {\n\t            $parent: $this.parents('[data-node=\"comment_Msg\"]').find('[data-node=\"imgUl\"]')\n\t        });\n\t        window.topicQrId[topicId] = new detectQr(obj);\n\t\n\t        window.topicQrId[topicId].init();\n\t    } else {\n\t        var _newObj = window.topicQrId[topicId];\n\t        if (!_newObj.useNewCode) {\n\t            _newObj.getCode();\n\t        } else {\n\t            if (!_newObj.checkShow()) {\n\t\n\t                _newObj.show();\n\t                _newObj.sendNum();\n\t            } else {\n\t                _newObj.hide();\n\t            }\n\t        }\n\t    }\n\t};\n\t\n\tvar customCb = function customCb(data, obj) {\n\t    var _this = obj;\n\t    topicId = obj.qid.slice(1);\n\t    var imgs = {}; //为了做兼容性 处理\n\t    imgs.images = data;\n\t    setImage(imgs, topicId);\n\t};\n\t\n\t//添加事件\n\tvar addEvent = function addEvent() {\n\t    showImgBox();\n\t};\n\t\n\tmodule.exports = {\n\t    init: addEvent\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 270 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar alert = __webpack_require__(36);\n\t\n\tvar init = function init() {\n\t\tvar $this = $(this);\n\t\tvar divEm = $(this).parent();\n\t\tvar $img = $($this.parents().eq(1)).children('img');\n\t\tvar imgSrc = $img.attr('src');\n\t\tvar oldImgSrc = $img.attr('data-oldImg');\n\t\tvar roteNum = Number.parseInt(divEm.attr('data-roteNum'));\n\t\n\t\tif (oldImgSrc.indexOf(\".gif\") != -1) {\n\t\t\talert(\"gif图不支持旋转\");\n\t\t\treturn false;\n\t\t} else {\n\t\t\tif ($this.hasClass('roteLeft')) {\n\t\t\t\troteNum = (roteNum + 90) % 360;\n\t\t\t} else if ($this.hasClass('roteRight')) {\n\t\t\t\troteNum = (roteNum - 90 + 360) % 360;\n\t\t\t}\n\t\n\t\t\tif (roteNum === 0) {\n\t\t\t\t$img.attr('src', oldImgSrc);\n\t\t\t\t$img.css({\n\t\t\t\t\t\"transform\": \"rotate(\" + roteNum + \"deg)\",\n\t\t\t\t\t\"-ms-transform\": \"rotate(\" + roteNum + \"deg)\",\n\t\t\t\t\t\"-moz-transform\": \"rotate(\" + roteNum + \"deg)\",\n\t\t\t\t\t\"-webkit-transform\": \"rotate(\" + roteNum + \"deg)\",\n\t\t\t\t\t\"-o-transform\": \"rotate(\" + roteNum + \"deg)\"\n\t\t\t\t});\n\t\t\t\tdivEm.attr('data-roteNum', roteNum);\n\t\t\t} else {\n\t\t\t\tvar params = {\n\t\t\t\t\timgPath: oldImgSrc,\n\t\t\t\t\tangle: roteNum\n\t\t\t\t};\n\t\t\t\tfetch.post(url.get('handleimg'), {\n\t\t\t\t\tdata: params\n\t\t\t\t}).then(function (data) {\n\t\n\t\t\t\t\tif (data.success) {\n\t\t\t\t\t\t$img.attr('src', data.data);\n\t\t\t\t\t\tdivEm.attr('data-roteNum', roteNum);\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n\t\n\tmodule.exports = { init: init };\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 271 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/comment/addImgGoods/chooseImg',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,images=$data.images,value=$data.value,i=$data.i,$escape=$utils.$escape,$out='';$each(images,function(value,i){\n\t$out+=' <li class=\"imgClass\"> <a href=\"javascript:;\" > <img src=\"';\n\t$out+=$escape(value);\n\t$out+='\" width=100 height=100 data-node=\"imgSrc\" data-oldImg=\"';\n\t$out+=$escape(value);\n\t$out+='\">  <div data-roteNum=0 class=\"icon-del\" > <em class=\"iconImg roteLeft\" data-node=\"roteRo\" ></em> <em class=\"iconImg roteRight\" data-node=\"roteRo\" ></em> <em class=\"iconImg deletImg\" data-node=\"deletImg\"></em> </div> </a> </li> ';\n\t});\n\t$out+=' ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 272 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($) {'use strict';\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\t//var addBox = $('[data-node=addImgGoods]');\n\tvar checkLoginStatus = __webpack_require__(23); //登陆判断\n\tvar dialog = __webpack_require__(131);\n\tvar Pubsub = __webpack_require__(45);\n\tvar pubName = __webpack_require__(100);\n\tvar goodsInTpl = __webpack_require__(273);\n\tvar loginState = __webpack_require__(252);\n\tvar curTopicId = \"\";\n\t\n\tvar showGoodsBox = function showGoodsBox() {\n\t\n\t    Pubsub(pubName.setPubliser.changedItem).sub(setGoods);\n\t    $(\"body\").on(\"click\", \"[data-node=addGoods_btn]\", function () {\n\t\n\t        // 判断是否登陆，没登录，显示登录框\n\t        if (!checkLoginStatus()) {\n\t            loginState.popUnion();\n\t            return false;\n\t        }\n\t\n\t        var $comment_Msg = $(this).closest(\"[data-node=comment_Msg]\");\n\t        curTopicId = $comment_Msg.attr(\"data-tid\");\n\t        var $addImgGoods = $comment_Msg.find(\"[data-node='addImgGoods']\");\n\t        if ($addImgGoods.hasClass(\"hasGoods\") || $(this).hasClass(\"disabled\")) {\n\t            return false;\n\t        } else {\n\t            var changedGoods = {};\n\t            dialog(changedGoods, 1);\n\t        }\n\t    });\n\t    //删除商品\n\t    $(\"body\").on(\"click\", \"[data-node='deletGoods']\", function () {\n\t        var $comment_Msg = $(this).closest(\"[data-node='comment_Msg']\");\n\t        $comment_Msg.find(\"[data-node='addImgGoods']\").removeClass(\"hasGoods\").attr(\"data-goodStr\", \"\");\n\t        $(this).parent().remove();\n\t        $comment_Msg.find(\"[data-node='addGoods_btn']\").removeClass(\"disabled\");\n\t    });\n\t};\n\t\n\t//\n\tvar setGoods = function setGoods(data) {\n\t    //将商品添加到div\n\t    var goodsData = data;\n\t    var comment_Msg = $(\"[data-tid=\" + curTopicId + \"]\");\n\t    var $addImgGoods = comment_Msg.children(\"[data-node='addImgGoods']\");\n\t    for (var key in goodsData) {\n\t        var v = goodsData[key];\n\t        var strGood = _defineProperty({\n\t            \"pid\": v.PId,\n\t            \"skuId\": v.skuId,\n\t            \"img\": v.img,\n\t            \"link\": v.link,\n\t            \"price\": v.price,\n\t            \"shopId\": v.shopId,\n\t            \"title\": v.title\n\t        }, 'skuId', v.skuId);\n\t    }\n\t\n\t    if (strGood != \"undefined\") {\n\t        $addImgGoods.attr(\"data-goodStr\", JSON.stringify(strGood));\n\t    }\n\t\n\t    var item = goodsInTpl(strGood);\n\t    $addImgGoods.prepend(item).addClass(\"hasGoods\");\n\t    comment_Msg.find(\"[data-node='addGoods_btn']\").addClass(\"disabled\");\n\t};\n\t\n\tmodule.exports = {\n\t    init: showGoodsBox\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2)))\n\n/***/ }),\n/* 273 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/comment/addImgGoods/goodsIn',function($data,$filename\n\t/*``*/) {\n\t'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,shopId=$data.shopId,pid=$data.pid,skuId=$data.skuId,img=$data.img,title=$data.title,price=$data.price,rebate=$data.rebate,link=$data.link,$out='';$out+=' <div data-node=\"goodsIn\" class=\"reply-details\" data-shopId =\"';\n\t$out+=$escape(shopId);\n\t$out+='\" data-itemId=\"';\n\t$out+=$escape(pid);\n\t$out+='\" data-skuId=';\n\t$out+=$escape(skuId);\n\t$out+='> <em class=\"icon-close-b\" data-node=\"deletGoods\"></em> <div class=\"reply-picture\"><img src=\"';\n\t$out+=$escape(img);\n\t$out+='\" onerror=\"imgError(this, \\'g\\')\"></div> <div class=\"reply-contxt\"> <p>';\n\t$out+=$escape(title);\n\t$out+='</p> <div class=\"price\"> <p class=\"price-numb\">￥<span>';\n\t$out+=$escape(price);\n\t$out+='</span></p> <!-- ';\n\tif(rebate > 0){\n\t$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n\t$out+=$escape(rebate);\n\t$out+='国美币</span> </div> ';\n\t}\n\t$out+=' --> </div> </div><a href=\"';\n\t$out+=$escape(link);\n\t$out+='\" class=\"see-details pc-btn pc-btnw105 pc-btnh40\" target=\"_blank\">查看详情</a> </div> ';\n\treturn new String($out);\n\t});\n\n/***/ }),\n/* 274 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/* WEBPACK VAR INJECTION */(function($, $_CONFIG) {'use strict';\n\t\n\t// 举报\n\tvar reportTpl = __webpack_require__(275);\n\tvar alert = __webpack_require__(36);\n\tvar fetch = __webpack_require__(21);\n\tvar url = __webpack_require__(24);\n\tvar confirm = __webpack_require__(65);\n\t\n\tvar reportBtn = '[data-action=topic-report]';\n\tvar reportSpan = '[data-node=reportType] span';\n\tvar checked = 'menu-checkbox-checked';\n\tvar type;\n\tvar reportId;\n\tvar active = 'active';\n\t\n\t//checkbox是否选中\n\tvar isChecked = function isChecked() {\n\t    var $this = $(this);\n\t    if (!$this.hasClass(checked)) {\n\t        $(reportSpan).removeClass(checked);\n\t        $this.addClass(checked);\n\t        $('.report-confirm-btn').addClass(active);\n\t    } else {\n\t        $this.removeClass(checked);\n\t        $('.report-confirm-btn').removeClass(active);\n\t    }\n\t};\n\tvar reportTopic = function reportTopic() {\n\t    var $this = $(this);\n\t    type = $this.attr('data-type');\n\t    reportId = type == 1 ? $this.parents('dd').attr('data-ddlist') : $this.parents('[data-node=wrap-box]').attr('id-node');\n\t    confirm('', {\n\t        content: reportTpl(),\n\t        title: '提示',\n\t        okCls: 'report-confirm-btn pc-btnh36 pc-btnw80',\n\t        cancelCls: 'pc-btnh36 pc-btnw80',\n\t        ok: sendMsg,\n\t        btnWrapCls: 'report-btn text-center'\n\t    });\n\t};\n\tvar sendMsg = function sendMsg() {\n\t    if ($('.report-confirm-btn').hasClass(active)) {\n\t        var groupid = $_CONFIG['groupid'];\n\t        var index = $(reportSpan + '.' + checked).parent().index();\n\t        var idd = {\n\t            type: type ? type : 0,\n\t            reason: index,\n\t            reportId: reportId\n\t        };\n\t        fetch.post(url.get('topicReport'), {\n\t            data: idd\n\t        }).then(function (data) {\n\t            if (data.success === true) {\n\t                alert('举报成功，小编将擦亮眼睛重新审核');\n\t            } else {\n\t                if (data.code === 409) {\n\t                    alert(data.message);\n\t                } else {\n\t                    alert(\"删除失败！\");\n\t                }\n\t            }\n\t        });\n\t    } else {\n\t        return false;\n\t    }\n\t};\n\t\n\tvar init = function init() {\n\t    $('body').on('click', reportSpan, isChecked);\n\t    $('body').on('click', reportBtn, reportTopic);\n\t};\n\tmodule.exports = {\n\t    init: init\n\t};\n\t/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(2), __webpack_require__(3)))\n\n/***/ }),\n/* 275 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar template=__webpack_require__(34);\n\tmodule.exports=template('src/js/page/topicDetails/report','<div class=\"gome-report-title\">请选择举报类型</div> <ul class=\"gome-report-box clearfix\" data-node=\"reportType\"> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>色情低俗</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>政治敏感</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>营销广告</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>人身攻击</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>其他</p> </li> </ul> ');\n\n/***/ })\n]);\n\n\n// WEBPACK FOOTER //\n// topicDetails.js","$(\"body\").attr(\"data-module\", \"1\");\nrequire('lazyload');\n$(\"img\").lazyload({\n    effect: \"fadeIn\"\n});\nvar commentv2 = require('./comment/commentv2');\nvar circle = require('module/joinCircle');\n//var follow = require('./follow');\nvar praise = require('./praise');\nvar share = require('./share');\nvar collect = require('./collect');\n\nvar topicAddMore = require('./topicAddMore/topicAddMore');\n// 发送统计数据用\nvar deleUserTopic = require('./deletUserTopic');\nvar addImg = require('./comment/addImgGoods/addIMG');\nvar addGoods = require('./comment/addImgGoods/addGoods');\nvar buriedPoint = require('utils/buriedPoint');\nburiedPoint.setPageData('topicDetail');\nvar reportTopic = require('./report');\n\ncommentv2.init(); // 评论\nshare.init(); // 分享\ncollect.init(); // 收藏\npraise.init(); // 赞\n//follow.init($('[data-node=\"follow\"]')); // 加关注\ntopicAddMore.init(); //加载更多话题\n\ndeleUserTopic.init();\n\naddGoods.init(); //商品选择\naddImg.init(); //添加图片事件\n\nreportTopic.init();  //举报话题\n\n\n// 加入圈子\n$('body').on('click', '[data-node=\"circle\"]', {\n    done: function() {\n        commentv2.getLoginState();\n        window.location.reload();\n    }\n}, circle);\n$(\"img\").lazyload({\n    effect: \"fadeIn\"\n});\n\n/*$(\".source-rig-box img\").not('.publish-item img').attr('src', '').on('error', function() {\n    imgError(this, 'l');\n})\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/index.js","/*TMODJS:{}*/\r\n!function () {\r\n\tfunction a(a, b) {\r\n\t\treturn (/string|function/.test(typeof b) ? h : g)(a, b)\r\n\t}\r\n\r\n\tfunction b(a, c) {\r\n\t\treturn \"string\" != typeof a && (c = typeof a, \"number\" === c ? a += \"\" : a = \"function\" === c ? b(a.call(a)) : \"\"), a\r\n\t}\r\n\r\n\tfunction c(a) {\r\n\t\treturn l[a]\r\n\t}\r\n\r\n\tfunction d(a) {\r\n\t\treturn b(a).replace(/&(?![\\w#]+;)|[<>\"']/g, c)\r\n\t}\r\n\r\n\tfunction e(a, b) {\r\n\t\tif (m(a))for (var c = 0, d = a.length; d > c; c++)b.call(a, a[c], c, a); else for (c in a)b.call(a, a[c], c)\r\n\t}\r\n\r\n\tfunction f(a, b) {\r\n\t\tvar c = /(\\/)[^\\/]+\\1\\.\\.\\1/, d = (\"./\" + a).replace(/[^\\/]+$/, \"\"), e = d + b;\r\n\t\tfor (e = e.replace(/\\/\\.\\//g, \"/\"); e.match(c);)e = e.replace(c, \"/\");\r\n\t\treturn e\r\n\t}\r\n\r\n\tfunction g(b, c) {\r\n\t\tvar d = a.get(b) || i({filename: b, name: \"Render Error\", message: \"Template not found\"});\r\n\t\treturn c ? d(c) : d\r\n\t}\r\n\r\n\tfunction h(a, b) {\r\n\t\tif (\"string\" == typeof b) {\r\n\t\t\tvar c = b;\r\n\t\t\tb = function () {\r\n\t\t\t\treturn new k(c)\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar d = j[a] = function (c) {\r\n\t\t\ttry {\r\n\t\t\t\treturn new b(c, a) + \"\"\r\n\t\t\t} catch (d) {\r\n\t\t\t\treturn i(d)()\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn d.prototype = b.prototype = n, d.toString = function () {\r\n\t\t\treturn b + \"\"\r\n\t\t}, d\r\n\t}\r\n\r\n\tfunction i(a) {\r\n\t\tvar b = \"{Template Error}\", c = a.stack || \"\";\r\n\t\tif (c)c = c.split(\"\\n\").slice(0, 2).join(\"\\n\"); else for (var d in a)c += \"<\" + d + \">\\n\" + a[d] + \"\\n\\n\";\r\n\t\treturn function () {\r\n\t\t\treturn \"object\" == typeof console && console.error(b + \"\\n\\n\" + c), b\r\n\t\t}\r\n\t}\r\n\r\n\tvar j = a.cache = {}, k = this.String, l = {\r\n\t\t\"<\": \"&#60;\",\r\n\t\t\">\": \"&#62;\",\r\n\t\t'\"': \"&#34;\",\r\n\t\t\"'\": \"&#39;\",\r\n\t\t\"&\": \"&#38;\"\r\n\t}, m = Array.isArray || function (a) {\r\n\t\t\treturn \"[object Array]\" === {}.toString.call(a)\r\n\t\t}, n = a.utils = {\r\n\t\t$helpers: {}, $include: function (a, b, c) {\r\n\t\t\treturn a = f(c, a), g(a, b)\r\n\t\t}, $string: b, $escape: d, $each: e\r\n\t}, o = a.helpers = n.$helpers;\r\n\ta.get = function (a) {\r\n\t\treturn j[a.replace(/^\\.\\//, \"\")]\r\n\t}, a.helper = function (a, b) {\r\n\t\to[a] = b\r\n\t}, module.exports = a\r\n}();\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/_tmodjs-loader@1.0.1@tmodjs-loader/runtime.js\n// module id = 34\n// module chunks = 0 2 3 4 5 6 8 10 14 16 17 21 22 23 27 28 30 31 33 35 36 39 44 45 46","var Dialog = require('dialog');\nvar noop = function() {};\n\nvar create = function(content, options) {\n    content = content || '';\n    options = options || {};\n    var defaults = {\n        fixed: true,\n        modal: true,\n        autofocus: false,\n        content: '<p class=\"del-pop-p\">' + content + '</p>',\n        className: 'pop-box',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        ok: noop\n    };\n    $.extend(true, defaults, options);\n    var d = Dialog(defaults);\n\n    var header = d._$('header');\n    var title = d._$('title');\n    if(!options.title){\n        title.css('borderBottom', 'none');\n    }\n    header.show();\n    d.show();\n    return d;\n};\n\nmodule.exports = create;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/alert.js","/*\r\n * 弹层提示弹窗\r\n * zhaodonghong\r\n */\r\n\r\n\r\n\r\nvar $publicMask;\r\nvar $publicTips;\r\nvar timer;\r\n\r\n\r\nvar events = function() {\r\n\r\n    $publicMask.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n\r\n    $publicTips.off().on('click', function() {\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n    });\r\n}\r\n\r\n\r\n/**\r\n * msg string 提示信息\r\n * options object \r\n * options.duration settimout消失时间\r\n * options.callback 提示消失的回调\r\n*/\r\nvar init = function(msg, options) {\r\n    var defaults = {\r\n        duration: 2000,\r\n        callback: function() {}\r\n    };\r\n\r\n    $.extend(defaults, options || {});\r\n\r\n    clearTimeout(timer);\r\n    $publicMask = $('[data-action=\"publicMask\"]');\r\n    $publicTips = $('[data-action=\"publicTips\"]');\r\n\r\n    if ($publicMask.length > 0) {\r\n\r\n        $publicMask.show();\r\n        $publicTips.show().text(msg);\r\n\r\n    } else {\r\n\r\n        $('body').append('<div data-action=\"publicMask\" class=\"ordi-toast\"></div><div class=\"ordi-toast-txt\" data-action=\"publicTips\">' + msg + '</div>');\r\n        $publicMask = $('[data-action=\"publicMask\"]');\r\n        $publicTips = $('[data-action=\"publicTips\"]');\r\n        events();\r\n    }\r\n\r\n    $publicTips.css('margin', -$publicTips[0].offsetHeight / 2 + 'px 0 0 ' + -$publicTips.width() / 2 + 'px');\r\n\r\n    timer = setTimeout(function() {\r\n\r\n        $publicMask.hide();\r\n        $publicTips.hide();\r\n\r\n        defaults.callback();\r\n\r\n    }, defaults.duration);\r\n};\r\n\r\n\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    events: events\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/hint.js","var fetch = require('io/fetch');\nvar Pubsub = require('io/pubsub');\n\nvar url = location.hostname.split('.');\nvar len = url.length;\nvar domain = url[len - 2] + '.' + url[len - 1];\nvar getCookieArea = function() {\n    fetch.get($_CONFIG.ss_service_gome + 'item/v1/cookie/getregion/flag/public/ip', {\n        dataType: 'jsonp',\n        jsonpCallback: \"ip\"\n    }).done(function(data) {\n        var value = data.atgregion;\n        if (data.success === true) {\n            $.cookie('atgregion', value, {\n                expires: 1,\n                path: '/',\n                domain: domain\n            });\n            Pubsub('getAreaId').pub();\n        }\n    })\n};\nmodule.exports = getCookieArea;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/atgregion.js","/*\n * Lazy Load - jQuery plugin for lazy loading images\n *\n * Copyright (c) 2007-2012 Mika Tuupola\n *\n * Licensed under the MIT license:\n *   http://www.opensource.org/licenses/mit-license.php\n *\n * Project home:\n *   http://www.appelsiini.net/projects/lazyload\n *\n * Version:  1.7.2\n *\n */\n(function($, window) {\n\n    var $window = $(window);\n    var $container;\n\n    $.fn.lazyload = function(options) {\n        var elements = this;\n        var settings = {\n            threshold: 0,\n            failure_limit: 0,\n            event: \"scroll\",\n            effect: \"show\",\n            container: window,\n            data_attribute: \"original\",\n            skip_invisible: true,\n            appear: null,\n            load: null\n        };\n\n        function update() {\n            var counter = 0;\n\n            elements.each(function() {\n                var $this = $(this);\n                if (settings.skip_invisible && !$this.is(\":visible\")) {\n                    return;\n                }\n                if ($.abovethetop(this, settings) ||\n                    $.leftofbegin(this, settings)) {\n                    /* Nothing. */\n                } else if (!$.belowthefold(this, settings) &&\n                    !$.rightoffold(this, settings)) {\n                    $this.trigger(\"appear\");\n                } else {\n                    if (++counter > settings.failure_limit) {\n                        return false;\n                    }\n                }\n            });\n\n        }\n\n        if (options) {\n            /* Maintain BC for a couple of versions. */\n            if (undefined !== options.failurelimit) {\n                options.failure_limit = options.failurelimit;\n                delete options.failurelimit;\n            }\n            if (undefined !== options.effectspeed) {\n                options.effect_speed = options.effectspeed;\n                delete options.effectspeed;\n            }\n\n            $.extend(settings, options);\n        }\n\n        /* Cache container as jQuery as object. */\n        $container = (settings.container === undefined ||\n            settings.container === window) ? $window : $(settings.container);\n\n        /* Fire one scroll event per scroll. Not one scroll event per image. */\n        if (0 === settings.event.indexOf(\"scroll\")) {\n            $container.bind(settings.event, function() {\n                return update();\n            });\n        }\n\n        this.each(function() {\n            var self = this;\n            var $self = $(self);\n\n            self.loaded = false;\n\n            /* When appear is triggered load original image. */\n            $self.one(\"appear\", function() {\n                if (!this.loaded) {\n                    if (settings.appear) {\n                        var elements_left = elements.length;\n                        settings.appear.call(self, elements_left, settings);\n                    }\n                    $(\"<img />\")\n                        .bind(\"load\", function() {\n                            $self\n                            //.hide()\n                                .attr(\"src\", $self.data(settings.data_attribute))[settings.effect](settings.effect_speed);\n                            self.loaded = true;\n\n                            /* Remove image from array so it is not looped next time. */\n                            var temp = $.grep(elements, function(element) {\n                                return !element.loaded;\n                            });\n                            elements = $(temp);\n\n                            if (settings.load) {\n                                var elements_left = elements.length;\n                                settings.load.call(self, elements_left, settings);\n                            }\n                        })\n                        .attr(\"src\", $self.data(settings.data_attribute));\n                }\n            });\n\n            /* When wanted event is triggered load original image */\n            /* by triggering appear.                              */\n            if (0 !== settings.event.indexOf(\"scroll\")) {\n                $self.bind(settings.event, function() {\n                    if (!self.loaded) {\n                        $self.trigger(\"appear\");\n                    }\n                });\n            }\n        });\n\n        /* Check if something appears when window is resized. */\n        $window.bind(\"resize\", function() {\n            update();\n        });\n\n        /* Force initial check if images should appear. */\n        update();\n\n        return this;\n    };\n\n    /* Convenience methods in jQuery namespace.           */\n    /* Use as  $.belowthefold(element, {threshold : 100, container : window}) */\n\n    $.belowthefold = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.height() + $window.scrollTop();\n        } else {\n            fold = $container.offset().top + $container.height();\n        }\n\n        return fold <= $(element).offset().top - settings.threshold;\n    };\n\n    $.rightoffold = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.width() + $window.scrollLeft();\n        } else {\n            fold = $container.offset().left + $container.width();\n        }\n\n        return fold <= $(element).offset().left - settings.threshold;\n    };\n\n    $.abovethetop = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.scrollTop();\n        } else {\n            fold = $container.offset().top;\n        }\n\n        return fold >= $(element).offset().top + settings.threshold + $(element).height();\n    };\n\n    $.leftofbegin = function(element, settings) {\n        var fold;\n\n        if (settings.container === undefined || settings.container === window) {\n            fold = $window.scrollLeft();\n        } else {\n            fold = $container.offset().left;\n        }\n\n        return fold >= $(element).offset().left + settings.threshold + $(element).width();\n    };\n\n    $.inviewport = function(element, settings) {\n        return !$.rightofscreen(element, settings) && !$.leftofscreen(element, settings) &&\n            !$.belowthefold(element, settings) && !$.abovethetop(element, settings);\n    };\n\n    /* Custom selectors for your convenience.   */\n    /* Use as $(\"img:below-the-fold\").something() */\n\n    $.extend($.expr[':'], {\n        \"below-the-fold\": function(a) {\n            return $.belowthefold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"above-the-top\": function(a) {\n            return !$.belowthefold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"right-of-screen\": function(a) {\n            return $.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"left-of-screen\": function(a) {\n            return !$.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"in-viewport\": function(a) {\n            return !$.inviewport(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        /* Maintain BC for couple of versions. */\n        \"above-the-fold\": function(a) {\n            return !$.belowthefold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"right-of-fold\": function(a) {\n            return $.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        },\n        \"left-of-fold\": function(a) {\n            return !$.rightoffold(a, {\n                threshold: 0,\n                container: window\n            });\n        }\n    });\n\n})(jQuery, window);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/plugin/jquery.lazyload.js\n// module id = 50\n// module chunks = 2 10 30","var imgPath = $_CONFIG.imgpath + '/images/emoji/';\n\nvar ext = '.png';\n\nvar groupOne = [{\n    name: '微笑',\n    url: 'weixiao'\n}, {\n    name: '色',\n    url: 'se'\n}, {\n    name: '亲亲',\n    url: 'qinqin'\n}, {\n    name: '得意',\n    url: 'deyi'\n}, {\n    name: '流泪',\n    url: 'liulei'\n}, {\n    name: '害羞',\n    url: 'haixiu'\n}, {\n    name: '闭嘴',\n    url: 'bizui'\n}, {\n    name: '鼓掌',\n    url: 'guzhang'\n}, {\n    name: '大哭',\n    url: 'daku'\n}, {\n    name: '尴尬',\n    url: 'ganga'\n}, {\n    name: '生气',\n    url: 'shengqi'\n}, {\n    name: '调皮',\n    url: 'tiaopi'\n}, {\n    name: '呲牙',\n    url: 'ciya'\n}, {\n    name: '惊讶',\n    url: 'jingya'\n}, {\n    name: '委屈',\n    url: 'weiqu'\n}, {\n    name: '吐血',\n    url: 'tuxue'\n}, {\n    name: '冷汗',\n    url: 'lenghan'\n}, {\n    name: '抓狂',\n    url: 'zhuakuang'\n}, {\n    name: '难过',\n    url: 'nanguo'\n}, {\n    name: '偷笑',\n    url: 'touxiao'\n}, {\n    name: '白眼',\n    url: 'baiyan'\n}, {\n    name: '不屑',\n    url: 'buxie'\n}, {\n    name: '快哭了',\n    url: 'kuaikule'\n}];\n\nvar groupTwo = [{\n    name: '困',\n    url: 'kun'\n}, {\n    name: '装酷',\n    url: 'zhuangku'\n}, {\n    name: '大笑',\n    url: 'daxiao'\n}, {\n    name: '偷瞄',\n    url: 'toumiao'\n}, {\n    name: '奋斗',\n    url: 'fendou'\n}, {\n    name: '咒骂',\n    url: 'zhouma'\n}, {\n    name: '疑问',\n    url: 'yiwen'\n}, {\n    name: '晕',\n    url: 'yun'\n}, {\n    name: '捶打',\n    url: 'chuida'\n}, {\n    name: '再见',\n    url: 'zaijian'\n}, {\n    name: '抠鼻',\n    url: 'koubi'\n}, {\n    name: '发呆',\n    url: 'fadai'\n}, {\n    name: '坏笑',\n    url: 'huaixiao'\n}, {\n    name: '哈欠',\n    url: 'haqian'\n}, {\n    name: '鄙视',\n    url: 'bishi'\n}, {\n    name: '睡觉',\n    url: 'shuijiao'\n}, {\n    name: '饿',\n    url: 'e'\n}, {\n    name: '阴险',\n    url: 'yinxian'\n}, {\n    name: '难受',\n    url: 'nanshou'\n}, {\n    name: '可怜',\n    url: 'kelian'\n}, {\n    name: '撇嘴',\n    url: 'piezui'\n}, {\n    name: '石化',\n    url: 'shihua'\n}, {\n    name: '泪眼',\n    url: 'leiyan'\n}];\n\nvar groupThree = [{\n    name: '嘘',\n    url: 'xu'\n}, {\n    name: '哼哼',\n    url: 'hengheng'\n}, {\n    name: '爱慕',\n    url: 'aimu'\n}, {\n    name: '财迷',\n    url: 'caimi'\n}, {\n    name: '耶',\n    url: 'ye'\n}, {\n    name: '思考',\n    url: 'sikao'\n}, {\n    name: '骷髅',\n    url: 'kulou'\n}, {\n    name: '痛哭',\n    url: 'tongku'\n}, {\n    name: '恭喜',\n    url: 'gongxi'\n}, {\n    name: '捂脸',\n    url: 'wulian'\n}, {\n    name: '嘿哈',\n    url: 'heiha'\n}, {\n    name: '机智',\n    url: 'jizhi'\n}, {\n    name: '皱眉',\n    url: 'zhoumei'\n}, {\n    name: '安慰',\n    url: 'anwei'\n}, {\n    name: '飞吻',\n    url: 'feiwen'\n}, {\n    name: '奸笑',\n    url: 'jianxiao'\n}, {\n    name: '猪头',\n    url: 'zhutou'\n}, {\n    name: '玫瑰',\n    url: 'meigui'\n}, {\n    name: '凋谢',\n    url: 'diaoxie'\n}, {\n    name: '爱心',\n    url: 'aixin'\n}, {\n    name: '心碎',\n    url: 'xinsui'\n}, {\n    name: '蛋糕',\n    url: 'dangao'\n}, {\n    name: '喝水',\n    url: 'heshui'\n}];\n\nvar groupFour = [{\n    name: '西瓜',\n    url: 'xigua'\n}, {\n    name: '咖啡',\n    url: 'kafei'\n}, {\n    name: '啤酒',\n    url: 'pijiu'\n}, {\n    name: '包包',\n    url: 'baobao'\n}, {\n    name: '高跟鞋',\n    url: 'gaogenxie'\n}, {\n    name: '帽子',\n    url: 'maozi'\n}, {\n    name: '口红',\n    url: 'kouhong'\n}, {\n    name: '裙子',\n    url: 'qunzi'\n}, {\n    name: 'T恤',\n    url: 'txu'\n}, {\n    name: '裤子',\n    url: 'kuzi'\n}, {\n    name: '眼镜',\n    url: 'yanjing'\n}, {\n    name: '太阳镜',\n    url: 'taiyangjing'\n}, {\n    name: '蜡烛',\n    url: 'lazhu'\n}, {\n    name: '礼物',\n    url: 'liwu'\n}, {\n    name: '红包',\n    url: 'hongbao'\n}, {\n    name: '拥抱',\n    url: 'yongbao'\n}, {\n    name: '太阳',\n    url: 'taiyang'\n}, {\n    name: '月亮',\n    url: 'yueliang'\n}, {\n    name: '便便',\n    url: 'bianbian'\n}, {\n    name: '炸弹',\n    url: 'zhadan'\n}, {\n    name: '菜刀',\n    url: 'caidao'\n}, {\n    name: '握手',\n    url: 'woshou'\n}, {\n    name: '胜利',\n    url: 'shengli'\n}];\n\nvar groupFive = [{\n    name: '赞',\n    url: 'zan'\n}, {\n    name: 'OK',\n    url: 'ok'\n}, {\n    name: '勾引',\n    url: 'gouyin'\n}, {\n    name: 'NO',\n    url: 'no'\n}, {\n    name: '打脸',\n    url: 'dalian'\n}, {\n    name: '抱拳',\n    url: 'baoquan'\n}, {\n    name: '乒乓球',\n    url: 'pingpangqiu'\n}, {\n    name: '足球',\n    url: 'zuqiu'\n}, {\n    name: '篮球',\n    url: 'lanqiu'\n}];\n\nvar format = function(arr) {\n    for (var i = 0, len = arr.length; i < len; i++) {\n        var emoji = arr[i];\n        emoji.url = imgPath + emoji.url + ext;\n    }\n    return arr;\n};\n\nmodule.exports = format(groupOne.concat(groupTwo, groupThree, groupFour, groupFive));\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/emoji.js","var Dialog = require('dialog');\nvar noop = function() {};\n\nvar create = function(content, options) {\n    var defaults = {\n        fixed: true,\n        modal: true,\n        content: '<p class=\"del-pop-p\">' + content + '</p>',\n        className: 'pop-box',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        ok: noop,\n        cancel: noop,\n        btnWrapCls: 'two-buttons'\n    };\n    $.extend(true, defaults, options);\n\n    var d = Dialog(defaults);\n\n    // var header = d._$('header');\n    // var title = d._$('title');\n    // title.css('borderBottom', 'none');\n    // header.show();\n\n    d.show();\n    return d;\n};\n\nmodule.exports = create;\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/confirm.js","var html = function(str, reg) {\n    return str ? str.replace(reg || /[&<\">'](?:(amp|lt|ldquo|rdquo|quot|gt|#39|nbsp|#\\d+);)?/g, function(a, b) {\n        if (b) {\n            return a;\n        } else {\n            return {\n                '<': '&lt;',\n                '&': '&amp;',\n                '\"': '&quot;',\n                '“': '&ldquo;',\n                '”': '&rdquo;',\n                '>': '&gt;',\n                \"'\": '&#39;'\n            }[a]\n        }\n\n    }) : '';\n};\n\nmodule.exports = html;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/encodeHtml.js","var emojis = require('./emoji');\r\nvar backward = require('./backward');\r\nvar faceTpl = require('./face.tpl');\r\n\r\nvar faceReg,\r\n    faceUrl,\r\n    defaultIndex = 0;\r\n\r\n// 将表情转换成map\r\nvar emojiMap = {};\r\n\r\n// 数据适配转换\r\nvar makeData = function(data) {\r\n    var total = data.length;\r\n    var offset = 24;\r\n    var page = Math.ceil(total / offset);\r\n    var list = [];\r\n\r\n    for (var i = 0; i < page; i++) {\r\n        list[i] = [];\r\n        var end = offset * (i + 1);\r\n        end = end > total ? total : end;\r\n        for (var j = i * offset; j < end; j++) {\r\n            var emoji = data[j];\r\n            list[i].push(emoji);\r\n            emojiMap[emoji.name] = emoji.url;\r\n        }\r\n    }\r\n    return {\r\n        page: new Array(page),\r\n        list: list\r\n    };\r\n};\r\n// 表情层显示\r\nvar show = function(x, y) {\r\n    setShowIndex(0);\r\n    $('[data-node=faceBox]').css({\r\n        left: x + 'px',\r\n        top: y + 'px'\r\n    }).show();\r\n};\r\n// 表情层隐藏\r\nvar hide = function() {\r\n    $('[data-node=faceBox]').hide();\r\n};\r\n// tab方式显示所选页\r\nvar setShowIndex = function(index) {\r\n    index = index || defaultIndex;\r\n\r\n    $('[data-action=facePage] > li').eq(index).addClass('active').siblings('li').removeClass('active');\r\n    $('[data-node=faceList] > div').eq(index).removeClass('hide').siblings('div').addClass('hide');\r\n};\r\n\r\n/**\r\n * 插入表情，回调数据\r\n * @param  {Function} fn     回调函数\r\n * @param  {Boolean}  isHide 点击表情后是否隐藏表情浮层，默认隐藏\r\n * @return {[type]}          null\r\n */\r\nvar insertFace = function(fn, isHide) {\r\n    $('body').on('click', '[data-face]', function(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        faceReg = $(this).data('face');\r\n        faceUrl = $(this).attr('src');\r\n        fn({\r\n            reg: faceReg,\r\n            url: faceUrl\r\n        });\r\n        isHide !== false && $('[data-node=faceBox]').hide();\r\n    });\r\n};\r\n// 初始化表情弹层\r\nvar initHTML = function(fn) {\r\n    var data = makeData(emojis);\r\n    var faceHTML = faceTpl(data);\r\n    $('body').append(faceHTML);\r\n    fn();\r\n};\r\n// 初始化事件\r\nvar initEvent = function() {\r\n    $('body').on('click', '[data-node=faceBox]', function(e) {\r\n        e.stopPropagation();\r\n    });\r\n    $(document).on('click', function() {\r\n        $('[data-node=faceBox]').hide();\r\n    });\r\n    // 分页切换显示\r\n    $('[data-node=faceBox]').on('mouseenter', '[data-action=facePage] > li', function() {\r\n        var index = $(this).index();\r\n        setShowIndex(index);\r\n    });\r\n};\r\n\r\n// 把表情占位符替换成img\r\nvar parseEmoji = function(str) {\r\n    var r = /(\\[([\\s\\S]+?)\\])/g;\r\n    if ($.isEmptyObject(emojiMap)) {\r\n        makeData(emojis);\r\n    }\r\n\r\n    return str.replace(r, function(s, $1, name) {\r\n        var img = emojiMap[name];\r\n        if (img) {\r\n            return '<img width=\"22\" height=\"22\" src=\"' + img + '\" />';\r\n        } else {\r\n            // 兼容旧版表情\r\n            var old = backward[name];\r\n            if (old) {\r\n                return '<img width=\"22\" height=\"22\" src=\"' + old.url + '\" />';\r\n            }\r\n            return s;\r\n        }\r\n    });\r\n};\r\n\r\nvar init = function() {\r\n    initHTML(initEvent);\r\n};\r\n\r\nmodule.exports = {\r\n    init: init,\r\n    insert: insertFace,\r\n    show: show,\r\n    hide: hide,\r\n    parseEmoji: parseEmoji\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/face.js","var path = $_CONFIG.imgpath + '/images/emoji/';\nvar ext = '.png';\n\nvar backward = {\n    '亲': {\n        name: '亲亲',\n        url: path + 'qinqin' + ext\n    },\n    '愤怒': {\n        name: '生气',\n        url: path + 'shengqi' + ext\n    },\n    '惊恐': {\n        name: '惊讶',\n        url: path + 'jingya' + ext\n    },\n    '迷茫': {\n        name: '委屈',\n        url: path + 'weiqu' + ext\n    },\n    '伤心': {\n        name: '难过',\n        url: path + 'nanguo' + ext\n    },\n    '努力': {\n        name: '奋斗',\n        url: path + 'fendou' + ext\n    },\n    'YY': {\n        name: ' 坏笑',\n        url: path + 'huaixiao' + ext\n    },\n    '恶心': {\n        name: '难受',\n        url: path + 'nanshou' + ext\n    }\n};\n\nmodule.exports = backward;\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/face/backward.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/face/face',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,list=$data.list,v=$data.v,i=$data.i,face=$data.face,$index=$data.$index,$escape=$utils.$escape,page=$data.page,$out='';$out+='<div data-node=\"faceBox\" class=\"imoj-box\" style=\"position: absolute;z-index: 9999;display:none\"> <em class=\"sanjiao\"></em> <div data-node=\"faceList\" class=\"imoj-list\"> ';\n$each(list,function(v,i){\n$out+=' <div class=\"imoj-content clearfix ';\nif(i){\n$out+='hide';\n}\n$out+='\"> ';\n$each(v,function(face,$index){\n$out+=' <a href=\"javascript:;\"> <img width=\"22\" height=\"22\" data-face=\"[';\n$out+=$escape(face.name);\n$out+=']\" src=\"';\n$out+=$escape(face.url);\n$out+='\" alt=\"';\n$out+=$escape(face.name);\n$out+='\" title=\"';\n$out+=$escape(face.name);\n$out+='\"> </a> ';\n});\n$out+=' </div> ';\n});\n$out+=' </div> <ul data-action=\"facePage\" class=\"pagination\"> ';\n$each(page,function(v,i){\n$out+=' <li ';\nif(i==0){\n$out+='class=\"active\"';\n}\n$out+='>';\n$out+=$escape(i+1);\n$out+='</li> ';\n});\n$out+=' </ul> </div>';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/face/face.tpl\n// module id = 77\n// module chunks = 3 6 16 21 22 30 31 33 45","/**\n * Created by dongyukuan on 2016/7/4.\n */\nvar inputTip = {\n    tel: {\n        ept: '请填写11位手机号',\n        err: '手机号格式错误',\n        errBack: '该手机号已被注册'\n    },\n    msgCode: {\n        tipGet: '请获取短信验证码',\n        tipEpt: '请输入短信验证码',\n        tipErr: '验证码是6位数字,请重新输入',\n        tipErrEdit: '验证码错误',\n        tipWrong: '验证码有误,请重新输入',\n        checkCodeWrong: '验证码输入错误,请重新输入',\n        send: '验证码已发送，请注意查收',\n        tipSend: '验证码已发送您的手机，10分钟内输入有效',\n        tipDisabled: \"验证码再次获取需间隔60s\",\n        tipLimitEdit: '获取验证码超限，请稍后再试',\n        btnAfterSend: \"秒后重新获取\",\n        btnDefault: \"获取验证码\"\n    },\n    pwd: {\n        commonTip: '请输入6-20位英文字母,数字或符号'\n    },\n    pwdV: {\n        ept: '请再次输入密码',\n        err: '两次输入的密码不一致'\n    },\n    nickName: {\n        eptName: '请输入昵称！',\n        commonTip: '昵称只能输入2-20位字符、字母、数字、-、_',\n        existName: '此昵称太受欢迎了，已经有人抢了~',\n        sucSub: '资料修改成功！',\n        errLine: \"网络超时!\",\n        wrongName: '此昵称含有敏感词,请重新输入'\n    },\n    birthTip: {\n        tip: '生日不能重复设置'\n    },\n    refCode: {\n        err: '推荐码错误'\n    },\n    imgCode: {\n        ept: '请输入验证码',\n        err: '验证码输入错误，请重新输入'\n    },\n    login: {\n        errCode: '请输入验证码',\n        errNum: '请输入账号',\n        errPwd: '请输入密码',\n        agreement: '请同意协议并勾选'\n    },\n    createCircle: {\n        typeEmpty: '请选择圈子分类',\n        nameEmpty: '圈子名称不能为空',\n        upperLimit: '抱歉，您创建的圈子已经达到上限，暂不能创建！'\n    },\n    circle: {\n    \tlogin: '登录成功！',\n        unJoin: '需要先加入该圈子才能发布话题',\n        cannotJoin: '抱歉！该圈子不允许发布话题!',\n        review: '加入圈子审核中，请耐心等待!',\n        joinSuccess: '恭喜您已经加入圈子！',\n        joinSuccessPublic: '恭喜您已经加入圈子，快来发布话题吧！',\n        cannotJoinCircle: '抱歉！该圈子不允许任何人加入！',\n        exit: '您已经退出该圈子！',\n        dissolved: '抱歉！该圈子已被解散'\n    },\n    qrCodeTip: {\n        loseEffTip: '二维码已失效',\n        loseEffBtn: '点击刷新',\n        failGetTip: '二维码生成失败',\n        failGetBtn: '重新生成'\n    },\n    masterApply: {\n        nameLength: '姓名要2-20个字符',\n        nameType: '姓名仅限汉字和字母',\n        isIdCard: '请填写18位有效身份证号',\n        type: '请选择达人类别',\n        summary: '请输入自我介绍，2-100个字符'\n    },\n    upload: {\n        noUpload: '请上传图片',\n        uploadError: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        uploadFaild: '上传失败,请重新上传',\n        uploadError_Master: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif!',\n        Q_EXCEED_NUM_LIMIT: '请上传小于4M的图片，支持格式jpg、jpeg、png、gif！',\n        Q_EXCEED_SIZE_LIMIT: '总文件大小超出限制',\n        Q_TYPE_DENIED: '文件类型错误',\n        F_EXCEED_SIZE: '请上传jpg、png格式且小于4M的图片！',\n        excess: '文件个数超出限制'\n    },\n    errLine: {\n        tip: '网络错误,请稍后再试！'\n    }\n};\nmodule.exports = inputTip;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/i18n.js","/*! WebUploader 0.1.5 */\n\n\n/**\n * @fileOverview 让内部各个部件的代码可以用[amd](https://github.com/amdjs/amdjs-api/wiki/AMD)模块定义方式组织起来。\n *\n * AMD API 内部的简单不完全实现，请忽略。只有当WebUploader被合并成一个文件的时候才会引入。\n */\n(function( root, factory ) {\n    var modules = {},\n\n        // 内部require, 简单不完全实现。\n        // https://github.com/amdjs/amdjs-api/wiki/require\n        _require = function( deps, callback ) {\n            var args, len, i;\n\n            // 如果deps不是数组，则直接返回指定module\n            if ( typeof deps === 'string' ) {\n                return getModule( deps );\n            } else {\n                args = [];\n                for( len = deps.length, i = 0; i < len; i++ ) {\n                    args.push( getModule( deps[ i ] ) );\n                }\n\n                return callback.apply( null, args );\n            }\n        },\n\n        // 内部define，暂时不支持不指定id.\n        _define = function( id, deps, factory ) {\n            if ( arguments.length === 2 ) {\n                factory = deps;\n                deps = null;\n            }\n\n            _require( deps || [], function() {\n                setModule( id, factory, arguments );\n            });\n        },\n\n        // 设置module, 兼容CommonJs写法。\n        setModule = function( id, factory, args ) {\n            var module = {\n                    exports: factory\n                },\n                returned;\n\n            if ( typeof factory === 'function' ) {\n                args.length || (args = [ _require, module.exports, module ,window.jQuery]);\n                returned = factory.apply( null, args );\n                returned !== undefined && (module.exports = returned);\n            }\n\n            modules[ id ] = module.exports;\n        },\n\n        // 根据id获取module\n        getModule = function( id ) {\n            var module = modules[ id ] || root[ id ];\n\n            if ( !module ) {\n                throw new Error( '`' + id + '` is undefined' );\n            }\n\n            return module;\n        },\n\n        // 将所有modules，将路径ids装换成对象。\n        exportsTo = function( obj ) {\n            var key, host, parts, part, last, ucFirst;\n\n            // make the first character upper case.\n            ucFirst = function( str ) {\n                return str && (str.charAt( 0 ).toUpperCase() + str.substr( 1 ));\n            };\n\n            for ( key in modules ) {\n                host = obj;\n\n                if ( !modules.hasOwnProperty( key ) ) {\n                    continue;\n                }\n\n                parts = key.split('/');\n                last = ucFirst( parts.pop() );\n\n                while( (part = ucFirst( parts.shift() )) ) {\n                    host[ part ] = host[ part ] || {};\n                    host = host[ part ];\n                }\n\n                host[ last ] = modules[ key ];\n            }\n\n            return obj;\n        },\n\n        makeExport = function( dollar ) {\n            root.__dollar = dollar;\n\n            // exports every module.\n            return exportsTo( factory( root, _define, _require,window.jQuery ) );\n        },\n\n        origin;\n\n    if ( typeof module === 'object' && typeof module.exports === 'object' ) {\n\n        // For CommonJS and CommonJS-like environments where a proper window is present,\n        module.exports = makeExport();\n    } else if ( typeof define === 'function' && define.amd ) {\n\n        // Allow using this built library as an AMD module\n        // in another project. That other project will only\n        // see this AMD call, not the internal modules in\n        // the closure below.\n        define([ 'jquery' ], makeExport );\n    } else {\n\n        // Browser globals case. Just assign the\n        // result to a property on the global.\n        origin = root.WebUploader;\n        root.WebUploader = makeExport();\n        root.WebUploader.noConflict = function() {\n            root.WebUploader = origin;\n        };\n    }\n})( window, function( window, define, require ,jQuery ) {\n\n\n    /**\n     * @fileOverview jQuery or Zepto\n     */\n    define('dollar-third',[],function() {\n        var $ = window.__dollar || window.jQuery || window.Zepto || jQuery;\n\n        if ( !$ ) {\n            throw new Error('jQuery or Zepto not found!');\n        }\n\n        return $;\n    });\n    /**\n     * @fileOverview Dom 操作相关\n     */\n    define('dollar',[\n        'dollar-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 使用jQuery的Promise\n     */\n    define('promise-third',[\n        'dollar'\n    ], function( $ ) {\n        return {\n            Deferred: $.Deferred,\n            when: $.when,\n\n            isPromise: function( anything ) {\n                return anything && typeof anything.then === 'function';\n            }\n        };\n    });\n    /**\n     * @fileOverview Promise/A+\n     */\n    define('promise',[\n        'promise-third'\n    ], function( _ ) {\n        return _;\n    });\n    /**\n     * @fileOverview 基础类方法。\n     */\n\n    /**\n     * Web Uploader内部类的详细说明，以下提及的功能类，都可以在`WebUploader`这个变量中访问到。\n     *\n     * As you know, Web Uploader的每个文件都是用过[AMD](https://github.com/amdjs/amdjs-api/wiki/AMD)规范中的`define`组织起来的, 每个Module都会有个module id.\n     * 默认module id为该文件的路径，而此路径将会转化成名字空间存放在WebUploader中。如：\n     *\n     * * module `base`：WebUploader.Base\n     * * module `file`: WebUploader.File\n     * * module `lib/dnd`: WebUploader.Lib.Dnd\n     * * module `runtime/html5/dnd`: WebUploader.Runtime.Html5.Dnd\n     *\n     *\n     * 以下文档中对类的使用可能省略掉了`WebUploader`前缀。\n     * @module WebUploader\n     * @title WebUploader API文档\n     */\n    define('base',[\n        'dollar',\n        'promise'\n    ], function( $, promise ) {\n\n        var noop = function() {},\n            call = Function.call;\n\n        // http://jsperf.com/uncurrythis\n        // 反科里化\n        function uncurryThis( fn ) {\n            return function() {\n                return call.apply( fn, arguments );\n            };\n        }\n\n        function bindFn( fn, context ) {\n            return function() {\n                return fn.apply( context, arguments );\n            };\n        }\n\n        function createObject( proto ) {\n            var f;\n\n            if ( Object.create ) {\n                return Object.create( proto );\n            } else {\n                f = function() {};\n                f.prototype = proto;\n                return new f();\n            }\n        }\n\n\n        /**\n         * 基础类，提供一些简单常用的方法。\n         * @class Base\n         */\n        return {\n\n            /**\n             * @property {String} version 当前版本号。\n             */\n            version: '0.1.5',\n\n            /**\n             * @property {jQuery|Zepto} $ 引用依赖的jQuery或者Zepto对象。\n             */\n            $: $,\n\n            Deferred: promise.Deferred,\n\n            isPromise: promise.isPromise,\n\n            when: promise.when,\n\n            /**\n             * @description  简单的浏览器检查结果。\n             *\n             * * `webkit`  webkit版本号，如果浏览器为非webkit内核，此属性为`undefined`。\n             * * `chrome`  chrome浏览器版本号，如果浏览器为chrome，此属性为`undefined`。\n             * * `ie`  ie浏览器版本号，如果浏览器为非ie，此属性为`undefined`。**暂不支持ie10+**\n             * * `firefox`  firefox浏览器版本号，如果浏览器为非firefox，此属性为`undefined`。\n             * * `safari`  safari浏览器版本号，如果浏览器为非safari，此属性为`undefined`。\n             * * `opera`  opera浏览器版本号，如果浏览器为非opera，此属性为`undefined`。\n             *\n             * @property {Object} [browser]\n             */\n            browser: (function( ua ) {\n                var ret = {},\n                    webkit = ua.match( /WebKit\\/([\\d.]+)/ ),\n                    chrome = ua.match( /Chrome\\/([\\d.]+)/ ) ||\n                        ua.match( /CriOS\\/([\\d.]+)/ ),\n\n                    ie = ua.match( /MSIE\\s([\\d\\.]+)/ ) ||\n                        ua.match( /(?:trident)(?:.*rv:([\\w.]+))?/i ),\n                    firefox = ua.match( /Firefox\\/([\\d.]+)/ ),\n                    safari = ua.match( /Safari\\/([\\d.]+)/ ),\n                    opera = ua.match( /OPR\\/([\\d.]+)/ );\n\n                webkit && (ret.webkit = parseFloat( webkit[ 1 ] ));\n                chrome && (ret.chrome = parseFloat( chrome[ 1 ] ));\n                ie && (ret.ie = parseFloat( ie[ 1 ] ));\n                firefox && (ret.firefox = parseFloat( firefox[ 1 ] ));\n                safari && (ret.safari = parseFloat( safari[ 1 ] ));\n                opera && (ret.opera = parseFloat( opera[ 1 ] ));\n\n                return ret;\n            })( navigator.userAgent ),\n\n            /**\n             * @description  操作系统检查结果。\n             *\n             * * `android`  如果在android浏览器环境下，此值为对应的android版本号，否则为`undefined`。\n             * * `ios` 如果在ios浏览器环境下，此值为对应的ios版本号，否则为`undefined`。\n             * @property {Object} [os]\n             */\n            os: (function( ua ) {\n                var ret = {},\n\n                    // osx = !!ua.match( /\\(Macintosh\\; Intel / ),\n                    android = ua.match( /(?:Android);?[\\s\\/]+([\\d.]+)?/ ),\n                    ios = ua.match( /(?:iPad|iPod|iPhone).*OS\\s([\\d_]+)/ );\n\n                // osx && (ret.osx = true);\n                android && (ret.android = parseFloat( android[ 1 ] ));\n                ios && (ret.ios = parseFloat( ios[ 1 ].replace( /_/g, '.' ) ));\n\n                return ret;\n            })( navigator.userAgent ),\n\n            /**\n             * 实现类与类之间的继承。\n             * @method inherits\n             * @grammar Base.inherits( super ) => child\n             * @grammar Base.inherits( super, protos ) => child\n             * @grammar Base.inherits( super, protos, statics ) => child\n             * @param  {Class} super 父类\n             * @param  {Object | Function} [protos] 子类或者对象。如果对象中包含constructor，子类将是用此属性值。\n             * @param  {Function} [protos.constructor] 子类构造器，不指定的话将创建个临时的直接执行父类构造器的方法。\n             * @param  {Object} [statics] 静态属性或方法。\n             * @return {Class} 返回子类。\n             * @example\n             * function Person() {\n             *     console.log( 'Super' );\n             * }\n             * Person.prototype.hello = function() {\n             *     console.log( 'hello' );\n             * };\n             *\n             * var Manager = Base.inherits( Person, {\n             *     world: function() {\n             *         console.log( 'World' );\n             *     }\n             * });\n             *\n             * // 因为没有指定构造器，父类的构造器将会执行。\n             * var instance = new Manager();    // => Super\n             *\n             * // 继承子父类的方法\n             * instance.hello();    // => hello\n             * instance.world();    // => World\n             *\n             * // 子类的__super__属性指向父类\n             * console.log( Manager.__super__ === Person );    // => true\n             */\n            inherits: function( Super, protos, staticProtos ) {\n                var child;\n\n                if ( typeof protos === 'function' ) {\n                    child = protos;\n                    protos = null;\n                } else if ( protos && protos.hasOwnProperty('constructor') ) {\n                    child = protos.constructor;\n                } else {\n                    child = function() {\n                        return Super.apply( this, arguments );\n                    };\n                }\n\n                // 复制静态方法\n                $.extend( true, child, Super, staticProtos || {} );\n\n                /* jshint camelcase: false */\n\n                // 让子类的__super__属性指向父类。\n                child.__super__ = Super.prototype;\n\n                // 构建原型，添加原型方法或属性。\n                // 暂时用Object.create实现。\n                child.prototype = createObject( Super.prototype );\n                protos && $.extend( true, child.prototype, protos );\n\n                return child;\n            },\n\n            /**\n             * 一个不做任何事情的方法。可以用来赋值给默认的callback.\n             * @method noop\n             */\n            noop: noop,\n\n            /**\n             * 返回一个新的方法，此方法将已指定的`context`来执行。\n             * @grammar Base.bindFn( fn, context ) => Function\n             * @method bindFn\n             * @example\n             * var doSomething = function() {\n             *         console.log( this.name );\n             *     },\n             *     obj = {\n             *         name: 'Object Name'\n             *     },\n             *     aliasFn = Base.bind( doSomething, obj );\n             *\n             *  aliasFn();    // => Object Name\n             *\n             */\n            bindFn: bindFn,\n\n            /**\n             * 引用Console.log如果存在的话，否则引用一个[空函数noop](#WebUploader:Base.noop)。\n             * @grammar Base.log( args... ) => undefined\n             * @method log\n             */\n            log: (function() {\n                if ( window.console ) {\n                    return bindFn( console.log, console );\n                }\n                return noop;\n            })(),\n\n            nextTick: (function() {\n\n                return function( cb ) {\n                    setTimeout( cb, 1 );\n                };\n\n                // @bug 当浏览器不在当前窗口时就停了。\n                // var next = window.requestAnimationFrame ||\n                //     window.webkitRequestAnimationFrame ||\n                //     window.mozRequestAnimationFrame ||\n                //     function( cb ) {\n                //         window.setTimeout( cb, 1000 / 60 );\n                //     };\n\n                // // fix: Uncaught TypeError: Illegal invocation\n                // return bindFn( next, window );\n            })(),\n\n            /**\n             * 被[uncurrythis](http://www.2ality.com/2011/11/uncurrying-this.html)的数组slice方法。\n             * 将用来将非数组对象转化成数组对象。\n             * @grammar Base.slice( target, start[, end] ) => Array\n             * @method slice\n             * @example\n             * function doSomthing() {\n             *     var args = Base.slice( arguments, 1 );\n             *     console.log( args );\n             * }\n             *\n             * doSomthing( 'ignored', 'arg2', 'arg3' );    // => Array [\"arg2\", \"arg3\"]\n             */\n            slice: uncurryThis( [].slice ),\n\n            /**\n             * 生成唯一的ID\n             * @method guid\n             * @grammar Base.guid() => String\n             * @grammar Base.guid( prefx ) => String\n             */\n            guid: (function() {\n                var counter = 0;\n\n                return function( prefix ) {\n                    var guid = (+new Date()).toString( 32 ),\n                        i = 0;\n\n                    for ( ; i < 5; i++ ) {\n                        guid += Math.floor( Math.random() * 65535 ).toString( 32 );\n                    }\n\n                    return (prefix || 'wu_') + guid + (counter++).toString( 32 );\n                };\n            })(),\n\n            /**\n             * 格式化文件大小, 输出成带单位的字符串\n             * @method formatSize\n             * @grammar Base.formatSize( size ) => String\n             * @grammar Base.formatSize( size, pointLength ) => String\n             * @grammar Base.formatSize( size, pointLength, units ) => String\n             * @param {Number} size 文件大小\n             * @param {Number} [pointLength=2] 精确到的小数点数。\n             * @param {Array} [units=[ 'B', 'K', 'M', 'G', 'TB' ]] 单位数组。从字节，到千字节，一直往上指定。如果单位数组里面只指定了到了K(千字节)，同时文件大小大于M, 此方法的输出将还是显示成多少K.\n             * @example\n             * console.log( Base.formatSize( 100 ) );    // => 100B\n             * console.log( Base.formatSize( 1024 ) );    // => 1.00K\n             * console.log( Base.formatSize( 1024, 0 ) );    // => 1K\n             * console.log( Base.formatSize( 1024 * 1024 ) );    // => 1.00M\n             * console.log( Base.formatSize( 1024 * 1024 * 1024 ) );    // => 1.00G\n             * console.log( Base.formatSize( 1024 * 1024 * 1024, 0, ['B', 'KB', 'MB'] ) );    // => 1024MB\n             */\n            formatSize: function( size, pointLength, units ) {\n                var unit;\n\n                units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n\n                while ( (unit = units.shift()) && size > 1024 ) {\n                    size = size / 1024;\n                }\n\n                return (unit === 'B' ? size : size.toFixed( pointLength || 2 )) +\n                        unit;\n            }\n        };\n    });\n    /**\n     * 事件处理类，可以独立使用，也可以扩展给对象使用。\n     * @fileOverview Mediator\n     */\n    define('mediator',[\n        'base'\n    ], function( Base ) {\n        var $ = Base.$,\n            slice = [].slice,\n            separator = /\\s+/,\n            protos;\n\n        // 根据条件过滤出事件handlers.\n        function findHandlers( arr, name, callback, context ) {\n            return $.grep( arr, function( handler ) {\n                return handler &&\n                        (!name || handler.e === name) &&\n                        (!callback || handler.cb === callback ||\n                        handler.cb._cb === callback) &&\n                        (!context || handler.ctx === context);\n            });\n        }\n\n        function eachEvent( events, callback, iterator ) {\n            // 不支持对象，只支持多个event用空格隔开\n            $.each( (events || '').split( separator ), function( _, key ) {\n                iterator( key, callback );\n            });\n        }\n\n        function triggerHanders( events, args ) {\n            var stoped = false,\n                i = -1,\n                len = events.length,\n                handler;\n\n            while ( ++i < len ) {\n                handler = events[ i ];\n\n                if ( handler.cb.apply( handler.ctx2, args ) === false ) {\n                    stoped = true;\n                    break;\n                }\n            }\n\n            return !stoped;\n        }\n\n        protos = {\n\n            /**\n             * 绑定事件。\n             *\n             * `callback`方法在执行时，arguments将会来源于trigger的时候携带的参数。如\n             * ```javascript\n             * var obj = {};\n             *\n             * // 使得obj有事件行为\n             * Mediator.installTo( obj );\n             *\n             * obj.on( 'testa', function( arg1, arg2 ) {\n             *     console.log( arg1, arg2 ); // => 'arg1', 'arg2'\n             * });\n             *\n             * obj.trigger( 'testa', 'arg1', 'arg2' );\n             * ```\n             *\n             * 如果`callback`中，某一个方法`return false`了，则后续的其他`callback`都不会被执行到。\n             * 切会影响到`trigger`方法的返回值，为`false`。\n             *\n             * `on`还可以用来添加一个特殊事件`all`, 这样所有的事件触发都会响应到。同时此类`callback`中的arguments有一个不同处，\n             * 就是第一个参数为`type`，记录当前是什么事件在触发。此类`callback`的优先级比脚低，会再正常`callback`执行完后触发。\n             * ```javascript\n             * obj.on( 'all', function( type, arg1, arg2 ) {\n             *     console.log( type, arg1, arg2 ); // => 'testa', 'arg1', 'arg2'\n             * });\n             * ```\n             *\n             * @method on\n             * @grammar on( name, callback[, context] ) => self\n             * @param  {String}   name     事件名，支持多个事件用空格隔开\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             * @class Mediator\n             */\n            on: function( name, callback, context ) {\n                var me = this,\n                    set;\n\n                if ( !callback ) {\n                    return this;\n                }\n\n                set = this._events || (this._events = []);\n\n                eachEvent( name, callback, function( name, callback ) {\n                    var handler = { e: name };\n\n                    handler.cb = callback;\n                    handler.ctx = context;\n                    handler.ctx2 = context || me;\n                    handler.id = set.length;\n\n                    set.push( handler );\n                });\n\n                return this;\n            },\n\n            /**\n             * 绑定事件，且当handler执行完后，自动解除绑定。\n             * @method once\n             * @grammar once( name, callback[, context] ) => self\n             * @param  {String}   name     事件名\n             * @param  {Function} callback 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            once: function( name, callback, context ) {\n                var me = this;\n\n                if ( !callback ) {\n                    return me;\n                }\n\n                eachEvent( name, callback, function( name, callback ) {\n                    var once = function() {\n                            me.off( name, once );\n                            return callback.apply( context || me, arguments );\n                        };\n\n                    once._cb = callback;\n                    me.on( name, once, context );\n                });\n\n                return me;\n            },\n\n            /**\n             * 解除事件绑定\n             * @method off\n             * @grammar off( [name[, callback[, context] ] ] ) => self\n             * @param  {String}   [name]     事件名\n             * @param  {Function} [callback] 事件处理器\n             * @param  {Object}   [context]  事件处理器的上下文。\n             * @return {self} 返回自身，方便链式\n             * @chainable\n             */\n            off: function( name, cb, ctx ) {\n                var events = this._events;\n\n                if ( !events ) {\n                    return this;\n                }\n\n                if ( !name && !cb && !ctx ) {\n                    this._events = [];\n                    return this;\n                }\n\n                eachEvent( name, cb, function( name, cb ) {\n                    $.each( findHandlers( events, name, cb, ctx ), function() {\n                        delete events[ this.id ];\n                    });\n                });\n\n                return this;\n            },\n\n            /**\n             * 触发事件\n             * @method trigger\n             * @grammar trigger( name[, args...] ) => self\n             * @param  {String}   type     事件名\n             * @param  {*} [...] 任意参数\n             * @return {Boolean} 如果handler中return false了，则返回false, 否则返回true\n             */\n            trigger: function( type ) {\n                var args, events, allEvents;\n\n                if ( !this._events || !type ) {\n                    return this;\n                }\n\n                args = slice.call( arguments, 1 );\n                events = findHandlers( this._events, type );\n                allEvents = findHandlers( this._events, 'all' );\n\n                return triggerHanders( events, args ) &&\n                        triggerHanders( allEvents, arguments );\n            }\n        };\n\n        /**\n         * 中介者，它本身是个单例，但可以通过[installTo](#WebUploader:Mediator:installTo)方法，使任何对象具备事件行为。\n         * 主要目的是负责模块与模块之间的合作，降低耦合度。\n         *\n         * @class Mediator\n         */\n        return $.extend({\n\n            /**\n             * 可以通过这个接口，使任何对象具备事件功能。\n             * @method installTo\n             * @param  {Object} obj 需要具备事件行为的对象。\n             * @return {Object} 返回obj.\n             */\n            installTo: function( obj ) {\n                return $.extend( obj, protos );\n            }\n\n        }, protos );\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('uploader',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$;\n\n        /**\n         * 上传入口类。\n         * @class Uploader\n         * @constructor\n         * @grammar new Uploader( opts ) => Uploader\n         * @example\n         * var uploader = WebUploader.Uploader({\n         *     swf: 'path_of_swf/Uploader.swf',\n         *\n         *     // 开起分片上传。\n         *     chunked: true\n         * });\n         */\n        function Uploader( opts ) {\n            this.options = $.extend( true, {}, Uploader.options, opts );\n            this._init( this.options );\n        }\n\n        // default Options\n        // widgets中有相应扩展\n        Uploader.options = {};\n        Mediator.installTo( Uploader.prototype );\n\n        // 批量添加纯命令式方法。\n        $.each({\n            upload: 'start-upload',\n            stop: 'stop-upload',\n            getFile: 'get-file',\n            getFiles: 'get-files',\n            addFile: 'add-file',\n            addFiles: 'add-file',\n            sort: 'sort-files',\n            removeFile: 'remove-file',\n            cancelFile: 'cancel-file',\n            skipFile: 'skip-file',\n            retry: 'retry',\n            isInProgress: 'is-in-progress',\n            makeThumb: 'make-thumb',\n            md5File: 'md5-file',\n            getDimension: 'get-dimension',\n            addButton: 'add-btn',\n            predictRuntimeType: 'predict-runtime-type',\n            refresh: 'refresh',\n            disable: 'disable',\n            enable: 'enable',\n            reset: 'reset'\n        }, function( fn, command ) {\n            Uploader.prototype[ fn ] = function() {\n                return this.request( command, arguments );\n            };\n        });\n\n        $.extend( Uploader.prototype, {\n            state: 'pending',\n\n            _init: function( opts ) {\n                var me = this;\n\n                me.request( 'init', opts, function() {\n                    me.state = 'ready';\n                    me.trigger('ready');\n                });\n            },\n\n            /**\n             * 获取或者设置Uploader配置项。\n             * @method option\n             * @grammar option( key ) => *\n             * @grammar option( key, val ) => self\n             * @example\n             *\n             * // 初始状态图片上传前不会压缩\n             * var uploader = new WebUploader.Uploader({\n             *     compress: null;\n             * });\n             *\n             * // 修改后图片上传前，尝试将图片压缩到1600 * 1600\n             * uploader.option( 'compress', {\n             *     width: 1600,\n             *     height: 1600\n             * });\n             */\n            option: function( key, val ) {\n                var opts = this.options;\n\n                // setter\n                if ( arguments.length > 1 ) {\n\n                    if ( $.isPlainObject( val ) &&\n                            $.isPlainObject( opts[ key ] ) ) {\n                        $.extend( opts[ key ], val );\n                    } else {\n                        opts[ key ] = val;\n                    }\n\n                } else {    // getter\n                    return key ? opts[ key ] : opts;\n                }\n            },\n\n            /**\n             * 获取文件统计信息。返回一个包含一下信息的对象。\n             * * `successNum` 上传成功的文件数\n             * * `progressNum` 上传中的文件数\n             * * `cancelNum` 被删除的文件数\n             * * `invalidNum` 无效的文件数\n             * * `uploadFailNum` 上传失败的文件数\n             * * `queueNum` 还在队列中的文件数\n             * * `interruptNum` 被暂停的文件数\n             * @method getStats\n             * @grammar getStats() => Object\n             */\n            getStats: function() {\n                // return this._mgr.getStats.apply( this._mgr, arguments );\n                var stats = this.request('get-stats');\n\n                return stats ? {\n                    successNum: stats.numOfSuccess,\n                    progressNum: stats.numOfProgress,\n\n                    // who care?\n                    // queueFailNum: 0,\n                    cancelNum: stats.numOfCancel,\n                    invalidNum: stats.numOfInvalid,\n                    uploadFailNum: stats.numOfUploadFailed,\n                    queueNum: stats.numOfQueue,\n                    interruptNum: stats.numofInterrupt\n                } : {};\n            },\n\n            // 需要重写此方法来来支持opts.onEvent和instance.onEvent的处理器\n            trigger: function( type/*, args...*/ ) {\n                var args = [].slice.call( arguments, 1 ),\n                    opts = this.options,\n                    name = 'on' + type.substring( 0, 1 ).toUpperCase() +\n                        type.substring( 1 );\n\n                if (\n                        // 调用通过on方法注册的handler.\n                        Mediator.trigger.apply( this, arguments ) === false ||\n\n                        // 调用opts.onEvent\n                        $.isFunction( opts[ name ] ) &&\n                        opts[ name ].apply( this, args ) === false ||\n\n                        // 调用this.onEvent\n                        $.isFunction( this[ name ] ) &&\n                        this[ name ].apply( this, args ) === false ||\n\n                        // 广播所有uploader的事件。\n                        Mediator.trigger.apply( Mediator,\n                        [ this, type ].concat( args ) ) === false ) {\n\n                    return false;\n                }\n\n                return true;\n            },\n\n            /**\n             * 销毁 webuploader 实例\n             * @method destroy\n             * @grammar destroy() => undefined\n             */\n            destroy: function() {\n                this.request( 'destroy', arguments );\n                this.off();\n            },\n\n            // widgets/widget.js将补充此方法的详细文档。\n            request: Base.noop\n        });\n\n        /**\n         * 创建Uploader实例，等同于new Uploader( opts );\n         * @method create\n         * @class Base\n         * @static\n         * @grammar Base.create( opts ) => Uploader\n         */\n        Base.create = Uploader.create = function( opts ) {\n            return new Uploader( opts );\n        };\n\n        // 暴露Uploader，可以通过它来扩展业务逻辑。\n        Base.Uploader = Uploader;\n\n        return Uploader;\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/runtime',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$,\n            factories = {},\n\n            // 获取对象的第一个key\n            getFirstKey = function( obj ) {\n                for ( var key in obj ) {\n                    if ( obj.hasOwnProperty( key ) ) {\n                        return key;\n                    }\n                }\n                return null;\n            };\n\n        // 接口类。\n        function Runtime( options ) {\n            this.options = $.extend({\n                container: document.body\n            }, options );\n            this.uid = Base.guid('rt_');\n        }\n\n        $.extend( Runtime.prototype, {\n\n            getContainer: function() {\n                var opts = this.options,\n                    parent, container;\n\n                if ( this._container ) {\n                    return this._container;\n                }\n\n                parent = $( opts.container || document.body );\n                container = $( document.createElement('div') );\n\n                container.attr( 'id', 'rt_' + this.uid );\n                container.css({\n                    position: 'absolute',\n                    top: '0px',\n                    left: '0px',\n                    width: '1px',\n                    height: '1px',\n                    overflow: 'hidden'\n                });\n\n                parent.append( container );\n                parent.addClass('webuploader-container');\n                this._container = container;\n                this._parent = parent;\n                return container;\n            },\n\n            init: Base.noop,\n            exec: Base.noop,\n\n            destroy: function() {\n                this._container && this._container.remove();\n                this._parent && this._parent.removeClass('webuploader-container');\n                this.off();\n            }\n        });\n\n        Runtime.orders = 'html5,flash';\n\n\n        /**\n         * 添加Runtime实现。\n         * @param {String} type    类型\n         * @param {Runtime} factory 具体Runtime实现。\n         */\n        Runtime.addRuntime = function( type, factory ) {\n            factories[ type ] = factory;\n        };\n\n        Runtime.hasRuntime = function( type ) {\n            return !!(type ? factories[ type ] : getFirstKey( factories ));\n        };\n\n        Runtime.create = function( opts, orders ) {\n            var type, runtime;\n\n            orders = orders || Runtime.orders;\n            $.each( orders.split( /\\s*,\\s*/g ), function() {\n                if ( factories[ this ] ) {\n                    type = this;\n                    return false;\n                }\n            });\n\n            type = type || getFirstKey( factories );\n            if ( !type ) {\n                throw new Error('Runtime Error');\n            }\n\n            runtime = new factories[ type ]( opts );\n            return runtime;\n        };\n\n        Mediator.installTo( Runtime.prototype );\n        return Runtime;\n    });\n\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/client',[\n        'base',\n        'mediator',\n        'runtime/runtime'\n    ], function( Base, Mediator, Runtime ) {\n\n        var cache;\n\n        cache = (function() {\n            var obj = {};\n\n            return {\n                add: function( runtime ) {\n                    obj[ runtime.uid ] = runtime;\n                },\n\n                get: function( ruid, standalone ) {\n                    var i;\n\n                    if ( ruid ) {\n                        return obj[ ruid ];\n                    }\n\n                    for ( i in obj ) {\n                        // 有些类型不能重用，比如filepicker.\n                        if ( standalone && obj[ i ].__standalone ) {\n                            continue;\n                        }\n\n                        return obj[ i ];\n                    }\n\n                    return null;\n                },\n\n                remove: function( runtime ) {\n                    delete obj[ runtime.uid ];\n                }\n            };\n        })();\n\n        function RuntimeClient( component, standalone ) {\n            var deferred = Base.Deferred(),\n                runtime;\n\n            this.uid = Base.guid('client_');\n\n            // 允许runtime没有初始化之前，注册一些方法在初始化后执行。\n            this.runtimeReady = function( cb ) {\n                return deferred.done( cb );\n            };\n\n            this.connectRuntime = function( opts, cb ) {\n\n                // already connected.\n                if ( runtime ) {\n                    throw new Error('already connected!');\n                }\n\n                deferred.done( cb );\n\n                if ( typeof opts === 'string' && cache.get( opts ) ) {\n                    runtime = cache.get( opts );\n                }\n\n                // 像filePicker只能独立存在，不能公用。\n                runtime = runtime || cache.get( null, standalone );\n\n                // 需要创建\n                if ( !runtime ) {\n                    runtime = Runtime.create( opts, opts.runtimeOrder );\n                    runtime.__promise = deferred.promise();\n                    runtime.once( 'ready', deferred.resolve );\n                    runtime.init();\n                    cache.add( runtime );\n                    runtime.__client = 1;\n                } else {\n                    // 来自cache\n                    Base.$.extend( runtime.options, opts );\n                    runtime.__promise.then( deferred.resolve );\n                    runtime.__client++;\n                }\n\n                standalone && (runtime.__standalone = standalone);\n                return runtime;\n            };\n\n            this.getRuntime = function() {\n                return runtime;\n            };\n\n            this.disconnectRuntime = function() {\n                if ( !runtime ) {\n                    return;\n                }\n\n                runtime.__client--;\n\n                if ( runtime.__client <= 0 ) {\n                    cache.remove( runtime );\n                    delete runtime.__promise;\n                    runtime.destroy();\n                }\n\n                runtime = null;\n            };\n\n            this.exec = function() {\n                if ( !runtime ) {\n                    return;\n                }\n\n                var args = Base.slice( arguments );\n                component && args.unshift( component );\n\n                return runtime.exec.apply( this, args );\n            };\n\n            this.getRuid = function() {\n                return runtime && runtime.uid;\n            };\n\n            this.destroy = (function( destroy ) {\n                return function() {\n                    destroy && destroy.apply( this, arguments );\n                    this.trigger('destroy');\n                    this.off();\n                    this.exec('destroy');\n                    this.disconnectRuntime();\n                };\n            })( this.destroy );\n        }\n\n        Mediator.installTo( RuntimeClient.prototype );\n        return RuntimeClient;\n    });\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/dnd',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n\n        var $ = Base.$;\n\n        function DragAndDrop( opts ) {\n            opts = this.options = $.extend({}, DragAndDrop.options, opts );\n\n            opts.container = $( opts.container );\n\n            if ( !opts.container.length ) {\n                return;\n            }\n\n            RuntimeClent.call( this, 'DragAndDrop' );\n        }\n\n        DragAndDrop.options = {\n            accept: null,\n            disableGlobalDnd: false\n        };\n\n        Base.inherits( RuntimeClent, {\n            constructor: DragAndDrop,\n\n            init: function() {\n                var me = this;\n\n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n\n        Mediator.installTo( DragAndDrop.prototype );\n\n        return DragAndDrop;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/widget',[\n        'base',\n        'uploader'\n    ], function( Base, Uploader ) {\n\n        var $ = Base.$,\n            _init = Uploader.prototype._init,\n            _destroy = Uploader.prototype.destroy,\n            IGNORE = {},\n            widgetClass = [];\n\n        function isArrayLike( obj ) {\n            if ( !obj ) {\n                return false;\n            }\n\n            var length = obj.length,\n                type = $.type( obj );\n\n            if ( obj.nodeType === 1 && length ) {\n                return true;\n            }\n\n            return type === 'array' || type !== 'function' && type !== 'string' &&\n                    (length === 0 || typeof length === 'number' && length > 0 &&\n                    (length - 1) in obj);\n        }\n\n        function Widget( uploader ) {\n            this.owner = uploader;\n            this.options = uploader.options;\n        }\n\n        $.extend( Widget.prototype, {\n\n            init: Base.noop,\n\n            // 类Backbone的事件监听声明，监听uploader实例上的事件\n            // widget直接无法监听事件，事件只能通过uploader来传递\n            invoke: function( apiName, args ) {\n\n                /*\n                    {\n                        'make-thumb': 'makeThumb'\n                    }\n                 */\n                var map = this.responseMap;\n\n                // 如果无API响应声明则忽略\n                if ( !map || !(apiName in map) || !(map[ apiName ] in this) ||\n                        !$.isFunction( this[ map[ apiName ] ] ) ) {\n\n                    return IGNORE;\n                }\n\n                return this[ map[ apiName ] ].apply( this, args );\n\n            },\n\n            /**\n             * 发送命令。当传入`callback`或者`handler`中返回`promise`时。返回一个当所有`handler`中的promise都完成后完成的新`promise`。\n             * @method request\n             * @grammar request( command, args ) => * | Promise\n             * @grammar request( command, args, callback ) => Promise\n             * @for  Uploader\n             */\n            request: function() {\n                return this.owner.request.apply( this.owner, arguments );\n            }\n        });\n\n        // 扩展Uploader.\n        $.extend( Uploader.prototype, {\n\n            /**\n             * @property {String | Array} [disableWidgets=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 默认所有 Uploader.register 了的 widget 都会被加载，如果禁用某一部分，请通过此 option 指定黑名单。\n             */\n\n            // 覆写_init用来初始化widgets\n            _init: function() {\n                var me = this,\n                    widgets = me._widgets = [],\n                    deactives = me.options.disableWidgets || '';\n\n                $.each( widgetClass, function( _, klass ) {\n                    (!deactives || !~deactives.indexOf( klass._name )) &&\n                        widgets.push( new klass( me ) );\n                });\n\n                return _init.apply( me, arguments );\n            },\n\n            request: function( apiName, args, callback ) {\n                var i = 0,\n                    widgets = this._widgets,\n                    len = widgets && widgets.length,\n                    rlts = [],\n                    dfds = [],\n                    widget, rlt, promise, key;\n\n                args = isArrayLike( args ) ? args : [ args ];\n\n                for ( ; i < len; i++ ) {\n                    widget = widgets[ i ];\n                    rlt = widget.invoke( apiName, args );\n\n                    if ( rlt !== IGNORE ) {\n\n                        // Deferred对象\n                        if ( Base.isPromise( rlt ) ) {\n                            dfds.push( rlt );\n                        } else {\n                            rlts.push( rlt );\n                        }\n                    }\n                }\n\n                // 如果有callback，则用异步方式。\n                if ( callback || dfds.length ) {\n                    promise = Base.when.apply( Base, dfds );\n                    key = promise.pipe ? 'pipe' : 'then';\n\n                    // 很重要不能删除。删除了会死循环。\n                    // 保证执行顺序。让callback总是在下一个 tick 中执行。\n                    return promise[ key ](function() {\n                                var deferred = Base.Deferred(),\n                                    args = arguments;\n\n                                if ( args.length === 1 ) {\n                                    args = args[ 0 ];\n                                }\n\n                                setTimeout(function() {\n                                    deferred.resolve( args );\n                                }, 1 );\n\n                                return deferred.promise();\n                            })[ callback ? key : 'done' ]( callback || Base.noop );\n                } else {\n                    return rlts[ 0 ];\n                }\n            },\n\n            destroy: function() {\n                _destroy.apply( this, arguments );\n                this._widgets = null;\n            }\n        });\n\n        /**\n         * 添加组件\n         * @grammar Uploader.register(proto);\n         * @grammar Uploader.register(map, proto);\n         * @param  {object} responseMap API 名称与函数实现的映射\n         * @param  {object} proto 组件原型，构造函数通过 constructor 属性定义\n         * @method Uploader.register\n         * @for Uploader\n         * @example\n         * Uploader.register({\n         *     'make-thumb': 'makeThumb'\n         * }, {\n         *     init: function( options ) {},\n         *     makeThumb: function() {}\n         * });\n         *\n         * Uploader.register({\n         *     'make-thumb': function() {\n         *\n         *     }\n         * });\n         */\n        Uploader.register = Widget.register = function( responseMap, widgetProto ) {\n            var map = { init: 'init', destroy: 'destroy', name: 'anonymous' },\n                klass;\n\n            if ( arguments.length === 1 ) {\n                widgetProto = responseMap;\n\n                // 自动生成 map 表。\n                $.each(widgetProto, function(key) {\n                    if ( key[0] === '_' || key === 'name' ) {\n                        key === 'name' && (map.name = widgetProto.name);\n                        return;\n                    }\n\n                    map[key.replace(/[A-Z]/g, '-$&').toLowerCase()] = key;\n                });\n\n            } else {\n                map = $.extend( map, responseMap );\n            }\n\n            widgetProto.responseMap = map;\n            klass = Base.inherits( Widget, widgetProto );\n            klass._name = map.name;\n            widgetClass.push( klass );\n\n            return klass;\n        };\n\n        /**\n         * 删除插件，只有在注册时指定了名字的才能被删除。\n         * @grammar Uploader.unRegister(name);\n         * @param  {string} name 组件名字\n         * @method Uploader.unRegister\n         * @for Uploader\n         * @example\n         *\n         * Uploader.register({\n         *     name: 'custom',\n         *\n         *     'make-thumb': function() {\n         *\n         *     }\n         * });\n         *\n         * Uploader.unRegister('custom');\n         */\n        Uploader.unRegister = Widget.unRegister = function( name ) {\n            if ( !name || name === 'anonymous' ) {\n                return;\n            }\n\n            // 删除指定的插件。\n            for ( var i = widgetClass.length; i--; ) {\n                if ( widgetClass[i]._name === name ) {\n                    widgetClass.splice(i, 1)\n                }\n            }\n        };\n\n        return Widget;\n    });\n    /**\n     * @fileOverview DragAndDrop Widget。\n     */\n    define('widgets/filednd',[\n        'base',\n        'uploader',\n        'lib/dnd',\n        'widgets/widget'\n    ], function( Base, Uploader, Dnd ) {\n        var $ = Base.$;\n\n        Uploader.options.dnd = '';\n\n        /**\n         * @property {Selector} [dnd=undefined]  指定Drag And Drop拖拽的容器，如果不指定，则不启动。\n         * @namespace options\n         * @for Uploader\n         */\n\n        /**\n         * @property {Selector} [disableGlobalDnd=false]  是否禁掉整个页面的拖拽功能，如果不禁用，图片拖进来的时候会默认被浏览器打开。\n         * @namespace options\n         * @for Uploader\n         */\n\n        /**\n         * @event dndAccept\n         * @param {DataTransferItemList} items DataTransferItem\n         * @description 阻止此事件可以拒绝某些类型的文件拖入进来。目前只有 chrome 提供这样的 API，且只能通过 mime-type 验证。\n         * @for  Uploader\n         */\n        return Uploader.register({\n            name: 'dnd',\n\n            init: function( opts ) {\n\n                if ( !opts.dnd ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        disableGlobalDnd: opts.disableGlobalDnd,\n                        container: opts.dnd,\n                        accept: opts.accept\n                    }),\n                    dnd;\n\n                this.dnd = dnd = new Dnd( options );\n\n                dnd.once( 'ready', deferred.resolve );\n                dnd.on( 'drop', function( files ) {\n                    me.request( 'add-file', [ files ]);\n                });\n\n                // 检测文件是否全部允许添加。\n                dnd.on( 'accept', function( items ) {\n                    return me.owner.trigger( 'dndAccept', items );\n                });\n\n                dnd.init();\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                this.dnd && this.dnd.destroy();\n            }\n        });\n    });\n\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepaste',[\n        'base',\n        'mediator',\n        'runtime/client'\n    ], function( Base, Mediator, RuntimeClent ) {\n\n        var $ = Base.$;\n\n        function FilePaste( opts ) {\n            opts = this.options = $.extend({}, opts );\n            opts.container = $( opts.container || document.body );\n            RuntimeClent.call( this, 'FilePaste' );\n        }\n\n        Base.inherits( RuntimeClent, {\n            constructor: FilePaste,\n\n            init: function() {\n                var me = this;\n\n                me.connectRuntime( me.options, function() {\n                    me.exec('init');\n                    me.trigger('ready');\n                });\n            }\n        });\n\n        Mediator.installTo( FilePaste.prototype );\n\n        return FilePaste;\n    });\n    /**\n     * @fileOverview 组件基类。\n     */\n    define('widgets/filepaste',[\n        'base',\n        'uploader',\n        'lib/filepaste',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePaste ) {\n        var $ = Base.$;\n\n        /**\n         * @property {Selector} [paste=undefined]  指定监听paste事件的容器，如果不指定，不启用此功能。此功能为通过粘贴来添加截屏的图片。建议设置为`document.body`.\n         * @namespace options\n         * @for Uploader\n         */\n        return Uploader.register({\n            name: 'paste',\n\n            init: function( opts ) {\n\n                if ( !opts.paste ||\n                        this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                var me = this,\n                    deferred = Base.Deferred(),\n                    options = $.extend({}, {\n                        container: opts.paste,\n                        accept: opts.accept\n                    }),\n                    paste;\n\n                this.paste = paste = new FilePaste( options );\n\n                paste.once( 'ready', deferred.resolve );\n                paste.on( 'paste', function( files ) {\n                    me.owner.request( 'add-file', [ files ]);\n                });\n                paste.init();\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                this.paste && this.paste.destroy();\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob\n     */\n    define('lib/blob',[\n        'base',\n        'runtime/client'\n    ], function( Base, RuntimeClient ) {\n\n        function Blob( ruid, source ) {\n            var me = this;\n\n            me.source = source;\n            me.ruid = ruid;\n            this.size = source.size || 0;\n\n            // 如果没有指定 mimetype, 但是知道文件后缀。\n            if ( !source.type && this.ext &&\n                    ~'jpg,jpeg,png,gif,bmp'.indexOf( this.ext ) ) {\n                this.type = 'image/' + (this.ext === 'jpg' ? 'jpeg' : this.ext);\n            } else {\n                this.type = source.type || 'application/octet-stream';\n            }\n\n            RuntimeClient.call( me, 'Blob' );\n            this.uid = source.uid || this.uid;\n\n            if ( ruid ) {\n                me.connectRuntime( ruid );\n            }\n        }\n\n        Base.inherits( RuntimeClient, {\n            constructor: Blob,\n\n            slice: function( start, end ) {\n                return this.exec( 'slice', start, end );\n            },\n\n            getSource: function() {\n                return this.source;\n            }\n        });\n\n        return Blob;\n    });\n    /**\n     * 为了统一化Flash的File和HTML5的File而存在。\n     * 以至于要调用Flash里面的File，也可以像调用HTML5版本的File一下。\n     * @fileOverview File\n     */\n    define('lib/file',[\n        'base',\n        'lib/blob'\n    ], function( Base, Blob ) {\n\n        var uid = 1,\n            rExt = /\\.([^.]+)$/;\n\n        function File( ruid, file ) {\n            var ext;\n\n            this.name = file.name || ('untitled' + uid++);\n            ext = rExt.exec( file.name ) ? RegExp.$1.toLowerCase() : '';\n\n            // todo 支持其他类型文件的转换。\n            // 如果有 mimetype, 但是文件名里面没有找出后缀规律\n            if ( !ext && file.type ) {\n                ext = /\\/(jpg|jpeg|png|gif|bmp)$/i.exec( file.type ) ?\n                        RegExp.$1.toLowerCase() : '';\n                this.name += '.' + ext;\n            }\n\n            this.ext = ext;\n            this.lastModifiedDate = file.lastModifiedDate ||\n                    (new Date()).toLocaleString();\n\n            Blob.apply( this, arguments );\n        }\n\n        return Base.inherits( Blob, File );\n    });\n\n    /**\n     * @fileOverview 错误信息\n     */\n    define('lib/filepicker',[\n        'base',\n        'runtime/client',\n        'lib/file'\n    ], function( Base, RuntimeClent, File ) {\n\n        var $ = Base.$;\n\n        function FilePicker( opts ) {\n            opts = this.options = $.extend({}, FilePicker.options, opts );\n\n            opts.container = $( opts.id );\n\n            if ( !opts.container.length ) {\n                throw new Error('按钮指定错误');\n            }\n\n            opts.innerHTML = opts.innerHTML || opts.label ||\n                    opts.container.html() || '';\n\n            opts.button = $( opts.button || document.createElement('div') );\n            opts.button.html( opts.innerHTML );\n            opts.container.html( opts.button );\n\n            RuntimeClent.call( this, 'FilePicker', true );\n        }\n\n        FilePicker.options = {\n            button: null,\n            container: null,\n            label: null,\n            innerHTML: null,\n            multiple: true,\n            accept: null,\n            name: 'file'\n        };\n\n        Base.inherits( RuntimeClent, {\n            constructor: FilePicker,\n\n            init: function() {\n                var me = this,\n                    opts = me.options,\n                    button = opts.button;\n\n                button.addClass('webuploader-pick');\n\n                me.on( 'all', function( type ) {\n                    var files;\n\n                    switch ( type ) {\n                        case 'mouseenter':\n                            button.addClass('webuploader-pick-hover');\n                            break;\n\n                        case 'mouseleave':\n                            button.removeClass('webuploader-pick-hover');\n                            break;\n\n                        case 'change':\n                            files = me.exec('getFiles');\n                            me.trigger( 'select', $.map( files, function( file ) {\n                                file = new File( me.getRuid(), file );\n\n                                // 记录来源。\n                                file._refer = opts.container;\n                                return file;\n                            }), opts.container );\n                            break;\n                    }\n                });\n\n                me.connectRuntime( opts, function() {\n                    me.refresh();\n                    me.exec( 'init', opts );\n                    me.trigger('ready');\n                });\n\n                this._resizeHandler = Base.bindFn( this.refresh, this );\n                $( window ).on( 'resize', this._resizeHandler );\n            },\n\n            refresh: function() {\n                var shimContainer = this.getRuntime().getContainer(),\n                    button = this.options.button,\n                    width = button.outerWidth ?\n                            button.outerWidth() : button.width(),\n\n                    height = button.outerHeight ?\n                            button.outerHeight() : button.height(),\n\n                    pos = button.offset();\n\n                width && height && shimContainer.css({\n                    bottom: 'auto',\n                    right: 'auto',\n                    width: width + 'px',\n                    height: height + 'px'\n                }).offset( pos );\n            },\n\n            enable: function() {\n                var btn = this.options.button;\n\n                btn.removeClass('webuploader-pick-disable');\n                this.refresh();\n            },\n\n            disable: function() {\n                var btn = this.options.button;\n\n                this.getRuntime().getContainer().css({\n                    top: '-99999px'\n                });\n\n                btn.addClass('webuploader-pick-disable');\n            },\n\n            destroy: function() {\n                var btn = this.options.button;\n                $( window ).off( 'resize', this._resizeHandler );\n                btn.removeClass('webuploader-pick-disable webuploader-pick-hover ' +\n                    'webuploader-pick');\n            }\n        });\n\n        return FilePicker;\n    });\n\n    /**\n     * @fileOverview 文件选择相关\n     */\n    define('widgets/filepicker',[\n        'base',\n        'uploader',\n        'lib/filepicker',\n        'widgets/widget'\n    ], function( Base, Uploader, FilePicker ) {\n        var $ = Base.$;\n\n        $.extend( Uploader.options, {\n\n            /**\n             * @property {Selector | Object} [pick=undefined]\n             * @namespace options\n             * @for Uploader\n             * @description 指定选择文件的按钮容器，不指定则不创建按钮。\n             *\n             * * `id` {Seletor|dom} 指定选择文件的按钮容器，不指定则不创建按钮。**注意** 这里虽然写的是 id, 但是不是只支持 id, 还支持 class, 或者 dom 节点。\n             * * `label` {String} 请采用 `innerHTML` 代替\n             * * `innerHTML` {String} 指定按钮文字。不指定时优先从指定的容器中看是否自带文字。\n             * * `multiple` {Boolean} 是否开起同时选择多个文件能力。\n             */\n            pick: null,\n\n            /**\n             * @property {Arroy} [accept=null]\n             * @namespace options\n             * @for Uploader\n             * @description 指定接受哪些类型的文件。 由于目前还有ext转mimeType表，所以这里需要分开指定。\n             *\n             * * `title` {String} 文字描述\n             * * `extensions` {String} 允许的文件后缀，不带点，多个用逗号分割。\n             * * `mimeTypes` {String} 多个用逗号分割。\n             *\n             * 如：\n             *\n             * ```\n             * {\n             *     title: 'Images',\n             *     extensions: 'gif,jpg,jpeg,bmp,png',\n             *     mimeTypes: 'image/*'\n             * }\n             * ```\n             */\n            accept: null/*{\n                title: 'Images',\n                extensions: 'gif,jpg,jpeg,bmp,png',\n                mimeTypes: 'image/*'\n            }*/\n        });\n\n        return Uploader.register({\n            name: 'picker',\n\n            init: function( opts ) {\n                this.pickers = [];\n                return opts.pick && this.addBtn( opts.pick );\n            },\n\n            refresh: function() {\n                $.each( this.pickers, function() {\n                    this.refresh();\n                });\n            },\n\n            /**\n             * @method addButton\n             * @for Uploader\n             * @grammar addButton( pick ) => Promise\n             * @description\n             * 添加文件选择按钮，如果一个按钮不够，需要调用此方法来添加。参数跟[options.pick](#WebUploader:Uploader:options)一致。\n             * @example\n             * uploader.addButton({\n             *     id: '#btnContainer',\n             *     innerHTML: '选择文件'\n             * });\n             */\n            addBtn: function( pick ) {\n                var me = this,\n                    opts = me.options,\n                    accept = opts.accept,\n                    promises = [];\n\n                if ( !pick ) {\n                    return;\n                }\n\n                $.isPlainObject( pick ) || (pick = {\n                    id: pick\n                });\n\n                $( pick.id ).each(function() {\n                    var options, picker, deferred;\n\n                    deferred = Base.Deferred();\n\n                    options = $.extend({}, pick, {\n                        accept: $.isPlainObject( accept ) ? [ accept ] : accept,\n                        swf: opts.swf,\n                        runtimeOrder: opts.runtimeOrder,\n                        id: this\n                    });\n\n                    picker = new FilePicker( options );\n\n                    picker.once( 'ready', deferred.resolve );\n                    picker.on( 'select', function( files ) {\n                        me.owner.request( 'add-file', [ files ]);\n                    });\n                    picker.init();\n\n                    me.pickers.push( picker );\n\n                    promises.push( deferred.promise() );\n                });\n\n                return Base.when.apply( Base, promises );\n            },\n\n            disable: function() {\n                $.each( this.pickers, function() {\n                    this.disable();\n                });\n            },\n\n            enable: function() {\n                $.each( this.pickers, function() {\n                    this.enable();\n                });\n            },\n\n            destroy: function() {\n                $.each( this.pickers, function() {\n                    this.destroy();\n                });\n                this.pickers = null;\n            }\n        });\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('lib/image',[\n        'base',\n        'runtime/client',\n        'lib/blob'\n    ], function( Base, RuntimeClient, Blob ) {\n        var $ = Base.$;\n\n        // 构造器。\n        function Image( opts ) {\n            this.options = $.extend({}, Image.options, opts );\n            RuntimeClient.call( this, 'Image' );\n\n            this.on( 'load', function() {\n                this._info = this.exec('info');\n                this._meta = this.exec('meta');\n            });\n        }\n\n        // 默认选项。\n        Image.options = {\n\n            // 默认的图片处理质量\n            quality: 90,\n\n            // 是否裁剪\n            crop: false,\n\n            // 是否保留头部信息\n            preserveHeaders: false,\n\n            // 是否允许放大。\n            allowMagnify: false\n        };\n\n        // 继承RuntimeClient.\n        Base.inherits( RuntimeClient, {\n            constructor: Image,\n\n            info: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n\n                // getter\n                return this._info;\n            },\n\n            meta: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n\n                // getter\n                return this._meta;\n            },\n\n            loadFromBlob: function( blob ) {\n                var me = this,\n                    ruid = blob.getRuid();\n\n                this.connectRuntime( ruid, function() {\n                    me.exec( 'init', me.options );\n                    me.exec( 'loadFromBlob', blob );\n                });\n            },\n\n            resize: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'resize' ].concat( args ) );\n            },\n\n            crop: function() {\n                var args = Base.slice( arguments );\n                return this.exec.apply( this, [ 'crop' ].concat( args ) );\n            },\n\n            getAsDataUrl: function( type ) {\n                return this.exec( 'getAsDataUrl', type );\n            },\n\n            getAsBlob: function( type ) {\n                var blob = this.exec( 'getAsBlob', type );\n\n                return new Blob( this.getRuid(), blob );\n            }\n        });\n\n        return Image;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/image',[\n        'base',\n        'uploader',\n        'lib/image',\n        'widgets/widget'\n    ], function( Base, Uploader, Image ) {\n\n        var $ = Base.$,\n            throttle;\n\n        // 根据要处理的文件大小来节流，一次不能处理太多，会卡。\n        throttle = (function( max ) {\n            var occupied = 0,\n                waiting = [],\n                tick = function() {\n                    var item;\n\n                    while ( waiting.length && occupied < max ) {\n                        item = waiting.shift();\n                        occupied += item[ 0 ];\n                        item[ 1 ]();\n                    }\n                };\n\n            return function( emiter, size, cb ) {\n                waiting.push([ size, cb ]);\n                emiter.once( 'destroy', function() {\n                    occupied -= size;\n                    setTimeout( tick, 1 );\n                });\n                setTimeout( tick, 1 );\n            };\n        })( 5 * 1024 * 1024 );\n\n        $.extend( Uploader.options, {\n\n            /**\n             * @property {Object} [thumb]\n             * @namespace options\n             * @for Uploader\n             * @description 配置生成缩略图的选项。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 110,\n             *     height: 110,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 70,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: true,\n             *\n             *     // 是否允许裁剪。\n             *     crop: true,\n             *\n             *     // 为空的话则保留原有图片格式。\n             *     // 否则强制转换成指定的类型。\n             *     type: 'image/jpeg'\n             * }\n             * ```\n             */\n            thumb: {\n                width: 110,\n                height: 110,\n                quality: 70,\n                allowMagnify: true,\n                crop: true,\n                preserveHeaders: false,\n\n                // 为空的话则保留原有图片格式。\n                // 否则强制转换成指定的类型。\n                // IE 8下面 base64 大小不能超过 32K 否则预览失败，而非 jpeg 编码的图片很可\n                // 能会超过 32k, 所以这里设置成预览的时候都是 image/jpeg\n                type: 'image/jpeg'\n            },\n\n            /**\n             * @property {Object} [compress]\n             * @namespace options\n             * @for Uploader\n             * @description 配置压缩的图片的选项。如果此选项为`false`, 则图片在上传前不进行压缩。\n             *\n             * 默认为：\n             *\n             * ```javascript\n             * {\n             *     width: 1600,\n             *     height: 1600,\n             *\n             *     // 图片质量，只有type为`image/jpeg`的时候才有效。\n             *     quality: 90,\n             *\n             *     // 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\n             *     allowMagnify: false,\n             *\n             *     // 是否允许裁剪。\n             *     crop: false,\n             *\n             *     // 是否保留头部meta信息。\n             *     preserveHeaders: true,\n             *\n             *     // 如果发现压缩后文件大小比原来还大，则使用原来图片\n             *     // 此属性可能会影响图片自动纠正功能\n             *     noCompressIfLarger: false,\n             *\n             *     // 单位字节，如果图片大小小于此值，不会采用压缩。\n             *     compressSize: 0\n             * }\n             * ```\n             */\n            compress: {\n                width: 1600,\n                height: 1600,\n                quality: 90,\n                allowMagnify: false,\n                crop: false,\n                preserveHeaders: true\n            }\n        });\n\n        return Uploader.register({\n\n            name: 'image',\n\n\n            /**\n             * 生成缩略图，此过程为异步，所以需要传入`callback`。\n             * 通常情况在图片加入队里后调用此方法来生成预览图以增强交互效果。\n             *\n             * 当 width 或者 height 的值介于 0 - 1 时，被当成百分比使用。\n             *\n             * `callback`中可以接收到两个参数。\n             * * 第一个为error，如果生成缩略图有错误，此error将为真。\n             * * 第二个为ret, 缩略图的Data URL值。\n             *\n             * **注意**\n             * Date URL在IE6/7中不支持，所以不用调用此方法了，直接显示一张暂不支持预览图片好了。\n             * 也可以借助服务端，将 base64 数据传给服务端，生成一个临时文件供预览。\n             *\n             * @method makeThumb\n             * @grammar makeThumb( file, callback ) => undefined\n             * @grammar makeThumb( file, callback, width, height ) => undefined\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.makeThumb( file, function( error, ret ) {\n             *         if ( error ) {\n             *             $li.text('预览错误');\n             *         } else {\n             *             $li.append('<img alt=\"\" src=\"' + ret + '\" />');\n             *         }\n             *     });\n             *\n             * });\n             */\n            makeThumb: function( file, cb, width, height ) {\n                var opts, image;\n                var isArtwork = false;\n                file = this.request( 'get-file', file );\n\n                // 只预览图片格式。\n                if ( !file.type.match( /^image/ ) ) {\n                    cb( true );\n                    return;\n                }\n\n                opts = $.extend({}, this.options.thumb );\n                isArtwork = $.isPlainObject( this.options.thumb ) ? false : true;\n                // 如果传入的是object.\n                if ( $.isPlainObject( width ) ) {\n                    opts = $.extend( opts, width );\n                    width = null;\n                }\n\n                width = width || opts.width;\n                height = height || opts.height;\n\n                image = new Image( opts );\n\n                image.once( 'load', function() {\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n\n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n\n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n                    if( isArtwork ){\n                        image.resize( file._info.width, file._info.height );\n\n                    }else{\n                        image.resize( width, height );\n\n\n                    }\n\n                });\n\n                // 当 resize 完后\n                image.once( 'complete', function() {\n                    cb( false, image.getAsDataUrl( opts.type ) );\n                    image.destroy();\n                });\n\n                image.once( 'error', function( reason ) {\n                    cb( reason || true );\n                    image.destroy();\n                });\n\n                throttle( image, file.source.size, function() {\n                    file._info && image.info( file._info );\n                    file._meta && image.meta( file._meta );\n                    image.loadFromBlob( file.source );\n                });\n            },\n\n            beforeSendFile: function( file ) {\n                var opts = this.options.compress || this.options.resize,\n                    compressSize = opts && opts.compressSize || 0,\n                    noCompressIfLarger = opts && opts.noCompressIfLarger || false,\n                    image, deferred;\n\n                file = this.request( 'get-file', file );\n\n                // 只压缩 jpeg 图片格式。\n                // gif 可能会丢失针\n                // bmp png 基本上尺寸都不大，且压缩比比较小。\n                if ( !opts || !~'image/jpeg,image/jpg'.indexOf( file.type ) ||\n                        file.size < compressSize ||\n                        file._compressed ) {\n                    return;\n                }\n\n                opts = $.extend({}, opts );\n                deferred = Base.Deferred();\n\n                image = new Image( opts );\n\n                deferred.always(function() {\n                    image.destroy();\n                    image = null;\n                });\n                image.once( 'error', deferred.reject );\n                image.once( 'load', function() {\n                    var width = opts.width,\n                        height = opts.height;\n\n                    file._info = file._info || image.info();\n                    file._meta = file._meta || image.meta();\n\n                    // 如果 width 的值介于 0 - 1\n                    // 说明设置的是百分比。\n                    if ( width <= 1 && width > 0 ) {\n                        width = file._info.width * width;\n                    }\n\n                    // 同样的规则应用于 height\n                    if ( height <= 1 && height > 0 ) {\n                        height = file._info.height * height;\n                    }\n\n                    image.resize( width, height );\n                });\n\n                image.once( 'complete', function() {\n                    var blob, size;\n\n                    // 移动端 UC / qq 浏览器的无图模式下\n                    // ctx.getImageData 处理大图的时候会报 Exception\n                    // INDEX_SIZE_ERR: DOM Exception 1\n                    try {\n                        blob = image.getAsBlob( opts.type );\n\n                        size = file.size;\n\n                        // 如果压缩后，比原来还大则不用压缩后的。\n                        if ( !noCompressIfLarger || blob.size < size ) {\n                            // file.source.destroy && file.source.destroy();\n                            file.source = blob;\n                            file.size = blob.size;\n\n                            file.trigger( 'resize', blob.size, size );\n                        }\n\n                        // 标记，避免重复压缩。\n                        file._compressed = true;\n                        deferred.resolve();\n                    } catch ( e ) {\n                        // 出错了直接继续，让其上传原始图片\n                        deferred.resolve();\n                    }\n                });\n\n                file._info && image.info( file._info );\n                file._meta && image.meta( file._meta );\n\n                image.loadFromBlob( file.source );\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview 文件属性封装\n     */\n    define('file',[\n        'base',\n        'mediator'\n    ], function( Base, Mediator ) {\n\n        var $ = Base.$,\n            idPrefix = 'WU_FILE_',\n            idSuffix = 0,\n            rExt = /\\.([^.]+)$/,\n            statusMap = {};\n\n        function gid() {\n            return idPrefix + idSuffix++;\n        }\n\n        /**\n         * 文件类\n         * @class File\n         * @constructor 构造函数\n         * @grammar new File( source ) => File\n         * @param {Lib.File} source [lib.File](#Lib.File)实例, 此source对象是带有Runtime信息的。\n         */\n        function WUFile( source ) {\n\n            /**\n             * 文件名，包括扩展名（后缀）\n             * @property name\n             * @type {string}\n             */\n            this.name = source.name || 'Untitled';\n\n            /**\n             * 文件体积（字节）\n             * @property size\n             * @type {uint}\n             * @default 0\n             */\n            this.size = source.size || 0;\n\n            /**\n             * 文件MIMETYPE类型，与文件类型的对应关系请参考[http://t.cn/z8ZnFny](http://t.cn/z8ZnFny)\n             * @property type\n             * @type {string}\n             * @default 'application/octet-stream'\n             */\n            this.type = source.type || 'application/octet-stream';\n\n            /**\n             * 文件最后修改日期\n             * @property lastModifiedDate\n             * @type {int}\n             * @default 当前时间戳\n             */\n            this.lastModifiedDate = source.lastModifiedDate || (new Date() * 1);\n\n            /**\n             * 文件ID，每个对象具有唯一ID，与文件名无关\n             * @property id\n             * @type {string}\n             */\n            this.id = gid();\n\n            /**\n             * 文件扩展名，通过文件名获取，例如test.png的扩展名为png\n             * @property ext\n             * @type {string}\n             */\n            this.ext = rExt.exec( this.name ) ? RegExp.$1 : '';\n\n\n            /**\n             * 状态文字说明。在不同的status语境下有不同的用途。\n             * @property statusText\n             * @type {string}\n             */\n            this.statusText = '';\n\n            // 存储文件状态，防止通过属性直接修改\n            statusMap[ this.id ] = WUFile.Status.INITED;\n\n            this.source = source;\n            this.loaded = 0;\n\n            this.on( 'error', function( msg ) {\n                this.setStatus( WUFile.Status.ERROR, msg );\n            });\n        }\n\n        $.extend( WUFile.prototype, {\n\n            /**\n             * 设置状态，状态变化时会触发`change`事件。\n             * @method setStatus\n             * @grammar setStatus( status[, statusText] );\n             * @param {File.Status|String} status [文件状态值](#WebUploader:File:File.Status)\n             * @param {String} [statusText=''] 状态说明，常在error时使用，用http, abort,server等来标记是由于什么原因导致文件错误。\n             */\n            setStatus: function( status, text ) {\n\n                var prevStatus = statusMap[ this.id ];\n\n                typeof text !== 'undefined' && (this.statusText = text);\n\n                if ( status !== prevStatus ) {\n                    statusMap[ this.id ] = status;\n                    /**\n                     * 文件状态变化\n                     * @event statuschange\n                     */\n                    this.trigger( 'statuschange', status, prevStatus );\n                }\n\n            },\n\n            /**\n             * 获取文件状态\n             * @return {File.Status}\n             * @example\n                     文件状态具体包括以下几种类型：\n                     {\n                         // 初始化\n                        INITED:     0,\n                        // 已入队列\n                        QUEUED:     1,\n                        // 正在上传\n                        PROGRESS:     2,\n                        // 上传出错\n                        ERROR:         3,\n                        // 上传成功\n                        COMPLETE:     4,\n                        // 上传取消\n                        CANCELLED:     5\n                    }\n             */\n            getStatus: function() {\n                return statusMap[ this.id ];\n            },\n\n            /**\n             * 获取文件原始信息。\n             * @return {*}\n             */\n            getSource: function() {\n                return this.source;\n            },\n\n            destroy: function() {\n                this.off();\n                delete statusMap[ this.id ];\n            }\n        });\n\n        Mediator.installTo( WUFile.prototype );\n\n        /**\n         * 文件状态值，具体包括以下几种类型：\n         * * `inited` 初始状态\n         * * `queued` 已经进入队列, 等待上传\n         * * `progress` 上传中\n         * * `complete` 上传完成。\n         * * `error` 上传出错，可重试\n         * * `interrupt` 上传中断，可续传。\n         * * `invalid` 文件不合格，不能重试上传。会自动从队列中移除。\n         * * `cancelled` 文件被移除。\n         * @property {Object} Status\n         * @namespace File\n         * @class File\n         * @static\n         */\n        WUFile.Status = {\n            INITED:     'inited',    // 初始状态\n            QUEUED:     'queued',    // 已经进入队列, 等待上传\n            PROGRESS:   'progress',    // 上传中\n            ERROR:      'error',    // 上传出错，可重试\n            COMPLETE:   'complete',    // 上传完成。\n            CANCELLED:  'cancelled',    // 上传取消。\n            INTERRUPT:  'interrupt',    // 上传中断，可续传。\n            INVALID:    'invalid'    // 文件不合格，不能重试上传。\n        };\n\n        return WUFile;\n    });\n\n    /**\n     * @fileOverview 文件队列\n     */\n    define('queue',[\n        'base',\n        'mediator',\n        'file'\n    ], function( Base, Mediator, WUFile ) {\n\n        var $ = Base.$,\n            STATUS = WUFile.Status;\n\n        /**\n         * 文件队列, 用来存储各个状态中的文件。\n         * @class Queue\n         * @extends Mediator\n         */\n        function Queue() {\n\n            /**\n             * 统计文件数。\n             * * `numOfQueue` 队列中的文件数。\n             * * `numOfSuccess` 上传成功的文件数\n             * * `numOfCancel` 被取消的文件数\n             * * `numOfProgress` 正在上传中的文件数\n             * * `numOfUploadFailed` 上传错误的文件数。\n             * * `numOfInvalid` 无效的文件数。\n             * * `numofDeleted` 被移除的文件数。\n             * @property {Object} stats\n             */\n            this.stats = {\n                numOfQueue: 0,\n                numOfSuccess: 0,\n                numOfCancel: 0,\n                numOfProgress: 0,\n                numOfUploadFailed: 0,\n                numOfInvalid: 0,\n                numofDeleted: 0,\n                numofInterrupt: 0\n            };\n\n            // 上传队列，仅包括等待上传的文件\n            this._queue = [];\n\n            // 存储所有文件\n            this._map = {};\n        }\n\n        $.extend( Queue.prototype, {\n\n            /**\n             * 将新文件加入对队列尾部\n             *\n             * @method append\n             * @param  {File} file   文件对象\n             */\n            append: function( file ) {\n                this._queue.push( file );\n                this._fileAdded( file );\n                return this;\n            },\n\n            /**\n             * 将新文件加入对队列头部\n             *\n             * @method prepend\n             * @param  {File} file   文件对象\n             */\n            prepend: function( file ) {\n                this._queue.unshift( file );\n                this._fileAdded( file );\n                return this;\n            },\n\n            /**\n             * 获取文件对象\n             *\n             * @method getFile\n             * @param  {String} fileId   文件ID\n             * @return {File}\n             */\n            getFile: function( fileId ) {\n                if ( typeof fileId !== 'string' ) {\n                    return fileId;\n                }\n                return this._map[ fileId ];\n            },\n\n            /**\n             * 从队列中取出一个指定状态的文件。\n             * @grammar fetch( status ) => File\n             * @method fetch\n             * @param {String} status [文件状态值](#WebUploader:File:File.Status)\n             * @return {File} [File](#WebUploader:File)\n             */\n            fetch: function( status ) {\n                var len = this._queue.length,\n                    i, file;\n\n                status = status || STATUS.QUEUED;\n\n                for ( i = 0; i < len; i++ ) {\n                    file = this._queue[ i ];\n\n                    if ( status === file.getStatus() ) {\n                        return file;\n                    }\n                }\n\n                return null;\n            },\n\n            /**\n             * 对队列进行排序，能够控制文件上传顺序。\n             * @grammar sort( fn ) => undefined\n             * @method sort\n             * @param {Function} fn 排序方法\n             */\n            sort: function( fn ) {\n                if ( typeof fn === 'function' ) {\n                    this._queue.sort( fn );\n                }\n            },\n\n            /**\n             * 获取指定类型的文件列表, 列表中每一个成员为[File](#WebUploader:File)对象。\n             * @grammar getFiles( [status1[, status2 ...]] ) => Array\n             * @method getFiles\n             * @param {String} [status] [文件状态值](#WebUploader:File:File.Status)\n             */\n            getFiles: function() {\n                var sts = [].slice.call( arguments, 0 ),\n                    ret = [],\n                    i = 0,\n                    len = this._queue.length,\n                    file;\n\n                for ( ; i < len; i++ ) {\n                    file = this._queue[ i ];\n\n                    if ( sts.length && !~$.inArray( file.getStatus(), sts ) ) {\n                        continue;\n                    }\n\n                    ret.push( file );\n                }\n\n                return ret;\n            },\n\n            /**\n             * 在队列中删除文件。\n             * @grammar removeFile( file ) => Array\n             * @method removeFile\n             * @param {File} 文件对象。\n             */\n            removeFile: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n\n                if ( existing ) {\n                    delete this._map[ file.id ];\n                    file.destroy();\n                    this.stats.numofDeleted++;\n                }\n            },\n\n            _fileAdded: function( file ) {\n                var me = this,\n                    existing = this._map[ file.id ];\n\n                if ( !existing ) {\n                    this._map[ file.id ] = file;\n\n                    file.on( 'statuschange', function( cur, pre ) {\n                        me._onFileStatusChange( cur, pre );\n                    });\n                }\n            },\n\n            _onFileStatusChange: function( curStatus, preStatus ) {\n                var stats = this.stats;\n\n                switch ( preStatus ) {\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress--;\n                        break;\n\n                    case STATUS.QUEUED:\n                        stats.numOfQueue --;\n                        break;\n\n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed--;\n                        break;\n\n                    case STATUS.INVALID:\n                        stats.numOfInvalid--;\n                        break;\n\n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt--;\n                        break;\n                }\n\n                switch ( curStatus ) {\n                    case STATUS.QUEUED:\n                        stats.numOfQueue++;\n                        break;\n\n                    case STATUS.PROGRESS:\n                        stats.numOfProgress++;\n                        break;\n\n                    case STATUS.ERROR:\n                        stats.numOfUploadFailed++;\n                        break;\n\n                    case STATUS.COMPLETE:\n                        stats.numOfSuccess++;\n                        break;\n\n                    case STATUS.CANCELLED:\n                        stats.numOfCancel++;\n                        break;\n\n\n                    case STATUS.INVALID:\n                        stats.numOfInvalid++;\n                        break;\n\n                    case STATUS.INTERRUPT:\n                        stats.numofInterrupt++;\n                        break;\n                }\n            }\n\n        });\n\n        Mediator.installTo( Queue.prototype );\n\n        return Queue;\n    });\n    /**\n     * @fileOverview 队列\n     */\n    define('widgets/queue',[\n        'base',\n        'uploader',\n        'queue',\n        'file',\n        'lib/file',\n        'runtime/client',\n        'widgets/widget'\n    ], function( Base, Uploader, Queue, WUFile, File, RuntimeClient ) {\n\n        var $ = Base.$,\n            rExt = /\\.\\w+$/,\n            Status = WUFile.Status;\n\n        return Uploader.register({\n            name: 'queue',\n\n            init: function( opts ) {\n                var me = this,\n                    deferred, len, i, item, arr, accept, runtime;\n\n                if ( $.isPlainObject( opts.accept ) ) {\n                    opts.accept = [ opts.accept ];\n                }\n\n                // accept中的中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].extensions;\n                        item && arr.push( item );\n                    }\n\n                    if ( arr.length ) {\n                        accept = '\\\\.' + arr.join(',')\n                                .replace( /,/g, '$|\\\\.' )\n                                .replace( /\\*/g, '.*' ) + '$';\n                    }\n\n                    me.accept = new RegExp( accept, 'i' );\n                }\n\n                me.queue = new Queue();\n                me.stats = me.queue.stats;\n\n                // 如果当前不是html5运行时，那就算了。\n                // 不执行后续操作\n                if ( this.request('predict-runtime-type') !== 'html5' ) {\n                    return;\n                }\n\n                // 创建一个 html5 运行时的 placeholder\n                // 以至于外部添加原生 File 对象的时候能正确包裹一下供 webuploader 使用。\n                deferred = Base.Deferred();\n                this.placeholder = runtime = new RuntimeClient('Placeholder');\n                runtime.connectRuntime({\n                    runtimeOrder: 'html5'\n                }, function() {\n                    me._ruid = runtime.getRuid();\n                    deferred.resolve();\n                });\n                return deferred.promise();\n            },\n\n\n            // 为了支持外部直接添加一个原生File对象。\n            _wrapFile: function( file ) {\n                if ( !(file instanceof WUFile) ) {\n\n                    if ( !(file instanceof File) ) {\n                        if ( !this._ruid ) {\n                            throw new Error('Can\\'t add external files.');\n                        }\n                        file = new File( this._ruid, file );\n                    }\n\n                    file = new WUFile( file );\n                }\n\n                return file;\n            },\n\n            // 判断文件是否可以被加入队列\n            acceptFile: function( file ) {\n                 var invalid = !file || !file.size || this.accept &&\n\n                        // 如果名字中有后缀，才做后缀白名单处理。\n                        rExt.exec( file.name )!== null ? !this.accept.test( file.name ) : true;\n                return !invalid;\n            },\n\n\n            /**\n             * @event beforeFileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列之前触发，此事件的handler返回值为`false`，则此文件不会被添加进入队列。\n             * @for  Uploader\n             */\n\n            /**\n             * @event fileQueued\n             * @param {File} file File对象\n             * @description 当文件被加入队列以后触发。\n             * @for  Uploader\n             */\n\n            _addFile: function( file ) {\n                var me = this;\n\n                file = me._wrapFile( file );\n\n                // 不过类型判断允许不允许，先派送 `beforeFileQueued`\n                if ( !me.owner.trigger( 'beforeFileQueued', file ) ) {\n                    return;\n                }\n\n                // 类型不匹配，则派送错误事件，并返回。\n                if ( !me.acceptFile( file ) ) {\n                    me.owner.trigger( 'error', 'Q_TYPE_DENIED', file );\n                    return;\n                }\n\n                me.queue.append( file );\n                me.owner.trigger( 'fileQueued', file );\n                return file;\n            },\n\n            getFile: function( fileId ) {\n                return this.queue.getFile( fileId );\n            },\n\n            /**\n             * @event filesQueued\n             * @param {File} files 数组，内容为原始File(lib/File）对象。\n             * @description 当一批文件添加进队列以后触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @property {Boolean} [auto=false]\n             * @namespace options\n             * @for Uploader\n             * @description 设置为 true 后，不需要手动调用上传，有文件选择即开始上传。\n             *\n             */\n\n            /**\n             * @method addFiles\n             * @grammar addFiles( file ) => undefined\n             * @grammar addFiles( [file1, file2 ...] ) => undefined\n             * @param {Array of File or File} [files] Files 对象 数组\n             * @description 添加文件到队列\n             * @for  Uploader\n             */\n            addFile: function( files ) {\n                var me = this;\n\n                if ( !files.length ) {\n                    files = [ files ];\n                }\n\n                files = $.map( files, function( file ) {\n                    return me._addFile( file );\n                });\n\n                me.owner.trigger( 'filesQueued', files );\n\n                if ( me.options.auto ) {\n                    setTimeout(function() {\n                        me.request('start-upload');\n                    }, 20 );\n                }\n            },\n\n            getStats: function() {\n                return this.stats;\n            },\n\n            /**\n             * @event fileDequeued\n             * @param {File} file File对象\n             * @description 当文件被移除队列后触发。\n             * @for  Uploader\n             */\n\n             /**\n             * @method removeFile\n             * @grammar removeFile( file ) => undefined\n             * @grammar removeFile( id ) => undefined\n             * @grammar removeFile( file, true ) => undefined\n             * @grammar removeFile( id, true ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 移除某一文件, 默认只会标记文件状态为已取消，如果第二个参数为 `true` 则会从 queue 中移除。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.removeFile( file );\n             * })\n             */\n            removeFile: function( file, remove ) {\n                var me = this;\n\n                file = file.id ? file : me.queue.getFile( file );\n\n                this.request( 'cancel-file', file );\n\n                if ( remove ) {\n                    this.queue.removeFile( file );\n                }\n            },\n\n            /**\n             * @method getFiles\n             * @grammar getFiles() => Array\n             * @grammar getFiles( status1, status2, status... ) => Array\n             * @description 返回指定状态的文件集合，不传参数将返回所有状态的文件。\n             * @for  Uploader\n             * @example\n             * console.log( uploader.getFiles() );    // => all files\n             * console.log( uploader.getFiles('error') )    // => all error files.\n             */\n            getFiles: function() {\n                return this.queue.getFiles.apply( this.queue, arguments );\n            },\n\n            fetchFile: function() {\n                return this.queue.fetch.apply( this.queue, arguments );\n            },\n\n            /**\n             * @method retry\n             * @grammar retry() => undefined\n             * @grammar retry( file ) => undefined\n             * @description 重试上传，重试指定文件，或者从出错的文件开始重新上传。\n             * @for  Uploader\n             * @example\n             * function retry() {\n             *     uploader.retry();\n             * }\n             */\n            retry: function( file, noForceStart ) {\n                var me = this,\n                    files, i, len;\n\n                if ( file ) {\n                    file = file.id ? file : me.queue.getFile( file );\n                    file.setStatus( Status.QUEUED );\n                    noForceStart || me.request('start-upload');\n                    return;\n                }\n\n                files = me.queue.getFiles( Status.ERROR );\n                i = 0;\n                len = files.length;\n\n                for ( ; i < len; i++ ) {\n                    file = files[ i ];\n                    file.setStatus( Status.QUEUED );\n                }\n\n                me.request('start-upload');\n            },\n\n            /**\n             * @method sort\n             * @grammar sort( fn ) => undefined\n             * @description 排序队列中的文件，在上传之前调整可以控制上传顺序。\n             * @for  Uploader\n             */\n            sortFiles: function() {\n                return this.queue.sort.apply( this.queue, arguments );\n            },\n\n            /**\n             * @event reset\n             * @description 当 uploader 被重置的时候触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @method reset\n             * @grammar reset() => undefined\n             * @description 重置uploader。目前只重置了队列。\n             * @for  Uploader\n             * @example\n             * uploader.reset();\n             */\n            reset: function() {\n                this.owner.trigger('reset');\n                this.queue = new Queue();\n                this.stats = this.queue.stats;\n            },\n\n            destroy: function() {\n                this.reset();\n                this.placeholder && this.placeholder.destroy();\n            }\n        });\n\n    });\n    /**\n     * @fileOverview 添加获取Runtime相关信息的方法。\n     */\n    define('widgets/runtime',[\n        'uploader',\n        'runtime/runtime',\n        'widgets/widget'\n    ], function( Uploader, Runtime ) {\n\n        Uploader.support = function() {\n            return Runtime.hasRuntime.apply( Runtime, arguments );\n        };\n\n        /**\n         * @property {Object} [runtimeOrder=html5,flash]\n         * @namespace options\n         * @for Uploader\n         * @description 指定运行时启动顺序。默认会想尝试 html5 是否支持，如果支持则使用 html5, 否则则使用 flash.\n         *\n         * 可以将此值设置成 `flash`，来强制使用 flash 运行时。\n         */\n\n        return Uploader.register({\n            name: 'runtime',\n\n            init: function() {\n                if ( !this.predictRuntimeType() ) {\n                    throw Error('Runtime Error');\n                }\n            },\n\n            /**\n             * 预测Uploader将采用哪个`Runtime`\n             * @grammar predictRuntimeType() => String\n             * @method predictRuntimeType\n             * @for  Uploader\n             */\n            predictRuntimeType: function() {\n                var orders = this.options.runtimeOrder || Runtime.orders,\n                    type = this.type,\n                    i, len;\n\n                if ( !type ) {\n                    orders = orders.split( /\\s*,\\s*/g );\n\n                    for ( i = 0, len = orders.length; i < len; i++ ) {\n                        if ( Runtime.hasRuntime( orders[ i ] ) ) {\n                            this.type = type = orders[ i ];\n                            break;\n                        }\n                    }\n                }\n\n                return type;\n            }\n        });\n    });\n    /**\n     * @fileOverview Transport\n     */\n    define('lib/transport',[\n        'base',\n        'runtime/client',\n        'mediator'\n    ], function( Base, RuntimeClient, Mediator ) {\n\n        var $ = Base.$;\n\n        function Transport( opts ) {\n            var me = this;\n\n            opts = me.options = $.extend( true, {}, Transport.options, opts || {} );\n            RuntimeClient.call( this, 'Transport' );\n\n            this._blob = null;\n            this._formData = opts.formData || {};\n            this._headers = opts.headers || {};\n\n            this.on( 'progress', this._timeout );\n            this.on( 'load error', function() {\n                me.trigger( 'progress', 1 );\n                clearTimeout( me._timer );\n            });\n        }\n\n        Transport.options = {\n            server: '',\n            method: 'POST',\n\n            // 跨域时，是否允许携带cookie, 只有html5 runtime才有效\n            withCredentials: false,\n            fileVal: 'file',\n            timeout: 2 * 60 * 1000,    // 2分钟\n            formData: {},\n            headers: {},\n            sendAsBinary: false\n        };\n\n        $.extend( Transport.prototype, {\n\n            // 添加Blob, 只能添加一次，最后一次有效。\n            appendBlob: function( key, blob, filename ) {\n                var me = this,\n                    opts = me.options;\n\n                if ( me.getRuid() ) {\n                    me.disconnectRuntime();\n                }\n\n                // 连接到blob归属的同一个runtime.\n                me.connectRuntime( blob.ruid, function() {\n                    me.exec('init');\n                });\n\n                me._blob = blob;\n                opts.fileVal = key || opts.fileVal;\n                opts.filename = filename || opts.filename;\n\n            },\n\n            // 添加其他字段\n            append: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._formData, key );\n                } else {\n                    this._formData[ key ] = value;\n                }\n            },\n\n            setRequestHeader: function( key, value ) {\n                if ( typeof key === 'object' ) {\n                    $.extend( this._headers, key );\n                } else {\n                    this._headers[ key ] = value;\n                }\n            },\n\n            send: function( method ) {\n                this.exec( 'send', method );\n                this._timeout();\n            },\n\n            abort: function() {\n                clearTimeout( this._timer );\n                return this.exec('abort');\n            },\n\n            destroy: function() {\n                this.trigger('destroy');\n                this.off();\n                this.exec('destroy');\n                this.disconnectRuntime();\n            },\n\n            getResponse: function() {\n                return this.exec('getResponse');\n            },\n\n            getResponseAsJson: function() {\n                return this.exec('getResponseAsJson');\n            },\n\n            getStatus: function() {\n                return this.exec('getStatus');\n            },\n\n            _timeout: function() {\n                var me = this,\n                    duration = me.options.timeout;\n\n                if ( !duration ) {\n                    return;\n                }\n\n                clearTimeout( me._timer );\n                me._timer = setTimeout(function() {\n                    me.abort();\n                    me.trigger( 'error', 'timeout' );\n                }, duration );\n            }\n\n        });\n\n        // 让Transport具备事件功能。\n        Mediator.installTo( Transport.prototype );\n\n        return Transport;\n    });\n    /**\n     * @fileOverview 负责文件上传相关。\n     */\n    define('widgets/upload',[\n        'base',\n        'uploader',\n        'file',\n        'lib/transport',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile, Transport ) {\n\n        var $ = Base.$,\n            isPromise = Base.isPromise,\n            Status = WUFile.Status;\n\n        // 添加默认配置项\n        $.extend( Uploader.options, {\n\n\n            /**\n             * @property {Boolean} [prepareNextFile=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否允许在文件传输时提前把下一个文件准备好。\n             * 对于一个文件的准备工作比较耗时，比如图片压缩，md5序列化。\n             * 如果能提前在当前文件传输期处理，可以节省总体耗时。\n             */\n            prepareNextFile: false,\n\n            /**\n             * @property {Boolean} [chunked=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否要分片处理大文件上传。\n             */\n            chunked: false,\n\n            /**\n             * @property {Boolean} [chunkSize=5242880]\n             * @namespace options\n             * @for Uploader\n             * @description 如果要分片，分多大一片？ 默认大小为5M.\n             */\n            chunkSize: 5 * 1024 * 1024,\n\n            /**\n             * @property {Boolean} [chunkRetry=2]\n             * @namespace options\n             * @for Uploader\n             * @description 如果某个分片由于网络问题出错，允许自动重传多少次？\n             */\n            chunkRetry: 2,\n\n            /**\n             * @property {Boolean} [threads=3]\n             * @namespace options\n             * @for Uploader\n             * @description 上传并发数。允许同时最大上传进程数。\n             */\n            threads: 3,\n\n\n            /**\n             * @property {Object} [formData={}]\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传请求的参数表，每次发送都会发送此对象中的参数。\n             */\n            formData: {}\n\n            /**\n             * @property {Object} [fileVal='file']\n             * @namespace options\n             * @for Uploader\n             * @description 设置文件上传域的name。\n             */\n\n            /**\n             * @property {Object} [method='POST']\n             * @namespace options\n             * @for Uploader\n             * @description 文件上传方式，`POST`或者`GET`。\n             */\n\n            /**\n             * @property {Object} [sendAsBinary=false]\n             * @namespace options\n             * @for Uploader\n             * @description 是否已二进制的流的方式发送文件，这样整个上传内容`php://input`都为文件内容，\n             * 其他参数在$_GET数组中。\n             */\n        });\n\n        // 负责将文件切片。\n        function CuteFile( file, chunkSize ) {\n            var pending = [],\n                blob = file.source,\n                total = blob.size,\n                chunks = chunkSize ? Math.ceil( total / chunkSize ) : 1,\n                start = 0,\n                index = 0,\n                len, api;\n\n            api = {\n                file: file,\n\n                has: function() {\n                    return !!pending.length;\n                },\n\n                shift: function() {\n                    return pending.shift();\n                },\n\n                unshift: function( block ) {\n                    pending.unshift( block );\n                }\n            };\n\n            while ( index < chunks ) {\n                len = Math.min( chunkSize, total - start );\n\n                pending.push({\n                    file: file,\n                    start: start,\n                    end: chunkSize ? (start + len) : total,\n                    total: total,\n                    chunks: chunks,\n                    chunk: index++,\n                    cuted: api\n                });\n                start += len;\n            }\n\n            file.blocks = pending.concat();\n            file.remaning = pending.length;\n\n            return api;\n        }\n\n        Uploader.register({\n            name: 'upload',\n\n            init: function() {\n                var owner = this.owner,\n                    me = this;\n\n                this.runing = false;\n                this.progress = false;\n\n                owner\n                    .on( 'startUpload', function() {\n                        me.progress = true;\n                    })\n                    .on( 'uploadFinished', function() {\n                        me.progress = false;\n                    });\n\n                // 记录当前正在传的数据，跟threads相关\n                this.pool = [];\n\n                // 缓存分好片的文件。\n                this.stack = [];\n\n                // 缓存即将上传的文件。\n                this.pending = [];\n\n                // 跟踪还有多少分片在上传中但是没有完成上传。\n                this.remaning = 0;\n                this.__tick = Base.bindFn( this._tick, this );\n\n                owner.on( 'uploadComplete', function( file ) {\n\n                    // 把其他块取消了。\n                    file.blocks && $.each( file.blocks, function( _, v ) {\n                        v.transport && (v.transport.abort(), v.transport.destroy());\n                        delete v.transport;\n                    });\n\n                    delete file.blocks;\n                    delete file.remaning;\n                });\n            },\n\n            reset: function() {\n                this.request( 'stop-upload', true );\n                this.runing = false;\n                this.pool = [];\n                this.stack = [];\n                this.pending = [];\n                this.remaning = 0;\n                this._trigged = false;\n                this._promise = null;\n            },\n\n            /**\n             * @event startUpload\n             * @description 当开始上传流程时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * 开始上传。此方法可以从初始状态调用开始上传流程，也可以从暂停状态调用，继续上传流程。\n             *\n             * 可以指定开始某一个文件。\n             * @grammar upload() => undefined\n             * @grammar upload( file | fileId) => undefined\n             * @method upload\n             * @for  Uploader\n             */\n            startUpload: function(file) {\n                var me = this;\n\n                // 移出invalid的文件\n                $.each( me.request( 'get-files', Status.INVALID ), function() {\n                    me.request( 'remove-file', this );\n                });\n\n                // 如果指定了开始某个文件，则只开始指定文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        $.each( me.pool, function( _, v ) {\n\n                            // 之前暂停过。\n                            if (v.file !== file) {\n                                return;\n                            }\n\n                            v.transport && v.transport.send();\n                        });\n\n                        file.setStatus( Status.QUEUED );\n                    } else if (file.getStatus() === Status.PROGRESS) {\n                        return;\n                    } else {\n                        file.setStatus( Status.QUEUED );\n                    }\n                } else {\n                    $.each( me.request( 'get-files', [ Status.INITED ] ), function() {\n                        this.setStatus( Status.QUEUED );\n                    });\n                }\n\n                if ( me.runing ) {\n                    return;\n                }\n\n                me.runing = true;\n\n                var files = [];\n\n                // 如果有暂停的，则续传\n                $.each( me.pool, function( _, v ) {\n                    var file = v.file;\n\n                    if ( file.getStatus() === Status.INTERRUPT ) {\n                        files.push(file);\n                        me._trigged = false;\n                        v.transport && v.transport.send();\n                    }\n                });\n\n                var file;\n                while ( (file = files.shift()) ) {\n                    file.setStatus( Status.PROGRESS );\n                }\n\n                file || $.each( me.request( 'get-files',\n                        Status.INTERRUPT ), function() {\n                    this.setStatus( Status.PROGRESS );\n                });\n\n                me._trigged = false;\n                Base.nextTick( me.__tick );\n                me.owner.trigger('startUpload');\n            },\n\n            /**\n             * @event stopUpload\n             * @description 当开始上传流程暂停时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * 暂停上传。第一个参数为是否中断上传当前正在上传的文件。\n             *\n             * 如果第一个参数是文件，则只暂停指定文件。\n             * @grammar stop() => undefined\n             * @grammar stop( true ) => undefined\n             * @grammar stop( file ) => undefined\n             * @method stop\n             * @for  Uploader\n             */\n            stopUpload: function( file, interrupt ) {\n                var me = this;\n\n                if (file === true) {\n                    interrupt = file;\n                    file = null;\n                }\n\n                if ( me.runing === false ) {\n                    return;\n                }\n\n                // 如果只是暂停某个文件。\n                if ( file ) {\n                    file = file.id ? file : me.request( 'get-file', file );\n\n                    if ( file.getStatus() !== Status.PROGRESS &&\n                            file.getStatus() !== Status.QUEUED ) {\n                        return;\n                    }\n\n                    file.setStatus( Status.INTERRUPT );\n                    $.each( me.pool, function( _, v ) {\n\n                        // 只 abort 指定的文件。\n                        if (v.file !== file) {\n                            return;\n                        }\n\n                        v.transport && v.transport.abort();\n                        me._putback(v);\n                        me._popBlock(v);\n                    });\n\n                    return Base.nextTick( me.__tick );\n                }\n\n                me.runing = false;\n\n                if (this._promise && this._promise.file) {\n                    this._promise.file.setStatus( Status.INTERRUPT );\n                }\n\n                interrupt && $.each( me.pool, function( _, v ) {\n                    v.transport && v.transport.abort();\n                    v.file.setStatus( Status.INTERRUPT );\n                });\n\n                me.owner.trigger('stopUpload');\n            },\n\n            /**\n             * @method cancelFile\n             * @grammar cancelFile( file ) => undefined\n             * @grammar cancelFile( id ) => undefined\n             * @param {File|id} file File对象或这File对象的id\n             * @description 标记文件状态为已取消, 同时将中断文件传输。\n             * @for  Uploader\n             * @example\n             *\n             * $li.on('click', '.remove-this', function() {\n             *     uploader.cancelFile( file );\n             * })\n             */\n            cancelFile: function( file ) {\n                file = file.id ? file : this.request( 'get-file', file );\n\n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n\n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n\n                file.setStatus( Status.CANCELLED );\n                this.owner.trigger( 'fileDequeued', file );\n            },\n\n            /**\n             * 判断`Uplaode`r是否正在上传中。\n             * @grammar isInProgress() => Boolean\n             * @method isInProgress\n             * @for  Uploader\n             */\n            isInProgress: function() {\n                return !!this.progress;\n            },\n\n            _getStats: function() {\n                return this.request('get-stats');\n            },\n\n            /**\n             * 掉过一个文件上传，直接标记指定文件为已上传状态。\n             * @grammar skipFile( file ) => undefined\n             * @method skipFile\n             * @for  Uploader\n             */\n            skipFile: function( file, status ) {\n                file = file.id ? file : this.request( 'get-file', file );\n\n                file.setStatus( status || Status.COMPLETE );\n                file.skipped = true;\n\n                // 如果正在上传。\n                file.blocks && $.each( file.blocks, function( _, v ) {\n                    var _tr = v.transport;\n\n                    if ( _tr ) {\n                        _tr.abort();\n                        _tr.destroy();\n                        delete v.transport;\n                    }\n                });\n\n                this.owner.trigger( 'uploadSkip', file );\n            },\n\n            /**\n             * @event uploadFinished\n             * @description 当所有文件上传结束时触发。\n             * @for  Uploader\n             */\n            _tick: function() {\n                var me = this,\n                    opts = me.options,\n                    fn, val;\n\n                // 上一个promise还没有结束，则等待完成后再执行。\n                if ( me._promise ) {\n                    return me._promise.always( me.__tick );\n                }\n\n                // 还有位置，且还有文件要处理的话。\n                if ( me.pool.length < opts.threads && (val = me._nextBlock()) ) {\n                    me._trigged = false;\n\n                    fn = function( val ) {\n                        me._promise = null;\n\n                        // 有可能是reject过来的，所以要检测val的类型。\n                        val && val.file && me._startSend( val );\n                        Base.nextTick( me.__tick );\n                    };\n\n                    me._promise = isPromise( val ) ? val.always( fn ) : fn( val );\n\n                // 没有要上传的了，且没有正在传输的了。\n                } else if ( !me.remaning && !me._getStats().numOfQueue &&\n                    !me._getStats().numofInterrupt ) {\n                    me.runing = false;\n\n                    me._trigged || Base.nextTick(function() {\n                        me.owner.trigger('uploadFinished');\n                    });\n                    me._trigged = true;\n                }\n            },\n\n            _putback: function(block) {\n                var idx;\n\n                block.cuted.unshift(block);\n                idx = this.stack.indexOf(block.cuted);\n\n                if (!~idx) {\n                    this.stack.unshift(block.cuted);\n                }\n            },\n\n            _getStack: function() {\n                var i = 0,\n                    act;\n\n                while ( (act = this.stack[ i++ ]) ) {\n                    if ( act.has() && act.file.getStatus() === Status.PROGRESS ) {\n                        return act;\n                    } else if (!act.has() ||\n                            act.file.getStatus() !== Status.PROGRESS &&\n                            act.file.getStatus() !== Status.INTERRUPT ) {\n\n                        // 把已经处理完了的，或者，状态为非 progress（上传中）、\n                        // interupt（暂停中） 的移除。\n                        this.stack.splice( --i, 1 );\n                    }\n                }\n\n                return null;\n            },\n\n            _nextBlock: function() {\n                var me = this,\n                    opts = me.options,\n                    act, next, done, preparing;\n\n                // 如果当前文件还有没有需要传输的，则直接返回剩下的。\n                if ( (act = this._getStack()) ) {\n\n                    // 是否提前准备下一个文件\n                    if ( opts.prepareNextFile && !me.pending.length ) {\n                        me._prepareNextFile();\n                    }\n\n                    return act.shift();\n\n                // 否则，如果正在运行，则准备下一个文件，并等待完成后返回下个分片。\n                } else if ( me.runing ) {\n\n                    // 如果缓存中有，则直接在缓存中取，没有则去queue中取。\n                    if ( !me.pending.length && me._getStats().numOfQueue ) {\n                        me._prepareNextFile();\n                    }\n\n                    next = me.pending.shift();\n                    done = function( file ) {\n                        if ( !file ) {\n                            return null;\n                        }\n\n                        act = CuteFile( file, opts.chunked ? opts.chunkSize : 0 );\n                        me.stack.push(act);\n                        return act.shift();\n                    };\n\n                    // 文件可能还在prepare中，也有可能已经完全准备好了。\n                    if ( isPromise( next) ) {\n                        preparing = next.file;\n                        next = next[ next.pipe ? 'pipe' : 'then' ]( done );\n                        next.file = preparing;\n                        return next;\n                    }\n\n                    return done( next );\n                }\n            },\n\n\n            /**\n             * @event uploadStart\n             * @param {File} file File对象\n             * @description 某个文件开始上传前触发，一个文件只会触发一次。\n             * @for  Uploader\n             */\n            _prepareNextFile: function() {\n                var me = this,\n                    file = me.request('fetch-file'),\n                    pending = me.pending,\n                    promise;\n\n                if ( file ) {\n                    promise = me.request( 'before-send-file', file, function() {\n\n                        // 有可能文件被skip掉了。文件被skip掉后，状态坑定不是Queued.\n                        if ( file.getStatus() === Status.PROGRESS ||\n                            file.getStatus() === Status.INTERRUPT ) {\n                            return file;\n                        }\n\n                        return me._finishFile( file );\n                    });\n\n                    me.owner.trigger( 'uploadStart', file );\n                    file.setStatus( Status.PROGRESS );\n\n                    promise.file = file;\n\n                    // 如果还在pending中，则替换成文件本身。\n                    promise.done(function() {\n                        var idx = $.inArray( promise, pending );\n\n                        ~idx && pending.splice( idx, 1, file );\n                    });\n\n                    // befeore-send-file的钩子就有错误发生。\n                    promise.fail(function( reason ) {\n                        file.setStatus( Status.ERROR, reason );\n                        me.owner.trigger( 'uploadError', file, reason );\n                        me.owner.trigger( 'uploadComplete', file );\n                    });\n\n                    pending.push( promise );\n                }\n            },\n\n            // 让出位置了，可以让其他分片开始上传\n            _popBlock: function( block ) {\n                var idx = $.inArray( block, this.pool );\n\n                this.pool.splice( idx, 1 );\n                block.file.remaning--;\n                this.remaning--;\n            },\n\n            // 开始上传，可以被掉过。如果promise被reject了，则表示跳过此分片。\n            _startSend: function( block ) {\n                var me = this,\n                    file = block.file,\n                    promise;\n\n                // 有可能在 before-send-file 的 promise 期间改变了文件状态。\n                // 如：暂停，取消\n                // 我们不能中断 promise, 但是可以在 promise 完后，不做上传操作。\n                if ( file.getStatus() !== Status.PROGRESS ) {\n\n                    // 如果是中断，则还需要放回去。\n                    if (file.getStatus() === Status.INTERRUPT) {\n                        me._putback(block);\n                    }\n\n                    return;\n                }\n\n                me.pool.push( block );\n                me.remaning++;\n\n                // 如果没有分片，则直接使用原始的。\n                // 不会丢失content-type信息。\n                block.blob = block.chunks === 1 ? file.source :\n                        file.source.slice( block.start, block.end );\n\n                // hook, 每个分片发送之前可能要做些异步的事情。\n                promise = me.request( 'before-send', block, function() {\n\n                    // 有可能文件已经上传出错了，所以不需要再传输了。\n                    if ( file.getStatus() === Status.PROGRESS ) {\n                        me._doSend( block );\n                    } else {\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n\n                // 如果为fail了，则跳过此分片。\n                promise.fail(function() {\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file ).always(function() {\n                            block.percentage = 1;\n                            me._popBlock( block );\n                            me.owner.trigger( 'uploadComplete', file );\n                            Base.nextTick( me.__tick );\n                        });\n                    } else {\n                        block.percentage = 1;\n                        me.updateFileProgress( file );\n                        me._popBlock( block );\n                        Base.nextTick( me.__tick );\n                    }\n                });\n            },\n\n\n            /**\n             * @event uploadBeforeSend\n             * @param {Object} object\n             * @param {Object} data 默认的上传参数，可以扩展此对象来控制上传参数。\n             * @param {Object} headers 可以扩展此对象来控制上传头部。\n             * @description 当某个文件的分块在发送前触发，主要用来询问是否要添加附带参数，大文件在开起分片上传的前提下此事件可能会触发多次。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadAccept\n             * @param {Object} object\n             * @param {Object} ret 服务端的返回数据，json格式，如果服务端不是json格式，从ret._raw中取数据，自行解析。\n             * @description 当某个文件上传到服务端响应后，会派送此事件来询问服务端响应是否有效。如果此事件handler返回值为`false`, 则此文件将派送`server`类型的`uploadError`事件。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadProgress\n             * @param {File} file File对象\n             * @param {Number} percentage 上传进度\n             * @description 上传过程中触发，携带上传进度。\n             * @for  Uploader\n             */\n\n\n            /**\n             * @event uploadError\n             * @param {File} file File对象\n             * @param {String} reason 出错的code\n             * @description 当文件上传出错时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadSuccess\n             * @param {File} file File对象\n             * @param {Object} response 服务端返回的数据\n             * @description 当文件上传成功时触发。\n             * @for  Uploader\n             */\n\n            /**\n             * @event uploadComplete\n             * @param {File} [file] File对象\n             * @description 不管成功或者失败，文件上传完成时触发。\n             * @for  Uploader\n             */\n\n            // 做上传操作。\n            _doSend: function( block ) {\n                var me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    file = block.file,\n                    tr = new Transport( opts ),\n                    data = $.extend({}, opts.formData ),\n                    headers = $.extend({}, opts.headers ),\n                    requestAccept, ret;\n\n                block.transport = tr;\n\n                tr.on( 'destroy', function() {\n                    delete block.transport;\n                    me._popBlock( block );\n                    Base.nextTick( me.__tick );\n                });\n\n                // 广播上传进度。以文件为单位。\n                tr.on( 'progress', function( percentage ) {\n                    block.percentage = percentage;\n                    me.updateFileProgress( file );\n                });\n\n                // 用来询问，是否返回的结果是有错误的。\n                requestAccept = function( reject ) {\n                    var fn;\n\n                    ret = tr.getResponseAsJson() || {};\n                    ret._raw = tr.getResponse();\n                    fn = function( value ) {\n                        reject = value;\n                    };\n\n                    // 服务端响应了，不代表成功了，询问是否响应正确。\n                    if ( !owner.trigger( 'uploadAccept', block, ret, fn ) ) {\n                        reject = reject || 'server';\n                    }\n\n                    return reject;\n                };\n\n                // 尝试重试，然后广播文件上传出错。\n                tr.on( 'error', function( type, flag ) {\n                    block.retried = block.retried || 0;\n\n                    // 自动重试\n                    if ( block.chunks > 1 && ~'http,abort'.indexOf( type ) &&\n                            block.retried < opts.chunkRetry ) {\n\n                        block.retried++;\n                        tr.send();\n\n                    } else {\n\n                        // http status 500 ~ 600\n                        if ( !flag && type === 'server' ) {\n                            type = requestAccept( type );\n                        }\n\n                        file.setStatus( Status.ERROR, type );\n                        owner.trigger( 'uploadError', file, type );\n                        owner.trigger( 'uploadComplete', file );\n                    }\n                });\n\n                // 上传成功\n                tr.on( 'load', function() {\n                    var reason;\n\n                    // 如果非预期，转向上传出错。\n                    if ( (reason = requestAccept()) ) {\n                        tr.trigger( 'error', reason, true );\n                        return;\n                    }\n\n                    // 全部上传完成。\n                    if ( file.remaning === 1 ) {\n                        me._finishFile( file, ret );\n                    } else {\n                        tr.destroy();\n                    }\n                });\n\n                // 配置默认的上传字段。\n                data = $.extend( data, {\n                    id: file.id,\n                    name: file.name,\n                    type: file.type,\n                    lastModifiedDate: file.lastModifiedDate,\n                    size: file.size\n                });\n\n                block.chunks > 1 && $.extend( data, {\n                    chunks: block.chunks,\n                    chunk: block.chunk\n                });\n\n                // 在发送之间可以添加字段什么的。。。\n                // 如果默认的字段不够使用，可以通过监听此事件来扩展\n                owner.trigger( 'uploadBeforeSend', block, data, headers );\n\n                // 开始发送。\n                tr.appendBlob( opts.fileVal, block.blob, file.name );\n                tr.append( data );\n                tr.setRequestHeader( headers );\n                tr.send();\n            },\n\n            // 完成上传。\n            _finishFile: function( file, ret, hds ) {\n                var owner = this.owner;\n\n                return owner\n                        .request( 'after-send-file', arguments, function() {\n                            file.setStatus( Status.COMPLETE );\n                            owner.trigger( 'uploadSuccess', file, ret, hds );\n                        })\n                        .fail(function( reason ) {\n\n                            // 如果外部已经标记为invalid什么的，不再改状态。\n                            if ( file.getStatus() === Status.PROGRESS ) {\n                                file.setStatus( Status.ERROR, reason );\n                            }\n\n                            owner.trigger( 'uploadError', file, reason );\n                        })\n                        .always(function() {\n                            owner.trigger( 'uploadComplete', file );\n                        });\n            },\n\n            updateFileProgress: function(file) {\n                var totalPercent = 0,\n                    uploaded = 0;\n\n                if (!file.blocks) {\n                    return;\n                }\n\n                $.each( file.blocks, function( _, v ) {\n                    uploaded += (v.percentage || 0) * (v.end - v.start);\n                });\n\n                totalPercent = uploaded / file.size;\n                this.owner.trigger( 'uploadProgress', file, totalPercent || 0 );\n            }\n\n        });\n    });\n    /**\n     * @fileOverview 各种验证，包括文件总大小是否超出、单文件是否超出和文件是否重复。\n     */\n\n    define('widgets/validator',[\n        'base',\n        'uploader',\n        'file',\n        'widgets/widget'\n    ], function( Base, Uploader, WUFile ) {\n\n        var $ = Base.$,\n            validators = {},\n            api;\n\n        /**\n         * @event error\n         * @param {String} type 错误类型。\n         * @description 当validate不通过时，会以派送错误事件的形式通知调用者。通过`upload.on('error', handler)`可以捕获到此类错误，目前有以下错误会在特定的情况下派送错来。\n         *\n         * * `Q_EXCEED_NUM_LIMIT` 在设置了`fileNumLimit`且尝试给`uploader`添加的文件数量超出这个值时派送。\n         * * `Q_EXCEED_SIZE_LIMIT` 在设置了`Q_EXCEED_SIZE_LIMIT`且尝试给`uploader`添加的文件总大小超出这个值时派送。\n         * * `Q_TYPE_DENIED` 当文件类型不满足时触发。。\n         * @for  Uploader\n         */\n\n        // 暴露给外面的api\n        api = {\n\n            // 添加验证器\n            addValidator: function( type, cb ) {\n                validators[ type ] = cb;\n            },\n\n            // 移除验证器\n            removeValidator: function( type ) {\n                delete validators[ type ];\n            }\n        };\n\n        // 在Uploader初始化的时候启动Validators的初始化\n        Uploader.register({\n            name: 'validator',\n\n            init: function() {\n                var me = this;\n                Base.nextTick(function() {\n                    $.each( validators, function() {\n                        this.call( me.owner );\n                    });\n                });\n            }\n        });\n\n        /**\n         * @property {int} [fileNumLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总数量, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileNumLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileNumLimit, 10 ),\n                flag = true;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n\n                if ( count >= max && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_NUM_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n\n                return count >= max ? false : true;\n            });\n\n            uploader.on( 'fileQueued', function() {\n                count++;\n            });\n\n            uploader.on( 'fileDequeued', function() {\n                count--;\n            });\n\n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n\n\n        /**\n         * @property {int} [fileSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证文件总大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                count = 0,\n                max = parseInt( opts.fileSizeLimit, 10 ),\n                flag = true;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n                var invalid = count + file.size > max;\n\n                if ( invalid && flag ) {\n                    flag = false;\n                    this.trigger( 'error', 'Q_EXCEED_SIZE_LIMIT', max, file );\n                    setTimeout(function() {\n                        flag = true;\n                    }, 1 );\n                }\n\n                return invalid ? false : true;\n            });\n\n            uploader.on( 'fileQueued', function( file ) {\n                count += file.size;\n            });\n\n            uploader.on( 'fileDequeued', function( file ) {\n                count -= file.size;\n            });\n\n            uploader.on( 'reset', function() {\n                count = 0;\n            });\n        });\n\n        /**\n         * @property {int} [fileSingleSizeLimit=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 验证单个文件大小是否超出限制, 超出则不允许加入队列。\n         */\n        api.addValidator( 'fileSingleSizeLimit', function() {\n            var uploader = this,\n                opts = uploader.options,\n                max = opts.fileSingleSizeLimit;\n\n            if ( !max ) {\n                return;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n\n                if ( file.size > max ) {\n                    file.setStatus( WUFile.Status.INVALID, 'exceed_size' );\n                    this.trigger( 'error', 'F_EXCEED_SIZE', max, file );\n                    return false;\n                }\n\n            });\n\n        });\n\n        /**\n         * @property {Boolean} [duplicate=undefined]\n         * @namespace options\n         * @for Uploader\n         * @description 去重， 根据文件名字、文件大小和最后修改时间来生成hash Key.\n         */\n        api.addValidator( 'duplicate', function() {\n            var uploader = this,\n                opts = uploader.options,\n                mapping = {};\n\n            if ( opts.duplicate ) {\n                return;\n            }\n\n            function hashString( str ) {\n                var hash = 0,\n                    i = 0,\n                    len = str.length,\n                    _char;\n\n                for ( ; i < len; i++ ) {\n                    _char = str.charCodeAt( i );\n                    hash = _char + (hash << 6) + (hash << 16) - hash;\n                }\n\n                return hash;\n            }\n\n            uploader.on( 'beforeFileQueued', function( file ) {\n                var hash = file.__hash || (file.__hash = hashString( file.name +\n                        file.size + file.lastModifiedDate ));\n\n                // 已经重复了\n                if ( mapping[ hash ] ) {\n                    this.trigger( 'error', 'F_DUPLICATE', file );\n                    return false;\n                }\n            });\n\n            uploader.on( 'fileQueued', function( file ) {\n                var hash = file.__hash;\n\n                hash && (mapping[ hash ] = true);\n            });\n\n            uploader.on( 'fileDequeued', function( file ) {\n                var hash = file.__hash;\n\n                hash && (delete mapping[ hash ]);\n            });\n\n            uploader.on( 'reset', function() {\n                mapping = {};\n            });\n        });\n\n        return api;\n    });\n\n    /**\n     * @fileOverview Md5\n     */\n    define('lib/md5',[\n        'runtime/client',\n        'mediator'\n    ], function( RuntimeClient, Mediator ) {\n\n        function Md5() {\n            RuntimeClient.call( this, 'Md5' );\n        }\n\n        // 让 Md5 具备事件功能。\n        Mediator.installTo( Md5.prototype );\n\n        Md5.prototype.loadFromBlob = function( blob ) {\n            var me = this;\n\n            if ( me.getRuid() ) {\n                me.disconnectRuntime();\n            }\n\n            // 连接到blob归属的同一个runtime.\n            me.connectRuntime( blob.ruid, function() {\n                me.exec('init');\n                me.exec( 'loadFromBlob', blob );\n            });\n        };\n\n        Md5.prototype.getResult = function() {\n            return this.exec('getResult');\n        };\n\n        return Md5;\n    });\n    /**\n     * @fileOverview 图片操作, 负责预览图片和上传前压缩图片\n     */\n    define('widgets/md5',[\n        'base',\n        'uploader',\n        'lib/md5',\n        'lib/blob',\n        'widgets/widget'\n    ], function( Base, Uploader, Md5, Blob ) {\n\n        return Uploader.register({\n            name: 'md5',\n\n\n            /**\n             * 计算文件 md5 值，返回一个 promise 对象，可以监听 progress 进度。\n             *\n             *\n             * @method md5File\n             * @grammar md5File( file[, start[, end]] ) => promise\n             * @for Uploader\n             * @example\n             *\n             * uploader.on( 'fileQueued', function( file ) {\n             *     var $li = ...;\n             *\n             *     uploader.md5File( file )\n             *\n             *         // 及时显示进度\n             *         .progress(function(percentage) {\n             *             console.log('Percentage:', percentage);\n             *         })\n             *\n             *         // 完成\n             *         .then(function(val) {\n             *             console.log('md5 result:', val);\n             *         });\n             *\n             * });\n             */\n            md5File: function( file, start, end ) {\n                var md5 = new Md5(),\n                    deferred = Base.Deferred(),\n                    blob = (file instanceof Blob) ? file :\n                        this.request( 'get-file', file ).source;\n\n                md5.on( 'progress load', function( e ) {\n                    e = e || {};\n                    deferred.notify( e.total ? e.loaded / e.total : 1 );\n                });\n\n                md5.on( 'complete', function() {\n                    deferred.resolve( md5.getResult() );\n                });\n\n                md5.on( 'error', function( reason ) {\n                    deferred.reject( reason );\n                });\n\n                if ( arguments.length > 1 ) {\n                    start = start || 0;\n                    end = end || 0;\n                    start < 0 && (start = blob.size + start);\n                    end < 0 && (end = blob.size + end);\n                    end = Math.min( end, blob.size );\n                    blob = blob.slice( start, end );\n                }\n\n                md5.loadFromBlob( blob );\n\n                return deferred.promise();\n            }\n        });\n    });\n    /**\n     * @fileOverview Runtime管理器，负责Runtime的选择, 连接\n     */\n    define('runtime/compbase',[],function() {\n\n        function CompBase( owner, runtime ) {\n\n            this.owner = owner;\n            this.options = owner.options;\n\n            this.getRuntime = function() {\n                return runtime;\n            };\n\n            this.getRuid = function() {\n                return runtime.uid;\n            };\n\n            this.trigger = function() {\n                return owner.trigger.apply( owner, arguments );\n            };\n        }\n\n        return CompBase;\n    });\n    /**\n     * @fileOverview Html5Runtime\n     */\n    define('runtime/html5/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n\n        var type = 'html5',\n            components = {};\n\n        function Html5Runtime() {\n            var pool = {},\n                me = this,\n                destroy = this.destroy;\n\n            Runtime.apply( me, arguments );\n            me.type = type;\n\n\n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n\n                if ( components[ comp ] ) {\n                    instance = pool[ uid ] = pool[ uid ] ||\n                            new components[ comp ]( client, me );\n\n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n            };\n\n            me.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n        }\n\n        Base.inherits( Runtime, {\n            constructor: Html5Runtime,\n\n            // 不需要连接其他程序，直接执行callback\n            init: function() {\n                var me = this;\n                setTimeout(function() {\n                    me.trigger('ready');\n                }, 1 );\n            }\n\n        });\n\n        // 注册Components\n        Html5Runtime.register = function( name, component ) {\n            var klass = components[ name ] = Base.inherits( CompBase, component );\n            return klass;\n        };\n\n        // 注册html5运行时。\n        // 只有在支持的前提下注册。\n        if ( window.Blob && window.FileReader && window.DataView ) {\n            Runtime.addRuntime( type, Html5Runtime );\n        }\n\n        return Html5Runtime;\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/html5/blob',[\n        'runtime/html5/runtime',\n        'lib/blob'\n    ], function( Html5Runtime, Blob ) {\n\n        return Html5Runtime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.owner.source,\n                    slice = blob.slice || blob.webkitSlice || blob.mozSlice;\n\n                blob = slice.call( blob, start, end );\n\n                return new Blob( this.getRuid(), blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/dnd',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n\n        var $ = Base.$,\n            prefix = 'webuploader-dnd-';\n\n        return Html5Runtime.register( 'DragAndDrop', {\n            init: function() {\n                var elem = this.elem = this.options.container;\n\n                this.dragEnterHandler = Base.bindFn( this._dragEnterHandler, this );\n                this.dragOverHandler = Base.bindFn( this._dragOverHandler, this );\n                this.dragLeaveHandler = Base.bindFn( this._dragLeaveHandler, this );\n                this.dropHandler = Base.bindFn( this._dropHandler, this );\n                this.dndOver = false;\n\n                elem.on( 'dragenter', this.dragEnterHandler );\n                elem.on( 'dragover', this.dragOverHandler );\n                elem.on( 'dragleave', this.dragLeaveHandler );\n                elem.on( 'drop', this.dropHandler );\n\n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).on( 'dragover', this.dragOverHandler );\n                    $( document ).on( 'drop', this.dropHandler );\n                }\n            },\n\n            _dragEnterHandler: function( e ) {\n                var me = this,\n                    denied = me._denied || false,\n                    items;\n\n                e = e.originalEvent || e;\n\n                if ( !me.dndOver ) {\n                    me.dndOver = true;\n\n                    // 注意只有 chrome 支持。\n                    items = e.dataTransfer.items;\n\n                    if ( items && items.length ) {\n                        me._denied = denied = !me.trigger( 'accept', items );\n                    }\n\n                    me.elem.addClass( prefix + 'over' );\n                    me.elem[ denied ? 'addClass' :\n                            'removeClass' ]( prefix + 'denied' );\n                }\n\n                e.dataTransfer.dropEffect = denied ? 'none' : 'copy';\n\n                return false;\n            },\n\n            _dragOverHandler: function( e ) {\n                // 只处理框内的。\n                var parentElem = this.elem.parent().get( 0 );\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n\n                clearTimeout( this._leaveTimer );\n                this._dragEnterHandler.call( this, e );\n\n                return false;\n            },\n\n            _dragLeaveHandler: function() {\n                var me = this,\n                    handler;\n\n                handler = function() {\n                    me.dndOver = false;\n                    me.elem.removeClass( prefix + 'over ' + prefix + 'denied' );\n                };\n\n                clearTimeout( me._leaveTimer );\n                me._leaveTimer = setTimeout( handler, 100 );\n                return false;\n            },\n\n            _dropHandler: function( e ) {\n                var me = this,\n                    ruid = me.getRuid(),\n                    parentElem = me.elem.parent().get( 0 ),\n                    dataTransfer, data;\n\n                // 只处理框内的。\n                if ( parentElem && !$.contains( parentElem, e.currentTarget ) ) {\n                    return false;\n                }\n\n                e = e.originalEvent || e;\n                dataTransfer = e.dataTransfer;\n\n                // 如果是页面内拖拽，还不能处理，不阻止事件。\n                // 此处 ie11 下会报参数错误，\n                try {\n                    data = dataTransfer.getData('text/html');\n                } catch( err ) {\n                }\n\n                if ( data ) {\n                    return;\n                }\n\n                me._getTansferFiles( dataTransfer, function( results ) {\n                    me.trigger( 'drop', $.map( results, function( file ) {\n                        return new File( ruid, file );\n                    }) );\n                });\n\n                me.dndOver = false;\n                me.elem.removeClass( prefix + 'over' );\n                return false;\n            },\n\n            // 如果传入 callback 则去查看文件夹，否则只管当前文件夹。\n            _getTansferFiles: function( dataTransfer, callback ) {\n                var results  = [],\n                    promises = [],\n                    items, files, file, item, i, len, canAccessFolder;\n\n                items = dataTransfer.items;\n                files = dataTransfer.files;\n\n                canAccessFolder = !!(items && items[ 0 ].webkitGetAsEntry);\n\n                for ( i = 0, len = files.length; i < len; i++ ) {\n                    file = files[ i ];\n                    item = items && items[ i ];\n\n                    if ( canAccessFolder && item.webkitGetAsEntry().isDirectory ) {\n\n                        promises.push( this._traverseDirectoryTree(\n                                item.webkitGetAsEntry(), results ) );\n                    } else {\n                        results.push( file );\n                    }\n                }\n\n                Base.when.apply( Base, promises ).done(function() {\n\n                    if ( !results.length ) {\n                        return;\n                    }\n\n                    callback( results );\n                });\n            },\n\n            _traverseDirectoryTree: function( entry, results ) {\n                var deferred = Base.Deferred(),\n                    me = this;\n\n                if ( entry.isFile ) {\n                    entry.file(function( file ) {\n                        results.push( file );\n                        deferred.resolve();\n                    });\n                } else if ( entry.isDirectory ) {\n                    entry.createReader().readEntries(function( entries ) {\n                        var len = entries.length,\n                            promises = [],\n                            arr = [],    // 为了保证顺序。\n                            i;\n\n                        for ( i = 0; i < len; i++ ) {\n                            promises.push( me._traverseDirectoryTree(\n                                    entries[ i ], arr ) );\n                        }\n\n                        Base.when.apply( Base, promises ).then(function() {\n                            results.push.apply( results, arr );\n                            deferred.resolve();\n                        }, deferred.reject );\n                    });\n                }\n\n                return deferred.promise();\n            },\n\n            destroy: function() {\n                var elem = this.elem;\n\n                // 还没 init 就调用 destroy\n                if (!elem) {\n                    return;\n                }\n\n                elem.off( 'dragenter', this.dragEnterHandler );\n                elem.off( 'dragover', this.dragOverHandler );\n                elem.off( 'dragleave', this.dragLeaveHandler );\n                elem.off( 'drop', this.dropHandler );\n\n                if ( this.options.disableGlobalDnd ) {\n                    $( document ).off( 'dragover', this.dragOverHandler );\n                    $( document ).off( 'drop', this.dropHandler );\n                }\n            }\n        });\n    });\n\n    /**\n     * @fileOverview FilePaste\n     */\n    define('runtime/html5/filepaste',[\n        'base',\n        'runtime/html5/runtime',\n        'lib/file'\n    ], function( Base, Html5Runtime, File ) {\n\n        return Html5Runtime.register( 'FilePaste', {\n            init: function() {\n                var opts = this.options,\n                    elem = this.elem = opts.container,\n                    accept = '.*',\n                    arr, i, len, item;\n\n                // accetp的mimeTypes中生成匹配正则。\n                if ( opts.accept ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        item = opts.accept[ i ].mimeTypes;\n                        item && arr.push( item );\n                    }\n\n                    if ( arr.length ) {\n                        accept = arr.join(',');\n                        accept = accept.replace( /,/g, '|' ).replace( /\\*/g, '.*' );\n                    }\n                }\n                this.accept = accept = new RegExp( accept, 'i' );\n                this.hander = Base.bindFn( this._pasteHander, this );\n                elem.on( 'paste', this.hander );\n            },\n\n            _pasteHander: function( e ) {\n                var allowed = [],\n                    ruid = this.getRuid(),\n                    items, item, blob, i, len;\n\n                e = e.originalEvent || e;\n                items = e.clipboardData.items;\n\n                for ( i = 0, len = items.length; i < len; i++ ) {\n                    item = items[ i ];\n\n                    if ( item.kind !== 'file' || !(blob = item.getAsFile()) ) {\n                        continue;\n                    }\n\n                    allowed.push( new File( ruid, blob ) );\n                }\n\n                if ( allowed.length ) {\n                    // 不阻止非文件粘贴（文字粘贴）的事件冒泡\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.trigger( 'paste', allowed );\n                }\n            },\n\n            destroy: function() {\n                this.elem.off( 'paste', this.hander );\n            }\n        });\n    });\n\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/html5/filepicker',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n\n        var $ = Base.$;\n\n        return Html5Runtime.register( 'FilePicker', {\n            init: function() {\n                var container = this.getRuntime().getContainer(),\n                    me = this,\n                    owner = me.owner,\n                    opts = me.options,\n                    label = this.label = $( document.createElement('label') ),\n                    input =  this.input = $( document.createElement('input') ),\n                    arr, i, len, mouseHandler;\n\n                input.attr( 'type', 'file' );\n                //console.log(opts.name)\n                input.attr( 'name', 'file' );\n                input.addClass('webuploader-element-invisible');\n\n                label.on( 'click', function() {\n                    input.trigger('click');\n                });\n\n                label.css({\n                    opacity: 0,\n                    width: '100%',\n                    height: '100%',\n                    display: 'block',\n                    cursor: 'pointer',\n                    background: '#ffffff'\n                });\n\n                if ( opts.multiple ) {\n                    input.attr( 'multiple', 'multiple' );\n                }\n\n                // @todo Firefox不支持单独指定后缀\n                if ( opts.accept && opts.accept.length > 0 ) {\n                    arr = [];\n\n                    for ( i = 0, len = opts.accept.length; i < len; i++ ) {\n                        arr.push( opts.accept[ i ].mimeTypes );\n                    }\n\n                    input.attr( 'accept', arr.join(',') );\n                }\n\n                container.append( input );\n                container.append( label );\n\n                mouseHandler = function( e ) {\n                    owner.trigger( e.type );\n                };\n\n                input.on( 'change', function( e ) {\n                    var fn = arguments.callee,\n                        clone;\n\n                    me.files = e.target.files;\n\n                    // reset input\n                    clone = this.cloneNode( true );\n                    clone.value = null;\n                    this.parentNode.replaceChild( clone, this );\n\n                    input.off();\n                    input = $( clone ).on( 'change', fn )\n                            .on( 'mouseenter mouseleave', mouseHandler );\n\n                    owner.trigger('change');\n                });\n\n                label.on( 'mouseenter mouseleave', mouseHandler );\n\n            },\n\n\n            getFiles: function() {\n                return this.files;\n            },\n\n            destroy: function() {\n                this.input.off();\n                this.label.off();\n            }\n        });\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/util',[\n        'base'\n    ], function( Base ) {\n\n        var urlAPI = window.createObjectURL && window ||\n                window.URL && URL.revokeObjectURL && URL ||\n                window.webkitURL,\n            createObjectURL = Base.noop,\n            revokeObjectURL = createObjectURL;\n\n        if ( urlAPI ) {\n\n            // 更安全的方式调用，比如android里面就能把context改成其他的对象。\n            createObjectURL = function() {\n                return urlAPI.createObjectURL.apply( urlAPI, arguments );\n            };\n\n            revokeObjectURL = function() {\n                return urlAPI.revokeObjectURL.apply( urlAPI, arguments );\n            };\n        }\n\n        return {\n            createObjectURL: createObjectURL,\n            revokeObjectURL: revokeObjectURL,\n\n            dataURL2Blob: function( dataURI ) {\n                var byteStr, intArray, ab, i, mimetype, parts;\n\n                parts = dataURI.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n\n                ab = new ArrayBuffer( byteStr.length );\n                intArray = new Uint8Array( ab );\n\n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n\n                mimetype = parts[ 0 ].split(':')[ 1 ].split(';')[ 0 ];\n\n                return this.arrayBufferToBlob( ab, mimetype );\n            },\n\n            dataURL2ArrayBuffer: function( dataURI ) {\n                var byteStr, intArray, i, parts;\n\n                parts = dataURI.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    byteStr = atob( parts[ 1 ] );\n                } else {\n                    byteStr = decodeURIComponent( parts[ 1 ] );\n                }\n\n                intArray = new Uint8Array( byteStr.length );\n\n                for ( i = 0; i < byteStr.length; i++ ) {\n                    intArray[ i ] = byteStr.charCodeAt( i );\n                }\n\n                return intArray.buffer;\n            },\n\n            arrayBufferToBlob: function( buffer, type ) {\n                var builder = window.BlobBuilder || window.WebKitBlobBuilder,\n                    bb;\n\n                // android不支持直接new Blob, 只能借助blobbuilder.\n                if ( builder ) {\n                    bb = new builder();\n                    bb.append( buffer );\n                    return bb.getBlob( type );\n                }\n\n                return new Blob([ buffer ], type ? { type: type } : {} );\n            },\n\n            // 抽出来主要是为了解决android下面canvas.toDataUrl不支持jpeg.\n            // 你得到的结果是png.\n            canvasToDataUrl: function( canvas, type, quality ) {\n                return canvas.toDataURL( type, quality / 100 );\n            },\n\n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            parseMeta: function( blob, callback ) {\n                callback( false, {});\n            },\n\n            // imagemeat会复写这个方法，如果用户选择加载那个文件了的话。\n            updateImageHead: function( data ) {\n                return data;\n            }\n        };\n    });\n    /**\n     * Terms:\n     *\n     * Uint8Array, FileReader, BlobBuilder, atob, ArrayBuffer\n     * @fileOverview Image控件\n     */\n    define('runtime/html5/imagemeta',[\n        'runtime/html5/util'\n    ], function( Util ) {\n\n        var api;\n\n        api = {\n            parsers: {\n                0xffe1: []\n            },\n\n            maxMetaDataSize: 262144,\n\n            parse: function( blob, cb ) {\n                var me = this,\n                    fr = new FileReader();\n\n                fr.onload = function() {\n                    cb( false, me._parse( this.result ) );\n                    fr = fr.onload = fr.onerror = null;\n                };\n\n                fr.onerror = function( e ) {\n                    cb( e.message );\n                    fr = fr.onload = fr.onerror = null;\n                };\n\n                blob = blob.slice( 0, me.maxMetaDataSize );\n                fr.readAsArrayBuffer( blob.getSource() );\n            },\n\n            _parse: function( buffer, noParse ) {\n                if ( buffer.byteLength < 6 ) {\n                    return;\n                }\n\n                var dataview = new DataView( buffer ),\n                    offset = 2,\n                    maxOffset = dataview.byteLength - 4,\n                    headLength = offset,\n                    ret = {},\n                    markerBytes, markerLength, parsers, i;\n\n                if ( dataview.getUint16( 0 ) === 0xffd8 ) {\n\n                    while ( offset < maxOffset ) {\n                        markerBytes = dataview.getUint16( offset );\n\n                        if ( markerBytes >= 0xffe0 && markerBytes <= 0xffef ||\n                                markerBytes === 0xfffe ) {\n\n                            markerLength = dataview.getUint16( offset + 2 ) + 2;\n\n                            if ( offset + markerLength > dataview.byteLength ) {\n                                break;\n                            }\n\n                            parsers = api.parsers[ markerBytes ];\n\n                            if ( !noParse && parsers ) {\n                                for ( i = 0; i < parsers.length; i += 1 ) {\n                                    parsers[ i ].call( api, dataview, offset,\n                                            markerLength, ret );\n                                }\n                            }\n\n                            offset += markerLength;\n                            headLength = offset;\n                        } else {\n                            break;\n                        }\n                    }\n\n                    if ( headLength > 6 ) {\n                        if ( buffer.slice ) {\n                            ret.imageHead = buffer.slice( 2, headLength );\n                        } else {\n                            // Workaround for IE10, which does not yet\n                            // support ArrayBuffer.slice:\n                            ret.imageHead = new Uint8Array( buffer )\n                                    .subarray( 2, headLength );\n                        }\n                    }\n                }\n\n                return ret;\n            },\n\n            updateImageHead: function( buffer, head ) {\n                var data = this._parse( buffer, true ),\n                    buf1, buf2, bodyoffset;\n\n\n                bodyoffset = 2;\n                if ( data.imageHead ) {\n                    bodyoffset = 2 + data.imageHead.byteLength;\n                }\n\n                if ( buffer.slice ) {\n                    buf2 = buffer.slice( bodyoffset );\n                } else {\n                    buf2 = new Uint8Array( buffer ).subarray( bodyoffset );\n                }\n\n                buf1 = new Uint8Array( head.byteLength + 2 + buf2.byteLength );\n\n                buf1[ 0 ] = 0xFF;\n                buf1[ 1 ] = 0xD8;\n                buf1.set( new Uint8Array( head ), 2 );\n                buf1.set( new Uint8Array( buf2 ), head.byteLength + 2 );\n\n                return buf1.buffer;\n            }\n        };\n\n        Util.parseMeta = function() {\n            return api.parse.apply( api, arguments );\n        };\n\n        Util.updateImageHead = function() {\n            return api.updateImageHead.apply( api, arguments );\n        };\n\n        return api;\n    });\n    /**\n     * 代码来自于：https://github.com/blueimp/JavaScript-Load-Image\n     * 暂时项目中只用了orientation.\n     *\n     * 去除了 Exif Sub IFD Pointer, GPS Info IFD Pointer, Exif Thumbnail.\n     * @fileOverview EXIF解析\n     */\n\n    // Sample\n    // ====================================\n    // Make : Apple\n    // Model : iPhone 4S\n    // Orientation : 1\n    // XResolution : 72 [72/1]\n    // YResolution : 72 [72/1]\n    // ResolutionUnit : 2\n    // Software : QuickTime 7.7.1\n    // DateTime : 2013:09:01 22:53:55\n    // ExifIFDPointer : 190\n    // ExposureTime : 0.058823529411764705 [1/17]\n    // FNumber : 2.4 [12/5]\n    // ExposureProgram : Normal program\n    // ISOSpeedRatings : 800\n    // ExifVersion : 0220\n    // DateTimeOriginal : 2013:09:01 22:52:51\n    // DateTimeDigitized : 2013:09:01 22:52:51\n    // ComponentsConfiguration : YCbCr\n    // ShutterSpeedValue : 4.058893515764426\n    // ApertureValue : 2.5260688216892597 [4845/1918]\n    // BrightnessValue : -0.3126686601998395\n    // MeteringMode : Pattern\n    // Flash : Flash did not fire, compulsory flash mode\n    // FocalLength : 4.28 [107/25]\n    // SubjectArea : [4 values]\n    // FlashpixVersion : 0100\n    // ColorSpace : 1\n    // PixelXDimension : 2448\n    // PixelYDimension : 3264\n    // SensingMethod : One-chip color area sensor\n    // ExposureMode : 0\n    // WhiteBalance : Auto white balance\n    // FocalLengthIn35mmFilm : 35\n    // SceneCaptureType : Standard\n    define('runtime/html5/imagemeta/exif',[\n        'base',\n        'runtime/html5/imagemeta'\n    ], function( Base, ImageMeta ) {\n\n        var EXIF = {};\n\n        EXIF.ExifMap = function() {\n            return this;\n        };\n\n        EXIF.ExifMap.prototype.map = {\n            'Orientation': 0x0112\n        };\n\n        EXIF.ExifMap.prototype.get = function( id ) {\n            return this[ id ] || this[ this.map[ id ] ];\n        };\n\n        EXIF.exifTagTypes = {\n            // byte, 8-bit unsigned int:\n            1: {\n                getValue: function( dataView, dataOffset ) {\n                    return dataView.getUint8( dataOffset );\n                },\n                size: 1\n            },\n\n            // ascii, 8-bit byte:\n            2: {\n                getValue: function( dataView, dataOffset ) {\n                    return String.fromCharCode( dataView.getUint8( dataOffset ) );\n                },\n                size: 1,\n                ascii: true\n            },\n\n            // short, 16 bit int:\n            3: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint16( dataOffset, littleEndian );\n                },\n                size: 2\n            },\n\n            // long, 32 bit int:\n            4: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n\n            // rational = two long values,\n            // first is numerator, second is denominator:\n            5: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getUint32( dataOffset, littleEndian ) /\n                        dataView.getUint32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            },\n\n            // slong, 32 bit signed int:\n            9: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian );\n                },\n                size: 4\n            },\n\n            // srational, two slongs, first is numerator, second is denominator:\n            10: {\n                getValue: function( dataView, dataOffset, littleEndian ) {\n                    return dataView.getInt32( dataOffset, littleEndian ) /\n                        dataView.getInt32( dataOffset + 4, littleEndian );\n                },\n                size: 8\n            }\n        };\n\n        // undefined, 8-bit byte, value depending on field:\n        EXIF.exifTagTypes[ 7 ] = EXIF.exifTagTypes[ 1 ];\n\n        EXIF.getExifValue = function( dataView, tiffOffset, offset, type, length,\n                littleEndian ) {\n\n            var tagType = EXIF.exifTagTypes[ type ],\n                tagSize, dataOffset, values, i, str, c;\n\n            if ( !tagType ) {\n                Base.log('Invalid Exif data: Invalid tag type.');\n                return;\n            }\n\n            tagSize = tagType.size * length;\n\n            // Determine if the value is contained in the dataOffset bytes,\n            // or if the value at the dataOffset is a pointer to the actual data:\n            dataOffset = tagSize > 4 ? tiffOffset + dataView.getUint32( offset + 8,\n                    littleEndian ) : (offset + 8);\n\n            if ( dataOffset + tagSize > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid data offset.');\n                return;\n            }\n\n            if ( length === 1 ) {\n                return tagType.getValue( dataView, dataOffset, littleEndian );\n            }\n\n            values = [];\n\n            for ( i = 0; i < length; i += 1 ) {\n                values[ i ] = tagType.getValue( dataView,\n                        dataOffset + i * tagType.size, littleEndian );\n            }\n\n            if ( tagType.ascii ) {\n                str = '';\n\n                // Concatenate the chars:\n                for ( i = 0; i < values.length; i += 1 ) {\n                    c = values[ i ];\n\n                    // Ignore the terminating NULL byte(s):\n                    if ( c === '\\u0000' ) {\n                        break;\n                    }\n                    str += c;\n                }\n\n                return str;\n            }\n            return values;\n        };\n\n        EXIF.parseExifTag = function( dataView, tiffOffset, offset, littleEndian,\n                data ) {\n\n            var tag = dataView.getUint16( offset, littleEndian );\n            data.exif[ tag ] = EXIF.getExifValue( dataView, tiffOffset, offset,\n                    dataView.getUint16( offset + 2, littleEndian ),    // tag type\n                    dataView.getUint32( offset + 4, littleEndian ),    // tag length\n                    littleEndian );\n        };\n\n        EXIF.parseExifTags = function( dataView, tiffOffset, dirOffset,\n                littleEndian, data ) {\n\n            var tagsNumber, dirEndOffset, i;\n\n            if ( dirOffset + 6 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory offset.');\n                return;\n            }\n\n            tagsNumber = dataView.getUint16( dirOffset, littleEndian );\n            dirEndOffset = dirOffset + 2 + 12 * tagsNumber;\n\n            if ( dirEndOffset + 4 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid directory size.');\n                return;\n            }\n\n            for ( i = 0; i < tagsNumber; i += 1 ) {\n                this.parseExifTag( dataView, tiffOffset,\n                        dirOffset + 2 + 12 * i,    // tag offset\n                        littleEndian, data );\n            }\n\n            // Return the offset to the next directory:\n            return dataView.getUint32( dirEndOffset, littleEndian );\n        };\n\n        // EXIF.getExifThumbnail = function(dataView, offset, length) {\n        //     var hexData,\n        //         i,\n        //         b;\n        //     if (!length || offset + length > dataView.byteLength) {\n        //         Base.log('Invalid Exif data: Invalid thumbnail data.');\n        //         return;\n        //     }\n        //     hexData = [];\n        //     for (i = 0; i < length; i += 1) {\n        //         b = dataView.getUint8(offset + i);\n        //         hexData.push((b < 16 ? '0' : '') + b.toString(16));\n        //     }\n        //     return 'data:image/jpeg,%' + hexData.join('%');\n        // };\n\n        EXIF.parseExifData = function( dataView, offset, length, data ) {\n\n            var tiffOffset = offset + 10,\n                littleEndian, dirOffset;\n\n            // Check for the ASCII code for \"Exif\" (0x45786966):\n            if ( dataView.getUint32( offset + 4 ) !== 0x45786966 ) {\n                // No Exif data, might be XMP data instead\n                return;\n            }\n            if ( tiffOffset + 8 > dataView.byteLength ) {\n                Base.log('Invalid Exif data: Invalid segment size.');\n                return;\n            }\n\n            // Check for the two null bytes:\n            if ( dataView.getUint16( offset + 8 ) !== 0x0000 ) {\n                Base.log('Invalid Exif data: Missing byte alignment offset.');\n                return;\n            }\n\n            // Check the byte alignment:\n            switch ( dataView.getUint16( tiffOffset ) ) {\n                case 0x4949:\n                    littleEndian = true;\n                    break;\n\n                case 0x4D4D:\n                    littleEndian = false;\n                    break;\n\n                default:\n                    Base.log('Invalid Exif data: Invalid byte alignment marker.');\n                    return;\n            }\n\n            // Check for the TIFF tag marker (0x002A):\n            if ( dataView.getUint16( tiffOffset + 2, littleEndian ) !== 0x002A ) {\n                Base.log('Invalid Exif data: Missing TIFF marker.');\n                return;\n            }\n\n            // Retrieve the directory offset bytes, usually 0x00000008 or 8 decimal:\n            dirOffset = dataView.getUint32( tiffOffset + 4, littleEndian );\n            // Create the exif object to store the tags:\n            data.exif = new EXIF.ExifMap();\n            // Parse the tags of the main image directory and retrieve the\n            // offset to the next directory, usually the thumbnail directory:\n            dirOffset = EXIF.parseExifTags( dataView, tiffOffset,\n                    tiffOffset + dirOffset, littleEndian, data );\n\n            // 尝试读取缩略图\n            // if ( dirOffset ) {\n            //     thumbnailData = {exif: {}};\n            //     dirOffset = EXIF.parseExifTags(\n            //         dataView,\n            //         tiffOffset,\n            //         tiffOffset + dirOffset,\n            //         littleEndian,\n            //         thumbnailData\n            //     );\n\n            //     // Check for JPEG Thumbnail offset:\n            //     if (thumbnailData.exif[0x0201]) {\n            //         data.exif.Thumbnail = EXIF.getExifThumbnail(\n            //             dataView,\n            //             tiffOffset + thumbnailData.exif[0x0201],\n            //             thumbnailData.exif[0x0202] // Thumbnail data length\n            //         );\n            //     }\n            // }\n        };\n\n        ImageMeta.parsers[ 0xffe1 ].push( EXIF.parseExifData );\n        return EXIF;\n    });\n    /**\n     * 这个方式性能不行，但是可以解决android里面的toDataUrl的bug\n     * android里面toDataUrl('image/jpege')得到的结果却是png.\n     *\n     * 所以这里没辙，只能借助这个工具\n     * @fileOverview jpeg encoder\n     */\n    define('runtime/html5/jpegencoder',[], function( require, exports, module ) {\n\n        /*\n          Copyright (c) 2008, Adobe Systems Incorporated\n          All rights reserved.\n\n          Redistribution and use in source and binary forms, with or without\n          modification, are permitted provided that the following conditions are\n          met:\n\n          * Redistributions of source code must retain the above copyright notice,\n            this list of conditions and the following disclaimer.\n\n          * Redistributions in binary form must reproduce the above copyright\n            notice, this list of conditions and the following disclaimer in the\n            documentation and/or other materials provided with the distribution.\n\n          * Neither the name of Adobe Systems Incorporated nor the names of its\n            contributors may be used to endorse or promote products derived from\n            this software without specific prior written permission.\n\n          THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS\n          IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,\n          THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n          PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n          CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n          EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n          PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n          PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n          LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n          NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n          SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n        */\n        /*\n        JPEG encoder ported to JavaScript and optimized by Andreas Ritter, www.bytestrom.eu, 11/2009\n\n        Basic GUI blocking jpeg encoder\n        */\n\n        function JPEGEncoder(quality) {\n          var self = this;\n            var fround = Math.round;\n            var ffloor = Math.floor;\n            var YTable = new Array(64);\n            var UVTable = new Array(64);\n            var fdtbl_Y = new Array(64);\n            var fdtbl_UV = new Array(64);\n            var YDC_HT;\n            var UVDC_HT;\n            var YAC_HT;\n            var UVAC_HT;\n\n            var bitcode = new Array(65535);\n            var category = new Array(65535);\n            var outputfDCTQuant = new Array(64);\n            var DU = new Array(64);\n            var byteout = [];\n            var bytenew = 0;\n            var bytepos = 7;\n\n            var YDU = new Array(64);\n            var UDU = new Array(64);\n            var VDU = new Array(64);\n            var clt = new Array(256);\n            var RGB_YUV_TABLE = new Array(2048);\n            var currentQuality;\n\n            var ZigZag = [\n                     0, 1, 5, 6,14,15,27,28,\n                     2, 4, 7,13,16,26,29,42,\n                     3, 8,12,17,25,30,41,43,\n                     9,11,18,24,31,40,44,53,\n                    10,19,23,32,39,45,52,54,\n                    20,22,33,38,46,51,55,60,\n                    21,34,37,47,50,56,59,61,\n                    35,36,48,49,57,58,62,63\n                ];\n\n            var std_dc_luminance_nrcodes = [0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0];\n            var std_dc_luminance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_luminance_nrcodes = [0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,0x7d];\n            var std_ac_luminance_values = [\n                    0x01,0x02,0x03,0x00,0x04,0x11,0x05,0x12,\n                    0x21,0x31,0x41,0x06,0x13,0x51,0x61,0x07,\n                    0x22,0x71,0x14,0x32,0x81,0x91,0xa1,0x08,\n                    0x23,0x42,0xb1,0xc1,0x15,0x52,0xd1,0xf0,\n                    0x24,0x33,0x62,0x72,0x82,0x09,0x0a,0x16,\n                    0x17,0x18,0x19,0x1a,0x25,0x26,0x27,0x28,\n                    0x29,0x2a,0x34,0x35,0x36,0x37,0x38,0x39,\n                    0x3a,0x43,0x44,0x45,0x46,0x47,0x48,0x49,\n                    0x4a,0x53,0x54,0x55,0x56,0x57,0x58,0x59,\n                    0x5a,0x63,0x64,0x65,0x66,0x67,0x68,0x69,\n                    0x6a,0x73,0x74,0x75,0x76,0x77,0x78,0x79,\n                    0x7a,0x83,0x84,0x85,0x86,0x87,0x88,0x89,\n                    0x8a,0x92,0x93,0x94,0x95,0x96,0x97,0x98,\n                    0x99,0x9a,0xa2,0xa3,0xa4,0xa5,0xa6,0xa7,\n                    0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,0xb5,0xb6,\n                    0xb7,0xb8,0xb9,0xba,0xc2,0xc3,0xc4,0xc5,\n                    0xc6,0xc7,0xc8,0xc9,0xca,0xd2,0xd3,0xd4,\n                    0xd5,0xd6,0xd7,0xd8,0xd9,0xda,0xe1,0xe2,\n                    0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,0xea,\n                    0xf1,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n\n            var std_dc_chrominance_nrcodes = [0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0];\n            var std_dc_chrominance_values = [0,1,2,3,4,5,6,7,8,9,10,11];\n            var std_ac_chrominance_nrcodes = [0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,0x77];\n            var std_ac_chrominance_values = [\n                    0x00,0x01,0x02,0x03,0x11,0x04,0x05,0x21,\n                    0x31,0x06,0x12,0x41,0x51,0x07,0x61,0x71,\n                    0x13,0x22,0x32,0x81,0x08,0x14,0x42,0x91,\n                    0xa1,0xb1,0xc1,0x09,0x23,0x33,0x52,0xf0,\n                    0x15,0x62,0x72,0xd1,0x0a,0x16,0x24,0x34,\n                    0xe1,0x25,0xf1,0x17,0x18,0x19,0x1a,0x26,\n                    0x27,0x28,0x29,0x2a,0x35,0x36,0x37,0x38,\n                    0x39,0x3a,0x43,0x44,0x45,0x46,0x47,0x48,\n                    0x49,0x4a,0x53,0x54,0x55,0x56,0x57,0x58,\n                    0x59,0x5a,0x63,0x64,0x65,0x66,0x67,0x68,\n                    0x69,0x6a,0x73,0x74,0x75,0x76,0x77,0x78,\n                    0x79,0x7a,0x82,0x83,0x84,0x85,0x86,0x87,\n                    0x88,0x89,0x8a,0x92,0x93,0x94,0x95,0x96,\n                    0x97,0x98,0x99,0x9a,0xa2,0xa3,0xa4,0xa5,\n                    0xa6,0xa7,0xa8,0xa9,0xaa,0xb2,0xb3,0xb4,\n                    0xb5,0xb6,0xb7,0xb8,0xb9,0xba,0xc2,0xc3,\n                    0xc4,0xc5,0xc6,0xc7,0xc8,0xc9,0xca,0xd2,\n                    0xd3,0xd4,0xd5,0xd6,0xd7,0xd8,0xd9,0xda,\n                    0xe2,0xe3,0xe4,0xe5,0xe6,0xe7,0xe8,0xe9,\n                    0xea,0xf2,0xf3,0xf4,0xf5,0xf6,0xf7,0xf8,\n                    0xf9,0xfa\n                ];\n\n            function initQuantTables(sf){\n                    var YQT = [\n                        16, 11, 10, 16, 24, 40, 51, 61,\n                        12, 12, 14, 19, 26, 58, 60, 55,\n                        14, 13, 16, 24, 40, 57, 69, 56,\n                        14, 17, 22, 29, 51, 87, 80, 62,\n                        18, 22, 37, 56, 68,109,103, 77,\n                        24, 35, 55, 64, 81,104,113, 92,\n                        49, 64, 78, 87,103,121,120,101,\n                        72, 92, 95, 98,112,100,103, 99\n                    ];\n\n                    for (var i = 0; i < 64; i++) {\n                        var t = ffloor((YQT[i]*sf+50)/100);\n                        if (t < 1) {\n                            t = 1;\n                        } else if (t > 255) {\n                            t = 255;\n                        }\n                        YTable[ZigZag[i]] = t;\n                    }\n                    var UVQT = [\n                        17, 18, 24, 47, 99, 99, 99, 99,\n                        18, 21, 26, 66, 99, 99, 99, 99,\n                        24, 26, 56, 99, 99, 99, 99, 99,\n                        47, 66, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99,\n                        99, 99, 99, 99, 99, 99, 99, 99\n                    ];\n                    for (var j = 0; j < 64; j++) {\n                        var u = ffloor((UVQT[j]*sf+50)/100);\n                        if (u < 1) {\n                            u = 1;\n                        } else if (u > 255) {\n                            u = 255;\n                        }\n                        UVTable[ZigZag[j]] = u;\n                    }\n                    var aasf = [\n                        1.0, 1.387039845, 1.306562965, 1.175875602,\n                        1.0, 0.785694958, 0.541196100, 0.275899379\n                    ];\n                    var k = 0;\n                    for (var row = 0; row < 8; row++)\n                    {\n                        for (var col = 0; col < 8; col++)\n                        {\n                            fdtbl_Y[k]  = (1.0 / (YTable [ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            fdtbl_UV[k] = (1.0 / (UVTable[ZigZag[k]] * aasf[row] * aasf[col] * 8.0));\n                            k++;\n                        }\n                    }\n                }\n\n                function computeHuffmanTbl(nrcodes, std_table){\n                    var codevalue = 0;\n                    var pos_in_table = 0;\n                    var HT = new Array();\n                    for (var k = 1; k <= 16; k++) {\n                        for (var j = 1; j <= nrcodes[k]; j++) {\n                            HT[std_table[pos_in_table]] = [];\n                            HT[std_table[pos_in_table]][0] = codevalue;\n                            HT[std_table[pos_in_table]][1] = k;\n                            pos_in_table++;\n                            codevalue++;\n                        }\n                        codevalue*=2;\n                    }\n                    return HT;\n                }\n\n                function initHuffmanTbl()\n                {\n                    YDC_HT = computeHuffmanTbl(std_dc_luminance_nrcodes,std_dc_luminance_values);\n                    UVDC_HT = computeHuffmanTbl(std_dc_chrominance_nrcodes,std_dc_chrominance_values);\n                    YAC_HT = computeHuffmanTbl(std_ac_luminance_nrcodes,std_ac_luminance_values);\n                    UVAC_HT = computeHuffmanTbl(std_ac_chrominance_nrcodes,std_ac_chrominance_values);\n                }\n\n                function initCategoryNumber()\n                {\n                    var nrlower = 1;\n                    var nrupper = 2;\n                    for (var cat = 1; cat <= 15; cat++) {\n                        //Positive numbers\n                        for (var nr = nrlower; nr<nrupper; nr++) {\n                            category[32767+nr] = cat;\n                            bitcode[32767+nr] = [];\n                            bitcode[32767+nr][1] = cat;\n                            bitcode[32767+nr][0] = nr;\n                        }\n                        //Negative numbers\n                        for (var nrneg =-(nrupper-1); nrneg<=-nrlower; nrneg++) {\n                            category[32767+nrneg] = cat;\n                            bitcode[32767+nrneg] = [];\n                            bitcode[32767+nrneg][1] = cat;\n                            bitcode[32767+nrneg][0] = nrupper-1+nrneg;\n                        }\n                        nrlower <<= 1;\n                        nrupper <<= 1;\n                    }\n                }\n\n                function initRGBYUVTable() {\n                    for(var i = 0; i < 256;i++) {\n                        RGB_YUV_TABLE[i]            =  19595 * i;\n                        RGB_YUV_TABLE[(i+ 256)>>0]  =  38470 * i;\n                        RGB_YUV_TABLE[(i+ 512)>>0]  =   7471 * i + 0x8000;\n                        RGB_YUV_TABLE[(i+ 768)>>0]  = -11059 * i;\n                        RGB_YUV_TABLE[(i+1024)>>0]  = -21709 * i;\n                        RGB_YUV_TABLE[(i+1280)>>0]  =  32768 * i + 0x807FFF;\n                        RGB_YUV_TABLE[(i+1536)>>0]  = -27439 * i;\n                        RGB_YUV_TABLE[(i+1792)>>0]  = - 5329 * i;\n                    }\n                }\n\n                // IO functions\n                function writeBits(bs)\n                {\n                    var value = bs[0];\n                    var posval = bs[1]-1;\n                    while ( posval >= 0 ) {\n                        if (value & (1 << posval) ) {\n                            bytenew |= (1 << bytepos);\n                        }\n                        posval--;\n                        bytepos--;\n                        if (bytepos < 0) {\n                            if (bytenew == 0xFF) {\n                                writeByte(0xFF);\n                                writeByte(0);\n                            }\n                            else {\n                                writeByte(bytenew);\n                            }\n                            bytepos=7;\n                            bytenew=0;\n                        }\n                    }\n                }\n\n                function writeByte(value)\n                {\n                    byteout.push(clt[value]); // write char directly instead of converting later\n                }\n\n                function writeWord(value)\n                {\n                    writeByte((value>>8)&0xFF);\n                    writeByte((value   )&0xFF);\n                }\n\n                // DCT & quantization core\n                function fDCTQuant(data, fdtbl)\n                {\n                    var d0, d1, d2, d3, d4, d5, d6, d7;\n                    /* Pass 1: process rows. */\n                    var dataOff=0;\n                    var i;\n                    var I8 = 8;\n                    var I64 = 64;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff+1];\n                        d2 = data[dataOff+2];\n                        d3 = data[dataOff+3];\n                        d4 = data[dataOff+4];\n                        d5 = data[dataOff+5];\n                        d6 = data[dataOff+6];\n                        d7 = data[dataOff+7];\n\n                        var tmp0 = d0 + d7;\n                        var tmp7 = d0 - d7;\n                        var tmp1 = d1 + d6;\n                        var tmp6 = d1 - d6;\n                        var tmp2 = d2 + d5;\n                        var tmp5 = d2 - d5;\n                        var tmp3 = d3 + d4;\n                        var tmp4 = d3 - d4;\n\n                        /* Even part */\n                        var tmp10 = tmp0 + tmp3;    /* phase 2 */\n                        var tmp13 = tmp0 - tmp3;\n                        var tmp11 = tmp1 + tmp2;\n                        var tmp12 = tmp1 - tmp2;\n\n                        data[dataOff] = tmp10 + tmp11; /* phase 3 */\n                        data[dataOff+4] = tmp10 - tmp11;\n\n                        var z1 = (tmp12 + tmp13) * 0.707106781; /* c4 */\n                        data[dataOff+2] = tmp13 + z1; /* phase 5 */\n                        data[dataOff+6] = tmp13 - z1;\n\n                        /* Odd part */\n                        tmp10 = tmp4 + tmp5; /* phase 2 */\n                        tmp11 = tmp5 + tmp6;\n                        tmp12 = tmp6 + tmp7;\n\n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5 = (tmp10 - tmp12) * 0.382683433; /* c6 */\n                        var z2 = 0.541196100 * tmp10 + z5; /* c2-c6 */\n                        var z4 = 1.306562965 * tmp12 + z5; /* c2+c6 */\n                        var z3 = tmp11 * 0.707106781; /* c4 */\n\n                        var z11 = tmp7 + z3;    /* phase 5 */\n                        var z13 = tmp7 - z3;\n\n                        data[dataOff+5] = z13 + z2; /* phase 6 */\n                        data[dataOff+3] = z13 - z2;\n                        data[dataOff+1] = z11 + z4;\n                        data[dataOff+7] = z11 - z4;\n\n                        dataOff += 8; /* advance pointer to next row */\n                    }\n\n                    /* Pass 2: process columns. */\n                    dataOff = 0;\n                    for (i=0; i<I8; ++i)\n                    {\n                        d0 = data[dataOff];\n                        d1 = data[dataOff + 8];\n                        d2 = data[dataOff + 16];\n                        d3 = data[dataOff + 24];\n                        d4 = data[dataOff + 32];\n                        d5 = data[dataOff + 40];\n                        d6 = data[dataOff + 48];\n                        d7 = data[dataOff + 56];\n\n                        var tmp0p2 = d0 + d7;\n                        var tmp7p2 = d0 - d7;\n                        var tmp1p2 = d1 + d6;\n                        var tmp6p2 = d1 - d6;\n                        var tmp2p2 = d2 + d5;\n                        var tmp5p2 = d2 - d5;\n                        var tmp3p2 = d3 + d4;\n                        var tmp4p2 = d3 - d4;\n\n                        /* Even part */\n                        var tmp10p2 = tmp0p2 + tmp3p2;  /* phase 2 */\n                        var tmp13p2 = tmp0p2 - tmp3p2;\n                        var tmp11p2 = tmp1p2 + tmp2p2;\n                        var tmp12p2 = tmp1p2 - tmp2p2;\n\n                        data[dataOff] = tmp10p2 + tmp11p2; /* phase 3 */\n                        data[dataOff+32] = tmp10p2 - tmp11p2;\n\n                        var z1p2 = (tmp12p2 + tmp13p2) * 0.707106781; /* c4 */\n                        data[dataOff+16] = tmp13p2 + z1p2; /* phase 5 */\n                        data[dataOff+48] = tmp13p2 - z1p2;\n\n                        /* Odd part */\n                        tmp10p2 = tmp4p2 + tmp5p2; /* phase 2 */\n                        tmp11p2 = tmp5p2 + tmp6p2;\n                        tmp12p2 = tmp6p2 + tmp7p2;\n\n                        /* The rotator is modified from fig 4-8 to avoid extra negations. */\n                        var z5p2 = (tmp10p2 - tmp12p2) * 0.382683433; /* c6 */\n                        var z2p2 = 0.541196100 * tmp10p2 + z5p2; /* c2-c6 */\n                        var z4p2 = 1.306562965 * tmp12p2 + z5p2; /* c2+c6 */\n                        var z3p2 = tmp11p2 * 0.707106781; /* c4 */\n\n                        var z11p2 = tmp7p2 + z3p2;  /* phase 5 */\n                        var z13p2 = tmp7p2 - z3p2;\n\n                        data[dataOff+40] = z13p2 + z2p2; /* phase 6 */\n                        data[dataOff+24] = z13p2 - z2p2;\n                        data[dataOff+ 8] = z11p2 + z4p2;\n                        data[dataOff+56] = z11p2 - z4p2;\n\n                        dataOff++; /* advance pointer to next column */\n                    }\n\n                    // Quantize/descale the coefficients\n                    var fDCTQuant;\n                    for (i=0; i<I64; ++i)\n                    {\n                        // Apply the quantization and scaling factor & Round to nearest integer\n                        fDCTQuant = data[i]*fdtbl[i];\n                        outputfDCTQuant[i] = (fDCTQuant > 0.0) ? ((fDCTQuant + 0.5)|0) : ((fDCTQuant - 0.5)|0);\n                        //outputfDCTQuant[i] = fround(fDCTQuant);\n\n                    }\n                    return outputfDCTQuant;\n                }\n\n                function writeAPP0()\n                {\n                    writeWord(0xFFE0); // marker\n                    writeWord(16); // length\n                    writeByte(0x4A); // J\n                    writeByte(0x46); // F\n                    writeByte(0x49); // I\n                    writeByte(0x46); // F\n                    writeByte(0); // = \"JFIF\",'\\0'\n                    writeByte(1); // versionhi\n                    writeByte(1); // versionlo\n                    writeByte(0); // xyunits\n                    writeWord(1); // xdensity\n                    writeWord(1); // ydensity\n                    writeByte(0); // thumbnwidth\n                    writeByte(0); // thumbnheight\n                }\n\n                function writeSOF0(width, height)\n                {\n                    writeWord(0xFFC0); // marker\n                    writeWord(17);   // length, truecolor YUV JPG\n                    writeByte(8);    // precision\n                    writeWord(height);\n                    writeWord(width);\n                    writeByte(3);    // nrofcomponents\n                    writeByte(1);    // IdY\n                    writeByte(0x11); // HVY\n                    writeByte(0);    // QTY\n                    writeByte(2);    // IdU\n                    writeByte(0x11); // HVU\n                    writeByte(1);    // QTU\n                    writeByte(3);    // IdV\n                    writeByte(0x11); // HVV\n                    writeByte(1);    // QTV\n                }\n\n                function writeDQT()\n                {\n                    writeWord(0xFFDB); // marker\n                    writeWord(132);    // length\n                    writeByte(0);\n                    for (var i=0; i<64; i++) {\n                        writeByte(YTable[i]);\n                    }\n                    writeByte(1);\n                    for (var j=0; j<64; j++) {\n                        writeByte(UVTable[j]);\n                    }\n                }\n\n                function writeDHT()\n                {\n                    writeWord(0xFFC4); // marker\n                    writeWord(0x01A2); // length\n\n                    writeByte(0); // HTYDCinfo\n                    for (var i=0; i<16; i++) {\n                        writeByte(std_dc_luminance_nrcodes[i+1]);\n                    }\n                    for (var j=0; j<=11; j++) {\n                        writeByte(std_dc_luminance_values[j]);\n                    }\n\n                    writeByte(0x10); // HTYACinfo\n                    for (var k=0; k<16; k++) {\n                        writeByte(std_ac_luminance_nrcodes[k+1]);\n                    }\n                    for (var l=0; l<=161; l++) {\n                        writeByte(std_ac_luminance_values[l]);\n                    }\n\n                    writeByte(1); // HTUDCinfo\n                    for (var m=0; m<16; m++) {\n                        writeByte(std_dc_chrominance_nrcodes[m+1]);\n                    }\n                    for (var n=0; n<=11; n++) {\n                        writeByte(std_dc_chrominance_values[n]);\n                    }\n\n                    writeByte(0x11); // HTUACinfo\n                    for (var o=0; o<16; o++) {\n                        writeByte(std_ac_chrominance_nrcodes[o+1]);\n                    }\n                    for (var p=0; p<=161; p++) {\n                        writeByte(std_ac_chrominance_values[p]);\n                    }\n                }\n\n                function writeSOS()\n                {\n                    writeWord(0xFFDA); // marker\n                    writeWord(12); // length\n                    writeByte(3); // nrofcomponents\n                    writeByte(1); // IdY\n                    writeByte(0); // HTY\n                    writeByte(2); // IdU\n                    writeByte(0x11); // HTU\n                    writeByte(3); // IdV\n                    writeByte(0x11); // HTV\n                    writeByte(0); // Ss\n                    writeByte(0x3f); // Se\n                    writeByte(0); // Bf\n                }\n\n                function processDU(CDU, fdtbl, DC, HTDC, HTAC){\n                    var EOB = HTAC[0x00];\n                    var M16zeroes = HTAC[0xF0];\n                    var pos;\n                    var I16 = 16;\n                    var I63 = 63;\n                    var I64 = 64;\n                    var DU_DCT = fDCTQuant(CDU, fdtbl);\n                    //ZigZag reorder\n                    for (var j=0;j<I64;++j) {\n                        DU[ZigZag[j]]=DU_DCT[j];\n                    }\n                    var Diff = DU[0] - DC; DC = DU[0];\n                    //Encode DC\n                    if (Diff==0) {\n                        writeBits(HTDC[0]); // Diff might be 0\n                    } else {\n                        pos = 32767+Diff;\n                        writeBits(HTDC[category[pos]]);\n                        writeBits(bitcode[pos]);\n                    }\n                    //Encode ACs\n                    var end0pos = 63; // was const... which is crazy\n                    for (; (end0pos>0)&&(DU[end0pos]==0); end0pos--) {}\n                    //end0pos = first element in reverse order !=0\n                    if ( end0pos == 0) {\n                        writeBits(EOB);\n                        return DC;\n                    }\n                    var i = 1;\n                    var lng;\n                    while ( i <= end0pos ) {\n                        var startpos = i;\n                        for (; (DU[i]==0) && (i<=end0pos); ++i) {}\n                        var nrzeroes = i-startpos;\n                        if ( nrzeroes >= I16 ) {\n                            lng = nrzeroes>>4;\n                            for (var nrmarker=1; nrmarker <= lng; ++nrmarker)\n                                writeBits(M16zeroes);\n                            nrzeroes = nrzeroes&0xF;\n                        }\n                        pos = 32767+DU[i];\n                        writeBits(HTAC[(nrzeroes<<4)+category[pos]]);\n                        writeBits(bitcode[pos]);\n                        i++;\n                    }\n                    if ( end0pos != I63 ) {\n                        writeBits(EOB);\n                    }\n                    return DC;\n                }\n\n                function initCharLookupTable(){\n                    var sfcc = String.fromCharCode;\n                    for(var i=0; i < 256; i++){ ///// ACHTUNG // 255\n                        clt[i] = sfcc(i);\n                    }\n                }\n\n                this.encode = function(image,quality) // image data object\n                {\n                    // var time_start = new Date().getTime();\n\n                    if(quality) setQuality(quality);\n\n                    // Initialize bit writer\n                    byteout = new Array();\n                    bytenew=0;\n                    bytepos=7;\n\n                    // Add JPEG headers\n                    writeWord(0xFFD8); // SOI\n                    writeAPP0();\n                    writeDQT();\n                    writeSOF0(image.width,image.height);\n                    writeDHT();\n                    writeSOS();\n\n\n                    // Encode 8x8 macroblocks\n                    var DCY=0;\n                    var DCU=0;\n                    var DCV=0;\n\n                    bytenew=0;\n                    bytepos=7;\n\n\n                    this.encode.displayName = \"_encode_\";\n\n                    var imageData = image.data;\n                    var width = image.width;\n                    var height = image.height;\n\n                    var quadWidth = width*4;\n                    var tripleWidth = width*3;\n\n                    var x, y = 0;\n                    var r, g, b;\n                    var start,p, col,row,pos;\n                    while(y < height){\n                        x = 0;\n                        while(x < quadWidth){\n                        start = quadWidth * y + x;\n                        p = start;\n                        col = -1;\n                        row = 0;\n\n                        for(pos=0; pos < 64; pos++){\n                            row = pos >> 3;// /8\n                            col = ( pos & 7 ) * 4; // %8\n                            p = start + ( row * quadWidth ) + col;\n\n                            if(y+row >= height){ // padding bottom\n                                p-= (quadWidth*(y+1+row-height));\n                            }\n\n                            if(x+col >= quadWidth){ // padding right\n                                p-= ((x+col) - quadWidth +4)\n                            }\n\n                            r = imageData[ p++ ];\n                            g = imageData[ p++ ];\n                            b = imageData[ p++ ];\n\n\n                            /* // calculate YUV values dynamically\n                            YDU[pos]=((( 0.29900)*r+( 0.58700)*g+( 0.11400)*b))-128; //-0x80\n                            UDU[pos]=(((-0.16874)*r+(-0.33126)*g+( 0.50000)*b));\n                            VDU[pos]=((( 0.50000)*r+(-0.41869)*g+(-0.08131)*b));\n                            */\n\n                            // use lookup table (slightly faster)\n                            YDU[pos] = ((RGB_YUV_TABLE[r]             + RGB_YUV_TABLE[(g +  256)>>0] + RGB_YUV_TABLE[(b +  512)>>0]) >> 16)-128;\n                            UDU[pos] = ((RGB_YUV_TABLE[(r +  768)>>0] + RGB_YUV_TABLE[(g + 1024)>>0] + RGB_YUV_TABLE[(b + 1280)>>0]) >> 16)-128;\n                            VDU[pos] = ((RGB_YUV_TABLE[(r + 1280)>>0] + RGB_YUV_TABLE[(g + 1536)>>0] + RGB_YUV_TABLE[(b + 1792)>>0]) >> 16)-128;\n\n                        }\n\n                        DCY = processDU(YDU, fdtbl_Y, DCY, YDC_HT, YAC_HT);\n                        DCU = processDU(UDU, fdtbl_UV, DCU, UVDC_HT, UVAC_HT);\n                        DCV = processDU(VDU, fdtbl_UV, DCV, UVDC_HT, UVAC_HT);\n                        x+=32;\n                        }\n                        y+=8;\n                    }\n\n\n                    ////////////////////////////////////////////////////////////////\n\n                    // Do the bit alignment of the EOI marker\n                    if ( bytepos >= 0 ) {\n                        var fillbits = [];\n                        fillbits[1] = bytepos+1;\n                        fillbits[0] = (1<<(bytepos+1))-1;\n                        writeBits(fillbits);\n                    }\n\n                    writeWord(0xFFD9); //EOI\n\n                    var jpegDataUri = 'data:image/jpeg;base64,' + btoa(byteout.join(''));\n\n                    byteout = [];\n\n                    // benchmarking\n                    // var duration = new Date().getTime() - time_start;\n                    // console.log('Encoding time: '+ currentQuality + 'ms');\n                    //\n\n                    return jpegDataUri\n            }\n\n            function setQuality(quality){\n                if (quality <= 0) {\n                    quality = 1;\n                }\n                if (quality > 100) {\n                    quality = 100;\n                }\n\n                if(currentQuality == quality) return // don't recalc if unchanged\n\n                var sf = 0;\n                if (quality < 50) {\n                    sf = Math.floor(5000 / quality);\n                } else {\n                    sf = Math.floor(200 - quality*2);\n                }\n\n                initQuantTables(sf);\n                currentQuality = quality;\n                // console.log('Quality set to: '+quality +'%');\n            }\n\n            function init(){\n                // var time_start = new Date().getTime();\n                if(!quality) quality = 50;\n                // Create tables\n                initCharLookupTable()\n                initHuffmanTbl();\n                initCategoryNumber();\n                initRGBYUVTable();\n\n                setQuality(quality);\n                // var duration = new Date().getTime() - time_start;\n                // console.log('Initialization '+ duration + 'ms');\n            }\n\n            init();\n\n        }\n\n        JPEGEncoder.encode = function( data, quality ) {\n            var encoder = new JPEGEncoder( quality );\n\n            return encoder.encode( data );\n        }\n\n        return JPEGEncoder;\n    });\n    /**\n     * @fileOverview Fix android canvas.toDataUrl bug.\n     */\n    define('runtime/html5/androidpatch',[\n        'runtime/html5/util',\n        'runtime/html5/jpegencoder',\n        'base'\n    ], function( Util, encoder, Base ) {\n        var origin = Util.canvasToDataUrl,\n            supportJpeg;\n\n        Util.canvasToDataUrl = function( canvas, type, quality ) {\n            var ctx, w, h, fragement, parts;\n\n            // 非android手机直接跳过。\n            if ( !Base.os.android ) {\n                return origin.apply( null, arguments );\n            }\n\n            // 检测是否canvas支持jpeg导出，根据数据格式来判断。\n            // JPEG 前两位分别是：255, 216\n            if ( type === 'image/jpeg' && typeof supportJpeg === 'undefined' ) {\n                fragement = origin.apply( null, arguments );\n\n                parts = fragement.split(',');\n\n                if ( ~parts[ 0 ].indexOf('base64') ) {\n                    fragement = atob( parts[ 1 ] );\n                } else {\n                    fragement = decodeURIComponent( parts[ 1 ] );\n                }\n\n                fragement = fragement.substring( 0, 2 );\n\n                supportJpeg = fragement.charCodeAt( 0 ) === 255 &&\n                        fragement.charCodeAt( 1 ) === 216;\n            }\n\n            // 只有在android环境下才修复\n            if ( type === 'image/jpeg' && !supportJpeg ) {\n                w = canvas.width;\n                h = canvas.height;\n                ctx = canvas.getContext('2d');\n\n                return encoder.encode( ctx.getImageData( 0, 0, w, h ), quality );\n            }\n\n            return origin.apply( null, arguments );\n        };\n    });\n    /**\n     * @fileOverview Image\n     */\n    define('runtime/html5/image',[\n        'base',\n        'runtime/html5/runtime',\n        'runtime/html5/util'\n    ], function( Base, Html5Runtime, Util ) {\n\n        var BLANK = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D';\n\n        return Html5Runtime.register( 'Image', {\n\n            // flag: 标记是否被修改过。\n            modified: false,\n\n            init: function() {\n                var me = this,\n                    img = new Image();\n\n                img.onload = function() {\n\n                    me._info = {\n                        type: me.type,\n                        width: this.width,\n                        height: this.height\n                    };\n\n                    // 读取meta信息。\n                    if ( !me._metas && 'image/jpeg' === me.type ) {\n                        Util.parseMeta( me._blob, function( error, ret ) {\n                            me._metas = ret;\n                            me.owner.trigger('load');\n                        });\n                    } else {\n                        me.owner.trigger('load');\n                    }\n                };\n\n                img.onerror = function() {\n                    me.owner.trigger('error');\n                };\n\n                me._img = img;\n            },\n\n            loadFromBlob: function( blob ) {\n                var me = this,\n                    img = me._img;\n\n                me._blob = blob;\n                me.type = blob.type;\n                img.src = Util.createObjectURL( blob.getSource() );\n                me.owner.once( 'load', function() {\n                    Util.revokeObjectURL( img.src );\n                });\n            },\n\n            resize: function( width, height ) {\n                var canvas = this._canvas ||\n                        (this._canvas = document.createElement('canvas'));\n\n                this._resize( this._img, canvas, width, height );\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'resize' );\n            },\n\n            crop: function( x, y, w, h, s ) {\n                var cvs = this._canvas ||\n                        (this._canvas = document.createElement('canvas')),\n                    opts = this.options,\n                    img = this._img,\n                    iw = img.naturalWidth,\n                    ih = img.naturalHeight,\n                    orientation = this.getOrientation();\n\n                s = s || 1;\n\n                // todo 解决 orientation 的问题。\n                // values that require 90 degree rotation\n                // if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\n                //     switch ( orientation ) {\n                //         case 6:\n                //             tmp = x;\n                //             x = y;\n                //             y = iw * s - tmp - w;\n                //             console.log(ih * s, tmp, w)\n                //             break;\n                //     }\n\n                //     (w ^= h, h ^= w, w ^= h);\n                // }\n\n                cvs.width = w;\n                cvs.height = h;\n\n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n                this._renderImageToCanvas( cvs, img, -x, -y, iw * s, ih * s );\n\n                this._blob = null;    // 没用了，可以删掉了。\n                this.modified = true;\n                this.owner.trigger( 'complete', 'crop' );\n            },\n\n            getAsBlob: function( type ) {\n                var blob = this._blob,\n                    opts = this.options,\n                    canvas;\n\n                type = type || this.type;\n\n                // blob需要重新生成。\n                if ( this.modified || this.type !== type ) {\n                    canvas = this._canvas;\n\n                    if ( type === 'image/jpeg' ) {\n\n                        blob = Util.canvasToDataUrl( canvas, type, opts.quality );\n\n                        if ( opts.preserveHeaders && this._metas &&\n                                this._metas.imageHead ) {\n\n                            blob = Util.dataURL2ArrayBuffer( blob );\n                            blob = Util.updateImageHead( blob,\n                                    this._metas.imageHead );\n                            blob = Util.arrayBufferToBlob( blob, type );\n                            return blob;\n                        }\n                    } else {\n                        blob = Util.canvasToDataUrl( canvas, type );\n                    }\n\n                    blob = Util.dataURL2Blob( blob );\n                }\n\n                return blob;\n            },\n\n            getAsDataUrl: function( type ) {\n                var opts = this.options;\n\n                type = type || this.type;\n\n                if ( type === 'image/jpeg' ) {\n                    return Util.canvasToDataUrl( this._canvas, type, opts.quality );\n                } else {\n                    return this._canvas.toDataURL( type );\n                }\n            },\n\n            getOrientation: function() {\n                return this._metas && this._metas.exif &&\n                        this._metas.exif.get('Orientation') || 1;\n            },\n\n            info: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._info = val;\n                    return this;\n                }\n\n                // getter\n                return this._info;\n            },\n\n            meta: function( val ) {\n\n                // setter\n                if ( val ) {\n                    this._meta = val;\n                    return this;\n                }\n\n                // getter\n                return this._meta;\n            },\n\n            destroy: function() {\n                var canvas = this._canvas;\n                this._img.onload = null;\n\n                if ( canvas ) {\n                    canvas.getContext('2d')\n                            .clearRect( 0, 0, canvas.width, canvas.height );\n                    canvas.width = canvas.height = 0;\n                    this._canvas = null;\n                }\n\n                // 释放内存。非常重要，否则释放不了image的内存。\n                this._img.src = BLANK;\n                this._img = this._blob = null;\n            },\n\n            _resize: function( img, cvs, width, height ) {\n                var opts = this.options,\n                    naturalWidth = img.width,\n                    naturalHeight = img.height,\n                    orientation = this.getOrientation(),\n                    scale, w, h, x, y;\n\n                // values that require 90 degree rotation\n                if ( ~[ 5, 6, 7, 8 ].indexOf( orientation ) ) {\n\n                    // 交换width, height的值。\n                    width ^= height;\n                    height ^= width;\n                    width ^= height;\n                }\n\n                scale = Math[ opts.crop ? 'max' : 'min' ]( width / naturalWidth,\n                        height / naturalHeight );\n\n                // 不允许放大。\n                opts.allowMagnify || (scale = Math.min( 1, scale ));\n\n                w = naturalWidth * scale;\n                h = naturalHeight * scale;\n\n                if ( opts.crop ) {\n                    cvs.width = width;\n                    cvs.height = height;\n                } else {\n                    cvs.width = w;\n                    cvs.height = h;\n                }\n\n                x = (cvs.width - w) / 2;\n                y = (cvs.height - h) / 2;\n\n                opts.preserveHeaders || this._rotate2Orientaion( cvs, orientation );\n\n                this._renderImageToCanvas( cvs, img, x, y, w, h );\n            },\n\n            _rotate2Orientaion: function( canvas, orientation ) {\n                var width = canvas.width,\n                    height = canvas.height,\n                    ctx = canvas.getContext('2d');\n\n                switch ( orientation ) {\n                    case 5:\n                    case 6:\n                    case 7:\n                    case 8:\n                        canvas.width = height;\n                        canvas.height = width;\n                        break;\n                }\n\n                switch ( orientation ) {\n                    case 2:    // horizontal flip\n                        ctx.translate( width, 0 );\n                        ctx.scale( -1, 1 );\n                        break;\n\n                    case 3:    // 180 rotate left\n                        ctx.translate( width, height );\n                        ctx.rotate( Math.PI );\n                        break;\n\n                    case 4:    // vertical flip\n                        ctx.translate( 0, height );\n                        ctx.scale( 1, -1 );\n                        break;\n\n                    case 5:    // vertical flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.scale( 1, -1 );\n                        break;\n\n                    case 6:    // 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( 0, -height );\n                        break;\n\n                    case 7:    // horizontal flip + 90 rotate right\n                        ctx.rotate( 0.5 * Math.PI );\n                        ctx.translate( width, -height );\n                        ctx.scale( -1, 1 );\n                        break;\n\n                    case 8:    // 90 rotate left\n                        ctx.rotate( -0.5 * Math.PI );\n                        ctx.translate( -width, 0 );\n                        break;\n                }\n            },\n\n            // https://github.com/stomita/ios-imagefile-megapixel/\n            // blob/master/src/megapix-image.js\n            _renderImageToCanvas: (function() {\n\n                // 如果不是ios, 不需要这么复杂！\n                if ( !Base.os.ios ) {\n                    return function( canvas ) {\n                        var args = Base.slice( arguments, 1 ),\n                            ctx = canvas.getContext('2d');\n\n                        ctx.drawImage.apply( ctx, args );\n                    };\n                }\n\n                /**\n                 * Detecting vertical squash in loaded image.\n                 * Fixes a bug which squash image vertically while drawing into\n                 * canvas for some images.\n                 */\n                function detectVerticalSquash( img, iw, ih ) {\n                    var canvas = document.createElement('canvas'),\n                        ctx = canvas.getContext('2d'),\n                        sy = 0,\n                        ey = ih,\n                        py = ih,\n                        data, alpha, ratio;\n\n\n                    canvas.width = 1;\n                    canvas.height = ih;\n                    ctx.drawImage( img, 0, 0 );\n                    data = ctx.getImageData( 0, 0, 1, ih ).data;\n\n                    // search image edge pixel position in case\n                    // it is squashed vertically.\n                    while ( py > sy ) {\n                        alpha = data[ (py - 1) * 4 + 3 ];\n\n                        if ( alpha === 0 ) {\n                            ey = py;\n                        } else {\n                            sy = py;\n                        }\n\n                        py = (ey + sy) >> 1;\n                    }\n\n                    ratio = (py / ih);\n                    return (ratio === 0) ? 1 : ratio;\n                }\n\n                // fix ie7 bug\n                // http://stackoverflow.com/questions/11929099/\n                // html5-canvas-drawimage-ratio-bug-ios\n                if ( Base.os.ios >= 7 ) {\n                    return function( canvas, img, x, y, w, h ) {\n                        var iw = img.naturalWidth,\n                            ih = img.naturalHeight,\n                            vertSquashRatio = detectVerticalSquash( img, iw, ih );\n\n                        return canvas.getContext('2d').drawImage( img, 0, 0,\n                                iw * vertSquashRatio, ih * vertSquashRatio,\n                                x, y, w, h );\n                    };\n                }\n\n                /**\n                 * Detect subsampling in loaded image.\n                 * In iOS, larger images than 2M pixels may be\n                 * subsampled in rendering.\n                 */\n                function detectSubsampling( img ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        canvas, ctx;\n\n                    // subsampling may happen overmegapixel image\n                    if ( iw * ih > 1024 * 1024 ) {\n                        canvas = document.createElement('canvas');\n                        canvas.width = canvas.height = 1;\n                        ctx = canvas.getContext('2d');\n                        ctx.drawImage( img, -iw + 1, 0 );\n\n                        // subsampled image becomes half smaller in rendering size.\n                        // check alpha channel value to confirm image is covering\n                        // edge pixel or not. if alpha value is 0\n                        // image is not covering, hence subsampled.\n                        return ctx.getImageData( 0, 0, 1, 1 ).data[ 3 ] === 0;\n                    } else {\n                        return false;\n                    }\n                }\n\n\n                return function( canvas, img, x, y, width, height ) {\n                    var iw = img.naturalWidth,\n                        ih = img.naturalHeight,\n                        ctx = canvas.getContext('2d'),\n                        subsampled = detectSubsampling( img ),\n                        doSquash = this.type === 'image/jpeg',\n                        d = 1024,\n                        sy = 0,\n                        dy = 0,\n                        tmpCanvas, tmpCtx, vertSquashRatio, dw, dh, sx, dx;\n\n                    if ( subsampled ) {\n                        iw /= 2;\n                        ih /= 2;\n                    }\n\n                    ctx.save();\n                    tmpCanvas = document.createElement('canvas');\n                    tmpCanvas.width = tmpCanvas.height = d;\n\n                    tmpCtx = tmpCanvas.getContext('2d');\n                    vertSquashRatio = doSquash ?\n                            detectVerticalSquash( img, iw, ih ) : 1;\n\n                    dw = Math.ceil( d * width / iw );\n                    dh = Math.ceil( d * height / ih / vertSquashRatio );\n\n                    while ( sy < ih ) {\n                        sx = 0;\n                        dx = 0;\n                        while ( sx < iw ) {\n                            tmpCtx.clearRect( 0, 0, d, d );\n                            tmpCtx.drawImage( img, -sx, -sy );\n                            ctx.drawImage( tmpCanvas, 0, 0, d, d,\n                                    x + dx, y + dy, dw, dh );\n                            sx += d;\n                            dx += dw;\n                        }\n                        sy += d;\n                        dy += dh;\n                    }\n                    ctx.restore();\n                    tmpCanvas = tmpCtx = null;\n                };\n            })()\n        });\n    });\n    /**\n     * @fileOverview Transport\n     * @todo 支持chunked传输，优势：\n     * 可以将大文件分成小块，挨个传输，可以提高大文件成功率，当失败的时候，也只需要重传那小部分，\n     * 而不需要重头再传一次。另外断点续传也需要用chunked方式。\n     */\n    define('runtime/html5/transport',[\n        'base',\n        'runtime/html5/runtime'\n    ], function( Base, Html5Runtime ) {\n\n        var noop = Base.noop,\n            $ = Base.$;\n\n        return Html5Runtime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n            },\n\n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    formData, binary, fr;\n\n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n\n                    binary = blob.getSource();\n                } else {\n                    formData = new FormData();\n                    $.each( owner._formData, function( k, v ) {\n                        formData.append( k, v );\n                    });\n\n                    formData.append( opts.fileVal, blob.getSource(),\n                            opts.filename || owner._formData.name || '' );\n                }\n\n                if ( opts.withCredentials && 'withCredentials' in xhr ) {\n                    xhr.open( opts.method, server, true );\n                    xhr.withCredentials = true;\n                } else {\n                    xhr.open( opts.method, server );\n                }\n\n                this._setRequestHeader( xhr, opts.headers );\n\n                if ( binary ) {\n                    // 强制设置成 content-type 为文件流。\n                    xhr.overrideMimeType &&\n                            xhr.overrideMimeType('application/octet-stream');\n\n                    // android直接发送blob会导致服务端接收到的是空文件。\n                    // bug详情。\n                    // https://code.google.com/p/android/issues/detail?id=39882\n                    // 所以先用fileReader读取出来再通过arraybuffer的方式发送。\n                    if ( Base.os.android ) {\n                        fr = new FileReader();\n\n                        fr.onload = function() {\n                            xhr.send( this.result );\n                            fr = fr.onload = null;\n                        };\n\n                        fr.readAsArrayBuffer( binary );\n                    } else {\n                        xhr.send( binary );\n                    }\n                } else {\n                    xhr.send( formData );\n                }\n            },\n\n            getResponse: function() {\n                return this._response;\n            },\n\n            getResponseAsJson: function() {\n                return this._parseJson( this._response );\n            },\n\n            getStatus: function() {\n                return this._status;\n            },\n\n            abort: function() {\n                var xhr = this._xhr;\n\n                if ( xhr ) {\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    xhr.abort();\n\n                    this._xhr = xhr = null;\n                }\n            },\n\n            destroy: function() {\n                this.abort();\n            },\n\n            _initAjax: function() {\n                var me = this,\n                    xhr = new XMLHttpRequest(),\n                    opts = this.options;\n\n                if ( opts.withCredentials && !('withCredentials' in xhr) &&\n                        typeof XDomainRequest !== 'undefined' ) {\n                    xhr = new XDomainRequest();\n                }\n\n                xhr.upload.onprogress = function( e ) {\n                    var percentage = 0;\n\n                    if ( e.lengthComputable ) {\n                        percentage = e.loaded / e.total;\n                    }\n\n                    return me.trigger( 'progress', percentage );\n                };\n\n                xhr.onreadystatechange = function() {\n\n                    if ( xhr.readyState !== 4 ) {\n                        return;\n                    }\n\n                    xhr.upload.onprogress = noop;\n                    xhr.onreadystatechange = noop;\n                    me._xhr = null;\n                    me._status = xhr.status;\n\n                    if ( xhr.status >= 200 && xhr.status < 300 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger('load');\n                    } else if ( xhr.status >= 500 && xhr.status < 600 ) {\n                        me._response = xhr.responseText;\n                        return me.trigger( 'error', 'server' );\n                    }\n\n\n                    return me.trigger( 'error', me._status ? 'http' : 'abort' );\n                };\n\n                me._xhr = xhr;\n                return xhr;\n            },\n\n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.setRequestHeader( key, val );\n                });\n            },\n\n            _parseJson: function( str ) {\n                var json;\n\n                try {\n                    json = JSON.parse( str );\n                } catch ( ex ) {\n                    json = {};\n                }\n\n                return json;\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/html5/md5',[\n        'runtime/html5/runtime'\n    ], function( FlashRuntime ) {\n\n        /*\n         * Fastest md5 implementation around (JKM md5)\n         * Credits: Joseph Myers\n         *\n         * @see http://www.myersdaily.org/joseph/javascript/md5-text.html\n         * @see http://jsperf.com/md5-shootout/7\n         */\n\n        /* this function is much faster,\n          so if possible we use it. Some IEs\n          are the only ones I know of that\n          need the idiotic second function,\n          generated by an if clause.  */\n        var add32 = function (a, b) {\n            return (a + b) & 0xFFFFFFFF;\n        },\n\n        cmn = function (q, a, b, x, s, t) {\n            a = add32(add32(a, q), add32(x, t));\n            return add32((a << s) | (a >>> (32 - s)), b);\n        },\n\n        ff = function (a, b, c, d, x, s, t) {\n            return cmn((b & c) | ((~b) & d), a, b, x, s, t);\n        },\n\n        gg = function (a, b, c, d, x, s, t) {\n            return cmn((b & d) | (c & (~d)), a, b, x, s, t);\n        },\n\n        hh = function (a, b, c, d, x, s, t) {\n            return cmn(b ^ c ^ d, a, b, x, s, t);\n        },\n\n        ii = function (a, b, c, d, x, s, t) {\n            return cmn(c ^ (b | (~d)), a, b, x, s, t);\n        },\n\n        md5cycle = function (x, k) {\n            var a = x[0],\n                b = x[1],\n                c = x[2],\n                d = x[3];\n\n            a = ff(a, b, c, d, k[0], 7, -680876936);\n            d = ff(d, a, b, c, k[1], 12, -389564586);\n            c = ff(c, d, a, b, k[2], 17, 606105819);\n            b = ff(b, c, d, a, k[3], 22, -1044525330);\n            a = ff(a, b, c, d, k[4], 7, -176418897);\n            d = ff(d, a, b, c, k[5], 12, 1200080426);\n            c = ff(c, d, a, b, k[6], 17, -1473231341);\n            b = ff(b, c, d, a, k[7], 22, -45705983);\n            a = ff(a, b, c, d, k[8], 7, 1770035416);\n            d = ff(d, a, b, c, k[9], 12, -1958414417);\n            c = ff(c, d, a, b, k[10], 17, -42063);\n            b = ff(b, c, d, a, k[11], 22, -1990404162);\n            a = ff(a, b, c, d, k[12], 7, 1804603682);\n            d = ff(d, a, b, c, k[13], 12, -40341101);\n            c = ff(c, d, a, b, k[14], 17, -1502002290);\n            b = ff(b, c, d, a, k[15], 22, 1236535329);\n\n            a = gg(a, b, c, d, k[1], 5, -165796510);\n            d = gg(d, a, b, c, k[6], 9, -1069501632);\n            c = gg(c, d, a, b, k[11], 14, 643717713);\n            b = gg(b, c, d, a, k[0], 20, -373897302);\n            a = gg(a, b, c, d, k[5], 5, -701558691);\n            d = gg(d, a, b, c, k[10], 9, 38016083);\n            c = gg(c, d, a, b, k[15], 14, -660478335);\n            b = gg(b, c, d, a, k[4], 20, -405537848);\n            a = gg(a, b, c, d, k[9], 5, 568446438);\n            d = gg(d, a, b, c, k[14], 9, -1019803690);\n            c = gg(c, d, a, b, k[3], 14, -187363961);\n            b = gg(b, c, d, a, k[8], 20, 1163531501);\n            a = gg(a, b, c, d, k[13], 5, -1444681467);\n            d = gg(d, a, b, c, k[2], 9, -51403784);\n            c = gg(c, d, a, b, k[7], 14, 1735328473);\n            b = gg(b, c, d, a, k[12], 20, -1926607734);\n\n            a = hh(a, b, c, d, k[5], 4, -378558);\n            d = hh(d, a, b, c, k[8], 11, -2022574463);\n            c = hh(c, d, a, b, k[11], 16, 1839030562);\n            b = hh(b, c, d, a, k[14], 23, -35309556);\n            a = hh(a, b, c, d, k[1], 4, -1530992060);\n            d = hh(d, a, b, c, k[4], 11, 1272893353);\n            c = hh(c, d, a, b, k[7], 16, -155497632);\n            b = hh(b, c, d, a, k[10], 23, -1094730640);\n            a = hh(a, b, c, d, k[13], 4, 681279174);\n            d = hh(d, a, b, c, k[0], 11, -358537222);\n            c = hh(c, d, a, b, k[3], 16, -722521979);\n            b = hh(b, c, d, a, k[6], 23, 76029189);\n            a = hh(a, b, c, d, k[9], 4, -640364487);\n            d = hh(d, a, b, c, k[12], 11, -421815835);\n            c = hh(c, d, a, b, k[15], 16, 530742520);\n            b = hh(b, c, d, a, k[2], 23, -995338651);\n\n            a = ii(a, b, c, d, k[0], 6, -198630844);\n            d = ii(d, a, b, c, k[7], 10, 1126891415);\n            c = ii(c, d, a, b, k[14], 15, -1416354905);\n            b = ii(b, c, d, a, k[5], 21, -57434055);\n            a = ii(a, b, c, d, k[12], 6, 1700485571);\n            d = ii(d, a, b, c, k[3], 10, -1894986606);\n            c = ii(c, d, a, b, k[10], 15, -1051523);\n            b = ii(b, c, d, a, k[1], 21, -2054922799);\n            a = ii(a, b, c, d, k[8], 6, 1873313359);\n            d = ii(d, a, b, c, k[15], 10, -30611744);\n            c = ii(c, d, a, b, k[6], 15, -1560198380);\n            b = ii(b, c, d, a, k[13], 21, 1309151649);\n            a = ii(a, b, c, d, k[4], 6, -145523070);\n            d = ii(d, a, b, c, k[11], 10, -1120210379);\n            c = ii(c, d, a, b, k[2], 15, 718787259);\n            b = ii(b, c, d, a, k[9], 21, -343485551);\n\n            x[0] = add32(a, x[0]);\n            x[1] = add32(b, x[1]);\n            x[2] = add32(c, x[2]);\n            x[3] = add32(d, x[3]);\n        },\n\n        /* there needs to be support for Unicode here,\n           * unless we pretend that we can redefine the MD-5\n           * algorithm for multi-byte characters (perhaps\n           * by adding every four 16-bit characters and\n           * shortening the sum to 32 bits). Otherwise\n           * I suggest performing MD-5 as if every character\n           * was two bytes--e.g., 0040 0025 = @%--but then\n           * how will an ordinary MD-5 sum be matched?\n           * There is no way to standardize text to something\n           * like UTF-8 before transformation; speed cost is\n           * utterly prohibitive. The JavaScript standard\n           * itself needs to look at this: it should start\n           * providing access to strings as preformed UTF-8\n           * 8-bit unsigned value arrays.\n           */\n        md5blk = function (s) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n\n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = s.charCodeAt(i) + (s.charCodeAt(i + 1) << 8) + (s.charCodeAt(i + 2) << 16) + (s.charCodeAt(i + 3) << 24);\n            }\n            return md5blks;\n        },\n\n        md5blk_array = function (a) {\n            var md5blks = [],\n                i; /* Andy King said do it this way. */\n\n            for (i = 0; i < 64; i += 4) {\n                md5blks[i >> 2] = a[i] + (a[i + 1] << 8) + (a[i + 2] << 16) + (a[i + 3] << 24);\n            }\n            return md5blks;\n        },\n\n        md51 = function (s) {\n            var n = s.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n\n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk(s.substring(i - 64, i)));\n            }\n            s = s.substring(i - 64);\n            length = s.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\n            }\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n\n            md5cycle(state, tail);\n            return state;\n        },\n\n        md51_array = function (a) {\n            var n = a.length,\n                state = [1732584193, -271733879, -1732584194, 271733878],\n                i,\n                length,\n                tail,\n                tmp,\n                lo,\n                hi;\n\n            for (i = 64; i <= n; i += 64) {\n                md5cycle(state, md5blk_array(a.subarray(i - 64, i)));\n            }\n\n            // Not sure if it is a bug, however IE10 will always produce a sub array of length 1\n            // containing the last element of the parent array if the sub array specified starts\n            // beyond the length of the parent array - weird.\n            // https://connect.microsoft.com/IE/feedback/details/771452/typed-array-subarray-issue\n            a = (i - 64) < n ? a.subarray(i - 64) : new Uint8Array(0);\n\n            length = a.length;\n            tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= a[i] << ((i % 4) << 3);\n            }\n\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Beware that the final length might not fit in 32 bits so we take care of that\n            tmp = n * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n\n            md5cycle(state, tail);\n\n            return state;\n        },\n\n        hex_chr = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'],\n\n        rhex = function (n) {\n            var s = '',\n                j;\n            for (j = 0; j < 4; j += 1) {\n                s += hex_chr[(n >> (j * 8 + 4)) & 0x0F] + hex_chr[(n >> (j * 8)) & 0x0F];\n            }\n            return s;\n        },\n\n        hex = function (x) {\n            var i;\n            for (i = 0; i < x.length; i += 1) {\n                x[i] = rhex(x[i]);\n            }\n            return x.join('');\n        },\n\n        md5 = function (s) {\n            return hex(md51(s));\n        },\n\n\n\n        ////////////////////////////////////////////////////////////////////////////\n\n        /**\n         * SparkMD5 OOP implementation.\n         *\n         * Use this class to perform an incremental md5, otherwise use the\n         * static methods instead.\n         */\n        SparkMD5 = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n\n\n        // In some cases the fast add32 function cannot be used..\n        if (md5('hello') !== '5d41402abc4b2a76b9719d911017c592') {\n            add32 = function (x, y) {\n                var lsw = (x & 0xFFFF) + (y & 0xFFFF),\n                    msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n                return (msw << 16) | (lsw & 0xFFFF);\n            };\n        }\n\n\n        /**\n         * Appends a string.\n         * A conversion will be applied if an utf8 string is detected.\n         *\n         * @param {String} str The string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.append = function (str) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n\n            // then append as binary\n            this.appendBinary(str);\n\n            return this;\n        };\n\n        /**\n         * Appends a binary string.\n         *\n         * @param {String} contents The binary string to be appended\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.appendBinary = function (contents) {\n            this._buff += contents;\n            this._length += contents.length;\n\n            var length = this._buff.length,\n                i;\n\n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk(this._buff.substring(i - 64, i)));\n            }\n\n            this._buff = this._buff.substr(i - 64);\n\n            return this;\n        };\n\n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                i,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                ret;\n\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff.charCodeAt(i) << ((i % 4) << 3);\n            }\n\n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n\n            this.reset();\n\n            return ret;\n        };\n\n        /**\n         * Finish the final calculation based on the tail.\n         *\n         * @param {Array}  tail   The tail (will be modified)\n         * @param {Number} length The length of the remaining buffer\n         */\n        SparkMD5.prototype._finish = function (tail, length) {\n            var i = length,\n                tmp,\n                lo,\n                hi;\n\n            tail[i >> 2] |= 0x80 << ((i % 4) << 3);\n            if (i > 55) {\n                md5cycle(this._state, tail);\n                for (i = 0; i < 16; i += 1) {\n                    tail[i] = 0;\n                }\n            }\n\n            // Do the final computation based on the tail and length\n            // Beware that the final length may not fit in 32 bits so we take care of that\n            tmp = this._length * 8;\n            tmp = tmp.toString(16).match(/(.*?)(.{0,8})$/);\n            lo = parseInt(tmp[2], 16);\n            hi = parseInt(tmp[1], 16) || 0;\n\n            tail[14] = lo;\n            tail[15] = hi;\n            md5cycle(this._state, tail);\n        };\n\n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5} The instance itself\n         */\n        SparkMD5.prototype.reset = function () {\n            this._buff = \"\";\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\n            return this;\n        };\n\n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.prototype.destroy = function () {\n            delete this._state;\n            delete this._buff;\n            delete this._length;\n        };\n\n\n        /**\n         * Performs the md5 hash on a string.\n         * A conversion will be applied if utf8 string is detected.\n         *\n         * @param {String}  str The string\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hash = function (str, raw) {\n            // converts the string to utf8 bytes if necessary\n            if (/[\\u0080-\\uFFFF]/.test(str)) {\n                str = unescape(encodeURIComponent(str));\n            }\n\n            var hash = md51(str);\n\n            return raw ? hash : hex(hash);\n        };\n\n        /**\n         * Performs the md5 hash on a binary string.\n         *\n         * @param {String}  content The binary string\n         * @param {Boolean} raw     True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.hashBinary = function (content, raw) {\n            var hash = md51(content);\n\n            return raw ? hash : hex(hash);\n        };\n\n        /**\n         * SparkMD5 OOP implementation for array buffers.\n         *\n         * Use this class to perform an incremental md5 ONLY for array buffers.\n         */\n        SparkMD5.ArrayBuffer = function () {\n            // call reset to init the instance\n            this.reset();\n        };\n\n        ////////////////////////////////////////////////////////////////////////////\n\n        /**\n         * Appends an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array to be appended\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.append = function (arr) {\n            // TODO: we could avoid the concatenation here but the algorithm would be more complex\n            //       if you find yourself needing extra performance, please make a PR.\n            var buff = this._concatArrayBuffer(this._buff, arr),\n                length = buff.length,\n                i;\n\n            this._length += arr.byteLength;\n\n            for (i = 64; i <= length; i += 64) {\n                md5cycle(this._state, md5blk_array(buff.subarray(i - 64, i)));\n            }\n\n            // Avoids IE10 weirdness (documented above)\n            this._buff = (i - 64) < length ? buff.subarray(i - 64) : new Uint8Array(0);\n\n            return this;\n        };\n\n        /**\n         * Finishes the incremental computation, reseting the internal state and\n         * returning the result.\n         * Use the raw parameter to obtain the raw result instead of the hex one.\n         *\n         * @param {Boolean} raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.prototype.end = function (raw) {\n            var buff = this._buff,\n                length = buff.length,\n                tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n                i,\n                ret;\n\n            for (i = 0; i < length; i += 1) {\n                tail[i >> 2] |= buff[i] << ((i % 4) << 3);\n            }\n\n            this._finish(tail, length);\n            ret = raw ? this._state : hex(this._state);\n\n            this.reset();\n\n            return ret;\n        };\n\n        SparkMD5.ArrayBuffer.prototype._finish = SparkMD5.prototype._finish;\n\n        /**\n         * Resets the internal state of the computation.\n         *\n         * @return {SparkMD5.ArrayBuffer} The instance itself\n         */\n        SparkMD5.ArrayBuffer.prototype.reset = function () {\n            this._buff = new Uint8Array(0);\n            this._length = 0;\n            this._state = [1732584193, -271733879, -1732584194, 271733878];\n\n            return this;\n        };\n\n        /**\n         * Releases memory used by the incremental buffer and other aditional\n         * resources. If you plan to use the instance again, use reset instead.\n         */\n        SparkMD5.ArrayBuffer.prototype.destroy = SparkMD5.prototype.destroy;\n\n        /**\n         * Concats two array buffers, returning a new one.\n         *\n         * @param  {ArrayBuffer} first  The first array buffer\n         * @param  {ArrayBuffer} second The second array buffer\n         *\n         * @return {ArrayBuffer} The new array buffer\n         */\n        SparkMD5.ArrayBuffer.prototype._concatArrayBuffer = function (first, second) {\n            var firstLength = first.length,\n                result = new Uint8Array(firstLength + second.byteLength);\n\n            result.set(first);\n            result.set(new Uint8Array(second), firstLength);\n\n            return result;\n        };\n\n        /**\n         * Performs the md5 hash on an array buffer.\n         *\n         * @param {ArrayBuffer} arr The array buffer\n         * @param {Boolean}     raw True to get the raw result, false to get the hex result\n         *\n         * @return {String|Array} The result\n         */\n        SparkMD5.ArrayBuffer.hash = function (arr, raw) {\n            var hash = md51_array(new Uint8Array(arr));\n\n            return raw ? hash : hex(hash);\n        };\n\n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n\n            loadFromBlob: function( file ) {\n                var blob = file.getSource(),\n                    chunkSize = 2 * 1024 * 1024,\n                    chunks = Math.ceil( blob.size / chunkSize ),\n                    chunk = 0,\n                    owner = this.owner,\n                    spark = new SparkMD5.ArrayBuffer(),\n                    me = this,\n                    blobSlice = blob.mozSlice || blob.webkitSlice || blob.slice,\n                    loadNext, fr;\n\n                fr = new FileReader();\n\n                loadNext = function() {\n                    var start, end;\n\n                    start = chunk * chunkSize;\n                    end = Math.min( start + chunkSize, blob.size );\n\n                    fr.onload = function( e ) {\n                        spark.append( e.target.result );\n                        owner.trigger( 'progress', {\n                            total: file.size,\n                            loaded: end\n                        });\n                    };\n\n                    fr.onloadend = function() {\n                        fr.onloadend = fr.onload = null;\n\n                        if ( ++chunk < chunks ) {\n                            setTimeout( loadNext, 1 );\n                        } else {\n                            setTimeout(function(){\n                                owner.trigger('load');\n                                me.result = spark.end();\n                                loadNext = file = blob = spark = null;\n                                owner.trigger('complete');\n                            }, 50 );\n                        }\n                    };\n\n                    fr.readAsArrayBuffer( blobSlice.call( blob, start, end ) );\n                };\n\n                loadNext();\n            },\n\n            getResult: function() {\n                return this.result;\n            }\n        });\n    });\n    /**\n     * @fileOverview FlashRuntime\n     */\n    define('runtime/flash/runtime',[\n        'base',\n        'runtime/runtime',\n        'runtime/compbase'\n    ], function( Base, Runtime, CompBase ) {\n\n        var $ = Base.$,\n            type = 'flash',\n            components = {};\n\n\n        function getFlashVersion() {\n            var version;\n\n            try {\n                version = navigator.plugins[ 'Shockwave Flash' ];\n                version = version.description;\n            } catch ( ex ) {\n                try {\n                    version = new ActiveXObject('ShockwaveFlash.ShockwaveFlash')\n                            .GetVariable('$version');\n                } catch ( ex2 ) {\n                    version = '0.0';\n                }\n            }\n            version = version.match( /\\d+/g );\n            return parseFloat( version[ 0 ] + '.' + version[ 1 ], 10 );\n        }\n\n        function FlashRuntime() {\n            var pool = {},\n                clients = {},\n                destroy = this.destroy,\n                me = this,\n                jsreciver = Base.guid('webuploader_');\n\n            Runtime.apply( me, arguments );\n            me.type = type;\n\n\n            // 这个方法的调用者，实际上是RuntimeClient\n            me.exec = function( comp, fn/*, args...*/ ) {\n                var client = this,\n                    uid = client.uid,\n                    args = Base.slice( arguments, 2 ),\n                    instance;\n\n                clients[ uid ] = client;\n\n                if ( components[ comp ] ) {\n                    if ( !pool[ uid ] ) {\n                        pool[ uid ] = new components[ comp ]( client, me );\n                    }\n\n                    instance = pool[ uid ];\n\n                    if ( instance[ fn ] ) {\n                        return instance[ fn ].apply( instance, args );\n                    }\n                }\n\n                return me.flashExec.apply( client, arguments );\n            };\n\n            function handler( evt, obj ) {\n                var type = evt.type || evt,\n                    parts, uid;\n\n                parts = type.split('::');\n                uid = parts[ 0 ];\n                type = parts[ 1 ];\n\n                // console.log.apply( console, arguments );\n\n                if ( type === 'Ready' && uid === me.uid ) {\n                    me.trigger('ready');\n                } else if ( clients[ uid ] ) {\n                    clients[ uid ].trigger( type.toLowerCase(), evt, obj );\n                }\n\n                // Base.log( evt, obj );\n            }\n\n            // flash的接受器。\n            window[ jsreciver ] = function() {\n                var args = arguments;\n\n                // 为了能捕获得到。\n                setTimeout(function() {\n                    handler.apply( null, args );\n                }, 1 );\n            };\n\n            this.jsreciver = jsreciver;\n\n            this.destroy = function() {\n                // @todo 删除池子中的所有实例\n                return destroy && destroy.apply( this, arguments );\n            };\n\n            this.flashExec = function( comp, fn ) {\n                var flash = me.getFlash(),\n                    args = Base.slice( arguments, 2 );\n\n                return flash.exec( this.uid, comp, fn, args );\n            };\n\n            // @todo\n        }\n\n        Base.inherits( Runtime, {\n            constructor: FlashRuntime,\n\n            init: function() {\n                var container = this.getContainer(),\n                    opts = this.options,\n                    html;\n\n                // if not the minimal height, shims are not initialized\n                // in older browsers (e.g FF3.6, IE6,7,8, Safari 4.0,5.0, etc)\n                container.css({\n                    position: 'absolute',\n                    top: '-8px',\n                    left: '-8px',\n                    width: '9px',\n                    height: '9px',\n                    overflow: 'hidden'\n                });\n\n                // insert flash object\n                html = '<object id=\"' + this.uid + '\" type=\"application/' +\n                        'x-shockwave-flash\" data=\"' +  opts.swf + '\" ';\n\n                if ( Base.browser.ie ) {\n                    html += 'classid=\"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000\" ';\n                }\n\n                html += 'width=\"100%\" height=\"100%\" style=\"outline:0\">'  +\n                    '<param name=\"movie\" value=\"' + opts.swf + '\" />' +\n                    '<param name=\"flashvars\" value=\"uid=' + this.uid +\n                    '&jsreciver=' + this.jsreciver + '\" />' +\n                    '<param name=\"wmode\" value=\"transparent\" />' +\n                    '<param name=\"allowscriptaccess\" value=\"always\" />' +\n                '</object>';\n\n                container.html( html );\n            },\n\n            getFlash: function() {\n                if ( this._flash ) {\n                    return this._flash;\n                }\n\n                this._flash = $( '#' + this.uid ).get( 0 );\n                return this._flash;\n            }\n\n        });\n\n        FlashRuntime.register = function( name, component ) {\n            component = components[ name ] = Base.inherits( CompBase, $.extend({\n\n                // @todo fix this later\n                flashExec: function() {\n                    var owner = this.owner,\n                        runtime = this.getRuntime();\n\n                    return runtime.flashExec.apply( owner, arguments );\n                }\n            }, component ) );\n\n            return component;\n        };\n\n        if ( getFlashVersion() >= 11.4 ) {\n            Runtime.addRuntime( type, FlashRuntime );\n        }\n\n        return FlashRuntime;\n    });\n    /**\n     * @fileOverview FilePicker\n     */\n    define('runtime/flash/filepicker',[\n        'base',\n        'runtime/flash/runtime'\n    ], function( Base, FlashRuntime ) {\n        var $ = Base.$;\n\n        return FlashRuntime.register( 'FilePicker', {\n            init: function( opts ) {\n                var copy = $.extend({}, opts ),\n                    len, i;\n\n                // 修复Flash再没有设置title的情况下无法弹出flash文件选择框的bug.\n                len = copy.accept && copy.accept.length;\n                for (  i = 0; i < len; i++ ) {\n                    if ( !copy.accept[ i ].title ) {\n                        copy.accept[ i ].title = 'Files';\n                    }\n                }\n\n                delete copy.button;\n                delete copy.id;\n                delete copy.container;\n\n                this.flashExec( 'FilePicker', 'init', copy );\n            },\n\n            destroy: function() {\n                this.flashExec( 'FilePicker', 'destroy' );\n            }\n        });\n    });\n    /**\n     * @fileOverview 图片压缩\n     */\n    define('runtime/flash/image',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n\n        return FlashRuntime.register( 'Image', {\n            // init: function( options ) {\n            //     var owner = this.owner;\n\n            //     this.flashExec( 'Image', 'init', options );\n            //     owner.on( 'load', function() {\n            //         debugger;\n            //     });\n            // },\n\n            loadFromBlob: function( blob ) {\n                var owner = this.owner;\n\n                owner.info() && this.flashExec( 'Image', 'info', owner.info() );\n                owner.meta() && this.flashExec( 'Image', 'meta', owner.meta() );\n\n                this.flashExec( 'Image', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Transport flash实现\n     */\n    define('runtime/flash/transport',[\n        'base',\n        'runtime/flash/runtime',\n        'runtime/client'\n    ], function( Base, FlashRuntime, RuntimeClient ) {\n        var $ = Base.$;\n\n        return FlashRuntime.register( 'Transport', {\n            init: function() {\n                this._status = 0;\n                this._response = null;\n                this._responseJson = null;\n            },\n\n            send: function() {\n                var owner = this.owner,\n                    opts = this.options,\n                    xhr = this._initAjax(),\n                    blob = owner._blob,\n                    server = opts.server,\n                    binary;\n\n                xhr.connectRuntime( blob.ruid );\n\n                if ( opts.sendAsBinary ) {\n                    server += (/\\?/.test( server ) ? '&' : '?') +\n                            $.param( owner._formData );\n\n                    binary = blob.uid;\n                } else {\n                    $.each( owner._formData, function( k, v ) {\n                        xhr.exec( 'append', k, v );\n                    });\n\n                    xhr.exec( 'appendBlob', opts.fileVal, blob.uid,\n                            opts.filename || owner._formData.name || '' );\n                }\n\n                this._setRequestHeader( xhr, opts.headers );\n                xhr.exec( 'send', {\n                    method: opts.method,\n                    url: server,\n                    forceURLStream: opts.forceURLStream,\n                    mimeType: 'application/octet-stream',\n                }, binary );\n            },\n\n            getStatus: function() {\n                return this._status;\n            },\n\n            getResponse: function() {\n                return this._response || '';\n            },\n\n            getResponseAsJson: function() {\n                return this._responseJson;\n            },\n\n            abort: function() {\n                var xhr = this._xhr;\n\n                if ( xhr ) {\n                    xhr.exec('abort');\n                    xhr.destroy();\n                    this._xhr = xhr = null;\n                }\n            },\n\n            destroy: function() {\n                this.abort();\n            },\n\n            _initAjax: function() {\n                var me = this,\n                    xhr = new RuntimeClient('XMLHttpRequest');\n\n                xhr.on( 'uploadprogress progress', function( e ) {\n                    var percent = e.loaded / e.total;\n                    percent = Math.min( 1, Math.max( 0, percent ) );\n                    return me.trigger( 'progress', percent );\n                });\n\n                xhr.on( 'load', function() {\n                    var status = xhr.exec('getStatus'),\n                        readBody = false,\n                        err = '',\n                        p;\n\n                    xhr.off();\n                    me._xhr = null;\n\n                    if ( status >= 200 && status < 300 ) {\n                        readBody = true;\n                    } else if ( status >= 500 && status < 600 ) {\n                        readBody = true;\n                        err = 'server';\n                    } else {\n                        err = 'http';\n                    }\n\n                    if ( readBody ) {\n                        me._response = xhr.exec('getResponse');\n                        me._response = decodeURIComponent( me._response );\n\n                        // flash 处理可能存在 bug, 没辙只能靠 js 了\n                        // try {\n                        //     me._responseJson = xhr.exec('getResponseAsJson');\n                        // } catch ( error ) {\n\n                        p = window.JSON && window.JSON.parse || function( s ) {\n                            try {\n                                return new Function('return ' + s).call();\n                            } catch ( err ) {\n                                return {};\n                            }\n                        };\n                        me._responseJson  = me._response ? p(me._response) : {};\n\n                        // }\n                    }\n\n                    xhr.destroy();\n                    xhr = null;\n\n                    return err ? me.trigger( 'error', err ) : me.trigger('load');\n                });\n\n                xhr.on( 'error', function() {\n                    xhr.off();\n                    me._xhr = null;\n                    me.trigger( 'error', 'http' );\n                });\n\n                me._xhr = xhr;\n                return xhr;\n            },\n\n            _setRequestHeader: function( xhr, headers ) {\n                $.each( headers, function( key, val ) {\n                    xhr.exec( 'setRequestHeader', key, val );\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Blob Html实现\n     */\n    define('runtime/flash/blob',[\n        'runtime/flash/runtime',\n        'lib/blob'\n    ], function( FlashRuntime, Blob ) {\n\n        return FlashRuntime.register( 'Blob', {\n            slice: function( start, end ) {\n                var blob = this.flashExec( 'Blob', 'slice', start, end );\n\n                return new Blob( blob.uid, blob );\n            }\n        });\n    });\n    /**\n     * @fileOverview  Md5 flash实现\n     */\n    define('runtime/flash/md5',[\n        'runtime/flash/runtime'\n    ], function( FlashRuntime ) {\n\n        return FlashRuntime.register( 'Md5', {\n            init: function() {\n                // do nothing.\n            },\n\n            loadFromBlob: function( blob ) {\n                return this.flashExec( 'Md5', 'loadFromBlob', blob.uid );\n            }\n        });\n    });\n    /**\n     * @fileOverview 完全版本。\n     */\n    define('preset/all',[\n        'base',\n\n        // widgets\n        'widgets/filednd',\n        'widgets/filepaste',\n        'widgets/filepicker',\n        'widgets/image',\n        'widgets/queue',\n        'widgets/runtime',\n        'widgets/upload',\n        'widgets/validator',\n        'widgets/md5',\n\n        // runtimes\n        // html5\n        'runtime/html5/blob',\n        'runtime/html5/dnd',\n        'runtime/html5/filepaste',\n        'runtime/html5/filepicker',\n        'runtime/html5/imagemeta/exif',\n        'runtime/html5/androidpatch',\n        'runtime/html5/image',\n        'runtime/html5/transport',\n        'runtime/html5/md5',\n\n        // flash\n        'runtime/flash/filepicker',\n        'runtime/flash/image',\n        'runtime/flash/transport',\n        'runtime/flash/blob',\n        'runtime/flash/md5'\n    ], function( Base ) {\n        return Base;\n    });\n    /**\n     * @fileOverview 日志组件，主要用来收集错误信息，可以帮助 webuploader 更好的定位问题和发展。\n     *\n     * 如果您不想要启用此功能，请在打包的时候去掉 log 模块。\n     *\n     * 或者可以在初始化的时候通过 options.disableWidgets 属性禁用。\n     *\n     * 如：\n     * WebUploader.create({\n     *     ...\n     *\n     *     disableWidgets: 'log',\n     *\n     *     ...\n     * })\n     */\n    define('widgets/log',[\n        'base',\n        'uploader',\n        'widgets/widget'\n    ], function( Base, Uploader ) {\n        var $ = Base.$,\n            logUrl = ' http://static.tieba.baidu.com/tb/pms/img/st.gif??',\n            product = (location.hostname || location.host || 'protected').toLowerCase(),\n\n            // 只针对 baidu 内部产品用户做统计功能。\n            enable = product && /baidu/i.exec(product),\n            base;\n\n        if (!enable) {\n            return;\n        }\n\n        base = {\n            dv: 3,\n            master: 'webuploader',\n            online: /test/.exec(product) ? 0 : 1,\n            module: '',\n            product: product,\n            type: 0\n        };\n\n        function send(data) {\n            var obj = $.extend({}, base, data),\n                url = logUrl.replace(/^(.*)\\?/, '$1' + $.param( obj )),\n                image = new Image();\n\n            image.src = url;\n        }\n\n        return Uploader.register({\n            name: 'log',\n\n            init: function() {\n                var owner = this.owner,\n                    count = 0,\n                    size = 0;\n\n                owner\n                    .on('error', function(code) {\n                        send({\n                            type: 2,\n                            c_error_code: code\n                        });\n                    })\n                    .on('uploadError', function(file, reason) {\n                        send({\n                            type: 2,\n                            c_error_code: 'UPLOAD_ERROR',\n                            c_reason: '' + reason\n                        });\n                    })\n                    .on('uploadComplete', function(file) {\n                        count++;\n                        size += file.size;\n                    }).\n                    on('uploadFinished', function() {\n                        send({\n                            c_count: count,\n                            c_size: size\n                        });\n                        count = size = 0;\n                    });\n\n                send({\n                    c_usage: 1\n                });\n            }\n        });\n    });\n    /**\n     * @fileOverview Uploader上传类\n     */\n    define('webuploader',[\n        'preset/all',\n        'widgets/log'\n    ], function( preset ) {\n        return preset;\n    });\n    return require('webuploader');\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/plugin/webuploader/webuploader.js\n// module id = 86\n// module chunks = 4 6 7 12 16 30 34","var tpl = require('./content.tpl');\nvar Dialog = require('dialog');\n\nvar create = function(data, options){\n    var content = tpl(data || {}); // 显示编辑弹窗之前,需要自己拼装数据\n    options = options || {};\n\n    var defaults = {\n        title: '选择图片',\n        modal: true,\n        fixed: true,\n        content: content,\n        className: 'pop-box',\n        okValue: '插入图片',\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\n        cancalValue : '取消',\n        btnWrapCls: 'insert-cancel'\n        /*function () {\n            // var value = $('#property-returnValue-demo').val();\n            // this.close(value);\n            // this.remove();\n        }*/\n    };\n    $.extend(true, defaults, options);\n    return Dialog(defaults);\n};\n\nmodule.exports = {\n    create: create\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/upload/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,maxlength=$data.maxlength,total=$data.total,$out='';$out+='<div data-node=\"uploadBox\"> <div class=\"pics-list-wrap clearfix\"> <ul class=\"pics-list clearfix\" data-node=\"uploadList\"> <li data-defaultAddFile=\\'picker\\'></li> </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"addNum\">';\n$out+=$escape(maxlength);\n$out+='</span><span class=\"deep-gray\">/';\n$out+=$escape(total);\n$out+='</span>张图片</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/upload/content.tpl\n// module id = 98\n// module chunks = 5 6 16 30","/**\n * 分享到 微信，QQ，微博，空间\n * @author Zhengchun Fu\n */\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar getQRCode = require('utils/getQRCode');\nvar checkLoginStatus = require('module/checkLoginStatus');\n\nvar APIS = {\n    qq: \"http://connect.qq.com/widget/shareqq/index.html\",\n    wb: \"http://v.t.sina.com.cn/share/share.php\",\n    qz: \"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey\"\n};\n\nvar defaultInfo = {\n    url: 'https://group.gomeplus.com/',\n    title: '国美APP边玩边分享，购物不孤单',\n    pic: '../../images/public/logo.png', // logo图片地址\n    summary: '国美APP边玩边分享，购物不孤单'\n};\n\nvar open = function(url) {\n    window.open(url);\n};\n\n// 分享按钮渲染\nvar hasShareBtnsHTML = false;\nvar initShareBtns = function() {\n    var shareBtns = '<p data-node=\"shareBtnBox\" class=\"share-down\" style=\"z-index:21;\"><span class=\"share-box\"><span class=\"icon icon-up-arrow\"></span><span class=\"icon-box\"><em data-shareto=\"weixin\" class=\"iconn-30\"></em><em data-shareto=\"qq\" class=\"iconn-32\"></em><em data-shareto=\"sina\" class=\"iconn-31\"></em><em data-shareto=\"qzone\" class=\"iconn-33\"></em></span></span></p>';\n    $('body').append(shareBtns);\n    hasShareBtnsHTML = true;\n};\nvar showShareToBtns = function(style) {\n    !hasShareBtnsHTML && initShareBtns();\n    $('[data-node=shareBtnBox]').css({\n        left: style.x,\n        top: style.y\n    }).show();\n};\n\n// 微信弹层渲染\nvar hasWeixinHTML = false;\nvar initWeixinHTML = function() {\n\n    var weixinBox = '<div class=\"share-weixin\"><div class=\"wx-mask\"></div><div class=\"wx-main\"><div class=\"wx-code\"><span></span><img data-node=\"shareWeixinCode\" alt=\"分享到微信\" /></div><p>打开微信扫一扫，即可分享</p><a href=\"javascript:;\" title=\"点击关闭\" class=\"wx-close\">×</a></div></div>';\n    $('body').append(weixinBox);\n    hasWeixinHTML = true;\n};\n\n// pics: 图片参数是否为pics，默认是pic。\nvar formatParams = function(p, pics) {\n    var s = [];\n    var data = {\n        title: p.title,\n        url: p.url,\n        summary: p.summary,\n        //desc: p.desc,\n        site: p.site\n    };\n\n    for (var i in data) {\n        s.push(i + '=' + encodeURIComponent(data[i] || ''));\n    }\n    if (pics) {\n        s.push('pics=' + p.pic);\n    } else {\n        s.push('pic=' + p.pic);\n    }\n    return s.join('&');\n};\n\n// 单个调用方法\n// 分享的图片多个用||隔开。\nvar shareTo = {\n    weixin: function(options) {\n        var link = getQRCode(options.url);\n        !hasWeixinHTML && initWeixinHTML();\n\n        $('[data-node=shareWeixinCode]')[0].src = link;\n        $('.share-weixin').show();\n        $('.wx-close').on('click', function() {\n            $('.share-weixin').hide();\n        });\n    },\n    qq: function(options) {\n        var link = APIS.qq + '?' + formatParams(options, true);\n        open(link);\n    },\n    wb: function(options) {\n        var link = APIS.wb + '?' + formatParams(options);\n        open(link);\n    },\n    qz: function(options) {\n        var link = APIS.qz + '?' + formatParams(options, true);\n        open(link);\n    }\n};\n\n// share with kid\nvar shareWithKid = function(args) {\n    var isRebate = args.isRebate === '0' ? false : true;\n    fetch.get(url.get('shareGetGoodsKid'), {\n        validate: isRebate,\n        data: {\n            skuId: args.skuId,\n            itemId: args.itemId,\n            parentKid: args.parentKid\n        },\n        async: false // 防止新窗口被拦截\n    }).done(function(data) {\n        if (data.success === true) {\n            var kid = data.data.kid;\n            var shareInfo = args.shareInfo;\n            // 替换分享链接\n            // 规则：mall_domain+product/shopid-productId.html?onlineUserId=xxxx&kid=xxxx\n            var url = shareInfo.url;\n            var index = url.indexOf('?');\n            if (index > 0) {\n                url = url.substring(0, index);\n            }\n            shareInfo.url = url + '?onlineUserId=' + shareInfo.onlineUserId + '&kId=' + kid;\n            shareTo[args.shareto](shareInfo);\n        } else {\n            shareTo[args.shareto](args.shareInfo);\n        }\n    }).fail(function() {\n        if (isRebate) {\n            if (checkLoginStatus()) {\n                shareTo[args.shareto](args.shareInfo);\n            }\n        } else {\n            shareTo[args.shareto](args.shareInfo);\n        }\n    });\n};\n\n// 统一方法\nvar go = function(obj) {\n    // {type:x,title:x,url:x,pic:x}\n    var info = {\n        title: obj.title || defaultInfo.title,\n        url: obj.url || defaultInfo.url,\n        pic: obj.pic || defaultInfo.pic,\n        summary: obj.summary || '',\n        desc: obj.desc || ''\n    };\n\n    !!shareTo[obj.type] && shareTo[obj.type](info);\n\n};\n\n/**\n * 简化分享\n * @param  {str} [parent] [容器节点]\n * @param {str} [selector] [子节点选择器]\n */\nvar shareItem = function(parent, selector, beforeShare) {\n    var shareInfo = null;\n    var $item = null;\n    $item = typeof parent === 'string' ? $(parent) : parent;\n    selector = selector || '[data-action=shareto]';\n    // 显示分享按钮\n    $item.on('mouseenter', selector, function() {\n        var shareUrl = $(this).data('surl');\n        var shareTitle = $(this).data('stitle');\n        var sharePic = $(this).data('spic');\n\n        shareInfo = {\n            url: shareUrl,\n            title: shareTitle,\n            pic: sharePic\n        };\n\n        var pw = $(this).width();\n        var ph = $(this).height();\n        var px = ($(this).offset().left / 1 + pw / 2 - 80) + 'px';\n        var py = ($(this).offset().top / 1 + (ph - 1)) + 'px';\n\n        showShareToBtns({\n            x: px,\n            y: py\n        });\n        return false;\n    });\n    // 隐藏分享按钮\n    $item.on('mouseleave', selector, function() {\n        $('[data-node=shareBtnBox]').hide();\n        return false;\n    });\n\n    $('body').on('click', '[data-shareto]', function(e) {\n        e.preventDefault();\n        var shareType = $(this).data('shareto');\n        shareInfo.type = shareType;\n        beforeShare = beforeShare || function() {};\n        beforeShare.call(null, shareInfo);\n        go(shareInfo);\n    });\n\n    $('body').on('mouseenter', '[data-node=shareBtnBox]', function() {\n        $(this).show();\n    });\n    $('body').on('mouseleave', '[data-node=shareBtnBox]', function() {\n        $(this).hide();\n    });\n};\n\nmodule.exports = {\n    share: go,\n    shareto: shareTo,\n    shareItem: shareItem,\n    shareWithKid: shareWithKid\n};\n\n/**\n * 分享到 使用说明\n * 在[data-action=shareto]节点上输出要获取的数据\n * data-surl,data-stitle,data-spic\n * url要是绝对地址，带https?://的\n * pic是要分享的图片绝对地址，多张图片用||隔开。\n *\n * 页面中在分享按钮加 [data-action=shareto] 自定义属性；\n * 如果是分享当前页面的也要加shareInfo,值为当前页面对应的信息。格式都一样。\n *\n * 调用方法:\n * var share = require(..);\n * share.shareItem(要分享的区域父节点字符串e.g. 'data-node=shareList');\n *\n * shareto.weixin({shareInfo})\n * shareto.qq({shareInfo})\n * shareto.sina({shareInfo})\n * shareto.qzone({shareInfo})\n *\n *\n * share.share({shareInfo});这个shareInfo里要有type：[weixin,qq,sina,qzone]\n */\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/share.js","// 根据字符串生成二维码\nvar getQRCode = function(url) {\n    return $_CONFIG.group_domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(url);\n};\n\nmodule.exports = getQRCode;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/getQRCode.js","var uploadPop = require('module/popup/upload/dialog'),\n    Pubsub = require('io/pubsub'),\n    pubName = require('io/channel');\nvar upload = require('module/upload');\nvar alert = require('module/popup/alert');\nvar imgReplace = require('utils/imgReplace');\n\nvar init = function(maxLen, total) {\n    var dialogUploader,\n        $webUpLoader,\n        maxlength = maxLen;\n    if (maxlength > 0) {\n\n        dialogUploader = uploadPop.create({\n            maxlength: maxlength,\n            total: total\n        }, {\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                var $imgList = $('[data-node=\"uploadList\"] img'),\n                    images = [];\n                for (var i = 0, len = $imgList.length; i < len; i++) {\n                    images.push($imgList.eq(i).attr('src'));\n                }\n                //maxLen -= images.length;\n                Pubsub(pubName.setPubliser.changeImage).pub({\n                    images: images\n                });\n                $('[data-node=picPopBox]').hide();\n            },\n            cancel: function() {\n                $('[data-node=\"uploadList\"]').off();\n                $webUpLoader.destroy();\n                $('[data-node=picPopBox]').hide();\n            }\n        });\n\n        $webUpLoader = upload.init({\n            maxlength: maxlength,\n            callbacks: {\n                onFileQueued: function(file, numList, number) {\n                    var $uploadBox = $('[data-node=\"uploadBox\"]');\n                    var picker = '[data-defaultaddfile=\"picker\"]';\n                    $('[data-node=picPopBox]').addClass('webuploader-element-invisible');\n                    dialogUploader.show();\n                    $uploadBox.find(picker).children().eq(0).html('<em class=\"icon-add\"></em>');\n                    var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n                    $uploadBox.find(picker).before(html);\n                    $uploadBox.find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n                    if (numList[file.source.ruid] === ~~number) {\n                        $uploadBox.find(picker).hide();\n                    }\n                    $uploadBox.find(picker).children().eq(1).css({\n                        'width': '78px',\n                        'height': '78px'\n                    })\n                },\n\n                onUploadSuccess: function(file, response) {\n                    if (response.code === 200 && response.success) {\n                        $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                        // 激活提交按钮\n                        $('[i-id=ok]').removeClass('btn-default');\n                    } else {\n                        $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                    }\n                }\n            }\n        });\n    } else {\n        alert('您最多能添加' + maxLen + '张图片哦！');\n    }\n    return $webUpLoader;\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/upload/uploader.js","/***\n * upload.js\n * @author zhaodonghong\n * @params                      object      上传图片参数\n *     maxlength               number      可上传图片最大张数\n *     selector                object      jq选择器\n *         parents             string      每个图片上传外层jq选择器\n *         delSelector         string      删除按钮jq选择器\n *         selector            string      实例化上传插件的pick.id的值\n *     defaultApi              object      实例化webuploader参数\n *     callbacks               object      实例化webuploader方法回调集合\n *         onBeforeFileQueued  function    上传图片添加到上传队列之前\n *         onFileQueued        function    上传图片添加到上传队列后\n *         onUploadSuccess     function    上传成功\n *         onUploadError       function    上传失败\n *         onUploadProgress    function    上传中\n *         onErrored           function    报错\n *         retry               function    重新上传\n *         delImage            function    删除上传图片\n */\n\nvar WebUploader = require('../plugin/webuploader/webuploader');\nvar hint = require('module/hint');\nvar notice = require('module/i18n');\nvar imgReplace = require('utils/imgReplace');\nvar init = function(options) {\n\n    //var number = maxlength;\n    var numList = {};\n    var $webUpLoader;\n    var files = {};\n    var defaultOptions = {\n        //最大上传张数\n        maxlength: options.maxlength || 9,\n        //选择器\n        selector: {\n            parents: '[data-node=\"uploadBox\"]', //每个图片上传外层jq选择器\n            delSelector: '[data-action=\"delImage\"]', //删除按钮jq选择器\n            selector: '[data-defaultAddFile=picker]' //初始化时options.defaultApi.pick 的值，也就是 选择器的值\n        }\n    };\n    //初始化参数\n    defaultOptions.defaultApi = {\n        pick: {\n            id: '[data-defaultAddFile=picker]',\n            innerHTML: '本地上传图片'\n        },\n        accept: {\n            title: 'Images',\n            extensions: 'jpg,jpeg,png,gif',\n            mimeTypes: 'image/jpg,image/jpeg,image/png,image/gif'\n        },\n        method: 'post',\n        // swf文件路径\n        swf: $_CONFIG.imgpath + '/images/swf/Uploader.swf',\n        auto: true,\n        disableGlobalDnd: true,\n        duplicate: true,\n        prepareNextFile: true,\n        chunked: true,\n        fileVal: 'avatar_file',\n        server: '/ajax/crop/crop_img',\n        fileNumLimit: defaultOptions.maxlength * $(defaultOptions.selector).length,\n        fileSizeLimit: defaultOptions.maxlength * $(defaultOptions.selector).length * 4 * 1024 * 1024, // 50 M\n        fileSingleSizeLimit: 4 * 1024 * 1024\n    };\n    defaultOptions.callbacks = {\n        /***\n         * name: 图片加入队列之前\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * number: 最多可上传数\n         */\n        onBeforeFileQueued: function( /*file, numList, number*/ ) {\n            hint.init(notice.upload.excess);\n        },\n\n        /***\n         * name: 图片添加入队列后\n         * file: 图片信息对象\n         * numList: 以 file.source.ruid 为key的计数json对象\n         * maxlength: 最多可上传数\n         */\n        onFileQueued: function(file, numList, number) {\n            var html = '<li id=\"' + file.id + '\">' + '<div class=\"bar-upload-pic\"><span data-node=\"progress\"></span></div>' + '</li>';\n            $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').before(html);\n\n            $('#rt_' + file.source.ruid).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[file.source.ruid]);\n\n            if (numList[file.source.ruid] === ~~number) {\n                $('#rt_' + file.source.ruid).parents('[data-defaultaddfile=\"picker\"]').hide();\n            }\n\n        },\n\n        /***\n         * name: 上传成功（此成功指ajax有返回结果，故需要判断返回的状态码）\n         * file: 图片信息对象\n         * response: 上传图片ajax返回数据\n         */\n        onUploadSuccess: function(file, response) {\n            if (response.code === 200 && response.success) {\n                $('#' + file.id).html('<img src=\"' + imgReplace.imgReplace(response.data[0]) + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n                //$('#' + file.id).html('<img src=\"' + imgReplace(response.data[0]) + '\" _src = \"' + response.data[0] + '\" alt=\"\"><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            } else {\n                $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n            }\n        },\n\n        /***\n         * name: 上传失败\n         * file: 图片信息对象\n         * reason: 出错的code\n         */\n        onUploadError: function(file /*, reason*/ ) {\n            $('#' + file.id).html('<a href=\"javascript:;\" class=\"re-upload\" data-action=\"retry\">重新上传</a><a href=\"javascript:;\"><em class=\"icon-del-pic\" data-action=\"delImage\"></em></a>');\n        },\n\n        /***\n         * name: 上传时，包含进度条\n         * file: 图片信息对象\n         * percentage: 上传进度\n         */\n        onUploadProgress: function(file, percentage) {\n            $('#' + file.id).find('[data-node=\"progress\"]').css('width', percentage * 100 + '%');\n        },\n\n        /***\n         * name: 报错\n         * type: 报错类型\n         */\n        onErrored: function( /*type*/ ) {\n            hint.init(notice.upload.uploadError);\n        },\n\n        //重新上传\n        retry: function() {\n            var _this = this;\n            $('[data-node=\"uploadList\"]').on('click', '[data-action=\"retry\"]', function() {\n                _this.retry(files[$(this).parents('li').attr('id')]);\n            });\n        },\n\n        /***\n         * name: 删除图片\n         * webuploader: webuploader实例化对象\n         * numList: 自定义json对象，用来存储每个实例化对象已上传的图片个数\n         * id: 每个webuploader实例化时，上传按钮所生成的唯一id\n         */\n        delImage: function(webuploader, numList, id, number) {\n            $webUpLoader.removeFile(files[$(this).parents('li').attr('id')]);\n            $(this).parents('[data-node=\"uploadBox\"]').find('[data-node=\"addNum\"]').text(number - numList[id]);\n            $(this).parents('ul').find('[data-defaultAddFile=\"picker\"]').show();\n            $(this).parents('li').eq(0).remove();\n            if (numList[id] === 0) {\n                $('[i-id=ok]').addClass('btn-default');\n            };\n        }\n    };\n    options.callbacks = $.extend({}, defaultOptions.callbacks, options.callbacks);\n    /*var */\n    options = $.extend({}, defaultOptions, options);\n    $webUpLoader = WebUploader.create(options.defaultApi);\n\n    $webUpLoader.onFileQueued = function(file) {\n        var ruid = $('[data-node=\"uploadBox\"]').find('[data-defaultaddfile=\"picker\"]').children().eq(1).attr('id');\n        file.source.ruid = ruid;\n        numList[file.source.ruid] = numList[file.source.ruid] !== undefined ? numList[file.source.ruid] : 0;\n        numList[file.source.ruid]++;\n        files[file.id] = file;\n        options.callbacks.onFileQueued.call($webUpLoader, file, numList, options.maxlength);\n\n    };\n\n    //上传成功\n    $webUpLoader.on('uploadSuccess', function(file, response) {\n        options.callbacks.onUploadSuccess.call($webUpLoader, file, response);\n    });\n\n    //加入队列前\n    $webUpLoader.on('beforeFileQueued', function(file) {\n        if (numList[file.source.ruid] >= options.maxlength) {\n            options.callbacks.onBeforeFileQueued.call($webUpLoader, file, numList, options.maxlength);\n            return false;\n        }\n\n    });\n    //上传失败\n    $webUpLoader.on('uploadError', function(file, reason) {\n        options.callbacks.onUploadError.call($webUpLoader, file, reason);\n    });\n\n    //上传时\n    $webUpLoader.on('uploadProgress', function(file, percentage) {\n        options.callbacks.onUploadProgress.call($webUpLoader, file, percentage);\n    });\n\n    //报错\n    $webUpLoader.on('error', function(type) {\n        options.callbacks.onErrored.call($webUpLoader, type);\n    });\n    options.callbacks.retry.call($webUpLoader);\n\n    //删除图片\n    $(options.selector.parents).on('click', options.selector.delSelector, function() {\n        var id = $(this).parents(options.selector.parents).find(options.defaultApi.pick.id).children().eq(1).attr('id');\n        numList[id]--;\n        options.callbacks.delImage.call(this, $webUpLoader, numList, id, options.maxlength);\n    });\n\n    return $webUpLoader;\n}\n\nmodule.exports = {\n    init: init\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/upload.js"," var rules = /^https?:/i;\n var https = 'https';\n var imgRule = /^http/i;\n/* var grepStr = /-600!80\\./g;\n var grepOldStr = /\\.600q80\\.jpg/gi;*/\n var shotCut = \"-600!80\";\n var imgType = /\\.(jpg|jpeg|png)$/;\n\nvar grepStr1 = /(.+?)-[^\\.]+\\.(jp(e)?g|png|gif).*/;\nvar grepStr2 = /(.+?\\.(jp(e)?g|png|gif)).*/\n\n\n var imgReplace = function(src) {\n    return  src.replace(rules, '');\n }\n\nvar orignalImgReplace = function(src){\n    if(grepStr1.test(src)){\n        return src.replace(grepStr1,\"$1.$2\"); \n    }else{\n        return src.replace(grepStr2,\"$1\");\n    }\n      \n}\n\nvar addShortCut = function(src){\n    return src.replace(imgType,function($1){\n        return shotCut + $1;\n    })\n}\n var imgProto = function(src) {\n     if (src.indexOf(https) != -1) {\n         return 'https:';\n     } else {\n         return 'http:'\n     }\n }\n\n var changeSrc = function(container) {\n     var $imgs = container.find('img').not('[data-node=\"goodsPic\"]');\n     var len = $imgs.length;\n     for (var i = 0; i < len; i++) {\n         var _this = $($imgs[i])\n         var _src = _this.attr(\"_src\");\n         var _orignal = _this.attr(\"data-original\");\n         if (_orignal) {\n             _this.attr({\n                 'src': imgReplace(_orignal),\n                 '_src': imgReplace(_orignal),\n                 'proto': imgProto(_orignal)\n             })\n         } else if (!imgRule.test(_src)) {\n             var proto = _this.attr(\"proto\");\n             _this.attr(\"_src\", _src);\n         }\n\n     }\n }\n\n module.exports = {\n     imgReplace: imgReplace,\n     addShortCut:addShortCut,\n     imgProto: imgProto,\n     changeSrc: changeSrc,\n     orignalImgReplace:orignalImgReplace\n };\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/imgReplace.js","var codeTpl = require('./upload.tpl');\nvar imgPath = $GLOBAL_CONFIG['pcimgpath'];\n\n$('body').append(codeTpl({\n    imgPath: imgPath\n}));\n\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar qrTips = require('module/i18n');\nvar alert = require('module/popup/alert');\nvar config = require('editor/config');\nvar imgReplace = require('utils/imgReplace');\nvar domain = $_CONFIG['group_domain'];\n\nvar pageId = window.pageId;\nvar maxLen = config.imgLimitNUm;\nvar pageId = window.pageId;\nfunction Scans(o) {\n    this.qid = o.qid || 'single'; //是否创建实例的唯一标示\n    this.topicQrId = \"\";\n    this.$parent = o.$parent; //用于寻找插入图片的节点\n    this.uploadMaxNum = o.maxNum || 20; //上传图片限制\n    //this.currentMaxNum = 0; //当前能够上传图片\n    this.useNewCode = 0; //二维码是否过期的判断\n    this.interval = 0;\n    this.type = o.type || 'pubsliser'; //扫码来源  评论页？发布话题页？等\n    this.$showBox = o.$showBox; //二维码弹层\n    this.time = o.time || 2000; //轮询请求间隔\n    this.customInit = o.customInit || \"\";\n    this.customCb = o.customCb; //用户自定义回调函数\n    this.isLoad = 0;\n    // this.$insertDom = o.$insertDom; //插入图片的节点\n    this.imgArr = []; //存储二维码未过期时，获得的的图片总数\n    this.editor = o.editor || \"\"; //用于编辑器\n    this.$cover = o.$showBox.find('[data-node=\"cover\"]'); //是否上传中\n    this.$localBtn = o.$showBox.find('[data-node=\"upLocal\"]'); //是否上传中\n    this.$target = o.$target;\n    this.code = \"\";\n    this.btn = o.btn;\n\n}\n\nScans.prototype = {\n    constructor: Scans,\n    init: function() {\n        var _this = this;\n        if (_this.editor) {\n            //\n            /*_this.editor.document.body.addEventListener('DOMNodeRemoved', function(evt) {\n                var code = evt.keyCode || evt.which\n                if (code == 8) {\n                    var target = evt.target\n                    debugger;\n                    console.log(target.nodeName, target.previousSibling, target.previousSibling.nodeName)\n                    if (target.nodeName == \"#text\") {\n                        if (target.previousSibling && target.previousSibling.nodeName == \"IMG\") {\n            console.log(333)\n                        }\n                    }\n                }\n            })*/\n\n            /*$(_this.editor.document).on('DOMNodeRemoved DOMNodeInserted', 'img', function(e) {\n                if (_this.interval) {\n                    //console.log(666)\n                    setTimeout(function() {\n                        _this.sendNum();\n                    }, 100)\n\n                }\n            })*/\n\n            $(_this.editor.body).on('click', function(e) {\n                //$webUpLoader.destroy();\n                _this.hide();\n                e.preventDefault();\n            })\n        }\n\n        if (typeof _this.customInit == 'function') {\n            this.customInit(this);\n        }\n        $('body').on('click', /* _this.$showBox*/ '[data-node=\"picPopBox\"]', function(e) {\n            var tagName = e.target.tagName;\n            tagName = tagName == 'INPUT' || tagName == 'LABEL'\n            if (!tagName) {\n                e.stopPropagation();\n            } else {\n                _this.hide()\n            }\n\n        });\n\n        this.start();\n    },\n    start: function() {\n        if (!this.useNewCode) {\n            this.getCode()\n        } else {\n\n            if (this.checkShow()) {\n                this.hide()\n            } else {\n                this.show();\n            }\n        }\n    },\n    //获取图片数量\n    imgLength: function() {\n        if (this.editor) {\n            return $(this.$parent.getContent()).find(\"img\").not('[data-node=\"goodsPic\"],[data-node=\"emoji\"]').length;\n        } else {\n            return this.$parent.find(\"img\").length;\n        }\n    },\n    //获取二维码\n    getCode: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var datas = {\n            pageId: pageId,\n            maxNum: this.uploadMaxNum - len\n        }\n        var qid = _this.qid;\n        var qidArr = window.topicQrId; //检测window变量是否有此变量 格式为：\n        _this.show();\n        //topicQrId:{\n        //  qid1:s1111,\n        //  qid2:s2222\n        // }\n        if (qidArr[qid].qrcodeId) {\n            datas.qrcodeId = _this.topicQrId;\n        }\n        fetch\n            .get(url.get('getUploadQrCode'), {\n                data: datas\n            })\n            .done(function(data) {\n                if (data.success == true) {\n\n                    if (data.code == 200) {\n\n                        _this.useNewCode = 1;\n\n                        var _data = data.data;\n\n                        var str = domain + 'qrupload/index?pageId=' + _data.pageId + '&qrcodeId=' + _data.qrcodeId + '&type=' + _this.type;;\n                        str = domain + 'ajax/qrcode/urlcode?url=' + encodeURIComponent(str);\n\n                        window.topicQrId[qid].qrcodeId = _this.topicQrId = _data.qrcodeId; //把data的值赋予 window [qid].qrcodeId\n\n                        _this.code = str; //把二维码的值放入\n                        _this.getCodeCb();\n\n                        _this.interval = setInterval(function() {\n                            _this.monitor();\n                        }, _this.time)\n\n                    }\n                } else {\n                    alert(data.message);\n                }\n            })\n            .fail(function(e, s) {})\n\n    },\n    //扫码轮询\n    monitor: function() {\n        var _this = this;\n        fetch\n            .post(url.get('topListenImg'), {\n                data: {\n                    code: pageId,\n                    groupkey: window.topicQrId[_this.qid].qrcodeId\n                }\n\n            })\n            .done(function(data) {\n\n                if (data.success == true) { //ok\n                    _this.scanCb(data);\n                } else {\n                    _this.hide();\n                }\n            }).fail(function(e, m) {\n                clearInterval(_this.interval);\n                _this.interval = 0;\n                _this.hide();\n                // alert(e);\n            })\n    },\n    sendNum: function() {\n        var _this = this;\n        var len = this.imgLength();\n        var maxNum = this.uploadMaxNum - len;\n        fetch\n            .get(url.get('topicuploadMax'), {\n                data: {\n                    qrcodeId: _this.topicQrId,\n                    maxNum: maxNum\n                }\n            })\n    },\n    //插入图片\n    insertPic: function(data) {\n        for (var i = 0, len = data.length; i < len; i++) {\n            var _data = data[i];\n            var _img = imgReplace.imgReplace(_data);\n            var _proto = imgReplace.imgProto(_data);\n            var str = '<p><img src=\"' + _img + '\" _src=\"' + _img + '\" data-type=\"insertImg\" proto=\"' + _proto + '\"/></p>';\n            this.editor.execCommand('inserthtml', str);\n        }\n    },\n    //用户正在上传中\n    loading: function() {\n        this.isLoad = 1;\n        this.$showBox.show();\n        this.$cover.show();\n        this.$localBtn.addClass('upload-unable');\n        if (this.editor) {\n            this.editor.setDisabled();\n        }\n\n    },\n    //用户不在上传中\n    unLoading: function() {\n        this.isLoad = 0;\n        this.$cover.hide();\n        this.$cover.css(\"display\", \"none\");\n        this.$localBtn.removeClass('upload-unable');\n        if (this.editor) {\n            this.editor.setEnabled();\n        }\n\n    },\n    //检查弹层状态\n    checkShow: function() {\n        if (this.$showBox.is(\":visible\")) {\n            return true;\n        }\n        return false;\n    },\n    //调整弹窗位置\n    fixPop: function() {\n        var $btn = this.$target;\n        var offset = $btn.offset();\n        var x = offset.left;\n        var y = offset.top / 1 + 30;\n\n        return this.$showBox.css({\n            'top': y + 'px',\n            'left': x + 'px'\n        });\n\n    },\n    //显示弹层\n    show: function() {\n        this.$showBox.removeClass('webuploader-element-invisible');\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        this.fixPop().show();\n    },\n    //隐藏弹层\n    hide: function() {\n        if (this.isLoad != 1) {\n            this.$showBox.hide();\n        }\n    },\n    //获得二维码回调\n    getCodeCb: function() {\n        this.sendNum(); //发送二维码数量\n        this.$showBox.find(\"img\").attr('src', this.code).css(\"display\", \"block\");\n        //this.show();\n    },\n    //扫码回调\n    scanCb: function(data) {\n\n            switch (data.isload) {\n                case 1:\n                    this.unLoading()\n                    break;\n                case 2: //上传中\n                    this.loading()\n\n                    break;\n                case 3: //上传完成\n                    var dataArr = data.data;\n                    var tempArr = [];\n\n                    var diffLen = dataArr.length - this.imgArr.length;\n\n                    if (diffLen) {\n                        this.loading()\n                        this.imgArr = dataArr;\n                        tempArr = dataArr.slice(-diffLen)\n                        var _this = this;\n                        setTimeout(function() {\n                            _this.unLoading()\n                            _this.hide();\n                            if (typeof _this.customCb == 'function') {\n                                _this.customCb(tempArr, _this)\n                            } else {\n                                _this.insertPic(tempArr);\n                            }\n\n                        }, 500)\n                    }\n                    break;\n                case 10000:\n                    this.imgArr = [];\n                    this.isload = 0;\n                    this.useNewCode = 0; //useNewCode 为0 意味着二维码过期\n                    clearInterval(this.interval);\n                    this.interval = 0;\n                    this.hide();\n                    break;\n            }\n        }\n        //prototype end\n}\n\nmodule.exports = Scans;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/uploadfileQR/index.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/uploadfileQR/upload',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgPath=$data.imgPath,$out='';$out+='<div data-node=\"picPopBox\" class=\"picPopBox\" data-node=\"picPopBox\"> <em class=\"sanjiao\"></em> <div class=\"container clearfix\"> <div class=\"left\"> <div class=\"qr\"> <img src=\\'\\'/> <div class=\"cover\" data-node=\"cover\">上传中...</div> </div> <p>扫描二维码,上传手机图片</p> </div> <div class=\"right\" data-node=\"uploadList\"> <div class=\"pc-btn pc-btnh35\" data-defaultAddFile=\\'picker\\'></div> </div> </div> </div> <div data-node=\"picLoading\" class=\"picLoading hide\"> <img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/public/loading.gif\"/> <div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/uploadfileQR/upload.tpl\n// module id = 121\n// module chunks = 6 16 30","//白名单\nvar whiteList = {\n    a: ['target', 'href', 'title', 'class', 'data-node'],\n    div: ['class', 'style', 'data-node', 'unselectable', 'onselectstart', 'data-type', 'data-skuid'],\n    dl: ['class', 'style', 'data-node'],\n    dt: ['class', 'style'],\n    em: ['class', 'style', 'data-node'],\n    h1: ['data-node'],\n    h2: ['data-node'],\n    h3: ['data-node'],\n    h4: ['data-node'],\n    h5: ['data-node'],\n    h6: ['data-node'],\n    img: ['src', 'alt', 'title', 'width', 'height', 'id', '_src', 'loadingclass', 'class', 'data-latex', 'data-node', 'data-index', 'data-type', 'data-node', 'data-original', 'onerror', 'proto'],\n    p: ['class', 'style', 'data-node'],\n    span: ['class', 'style', 'data-node'],\n    ul: ['class', 'style', 'data-node'],\n    ol: ['class', 'style', 'data-node'],\n    li: ['class', 'style', 'data-node']\n};\n\nvar defaults = {\n    //图片张数限制\n    imgLimitNUm: 20,\n    //商品个数限制\n    goodsLimitNUm: 9,\n    initialFrameWidth: 788,\n    initialFrameHeight: 400,\n    zIndex: 9,\n    autoClearinitialContent: true,\n    //服务器根目录\n    UEDITOR_HOME_URL: $_CONFIG['js_domain'],\n    //后台地址\n    //serverUrl:'php/1.php',\n    //serverUrl: $_CONFIG['group_domain'],\n    serverUrl: '',\n    //css 路径\n    themePath: $_CONFIG.csspath + '/css/module/',\n    //白名单\n    whitList: whiteList,\n    //工具栏\n    toolbars: [\n        ['bold', 'italic', 'underline', 'insertunorderedlist', 'insertorderedlist', 'justifyleft', 'justifycenter', 'justifyright']\n        //['insertunorderedlist', 'insertorderedlist']\n    ],\n    //iframe 内置样式\n    iframeCssUrl: $_CONFIG.csspath + '/css/module/iframestyle.css?v=' + $GLOBAL_CONFIG['versionData'],\n    //'//localhost:8017/src/js/editor/themes/iframestyle.css',\n    //纯文本粘贴\n    pasteplain: true,\n    //禁止div转换成p标签\n    allowDivTransToP: false,\n    //禁止缩放图片\n    imageScaleEnabled: false,\n    elementPathEnabled: false, // 关闭元素路径,调试时暂时开启\n    wordCount: false, // 字数统计\n    //禁止非同域上传图片\n    catchRemoteImageEnable: true,\n    //匹配快捷按键回调\n    // callbackKey: shortcutKey.callbackKey,\n    //右键菜单功能\n    enableContextMenu: false,\n    // 因为是用的自定义的弹窗,所以,关闭了编辑器自带的图片弹窗\n    imagePopup: false,\n    // 禁止自动保存\n    enableAutoSave: false,\n    // 自定义过滤规则\n    // filterTxtRules:filterTxtRules()\n};\nmodule.exports = defaults;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/editor/config.js","var dialog = require('module/popup/addGoods/dialog');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar Pubsub = require('io/pubsub');\nvar tpl = require('module/popup/addGoods/content.tpl');\nvar itemlist = require('module/popup/addGoods/itemContent.tpl');\nvar defaultItemlist = require('module/popup/addGoods/defaultItemContent.tpl');\nvar pubName = require('io/channel');\nvar indexof = require('lodash/indexOf');\nvar alert = require('module/popup/alert');\n\nvar pageNum = 1;\nvar maxlength = 9;\nvar isDefault = true;\nvar keyWord = '';\nvar changedList = [];\nvar isGetMore = false;\nvar options = {};\nvar degree = 1;\n// var delChanged = [];\nvar addDialog;\n\nvar $searchTop = null,\n    $searchInput = null,\n    $searchBtn = null,\n    $searchNormal = null,\n    $searchLoading = null,\n    $searchFail = null,\n    $searchResult = null,\n    $searchList = null,\n    // $searchPage = null,\n    $changeNum = null,\n    $listBox = null,\n    $changeList = null,\n    $title = null,\n    $getMore = null,\n    $searchListBox = null;\n\nvar selectedGoods = {};\n\nvar init = function(changedGoods, max /* 最多可选 */ ) {\n    var returnList = [];\n    selectedGoods = {};\n    // var selectedGoodsBak = {};\n    for (var i in changedGoods) {\n        changedList.push(i);\n        returnList.push(changedGoods[i]);\n    }\n\n    maxlength = max || 9;\n    selectedGoods = $.extend(true, selectedGoods, changedGoods);\n    if (maxlength - returnList.length !== 0) {\n        options = {\n            title: ' ',\n            modal: true,\n            fixed: true,\n            width: 712,\n            content: tpl({\n                imgSrc: $_CONFIG.imgpath,\n                returnList: returnList,\n                maxlength: maxlength,\n                changeNum: maxlength - returnList.length\n            }),\n            className: 'pop-box',\n            okValue: '插入商品',\n            okCls: 'pc-btn pc-btnh35 circle-pop-btn btn-default',\n            btnWrapCls: 'insert-cancel',\n            ok: function() {\n                if ($(this.node).find('[i-id=ok]').hasClass('btn-default')) {\n                    return false;\n                }\n                Pubsub(pubName.setPubliser.changedItem).pub(selectedGoods);\n                dialogClosed();\n            },\n            cancel: function() {\n                dialogClosed();\n            },\n            onshow: function() {\n\n                $('[i=\"title\"]').hide();\n                getNode(); //获取节点\n                defaultItem(pageNum); //默认输出内容\n                searchItem(); //搜索商品\n                reGet(); //重新获取\n                changeItem(); //选择添加的商品\n                getMoreItem(); //加载 更多\n                $('body').css({\n                    height: '100%',\n                    overflowY: 'hidden'\n                });\n            }\n        };\n\n    } else {\n        options = {};\n    }\n\n    addDialog = dialog.create(options);\n    setTimeout(function() {\n        addDialog.show();\n    }, 100)\n\n};\n//获取节点\nvar getNode = function() {\n    $searchTop = $('[data-node=\"addTopBox\"]');\n    $searchInput = $searchTop.find('[data-action=\"addSearchInput\"]');\n    $searchBtn = $searchTop.find('[data-action=\"addSearchBtn\"]');\n    $searchNormal = $('[data-node=\"searchNormal\"]');\n    $searchLoading = $('[data-node=\"searchLoading\"]');\n    $searchFail = $('[data-node=\"searchFail\"]');\n    $searchResult = $('[data-node=\"searchResultBox\"]');\n    $searchList = $searchResult.find('[data-node=\"searchResultList\"]');\n    $listBox = $searchResult.find('[data-node=\"changedBox\"]');\n    $changeList = $listBox.find('[data-node=\"searchChangeList\"]');\n    $changeNum = $searchResult.find('[data-node=\"searchChangeNum\"]');\n    $title = $('[data-node=\"title\"]'),\n        $getMore = $searchResult.find('[data-action=\"moreItem\"]');\n    $searchListBox = $searchList.parent();\n};\n\n//初始化进弹窗获取数据\nvar defaultItem = function(pageNum) {\n    getItems(url.get('getCollectItem'), {\n        data: {\n            page: pageNum,\n            pagesize: 10\n        },\n        done: function(result) {\n            var html = defaultItemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//搜索 商品\nvar searchItem = function() {\n    $searchInput.on('keyup', function(e) {\n        var keycode = e.which;\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).val());\n        //处理回车的情况\n        if (keycode === 13) {\n            if (keyWord !== '') {\n                if (keyWord.length < 2) {\n                    alert('请输入两个字符以上关键词');\n                } else {\n                    pageNum = 1;\n                    $title.hide();\n                    $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                    moreItem(pageNum, keyWord);\n                }\n            } else {\n                alert('请输入关键词');\n            }\n        }\n        //返回我收藏的商品列表\n        if (keyWord === '') {\n            $searchResult.children().eq(0).hide();\n            isDefault = true;\n            pageNum = 1;\n            $title.show();\n            defaultItem(pageNum); //默认输出内容\n\n        }\n    });\n    $searchBtn.on('click', function() {\n        isDefault = false;\n        isGetMore = false;\n        keyWord = $.trim($(this).prev().val());\n\n        if (keyWord !== '') {\n            if (keyWord.length < 2) {\n                alert('请输入两个字符以上关键词');\n            } else {\n                $getMore.find('span').html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n                pageNum = 1;\n                $title.hide();\n                moreItem(pageNum, keyWord);\n            }\n        } else {\n            alert('请输入关键词');\n        }\n\n    });\n};\n\n//获取更多商品\n\nvar moreItem = function(pageNum, txt) {\n    getItems(url.get('getMoreItem'), {\n        data: {\n            pagenum: pageNum,\n            pagesize: 10,\n            word: txt\n        },\n        done: function(result) {\n            var html = itemlist({\n                itemlist: result.data.items,\n                changedList: changedList,\n                indexof: indexof\n            });\n            if (result.pageCount != \"1\") {\n                $getMore.hide();\n            }\n            if (pageNum === 1) {\n                $searchList.html(html);\n            } else {\n                $searchList.append(html);\n            }\n        }\n    });\n};\n\n//ajax\nvar getItems = function(link, options) {\n    if (pageNum === 1) {\n        $searchList.hide();\n        $searchFail.hide();\n        $searchLoading.show();\n        $searchNormal.hide();\n    } else {\n        $getMore.show();\n    }\n    fetch.get(link, {\n        data: options.data\n    }).done(function(result) {\n\n        if (result.code === 200) {\n            var resultItem = result.data.collections === undefined ? result.data.items : result.data.collections;\n            if ((!resultItem || resultItem.length === 0) && isDefault) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('暂无收藏的商品，可以搜索查找！');\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else if (!resultItem || resultItem.length === 0) {\n                if (pageNum === 1) {\n                    $searchNormal.show().text('没有找到相关产品');\n                    $searchResult.children().eq(0).hide();\n                } else {\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            } else {\n                $searchResult.show().children().eq(0).show();\n                $searchList.show();\n                options.done.call(this, result);\n                $getMore.hide();\n                isGetMore = false;\n\n                if (resultItem.length < 10 && pageNum !== 1) {\n\n                    isGetMore = true;\n                    $getMore.show().find('span').text('没有可加载内容');\n                }\n            }\n\n            // 重新定位弹窗位置\n            // addDialog.reset();\n\n        } else if (result.code === 881001) {\n            if (pageNum === 1) {\n                $searchNormal.show().text('没有找到相关产品');\n                $searchResult.children().eq(0).hide();\n            } else {\n                $getMore.show().find('span').text('没有可加载内容');\n            }\n        } else {\n            if (pageNum === 1) {\n                $searchFail.show();\n            } else {\n                $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n            }\n        }\n    }).fail(function() {\n        if (pageNum === 1) {\n            $searchFail.show();\n        } else {\n            $getMore.show().find('span').html('数据获取失败，点击<a href=\"javascript:;\" node-action=\"reget\" class=\"reload\">重新加载</a>！');\n        }\n    }).always(function() {\n        $searchLoading.hide();\n    });\n};\n\n//重新获取\nvar reGet = function() {\n    $searchFail.on('click', function() {\n        if (pageNum === 1) {\n            $searchLoading.show();\n            $searchFail.hide();\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n    $getMore.on('click', '[node-action=\"reget\"]', function() {\n        $(this).parent().html('<img src=\"' + $_CONFIG.imgpath + '/images/public/loading.gif\">正在加载...');\n        if (isDefault) {\n            defaultItem(pageNum);\n        } else {\n            moreItem(pageNum, keyWord);\n        }\n    });\n};\n\nvar changeItem = function() {\n    if ($changeList.children().length) {\n        $('[i-id=ok]').removeClass('btn-default');\n    }\n    $searchResult.on('click', '[data-action=\"item\"]', function() {\n        var $this = $(this);\n        var imgSrc = $this.find('img').attr('src'),\n            pId = $this.attr('data-pId'),\n            shopId = $this.attr('data-shopid'),\n            itemLink = $this.attr('data-link'),\n            skuId = $this.attr('data-skuId'),\n            html = '';\n        if (maxlength == 1) {\n            if ($changeList.children().length) {\n                $changeList.empty();\n                $searchList.children(\"dl\").removeClass(\"chosed-mer-true\");\n\n            }\n            $this.addClass(\"chosed-mer-true\");\n\n            if ($changeList.children().length === 0) {\n                $listBox.show();\n            }\n            selectedGoods = {};\n            selectedGoods[skuId] = {\n                shopId: shopId,\n                skuId: skuId,\n                PId: pId,\n                title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                img: imgSrc,\n                price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                // 融合后的新商品链接\n                link: itemLink,\n                //rebate: $(this).attr('data-rebate')\n            };\n            html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n\n            $changeList.append(html);\n            $changeNum.text(maxlength - $changeList.children().length);\n        } else {\n\n            if (!$(this).hasClass('chosed-mer-true')) {\n                if ($changeList.children().length >= maxlength) {\n                    alert('最多可选取' + maxlength + '个商品');\n                    return false;\n                }\n\n                changedList.push(skuId);\n                selectedGoods[skuId] = {\n                    shopId: shopId,\n                    skuId: skuId,\n                    PId: pId,\n                    title: $(this).find('[node-data=\"itemTitle\"]').text(),\n                    img: imgSrc,\n                    price: $(this).find('[node-data=\"itemPrice\"]').text(),\n                    // link: $_CONFIG.mall_domain + 'product/' + $(this).attr('data-shopId') + '-' + pId + '.html'\\\n                    // 融合后的新商品链接\n                    link: $(this).attr('data-link'),\n                    //rebate: $(this).attr('data-rebate')\n                };\n                $(this).addClass('chosed-mer-true');\n                html = '<li data-skuId=\"' + skuId + '\" data-pId=\"' + pId + '\" data-degree=\"' + degree + '\"><img src=\"' + imgSrc + '\" alt=\"\"><a href=\"javascript:;\" data-action=\"delChanged\"><em class=\"icon-del-pic\"></em></a></li>';\n                if ($changeList.children().length === 0) {\n                    $listBox.show();\n                }\n                $changeList.append(html);\n                $changeNum.text(maxlength - $changeList.children().length);\n            } else {\n                var del = $changeList.find('[data-skuId=\"' + skuId + '\"]');\n                $(this).removeClass('chosed-mer-true');\n                del.remove();\n\n                var id = $(this).attr('data-skuId');\n                var index = changedList.indexOf(id);\n                if (index !== -1) {\n                    changedList.splice(index, 1)\n                }\n                delete selectedGoods[id];\n                if ($changeList.children().length === 0) {\n                    $listBox.hide();\n                }\n                $changeNum.text(maxlength - $changeList.children().length);\n            }\n\n        }\n\n        if ($changeList.children().length) {\n            $('[i-id=ok]').removeClass('btn-default');\n        } else {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n\n        addDialog.reset();\n\n    }).on('click', '[data-action=\"delChanged\"]', function() {\n        var id = $(this).closest('li').attr('data-skuId');\n        var index = changedList.indexOf(id);\n        if (index !== -1) {\n            changedList.splice(index, 1)\n        }\n        var _this = this;\n        $searchList.find('[data-skuId=\"' + $(_this).parent().attr('data-skuId') + '\"]').removeClass('chosed-mer-true');\n\n        $(_this).parents('li').remove();\n        delete selectedGoods[id];\n        if ($changeList.children().length === 0) {\n            $listBox.hide();\n        }\n        $changeNum.text(maxlength - $changeList.children().length);\n        if (!$changeList.children().length) {\n            $('[i-id=ok]').addClass('btn-default');\n        }\n    });\n};\n\n//加载更多\nvar getMoreItem = function() {\n    $searchListBox.on('scroll', function() {\n        if (!isGetMore && $searchListBox.scrollTop() >= ($searchList.height() - $searchListBox.height())) {\n            isGetMore = true;\n            pageNum++;\n            if (isDefault) {\n                defaultItem(pageNum);\n            } else {\n                moreItem(pageNum, keyWord);\n            }\n        }\n    });\n};\n\n//弹窗关闭\nvar dialogClosed = function() {\n    degree++;\n    $('body').css({\n        height: 'auto',\n        overflowY: 'auto'\n    });\n\n    $searchListBox.off('scroll');\n    $searchResult.off('click');\n    $searchFail.off('click');\n    $searchInput.off('keyup');\n    $searchBtn.off('click');\n    pageNum = 1;\n    // delChanged = [];\n    isDefault = true;\n    keyWord = '';\n    isGetMore = false;\n    changedList = [];\n};\n\nmodule.exports = init;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/addGoods.js","var Dialog = require('dialog');\r\n\r\n\r\n\r\nvar create = function(options) {\r\n    options = options || {};\r\n    var defaults = {\r\n        title: ' ',\r\n        modal: true,\r\n        fixed: true,\r\n        width: 350,\r\n        content: '<p class=\"del-pop-p\">您最多能添加9个商品哦！</p>',\r\n        className: 'pop-box',\r\n        okValue: '确定',\r\n        okCls: 'pc-btn pc-btnh35 circle-pop-btn',\r\n        ok: function() {\r\n\r\n        },\r\n        onshow: function() {\r\n            $('[i=\"title\"]').hide();\r\n        }\r\n    };\r\n    $.extend(true, defaults, options);\r\n    return Dialog(defaults);\r\n};\r\n\r\n\r\nmodule.exports = {\r\n    create: create\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/popup/addGoods/dialog.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/content',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,imgSrc=$data.imgSrc,returnList=$data.returnList,$each=$utils.$each,$value=$data.$value,$index=$data.$index,changeNum=$data.changeNum,maxlength=$data.maxlength,$out='';$out+=' <div class=\"search-box\" data-node=\"addTopBox\"> <input type=\"text\" placeholder=\"搜索商品\" data-action=\"addSearchInput\"> <em class=\"icon-search-sw\" data-action=\"addSearchBtn\"></em> </div> <div class=\"ui-dialog-title\" data-node=\"title\">我收藏的商品</div> <p class=\"no-saving-txt\" style=\"display:none;\" data-node=\"searchNormal\">暂无收藏的商品，可以搜索查找！</p> <div class=\"loading\" data-node=\"searchLoading\"><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\" alt=\"\"></div> <p class=\"failed-txt\" style=\"display:none;\" data-node=\"searchFail\">数据获取失败，点击重新加载！</p> <div style=\"display:';\n$out+=$escape((returnList.length === 0 ? 'none':''));\n$out+=';\" data-node=\"searchResultBox\"> <div class=\"merchant-list clearfix\" > <div class=\"clearfix\" data-node=\"searchResultList\"></div> <div class=\"more-comments pop-more-com\" data-action=\"moreItem\" style=\"display:none;\"> <span><img src=\"';\n$out+=$escape(imgSrc);\n$out+='/images/public/loading.gif\">正在加载...</span> </div> </div> <div class=\"chosed-merchants\" data-node=\"changedBox\" style=\"display:';\n$out+=$escape((returnList.length>0?'':'none'));\n$out+='\"> <ul class=\"merchants-list clearfix\" data-node=\"searchChangeList\"> ';\n$each(returnList,function($value,$index){\n$out+=' <li data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" data-pid=\"';\n$out+=$escape($value.PId);\n$out+='\"> <img src=\"';\n$out+=$escape($value.img);\n$out+='\" alt=\"\" onerror=\"imgError(this)\"> <a href=\"javascript:;\" data-action=\"delChanged\"> <em class=\"icon-del-pic\"></em> </a> </li> ';\n});\n$out+=' </ul> </div> <div class=\"num-pics\">您可以添加 <span class=\"link-hover-red\" data-node=\"searchChangeNum\">';\n$out+=$escape(changeNum);\n$out+='</span>/<span class=\"deep-gray\">';\n$out+=$escape(maxlength);\n$out+='</span>个商品</div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/content.tpl\n// module id = 133\n// module chunks = 6 16 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/itemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$string=$utils.$string,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"11111\" onerror=\"imgError(this)\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$string($value.name);\n$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.salePrice !== null?$value.salePrice:'暂无售价');\n$out+='</span></span> <!-- ';\nif($value.rebateMoney > 0){\n$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n$out+=$escape($value.rebateMoney);\n$out+='国美币</span> </div> ';\n}\n$out+=' --> </dd> </dl> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/itemContent.tpl\n// module id = 134\n// module chunks = 6 16 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/module/popup/addGoods/defaultItemContent',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,itemlist=$data.itemlist,$value=$data.$value,$index=$data.$index,$escape=$utils.$escape,indexof=$data.indexof,changedList=$data.changedList,$out='';$each(itemlist,function($value,$index){\n$out+=' <dl class=\"merchant-item clearfix ';\n$out+=$escape((indexof(changedList,$value.skuId) !== -1 ? 'chosed-mer-true':''));\n$out+='\" data-action=\"item\" data-pId=\"';\n$out+=$escape($value.pId);\n$out+='\" data-shopId=\"';\n$out+=$escape($value.shopId);\n$out+='\" data-link=\"';\n$out+=$escape($value.sUrl);\n$out+='\" data-skuId=\"';\n$out+=$escape($value.skuId);\n$out+='\" > <dt><img src=';\n$out+=$escape($value.mainImage);\n$out+=' alt=\"\" onerror=\"imgError(this,\\'m\\')\"></dt> <dd> <h4 node-data=\"itemTitle\">';\n$out+=$escape($value.name);\n$out+='</h4> <span class=\"itemPrice\"><em>￥</em><span node-data=\"itemPrice\">';\n$out+=$escape($value.skuPrice);\n$out+='</span></span> <!-- ';\nif($value.rebate > 0){\n$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n$out+=$escape($value.rebate);\n$out+='国美币</span> </div> ';\n}\n$out+=' --> </dd> </dl> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/module/popup/addGoods/defaultItemContent.tpl\n// module id = 135\n// module chunks = 6 16 30","var fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar confirm = require('module/popup/confirm');\nvar tips = require(\"module/i18n\").circle;\nvar checkLoginStatus = require('module/checkLoginStatus');\nvar loginPop = require('module/popup/login');\n\n// var popTpl = \"<p data-node='alertTitle' class='dialog_p'>申请已发送，请耐心等待</p><img data-node='QRcode' src=''><p class='dialog_p'>下载国美APP随时关注</p>\";\n\nvar join = function (event){\n\tvar $els = event.data?event.data.selector||$(this):$(this);\n\tvar $action = $els.attr('data-action');\n\tvar done = event.data?event.data.done||function (){}:function (){};\n\tvar word = event.data?event.data.word||{ join : '加入圈子', focus : '退出圈子' }:{ join : '加入圈子', focus : '退出圈子' };\n\tvar groupId = $els.attr('data-groupid'),\n\t\tmemberType = $els.attr('data-membertype'),\n\t\tbpData = {\n\t\t\tevent_id: $els.attr('event-id'), // 埋点数据\n\t\t\tgroup_id: groupId,\n\t\t\tcircle_type: $_CONFIG['s_c'] // 2级分类\n\t\t};\n\tif ($_CONFIG['topicid']) {\n\t\tbpData.topic_id = $_CONFIG['topicid'];\n\t}\n\t// 发送统计数据\n\tif (window.BP !== undefined) {\n\t\tBP.send(bpData);\n\t}\n\n\tif ($els.attr('data-verif') == 1) {\n\t\talert('您已提交申请，请等待审核');\n\t\treturn;\n\t}\n\t/*var firing = $els.attr('data-firing');\n\tif (firing == 1) {\n\t\treturn false;\n\t}\n\t$els.attr('data-firing', 1);*/\n\tvar userid = $els.attr('data-userid');\n\t// var approvaltype = $els.attr('data-approvaltype');\n\n\n\tvar newWeb = '';\n\tvar noRefreshFetch = function(flag) {\n\t\tfetch.post(url.get('joinCircle'), {\n\t\t\t// validate: true,\n\t\t\tdata: {\n\t\t\t\tgroupid: groupId,\n\t\t\t\timid: 'b_' + userid\n\t\t\t}/*,\n\t\t\tonLogin: function (){\n\t\t\t\t$_CONFIG['islogin'] = '1';\n\t\t\t\tnoRefreshFetch();\n\t\t\t}*/\n\t\t}).done(function(data/*, textStatus, jqXHR*/) {\n\t\t\tif (data && data.code === 200 && data.success) {\n\t\t\t\tif (data.data.status === 0) {\n\t\t\t\t\tif($action && $action == 'joinGroup' && !flag) {\n\t\t\t\t\t\tconfirm(tips.joinSuccessPublic, {\n\t\t\t\t\t\t\t\tclassName: 'pop-box',\n\t\t\t\t\t\t\t\tokValue: '暂不发布',\n\t\t\t\t\t\t\t\tcancelValue: '立即发布话题',\n\t\t\t\t\t\t\t\tokCls: 'pc-btn pc-btnh35 circle-pop-btn circle-cancel-btn',\n\t\t\t\t\t\t\t\tcancelCls: 'pc-btn pc-btnh35 circle-pop-btn',\n\t\t\t\t\t\t\t\tcontent: '<button data-active=\"close-join\" class=\"ui-dialog-close icon icon-close\" title=\"取消\">×</button><div i=\"title\" class=\"ui-dialog-title\" style=\"border-bottom: none;\"></div><p class=\"del-pop-p\">' + tips.joinSuccessPublic + '</p>',\n\t\t\t\t\t\t\t\tok: function(){},\n\t\t\t\t\t\t\t\tcancel: function(){\n\t\t\t\t\t\t\t\t\t// var $postTopic = $('[data-node=postTopic]');\n\t\t\t\t\t\t\t\t\tvar url = 'topic/publiser?gid=' + $els.attr('data-groupid');\n\t\t\t\t\t\t\t\t\twindow.open($_CONFIG['group_domain']+url);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if($action && $action == 'joinCircle') {\n\t\t\t\t\t\talert(tips.joinSuccess);\n\t\t\t\t\t} else {\n\t\t\t\t\t\talert(tips.joinSuccess);\n\t\t\t\t\t}\n\t\t\t\t\t$('[data-active=close-join]').on('click', function(){\n\t\t\t\t\t\t$('.pop-box-backdrop').hide();\n\t\t\t\t\t\t$('[role=alertdialog]').hide();\n\t\t\t\t\t})\n\t\t\t\t\t$els.html(word.focus);\n\t\t\t\t} else if (data.data.status === 1) {\n\t\t\t\t\t// alert('申请已发送，请耐心等待');\n\t\t\t\t\t// var Dialog = alert('', {\n\t\t\t\t\t//     width: \"500px\",\n\t\t\t\t\t//     content: popTpl,\n\t\t\t\t\t//     cancel: false\n\t\t\t\t\t// });\n\t\t\t\t\t$('[data-node=QRcode]').attr('src', $_CONFIG.imgpath + '/images/public/down-ma.png');\n\t\t\t\t\t$('.dialog_p').css({\n\t\t\t\t\t\t'text-align': 'center',\n\t\t\t\t\t\t'margin': '10px 0px',\n\t\t\t\t\t\t'font-size': '1.5em'\n\t\t\t\t\t});\n\t\t\t\t\t$('[data-node=QRcode]').css({\n\t\t\t\t\t\t'margin-left': '173px'\n\t\t\t\t\t});\n\t\t\t\t\t// $els.css('background', '#CCC').html('审核中').off();\n\t\t\t\t\t// $els.html(word.join);\n\t\t\t\t\talert('您已申请加入圈子，请等待圈主审核');\n                    done(\"joining\", $els);\n                    setTimeout(function() {\n                    \tflag && location.reload();\n\t\t\t\t\t}, 1500)\n\t\t\t\t}\n\t\t\t\tdone(\"join\", $els);\n\t\t\t} else {\n\t\t\t\tif (data.code === 403 || data.message == '圈子拒绝加入') {\n\t\t\t\t\talert(tips.cannotJoinCircle);\n\t\t\t\t} else if (data.code === 409) {\n\t\t\t\t\t$els.html(word.join);\n\t\t\t\t\tif(data.error) {\n\t                    if(data.error.code === '2' || data.message === '该圈子人数已达上限'){\n\t                        alert(data.message);\n\t\t\t\t\t\t\tdone(\"limit\", $els);\n\t                    }else if(data.error.code === '3' || data.message === '您已申请加入圈子，请等待圈主审核'){\n\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\tdone(\"joining\", $els);\n\t\t\t\t\t\t}else if(data.error.code === '1' || data.message === '您已加入该圈子！'){\n\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\tdone(\"joined\", $els);\n\t\t\t\t\t\t\t$els.html(word.focus);\n\t\t\t\t\t\t\t// location.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\talert(data.message);\n\t\t\t\t}\n\t\t\t}\n\t\t}).fail(function(/*jqXHR, textStatus, errorThrown*/) {\n            // console.log(arguments);\n\t\t}).always(function() {\n\t\t\t// $els.attr('data-firing', 0);\n\t\t});\n\t};\n\tvar exitCircle = function (){\n\t\tfetch.post(url.get('exitCircle'), {\n\t\t\tdata: {\n\t\t\t\tgroupid: groupId\n\t\t\t}\n\t\t}).done(function(data/*, textStatus, jqXHR*/) {\n\t\t\tif (data && data.code == 200 && data.success) {\n\t\t\t\talert(tips.exit);\n\t\t\t\t$els.attr('data-membertype', 1);\n\t\t\t\t$els.html(word.join);\n\t\t\t\tdone(\"exit\", $els);\n\t\t\t}else{\n\t\t\t\tif( data.code == 410 ){\n\t\t\t\t\talert(tips.dissolved,{\n\t\t\t\t\t\tok:function (){\n\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonclose:function (){\n\t\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}else if (data.code == 404){\n\t\t\t\t\tlocation.reload();\n\t\t\t\t}\n\t\t\t}\n\t\t}).fail(function(/*jqXHR, textStatus, errorThrown*/) {\n\t\t\t// console.log(arguments);\n\t\t}).always(function() {\n\t\t\t$els.attr('data-firing', 0);\n\t\t});\n\t}\n\tif(!checkLoginStatus()){\n\t\tloginPop(function(){\n\t\t\t$_CONFIG['islogin'] = '1';\n\t\t\tnoRefreshFetch(1);\n\t\t\tsetTimeout(function() {\n            \twindow.location.href = window.location;\n\t\t\t}, 1500)\n\t\t})\n\t\treturn;\n\t}\n\tif( memberType == 0 ){\n\t\texitCircle();\n\t}else{\n\t\tnoRefreshFetch();\n\t}\n\treturn false;\n}\nmodule.exports = join;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/joinCircle.js","var fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar flag = false;\nvar sensitiveTitle = function(node,comment) {\n    fetch.post(url.get('sensitiveWord'), {\n        data: {\n            text: node\n        },\n        async: false\n    }).done(function(data) {\n        if (data.success === false) {\n            var msg = '标题';\n            flag = true;\n            if(comment){\n                msg='评论';\n            }\n            alert(msg + '中含有\"' + data.data + '\"敏感词');\n        } else {\n            flag = false;\n        }\n    }).fail(function() {\n        alert('数据加载失败');\n    });\n    return flag;\n}\n\nmodule.exports = sensitiveTitle;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/sensitiveContent.js","/**\n *\n * 赞/取消赞\n */\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar checkLoginStatus = require('module/checkLoginStatus');\nvar loginPop = require('module/popup/login');\n\nvar isLogin = checkLoginStatus(); //页面初始化是否登录判断\nvar popFlag = 0;\n\nvar noop = function() {};\nvar setData = function($node, praise, count) {\n    $node.data('praise', praise);\n    $node.data('count', count);\n};\n\nvar helper = {\n    normal: {\n        add: function($node, data, count) {\n            $node.addClass('active');\n            if (!count) {\n                count = \"取消点赞\";\n            }\n            $node.find('span').text(count);\n\n        },\n        reduce: function($node, data, count) {\n            $node.removeClass('active');\n            if (!count) {\n                count = \"点赞\";\n            }\n            $node.find('span').text(count);\n        }\n    }\n};\n\nvar getCallback = function(mode) {\n    return helper[mode];\n}\n\nvar praise = function(container, selector, options) {\n    var $container = $(container);\n    var onPraise = options.onPraise || noop;\n    var onUnPraise = options.onUnPraise || noop;\n    var onPraised = options.onPraised || noop;\n    var mode = options.mode || 'normal';\n\n    $container.on('click', selector, function() {\n        var $this = $(this);\n        /* var firing = $this.data('firing');\n         if (firing === 1) {\n             return;\n         }*/\n\n        // $this.data('firing', 1);\n        var t = $this.data('type');\n        var isPraise = $this.data('praise');\n        var id = $this.data('id');\n        var count = $this.data('count');\n\n        var objs = {\n            data: {\n                groupId: $_CONFIG['groupid'],\n                id: id,\n                type: t, // 0 店铺,  1 话题\n                isPraise: isPraise // 0 取消点赞, 1 点赞\n            }\n            /*,\n                        onLogin: noRefreshFetch,\n                        refresh: true*/\n        }\n\n        //无刷新登录\n        function noRefreshFetch() {\n            var o = objs;\n            fetch.post(url.get('praise'), o)\n                .done(function(data /*, textStatus, jqXHR*/ ) {\n                    var callbacks = getCallback(mode);\n                    //推送 评论区状态\n                    Pubsub(channel.comment.enableEditor).pub({\n                        pid: \"enable\"\n                    });\n\n                    if (data && data.code === 200 && data.success) {\n                        if (isPraise === 1) {\n                            setData($this, 0, ++count);\n                            callbacks.add($this, data, count);\n                            onPraise.call($this, data, count);\n                        } else if (isPraise === 0) {\n                            setData($this, 1, --count);\n                            callbacks.reduce($this, data, count);\n                            onUnPraise.call($this, data, count);\n                        }\n\n                    } else if (data && data.code === 422) {\n                        // window.location.href = $_CONFIG.passport_domain + 'login/index';\n                    } else if (data && data.code === 403) {\n                        alert('抱歉！该话题审核未通过', {\n                            ok: function() {\n                                window.location.href = $_CONFIG.group_domain + 'index/error?code=topic';\n                            }\n                        });\n                    } else if (data.code === 409) {\n                        //409点过赞  已经登录 把点赞状态回带，不刷新\n                        onPraised.call($this, data, count);\n                        if (!popFlag) {\n                            alert(data.message);\n                        }\n                    } else {\n                        var message = data.message;\n                        if (t === 0) {\n                            if (data.code === 404) {\n                                alert(message, {\n                                    ok: function() {\n                                        window.location.reload();\n                                    }\n                                });\n                            } else {\n                                alert(message);\n                            }\n                        } else {\n                            alert(message);\n                        }\n                    }\n                    if (popFlag) {\n                        window.location.reload();\n                    }\n                }).fail(function( /*jqXHR, textStatus, errorThrown*/ ) {\n                    // 点赞失败时,如何处理\n                }).always(function() {\n                    // $this.data('firing', 0);\n                });\n        }\n        if (!checkLoginStatus()) {\n            popFlag = 1;\n            loginPop(noRefreshFetch);\n        } else {\n            popFlag = 0;\n            noRefreshFetch()\n        }\n        return false;\n    });\n};\n\nmodule.exports = praise;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/praise.js","/*话题详情页 v2版本改造*/\n\nrequire('lazyload');\nvar face = require('module/popup/face/face');\n//var loginPop = require('module/popup/login'); //登录弹窗\n//var checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\n\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar identify = require('utils/IdentifyIE8-');\n\nvar getCommentList = require('./getCommentList'); //\nvar a_Submit = require('./a_submit'); //\nvar secondComBtn = require('./a_secondComBtn'); //\nvar showMoreList = require('./showMoreList'); //\nvar loginState = require('./loginState');\nvar Smiley = require('./Smiley');\nvar otherFn = require('./otherFn');\n\nvar $loadlist = $(\"[data-node='loadlist']\");\nvar $comment_Msg = $(\"[data-node='comment_Msg']\");\n//var $a_Submit = $(\"[data-node=a_Submit]\");\n//var $circleCom = $(\"[data-node=circleCom]\");\nvar clickTopicId = $_CONFIG['topicid'];\n\nvar DIVOBJ = $(\"[data-node='more-topic']\");\nvar textareaTips = '[data-node=\"textareaTips\"]';\nvar hide = 'hide';\n\n$loadlist.css(\"display\", \"none\");\n$(\"[data-node='loading']\").css(\"display\", \"none\");\n$(\"[data-node='noload']\").css(\"display\", \"none\");\n$(\"[data-node='imgUl']\").addClass(\"hide\");\n\nvar commentDomInit = function() {\n    $comment_Msg.on('click', loginState.commentCheck)\n\n    DIVOBJ.on(\"click\", \"[data-node='a_Submit']\", a_Submit);\n    //$a_Submit.on(\"click\", $); //一级话题回复 绑定事件\n    DIVOBJ.on(\"click\", \"[data-node='secondCom_Key']\", secondComBtn.secondCom_Key); //显示二级回复框\n    DIVOBJ.on(\"click\", \"[data-node='hideComBox']\", secondComBtn.hideComBox); //点击收起 按钮，隐藏二级输入框\n    DIVOBJ.on(\"click\", \"[data-node='a_secondComBtn']\", secondComBtn.a_secondComBtn); //二级话题回复\n    DIVOBJ.on('click', '[data-node=\"smilies_Face\"]', Smiley.showEmoji); //表情添加\n    DIVOBJ.on(\"click\", \"[data-node='showMoreList']\", showMoreList); // 二级列表\n    if (identify()) {\n        DIVOBJ.on('keydown', 'textarea', hideTextareaTips);\n        DIVOBJ.on('blur', 'textarea', showTextareaTips);\n    }\n\n}\n\n// placeholder显示隐藏\nvar hideTextareaTips = function() {\n    var $this = $(this);\n    $this.parent($comment_Msg).find(textareaTips).addClass(hide);\n}\nvar showTextareaTips = function() {\n    var $this = $(this);\n    var textVal = $.trim($this.val());\n    $this.val(textVal);\n    if (textVal.length) {\n        $this.parent($comment_Msg).find(textareaTips).addClass(hide);\n    } else {\n        $this.parent($comment_Msg).find(textareaTips).removeClass(hide);\n    }\n}\n\nvar init = function() {\n    //登陆状态以及事件绑定\n    if (loginState.getLoginState()) {\n        face.insert(function(data) {\n            Smiley.insertAtCursor(Smiley.curretTextAreaObj(), data.reg);\n        });\n\n    }\n    getCommentList(clickTopicId, 1, 10, 2); //评论列表\n    commentDomInit(); //事件绑定\n    otherFn.lodingMore(); //一级评论列表加载更多\n    otherFn.goComment(); // 点击评论图标页面滚动到评论区域\n    face.init(); // 初始化表情\n    $(\"img\").lazyload({\n        effect: \"fadeIn\"\n    });\n}\n\n// 订阅\nPubsub(channel.comment.enableEditor).sub(function(data) {\n    if (data.pid == \"enable\") {\n        loginState.getLoginState();\n    }\n});\n\nmodule.exports = {\n    init: init,\n    getLoginState: loginState.getLoginState\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/commentv2.js","//识别当前浏览器是否为IE8及以下版本\n//返回值为 boolean true:当前版本为IE8及以下浏览器\nvar identify = function() {\n    var ua = navigator.userAgent.toLowerCase();\n    var version = 8.0;\n    var isIE = ua.indexOf(\"msie\") > -1;\n    if (isIE) {\n        var safariVersion = ua.match(/msie ([\\d.]+)/)[1];\n        if (safariVersion <= version) {\n            return true;\n        } else {\n            return false;\n        }\n    } else {\n        return false;\n    }\n};\nmodule.exports = identify;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/IdentifyIE8-.js","/**评论一级列表**/\nvar changeContent = require('./changeContent'); //评论内容转换\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\nvar face = require('module/popup/face/face');\nvar fromNow = require('utils/fromNow');\nvar commentList = require('./commentList.tpl');\nvar addImageTpl = require('./addImageTpl.tpl');\n//var fixedTopic = require('../fixedTopic');\n\nvar $is_Login = checkLoginStatus() == true ? 1 : 0; // 判断登陆状态\n//var  $LoginSrc = $_CONFIG.passport_domain; //登录注册域名\nvar $mall_domain = $_CONFIG['product_item_gome']; // 商城\nvar $userIsExpert = $_CONFIG['isExpert']; // 当前用户是否为达人\n\nvar $secondCom_Key = $(\"[data-node='secondCom_Key']\");\n\nvar LoadListStr = \"[data-node='loadlist']\";\nvar LoadtingStr = \"[data-node='loading']\";\n//var NoLoadStr = \"[data-node=noload]\";\n\nvar getCommentList = function(id, currPage, pageSize, listSize, nodelist) {\n\n    var $hidDiv = $(\"[id-node='\" + id + \"']\").children(\".topic-lfet\").children(\"[data-node='hidDiv']\");\n\n    var $thisObjId = $(\"[data-circlecom='\" + id + \"']\"); //每个话题的评论容器\n    var $ComTopicId = $thisObjId.parent(\".bjfff\");\n    //var $ComTopicId = $(\"[data-ComTopicId=\"+id+\"]\");\n    var $loadlist = $($ComTopicId.children(LoadListStr));\n    var $loading = $($ComTopicId.children(LoadtingStr));\n    //var $noload = $($ComTopicId.children(NoLoadStr));\n\n    $loadlist.css(\"display\", \"none\");\n    $loading.css(\"display\", \"block\");\n\n    var currUserImg = $(\"[data-tid='\" + id + \"']\").attr(\"data-headface\");\n    var paramList = '?page=' + currPage + '&pagesize=' + pageSize + '&topicid=' + id;\n\n    fetch.get(url.get('commentListUrlV2') + paramList).then(function(data) {\n\n        if (data.success) {\n            //获取所有的一级评论\n            //console.log(data);\n            var topicReplys = data.data.topicReplys;\n            // var windowHeight = parseInt($(window).height());\n            var height = $(\"[data-comtopicid='\" + id + \"']\").offset().top;\n            if (topicReplys.length > 0) {\n\n                //显示 正在加载中\n                $loading.css(\"display\", \"block\");\n                $loadlist.css(\"display\", \"block\").attr(\"data-addMorePages\", currPage).attr(\"data-ListSize\", pageSize);\n\n                for (var i = 0; i < topicReplys.length; i++) {\n\n                    //获取每个评论下的二级评论\n                    var topicMsg = topicReplys[i];\n                    var subReplyQuantity = topicMsg.subReplyQuantity; //二级回复的总数\n                    var subTop = topicMsg.topicSubReplys; //二级回复\n                    var replySecArr = []; //二级评论数组\n\n                    //判断是否显示  查看更多按钮\n                    var showNum = null;\n                    var dlShowBorder = null;\n                    var showMall = null;\n                    if (subReplyQuantity > listSize) {\n                        showMall = true;\n                        dlShowBorder = \"clearfix\";\n                        showNum = listSize;\n                    } else {\n                        showMall = false;\n                        showNum = parseInt(subTop.length);\n                        dlShowBorder = \"clearfix bd-bottom\";\n                    }\n                    var UserId = checkUserId(topicMsg.user.id);\n                    var showReport = ($is_Login == 1) && ($_CONFIG['userId'] != topicMsg.user.id) ? true : false;\n                    var showSecComm = showNum > 0 ? \"\" : \"hide\";\n                    for (var j = 0; j < showNum; j++) {\n                        var subTopMsg = subTop[j];\n                        if (subTopMsg) {\n                            // console.log(subTopMsg.creatorId +\" \" +subTopMsg.user.id);\n                            //判断是二级评论还是三级评论\n                            var replayToPub = null;\n                            var beReplyUserName = \"\";\n                            var beReplyUserId = \"\";\n                            var threeUserId = \"javascript:;\";\n                            if (subTopMsg.topicSubReplyUser) {\n                                // 三级回复\n\n                                replayToPub = true;\n                                beReplyUserName = subTopMsg.topicSubReplyUser.nickname;\n                                beReplyUserId = subTopMsg.topicSubReplyUser.id;\n                                threeUserId = checkUserId(beReplyUserId)\n                            } else {\n                                //二级回复\n                                replayToPub = false;\n                            }\n\n                            var contentSed = subTopMsg.content;\n                            contentSed = changeContent(contentSed);\n                            var SenUserId = \"\";\n                            if (subTopMsg.user) {\n                                SenUserId = checkUserId(subTopMsg.user.id);\n                            }\n                            //var SenUserId =  checkUserId(subTopMsg.user.id);\n\n                            //二级回复中参数\n                            var replySecMsg = {\n                                \"threeUserId\": threeUserId,\n                                \"SenUserId\": SenUserId,\n                                \"parentCommentId\": topicMsg.id, //话题id\n                                // \"topicId\": topicId, //\n                                \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n                                \"content\": contentSed, //回复内容\n                                \"replyUserName\": subTopMsg.user.nickname, //回复人昵称\n                                \"replyUserId\": subTopMsg.user.id, //回复人id\n                                \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n                                \"beReplyUserId\": beReplyUserId, //被回复人的id\n                                \"replyCommentId\": subTopMsg.id // 二级回复内容id\n                            }\n\n                            replySecArr.push(replySecMsg);\n\n                        }\n\n                    }\n\n                    var content = topicMsg.content; //获取一级评论内容\n                    content = changeContent(content);\n                    var topicPic = topicMsg.pics; //一级评论的图片\n                    //var str = \"\";\n                    var imageStr = \"\";\n                    if (topicPic.length > 0) {\n                        var imgsrcPic = {\n                            picsSrc: topicPic,\n                            picture: topicMsg.pictures,\n                            length: topicPic.length\n                        }\n                        imageStr = addImageTpl(imgsrcPic);\n\n                        //addImageTpl\n                        // var imgArr = topicPic;\n                        // var imgArrLen = imgArr.length;\n\n                        // $.each(imgArr, function(index, img) {\n                        //     str += '<li><a href=\"javascript:;\"><img src=\"'+img+'\"></a></li>';\n                        //     //str += \"</br><img     data-original=\" + img + \"  >\";\n                        // })\n                        // imageStr =  '<ul class=\"clearfix comments-imglist\">'+str+'</ul>';\n                    }\n                    //content = content + str;\n                    //商品参数添加\n\n                    var itemsPic = \"\"; //商品图标\n                    var itemShopName = \"\"; //\n                    var itemPrice = \"\";\n                    var shopId = \"\";\n                    var itemShopId = \"\";\n                    var itemShopNameItem = \"\";\n                    var skuId = \"\";\n                    //var rebate = \"\";\n                    //var rebateSummary = \"\";\n                    if (topicMsg.item) {\n\n                        itemsPic = topicMsg.item.mainImage;\n                        itemShopNameItem = topicMsg.item.name;\n                        itemPrice = topicMsg.item.salePrice !== null ? topicMsg.item.salePrice : '暂无售价';\n                        shopId = topicMsg.item.id;\n                        itemShopId = topicMsg.item.id;\n                        skuId = topicMsg.item.skuId;\n                        //rebate = topicMsg.item.rebateSummary.mostRebate;\n                        // rebateSummary = topicMsg.item.rebateSummary; //返利金额\n\n                        /*\n                        \"discount\": 0, // 直降金额\n                        \"id\": 1179,  //商品id\n                        \"mainImage\": \"http://img.gomein.net.cn/image/prodimg/production_image/img/1000083845/1000027654\",\n                        \"name\": \"尤尼克斯（YONEX）SHB-60C羽毛球鞋\",\n                        \"originalPrice\": 18400, //市场价格\n                        \"price\": 18400,\n                        \"salePrice\": 18400, 售价\n                        \"saleQuantity\": 16, 销量\n                        \"shopId\": 3,\n                        \"skuHighestPrice\": 45900,\n                        \"status\": -1,\n                        \"stock\": 50000\n                        */\n                    }\n\n                    //店铺参数\n                    var shopPic = \"\";\n                    var redPackage = \"\";\n                    if (topicMsg.shop) {\n                        shopPic = topicMsg.shop.icon;\n                        itemShopName = topicMsg.shop.name;\n                        if (topicMsg.shop.promotionMark) {\n                            redPackage = topicMsg.shop.promotionMark.hasCouponPlan; //是否有优惠券\n                        }\n                        //redPackage = topicMsg.shop.promotionMark.hasCouponPlan; //是否有优惠券\n                        itemShopId = topicMsg.shop.id;\n                    }\n                    //所有参数集合\n                    var showDateList = {\n                        \"showSecComm\": showSecComm,\n                        \"imageStr\": imageStr,\n                        \"itemShopNameItem\": itemShopNameItem,\n                        \"UserId\": UserId,\n                        \"dlShowBorder\": dlShowBorder,\n                        \"showMall\": showMall,\n                        \"userIsExpert\": $userIsExpert, //当前用户是否是达人\n                        \"isExpert\": topicMsg.expertInfo.isExpert, //是否是达人\n                        \"userPic\": topicMsg.user.facePicUrl, //用户头像\n                        \"username\": topicMsg.user.nickname, //用户昵称\n                        \"backTopicId\": topicMsg.id, //本条评论id\n                        \"content\": face.parseEmoji(content), //过滤之后的内容\n                        \"topicType\": topicMsg.replyType, // 评论类型\n                        \"topicId\": topicMsg.topicId, // 话题id\n                        \"currUserImg\": currUserImg, // 当前用户的头像，在二级评论框中显示\n                        \"times\": fromNow(timeString(topicMsg.createTime)), //评论时间\n                        \"isFirstCom\": false, // 是否是一级评论  --  判断是否显示二级评论\n                        \"secondReply\": replySecArr, // 二级评论数组\n                        //商品参数\n                        \"mall_domain\": $mall_domain,\n                        \"itemsPic\": itemsPic,\n                        \"itemShopName\": itemShopName,\n                        \"itemPrice\": itemPrice,\n                        \"shopId\": shopId,\n                        \"itemShopId\": itemShopId,\n                        \"skuId\":skuId ? \"-\" + skuId : \"\",\n                        // 店铺参数\n                        \"redPackage\": redPackage,\n                        \"shopPic\": shopPic,\n                        //举报\n                        \"showReport\": showReport,\n                        //\"rebate\": rebate,\n                        \"kid\": topicMsg.kid\n                    }\n\n                    var item = commentList(showDateList);\n                    //$circleCom.append($(item));\n                    $thisObjId.append($(item));\n                    $loading.css(\"display\", \"none\");\n                    $loadlist.css(\"display\", \"block\");\n\n                    $(\"img\").lazyload({\n                        effect: \"fadeIn\"\n                    });\n\n                    //没有登录时不显示 “回复”\n                    if ($is_Login == \"0\") {\n                        $secondCom_Key.css(\"display\", \"none\");\n                    }\n                    if (topicReplys.length < pageSize) {\n                        $loadlist.css(\"display\", \"none\");\n                    }\n\n                }\n                //fixedTopic.init();\n                if (nodelist) {\n\n                    //console.log(id);\n                    // var height = $(\"[data-comtopicid=\"+id+\"]\").height() - windowHeight;\n                    //console.log(height);\n                    $(window).scrollTop(height);\n                }\n            } else {\n                $loading.css(\"display\", \"none\");\n                if (pageSize == 1) {\n                    $hidDiv.css(\"display\", \"none\");\n                }\n            }\n        } else {\n            $loadlist.css(\"display\", \"none\");\n            // $noload.css(\"display\", \"block\");\n            $loading.css(\"display\", \"none\");\n        }\n\n    });\n\n}\n\nfunction checkUserId(id) {\n\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n\n}\n\nfunction timeString(str) {\n    var date = new Date(str);\n    var fullYear = date.getFullYear();\n    var month = (date.getMonth() + 1);\n    var day = date.getDate();\n    var hh = date.getHours();\n    var mm = date.getMinutes();\n    var ss = date.getSeconds();\n\n    function addZero(num) {\n\n        var newNum = \"\";\n        if (parseInt(num) < 10) {\n            newNum = \"0\" + num;\n        } else {\n            newNum = num;\n        }\n        return newNum;\n    }\n\n    return fullYear + \"-\" + addZero(month) + \"-\" + addZero(day) + \" \" + addZero(hh) + \":\" + addZero(mm) + \":\" + addZero(ss);\n\n}\n\nmodule.exports = getCommentList;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/getCommentList.js","\n\n//话题评论内容转换\n\nvar encodeHtml = require('utils/encodeHtml');\nvar face = require('module/popup/face/face');\n\n\nfunction htmlNull(str) {\n    var re = str.replace(/\\n|\\r\\n/g, \"</br>\");\n    return re; //去掉所有的html标记\n}\n\nvar changeContent = function(content){\n\tcontent = encodeHtml(content);\n    content = face.parseEmoji(content);\n    content = htmlNull(content);\n    return content;\n}\n\nmodule.exports = changeContent;\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/changeContent.js","// 传入的时间格式  2016-04-27 15:12:58\nvar fromNow = function(timeStr,max) {\n    /**\n      1）1个小时以内发表的消息，显示发表的分钟数，如“20分钟前”；\n      2）在24小时以内，发表的信息，显示具体小时数，如“15小时前”；\n      3）大于24小时小于48小时，发表的消息，显示昨天；\n      4）大于48小时小于72小时，发表的消息，显示2天前；大于72小时小于96小时，发表的消息，显示3天前；依此类推，最多到7天前\n      5）超过7天前，显示具体年/月/日\n    **/\n\n    var showTime = \"\";\n    var time = new Date(timeStr).getTime();\n    var date = new Date().getTime();\n    var num = date - time;\n    var maxDay = max||7;\n    var oneMin = 60000,\n        oneHour = 3600000,\n        oneDay = 24 * 3600000;\n    var s;\n    if (num < oneMin) {\n        showTime = '1分钟前';\n        //console.log(showTime);\n    } else if (num >= oneMin & num < oneHour) {\n        s = Math.floor(num / oneMin);\n        showTime = s + \"分钟前\";\n        //console.log(showTime);\n    } else if (num >= oneHour & num < oneDay) {\n        s = Math.floor(num / oneHour);\n        showTime = s + \"小时前\";\n        //console.log(showTime);\n    } else if (num >= oneDay & num < 2 * oneDay) {\n        s = Math.floor(num / oneDay);\n        showTime = \"昨天\";\n        //console.log(showTime);\n    } else if (num >= 2 * oneDay & num < maxDay * oneDay) {\n        s = Math.floor(num / oneDay);\n        showTime = s + \"天前\";\n        //console.log(showTime);\n    } else {\n        var getd = timeStr.split(' ');\n        showTime = getd[0];\n    }\n    return showTime;\n}\nmodule.exports = fromNow;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/fromNow.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/commentList',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,dlShowBorder=$data.dlShowBorder,userSubmit=$data.userSubmit,UserId=$data.UserId,isExpert=$data.isExpert,userPic=$data.userPic,backTopicId=$data.backTopicId,topicType=$data.topicType,topicId=$data.topicId,showReport=$data.showReport,username=$data.username,times=$data.times,$string=$utils.$string,content=$data.content,itemsPic=$data.itemsPic,itemShopNameItem=$data.itemShopNameItem,itemPrice=$data.itemPrice,rebate=$data.rebate,mall_domain=$data.mall_domain,shopId=$data.shopId,skuId=$data.skuId,kid=$data.kid,itemShopId=$data.itemShopId,imageStr=$data.imageStr,showSecComm=$data.showSecComm,isFirstCom=$data.isFirstCom,$each=$utils.$each,secondReply=$data.secondReply,value=$data.value,i=$data.i,imId=$data.imId,showMall=$data.showMall,groupId=$data.groupId,replyCommentNum=$data.replyCommentNum,currentPage=$data.currentPage,pageSize=$data.pageSize,userIsExpert=$data.userIsExpert,currUserImg=$data.currUserImg,$out='';$out+=' <dl class=\"';\n$out+=$escape(dlShowBorder);\n$out+=' \" ';\nif(userSubmit){\n$out+=' data-node=\"userSubmit\"';\n}\n$out+='> <dt> <a href=\"';\n$out+=$escape(UserId);\n$out+='\" target=\"_blank\"> ';\nif(isExpert){\n$out+=' <em class=\"icon-daren\"></em>';\n}\n$out+=' <img src=\"';\n$out+=$escape(userPic);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"> </a> </dt> <dd data-ddList=\"';\n$out+=$escape(backTopicId);\n$out+='\"> <div class=\"circle-comments-title\" data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+='> <p class=\"comments-replay\" data-node=\"comReplay\"> ';\nif(showReport){\n$out+=' <a href=\"javascript:;\" class=\"replay-report\" data-action=\"topic-report\" data-type=\"1\">举报</a> <span class=\"line\"></span> ';\n}\n$out+=' <a href=\"javascript:;\" data-node=\"secondCom_Key\" data-comId=\"';\n$out+=$escape(backTopicId);\n$out+='\" data-replayUser=';\n$out+=$escape(username);\n$out+=' data-publish=\"1\">回复</a> </p> <a href=\"';\n$out+=$escape(UserId);\n$out+='\" target=\"_blank\">';\n$out+=$escape(username);\n$out+='</a> <span>';\n$out+=$escape(times);\n$out+='</span> </div> <div class=\"first-comment\"> <p class=\"clearfix\">';\n$out+=$string(content);\n$out+='</p> ';\nif(topicType==\"1\"){\n$out+=' <div class=\"reply-details merchant\"> <div class=\"reply-picture\"> <img src=\"';\n$out+=$escape(itemsPic);\n$out+='\" onerror=\"imgError(this)\"> </div> <div class=\"reply-contxt\"> <p>';\n$out+=$escape(itemShopNameItem);\n$out+='</p> <div class=\"price\"> <p class=\"price-numb\">￥<span>';\n$out+=$escape(itemPrice);\n$out+='</span></p> <!-- ';\nif(rebate > 0){\n$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n$out+=$escape(rebate);\n$out+='国美币</span> </div> ';\n}\n$out+=' --> </div> </div> <a href=\"';\n$out+=$escape(mall_domain);\n$out+=$escape(shopId);\n$out+=$escape(skuId);\n$out+='.html';\nif(kid){\n$out+='?kid=';\n$out+=$escape(kid);\n}\n$out+='\" target=\"_blank\" class=\"see-details pc-btn pc-btnw105 pc-btnh40\" data-shopId=';\n$out+=$escape(shopId);\n$out+=' data-itemShopId=';\n$out+=$escape(itemShopId);\n$out+=' data-node=\"checkDetailMsg\">查看详情</a> </div> ';\n}\n$out+=' ';\n$out+=$string(imageStr);\n$out+=' </div> <div class=\"comments-box ';\n$out+=$escape(showSecComm);\n$out+='\"> ';\nif(!isFirstCom){\n$out+=' ';\n$each(secondReply,function(value,i){\n$out+=' <div class=\"comments-s\" data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+='> <a href=\"';\n$out+=$escape(value.SenUserId);\n$out+='\" target=\"_blank\" data-replyUserId=';\n$out+=$escape(value.replyUserId);\n$out+='>';\n$out+=$escape(value.replyUserName);\n$out+='</a> ';\nif(value.replayToPub){\n$out+=' ：<span>回复</span> ';\n}\n$out+=' <a href=\"';\n$out+=$escape(value.threeUserId);\n$out+='\" target=\"_blank\" data-replyCommentId =';\n$out+=$escape(value.replyCommentId);\n$out+='>';\n$out+=$escape(value.beReplyUserName);\n$out+=':</a> <span data-replyCommentId=';\n$out+=$escape(value.replyCommentId);\n$out+='>';\n$out+=$string(value.content);\n$out+='</span> <a href=\"javascript:;\" class=\"hf-btn fr\" data-getTopicId=';\n$out+=$escape(backTopicId);\n$out+=' data-node=\"secondCom_Key\" data-replayUser=';\n$out+=$escape(value.replyUserName);\n$out+=' data-publish=\"0\" data-comId=\"';\n$out+=$escape(value.parentCommentId);\n$out+='\" data-replyCommentId =';\n$out+=$escape(value.replyCommentId);\n$out+=' data-replyUserId=';\n$out+=$escape(value.replyUserId);\n$out+=' data-imId=';\n$out+=$escape(imId);\n$out+='>回复</a> </div> ';\n});\n$out+=' ';\n}\n$out+=' </div> </dd> </dl> ';\nif(!isFirstCom){\n$out+=' ';\nif(showMall){\n$out+=' <a href=\"javascript:;\" class=\"comments-more\" data-node=\"showMoreList\" data-groupId=';\n$out+=$escape(groupId);\n$out+=' data-imId=';\n$out+=$escape(imId);\n$out+=' data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+=' data-tootlePages=';\n$out+=$escape(replyCommentNum);\n$out+=' data-currentPage= ';\n$out+=$escape(currentPage);\n$out+=' data-pageSize=';\n$out+=$escape(pageSize);\n$out+='>查看回复...</a> ';\n}\n$out+=' ';\n}\n$out+=' <a class=\"pack-up\" style=\"display: none\" data-node=\"hideComBox\" data-parentTopicIdBtn=';\n$out+=$escape(backTopicId);\n$out+='>收起</a> <div class=\"text-field-box clearfix secondText margin-width\" style=\"display: none\" data-parentTopicId=';\n$out+=$escape(backTopicId);\n$out+='> <div class=\"topic-user-head\"> ';\nif(userIsExpert){\n$out+=' <em class=\"icon-daren\"></em>';\n}\n$out+=' <img src=\"';\n$out+=$escape(currUserImg);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"> </div> <div class=\"topic-publish-content\"> <textarea placeholder=\"说点什么吧…\" class=\"textarea-bx secondT\"></textarea> <label class=\"textarea-tips hide\" data-node=\"textareaTips\"></label> <div class=\"publish-face-bx\"> <p class=\"icon-face\" data-node=\"smilies_Face\"><em class=\"icon-emoji\"></em> 表情</p> <a href=\"javascript:;\" class=\"pc-btn pc-btnh30 pc-btnw105\" data-node=\"a_secondComBtn\" data-getTopicId=';\n$out+=$escape(backTopicId);\n$out+='>发布</a> </div> </div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/commentList.tpl\n// module id = 249\n// module chunks = 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/addImageTpl',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,picsSrc=$data.picsSrc,value=$data.value,i=$data.i,$escape=$utils.$escape,length=$data.length,picture=$data.picture,$out='';$out+=' <div class=\"comments-imglist\" > <ul class=\"clearfix comments-imglist\" > ';\n$each(picsSrc,function(value,i){\n$out+=' <li data-imgSort=';\n$out+=$escape(i);\n$out+=' data-node=\"imgPics\"><a href=\"javascript:;\"><img src=\"';\n$out+=$escape(value);\n$out+='\"></a></li> ';\n});\n$out+=' </ul> <div class=\"imglist-big hide\" data-node=\"imgBigPic\"> <div class=\"big-title\"> <a href=\"javascript:;\" data-node=\"imgBigHind\"><em class=\"icon-up\"></em>收起</a> <a href=\"javascript:;\" data-node=\"imgBigSrc\" target=\"_blank\"><em class=\"icon-view-img\"></em>查看原图</a> </div> <div class=\"big-img\" data-picLength=\"';\n$out+=$escape(length);\n$out+='\"> <div class=\"img-hidden\"> ';\n$each(picture,function(value,i){\n$out+=' <div class=\"img-box\" data-bigImg=';\n$out+=$escape(i);\n$out+=' data-node=\"hideBigPic\"><img class=\"srcError\" data-imgsrc = \"';\n$out+=$escape(value.url);\n$out+='\"></div> ';\n});\n$out+=' </div> <em class=\"icon-left\" data-node=\"imgBigPN\" data-page=\"pre\"></em> <em class=\"icon-right\" data-node=\"imgBigPN\" data-page=\"next\"></em> </div> <div class=\"img-slide\"> ';\n$each(picture,function(value,i){\n$out+=' <a href=\"javascript:;\" data-node=\"showImg\" data-active=\"';\n$out+=$escape(i);\n$out+='\" ></a> ';\n});\n$out+=' </div> </div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/addImageTpl.tpl\n// module id = 250\n// module chunks = 30","/*\n\t一级评论\n*/\nvar $is_Login = 1;\nvar alert = require('module/popup/alert');\nvar hint = require('module/hint.js');\n//var fixedTopic = require('../fixedTopic');\nvar commentList = require('./commentList.tpl');\nvar changeContent = require('./changeContent'); //评论内容转换\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar loginState = require('./loginState');\nvar face = require('module/popup/face/face');\nvar fromNow = require('utils/fromNow');\n//var addImg = require('./addImgGoods/addIMG');\nvar addImageTpl = require('./addImageTpl.tpl');\n\n// 敏感词过滤\nvar sensitiveContent = require('module/sensitiveContent');\n\nvar $comment_Msg = $(\"[data-node='comment_Msg']\");\nvar $userIsExpert = $_CONFIG['isExpert'];\n//var $circleCom = $(\"[data-node=circleCom]\");\n\nvar $mall_domain = $_CONFIG[\"product_item_gome\"]; // 商城\n\nvar a_Submit = function() {\n\n    // 判断是否登陆，没登录，显示登录框\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var currUserImg = $comment_Msg.attr(\"data-headface\"); //头像\n    var parentDiv = $(this).parents().eq(1);\n    var comment_Msg = parentDiv.children(\"textarea\").val();\n    comment_Msg = comment_Msg.trim(); //对输入空格进行过滤\n    if (comment_Msg) {\n        if (sensitiveContent(comment_Msg,true)) {\n            return false;\n        }\n    }\n\n    //var data_userid = parentDiv.attr(\"data-userid\");\n    var topicid = parentDiv.attr(\"data-tid\");\n\n    //var imgPics = parentDiv.find(\"[data-node=imgUl]\").attr(\"data-imgsrt\");\n    var lis = parentDiv.find(\"[data-node='imgUl']\").children(\"li\");\n    var imgPics = [];\n\n    for (var i = 0; i < lis.length; i++) {\n        //console.log(lis[i]);\n        var imgObj = $(lis[i]).find(\"img\").attr(\"src\");\n        if (imgObj) {\n            imgPics.push(imgObj);\n        }\n    }\n\n    var $addImgGoods = parentDiv.find(\"[data-node='addImgGoods']\");\n\n    //var shopid = $(\"[data-node=goodsDiv]\").attr(\"data-shopId\");\n\n    if (comment_Msg || imgPics.length || $addImgGoods.hasClass(\"hasGoods\")) {\n        //var imId = \"b_\" + data_userid;\n        //var businessid = 0;\n        var topicType = null;\n        var shopId = \"\";\n        var itemid = \"\";\n        var skuId = \"\";\n        if ($addImgGoods.hasClass(\"hasGoods\")) {\n            var $goodIn = $addImgGoods.find(\"[data-node='goodsIn']\");\n            shopId = $goodIn.attr(\"data-shopId\");\n            itemid = $goodIn.attr(\"data-itemId\");\n            skuId = $goodIn.attr(\"data-skuId\");\n            topicType = 1;\n        } else {\n            topicType = 0;\n        }\n        var params = {\n            \"reply_type\": topicType, //回复的类型\n            \"topicid\": topicid, //话题id\n            \"content\": comment_Msg, //话题回复内容\n            \"pics\": imgPics, //话题回复图片\n            \"shopid\": shopId, //如果topicType = 1 或者 =2 那么这个字段必填\n            \"itemid\": itemid //如果topicType = 1 那么这个字段必填\n        }\n        if(skuId){\n            params.skuid = skuId;\n        }\n\n        //提交请求\n        fetch.post(url.get('commentFirstV2'), {\n            data: params\n        }).then(function(data) {\n            if (data.success) {\n                var Msg = data.data;\n                var contentMsg = Msg.content;\n                contentMsg = changeContent(contentMsg);\n                parentDiv.children(\"textarea\").val(\"\");\n\n                var imageStr = null;\n\n                if (Msg.pics.length > 0) {\n                    var imgsrcPic = {\n                        \"picsSrc\": Msg.pics,\n                        \"picture\": Msg.pictures,\n                        \"length\": Msg.pics.length\n                    }\n                    imageStr = addImageTpl(imgsrcPic);\n                    //console.log(Msg.pics);\n                }\n                var mall_domain = \"\",\n                    itemsPic = \"\",\n                    itemShopName = \"\",\n                    itemPrice = \"\",\n                    shopId = \"\",\n                    itemShopId = \"\",\n                    skuId = \"\";\n                    //rebate= \"\";\n                if (Msg.item) {\n                    // var goodStr = $(\"[data-node=addImgGoods]\").attr(\"data-goodStr\");\n                    var goodObj = Msg.item;\n                    mall_domain = $mall_domain;\n                    itemsPic = goodObj.mainImage;\n                    itemShopName = goodObj.name;\n                    itemPrice = goodObj.salePrice !== null ? goodObj.salePrice : '暂无售价';\n                    shopId = goodObj.id;\n                    itemShopId = Msg.id;\n                    skuId = Msg.skuId ? \"-\" + Msg.skuId : \"\";\n                    //rebate = goodObj.rebateSummary.mostRebate;\n                }\n\n                //time = timeString(Msg.createTime);\n                var UserId = checkUserId(data.data.user.id);\n                var showReport = ($is_Login == 1) && ($_CONFIG['userId'] != data.data.user.id) ? true : false;\n                var basics = {\n                    \"showSecComm\": \"hide\",\n                    \"mall_domain\": mall_domain,\n                    \"itemsPic\": itemsPic,\n                    \"itemShopNameItem\": itemShopName,\n                    \"itemPrice\": itemPrice,\n                    \"shopId\": shopId,\n                    \"itemShopId\": itemShopId,\n                    \"skuId\":skuId,\n                    \"imageStr\": imageStr,\n                    \"UserId\": UserId,\n                    \"dlShowBorder\": \"clearfix bd-bottom\",\n                    \"userIsExpert\": $userIsExpert, //当前用户是否是达人\n                    \"isExpert\": Msg.expertInfo.isExpert, //是否是达人\n                    \"userPic\": Msg.user.facePicUrl, //用户头像\n                    \"username\": Msg.user.nickname, //用户昵称\n                    \"backTopicId\": Msg.id, //本条评论id\n                    \"content\": face.parseEmoji(contentMsg), //过滤之后的内容\n                    \"topicType\": topicType, // 评论类型\n                    \"topicId\": Msg.topicId, // 话题id\n                    \"currUserImg\": currUserImg, // 当前用户的头像，在二级评论框中显示\n                    \"times\": fromNow(timeString(Msg.createTime)), //评论时间\n                    \"isFirstCom\": true, // 是否是一级评论  --  判断是否显示二级评论\n                    \"userSubmit\": true,   //是否用户自己发布的评论\n                    \"showReport\": showReport,  //是否显示举报\n                    //\"rebate\": rebate, //是否显示返利\n                    \"kid\": Msg.kid\n                }\n                //$(\"[data-node=noload]\").css(\"display\", \"none\");\n                $(\"[data-node='hidDiv']\").css(\"display\", \"block\");\n\n                var item = commentList(basics);\n                //$circleCom.append($(item));\n\n                $(\"[data-circlecom='\" + topicid + \"']\").append($(item));\n                //console.log($(\"[data-circlecom=\"+topicid+\"]\").attr(\"class\"));\n                //var newDL = $(\"[data-ddlist=\" + basics.backTopicId + \"]\");\n\n                // 商品选择列表清空\n                // 图片列表清空\n                $(\"[data-tid='\" + topicid + \"']\").children('[data-node=\"addImgGoods\"]').attr(\"data-imgnum\", 9)\n                    .attr(\"data-goodstr\", \"\")\n                    .removeClass(\"hasGoods\");\n                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='imgUl']\")\n                    .attr(\"data-imgsrt\", \"\").addClass(\"hide\").children(\".imgClass\").remove();\n                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='addGoods_btn']\").removeClass(\"disabled\");\n                $(\"[data-tid='\" + topicid + \"']\").find(\"[data-node='addImg_btn']\").removeClass(\"disabled\");\n                $(\"[data-node='goodsIn']\").remove();\n\n                var idNode = $(\"[id-node='\" + topicid + \"']\");\n                $(\"body,html\").animate({ //？？？？？有问题\n                    scrollTop: parseInt(idNode.height() + idNode.offset().top - $(window).height() / 2)\n\n                });\n                hint.init(\"评论成功\");\n\n            } else {\n\n                if (data.code === 881001) {\n                    alert(\"评论内容不能超过200个汉字\");\n                } else if (data.code === 404 || data.code === 410) {\n                    alert(\"抱歉，该话题已被删除\", {\n                        ok: function() {\n                            window.location.href = \"/index/get_error?code=topic_404\";\n                        }\n                    });\n                } else if (data.code === 422) {\n                    alert(\"抱歉，服务器君正在打盹\", {\n                        ok: function() {\n                            window.location.href = \"/index/get_error?code=500\";\n                        }\n                    });\n                } else if (data.code === 403) {\n                    alert(\"抱歉，该话题审核不通过！\", {\n                        ok: function() {\n                            window.location.href = \"/index/get_error?code=topic\";\n                        }\n                    });\n                } else {\n                    alert(data.message);\n                }\n\n            }\n        });\n    } else {\n        alert(\"请输入评论内容！\");\n    }\n\n}\n\nfunction checkUserId(id) {\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\n\nfunction timeString(str) {\n    var date = new Date(str);\n    var fullYear = date.getFullYear();\n    var month = (date.getMonth() + 1);\n    var day = date.getDate();\n    var hh = date.getHours();\n    var mm = date.getMinutes();\n    var ss = date.getSeconds();\n\n    function addZero(num) {\n\n        var newNum = \"\";\n        if (parseInt(num) < 10) {\n            newNum = \"0\" + num;\n        } else {\n            newNum = num;\n        }\n        return newNum;\n    }\n\n    return fullYear + \"-\" + addZero(month) + \"-\" + addZero(day) + \" \" + addZero(hh) + \":\" + addZero(mm) + \":\" + addZero(ss);\n\n}\n\nmodule.exports = a_Submit;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/a_submit.js","// 判断登陆状态\nvar checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\nvar $comment_Msg = $(\"[data-node='comment_Msg']\");\nvar $a_Submit = $(\"[data-node='a_Submit']\");\n\n\n\n//var getCommentList = require('./getCommentList'); //\nvar loginPop = require('module/popup/login'); //登录弹窗\n//var checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\n\n//var $is_Login = checkLoginStatus() == true ? 1 : 0;\n\n\nvar getLoginState = function() {\n    var ISLOGIN = null;\n    if (!checkLoginStatus()) { //必须重新判断 别的无刷新事件修改了登录状态\n        //没有登录\n        ISLOGIN = \"0\";\n        $comment_Msg.children(\"textarea\").attr(\"readonly\", \"readonly\").css(\"background\", \"#fff\");\n        $(\"[data-node='secondCom_Key']\").css(\"display\", \"none\");\n    } else {\n        $comment_Msg.children(\"textarea\")\n            .removeAttr(\"readonly\").css(\"background\", \"transparent\");\n\n        $a_Submit.removeClass(\"pc-bj-fc8753\").html(\"发布\");\n\n        $(\"[data-node='secondCom_Key']\").css(\"display\", \"block\");\n        //添加事件\n        ISLOGIN = \"1\";\n    }\n    return ISLOGIN;\n}\n\n// var loginCallback = function() {\n//     $is_Login = 1;\n//     getLoginState();\n//     $(\".topic-publish-content\").children(\"textarea\").removeAttr(\"readonly\").css(\"background\", \"transparent\");\n//     $(\".publish-face-bx\").children(\"a\").removeClass(\"pc-bj-fc8753\").html(\"发布\");\n//     //$(\"[data-node=circleCom]\").empty();\n//     //getCommentList(1, 10, 2);\n// }\n\nvar popUnion = function() {\n    loginPop();\n}\n\nvar commentCheck = function() {\n    if (!checkLoginStatus()) {\n        popUnion();\n        return false;\n    }\n}\n\nmodule.exports = {\n    getLoginState : getLoginState,\n    popUnion : popUnion,\n    commentCheck :commentCheck\n};\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/loginState.js","var identify = require('utils/IdentifyIE8-');\n\n//二级话题回复\nvar getCommentList = require('./getCommentList');\nvar $is_Login = 1;\nvar alert = require('module/popup/alert');\n//var hint = require('module/hint.js');\n//var commentList = require('./commentList.tpl');\nvar changeContent = require('./changeContent'); //评论内容转换\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar loginState = require('./loginState');\n//var face = require('module/popup/face/face');\n//var fromNow = require('utils/fromNow');\nvar secondComList = require('./secondComList.tpl');\n\n// 敏感词过滤\nvar sensitiveContent = require('module/sensitiveContent');\n\n//var $comment_Msg = $(\"[data-node=comment_Msg]\");\n\nvar a_secondComBtn = function() {\n\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var replayToPub = $(this).parents().eq(2).attr(\"data-ispublish\"); //\n    var beReplyId = \"\";\n    //var replayImid = \"\";\n\n    if (replayToPub == \"1\") {\n        replayToPub = false;\n    } else {\n        replayToPub = true;\n        beReplyId = $(this).parents().eq(2).attr(\"data-replycommentid\");\n        // var replayImid = \"b_\" + $(this).parents().eq(2).attr(\"data-replyuserid\");\n    }\n    //var replyUserName = $comment_Msg.attr(\"data-nickname\");\n    //var beReplyUserName = $(this).parents().eq(2).attr(\"data-replayto\");\n    var tId = $(this).attr(\"data-gettopicid\");\n    //var groupId = $(\"[data-htid=\" + tId + \"]\").attr(\"data-groupid\");\n\n    //var topicType = $(\"[data-htid=\" + tId + \"]\").attr(\"data-topictype\");;\n    var topicId = $(\"[data-htid='\" + tId + \"']\").attr(\"data-tid\");\n    var content = $(this).parents().eq(1).children(\"textarea\").val();\n    content = content.trim();\n    // var contentLong = \"\";\n\n    // if (content.length > 200) {\n    //     contentLong = true;\n    // } else {\n    //     contentLong = false;\n    // }\n    //var imId = \"b_\" + $comment_Msg.attr(\"data-userid\");\n    // var id = $(this).parents().eq(2).attr(\"data-replycommentid\");\n    var replyId = tId;\n\n    var params = {\n        \"topic_reply_id\": replyId,\n        \"topicid\": topicId,\n        \"content\": content,\n        \"topic_subreply_id\": beReplyId\n    }\n    if (content) {\n        if (sensitiveContent(content,true)) {\n            return false;\n        }\n        fetch.post(url.get('secondtopicV2'), {\n            data: params\n        }).then(function(data) {\n            if (data.success) {\n\n                var contentT = data.data.content;\n                contentT = changeContent(contentT);\n                //判断是二级回复还是三级回复\n                var beReplyUserName = \"\";\n                var beReplyUserId = \"\";\n\n                var SenUserId = checkUserId(data.data.user.id);\n                var threeUserId = \"javascript:;\"\n\n                if (replayToPub) {\n                    beReplyUserName = data.data.topicSubReplyUser.nickname;\n                    beReplyUserId = data.data.topicSubReplyUser.id;\n                    threeUserId = checkUserId(beReplyUserId);\n                }\n                var showCom = {\n                    \"SenUserId\": SenUserId,\n                    \"threeUserId\": threeUserId,\n                    \"topicType\": 0,\n                    \"backTopicId\": tId,\n                    \"parentCommentId\": tId, //话题id\n                    \"topicId\": data.data.topicId,\n                    \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n                    \"content\": contentT, //回复内容\n                    \"replyUserName\": data.data.user.nickname, //回复人昵称\n                    \"replyUserId\": data.data.user.id, //回复人id\n                    \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n                    \"beReplyUserId\": beReplyUserId, //被回复人的id\n                    \"replyCommentId\": data.data.id // 二级回复内容id\n                }\n\n                var item = secondComList(showCom);\n                $(\"[data-ddlist='\" + tId + \"']\").find(\".comments-box\").removeClass(\"hide\").append(item);\n                $(\"[data-parentTopicIdBtn='\" + tId + \"']\").css(\"display\", \"none\");\n                $(\"[data-parentTopicId='\" + tId + \"']\").css(\"display\", \"none\");\n                $(\"[data-parentTopicId='\" + tId + \"']\").removeAttr(\"data-replayto\");\n                $(\".textarea-bx\", \"[data-parentTopicId='\" + tId + \"']\").val(\"\");\n\n            } else {\n                if (data.code === 500 || data.message === \"请求参数为空\") {\n                    alert(data.message);\n                } else {\n                    // console.log(data.code);\n                    if (data.code === 403) {\n                        data.message = \"抱歉，该回复审核不通过！\";\n                    }\n                    alert(data.message, {\n                        ok: function() {\n                            $(\"[data-node=circleCom]\").empty();\n                            getCommentList(topicId, 1, 10, 2);\n                        }\n                    });\n                }\n\n            }\n        });\n    } else {\n        alert(\"请输入评论内容！\");\n    }\n};\n\n//点击回复按钮，显示二级输入框\nvar secondCom_Key = function() {\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var replyuserid = $(this).attr(\"data-replyuserid\");\n    //var replyimId = $(this).attr(\"data-imId\");\n\n    var replycommentid = $(this).attr(\"data-replycommentid\");\n    var topicid = $(this).attr(\"data-comid\");\n    var username = $(this).attr(\"data-replayUser\");\n    var dataPublis = $(this).attr(\"data-publish\");\n    var isHide = $(\"[data-parenttopicid='\" + topicid + \"']\").css(\"display\");\n    var dataObj = $(\"[data-parentTopicId='\" + topicid + \"']\");\n\n    dataObj.removeAttr(\"data-replyuserid\");\n    //dataObj.removeAttr(\"data-imId\");\n    dataObj.removeAttr(\"data-replayTo\");\n    dataObj.removeAttr(\"data-replycommentid\");\n    dataObj.removeAttr(\"data-isPublish\");\n    //dataObj.attr(\"data-imId\",replyimId);\n    dataObj.attr(\"data-replyuserid\", replyuserid);\n    dataObj.attr(\"data-replayTo\", username);\n    dataObj.attr(\"data-isPublish\", dataPublis);\n    dataObj.attr(\"data-replycommentid\", replycommentid);\n    dataObj.children(\".topic-publish-content\").children(\"textarea\").attr(\"placeholder\", \"回复: \" + username);\n    if (identify()) {\n        dataObj.children(\".topic-publish-content\").children(\"label\").html(\"回复: \" + username);\n    }\n    if (isHide == \"none\") {\n        $(\".secondText\").css(\"display\", \"none\");\n        $(\".pack-up\").css(\"display\", \"none\");\n        dataObj.css(\"display\", \"block\");\n        $(\"[data-parentTopicIdBtn='\" + topicid + \"']\").css(\"display\", \"block\");\n\n        var a = $(window).scrollTop() + $(window).height();\n        var b = dataObj.offset().top;\n        if (a + 60 < b) {\n\n            $('html,body').animate({\n                'scrollTop': dataObj.offset().top - $(window).height() + 185\n            }, 200);\n        }\n\n        dataObj.children(\".topic-publish-content\").children(\"textarea\").focus();\n        if (identify()) {\n            dataObj.children(\".topic-publish-content\").children(\"label\").removeClass('hide');\n        }\n\n    }\n}\n\n//隐藏二级输入框\nvar hideComBox = function() {\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n    var hideId = $(this).attr(\"data-parentTopicIdBtn\");\n    $(\"[data-parentTopicId='\" + hideId + \"']\").css(\"display\", \"none\");\n    $(\"[data-parentTopicId='\" + hideId + \"']\").children(\"textarea\").attr(\"placeholder\", \"说点什么吧\");\n    $(\"[data-parentTopicIdBtn='\" + hideId + \"']\").css(\"display\", \"none\");\n    $(\"[data-parentTopicId='\" + hideId + \"']\").removeAttr(\"data-isPublish\").removeAttr(\"data-replayTo\");\n    $(\".textarea-bx\", \"[data-parentTopicId='\" + hideId + \"']\").val(\"\");\n}\n\nfunction checkUserId(id) {\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\nmodule.exports = {\n    a_secondComBtn: a_secondComBtn,\n    secondCom_Key: secondCom_Key,\n    hideComBox: hideComBox\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/a_secondComBtn.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/secondComList',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,topicType=$data.topicType,backTopicId=$data.backTopicId,topicId=$data.topicId,SenUserId=$data.SenUserId,replyUserId=$data.replyUserId,replyUserName=$data.replyUserName,replayToPub=$data.replayToPub,threeUserId=$data.threeUserId,replyCommentId=$data.replyCommentId,beReplyUserName=$data.beReplyUserName,$string=$utils.$string,content=$data.content,parentCommentId=$data.parentCommentId,imId=$data.imId,$out='';$out+='<div class=\"comments-s\" data-topicType=';\n$out+=$escape(topicType);\n$out+=' data-htId=';\n$out+=$escape(backTopicId);\n$out+=' data-tid=';\n$out+=$escape(topicId);\n$out+='> <a href=\"';\n$out+=$escape(SenUserId);\n$out+='\" target=\"_blank\" data-replyUserId=\"';\n$out+=$escape(replyUserId);\n$out+='\">';\n$out+=$escape(replyUserName);\n$out+='</a> ';\nif(replayToPub){\n$out+=' ：<span>回复</span> <a href=\"';\n$out+=$escape(threeUserId);\n$out+='\" target=\"_blank\" data-replyCommentId =\"';\n$out+=$escape(replyCommentId);\n$out+='\">';\n$out+=$escape(beReplyUserName);\n$out+='</a> ';\n}\n$out+=' <span data-replyCommentId=';\n$out+=$escape(replyCommentId);\n$out+='>：';\n$out+=$string(content);\n$out+='</span> <a href=\"javascript:;\" class=\"fr\" data-node=\"secondCom_Key\" data-getTopicId=';\n$out+=$escape(backTopicId);\n$out+=' data-replayUser=';\n$out+=$escape(replyUserName);\n$out+=' data-publish=\"0\" data-comId=\"';\n$out+=$escape(parentCommentId);\n$out+='\" data-replyCommentId=\"';\n$out+=$escape(replyCommentId);\n$out+='\" data-imId=\"';\n$out+=$escape(imId);\n$out+='\" data-replyUserId=';\n$out+=$escape(replyUserId);\n$out+=' >回复</a> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/secondComList.tpl\n// module id = 254\n// module chunks = 30","//二级列表\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar changeContent = require('./changeContent'); //评论内容转换\nvar secondComList = require('./secondComList.tpl');\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\n\nvar $is_Login = checkLoginStatus() == true ? 1 : 0; // 判断登陆状态\n\nvar showMoreList = function() {\n\n    //var groupId = $(this).attr(\"data-groupId\");\n    //var imId = $(this).attr(\"data-imId\");\n    //var topicType = $(this).attr(\"data-topicType\");\n    var commentid = $(this).attr(\"data-htid\");\n    //var tid = $(this).attr(\"data-tid\");\n    //var tootalPages = $(this).attr(\"data-tootlePages\"); //\n    //var currentPage = $(this).attr(\"data-currentPage\"); //当前页数\n    //var pageSize = $(this).attr(\"data-pageSize\"); //当前展示列表数\n    //var a = Math.ceil(parseInt(tootalPages) / parseInt(pageSize)); //获取总页数\n    // var b = parseInt(tootalPages) % parseInt(pageSize); //获取最后一页的列表数目\n    //var toPage = parseInt(currentPage) + 1;\n    var obj = $(this);\n    var paramList = '?page=1&pagesize=70&topic_replyid=' + commentid;\n    var objHtml = obj.html();\n\n    if (objHtml === \"查看回复...\") {\n        getRelyList(paramList, obj);\n    } else {\n        //\n        var childrens = $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-s\");\n        //console.log(childrens);\n        for (var k = 2; k < childrens.length; k++) {\n            childrens.eq(k).remove();\n        }\n        obj.html(\"查看回复...\");\n    }\n\n    function getRelyList(paramList, obj) {\n        fetch.get(url.get('getRelyListV2') + paramList).then(function(data) {\n            //console.log(data);\n\n            var replyCommentList = data.data.topicSubReplys;\n            if (replyCommentList.length > 2) {\n\n                $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-box\").empty();\n                for (var i = 0; i < replyCommentList.length; i++) {\n\n                    var replyaList = replyCommentList[i];\n                    var content = replyaList.content;\n                    content = changeContent(content);\n                    var beReplyUserName = \"\";\n                    var beReplyUserId = \"\";\n                    var replayToPub = false;\n                    // console.log(replyaList);\n                    var SenUserId = checkUserId(replyaList.user.id);\n                    var threeUserId = \"javascript:;\";\n\n                    if (replyaList.topicSubReplyUser) {\n                        beReplyUserName = replyaList.topicSubReplyUser.nickname;\n                        beReplyUserId = replyaList.topicSubReplyUser.id;\n                        replayToPub = true;\n                        threeUserId = checkUserId(beReplyUserId);\n                    }\n                    var showCom = {\n                        \"SenUserId\": SenUserId,\n                        \"threeUserId\": threeUserId,\n                        \"topicType\": 0,\n                        \"backTopicId\": commentid,\n                        \"parentCommentId\": commentid, //话题id\n                        \"topicId\": replyaList.topicId,\n                        \"replayToPub\": replayToPub, //判断是二级回复还是三级回复\n                        \"content\": content, //回复内容\n                        \"replyUserName\": replyaList.user.nickname, //回复人昵称\n                        \"replyUserId\": replyaList.user.id, //回复人id\n                        \"beReplyUserName\": beReplyUserName, //被回复人的昵称\n                        \"beReplyUserId\": beReplyUserId, //被回复人的id\n                        \"replyCommentId\": replyaList.id // 二级回复内容id\n                    }\n                    var item = secondComList(showCom);\n                    //console.log(showCom);\n                    $(\"[data-ddlist='\" + commentid + \"']\").find(\".comments-box\").append(item);\n                    // if ($is_Login == \"0\") {\n                    //     $(\"[data-node=secondCom_Key]\").css(\"display\", \"none\");\n                    // }\n                    obj.html(\"收起\");\n                    //obj.css(\"display\", \"none\");\n\n                }\n            } else {\n                obj.addClass(\"hide\");\n                $(\"[data-ddlist='\" + commentid + \"']\").parent().addClass(\"bd-bottom\");\n            }\n        });\n    }\n}\n\nfunction checkUserId(id) {\n    if ($is_Login == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\nmodule.exports = showMoreList;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/showMoreList.js","//表情添加\n\nvar checkLoginStatus = require('module/checkLoginStatus'); // 登陆判断\nvar face = require('module/popup/face/face');\nvar loginState = require('./loginState');\n\nvar textareaTips = '[data-node=\"textareaTips\"]';\nvar curretTextArea = [];\nvar $showBox;\nvar selectText = function(textbox, startIndex, stopIndex) {\n    if (textbox.setSelectionRange) {\n        textbox.setSelectionRange(startIndex, stopIndex);\n    } else if (textbox.createTextRagen) {\n        var range = textbox.createTextRange();\n        range.collapse(true);\n        range.moveStart('character', startIndex);\n        range.moveEnd('character', stopIndex - startIndex);\n        range.select();\n    }\n    textbox.focus();\n};\n\nvar insertAtCursor = function(textbox, text) {\n    if (textbox.selectionStart >= 0) {\n        var val = textbox.value;\n        var startIndex = textbox.selectionStart;\n        textbox.value = val.substring(0, startIndex) + text + val.substring(textbox.selectionEnd);\n        textbox.selectionStart = textbox.selectionEnd = startIndex + text.length;\n        textbox.focus();\n    } else if (typeof document.selection != 'undefined' && typeof document.selection.createRange != 'undefined') {\n        textbox.focus();\n        $(textbox).siblings(textareaTips).addClass('hide');\n        var range = document.selection.createRange();\n        range.text = text;\n        range.select();\n    }\n};\nvar showEmoji = function() {\n    if ($showBox) {\n        $showBox.hide();\n    } else {\n        $showBox = $('[data-node=\"picPopBox\"]');\n        $showBox.hide();\n    }\n\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var $this = $(this);\n\n    var offset = $this.offset();\n    var x = offset.left - 2;\n    var y = offset.top + 38;\n\n    curretTextArea = $this.closest('.topic-publish-content').children(\"textarea\");\n    curretTextArea.focus();\n    if ($('[data-node=\"faceBox\"]').is(':hidden')) {\n        face.show(x, y);\n    } else {\n        face.hide();\n    }\n\n    return false;\n};\n\nmodule.exports = {\n    showEmoji: showEmoji,\n    insertAtCursor: insertAtCursor,\n    selectText: selectText,\n    curretTextAreaObj: function() {\n        return curretTextArea.get(0);\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/Smiley.js","\nvar getCommentList = require('./getCommentList'); //\n\n//var $loadlist = $(\"[data-node=loadlist]\");\n//var $comment_Msg = $(\"[data-node=comment_Msg]\");\n//var $a_Submit = $(\"[data-node=a_Submit]\");\n//var $circleCom = $(\"[data-node=circleCom]\");\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar DIVOBJ = $(\"[data-node='more-topic']\");\nvar loginPop = require('module/popup/login');\nvar  lodingMore = function(){\n\n    //加载更多\n\n    //$(\"[data-node=loading]\").css(\"display\", \"none\");\n    //$(\"[data-node=noload]\").css(\"display\", \"none\");\n\n    DIVOBJ.on(\"click\" ,\"[data-node='loadlist']\",function(){\n        var hideDiv = $(this).parent(\"[data-node='hidDiv']\")\n        var topicId = hideDiv.attr(\"data-comtopicid\");\n        var userSubmits = hideDiv.find(\"[data-node='userSubmit']\");\n        var addmorepages = $(this).attr(\"data-addmorepages\"); //当前页\n        var listsize = $(this).attr(\"data-listsize\"); //\n        //var tootalPa = $(this).attr(\"data-tootlepa\"); //总页数\n        var toPage = parseInt(addmorepages) + 1;\n        var nodelist = \"nodelist\";\n\n        for(var i=0,len = userSubmits.length; i<len; i++){\n            var $this = $(userSubmits[i]);\n            $this.next('a').remove();\n            $this.next('div').remove();\n            $this.remove();\n            \n        }\n\n        getCommentList(topicId,toPage, listsize, 5, nodelist);\n        return false;\n    });\n\n\n}\n\n// 点击评论图标页面滚动到评论区域\nvar goComment = function() {\n\n\n\n    var $body = $('body');\n    $body.on('click',\"[data-action='goComment']\", function() {\n        if (!checkLoginStatus()) {\n            loginPop();\n            return false;\n        }\n        var id = $($(this).parents()[2]).attr(\"data-conter-ul\");\n        //console.log(id);\n        if (window.BP) {\n            BP.send({\n                event_id: 'G000P008',\n                group_id: $_CONFIG.groupid,\n                topic_id: $_CONFIG.topicid,\n                circle_type: $_CONFIG.s_c,\n                channel_id: 'in-pinglun'\n            });\n        }\n\n        var $topObj = $(\"[data-left='\"+id+\"']\").children(\"[data-node='commentBox']\");\n        var offsetTop = $topObj.offset().top;\n        $(\"[data-tid='\"+id+\"']\").children(\"textarea\").focus();\n        $('html,body').animate({\n            'scrollTop': offsetTop\n        }, 200);\n\n\n    });\n}\n\n\n\n\nmodule.exports = {\n\tlodingMore : lodingMore,\n\tgoComment :goComment\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/otherFn.js","var praise = require('module/praise');\n\nvar $praiseClick = $(\"[data-node='praiseClick']\");\n\n if($praiseClick.children(\"em\").hasClass(\"active\")){\n    $praiseClick.children(\"span\").html(\"取消点赞\");\n}\n\nvar init = function(){\n    praise('body', '[data-node=\"praiseClick\"]', {\n        mode: 'normal'\n    });\n   /* praise('[data-node=hot_topics]', '[data-action=like]', {\n        mode: 'normal'\n    });\n    */\n\n    return false;\n};\n\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/praise.js","var share = require('module/share').shareto;\nvar shareBP = require('module/shareBP');\n\nvar init = function() {\n    var $body = $(\"body\");\n    //var $wx = $('[data-node=wx]');\n    // var $wb = $('[data-node=wb]');\n    //var $qq = $('[data-node=qq]');\n    //var $qzone = $('[data-node=qzone]');\n\n    var gomeplusLogo = $_CONFIG.imgpath + '/images/public/down-logo.png';\n\n    var getShareInfo = function($node) {\n        var $ul = $node.closest('ul');\n        var shareInfo = {\n            url: $ul.data('surl'),\n            title: $ul.data('stitle'),\n            pic: $ul.data('spic') || gomeplusLogo,\n            summary: $ul.data('content') || \"这里有志趣相投的小伙伴，机智诙谐的猛料，还有你\"\n                //desc: $ul.data('content')\n        };\n        return shareInfo;\n    };\n\n    var shareTo = function(type) {\n        return function() {\n            var info = getShareInfo($(this));\n            //console.log(info);\n            var topicId = $(this).closest('.topic-conter').attr(\"data-conter-ul\");\n            //console.log(topicId);\n            share[type](info);\n            // analytic(type, topicId); // 发送统计数据\n            var opts = {\n                page: 'ht',\n                shareTo: type,\n                shareId: topicId\n            }\n            shareBP(opts);\n            return false;\n        };\n    };\n\n    var evtType = 'click';\n    var $conf = $_CONFIG;\n\n    /*var channels = {\n        'wx': 'out-weixin',\n        'sina': 'out-xlwb',\n        'qq': 'out-QQ',\n        'qzone': 'out-Qqzone'\n    };\n    var analytic = function(channel, topicId) {\n        BP.send({\n            event_id: 'G000P008',\n            group_id: $conf.groupid,\n            topic_id: topicId,\n            circle_type: $conf.s_c,\n            channel_id: channels[channel] || ''\n        });\n    };*/\n    $body.on(evtType, \"[data-node='wx']\", function() {\n        // 当前话题页所对应的wap页的地址\n        // https://m-pre.gomeplus.com/group/topic?topicId=56dfeac86af14853711f4668\n        var topicid = $(this).closest('.topic-conter').attr(\"data-conter-ul\");\n        share.weixin({\n            url: $_CONFIG.wap_circle_url + '/topic-' + topicid + '.html'\n                //url: \"https://circle.m.gomeplus.com/topic-\" + topicid + \".html\"\n        });\n\n        // analytic('wx'); // 发送统计数据\n        var opts = {\n            page: 'ht',\n            shareTo: 'wx',\n            shareId: topicid\n        };\n        shareBP(opts); //发送统计数据\n        return false;\n    });\n    $body.on(evtType, \"[data-node='wb']\", shareTo('wb'));\n    $body.on(evtType, \"[data-node='qq']\", shareTo('qq'));\n    $body.on(evtType, \"[data-node='qzone']\", shareTo('qz'));\n};\n\nmodule.exports = {\n    init: init\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/share.js","/*\n@Author:dongyukuan\n@data:2017/3/2\n话题详情页和圈子主页的分享埋点\n使用方法：\n    1、var shareBP = require('module/shareBP');\n    2、shareBP(opts);\n       注：opts={\n            page:是圈子主页还是话题详情页\n            shareTo:分享到微信、微博等\n            share_id:topic_id或group_id\n       }\n*/\n\nvar fetch = require(\"io/fetch\");\nvar api = 'https://beacon.gomeplus.com/log_share';\nvar shareObj = {\n    ht: {\n        share: {\n            qq: '2010506904',\n            qz: '2020506904',\n            wx: '2030506904',\n            wb: '2050506904'\n        },\n        url: {\n            qq: location.href + '&cmpid=fx_pc_qq' + $_CONFIG.share_time,\n            qz: location.href + '&cmpid=fx_pc_qz' + $_CONFIG.share_time,\n            wx: location.href + '&cmpid=fx_pc_wx' + $_CONFIG.share_time,\n            wb: location.href + '&cmpid=fx_pc_wb' + $_CONFIG.share_time\n        }\n    },\n    qz: {\n        share: {\n            qq: '2010507903',\n            qz: '2020507903',\n            wx: '2030507903',\n            wb: '2050507903'\n        },\n        url: {\n            qq: location.href + '&cmpid=fx_pc_qq' + $_CONFIG.share_time,\n            qz: location.href + '&cmpid=fx_pc_qz' + $_CONFIG.share_time,\n            wx: location.href + '&cmpid=fx_pc_wx' + $_CONFIG.share_time,\n            wb: location.href + '&cmpid=fx_pc_wb' + $_CONFIG.share_time\n        }\n    },\n    user_id: $_CONFIG.userId,\n    cookie_id: $_CONFIG.share_ssid,\n    env: $_CONFIG.share_env\n};\n\nfunction jianjie(data) {\n    console.log(data)\n};\n\nfunction shareBP(opts) {\n    var page = opts.page; //需传入'topic'(话题详情页)；'circle'(圈子主页);\n    var shareTo = opts.shareTo; //分享到哪(qq,qzone,wx,sina);\n    var share_id = opts.shareId; //topic_id或group_id;\n    function getcookie(objname){//获取指定名称的cookie的值\n        var cookieArr = document.cookie.split(\"; \");\n        for(var i = 0;i < cookieArr.length;i ++){\n            var temp = cookieArr[i].split(\"=\");\n            if(temp[0] == objname) return unescape(temp[1]);\n        }\n    }\n    var shareData = {\n        'sp':'plus',\n        'pf':'pc',\n        'sc':shareTo,\n        'st':page,\n        'ss':0,\n        'pid':window.page_id,\n        'sid':share_id,       \n        'uid':shareObj.user_id,\n        'cid':getcookie('__gmz'),\n        'url': shareObj[page].url[shareTo],\n        'env': shareObj.env,\n        'di':''\n    };\n    shareData = JSON.stringify(shareData);\n    fetch.post(api, {\n        data: shareData\n    }).done(function(data) {})\n};\nmodule.exports = shareBP;\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/module/shareBP.js","/**\n * 话题收藏/取消收藏\n */\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\nvar loginPop = require('module/popup/login');\nvar checkLoginStatus = require('module/checkLoginStatus');\n\nvar popFlag = 0;\n\nvar login = function() {\n    window.location.href = $_CONFIG.passport_domain + 'login/index';\n};\nvar $collect = $(\"[data-node='collect']\");\nif ($collect.children(\"em\").parent().hasClass(\"active\")) {\n    $collect.children(\"span\").html(\"取消收藏\");\n    // $collect.attr(\"data-status\",\"1\");\n}\n\n\nvar init = function() {\n    var $body = $(\"body\");\n    $body.on('click', \"[data-node='collect']\", function() {\n        var $CONF = $_CONFIG;\n        if (window.BP) {\n            BP.send({\n                event_id: 'G000P008',\n                group_id: $CONF.groupid,\n                topic_id: $($(this).parents()[2]).attr(\"data-conter-ul\"),\n                circle_type: $CONF.s_c,\n                channel_id: 'in-shoucang'\n            });\n        }\n\n        var $this = $(this);\n        // var firing = $this.data('firing');\n        // if (firing) {\n        //     return false;\n        // }\n        // $this.data('firing', 1);\n        var iscollect = $this.data('status');\n        // 1 收藏, 2 取消收藏\n        var t = iscollect === 0 ? 1 : 2;\n\n        //console.log($($this.parents()[2]).attr(\"data-conter-ul\"));\n        var objs = {\n            //validate: true,\n            data: {\n                groupId: $_CONFIG['groupid'],\n                topicId: $($this.parents()[2]).attr(\"data-conter-ul\"),\n                type: t\n            },\n            onLogin: noRefreshFetch,\n            refresh: true // 目前登录和收藏需要刷新页面\n        }\n\n        //无刷新登录\n        function noRefreshFetch() {\n            var o = objs;\n            fetch.post(url.get('collectTopic'), o).done(function(data) {\n                //订阅评论区编辑状态\n                Pubsub(channel.comment.enableEditor).pub({\n                    pid: \"enable\"\n                });\n                if (data && data.code === 200 && data.success) {\n                    if (t === 1) {\n                        $this.data('status', 1);\n                        $this.find('em').parent().addClass('active');\n                        $this.find('span').text('取消收藏');\n                    } else if (t === 2) {\n                        $this.data('status', 0);\n                        $this.find('em').parent().removeClass('active');\n                        $this.find('span').text('收藏');\n                    }\n                } else if (data && data.code === 422) {\n                    login();\n                } else {\n                    alert(data.message);\n                }\n                if (popFlag) {\n                    window.location.reload();\n                }\n            }).fail(function() {\n\n            }).always(function() {\n                // $this.data('firing', 0);\n            });\n        }\n        if (!checkLoginStatus()) {\n            popFlag = 1;\n            loginPop(noRefreshFetch);\n        } else {\n            popFlag = 0;\n            noRefreshFetch()\n        }\n        return false;\n    });\n};\n\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/collect.js","var Pubsub = require('io/pubsub');\nvar identify = require('utils/IdentifyIE8-');\nvar titel = require('./title.tpl');\nvar comList = require('./comList.tpl');\nvar commentBox = require('./commentBox.tpl');\nvar topicRight = require('./topicRight.tpl');\nrequire('lazyload');\n\nrequire('history');\nrequire('module/atgregion')();\n\nvar getCommentList = require('../comment/getCommentList');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\n\nvar clickTopicId = $_CONFIG['topicid'];\nvar clickTopicObj = {\n    \"name\": $_CONFIG['topic_title'],\n    \"id\": clickTopicId\n};\n//console.log(clickTopicObj);\nvar len = 0;\nvar lastScroll = 0;\n\nvar downLoadTopic = [clickTopicObj]; //已加载的有效话题id\n\nvar OpenedTop = [clickTopicObj]; //记录页面已经滑过的话题id\nvar ListTopsValid = [];\n\nvar arrayIdBoolean = []; //改变ul地址的判断\nvar idVideo = [];\nvar videoObj = [];\nvar currentId = clickTopicObj.id;\nvar oldCurrentId  = clickTopicObj.id;\n//var vid = null;\n\nvar $no_next = $_CONFIG['no_next']; //1 false\n\nvar imgPath = $_CONFIG['imgpath'];\nvar isLogin = $_CONFIG['islogin'];\n\nvar jctjmodule = $_CONFIG['htfxan']; //分享按钮\nvar htxqmodule = $_CONFIG['htxq']; //话题详情\nvar htcyplmodule = $_CONFIG['htcypl']; //参与评论\nvar htpllbmodule = $_CONFIG['htpllb']; //评论列表\nvar htqzxxmodule = $_CONFIG['htqzxx']; //圈主信息\nvar htrmhtmodule = $_CONFIG['htrmht']; //热门话题\nvar htxyymodule = $_CONFIG['htxyy']; //下一篇\n//$GLOBAL_CONFIG['ggckgd'] = 'PGGMKCKmd0003';  //埋点查看更多标示\nvar ggjzgdmodule = $_CONFIG['ggjzgd']; //埋点加载更多标示\nvar hotTopicUl = $(\"[data-node='hot_topics']\").html();\nvar topicRT = $(\".topic-r-t\").html();\nvar $topicWrap =  $(\"[data-node='more-topic']\");\nvar number = 0;\nfunction addDivHtml(newMsg1) {\n    var newMsg = newMsg1;\n    var id = newMsg.id;\n    //右侧的参数\n    var rightNextMsg = {\n        topicRT: topicRT,\n        hotTopicUl: hotTopicUl,\n        id: id,\n        nextTopName: newMsg.topicName,\n        nextTopTime: newMsg.lastReplyTime,\n        htqzxxmodule: newMsg.htqzxxmodule,\n        htrmhtmodule: newMsg.htrmhtmodule,\n        htxyymodule: newMsg.htxyymodule\n    }\n\n    var elemTitle = titel(newMsg); //头部\n    var elemCommentBox = commentBox(newMsg);\n    var elemComList = comList(newMsg); //评论\n    var elemRight = topicRight(rightNextMsg);\n\n    var topicHtml = '<div class=\"more-topic\" >'\n                        + '<div class=\"wrap-box ovflow-hid wrap-reletive \" data-node=\"wrap-box\" id-node=' + id + '>'\n                            + '<div class=\"topic-lfet\" data-left=' + id + '>'\n                                + elemTitle\n                                + elemCommentBox\n                                + elemComList\n                            + '</div>'\n                            + elemRight\n                        + '</div>'\n                    '</div>';\n    $topicWrap.append(topicHtml);\n\n    var $leftImg = $topicWrap.children().last().find('.source-rig-box img');\n    $leftImg.lazyload({\n        effect: \"fadeIn\"\n    });\n}\n\nfunction getVideo() {\n\n    var videoArr = $_CONFIG['video_arr'];\n    //console.log();\n    var newVideo = [videoArr];\n    if (videoArr.length > idVideo.length) {\n\n        newVideo = videoArr.slice(idVideo.length);\n        for (var i = 0; i < newVideo.length; i++) {\n\n            var _video = newVideo[i];\n            var video_id = _video.base.id;\n\n            var v = new MeixinPlayer();\n            v.init(video_id, 'videoContainer_' + video_id + \"_\" + _video.config.topicId, _video.config);\n            idVideo.push(newVideo[i]);\n            videoObj.push(v);\n\n            v.on('playStart', function() {\n                for (var i = 0; i < videoObj.length; i++) {\n                    if (videoObj[i] === v) {\n                        //return false;\n                    } else {\n                        videoObj[i].stopVideo();\n                    }\n                }\n            }, v);\n        }\n    } else {\n        return false;\n    }\n}\nvar nextLoading = 0;\n\n//增加话题访问量\nvar addVisitTopicId = function(openTopicId) {\n    fetch.get(url.get('addVisitTopic'), {\n        data: {\n            topicid: openTopicId\n        }\n    })\n}\n\n//获取话题中商品价格\nvar getGoodsPrice = function(goodsId) {\n    var ids = '';\n    $.each(goodsId, function(i, v) {\n        ids += ',' + $(v).attr('data-id') + '|' + $(v).attr('data-skuid');\n    })\n    return ids.substr(1);\n}\n\n//渲染话题中的价格\nvar changeGoodsPrice = function(topicId) {\n    var curTopicId = $('[id-node=\"' + topicId + '\"]');\n    var len = curTopicId.find('strong[data-id]').length;\n    var ids = getGoodsPrice(curTopicId.find('strong[data-id]'));\n    if (len !== 0) {\n        fetch.get(url.get('getIndexData'), {\n            data: {\n                type: 'product',\n                ids: ids\n            }\n        }).done(function(data) {\n            if (data.success === true) {\n                $.each(data.data, function(i, v) {\n                    if (v.salePrice === null) {\n                        v.salePrice = '暂无售价'\n                    }\n                    $('[data-id=\"' + v.id + '\"]').text(v.salePrice);\n                    $('[data-id=\"' + v.id + '\"]').parent('[data-node=\"price\"]').removeClass('hide');\n                })\n            }\n\n        })\n    }\n}\n\nfunction getNextTopicId(openTopicId) {\n    arrayIdBoolean.push(openTopicId);\n\n    fetch.get(url.get('getNextTopic') + \"?topicid=\" + openTopicId).then(function(data) {\n        if (data.success == true && data.code == 200) {\n\n            var $getNext = $(\"[data-get-next-topic='\" + openTopicId + \"']\");\n            if (nextLoading) {\n                $getNext.children(\"a\").html(data.data.name)\n                    .attr(\"href\", \"/topic/\" + data.data.id + \".html\")\n                    .attr(\"target\", \"_blank\");\n                $getNext.find(\".f12\").html(data.data.lastReplyTime);\n                $getNext.slideDown(\"slow\");\n            } else {\n                nextLoading = 1;\n            }\n            //获取下个话题的信息，id\n            var userImage = $_CONFIG['headface'];\n            var pathImg = $_CONFIG.imgpath;\n            if (!userImage) {\n                userImage = pathImg + \"/images/public/head-default.png\";\n            }\n            var isExpert = $_CONFIG['isExpert'] ? true : false; //是否为达人\n\n            //console.log(isLogin);\n            var isLoginClass = \"\";\n            var isLoginStr = '';\n            var readyOnly = '';\n            if (isLogin == \"0\") {\n                isLoginStr = \"登录\";\n                isLoginClass = \"pc-bj-fc8753\";\n                readyOnly = \"readonly\";\n                //var headface\n            } else {\n                isLoginStr = \"发布\";\n                isLoginClass = \"\";\n                readyOnly = \"\";\n            }\n\n            var dataStr = data.data;\n            var id = dataStr.id;\n            var name = data.data.name;\n            $(\"body\").attr(\"data-currentTopicId\", openTopicId);\n            $(\"body\").attr(\"data-nextTopicId\", id);\n\n            downLoadTopic.push({\n                \"name\": name,\n                \"id\": id\n            });\n\n            // 点赞和收藏\n\n            //var likeIS = dataStr.ext.praise.isLike == false ? \"\" : \"active\";\n            var UserId = checkUserId(dataStr.user.id);\n            var showReport = (isLogin == 1) && ($_CONFIG['userId'] != dataStr.user.id) ? true : false;\n            var allNum = parseInt(dataStr.replyQuantity + dataStr.subReplyQuantity);\n            var newMsg = {\n                    jctjmodule: getModuleString(jctjmodule),\n                    htxqmodule: getModuleString(htxqmodule),\n                    htcyplmodule: getModuleString(htcyplmodule),\n                    htpllbmodule: getModuleString(htpllbmodule),\n                    htqzxxmodule: getModuleString(htqzxxmodule),\n                    htrmhtmodule: getModuleString(htrmhtmodule),\n                    htxyymodule: getModuleString(htxyymodule),\n                    ggjzgdmodule: ggjzgdmodule,\n                    UserId: UserId,\n                    html: dataStr.html,\n                    isEssence: dataStr.isEssence, //精品,\n                    isUpper: dataStr.isUpper, //置顶,\n                    style: dataStr.style == \"0\" ? false : true, //专访\n                    topicName: dataStr.name, //话题名称\n                    id: id, //话题ID\n                    imgPath: imgPath,\n                    facePicUrl: dataStr.user.facePicUrl, // 话题 用户头像\n                    nickName: dataStr.user.nickname, //话题 用户名\n                    groupCircleName: dataStr.group.name, //来自圈子\n                    lastReplyTime: dataStr.lastReplyTime, //话题时间\n                    allNum: allNum, //评论数\n                    extGroupUrl: dataStr.ext.group_url, // 圈子路径\n\n                    extImagesLst: dataStr.ext.surl, //左侧ul上添加的数据\n                    share_text: dataStr.ext.share_text, // 左侧ul上的data-content 属性值\n                    extSpic: dataStr.ext.images_lst,\n                    extStitle: dataStr.name,\n\n                    isLike: dataStr.ext.praise.isLike == false ? \"\" : \"active\", //点赞\n                    isLikeName: dataStr.ext.praise.isLike == false ? \"点赞\" : \"取消点赞\", //点赞\n                    userQuantity: dataStr.ext.praise.userQuantity, // 点赞数\n                    userCollection: dataStr.userCollection.result == 0 ? \"\" : \"active\", //收藏\n                    userCollectionName: dataStr.userCollection.result == 0 ? \"收藏\" : \"取消收藏\", //收藏\n                    userCollectionStatu: dataStr.userCollection.result == 0 ? 0 : 1,\n                    dataParise: dataStr.ext.praise.isLike == false ? \"1\" : \"0\", //点赞\n                    mshopFlag: dataStr.ext.mshop_flag,  //是否显示美店图标\n                    mshopUrl: dataStr.ext.mshop_url,  //美店链接\n                    coverPic: dataStr.coverPic,   //封面\n\n                    is_del: dataStr.user.is_del,\n                    isExpert: isExpert, //是否是达人\n                    userImage: userImage, //用户头像\n                    groupId: data.data.groupId, //groupid\n\n                    isLoginStr: isLoginStr, //根据是否登陆判断显示 按钮内容\n                    isLoginClass: isLoginClass, //根据是否登陆显示  样式\n                    readyOnly: readyOnly, //根据是否登陆判断是  只读还是可写\n                    showReport: showReport  //举报\n\n                }\n                //填写数据\n            addDivHtml(newMsg); //添加数据到页面\n            showTextareaTips();\n            $(\"body\").attr(\"data-module\", Number($(\"body\").attr(\"data-module\")) + 1);\n            if (allNum != 0) {\n                getCommentList(id, 1, 10, 2);\n            }\n            ListTopsValid.push({\n                \"name\": name,\n                \"id\": id\n            });\n\n            var topRightH = $(\"[data-topicrt='\" + openTopicId + \"']\");\n            var h = topRightH.children(\".topic-r-t\").height() + topRightH.children(\".topic-position\").height();\n\n            $(\"[id-node='\" + openTopicId + \"']\").css(\"min-height\", h + \"px\");\n\n        } else if (data.success == false && data.code == 404) {\n            return false;\n        }\n\n    });\n\n}\n\n//鼠标下滑\nfunction addMoreEvent(s) {\n    //var TopicIdNext = $(\"body\").attr(\"data-nexttopicid\"); //\n    if (len == -1) {\n        // 已经滑过的对象数字\n        OpenedTop.push(clickTopicObj); //clickTopic\n        len = 0;\n    }\n    if (ListTopsValid.length - 1 == len) {\n        var id = ListTopsValid[ListTopsValid.length - 1].id;\n        var name = ListTopsValid[ListTopsValid.length - 1].name;\n\n        if (s > $(\"[id-node='\" + id + \"']\").offset().top) {\n            History.replaceState({}, name, id + \".html\");\n            OpenedTop.push({\n                name: name,\n                id: id\n            });\n            if ($no_next == 0 && arrayIdBoolean[arrayIdBoolean.length - 1] != id) {\n                getNextTopicId(id);\n                addVisitTopicId(id);\n                changeGoodsPrice(id);\n            }\n            getVideo();\n            len++;\n            currentId = id;\n        }\n    }\n\n    if (ListTopsValid.length - 1 > len) {\n        var id1 = ListTopsValid[len].id;\n        var name1 = ListTopsValid[len].name;\n\n        if (s > $(\"[id-node='\" + id1 + \"']\").offset().top) {\n            History.replaceState({}, name1, id1 + \".html\");\n            OpenedTop.push({\n                name: name1,\n                id: id1\n            });\n            len++;\n            currentId = id1;\n        }\n    }\n}\n//鼠标上滑\nfunction scrollToTop(t) {\n\n    var id = \"\";\n    var nextiD = \"\";\n    var name = \"\";\n    if (len < 1) {\n        nextiD = clickTopicObj.id;\n        name = clickTopicObj.name;\n        currentId = nextiD;\n    } else {\n        id = OpenedTop[len].id;\n        nextiD = OpenedTop[len - 1].id;\n        name = OpenedTop[len - 1].name;\n        currentId = id;\n    }\n    if (id) {\n        //var scrollTop = $(this).scrollTop();\n        if (t < $(\"[id-node='\" + id + \"']\").offset().top) {\n            History.replaceState({}, name, nextiD + \".html\");\n            OpenedTop.length = len;\n            len--;\n        }\n    }\n}\n\n//右侧 固定\nfunction topFixed(scrollTop) {\n\n    var showTopicID = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n\n    var $showDiv = $(\"[id-node='\" + showTopicID + \"']\"); //当前话题的div\n    var $showRight = $showDiv.children(\".topic-right \"); //右侧整体\n    var $thisScroll = $showRight.children(\"[data-node='topic_xi']\"); // 滚动部分\n    var $showLeft = $showDiv.children(\".topic-lfet\"); //左侧\n\n    var showDivHeight = $showDiv.height(); // 话题整体高度\n    var showRightHeight = $showRight.height(); //右侧高度\n    var thisScrollHeight = $thisScroll.height(); //热门话题的高度\n    var windowHight = $(window).height(); //窗口高度\n    var showLeftHeight = $showLeft.height(); //左侧高度\n\n    var floatRight = $(\"body\").width() - $(\".wrap-box\").width();\n    floatRight = parseInt(floatRight) / 2; //右边浮动的宽度\n\n    var s = scrollTop; //鼠标滚动的高度\n    var TopShow = parseInt($showDiv.offset().top); //整个话题div距离顶部的高度\n    var topicRT = TopShow + 320; //热门话题距离页面顶部的距离\n    var BottomShow = parseInt(TopShow) + showDivHeight; //热门话题距离页面底部的距离，应该减去热门话题的高度\n\n    // 左侧小于右侧，不操作\n    if (showLeftHeight <= showRightHeight) {\n        return false;\n    } else {\n        var pp = null;\n        var autoTop = null;\n        var opx = null;\n        //var toTopHeight = $(\".topic-r-t\").height();\n\n        var h = 0;\n        //var m = 0;\n        if (windowHight > thisScrollHeight) {\n            h = windowHight - thisScrollHeight;\n        } else {\n            //m = thisScrollHeight - windowHight;\n        }\n\n        if (thisScrollHeight <= windowHight) {\n            //吸顶\n            pp = topicRT;\n            autoTop = \"0px\";\n            opx = \"auto\";\n        } else {\n            //吸底\n            pp = topicRT - windowHight + thisScrollHeight;\n            autoTop = \"auto\";\n            opx = \"0px\";\n        }\n        //var h = windowHight - thisScrollHeight;\n        if (s > pp && s + windowHight <= BottomShow + h) {\n            $($thisScroll).css({\n                \"position\": \"fixed\",\n                \"right\": floatRight + \"px\",\n                \"top\": autoTop,\n                \"bottom\": opx\n            });\n        } else if (s + windowHight > BottomShow + h) {\n            $($thisScroll).css({\n                \"position\": \"absolute\",\n                \"right\": \"0px\",\n                \"top\": \"auto\",\n                \"bottom\": \"0px\"\n            });\n        } else if (s < pp) {\n            $($thisScroll).css({\n                \"position\": \"absolute\",\n                \"right\": \"0px\",\n                \"top\": \"320px\",\n                \"bottom\": \"auto\"\n            });\n        }\n\n    }\n\n}\nvar leftS = parseInt($(\".wrap-box.ovflow-hid\").css(\"margin-left\"), 10) + 20;\nfunction ulFixt(scrollTop) {\n    var containerId = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n    var $divConter = $(\"[data-conter-ul='\" + containerId + \"']\");\n    var $ul = $($divConter).children(\"ul\");\n    var divTop = $divConter.offset().top;\n    var divHeight = $divConter.height();\n    var ulHeight = $ul.height();\n    var s = divHeight + divTop - ulHeight;\n    if (scrollTop > divTop && scrollTop < s) {\n        $ul.css({\n            \"position\": \"fixed\",\n            \"top\": \"6px\",\n            \"left\": leftS + \"px\",\n            \"bottom\": \"auto\"\n        });\n    } else if (scrollTop > s) {\n        $ul.css({\n            \"position\": \"absolute\",\n            \"top\": \"auto\",\n            \"left\": \"0px\",\n            \"bottom\": \"0px\"\n        });\n    } else if (scrollTop < divTop) {\n        $ul.css({\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"bottom\": \"auto\",\n            \"left\": \"0px\"\n        });\n    }\n\n}\n\nfunction checkUserId(id) {\n    if (isLogin == 1 && $_CONFIG['userId'] == id) {\n        return $_CONFIG.i_domain + 'member/profileHome';\n    } else {\n        return $_CONFIG.group_domain + 'ta/' + id + '.html';\n    }\n}\n\n// 返回顶部a\nfunction toTopBtn() {\n    var $Btn = $(\"[data-node='top']\");\n    $Btn.off();\n    var btnScroll = -1;\n\n    $Btn.on(\"click\", function() {\n\n        var topicId = \"\";\n        var winScrollTop = parseInt($(window).scrollTop());\n        $(this).attr(\"data-winScrollTop\", winScrollTop);\n        if (btnScroll == winScrollTop) {\n            OpenedTop = [clickTopicObj];\n            topicId = OpenedTop[OpenedTop.length - 1]; //当前话题id\n            len = 0;\n            $(\"html, body\").scrollTop(10);\n            History.replaceState({}, topicId.name, topicId.id + \".html\");\n\n        } else {\n            topicId = OpenedTop[OpenedTop.length - 1].id; //当前话题id\n            var dropTop = parseInt($(\"[id-node='\" + topicId + \"']\").offset().top);\n            $(window).scrollTop(dropTop);\n            btnScroll = dropTop;\n        }\n        $(this).attr(\"data-btnScroll\", btnScroll);\n        //console.log(\"winScrollTop: \"+winScrollTop +\" dropTop: \"+dropTop);\n    })\n}\n\nvar getModuleString = function(modulestr) {\n    // var num = Number($(\"body\").attr(\"data-module\")) +1;\n    // if(num <10 ){\n    //     return modulestr+\"000\"+num;\n    // }else if(num >=10 && num <1000 ){\n    //     return modulestr+\"00\"+num;\n    // }else if(num >=100 && num <100){\n    //     return modulestr+\"0\"+num;\n    // }else if( num >=1000 &&num <10000){\n    //     return modulestr+\"\"+num;\n    // }\n    return modulestr;\n}\n\n//IE显示placeholder内容\nvar showTextareaTips = function() {\n    var $textareaTips = $('[data-node=\"textareaTips\"]');\n    if (identify()) {\n        $textareaTips.removeClass('hide');\n    }\n}\n\nvar init = function() {\n    getVideo();\n    toTopBtn();\n    History.Adapter.bind(window, 'statechange', function() {\n        //var State = History.getState();\n        //History.log('statechange:', State.data, State.title, State.hash);\n    });\n    showTextareaTips();\n    //var topicRT = $(\".topic-r-t\").html(); // 右侧的html\n    //var hotTopicUl = $(\"[data-node=hot_topics]\").html(); //热门话题的html\n\n    //获取下一个话题\n    if ($no_next == 0) {\n        getNextTopicId(clickTopicId);\n    }\n    addVisitTopicId(clickTopicId);\n\n    Pubsub('getAreaId').sub(function() {\n        changeGoodsPrice(clickTopicId);\n    });\n\n    var scrollTop = 0;\n    var windowHight = $(window).height();\n    var s = 0;\n    var noneHeight = 0;\n    //鼠标滚动事件\n    $(window).on(\"scroll\", function() {\n\n        scrollTop = $(this).scrollTop();\n        windowHight = $(window).height();\n        s = parseInt(scrollTop + windowHight / 3);\n        topFixed(scrollTop);\n        ulFixt(scrollTop);\n        var $current = $(\"[id-node='\" + currentId + \"']\").parent();\n        // 视频暂停\n        if (scrollTop - lastScroll > 0) { //下滑\n            //判断并加载话题\n            addMoreEvent(s);\n\n\n        } else { //上滑\n            //改变ulr地址\n            scrollToTop(s);\n            $current.next().nextAll() !== 'none' && $current.next().nextAll().hide();\n\n            if($current.prev().css('display') === 'none') {\n                $current.prev().show();\n                noneHeight = scrollTop + $current.prev().height();\n                $(window).scrollTop(noneHeight);\n            }\n        }\n        if( oldCurrentId !== currentId ){\n            if (scrollTop - lastScroll > 0) {\n                noneHeight = scrollTop - $current.prev().prev().height();\n                $current.prev().prevAll().css('display') !== 'none' && $current.prev().prevAll().hide();\n                $current.next().css('display') === 'none' && $current.next().show();\n                $(window).scrollTop(noneHeight);\n            }\n            oldCurrentId = currentId;\n        }\n\n        lastScroll = scrollTop;\n    });\n}\n\n\nmodule.exports = {\n    init: init,\n    topFixed: topFixed\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/topicAddMore/topicAddMore.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/title',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htxqmodule=$data.htxqmodule,coverPic=$data.coverPic,isUpper=$data.isUpper,isEssence=$data.isEssence,style=$data.style,$string=$utils.$string,topicName=$data.topicName,UserId=$data.UserId,facePicUrl=$data.facePicUrl,nickName=$data.nickName,extGroupUrl=$data.extGroupUrl,groupCircleName=$data.groupCircleName,lastReplyTime=$data.lastReplyTime,allNum=$data.allNum,userQuantity=$data.userQuantity,extImagesLst=$data.extImagesLst,extSpic=$data.extSpic,extStitle=$data.extStitle,share_text=$data.share_text,jctjmodule=$data.jctjmodule,dataParise=$data.dataParise,isLike=$data.isLike,isLikeName=$data.isLikeName,userCollectionStatu=$data.userCollectionStatu,userCollection=$data.userCollection,userCollectionName=$data.userCollectionName,mshopFlag=$data.mshopFlag,mshopUrl=$data.mshopUrl,html=$data.html,is_del=$data.is_del,showReport=$data.showReport,$out='';$out+='<div class=\"bjfff\" data-node=\"tiles\" data-title =';\n$out+=$escape(id);\n$out+=' modelid=\"';\n$out+=$escape(htxqmodule);\n$out+='\"> ';\nif(coverPic){\n$out+=' <div class=\"topic-cover\"><img src=';\n$out+=$escape(coverPic);\n$out+='></div> ';\n}\n$out+=' <div class=\"topic-title0\"> <h1> ';\nif(isUpper){\n$out+='<em class=\"set-top\">置顶</em> ';\n}\n$out+=' ';\nif(isEssence){\n$out+='<em class=\"set-spark\">精品</em> ';\n}\n$out+=' ';\nif(style){\n$out+='<em class=\"set-access\">专访</em> ';\n}\n$out+=' ';\n$out+=$string(topicName);\n$out+=' </h1> <p class=\"topic-source\" data-node=\"likewrap\"> <a href=\"';\n$out+=$escape(UserId);\n$out+='\" target=\"_blank\"> <img onerror=\"imgError(this, \\'h\\')\" src=';\n$out+=$escape(facePicUrl);\n$out+=' alt=\"\">';\n$out+=$escape(nickName);\n$out+=' </a> <span>来自圈子：</span> <a href=';\n$out+=$escape(extGroupUrl);\n$out+=' target=\"_blank\">';\n$out+=$escape(groupCircleName);\n$out+='</a> <span>';\n$out+=$escape(lastReplyTime);\n$out+='</span> <span class=\"fr\"> <em class=\"icon-discuss\"></em> <span class=\"topic-count\">';\n$out+=$escape(allNum);\n$out+='</span> </span> <span class=\"fr\"> <em class=\"icon-like\"></em> <span class=\"topic-count\">';\n$out+=$escape(userQuantity);\n$out+='</span> </span>  </a> </p> </div> <div class=\"topic-conter\" data-conter-ul =';\n$out+=$escape(id);\n$out+=' > <ul class=\"source-lef-list\" data-node=\"ulFloat\" data-surl=\"';\n$out+=$escape(extImagesLst);\n$out+='\" data-spic=\"';\n$out+=$escape(extSpic);\n$out+='\" data-stitle=\"';\n$out+=$escape(extStitle);\n$out+='\" data-content=\"';\n$out+=$escape(share_text);\n$out+='\" > <!--modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='\"--> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0001\"><a href=\"javascript:void(0)\" data-node=\"wx\"><em class=\"icon-weixin\"></em><span>微信</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0002\"><a href=\"javascript:void(0)\" data-node=\"wb\"><em class=\"icon-weibo\"></em><span>微博</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0003\"><a href=\"javascript:void(0)\" data-node=\"qq\"><em class=\"icon-qq\"></em><span>QQ</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0004\"><a href=\"javascript:void(0)\" data-node=\"qzone\"><em class=\"icon-qzone\"></em><span>QQ空间</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0005\"> <a href=\"javascript:void(0)\" data-id=\"';\n$out+=$escape(id);\n$out+='\" data-node=\"praiseClick\" data-type=\"1\" data-praise=\"';\n$out+=$escape(dataParise);\n$out+='\" class=\"';\n$out+=$escape(isLike);\n$out+='\"> <em class=\"icon-like-big ';\n$out+=$escape(isLike);\n$out+=' \"></em><span>';\n$out+=$escape(isLikeName);\n$out+='</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0006\"> <a href=\"javascript:void(0)\" data-node=\"collect\" data-status=\"';\n$out+=$escape(userCollectionStatu);\n$out+='\" class=\"';\n$out+=$escape(userCollection);\n$out+='\"> <em class=\"icon-collect-big ';\n$out+=$escape(userCollection);\n$out+='\" ></em><span>';\n$out+=$escape(userCollectionName);\n$out+='</span></a></li> <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0007\"><a data-action=\"goComment\" href=\"javascript:;\"><em class=\"icon-discuss-big\"></em><span>评论</span></a></li> ';\nif(mshopFlag == 1){\n$out+=' <li modelid=\"';\n$out+=$escape(jctjmodule);\n$out+='0008\"><a href=';\n$out+=$escape(mshopUrl);\n$out+=' target=\"_blank\"><em class=\"icon-meidian-big\"></em><span>美店</span></a></li> ';\n}\n$out+=' </ul> <div class=\"source-right-box\"> ';\n$out+=$string(html);\n$out+=' </div> </div> <div class=\"topic-operate\"> ';\nif(is_del){\n$out+=' <a data-node=\"userTopic-del\" href=\"javascript:;\" title=\"删除该话题\">删除</a> ';\n}\n$out+=' ';\nif(is_del && showReport){\n$out+=' <em class=\"line\"></em> ';\n}\n$out+=' ';\nif(showReport){\n$out+=' <a data-action=\"topic-report\" href=\"javascript:;\" title=\"举报该话题\">举报</a> ';\n}\n$out+=' </div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/title.tpl\n// module id = 263\n// module chunks = 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/comList',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htpllbmodule=$data.htpllbmodule,ggjzgdmodule=$data.ggjzgdmodule,imgPath=$data.imgPath,$out='';$out+='<div class=\"bjfff\" data-node =\"hidDiv\" data-ComTopicId=';\n$out+=$escape(id);\n$out+=' > <div class=\"circle-comments\" data-node=\"circleCom\" data-circleCom = ';\n$out+=$escape(id);\n$out+=' modelid=\"';\n$out+=$escape(htpllbmodule);\n$out+='\"> </div> <div class=\"more-comments\" data-node=\"loadlist\" style=\"display: none;\" modelid=\"';\n$out+=$escape(ggjzgdmodule);\n$out+='\"> <a href=\"##\" class=\"clearfix\"> <span> <img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/circle/small-logo.png\" >点击加载更多 <em class=\"icon icon-right\"></em> </span> </a> </div> <div class=\"more-comments\" data-node=\"loading\" style=\"display: none;\" > <a href=\"javascript:;\" class=\"disabled clearfix\"><span><img src=\"';\n$out+=$escape(imgPath);\n$out+='/images/public/loading.gif\">正在加载...</span></a> </div> <div class=\"more-comments\" data-node=\"noload\" style=\"display: none;\" > <a href=\"javascript:;\" class=\"disabled clearfix\"> <span>没有可加载内容</span> </a> </div> </div>';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/comList.tpl\n// module id = 264\n// module chunks = 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/commentBox',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,htcyplmodule=$data.htcyplmodule,isExpert=$data.isExpert,userImage=$data.userImage,id=$data.id,readyOnly=$data.readyOnly,isLoginClass=$data.isLoginClass,isLoginStr=$data.isLoginStr,allNum=$data.allNum,$out='';$out+='<div data-node=\"commentBox\" class=\"topic-review-box\" modelid=\"';\n$out+=$escape(htcyplmodule);\n$out+='\"> <h2 class=\"review-title\">参与评论</h2> <div class=\"bjfff margin-btom20\" data-node=\"comment_FirDiv\"> <div class=\"text-field-box clearfix\"> <div class=\"topic-user-head\"> ';\nif(isExpert){\n$out+=' <em class=\"icon-daren\"></em> ';\n}\n$out+=' <img src=\"';\n$out+=$escape(userImage);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"> </div> <div class=\"topic-publish-content\" data-node=\"comment_Msg\" data-nickname=\"\" data-tid=\"';\n$out+=$escape(id);\n$out+='\" data-userid=\"0\" data-headface=\"';\n$out+=$escape(userImage);\n$out+='\"> <textarea class=\"textarea-bx\" ';\n$out+=$escape(readyOnly);\n$out+=' placeholder=\"说点什么吧…\" style=\"background: rgb(255, 255, 255);\"></textarea> <label class=\"textarea-tips hide\" data-node=\"textareaTips\">说点什么吧…</label> <div data-node=\"addImgGoods\" data-imgNum =\"9\"> <ul data-node=\"imgUl\" class=\"clearfix hide\"></ul> </div> <div class=\"publish-face-bx\" data-publish=\"';\n$out+=$escape(id);\n$out+='\"> <p class=\"icon-face cursor-pointer\" data-node=\"smilies_Face\"><em class=\"icon-emoji\"></em>表情</p> <p class=\"icon-face cursor-pointer\" data-node=\"addImg_btn\"><em class=\"icon-picture\"></em>图片</p> <p class=\"icon-face cursor-pointer\" data-node=\"addGoods_btn\"><em class=\"icon-goods\"></em>商品</p> <a href=\"javascript:;\" class=\"pc-btn pc-btnh30 pc-btnw105 ';\n$out+=$escape(isLoginClass);\n$out+='\" data-node=\"a_Submit\">';\n$out+=$escape(isLoginStr);\n$out+='</a> </div> </div> </div> </div> </div> <div class=\"comment-title\" data-node=\"hidDiv\"> <div class=\"bd-bottom\"><span class=\"red\">';\n$out+=$escape(allNum);\n$out+='</span><span>条评论</span></div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/commentBox.tpl\n// module id = 265\n// module chunks = 30","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/topicAddMore/topicRight',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,id=$data.id,htqzxxmodule=$data.htqzxxmodule,$string=$utils.$string,topicRT=$data.topicRT,htrmhtmodule=$data.htrmhtmodule,hotTopicUl=$data.hotTopicUl,htxyymodule=$data.htxyymodule,$out='';$out+='<div class=\"topic-right topic-absolute\" data-topicRT= ';\n$out+=$escape(id);\n$out+='> <div class=\"topic-r-t\" modelid=\"';\n$out+=$escape(htqzxxmodule);\n$out+='\"> <!--modelid=\"';\n$out+=$escape(htqzxxmodule);\n$out+='\"--> ';\n$out+=$string(topicRT);\n$out+=' </div> <div class=\"topic-position\" data-node=\"topic_xi\"> <div class=\"topic-r-b\" data-node=\"hot_topics\"> <!--modelid=\"';\n$out+=$escape(htrmhtmodule);\n$out+='\"--> ';\n$out+=$string(hotTopicUl);\n$out+=' </div> <div class=\"next-page\" data-node=\"next-page\" data-get-next-topic =';\n$out+=$escape(id);\n$out+=' style=\"display: none\" modelid=\"';\n$out+=$escape(htxyymodule);\n$out+='\"> <p><span class=\"f12\" data-node=\"times\"></span>下一篇</p> <a></a> </div> </div> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/topicAddMore/topicRight.tpl\n// module id = 266\n// module chunks = 30","/**\n * History.js jQuery Adapter\n * @author Benjamin Arthur Lupton <contact@balupton.com>\n * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>\n * @license New BSD License <http://creativecommons.org/licenses/BSD/>\n */\n\n// Closure\n(function(window,undefined){\n\t\"use strict\";\n\n\t// Localise Globals\n\tvar\n\t\tHistory = window.History = window.History||{},\n\t\tjQuery = window.jQuery;\n\n\t// Check Existence\n\tif ( typeof History.Adapter !== 'undefined' ) {\n\t\tthrow new Error('History.js Adapter has already been loaded...');\n\t}\n\n\t// Add the Adapter\n\tHistory.Adapter = {\n\t\t/**\n\t\t * History.Adapter.bind(el,event,callback)\n\t\t * @param {Element|string} el\n\t\t * @param {string} event - custom and standard events\n\t\t * @param {function} callback\n\t\t * @return {void}\n\t\t */\n\t\tbind: function(el,event,callback){\n\t\t\tjQuery(el).bind(event,callback);\n\t\t},\n\n\t\t/**\n\t\t * History.Adapter.trigger(el,event)\n\t\t * @param {Element|string} el\n\t\t * @param {string} event - custom and standard events\n\t\t * @param {Object=} extra - a object of extra event data (optional)\n\t\t * @return {void}\n\t\t */\n\t\ttrigger: function(el,event,extra){\n\t\t\tjQuery(el).trigger(event,extra);\n\t\t},\n\n\t\t/**\n\t\t * History.Adapter.extractEventData(key,event,extra)\n\t\t * @param {string} key - key for the event data to extract\n\t\t * @param {string} event - custom and standard events\n\t\t * @param {Object=} extra - a object of extra event data (optional)\n\t\t * @return {mixed}\n\t\t */\n\t\textractEventData: function(key,event,extra){\n\t\t\t// jQuery Native then jQuery Custom\n\t\t\tvar result = (event && event.originalEvent && event.originalEvent[key]) || (extra && extra[key]) || undefined;\n\n\t\t\t// Return\n\t\t\treturn result;\n\t\t},\n\n\t\t/**\n\t\t * History.Adapter.onDomLoad(callback)\n\t\t * @param {function} callback\n\t\t * @return {void}\n\t\t */\n\t\tonDomLoad: function(callback) {\n\t\t\tjQuery(callback);\n\t\t}\n\t};\n\n\t// Try and Initialise History\n\tif ( typeof History.init !== 'undefined' ) {\n\t\tHistory.init();\n\t}\n\n})(window);\n\n/**\n * History.js Core\n * @author Benjamin Arthur Lupton <contact@balupton.com>\n * @copyright 2010-2011 Benjamin Arthur Lupton <contact@balupton.com>\n * @license New BSD License <http://creativecommons.org/licenses/BSD/>\n */\n\n(function(window,undefined){\n\t\"use strict\";\n\n\t// ========================================================================\n\t// Initialise\n\n\t// Localise Globals\n\tvar\n\t\tconsole = window.console||undefined, // Prevent a JSLint complain\n\t\tdocument = window.document, // Make sure we are using the correct document\n\t\tnavigator = window.navigator, // Make sure we are using the correct navigator\n\t\tsessionStorage = false, // sessionStorage\n\t\tsetTimeout = window.setTimeout,\n\t\tclearTimeout = window.clearTimeout,\n\t\tsetInterval = window.setInterval,\n\t\tclearInterval = window.clearInterval,\n\t\tJSON = window.JSON,\n\t\talert = window.alert,\n\t\tHistory = window.History = window.History||{}, // Public History Object\n\t\thistory = window.history; // Old History Object\n\n\ttry {\n\t\tsessionStorage = window.sessionStorage; // This will throw an exception in some browsers when cookies/localStorage are explicitly disabled (i.e. Chrome)\n\t\tsessionStorage.setItem('TEST', '1');\n\t\tsessionStorage.removeItem('TEST');\n\t} catch(e) {\n\t\tsessionStorage = false;\n\t}\n\n\t// MooTools Compatibility\n\tJSON.stringify = JSON.stringify||JSON.encode;\n\tJSON.parse = JSON.parse||JSON.decode;\n\n\t// Check Existence\n\tif ( typeof History.init !== 'undefined' ) {\n\t\tthrow new Error('History.js Core has already been loaded...');\n\t}\n\n\t// Initialise History\n\tHistory.init = function(options){\n\t\t// Check Load Status of Adapter\n\t\tif ( typeof History.Adapter === 'undefined' ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Check Load Status of Core\n\t\tif ( typeof History.initCore !== 'undefined' ) {\n\t\t\tHistory.initCore();\n\t\t}\n\n\t\t// Check Load Status of HTML4 Support\n\t\tif ( typeof History.initHtml4 !== 'undefined' ) {\n\t\t\tHistory.initHtml4();\n\t\t}\n\n\t\t// Return true\n\t\treturn true;\n\t};\n\n\n\t// ========================================================================\n\t// Initialise Core\n\n\t// Initialise Core\n\tHistory.initCore = function(options){\n\t\t// Initialise\n\t\tif ( typeof History.initCore.initialized !== 'undefined' ) {\n\t\t\t// Already Loaded\n\t\t\treturn false;\n\t\t}\n\t\telse {\n\t\t\tHistory.initCore.initialized = true;\n\t\t}\n\n\n\t\t// ====================================================================\n\t\t// Options\n\n\t\t/**\n\t\t * History.options\n\t\t * Configurable options\n\t\t */\n\t\tHistory.options = History.options||{};\n\n\t\t/**\n\t\t * History.options.hashChangeInterval\n\t\t * How long should the interval be before hashchange checks\n\t\t */\n\t\tHistory.options.hashChangeInterval = History.options.hashChangeInterval || 100;\n\n\t\t/**\n\t\t * History.options.safariPollInterval\n\t\t * How long should the interval be before safari poll checks\n\t\t */\n\t\tHistory.options.safariPollInterval = History.options.safariPollInterval || 500;\n\n\t\t/**\n\t\t * History.options.doubleCheckInterval\n\t\t * How long should the interval be before we perform a double check\n\t\t */\n\t\tHistory.options.doubleCheckInterval = History.options.doubleCheckInterval || 500;\n\n\t\t/**\n\t\t * History.options.disableSuid\n\t\t * Force History not to append suid\n\t\t */\n\t\tHistory.options.disableSuid = History.options.disableSuid || false;\n\n\t\t/**\n\t\t * History.options.storeInterval\n\t\t * How long should we wait between store calls\n\t\t */\n\t\tHistory.options.storeInterval = History.options.storeInterval || 1000;\n\n\t\t/**\n\t\t * History.options.busyDelay\n\t\t * How long should we wait between busy events\n\t\t */\n\t\tHistory.options.busyDelay = History.options.busyDelay || 250;\n\n\t\t/**\n\t\t * History.options.debug\n\t\t * If true will enable debug messages to be logged\n\t\t */\n\t\tHistory.options.debug = History.options.debug || false;\n\n\t\t/**\n\t\t * History.options.initialTitle\n\t\t * What is the title of the initial state\n\t\t */\n\t\tHistory.options.initialTitle = History.options.initialTitle || document.title;\n\n\t\t/**\n\t\t * History.options.html4Mode\n\t\t * If true, will force HTMl4 mode (hashtags)\n\t\t */\n\t\tHistory.options.html4Mode = History.options.html4Mode || false;\n\n\t\t/**\n\t\t * History.options.delayInit\n\t\t * Want to override default options and call init manually.\n\t\t */\n\t\tHistory.options.delayInit = History.options.delayInit || false;\n\n\n\t\t// ====================================================================\n\t\t// Interval record\n\n\t\t/**\n\t\t * History.intervalList\n\t\t * List of intervals set, to be cleared when document is unloaded.\n\t\t */\n\t\tHistory.intervalList = [];\n\n\t\t/**\n\t\t * History.clearAllIntervals\n\t\t * Clears all setInterval instances.\n\t\t */\n\t\tHistory.clearAllIntervals = function(){\n\t\t\tvar i, il = History.intervalList;\n\t\t\tif (typeof il !== \"undefined\" && il !== null) {\n\t\t\t\tfor (i = 0; i < il.length; i++) {\n\t\t\t\t\tclearInterval(il[i]);\n\t\t\t\t}\n\t\t\t\tHistory.intervalList = null;\n\t\t\t}\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Debug\n\n\t\t/**\n\t\t * History.debug(message,...)\n\t\t * Logs the passed arguments if debug enabled\n\t\t */\n\t\tHistory.debug = function(){\n\t\t\tif ( (History.options.debug||false) ) {\n\t\t\t\tHistory.log.apply(History,arguments);\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * History.log(message,...)\n\t\t * Logs the passed arguments\n\t\t */\n\t\tHistory.log = function(){\n\t\t\t// Prepare\n\t\t\tvar\n\t\t\t\tconsoleExists = !(typeof console === 'undefined' || typeof console.log === 'undefined' || typeof console.log.apply === 'undefined'),\n\t\t\t\ttextarea = document.getElementById('log'),\n\t\t\t\tmessage,\n\t\t\t\ti,n,\n\t\t\t\targs,arg\n\t\t\t\t;\n\n\t\t\t// Write to Console\n\t\t\tif ( consoleExists ) {\n\t\t\t\targs = Array.prototype.slice.call(arguments);\n\t\t\t\tmessage = args.shift();\n\t\t\t\tif ( typeof console.debug !== 'undefined' ) {\n\t\t\t\t\tconsole.debug.apply(console,[message,args]);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconsole.log.apply(console,[message,args]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmessage = (\"\\n\"+arguments[0]+\"\\n\");\n\t\t\t}\n\n\t\t\t// Write to log\n\t\t\tfor ( i=1,n=arguments.length; i<n; ++i ) {\n\t\t\t\targ = arguments[i];\n\t\t\t\tif ( typeof arg === 'object' && typeof JSON !== 'undefined' ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\targ = JSON.stringify(arg);\n\t\t\t\t\t}\n\t\t\t\t\tcatch ( Exception ) {\n\t\t\t\t\t\t// Recursive Object\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmessage += \"\\n\"+arg+\"\\n\";\n\t\t\t}\n\n\t\t\t// Textarea\n\t\t\tif ( textarea ) {\n\t\t\t\ttextarea.value += message+\"\\n-----\\n\";\n\t\t\t\ttextarea.scrollTop = textarea.scrollHeight - textarea.clientHeight;\n\t\t\t}\n\t\t\t// No Textarea, No Console\n\t\t\telse if ( !consoleExists ) {\n\t\t\t\talert(message);\n\t\t\t}\n\n\t\t\t// Return true\n\t\t\treturn true;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Emulated Status\n\n\t\t/**\n\t\t * History.getInternetExplorerMajorVersion()\n\t\t * Get's the major version of Internet Explorer\n\t\t * @return {integer}\n\t\t * @license Public Domain\n\t\t * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t\t * @author James Padolsey <https://gist.github.com/527683>\n\t\t */\n\t\tHistory.getInternetExplorerMajorVersion = function(){\n\t\t\tvar result = History.getInternetExplorerMajorVersion.cached =\n\t\t\t\t\t(typeof History.getInternetExplorerMajorVersion.cached !== 'undefined')\n\t\t\t\t?\tHistory.getInternetExplorerMajorVersion.cached\n\t\t\t\t:\t(function(){\n\t\t\t\t\t\tvar v = 3,\n\t\t\t\t\t\t\t\tdiv = document.createElement('div'),\n\t\t\t\t\t\t\t\tall = div.getElementsByTagName('i');\n\t\t\t\t\t\twhile ( (div.innerHTML = '<!--[if gt IE ' + (++v) + ']><i></i><![endif]-->') && all[0] ) {}\n\t\t\t\t\t\treturn (v > 4) ? v : false;\n\t\t\t\t\t})()\n\t\t\t\t;\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.isInternetExplorer()\n\t\t * Are we using Internet Explorer?\n\t\t * @return {boolean}\n\t\t * @license Public Domain\n\t\t * @author Benjamin Arthur Lupton <contact@balupton.com>\n\t\t */\n\t\tHistory.isInternetExplorer = function(){\n\t\t\tvar result =\n\t\t\t\tHistory.isInternetExplorer.cached =\n\t\t\t\t(typeof History.isInternetExplorer.cached !== 'undefined')\n\t\t\t\t\t?\tHistory.isInternetExplorer.cached\n\t\t\t\t\t:\tBoolean(History.getInternetExplorerMajorVersion())\n\t\t\t\t;\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.emulated\n\t\t * Which features require emulating?\n\t\t */\n\n\t\tif (History.options.html4Mode) {\n\t\t\tconsole.log(1)\n\t\t\tHistory.emulated = {\n\t\t\t\tpushState : true,\n\t\t\t\thashChange: true\n\t\t\t};\n\t\t}\n\n\t\telse {\n\t\t\tHistory.emulated = {\n\t\t\t\tpushState: /trident\\/7.0/i.test(navigator.userAgent),\n\t\t\t\thashChange: History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * History.enabled\n\t\t * Is History enabled?\n\t\t */\n\t\tHistory.enabled = !History.emulated.pushState;\n\n\t\t/**\n\t\t * History.bugs\n\t\t * Which bugs are present\n\t\t */\n\t\tHistory.bugs = {\n\t\t\t/**\n\t\t\t * Safari 5 and Safari iOS 4 fail to return to the correct state once a hash is replaced by a `replaceState` call\n\t\t\t * https://bugs.webkit.org/show_bug.cgi?id=56249\n\t\t\t */\n\t\t\tsetHash: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\n\t\t\t/**\n\t\t\t * Safari 5 and Safari iOS 4 sometimes fail to apply the state change under busy conditions\n\t\t\t * https://bugs.webkit.org/show_bug.cgi?id=42940\n\t\t\t */\n\t\t\tsafariPoll: Boolean(!History.emulated.pushState && navigator.vendor === 'Apple Computer, Inc.' && /AppleWebKit\\/5([0-2]|3[0-3])/.test(navigator.userAgent)),\n\n\t\t\t/**\n\t\t\t * MSIE 6 and 7 sometimes do not apply a hash even it was told to (requiring a second call to the apply function)\n\t\t\t */\n\t\t\tieDoubleCheck: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 8),\n\n\t\t\t/**\n\t\t\t * MSIE 6 requires the entire hash to be encoded for the hashes to trigger the onHashChange event\n\t\t\t */\n\t\t\thashEscape: Boolean(History.isInternetExplorer() && History.getInternetExplorerMajorVersion() < 7)\n\t\t};\n\n\t\t/**\n\t\t * History.isEmptyObject(obj)\n\t\t * Checks to see if the Object is Empty\n\t\t * @param {Object} obj\n\t\t * @return {boolean}\n\t\t */\n\t\tHistory.isEmptyObject = function(obj) {\n\t\t\tfor ( var name in obj ) {\n\t\t\t\tif ( obj.hasOwnProperty(name) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.cloneObject(obj)\n\t\t * Clones a object and eliminate all references to the original contexts\n\t\t * @param {Object} obj\n\t\t * @return {Object}\n\t\t */\n\t\tHistory.cloneObject = function(obj) {\n\t\t\tvar hash,newObj;\n\t\t\tif ( obj ) {\n\t\t\t\thash = JSON.stringify(obj);\n\t\t\t\tnewObj = JSON.parse(hash);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tnewObj = {};\n\t\t\t}\n\t\t\treturn newObj;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// URL Helpers\n\n\t\t/**\n\t\t * History.getRootUrl()\n\t\t * Turns \"http://mysite.com/dir/page.html?asd\" into \"http://mysite.com\"\n\t\t * @return {String} rootUrl\n\t\t */\n\t\tHistory.getRootUrl = function(){\n\t\t\t// Create\n\t\t\tvar rootUrl = document.location.protocol+'//'+(document.location.hostname||document.location.host);\n\t\t\tif ( document.location.port||false ) {\n\t\t\t\trootUrl += ':'+document.location.port;\n\t\t\t}\n\t\t\trootUrl += '/';\n\n\t\t\t// Return\n\t\t\treturn rootUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getBaseHref()\n\t\t * Fetches the `href` attribute of the `<base href=\"...\">` element if it exists\n\t\t * @return {String} baseHref\n\t\t */\n\t\tHistory.getBaseHref = function(){\n\t\t\t// Create\n\t\t\tvar\n\t\t\t\tbaseElements = document.getElementsByTagName('base'),\n\t\t\t\tbaseElement = null,\n\t\t\t\tbaseHref = '';\n\n\t\t\t// Test for Base Element\n\t\t\tif ( baseElements.length === 1 ) {\n\t\t\t\t// Prepare for Base Element\n\t\t\t\tbaseElement = baseElements[0];\n\t\t\t\tbaseHref = baseElement.href.replace(/[^\\/]+$/,'');\n\t\t\t}\n\n\t\t\t// Adjust trailing slash\n\t\t\tbaseHref = baseHref.replace(/\\/+$/,'');\n\t\t\tif ( baseHref ) baseHref += '/';\n\n\t\t\t// Return\n\t\t\treturn baseHref;\n\t\t};\n\n\t\t/**\n\t\t * History.getBaseUrl()\n\t\t * Fetches the baseHref or basePageUrl or rootUrl (whichever one exists first)\n\t\t * @return {String} baseUrl\n\t\t */\n\t\tHistory.getBaseUrl = function(){\n\t\t\t// Create\n\t\t\tvar baseUrl = History.getBaseHref()||History.getBasePageUrl()||History.getRootUrl();\n\n\t\t\t// Return\n\t\t\treturn baseUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getPageUrl()\n\t\t * Fetches the URL of the current page\n\t\t * @return {String} pageUrl\n\t\t */\n\t\tHistory.getPageUrl = function(){\n\t\t\t// Fetch\n\t\t\tvar\n\t\t\t\tState = History.getState(false,false),\n\t\t\t\tstateUrl = (State||{}).url||History.getLocationHref(),\n\t\t\t\tpageUrl;\n\n\t\t\t// Create\n\t\t\tpageUrl = stateUrl.replace(/\\/+$/,'').replace(/[^\\/]+$/,function(part,index,string){\n\t\t\t\treturn (/\\./).test(part) ? part : part+'/';\n\t\t\t});\n\n\t\t\t// Return\n\t\t\treturn pageUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getBasePageUrl()\n\t\t * Fetches the Url of the directory of the current page\n\t\t * @return {String} basePageUrl\n\t\t */\n\t\tHistory.getBasePageUrl = function(){\n\t\t\t// Create\n\t\t\tvar basePageUrl = (History.getLocationHref()).replace(/[#\\?].*/,'').replace(/[^\\/]+$/,function(part,index,string){\n\t\t\t\treturn (/[^\\/]$/).test(part) ? '' : part;\n\t\t\t}).replace(/\\/+$/,'')+'/';\n\n\t\t\t// Return\n\t\t\treturn basePageUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getFullUrl(url)\n\t\t * Ensures that we have an absolute URL and not a relative URL\n\t\t * @param {string} url\n\t\t * @param {Boolean} allowBaseHref\n\t\t * @return {string} fullUrl\n\t\t */\n\t\tHistory.getFullUrl = function(url,allowBaseHref){\n\t\t\t// Prepare\n\t\t\tvar fullUrl = url, firstChar = url.substring(0,1);\n\t\t\tallowBaseHref = (typeof allowBaseHref === 'undefined') ? true : allowBaseHref;\n\n\t\t\t// Check\n\t\t\tif ( /[a-z]+\\:\\/\\//.test(url) ) {\n\t\t\t\t// Full URL\n\t\t\t}\n\t\t\telse if ( firstChar === '/' ) {\n\t\t\t\t// Root URL\n\t\t\t\tfullUrl = History.getRootUrl()+url.replace(/^\\/+/,'');\n\t\t\t}\n\t\t\telse if ( firstChar === '#' ) {\n\t\t\t\t// Anchor URL\n\t\t\t\tfullUrl = History.getPageUrl().replace(/#.*/,'')+url;\n\t\t\t}\n\t\t\telse if ( firstChar === '?' ) {\n\t\t\t\t// Query URL\n\t\t\t\tfullUrl = History.getPageUrl().replace(/[\\?#].*/,'')+url;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Relative URL\n\t\t\t\tif ( allowBaseHref ) {\n\t\t\t\t\tfullUrl = History.getBaseUrl()+url.replace(/^(\\.\\/)+/,'');\n\t\t\t\t} else {\n\t\t\t\t\tfullUrl = History.getBasePageUrl()+url.replace(/^(\\.\\/)+/,'');\n\t\t\t\t}\n\t\t\t\t// We have an if condition above as we do not want hashes\n\t\t\t\t// which are relative to the baseHref in our URLs\n\t\t\t\t// as if the baseHref changes, then all our bookmarks\n\t\t\t\t// would now point to different locations\n\t\t\t\t// whereas the basePageUrl will always stay the same\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn fullUrl.replace(/\\#$/,'');\n\t\t};\n\n\t\t/**\n\t\t * History.getShortUrl(url)\n\t\t * Ensures that we have a relative URL and not a absolute URL\n\t\t * @param {string} url\n\t\t * @return {string} url\n\t\t */\n\t\tHistory.getShortUrl = function(url){\n\t\t\t// Prepare\n\t\t\tvar shortUrl = url, baseUrl = History.getBaseUrl(), rootUrl = History.getRootUrl();\n\n\t\t\t// Trim baseUrl\n\t\t\tif ( History.emulated.pushState ) {\n\t\t\t\t// We are in a if statement as when pushState is not emulated\n\t\t\t\t// The actual url these short urls are relative to can change\n\t\t\t\t// So within the same session, we the url may end up somewhere different\n\t\t\t\tshortUrl = shortUrl.replace(baseUrl,'');\n\t\t\t}\n\n\t\t\t// Trim rootUrl\n\t\t\tshortUrl = shortUrl.replace(rootUrl,'/');\n\n\t\t\t// Ensure we can still detect it as a state\n\t\t\tif ( History.isTraditionalAnchor(shortUrl) ) {\n\t\t\t\tshortUrl = './'+shortUrl;\n\t\t\t}\n\n\t\t\t// Clean It\n\t\t\tshortUrl = shortUrl.replace(/^(\\.\\/)+/g,'./').replace(/\\#$/,'');\n\n\t\t\t// Return\n\t\t\treturn shortUrl;\n\t\t};\n\n\t\t/**\n\t\t * History.getLocationHref(document)\n\t\t * Returns a normalized version of document.location.href\n\t\t * accounting for browser inconsistencies, etc.\n\t\t *\n\t\t * This URL will be URI-encoded and will include the hash\n\t\t *\n\t\t * @param {object} document\n\t\t * @return {string} url\n\t\t */\n\t\tHistory.getLocationHref = function(doc) {\n\t\t\tdoc = doc || document;\n\n\t\t\t// most of the time, this will be true\n\t\t\tif (doc.URL === doc.location.href)\n\t\t\t\treturn doc.location.href;\n\n\t\t\t// some versions of webkit URI-decode document.location.href\n\t\t\t// but they leave document.URL in an encoded state\n\t\t\tif (doc.location.href === decodeURIComponent(doc.URL))\n\t\t\t\treturn doc.URL;\n\n\t\t\t// FF 3.6 only updates document.URL when a page is reloaded\n\t\t\t// document.location.href is updated correctly\n\t\t\tif (doc.location.hash && decodeURIComponent(doc.location.href.replace(/^[^#]+/, \"\")) === doc.location.hash)\n\t\t\t\treturn doc.location.href;\n\n\t\t\tif (doc.URL.indexOf('#') == -1 && doc.location.href.indexOf('#') != -1)\n\t\t\t\treturn doc.location.href;\n\n\t\t\treturn doc.URL || doc.location.href;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// State Storage\n\n\t\t/**\n\t\t * History.store\n\t\t * The store for all session specific data\n\t\t */\n\t\tHistory.store = {};\n\n\t\t/**\n\t\t * History.idToState\n\t\t * 1-1: State ID to State Object\n\t\t */\n\t\tHistory.idToState = History.idToState||{};\n\n\t\t/**\n\t\t * History.stateToId\n\t\t * 1-1: State String to State ID\n\t\t */\n\t\tHistory.stateToId = History.stateToId||{};\n\n\t\t/**\n\t\t * History.urlToId\n\t\t * 1-1: State URL to State ID\n\t\t */\n\t\tHistory.urlToId = History.urlToId||{};\n\n\t\t/**\n\t\t * History.storedStates\n\t\t * Store the states in an array\n\t\t */\n\t\tHistory.storedStates = History.storedStates||[];\n\n\t\t/**\n\t\t * History.savedStates\n\t\t * Saved the states in an array\n\t\t */\n\t\tHistory.savedStates = History.savedStates||[];\n\n\t\t/**\n\t\t * History.noramlizeStore()\n\t\t * Noramlize the store by adding necessary values\n\t\t */\n\t\tHistory.normalizeStore = function(){\n\t\t\tHistory.store.idToState = History.store.idToState||{};\n\t\t\tHistory.store.urlToId = History.store.urlToId||{};\n\t\t\tHistory.store.stateToId = History.store.stateToId||{};\n\t\t};\n\n\t\t/**\n\t\t * History.getState()\n\t\t * Get an object containing the data, title and url of the current state\n\t\t * @param {Boolean} friendly\n\t\t * @param {Boolean} create\n\t\t * @return {Object} State\n\t\t */\n\t\tHistory.getState = function(friendly,create){\n\t\t\t// Prepare\n\t\t\tif ( typeof friendly === 'undefined' ) { friendly = true; }\n\t\t\tif ( typeof create === 'undefined' ) { create = true; }\n\n\t\t\t// Fetch\n\t\t\tvar State = History.getLastSavedState();\n\n\t\t\t// Create\n\t\t\tif ( !State && create ) {\n\t\t\t\tState = History.createStateObject();\n\t\t\t}\n\n\t\t\t// Adjust\n\t\t\tif ( friendly ) {\n\t\t\t\tState = History.cloneObject(State);\n\t\t\t\tState.url = State.cleanUrl||State.url;\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getIdByState(State)\n\t\t * Gets a ID for a State\n\t\t * @param {State} newState\n\t\t * @return {String} id\n\t\t */\n\t\tHistory.getIdByState = function(newState){\n\n\t\t\t// Fetch ID\n\t\t\tvar id = History.extractId(newState.url),\n\t\t\t\tstr;\n\n\t\t\tif ( !id ) {\n\t\t\t\t// Find ID via State String\n\t\t\t\tstr = History.getStateString(newState);\n\t\t\t\tif ( typeof History.stateToId[str] !== 'undefined' ) {\n\t\t\t\t\tid = History.stateToId[str];\n\t\t\t\t}\n\t\t\t\telse if ( typeof History.store.stateToId[str] !== 'undefined' ) {\n\t\t\t\t\tid = History.store.stateToId[str];\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Generate a new ID\n\t\t\t\t\twhile ( true ) {\n\t\t\t\t\t\tid = (new Date()).getTime() + String(Math.random()).replace(/\\D/g,'');\n\t\t\t\t\t\tif ( typeof History.idToState[id] === 'undefined' && typeof History.store.idToState[id] === 'undefined' ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Apply the new State to the ID\n\t\t\t\t\tHistory.stateToId[str] = id;\n\t\t\t\t\tHistory.idToState[id] = newState;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Return ID\n\t\t\treturn id;\n\t\t};\n\n\t\t/**\n\t\t * History.normalizeState(State)\n\t\t * Expands a State Object\n\t\t * @param {object} State\n\t\t * @return {object}\n\t\t */\n\t\tHistory.normalizeState = function(oldState){\n\t\t\t// Variables\n\t\t\tvar newState, dataNotEmpty;\n\n\t\t\t// Prepare\n\t\t\tif ( !oldState || (typeof oldState !== 'object') ) {\n\t\t\t\toldState = {};\n\t\t\t}\n\n\t\t\t// Check\n\t\t\tif ( typeof oldState.normalized !== 'undefined' ) {\n\t\t\t\treturn oldState;\n\t\t\t}\n\n\t\t\t// Adjust\n\t\t\tif ( !oldState.data || (typeof oldState.data !== 'object') ) {\n\t\t\t\toldState.data = {};\n\t\t\t}\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Create\n\t\t\tnewState = {};\n\t\t\tnewState.normalized = true;\n\t\t\tnewState.title = oldState.title||'';\n\t\t\tnewState.url = History.getFullUrl(oldState.url?oldState.url:(History.getLocationHref()));\n\t\t\tnewState.hash = History.getShortUrl(newState.url);\n\t\t\tnewState.data = History.cloneObject(oldState.data);\n\n\t\t\t// Fetch ID\n\t\t\tnewState.id = History.getIdByState(newState);\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Clean the URL\n\t\t\tnewState.cleanUrl = newState.url.replace(/\\??\\&_suid.*/,'');\n\t\t\tnewState.url = newState.cleanUrl;\n\n\t\t\t// Check to see if we have more than just a url\n\t\t\tdataNotEmpty = !History.isEmptyObject(newState.data);\n\n\t\t\t// Apply\n\t\t\tif ( (newState.title || dataNotEmpty) && History.options.disableSuid !== true ) {\n\t\t\t\t// Add ID to Hash\n\t\t\t\tnewState.hash = History.getShortUrl(newState.url).replace(/\\??\\&_suid.*/,'');\n\t\t\t\tif ( !/\\?/.test(newState.hash) ) {\n\t\t\t\t\tnewState.hash += '?';\n\t\t\t\t}\n\t\t\t\tnewState.hash += '&_suid='+newState.id;\n\t\t\t}\n\n\t\t\t// Create the Hashed URL\n\t\t\tnewState.hashedUrl = History.getFullUrl(newState.hash);\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Update the URL if we have a duplicate\n\t\t\tif ( (History.emulated.pushState || History.bugs.safariPoll) && History.hasUrlDuplicate(newState) ) {\n\t\t\t\tnewState.url = newState.hashedUrl;\n\t\t\t}\n\n\t\t\t// ----------------------------------------------------------------\n\n\t\t\t// Return\n\t\t\treturn newState;\n\t\t};\n\n\t\t/**\n\t\t * History.createStateObject(data,title,url)\n\t\t * Creates a object based on the data, title and url state params\n\t\t * @param {object} data\n\t\t * @param {string} title\n\t\t * @param {string} url\n\t\t * @return {object}\n\t\t */\n\t\tHistory.createStateObject = function(data,title,url){\n\t\t\t// Hashify\n\t\t\tvar State = {\n\t\t\t\t'data': data,\n\t\t\t\t'title': title,\n\t\t\t\t'url': url\n\t\t\t};\n\n\t\t\t// Expand the State\n\t\t\tState = History.normalizeState(State);\n\n\t\t\t// Return object\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getStateById(id)\n\t\t * Get a state by it's UID\n\t\t * @param {String} id\n\t\t */\n\t\tHistory.getStateById = function(id){\n\t\t\t// Prepare\n\t\t\tid = String(id);\n\n\t\t\t// Retrieve\n\t\t\tvar State = History.idToState[id] || History.store.idToState[id] || undefined;\n\n\t\t\t// Return State\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * Get a State's String\n\t\t * @param {State} passedState\n\t\t */\n\t\tHistory.getStateString = function(passedState){\n\t\t\t// Prepare\n\t\t\tvar State, cleanedState, str;\n\n\t\t\t// Fetch\n\t\t\tState = History.normalizeState(passedState);\n\n\t\t\t// Clean\n\t\t\tcleanedState = {\n\t\t\t\tdata: State.data,\n\t\t\t\ttitle: passedState.title,\n\t\t\t\turl: passedState.url\n\t\t\t};\n\n\t\t\t// Fetch\n\t\t\tstr = JSON.stringify(cleanedState);\n\n\t\t\t// Return\n\t\t\treturn str;\n\t\t};\n\n\t\t/**\n\t\t * Get a State's ID\n\t\t * @param {State} passedState\n\t\t * @return {String} id\n\t\t */\n\t\tHistory.getStateId = function(passedState){\n\t\t\t// Prepare\n\t\t\tvar State, id;\n\n\t\t\t// Fetch\n\t\t\tState = History.normalizeState(passedState);\n\n\t\t\t// Fetch\n\t\t\tid = State.id;\n\n\t\t\t// Return\n\t\t\treturn id;\n\t\t};\n\n\t\t/**\n\t\t * History.getHashByState(State)\n\t\t * Creates a Hash for the State Object\n\t\t * @param {State} passedState\n\t\t * @return {String} hash\n\t\t */\n\t\tHistory.getHashByState = function(passedState){\n\t\t\t// Prepare\n\t\t\tvar State, hash;\n\n\t\t\t// Fetch\n\t\t\tState = History.normalizeState(passedState);\n\n\t\t\t// Hash\n\t\t\thash = State.hash;\n\n\t\t\t// Return\n\t\t\treturn hash;\n\t\t};\n\n\t\t/**\n\t\t * History.extractId(url_or_hash)\n\t\t * Get a State ID by it's URL or Hash\n\t\t * @param {string} url_or_hash\n\t\t * @return {string} id\n\t\t */\n\t\tHistory.extractId = function ( url_or_hash ) {\n\t\t\t// Prepare\n\t\t\tvar id,parts,url, tmp;\n\n\t\t\t// Extract\n\n\t\t\t// If the URL has a #, use the id from before the #\n\t\t\tif (url_or_hash.indexOf('#') != -1)\n\t\t\t{\n\t\t\t\ttmp = url_or_hash.split(\"#\")[0];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ttmp = url_or_hash;\n\t\t\t}\n\n\t\t\tparts = /(.*)\\&_suid=([0-9]+)$/.exec(tmp);\n\t\t\turl = parts ? (parts[1]||url_or_hash) : url_or_hash;\n\t\t\tid = parts ? String(parts[2]||'') : '';\n\n\t\t\t// Return\n\t\t\treturn id||false;\n\t\t};\n\n\t\t/**\n\t\t * History.isTraditionalAnchor\n\t\t * Checks to see if the url is a traditional anchor or not\n\t\t * @param {String} url_or_hash\n\t\t * @return {Boolean}\n\t\t */\n\t\tHistory.isTraditionalAnchor = function(url_or_hash){\n\t\t\t// Check\n\t\t\tvar isTraditional = !(/[\\/\\?\\.]/.test(url_or_hash));\n\n\t\t\t// Return\n\t\t\treturn isTraditional;\n\t\t};\n\n\t\t/**\n\t\t * History.extractState\n\t\t * Get a State by it's URL or Hash\n\t\t * @param {String} url_or_hash\n\t\t * @return {State|null}\n\t\t */\n\t\tHistory.extractState = function(url_or_hash,create){\n\t\t\t// Prepare\n\t\t\tvar State = null, id, url;\n\t\t\tcreate = create||false;\n\n\t\t\t// Fetch SUID\n\t\t\tid = History.extractId(url_or_hash);\n\t\t\tif ( id ) {\n\t\t\t\tState = History.getStateById(id);\n\t\t\t}\n\n\t\t\t// Fetch SUID returned no State\n\t\t\tif ( !State ) {\n\t\t\t\t// Fetch URL\n\t\t\t\turl = History.getFullUrl(url_or_hash);\n\n\t\t\t\t// Check URL\n\t\t\t\tid = History.getIdByUrl(url)||false;\n\t\t\t\tif ( id ) {\n\t\t\t\t\tState = History.getStateById(id);\n\t\t\t\t}\n\n\t\t\t\t// Create State\n\t\t\t\tif ( !State && create && !History.isTraditionalAnchor(url_or_hash) ) {\n\t\t\t\t\tState = History.createStateObject(null,null,url);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getIdByUrl()\n\t\t * Get a State ID by a State URL\n\t\t */\n\t\tHistory.getIdByUrl = function(url){\n\t\t\t// Fetch\n\t\t\tvar id = History.urlToId[url] || History.store.urlToId[url] || undefined;\n\n\t\t\t// Return\n\t\t\treturn id;\n\t\t};\n\n\t\t/**\n\t\t * History.getLastSavedState()\n\t\t * Get an object containing the data, title and url of the current state\n\t\t * @return {Object} State\n\t\t */\n\t\tHistory.getLastSavedState = function(){\n\t\t\treturn History.savedStates[History.savedStates.length-1]||undefined;\n\t\t};\n\n\t\t/**\n\t\t * History.getLastStoredState()\n\t\t * Get an object containing the data, title and url of the current state\n\t\t * @return {Object} State\n\t\t */\n\t\tHistory.getLastStoredState = function(){\n\t\t\treturn History.storedStates[History.storedStates.length-1]||undefined;\n\t\t};\n\n\t\t/**\n\t\t * History.hasUrlDuplicate\n\t\t * Checks if a Url will have a url conflict\n\t\t * @param {Object} newState\n\t\t * @return {Boolean} hasDuplicate\n\t\t */\n\t\tHistory.hasUrlDuplicate = function(newState) {\n\t\t\t// Prepare\n\t\t\tvar hasDuplicate = false,\n\t\t\t\toldState;\n\n\t\t\t// Fetch\n\t\t\toldState = History.extractState(newState.url);\n\n\t\t\t// Check\n\t\t\thasDuplicate = oldState && oldState.id !== newState.id;\n\n\t\t\t// Return\n\t\t\treturn hasDuplicate;\n\t\t};\n\n\t\t/**\n\t\t * History.storeState\n\t\t * Store a State\n\t\t * @param {Object} newState\n\t\t * @return {Object} newState\n\t\t */\n\t\tHistory.storeState = function(newState){\n\t\t\t// Store the State\n\t\t\tHistory.urlToId[newState.url] = newState.id;\n\n\t\t\t// Push the State\n\t\t\tHistory.storedStates.push(History.cloneObject(newState));\n\n\t\t\t// Return newState\n\t\t\treturn newState;\n\t\t};\n\n\t\t/**\n\t\t * History.isLastSavedState(newState)\n\t\t * Tests to see if the state is the last state\n\t\t * @param {Object} newState\n\t\t * @return {boolean} isLast\n\t\t */\n\t\tHistory.isLastSavedState = function(newState){\n\t\t\t// Prepare\n\t\t\tvar isLast = false,\n\t\t\t\tnewId, oldState, oldId;\n\n\t\t\t// Check\n\t\t\tif ( History.savedStates.length ) {\n\t\t\t\tnewId = newState.id;\n\t\t\t\toldState = History.getLastSavedState();\n\t\t\t\toldId = oldState.id;\n\n\t\t\t\t// Check\n\t\t\t\tisLast = (newId === oldId);\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn isLast;\n\t\t};\n\n\t\t/**\n\t\t * History.saveState\n\t\t * Push a State\n\t\t * @param {Object} newState\n\t\t * @return {boolean} changed\n\t\t */\n\t\tHistory.saveState = function(newState){\n\t\t\t// Check Hash\n\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Push the State\n\t\t\tHistory.savedStates.push(History.cloneObject(newState));\n\n\t\t\t// Return true\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.getStateByIndex()\n\t\t * Gets a state by the index\n\t\t * @param {integer} index\n\t\t * @return {Object}\n\t\t */\n\t\tHistory.getStateByIndex = function(index){\n\t\t\t// Prepare\n\t\t\tvar State = null;\n\n\t\t\t// Handle\n\t\t\tif ( typeof index === 'undefined' ) {\n\t\t\t\t// Get the last inserted\n\t\t\t\tState = History.savedStates[History.savedStates.length-1];\n\t\t\t}\n\t\t\telse if ( index < 0 ) {\n\t\t\t\t// Get from the end\n\t\t\t\tState = History.savedStates[History.savedStates.length+index];\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Get from the beginning\n\t\t\t\tState = History.savedStates[index];\n\t\t\t}\n\n\t\t\t// Return State\n\t\t\treturn State;\n\t\t};\n\n\t\t/**\n\t\t * History.getCurrentIndex()\n\t\t * Gets the current index\n\t\t * @return (integer)\n\t\t*/\n\t\tHistory.getCurrentIndex = function(){\n\t\t\t// Prepare\n\t\t\tvar index = null;\n\n\t\t\t// No states saved\n\t\t\tif(History.savedStates.length < 1) {\n\t\t\t\tindex = 0;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tindex = History.savedStates.length-1;\n\t\t\t}\n\t\t\treturn index;\n\t\t};\n\n\t\t// ====================================================================\n\t\t// Hash Helpers\n\n\t\t/**\n\t\t * History.getHash()\n\t\t * @param {Location=} location\n\t\t * Gets the current document hash\n\t\t * Note: unlike location.hash, this is guaranteed to return the escaped hash in all browsers\n\t\t * @return {string}\n\t\t */\n\t\tHistory.getHash = function(doc){\n\t\t\tvar url = History.getLocationHref(doc),\n\t\t\t\thash;\n\t\t\thash = History.getHashByUrl(url);\n\t\t\treturn hash;\n\t\t};\n\n\t\t/**\n\t\t * History.unescapeHash()\n\t\t * normalize and Unescape a Hash\n\t\t * @param {String} hash\n\t\t * @return {string}\n\t\t */\n\t\tHistory.unescapeHash = function(hash){\n\t\t\t// Prepare\n\t\t\tvar result = History.normalizeHash(hash);\n\n\t\t\t// Unescape hash\n\t\t\tresult = decodeURIComponent(result);\n\n\t\t\t// Return result\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.normalizeHash()\n\t\t * normalize a hash across browsers\n\t\t * @return {string}\n\t\t */\n\t\tHistory.normalizeHash = function(hash){\n\t\t\t// Prepare\n\t\t\tvar result = hash.replace(/[^#]*#/,'').replace(/#.*/, '');\n\n\t\t\t// Return result\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.setHash(hash)\n\t\t * Sets the document hash\n\t\t * @param {string} hash\n\t\t * @return {History}\n\t\t */\n\t\tHistory.setHash = function(hash,queue){\n\t\t\t// Prepare\n\t\t\tvar State, pageUrl;\n\n\t\t\t// Handle Queueing\n\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t// Wait + Push to Queue\n\t\t\t\t//History.debug('History.setHash: we must wait', arguments);\n\t\t\t\tHistory.pushQueue({\n\t\t\t\t\tscope: History,\n\t\t\t\t\tcallback: History.setHash,\n\t\t\t\t\targs: arguments,\n\t\t\t\t\tqueue: queue\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Log\n\t\t\t//History.debug('History.setHash: called',hash);\n\n\t\t\t// Make Busy + Continue\n\t\t\tHistory.busy(true);\n\n\t\t\t// Check if hash is a state\n\t\t\tState = History.extractState(hash,true);\n\t\t\tif ( State && !History.emulated.pushState ) {\n\t\t\t\t// Hash is a state so skip the setHash\n\t\t\t\t//History.debug('History.setHash: Hash is a state so skipping the hash set with a direct pushState call',arguments);\n\n\t\t\t\t// PushState\n\t\t\t\tHistory.pushState(State.data,State.title,State.url,false);\n\t\t\t}\n\t\t\telse if ( History.getHash() !== hash ) {\n\t\t\t\t// Hash is a proper hash, so apply it\n\n\t\t\t\t// Handle browser bugs\n\t\t\t\tif ( History.bugs.setHash ) {\n\t\t\t\t\t// Fix Safari Bug https://bugs.webkit.org/show_bug.cgi?id=56249\n\n\t\t\t\t\t// Fetch the base page\n\t\t\t\t\tpageUrl = History.getPageUrl();\n\n\t\t\t\t\t// Safari hash apply\n\t\t\t\t\tHistory.pushState(null,null,pageUrl+'#'+hash,false);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Normal hash apply\n\t\t\t\t\tdocument.location.hash = hash;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.escape()\n\t\t * normalize and Escape a Hash\n\t\t * @return {string}\n\t\t */\n\t\tHistory.escapeHash = function(hash){\n\t\t\t// Prepare\n\t\t\tvar result = History.normalizeHash(hash);\n\n\t\t\t// Escape hash\n\t\t\tresult = window.encodeURIComponent(result);\n\n\t\t\t// IE6 Escape Bug\n\t\t\tif ( !History.bugs.hashEscape ) {\n\t\t\t\t// Restore common parts\n\t\t\t\tresult = result\n\t\t\t\t\t.replace(/\\%21/g,'!')\n\t\t\t\t\t.replace(/\\%26/g,'&')\n\t\t\t\t\t.replace(/\\%3D/g,'=')\n\t\t\t\t\t.replace(/\\%3F/g,'?');\n\t\t\t}\n\n\t\t\t// Return result\n\t\t\treturn result;\n\t\t};\n\n\t\t/**\n\t\t * History.getHashByUrl(url)\n\t\t * Extracts the Hash from a URL\n\t\t * @param {string} url\n\t\t * @return {string} url\n\t\t */\n\t\tHistory.getHashByUrl = function(url){\n\t\t\t// Extract the hash\n\t\t\tvar hash = String(url)\n\t\t\t\t.replace(/([^#]*)#?([^#]*)#?(.*)/, '$2')\n\t\t\t\t;\n\n\t\t\t// Unescape hash\n\t\t\thash = History.unescapeHash(hash);\n\n\t\t\t// Return hash\n\t\t\treturn hash;\n\t\t};\n\n\t\t/**\n\t\t * History.setTitle(title)\n\t\t * Applies the title to the document\n\t\t * @param {State} newState\n\t\t * @return {Boolean}\n\t\t */\n\t\tHistory.setTitle = function(newState){\n\t\t\t// Prepare\n\t\t\tvar title = newState.title,\n\t\t\t\tfirstState;\n\n\t\t\t// Initial\n\t\t\tif ( !title ) {\n\t\t\t\tfirstState = History.getStateByIndex(0);\n\t\t\t\tif ( firstState && firstState.url === newState.url ) {\n\t\t\t\t\ttitle = firstState.title||History.options.initialTitle;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply\n\t\t\ttry {\n\t\t\t\tdocument.getElementsByTagName('title')[0].innerHTML = title.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ');\n\t\t\t}\n\t\t\tcatch ( Exception ) { }\n\t\t\tdocument.title = title;\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Queueing\n\n\t\t/**\n\t\t * History.queues\n\t\t * The list of queues to use\n\t\t * First In, First Out\n\t\t */\n\t\tHistory.queues = [];\n\n\t\t/**\n\t\t * History.busy(value)\n\t\t * @param {boolean} value [optional]\n\t\t * @return {boolean} busy\n\t\t */\n\t\tHistory.busy = function(value){\n\t\t\t// Apply\n\t\t\tif ( typeof value !== 'undefined' ) {\n\t\t\t\t//History.debug('History.busy: changing ['+(History.busy.flag||false)+'] to ['+(value||false)+']', History.queues.length);\n\t\t\t\tHistory.busy.flag = value;\n\t\t\t}\n\t\t\t// Default\n\t\t\telse if ( typeof History.busy.flag === 'undefined' ) {\n\t\t\t\tHistory.busy.flag = false;\n\t\t\t}\n\n\t\t\t// Queue\n\t\t\tif ( !History.busy.flag ) {\n\t\t\t\t// Execute the next item in the queue\n\t\t\t\tclearTimeout(History.busy.timeout);\n\t\t\t\tvar fireNext = function(){\n\t\t\t\t\tvar i, queue, item;\n\t\t\t\t\tif ( History.busy.flag ) return;\n\t\t\t\t\tfor ( i=History.queues.length-1; i >= 0; --i ) {\n\t\t\t\t\t\tqueue = History.queues[i];\n\t\t\t\t\t\tif ( queue.length === 0 ) continue;\n\t\t\t\t\t\titem = queue.shift();\n\t\t\t\t\t\tHistory.fireQueueItem(item);\n\t\t\t\t\t\tHistory.busy.timeout = setTimeout(fireNext,History.options.busyDelay);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tHistory.busy.timeout = setTimeout(fireNext,History.options.busyDelay);\n\t\t\t}\n\n\t\t\t// Return\n\t\t\treturn History.busy.flag;\n\t\t};\n\n\t\t/**\n\t\t * History.busy.flag\n\t\t */\n\t\tHistory.busy.flag = false;\n\n\t\t/**\n\t\t * History.fireQueueItem(item)\n\t\t * Fire a Queue Item\n\t\t * @param {Object} item\n\t\t * @return {Mixed} result\n\t\t */\n\t\tHistory.fireQueueItem = function(item){\n\t\t\treturn item.callback.apply(item.scope||History,item.args||[]);\n\t\t};\n\n\t\t/**\n\t\t * History.pushQueue(callback,args)\n\t\t * Add an item to the queue\n\t\t * @param {Object} item [scope,callback,args,queue]\n\t\t */\n\t\tHistory.pushQueue = function(item){\n\t\t\t// Prepare the queue\n\t\t\tHistory.queues[item.queue||0] = History.queues[item.queue||0]||[];\n\n\t\t\t// Add to the queue\n\t\t\tHistory.queues[item.queue||0].push(item);\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.queue (item,queue), (func,queue), (func), (item)\n\t\t * Either firs the item now if not busy, or adds it to the queue\n\t\t */\n\t\tHistory.queue = function(item,queue){\n\t\t\t// Prepare\n\t\t\tif ( typeof item === 'function' ) {\n\t\t\t\titem = {\n\t\t\t\t\tcallback: item\n\t\t\t\t};\n\t\t\t}\n\t\t\tif ( typeof queue !== 'undefined' ) {\n\t\t\t\titem.queue = queue;\n\t\t\t}\n\n\t\t\t// Handle\n\t\t\tif ( History.busy() ) {\n\t\t\t\tHistory.pushQueue(item);\n\t\t\t} else {\n\t\t\t\tHistory.fireQueueItem(item);\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.clearQueue()\n\t\t * Clears the Queue\n\t\t */\n\t\tHistory.clearQueue = function(){\n\t\t\tHistory.busy.flag = false;\n\t\t\tHistory.queues = [];\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// IE Bug Fix\n\n\t\t/**\n\t\t * History.stateChanged\n\t\t * States whether or not the state has changed since the last double check was initialised\n\t\t */\n\t\tHistory.stateChanged = false;\n\n\t\t/**\n\t\t * History.doubleChecker\n\t\t * Contains the timeout used for the double checks\n\t\t */\n\t\tHistory.doubleChecker = false;\n\n\t\t/**\n\t\t * History.doubleCheckComplete()\n\t\t * Complete a double check\n\t\t * @return {History}\n\t\t */\n\t\tHistory.doubleCheckComplete = function(){\n\t\t\t// Update\n\t\t\tHistory.stateChanged = true;\n\n\t\t\t// Clear\n\t\t\tHistory.doubleCheckClear();\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.doubleCheckClear()\n\t\t * Clear a double check\n\t\t * @return {History}\n\t\t */\n\t\tHistory.doubleCheckClear = function(){\n\t\t\t// Clear\n\t\t\tif ( History.doubleChecker ) {\n\t\t\t\tclearTimeout(History.doubleChecker);\n\t\t\t\tHistory.doubleChecker = false;\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\t\t/**\n\t\t * History.doubleCheck()\n\t\t * Create a double check\n\t\t * @return {History}\n\t\t */\n\t\tHistory.doubleCheck = function(tryAgain){\n\t\t\t// Reset\n\t\t\tHistory.stateChanged = false;\n\t\t\tHistory.doubleCheckClear();\n\n\t\t\t// Fix IE6,IE7 bug where calling history.back or history.forward does not actually change the hash (whereas doing it manually does)\n\t\t\t// Fix Safari 5 bug where sometimes the state does not change: https://bugs.webkit.org/show_bug.cgi?id=42940\n\t\t\tif ( History.bugs.ieDoubleCheck ) {\n\t\t\t\t// Apply Check\n\t\t\t\tHistory.doubleChecker = setTimeout(\n\t\t\t\t\tfunction(){\n\t\t\t\t\t\tHistory.doubleCheckClear();\n\t\t\t\t\t\tif ( !History.stateChanged ) {\n\t\t\t\t\t\t\t//History.debug('History.doubleCheck: State has not yet changed, trying again', arguments);\n\t\t\t\t\t\t\t// Re-Attempt\n\t\t\t\t\t\t\ttryAgain();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t},\n\t\t\t\t\tHistory.options.doubleCheckInterval\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// Safari Bug Fix\n\n\t\t/**\n\t\t * History.safariStatePoll()\n\t\t * Poll the current state\n\t\t * @return {History}\n\t\t */\n\t\tHistory.safariStatePoll = function(){\n\t\t\t// Poll the URL\n\n\t\t\t// Get the Last State which has the new URL\n\t\t\tvar\n\t\t\t\turlState = History.extractState(History.getLocationHref()),\n\t\t\t\tnewState;\n\n\t\t\t// Check for a difference\n\t\t\tif ( !History.isLastSavedState(urlState) ) {\n\t\t\t\tnewState = urlState;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Check if we have a state with that url\n\t\t\t// If not create it\n\t\t\tif ( !newState ) {\n\t\t\t\t//History.debug('History.safariStatePoll: new');\n\t\t\t\tnewState = History.createStateObject();\n\t\t\t}\n\n\t\t\t// Apply the New State\n\t\t\t//History.debug('History.safariStatePoll: trigger');\n\t\t\tHistory.Adapter.trigger(window,'popstate');\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// State Aliases\n\n\t\t/**\n\t\t * History.back(queue)\n\t\t * Send the browser history back one item\n\t\t * @param {Integer} queue [optional]\n\t\t */\n\t\tHistory.back = function(queue){\n\t\t\t//History.debug('History.back: called', arguments);\n\n\t\t\t// Handle Queueing\n\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t// Wait + Push to Queue\n\t\t\t\t//History.debug('History.back: we must wait', arguments);\n\t\t\t\tHistory.pushQueue({\n\t\t\t\t\tscope: History,\n\t\t\t\t\tcallback: History.back,\n\t\t\t\t\targs: arguments,\n\t\t\t\t\tqueue: queue\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Make Busy + Continue\n\t\t\tHistory.busy(true);\n\n\t\t\t// Fix certain browser bugs that prevent the state from changing\n\t\t\tHistory.doubleCheck(function(){\n\t\t\t\tHistory.back(false);\n\t\t\t});\n\n\t\t\t// Go back\n\t\t\thistory.go(-1);\n\n\t\t\t// End back closure\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.forward(queue)\n\t\t * Send the browser history forward one item\n\t\t * @param {Integer} queue [optional]\n\t\t */\n\t\tHistory.forward = function(queue){\n\t\t\t//History.debug('History.forward: called', arguments);\n\n\t\t\t// Handle Queueing\n\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t// Wait + Push to Queue\n\t\t\t\t//History.debug('History.forward: we must wait', arguments);\n\t\t\t\tHistory.pushQueue({\n\t\t\t\t\tscope: History,\n\t\t\t\t\tcallback: History.forward,\n\t\t\t\t\targs: arguments,\n\t\t\t\t\tqueue: queue\n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Make Busy + Continue\n\t\t\tHistory.busy(true);\n\n\t\t\t// Fix certain browser bugs that prevent the state from changing\n\t\t\tHistory.doubleCheck(function(){\n\t\t\t\tHistory.forward(false);\n\t\t\t});\n\n\t\t\t// Go forward\n\t\t\thistory.go(1);\n\n\t\t\t// End forward closure\n\t\t\treturn true;\n\t\t};\n\n\t\t/**\n\t\t * History.go(index,queue)\n\t\t * Send the browser history back or forward index times\n\t\t * @param {Integer} queue [optional]\n\t\t */\n\t\tHistory.go = function(index,queue){\n\t\t\t//History.debug('History.go: called', arguments);\n\n\t\t\t// Prepare\n\t\t\tvar i;\n\n\t\t\t// Handle\n\t\t\tif ( index > 0 ) {\n\t\t\t\t// Forward\n\t\t\t\tfor ( i=1; i<=index; ++i ) {\n\t\t\t\t\tHistory.forward(queue);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if ( index < 0 ) {\n\t\t\t\t// Backward\n\t\t\t\tfor ( i=-1; i>=index; --i ) {\n\t\t\t\t\tHistory.back(queue);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthrow new Error('History.go: History.go requires a positive or negative integer passed.');\n\t\t\t}\n\n\t\t\t// Chain\n\t\t\treturn History;\n\t\t};\n\n\n\t\t// ====================================================================\n\t\t// HTML5 State Support\n\n\t\t// Non-Native pushState Implementation\n\t\tif ( History.emulated.pushState ) {\n\t\t\t/*\n\t\t\t * Provide Skeleton for HTML4 Browsers\n\t\t\t */\n\n\t\t\t// Prepare\n\t\t\tvar emptyFunction = function(){};\n\t\t\tHistory.pushState = History.pushState||emptyFunction;\n\t\t\tHistory.replaceState = History.replaceState||emptyFunction;\n\t\t} // History.emulated.pushState\n\n\t\t// Native pushState Implementation\n\t\telse {\n\t\t\t/*\n\t\t\t * Use native HTML5 History API Implementation\n\t\t\t */\n\n\t\t\t/**\n\t\t\t * History.onPopState(event,extra)\n\t\t\t * Refresh the Current State\n\t\t\t */\n\t\t\tHistory.onPopState = function(event,extra){\n\t\t\t\t// Prepare\n\t\t\t\tvar stateId = false, newState = false, currentHash, currentState;\n\n\t\t\t\t// Reset the double check\n\t\t\t\tHistory.doubleCheckComplete();\n\n\t\t\t\t// Check for a Hash, and handle apporiatly\n\t\t\t\tcurrentHash = History.getHash();\n\t\t\t\tif ( currentHash ) {\n\t\t\t\t\t// Expand Hash\n\t\t\t\t\tcurrentState = History.extractState(currentHash||History.getLocationHref(),true);\n\t\t\t\t\tif ( currentState ) {\n\t\t\t\t\t\t// We were able to parse it, it must be a State!\n\t\t\t\t\t\t// Let's forward to replaceState\n\t\t\t\t\t\t//History.debug('History.onPopState: state anchor', currentHash, currentState);\n\t\t\t\t\t\tHistory.replaceState(currentState.data, currentState.title, currentState.url, false);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// Traditional Anchor\n\t\t\t\t\t\t//History.debug('History.onPopState: traditional anchor', currentHash);\n\t\t\t\t\t\tHistory.Adapter.trigger(window,'anchorchange');\n\t\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\t}\n\n\t\t\t\t\t// We don't care for hashes\n\t\t\t\t\tHistory.expectedStateId = false;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Ensure\n\t\t\t\tstateId = History.Adapter.extractEventData('state',event,extra) || false;\n\n\t\t\t\t// Fetch State\n\t\t\t\tif ( stateId ) {\n\t\t\t\t\t// Vanilla: Back/forward button was used\n\t\t\t\t\tnewState = History.getStateById(stateId);\n\t\t\t\t}\n\t\t\t\telse if ( History.expectedStateId ) {\n\t\t\t\t\t// Vanilla: A new state was pushed, and popstate was called manually\n\t\t\t\t\tnewState = History.getStateById(History.expectedStateId);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Initial State\n\t\t\t\t\tnewState = History.extractState(History.getLocationHref());\n\t\t\t\t}\n\n\t\t\t\t// The State did not exist in our store\n\t\t\t\tif ( !newState ) {\n\t\t\t\t\t// Regenerate the State\n\t\t\t\t\tnewState = History.createStateObject(null,null,History.getLocationHref());\n\t\t\t\t}\n\n\t\t\t\t// Clean\n\t\t\t\tHistory.expectedStateId = false;\n\n\t\t\t\t// Check if we are the same state\n\t\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\t\t// There has been no change (just the page's hash has finally propagated)\n\t\t\t\t\t//History.debug('History.onPopState: no change', newState, History.savedStates);\n\t\t\t\t\tHistory.busy(false);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Store the State\n\t\t\t\tHistory.storeState(newState);\n\t\t\t\tHistory.saveState(newState);\n\n\t\t\t\t// Force update of the title\n\t\t\t\tHistory.setTitle(newState);\n\n\t\t\t\t// Fire Our Event\n\t\t\t\tHistory.Adapter.trigger(window,'statechange');\n\t\t\t\tHistory.busy(false);\n\n\t\t\t\t// Return true\n\t\t\t\treturn true;\n\t\t\t};\n\t\t\tHistory.Adapter.bind(window,'popstate',History.onPopState);\n\n\t\t\t/**\n\t\t\t * History.pushState(data,title,url)\n\t\t\t * Add a new State to the history object, become it, and trigger onpopstate\n\t\t\t * We have to trigger for HTML4 compatibility\n\t\t\t * @param {object} data\n\t\t\t * @param {string} title\n\t\t\t * @param {string} url\n\t\t\t * @return {true}\n\t\t\t */\n\t\t\tHistory.pushState = function(data,title,url,queue){\n\t\t\t\t//History.debug('History.pushState: called', arguments);\n\n\t\t\t\t// Check the State\n\t\t\t\tif ( History.getHashByUrl(url) && History.emulated.pushState ) {\n\t\t\t\t\tthrow new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n\t\t\t\t}\n\n\t\t\t\t// Handle Queueing\n\t\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t//History.debug('History.pushState: we must wait', arguments);\n\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\tcallback: History.pushState,\n\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Make Busy + Continue\n\t\t\t\tHistory.busy(true);\n\n\t\t\t\t// Create the newState\n\t\t\t\tvar newState = History.createStateObject(data,title,url);\n\n\t\t\t\t// Check it\n\t\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\t\t// Won't be a change\n\t\t\t\t\tHistory.busy(false);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Store the newState\n\t\t\t\t\tHistory.storeState(newState);\n\t\t\t\t\tHistory.expectedStateId = newState.id;\n\n\t\t\t\t\t// Push the newState\n\t\t\t\t\thistory.pushState(newState.id,newState.title,newState.url);\n\n\t\t\t\t\t// Fire HTML5 Event\n\t\t\t\t\tHistory.Adapter.trigger(window,'popstate');\n\t\t\t\t}\n\n\t\t\t\t// End pushState closure\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\t/**\n\t\t\t * History.replaceState(data,title,url)\n\t\t\t * Replace the State and trigger onpopstate\n\t\t\t * We have to trigger for HTML4 compatibility\n\t\t\t * @param {object} data\n\t\t\t * @param {string} title\n\t\t\t * @param {string} url\n\t\t\t * @return {true}\n\t\t\t */\n\t\t\tHistory.replaceState = function(data,title,url,queue){\n\t\t\t\t//History.debug('History.replaceState: called', arguments);\n\n\t\t\t\t// Check the State\n\t\t\t\tif ( History.getHashByUrl(url) && History.emulated.pushState ) {\n\t\t\t\t\tthrow new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');\n\t\t\t\t}\n\n\t\t\t\t// Handle Queueing\n\t\t\t\tif ( queue !== false && History.busy() ) {\n\t\t\t\t\t// Wait + Push to Queue\n\t\t\t\t\t//History.debug('History.replaceState: we must wait', arguments);\n\t\t\t\t\tHistory.pushQueue({\n\t\t\t\t\t\tscope: History,\n\t\t\t\t\t\tcallback: History.replaceState,\n\t\t\t\t\t\targs: arguments,\n\t\t\t\t\t\tqueue: queue\n\t\t\t\t\t});\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\t// Make Busy + Continue\n\t\t\t\tHistory.busy(true);\n\n\t\t\t\t// Create the newState\n\t\t\t\tvar newState = History.createStateObject(data,title,url);\n\n\t\t\t\t// Check it\n\t\t\t\tif ( History.isLastSavedState(newState) ) {\n\t\t\t\t\t// Won't be a change\n\t\t\t\t\tHistory.busy(false);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Store the newState\n\t\t\t\t\tHistory.storeState(newState);\n\t\t\t\t\tHistory.expectedStateId = newState.id;\n\n\t\t\t\t\t// Push the newState\n\t\t\t\t\thistory.replaceState(newState.id,newState.title,newState.url);\n\n\t\t\t\t\t// Fire HTML5 Event\n\t\t\t\t\tHistory.Adapter.trigger(window,'popstate');\n\t\t\t\t}\n\n\t\t\t\t// End replaceState closure\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t} // !History.emulated.pushState\n\n\n\t\t// ====================================================================\n\t\t// Initialise\n\n\t\t/**\n\t\t * Load the Store\n\t\t */\n\t\tif ( sessionStorage ) {\n\t\t\t// Fetch\n\t\t\ttry {\n\t\t\t\tHistory.store = JSON.parse(sessionStorage.getItem('History.store'))||{};\n\t\t\t}\n\t\t\tcatch ( err ) {\n\t\t\t\tHistory.store = {};\n\t\t\t}\n\n\t\t\t// Normalize\n\t\t\tHistory.normalizeStore();\n\t\t}\n\t\telse {\n\t\t\t// Default Load\n\t\t\tHistory.store = {};\n\t\t\tHistory.normalizeStore();\n\t\t}\n\n\t\t/**\n\t\t * Clear Intervals on exit to prevent memory leaks\n\t\t */\n\t\tHistory.Adapter.bind(window,\"unload\",History.clearAllIntervals);\n\n\t\t/**\n\t\t * Create the initial State\n\t\t */\n\t\tHistory.saveState(History.storeState(History.extractState(History.getLocationHref(),true)));\n\n\t\t/**\n\t\t * Bind for Saving Store\n\t\t */\n\t\tif ( sessionStorage ) {\n\t\t\t// When the page is closed\n\t\t\tHistory.onUnload = function(){\n\t\t\t\t// Prepare\n\t\t\t\tvar\tcurrentStore, item, currentStoreString;\n\n\t\t\t\t// Fetch\n\t\t\t\ttry {\n\t\t\t\t\tcurrentStore = JSON.parse(sessionStorage.getItem('History.store'))||{};\n\t\t\t\t}\n\t\t\t\tcatch ( err ) {\n\t\t\t\t\tcurrentStore = {};\n\t\t\t\t}\n\n\t\t\t\t// Ensure\n\t\t\t\tcurrentStore.idToState = currentStore.idToState || {};\n\t\t\t\tcurrentStore.urlToId = currentStore.urlToId || {};\n\t\t\t\tcurrentStore.stateToId = currentStore.stateToId || {};\n\n\t\t\t\t// Sync\n\t\t\t\tfor ( item in History.idToState ) {\n\t\t\t\t\tif ( !History.idToState.hasOwnProperty(item) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentStore.idToState[item] = History.idToState[item];\n\t\t\t\t}\n\t\t\t\tfor ( item in History.urlToId ) {\n\t\t\t\t\tif ( !History.urlToId.hasOwnProperty(item) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentStore.urlToId[item] = History.urlToId[item];\n\t\t\t\t}\n\t\t\t\tfor ( item in History.stateToId ) {\n\t\t\t\t\tif ( !History.stateToId.hasOwnProperty(item) ) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tcurrentStore.stateToId[item] = History.stateToId[item];\n\t\t\t\t}\n\n\t\t\t\t// Update\n\t\t\t\tHistory.store = currentStore;\n\t\t\t\tHistory.normalizeStore();\n\n\t\t\t\t// In Safari, going into Private Browsing mode causes the\n\t\t\t\t// Session Storage object to still exist but if you try and use\n\t\t\t\t// or set any property/function of it it throws the exception\n\t\t\t\t// \"QUOTA_EXCEEDED_ERR: DOM Exception 22: An attempt was made to\n\t\t\t\t// add something to storage that exceeded the quota.\" infinitely\n\t\t\t\t// every second.\n\t\t\t\tcurrentStoreString = JSON.stringify(currentStore);\n\t\t\t\ttry {\n\t\t\t\t\t// Store\n\t\t\t\t\tsessionStorage.setItem('History.store', currentStoreString);\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\tif (e.code === DOMException.QUOTA_EXCEEDED_ERR) {\n\t\t\t\t\t\tif (sessionStorage.length) {\n\t\t\t\t\t\t\t// Workaround for a bug seen on iPads. Sometimes the quota exceeded error comes up and simply\n\t\t\t\t\t\t\t// removing/resetting the storage can work.\n\t\t\t\t\t\t\tsessionStorage.removeItem('History.store');\n\t\t\t\t\t\t\tsessionStorage.setItem('History.store', currentStoreString);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Otherwise, we're probably private browsing in Safari, so we'll ignore the exception.\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// For Internet Explorer\n\t\t\tHistory.intervalList.push(setInterval(History.onUnload,History.options.storeInterval));\n\n\t\t\t// For Other Browsers\n\t\t\tHistory.Adapter.bind(window,'beforeunload',History.onUnload);\n\t\t\tHistory.Adapter.bind(window,'unload',History.onUnload);\n\n\t\t\t// Both are enabled for consistency\n\t\t}\n\n\t\t// Non-Native pushState Implementation\n\t\tif ( !History.emulated.pushState ) {\n\t\t\t// Be aware, the following is only for native pushState implementations\n\t\t\t// If you are wanting to include something for all browsers\n\t\t\t// Then include it above this if block\n\n\t\t\t/**\n\t\t\t * Setup Safari Fix\n\t\t\t */\n\t\t\tif ( History.bugs.safariPoll ) {\n\t\t\t\tHistory.intervalList.push(setInterval(History.safariStatePoll, History.options.safariPollInterval));\n\t\t\t}\n\n\t\t\t/**\n\t\t\t * Ensure Cross Browser Compatibility\n\t\t\t */\n\t\t\tif ( navigator.vendor === 'Apple Computer, Inc.' || (navigator.appCodeName||'') === 'Mozilla' ) {\n\t\t\t\t/**\n\t\t\t\t * Fix Safari HashChange Issue\n\t\t\t\t */\n\n\t\t\t\t// Setup Alias\n\t\t\t\tHistory.Adapter.bind(window,'hashchange',function(){\n\t\t\t\t\tHistory.Adapter.trigger(window,'popstate');\n\t\t\t\t});\n\n\t\t\t\t// Initialise Alias\n\t\t\t\tif ( History.getHash() ) {\n\t\t\t\t\tHistory.Adapter.onDomLoad(function(){\n\t\t\t\t\t\tHistory.Adapter.trigger(window,'hashchange');\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t} // !History.emulated.pushState\n\n\n\t}; // History.initCore\n\n\t// Try to Initialise History\n\tif (!History.options || !History.options.delayInit) {\n\t\tHistory.init();\n\t}\n\n})(window);\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/plugin/jquery.history.js","// 删除自己发布的话题\nvar alert = require('module/popup/alert');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar confirm = require('module/popup/confirm');\n// //提交请求\n//        fetch.post(url.get('commentFirstV2'), {\n//            data: params\n//        }).then(function(data) {\n\nvar init = function() {\n    $(\"body\").on(\"click\", '[data-node=\"userTopic-del\"]', deletTopic);\n\n}\n\nvar deletTopic = function() {\n    var $this = $(this);\n    var id = $($this.parents().eq(2)).attr('data-left');\n    confirm('', {\n        content: \"<p class='del-pop-p' data-node='gettopId' data-topicH=\" + id + \">确定要删除该话题吗？</p>\",\n        title: '提示',\n        okCls: 'two-button two-button-red',\n        cancelCls: 'two-button',\n        ok: sendMsg,\n        btnWrapCls: 'text-center'\n    });\n}\nvar sendMsg = function() {\n    var groupid = $_CONFIG['groupid'];\n    var idd = {\n        id: $(\"[data-node='gettopId']\").attr('data-topicH'),\n        groupId:groupid\n    };\n\n    fetch.post(url.get('topicDel'), {\n        data: idd\n    }).then(function(data) {\n        if (data.success) {\n            location.replace($GLOBAL_CONFIG['group_domain'] + 'circle/' + groupid + '.html');\n        } else {\n            alert(\"删除失败！\");\n        }\n    });\n}\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/deletUserTopic.js","//var alert = require('module/popup/alert');\nvar upload = require('module/popup/upload/uploader');\n//var addBox = $('[data-node=addImgGoods]');\nvar confirm = require('module/popup/confirm');\nvar loginState = require('./../loginState');\nvar rotateImg = require('./rotateImg');\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar addImgTpl = require('./chooseImg.tpl');\nvar topFixed = require('../../topicAddMore/topicAddMore').topFixed; //右侧固定\nvar Pubsub = require('io/pubsub');\nvar channel = require('io/channel');\n\n//插入二维码上传\nvar detectQr = require('module/popup/uploadfileQR');\n//存储二维码\nvar codeArr = [];\n\nvar $showBox = $('[data-node=\"picPopBox\"]');\nvar topicId = '';\nvar showImgBox = function() {\n\n    $(\"body\").on(\"click\", '[data-node=\"addImg_btn\"]', btnEvent)\n        .on(\"click\", \"[data-node='addMoreImg']\", addMoreImgFn) //+ tu\n        .on(\"click\", \"[data-node='imgPics']\", imgPicsBig)\n        .on(\"click\", '[data-node=\"imgBigHind\"]', imgBigHindFn)\n        .on(\"click\", '[data-node=\"hideBigPic\"]', hideBigPicFn)\n        .on(\"click\", '[data-node=\"imgBigPN\"]', imgBigPNFn)\n        .on(\"click\", '[data-node=\"deletImg\"]', deletImgFn)\n        .on(\"click\", '[data-node=\"showImg\"]', showImgFn)\n        .on(\"click\", '[data-node=\"roteRo\"]', rotateImg.init)\n        .on(\"click\", '[data-node=\"addImg_btn\"]', picPopBoxEvent)\n        .on(\"click\", '[data-node=\"picPopBox\"]', picPopBoxEvent)\n        .on('click', codeBoxEvent);\n}\n\nvar deletImgFn = function() {\n    var $this = $($(this).parents().eq(2));\n    var imgSrc = $this.children(\"a\").children(\"img\").attr(\"src\");\n    var ul = $this.parent();\n    var $div = ul.parent();\n    var imgLENG = parseInt($div.attr(\"data-imgnum\"));\n    //var arrImg=[];\n    confirm('确认删除该图片？', {\n        title: '提示',\n        okCls: 'two-button two-button-red',\n        cancelCls: 'two-button',\n        btnWrapCls: 'text-center',\n        ok: function() {\n            $this.remove();\n            var arriMG = ul.attr(\"data-imgsrt\");\n            var a = arriMG.split(',');\n            var b = a;\n            b.splice(imgSrc, 1);\n            ul.attr(\"data-imgsrt\", b);\n            $div.attr(\"data-imgnum\", imgLENG + 1);\n            ul.children(\"[data-node='addMoreImg']\").removeClass(\"hide\");\n            $div.parent().find(\"[data-node='addImg_btn']\").removeClass(\"disabled\");\n            if (parseInt(imgLENG + 1) >= 9) {\n                ul.addClass(\"hide\");\n            }\n        }\n    })\n}\nvar addMoreImgFn = function() {\n    var imgNum = $($(this).parents().eq(1)).attr(\"data-imgNum\");\n    topicId = $($(this).parents().eq(2)).children(\".publish-face-bx\").attr(\"data-publish\");\n    if (imgNum == 0) {\n        return false\n    } else {\n        upload(imgNum, topicId); //\n    }\n}\nvar showImgFn = function() {\n    var $this = $(this);\n\n    if ($this.hasClass(\"active\")) {\n        return false;\n    } else {\n        var toPage = $(this).attr(\"data-active\");\n        var toImG = $($this.parents().eq(1)).children(\".big-img\").children(\".img-hidden\").children(\"[data-bigimg='\" + toPage + \"']\");\n\n        $(toImG).removeClass(\"hide\").siblings().addClass(\"hide\");\n        var imgObj = $(toImG).children(\"img\");\n        if ($(imgObj).hasClass(\"srcError\")) {\n            $(imgObj).removeClass(\"srcError\")\n            $(imgObj).attr(\"src\", $(imgObj).attr(\"data-imgsrc\"));\n        }\n        $this.addClass(\"active\").siblings().removeClass(\"active\");\n        var imgSrc = $($this.parents().eq(1)).children(\".big-title\").children(\"[data-node='imgBigSrc']\");\n        $(imgSrc).attr(\"href\", $(imgObj).attr(\"data-imgsrc\"));\n    }\n\n}\nvar imgBigPNFn = function() {\n    var $this = $(this);\n    var curPage = $($this.parents().eq(1)).children(\".img-slide\").children(\".active\").attr(\"data-active\");\n    curPage = parseInt(curPage);\n\n    var toPage = null;\n    var tootalPage = parseInt($this.parent().attr(\"data-piclength\")) - 1;\n\n    if ($this.attr(\"data-page\") == \"pre\") {\n        if (curPage == 0) {\n            toPage = tootalPage;\n        } else {\n            toPage = curPage - 1;\n        }\n    } else {\n        if (curPage == tootalPage) {\n            toPage = 0;\n        } else {\n            toPage = curPage + 1;\n        }\n    }\n    // 图片更改\n    $($this.parents().eq(1)).children(\".img-slide\").children(\"[data-active='\" + toPage + \"']\").click();\n\n}\nvar hideBigPicFn = function() {\n    var divObj = $(this).parents().eq(2);\n    var parentObj = $(this).parents().eq(3);\n    $(divObj).addClass(\"hide\");\n    $(parentObj).children(\"ul\").removeClass(\"hide\");\n    topFixed($(window).scrollTop());\n}\n\n//大图隐藏\nvar imgBigHindFn = function() {\n        var divObj = $(this).parents().eq(1);\n        var parentObj = $(this).parents().eq(2);\n        $(divObj).addClass(\"hide\");\n        $(parentObj).children(\"ul\").removeClass(\"hide\");\n        topFixed($(window).scrollTop());\n    }\n    // 评论列表中大图展示\nvar imgPicsBig = function() {\n    var parentObj = $(this).parents().eq(1);\n    var ulObj = $(this).parents().eq(0);\n    var divBig = $(parentObj).children(\"[data-node='imgBigPic']\");\n    $(ulObj).addClass(\"hide\");\n    divBig.removeClass(\"hide\");\n\n    //大图定位显示\n    var pageId = $(this).attr(\"data-imgsort\");\n    //获取当前大图节点\n    //div\n    var thisBigPic = divBig.children(\".big-img\").children(\".img-hidden\").children(\"[data-bigimg='\" + pageId + \"']\");\n    var thisImage = $(thisBigPic).children(\"img\"); //img\n\n    $(thisBigPic).removeClass(\"hide\").siblings().addClass(\"hide\");\n    if ($(thisImage).hasClass(\"srcError\")) {\n        $(thisImage).removeClass(\"srcError\")\n        $(thisImage).attr(\"src\", $(thisImage).attr(\"data-imgsrc\"));\n    }\n\n    var aBtn = divBig.children(\".img-slide\").children(\"[data-active='\" + pageId + \"']\");\n    $(aBtn).addClass(\"active\").siblings().removeClass(\"active\");\n    //查看原图 添加链接\n    var $imgSrc = divBig.children(\".big-title\").children(\"[data-node='imgBigSrc']\");\n    $($imgSrc).attr(\"href\", $(thisImage).attr(\"data-imgsrc\"));\n    topFixed($(window).scrollTop());\n}\n\n//添加图片按钮事件\nvar btnEvent = function() {\n\n    if (!checkLoginStatus()) {\n        loginState.popUnion();\n        return false;\n    }\n\n    var imgNum = $(this).parents().eq(1).children(\"[data-node='addImgGoods']\").attr(\"data-imgNum\");\n    topicId = $(this).parent().attr(\"data-publish\");\n    $('[data-node=\"picPopBox\"]').removeClass('webuploader-element-invisible');\n    $('div[tabindex]').remove();\n    if (imgNum == 0) {\n        return false\n    } else {\n        code(topicId, $(this));\n        upload(imgNum, 9);\n    }\n}\nPubsub(channel.setPubliser.changeImage).sub(function(data) {\n    setImage(data, topicId);\n});\nvar setImage = function(data, topicId) {\n    if (data.images.length > 0) {\n        var arrImg = [];\n        var $div = $(\"[data-tid=\" + topicId + \"]\").children(\"[data-node='addImgGoods']\");\n        var num = parseInt($div.attr(\"data-imgNum\"));\n        var nextnum = parseInt(num - data.images.length);\n        $div.attr(\"data-imgNum\", nextnum);\n        var $ul = $(\"[data-tid='\" + topicId + \"']\").find(\"[data-node='imgUl']\");\n        $ul.addClass(\"topic-imglist\");\n        var imgsrt = $ul.attr(\"data-imgsrt\");\n        var pictureHTML = addImgTpl(data);\n        $ul.removeClass(\"hide\").append(pictureHTML);\n        if (imgsrt) {\n            arrImg.push(imgsrt);\n        }\n        for (var i = 0; i < data.images.length; i++) {\n            arrImg.push(data.images[i]);\n        }\n        $ul.attr(\"data-imgsrt\", arrImg);\n        var lengthImg = parseInt($ul.parent().attr(\"data-imgNum\"));\n        if (lengthImg <= 0) {\n            $(\"[data-tid=\" + topicId + \"]\").find(\"[data-node='addImg_btn']\").addClass(\"disabled\");\n        }\n    } else {\n        return false;\n    }\n\n}\n\n//图片二维码弹窗显示隐藏\nvar picPopBoxEvent = function(e) {\n\n    $('[data-node=\"faceBox\"]').hide();\n    e.stopPropagation();\n}\n\n//body点击事件,二维码弹窗隐藏\nvar codeBoxEvent = function(e) {\n    $showBox.hide();\n}\n\nvar code = function(topicId, $this) {\n\n    if (!window.topicQrId) {\n\n        window.topicQrId = [];\n    }\n    topicId = 's' + topicId;\n    //var arr = window.topicQrId;\n    if (!window.topicQrId[topicId]) {\n\n        var obj = {\n            qid: topicId,\n            time: 2000,\n            $showBox: $showBox,\n            customCb: customCb,\n            $insertDom: \"\",\n            $target: $this,\n            type: 'detail',\n            maxNum: 9\n        }\n\n        $.extend(obj, {\n            $parent: $this.parents('[data-node=\"comment_Msg\"]').find('[data-node=\"imgUl\"]'),\n        })\n        window.topicQrId[topicId] = new detectQr(obj)\n\n        window.topicQrId[topicId].init();\n\n    } else {\n        var _newObj = window.topicQrId[topicId]\n        if (!_newObj.useNewCode) {\n            _newObj.getCode();\n        } else {\n            if (!_newObj.checkShow()) {\n\n                _newObj.show();\n                _newObj.sendNum();\n            } else {\n                _newObj.hide();\n            }\n        }\n    }\n}\n\nvar customCb = function(data, obj) {\n    var _this = obj;\n    topicId = obj.qid.slice(1);\n    var imgs = {}; //为了做兼容性 处理\n    imgs.images = data;\n    setImage(imgs, topicId);\n}\n\n//添加事件\nvar addEvent = function() {\n    showImgBox();\n}\n\nmodule.exports = {\n    init: addEvent\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/addImgGoods/addIMG.js","var fetch = require('io/fetch');\nvar url = require('io/url');\nvar alert = require('module/popup/alert');\n\nvar init = function (){\n\tvar $this = $(this);\n\tvar divEm = $(this).parent();\n\tvar $img = $($this.parents().eq(1)).children('img');\n\tvar imgSrc = $img.attr('src');\n\tvar oldImgSrc = $img.attr('data-oldImg');\n\tvar roteNum =Number.parseInt(divEm.attr('data-roteNum'));\n\n\tif(oldImgSrc.indexOf(\".gif\") != -1){\n\t\talert(\"gif图不支持旋转\");\n\t\treturn false;\n\t}else{\n\t\tif($this.hasClass('roteLeft')){\n\t\t\troteNum =(roteNum + 90)%360;\n\t\t}else if($this.hasClass('roteRight')){\n\t\t\troteNum =(roteNum - 90 + 360)%360;\n\t\t}\n\n\t\tif(roteNum===0){\n\t\t\t$img.attr('src',oldImgSrc);\n\t\t\t$img.css({\n\t\t\t\t\"transform\":\"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-ms-transform\" : \"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-moz-transform\":\"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-webkit-transform\":\"rotate(\"+roteNum+\"deg)\",\n\t\t\t\t\"-o-transform\":\"rotate(\"+roteNum+\"deg)\"\n\t\t\t});\n\t\t\tdivEm.attr('data-roteNum',roteNum);\n\n\t\t}else{\n\t\t\tvar params = {\n\t\t\t\timgPath : oldImgSrc,\n\t\t        angle : roteNum\n\t\t\t}\n\t\t\tfetch.post(url.get('handleimg'), {\n\t\t        data: params\n\t\t    }).then(function(data) {\n\t\t    \t\n\t\t    \tif(data.success){\n\t\t    \t\t$img.attr('src',data.data);\n\t\t    \t\tdivEm.attr('data-roteNum',roteNum);\n\t\t    \t}else{\n\t\t    \t\talert(data.message);\n\t\t    \t}\n\t\t    });\n\t\t}\n\t}\n\n\t\n\t\n}\n\nmodule.exports = { init }\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/addImgGoods/rotateImg.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/addImgGoods/chooseImg',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$each=$utils.$each,images=$data.images,value=$data.value,i=$data.i,$escape=$utils.$escape,$out='';$each(images,function(value,i){\n$out+=' <li class=\"imgClass\"> <a href=\"javascript:;\" > <img src=\"';\n$out+=$escape(value);\n$out+='\" width=100 height=100 data-node=\"imgSrc\" data-oldImg=\"';\n$out+=$escape(value);\n$out+='\">  <div data-roteNum=0 class=\"icon-del\" > <em class=\"iconImg roteLeft\" data-node=\"roteRo\" ></em> <em class=\"iconImg roteRight\" data-node=\"roteRo\" ></em> <em class=\"iconImg deletImg\" data-node=\"deletImg\"></em> </div> </a> </li> ';\n});\n$out+=' ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/addImgGoods/chooseImg.tpl\n// module id = 271\n// module chunks = 30","//var addBox = $('[data-node=addImgGoods]');\nvar checkLoginStatus = require('module/checkLoginStatus'); //登陆判断\nvar dialog = require('module/addGoods');\nvar Pubsub = require('io/pubsub');\nvar pubName = require('io/channel');\nvar goodsInTpl = require('./goodsIn.tpl');\nvar loginState = require('./../loginState');\nvar curTopicId = \"\";\n\nvar showGoodsBox = function() {\n\n    Pubsub(pubName.setPubliser.changedItem).sub(setGoods);\n    $(\"body\").on(\"click\", \"[data-node=addGoods_btn]\", function() {\n\n        // 判断是否登陆，没登录，显示登录框\n        if (!checkLoginStatus()) {\n            loginState.popUnion();\n            return false;\n        }\n\n        var $comment_Msg = $(this).closest(\"[data-node=comment_Msg]\");\n        curTopicId = $comment_Msg.attr(\"data-tid\");\n        var $addImgGoods = $comment_Msg.find(\"[data-node='addImgGoods']\");\n        if ($addImgGoods.hasClass(\"hasGoods\") || $(this).hasClass(\"disabled\")) {\n            return false;\n        } else {\n            var changedGoods = {};\n            dialog(changedGoods, 1);\n\n        }\n\n    });\n    //删除商品\n    $(\"body\").on(\"click\", \"[data-node='deletGoods']\", function() {\n        var $comment_Msg = $(this).closest(\"[data-node='comment_Msg']\");\n        $comment_Msg.find(\"[data-node='addImgGoods']\").removeClass(\"hasGoods\").attr(\"data-goodStr\", \"\");\n        $(this).parent().remove();\n        $comment_Msg.find(\"[data-node='addGoods_btn']\").removeClass(\"disabled\");\n    });\n}\n\n//\nvar setGoods = function(data) {\n    //将商品添加到div\n    var goodsData = data;\n    var comment_Msg = $(\"[data-tid=\" + curTopicId + \"]\");\n    var $addImgGoods = comment_Msg.children(\"[data-node='addImgGoods']\");\n    for (var key in goodsData) {\n        var v = goodsData[key];\n        var strGood = {\n            \"pid\": v.PId,\n            \"skuId\": v.skuId,\n            \"img\": v.img,\n            \"link\": v.link,\n            \"price\": v.price,\n            \"shopId\": v.shopId,\n            \"title\": v.title,\n            //\"rebate\": v.rebate,\n            \"skuId\":v.skuId\n        }\n    }\n\n    if (strGood != \"undefined\") {\n        $addImgGoods.attr(\"data-goodStr\", JSON.stringify(strGood));\n    }\n\n    var item = goodsInTpl(strGood);\n    $addImgGoods.prepend(item).addClass(\"hasGoods\");\n    comment_Msg.find(\"[data-node='addGoods_btn']\").addClass(\"disabled\");\n}\n\nmodule.exports = {\n    init: showGoodsBox\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/comment/addImgGoods/addGoods.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/comment/addImgGoods/goodsIn',function($data,$filename\n/*``*/) {\n'use strict';var $utils=this,$helpers=$utils.$helpers,$escape=$utils.$escape,shopId=$data.shopId,pid=$data.pid,skuId=$data.skuId,img=$data.img,title=$data.title,price=$data.price,rebate=$data.rebate,link=$data.link,$out='';$out+=' <div data-node=\"goodsIn\" class=\"reply-details\" data-shopId =\"';\n$out+=$escape(shopId);\n$out+='\" data-itemId=\"';\n$out+=$escape(pid);\n$out+='\" data-skuId=';\n$out+=$escape(skuId);\n$out+='> <em class=\"icon-close-b\" data-node=\"deletGoods\"></em> <div class=\"reply-picture\"><img src=\"';\n$out+=$escape(img);\n$out+='\" onerror=\"imgError(this, \\'g\\')\"></div> <div class=\"reply-contxt\"> <p>';\n$out+=$escape(title);\n$out+='</p> <div class=\"price\"> <p class=\"price-numb\">￥<span>';\n$out+=$escape(price);\n$out+='</span></p> <!-- ';\nif(rebate > 0){\n$out+=' <div class=\"fan fan-s\"> <em class=\"icon-fan-s\"></em> <span>最高返';\n$out+=$escape(rebate);\n$out+='国美币</span> </div> ';\n}\n$out+=' --> </div> </div><a href=\"';\n$out+=$escape(link);\n$out+='\" class=\"see-details pc-btn pc-btnw105 pc-btnh40\" target=\"_blank\">查看详情</a> </div> ';\nreturn new String($out);\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/comment/addImgGoods/goodsIn.tpl\n// module id = 273\n// module chunks = 30","// 举报\nvar reportTpl = require('./report.tpl');\nvar alert = require('module/popup/alert');\nvar fetch = require('io/fetch');\nvar url = require('io/url');\nvar confirm = require('module/popup/confirm');\n\nvar reportBtn = '[data-action=topic-report]';\nvar reportSpan = '[data-node=reportType] span';\nvar checked = 'menu-checkbox-checked';\nvar type;\nvar reportId;\nvar active = 'active';\n\n//checkbox是否选中\nvar isChecked = function(){\n\tvar $this = $(this);\n\tif(!$this.hasClass(checked)){\n\t\t$(reportSpan).removeClass(checked);\n\t\t$this.addClass(checked);\n        $('.report-confirm-btn').addClass(active);\n\t}else {\n\t\t$this.removeClass(checked);\n        $('.report-confirm-btn').removeClass(active);\n\t}\n}\nvar reportTopic = function() {\n    var $this = $(this);\n    type = $this.attr('data-type');\n    reportId = (type==1) ? $this.parents('dd').attr('data-ddlist') : $this.parents('[data-node=wrap-box]').attr('id-node');\n    confirm('', {\n        content: reportTpl(),\n        title: '提示',\n        okCls: 'report-confirm-btn pc-btnh36 pc-btnw80',\n        cancelCls: 'pc-btnh36 pc-btnw80',\n        ok: sendMsg,\n        btnWrapCls: 'report-btn text-center'\n    });\n}\nvar sendMsg = function() {\n    if($('.report-confirm-btn').hasClass(active)){\n        var groupid = $_CONFIG['groupid'];\n        var index = $(reportSpan+'.'+checked).parent().index();\n        var idd = {\n            type: type ? type : 0,\n            reason: index,\n            reportId: reportId\n        };\n        fetch.post(url.get('topicReport'), {\n            data: idd\n        }).then(function(data) {\n            if (data.success === true) {\n                alert('举报成功，小编将擦亮眼睛重新审核');\n            } else {\n                if(data.code === 409) {\n                    alert(data.message);\n                }else {\n                    alert(\"删除失败！\");\n                }\n            }\n        });\n    }else {\n        return false;\n    }\n    \n}\n\nvar init = function() {\n\t$('body').on('click', reportSpan, isChecked);\n    $('body').on('click', reportBtn, reportTopic);\n}\nmodule.exports = {\n    init: init\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/page/topicDetails/report.js","var template=require('tmodjs-loader/runtime');\nmodule.exports=template('src/js/page/topicDetails/report','<div class=\"gome-report-title\">请选择举报类型</div> <ul class=\"gome-report-box clearfix\" data-node=\"reportType\"> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>色情低俗</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>政治敏感</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>营销广告</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>人身攻击</p> </li> <li class=\"gome-report clearfix\"> <span class=\"menu-checkbox\"></span> <p>其他</p> </li> </ul> ');\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/page/topicDetails/report.tpl\n// module id = 275\n// module chunks = 30"],"sourceRoot":""}